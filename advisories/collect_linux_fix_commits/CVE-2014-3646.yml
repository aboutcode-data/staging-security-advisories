advisory_id: CVE-2014-3646
datasource_id: collect_linux_fix_commits/CVE-2014-3646
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  a642fc305053cc1c6e47e4f4df327895747ab485:kvm: vmx: handle invvpid vm exit gracefully

  On systems with invvpid instruction support (corresponding bit in
  IA32_VMX_EPT_VPID_CAP MSR is set) guest invocation of invvpid
  causes vm exit, which is currently not handled and results in
  propagation of unknown exit to userspace.

  Fix this by installing an invvpid vm exit handler.

  This is CVE-2014-3646.

  Cc: stable@vger.kernel.org
  Signed-off-by: Petr Matousek <pmatouse@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: a642fc305053cc1c6e47e4f4df327895747ab485
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/a642fc305053cc1c6e47e4f4df327895747ab485
    reference_type: commit
    reference_id: a642fc305053cc1c6e47e4f4df327895747ab485
