advisory_id: CVE-2011-0726
datasource_id: collect_linux_fix_commits/CVE-2011-0726
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  5883f57ca0008ffc93e09cbb9847a1928e50c6f3:proc: protect mm start_code/end_code in /proc/pid/stat

  While mm->start_stack was protected from cross-uid viewing (commit
  f83ce3e6b02d5 ("proc: avoid information leaks to non-privileged
  processes")), the start_code and end_code values were not.  This would
  allow the text location of a PIE binary to leak, defeating ASLR.

  Note that the value "1" is used instead of "0" for a protected value since
  "ps", "killall", and likely other readers of /proc/pid/stat, take
  start_code of "0" to mean a kernel thread and will misbehave.  Thanks to
  Brad Spengler for pointing this out.

  Addresses CVE-2011-0726

  Signed-off-by: Kees Cook <kees.cook@canonical.com>
  Cc: <stable@kernel.org>
  Cc: Alexey Dobriyan <adobriyan@gmail.com>
  Cc: David Howells <dhowells@redhat.com>
  Cc: Eugene Teo <eugeneteo@kernel.sg>
  Cc: Martin Schwidefsky <schwidefsky@de.ibm.com>
  Cc: Brad Spengler <spender@grsecurity.net>
  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 5883f57ca0008ffc93e09cbb9847a1928e50c6f3
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/5883f57ca0008ffc93e09cbb9847a1928e50c6f3
    reference_type: commit
    reference_id: 5883f57ca0008ffc93e09cbb9847a1928e50c6f3
