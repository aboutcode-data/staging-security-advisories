advisory_id: CVE-2021-3640
datasource_id: collect_linux_fix_commits/CVE-2021-3640
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  99c23da0eed4fd20cae8243f2b51e10e66aa0951:Bluetooth: sco: Fix lock_sock() blockage by memcpy_from_msg()

  The sco_send_frame() also takes lock_sock() during memcpy_from_msg()
  call that may be endlessly blocked by a task with userfaultd
  technique, and this will result in a hung task watchdog trigger.

  Just like the similar fix for hci_sock_sendmsg() in commit
  92c685dc5de0 ("Bluetooth: reorganize functions..."), this patch moves
  the  memcpy_from_msg() out of lock_sock() for addressing the hang.

  This should be the last piece for fixing CVE-2021-3640 after a few
  already queued fixes.

  Signed-off-by: Takashi Iwai <tiwai@suse.de>
  Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 99c23da0eed4fd20cae8243f2b51e10e66aa0951
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/99c23da0eed4fd20cae8243f2b51e10e66aa0951
    reference_type: commit
    reference_id: 99c23da0eed4fd20cae8243f2b51e10e66aa0951
