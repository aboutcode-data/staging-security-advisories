advisory_id: CVE-2018-11412
datasource_id: collect_linux_fix_commits/CVE-2018-11412
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  eb9b5f01c33adebc31cbc236c02695f605b0e417:ext4: bubble errors from ext4_find_inline_data_nolock() up to ext4_iget()

  If ext4_find_inline_data_nolock() returns an error it needs to get
  reflected up to ext4_iget().  In order to fix this,
  ext4_iget_extra_inode() needs to return an error (and not return
  void).

  This is related to "ext4: do not allow external inodes for inline
  data" (which fixes CVE-2018-11412) in that in the errors=continue
  case, it would be useful to for userspace to receive an error
  indicating that file system is corrupted.

  Signed-off-by: Theodore Ts'o <tytso@mit.edu>
  Reviewed-by: Andreas Dilger <adilger@dilger.ca>
  Cc: stable@kernel.org
  117166efb1ee8f13c38f9e96b258f16d4923f888:ext4: do not allow external inodes for inline data

  The inline data feature was implemented before we added support for
  external inodes for xattrs.  It makes no sense to support that
  combination, but the problem is that there are a number of extended
  attribute checks that are skipped if e_value_inum is non-zero.

  Unfortunately, the inline data code is completely e_value_inum
  unaware, and attempts to interpret the xattr fields as if it were an
  inline xattr --- at which point, Hilarty Ensues.

  This addresses CVE-2018-11412.

  https://bugzilla.kernel.org/show_bug.cgi?id=199803

  Reported-by: Jann Horn <jannh@google.com>
  Reviewed-by: Andreas Dilger <adilger@dilger.ca>
  Signed-off-by: Theodore Ts'o <tytso@mit.edu>
  Fixes: e50e5129f384 ("ext4: xattr-in-inode support")
  Cc: stable@kernel.org
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: eb9b5f01c33adebc31cbc236c02695f605b0e417
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 117166efb1ee8f13c38f9e96b258f16d4923f888
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/117166efb1ee8f13c38f9e96b258f16d4923f888
    reference_type: commit
    reference_id: 117166efb1ee8f13c38f9e96b258f16d4923f888
  - url: https://github.com/torvalds/linux/tree/eb9b5f01c33adebc31cbc236c02695f605b0e417
    reference_type: commit
    reference_id: eb9b5f01c33adebc31cbc236c02695f605b0e417
