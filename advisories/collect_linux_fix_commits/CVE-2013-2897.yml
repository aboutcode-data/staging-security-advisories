advisory_id: CVE-2013-2897
datasource_id: collect_linux_fix_commits/CVE-2013-2897
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  84fca9f38c5d646e95cdeef70e41cf15db549b95:Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/hid

  Pull HID updates from Jiri Kosina:
   "Fixes for CVE-2013-2897, CVE-2013-2895, CVE-2013-2897, CVE-2013-2894,
    CVE-2013-2893, CVE-2013-2891, CVE-2013-2890, CVE-2013-2889.

    All the bugs are triggerable only by specially crafted evil-on-purpose
    HW devices.  Fixes by Kees Cook and Benjamin Tissoires"

  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/hid:
    HID: lenovo-tpkbd: fix leak if tpkbd_probe_tp fails
    HID: multitouch: validate indexes details
    HID: logitech-dj: validate output report details
    HID: validate feature and input report details
    HID: lenovo-tpkbd: validate output report details
    HID: LG: validate HID output report details
    HID: steelseries: validate output report details
    HID: sony: validate HID output report details
    HID: zeroplus: validate output report details
    HID: provide a helper for validating hid reports
  84fca9f38c5d646e95cdeef70e41cf15db549b95:Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/hid

  Pull HID updates from Jiri Kosina:
   "Fixes for CVE-2013-2897, CVE-2013-2895, CVE-2013-2897, CVE-2013-2894,
    CVE-2013-2893, CVE-2013-2891, CVE-2013-2890, CVE-2013-2889.

    All the bugs are triggerable only by specially crafted evil-on-purpose
    HW devices.  Fixes by Kees Cook and Benjamin Tissoires"

  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/hid:
    HID: lenovo-tpkbd: fix leak if tpkbd_probe_tp fails
    HID: multitouch: validate indexes details
    HID: logitech-dj: validate output report details
    HID: validate feature and input report details
    HID: lenovo-tpkbd: validate output report details
    HID: LG: validate HID output report details
    HID: steelseries: validate output report details
    HID: sony: validate HID output report details
    HID: zeroplus: validate output report details
    HID: provide a helper for validating hid reports
  8821f5dc187bdf16cfb32ef5aa8c3035273fa79a:HID: multitouch: validate indexes details

  When working on report indexes, always validate that they are in bounds.
  Without this, a HID device could report a malicious feature report that
  could trick the driver into a heap overflow:

  [  634.885003] usb 1-1: New USB device found, idVendor=0596, idProduct=0500
  ...
  [  676.469629] BUG kmalloc-192 (Tainted: G        W   ): Redzone overwritten

  Note that we need to change the indexes from s8 to s16 as they can
  be between -1 and 255.

  CVE-2013-2897

  Cc: stable@vger.kernel.org
  Signed-off-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>
  Acked-by: Kees Cook <keescook@chromium.org>
  Signed-off-by: Jiri Kosina <jkosina@suse.cz>
  cc6b54aa54bf40b762cab45a9fc8aa81653146eb:HID: validate feature and input report details

  When dealing with usage_index, be sure to properly use unsigned instead of
  int to avoid overflows.

  When working on report fields, always validate that their report_counts are
  in bounds.
  Without this, a HID device could report a malicious feature report that
  could trick the driver into a heap overflow:

  [  634.885003] usb 1-1: New USB device found, idVendor=0596, idProduct=0500
  ...
  [  676.469629] BUG kmalloc-192 (Tainted: G        W   ): Redzone overwritten

  CVE-2013-2897

  Cc: stable@vger.kernel.org
  Signed-off-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>
  Acked-by: Kees Cook <keescook@chromium.org>
  Signed-off-by: Jiri Kosina <jkosina@suse.cz>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 84fca9f38c5d646e95cdeef70e41cf15db549b95
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 8821f5dc187bdf16cfb32ef5aa8c3035273fa79a
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: cc6b54aa54bf40b762cab45a9fc8aa81653146eb
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/84fca9f38c5d646e95cdeef70e41cf15db549b95
    reference_type: commit
    reference_id: 84fca9f38c5d646e95cdeef70e41cf15db549b95
  - url: https://github.com/torvalds/linux/tree/8821f5dc187bdf16cfb32ef5aa8c3035273fa79a
    reference_type: commit
    reference_id: 8821f5dc187bdf16cfb32ef5aa8c3035273fa79a
  - url: https://github.com/torvalds/linux/tree/cc6b54aa54bf40b762cab45a9fc8aa81653146eb
    reference_type: commit
    reference_id: cc6b54aa54bf40b762cab45a9fc8aa81653146eb
