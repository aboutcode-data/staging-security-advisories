advisory_id: CVE-2017-8824
datasource_id: collect_linux_fix_commits/CVE-2017-8824
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  67f93df79aeefc3add4e4b31a752600f834236e2:dccp: check sk for closed state in dccp_sendmsg()

  dccp_disconnect() sets 'dp->dccps_hc_tx_ccid' tx handler to NULL,
  therefore if DCCP socket is disconnected and dccp_sendmsg() is
  called after it, it will cause a NULL pointer dereference in
  dccp_write_xmit().

  This crash and the reproducer was reported by syzbot. Looks like
  it is reproduced if commit 69c64866ce07 ("dccp: CVE-2017-8824:
  use-after-free in DCCP code") is applied.

  Reported-by: syzbot+f99ab3887ab65d70f816@syzkaller.appspotmail.com
  Signed-off-by: Alexey Kodanev <alexey.kodanev@oracle.com>
  Signed-off-by: David S. Miller <davem@davemloft.net>
  69c64866ce072dea1d1e59a0d61e0f66c0dffb76:dccp: CVE-2017-8824: use-after-free in DCCP code

  Whenever the sock object is in DCCP_CLOSED state,
  dccp_disconnect() must free dccps_hc_tx_ccid and
  dccps_hc_rx_ccid and set to NULL.

  Signed-off-by: Mohamed Ghannam <simo.ghannam@gmail.com>
  Reviewed-by: Eric Dumazet <edumazet@google.com>
  Signed-off-by: David S. Miller <davem@davemloft.net>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 69c64866ce072dea1d1e59a0d61e0f66c0dffb76
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 67f93df79aeefc3add4e4b31a752600f834236e2
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/67f93df79aeefc3add4e4b31a752600f834236e2
    reference_type: commit
    reference_id: 67f93df79aeefc3add4e4b31a752600f834236e2
  - url: https://github.com/torvalds/linux/tree/69c64866ce072dea1d1e59a0d61e0f66c0dffb76
    reference_type: commit
    reference_id: 69c64866ce072dea1d1e59a0d61e0f66c0dffb76
