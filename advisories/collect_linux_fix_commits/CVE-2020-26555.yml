advisory_id: CVE-2020-26555
datasource_id: collect_linux_fix_commits/CVE-2020-26555
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  1ffc6f8cc33268731fcf9629fc4438f6db1191fc:Bluetooth: Reject connection with the device which has same BD_ADDR

  This change is used to relieve CVE-2020-26555. The description of
  the CVE:

  Bluetooth legacy BR/EDR PIN code pairing in Bluetooth Core Specification
  1.0B through 5.2 may permit an unauthenticated nearby device to spoof
  the BD_ADDR of the peer device to complete pairing without knowledge
  of the PIN. [1]

  The detail of this attack is in IEEE paper:
  BlueMirror: Reflections on Bluetooth Pairing and Provisioning Protocols
  [2]

  It's a reflection attack. The paper mentioned that attacker can induce
  the attacked target to generate null link key (zero key) without PIN
  code. In BR/EDR, the key generation is actually handled in the controller
  which is below HCI.

  A condition of this attack is that attacker should change the
  BR_ADDR of his hacking device (Host B) to equal to the BR_ADDR with
  the target device being attacked (Host A).

  Thus, we reject the connection with device which has same BD_ADDR
  both on HCI_Create_Connection and HCI_Connection_Request to prevent
  the attack. A similar implementation also shows in btstack project.
  [3][4]

  Cc: stable@vger.kernel.org
  Link: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26555 [1]
  Link: https://ieeexplore.ieee.org/abstract/document/9474325/authors#authors [2]
  Link: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L3523 [3]
  Link: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L7297 [4]
  Signed-off-by: Lee, Chun-Yi <jlee@suse.com>
  Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
  1ffc6f8cc33268731fcf9629fc4438f6db1191fc:Bluetooth: Reject connection with the device which has same BD_ADDR

  This change is used to relieve CVE-2020-26555. The description of
  the CVE:

  Bluetooth legacy BR/EDR PIN code pairing in Bluetooth Core Specification
  1.0B through 5.2 may permit an unauthenticated nearby device to spoof
  the BD_ADDR of the peer device to complete pairing without knowledge
  of the PIN. [1]

  The detail of this attack is in IEEE paper:
  BlueMirror: Reflections on Bluetooth Pairing and Provisioning Protocols
  [2]

  It's a reflection attack. The paper mentioned that attacker can induce
  the attacked target to generate null link key (zero key) without PIN
  code. In BR/EDR, the key generation is actually handled in the controller
  which is below HCI.

  A condition of this attack is that attacker should change the
  BR_ADDR of his hacking device (Host B) to equal to the BR_ADDR with
  the target device being attacked (Host A).

  Thus, we reject the connection with device which has same BD_ADDR
  both on HCI_Create_Connection and HCI_Connection_Request to prevent
  the attack. A similar implementation also shows in btstack project.
  [3][4]

  Cc: stable@vger.kernel.org
  Link: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26555 [1]
  Link: https://ieeexplore.ieee.org/abstract/document/9474325/authors#authors [2]
  Link: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L3523 [3]
  Link: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L7297 [4]
  Signed-off-by: Lee, Chun-Yi <jlee@suse.com>
  Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
  33155c4aae5260475def6f7438e4e35564f4f3ba:Bluetooth: hci_event: Ignore NULL link key

  This change is used to relieve CVE-2020-26555. The description of the
  CVE:

  Bluetooth legacy BR/EDR PIN code pairing in Bluetooth Core Specification
  1.0B through 5.2 may permit an unauthenticated nearby device to spoof
  the BD_ADDR of the peer device to complete pairing without knowledge
  of the PIN. [1]

  The detail of this attack is in IEEE paper:
  BlueMirror: Reflections on Bluetooth Pairing and Provisioning Protocols
  [2]

  It's a reflection attack. The paper mentioned that attacker can induce
  the attacked target to generate null link key (zero key) without PIN
  code. In BR/EDR, the key generation is actually handled in the controller
  which is below HCI.

  Thus, we can ignore null link key in the handler of "Link Key Notification
  event" to relieve the attack. A similar implementation also shows in
  btstack project. [3]

  v3: Drop the connection when null link key be detected.

  v2:
  - Used Link: tag instead of Closes:
  - Used bt_dev_dbg instead of BT_DBG
  - Added Fixes: tag

  Cc: stable@vger.kernel.org
  Fixes: 55ed8ca10f35 ("Bluetooth: Implement link key handling for the management interface")
  Link: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26555 [1]
  Link: https://ieeexplore.ieee.org/abstract/document/9474325/authors#authors [2]
  Link: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L3722 [3]
  Signed-off-by: Lee, Chun-Yi <jlee@suse.com>
  Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
  33155c4aae5260475def6f7438e4e35564f4f3ba:Bluetooth: hci_event: Ignore NULL link key

  This change is used to relieve CVE-2020-26555. The description of the
  CVE:

  Bluetooth legacy BR/EDR PIN code pairing in Bluetooth Core Specification
  1.0B through 5.2 may permit an unauthenticated nearby device to spoof
  the BD_ADDR of the peer device to complete pairing without knowledge
  of the PIN. [1]

  The detail of this attack is in IEEE paper:
  BlueMirror: Reflections on Bluetooth Pairing and Provisioning Protocols
  [2]

  It's a reflection attack. The paper mentioned that attacker can induce
  the attacked target to generate null link key (zero key) without PIN
  code. In BR/EDR, the key generation is actually handled in the controller
  which is below HCI.

  Thus, we can ignore null link key in the handler of "Link Key Notification
  event" to relieve the attack. A similar implementation also shows in
  btstack project. [3]

  v3: Drop the connection when null link key be detected.

  v2:
  - Used Link: tag instead of Closes:
  - Used bt_dev_dbg instead of BT_DBG
  - Added Fixes: tag

  Cc: stable@vger.kernel.org
  Fixes: 55ed8ca10f35 ("Bluetooth: Implement link key handling for the management interface")
  Link: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26555 [1]
  Link: https://ieeexplore.ieee.org/abstract/document/9474325/authors#authors [2]
  Link: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L3722 [3]
  Signed-off-by: Lee, Chun-Yi <jlee@suse.com>
  Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 33155c4aae5260475def6f7438e4e35564f4f3ba
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 1ffc6f8cc33268731fcf9629fc4438f6db1191fc
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/1ffc6f8cc33268731fcf9629fc4438f6db1191fc
    reference_type: commit
    reference_id: 1ffc6f8cc33268731fcf9629fc4438f6db1191fc
  - url: https://github.com/torvalds/linux/tree/33155c4aae5260475def6f7438e4e35564f4f3ba
    reference_type: commit
    reference_id: 33155c4aae5260475def6f7438e4e35564f4f3ba
