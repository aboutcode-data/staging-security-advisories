advisory_id: CVE-2023-34319
datasource_id: collect_linux_fix_commits/CVE-2023-34319
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  534fc31d09b706a16d83533e16b5dc855caf7576:xen/netback: Fix buffer overrun triggered by unusual packet

  It is possible that a guest can send a packet that contains a head + 18
  slots and yet has a len <= XEN_NETBACK_TX_COPY_LEN. This causes nr_slots
  to underflow in xenvif_get_requests() which then causes the subsequent
  loop's termination condition to be wrong, causing a buffer overrun of
  queue->tx_map_ops.

  Rework the code to account for the extra frag_overflow slots.

  This is CVE-2023-34319 / XSA-432.

  Fixes: ad7f402ae4f4 ("xen/netback: Ensure protocol headers don't fall in the non-linear area")
  Signed-off-by: Ross Lagerwall <ross.lagerwall@citrix.com>
  Reviewed-by: Paul Durrant <paul@xen.org>
  Reviewed-by: Wei Liu <wei.liu@kernel.org>
  Signed-off-by: Juergen Gross <jgross@suse.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 534fc31d09b706a16d83533e16b5dc855caf7576
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/534fc31d09b706a16d83533e16b5dc855caf7576
    reference_type: commit
    reference_id: 534fc31d09b706a16d83533e16b5dc855caf7576
