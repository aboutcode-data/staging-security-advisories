advisory_id: CVE-2010-3698
datasource_id: collect_linux_fix_commits/CVE-2010-3698
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  9581d442b9058d3699b4be568b6e5eae38a41493:KVM: Fix fs/gs reload oops with invalid ldt

  kvm reloads the host's fs and gs blindly, however the underlying segment
  descriptors may be invalid due to the user modifying the ldt after loading
  them.

  Fix by using the safe accessors (loadsegment() and load_gs_index()) instead
  of home grown unsafe versions.

  This is CVE-2010-3698.

  KVM-Stable-Tag.
  Signed-off-by: Avi Kivity <avi@redhat.com>
  Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 9581d442b9058d3699b4be568b6e5eae38a41493
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/9581d442b9058d3699b4be568b6e5eae38a41493
    reference_type: commit
    reference_id: 9581d442b9058d3699b4be568b6e5eae38a41493
