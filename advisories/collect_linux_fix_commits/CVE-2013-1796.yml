advisory_id: CVE-2013-1796
datasource_id: collect_linux_fix_commits/CVE-2013-1796
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  2ae33b389601b86a3d0cfe2d09f5e3189d5322fd:Merge remote-tracking branch 'upstream/master' into queue

  Merge reason:

  From: Alexander Graf <agraf@suse.de>

  "Just recently this really important patch got pulled into Linus' tree for 3.9:

  commit 1674400aaee5b466c595a8fc310488263ce888c7
  Author: Anton Blanchard <anton <at> samba.org>
  Date:   Tue Mar 12 01:51:51 2013 +0000

  Without that commit, I can not boot my G5, thus I can't run automated tests on it against my queue.

  Could you please merge kvm/next against linus/master, so that I can base my trees against that?"

  * upstream/master: (653 commits)
    PCI: Use ROM images from firmware only if no other ROM source available
    sparc: remove unused "config BITS"
    sparc: delete "if !ULTRA_HAS_POPULATION_COUNT"
    KVM: Fix bounds checking in ioapic indirect register reads (CVE-2013-1798)
    KVM: x86: Convert MSR_KVM_SYSTEM_TIME to use gfn_to_hva_cache functions (CVE-2013-1797)
    KVM: x86: fix for buffer overflow in handling of MSR_KVM_SYSTEM_TIME (CVE-2013-1796)
    arm64: Kconfig.debug: Remove unused CONFIG_DEBUG_ERRORS
    arm64: Do not select GENERIC_HARDIRQS_NO_DEPRECATED
    inet: limit length of fragment queue hash table bucket lists
    qeth: Fix scatter-gather regression
    qeth: Fix invalid router settings handling
    qeth: delay feature trace
    sgy-cts1000: Remove __dev* attributes
    KVM: x86: fix deadlock in clock-in-progress request handling
    KVM: allow host header to be included even for !CONFIG_KVM
    hwmon: (lm75) Fix tcn75 prefix
    hwmon: (lm75.h) Update header inclusion
    MAINTAINERS: Remove Mark M. Hoffman
    xfs: ensure we capture IO errors correctly
    xfs: fix xfs_iomap_eof_prealloc_initial_size type
    ...

  Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
  ea4a0ce11160200410abbabd44ec9e75e93a95be:Merge git://git.kernel.org/pub/scm/virt/kvm/kvm

  Pull kvm fixes from Marcelo Tosatti.

  * git://git.kernel.org/pub/scm/virt/kvm/kvm:
    KVM: Fix bounds checking in ioapic indirect register reads (CVE-2013-1798)
    KVM: x86: Convert MSR_KVM_SYSTEM_TIME to use gfn_to_hva_cache functions (CVE-2013-1797)
    KVM: x86: fix for buffer overflow in handling of MSR_KVM_SYSTEM_TIME (CVE-2013-1796)
    KVM: x86: fix deadlock in clock-in-progress request handling
    KVM: allow host header to be included even for !CONFIG_KVM
  c300aa64ddf57d9c5d9c898a64b36877345dd4a9:KVM: x86: fix for buffer overflow in handling of MSR_KVM_SYSTEM_TIME (CVE-2013-1796)

  If the guest sets the GPA of the time_page so that the request to update the
  time straddles a page then KVM will write onto an incorrect page.  The
  write is done byusing kmap atomic to get a pointer to the page for the time
  structure and then performing a memcpy to that page starting at an offset
  that the guest controls.  Well behaved guests always provide a 32-byte aligned
  address, however a malicious guest could use this to corrupt host kernel
  memory.

  Tested: Tested against kvmclock unit test.

  Signed-off-by: Andrew Honig <ahonig@google.com>
  Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: ea4a0ce11160200410abbabd44ec9e75e93a95be
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 2ae33b389601b86a3d0cfe2d09f5e3189d5322fd
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: c300aa64ddf57d9c5d9c898a64b36877345dd4a9
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/2ae33b389601b86a3d0cfe2d09f5e3189d5322fd
    reference_type: commit
    reference_id: 2ae33b389601b86a3d0cfe2d09f5e3189d5322fd
  - url: https://github.com/torvalds/linux/tree/c300aa64ddf57d9c5d9c898a64b36877345dd4a9
    reference_type: commit
    reference_id: c300aa64ddf57d9c5d9c898a64b36877345dd4a9
  - url: https://github.com/torvalds/linux/tree/ea4a0ce11160200410abbabd44ec9e75e93a95be
    reference_type: commit
    reference_id: ea4a0ce11160200410abbabd44ec9e75e93a95be
