advisory_id: CVE-2023-6238
datasource_id: collect_linux_fix_commits/CVE-2023-6238
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  6fad84a4d624c300d03ebba457cc641765050c43:nvme-pci: use sgls for all user requests if possible

  If the device supports SGLs, use these for all user requests. This
  format encodes the expected transfer length so it can catch short buffer
  errors in a user command, whether it occurred accidently or maliciously.

  For controllers that support SGL data mode, this is a viable mitigation
  to CVE-2023-6238. For controllers that don't support SGLs, log a warning
  in the passthrough path since not having the capability can corrupt
  data if the interface is not used correctly.

  Reviewed-by: Christoph Hellwig <hch@lst.de>
  Signed-off-by: Keith Busch <kbusch@kernel.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 6fad84a4d624c300d03ebba457cc641765050c43
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/6fad84a4d624c300d03ebba457cc641765050c43
    reference_type: commit
    reference_id: 6fad84a4d624c300d03ebba457cc641765050c43
