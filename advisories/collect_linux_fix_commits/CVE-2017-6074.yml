advisory_id: CVE-2017-6074
datasource_id: collect_linux_fix_commits/CVE-2017-6074
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  d9ea761fdd197351890418acd462c51f241014a7:dccp: don't duplicate ccid when cloning dccp sock

  Commit 2677d2067731 ("dccp: don't free ccid2_hc_tx_sock ...") fixed
  a UAF but reintroduced CVE-2017-6074.

  When the sock is cloned, two dccps_hc_tx_ccid will reference to the
  same ccid. So one can free the ccid object twice from two socks after
  cloning.

  This issue was found by "Hadar Manor" as well and assigned with
  CVE-2020-16119, which was fixed in Ubuntu's kernel. So here I port
  the patch from Ubuntu to fix it.

  The patch prevents cloned socks from referencing the same ccid.

  Fixes: 2677d2067731410 ("dccp: don't free ccid2_hc_tx_sock ...")
  Signed-off-by: Zhenpeng Lin <zplin@psu.edu>
  Signed-off-by: David S. Miller <davem@davemloft.net>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: d9ea761fdd197351890418acd462c51f241014a7
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/d9ea761fdd197351890418acd462c51f241014a7
    reference_type: commit
    reference_id: d9ea761fdd197351890418acd462c51f241014a7
