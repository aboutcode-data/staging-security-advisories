advisory_id: CVE-2019-3819
datasource_id: collect_linux_fix_commits/CVE-2019-3819
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  d47e3da1759230e394096fd742aad423c291ba48:Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/hid/hid

  Pull HID fix from Jiri Kosina:
   "A fix for a bug in hid-debug that can lock up the kernel in infinite
    loop (CVE-2019-3819), from Vladis Dronov"

  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/hid/hid:
    HID: debug: fix the ring buffer implementation
  13054abbaa4f1fd4e6f3b4b63439ec033b4c8035:HID: debug: fix the ring buffer implementation

  Ring buffer implementation in hid_debug_event() and hid_debug_events_read()
  is strange allowing lost or corrupted data. After commit 717adfdaf147
  ("HID: debug: check length before copy_to_user()") it is possible to enter
  an infinite loop in hid_debug_events_read() by providing 0 as count, this
  locks up a system. Fix this by rewriting the ring buffer implementation
  with kfifo and simplify the code.

  This fixes CVE-2019-3819.

  v2: fix an execution logic and add a comment
  v3: use __set_current_state() instead of set_current_state()

  Link: https://bugzilla.redhat.com/show_bug.cgi?id=1669187
  Cc: stable@vger.kernel.org # v4.18+
  Fixes: cd667ce24796 ("HID: use debugfs for events/reports dumping")
  Fixes: 717adfdaf147 ("HID: debug: check length before copy_to_user()")
  Signed-off-by: Vladis Dronov <vdronov@redhat.com>
  Reviewed-by: Oleg Nesterov <oleg@redhat.com>
  Signed-off-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: d47e3da1759230e394096fd742aad423c291ba48
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 13054abbaa4f1fd4e6f3b4b63439ec033b4c8035
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/13054abbaa4f1fd4e6f3b4b63439ec033b4c8035
    reference_type: commit
    reference_id: 13054abbaa4f1fd4e6f3b4b63439ec033b4c8035
  - url: https://github.com/torvalds/linux/tree/d47e3da1759230e394096fd742aad423c291ba48
    reference_type: commit
    reference_id: d47e3da1759230e394096fd742aad423c291ba48
