advisory_id: CVE-2018-1095
datasource_id: collect_linux_fix_commits/CVE-2018-1095
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  ce3fd194fcc6fbdc00ce095a852f22df97baa401:ext4: limit xattr size to INT_MAX

  ext4 isn't validating the sizes of xattrs where the value of the xattr
  is stored in an external inode.  This is problematic because
  ->e_value_size is a u32, but ext4_xattr_get() returns an int.  A very
  large size is misinterpreted as an error code, which ext4_get_acl()
  translates into a bogus ERR_PTR() for which IS_ERR() returns false,
  causing a crash.

  Fix this by validating that all xattrs are <= INT_MAX bytes.

  This issue has been assigned CVE-2018-1095.

  https://bugzilla.kernel.org/show_bug.cgi?id=199185
  https://bugzilla.redhat.com/show_bug.cgi?id=1560793

  Reported-by: Wen Xu <wen.xu@gatech.edu>
  Signed-off-by: Eric Biggers <ebiggers@google.com>
  Signed-off-by: Theodore Ts'o <tytso@mit.edu>
  Cc: stable@vger.kernel.org
  Fixes: e50e5129f384 ("ext4: xattr-in-inode support")
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: ce3fd194fcc6fbdc00ce095a852f22df97baa401
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/ce3fd194fcc6fbdc00ce095a852f22df97baa401
    reference_type: commit
    reference_id: ce3fd194fcc6fbdc00ce095a852f22df97baa401
