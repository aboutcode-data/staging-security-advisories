advisory_id: CVE-2011-1019
datasource_id: collect_linux_fix_commits/CVE-2011-1019
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "8909c9ad8ff03611c9c96c9a92656213e4bb495b:net: don't allow CAP_NET_ADMIN to load non-netdev\
  \ kernel modules\n\nSince a8f80e8ff94ecba629542d9b4b5f5a8ee3eb565c any process with\nCAP_NET_ADMIN\
  \ may load any module from /lib/modules/.  This doesn't mean\nthat CAP_NET_ADMIN is a superset\
  \ of CAP_SYS_MODULE as modules are\nlimited to /lib/modules/**.  However, CAP_NET_ADMIN capability\
  \ shouldn't\nallow anybody load any module not related to networking.\n\nThis patch restricts\
  \ an ability of autoloading modules to netdev modules\nwith explicit aliases.  This fixes\
  \ CVE-2011-1019.\n\nArnd Bergmann suggested to leave untouched the old pre-v2.6.32 behavior\n\
  of loading netdev modules by name (without any prefix) for processes\nwith CAP_SYS_MODULE\
  \ to maintain the compatibility with network scripts\nthat use autoloading netdev modules\
  \ by aliases like \"eth0\", \"wlan0\".\n\nCurrently there are only three users of the feature\
  \ in the upstream\nkernel: ipip, ip_gre and sit.\n\n    root@albatros:~# capsh --drop=$(seq\
  \ -s, 0 11),$(seq -s, 13 34) --\n    root@albatros:~# grep Cap /proc/$$/status\n    CapInh:\t\
  0000000000000000\n    CapPrm:\tfffffff800001000\n    CapEff:\tfffffff800001000\n    CapBnd:\t\
  fffffff800001000\n    root@albatros:~# modprobe xfs\n    FATAL: Error inserting xfs\n    (/lib/modules/2.6.38-rc6-00001-g2bf4ca3/kernel/fs/xfs/xfs.ko):\
  \ Operation not permitted\n    root@albatros:~# lsmod | grep xfs\n    root@albatros:~# ifconfig\
  \ xfs\n    xfs: error fetching interface information: Device not found\n    root@albatros:~#\
  \ lsmod | grep xfs\n    root@albatros:~# lsmod | grep sit\n    root@albatros:~# ifconfig sit\n\
  \    sit: error fetching interface information: Device not found\n    root@albatros:~# lsmod\
  \ | grep sit\n    root@albatros:~# ifconfig sit0\n    sit0      Link encap:IPv6-in-IPv4\n\t\
  \      NOARP  MTU:1480  Metric:1\n\n    root@albatros:~# lsmod | grep sit\n    sit       \
  \             10457  0\n    tunnel4                 2957  1 sit\n\nFor CAP_SYS_MODULE module\
  \ loading is still relaxed:\n\n    root@albatros:~# grep Cap /proc/$$/status\n    CapInh:\t\
  0000000000000000\n    CapPrm:\tffffffffffffffff\n    CapEff:\tffffffffffffffff\n    CapBnd:\t\
  ffffffffffffffff\n    root@albatros:~# ifconfig xfs\n    xfs: error fetching interface information:\
  \ Device not found\n    root@albatros:~# lsmod | grep xfs\n    xfs                   745319\
  \  0\n\nReference: https://lkml.org/lkml/2011/2/24/203\n\nSigned-off-by: Vasiliy Kulikov <segoon@openwall.com>\n\
  Signed-off-by: Michael Tokarev <mjt@tls.msk.ru>\nAcked-by: David S. Miller <davem@davemloft.net>\n\
  Acked-by: Kees Cook <kees.cook@canonical.com>\nSigned-off-by: James Morris <jmorris@namei.org>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 8909c9ad8ff03611c9c96c9a92656213e4bb495b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/8909c9ad8ff03611c9c96c9a92656213e4bb495b
    reference_type: commit
    reference_id: 8909c9ad8ff03611c9c96c9a92656213e4bb495b
