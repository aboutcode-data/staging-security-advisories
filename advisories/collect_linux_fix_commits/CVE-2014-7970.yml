advisory_id: CVE-2014-7970
datasource_id: collect_linux_fix_commits/CVE-2014-7970
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  ce9d7f7b45930ed16c512aabcfe651d44f1c8619:Merge branch 'CVE-2014-7970' of git://git.kernel.org/pub/scm/linux/kernel/git/luto/linux

  Pull pivot_root() fix from Andy Lutomirski.

  Prevent a leak of unreachable mounts.

  * 'CVE-2014-7970' of git://git.kernel.org/pub/scm/linux/kernel/git/luto/linux:
    mnt: Prevent pivot_root from creating a loop in the mount tree
  ce9d7f7b45930ed16c512aabcfe651d44f1c8619:Merge branch 'CVE-2014-7970' of git://git.kernel.org/pub/scm/linux/kernel/git/luto/linux

  Pull pivot_root() fix from Andy Lutomirski.

  Prevent a leak of unreachable mounts.

  * 'CVE-2014-7970' of git://git.kernel.org/pub/scm/linux/kernel/git/luto/linux:
    mnt: Prevent pivot_root from creating a loop in the mount tree
  0d0826019e529f21c84687521d03f60cd241ca7d:mnt: Prevent pivot_root from creating a loop in the mount tree

  Andy Lutomirski recently demonstrated that when chroot is used to set
  the root path below the path for the new ``root'' passed to pivot_root
  the pivot_root system call succeeds and leaks mounts.

  In examining the code I see that starting with a new root that is
  below the current root in the mount tree will result in a loop in the
  mount tree after the mounts are detached and then reattached to one
  another.  Resulting in all kinds of ugliness including a leak of that
  mounts involved in the leak of the mount loop.

  Prevent this problem by ensuring that the new mount is reachable from
  the current root of the mount tree.

  [Added stable cc.  Fixes CVE-2014-7970.  --Andy]

  Cc: stable@vger.kernel.org
  Reported-by: Andy Lutomirski <luto@amacapital.net>
  Reviewed-by: Andy Lutomirski <luto@amacapital.net>
  Link: http://lkml.kernel.org/r/87bnpmihks.fsf@x220.int.ebiederm.org
  Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>
  Signed-off-by: Andy Lutomirski <luto@amacapital.net>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: ce9d7f7b45930ed16c512aabcfe651d44f1c8619
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 0d0826019e529f21c84687521d03f60cd241ca7d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/0d0826019e529f21c84687521d03f60cd241ca7d
    reference_type: commit
    reference_id: 0d0826019e529f21c84687521d03f60cd241ca7d
  - url: https://github.com/torvalds/linux/tree/ce9d7f7b45930ed16c512aabcfe651d44f1c8619
    reference_type: commit
    reference_id: ce9d7f7b45930ed16c512aabcfe651d44f1c8619
