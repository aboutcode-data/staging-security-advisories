advisory_id: CVE-2017-7472
datasource_id: collect_linux_fix_commits/CVE-2017-7472
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "f205b5dc1c9e62237ac6e21642724d8cbc85f7ee:Merge tag 'keys-fixes-20170419' of git://git.kernel.org/pub/scm/linux/kernel/git/dhowells/linux-fs\n\
  \nPull keyrings fixes from David Howells:\n\n (1) Disallow keyrings whose name begins with\
  \ a '.' to be joined\n     [CVE-2016-9604].\n\n (2) Change the name of the dead type to \"\
  .dead\" to prevent user access\n     [CVE-2017-6951].\n\n (3) Fix keyctl_set_reqkey_keyring()\
  \ to not leak thread keyrings\n     [CVE-2017-7472]\n\n* tag 'keys-fixes-20170419' of git://git.kernel.org/pub/scm/linux/kernel/git/dhowells/linux-fs:\n\
  \  KEYS: fix keyctl_set_reqkey_keyring() to not leak thread keyrings\n  KEYS: Change the name\
  \ of the dead type to \".dead\" to prevent user access\n  KEYS: Disallow keyrings beginning\
  \ with '.' to be joined as session keyrings\nc9f838d104fed6f2f61d68164712e3204bf5271b:KEYS:\
  \ fix keyctl_set_reqkey_keyring() to not leak thread keyrings\n\nThis fixes CVE-2017-7472.\n\
  \nRunning the following program as an unprivileged user exhausts kernel\nmemory by leaking\
  \ thread keyrings:\n\n\t#include <keyutils.h>\n\n\tint main()\n\t{\n\t\tfor (;;)\n\t\t\tkeyctl_set_reqkey_keyring(KEY_REQKEY_DEFL_THREAD_KEYRING);\n\
  \t}\n\nFix it by only creating a new thread keyring if there wasn't one before.\nTo make things\
  \ more consistent, make install_thread_keyring_to_cred()\nand install_process_keyring_to_cred()\
  \ both return 0 if the corresponding\nkeyring is already present.\n\nFixes: d84f4f992cbd (\"\
  CRED: Inaugurate COW credentials\")\nCc: stable@vger.kernel.org # 2.6.29+\nSigned-off-by:\
  \ Eric Biggers <ebiggers@google.com>\nSigned-off-by: David Howells <dhowells@redhat.com>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: c9f838d104fed6f2f61d68164712e3204bf5271b
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: f205b5dc1c9e62237ac6e21642724d8cbc85f7ee
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/c9f838d104fed6f2f61d68164712e3204bf5271b
    reference_type: commit
    reference_id: c9f838d104fed6f2f61d68164712e3204bf5271b
  - url: https://github.com/torvalds/linux/tree/f205b5dc1c9e62237ac6e21642724d8cbc85f7ee
    reference_type: commit
    reference_id: f205b5dc1c9e62237ac6e21642724d8cbc85f7ee
