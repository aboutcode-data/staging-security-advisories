advisory_id: CVE-2016-8630
datasource_id: collect_linux_fix_commits/CVE-2016-8630
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  66cecb67894b35c6af17eb4e6b6aaec6c8957c2e:Merge tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm

  Pull KVM updates from Paolo Bonzini:
   "One NULL pointer dereference, and two fixes for regressions introduced
    during the merge window.

    The rest are fixes for MIPS, s390 and nested VMX"

  * tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm:
    kvm: x86: Check memopp before dereference (CVE-2016-8630)
    kvm: nVMX: VMCLEAR an active shadow VMCS after last use
    KVM: x86: drop TSC offsetting kvm_x86_ops to fix KVM_GET/SET_CLOCK
    KVM: x86: fix wbinvd_dirty_mask use-after-free
    kvm/x86: Show WRMSR data is in hex
    kvm: nVMX: Fix kernel panics induced by illegal INVEPT/INVVPID types
    KVM: document lock orders
    KVM: fix OOPS on flush_work
    KVM: s390: Fix STHYI buffer alignment for diag224
    KVM: MIPS: Precalculate MMIO load resume PC
    KVM: MIPS: Make ERET handle ERL before EXL
    KVM: MIPS: Fix lazy user ASID regenerate for SMP
  d9092f52d7e61dd1557f2db2400ddb430e85937e:kvm: x86: Check memopp before dereference (CVE-2016-8630)

  Commit 41061cdb98 ("KVM: emulate: do not initialize memopp") removes a
  check for non-NULL under incorrect assumptions. An undefined instruction
  with a ModR/M byte with Mod=0 and R/M-5 (e.g. 0xc7 0x15) will attempt
  to dereference a null pointer here.

  Fixes: 41061cdb98a0bec464278b4db8e894a3121671f5
  Message-Id: <1477592752-126650-2-git-send-email-osh@google.com>
  Signed-off-by: Owen Hofmann <osh@google.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 66cecb67894b35c6af17eb4e6b6aaec6c8957c2e
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: d9092f52d7e61dd1557f2db2400ddb430e85937e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/66cecb67894b35c6af17eb4e6b6aaec6c8957c2e
    reference_type: commit
    reference_id: 66cecb67894b35c6af17eb4e6b6aaec6c8957c2e
  - url: https://github.com/torvalds/linux/tree/d9092f52d7e61dd1557f2db2400ddb430e85937e
    reference_type: commit
    reference_id: d9092f52d7e61dd1557f2db2400ddb430e85937e
