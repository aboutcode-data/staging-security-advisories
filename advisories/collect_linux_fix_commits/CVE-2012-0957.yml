advisory_id: CVE-2012-0957
datasource_id: collect_linux_fix_commits/CVE-2012-0957
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  2702b1526c7278c4d65d78de209a465d4de2885e:kernel/sys.c: fix stack memory content leak via UNAME26

  Calling uname() with the UNAME26 personality set allows a leak of kernel
  stack contents.  This fixes it by defensively calculating the length of
  copy_to_user() call, making the len argument unsigned, and initializing
  the stack buffer to zero (now technically unneeded, but hey, overkill).

  CVE-2012-0957

  Reported-by: PaX Team <pageexec@freemail.hu>
  Signed-off-by: Kees Cook <keescook@chromium.org>
  Cc: Andi Kleen <ak@linux.intel.com>
  Cc: PaX Team <pageexec@freemail.hu>
  Cc: Brad Spengler <spender@grsecurity.net>
  Cc: <stable@vger.kernel.org>
  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 2702b1526c7278c4d65d78de209a465d4de2885e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/2702b1526c7278c4d65d78de209a465d4de2885e
    reference_type: commit
    reference_id: 2702b1526c7278c4d65d78de209a465d4de2885e
