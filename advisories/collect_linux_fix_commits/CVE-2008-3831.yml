advisory_id: CVE-2008-3831
datasource_id: collect_linux_fix_commits/CVE-2008-3831
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  f7ea4a4ba84f382e8eb143e435551de0feee5b4b:Merge branch 'drm-next' of git://git.kernel.org/pub/scm/linux/kernel/git/airlied/drm-2.6

  * 'drm-next' of git://git.kernel.org/pub/scm/linux/kernel/git/airlied/drm-2.6: (44 commits)
    drm/i915: fix ioremap of a user address for non-root (CVE-2008-3831)
    drm: make CONFIG_DRM depend on CONFIG_SHMEM.
    radeon: fix PCI bus mastering support enables.
    radeon: add RS400 family support.
    drm/radeon: add support for RS740 IGP chipsets.
    i915: GM45 has GM965-style MCH setup.
    i915: Don't run retire work handler while suspended
    i915: Map status page cached for chips with GTT-based HWS location.
    i915: Fix up ring initialization to cover G45 oddities
    i915: Use non-reserved status page index for breadcrumb
    drm: Increment dev_priv->irq_received so i915_gem_interrupts count works.
    drm: kill drm_device->irq
    drm: wbinvd is cache coherent.
    i915: add missing return in error path.
    i915: fixup permissions on gem ioctls.
    drm: Clean up many sparse warnings in i915.
    drm: Use ioremap_wc in i915_driver instead of ioremap, since we always want WC.
    drm: G33-class hardware has a newer 965-style MCH (no DCC register).
    drm: Avoid oops in GEM execbuffers with bad arguments.
    DRM: Return -EBADF on bad object in flink, and return curent name if it exists.
    ...
  4b40893918203ee1a1f6a114316c2a19c072e9bd:drm/i915: fix ioremap of a user address for non-root (CVE-2008-3831)

  Olaf Kirch noticed that the i915_set_status_page() function of the i915
  kernel driver calls ioremap with an address offset that is supplied by
  userspace via ioctl. The function zeroes the mapped memory via memset
  and tells the hardware about the address. Turns out that access to that
  ioctl is not restricted to root so users could probably exploit that to
  do nasty things. We haven't tried to write actual exploit code though.

  It only affects the Intel G33 series and newer.

  Signed-off-by: Dave Airlie <airlied@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 4b40893918203ee1a1f6a114316c2a19c072e9bd
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: f7ea4a4ba84f382e8eb143e435551de0feee5b4b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/4b40893918203ee1a1f6a114316c2a19c072e9bd
    reference_type: commit
    reference_id: 4b40893918203ee1a1f6a114316c2a19c072e9bd
  - url: https://github.com/torvalds/linux/tree/f7ea4a4ba84f382e8eb143e435551de0feee5b4b
    reference_type: commit
    reference_id: f7ea4a4ba84f382e8eb143e435551de0feee5b4b
