advisory_id: CVE-2006-5753
datasource_id: collect_linux_fix_commits/CVE-2006-5753
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "be6aab0e9fa6d3c6d75aa1e38ac972d8b4ee82b8:[PATCH] fix memory corruption from misinterpreted\
  \ bad_inode_ops return values\n\nCVE-2006-5753 is for a case where an inode can be marked\
  \ bad, switching\nthe ops to bad_inode_ops, which are all connected as:\n\nstatic int return_EIO(void)\n\
  {\n        return -EIO;\n}\n\n#define EIO_ERROR ((void *) (return_EIO))\n\nstatic struct inode_operations\
  \ bad_inode_ops =\n{\n        .create         = bad_inode_create\n...etc...\n\nThe problem\
  \ here is that the void cast causes return types to not be\npromoted, and for ops such as\
  \ listxattr which expect more than 32 bits of\nreturn value, the 32-bit -EIO is interpreted\
  \ as a large positive 64-bit\nnumber, i.e. 0x00000000fffffffa instead of 0xfffffffa.\n\nThis\
  \ goes particularly badly when the return value is taken as a number of\nbytes to copy into,\
  \ say, a user's buffer for example...\n\nI originally had coded up the fix by creating a return_EIO_<TYPE>\
  \ macro\nfor each return type, like this:\n\nstatic int return_EIO_int(void)\n{\n\treturn\
  \ -EIO;\n}\n#define EIO_ERROR_INT ((void *) (return_EIO_int))\n\nstatic struct inode_operations\
  \ bad_inode_ops =\n{\n\t.create\t\t= EIO_ERROR_INT,\n...etc...\n\nbut Al felt that it was\
  \ probably better to create an EIO-returner for each\nactual op signature.  Since so few ops\
  \ share a signature, I just went ahead\n& created an EIO function for each individual file\
  \ & inode op that returns\na value.\n\nSigned-off-by: Eric Sandeen <sandeen@redhat.com>\n\
  Cc: Al Viro <viro@zeniv.linux.org.uk>\nSigned-off-by: Andrew Morton <akpm@osdl.org>\nSigned-off-by:\
  \ Linus Torvalds <torvalds@osdl.org>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: be6aab0e9fa6d3c6d75aa1e38ac972d8b4ee82b8
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/be6aab0e9fa6d3c6d75aa1e38ac972d8b4ee82b8
    reference_type: commit
    reference_id: be6aab0e9fa6d3c6d75aa1e38ac972d8b4ee82b8
