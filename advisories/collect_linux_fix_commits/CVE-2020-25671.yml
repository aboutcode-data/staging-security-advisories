advisory_id: CVE-2020-25671
datasource_id: collect_linux_fix_commits/CVE-2020-25671
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  8a4cd82d62b5ec7e5482333a72b58a4eea4979f0:nfc: fix refcount leak in llcp_sock_connect()

  nfc_llcp_local_get() is invoked in llcp_sock_connect(),
  but nfc_llcp_local_put() is not invoked in subsequent failure branches.
  As a result, refcount leakage occurs.
  To fix it, add calling nfc_llcp_local_put().

  fix CVE-2020-25671
  Fixes: c7aa12252f51 ("NFC: Take a reference on the LLCP local pointer when creating a socket")
  Reported-by: "kiyin(尹亮)" <kiyin@tencent.com>
  Link: https://www.openwall.com/lists/oss-security/2020/11/01/1
  Cc: <stable@vger.kernel.org> #v3.6
  Signed-off-by: Xiaoming Ni <nixiaoming@huawei.com>
  Signed-off-by: David S. Miller <davem@davemloft.net>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 8a4cd82d62b5ec7e5482333a72b58a4eea4979f0
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/8a4cd82d62b5ec7e5482333a72b58a4eea4979f0
    reference_type: commit
    reference_id: 8a4cd82d62b5ec7e5482333a72b58a4eea4979f0
