advisory_id: CVE-2024-47663
datasource_id: collect_linux_fix_commits/CVE-2024-47663
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  6bd301819f8f69331a55ae2336c8b111fc933f3d:staging: iio: frequency: ad9832: fix division by zero in ad9832_calc_freqreg()

  In the ad9832_write_frequency() function, clk_get_rate() might return 0.
  This can lead to a division by zero when calling ad9832_calc_freqreg().
  The check if (fout > (clk_get_rate(st->mclk) / 2)) does not protect
  against the case when fout is 0. The ad9832_write_frequency() function
  is called from ad9832_write(), and fout is derived from a text buffer,
  which can contain any value.

  Link: https://lore.kernel.org/all/2024100904-CVE-2024-47663-9bdc@gregkh/
  Fixes: ea707584bac1 ("Staging: IIO: DDS: AD9832 / AD9835 driver")
  Cc: stable@vger.kernel.org
  Signed-off-by: Zicheng Qu <quzicheng@huawei.com>
  Reviewed-by: Nuno Sa <nuno.sa@analog.com>
  Reviewed-by: Dan Carpenter <dan.carpenter@linaro.org>
  Link: https://patch.msgid.link/20241022134354.574614-1-quzicheng@huawei.com
  Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 6bd301819f8f69331a55ae2336c8b111fc933f3d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/6bd301819f8f69331a55ae2336c8b111fc933f3d
    reference_type: commit
    reference_id: 6bd301819f8f69331a55ae2336c8b111fc933f3d
