advisory_id: CVE-2018-9568
datasource_id: collect_linux_fix_commits/CVE-2018-9568
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "598a0717a816abc8f5d3c4598628338b9190d127:mm/slab: validate cache membership under\
  \ freelist hardening\n\nPatch series \"mm/slab: Improved sanity checking\".\n\nThis adds defenses\
  \ against slab cache confusion (as seen in real-world\nexploits[1]) and gracefully handles\
  \ type confusions when trying to look\nup slab caches from an arbitrary page.  (Also is patch\
  \ 3: new LKDTM\ntests for these defenses as well as for the existing double-free\ndetection.\n\
  \nThis patch (of 3):\n\nWhen building under CONFIG_SLAB_FREELIST_HARDENING, it makes sense\
  \ to\nperform sanity-checking on the assumed slab cache during\nkmem_cache_free() to make\
  \ sure the kernel doesn't mix freelists across\nslab caches and corrupt memory (as seen in\
  \ the exploitation of flaws\nlike CVE-2018-9568[1]).  Note that the prior code might WARN()\
  \ but still\ncorrupt memory (i.e.  return the assumed cache instead of the owned\ncache).\n\
  \nThere is no noticeable performance impact (changes are within noise).\nMeasuring parallel\
  \ kernel builds, I saw the following with\nCONFIG_SLAB_FREELIST_HARDENED, before and after\
  \ this patch:\n\nbefore:\n\n\tRun times: 288.85 286.53 287.09 287.07 287.21\n\tMin: 286.53\
  \ Max: 288.85 Mean: 287.35 Std Dev: 0.79\n\nafter:\n\n\tRun times: 289.58 287.40 286.97 287.20\
  \ 287.01\n\tMin: 286.97 Max: 289.58 Mean: 287.63 Std Dev: 0.99\n\nDelta: 0.1% which is well\
  \ below the standard deviation\n\n[1] https://github.com/ThomasKing2014/slides/raw/master/Building%20universal%20Android%20rooting%20with%20a%20type%20confusion%20vulnerability.pdf\n\
  \nLink: http://lkml.kernel.org/r/20190530045017.15252-2-keescook@chromium.org\nSigned-off-by:\
  \ Kees Cook <keescook@chromium.org>\nCc: Christoph Lameter <cl@linux.com>\nCc: Pekka Enberg\
  \ <penberg@kernel.org>\nCc: David Rientjes <rientjes@google.com>\nCc: Joonsoo Kim <iamjoonsoo.kim@lge.com>\n\
  Cc: Matthew Wilcox <willy@infradead.org>\nCc: Alexander Popov <alex.popov@linux.com>\nCc:\
  \ Alexander Potapenko <glider@google.com>\nCc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n\
  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 598a0717a816abc8f5d3c4598628338b9190d127
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/598a0717a816abc8f5d3c4598628338b9190d127
    reference_type: commit
    reference_id: 598a0717a816abc8f5d3c4598628338b9190d127
