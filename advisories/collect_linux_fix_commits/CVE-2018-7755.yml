advisory_id: CVE-2018-7755
datasource_id: collect_linux_fix_commits/CVE-2018-7755
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  65eea8edc315589d6c993cf12dbb5d0e9ef1fe4e:floppy: Do not copy a kernel pointer to user memory in FDGETPRM ioctl

  The final field of a floppy_struct is the field "name", which is a pointer
  to a string in kernel memory.  The kernel pointer should not be copied to
  user memory.  The FDGETPRM ioctl copies a floppy_struct to user memory,
  including this "name" field.  This pointer cannot be used by the user
  and it will leak a kernel address to user-space, which will reveal the
  location of kernel code and data and undermine KASLR protection.

  Model this code after the compat ioctl which copies the returned data
  to a previously cleared temporary structure on the stack (excluding the
  name pointer) and copy out to userspace from there.  As we already have
  an inparam union with an appropriate member and that memory is already
  cleared even for read only calls make use of that as a temporary store.

  Based on an initial patch by Brian Belleville.

  CVE-2018-7755
  Signed-off-by: Andy Whitcroft <apw@canonical.com>

  Broke up long line.

  Signed-off-by: Jens Axboe <axboe@kernel.dk>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 65eea8edc315589d6c993cf12dbb5d0e9ef1fe4e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/65eea8edc315589d6c993cf12dbb5d0e9ef1fe4e
    reference_type: commit
    reference_id: 65eea8edc315589d6c993cf12dbb5d0e9ef1fe4e
