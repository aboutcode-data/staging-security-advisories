advisory_id: CVE-2014-3153
datasource_id: collect_linux_fix_commits/CVE-2014-3153
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "e9c243a5a6de0be8e584c604d353412584b592f8:futex-prevent-requeue-pi-on-same-futex.patch\
  \ futex: Forbid uaddr == uaddr2 in futex_requeue(..., requeue_pi=1)\n\nIf uaddr == uaddr2,\
  \ then we have broken the rule of only requeueing from\na non-pi futex to a pi futex with\
  \ this call.  If we attempt this, then\ndangling pointers may be left for rt_waiter resulting\
  \ in an exploitable\ncondition.\n\nThis change brings futex_requeue() in line with futex_wait_requeue_pi()\n\
  which performs the same check as per commit 6f7b0a2a5c0f (\"futex: Forbid\nuaddr == uaddr2\
  \ in futex_wait_requeue_pi()\")\n\n[ tglx: Compare the resulting keys as well, as uaddrs might\
  \ be\n  \tdifferent depending on the mapping ]\n\nFixes CVE-2014-3153.\n\nReported-by: Pinkie\
  \ Pie\nSigned-off-by: Will Drewry <wad@chromium.org>\nSigned-off-by: Kees Cook <keescook@chromium.org>\n\
  Cc: stable@vger.kernel.org\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nReviewed-by:\
  \ Darren Hart <dvhart@linux.intel.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: e9c243a5a6de0be8e584c604d353412584b592f8
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/e9c243a5a6de0be8e584c604d353412584b592f8
    reference_type: commit
    reference_id: e9c243a5a6de0be8e584c604d353412584b592f8
