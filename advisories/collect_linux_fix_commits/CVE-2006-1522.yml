advisory_id: CVE-2006-1522
datasource_id: collect_linux_fix_commits/CVE-2006-1522
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "c3a9d6541f84ac3ff566982d08389b87c1c36b4e:[Security] Keys: Fix oops when adding key\
  \ to non-keyring\n\nThis fixes the problem of an oops occuring when a user attempts to add\
  \ a\nkey to a non-keyring key [CVE-2006-1522].\n\nThe problem is that __keyring_search_one()\
  \ doesn't check that the\nkeyring it's been given is actually a keyring.\n\nI've fixed this\
  \ problem by:\n\n (1) declaring that caller of __keyring_search_one() must guarantee that\n\
  \     the keyring is a keyring; and\n\n (2) making key_create_or_update() check that the keyring\
  \ is a keyring,\n     and return -ENOTDIR if it isn't.\n\nThis can be tested by:\n\n\tkeyctl\
  \ add user b b `keyctl add user a a @s`\n\nSigned-off-by: David Howells <dhowells@redhat.com>\n\
  Signed-off-by: Linus Torvalds <torvalds@osdl.org>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: c3a9d6541f84ac3ff566982d08389b87c1c36b4e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/c3a9d6541f84ac3ff566982d08389b87c1c36b4e
    reference_type: commit
    reference_id: c3a9d6541f84ac3ff566982d08389b87c1c36b4e
