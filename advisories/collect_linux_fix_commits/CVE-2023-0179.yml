advisory_id: CVE-2023-0179
datasource_id: collect_linux_fix_commits/CVE-2023-0179
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  696e1a48b1a1b01edad542a1ef293665864a4dd0:netfilter: nft_payload: incorrect arithmetics when fetching VLAN header bits

  If the offset + length goes over the ethernet + vlan header, then the
  length is adjusted to copy the bytes that are within the boundaries of
  the vlan_ethhdr scratchpad area. The remaining bytes beyond ethernet +
  vlan header are copied directly from the skbuff data area.

  Fix incorrect arithmetic operator: subtract, not add, the size of the
  vlan header in case of double-tagged packets to adjust the length
  accordingly to address CVE-2023-0179.

  Reported-by: Davide Ornaghi <d.ornaghi97@gmail.com>
  Fixes: f6ae9f120dad ("netfilter: nft_payload: add C-VLAN support")
  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 696e1a48b1a1b01edad542a1ef293665864a4dd0
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/696e1a48b1a1b01edad542a1ef293665864a4dd0
    reference_type: commit
    reference_id: 696e1a48b1a1b01edad542a1ef293665864a4dd0
