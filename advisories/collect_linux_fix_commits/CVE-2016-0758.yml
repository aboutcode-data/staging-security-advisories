advisory_id: CVE-2016-0758
datasource_id: collect_linux_fix_commits/CVE-2016-0758
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "23c8a812dc3c621009e4f0e5342aa4e2ede1ceaa:KEYS: Fix ASN.1 indefinite length object\
  \ parsing\n\nThis fixes CVE-2016-0758.\n\nIn the ASN.1 decoder, when the length field of an\
  \ ASN.1 value is extracted,\nit isn't validated against the remaining amount of data before\
  \ being added\nto the cursor.  With a sufficiently large size indicated, the check:\n\n\t\
  datalen - dp < 2\n\nmay then fail due to integer overflow.\n\nFix this by checking the length\
  \ indicated against the amount of remaining\ndata in both places a definite length is determined.\n\
  \nWhilst we're at it, make the following changes:\n\n (1) Check the maximum size of extended\
  \ length does not exceed the capacity\n     of the variable it's being stored in (len) rather\
  \ than the type that\n     variable is assumed to be (size_t).\n\n (2) Compare the EOC tag\
  \ to the symbolic constant ASN1_EOC rather than the\n     integer 0.\n\n (3) To reduce confusion,\
  \ move the initialisation of len outside of:\n\n\tfor (len = 0; n > 0; n--) {\n\n     since\
  \ it doesn't have anything to do with the loop counter n.\n\nSigned-off-by: David Howells\
  \ <dhowells@redhat.com>\nReviewed-by: Mimi Zohar <zohar@linux.vnet.ibm.com>\nAcked-by: David\
  \ Woodhouse <David.Woodhouse@intel.com>\nAcked-by: Peter Jones <pjones@redhat.com>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 23c8a812dc3c621009e4f0e5342aa4e2ede1ceaa
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/23c8a812dc3c621009e4f0e5342aa4e2ede1ceaa
    reference_type: commit
    reference_id: 23c8a812dc3c621009e4f0e5342aa4e2ede1ceaa
