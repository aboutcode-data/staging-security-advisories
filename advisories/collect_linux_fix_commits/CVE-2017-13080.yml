advisory_id: CVE-2017-13080
datasource_id: collect_linux_fix_commits/CVE-2017-13080
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  1b72bf5a0777d7cec6c2d857ac15599022b3c123:Merge tag 'mac80211-for-davem-2017-10-16' of git://git.kernel.org/pub/scm/linux/kernel/git/jberg/mac80211

  Johannes Berg says:

  ====================
  Just a single fix, for a WoWLAN-related part of CVE-2017-13080.
  ====================

  Signed-off-by: David S. Miller <davem@davemloft.net>
  fdf7cb4185b60c68e1a75e61691c4afdc15dea0e:mac80211: accept key reinstall without changing anything

  When a key is reinstalled we can reset the replay counters
  etc. which can lead to nonce reuse and/or replay detection
  being impossible, breaking security properties, as described
  in the "KRACK attacks".

  In particular, CVE-2017-13080 applies to GTK rekeying that
  happened in firmware while the host is in D3, with the second
  part of the attack being done after the host wakes up. In
  this case, the wpa_supplicant mitigation isn't sufficient
  since wpa_supplicant doesn't know the GTK material.

  In case this happens, simply silently accept the new key
  coming from userspace but don't take any action on it since
  it's the same key; this keeps the PN replay counters intact.

  Signed-off-by: Johannes Berg <johannes.berg@intel.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 1b72bf5a0777d7cec6c2d857ac15599022b3c123
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: fdf7cb4185b60c68e1a75e61691c4afdc15dea0e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/1b72bf5a0777d7cec6c2d857ac15599022b3c123
    reference_type: commit
    reference_id: 1b72bf5a0777d7cec6c2d857ac15599022b3c123
  - url: https://github.com/torvalds/linux/tree/fdf7cb4185b60c68e1a75e61691c4afdc15dea0e
    reference_type: commit
    reference_id: fdf7cb4185b60c68e1a75e61691c4afdc15dea0e
