advisory_id: CVE-2017-6951
datasource_id: collect_linux_fix_commits/CVE-2017-6951
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "f205b5dc1c9e62237ac6e21642724d8cbc85f7ee:Merge tag 'keys-fixes-20170419' of git://git.kernel.org/pub/scm/linux/kernel/git/dhowells/linux-fs\n\
  \nPull keyrings fixes from David Howells:\n\n (1) Disallow keyrings whose name begins with\
  \ a '.' to be joined\n     [CVE-2016-9604].\n\n (2) Change the name of the dead type to \"\
  .dead\" to prevent user access\n     [CVE-2017-6951].\n\n (3) Fix keyctl_set_reqkey_keyring()\
  \ to not leak thread keyrings\n     [CVE-2017-7472]\n\n* tag 'keys-fixes-20170419' of git://git.kernel.org/pub/scm/linux/kernel/git/dhowells/linux-fs:\n\
  \  KEYS: fix keyctl_set_reqkey_keyring() to not leak thread keyrings\n  KEYS: Change the name\
  \ of the dead type to \".dead\" to prevent user access\n  KEYS: Disallow keyrings beginning\
  \ with '.' to be joined as session keyrings\nc1644fe041ebaf6519f6809146a77c3ead9193af:KEYS:\
  \ Change the name of the dead type to \".dead\" to prevent user access\n\nThis fixes CVE-2017-6951.\n\
  \nUserspace should not be able to do things with the \"dead\" key type as it\ndoesn't have\
  \ some of the helper functions set upon it that the kernel\nneeds.  Attempting to use it may\
  \ cause the kernel to crash.\n\nFix this by changing the name of the type to \".dead\" so\
  \ that it's rejected\nup front on userspace syscalls by key_get_type_from_user().\n\nThough\
  \ this doesn't seem to affect recent kernels, it does affect older\nones, certainly those\
  \ prior to:\n\n\tcommit c06cfb08b88dfbe13be44a69ae2fdc3a7c902d81\n\tAuthor: David Howells\
  \ <dhowells@redhat.com>\n\tDate:   Tue Sep 16 17:36:06 2014 +0100\n\tKEYS: Remove key_type::match\
  \ in favour of overriding default by match_preparse\n\nwhich went in before 3.18-rc1.\n\n\
  Signed-off-by: David Howells <dhowells@redhat.com>\ncc: stable@vger.kernel.org"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: c1644fe041ebaf6519f6809146a77c3ead9193af
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: f205b5dc1c9e62237ac6e21642724d8cbc85f7ee
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/c1644fe041ebaf6519f6809146a77c3ead9193af
    reference_type: commit
    reference_id: c1644fe041ebaf6519f6809146a77c3ead9193af
  - url: https://github.com/torvalds/linux/tree/f205b5dc1c9e62237ac6e21642724d8cbc85f7ee
    reference_type: commit
    reference_id: f205b5dc1c9e62237ac6e21642724d8cbc85f7ee
