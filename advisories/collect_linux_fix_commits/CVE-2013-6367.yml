advisory_id: CVE-2013-6367
datasource_id: collect_linux_fix_commits/CVE-2013-6367
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f:Merge tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm

  Pull kvm fixes from Paolo Bonzini:
   "Four security fixes for KVM on x86.  Thanks to Andrew Honig and Lars
    Bull from Google for reporting them"

  * tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm:
    KVM: x86: fix guest-initiated crash with x2apic (CVE-2013-6376)
    KVM: x86: Convert vapic synchronization to _cached functions (CVE-2013-6368)
    KVM: x86: Fix potential divide by 0 in lapic (CVE-2013-6367)
    KVM: Improve create VCPU parameter (CVE-2013-4587)
  b963a22e6d1a266a67e9eecc88134713fd54775c:KVM: x86: Fix potential divide by 0 in lapic (CVE-2013-6367)

  Under guest controllable circumstances apic_get_tmcct will execute a
  divide by zero and cause a crash.  If the guest cpuid support
  tsc deadline timers and performs the following sequence of requests
  the host will crash.
  - Set the mode to periodic
  - Set the TMICT to 0
  - Set the mode bits to 11 (neither periodic, nor one shot, nor tsc deadline)
  - Set the TMICT to non-zero.
  Then the lapic_timer.period will be 0, but the TMICT will not be.  If the
  guest then reads from the TMCCT then the host will perform a divide by 0.

  This patch ensures that if the lapic_timer.period is 0, then the division
  does not occur.

  Reported-by: Andrew Honig <ahonig@google.com>
  Cc: stable@vger.kernel.org
  Signed-off-by: Andrew Honig <ahonig@google.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: b963a22e6d1a266a67e9eecc88134713fd54775c
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f
    reference_type: commit
    reference_id: 54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f
  - url: https://github.com/torvalds/linux/tree/b963a22e6d1a266a67e9eecc88134713fd54775c
    reference_type: commit
    reference_id: b963a22e6d1a266a67e9eecc88134713fd54775c
