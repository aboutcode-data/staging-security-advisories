advisory_id: CVE-2007-2876
datasource_id: collect_linux_fix_commits/CVE-2007-2876
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  e1bd2ac5a6b7a8b625e40c9e9f8b6dea4cf22f85:Merge branch 'master' of master.kernel.org:/pub/scm/linux/kernel/git/davem/net-2.6

  * 'master' of master.kernel.org:/pub/scm/linux/kernel/git/davem/net-2.6: (183 commits)
    [TG3]: Update version to 3.78.
    [TG3]: Add missing NVRAM strapping.
    [TG3]: Enable auto MDI.
    [TG3]: Fix the polarity bit.
    [TG3]: Fix irq_sync race condition.
    [NET_SCHED]: ematch: module autoloading
    [TCP]: tcp probe wraparound handling and other changes
    [RTNETLINK]: rtnl_link: allow specifying initial device address
    [RTNETLINK]: rtnl_link API simplification
    [VLAN]: Fix MAC address handling
    [ETH]: Validate address in eth_mac_addr
    [NET]: Fix races in net_rx_action vs netpoll.
    [AF_UNIX]: Rewrite garbage collector, fixes race.
    [NETFILTER]: {ip, nf}_conntrack_sctp: fix remotely triggerable NULL ptr dereference (CVE-2007-2876)
    [NET]: Make all initialized struct seq_operations const.
    [UDP]: Fix length check.
    [IPV6]: Remove unneeded pointer idev from addrconf_cleanup().
    [DECNET]: Another unnecessary net/tcp.h inclusion in net/dn.h
    [IPV6]: Make IPV6_{RECV,2292}RTHDR boolean options.
    [IPV6]: Do not send RH0 anymore.
    ...

  Fixed up trivial conflict in Documentation/feature-removal-schedule.txt
  manually.

  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
  99d24edeb6abc6ca3a0d0fbdb83c664c04403c8c:[NETFILTER]: {ip, nf}_conntrack_sctp: fix remotely triggerable NULL ptr dereference (CVE-2007-2876)

  When creating a new connection by sending an unknown chunk type, we
  don't transition to a valid state, causing a NULL pointer dereference
  in sctp_packet when accessing sctp_timeouts[SCTP_CONNTRACK_NONE].

  Fix by don't creating new conntrack entry if initial state is invalid.

  Noticed by Vilmos Nebehaj <vilmos.nebehaj@ramsys.hu>

  Signed-off-by: Patrick McHardy <kaber@trash.net>
  Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
  Signed-off-by: Chris Wright <chrisw@sous-sol.org>
  Signed-off-by: David S. Miller <davem@davemloft.net>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 99d24edeb6abc6ca3a0d0fbdb83c664c04403c8c
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: e1bd2ac5a6b7a8b625e40c9e9f8b6dea4cf22f85
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/99d24edeb6abc6ca3a0d0fbdb83c664c04403c8c
    reference_type: commit
    reference_id: 99d24edeb6abc6ca3a0d0fbdb83c664c04403c8c
  - url: https://github.com/torvalds/linux/tree/e1bd2ac5a6b7a8b625e40c9e9f8b6dea4cf22f85
    reference_type: commit
    reference_id: e1bd2ac5a6b7a8b625e40c9e9f8b6dea4cf22f85
