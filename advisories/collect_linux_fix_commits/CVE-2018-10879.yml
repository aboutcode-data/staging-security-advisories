advisory_id: CVE-2018-10879
datasource_id: collect_linux_fix_commits/CVE-2018-10879
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  513f86d73855ce556ea9522b6bfd79f87356dc3a:ext4: always verify the magic number in xattr blocks

  If there an inode points to a block which is also some other type of
  metadata block (such as a block allocation bitmap), the
  buffer_verified flag can be set when it was validated as that other
  metadata block type; however, it would make a really terrible external
  attribute block.  The reason why we use the verified flag is to avoid
  constantly reverifying the block.  However, it doesn't take much
  overhead to make sure the magic number of the xattr block is correct,
  and this will avoid potential crashes.

  This addresses CVE-2018-10879.

  https://bugzilla.kernel.org/show_bug.cgi?id=200001

  Signed-off-by: Theodore Ts'o <tytso@mit.edu>
  Reviewed-by: Andreas Dilger <adilger@dilger.ca>
  Cc: stable@kernel.org
  5369a762c882c0b6e9599e4ebbb3a9ba9eee7e2d:ext4: add corruption check in ext4_xattr_set_entry()

  In theory this should have been caught earlier when the xattr list was
  verified, but in case it got missed, it's simple enough to add check
  to make sure we don't overrun the xattr buffer.

  This addresses CVE-2018-10879.

  https://bugzilla.kernel.org/show_bug.cgi?id=200001

  Signed-off-by: Theodore Ts'o <tytso@mit.edu>
  Reviewed-by: Andreas Dilger <adilger@dilger.ca>
  Cc: stable@kernel.org
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 513f86d73855ce556ea9522b6bfd79f87356dc3a
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 5369a762c882c0b6e9599e4ebbb3a9ba9eee7e2d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/513f86d73855ce556ea9522b6bfd79f87356dc3a
    reference_type: commit
    reference_id: 513f86d73855ce556ea9522b6bfd79f87356dc3a
  - url: https://github.com/torvalds/linux/tree/5369a762c882c0b6e9599e4ebbb3a9ba9eee7e2d
    reference_type: commit
    reference_id: 5369a762c882c0b6e9599e4ebbb3a9ba9eee7e2d
