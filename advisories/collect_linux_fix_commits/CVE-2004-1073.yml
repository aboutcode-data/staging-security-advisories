advisory_id: CVE-2004-1073
datasource_id: collect_linux_fix_commits/CVE-2004-1073
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  1fb844961818ce94e782acf6a96b92dc2303553b:[PATCH] core-dumping unreadable binaries via PT_INTERP

  Proposed patch to fix #5 in
  http://www.isec.pl/vulnerabilities/isec-0017-binfmt_elf.txt
  aka
  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1073

  To reproduce, do
  * grab poc at the end of advisory.
  * add line "eph.p_memsz = 4096;" after "eph.p_filesz = 4096;"
    where first "4096" is something equal to or greater than 4096.
  * ./poc /usr/bin/sudo && ls -l

  Here I get with 2.6.20-rc5:

   -rw------- 1 ad   ad   102400 2007-01-15 19:17 core
   ---s--x--x 2 root root 101820 2007-01-15 19:15 /usr/bin/sudo

  Check for MAY_READ like binfmt_misc.c does.

  Signed-off-by: Alexey Dobriyan <adobriyan@openvz.org>
  Signed-off-by: Andrew Morton <akpm@osdl.org>
  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 1fb844961818ce94e782acf6a96b92dc2303553b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/1fb844961818ce94e782acf6a96b92dc2303553b
    reference_type: commit
    reference_id: 1fb844961818ce94e782acf6a96b92dc2303553b
