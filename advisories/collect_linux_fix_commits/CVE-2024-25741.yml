advisory_id: CVE-2024-25741
datasource_id: collect_linux_fix_commits/CVE-2024-25741
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  e587a7633dfee8987a999cf253f7c52a8e09276c:usb: gadget: printer: fix races against disable

  printer_read() and printer_write() guard against the race
  against disable() by checking the dev->interface flag,
  which in turn is guarded by a spinlock.
  These functions, however, drop the lock on multiple occasions.
  This means that the test has to be redone after reacquiring
  the lock and before doing IO.

  Add the tests.

  This also addresses CVE-2024-25741

  Fixes: 7f2ca14d2f9b9 ("usb: gadget: function: printer: Interface is disabled and returns error")
  Cc: stable <stable@kernel.org>
  Signed-off-by: Oliver Neukum <oneukum@suse.com>
  Link: https://lore.kernel.org/r/20240620114039.5767-1-oneukum@suse.com
  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: e587a7633dfee8987a999cf253f7c52a8e09276c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/e587a7633dfee8987a999cf253f7c52a8e09276c
    reference_type: commit
    reference_id: e587a7633dfee8987a999cf253f7c52a8e09276c
