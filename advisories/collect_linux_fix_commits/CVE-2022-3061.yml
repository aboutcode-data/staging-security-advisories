advisory_id: CVE-2022-3061
datasource_id: collect_linux_fix_commits/CVE-2022-3061
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  e421946be7d9bf545147bea8419ef8239cb7ca52:fbdev: sis: Error out if pixclock equals zero

  The userspace program could pass any values to the driver through
  ioctl() interface. If the driver doesn't check the value of pixclock,
  it may cause divide-by-zero error.

  In sisfb_check_var(), var->pixclock is used as a divisor to caculate
  drate before it is checked against zero. Fix this by checking it
  at the beginning.

  This is similar to CVE-2022-3061 in i740fb which was fixed by
  commit 15cf0b8.

  Signed-off-by: Fullway Wang <fullwaywang@outlook.com>
  Signed-off-by: Helge Deller <deller@gmx.de>
  04e5eac8f3ab2ff52fa191c187a46d4fdbc1e288:fbdev: savage: Error out if pixclock equals zero

  The userspace program could pass any values to the driver through
  ioctl() interface. If the driver doesn't check the value of pixclock,
  it may cause divide-by-zero error.

  Although pixclock is checked in savagefb_decode_var(), but it is not
  checked properly in savagefb_probe(). Fix this by checking whether
  pixclock is zero in the function savagefb_check_var() before
  info->var.pixclock is used as the divisor.

  This is similar to CVE-2022-3061 in i740fb which was fixed by
  commit 15cf0b8.

  Signed-off-by: Fullway Wang <fullwaywang@outlook.com>
  Signed-off-by: Helge Deller <deller@gmx.de>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: e421946be7d9bf545147bea8419ef8239cb7ca52
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 04e5eac8f3ab2ff52fa191c187a46d4fdbc1e288
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/04e5eac8f3ab2ff52fa191c187a46d4fdbc1e288
    reference_type: commit
    reference_id: 04e5eac8f3ab2ff52fa191c187a46d4fdbc1e288
  - url: https://github.com/torvalds/linux/tree/e421946be7d9bf545147bea8419ef8239cb7ca52
    reference_type: commit
    reference_id: e421946be7d9bf545147bea8419ef8239cb7ca52
