advisory_id: CVE-2022-4139
datasource_id: collect_linux_fix_commits/CVE-2022-4139
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  04aa64375f48a5d430b5550d9271f8428883e550:drm/i915: fix TLB invalidation for Gen12 video and compute engines

  In case of Gen12 video and compute engines, TLB_INV registers are masked -
  to modify one bit, corresponding bit in upper half of the register must
  be enabled, otherwise nothing happens.

  CVE: CVE-2022-4139
  Suggested-by: Chris Wilson <chris.p.wilson@intel.com>
  Signed-off-by: Andrzej Hajda <andrzej.hajda@intel.com>
  Acked-by: Daniel Vetter <daniel.vetter@ffwll.ch>
  Fixes: 7938d61591d3 ("drm/i915: Flush TLBs before releasing backing store")
  Cc: stable@vger.kernel.org
  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 04aa64375f48a5d430b5550d9271f8428883e550
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/04aa64375f48a5d430b5550d9271f8428883e550
    reference_type: commit
    reference_id: 04aa64375f48a5d430b5550d9271f8428883e550
