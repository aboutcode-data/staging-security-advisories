advisory_id: CVE-2008-1514
datasource_id: collect_linux_fix_commits/CVE-2008-1514
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  ea81e2722e55ba0269c92f266763e445dcffb973:Merge branch 'for-linus' of git://git390.osdl.marist.edu/pub/scm/linux-2.6

  * 'for-linus' of git://git390.osdl.marist.edu/pub/scm/linux-2.6:
    [S390] cio: allow offline processing for disconnected devices
    [S390] cio: handle ssch() return codes correctly.
    [S390] cio: Correct cleanup on error.
    [S390] CVE-2008-1514: prevent ptrace padding area read/write in 31-bit mode
  3d6e48f43340343d97839eadb1ab7b6a3ea98797:[S390] CVE-2008-1514: prevent ptrace padding area read/write in 31-bit mode

  When running a 31-bit ptrace, on either an s390 or s390x kernel,
  reads and writes into a padding area in struct user_regs_struct32
  will result in a kernel panic.

  This is also known as CVE-2008-1514.

  Test case available here:
  http://sources.redhat.com/cgi-bin/cvsweb.cgi/~checkout~/tests/ptrace-tests/tests/user-area-padding.c?cvsroot=systemtap

  Steps to reproduce:
  1) wget the above
  2) gcc -o user-area-padding-31bit user-area-padding.c -Wall -ggdb2 -D_GNU_SOURCE -m31
  3) ./user-area-padding-31bit
  <panic>

  Test status
  -----------
  Without patch, both s390 and s390x kernels panic. With patch, the test case,
  as well as the gdb testsuite, pass without incident, padding area reads
  returning zero, writes ignored.

  Nb: original version returned -EINVAL on write attempts, which broke the
  gdb test and made the test case slightly unhappy, Jan Kratochvil suggested
  the change to return 0 on write attempts.

  Signed-off-by: Jarod Wilson <jarod@redhat.com>
  Tested-by: Jan Kratochvil <jan.kratochvil@redhat.com>
  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
  3d6e48f43340343d97839eadb1ab7b6a3ea98797:[S390] CVE-2008-1514: prevent ptrace padding area read/write in 31-bit mode

  When running a 31-bit ptrace, on either an s390 or s390x kernel,
  reads and writes into a padding area in struct user_regs_struct32
  will result in a kernel panic.

  This is also known as CVE-2008-1514.

  Test case available here:
  http://sources.redhat.com/cgi-bin/cvsweb.cgi/~checkout~/tests/ptrace-tests/tests/user-area-padding.c?cvsroot=systemtap

  Steps to reproduce:
  1) wget the above
  2) gcc -o user-area-padding-31bit user-area-padding.c -Wall -ggdb2 -D_GNU_SOURCE -m31
  3) ./user-area-padding-31bit
  <panic>

  Test status
  -----------
  Without patch, both s390 and s390x kernels panic. With patch, the test case,
  as well as the gdb testsuite, pass without incident, padding area reads
  returning zero, writes ignored.

  Nb: original version returned -EINVAL on write attempts, which broke the
  gdb test and made the test case slightly unhappy, Jan Kratochvil suggested
  the change to return 0 on write attempts.

  Signed-off-by: Jarod Wilson <jarod@redhat.com>
  Tested-by: Jan Kratochvil <jan.kratochvil@redhat.com>
  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: ea81e2722e55ba0269c92f266763e445dcffb973
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 3d6e48f43340343d97839eadb1ab7b6a3ea98797
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/3d6e48f43340343d97839eadb1ab7b6a3ea98797
    reference_type: commit
    reference_id: 3d6e48f43340343d97839eadb1ab7b6a3ea98797
  - url: https://github.com/torvalds/linux/tree/ea81e2722e55ba0269c92f266763e445dcffb973
    reference_type: commit
    reference_id: ea81e2722e55ba0269c92f266763e445dcffb973
