advisory_id: CVE-2015-7799
datasource_id: collect_linux_fix_commits/CVE-2015-7799
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  4ab42d78e37a294ac7bc56901d563c642e03c4ae:ppp, slip: Validate VJ compression slot parameters completely

  Currently slhc_init() treats out-of-range values of rslots and tslots
  as equivalent to 0, except that if tslots is too large it will
  dereference a null pointer (CVE-2015-7799).

  Add a range-check at the top of the function and make it return an
  ERR_PTR() on error instead of NULL.  Change the callers accordingly.

  Compile-tested only.

  Reported-by: 郭永刚 <guoyonggang@360.cn>
  References: http://article.gmane.org/gmane.comp.security.oss.general/17908
  Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
  Signed-off-by: David S. Miller <davem@davemloft.net>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 4ab42d78e37a294ac7bc56901d563c642e03c4ae
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/4ab42d78e37a294ac7bc56901d563c642e03c4ae
    reference_type: commit
    reference_id: 4ab42d78e37a294ac7bc56901d563c642e03c4ae
