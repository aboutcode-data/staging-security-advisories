advisory_id: cve-2019-3016
datasource_id: collect_linux_fix_commits/cve-2019-3016
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "4cbc418a44d5067133271bb6eeac2382f2bf94f7:Merge branch 'cve-2019-3016' into kvm-next-5.6\n\
  \nFrom Boris Ostrovsky:\n\nThe KVM hypervisor may provide a guest with ability to defer remote\
  \ TLB\nflush when the remote VCPU is not running. When this feature is used,\nthe TLB flush\
  \ will happen only when the remote VPCU is scheduled to run\nagain. This will avoid unnecessary\
  \ (and expensive) IPIs.\n\nUnder certain circumstances, when a guest initiates such deferred\
  \ action,\nthe hypervisor may miss the request. It is also possible that the guest\nmay mistakenly\
  \ assume that it has already marked remote VCPU as needing\na flush when in fact that request\
  \ had already been processed by the\nhypervisor. In both cases this will result in an invalid\
  \ translation\nbeing present in a vCPU, potentially allowing accesses to memory locations\n\
  in that guest's address space that should not be accessible.\n\nNote that only intra-guest\
  \ memory is vulnerable.\n\nThe five patches address both of these problems:\n1. The first\
  \ patch makes sure the hypervisor doesn't accidentally clear\na guest's remote flush request\n\
  2. The rest of the patches prevent the race between hypervisor\nacknowledging a remote flush\
  \ request and guest issuing a new one.\n\nConflicts:\n\tarch/x86/kvm/x86.c [move from kvm_arch_vcpu_free\
  \ to kvm_arch_vcpu_destroy]"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 4cbc418a44d5067133271bb6eeac2382f2bf94f7
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/4cbc418a44d5067133271bb6eeac2382f2bf94f7
    reference_type: commit
    reference_id: 4cbc418a44d5067133271bb6eeac2382f2bf94f7
