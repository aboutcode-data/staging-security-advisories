advisory_id: CVE-2014-0206
datasource_id: collect_linux_fix_commits/CVE-2014-0206
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  10b5b5361a3c2a7fff9dbfa0f127adc2531e7732:Merge git://git.kvack.org/~bcrl/aio-fixes

  Pull aio fixes from Ben LaHaise:
   "These fix a kernel memory disclosure issue (arbitrary kmap() &
    copy_to_user()) revealed in CVE-2014-0206 by changes that were
    introduced in v3.10"

  * git://git.kvack.org/~bcrl/aio-fixes:
    aio: fix kernel memory disclosure in io_getevents() introduced in v3.10
    aio: fix aio request leak when events are reaped by userspace
  edfbbf388f293d70bf4b7c0bc38774d05e6f711a:aio: fix kernel memory disclosure in io_getevents() introduced in v3.10

  A kernel memory disclosure was introduced in aio_read_events_ring() in v3.10
  by commit a31ad380bed817aa25f8830ad23e1a0480fef797.  The changes made to
  aio_read_events_ring() failed to correctly limit the index into
  ctx->ring_pages[], allowing an attacked to cause the subsequent kmap() of
  an arbitrary page with a copy_to_user() to copy the contents into userspace.
  This vulnerability has been assigned CVE-2014-0206.  Thanks to Mateusz and
  Petr for disclosing this issue.

  This patch applies to v3.12+.  A separate backport is needed for 3.10/3.11.

  Signed-off-by: Benjamin LaHaise <bcrl@kvack.org>
  Cc: Mateusz Guzik <mguzik@redhat.com>
  Cc: Petr Matousek <pmatouse@redhat.com>
  Cc: Kent Overstreet <kmo@daterainc.com>
  Cc: Jeff Moyer <jmoyer@redhat.com>
  Cc: stable@vger.kernel.org
  f8567a3845ac05bb28f3c1b478ef752762bd39ef:aio: fix aio request leak when events are reaped by userspace

  The aio cleanups and optimizations by kmo that were merged into the 3.10
  tree added a regression for userspace event reaping.  Specifically, the
  reference counts are not decremented if the event is reaped in userspace,
  leading to the application being unable to submit further aio requests.
  This patch applies to 3.12+.  A separate backport is required for 3.10/3.11.
  This issue was uncovered as part of CVE-2014-0206.

  Signed-off-by: Benjamin LaHaise <bcrl@kvack.org>
  Cc: stable@vger.kernel.org
  Cc: Kent Overstreet <kmo@daterainc.com>
  Cc: Mateusz Guzik <mguzik@redhat.com>
  Cc: Petr Matousek <pmatouse@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 10b5b5361a3c2a7fff9dbfa0f127adc2531e7732
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: f8567a3845ac05bb28f3c1b478ef752762bd39ef
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: edfbbf388f293d70bf4b7c0bc38774d05e6f711a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/10b5b5361a3c2a7fff9dbfa0f127adc2531e7732
    reference_type: commit
    reference_id: 10b5b5361a3c2a7fff9dbfa0f127adc2531e7732
  - url: https://github.com/torvalds/linux/tree/edfbbf388f293d70bf4b7c0bc38774d05e6f711a
    reference_type: commit
    reference_id: edfbbf388f293d70bf4b7c0bc38774d05e6f711a
  - url: https://github.com/torvalds/linux/tree/f8567a3845ac05bb28f3c1b478ef752762bd39ef
    reference_type: commit
    reference_id: f8567a3845ac05bb28f3c1b478ef752762bd39ef
