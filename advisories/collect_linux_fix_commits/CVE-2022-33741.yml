advisory_id: CVE-2022-33741
datasource_id: collect_linux_fix_commits/CVE-2022-33741
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  e35e5b6f695d241ffb1d223207da58a1fbcdff4b:Merge tag 'xsa-5.19-tag' of git://git.kernel.org/pub/scm/linux/kernel/git/xen/tip

  Pull xen security fixes from Juergen Gross:

   - XSA-403 (4 patches for blkfront and netfront drivers):

     Linux Block and Network PV device frontends don't zero memory regions
     before sharing them with the backend (CVE-2022-26365,
     CVE-2022-33740). Additionally the granularity of the grant table
     doesn't allow sharing less than a 4K page, leading to unrelated data
     residing in the same 4K page as data shared with a backend being
     accessible by such backend (CVE-2022-33741, CVE-2022-33742).

   - XSA-405 (1 patch for netfront driver, only 5.10 and newer):

     While adding logic to support XDP (eXpress Data Path), a code label
     was moved in a way allowing for SKBs having references (pointers)
     retained for further processing to nevertheless be freed.

   - XSA-406 (1 patch for Arm specific dom0 code):

     When mapping pages of guests on Arm, dom0 is using an rbtree to keep
     track of the foreign mappings.

     Updating of that rbtree is not always done completely with the
     related lock held, resulting in a small race window, which can be
     used by unprivileged guests via PV devices to cause inconsistencies
     of the rbtree. These inconsistencies can lead to Denial of Service
     (DoS) of dom0, e.g. by causing crashes or the inability to perform
     further mappings of other guests' memory pages.

  * tag 'xsa-5.19-tag' of git://git.kernel.org/pub/scm/linux/kernel/git/xen/tip:
    xen/arm: Fix race in RB-tree based P2M accounting
    xen-netfront: restore __skb_queue_tail() positioning in xennet_get_responses()
    xen/blkfront: force data bouncing when backend is untrusted
    xen/netfront: force data bouncing when backend is untrusted
    xen/netfront: fix leaking data in shared pages
    xen/blkfront: fix leaking data in shared pages
  4491001c2e0fa69efbb748c96ec96b100a5cdb7e:xen/netfront: force data bouncing when backend is untrusted

  Bounce all data on the skbs to be transmitted into zeroed pages if the
  backend is untrusted. This avoids leaking data present in the pages
  shared with the backend but not part of the skb fragments.  This
  requires introducing a new helper in order to allocate skbs with a
  size multiple of XEN_PAGE_SIZE so we don't leak contiguous data on the
  granted pages.

  Reporting whether the backend is to be trusted can be done using a
  module parameter, or from the xenstore frontend path as set by the
  toolstack when adding the device.

  This is CVE-2022-33741, part of XSA-403.

  Signed-off-by: Roger Pau Monn√© <roger.pau@citrix.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Juergen Gross <jgross@suse.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 4491001c2e0fa69efbb748c96ec96b100a5cdb7e
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: e35e5b6f695d241ffb1d223207da58a1fbcdff4b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/4491001c2e0fa69efbb748c96ec96b100a5cdb7e
    reference_type: commit
    reference_id: 4491001c2e0fa69efbb748c96ec96b100a5cdb7e
  - url: https://github.com/torvalds/linux/tree/e35e5b6f695d241ffb1d223207da58a1fbcdff4b
    reference_type: commit
    reference_id: e35e5b6f695d241ffb1d223207da58a1fbcdff4b
