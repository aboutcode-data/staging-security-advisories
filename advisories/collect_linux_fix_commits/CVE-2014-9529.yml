advisory_id: CVE-2014-9529
datasource_id: collect_linux_fix_commits/CVE-2014-9529
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  086b2a942e794a03e5ea7503f45f2353559b5a3e:Merge tag 'keys-fixes-20150107' of git://git.kernel.org/pub/scm/linux/kernel/git/dhowells/linux-fs

  Pull keyrings fixes from David Howells:
   "Two fixes:

     - Fix for the order in which things are done during key garbage
       collection to prevent named keyrings causing a crash
       [CVE-2014-9529].

     - Fix assoc_array to explicitly #include rcupdate.h to prevent
       compilation errors under certain circumstances"

  * tag 'keys-fixes-20150107' of git://git.kernel.org/pub/scm/linux/kernel/git/dhowells/linux-fs:
    assoc_array: Include rcupdate.h for call_rcu() definition
    KEYS: close race between key lookup and freeing
  a3a8784454692dd72e5d5d34dcdab17b4420e74c:KEYS: close race between key lookup and freeing

  When a key is being garbage collected, it's key->user would get put before
  the ->destroy() callback is called, where the key is removed from it's
  respective tracking structures.

  This leaves a key hanging in a semi-invalid state which leaves a window open
  for a different task to try an access key->user. An example is
  find_keyring_by_name() which would dereference key->user for a key that is
  in the process of being garbage collected (where key->user was freed but
  ->destroy() wasn't called yet - so it's still present in the linked list).

  This would cause either a panic, or corrupt memory.

  Fixes CVE-2014-9529.

  Signed-off-by: Sasha Levin <sasha.levin@oracle.com>
  Signed-off-by: David Howells <dhowells@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 086b2a942e794a03e5ea7503f45f2353559b5a3e
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: a3a8784454692dd72e5d5d34dcdab17b4420e74c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/086b2a942e794a03e5ea7503f45f2353559b5a3e
    reference_type: commit
    reference_id: 086b2a942e794a03e5ea7503f45f2353559b5a3e
  - url: https://github.com/torvalds/linux/tree/a3a8784454692dd72e5d5d34dcdab17b4420e74c
    reference_type: commit
    reference_id: a3a8784454692dd72e5d5d34dcdab17b4420e74c
