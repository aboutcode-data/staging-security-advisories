advisory_id: CVE-2013-4587
datasource_id: collect_linux_fix_commits/CVE-2013-4587
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f:Merge tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm

  Pull kvm fixes from Paolo Bonzini:
   "Four security fixes for KVM on x86.  Thanks to Andrew Honig and Lars
    Bull from Google for reporting them"

  * tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm:
    KVM: x86: fix guest-initiated crash with x2apic (CVE-2013-6376)
    KVM: x86: Convert vapic synchronization to _cached functions (CVE-2013-6368)
    KVM: x86: Fix potential divide by 0 in lapic (CVE-2013-6367)
    KVM: Improve create VCPU parameter (CVE-2013-4587)
  338c7dbadd2671189cec7faf64c84d01071b3f96:KVM: Improve create VCPU parameter (CVE-2013-4587)

  In multiple functions the vcpu_id is used as an offset into a bitfield.  Ag
  malicious user could specify a vcpu_id greater than 255 in order to set or
  clear bits in kernel memory.  This could be used to elevate priveges in the
  kernel.  This patch verifies that the vcpu_id provided is less than 255.
  The api documentation already specifies that the vcpu_id must be less than
  max_vcpus, but this is currently not checked.

  Reported-by: Andrew Honig <ahonig@google.com>
  Cc: stable@vger.kernel.org
  Signed-off-by: Andrew Honig <ahonig@google.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 338c7dbadd2671189cec7faf64c84d01071b3f96
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/338c7dbadd2671189cec7faf64c84d01071b3f96
    reference_type: commit
    reference_id: 338c7dbadd2671189cec7faf64c84d01071b3f96
  - url: https://github.com/torvalds/linux/tree/54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f
    reference_type: commit
    reference_id: 54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f
