advisory_id: CVE-2019-19332
datasource_id: collect_linux_fix_commits/CVE-2019-19332
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  aedc0650f9135f3b92b39cbed1a8fe98d8088825:Merge tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm

  Pull more KVM updates from Paolo Bonzini:

   - PPC secure guest support

   - small x86 cleanup

   - fix for an x86-specific out-of-bounds write on a ioctl (not guest
     triggerable, data not attacker-controlled)

  * tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm:
    kvm: vmx: Stop wasting a page for guest_msrs
    KVM: x86: fix out-of-bounds write in KVM_GET_EMULATED_CPUID (CVE-2019-19332)
    Documentation: kvm: Fix mention to number of ioctls classes
    powerpc: Ultravisor: Add PPC_UV config option
    KVM: PPC: Book3S HV: Support reset of secure guest
    KVM: PPC: Book3S HV: Handle memory plug/unplug to secure VM
    KVM: PPC: Book3S HV: Radix changes for secure guest
    KVM: PPC: Book3S HV: Shared pages support for secure guests
    KVM: PPC: Book3S HV: Support for running secure guests
    mm: ksm: Export ksm_madvise()
    KVM x86: Move kvm cpuid support out of svm
  433f4ba1904100da65a311033f17a9bf586b287e:KVM: x86: fix out-of-bounds write in KVM_GET_EMULATED_CPUID (CVE-2019-19332)

  The bounds check was present in KVM_GET_SUPPORTED_CPUID but not
  KVM_GET_EMULATED_CPUID.

  Reported-by: syzbot+e3f4897236c4eeb8af4f@syzkaller.appspotmail.com
  Fixes: 84cffe499b94 ("kvm: Emulate MOVBE", 2013-10-29)
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: aedc0650f9135f3b92b39cbed1a8fe98d8088825
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 433f4ba1904100da65a311033f17a9bf586b287e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/433f4ba1904100da65a311033f17a9bf586b287e
    reference_type: commit
    reference_id: 433f4ba1904100da65a311033f17a9bf586b287e
  - url: https://github.com/torvalds/linux/tree/aedc0650f9135f3b92b39cbed1a8fe98d8088825
    reference_type: commit
    reference_id: aedc0650f9135f3b92b39cbed1a8fe98d8088825
