advisory_id: CVE-2024-53240
datasource_id: collect_linux_fix_commits/CVE-2024-53240
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  f9244fb55f37356f75c739c57323d9422d7aa0f8:xen/netfront: fix crash when removing device

  When removing a netfront device directly after a suspend/resume cycle
  it might happen that the queues have not been setup again, causing a
  crash during the attempt to stop the queues another time.

  Fix that by checking the queues are existing before trying to stop
  them.

  This is XSA-465 / CVE-2024-53240.

  Reported-by: Marek Marczykowski-GÃ³recki <marmarek@invisiblethingslab.com>
  Fixes: d50b7914fae0 ("xen-netfront: Fix NULL sring after live migration")
  Signed-off-by: Juergen Gross <jgross@suse.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: f9244fb55f37356f75c739c57323d9422d7aa0f8
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/f9244fb55f37356f75c739c57323d9422d7aa0f8
    reference_type: commit
    reference_id: f9244fb55f37356f75c739c57323d9422d7aa0f8
