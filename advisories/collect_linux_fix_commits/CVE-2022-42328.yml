advisory_id: CVE-2022-42328
datasource_id: collect_linux_fix_commits/CVE-2022-42328
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  74e7e1efdad45580cc3839f2a155174cf158f9b5:xen/netback: don't call kfree_skb() with interrupts disabled

  It is not allowed to call kfree_skb() from hardware interrupt
  context or with interrupts being disabled. So remove kfree_skb()
  from the spin_lock_irqsave() section and use the already existing
  "drop" label in xenvif_start_xmit() for dropping the SKB. At the
  same time replace the dev_kfree_skb() call there with a call of
  dev_kfree_skb_any(), as xenvif_start_xmit() can be called with
  disabled interrupts.

  This is XSA-424 / CVE-2022-42328 / CVE-2022-42329.

  Fixes: be81992f9086 ("xen/netback: don't queue unlimited number of packages")
  Reported-by: Yang Yingliang <yangyingliang@huawei.com>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  Signed-off-by: Juergen Gross <jgross@suse.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 74e7e1efdad45580cc3839f2a155174cf158f9b5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/74e7e1efdad45580cc3839f2a155174cf158f9b5
    reference_type: commit
    reference_id: 74e7e1efdad45580cc3839f2a155174cf158f9b5
