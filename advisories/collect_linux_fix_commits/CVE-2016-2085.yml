advisory_id: CVE-2016-2085
datasource_id: collect_linux_fix_commits/CVE-2016-2085
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  613317bd212c585c20796c10afe5daaa95d4b0a1:EVM: Use crypto_memneq() for digest comparisons

  This patch fixes vulnerability CVE-2016-2085.  The problem exists
  because the vm_verify_hmac() function includes a use of memcmp().
  Unfortunately, this allows timing side channel attacks; specifically
  a MAC forgery complexity drop from 2^128 to 2^12.  This patch changes
  the memcmp() to the cryptographically safe crypto_memneq().

  Reported-by: Xiaofei Rex Guo <xiaofei.rex.guo@intel.com>
  Signed-off-by: Ryan Ware <ware@linux.intel.com>
  Cc: stable@vger.kernel.org
  Signed-off-by: Mimi Zohar <zohar@linux.vnet.ibm.com>
  Signed-off-by: James Morris <james.l.morris@oracle.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 613317bd212c585c20796c10afe5daaa95d4b0a1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/613317bd212c585c20796c10afe5daaa95d4b0a1
    reference_type: commit
    reference_id: 613317bd212c585c20796c10afe5daaa95d4b0a1
