advisory_id: CVE-2021-3656
datasource_id: collect_linux_fix_commits/CVE-2021-3656
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  faf6b755629627f19feafa75b32e81cd7738f12d:KVM: x86: nSVM: don't copy virt_ext from vmcb12

  These field correspond to features that we don't expose yet to L2

  While currently there are no CVE worthy features in this field,
  if AMD adds more features to this field, that could allow guest
  escapes similar to CVE-2021-3653 and CVE-2021-3656.

  Signed-off-by: Maxim Levitsky <mlevitsk@redhat.com>
  Message-Id: <20210914154825.104886-6-mlevitsk@redhat.com>
  Cc: stable@vger.kernel.org
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  02a3715449a0edf06a37efe3862bc7732099a220:Merge tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm

  Pull KVM fixes from Paolo Bonzini:
   "Two nested virtualization fixes for AMD processors"

  * tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm:
    KVM: nSVM: always intercept VMLOAD/VMSAVE when nested (CVE-2021-3656)
    KVM: nSVM: avoid picking up unsupported bits from L2 in int_ctl (CVE-2021-3653)
  c7dfa4009965a9b2d7b329ee970eb8da0d32f0bc:KVM: nSVM: always intercept VMLOAD/VMSAVE when nested (CVE-2021-3656)

  If L1 disables VMLOAD/VMSAVE intercepts, and doesn't enable
  Virtual VMLOAD/VMSAVE (currently not supported for the nested hypervisor),
  then VMLOAD/VMSAVE must operate on the L1 physical memory, which is only
  possible by making L0 intercept these instructions.

  Failure to do so allowed the nested guest to run VMLOAD/VMSAVE unintercepted,
  and thus read/write portions of the host physical memory.

  Fixes: 89c8a4984fc9 ("KVM: SVM: Enable Virtual VMLOAD VMSAVE feature")

  Suggested-by: Paolo Bonzini <pbonzini@redhat.com>
  Signed-off-by: Maxim Levitsky <mlevitsk@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 02a3715449a0edf06a37efe3862bc7732099a220
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: c7dfa4009965a9b2d7b329ee970eb8da0d32f0bc
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: faf6b755629627f19feafa75b32e81cd7738f12d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/02a3715449a0edf06a37efe3862bc7732099a220
    reference_type: commit
    reference_id: 02a3715449a0edf06a37efe3862bc7732099a220
  - url: https://github.com/torvalds/linux/tree/c7dfa4009965a9b2d7b329ee970eb8da0d32f0bc
    reference_type: commit
    reference_id: c7dfa4009965a9b2d7b329ee970eb8da0d32f0bc
  - url: https://github.com/torvalds/linux/tree/faf6b755629627f19feafa75b32e81cd7738f12d
    reference_type: commit
    reference_id: faf6b755629627f19feafa75b32e81cd7738f12d
