advisory_id: CVE-2019-7222
datasource_id: collect_linux_fix_commits/CVE-2019-7222
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  6fb845f0e78de19eaaf6a2d351702474e44b6a9e:Merge tag 'v5.0-rc6' into for-5.1/block

  Pull in 5.0-rc6 to avoid a dumb merge conflict with fs/iomap.c.
  This is needed since io_uring is now based on the block branch,
  to avoid a conflict between the multi-page bvecs and the bits
  of io_uring that touch the core block parts.

  * tag 'v5.0-rc6': (525 commits)
    Linux 5.0-rc6
    x86/mm: Make set_pmd_at() paravirt aware
    MAINTAINERS: Update the ocores i2c bus driver maintainer, etc
    blk-mq: remove duplicated definition of blk_mq_freeze_queue
    Blk-iolatency: warn on negative inflight IO counter
    blk-iolatency: fix IO hang due to negative inflight counter
    MAINTAINERS: unify reference to xen-devel list
    x86/mm/cpa: Fix set_mce_nospec()
    futex: Handle early deadlock return correctly
    futex: Fix barrier comment
    net: dsa: b53: Fix for failure when irq is not defined in dt
    blktrace: Show requests without sector
    mips: cm: reprime error cause
    mips: loongson64: remove unreachable(), fix loongson_poweroff().
    sit: check if IPv6 enabled before calling ip6_err_gen_icmpv6_unreach()
    geneve: should not call rt6_lookup() when ipv6 was disabled
    KVM: nVMX: unconditionally cancel preemption timer in free_nested (CVE-2019-7221)
    KVM: x86: work around leak of uninitialized stack contents (CVE-2019-7222)
    kvm: fix kvm_ioctl_create_device() reference counting (CVE-2019-6974)
    signal: Better detection of synchronous signals
    ...
  e303a067ceede918fbf90ff3dc8affbb98bad4e8:Merge tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm

  Pull KVM fixes from Paolo Bonzini:
   "Three security fixes"

  * tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm:
    KVM: nVMX: unconditionally cancel preemption timer in free_nested (CVE-2019-7221)
    KVM: x86: work around leak of uninitialized stack contents (CVE-2019-7222)
    kvm: fix kvm_ioctl_create_device() reference counting (CVE-2019-6974)
  353c0956a618a07ba4bbe7ad00ff29fe70e8412a:KVM: x86: work around leak of uninitialized stack contents (CVE-2019-7222)

  Bugzilla: 1671930

  Emulation of certain instructions (VMXON, VMCLEAR, VMPTRLD, VMWRITE with
  memory operand, INVEPT, INVVPID) can incorrectly inject a page fault
  when passed an operand that points to an MMIO address.  The page fault
  will use uninitialized kernel stack memory as the CR2 and error code.

  The right behavior would be to abort the VM with a KVM_EXIT_INTERNAL_ERROR
  exit to userspace; however, it is not an easy fix, so for now just
  ensure that the error code and CR2 are zero.

  Embargoed until Feb 7th 2019.

  Reported-by: Felix Wilhelm <fwilhelm@google.com>
  Cc: stable@kernel.org
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: e303a067ceede918fbf90ff3dc8affbb98bad4e8
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 6fb845f0e78de19eaaf6a2d351702474e44b6a9e
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 353c0956a618a07ba4bbe7ad00ff29fe70e8412a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/353c0956a618a07ba4bbe7ad00ff29fe70e8412a
    reference_type: commit
    reference_id: 353c0956a618a07ba4bbe7ad00ff29fe70e8412a
  - url: https://github.com/torvalds/linux/tree/6fb845f0e78de19eaaf6a2d351702474e44b6a9e
    reference_type: commit
    reference_id: 6fb845f0e78de19eaaf6a2d351702474e44b6a9e
  - url: https://github.com/torvalds/linux/tree/e303a067ceede918fbf90ff3dc8affbb98bad4e8
    reference_type: commit
    reference_id: e303a067ceede918fbf90ff3dc8affbb98bad4e8
