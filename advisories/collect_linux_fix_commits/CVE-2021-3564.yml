advisory_id: CVE-2021-3564
datasource_id: collect_linux_fix_commits/CVE-2021-3564
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  579028dec182c026b9a85725682f1dfbdc825eaa:Merge tag 'for-net-2021-06-03' of git://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth

  bluetooth pull request for net:

   - Fixes UAF and CVE-2021-3564
   - Fix VIRTIO_ID_BT to use an unassigned ID
   - Fix firmware loading on some Intel Controllers

  Signed-off-by: David S. Miller <davem@davemloft.net>
  6a137caec23aeb9e036cdfd8a46dd8a366460e5d:Bluetooth: fix the erroneous flush_work() order

  In the cleanup routine for failed initialization of HCI device,
  the flush_work(&hdev->rx_work) need to be finished before the
  flush_work(&hdev->cmd_work). Otherwise, the hci_rx_work() can
  possibly invoke new cmd_work and cause a bug, like double free,
  in late processings.

  This was assigned CVE-2021-3564.

  This patch reorder the flush_work() to fix this bug.

  Cc: Marcel Holtmann <marcel@holtmann.org>
  Cc: Johan Hedberg <johan.hedberg@gmail.com>
  Cc: Luiz Augusto von Dentz <luiz.dentz@gmail.com>
  Cc: "David S. Miller" <davem@davemloft.net>
  Cc: Jakub Kicinski <kuba@kernel.org>
  Cc: linux-bluetooth@vger.kernel.org
  Cc: netdev@vger.kernel.org
  Cc: linux-kernel@vger.kernel.org
  Signed-off-by: Lin Ma <linma@zju.edu.cn>
  Signed-off-by: Hao Xiong <mart1n@zju.edu.cn>
  Cc: stable <stable@vger.kernel.org>
  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
  Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 6a137caec23aeb9e036cdfd8a46dd8a366460e5d
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 579028dec182c026b9a85725682f1dfbdc825eaa
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/579028dec182c026b9a85725682f1dfbdc825eaa
    reference_type: commit
    reference_id: 579028dec182c026b9a85725682f1dfbdc825eaa
  - url: https://github.com/torvalds/linux/tree/6a137caec23aeb9e036cdfd8a46dd8a366460e5d
    reference_type: commit
    reference_id: 6a137caec23aeb9e036cdfd8a46dd8a366460e5d
