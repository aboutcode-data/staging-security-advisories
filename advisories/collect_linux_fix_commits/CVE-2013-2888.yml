advisory_id: CVE-2013-2888
datasource_id: collect_linux_fix_commits/CVE-2013-2888
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  22e04f6b4b04a8afe9af9239224591d06ba3b24d:Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/hid

  Pull HID updates from Jiri Kosina:
   "Highlights:

     - conversion of HID subsystem to use devm-based resource management,
       from Benjamin Tissoires

     - i2c-hid support for DT bindings, from Benjamin Tissoires

     - much improved support for Win8-multitouch devices, from Benjamin
       Tissoires

     - cleanup of core code using common hidinput_input_event(), from
       David Herrmann

     - fix for bug in implement() access to the bit stream (causing oops)
       that has been present in the code for ages, but devices that are
       able to trigger it have started to appear only now, from Jiri
       Kosina

     - fixes for CVE-2013-2899, CVE-2013-2898, CVE-2013-2896,
       CVE-2013-2892, CVE-2013-2888 (all triggerable only by specially
       crafted malicious HW devices plugged into the system), from Kees
       Cook

     - hidraw oops fix, from Manoj Chourasia

     - various smaller fixes here and there, support for a bunch of new
       devices by various contributors"

  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/hid: (53 commits)
    HID: MAINTAINERS: add roccat drivers
    HID: hid-sensor-hub: change kmalloc + memcpy by kmemdup
    HID: hid-sensor-hub: move to devm_kzalloc
    HID: hid-sensor-hub: fix indentation accross the code
    HID: move HID_REPORT_TYPES closer to the report-definitions
    HID: check for NULL field when setting values
    HID: picolcd_core: validate output report details
    HID: sensor-hub: validate feature report details
    HID: ntrig: validate feature report details
    HID: pantherlord: validate output report details
    HID: hid-wiimote: print small buffers via %*phC
    HID: uhid: improve uhid example client
    HID: Correct the USB IDs for the new Macbook Air 6
    HID: wiimote: add support for Guitar-Hero guitars
    HID: wiimote: add support for Guitar-Hero drums
    Input: introduce BTN/ABS bits for drums and guitars
    HID: battery: don't do DMA from stack
    HID: roccat: add support for KonePureOptical v2
    HID: picolcd: Prevent NULL pointer dereference on _remove()
    HID: usbhid: quirk for N-Trig DuoSense Touch Screen
    ...
  47ab1a2de42031021965b81cbab4f3b4c5696d07:Merge branch 'for-3.11/CVE-2013-2888' into for-3.12/upstream

  This one didn't make it for 3.11 due to being applied too close
  to release, queue it for 3.12 merge window.

  Signed-off-by: Jiri Kosina <jkosina@suse.cz>
  43622021d2e2b82ea03d883926605bdd0525e1d1:HID: validate HID report id size

  The "Report ID" field of a HID report is used to build indexes of
  reports. The kernel's index of these is limited to 256 entries, so any
  malicious device that sets a Report ID greater than 255 will trigger
  memory corruption on the host:

  [ 1347.156239] BUG: unable to handle kernel paging request at ffff88094958a878
  [ 1347.156261] IP: [<ffffffff813e4da0>] hid_register_report+0x2a/0x8b

  CVE-2013-2888

  Signed-off-by: Kees Cook <keescook@chromium.org>
  Cc: stable@kernel.org
  Signed-off-by: Jiri Kosina <jkosina@suse.cz>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 22e04f6b4b04a8afe9af9239224591d06ba3b24d
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 47ab1a2de42031021965b81cbab4f3b4c5696d07
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 43622021d2e2b82ea03d883926605bdd0525e1d1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/22e04f6b4b04a8afe9af9239224591d06ba3b24d
    reference_type: commit
    reference_id: 22e04f6b4b04a8afe9af9239224591d06ba3b24d
  - url: https://github.com/torvalds/linux/tree/43622021d2e2b82ea03d883926605bdd0525e1d1
    reference_type: commit
    reference_id: 43622021d2e2b82ea03d883926605bdd0525e1d1
  - url: https://github.com/torvalds/linux/tree/47ab1a2de42031021965b81cbab4f3b4c5696d07
    reference_type: commit
    reference_id: 47ab1a2de42031021965b81cbab4f3b4c5696d07
