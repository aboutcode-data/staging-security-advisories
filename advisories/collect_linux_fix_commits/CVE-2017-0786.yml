advisory_id: CVE-2017-0786
datasource_id: collect_linux_fix_commits/CVE-2017-0786
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  20c62c797e85b589152970089eaf22a7d88d989a:Merge tag 'wireless-drivers-for-davem-2017-09-25' of git://git.kernel.org/pub/scm/linux/kernel/git/kvalo/wireless-drivers

  Kalle Valo says:

  ====================
  wireless-drivers fixes for 4.14

  Quite a lot of fixes this time. Most notable is the brcmfmac fix for a
  CVE issue.

  iwlwifi

  * a couple of bugzilla bugs related to multicast handling

  * two fixes for WoWLAN bugs that were causing queue hangs and
    re-initialization problems

  * two fixes for potential uninitialized variable use reported by Dan
    Carpenter in relation to a recently introduced patch

  * a fix for buffer reordering in the newly supported 9000 device
    family

  * fix a race when starting aggregation

  * small fix for a recent patch to wake mac80211 queues

  * send non-bufferable management frames in the generic queue so they
    are not sent on queues that are under power-save

  ath10k

  * fix a PCI PM related gcc warning

  brcmfmac

  * CVE-2017-0786: add length check scan results from firmware

  * respect passive scan requests from user space

  qtnfmac

  * fix race in tx path when using multiple interfaces

  * cancel ongoing scan when removing the wireless interface
  ====================

  Signed-off-by: David S. Miller <davem@davemloft.net>
  17df6453d4be17910456e99c5a85025aa1b7a246:brcmfmac: add length check in brcmf_cfg80211_escan_handler()

  Upon handling the firmware notification for scans the length was
  checked properly and may result in corrupting kernel heap memory
  due to buffer overruns. This fix addresses CVE-2017-0786.

  Cc: stable@vger.kernel.org # v4.0.x
  Cc: Kevin Cernekee <cernekee@chromium.org>
  Reviewed-by: Hante Meuleman <hante.meuleman@broadcom.com>
  Reviewed-by: Pieter-Paul Giesberts <pieter-paul.giesberts@broadcom.com>
  Reviewed-by: Franky Lin <franky.lin@broadcom.com>
  Signed-off-by: Arend van Spriel <arend.vanspriel@broadcom.com>
  Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 17df6453d4be17910456e99c5a85025aa1b7a246
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 20c62c797e85b589152970089eaf22a7d88d989a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/17df6453d4be17910456e99c5a85025aa1b7a246
    reference_type: commit
    reference_id: 17df6453d4be17910456e99c5a85025aa1b7a246
  - url: https://github.com/torvalds/linux/tree/20c62c797e85b589152970089eaf22a7d88d989a
    reference_type: commit
    reference_id: 20c62c797e85b589152970089eaf22a7d88d989a
