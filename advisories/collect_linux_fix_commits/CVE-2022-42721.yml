advisory_id: CVE-2022-42721
datasource_id: collect_linux_fix_commits/CVE-2022-42721
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  bcca852027e5878aec911a347407ecc88d6fff7f:wifi: cfg80211: avoid nontransmitted BSS list corruption

  If a non-transmitted BSS shares enough information (both
  SSID and BSSID!) with another non-transmitted BSS of a
  different AP, then we can find and update it, and then
  try to add it to the non-transmitted BSS list. We do a
  search for it on the transmitted BSS, but if it's not
  there (but belongs to another transmitted BSS), the list
  gets corrupted.

  Since this is an erroneous situation, simply fail the
  list insertion in this case and free the non-transmitted
  BSS.

  This fixes CVE-2022-42721.

  Reported-by: Sönke Huster <shuster@seemoo.tu-darmstadt.de>
  Tested-by: Sönke Huster <shuster@seemoo.tu-darmstadt.de>
  Fixes: 0b8fb8235be8 ("cfg80211: Parsing of Multiple BSSID information in scanning")
  Signed-off-by: Johannes Berg <johannes.berg@intel.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: bcca852027e5878aec911a347407ecc88d6fff7f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/bcca852027e5878aec911a347407ecc88d6fff7f
    reference_type: commit
    reference_id: bcca852027e5878aec911a347407ecc88d6fff7f
