advisory_id: CVE-2022-42719
datasource_id: collect_linux_fix_commits/CVE-2022-42719
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  ff05d4b45dd89b922578dac497dcabf57cf771c6:wifi: mac80211: fix MBSSID parsing use-after-free

  When we parse a multi-BSSID element, we might point some
  element pointers into the allocated nontransmitted_profile.
  However, we free this before returning, causing UAF when the
  relevant pointers in the parsed elements are accessed.

  Fix this by not allocating the scratch buffer separately but
  as part of the returned structure instead, that way, there
  are no lifetime issues with it.

  The scratch buffer introduction as part of the returned data
  here is taken from MLO feature work done by Ilan.

  This fixes CVE-2022-42719.

  Fixes: 5023b14cf4df ("mac80211: support profile split between elements")
  Co-developed-by: Ilan Peer <ilan.peer@intel.com>
  Signed-off-by: Ilan Peer <ilan.peer@intel.com>
  Reviewed-by: Kees Cook <keescook@chromium.org>
  Signed-off-by: Johannes Berg <johannes.berg@intel.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: ff05d4b45dd89b922578dac497dcabf57cf771c6
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/ff05d4b45dd89b922578dac497dcabf57cf771c6
    reference_type: commit
    reference_id: ff05d4b45dd89b922578dac497dcabf57cf771c6
