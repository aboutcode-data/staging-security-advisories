advisory_id: CVE-2022-41674
datasource_id: collect_linux_fix_commits/CVE-2022-41674
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "8f033d2becc24aa6bfd2a5c104407963560caabc:wifi: cfg80211/mac80211: reject bad MBSSID\
  \ elements\n\nPer spec, the maximum value for the MaxBSSID ('n') indicator is 8,\nand the\
  \ minimum is 1 since a multiple BSSID set with just one BSSID\ndoesn't make sense (the # of\
  \ BSSIDs is limited by 2^n).\n\nLimit this in the parsing in both cfg80211 and mac80211, rejecting\n\
  any elements with an invalid value.\n\nThis fixes potentially bad shifts in the processing\
  \ of these inside\nthe cfg80211_gen_new_bssid() function later.\n\nI found this during the\
  \ investigation of CVE-2022-41674 fixed by the\nprevious patch.\n\nFixes: 0b8fb8235be8 (\"\
  cfg80211: Parsing of Multiple BSSID information in scanning\")\nFixes: 78ac51f81532 (\"mac80211:\
  \ support multi-bssid\")\nReviewed-by: Kees Cook <keescook@chromium.org>\nSigned-off-by: Johannes\
  \ Berg <johannes.berg@intel.com>\naebe9f4639b13a1f4e9a6b42cdd2e38c617b442d:wifi: cfg80211:\
  \ fix u8 overflow in cfg80211_update_notlisted_nontrans()\n\nIn the copy code of the elements,\
  \ we do the following calculation\nto reach the end of the MBSSID element:\n\n\t/* copy the\
  \ IEs after MBSSID */\n\tcpy_len = mbssid[1] + 2;\n\nThis looks fine, however, cpy_len is\
  \ a u8, the same as mbssid[1],\nso the addition of two can overflow. In this case the subsequent\n\
  memcpy() will overflow the allocated buffer, since it copies 256\nbytes too much due to the\
  \ way the allocation and memcpy() sizes\nare calculated.\n\nFix this by using size_t for the\
  \ cpy_len variable.\n\nThis fixes CVE-2022-41674.\n\nReported-by: Soenke Huster <shuster@seemoo.tu-darmstadt.de>\n\
  Tested-by: Soenke Huster <shuster@seemoo.tu-darmstadt.de>\nFixes: 0b8fb8235be8 (\"cfg80211:\
  \ Parsing of Multiple BSSID information in scanning\")\nReviewed-by: Kees Cook <keescook@chromium.org>\n\
  Signed-off-by: Johannes Berg <johannes.berg@intel.com>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 8f033d2becc24aa6bfd2a5c104407963560caabc
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: aebe9f4639b13a1f4e9a6b42cdd2e38c617b442d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/8f033d2becc24aa6bfd2a5c104407963560caabc
    reference_type: commit
    reference_id: 8f033d2becc24aa6bfd2a5c104407963560caabc
  - url: https://github.com/torvalds/linux/tree/aebe9f4639b13a1f4e9a6b42cdd2e38c617b442d
    reference_type: commit
    reference_id: aebe9f4639b13a1f4e9a6b42cdd2e38c617b442d
