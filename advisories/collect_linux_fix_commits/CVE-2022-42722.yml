advisory_id: CVE-2022-42722
datasource_id: collect_linux_fix_commits/CVE-2022-42722
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  b2d03cabe2b2e150ff5a381731ea0355459be09f:wifi: mac80211: fix crash in beacon protection for P2P-device

  If beacon protection is active but the beacon cannot be
  decrypted or is otherwise malformed, we call the cfg80211
  API to report this to userspace, but that uses a netdev
  pointer, which isn't present for P2P-Device. Fix this to
  call it only conditionally to ensure cfg80211 won't crash
  in the case of P2P-Device.

  This fixes CVE-2022-42722.

  Reported-by: SÃ¶nke Huster <shuster@seemoo.tu-darmstadt.de>
  Fixes: 9eaf183af741 ("mac80211: Report beacon protection failures to user space")
  Signed-off-by: Johannes Berg <johannes.berg@intel.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: b2d03cabe2b2e150ff5a381731ea0355459be09f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/b2d03cabe2b2e150ff5a381731ea0355459be09f
    reference_type: commit
    reference_id: b2d03cabe2b2e150ff5a381731ea0355459be09f
