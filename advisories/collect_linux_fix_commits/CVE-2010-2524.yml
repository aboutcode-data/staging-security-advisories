advisory_id: CVE-2010-2524
datasource_id: collect_linux_fix_commits/CVE-2010-2524
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "4c0c03ca54f72fdd5912516ad0a23ec5cf01bda7:CIFS: Fix a malicious redirect problem in\
  \ the DNS lookup code\n\nFix the security problem in the CIFS filesystem DNS lookup code in\
  \ which a\nmalicious redirect could be installed by a random user by simply adding a\nresult\
  \ record into one of their keyrings with add_key() and then invoking a\nCIFS CFS lookup [CVE-2010-2524].\n\
  \nThis is done by creating an internal keyring specifically for the caching of\nDNS lookups.\
  \  To enforce the use of this keyring, the module init routine\ncreates a set of override\
  \ credentials with the keyring installed as the thread\nkeyring and instructs request_key()\
  \ to only install lookup result keys in that\nkeyring.\n\nThe override is then applied around\
  \ the call to request_key().\n\nThis has some additional benefits when a kernel service uses\
  \ this module to\nrequest a key:\n\n (1) The result keys are owned by root, not the user that\
  \ caused the lookup.\n\n (2) The result keys don't pop up in the user's keyrings.\n\n (3)\
  \ The result keys don't come out of the quota of the user that caused the\n     lookup.\n\n\
  The keyring can be viewed as root by doing cat /proc/keys:\n\n2a0ca6c3 I-----     1 perm 1f030000\
  \     0     0 keyring   .dns_resolver: 1/4\n\nIt can then be listed with 'keyctl list' by\
  \ root.\n\n\t# keyctl list 0x2a0ca6c3\n\t1 key in keyring:\n\t726766307: --alswrv     0  \
  \   0 dns_resolver: foo.bar.com\n\nSigned-off-by: David Howells <dhowells@redhat.com>\nReviewed-and-Tested-by:\
  \ Jeff Layton <jlayton@redhat.com>\nAcked-by: Steve French <smfrench@gmail.com>\nSigned-off-by:\
  \ Linus Torvalds <torvalds@linux-foundation.org>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 4c0c03ca54f72fdd5912516ad0a23ec5cf01bda7
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/4c0c03ca54f72fdd5912516ad0a23ec5cf01bda7
    reference_type: commit
    reference_id: 4c0c03ca54f72fdd5912516ad0a23ec5cf01bda7
