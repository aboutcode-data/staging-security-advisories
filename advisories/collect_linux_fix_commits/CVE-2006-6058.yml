advisory_id: CVE-2006-6058
datasource_id: collect_linux_fix_commits/CVE-2006-6058
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  f44ec6f3f89889a469773b1fd894f8fcc07c29cf:limit minixfs printks on corrupted dir i_size

  This attempts to address CVE-2006-6058
  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6058

  first reported at http://projects.info-pull.com/mokb/MOKB-17-11-2006.html

  Essentially a corrupted minix dir inode reporting a very large
  i_size will loop for a very long time in minix_readdir, minix_find_entry,
  etc, because on EIO they just move on to try the next page.  This is
  under the BKL, printk-storming as well.  This can lock up the machine
  for a very long time.  Simply ratelimiting the printks gets things back
  under control.  Make the message a bit more informative while we're here.

  Signed-off-by: Eric Sandeen <sandeen@redhat.com>
  Cc: Bodo Eggert <7eggert@gmx.de>
  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
  f44ec6f3f89889a469773b1fd894f8fcc07c29cf:limit minixfs printks on corrupted dir i_size

  This attempts to address CVE-2006-6058
  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6058

  first reported at http://projects.info-pull.com/mokb/MOKB-17-11-2006.html

  Essentially a corrupted minix dir inode reporting a very large
  i_size will loop for a very long time in minix_readdir, minix_find_entry,
  etc, because on EIO they just move on to try the next page.  This is
  under the BKL, printk-storming as well.  This can lock up the machine
  for a very long time.  Simply ratelimiting the printks gets things back
  under control.  Make the message a bit more informative while we're here.

  Signed-off-by: Eric Sandeen <sandeen@redhat.com>
  Cc: Bodo Eggert <7eggert@gmx.de>
  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: f44ec6f3f89889a469773b1fd894f8fcc07c29cf
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/f44ec6f3f89889a469773b1fd894f8fcc07c29cf
    reference_type: commit
    reference_id: f44ec6f3f89889a469773b1fd894f8fcc07c29cf
