advisory_id: CVE-2013-6368
datasource_id: collect_linux_fix_commits/CVE-2013-6368
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f:Merge tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm

  Pull kvm fixes from Paolo Bonzini:
   "Four security fixes for KVM on x86.  Thanks to Andrew Honig and Lars
    Bull from Google for reporting them"

  * tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm:
    KVM: x86: fix guest-initiated crash with x2apic (CVE-2013-6376)
    KVM: x86: Convert vapic synchronization to _cached functions (CVE-2013-6368)
    KVM: x86: Fix potential divide by 0 in lapic (CVE-2013-6367)
    KVM: Improve create VCPU parameter (CVE-2013-4587)
  fda4e2e85589191b123d31cdc21fd33ee70f50fd:KVM: x86: Convert vapic synchronization to _cached functions (CVE-2013-6368)

  In kvm_lapic_sync_from_vapic and kvm_lapic_sync_to_vapic there is the
  potential to corrupt kernel memory if userspace provides an address that
  is at the end of a page.  This patches concerts those functions to use
  kvm_write_guest_cached and kvm_read_guest_cached.  It also checks the
  vapic_address specified by userspace during ioctl processing and returns
  an error to userspace if the address is not a valid GPA.

  This is generally not guest triggerable, because the required write is
  done by firmware that runs before the guest.  Also, it only affects AMD
  processors and oldish Intel that do not have the FlexPriority feature
  (unless you disable FlexPriority, of course; then newer processors are
  also affected).

  Fixes: b93463aa59d6 ('KVM: Accelerated apic support')

  Reported-by: Andrew Honig <ahonig@google.com>
  Cc: stable@vger.kernel.org
  Signed-off-by: Andrew Honig <ahonig@google.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: fda4e2e85589191b123d31cdc21fd33ee70f50fd
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f
    reference_type: commit
    reference_id: 54fb723cc48db2fde964fb9bb0eaaccf2cf31a9f
  - url: https://github.com/torvalds/linux/tree/fda4e2e85589191b123d31cdc21fd33ee70f50fd
    reference_type: commit
    reference_id: fda4e2e85589191b123d31cdc21fd33ee70f50fd
