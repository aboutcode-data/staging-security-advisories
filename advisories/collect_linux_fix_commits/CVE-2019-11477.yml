advisory_id: CVE-2019-11477
datasource_id: collect_linux_fix_commits/CVE-2019-11477
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "3b4929f65b0d8249f19a50245cd88ed1a2f78cff:tcp: limit payload size of sacked skbs\n\n\
  Jonathan Looney reported that TCP can trigger the following crash\nin tcp_shifted_skb() :\n\
  \n\tBUG_ON(tcp_skb_pcount(skb) < pcount);\n\nThis can happen if the remote peer has advertized\
  \ the smallest\nMSS that linux TCP accepts : 48\n\nAn skb can hold 17 fragments, and each\
  \ fragment can hold 32KB\non x86, or 64KB on PowerPC.\n\nThis means that the 16bit witdh of\
  \ TCP_SKB_CB(skb)->tcp_gso_segs\ncan overflow.\n\nNote that tcp_sendmsg() builds skbs with\
  \ less than 64KB\nof payload, so this problem needs SACK to be enabled.\nSACK blocks allow\
  \ TCP to coalesce multiple skbs in the retransmit\nqueue, thus filling the 17 fragments to\
  \ maximal capacity.\n\nCVE-2019-11477 -- u16 overflow of TCP_SKB_CB(skb)->tcp_gso_segs\n\n\
  Fixes: 832d11c5cd07 (\"tcp: Try to restore large SKBs while SACK processing\")\nSigned-off-by:\
  \ Eric Dumazet <edumazet@google.com>\nReported-by: Jonathan Looney <jtl@netflix.com>\nAcked-by:\
  \ Neal Cardwell <ncardwell@google.com>\nReviewed-by: Tyler Hicks <tyhicks@canonical.com>\n\
  Cc: Yuchung Cheng <ycheng@google.com>\nCc: Bruce Curtis <brucec@netflix.com>\nCc: Jonathan\
  \ Lemon <jonathan.lemon@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 3b4929f65b0d8249f19a50245cd88ed1a2f78cff
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/3b4929f65b0d8249f19a50245cd88ed1a2f78cff
    reference_type: commit
    reference_id: 3b4929f65b0d8249f19a50245cd88ed1a2f78cff
