advisory_id: CVE-2011-1017
datasource_id: collect_linux_fix_commits/CVE-2011-1017
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  cae13fe4cc3f24820ffb990c09110626837e85d4:Fix for buffer overflow in ldm_frag_add not sufficient

  As Ben Hutchings discovered [1], the patch for CVE-2011-1017 (buffer
  overflow in ldm_frag_add) is not sufficient.  The original patch in
  commit c340b1d64000 ("fs/partitions/ldm.c: fix oops caused by corrupted
  partition table") does not consider that, for subsequent fragments,
  previously allocated memory is used.

  [1] http://lkml.org/lkml/2011/5/6/407

  Reported-by: Ben Hutchings <ben@decadent.org.uk>
  Signed-off-by: Timo Warns <warns@pre-sense.de>
  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: cae13fe4cc3f24820ffb990c09110626837e85d4
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/cae13fe4cc3f24820ffb990c09110626837e85d4
    reference_type: commit
    reference_id: cae13fe4cc3f24820ffb990c09110626837e85d4
