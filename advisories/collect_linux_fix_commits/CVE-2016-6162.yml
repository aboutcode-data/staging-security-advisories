advisory_id: CVE-2016-6162
datasource_id: collect_linux_fix_commits/CVE-2016-6162
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  a612769774a30e4fc143c4cb6395c12573415660:udp: prevent bugcheck if filter truncates packet too much

  If socket filter truncates an udp packet below the length of UDP header
  in udpv6_queue_rcv_skb() or udp_queue_rcv_skb(), it will trigger a
  BUG_ON in skb_pull_rcsum(). This BUG_ON (and therefore a system crash if
  kernel is configured that way) can be easily enforced by an unprivileged
  user which was reported as CVE-2016-6162. For a reproducer, see
  http://seclists.org/oss-sec/2016/q3/8

  Fixes: e6afc8ace6dd ("udp: remove headers from UDP packets before queueing")
  Reported-by: Marco Grassi <marco.gra@gmail.com>
  Signed-off-by: Michal Kubecek <mkubecek@suse.cz>
  Acked-by: Eric Dumazet <edumazet@google.com>
  Acked-by: Willem de Bruijn <willemb@google.com>
  Signed-off-by: David S. Miller <davem@davemloft.net>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: a612769774a30e4fc143c4cb6395c12573415660
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/a612769774a30e4fc143c4cb6395c12573415660
    reference_type: commit
    reference_id: a612769774a30e4fc143c4cb6395c12573415660
