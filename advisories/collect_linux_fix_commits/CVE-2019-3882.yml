advisory_id: CVE-2019-3882
datasource_id: collect_linux_fix_commits/CVE-2019-3882
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  3e28fb0fcb69dbedfe254939143198b46d83bfa1:Merge tag 'vfio-v5.1-rc4' of git://github.com/awilliam/linux-vfio

  Pull VFIO fixes from Alex Williamson:

   - Fix clang printk format errors (Louis Taylor)

   - Declare structure static to fix sparse warning (Wang Hai)

   - Limit user DMA mappings per container (CVE-2019-3882) (Alex
     Williamson)

  * tag 'vfio-v5.1-rc4' of git://github.com/awilliam/linux-vfio:
    vfio/type1: Limit DMA mappings per container
    vfio/spapr_tce: Make symbol 'tce_iommu_driver_ops' static
    vfio/pci: use correct format characters
  492855939bdb59c6f947b0b5b44af9ad82b7e38c:vfio/type1: Limit DMA mappings per container

  Memory backed DMA mappings are accounted against a user's locked
  memory limit, including multiple mappings of the same memory.  This
  accounting bounds the number of such mappings that a user can create.
  However, DMA mappings that are not backed by memory, such as DMA
  mappings of device MMIO via mmaps, do not make use of page pinning
  and therefore do not count against the user's locked memory limit.
  These mappings still consume memory, but the memory is not well
  associated to the process for the purpose of oom killing a task.

  To add bounding on this use case, we introduce a limit to the total
  number of concurrent DMA mappings that a user is allowed to create.
  This limit is exposed as a tunable module option where the default
  value of 64K is expected to be well in excess of any reasonable use
  case (a large virtual machine configuration would typically only make
  use of tens of concurrent mappings).

  This fixes CVE-2019-3882.

  Reviewed-by: Eric Auger <eric.auger@redhat.com>
  Tested-by: Eric Auger <eric.auger@redhat.com>
  Reviewed-by: Peter Xu <peterx@redhat.com>
  Reviewed-by: Cornelia Huck <cohuck@redhat.com>
  Signed-off-by: Alex Williamson <alex.williamson@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 492855939bdb59c6f947b0b5b44af9ad82b7e38c
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 3e28fb0fcb69dbedfe254939143198b46d83bfa1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/3e28fb0fcb69dbedfe254939143198b46d83bfa1
    reference_type: commit
    reference_id: 3e28fb0fcb69dbedfe254939143198b46d83bfa1
  - url: https://github.com/torvalds/linux/tree/492855939bdb59c6f947b0b5b44af9ad82b7e38c
    reference_type: commit
    reference_id: 492855939bdb59c6f947b0b5b44af9ad82b7e38c
