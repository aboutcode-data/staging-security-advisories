advisory_id: CVE-2022-3643
datasource_id: collect_linux_fix_commits/CVE-2022-3643
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  ad7f402ae4f466647c3a669b8a6f3e5d4271c84a:xen/netback: Ensure protocol headers don't fall in the non-linear area

  In some cases, the frontend may send a packet where the protocol headers
  are spread across multiple slots. This would result in netback creating
  an skb where the protocol headers spill over into the non-linear area.
  Some drivers and NICs don't handle this properly resulting in an
  interface reset or worse.

  This issue was introduced by the removal of an unconditional skb pull in
  the tx path to improve performance.  Fix this without reintroducing the
  pull by setting up grant copy ops for as many slots as needed to reach
  the XEN_NETBACK_TX_COPY_LEN size. Adjust the rest of the code to handle
  multiple copy operations per skb.

  This is XSA-423 / CVE-2022-3643.

  Fixes: 7e5d7753956b ("xen-netback: remove unconditional __pskb_pull_tail() in guest Tx path")
  Signed-off-by: Ross Lagerwall <ross.lagerwall@citrix.com>
  Reviewed-by: Paul Durrant <paul@xen.org>
  Signed-off-by: Juergen Gross <jgross@suse.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: ad7f402ae4f466647c3a669b8a6f3e5d4271c84a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/ad7f402ae4f466647c3a669b8a6f3e5d4271c84a
    reference_type: commit
    reference_id: ad7f402ae4f466647c3a669b8a6f3e5d4271c84a
