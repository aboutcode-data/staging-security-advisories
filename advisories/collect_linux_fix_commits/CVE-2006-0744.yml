advisory_id: CVE-2006-0744
datasource_id: collect_linux_fix_commits/CVE-2006-0744
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  7bf36bbc5e0c09271f9efe22162f8cc3f8ebd3d2:[PATCH] x86_64: When user could have changed RIP always force IRET

  Intel EM64T CPUs handle uncanonical return addresses differently
  from AMD CPUs.

  The exception is reported in the SYSRET, not the next instruction.
  This leads to the kernel exception handler running on the user stack
  with the wrong GS because the kernel didn't expect exceptions
  on this instruction.

  This version of the patch has the teething problems that plagued an earlier
  version fixed.

  This is CVE-2006-0744

  Thanks to Ernie Petrides and Asit B. Mallick for analysis and initial
  patches.

  Signed-off-by: Andi Kleen <ak@suse.de>
  Signed-off-by: Linus Torvalds <torvalds@osdl.org>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 7bf36bbc5e0c09271f9efe22162f8cc3f8ebd3d2
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/7bf36bbc5e0c09271f9efe22162f8cc3f8ebd3d2
    reference_type: commit
    reference_id: 7bf36bbc5e0c09271f9efe22162f8cc3f8ebd3d2
