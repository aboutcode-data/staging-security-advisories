advisory_id: CVE-2020-26541
datasource_id: collect_linux_fix_commits/CVE-2020-26541
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  b0e22b47f650b53dbb094cd0011a48f6f3ae3e29:Merge tag 'keys-cve-2020-26541-v3' of git://git.kernel.org/pub/scm/linux/kernel/git/dhowells/linux-fs

  Pull x509 dbx/mokx UEFI support from David Howells:
   "Here's a set of patches from Eric Snowberg[1] that add support for
    EFI_CERT_X509_GUID entries in the dbx and mokx UEFI tables (such
    entries cause matching certificates to be rejected).

    These are currently ignored and only the hash entries are made use of.

    Additionally Eric included his patches to allow such certificates to
    be preloaded.

    These patches deal with CVE-2020-26541.

    To quote Eric:
         'This is the fifth patch series for adding support for
          EFI_CERT_X509_GUID entries [2]. It has been expanded to not only
          include dbx entries but also entries in the mokx. Additionally
          my series to preload these certificate [3] has also been
          included'"

  Link: https://lore.kernel.org/r/20210122181054.32635-1-eric.snowberg@oracle.com [1]
  Link: https://patchwork.kernel.org/project/linux-security-module/patch/20200916004927.64276-1-eric.snowberg@oracle.com/ [2]
  Link: https://lore.kernel.org/patchwork/cover/1315485/ [3]

  * tag 'keys-cve-2020-26541-v3' of git://git.kernel.org/pub/scm/linux/kernel/git/dhowells/linux-fs:
    integrity: Load mokx variables into the blacklist keyring
    certs: Add ability to preload revocation certs
    certs: Move load_system_certificate_list to a common function
    certs: Add EFI_CERT_X509_GUID support for dbx entries
  56c5812623f95313f6a46fbf0beee7fa17c68bbf:certs: Add EFI_CERT_X509_GUID support for dbx entries

  This fixes CVE-2020-26541.

  The Secure Boot Forbidden Signature Database, dbx, contains a list of now
  revoked signatures and keys previously approved to boot with UEFI Secure
  Boot enabled.  The dbx is capable of containing any number of
  EFI_CERT_X509_SHA256_GUID, EFI_CERT_SHA256_GUID, and EFI_CERT_X509_GUID
  entries.

  Currently when EFI_CERT_X509_GUID are contained in the dbx, the entries are
  skipped.

  Add support for EFI_CERT_X509_GUID dbx entries. When a EFI_CERT_X509_GUID
  is found, it is added as an asymmetrical key to the .blacklist keyring.
  Anytime the .platform keyring is used, the keys in the .blacklist keyring
  are referenced, if a matching key is found, the key will be rejected.

  [DH: Made the following changes:
   - Added to have a config option to enable the facility.  This allows a
     Kconfig solution to make sure that pkcs7_validate_trust() is
     enabled.[1][2]
   - Moved the functions out from the middle of the blacklist functions.
   - Added kerneldoc comments.]

  Signed-off-by: Eric Snowberg <eric.snowberg@oracle.com>
  Signed-off-by: David Howells <dhowells@redhat.com>
  Reviewed-by: Jarkko Sakkinen <jarkko@kernel.org>
  cc: Randy Dunlap <rdunlap@infradead.org>
  cc: Mickaël Salaün <mic@digikod.net>
  cc: Arnd Bergmann <arnd@kernel.org>
  cc: keyrings@vger.kernel.org
  Link: https://lore.kernel.org/r/20200901165143.10295-1-eric.snowberg@oracle.com/ # rfc
  Link: https://lore.kernel.org/r/20200909172736.73003-1-eric.snowberg@oracle.com/ # v2
  Link: https://lore.kernel.org/r/20200911182230.62266-1-eric.snowberg@oracle.com/ # v3
  Link: https://lore.kernel.org/r/20200916004927.64276-1-eric.snowberg@oracle.com/ # v4
  Link: https://lore.kernel.org/r/20210122181054.32635-2-eric.snowberg@oracle.com/ # v5
  Link: https://lore.kernel.org/r/161428672051.677100.11064981943343605138.stgit@warthog.procyon.org.uk/
  Link: https://lore.kernel.org/r/161433310942.902181.4901864302675874242.stgit@warthog.procyon.org.uk/ # v2
  Link: https://lore.kernel.org/r/161529605075.163428.14625520893961300757.stgit@warthog.procyon.org.uk/ # v3
  Link: https://lore.kernel.org/r/bc2c24e3-ed68-2521-0bf4-a1f6be4a895d@infradead.org/ [1]
  Link: https://lore.kernel.org/r/20210225125638.1841436-1-arnd@kernel.org/ [2]
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 56c5812623f95313f6a46fbf0beee7fa17c68bbf
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: b0e22b47f650b53dbb094cd0011a48f6f3ae3e29
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/56c5812623f95313f6a46fbf0beee7fa17c68bbf
    reference_type: commit
    reference_id: 56c5812623f95313f6a46fbf0beee7fa17c68bbf
  - url: https://github.com/torvalds/linux/tree/b0e22b47f650b53dbb094cd0011a48f6f3ae3e29
    reference_type: commit
    reference_id: b0e22b47f650b53dbb094cd0011a48f6f3ae3e29
