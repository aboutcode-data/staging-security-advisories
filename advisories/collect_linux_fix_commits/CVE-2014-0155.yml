advisory_id: CVE-2014-0155
datasource_id: collect_linux_fix_commits/CVE-2014-0155
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  55101e2d6ce1c780f6ee8fee5f37306971aac6cd:Merge git://git.kernel.org/pub/scm/virt/kvm/kvm

  Pull KVM fixes from Marcelo Tosatti:
   - Fix for guest triggerable BUG_ON (CVE-2014-0155)
   - CR4.SMAP support
   - Spurious WARN_ON() fix

  * git://git.kernel.org/pub/scm/virt/kvm/kvm:
    KVM: x86: remove WARN_ON from get_kernel_ns()
    KVM: Rename variable smep to cr4_smep
    KVM: expose SMAP feature to guest
    KVM: Disable SMAP for guests in EPT realmode and EPT unpaging mode
    KVM: Add SMAP support when setting CR4
    KVM: Remove SMAP bit from CR4_RESERVED_BITS
    KVM: ioapic: try to recover if pending_eoi goes out of range
    KVM: ioapic: fix assignment of ioapic->rtc_status.pending_eoi (CVE-2014-0155)
  55101e2d6ce1c780f6ee8fee5f37306971aac6cd:Merge git://git.kernel.org/pub/scm/virt/kvm/kvm

  Pull KVM fixes from Marcelo Tosatti:
   - Fix for guest triggerable BUG_ON (CVE-2014-0155)
   - CR4.SMAP support
   - Spurious WARN_ON() fix

  * git://git.kernel.org/pub/scm/virt/kvm/kvm:
    KVM: x86: remove WARN_ON from get_kernel_ns()
    KVM: Rename variable smep to cr4_smep
    KVM: expose SMAP feature to guest
    KVM: Disable SMAP for guests in EPT realmode and EPT unpaging mode
    KVM: Add SMAP support when setting CR4
    KVM: Remove SMAP bit from CR4_RESERVED_BITS
    KVM: ioapic: try to recover if pending_eoi goes out of range
    KVM: ioapic: fix assignment of ioapic->rtc_status.pending_eoi (CVE-2014-0155)
  5678de3f15010b9022ee45673f33bcfc71d47b60:KVM: ioapic: fix assignment of ioapic->rtc_status.pending_eoi (CVE-2014-0155)

  QE reported that they got the BUG_ON in ioapic_service to trigger.
  I cannot reproduce it, but there are two reasons why this could happen.

  The less likely but also easiest one, is when kvm_irq_delivery_to_apic
  does not deliver to any APIC and returns -1.

  Because irqe.shorthand == 0, the kvm_for_each_vcpu loop in that
  function is never reached.  However, you can target the similar loop in
  kvm_irq_delivery_to_apic_fast; just program a zero logical destination
  address into the IOAPIC, or an out-of-range physical destination address.

  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 55101e2d6ce1c780f6ee8fee5f37306971aac6cd
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 5678de3f15010b9022ee45673f33bcfc71d47b60
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/55101e2d6ce1c780f6ee8fee5f37306971aac6cd
    reference_type: commit
    reference_id: 55101e2d6ce1c780f6ee8fee5f37306971aac6cd
  - url: https://github.com/torvalds/linux/tree/5678de3f15010b9022ee45673f33bcfc71d47b60
    reference_type: commit
    reference_id: 5678de3f15010b9022ee45673f33bcfc71d47b60
