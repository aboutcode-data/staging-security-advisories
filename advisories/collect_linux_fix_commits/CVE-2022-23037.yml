advisory_id: CVE-2022-23037
datasource_id: collect_linux_fix_commits/CVE-2022-23037
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  31185df7e2b1d2fa1de4900247a12d7b9c7087eb:xen/netfront: don't use gnttab_query_foreign_access() for mapped status

  It isn't enough to check whether a grant is still being in use by
  calling gnttab_query_foreign_access(), as a mapping could be realized
  by the other side just after having called that function.

  In case the call was done in preparation of revoking a grant it is
  better to do so via gnttab_end_foreign_access_ref() and check the
  success of that operation instead.

  This is CVE-2022-23037 / part of XSA-396.

  Reported-by: Demi Marie Obenour <demi@invisiblethingslab.com>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  ---
  V2:
  - use gnttab_try_end_foreign_access()
  V3:
  - don't use gnttab_try_end_foreign_access()
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 31185df7e2b1d2fa1de4900247a12d7b9c7087eb
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/31185df7e2b1d2fa1de4900247a12d7b9c7087eb
    reference_type: commit
    reference_id: 31185df7e2b1d2fa1de4900247a12d7b9c7087eb
