advisory_id: CVE-2015-8543
datasource_id: collect_linux_fix_commits/CVE-2015-8543
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: "79462ad02e861803b3840cc782248c7359451cd9:net: add validation for the socket syscall\
  \ protocol argument\n\n郭永刚 reported that one could simply crash the kernel as root by\nusing\
  \ a simple program:\n\n\tint socket_fd;\n\tstruct sockaddr_in addr;\n\taddr.sin_port = 0;\n\
  \taddr.sin_addr.s_addr = INADDR_ANY;\n\taddr.sin_family = 10;\n\n\tsocket_fd = socket(10,3,0x40000000);\n\
  \tconnect(socket_fd , &addr,16);\n\nAF_INET, AF_INET6 sockets actually only support 8-bit\
  \ protocol\nidentifiers. inet_sock's skc_protocol field thus is sized accordingly,\nthus larger\
  \ protocol identifiers simply cut off the higher bits and\nstore a zero in the protocol fields.\n\
  \nThis could lead to e.g. NULL function pointer because as a result of\nthe cut off inet_num\
  \ is zero and we call down to inet_autobind, which\nis NULL for raw sockets.\n\nkernel: Call\
  \ Trace:\nkernel:  [<ffffffff816db90e>] ? inet_autobind+0x2e/0x70\nkernel:  [<ffffffff816db9a4>]\
  \ inet_dgram_connect+0x54/0x80\nkernel:  [<ffffffff81645069>] SYSC_connect+0xd9/0x110\nkernel:\
  \  [<ffffffff810ac51b>] ? ptrace_notify+0x5b/0x80\nkernel:  [<ffffffff810236d8>] ? syscall_trace_enter_phase2+0x108/0x200\n\
  kernel:  [<ffffffff81645e0e>] SyS_connect+0xe/0x10\nkernel:  [<ffffffff81779515>] tracesys_phase2+0x84/0x89\n\
  \nI found no particular commit which introduced this problem.\n\nCVE: CVE-2015-8543\nCc: Cong\
  \ Wang <cwang@twopensource.com>\nReported-by: 郭永刚 <guoyonggang@360.cn>\nSigned-off-by: Hannes\
  \ Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>"
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 79462ad02e861803b3840cc782248c7359451cd9
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/79462ad02e861803b3840cc782248c7359451cd9
    reference_type: commit
    reference_id: 79462ad02e861803b3840cc782248c7359451cd9
