advisory_id: CVE-2017-1000252
datasource_id: collect_linux_fix_commits/CVE-2017-1000252
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  3a8b0677fc6180a467e26cc32ce6b0c09a32f9bb:KVM: VMX: Do not BUG() on out-of-bounds guest IRQ

  The value of the guest_irq argument to vmx_update_pi_irte() is
  ultimately coming from a KVM_IRQFD API call. Do not BUG() in
  vmx_update_pi_irte() if the value is out-of bounds. (Especially,
  since KVM as a whole seems to hang after that.)

  Instead, print a message only once if we find that we don't have a
  route for a certain IRQ (which can be out-of-bounds or within the
  array).

  This fixes CVE-2017-1000252.

  Fixes: efc644048ecde54 ("KVM: x86: Update IRTE for posted-interrupts")
  Signed-off-by: Jan H. Sch√∂nherr <jschoenh@amazon.de>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 3a8b0677fc6180a467e26cc32ce6b0c09a32f9bb
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/3a8b0677fc6180a467e26cc32ce6b0c09a32f9bb
    reference_type: commit
    reference_id: 3a8b0677fc6180a467e26cc32ce6b0c09a32f9bb
