advisory_id: CVE-2020-4788
datasource_id: collect_linux_fix_commits/CVE-2020-4788
datasource_url: https://github.com/torvalds/linux
aliases: []
summary: |
  dda3f4252e6c8b833a2ef164afd3da9808d0f07c:Merge tag 'powerpc-cve-2020-4788' of git://git.kernel.org/pub/scm/linux/kernel/git/powerpc/linux

  Pull powerpc fixes from Michael Ellerman:
   "Fixes for CVE-2020-4788.

    From Daniel's cover letter:

    IBM Power9 processors can speculatively operate on data in the L1
    cache before it has been completely validated, via a way-prediction
    mechanism. It is not possible for an attacker to determine the
    contents of impermissible memory using this method, since these
    systems implement a combination of hardware and software security
    measures to prevent scenarios where protected data could be leaked.

    However these measures don't address the scenario where an attacker
    induces the operating system to speculatively execute instructions
    using data that the attacker controls. This can be used for example to
    speculatively bypass "kernel user access prevention" techniques, as
    discovered by Anthony Steinhauser of Google's Safeside Project. This
    is not an attack by itself, but there is a possibility it could be
    used in conjunction with side-channels or other weaknesses in the
    privileged code to construct an attack.

    This issue can be mitigated by flushing the L1 cache between privilege
    boundaries of concern.

    This patch series flushes the L1 cache on kernel entry (patch 2) and
    after the kernel performs any user accesses (patch 3). It also adds a
    self-test and performs some related cleanups"

  * tag 'powerpc-cve-2020-4788' of git://git.kernel.org/pub/scm/linux/kernel/git/powerpc/linux:
    powerpc/64s: rename pnv|pseries_setup_rfi_flush to _setup_security_mitigations
    selftests/powerpc: refactor entry and rfi_flush tests
    selftests/powerpc: entry flush test
    powerpc: Only include kup-radix.h for 64-bit Book3S
    powerpc/64s: flush L1D after user accesses
    powerpc/64s: flush L1D on kernel entry
    selftests/powerpc: rfi_flush: disable entry flush if present
  9a32a7e78bd0cd9a9b6332cbdc345ee5ffd0c5de:powerpc/64s: flush L1D after user accesses

  IBM Power9 processors can speculatively operate on data in the L1 cache
  before it has been completely validated, via a way-prediction mechanism. It
  is not possible for an attacker to determine the contents of impermissible
  memory using this method, since these systems implement a combination of
  hardware and software security measures to prevent scenarios where
  protected data could be leaked.

  However these measures don't address the scenario where an attacker induces
  the operating system to speculatively execute instructions using data that
  the attacker controls. This can be used for example to speculatively bypass
  "kernel user access prevention" techniques, as discovered by Anthony
  Steinhauser of Google's Safeside Project. This is not an attack by itself,
  but there is a possibility it could be used in conjunction with
  side-channels or other weaknesses in the privileged code to construct an
  attack.

  This issue can be mitigated by flushing the L1 cache between privilege
  boundaries of concern. This patch flushes the L1 cache after user accesses.

  This is part of the fix for CVE-2020-4788.

  Signed-off-by: Nicholas Piggin <npiggin@gmail.com>
  Signed-off-by: Daniel Axtens <dja@axtens.net>
  Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
  f79643787e0a0762d2409b7b8334e83f22d85695:powerpc/64s: flush L1D on kernel entry

  IBM Power9 processors can speculatively operate on data in the L1 cache
  before it has been completely validated, via a way-prediction mechanism. It
  is not possible for an attacker to determine the contents of impermissible
  memory using this method, since these systems implement a combination of
  hardware and software security measures to prevent scenarios where
  protected data could be leaked.

  However these measures don't address the scenario where an attacker induces
  the operating system to speculatively execute instructions using data that
  the attacker controls. This can be used for example to speculatively bypass
  "kernel user access prevention" techniques, as discovered by Anthony
  Steinhauser of Google's Safeside Project. This is not an attack by itself,
  but there is a possibility it could be used in conjunction with
  side-channels or other weaknesses in the privileged code to construct an
  attack.

  This issue can be mitigated by flushing the L1 cache between privilege
  boundaries of concern. This patch flushes the L1 cache on kernel entry.

  This is part of the fix for CVE-2020-4788.

  Signed-off-by: Nicholas Piggin <npiggin@gmail.com>
  Signed-off-by: Daniel Axtens <dja@axtens.net>
  Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
impacted_packages:
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: 9a32a7e78bd0cd9a9b6332cbdc345ee5ffd0c5de
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: f79643787e0a0762d2409b7b8334e83f22d85695
    introduced_in_commits: []
  - purl: pkg:github/torvalds/linux
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/torvalds/linux
        commit: dda3f4252e6c8b833a2ef164afd3da9808d0f07c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/torvalds/linux/tree/9a32a7e78bd0cd9a9b6332cbdc345ee5ffd0c5de
    reference_type: commit
    reference_id: 9a32a7e78bd0cd9a9b6332cbdc345ee5ffd0c5de
  - url: https://github.com/torvalds/linux/tree/dda3f4252e6c8b833a2ef164afd3da9808d0f07c
    reference_type: commit
    reference_id: dda3f4252e6c8b833a2ef164afd3da9808d0f07c
  - url: https://github.com/torvalds/linux/tree/f79643787e0a0762d2409b7b8334e83f22d85695
    reference_type: commit
    reference_id: f79643787e0a0762d2409b7b8334e83f22d85695
