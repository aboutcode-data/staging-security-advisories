advisory_id: CVE-2023-39320
datasource_id: collect_containerd_fix_commits/CVE-2023-39320
datasource_url: https://github.com/containerd/containerd
aliases: []
summary: |
  423693d7b481e4bd8adb7b0ed76cec0b2cb96724:[release/1.7] update to go1.20.8

  go1.20.8 (released 2023-09-06) includes two security fixes to the html/template
  package, as well as bug fixes to the compiler, the go command, the runtime,
  and the crypto/tls, go/types, net/http, and path/filepath packages. See the
  Go 1.20.8 milestone on our issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.8+label%3ACherryPickApproved

  full diff: https://github.com/golang/go/compare/go1.20.7...go1.20.8

  From the security mailing:

  [security] Go 1.21.1 and Go 1.20.8 are released

  Hello gophers,

  We have just released Go versions 1.21.1 and 1.20.8, minor point releases.

  These minor releases include 4 security fixes following the security policy:

  - cmd/go: go.mod toolchain directive allows arbitrary execution
    The go.mod toolchain directive, introduced in Go 1.21, could be leveraged to
    execute scripts and binaries relative to the root of the module when the "go"
    command was executed within the module. This applies to modules downloaded using
    the "go" command from the module proxy, as well as modules downloaded directly
    using VCS software.

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-39320 and Go issue https://go.dev/issue/62198.

  - html/template: improper handling of HTML-like comments within script contexts
    The html/template package did not properly handle HMTL-like "<!--" and "-->"
    comment tokens, nor hashbang "#!" comment tokens, in <script> contexts. This may
    cause the template parser to improperly interpret the contents of <script>
    contexts, causing actions to be improperly escaped. This could be leveraged to
    perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39318 and Go issue https://go.dev/issue/62196.

  - html/template: improper handling of special tags within script contexts
    The html/template package did not apply the proper rules for handling occurrences
    of "<script", "<!--", and "</script" within JS literals in <script> contexts.
    This may cause the template parser to improperly consider script contexts to be
    terminated early, causing actions to be improperly escaped. This could be
    leveraged to perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39319 and Go issue https://go.dev/issue/62197.

  - crypto/tls: panic when processing post-handshake message on QUIC connections
    Processing an incomplete post-handshake message for a QUIC connection caused a panic.

    Thanks to Marten Seemann for reporting this issue.

    This is CVE-2023-39321 and CVE-2023-39322 and Go issue https://go.dev/issue/62266.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  a2c294800ec11447b497bf7452bbbfba06c0168d:[release/1.6] update to go1.20.8

  go1.20.8 (released 2023-09-06) includes two security fixes to the html/template
  package, as well as bug fixes to the compiler, the go command, the runtime,
  and the crypto/tls, go/types, net/http, and path/filepath packages. See the
  Go 1.20.8 milestone on our issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.8+label%3ACherryPickApproved

  full diff: https://github.com/golang/go/compare/go1.20.7...go1.20.8

  From the security mailing:

  [security] Go 1.21.1 and Go 1.20.8 are released

  Hello gophers,

  We have just released Go versions 1.21.1 and 1.20.8, minor point releases.

  These minor releases include 4 security fixes following the security policy:

  - cmd/go: go.mod toolchain directive allows arbitrary execution
    The go.mod toolchain directive, introduced in Go 1.21, could be leveraged to
    execute scripts and binaries relative to the root of the module when the "go"
    command was executed within the module. This applies to modules downloaded using
    the "go" command from the module proxy, as well as modules downloaded directly
    using VCS software.

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-39320 and Go issue https://go.dev/issue/62198.

  - html/template: improper handling of HTML-like comments within script contexts
    The html/template package did not properly handle HMTL-like "<!--" and "-->"
    comment tokens, nor hashbang "#!" comment tokens, in <script> contexts. This may
    cause the template parser to improperly interpret the contents of <script>
    contexts, causing actions to be improperly escaped. This could be leveraged to
    perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39318 and Go issue https://go.dev/issue/62196.

  - html/template: improper handling of special tags within script contexts
    The html/template package did not apply the proper rules for handling occurrences
    of "<script", "<!--", and "</script" within JS literals in <script> contexts.
    This may cause the template parser to improperly consider script contexts to be
    terminated early, causing actions to be improperly escaped. This could be
    leveraged to perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39319 and Go issue https://go.dev/issue/62197.

  - crypto/tls: panic when processing post-handshake message on QUIC connections
    Processing an incomplete post-handshake message for a QUIC connection caused a panic.

    Thanks to Marten Seemann for reporting this issue.

    This is CVE-2023-39321 and CVE-2023-39322 and Go issue https://go.dev/issue/62266.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  eaf60710192fcad3699751a369f943954c9e68d0:update to go1.21.1, go1.20.8

  go1.21.1 (released 2023-09-06) includes four security fixes to the cmd/go,
  crypto/tls, and html/template packages, as well as bug fixes to the compiler,
  the go command, the linker, the runtime, and the context, crypto/tls,
  encoding/gob, encoding/xml, go/types, net/http, os, and path/filepath packages.
  See the Go 1.21.1 milestone on our issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.21.1+label%3ACherryPickApproved

  full diff: https://github.com/golang/go/compare/go1.21.0...go1.21.1

  From the security mailing:

  [security] Go 1.21.1 and Go 1.20.8 are released

  Hello gophers,

  We have just released Go versions 1.21.1 and 1.20.8, minor point releases.

  These minor releases include 4 security fixes following the security policy:

  - cmd/go: go.mod toolchain directive allows arbitrary execution
    The go.mod toolchain directive, introduced in Go 1.21, could be leveraged to
    execute scripts and binaries relative to the root of the module when the "go"
    command was executed within the module. This applies to modules downloaded using
    the "go" command from the module proxy, as well as modules downloaded directly
    using VCS software.

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-39320 and Go issue https://go.dev/issue/62198.

  - html/template: improper handling of HTML-like comments within script contexts
    The html/template package did not properly handle HMTL-like "<!--" and "-->"
    comment tokens, nor hashbang "#!" comment tokens, in <script> contexts. This may
    cause the template parser to improperly interpret the contents of <script>
    contexts, causing actions to be improperly escaped. This could be leveraged to
    perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39318 and Go issue https://go.dev/issue/62196.

  - html/template: improper handling of special tags within script contexts
    The html/template package did not apply the proper rules for handling occurrences
    of "<script", "<!--", and "</script" within JS literals in <script> contexts.
    This may cause the template parser to improperly consider script contexts to be
    terminated early, causing actions to be improperly escaped. This could be
    leveraged to perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39319 and Go issue https://go.dev/issue/62197.

  - crypto/tls: panic when processing post-handshake message on QUIC connections
    Processing an incomplete post-handshake message for a QUIC connection caused a panic.

    Thanks to Marten Seemann for reporting this issue.

    This is CVE-2023-39321 and CVE-2023-39322 and Go issue https://go.dev/issue/62266.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 423693d7b481e4bd8adb7b0ed76cec0b2cb96724
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: eaf60710192fcad3699751a369f943954c9e68d0
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: a2c294800ec11447b497bf7452bbbfba06c0168d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/containerd/containerd/tree/423693d7b481e4bd8adb7b0ed76cec0b2cb96724
    reference_type: commit
    reference_id: 423693d7b481e4bd8adb7b0ed76cec0b2cb96724
  - url: https://github.com/containerd/containerd/tree/a2c294800ec11447b497bf7452bbbfba06c0168d
    reference_type: commit
    reference_id: a2c294800ec11447b497bf7452bbbfba06c0168d
  - url: https://github.com/containerd/containerd/tree/eaf60710192fcad3699751a369f943954c9e68d0
    reference_type: commit
    reference_id: eaf60710192fcad3699751a369f943954c9e68d0
