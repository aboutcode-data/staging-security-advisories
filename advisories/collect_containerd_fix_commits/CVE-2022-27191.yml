advisory_id: CVE-2022-27191
datasource_id: collect_containerd_fix_commits/CVE-2022-27191
datasource_url: https://github.com/containerd/containerd
aliases: []
summary: |
  5b44c5271136c5f1c4b6df4275c6ff3b124d731d:vendor: golang.org/x/crypto v0.0.0-20220315160706-3147a52a75dd

  full diff: https://github.com/golang/crypto/compare/32db794688a5...3147a52a75dd

  This version contains a fix for CVE-2022-27191 (not sure if it affects us).

  From the golang mailing list:

      Hello gophers,

      Version v0.0.0-20220315160706-3147a52a75dd of golang.org/x/crypto/ssh implements
      client authentication support for signature algorithms based on SHA-2 for use with
      existing RSA keys.

      Previously, a client would fail to authenticate with RSA keys to servers that
      reject signature algorithms based on SHA-1. This includes OpenSSH 8.8 by default
      and—starting today March 15, 2022 for recently uploaded keys.

      We are providing this announcement as the error (“ssh: unable to authenticate”)
      might otherwise be difficult to troubleshoot.

      Version v0.0.0-20220314234659-1baeb1ce4c0b (included in the version above) also
      fixes a potential security issue where an attacker could cause a crash in a
      golang.org/x/crypto/ssh server under these conditions:

      - The server has been configured by passing a Signer to ServerConfig.AddHostKey.
      - The Signer passed to AddHostKey does not also implement AlgorithmSigner.
      - The Signer passed to AddHostKey does return a key of type “ssh-rsa” from its PublicKey method.

      Servers that only use Signer implementations provided by the ssh package are
      unaffected. This is CVE-2022-27191.

      Alla prossima,

      Filippo for the Go Security team

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  Signed-off-by: Dan Čermák <dcermak@suse.com>
  (cherry picked from commit 9aadef1bee81d9377d481cfa53703d51bbaa7eca)
  5b44c5271136c5f1c4b6df4275c6ff3b124d731d:vendor: golang.org/x/crypto v0.0.0-20220315160706-3147a52a75dd

  full diff: https://github.com/golang/crypto/compare/32db794688a5...3147a52a75dd

  This version contains a fix for CVE-2022-27191 (not sure if it affects us).

  From the golang mailing list:

      Hello gophers,

      Version v0.0.0-20220315160706-3147a52a75dd of golang.org/x/crypto/ssh implements
      client authentication support for signature algorithms based on SHA-2 for use with
      existing RSA keys.

      Previously, a client would fail to authenticate with RSA keys to servers that
      reject signature algorithms based on SHA-1. This includes OpenSSH 8.8 by default
      and—starting today March 15, 2022 for recently uploaded keys.

      We are providing this announcement as the error (“ssh: unable to authenticate”)
      might otherwise be difficult to troubleshoot.

      Version v0.0.0-20220314234659-1baeb1ce4c0b (included in the version above) also
      fixes a potential security issue where an attacker could cause a crash in a
      golang.org/x/crypto/ssh server under these conditions:

      - The server has been configured by passing a Signer to ServerConfig.AddHostKey.
      - The Signer passed to AddHostKey does not also implement AlgorithmSigner.
      - The Signer passed to AddHostKey does return a key of type “ssh-rsa” from its PublicKey method.

      Servers that only use Signer implementations provided by the ssh package are
      unaffected. This is CVE-2022-27191.

      Alla prossima,

      Filippo for the Go Security team

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  Signed-off-by: Dan Čermák <dcermak@suse.com>
  (cherry picked from commit 9aadef1bee81d9377d481cfa53703d51bbaa7eca)
  9aadef1bee81d9377d481cfa53703d51bbaa7eca:vendor: golang.org/x/crypto v0.0.0-20220315160706-3147a52a75dd

  full diff: https://github.com/golang/crypto/compare/32db794688a5...3147a52a75dd

  This version contains a fix for CVE-2022-27191 (not sure if it affects us).

  From the golang mailing list:

      Hello gophers,

      Version v0.0.0-20220315160706-3147a52a75dd of golang.org/x/crypto/ssh implements
      client authentication support for signature algorithms based on SHA-2 for use with
      existing RSA keys.

      Previously, a client would fail to authenticate with RSA keys to servers that
      reject signature algorithms based on SHA-1. This includes OpenSSH 8.8 by default
      and—starting today March 15, 2022 for recently uploaded keys.

      We are providing this announcement as the error (“ssh: unable to authenticate”)
      might otherwise be difficult to troubleshoot.

      Version v0.0.0-20220314234659-1baeb1ce4c0b (included in the version above) also
      fixes a potential security issue where an attacker could cause a crash in a
      golang.org/x/crypto/ssh server under these conditions:

      - The server has been configured by passing a Signer to ServerConfig.AddHostKey.
      - The Signer passed to AddHostKey does not also implement AlgorithmSigner.
      - The Signer passed to AddHostKey does return a key of type “ssh-rsa” from its PublicKey method.

      Servers that only use Signer implementations provided by the ssh package are
      unaffected. This is CVE-2022-27191.

      Alla prossima,

      Filippo for the Go Security team

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  9aadef1bee81d9377d481cfa53703d51bbaa7eca:vendor: golang.org/x/crypto v0.0.0-20220315160706-3147a52a75dd

  full diff: https://github.com/golang/crypto/compare/32db794688a5...3147a52a75dd

  This version contains a fix for CVE-2022-27191 (not sure if it affects us).

  From the golang mailing list:

      Hello gophers,

      Version v0.0.0-20220315160706-3147a52a75dd of golang.org/x/crypto/ssh implements
      client authentication support for signature algorithms based on SHA-2 for use with
      existing RSA keys.

      Previously, a client would fail to authenticate with RSA keys to servers that
      reject signature algorithms based on SHA-1. This includes OpenSSH 8.8 by default
      and—starting today March 15, 2022 for recently uploaded keys.

      We are providing this announcement as the error (“ssh: unable to authenticate”)
      might otherwise be difficult to troubleshoot.

      Version v0.0.0-20220314234659-1baeb1ce4c0b (included in the version above) also
      fixes a potential security issue where an attacker could cause a crash in a
      golang.org/x/crypto/ssh server under these conditions:

      - The server has been configured by passing a Signer to ServerConfig.AddHostKey.
      - The Signer passed to AddHostKey does not also implement AlgorithmSigner.
      - The Signer passed to AddHostKey does return a key of type “ssh-rsa” from its PublicKey method.

      Servers that only use Signer implementations provided by the ssh package are
      unaffected. This is CVE-2022-27191.

      Alla prossima,

      Filippo for the Go Security team

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 9aadef1bee81d9377d481cfa53703d51bbaa7eca
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 5b44c5271136c5f1c4b6df4275c6ff3b124d731d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/containerd/containerd/tree/5b44c5271136c5f1c4b6df4275c6ff3b124d731d
    reference_type: commit
    reference_id: 5b44c5271136c5f1c4b6df4275c6ff3b124d731d
  - url: https://github.com/containerd/containerd/tree/9aadef1bee81d9377d481cfa53703d51bbaa7eca
    reference_type: commit
    reference_id: 9aadef1bee81d9377d481cfa53703d51bbaa7eca
