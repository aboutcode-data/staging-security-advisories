advisory_id: CVE-2023-45283
datasource_id: collect_containerd_fix_commits/CVE-2023-45283
datasource_url: https://github.com/containerd/containerd
aliases: []
summary: |
  7cbdfc92ef38f789f1a2773fa6fac405d361a6cc:update to go1.20.12, test go1.21.5

  go1.20.12 (released 2023-12-05) includes security fixes to the go command,
  and the net/http and path/filepath packages, as well as bug fixes to the
  compiler and the go command. See the Go 1.20.12 milestone on our issue
  tracker for details:

  - https://github.com/golang/go/issues?q=milestone%3AGo1.20.12+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.20.11...go1.20.12

  from the security mailing:

  [security] Go 1.21.5 and Go 1.20.12 are released

  Hello gophers,

  We have just released Go versions 1.21.5 and 1.20.12, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - net/http: limit chunked data overhead

    A malicious HTTP sender can use chunk extensions to cause a receiver
    reading from a request or response body to read many more bytes from
    the network than are in the body.

    A malicious HTTP client can further exploit this to cause a server to
    automatically read a large amount of data (up to about 1GiB) when a
    handler fails to read the entire body of a request.

    Chunk extensions are a little-used HTTP feature which permit including
    additional metadata in a request or response body sent using the chunked
    encoding. The net/http chunked encoding reader discards this metadata.
    A sender can exploit this by inserting a large metadata segment with
    each byte transferred. The chunk reader now produces an error if the
    ratio of real body to encoded bytes grows too small.

    Thanks to Bartek Nowotarski for reporting this issue.

    This is CVE-2023-39326 and Go issue https://go.dev/issue/64433.

  - cmd/go: go get may unexpectedly fallback to insecure git

    Using go get to fetch a module with the ".git" suffix may unexpectedly
    fallback to the insecure "git://" protocol if the module is unavailable
    via the secure "https://" and "git+ssh://" protocols, even if GOINSECURE
    is not set for said module. This only affects users who are not using
    the module proxy and are fetching modules directly (i.e. GOPROXY=off).

    Thanks to David Leadbeater for reporting this issue.

    This is CVE-2023-45285 and Go issue https://go.dev/issue/63845.

  - path/filepath: retain trailing \ when cleaning paths like \\?\c:\

    Go 1.20.11 and Go 1.21.4 inadvertently changed the definition of the
    volume name in Windows paths starting with \\?\, resulting in
    filepath.Clean(\\?\c:\) returning \\?\c: rather than \\?\c:\ (among
    other effects). The previous behavior has been restored.

    This is an update to CVE-2023-45283 and Go issue https://go.dev/issue/64028.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  024b1cce6b27f10e00bb9bde33a5fe9563545f8d:update to go1.20.11, test go1.21.4

  go1.20.11 (released 2023-11-07) includes security fixes to the path/filepath
  package, as well as bug fixes to the linker and the net/http package. See the
  Go 1.20.11 milestone on our issue tracker for details:

  - https://github.com/golang/go/issues?q=milestone%3AGo1.20.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.20.10...go1.20.11

  from the security mailing:

  [security] Go 1.21.4 and Go 1.20.11 are released

  Hello gophers,

  We have just released Go versions 1.21.4 and 1.20.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - path/filepath: recognize `\??\` as a Root Local Device path prefix.

    On Windows, a path beginning with `\??\` is a Root Local Device path equivalent
    to a path beginning with `\\?\`. Paths with a `\??\` prefix may be used to
    access arbitrary locations on the system. For example, the path `\??\c:\x`
    is equivalent to the more common path c:\x.

    The filepath package did not recognize paths with a `\??\` prefix as special.

    Clean could convert a rooted path such as `\a\..\??\b` into
    the root local device path `\??\b`. It will now convert this
    path into `.\??\b`.

    `IsAbs` did not report paths beginning with `\??\` as absolute.
    It now does so.

    VolumeName now reports the `\??\` prefix as a volume name.

    `Join(`\`, `??`, `b`)` could convert a seemingly innocent
    sequence of path elements into the root local device path
    `\??\b`. It will now convert this to `\.\??\b`.

    This is CVE-2023-45283 and https://go.dev/issue/63713.

  - path/filepath: recognize device names with trailing spaces and superscripts

    The `IsLocal` function did not correctly detect reserved names in some cases:

    - reserved names followed by spaces, such as "COM1 ".
    - "COM" or "LPT" followed by a superscript 1, 2, or 3.

    `IsLocal` now correctly reports these names as non-local.

    This is CVE-2023-45284 and https://go.dev/issue/63713.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  0d314401d9b9ad470153dc3d09f6d9cd7d527697:update to go1.20.12, test go1.21.5

  go1.20.12 (released 2023-12-05) includes security fixes to the go command,
  and the net/http and path/filepath packages, as well as bug fixes to the
  compiler and the go command. See the Go 1.20.12 milestone on our issue
  tracker for details:

  - https://github.com/golang/go/issues?q=milestone%3AGo1.20.12+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.20.11...go1.20.12

  from the security mailing:

  [security] Go 1.21.5 and Go 1.20.12 are released

  Hello gophers,

  We have just released Go versions 1.21.5 and 1.20.12, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - net/http: limit chunked data overhead

    A malicious HTTP sender can use chunk extensions to cause a receiver
    reading from a request or response body to read many more bytes from
    the network than are in the body.

    A malicious HTTP client can further exploit this to cause a server to
    automatically read a large amount of data (up to about 1GiB) when a
    handler fails to read the entire body of a request.

    Chunk extensions are a little-used HTTP feature which permit including
    additional metadata in a request or response body sent using the chunked
    encoding. The net/http chunked encoding reader discards this metadata.
    A sender can exploit this by inserting a large metadata segment with
    each byte transferred. The chunk reader now produces an error if the
    ratio of real body to encoded bytes grows too small.

    Thanks to Bartek Nowotarski for reporting this issue.

    This is CVE-2023-39326 and Go issue https://go.dev/issue/64433.

  - cmd/go: go get may unexpectedly fallback to insecure git

    Using go get to fetch a module with the ".git" suffix may unexpectedly
    fallback to the insecure "git://" protocol if the module is unavailable
    via the secure "https://" and "git+ssh://" protocols, even if GOINSECURE
    is not set for said module. This only affects users who are not using
    the module proxy and are fetching modules directly (i.e. GOPROXY=off).

    Thanks to David Leadbeater for reporting this issue.

    This is CVE-2023-45285 and Go issue https://go.dev/issue/63845.

  - path/filepath: retain trailing \ when cleaning paths like \\?\c:\

    Go 1.20.11 and Go 1.21.4 inadvertently changed the definition of the
    volume name in Windows paths starting with \\?\, resulting in
    filepath.Clean(\\?\c:\) returning \\?\c: rather than \\?\c:\ (among
    other effects). The previous behavior has been restored.

    This is an update to CVE-2023-45283 and Go issue https://go.dev/issue/64028.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  1ec1ae2c6b6458b5d000af1ec6263b4ee337cd58:update to go1.20.11, test go1.21.4

  go1.20.11 (released 2023-11-07) includes security fixes to the path/filepath
  package, as well as bug fixes to the linker and the net/http package. See the
  Go 1.20.11 milestone on our issue tracker for details:

  - https://github.com/golang/go/issues?q=milestone%3AGo1.20.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.20.10...go1.20.11

  from the security mailing:

  [security] Go 1.21.4 and Go 1.20.11 are released

  Hello gophers,

  We have just released Go versions 1.21.4 and 1.20.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - path/filepath: recognize `\??\` as a Root Local Device path prefix.

    On Windows, a path beginning with `\??\` is a Root Local Device path equivalent
    to a path beginning with `\\?\`. Paths with a `\??\` prefix may be used to
    access arbitrary locations on the system. For example, the path `\??\c:\x`
    is equivalent to the more common path c:\x.

    The filepath package did not recognize paths with a `\??\` prefix as special.

    Clean could convert a rooted path such as `\a\..\??\b` into
    the root local device path `\??\b`. It will now convert this
    path into `.\??\b`.

    `IsAbs` did not report paths beginning with `\??\` as absolute.
    It now does so.

    VolumeName now reports the `\??\` prefix as a volume name.

    `Join(`\`, `??`, `b`)` could convert a seemingly innocent
    sequence of path elements into the root local device path
    `\??\b`. It will now convert this to `\.\??\b`.

    This is CVE-2023-45283 and https://go.dev/issue/63713.

  - path/filepath: recognize device names with trailing spaces and superscripts

    The `IsLocal` function did not correctly detect reserved names in some cases:

    - reserved names followed by spaces, such as "COM1 ".
    - "COM" or "LPT" followed by a superscript 1, 2, or 3.

    `IsLocal` now correctly reports these names as non-local.

    This is CVE-2023-45284 and https://go.dev/issue/63713.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  734219a21aae2cb1882b5650d6e5d2f2d7f79725:update to go1.21.5, go1.20.12

  go1.21.5 (released 2023-12-05) includes security fixes to the go command,
  and the net/http and path/filepath packages, as well as bug fixes to the
  compiler, the go command, the runtime, and the crypto/rand, net, os, and
  syscall packages. See the Go 1.21.5 milestone on our issue tracker for
  details:

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.5+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.4...go1.21.5

  from the security mailing:

  [security] Go 1.21.5 and Go 1.20.12 are released

  Hello gophers,

  We have just released Go versions 1.21.5 and 1.20.12, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - net/http: limit chunked data overhead

    A malicious HTTP sender can use chunk extensions to cause a receiver
    reading from a request or response body to read many more bytes from
    the network than are in the body.

    A malicious HTTP client can further exploit this to cause a server to
    automatically read a large amount of data (up to about 1GiB) when a
    handler fails to read the entire body of a request.

    Chunk extensions are a little-used HTTP feature which permit including
    additional metadata in a request or response body sent using the chunked
    encoding. The net/http chunked encoding reader discards this metadata.
    A sender can exploit this by inserting a large metadata segment with
    each byte transferred. The chunk reader now produces an error if the
    ratio of real body to encoded bytes grows too small.

    Thanks to Bartek Nowotarski for reporting this issue.

    This is CVE-2023-39326 and Go issue https://go.dev/issue/64433.

  - cmd/go: go get may unexpectedly fallback to insecure git

    Using go get to fetch a module with the ".git" suffix may unexpectedly
    fallback to the insecure "git://" protocol if the module is unavailable
    via the secure "https://" and "git+ssh://" protocols, even if GOINSECURE
    is not set for said module. This only affects users who are not using
    the module proxy and are fetching modules directly (i.e. GOPROXY=off).

    Thanks to David Leadbeater for reporting this issue.

    This is CVE-2023-45285 and Go issue https://go.dev/issue/63845.

  - path/filepath: retain trailing \ when cleaning paths like \\?\c:\

    Go 1.20.11 and Go 1.21.4 inadvertently changed the definition of the
    volume name in Windows paths starting with \\?\, resulting in
    filepath.Clean(\\?\c:\) returning \\?\c: rather than \\?\c:\ (among
    other effects). The previous behavior has been restored.

    This is an update to CVE-2023-45283 and Go issue https://go.dev/issue/64028.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  21220045259f810e05d50185e4d90dfe89e44054:update to go1.21.4, go1.20.11

  go1.21.4 (released 2023-11-07) includes security fixes to the path/filepath
  package, as well as bug fixes to the linker, the runtime, the compiler, and
  the go/types, net/http, and runtime/cgo packages. See the Go 1.21.4 milestone
  on our issue tracker for details:

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.4+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.3...go1.21.4

  from the security mailing:

  [security] Go 1.21.4 and Go 1.20.11 are released

  Hello gophers,

  We have just released Go versions 1.21.4 and 1.20.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - path/filepath: recognize `\??\` as a Root Local Device path prefix.

    On Windows, a path beginning with `\??\` is a Root Local Device path equivalent
    to a path beginning with `\\?\`. Paths with a `\??\` prefix may be used to
    access arbitrary locations on the system. For example, the path `\??\c:\x`
    is equivalent to the more common path c:\x.

    The filepath package did not recognize paths with a `\??\` prefix as special.

    Clean could convert a rooted path such as `\a\..\??\b` into
    the root local device path `\??\b`. It will now convert this
    path into `.\??\b`.

    `IsAbs` did not report paths beginning with `\??\` as absolute.
    It now does so.

    VolumeName now reports the `\??\` prefix as a volume name.

    `Join(`\`, `??`, `b`)` could convert a seemingly innocent
    sequence of path elements into the root local device path
    `\??\b`. It will now convert this to `\.\??\b`.

    This is CVE-2023-45283 and https://go.dev/issue/63713.

  - path/filepath: recognize device names with trailing spaces and superscripts

    The `IsLocal` function did not correctly detect reserved names in some cases:

    - reserved names followed by spaces, such as "COM1 ".
    - "COM" or "LPT" followed by a superscript 1, 2, or 3.

    `IsLocal` now correctly reports these names as non-local.

    This is CVE-2023-45284 and https://go.dev/issue/63713.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 0d314401d9b9ad470153dc3d09f6d9cd7d527697
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 024b1cce6b27f10e00bb9bde33a5fe9563545f8d
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 734219a21aae2cb1882b5650d6e5d2f2d7f79725
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 7cbdfc92ef38f789f1a2773fa6fac405d361a6cc
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 21220045259f810e05d50185e4d90dfe89e44054
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 1ec1ae2c6b6458b5d000af1ec6263b4ee337cd58
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/containerd/containerd/tree/024b1cce6b27f10e00bb9bde33a5fe9563545f8d
    reference_type: commit
    reference_id: 024b1cce6b27f10e00bb9bde33a5fe9563545f8d
  - url: https://github.com/containerd/containerd/tree/0d314401d9b9ad470153dc3d09f6d9cd7d527697
    reference_type: commit
    reference_id: 0d314401d9b9ad470153dc3d09f6d9cd7d527697
  - url: https://github.com/containerd/containerd/tree/1ec1ae2c6b6458b5d000af1ec6263b4ee337cd58
    reference_type: commit
    reference_id: 1ec1ae2c6b6458b5d000af1ec6263b4ee337cd58
  - url: https://github.com/containerd/containerd/tree/21220045259f810e05d50185e4d90dfe89e44054
    reference_type: commit
    reference_id: 21220045259f810e05d50185e4d90dfe89e44054
  - url: https://github.com/containerd/containerd/tree/734219a21aae2cb1882b5650d6e5d2f2d7f79725
    reference_type: commit
    reference_id: 734219a21aae2cb1882b5650d6e5d2f2d7f79725
  - url: https://github.com/containerd/containerd/tree/7cbdfc92ef38f789f1a2773fa6fac405d361a6cc
    reference_type: commit
    reference_id: 7cbdfc92ef38f789f1a2773fa6fac405d361a6cc
