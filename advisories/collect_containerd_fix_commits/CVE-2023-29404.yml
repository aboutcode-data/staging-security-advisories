advisory_id: CVE-2023-29404
datasource_id: collect_containerd_fix_commits/CVE-2023-29404
datasource_url: https://github.com/containerd/containerd
aliases: []
summary: |
  cff669c7aab055d6b46bbb27fd044aba5e1453d8:update go to go1.20.5, go1.19.10

  go1.20.5 (released 2023-06-06) includes four security fixes to the cmd/go and
  runtime packages, as well as bug fixes to the compiler, the go command, the
  runtime, and the crypto/rsa, net, and os packages. See the Go 1.20.5 milestone
  on our issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.5+label%3ACherryPickApproved

  full diff: https://github.com/golang/go/compare/go1.20.4...go1.20.5

  These minor releases include 3 security fixes following the security policy:

  - cmd/go: cgo code injection
    The go command may generate unexpected code at build time when using cgo. This
    may result in unexpected behavior when running a go program which uses cgo.

    This may occur when running an untrusted module which contains directories with
    newline characters in their names. Modules which are retrieved using the go command,
    i.e. via "go get", are not affected (modules retrieved using GOPATH-mode, i.e.
    GO111MODULE=off, may be affected).

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-29402 and Go issue https://go.dev/issue/60167.

  - runtime: unexpected behavior of setuid/setgid binaries

    The Go runtime didn't act any differently when a binary had the setuid/setgid
    bit set. On Unix platforms, if a setuid/setgid binary was executed with standard
    I/O file descriptors closed, opening any files could result in unexpected
    content being read/written with elevated prilieges. Similarly if a setuid/setgid
    program was terminated, either via panic or signal, it could leak the contents
    of its registers.

    Thanks to Vincent Dehors from Synacktiv for reporting this issue.

    This is CVE-2023-29403 and Go issue https://go.dev/issue/60272.

  - cmd/go: improper sanitization of LDFLAGS

    The go command may execute arbitrary code at build time when using cgo. This may
    occur when running "go get" on a malicious module, or when running any other
    command which builds untrusted code. This is can by triggered by linker flags,
    specified via a "#cgo LDFLAGS" directive.

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-29404 and CVE-2023-29405 and Go issues https://go.dev/issue/60305 and https://go.dev/issue/60306.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit e9f63f64f55c07e71bf96f305219bcee2cdd6289)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  17cd86629acab42dd7708720b386e88cd4be1535:[release/1.6] update go to go1.19.10

  go1.19.10 (released 2023-06-06) includes four security fixes to the cmd/go and
  runtime packages, as well as bug fixes to the compiler, the go command, and the
  runtime. See the Go 1.19.10 milestone on our issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.19.10+label%3ACherryPickApproved

  full diff: https://github.com/golang/go/compare/go1.19.9...go1.19.10

  These minor releases include 3 security fixes following the security policy:

  - cmd/go: cgo code injection
    The go command may generate unexpected code at build time when using cgo. This
    may result in unexpected behavior when running a go program which uses cgo.

    This may occur when running an untrusted module which contains directories with
    newline characters in their names. Modules which are retrieved using the go command,
    i.e. via "go get", are not affected (modules retrieved using GOPATH-mode, i.e.
    GO111MODULE=off, may be affected).

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-29402 and Go issue https://go.dev/issue/60167.

  - runtime: unexpected behavior of setuid/setgid binaries

    The Go runtime didn't act any differently when a binary had the setuid/setgid
    bit set. On Unix platforms, if a setuid/setgid binary was executed with standard
    I/O file descriptors closed, opening any files could result in unexpected
    content being read/written with elevated prilieges. Similarly if a setuid/setgid
    program was terminated, either via panic or signal, it could leak the contents
    of its registers.

    Thanks to Vincent Dehors from Synacktiv for reporting this issue.

    This is CVE-2023-29403 and Go issue https://go.dev/issue/60272.

  - cmd/go: improper sanitization of LDFLAGS

    The go command may execute arbitrary code at build time when using cgo. This may
    occur when running "go get" on a malicious module, or when running any other
    command which builds untrusted code. This is can by triggered by linker flags,
    specified via a "#cgo LDFLAGS" directive.

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-29404 and CVE-2023-29405 and Go issues https://go.dev/issue/60305 and https://go.dev/issue/60306.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  403033e52782716aa444d8d43a5c7e25efdfd4e5:update go to go1.20.5, go1.19.10

  go1.20.5 (released 2023-06-06) includes four security fixes to the cmd/go and
  runtime packages, as well as bug fixes to the compiler, the go command, the
  runtime, and the crypto/rsa, net, and os packages. See the Go 1.20.5 milestone
  on our issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.5+label%3ACherryPickApproved

  full diff: https://github.com/golang/go/compare/go1.20.4...go1.20.5

  These minor releases include 3 security fixes following the security policy:

  - cmd/go: cgo code injection
    The go command may generate unexpected code at build time when using cgo. This
    may result in unexpected behavior when running a go program which uses cgo.

    This may occur when running an untrusted module which contains directories with
    newline characters in their names. Modules which are retrieved using the go command,
    i.e. via "go get", are not affected (modules retrieved using GOPATH-mode, i.e.
    GO111MODULE=off, may be affected).

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-29402 and Go issue https://go.dev/issue/60167.

  - runtime: unexpected behavior of setuid/setgid binaries

    The Go runtime didn't act any differently when a binary had the setuid/setgid
    bit set. On Unix platforms, if a setuid/setgid binary was executed with standard
    I/O file descriptors closed, opening any files could result in unexpected
    content being read/written with elevated prilieges. Similarly if a setuid/setgid
    program was terminated, either via panic or signal, it could leak the contents
    of its registers.

    Thanks to Vincent Dehors from Synacktiv for reporting this issue.

    This is CVE-2023-29403 and Go issue https://go.dev/issue/60272.

  - cmd/go: improper sanitization of LDFLAGS

    The go command may execute arbitrary code at build time when using cgo. This may
    occur when running "go get" on a malicious module, or when running any other
    command which builds untrusted code. This is can by triggered by linker flags,
    specified via a "#cgo LDFLAGS" directive.

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-29404 and CVE-2023-29405 and Go issues https://go.dev/issue/60305 and https://go.dev/issue/60306.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit e9f63f64f55c07e71bf96f305219bcee2cdd6289)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  e9f63f64f55c07e71bf96f305219bcee2cdd6289:update go to go1.20.5, go1.19.10

  go1.20.5 (released 2023-06-06) includes four security fixes to the cmd/go and
  runtime packages, as well as bug fixes to the compiler, the go command, the
  runtime, and the crypto/rsa, net, and os packages. See the Go 1.20.5 milestone
  on our issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.5+label%3ACherryPickApproved

  full diff: https://github.com/golang/go/compare/go1.20.4...go1.20.5

  These minor releases include 3 security fixes following the security policy:

  - cmd/go: cgo code injection
    The go command may generate unexpected code at build time when using cgo. This
    may result in unexpected behavior when running a go program which uses cgo.

    This may occur when running an untrusted module which contains directories with
    newline characters in their names. Modules which are retrieved using the go command,
    i.e. via "go get", are not affected (modules retrieved using GOPATH-mode, i.e.
    GO111MODULE=off, may be affected).

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-29402 and Go issue https://go.dev/issue/60167.

  - runtime: unexpected behavior of setuid/setgid binaries

    The Go runtime didn't act any differently when a binary had the setuid/setgid
    bit set. On Unix platforms, if a setuid/setgid binary was executed with standard
    I/O file descriptors closed, opening any files could result in unexpected
    content being read/written with elevated prilieges. Similarly if a setuid/setgid
    program was terminated, either via panic or signal, it could leak the contents
    of its registers.

    Thanks to Vincent Dehors from Synacktiv for reporting this issue.

    This is CVE-2023-29403 and Go issue https://go.dev/issue/60272.

  - cmd/go: improper sanitization of LDFLAGS

    The go command may execute arbitrary code at build time when using cgo. This may
    occur when running "go get" on a malicious module, or when running any other
    command which builds untrusted code. This is can by triggered by linker flags,
    specified via a "#cgo LDFLAGS" directive.

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-29404 and CVE-2023-29405 and Go issues https://go.dev/issue/60305 and https://go.dev/issue/60306.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 403033e52782716aa444d8d43a5c7e25efdfd4e5
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 17cd86629acab42dd7708720b386e88cd4be1535
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: cff669c7aab055d6b46bbb27fd044aba5e1453d8
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: e9f63f64f55c07e71bf96f305219bcee2cdd6289
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/containerd/containerd/tree/17cd86629acab42dd7708720b386e88cd4be1535
    reference_type: commit
    reference_id: 17cd86629acab42dd7708720b386e88cd4be1535
  - url: https://github.com/containerd/containerd/tree/403033e52782716aa444d8d43a5c7e25efdfd4e5
    reference_type: commit
    reference_id: 403033e52782716aa444d8d43a5c7e25efdfd4e5
  - url: https://github.com/containerd/containerd/tree/cff669c7aab055d6b46bbb27fd044aba5e1453d8
    reference_type: commit
    reference_id: cff669c7aab055d6b46bbb27fd044aba5e1453d8
  - url: https://github.com/containerd/containerd/tree/e9f63f64f55c07e71bf96f305219bcee2cdd6289
    reference_type: commit
    reference_id: e9f63f64f55c07e71bf96f305219bcee2cdd6289
