advisory_id: CVE-2021-3115
datasource_id: collect_containerd_fix_commits/CVE-2021-3115
datasource_url: https://github.com/containerd/containerd
aliases: []
summary: |
  2ac996840187b2e42fdbe4e4c9b6b55a7c775c43:replace uses of os/exec with golang.org/x/sys/execabs

  Go 1.15.7 contained a security fix for CVE-2021-3115, which allowed arbitrary
  code to be executed at build time when using cgo on Windows. This issue also
  affects Unix users who have “.” listed explicitly in their PATH and are running
  “go get” outside of a module or with module mode disabled.

  This issue is not limited to the go command itself, and can also affect binaries
  that use `os.Command`, `os.LookPath`, etc.

  From the related blogpost (ttps://blog.golang.org/path-security):

  > Are your own programs affected?
  >
  > If you use exec.LookPath or exec.Command in your own programs, you only need to
  > be concerned if you (or your users) run your program in a directory with untrusted
  > contents. If so, then a subprocess could be started using an executable from dot
  > instead of from a system directory. (Again, using an executable from dot happens
  > always on Windows and only with uncommon PATH settings on Unix.)
  >
  > If you are concerned, then we’ve published the more restricted variant of os/exec
  > as golang.org/x/sys/execabs. You can use it in your program by simply replacing

  This patch replaces all uses of `os/exec` with `golang.org/x/sys/execabs`. While
  some uses of `os/exec` should not be problematic (e.g. part of tests), it is
  probably good to be consistent, in case code gets moved around.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 2ac996840187b2e42fdbe4e4c9b6b55a7c775c43
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/containerd/containerd/tree/2ac996840187b2e42fdbe4e4c9b6b55a7c775c43
    reference_type: commit
    reference_id: 2ac996840187b2e42fdbe4e4c9b6b55a7c775c43
