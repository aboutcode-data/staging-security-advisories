advisory_id: CVE-2022-2879
datasource_id: collect_containerd_fix_commits/CVE-2022-2879
datasource_url: https://github.com/containerd/containerd
aliases: []
summary: |
  ebba7849fa17c1acdb4385695165d9d0983f8227:Merge pull request #7476 from thaJeztah/1.5_bump_go_1.18.7

  [release/1.5] Update go 1.18.7, addresses CVE-2022-2879, CVE-2022-2880, CVE-2022-41715
  a6672294a5fb12bbab45beaab6d5f963c88cf5ed:[release/1.5] Update go 1.18.7, addresses CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.18.7

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  a6672294a5fb12bbab45beaab6d5f963c88cf5ed:[release/1.5] Update go 1.18.7, addresses CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.18.7

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  1eb637f95a61d14b14febb0f824ff348314d360f:Merge pull request #7475 from thaJeztah/1.6_bump_go_1.18.7

  [release/1.6] Update go 1.18.7, addresses CVE-2022-2879, CVE-2022-2880, CVE-2022-41715
  28324c529fad2285d44ae5348377496cdf9c4926:[release/1.6] Update go 1.18.7, addresses CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.18.7

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  28324c529fad2285d44ae5348377496cdf9c4926:[release/1.6] Update go 1.18.7, addresses CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.18.7

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  54f2b51215be6317a632579d225fdca60e8823f8:Update to go 1.19.2 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.19.2

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  54f2b51215be6317a632579d225fdca60e8823f8:Update to go 1.19.2 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.19.2

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 28324c529fad2285d44ae5348377496cdf9c4926
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 1eb637f95a61d14b14febb0f824ff348314d360f
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: a6672294a5fb12bbab45beaab6d5f963c88cf5ed
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: ebba7849fa17c1acdb4385695165d9d0983f8227
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 54f2b51215be6317a632579d225fdca60e8823f8
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/containerd/containerd/tree/1eb637f95a61d14b14febb0f824ff348314d360f
    reference_type: commit
    reference_id: 1eb637f95a61d14b14febb0f824ff348314d360f
  - url: https://github.com/containerd/containerd/tree/28324c529fad2285d44ae5348377496cdf9c4926
    reference_type: commit
    reference_id: 28324c529fad2285d44ae5348377496cdf9c4926
  - url: https://github.com/containerd/containerd/tree/54f2b51215be6317a632579d225fdca60e8823f8
    reference_type: commit
    reference_id: 54f2b51215be6317a632579d225fdca60e8823f8
  - url: https://github.com/containerd/containerd/tree/a6672294a5fb12bbab45beaab6d5f963c88cf5ed
    reference_type: commit
    reference_id: a6672294a5fb12bbab45beaab6d5f963c88cf5ed
  - url: https://github.com/containerd/containerd/tree/ebba7849fa17c1acdb4385695165d9d0983f8227
    reference_type: commit
    reference_id: ebba7849fa17c1acdb4385695165d9d0983f8227
