advisory_id: CVE-2022-41720
datasource_id: collect_containerd_fix_commits/CVE-2022-41720
datasource_url: https://github.com/containerd/containerd
aliases: []
summary: |
  9743dbae8b442527647a387b61f5fe52742992c6:[release/1.6] update to go1.18.9

  Includes security fixes for net/http (CVE-2022-41717, CVE-2022-41720),
  and os (CVE-2022-41720).

  These minor releases include 2 security fixes following the security policy:

  - os, net/http: avoid escapes from os.DirFS and http.Dir on Windows

    The os.DirFS function and http.Dir type provide access to a tree of files
    rooted at a given directory. These functions permitted access to Windows
    device files under that root. For example, os.DirFS("C:/tmp").Open("COM1")
    would open the COM1 device.
    Both os.DirFS and http.Dir only provide read-only filesystem access.

    In addition, on Windows, an os.DirFS for the directory \(the root of the
    current drive) can permit a maliciously crafted path to escape from the
    drive and access any path on the system.

    The behavior of os.DirFS("") has changed. Previously, an empty root was
    treated equivalently to "/", so os.DirFS("").Open("tmp") would open the
    path "/tmp". This now returns an error.

    This is CVE-2022-41720 and Go issue https://go.dev/issue/56694.

  - net/http: limit canonical header cache by bytes, not entries

    An attacker can cause excessive memory growth in a Go server accepting
    HTTP/2 requests.

    HTTP/2 server connections contain a cache of HTTP header keys sent by
    the client. While the total number of entries in this cache is capped,
    an attacker sending very large keys can cause the server to allocate
    approximately 64 MiB per open connection.

    This issue is also fixed in golang.org/x/net/http2 vX.Y.Z, for users
    manually configuring HTTP/2.

    Thanks to Josselin Costanzi for reporting this issue.

    This is CVE-2022-41717 and Go issue https://go.dev/issue/56350.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.18.9

  And the milestone on the issue tracker:
  https://github.com/golang/go/issues?q=milestone%3AGo1.18.9+label%3ACherryPickApproved

  Full diff: https://github.com/golang/go/compare/go1.18.8...go1.18.9

  The golang.org/x/net fix is in https://github.com/golang/net/commit/1e63c2f08a10a150fa02c50ece89b340ae64efe4

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  9743dbae8b442527647a387b61f5fe52742992c6:[release/1.6] update to go1.18.9

  Includes security fixes for net/http (CVE-2022-41717, CVE-2022-41720),
  and os (CVE-2022-41720).

  These minor releases include 2 security fixes following the security policy:

  - os, net/http: avoid escapes from os.DirFS and http.Dir on Windows

    The os.DirFS function and http.Dir type provide access to a tree of files
    rooted at a given directory. These functions permitted access to Windows
    device files under that root. For example, os.DirFS("C:/tmp").Open("COM1")
    would open the COM1 device.
    Both os.DirFS and http.Dir only provide read-only filesystem access.

    In addition, on Windows, an os.DirFS for the directory \(the root of the
    current drive) can permit a maliciously crafted path to escape from the
    drive and access any path on the system.

    The behavior of os.DirFS("") has changed. Previously, an empty root was
    treated equivalently to "/", so os.DirFS("").Open("tmp") would open the
    path "/tmp". This now returns an error.

    This is CVE-2022-41720 and Go issue https://go.dev/issue/56694.

  - net/http: limit canonical header cache by bytes, not entries

    An attacker can cause excessive memory growth in a Go server accepting
    HTTP/2 requests.

    HTTP/2 server connections contain a cache of HTTP header keys sent by
    the client. While the total number of entries in this cache is capped,
    an attacker sending very large keys can cause the server to allocate
    approximately 64 MiB per open connection.

    This issue is also fixed in golang.org/x/net/http2 vX.Y.Z, for users
    manually configuring HTTP/2.

    Thanks to Josselin Costanzi for reporting this issue.

    This is CVE-2022-41717 and Go issue https://go.dev/issue/56350.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.18.9

  And the milestone on the issue tracker:
  https://github.com/golang/go/issues?q=milestone%3AGo1.18.9+label%3ACherryPickApproved

  Full diff: https://github.com/golang/go/compare/go1.18.8...go1.18.9

  The golang.org/x/net fix is in https://github.com/golang/net/commit/1e63c2f08a10a150fa02c50ece89b340ae64efe4

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  9743dbae8b442527647a387b61f5fe52742992c6:[release/1.6] update to go1.18.9

  Includes security fixes for net/http (CVE-2022-41717, CVE-2022-41720),
  and os (CVE-2022-41720).

  These minor releases include 2 security fixes following the security policy:

  - os, net/http: avoid escapes from os.DirFS and http.Dir on Windows

    The os.DirFS function and http.Dir type provide access to a tree of files
    rooted at a given directory. These functions permitted access to Windows
    device files under that root. For example, os.DirFS("C:/tmp").Open("COM1")
    would open the COM1 device.
    Both os.DirFS and http.Dir only provide read-only filesystem access.

    In addition, on Windows, an os.DirFS for the directory \(the root of the
    current drive) can permit a maliciously crafted path to escape from the
    drive and access any path on the system.

    The behavior of os.DirFS("") has changed. Previously, an empty root was
    treated equivalently to "/", so os.DirFS("").Open("tmp") would open the
    path "/tmp". This now returns an error.

    This is CVE-2022-41720 and Go issue https://go.dev/issue/56694.

  - net/http: limit canonical header cache by bytes, not entries

    An attacker can cause excessive memory growth in a Go server accepting
    HTTP/2 requests.

    HTTP/2 server connections contain a cache of HTTP header keys sent by
    the client. While the total number of entries in this cache is capped,
    an attacker sending very large keys can cause the server to allocate
    approximately 64 MiB per open connection.

    This issue is also fixed in golang.org/x/net/http2 vX.Y.Z, for users
    manually configuring HTTP/2.

    Thanks to Josselin Costanzi for reporting this issue.

    This is CVE-2022-41717 and Go issue https://go.dev/issue/56350.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.18.9

  And the milestone on the issue tracker:
  https://github.com/golang/go/issues?q=milestone%3AGo1.18.9+label%3ACherryPickApproved

  Full diff: https://github.com/golang/go/compare/go1.18.8...go1.18.9

  The golang.org/x/net fix is in https://github.com/golang/net/commit/1e63c2f08a10a150fa02c50ece89b340ae64efe4

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  46e2ef099401a051780688ad0b6a72b35b9b3681:[release/1.5] update to go1.18.9

  Includes security fixes for net/http (CVE-2022-41717, CVE-2022-41720),
  and os (CVE-2022-41720).

  These minor releases include 2 security fixes following the security policy:

  - os, net/http: avoid escapes from os.DirFS and http.Dir on Windows

    The os.DirFS function and http.Dir type provide access to a tree of files
    rooted at a given directory. These functions permitted access to Windows
    device files under that root. For example, os.DirFS("C:/tmp").Open("COM1")
    would open the COM1 device.
    Both os.DirFS and http.Dir only provide read-only filesystem access.

    In addition, on Windows, an os.DirFS for the directory \(the root of the
    current drive) can permit a maliciously crafted path to escape from the
    drive and access any path on the system.

    The behavior of os.DirFS("") has changed. Previously, an empty root was
    treated equivalently to "/", so os.DirFS("").Open("tmp") would open the
    path "/tmp". This now returns an error.

    This is CVE-2022-41720 and Go issue https://go.dev/issue/56694.

  - net/http: limit canonical header cache by bytes, not entries

    An attacker can cause excessive memory growth in a Go server accepting
    HTTP/2 requests.

    HTTP/2 server connections contain a cache of HTTP header keys sent by
    the client. While the total number of entries in this cache is capped,
    an attacker sending very large keys can cause the server to allocate
    approximately 64 MiB per open connection.

    This issue is also fixed in golang.org/x/net/http2 vX.Y.Z, for users
    manually configuring HTTP/2.

    Thanks to Josselin Costanzi for reporting this issue.

    This is CVE-2022-41717 and Go issue https://go.dev/issue/56350.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.18.9

  And the milestone on the issue tracker:
  https://github.com/golang/go/issues?q=milestone%3AGo1.18.9+label%3ACherryPickApproved

  Full diff: https://github.com/golang/go/compare/go1.18.8...go1.18.9

  The golang.org/x/net fix is in https://github.com/golang/net/commit/1e63c2f08a10a150fa02c50ece89b340ae64efe4

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  46e2ef099401a051780688ad0b6a72b35b9b3681:[release/1.5] update to go1.18.9

  Includes security fixes for net/http (CVE-2022-41717, CVE-2022-41720),
  and os (CVE-2022-41720).

  These minor releases include 2 security fixes following the security policy:

  - os, net/http: avoid escapes from os.DirFS and http.Dir on Windows

    The os.DirFS function and http.Dir type provide access to a tree of files
    rooted at a given directory. These functions permitted access to Windows
    device files under that root. For example, os.DirFS("C:/tmp").Open("COM1")
    would open the COM1 device.
    Both os.DirFS and http.Dir only provide read-only filesystem access.

    In addition, on Windows, an os.DirFS for the directory \(the root of the
    current drive) can permit a maliciously crafted path to escape from the
    drive and access any path on the system.

    The behavior of os.DirFS("") has changed. Previously, an empty root was
    treated equivalently to "/", so os.DirFS("").Open("tmp") would open the
    path "/tmp". This now returns an error.

    This is CVE-2022-41720 and Go issue https://go.dev/issue/56694.

  - net/http: limit canonical header cache by bytes, not entries

    An attacker can cause excessive memory growth in a Go server accepting
    HTTP/2 requests.

    HTTP/2 server connections contain a cache of HTTP header keys sent by
    the client. While the total number of entries in this cache is capped,
    an attacker sending very large keys can cause the server to allocate
    approximately 64 MiB per open connection.

    This issue is also fixed in golang.org/x/net/http2 vX.Y.Z, for users
    manually configuring HTTP/2.

    Thanks to Josselin Costanzi for reporting this issue.

    This is CVE-2022-41717 and Go issue https://go.dev/issue/56350.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.18.9

  And the milestone on the issue tracker:
  https://github.com/golang/go/issues?q=milestone%3AGo1.18.9+label%3ACherryPickApproved

  Full diff: https://github.com/golang/go/compare/go1.18.8...go1.18.9

  The golang.org/x/net fix is in https://github.com/golang/net/commit/1e63c2f08a10a150fa02c50ece89b340ae64efe4

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  46e2ef099401a051780688ad0b6a72b35b9b3681:[release/1.5] update to go1.18.9

  Includes security fixes for net/http (CVE-2022-41717, CVE-2022-41720),
  and os (CVE-2022-41720).

  These minor releases include 2 security fixes following the security policy:

  - os, net/http: avoid escapes from os.DirFS and http.Dir on Windows

    The os.DirFS function and http.Dir type provide access to a tree of files
    rooted at a given directory. These functions permitted access to Windows
    device files under that root. For example, os.DirFS("C:/tmp").Open("COM1")
    would open the COM1 device.
    Both os.DirFS and http.Dir only provide read-only filesystem access.

    In addition, on Windows, an os.DirFS for the directory \(the root of the
    current drive) can permit a maliciously crafted path to escape from the
    drive and access any path on the system.

    The behavior of os.DirFS("") has changed. Previously, an empty root was
    treated equivalently to "/", so os.DirFS("").Open("tmp") would open the
    path "/tmp". This now returns an error.

    This is CVE-2022-41720 and Go issue https://go.dev/issue/56694.

  - net/http: limit canonical header cache by bytes, not entries

    An attacker can cause excessive memory growth in a Go server accepting
    HTTP/2 requests.

    HTTP/2 server connections contain a cache of HTTP header keys sent by
    the client. While the total number of entries in this cache is capped,
    an attacker sending very large keys can cause the server to allocate
    approximately 64 MiB per open connection.

    This issue is also fixed in golang.org/x/net/http2 vX.Y.Z, for users
    manually configuring HTTP/2.

    Thanks to Josselin Costanzi for reporting this issue.

    This is CVE-2022-41717 and Go issue https://go.dev/issue/56350.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.18.9

  And the milestone on the issue tracker:
  https://github.com/golang/go/issues?q=milestone%3AGo1.18.9+label%3ACherryPickApproved

  Full diff: https://github.com/golang/go/compare/go1.18.8...go1.18.9

  The golang.org/x/net fix is in https://github.com/golang/net/commit/1e63c2f08a10a150fa02c50ece89b340ae64efe4

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  85776d2c671b14d0ad37d2e3e5a5d5f5d2800a41:update to go1.19.4, go1.18.9

  Includes security fixes for net/http (CVE-2022-41717, CVE-2022-41720),
  and os (CVE-2022-41720).

  These minor releases include 2 security fixes following the security policy:

  - os, net/http: avoid escapes from os.DirFS and http.Dir on Windows

    The os.DirFS function and http.Dir type provide access to a tree of files
    rooted at a given directory. These functions permitted access to Windows
    device files under that root. For example, os.DirFS("C:/tmp").Open("COM1")
    would open the COM1 device.
    Both os.DirFS and http.Dir only provide read-only filesystem access.

    In addition, on Windows, an os.DirFS for the directory \(the root of the
    current drive) can permit a maliciously crafted path to escape from the
    drive and access any path on the system.

    The behavior of os.DirFS("") has changed. Previously, an empty root was
    treated equivalently to "/", so os.DirFS("").Open("tmp") would open the
    path "/tmp". This now returns an error.

    This is CVE-2022-41720 and Go issue https://go.dev/issue/56694.

  - net/http: limit canonical header cache by bytes, not entries

    An attacker can cause excessive memory growth in a Go server accepting
    HTTP/2 requests.

    HTTP/2 server connections contain a cache of HTTP header keys sent by
    the client. While the total number of entries in this cache is capped,
    an attacker sending very large keys can cause the server to allocate
    approximately 64 MiB per open connection.

    This issue is also fixed in golang.org/x/net/http2 vX.Y.Z, for users
    manually configuring HTTP/2.

    Thanks to Josselin Costanzi for reporting this issue.

    This is CVE-2022-41717 and Go issue https://go.dev/issue/56350.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.19.4

  And the milestone on the issue tracker:
  https://github.com/golang/go/issues?q=milestone%3AGo1.19.4+label%3ACherryPickApproved

  Full diff: https://github.com/golang/go/compare/go1.19.3...go1.19.4

  The golang.org/x/net fix is in https://github.com/golang/net/commit/1e63c2f08a10a150fa02c50ece89b340ae64efe4

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  85776d2c671b14d0ad37d2e3e5a5d5f5d2800a41:update to go1.19.4, go1.18.9

  Includes security fixes for net/http (CVE-2022-41717, CVE-2022-41720),
  and os (CVE-2022-41720).

  These minor releases include 2 security fixes following the security policy:

  - os, net/http: avoid escapes from os.DirFS and http.Dir on Windows

    The os.DirFS function and http.Dir type provide access to a tree of files
    rooted at a given directory. These functions permitted access to Windows
    device files under that root. For example, os.DirFS("C:/tmp").Open("COM1")
    would open the COM1 device.
    Both os.DirFS and http.Dir only provide read-only filesystem access.

    In addition, on Windows, an os.DirFS for the directory \(the root of the
    current drive) can permit a maliciously crafted path to escape from the
    drive and access any path on the system.

    The behavior of os.DirFS("") has changed. Previously, an empty root was
    treated equivalently to "/", so os.DirFS("").Open("tmp") would open the
    path "/tmp". This now returns an error.

    This is CVE-2022-41720 and Go issue https://go.dev/issue/56694.

  - net/http: limit canonical header cache by bytes, not entries

    An attacker can cause excessive memory growth in a Go server accepting
    HTTP/2 requests.

    HTTP/2 server connections contain a cache of HTTP header keys sent by
    the client. While the total number of entries in this cache is capped,
    an attacker sending very large keys can cause the server to allocate
    approximately 64 MiB per open connection.

    This issue is also fixed in golang.org/x/net/http2 vX.Y.Z, for users
    manually configuring HTTP/2.

    Thanks to Josselin Costanzi for reporting this issue.

    This is CVE-2022-41717 and Go issue https://go.dev/issue/56350.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.19.4

  And the milestone on the issue tracker:
  https://github.com/golang/go/issues?q=milestone%3AGo1.19.4+label%3ACherryPickApproved

  Full diff: https://github.com/golang/go/compare/go1.19.3...go1.19.4

  The golang.org/x/net fix is in https://github.com/golang/net/commit/1e63c2f08a10a150fa02c50ece89b340ae64efe4

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  85776d2c671b14d0ad37d2e3e5a5d5f5d2800a41:update to go1.19.4, go1.18.9

  Includes security fixes for net/http (CVE-2022-41717, CVE-2022-41720),
  and os (CVE-2022-41720).

  These minor releases include 2 security fixes following the security policy:

  - os, net/http: avoid escapes from os.DirFS and http.Dir on Windows

    The os.DirFS function and http.Dir type provide access to a tree of files
    rooted at a given directory. These functions permitted access to Windows
    device files under that root. For example, os.DirFS("C:/tmp").Open("COM1")
    would open the COM1 device.
    Both os.DirFS and http.Dir only provide read-only filesystem access.

    In addition, on Windows, an os.DirFS for the directory \(the root of the
    current drive) can permit a maliciously crafted path to escape from the
    drive and access any path on the system.

    The behavior of os.DirFS("") has changed. Previously, an empty root was
    treated equivalently to "/", so os.DirFS("").Open("tmp") would open the
    path "/tmp". This now returns an error.

    This is CVE-2022-41720 and Go issue https://go.dev/issue/56694.

  - net/http: limit canonical header cache by bytes, not entries

    An attacker can cause excessive memory growth in a Go server accepting
    HTTP/2 requests.

    HTTP/2 server connections contain a cache of HTTP header keys sent by
    the client. While the total number of entries in this cache is capped,
    an attacker sending very large keys can cause the server to allocate
    approximately 64 MiB per open connection.

    This issue is also fixed in golang.org/x/net/http2 vX.Y.Z, for users
    manually configuring HTTP/2.

    Thanks to Josselin Costanzi for reporting this issue.

    This is CVE-2022-41717 and Go issue https://go.dev/issue/56350.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.19.4

  And the milestone on the issue tracker:
  https://github.com/golang/go/issues?q=milestone%3AGo1.19.4+label%3ACherryPickApproved

  Full diff: https://github.com/golang/go/compare/go1.19.3...go1.19.4

  The golang.org/x/net fix is in https://github.com/golang/net/commit/1e63c2f08a10a150fa02c50ece89b340ae64efe4

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 9743dbae8b442527647a387b61f5fe52742992c6
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 85776d2c671b14d0ad37d2e3e5a5d5f5d2800a41
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 46e2ef099401a051780688ad0b6a72b35b9b3681
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/containerd/containerd/tree/46e2ef099401a051780688ad0b6a72b35b9b3681
    reference_type: commit
    reference_id: 46e2ef099401a051780688ad0b6a72b35b9b3681
  - url: https://github.com/containerd/containerd/tree/85776d2c671b14d0ad37d2e3e5a5d5f5d2800a41
    reference_type: commit
    reference_id: 85776d2c671b14d0ad37d2e3e5a5d5f5d2800a41
  - url: https://github.com/containerd/containerd/tree/9743dbae8b442527647a387b61f5fe52742992c6
    reference_type: commit
    reference_id: 9743dbae8b442527647a387b61f5fe52742992c6
