advisory_id: CVE-2019-16276
datasource_id: collect_containerd_fix_commits/CVE-2019-16276
datasource_url: https://github.com/containerd/containerd
aliases: []
summary: |
  23b0ca70feadeda6b9f1f7072e71687c660590ca:Update Golang 1.12.12 (CVE-2019-17596)

  Golang 1.12.12
  -------------------------------

  go1.12.12 (released 2019/10/17) includes fixes to the go command, runtime,
  syscall and net packages. See the Go 1.12.12 milestone on our issue tracker for
  details.

  https://github.com/golang/go/issues?q=milestone%3AGo1.12.12

  Golang 1.12.11 (CVE-2019-17596)
  -------------------------------

  go1.12.11 (released 2019/10/17) includes security fixes to the crypto/dsa
  package. See the Go 1.12.11 milestone on our issue tracker for details.
  https://github.com/golang/go/issues?q=milestone%3AGo1.12.11

  [security] Go 1.13.2 and Go 1.12.11 are released

  Hi gophers,

  We have just released Go 1.13.2 and Go 1.12.11 to address a recently reported
  security issue. We recommend that all affected users update to one of these
  releases (if you're not sure which, choose Go 1.13.2).

  Invalid DSA public keys can cause a panic in dsa.Verify. In particular, using
  crypto/x509.Verify on a crafted X.509 certificate chain can lead to a panic,
  even if the certificates don't chain to a trusted root. The chain can be
  delivered via a crypto/tls connection to a client, or to a server that accepts
  and verifies client certificates. net/http clients can be made to crash by an
  HTTPS server, while net/http servers that accept client certificates will
  recover the panic and are unaffected.

  Moreover, an application might crash invoking
  crypto/x509.(*CertificateRequest).CheckSignature on an X.509 certificate
  request, parsing a golang.org/x/crypto/openpgp Entity, or during a
  golang.org/x/crypto/otr conversation. Finally, a golang.org/x/crypto/ssh client
  can panic due to a malformed host key, while a server could panic if either
  PublicKeyCallback accepts a malformed public key, or if IsUserAuthority accepts
  a certificate with a malformed public key.

  The issue is CVE-2019-17596 and Go issue golang.org/issue/34960.

  Thanks to Daniel Mandragona for discovering and reporting this issue. We'd also
  like to thank regilero for a previous disclosure of CVE-2019-16276.

  The Go 1.13.2 release also includes a fix to the compiler that prevents improper
  access to negative slice indexes in rare cases. Affected code, in which the
  compiler can prove that the index is zero or negative, would have resulted in a
  panic in Go 1.12, but could have led to arbitrary memory read and writes in Go
  1.13 and Go 1.13.1. This is Go issue golang.org/issue/34802.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 6356e55be002df80b98ba59ec98dfd0ece7ec80c)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  e319caedc4f32d6eb91352c52e008f6c934fb2cc:Update Golang 1.12.12 (CVE-2019-17596)

  Golang 1.12.12
  -------------------------------

  go1.12.12 (released 2019/10/17) includes fixes to the go command, runtime,
  syscall and net packages. See the Go 1.12.12 milestone on our issue tracker for
  details.

  https://github.com/golang/go/issues?q=milestone%3AGo1.12.12

  Golang 1.12.11 (CVE-2019-17596)
  -------------------------------

  go1.12.11 (released 2019/10/17) includes security fixes to the crypto/dsa
  package. See the Go 1.12.11 milestone on our issue tracker for details.
  https://github.com/golang/go/issues?q=milestone%3AGo1.12.11

  [security] Go 1.13.2 and Go 1.12.11 are released

  Hi gophers,

  We have just released Go 1.13.2 and Go 1.12.11 to address a recently reported
  security issue. We recommend that all affected users update to one of these
  releases (if you're not sure which, choose Go 1.13.2).

  Invalid DSA public keys can cause a panic in dsa.Verify. In particular, using
  crypto/x509.Verify on a crafted X.509 certificate chain can lead to a panic,
  even if the certificates don't chain to a trusted root. The chain can be
  delivered via a crypto/tls connection to a client, or to a server that accepts
  and verifies client certificates. net/http clients can be made to crash by an
  HTTPS server, while net/http servers that accept client certificates will
  recover the panic and are unaffected.

  Moreover, an application might crash invoking
  crypto/x509.(*CertificateRequest).CheckSignature on an X.509 certificate
  request, parsing a golang.org/x/crypto/openpgp Entity, or during a
  golang.org/x/crypto/otr conversation. Finally, a golang.org/x/crypto/ssh client
  can panic due to a malformed host key, while a server could panic if either
  PublicKeyCallback accepts a malformed public key, or if IsUserAuthority accepts
  a certificate with a malformed public key.

  The issue is CVE-2019-17596 and Go issue golang.org/issue/34960.

  Thanks to Daniel Mandragona for discovering and reporting this issue. We'd also
  like to thank regilero for a previous disclosure of CVE-2019-16276.

  The Go 1.13.2 release also includes a fix to the compiler that prevents improper
  access to negative slice indexes in rare cases. Affected code, in which the
  compiler can prove that the index is zero or negative, would have resulted in a
  panic in Go 1.12, but could have led to arbitrary memory read and writes in Go
  1.13 and Go 1.13.1. This is Go issue golang.org/issue/34802.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 6356e55be002df80b98ba59ec98dfd0ece7ec80c)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  6356e55be002df80b98ba59ec98dfd0ece7ec80c:Update Golang 1.12.12 (CVE-2019-17596)

  Golang 1.12.12
  -------------------------------

  go1.12.12 (released 2019/10/17) includes fixes to the go command, runtime,
  syscall and net packages. See the Go 1.12.12 milestone on our issue tracker for
  details.

  https://github.com/golang/go/issues?q=milestone%3AGo1.12.12

  Golang 1.12.11 (CVE-2019-17596)
  -------------------------------

  go1.12.11 (released 2019/10/17) includes security fixes to the crypto/dsa
  package. See the Go 1.12.11 milestone on our issue tracker for details.
  https://github.com/golang/go/issues?q=milestone%3AGo1.12.11

  [security] Go 1.13.2 and Go 1.12.11 are released

  Hi gophers,

  We have just released Go 1.13.2 and Go 1.12.11 to address a recently reported
  security issue. We recommend that all affected users update to one of these
  releases (if you're not sure which, choose Go 1.13.2).

  Invalid DSA public keys can cause a panic in dsa.Verify. In particular, using
  crypto/x509.Verify on a crafted X.509 certificate chain can lead to a panic,
  even if the certificates don't chain to a trusted root. The chain can be
  delivered via a crypto/tls connection to a client, or to a server that accepts
  and verifies client certificates. net/http clients can be made to crash by an
  HTTPS server, while net/http servers that accept client certificates will
  recover the panic and are unaffected.

  Moreover, an application might crash invoking
  crypto/x509.(*CertificateRequest).CheckSignature on an X.509 certificate
  request, parsing a golang.org/x/crypto/openpgp Entity, or during a
  golang.org/x/crypto/otr conversation. Finally, a golang.org/x/crypto/ssh client
  can panic due to a malformed host key, while a server could panic if either
  PublicKeyCallback accepts a malformed public key, or if IsUserAuthority accepts
  a certificate with a malformed public key.

  The issue is CVE-2019-17596 and Go issue golang.org/issue/34960.

  Thanks to Daniel Mandragona for discovering and reporting this issue. We'd also
  like to thank regilero for a previous disclosure of CVE-2019-16276.

  The Go 1.13.2 release also includes a fix to the compiler that prevents improper
  access to negative slice indexes in rare cases. Affected code, in which the
  compiler can prove that the index is zero or negative, would have resulted in a
  panic in Go 1.12, but could have led to arbitrary memory read and writes in Go
  1.13 and Go 1.13.1. This is Go issue golang.org/issue/34802.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  61f763ffef3ca621c5b2a130b8c0b225cfec136f:Merge pull request #3687 from thaJeztah/1.2_backport_bump_golang_1.12.10

  [release/1.2 backport] AppVeyor: bump golang 1.12.10 (CVE-2019-16276)
  277ab9ed6e1ef8ca003eb6db54271d26a99aa87a:Merge pull request #3686 from thaJeztah/bump_golang_1.12.10

  AppVeyor: bump golang 1.12.10 (CVE-2019-16276)
  8d33d03519a7b87b5ef8a5d973228826cde7d759:AppVeyor: bump golang 1.12.10 (CVE-2019-16276)

  full diff: https://github.com/golang/go/compare/go1.12.9...go1.12.10

  ```
  Hi gophers,

  We have just released Go 1.13.1 and Go 1.12.10 to address a recently reported security issue. We recommend that all affected users update to one of these releases (if you're not sure which, choose Go 1.13.1).

  net/http (through net/textproto) used to accept and normalize invalid HTTP/1.1 headers with a space before the colon, in violation of RFC 7230. If a Go server is used behind an uncommon reverse proxy that accepts and forwards but doesn't normalize such invalid headers, the reverse proxy and the server can interpret the headers differently. This can lead to filter bypasses or request smuggling, the latter if requests from separate clients are multiplexed onto the same upstream connection by the proxy. Such invalid headers are now rejected by Go servers, and passed without normalization to Go client applications.

  The issue is CVE-2019-16276 and Go issue golang.org/issue/34540.

  Thanks to Andrew Stucki, Adam Scarr (99designs.com), and Jan Masarik (masarik.sh) for discovering and reporting this issue.

  Downloads are available at https://golang.org/dl for all supported platforms.

  Alla prossima,
  Filippo on behalf of the Go team
  ```

  From the patch: https://github.com/golang/go/commit/6e6f4aaf70c8b1cc81e65a26332aa9409de03ad8

  ```
  net/textproto: don't normalize headers with spaces before the colon

  RFC 7230 is clear about headers with a space before the colon, like

  X-Answer : 42

  being invalid, but we've been accepting and normalizing them for compatibility
  purposes since CL 5690059 in 2012.

  On the client side, this is harmless and indeed most browsers behave the same
  to this day. On the server side, this becomes a security issue when the
  behavior doesn't match that of a reverse proxy sitting in front of the server.

  For example, if a WAF accepts them without normalizing them, it might be
  possible to bypass its filters, because the Go server would interpret the
  header differently. Worse, if the reverse proxy coalesces requests onto a
  single HTTP/1.1 connection to a Go server, the understanding of the request
  boundaries can get out of sync between them, allowing an attacker to tack an
  arbitrary method and path onto a request by other clients, including
  authentication headers unknown to the attacker.

  This was recently presented at multiple security conferences:
  https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn

  net/http servers already reject header keys with invalid characters.
  Simply stop normalizing extra spaces in net/textproto, let it return them
  unchanged like it does for other invalid headers, and let net/http enforce
  RFC 7230, which is HTTP specific. This loses us normalization on the client
  side, but there's no right answer on the client side anyway, and hiding the
  issue sounds worse than letting the application decide.
  ```

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 35d3bae1e16de3d4b24ec3770c7b982006923440)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  8d33d03519a7b87b5ef8a5d973228826cde7d759:AppVeyor: bump golang 1.12.10 (CVE-2019-16276)

  full diff: https://github.com/golang/go/compare/go1.12.9...go1.12.10

  ```
  Hi gophers,

  We have just released Go 1.13.1 and Go 1.12.10 to address a recently reported security issue. We recommend that all affected users update to one of these releases (if you're not sure which, choose Go 1.13.1).

  net/http (through net/textproto) used to accept and normalize invalid HTTP/1.1 headers with a space before the colon, in violation of RFC 7230. If a Go server is used behind an uncommon reverse proxy that accepts and forwards but doesn't normalize such invalid headers, the reverse proxy and the server can interpret the headers differently. This can lead to filter bypasses or request smuggling, the latter if requests from separate clients are multiplexed onto the same upstream connection by the proxy. Such invalid headers are now rejected by Go servers, and passed without normalization to Go client applications.

  The issue is CVE-2019-16276 and Go issue golang.org/issue/34540.

  Thanks to Andrew Stucki, Adam Scarr (99designs.com), and Jan Masarik (masarik.sh) for discovering and reporting this issue.

  Downloads are available at https://golang.org/dl for all supported platforms.

  Alla prossima,
  Filippo on behalf of the Go team
  ```

  From the patch: https://github.com/golang/go/commit/6e6f4aaf70c8b1cc81e65a26332aa9409de03ad8

  ```
  net/textproto: don't normalize headers with spaces before the colon

  RFC 7230 is clear about headers with a space before the colon, like

  X-Answer : 42

  being invalid, but we've been accepting and normalizing them for compatibility
  purposes since CL 5690059 in 2012.

  On the client side, this is harmless and indeed most browsers behave the same
  to this day. On the server side, this becomes a security issue when the
  behavior doesn't match that of a reverse proxy sitting in front of the server.

  For example, if a WAF accepts them without normalizing them, it might be
  possible to bypass its filters, because the Go server would interpret the
  header differently. Worse, if the reverse proxy coalesces requests onto a
  single HTTP/1.1 connection to a Go server, the understanding of the request
  boundaries can get out of sync between them, allowing an attacker to tack an
  arbitrary method and path onto a request by other clients, including
  authentication headers unknown to the attacker.

  This was recently presented at multiple security conferences:
  https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn

  net/http servers already reject header keys with invalid characters.
  Simply stop normalizing extra spaces in net/textproto, let it return them
  unchanged like it does for other invalid headers, and let net/http enforce
  RFC 7230, which is HTTP specific. This loses us normalization on the client
  side, but there's no right answer on the client side anyway, and hiding the
  issue sounds worse than letting the application decide.
  ```

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 35d3bae1e16de3d4b24ec3770c7b982006923440)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  35d3bae1e16de3d4b24ec3770c7b982006923440:AppVeyor: bump golang 1.12.10 (CVE-2019-16276)

  full diff: https://github.com/golang/go/compare/go1.12.9...go1.12.10

  ```
  Hi gophers,

  We have just released Go 1.13.1 and Go 1.12.10 to address a recently reported security issue. We recommend that all affected users update to one of these releases (if you're not sure which, choose Go 1.13.1).

  net/http (through net/textproto) used to accept and normalize invalid HTTP/1.1 headers with a space before the colon, in violation of RFC 7230. If a Go server is used behind an uncommon reverse proxy that accepts and forwards but doesn't normalize such invalid headers, the reverse proxy and the server can interpret the headers differently. This can lead to filter bypasses or request smuggling, the latter if requests from separate clients are multiplexed onto the same upstream connection by the proxy. Such invalid headers are now rejected by Go servers, and passed without normalization to Go client applications.

  The issue is CVE-2019-16276 and Go issue golang.org/issue/34540.

  Thanks to Andrew Stucki, Adam Scarr (99designs.com), and Jan Masarik (masarik.sh) for discovering and reporting this issue.

  Downloads are available at https://golang.org/dl for all supported platforms.

  Alla prossima,
  Filippo on behalf of the Go team
  ```

  From the patch: https://github.com/golang/go/commit/6e6f4aaf70c8b1cc81e65a26332aa9409de03ad8

  ```
  net/textproto: don't normalize headers with spaces before the colon

  RFC 7230 is clear about headers with a space before the colon, like

  X-Answer : 42

  being invalid, but we've been accepting and normalizing them for compatibility
  purposes since CL 5690059 in 2012.

  On the client side, this is harmless and indeed most browsers behave the same
  to this day. On the server side, this becomes a security issue when the
  behavior doesn't match that of a reverse proxy sitting in front of the server.

  For example, if a WAF accepts them without normalizing them, it might be
  possible to bypass its filters, because the Go server would interpret the
  header differently. Worse, if the reverse proxy coalesces requests onto a
  single HTTP/1.1 connection to a Go server, the understanding of the request
  boundaries can get out of sync between them, allowing an attacker to tack an
  arbitrary method and path onto a request by other clients, including
  authentication headers unknown to the attacker.

  This was recently presented at multiple security conferences:
  https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn

  net/http servers already reject header keys with invalid characters.
  Simply stop normalizing extra spaces in net/textproto, let it return them
  unchanged like it does for other invalid headers, and let net/http enforce
  RFC 7230, which is HTTP specific. This loses us normalization on the client
  side, but there's no right answer on the client side anyway, and hiding the
  issue sounds worse than letting the application decide.
  ```

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  35d3bae1e16de3d4b24ec3770c7b982006923440:AppVeyor: bump golang 1.12.10 (CVE-2019-16276)

  full diff: https://github.com/golang/go/compare/go1.12.9...go1.12.10

  ```
  Hi gophers,

  We have just released Go 1.13.1 and Go 1.12.10 to address a recently reported security issue. We recommend that all affected users update to one of these releases (if you're not sure which, choose Go 1.13.1).

  net/http (through net/textproto) used to accept and normalize invalid HTTP/1.1 headers with a space before the colon, in violation of RFC 7230. If a Go server is used behind an uncommon reverse proxy that accepts and forwards but doesn't normalize such invalid headers, the reverse proxy and the server can interpret the headers differently. This can lead to filter bypasses or request smuggling, the latter if requests from separate clients are multiplexed onto the same upstream connection by the proxy. Such invalid headers are now rejected by Go servers, and passed without normalization to Go client applications.

  The issue is CVE-2019-16276 and Go issue golang.org/issue/34540.

  Thanks to Andrew Stucki, Adam Scarr (99designs.com), and Jan Masarik (masarik.sh) for discovering and reporting this issue.

  Downloads are available at https://golang.org/dl for all supported platforms.

  Alla prossima,
  Filippo on behalf of the Go team
  ```

  From the patch: https://github.com/golang/go/commit/6e6f4aaf70c8b1cc81e65a26332aa9409de03ad8

  ```
  net/textproto: don't normalize headers with spaces before the colon

  RFC 7230 is clear about headers with a space before the colon, like

  X-Answer : 42

  being invalid, but we've been accepting and normalizing them for compatibility
  purposes since CL 5690059 in 2012.

  On the client side, this is harmless and indeed most browsers behave the same
  to this day. On the server side, this becomes a security issue when the
  behavior doesn't match that of a reverse proxy sitting in front of the server.

  For example, if a WAF accepts them without normalizing them, it might be
  possible to bypass its filters, because the Go server would interpret the
  header differently. Worse, if the reverse proxy coalesces requests onto a
  single HTTP/1.1 connection to a Go server, the understanding of the request
  boundaries can get out of sync between them, allowing an attacker to tack an
  arbitrary method and path onto a request by other clients, including
  authentication headers unknown to the attacker.

  This was recently presented at multiple security conferences:
  https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn

  net/http servers already reject header keys with invalid characters.
  Simply stop normalizing extra spaces in net/textproto, let it return them
  unchanged like it does for other invalid headers, and let net/http enforce
  RFC 7230, which is HTTP specific. This loses us normalization on the client
  side, but there's no right answer on the client side anyway, and hiding the
  issue sounds worse than letting the application decide.
  ```

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 61f763ffef3ca621c5b2a130b8c0b225cfec136f
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 35d3bae1e16de3d4b24ec3770c7b982006923440
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: e319caedc4f32d6eb91352c52e008f6c934fb2cc
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 23b0ca70feadeda6b9f1f7072e71687c660590ca
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 8d33d03519a7b87b5ef8a5d973228826cde7d759
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 277ab9ed6e1ef8ca003eb6db54271d26a99aa87a
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 6356e55be002df80b98ba59ec98dfd0ece7ec80c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/containerd/containerd/tree/23b0ca70feadeda6b9f1f7072e71687c660590ca
    reference_type: commit
    reference_id: 23b0ca70feadeda6b9f1f7072e71687c660590ca
  - url: https://github.com/containerd/containerd/tree/277ab9ed6e1ef8ca003eb6db54271d26a99aa87a
    reference_type: commit
    reference_id: 277ab9ed6e1ef8ca003eb6db54271d26a99aa87a
  - url: https://github.com/containerd/containerd/tree/35d3bae1e16de3d4b24ec3770c7b982006923440
    reference_type: commit
    reference_id: 35d3bae1e16de3d4b24ec3770c7b982006923440
  - url: https://github.com/containerd/containerd/tree/61f763ffef3ca621c5b2a130b8c0b225cfec136f
    reference_type: commit
    reference_id: 61f763ffef3ca621c5b2a130b8c0b225cfec136f
  - url: https://github.com/containerd/containerd/tree/6356e55be002df80b98ba59ec98dfd0ece7ec80c
    reference_type: commit
    reference_id: 6356e55be002df80b98ba59ec98dfd0ece7ec80c
  - url: https://github.com/containerd/containerd/tree/8d33d03519a7b87b5ef8a5d973228826cde7d759
    reference_type: commit
    reference_id: 8d33d03519a7b87b5ef8a5d973228826cde7d759
  - url: https://github.com/containerd/containerd/tree/e319caedc4f32d6eb91352c52e008f6c934fb2cc
    reference_type: commit
    reference_id: e319caedc4f32d6eb91352c52e008f6c934fb2cc
