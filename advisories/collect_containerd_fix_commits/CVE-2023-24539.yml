advisory_id: CVE-2023-24539
datasource_id: collect_containerd_fix_commits/CVE-2023-24539
datasource_url: https://github.com/containerd/containerd
aliases: []
summary: |
  f34a22de99b57e30cd33d3769e3765950475ba07:update go to go1.20.4, go1.19.9

  go1.20.4 (released 2023-05-02) includes three security fixes to the html/template
  package, as well as bug fixes to the compiler, the runtime, and the crypto/subtle,
  crypto/tls, net/http, and syscall packages. See the Go 1.20.4 milestone on our
  issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.4+label%3ACherryPickApproved

  release notes: https://go.dev/doc/devel/release#go1.20.4
  full diff: https://github.com/golang/go/compare/go1.20.3...go1.20.4

  from the announcement:

  > These minor releases include 3 security fixes following the security policy:
  >
  > - html/template: improper sanitization of CSS values
  >
  >   Angle brackets (`<>`) were not considered dangerous characters when inserted
  >   into CSS contexts. Templates containing multiple actions separated by a '/'
  >   character could result in unexpectedly closing the CSS context and allowing
  >   for injection of unexpected HMTL, if executed with untrusted input.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-24539 and Go issue https://go.dev/issue/59720.
  >
  > - html/template: improper handling of JavaScript whitespace
  >
  >   Not all valid JavaScript whitespace characters were considered to be
  >   whitespace. Templates containing whitespace characters outside of the character
  >   set "\t\n\f\r\u0020\u2028\u2029" in JavaScript contexts that also contain
  >   actions may not be properly sanitized during execution.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-24540 and Go issue https://go.dev/issue/59721.
  >
  > - html/template: improper handling of empty HTML attributes
  >
  >   Templates containing actions in unquoted HTML attributes (e.g. "attr={{.}}")
  >   executed with empty input could result in output that would have unexpected
  >   results when parsed due to HTML normalization rules. This may allow injection
  >   of arbitrary attributes into tags.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-29400 and Go issue https://go.dev/issue/59722.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit b947a6f5289864a4d4b212401638ada8e7fc2fc6)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  39566aadecc45abcfa242e41ad7bf07142f49c8c:[release/1.6] update go to go1.19.9

  go1.19.9 (released 2023-05-02) includes three security fixes to the html/template
  package, as well as bug fixes to the compiler, the runtime, and the crypto/tls
  and syscall packages. See the Go 1.19.9 milestone on our issue tracker for details.

  https://github.com/golang/go/issues?q=milestone%3AGo1.19.9+label%3ACherryPickApproved

  release notes: https://go.dev/doc/devel/release#go1.19.9
  full diff: https://github.com/golang/go/compare/go1.19.8...go1.19.9

  from the announcement:

  > These minor releases include 3 security fixes following the security policy:
  >
  >- html/template: improper sanitization of CSS values
  >
  >  Angle brackets (`<>`) were not considered dangerous characters when inserted
  >  into CSS contexts. Templates containing multiple actions separated by a '/'
  >  character could result in unexpectedly closing the CSS context and allowing
  >  for injection of unexpected HMTL, if executed with untrusted input.
  >
  >  Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >  This is CVE-2023-24539 and Go issue https://go.dev/issue/59720.
  >
  > - html/template: improper handling of JavaScript whitespace
  >
  >   Not all valid JavaScript whitespace characters were considered to be
  >   whitespace. Templates containing whitespace characters outside of the character
  >   set "\t\n\f\r\u0020\u2028\u2029" in JavaScript contexts that also contain
  >   actions may not be properly sanitized during execution.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-24540 and Go issue https://go.dev/issue/59721.
  >
  > - html/template: improper handling of empty HTML attributes
  >
  >   Templates containing actions in unquoted HTML attributes (e.g. "attr={{.}}")
  >   executed with empty input could result in output that would have unexpected
  >   results when parsed due to HTML normalization rules. This may allow injection
  >   of arbitrary attributes into tags.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-29400 and Go issue https://go.dev/issue/59722.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  021bba28b50e445c4a0a8e79b458db7116dc50e7:update go to go1.20.4, go1.19.9

  go1.20.4 (released 2023-05-02) includes three security fixes to the html/template
  package, as well as bug fixes to the compiler, the runtime, and the crypto/subtle,
  crypto/tls, net/http, and syscall packages. See the Go 1.20.4 milestone on our
  issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.4+label%3ACherryPickApproved

  release notes: https://go.dev/doc/devel/release#go1.20.4
  full diff: https://github.com/golang/go/compare/go1.20.3...go1.20.4

  from the announcement:

  > These minor releases include 3 security fixes following the security policy:
  >
  > - html/template: improper sanitization of CSS values
  >
  >   Angle brackets (`<>`) were not considered dangerous characters when inserted
  >   into CSS contexts. Templates containing multiple actions separated by a '/'
  >   character could result in unexpectedly closing the CSS context and allowing
  >   for injection of unexpected HMTL, if executed with untrusted input.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-24539 and Go issue https://go.dev/issue/59720.
  >
  > - html/template: improper handling of JavaScript whitespace
  >
  >   Not all valid JavaScript whitespace characters were considered to be
  >   whitespace. Templates containing whitespace characters outside of the character
  >   set "\t\n\f\r\u0020\u2028\u2029" in JavaScript contexts that also contain
  >   actions may not be properly sanitized during execution.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-24540 and Go issue https://go.dev/issue/59721.
  >
  > - html/template: improper handling of empty HTML attributes
  >
  >   Templates containing actions in unquoted HTML attributes (e.g. "attr={{.}}")
  >   executed with empty input could result in output that would have unexpected
  >   results when parsed due to HTML normalization rules. This may allow injection
  >   of arbitrary attributes into tags.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-29400 and Go issue https://go.dev/issue/59722.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit b947a6f5289864a4d4b212401638ada8e7fc2fc6)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  b947a6f5289864a4d4b212401638ada8e7fc2fc6:update go to go1.20.4, go1.19.9

  go1.20.4 (released 2023-05-02) includes three security fixes to the html/template
  package, as well as bug fixes to the compiler, the runtime, and the crypto/subtle,
  crypto/tls, net/http, and syscall packages. See the Go 1.20.4 milestone on our
  issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.4+label%3ACherryPickApproved

  release notes: https://go.dev/doc/devel/release#go1.20.4
  full diff: https://github.com/golang/go/compare/go1.20.3...go1.20.4

  from the announcement:

  > These minor releases include 3 security fixes following the security policy:
  >
  > - html/template: improper sanitization of CSS values
  >
  >   Angle brackets (`<>`) were not considered dangerous characters when inserted
  >   into CSS contexts. Templates containing multiple actions separated by a '/'
  >   character could result in unexpectedly closing the CSS context and allowing
  >   for injection of unexpected HMTL, if executed with untrusted input.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-24539 and Go issue https://go.dev/issue/59720.
  >
  > - html/template: improper handling of JavaScript whitespace
  >
  >   Not all valid JavaScript whitespace characters were considered to be
  >   whitespace. Templates containing whitespace characters outside of the character
  >   set "\t\n\f\r\u0020\u2028\u2029" in JavaScript contexts that also contain
  >   actions may not be properly sanitized during execution.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-24540 and Go issue https://go.dev/issue/59721.
  >
  > - html/template: improper handling of empty HTML attributes
  >
  >   Templates containing actions in unquoted HTML attributes (e.g. "attr={{.}}")
  >   executed with empty input could result in output that would have unexpected
  >   results when parsed due to HTML normalization rules. This may allow injection
  >   of arbitrary attributes into tags.
  >
  >   Thanks to Juho Nurminen of Mattermost for reporting this issue.
  >
  >   This is CVE-2023-29400 and Go issue https://go.dev/issue/59722.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: b947a6f5289864a4d4b212401638ada8e7fc2fc6
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 39566aadecc45abcfa242e41ad7bf07142f49c8c
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: 021bba28b50e445c4a0a8e79b458db7116dc50e7
    introduced_in_commits: []
  - purl: pkg:github/containerd/containerd
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/containerd/containerd
        commit: f34a22de99b57e30cd33d3769e3765950475ba07
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/containerd/containerd/tree/021bba28b50e445c4a0a8e79b458db7116dc50e7
    reference_type: commit
    reference_id: 021bba28b50e445c4a0a8e79b458db7116dc50e7
  - url: https://github.com/containerd/containerd/tree/39566aadecc45abcfa242e41ad7bf07142f49c8c
    reference_type: commit
    reference_id: 39566aadecc45abcfa242e41ad7bf07142f49c8c
  - url: https://github.com/containerd/containerd/tree/b947a6f5289864a4d4b212401638ada8e7fc2fc6
    reference_type: commit
    reference_id: b947a6f5289864a4d4b212401638ada8e7fc2fc6
  - url: https://github.com/containerd/containerd/tree/f34a22de99b57e30cd33d3769e3765950475ba07
    reference_type: commit
    reference_id: f34a22de99b57e30cd33d3769e3765950475ba07
