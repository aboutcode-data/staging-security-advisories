advisory_id: GHSA-qq97-vm5h-rrhg
datasource_id: github_osv_importer_v2/GHSA-qq97-vm5h-rrhg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-qq97-vm5h-rrhg/GHSA-qq97-vm5h-rrhg.json
aliases: []
summary: "OCI Manifest Type Confusion Issue\n### Impact\n\nSystems that rely on digest equivalence\
  \ for image attestations may be vulnerable to type confusion.\n\n### Patches\n\nUpgrade to\
  \ at least `v2.8.0-beta.1`  if you are running `v2.x` release. If you use the code from the\
  \ `main` branch, update at least to the commit after [b59a6f827947f9e0e67df0cfb571046de4733586](https://github.com/distribution/distribution/commit/b59a6f827947f9e0e67df0cfb571046de4733586).\n\
  \n### Workarounds\n\nThere is no way to work around this issue without patching.\n\n### References\n\
  \nDue to [an oversight in the OCI Image Specification](https://github.com/opencontainers/image-spec/pull/411)\
  \ that removed the embedded `mediaType` field from manifests, a maliciously crafted OCI Container\
  \ Image can cause registry clients to parse the same image in two different ways without modifying\
  \ the imageâ€™s digest by modifying the `Content-Type` header returned by a registry. This can\
  \ invalidate a common pattern of relying on container image digests for equivalence.\n\n###\
  \ For more information\n\nIf you have any questions or comments about this advisory:\n* Open\
  \ an issue in [distribution](https://github.com/distribution/distribution) \n* Open an issue\
  \ in [distribution-spec](https://github.com/opencontainers/distribution-spec) \n* Email us\
  \ at [cncf-distribution-security@lists.cncf.io](mailto:cncf-distribution-security@lists.cncf.io)"
impacted_packages: []
severities:
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-qq97-vm5h-rrhg/GHSA-qq97-vm5h-rrhg.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-843
references:
  - url: https://github.com/distribution/distribution
    reference_type:
    reference_id:
  - url: https://github.com/distribution/distribution/commit/b59a6f827947f9e0e67df0cfb571046de4733586
    reference_type:
    reference_id:
  - url: https://github.com/distribution/distribution/security/advisories/GHSA-qq97-vm5h-rrhg
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/image-spec/pull/411
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-0379
    reference_type:
    reference_id:
