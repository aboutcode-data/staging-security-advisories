advisory_id: GHSA-rfq3-w54c-f9q5
datasource_id: github_osv_importer_v2/GHSA-rfq3-w54c-f9q5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-rfq3-w54c-f9q5/GHSA-rfq3-w54c-f9q5.json
aliases:
  - CVE-2020-15233
summary: |
  OAuth2 Redirect URL validity does not respect query parameters and character casing for loopback addresses
  ### Impact

  [fosite#400](https://github.com/ory/fosite/pull/400) (released as v0.30.2) introduced a new feature for handling redirect URLs pointing to loopback interfaces ([rfc8252#section-7.3](https://tools.ietf.org/html/rfc8252#section-7.3)). As part of that change new behavior was introduced which failed to respect the redirect URL's (only for loopback interfaces!) query parameters

  1. Registering a client with allowed redirect URL `http://127.0.0.1/callback`
  2. Performing OAuth2 flow and requesting redirect URL `http://127.0.0.1/callback?bar=foo`
  3. Instead of an error, the browser is redirected to `http://127.0.0.1/callback?bar=foo` with a potentially successful OAuth2 response.

  as well as the host parameter (as long as the host is a loopback interface):

  1. Registering a client with allowed redirect URL `https://example.com/callback`
  2. Performing OAuth2 flow and requesting redirect URL `http://127.0.0.1/callback`
  3. Instead of an error, the browser is redirected to `http://127.0.0.1/callback` with a potentially successful OAuth2 response.

  These bugs are only applicable in scenarios where the attacker has control over the loopback interface (`localhost`, `127.0.0.1`, `[::1]`) where the browser performing the OAuth2 flow is running.
impacted_packages: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-rfq3-w54c-f9q5/GHSA-rfq3-w54c-f9q5.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-601
references:
  - url: https://github.com/ory/fosite
    reference_type:
    reference_id:
  - url: https://github.com/ory/fosite/commit/cdee51ebe721bfc8acca0fd0b86b030ca70867bf
    reference_type:
    reference_id:
  - url: https://github.com/ory/fosite/pull/400
    reference_type:
    reference_id:
  - url: https://github.com/ory/fosite/security/advisories/GHSA-rfq3-w54c-f9q5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15233
    reference_type:
    reference_id: CVE-2020-15233
