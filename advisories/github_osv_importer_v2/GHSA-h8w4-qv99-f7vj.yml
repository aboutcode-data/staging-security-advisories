advisory_id: GHSA-h8w4-qv99-f7vj
datasource_id: github_osv_importer_v2/GHSA-h8w4-qv99-f7vj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/10/GHSA-h8w4-qv99-f7vj/GHSA-h8w4-qv99-f7vj.json
aliases:
  - CVE-2018-15758
summary: |
  Authorization bypass in org.springframework.security.oauth:spring-security-oauth2
  Spring Security OAuth, versions 2.3 prior to 2.3.4, and 2.2 prior to 2.2.3, and 2.1 prior to 2.1.3, and 2.0 prior to 2.0.16, and older unsupported versions could be susceptible to a privilege escalation under certain conditions. A malicious user or attacker can craft a request to the approval endpoint that can modify the previously saved authorization request and lead to a privilege escalation on the subsequent approval. This scenario can happen if the application is configured to use a custom approval endpoint that declares AuthorizationRequest as a controller method argument. This vulnerability exposes applications that meet all of the following requirements: Act in the role of an Authorization Server (e.g. @EnableAuthorizationServer) and use a custom Approval Endpoint that declares AuthorizationRequest as a controller method argument. This vulnerability does not expose applications that: Act in the role of an Authorization Server and use the default Approval Endpoint, act in the role of a Resource Server only (e.g. @EnableResourceServer), act in the role of a Client only (e.g. @EnableOAuthClient).
impacted_packages:
  - purl: pkg:maven/org.springframework.security.oauth/spring-security-oauth2
    affected_versions: vers:maven/>=2.0.0|<2.0.16
    fixed_versions: vers:maven/2.0.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.springframework.security.oauth/spring-security-oauth2
    affected_versions: vers:maven/>=2.1.0|<2.1.3
    fixed_versions: vers:maven/2.1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.springframework.security.oauth/spring-security-oauth2
    affected_versions: vers:maven/>=2.2.0|<2.2.3.RELEASE
    fixed_versions: vers:maven/2.2.3.RELEASE
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.springframework.security.oauth/spring-security-oauth2
    affected_versions: vers:maven/>=2.3.0|<2.3.4.RELEASE
    fixed_versions: vers:maven/2.3.4.RELEASE
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/10/GHSA-h8w4-qv99-f7vj/GHSA-h8w4-qv99-f7vj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://access.redhat.com/errata/RHSA-2019:2413
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-h8w4-qv99-f7vj
    reference_type:
    reference_id:
  - url: https://github.com/spring-attic/spring-security-oauth/commit/4082ec7ae3d39198a47b5c803ccb20dacefb0b0
    reference_type:
    reference_id:
  - url: https://github.com/spring-attic/spring-security-oauth/commit/623776689fdcc8047f5a908c71f348e1f172a97
    reference_type:
    reference_id:
  - url: https://github.com/spring-attic/spring-security-oauth/commit/ddd65cd9417ae1e4a69e4193a622300db38e2ef
    reference_type:
    reference_id:
  - url: https://github.com/spring-attic/spring-security-oauth/commit/f92223afc71687bd3156298054903f50aa71fbf
    reference_type:
    reference_id:
  - url: https://pivotal.io/security/cve-2018-15758
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/105687
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-15758
    reference_type:
    reference_id: CVE-2018-15758
