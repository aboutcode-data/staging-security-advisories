advisory_id: GHSA-32vj-v39g-jh23
datasource_id: github_osv_importer_v2/GHSA-32vj-v39g-jh23
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-32vj-v39g-jh23/GHSA-32vj-v39g-jh23.json
aliases:
  - CVE-2022-31690
summary: |
  spring-security-oauth2-client vulnerable to Privilege Escalation
  Spring Security, versions 5.7 prior to 5.7.5, and 5.6 prior to 5.6.9, and older unsupported versions could be susceptible to a privilege escalation under certain conditions. A malicious user or attacker can modify a request initiated by the Client (via the browser) to the Authorization Server which can lead to a privilege escalation on the subsequent approval. This scenario can happen if the Authorization Server responds with an OAuth2 Access Token Response containing an empty scope list (per RFC 6749, Section 5.1) on the subsequent request to the token endpoint to obtain the access token.
impacted_packages:
  - purl: pkg:maven/org.springframework.security/spring-security-oauth2-client
    affected_versions: vers:maven/>=5.7.0|<5.7.5
    fixed_versions: vers:maven/5.7.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.springframework.security/spring-security-oauth2-client
    affected_versions: vers:maven/<5.6.9
    fixed_versions: vers:maven/5.6.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-32vj-v39g-jh23/GHSA-32vj-v39g-jh23.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/spring-projects/spring-security-samples/blob/4638e1e428ee2ddab234199eb3b67b9c94dfa08b/servlet/spring-boot/java/oauth2/webclient/src/main/java/example/SecurityConfiguration.java#L48
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20221215-0010
    reference_type:
    reference_id:
  - url: https://tanzu.vmware.com/security/cve-2022-31690
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31690
    reference_type:
    reference_id: CVE-2022-31690
