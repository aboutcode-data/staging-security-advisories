advisory_id: GHSA-w6v2-qchm-grj7
datasource_id: github_osv_importer_v2/GHSA-w6v2-qchm-grj7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-w6v2-qchm-grj7/GHSA-w6v2-qchm-grj7.json
aliases:
  - CVE-2020-25039
summary: |
  Insecure permissions on user namespace / fakeroot temporary rootfs in Singularity
  ### Impact

  Insecure permissions on temporary directories used in fakeroot or user namespace container execution.

  When a Singularity action command (run, shell, exec) is run with the fakeroot or user namespace option, Singularity will extract a container image to a temporary sandbox directory. Due to insecure permissions on the temporary directory it is possible for any user with access to the system to read the contents of the image. Additionally, if the image contains a world-writable file or directory, it is possible for a user to inject arbitrary content into the running container.

  ### Patches

  This issue is addressed in Singularity 3.6.3.

  All users are advised to upgrade to 3.6.3.

  ### Workarounds

  The issue is mitigated if `TMPDIR` is set to a location that is only accessible to the user, as any subdirectories directly under `TMPDIR` cannot then be accessed by others. However, this is difficult to enforce so it is not recommended to rely on this as a mitigation.

  ### For more information

  General questions about the impact of the advisory / changes made in the 3.6.0 release can be asked in the:

  * [Singularity Slack Channel](https://bit.ly/2m0g3lX)
  * [Singularity Mailing List](https://groups.google.com/a/lbl.gov/forum/??sdf%7Csort:date#!forum/singularity)

  Any sensitive security concerns should be directed to: security@sylabs.io

  See our Security Policy here: https://sylabs.io/security-policy
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-w6v2-qchm-grj7/GHSA-w6v2-qchm-grj7.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-668
  - CWE-732
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2020-09/msg00070.html
    reference_type:
    reference_id:
  - url: http://lists.opensuse.org/opensuse-security-announce/2020-09/msg00088.html
    reference_type:
    reference_id:
  - url: https://github.com/hpcng/singularity/security/advisories/GHSA-w6v2-qchm-grj7
    reference_type:
    reference_id:
  - url: https://medium.com/sylabs
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-25039
    reference_type:
    reference_id: CVE-2020-25039
