advisory_id: GHSA-9hq9-cr36-4wpj
datasource_id: github_osv_importer_v2/GHSA-9hq9-cr36-4wpj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-9hq9-cr36-4wpj/GHSA-9hq9-cr36-4wpj.json
aliases:
  - CVE-2025-47939
summary: "TYPO3 Allows Unrestricted File Upload in File Abstraction Layer\n### Problem\nBy design,\
  \ the file management module in TYPO3’s backend user interface has historically allowed the\
  \ upload of any file type, with the exception of those that are directly executable in a web\
  \ server context. This lack of restriction means it is possible to upload files that may be\
  \ considered potentially harmful, such as executable binaries (e.g., `.exe` files), or files\
  \ with inconsistent file extensions and MIME types (for example, a file incorrectly named\
  \ with a `.png` extension but actually carrying the MIME type `application/zip`).\n\nAlthough\
  \ such files are not directly executable through the web server, their presence can introduce\
  \ indirect risks. For example, third-party services such as antivirus scanners or malware\
  \ detection systems might flag or block access to the website for end users if suspicious\
  \ files are found. This could negatively affect the availability or reputation of the site.\n\
  \n### Solution\nUpdate to TYPO3 versions 9.5.51 ELTS, 10.4.50 ELTS, 11.5.44 ELTS, 12.4.31\
  \ LTS, 13.4.12 LTS that fix the problem described.\n\n> [!NOTE]\n> The mitigation strategies\
  \ outlined below apply broadly to all file uploads handled through TYPO3's File Abstraction\
  \ Layer (FAL), not just those performed via the backend interface. This means that any extension\
  \ or custom integration leveraging FAL will also be subject to the new validation rules and\
  \ configuration options. Developers are advised to review the implications for their code\
  \ and refer to the [documentation of that change](https://docs.typo3.org/c/typo3/cms-core/main/en-us/Changelog/12.4.x/Important-106240-EnforceFile-extensionsAndMime-typeConsistencyInFileAbstractionLayer.html)\
  \ for guidance.\n\n> [!IMPORTANT]\n>\n> **Strong security defaults - Manual actions required**\n\
  > \n> These versions introduce new configuration options to better control which files are\
  \ permitted for upload and to improve consistency checks.\n> \n> A new configuration option,\
  \ `$GLOBALS['TYPO3_CONF_VARS']['SYS']['miscfile_ext']`, has been added. This option allows\
  \ administrators to explicitly define which file extensions should be permitted that are not\
  \ already part of the built-in text or media file groups - examples include archive formats\
  \ such as `zip` or `xz`.\n> \n> In addition, two new feature flags have been introduced to\
  \ enhance security:\n> * `security.system.enforceAllowedFileExtensions`, enforces the defined\
  \ list of allowed file extensions. This flag is enabled by default in new TYPO3 installations,\
  \ but remains disabled in existing installations to prevent breaking changes.\n> * `security.system.enforceFileExtensionMimeTypeConsistency`,\
  \ ensures that the uploaded file’s extension matches its actual MIME type, providing further\
  \ validation of file integrity. This flag is active by default.\n> \n> It is recommended to\
  \ configure the allowed file extensions via `$GLOBALS['TYPO3_CONF_VARS']['SYS']['miscfile_ext']`\
  \ and to enable the feature flag `security.system.enforceAllowedFileExtensions` to enforce\
  \ the restriction.\n\n### Credits\nThanks to Hamed Kohi for reporting this issue, and to TYPO3\
  \ core & security team member Oliver Hader for fixing it."
impacted_packages:
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/<=9.5.50
    fixed_versions: vers:composer/9.5.51
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/<=10.4.49
    fixed_versions: vers:composer/10.4.50
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/<=11.5.43
    fixed_versions: vers:composer/11.5.44
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/<=12.4.30
    fixed_versions: vers:composer/12.4.31
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/<=13.4.11
    fixed_versions: vers:composer/13.4.12
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-9hq9-cr36-4wpj/GHSA-9hq9-cr36-4wpj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
  - CWE-351
references:
  - url: https://github.com/TYPO3-CMS/core
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3-CMS/core/commit/c265beed6e2c01817c534a226e80e593400f8255
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3/security/advisories/GHSA-9hq9-cr36-4wpj
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2025-014
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-47939
    reference_type:
    reference_id: CVE-2025-47939
