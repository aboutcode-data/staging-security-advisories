advisory_id: GHSA-5vvg-pvhp-hv2m
datasource_id: github_osv_importer_v2/GHSA-5vvg-pvhp-hv2m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-5vvg-pvhp-hv2m/GHSA-5vvg-pvhp-hv2m.json
aliases:
  - CVE-2024-49750
summary: |
  The Snowflake Connector for Python stores sensitive data in logs
  ### Issue
  Snowflake recently learned about and remediated a set of vulnerabilities in the Snowflake Connector for Python. Under specific conditions, certain users credentials (or portions of those credentials) were logged locally by the Connector to the users own systems. The credentials were not logged by Snowflake.

  These vulnerabilities affect versions up to and including 3.12.2. Snowflake fixed the issue in version 3.12.3.

  ### Vulnerability Details
  When the logging level was set by the user to DEBUG, the Connector could have logged Duo passcodes (when specified via the “passcode” parameter) and Azure SAS tokens. Additionally, the [SecretDetector](https://docs.snowflake.com/en/developer-guide/python-connector/python-connector-example#logging) logging formatter, if enabled, contained bugs which caused it to not fully redact JWT tokens and certain private key formats.

  ### Solution
  Snowflake released version 3.12.3 of the Snowflake Connector for Python, which fixes these issues. We recommend users upgrade to version 3.12.3 and review their logs for any potentially sensitive information that may have been captured.

  ### Additional Information
  If you discover a security vulnerability in one of our products or websites, please report the issue to HackerOne. For more information, please see our [Vulnerability Disclosure Policy](https://hackerone.com/snowflake?type=team).
impacted_packages:
  - purl: pkg:pypi/snowflake-connector-python
    affected_versions: vers:pypi/<3.12.3
    fixed_versions: vers:pypi/3.12.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-5vvg-pvhp-hv2m/GHSA-5vvg-pvhp-hv2m.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/snowflake-connector-python/PYSEC-2024-191.yaml
    reference_type:
    reference_id:
  - url: https://github.com/snowflakedb/snowflake-connector-python
    reference_type:
    reference_id:
  - url: https://github.com/snowflakedb/snowflake-connector-python/commit/dbc9284a3c0382c131b971b35e8d6ab93c46f37a
    reference_type:
    reference_id:
  - url: https://github.com/snowflakedb/snowflake-connector-python/security/advisories/GHSA-5vvg-pvhp-hv2m
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49750
    reference_type:
    reference_id: CVE-2024-49750
