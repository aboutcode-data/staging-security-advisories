advisory_id: GHSA-3c9c-2p65-qvwv
datasource_id: github_osv_importer_v2/GHSA-3c9c-2p65-qvwv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-3c9c-2p65-qvwv/GHSA-3c9c-2p65-qvwv.json
aliases:
  - CVE-2021-41097
summary: |
  Prototype pollution in aurelia-path
  ### Impact
  The vulnerability exposes Aurelia application that uses `aurelia-path` package to parse a string. The majority of this will be Aurelia applications that employ the `aurelia-router` package. An example is this could allow an attacker to change the prototype of base object class `Object` by tricking an application to parse the following URL: `https://aurelia.io/blog/?__proto__[asdf]=asdf`

  ### Patches
  The problem should be patched in version `1.1.7`. Any version earlier than this is vulnerable.

  ### Workarounds
  A partial work around is to free the Object prototype:
  ```ts
  Object.freeze(Object.prototype)
  ```
impacted_packages:
  - purl: pkg:npm/aurelia-path
    affected_versions: vers:npm/<1.1.7
    fixed_versions: vers:npm/1.1.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-3c9c-2p65-qvwv/GHSA-3c9c-2p65-qvwv.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1321
  - CWE-915
references:
  - url: https://github.com/aurelia/path
    reference_type:
    reference_id:
  - url: https://github.com/aurelia/path/commit/7c4e235433a4a2df9acc313fbe891758084fdec1
    reference_type:
    reference_id:
  - url: https://github.com/aurelia/path/issues/44
    reference_type:
    reference_id:
  - url: https://github.com/aurelia/path/releases/tag/1.1.7
    reference_type:
    reference_id:
  - url: https://github.com/aurelia/path/security/advisories/GHSA-3c9c-2p65-qvwv
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/aurelia-path
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41097
    reference_type:
    reference_id: CVE-2021-41097
