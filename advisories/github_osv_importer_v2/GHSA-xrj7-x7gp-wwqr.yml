advisory_id: GHSA-xrj7-x7gp-wwqr
datasource_id: github_osv_importer_v2/GHSA-xrj7-x7gp-wwqr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-xrj7-x7gp-wwqr/GHSA-xrj7-x7gp-wwqr.json
aliases:
  - CVE-2023-50298
summary: |
  Apache Solr's Streaming Expressions allow users to extract data from other Solr Clouds
  Exposure of Sensitive Information to an Unauthorized Actor vulnerability in Apache Solr. This issue affects Apache Solr from 6.0.0 through 8.11.2, from 9.0.0 before 9.4.1.

  Solr Streaming Expressions allows users to extract data from other Solr Clouds, using a "zkHost" parameter.

  When original SolrCloud is setup to use ZooKeeper credentials and ACLs, they will be sent to whatever "zkHost" the user provides.

  An attacker could setup a server to mock ZooKeeper, that accepts ZooKeeper requests with credentials and ACLs and extracts the sensitive information, then send a streaming expression using the mock server's address in "zkHost".

  Streaming Expressions are exposed via the "/streaming" handler, with "read" permissions.

  Users are recommended to upgrade to version 8.11.3 or 9.4.1, which fix the issue.

  From these versions on, only zkHost values that have the same server address (regardless of chroot), will use the given ZooKeeper credentials and ACLs when connecting.
impacted_packages:
  - purl: pkg:maven/org.apache.solr/solr-solrj-streaming
    affected_versions: vers:maven/>=9.0.0|<9.4.1
    fixed_versions: vers:maven/9.4.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.solr/solr-solrj-streaming
    affected_versions: vers:maven/>=6.0.0|<8.11.3
    fixed_versions: vers:maven/8.11.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.solr/solr-solrj
    affected_versions: vers:maven/>=9.0.0|<9.4.1
    fixed_versions: vers:maven/9.4.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.solr/solr-solrj
    affected_versions: vers:maven/>=6.0.0|<8.11.3
    fixed_versions: vers:maven/8.11.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-xrj7-x7gp-wwqr/GHSA-xrj7-x7gp-wwqr.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-xrj7-x7gp-wwqr/GHSA-xrj7-x7gp-wwqr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-922
references:
  - url: https://github.com/apache/lucene-solr/commit/61c956c426b2cfb85ccef55d1afca4335eacd269
    reference_type:
    reference_id:
  - url: https://github.com/apache/solr
    reference_type:
    reference_id:
  - url: https://github.com/apache/solr/commit/e2bf1f434aad873fbb24c21d46ac00e888806d98
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/SOLR-17098
    reference_type:
    reference_id:
  - url: https://solr.apache.org/security.html#cve-2023-50298-apache-solr-can-expose-zookeeper-credentials-via-streaming-expressions
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/02/09/2
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/02/09/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-50298
    reference_type:
    reference_id: CVE-2023-50298
