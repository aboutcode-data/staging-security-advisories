advisory_id: GHSA-4qhp-652w-c22x
datasource_id: github_osv_importer_v2/GHSA-4qhp-652w-c22x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-4qhp-652w-c22x/GHSA-4qhp-652w-c22x.json
aliases:
  - CVE-2024-22415
summary: |
  Unsecured endpoints in the jupyter-lsp server extension
  ### Impact
  Installations of jupyter-lsp running in environments without configured file system access control (on the operating system level), and with jupyter-server instances exposed to non-trusted network are vulnerable to unauthorised access and modification of file system beyond the jupyter root directory.

  ### Patches
  Version 2.2.2 has been patched.

  ### Workarounds
  Users of jupyterlab who do not use jupyterlab-lsp can uninstall jupyter-lsp.

  ### Credits
  We would like to credit Bary Levy, researcher of pillar.security research team, for the discovery and responsible disclosure of this vulnerability.

  Edit: based on advice from pillar.security the Confidentiality/Integrity/Availability were increased to High to reflect potential for critical impact on publicly hosted jupyter-server instances lacking isolation of user privileges on operating system level (for best practices please consult https://jupyterhub.readthedocs.io/en/stable/explanation/websecurity.html#protect-users-from-each-other) and CWE-94 was added due to a potential vulnerability chaining in specific environments.
impacted_packages:
  - purl: pkg:pypi/jupyter-lsp
    affected_versions: vers:pypi/<=2.2.1
    fixed_versions: vers:pypi/2.2.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-4qhp-652w-c22x/GHSA-4qhp-652w-c22x.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-23
  - CWE-22
references:
  - url: https://github.com/jupyter-lsp/jupyterlab-lsp
    reference_type:
    reference_id:
  - url: https://github.com/jupyter-lsp/jupyterlab-lsp/commit/4ad12f204ad0b85580fc32137c647baaff044e95
    reference_type:
    reference_id:
  - url: https://github.com/jupyter-lsp/jupyterlab-lsp/releases/tag/v5.0.2
    reference_type:
    reference_id:
  - url: https://github.com/jupyter-lsp/jupyterlab-lsp/security/advisories/GHSA-4qhp-652w-c22x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22415
    reference_type:
    reference_id: CVE-2024-22415
