advisory_id: GHSA-7rg2-cxvp-9p7p
datasource_id: github_osv_importer_v2/GHSA-7rg2-cxvp-9p7p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-7rg2-cxvp-9p7p/GHSA-7rg2-cxvp-9p7p.json
aliases:
  - CVE-2022-46146
summary: |
  Prometheus Exporter-Toolkit is vulnerable to authentication bypass
  ### Impact

  Prometheus and its exporters can be secured by a web.yml file that specifies usernames and hashed passwords for basic authentication.

  Passwords are hashed with bcrypt, which means that even if you have access to the hash, it is very hard to find the original password back.

  However, a flaw in the way this mechanism was implemented in the exporter toolkit makes it possible with people who know the hashed password to authenticate against Prometheus.

  A request can be forged by an attacker to poison the internal cache used to cache the computation of hashes and make subsequent requests successful. This cache is used in both happy and unhappy scenarios in order to limit side channel attacks that could tell an attacker if a user is present in the file or not.

  ### Patches

  The exporter-toolkit v0.7.3 and v0.8.2 have been released to address this issue.

  ### Workarounds

  There is no workaround but attacker must have access to the hashed password, stored in disk, to bypass the authentication.

  ### Credit

  We want to thank Lei Wan reporting this security issue.
impacted_packages: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-7rg2-cxvp-9p7p/GHSA-7rg2-cxvp-9p7p.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/prometheus/exporter-toolkit
    reference_type:
    reference_id:
  - url: https://github.com/prometheus/exporter-toolkit/commit/25288779bc59d00c41b4a1706c6b87f0561ef2d7
    reference_type:
    reference_id:
  - url: https://github.com/prometheus/exporter-toolkit/commit/5b1eab34484ddd353986bce736cd119d863e4ff5
    reference_type:
    reference_id:
  - url: https://github.com/prometheus/exporter-toolkit/security/advisories/GHSA-7rg2-cxvp-9p7p
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JRSHISR64L6QGSMDFZDNPHHIXSCAKK26
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UH24VXIB25OGHF4VGY4PLZMTGTI3BHCA
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ULVDTAI76VATRAHTKCE2SUJ4NC3PQZ6Y
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/JRSHISR64L6QGSMDFZDNPHHIXSCAKK26
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UH24VXIB25OGHF4VGY4PLZMTGTI3BHCA
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ULVDTAI76VATRAHTKCE2SUJ4NC3PQZ6Y
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202401-15
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2022/11/29/1
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2022/11/29/2
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2022/11/29/4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-46146
    reference_type:
    reference_id: CVE-2022-46146
