advisory_id: GHSA-27wq-qx3q-fxm9
datasource_id: github_osv_importer_v2/GHSA-27wq-qx3q-fxm9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-27wq-qx3q-fxm9/GHSA-27wq-qx3q-fxm9.json
aliases:
  - CVE-2021-39131
summary: |
  Improper Handling of Unexpected Data Type in ced
  ### Impact

  In ced v0.1.0, passing data types other than `Buffer` causes the Node.js process to crash.

  ### Patches

  The problem has been patched in [ced v1.0.0](https://github.com/sonicdoe/ced/releases/tag/v1.0.0). You can upgrade from v0.1.0 without any breaking changes.

  ### Workarounds

  Before passing an argument to ced, verify it’s a `Buffer` using [`Buffer.isBuffer(obj)`](https://nodejs.org/api/buffer.html#buffer_static_method_buffer_isbuffer_obj).

  ### CVSS score

  [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/RL:O/RC:C](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/RL:O/RC:C)

  Base Score: 7.5 (High)
  Temporal Score: 7.2 (High)

  Since ced is a library, the scoring is based on the “[reasonable worst-case implementation scenario](https://www.first.org/cvss/v3.1/user-guide#3-7-Scoring-Vulnerabilities-in-Software-Libraries-and-Similar)”, namely, accepting data from untrusted sources over a network and passing it directly to ced. Depending on your specific implementation, the vulnerability’s severity in your program may be different.

  ### Proof of concept

  ```js
  const express = require("express");
  const bodyParser = require("body-parser");
  const ced = require("ced");

  const app = express();

  app.use(bodyParser.raw());

  app.post("/", (req, res) => {
    const encoding = ced(req.body);

    res.end(encoding);
  });

  app.listen(3000);
  ```

  `curl --request POST --header "Content-Type: text/plain" --data foo http://localhost:3000` crashes the server.

  ### References

  - https://github.com/sonicdoe/ced/commit/a4d9f10b6bf1cd468d1a5b9a283cdf437f8bb7b3
impacted_packages:
  - purl: pkg:npm/ced
    affected_versions: vers:npm/<1.0.0
    fixed_versions: vers:npm/1.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-27wq-qx3q-fxm9/GHSA-27wq-qx3q-fxm9.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-241
references:
  - url: https://github.com/sonicdoe/ced
    reference_type:
    reference_id:
  - url: https://github.com/sonicdoe/ced/commit/a4d9f10b6bf1cd468d1a5b9a283cdf437f8bb7b3
    reference_type:
    reference_id:
  - url: https://github.com/sonicdoe/ced/releases/tag/v1.0.0
    reference_type:
    reference_id:
  - url: https://github.com/sonicdoe/ced/security/advisories/GHSA-27wq-qx3q-fxm9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39131
    reference_type:
    reference_id: CVE-2021-39131
