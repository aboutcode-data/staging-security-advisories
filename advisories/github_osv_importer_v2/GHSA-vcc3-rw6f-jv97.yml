advisory_id: GHSA-vcc3-rw6f-jv97
datasource_id: github_osv_importer_v2/GHSA-vcc3-rw6f-jv97
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-vcc3-rw6f-jv97/GHSA-vcc3-rw6f-jv97.json
aliases: []
summary: |
  Duplicate Advisory: Use-after-free in libxml2 via Nokogiri::XML::Reader
  # Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-xc9x-jj77-9p9j. This link is maintained to preserve external references.

  # Original Description

  ### Summary

  Nokogiri upgrades its dependency libxml2 as follows:
  - v1.15.6 upgrades libxml2 to 2.11.7 from 2.11.6
  - v1.16.2 upgrades libxml2 to 2.12.5 from 2.12.4

  libxml2 v2.11.7 and v2.12.5 address the following vulnerability:

  CVE-2024-25062 / https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-25062
  - described at https://gitlab.gnome.org/GNOME/libxml2/-/issues/604
  - patched by https://gitlab.gnome.org/GNOME/libxml2/-/commit/92721970

  Please note that this advisory only applies to the CRuby implementation of Nokogiri, and only if
  the packaged libraries are being used. If you've overridden defaults at installation time to use
  system libraries instead of packaged libraries, you should instead pay attention to your distro's
  libxml2 release announcements.

  JRuby users are not affected.

  ### Severity

  The Nokogiri maintainers have evaluated this as **Moderate**.

  ### Impact

  From the CVE description, this issue applies to the `xmlTextReader` module (which underlies
  `Nokogiri::XML::Reader`):

  > When using the XML Reader interface with DTD validation and XInclude expansion enabled,
  > processing crafted XML documents can lead to an xmlValidatePopElement use-after-free.

  ### Mitigation

  Upgrade to Nokogiri `~> 1.15.6` or `>= 1.16.2`.

  Users who are unable to upgrade Nokogiri may also choose a more complicated mitigation: compile
  and link Nokogiri against patched external libxml2 libraries which will also address these same
  issues.
impacted_packages:
  - purl: pkg:gem/nokogiri
    affected_versions: vers:gem/<1.15.6
    fixed_versions: vers:gem/1.15.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/nokogiri
    affected_versions: vers:gem/>=1.16.0|<1.16.2
    fixed_versions: vers:gem/1.16.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-416
references:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/GHSA-xc9x-jj77-9p9j.yml
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-xc9x-jj77-9p9j
    reference_type:
    reference_id:
