advisory_id: GHSA-6w63-h3fj-q4vw
datasource_id: github_osv_importer_v2/GHSA-6w63-h3fj-q4vw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-6w63-h3fj-q4vw/GHSA-6w63-h3fj-q4vw.json
aliases:
  - CVE-2023-34104
summary: |
  fast-xml-parser vulnerable to Regex Injection via Doctype Entities
  ### Impact
  "fast-xml-parser" allows special characters in entity names, which are not escaped or sanitized. Since the entity name is used for creating a regex for searching and replacing entities in the XML body, an attacker can abuse it for DoS attacks. By crafting an entity name that results in an intentionally bad performing regex and utilizing it in the entity replacement step of the parser, this can cause the parser to stall for an indefinite amount of time.

  ### Patches
  The problem has been resolved in v4.2.4

  ### Workarounds
  Avoid using DOCTYPE parsing by `processEntities: false` option.
impacted_packages:
  - purl: pkg:npm/fast-xml-parser
    affected_versions: vers:npm/>=4.1.3|<4.2.4
    fixed_versions: vers:npm/4.2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-6w63-h3fj-q4vw/GHSA-6w63-h3fj-q4vw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
references:
  - url: https://github.com/NaturalIntelligence/fast-xml-parser
    reference_type:
    reference_id:
  - url: https://github.com/NaturalIntelligence/fast-xml-parser/commit/39b0e050bb909e8499478657f84a3076e39ce76c
    reference_type:
    reference_id:
  - url: https://github.com/NaturalIntelligence/fast-xml-parser/commit/a4bdced80369892ee413bf08e28b78795a2b0d5b
    reference_type:
    reference_id:
  - url: https://github.com/NaturalIntelligence/fast-xml-parser/security/advisories/GHSA-6w63-h3fj-q4vw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34104
    reference_type:
    reference_id: CVE-2023-34104
