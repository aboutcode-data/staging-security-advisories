advisory_id: GHSA-w2v8-php4-p8hc
datasource_id: github_osv_importer_v2/GHSA-w2v8-php4-p8hc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-w2v8-php4-p8hc/GHSA-w2v8-php4-p8hc.json
aliases:
  - CVE-2024-32882
summary: |
  Wagtail has permission check bypass when editing a model with per-field restrictions through `wagtail.contrib.settings` or `ModelViewSet`
  ### Impact
  If a model has been made available for editing through the [`wagtail.contrib.settings`](https://docs.wagtail.org/en/stable/reference/contrib/settings.html) module or [`ModelViewSet`](https://docs.wagtail.org/en/stable/extending/generic_views.html#modelviewset), and the [`permission` argument on `FieldPanel`](https://docs.wagtail.org/en/stable/reference/pages/panels.html#wagtail.admin.panels.FieldPanel.permission) has been used to further restrict access to one or more fields of the model, a user with edit permission over the model but not the specific field can craft an HTTP POST request that bypasses the permission check on the individual field, allowing them to update its value.

  The vulnerability is not exploitable by an ordinary site visitor without access to the Wagtail admin, or by a user who has not been granted edit access to the model in question. The editing interfaces for pages and snippets are also unaffected.

  ### Patches
  Patched versions have been released as Wagtail 6.0.3 and 6.1. Wagtail releases prior to 6.0 are unaffected.

  ### Workarounds
  Site owners who are unable to upgrade to a patched version can avoid the vulnerability in `ModelViewSet` by registering the model as a snippet instead. No workaround is available for `wagtail.contrib.settings`.

  ### Acknowledgements
  Many thanks to Ben Morse and Joshua Munn for reporting this issue.

  ### For more information
  If you have any questions or comments about this advisory:

  * Visit Wagtail's [support channels](https://docs.wagtail.io/en/stable/support.html)
  * Email us at [security@wagtail.org](mailto:security@wagtail.org) (view our [security policy](https://github.com/wagtail/wagtail/security/policy) for more information).
impacted_packages:
  - purl: pkg:pypi/wagtail
    affected_versions: vers:pypi/>=6.0.0|<6.0.3
    fixed_versions: vers:pypi/6.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-w2v8-php4-p8hc/GHSA-w2v8-php4-p8hc.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-280
references:
  - url: https://docs.wagtail.org/en/stable/extending/generic_views.html#modelviewset
    reference_type:
    reference_id:
  - url: https://docs.wagtail.org/en/stable/reference/contrib/settings.html
    reference_type:
    reference_id:
  - url: https://docs.wagtail.org/en/stable/reference/pages/panels.html#wagtail.admin.panels.FieldPanel.permission
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/ab2a5d82b4ee3c909d2456704388ccf90e367c9b
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/fa0d4829f9c81eefb37cc058e2fa1b6a918741da
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/releases/tag/v6.0.3
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/security/advisories/GHSA-w2v8-php4-p8hc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32882
    reference_type:
    reference_id: CVE-2024-32882
