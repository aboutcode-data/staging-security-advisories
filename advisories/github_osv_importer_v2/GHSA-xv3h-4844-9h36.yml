advisory_id: GHSA-xv3h-4844-9h36
datasource_id: github_osv_importer_v2/GHSA-xv3h-4844-9h36
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-xv3h-4844-9h36/GHSA-xv3h-4844-9h36.json
aliases:
  - CVE-2023-29530
summary: |
  HTTP Multiline Header Termination
  ### Impact

  Affected versions of Laminas Diactoros accepted a single line feed (LF / `\n` ) character at the end of a header name. When serializing such a header name containing a line-feed into the on-the-wire representation of a HTTP/1.x message, the resulting message would be syntactically invalid, due to the header line being terminated too early. An attacker that is able to control the header names that are passed to Laminas Diactoros would be able to intentionally craft invalid messages, possibly causing application errors or invalid HTTP requests being sent out with an PSR-18 HTTP client. The latter might present a denial of service vector if a remote serviceâ€™s web application firewall bans the application due to the receipt of malformed requests.

  ### Patches

  The problem has been patched in the following versions:

  - 2.18.1
  - 2.19.1
  - 2.20.1
  - 2.21.1
  - 2.22.1
  - 2.23.1
  - 2.24.2
  - 2.25.2

  ### Workarounds

  Validate HTTP header keys and/or values, and if using user-supplied values, filter them to strip off leading or trailing newline characters before calling `withHeader()`.

  ### References

  - CVE-2023-29197
  - GHSA-wxmh-65f7-jcvw
impacted_packages:
  - purl: pkg:composer/laminas/laminas-diactoros
    affected_versions: vers:composer/<2.18.1
    fixed_versions: vers:composer/2.18.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/laminas/laminas-diactoros
    affected_versions: vers:composer/2.19.0
    fixed_versions: vers:composer/2.19.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/laminas/laminas-diactoros
    affected_versions: vers:composer/2.20.0
    fixed_versions: vers:composer/2.20.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/laminas/laminas-diactoros
    affected_versions: vers:composer/2.21.0
    fixed_versions: vers:composer/2.21.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/laminas/laminas-diactoros
    affected_versions: vers:composer/2.22.0
    fixed_versions: vers:composer/2.22.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/laminas/laminas-diactoros
    affected_versions: vers:composer/2.23.0
    fixed_versions: vers:composer/2.23.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/laminas/laminas-diactoros
    affected_versions: vers:composer/>=2.24.0|<2.24.2
    fixed_versions: vers:composer/2.24.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/laminas/laminas-diactoros
    affected_versions: vers:composer/>=2.25.0|<2.25.2
    fixed_versions: vers:composer/2.25.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-xv3h-4844-9h36/GHSA-xv3h-4844-9h36.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/advisories/GHSA-wxmh-65f7-jcvw
    reference_type:
    reference_id:
  - url: https://github.com/laminas/laminas-diactoros
    reference_type:
    reference_id:
  - url: https://github.com/laminas/laminas-diactoros/commit/7e721a60a09c5119c98694c2d23fc031094e1f1c
    reference_type:
    reference_id:
  - url: https://github.com/laminas/laminas-diactoros/security/advisories/GHSA-xv3h-4844-9h36
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BPW54QK7ISDALPLP2CKODU4ZIVRYS336
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29530
    reference_type:
    reference_id: CVE-2023-29530
