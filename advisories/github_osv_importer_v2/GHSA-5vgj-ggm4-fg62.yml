advisory_id: GHSA-5vgj-ggm4-fg62
datasource_id: github_osv_importer_v2/GHSA-5vgj-ggm4-fg62
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-5vgj-ggm4-fg62/GHSA-5vgj-ggm4-fg62.json
aliases:
  - CVE-2024-38526
summary: |
  pdoc embeds link to malicious CDN if math mode is enabled
  ### Impact

  Documentation generated with `pdoc --math` linked to JavaScript files from polyfill.io.
  The polyfill.io CDN has been sold and now serves malicious code.

  Users who produce documentation with math mode should update immediately. All other users are unaffected.

  ### Patches

  This issue has been fixed in pdoc 14.5.1.

  ### References

  https://github.com/mitmproxy/pdoc/pull/703
  https://sansec.io/research/polyfill-supply-chain-attack

  ### Timeline

  - **[2024-06-25]** https://sansec.io/research/polyfill-supply-chain-attack is published.
  - **[2024-06-25 20:54 UTC]** Issue reported to the pdoc project by @adhintz.
  - **[2024-06-25 21:33 UTC]** Patched version released.
  - **[2024-06-25 21:37 UTC]** Security advisory published.
  - **[2024-06-25 23:49 UTC]** CVE-2024-38526 assigned by GitHub.
impacted_packages:
  - purl: pkg:pypi/pdoc
    affected_versions: vers:pypi/<14.5.1
    fixed_versions: vers:pypi/14.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-5vgj-ggm4-fg62/GHSA-5vgj-ggm4-fg62.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/mitmproxy/pdoc
    reference_type:
    reference_id:
  - url: https://github.com/mitmproxy/pdoc/commit/726b8f2e365fe8afeb3604a7c73d19b460395d58
    reference_type:
    reference_id:
  - url: https://github.com/mitmproxy/pdoc/pull/703
    reference_type:
    reference_id:
  - url: https://github.com/mitmproxy/pdoc/security/advisories/GHSA-5vgj-ggm4-fg62
    reference_type:
    reference_id:
  - url: https://sansec.io/research/polyfill-supply-chain-attack
    reference_type:
    reference_id:
  - url: https://www.vicarius.io/vsociety/posts/polyfillio-in-pdoc-cve-2024-38526
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-38526
    reference_type:
    reference_id: CVE-2024-38526
