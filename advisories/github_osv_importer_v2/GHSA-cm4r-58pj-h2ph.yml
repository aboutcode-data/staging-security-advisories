advisory_id: GHSA-cm4r-58pj-h2ph
datasource_id: github_osv_importer_v2/GHSA-cm4r-58pj-h2ph
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-cm4r-58pj-h2ph/GHSA-cm4r-58pj-h2ph.json
aliases:
  - CVE-2015-2267
summary: |
  Moodle allows attackers to extract archives to arbitrary directories
  mdeploy.php in Moodle through 2.5.9, 2.6.x before 2.6.9, 2.7.x before 2.7.6, and 2.8.x before 2.8.4 allows remote authenticated users to bypass intended access restrictions and extract archives to arbitrary directories via a crafted dataroot value.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<2.6.9
    fixed_versions: vers:composer/2.6.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=2.7.0|<2.7.6
    fixed_versions: vers:composer/2.7.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=2.8.0|<2.8.4
    fixed_versions: vers:composer/2.8.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
references:
  - url: http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-49087
    reference_type:
    reference_id:
  - url: http://openwall.com/lists/oss-security/2015/03/16/1
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/12a8fcb5e45c58ee8267ad0472852c2b80a19878
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/240e7be7341afa31096fdbf3f242a7966f6237ab
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/4475f1e478370fb97933127ec60e40f39e285da1
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/76da7e9bc88669eab62f83f04639ba356a0b0c5a
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/83866c3c2a5b1391317172eea0b4f017c6d142d2
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/84f9f60b67e1e20058fbe2afa473607d075aff63
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/8d9bdd28e049ca6b6b2a4ab8f142097c2f907df6
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/a47aabc7833d0c88a83791d99a1204742c33f59b
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/c353a6202658f320096a41e94494063393153b7f
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/de169b7944e36d374d55e3f396d90ab2b4303afb
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=307381
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2015-2267
    reference_type:
    reference_id: CVE-2015-2267
