advisory_id: GHSA-mh3m-8c74-74xh
datasource_id: github_osv_importer_v2/GHSA-mh3m-8c74-74xh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-mh3m-8c74-74xh/GHSA-mh3m-8c74-74xh.json
aliases:
  - CVE-2022-21708
summary: "Denial of Service in graphql-go\n### Impact\nThis is a DoS vulnerability that is possible\
  \ due to a bug in the library that would allow an attacker with specifically designed queries\
  \ to cause stack overflow panics. Any user with access to the GraphQL handler can send these\
  \ queries and cause stack overflows. This in turn could potentially compromise the ability\
  \ of the server to serve data to its users. To make things worse the only mitigation in affected\
  \ versions creates opportunities for other attacks. This issue is only available if you are\
  \ using `graphql.MaxDepth` option in your schema (which is highly recommended in most cases).\n\
  \n### Patches\nThe issue has been patched in version `v1.3.0`. We have been trying to maintain\
  \ backwards compatibility and avoid breaking changes so upgrading should not be problematic.\
  \ \n\n### Workarounds\nThe best workaround is to patch to a version greater than or equal\
  \ to `v1.3.0`. \nOtherwise, the only workaround in versions prior to `v1.3.0` is to disable\
  \ the `graphql.MaxDepth` option from your schema. Unfortunately, this could potentially create\
  \ opportunities for other attacks.\n\n### References\nThere are no references or links. This\
  \ issue was reported privately and was fixed before creating this Security Advisory.\n\n###\
  \ For more information\nIf you have any questions or comments feel free to reach out to @pavelnikolov\
  \ or @tony on the Gopher Slack."
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-mh3m-8c74-74xh/GHSA-mh3m-8c74-74xh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/graph-gophers/graphql-go
    reference_type:
    reference_id:
  - url: https://github.com/graph-gophers/graphql-go/commit/eae31ca73eb3473c544710955d1dbebc22605bfe
    reference_type:
    reference_id:
  - url: https://github.com/graph-gophers/graphql-go/security/advisories/GHSA-mh3m-8c74-74xh
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-0300
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21708
    reference_type:
    reference_id: CVE-2022-21708
