advisory_id: GHSA-6rw7-vpxm-498p
datasource_id: github_osv_importer_v2/GHSA-6rw7-vpxm-498p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-6rw7-vpxm-498p/GHSA-6rw7-vpxm-498p.json
aliases:
  - CVE-2025-15284
summary: |
  qs's arrayLimit bypass in its bracket notation allows DoS via memory exhaustion
  ### Summary

  The `arrayLimit` option in qs did not enforce limits for bracket notation (`a[]=1&a[]=2`), only for indexed notation (`a[0]=1`). This is a consistency bug; `arrayLimit` should apply uniformly across all array notations.

  **Note:** The default `parameterLimit` of 1000 effectively mitigates the DoS scenario originally described. With default options, bracket notation cannot produce arrays larger than `parameterLimit` regardless of `arrayLimit`, because each `a[]=value` consumes one parameter slot. The severity has been reduced accordingly.

  ### Details

  The `arrayLimit` option only checked limits for indexed notation (`a[0]=1&a[1]=2`) but did not enforce it for bracket notation (`a[]=1&a[]=2`).

  **Vulnerable code** (`lib/parse.js:159-162`):
  ```javascript
  if (root === '[]' && options.parseArrays) {
      obj = utils.combine([], leaf);  // No arrayLimit check
  }
  ```

  **Working code** (`lib/parse.js:175`):
  ```javascript
  else if (index <= options.arrayLimit) {  // Limit checked here
      obj = [];
      obj[index] = leaf;
  }
  ```

  The bracket notation handler at line 159 uses `utils.combine([], leaf)` without validating against `options.arrayLimit`, while indexed notation at line 175 checks `index <= options.arrayLimit` before creating arrays.

  ### PoC

  ```javascript
  const qs = require('qs');
  const result = qs.parse('a[]=1&a[]=2&a[]=3&a[]=4&a[]=5&a[]=6', { arrayLimit: 5 });
  console.log(result.a.length);  // Output: 6 (should be max 5)
  ```

  **Note on parameterLimit interaction:** The original advisory's "DoS demonstration" claimed a length of 10,000, but `parameterLimit` (default: 1000) caps parsing to 1,000 parameters. With default options, the actual output is 1,000, not 10,000.

  ### Impact

  Consistency bug in `arrayLimit` enforcement. With default `parameterLimit`, the practical DoS risk is negligible since `parameterLimit` already caps the total number of parsed parameters (and thus array elements from bracket notation). The risk increases only when `parameterLimit` is explicitly set to a very high value.
impacted_packages:
  - purl: pkg:npm/qs
    affected_versions: vers:npm/<6.14.1
    fixed_versions: vers:npm/6.14.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-6rw7-vpxm-498p/GHSA-6rw7-vpxm-498p.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-6rw7-vpxm-498p/GHSA-6rw7-vpxm-498p.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/ljharb/qs
    reference_type:
    reference_id:
  - url: https://github.com/ljharb/qs/commit/3086902ecf7f088d0d1803887643ac6c03d415b9
    reference_type:
    reference_id:
  - url: https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-15284
    reference_type:
    reference_id:
