advisory_id: GHSA-f244-f9fc-w6fq
datasource_id: github_osv_importer_v2/GHSA-f244-f9fc-w6fq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-f244-f9fc-w6fq/GHSA-f244-f9fc-w6fq.json
aliases:
  - CVE-2023-30515
summary: |
  Jenkins Thycotic DevOps Secrets Vault Plugin does not properly mask credentials
  Multiple Jenkins plugins do not properly mask (i.e., replace with asterisks) credentials printed in the build log from Pipeline steps like sh and bat, when both of the following conditions are met:

  - The credentials are printed in build steps executing on an agent (typically inside a node block).

  - Push mode for durable task logging is enabled. This is a hidden option in Pipeline: Nodes and Processes that can be enabled through the Java system property org.jenkinsci.plugins.workflow.steps.durable_task.DurableTaskStep.USE_WATCHING. It is also automatically enabled by some plugins, e.g., OpenTelemetry and Pipeline Logging over CloudWatch.

  The following plugins are affected by this vulnerability:

  - Kubernetes 3909.v1f2c633e8590 and earlier (SECURITY-3079 / CVE-2023-30513)

  - Azure Key Vault 187.va_cd5fecd198a_ and earlier (SECURITY-3051 / CVE-2023-30514)

  - Thycotic DevOps Secrets Vault 1.0.0 (SECURITY-3078 / CVE-2023-30515)

  The following plugins have been updated to properly mask credentials in the build log when push mode for durable task logging is enabled:

  - Kubernetes 3910.ve59cec5e33ea_ (SECURITY-3079 / CVE-2023-30513)

  - Azure Key Vault 188.vf46b_7fa_846a_1 (SECURITY-3051 / CVE-2023-30514)

  As of publication of this advisory, there is no fix available for the following plugin:

  - Thycotic DevOps Secrets Vault 1.0.0 (SECURITY-3078 / CVE-2023-30515)
impacted_packages:
  - purl: pkg:maven/io.jenkins.plugins/thycotic-devops-secrets-vault
    affected_versions: vers:maven/<=1.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-f244-f9fc-w6fq/GHSA-f244-f9fc-w6fq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-319
references:
  - url: https://www.jenkins.io/security/advisory/2023-04-12/#SECURITY-3075
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/04/13/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-30515
    reference_type:
    reference_id: CVE-2023-30515
