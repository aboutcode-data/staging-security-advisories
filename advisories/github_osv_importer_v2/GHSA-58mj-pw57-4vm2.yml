advisory_id: GHSA-58mj-pw57-4vm2
datasource_id: github_osv_importer_v2/GHSA-58mj-pw57-4vm2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/03/GHSA-58mj-pw57-4vm2/GHSA-58mj-pw57-4vm2.json
aliases:
  - CVE-2017-11503
summary: |
  Cross-site scripting in PHPMailer
  PHPMailer versions prior to 5.2.24 (released July 26th 2017) have an XSS vulnerability in one of the code examples, CVE-2017-11503. The code_generator.phps example did not filter user input prior to output. This file is distributed with a `.phps` extension, so it it not normally executable unless it is explicitly renamed, and the file is not included when PHPMailer is loaded through composer, so it is safe by default. There was also an undisclosed potential XSS vulnerability in the default exception handler (unused by default). Patches for both issues kindly provided by Patrick Monnerat of the Fedora Project.

  ### Impact
  PHPMailer 5.2.23 has XSS in the &quot;From Email Address&quot; and &quot;To Email Address&quot; fields of code_generator.php.

  ### Patches
  Fixed in 5.2.24

  ### Workarounds
  None.

  ### References
  https://nvd.nist.gov/vuln/detail/CVE-2017-11503

  ### For more information
  If you have any questions or comments about this advisory:
  * Open a private issue in [the PHPMailer project](https://github.com/PHPMailer/PHPMailer)
impacted_packages:
  - purl: pkg:composer/phpmailer/phpmailer
    affected_versions: vers:composer/>=5.0.0|<5.2.24
    fixed_versions: vers:composer/5.2.24
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/03/GHSA-58mj-pw57-4vm2/GHSA-58mj-pw57-4vm2.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://cxsecurity.com/issue/WLB-2017060181
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/phpmailer/phpmailer/CVE-2017-11503.yaml
    reference_type:
    reference_id:
  - url: https://github.com/PHPMailer/PHPMailer/releases/tag/v5.2.24
    reference_type:
    reference_id:
  - url: https://github.com/PHPMailer/PHPMailer/security/advisories/GHSA-58mj-pw57-4vm2
    reference_type:
    reference_id:
  - url: https://packetstormsecurity.com/files/143138/phpmailer-xss.txt
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/99293
    reference_type:
    reference_id:
  - url: http://www.securitytracker.com/id/1039026
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-11503
    reference_type:
    reference_id: CVE-2017-11503
