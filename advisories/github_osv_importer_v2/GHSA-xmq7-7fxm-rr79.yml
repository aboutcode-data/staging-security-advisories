advisory_id: GHSA-xmq7-7fxm-rr79
datasource_id: github_osv_importer_v2/GHSA-xmq7-7fxm-rr79
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/09/GHSA-xmq7-7fxm-rr79/GHSA-xmq7-7fxm-rr79.json
aliases:
  - CVE-2020-15203
summary: "Denial of Service in Tensorflow\n### Impact\nBy controlling the `fill` argument of\
  \ [`tf.strings.as_string`](https://www.tensorflow.org/api_docs/python/tf/strings/as_string),\
  \ a malicious attacker is able to trigger a format string vulnerability due to the way the\
  \ internal format use in a `printf` call is constructed: https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/core/kernels/as_string_op.cc#L68-L74\n\
  \nThis can result in unexpected output:\n```python\nIn [1]: tf.strings.as_string(input=[1234],\
  \ width=6, fill='-')                                                                     \n\
  Out[1]: <tf.Tensor: shape=(1,), dtype=string, numpy=array(['1234  '], dtype=object)>     \
  \                                         \nIn [2]: tf.strings.as_string(input=[1234], width=6,\
  \ fill='+')                                                                     \nOut[2]:\
  \ <tf.Tensor: shape=(1,), dtype=string, numpy=array([' +1234'], dtype=object)> \nIn [3]: tf.strings.as_string(input=[1234],\
  \ width=6, fill=\"h\")                                                                   \
  \  \nOut[3]: <tf.Tensor: shape=(1,), dtype=string, numpy=array(['%6d'], dtype=object)> \n\
  In [4]: tf.strings.as_string(input=[1234], width=6, fill=\"d\")                          \
  \                                           \nOut[4]: <tf.Tensor: shape=(1,), dtype=string,\
  \ numpy=array(['12346d'], dtype=object)> \nIn [5]: tf.strings.as_string(input=[1234], width=6,\
  \ fill=\"o\")\nOut[5]: <tf.Tensor: shape=(1,), dtype=string, numpy=array(['23226d'], dtype=object)>\n\
  In [6]: tf.strings.as_string(input=[1234], width=6, fill=\"x\")\nOut[6]: <tf.Tensor: shape=(1,),\
  \ dtype=string, numpy=array(['4d26d'], dtype=object)>\nIn [7]: tf.strings.as_string(input=[1234],\
  \ width=6, fill=\"g\")\nOut[7]: <tf.Tensor: shape=(1,), dtype=string, numpy=array(['8.67458e-3116d'],\
  \ dtype=object)>\nIn [8]: tf.strings.as_string(input=[1234], width=6, fill=\"a\")\nOut[8]:\
  \ <tf.Tensor: shape=(1,), dtype=string, numpy=array(['0x0.00ff7eebb4d4p-10226d'], dtype=object)>\n\
  In [9]: tf.strings.as_string(input=[1234], width=6, fill=\"c\")\nOut[9]: <tf.Tensor: shape=(1,),\
  \ dtype=string, numpy=array(['\\xd26d'], dtype=object)>\nIn [10]: tf.strings.as_string(input=[1234],\
  \ width=6, fill=\"p\")\nOut[10]: <tf.Tensor: shape=(1,), dtype=string, numpy=array(['0x4d26d'],\
  \ dtype=object)>\nIn [11]: tf.strings.as_string(input=[1234], width=6, fill='m') \nOut[11]:\
  \ <tf.Tensor: shape=(1,), dtype=string, numpy=array(['Success6d'], dtype=object)>\n```\n\n\
  However, passing in `n` or `s` results in segmentation fault.\n\n### Patches\nWe have patched\
  \ the issue in 33be22c65d86256e6826666662e40dbdfe70ee83 and will release patch releases for\
  \ all versions between 1.15 and 2.3.\n\nWe recommend users to upgrade to TensorFlow 1.15.4,\
  \ 2.0.3, 2.1.2, 2.2.1, or 2.3.1.\n\n### For more information\nPlease consult [our security\
  \ guide](https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md) for more information\
  \ regarding the security model and how to contact us with issues and questions.\n\n### Attribution\n\
  This vulnerability has been reported by members of the Aivul Team from Qihoo 360."
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/<1.15.4
    fixed_versions: vers:pypi/1.15.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/>=2.0.0|<2.0.3
    fixed_versions: vers:pypi/2.0.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/>=2.1.0|<2.1.2
    fixed_versions: vers:pypi/2.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/2.2.0
    fixed_versions: vers:pypi/2.2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/2.3.0
    fixed_versions: vers:pypi/2.3.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/<1.15.4
    fixed_versions: vers:pypi/1.15.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/>=2.0.0|<2.0.3
    fixed_versions: vers:pypi/2.0.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/>=2.1.0|<2.1.2
    fixed_versions: vers:pypi/2.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/2.2.0
    fixed_versions: vers:pypi/2.2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/2.3.0
    fixed_versions: vers:pypi/2.3.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/<1.15.4
    fixed_versions: vers:pypi/1.15.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/>=2.0.0|<2.0.3
    fixed_versions: vers:pypi/2.0.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/>=2.1.0|<2.1.2
    fixed_versions: vers:pypi/2.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/2.2.0
    fixed_versions: vers:pypi/2.2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/2.3.0
    fixed_versions: vers:pypi/2.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/09/GHSA-xmq7-7fxm-rr79/GHSA-xmq7-7fxm-rr79.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/09/GHSA-xmq7-7fxm-rr79/GHSA-xmq7-7fxm-rr79.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-134
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2020-283.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2020-318.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2020-126.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/33be22c65d86256e6826666662e40dbdfe70ee83
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-xmq7-7fxm-rr79
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15203
    reference_type:
    reference_id: CVE-2020-15203
