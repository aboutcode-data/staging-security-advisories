advisory_id: GHSA-5476-xc4j-rqcv
datasource_id: github_osv_importer_v2/GHSA-5476-xc4j-rqcv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-5476-xc4j-rqcv/GHSA-5476-xc4j-rqcv.json
aliases:
  - CVE-2026-27830
summary: |
  c3p0 vulnerable to Remote Code Execution via unsafe deserialization of userOverridesAsString property
  ### Impact

  c3p0 is vulnerable to attack via maliciously crafted Java-serialized objects and `javax.naming.Reference` instances. Several c3p0 `ConnectionPoolDataSource` implementations have a property called `userOverridesAsString` which conceptually represents a `Map<String,Map<String,String>>`. Prior to v0.12.0, that property was maintained as a hex-encoded serialized object. Any attacker able to reset this property, on an existing `ConnectionPoolDataSource` or via maliciously crafted serialized objects or `javax.naming.Reference` instances could be tailored execute unexpected code on the application's `CLASSPATH`.

  The danger of this vulnerability was strongly magnified by vulnerabilities in c3p0's main dependency, mchange-commons-java. This library includes code that mirrors early implementations of JNDI functionality, including ungated support for remote `factoryClassLocation` values. Attackers could set c3p0's `userOverridesAsString` hex-encoded serialized objects that include objects "indirectly serialized" via JNDI references. Deserialization of those objects and dereferencing of the embedded `javax.naming.Reference` objects could provoke download and execution of malicious code from a remote `factoryClassLocation`.

  Although hazard presented by c3p0's vulnerabilites are exarcerbated by vulnerabilities in mchange-commons-java, use of Java-serialized-object hex as the format for a writable Java-Bean property, of objects that may be exposed across JNDI interfaces, represents a serious independent fragility.

  ### Patches

  The `userOverridesAsString` property of c3p0 `ConnectionPoolDataSource` classes has been reimplemented to use a safe CSV-based format, rather than rely upon potentially dangerous Java object deserialization.

  c3p0-0.12.0+ and above depend upon mchange-commons-java 0.4.0+, which gates support for remote `factoryClassLocation` values by configuration parameters that default to restrictive values. Those parameters are documented [here](https://www.mchange.com/projects/c3p0/#configuring_security).

  c3p0 additionally enforces the new mchange-commons-java `com.mchange.v2.naming.nameGuardClassName` to prevent injection of unexpected, potentially remote JNDI names.

  ### Workarounds

  Users should upgrade to c3p0-0.12.0 or above. There is no supported workaround for earlier versions of c3p0.

  ### References

  [c3p0, you little rascal &mdash; Hans-Martin MÃ¼nch](https://mogwailabs.de/en/blog/2025/02/c3p0-you-little-rascal/)
  [c3p0 documentation, security note](https://www.mchange.com/projects/c3p0/#security-note)
  [c3p0 documentation, configuring security](https://www.mchange.com/projects/c3p0/#configuring_security)
impacted_packages:
  - purl: pkg:maven/com.mchange/c3p0
    affected_versions: vers:maven/<0.12.0
    fixed_versions: vers:maven/0.12.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:A/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-5476-xc4j-rqcv/GHSA-5476-xc4j-rqcv.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
  - CWE-94
references:
  - url: https://github.com/swaldman/c3p0
    reference_type:
    reference_id:
  - url: https://github.com/swaldman/c3p0/commit/e14cbd8166e423e2e9a9d6f08b2add3433492d6e
    reference_type:
    reference_id:
  - url: https://github.com/swaldman/c3p0/security/advisories/GHSA-5476-xc4j-rqcv
    reference_type:
    reference_id:
  - url: https://mogwailabs.de/en/blog/2025/02/c3p0-you-little-rascal
    reference_type:
    reference_id:
  - url: https://www.mchange.com/projects/c3p0/#configuring_security
    reference_type:
    reference_id:
  - url: https://www.mchange.com/projects/c3p0/#security-note
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-27830
    reference_type:
    reference_id: CVE-2026-27830
