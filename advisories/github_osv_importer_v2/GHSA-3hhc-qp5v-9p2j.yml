advisory_id: GHSA-3hhc-qp5v-9p2j
datasource_id: github_osv_importer_v2/GHSA-3hhc-qp5v-9p2j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-3hhc-qp5v-9p2j/GHSA-3hhc-qp5v-9p2j.json
aliases:
  - CVE-2022-32224
summary: |
  Active Record RCE bug with Serialized Columns
  When serialized columns that use YAML (the default) are deserialized, Rails uses YAML.unsafe_load to convert the YAML data in to Ruby objects. If an attacker can manipulate data in the database (via means like SQL injection), then it may be possible for the attacker to escalate to an RCE.

  There are no feasible workarounds for this issue, but other coders (such as JSON) are not impacted.
impacted_packages:
  - purl: pkg:gem/activerecord
    affected_versions: vers:gem/<=7.0.3
    fixed_versions: vers:gem/7.0.3.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activerecord
    affected_versions: vers:gem/<=6.1.6
    fixed_versions: vers:gem/6.1.6.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activerecord
    affected_versions: vers:gem/<=6.0.5
    fixed_versions: vers:gem/6.0.5.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activerecord
    affected_versions: vers:gem/<=5.2.8
    fixed_versions: vers:gem/5.2.8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-3hhc-qp5v-9p2j/GHSA-3hhc-qp5v-9p2j.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://discuss.rubyonrails.org/t/cve-2022-32224-possible-rce-escalation-bug-with-serialized-columns-in-active-record/81017
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-3hhc-qp5v-9p2j
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/611990f1a6c137c2d56b1ba06b27e5d2434dcd6a
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commits/main/activerecord
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activerecord/CVE-2022-32224.yml
    reference_type:
    reference_id:
  - url: https://groups.google.com/g/rubyonrails-security/c/MmFO3LYQE8U
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-32224
    reference_type:
    reference_id: CVE-2022-32224
