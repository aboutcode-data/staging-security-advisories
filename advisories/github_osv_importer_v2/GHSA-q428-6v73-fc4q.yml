advisory_id: GHSA-q428-6v73-fc4q
datasource_id: github_osv_importer_v2/GHSA-q428-6v73-fc4q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-q428-6v73-fc4q/GHSA-q428-6v73-fc4q.json
aliases:
  - CVE-2025-64517
summary: |
  sudo-rs doesn't record authenticating user properly in timestamp
  ### Summary
  When `Defaults targetpw` (or `Defaults rootpw`) is enabled, the password of the target account (or root account) instead of the invoking user is used for authentication. `sudo-rs` prior to 0.2.10 incorrectly recorded the invoking userâ€™s UID instead of the authenticated-as user's UID in the authentication timestamp. Any later `sudo` invocation on the same terminal while the timestamp was still valid would use that timestamp, potentially bypassing new authentication even if the policy would have required it.

  ### Impact
  A highly-privileged user (able to run commands as other users, or as root, through sudo) who knows one password of an account they are allowed to run commands as, would be able to run commands as any other account the policy permits them to run commands for, even if they don't know the password for those accounts.

  A common instance of this would be that a user can still use their own password to run commands as root (the default behaviour of `sudo`), effectively negating the intended behaviour of the `targetpw` or `rootpw` options.

  ### Example

  With this in /etc/sudoers:
  ```
  Defaults targetpw
  user ALL=(ALL:ALL) ALL
  ```
  First run:
  ```
  user@machine$ sudo -g root whoami
  [sudo: authenticate] Password: <password for user>
  user
  ```
  Then run:
  ```
  user@machine$ sudo -u root whoami
  root
  ```

  ### Affected versions

  sudo-rs prior to 0.2.5 are not affected, since they do not offer `Defaults targetpw` or `Defaults rootpw`.

  ### Credits

  This issue was discovered and reported by @Pingasmaster.
impacted_packages: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-q428-6v73-fc4q/GHSA-q428-6v73-fc4q.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/trifectatechfoundation/sudo-rs
    reference_type:
    reference_id:
  - url: https://github.com/trifectatechfoundation/sudo-rs/commit/8423fd986c3fa58b357f238c0db5e54baca5255d
    reference_type:
    reference_id:
  - url: https://github.com/trifectatechfoundation/sudo-rs/releases/tag/v0.2.10
    reference_type:
    reference_id:
  - url: https://github.com/trifectatechfoundation/sudo-rs/security/advisories/GHSA-q428-6v73-fc4q
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64517
    reference_type:
    reference_id:
