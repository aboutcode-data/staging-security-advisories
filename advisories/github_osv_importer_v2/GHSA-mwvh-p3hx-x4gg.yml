advisory_id: GHSA-mwvh-p3hx-x4gg
datasource_id: github_osv_importer_v2/GHSA-mwvh-p3hx-x4gg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-mwvh-p3hx-x4gg/GHSA-mwvh-p3hx-x4gg.json
aliases: []
summary: |
  Ibexa Kernel's files with blacklisted extensions can be still saved to drafts
  ### Impact
  File validation can be configured to reject certain files by file type. When this happens, validation fails, and the content can't be published. However, the file can be saved when saving the content draft. This means unwanted files can be present in storage, even if they are not easily accessible due to the content not being published. The fix ensures these unwanted file types are never stored. An attacker would need to have existing access to create content with a file field type to exploit this.

  ### Patches
  See "Patched versions".
  Commit: https://github.com/ezsystems/ezplatform-kernel/commit/7e472317f7c75f45f72f74c38406952d8bea0de1

  ### References
  https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages
impacted_packages:
  - purl: pkg:composer/ezsystems/ezplatform-kernel
    affected_versions: vers:composer/>=1.3.0|<1.3.35
    fixed_versions: vers:composer/1.3.35
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-kernel
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-kernel/commit/7e472317f7c75f45f72f74c38406952d8bea0de1
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-kernel/security/advisories/GHSA-mwvh-p3hx-x4gg
    reference_type:
    reference_id:
