advisory_id: GHSA-jjjj-jwhf-8rgr
datasource_id: github_osv_importer_v2/GHSA-jjjj-jwhf-8rgr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-jjjj-jwhf-8rgr/GHSA-jjjj-jwhf-8rgr.json
aliases:
  - CVE-2025-62506
summary: |
  MinIO is Vulnerable to Privilege Escalation via Session Policy Bypass in Service Accounts and STS
  ### Summary
  A privilege escalation vulnerability allows service accounts and STS (Security Token Service) accounts with restricted session policies to bypass their inline policy restrictions when performing "own" account operations, specifically when creating new service accounts for the same user.

  ### Details
  The vulnerability exists in the IAM policy validation logic in `cmd/iam.go`. When validating session policies for restricted accounts performing operations on their own account (such as creating service accounts), the code incorrectly relied on the `DenyOnly` argument.

  The `DenyOnly` flag is used to allow accounts to perform actions related to their own account by only checking if the action is explicitly denied. However, when a session policy (sub-policy) is present, the system should validate that the action is actually **allowed** by the session policy, not just that it isn't denied.

  ### Attack Scenario
    1. An administrator creates a service account or STS account with a restricted inline policy (e.g., access only to bucket1 and bucket2)
    2. The restricted account attempts to create a new service account for itself without specifying any policy restrictions
    3. Due to the bypass, the new service account is created with full parent privileges instead of being restricted by the inline policy
    4. The attacker now has escalated privileges beyond the intended restrictions

  ### Impact

    **Attack Complexity**: LOW - Exploitation requires only valid credentials for a restricted service/STS account

    **Confidentiality**: HIGH - Attackers can access buckets and objects beyond their intended restrictions

    **Integrity**: HIGH - Attackers can modify, delete, or create objects outside their authorized scope

    **Availability**: NONE - Does not directly impact service availability

  ### Patches
  Fixed in PR https://github.com/minio/minio/pull/21642
  Commit: c1a49490c78e9c3ebcad86ba0662319138ace190

  Install the release
  ```
  go install -v github.com/minio/minio@RELEASE.2025-10-15T17-29-55Z
  ```

  ### Workarounds
  No workarounds available. You can upgrade to the latest version immediately.

  ### Mitigation Steps

  1. **Upgrade MinIO**: Update to the latest version containing the fix
  2. **Audit Service Accounts**: Review all service accounts created by non-admin accounts
  3. **Revoke Suspicious Accounts**: Delete any service accounts that may have been created through exploitation
  4. **Review Access Logs**: Check for unauthorized access to sensitive buckets

  ### Resources

  - Fix PR: https://github.com/minio/minio/pull/21642
  - Affected code: cmd/iam.go (functions: isAllowedBySessionPolicyForServiceAccount, isAllowedBySessionPolicy)
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-jjjj-jwhf-8rgr/GHSA-jjjj-jwhf-8rgr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/minio/minio
    reference_type:
    reference_id:
  - url: https://github.com/minio/minio/commit/c1a49490c78e9c3ebcad86ba0662319138ace190
    reference_type:
    reference_id:
  - url: https://github.com/minio/minio/discussions/21655
    reference_type:
    reference_id:
  - url: https://github.com/minio/minio/issues/21647
    reference_type:
    reference_id:
  - url: https://github.com/minio/minio/pull/21642
    reference_type:
    reference_id:
  - url: https://github.com/minio/minio/security/advisories/GHSA-jjjj-jwhf-8rgr
    reference_type:
    reference_id:
  - url: https://news.ycombinator.com/item?id=45684035
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-62506
    reference_type:
    reference_id:
