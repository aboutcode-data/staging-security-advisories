advisory_id: GHSA-8fxr-qfr9-p34w
datasource_id: github_osv_importer_v2/GHSA-8fxr-qfr9-p34w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-8fxr-qfr9-p34w/GHSA-8fxr-qfr9-p34w.json
aliases:
  - CVE-2023-43654
summary: |
  TorchServe Server-Side Request Forgery vulnerability
  ## Impact
  **Remote Server-Side Request Forgery (SSRF)**
      **Issue**: TorchServe default configuration lacks proper input validation, enabling third parties to invoke remote HTTP download requests and write files to the disk. This issue could be taken advantage of to compromise the integrity of the system and sensitive data. This issue is present in versions `0.1.0` to `0.8.1`.
      **Mitigation**: The user is able to load the model of their choice from any URL that they would like to use. The user of TorchServe is responsible for configuring both the [allowed_urls](https://github.com/pytorch/serve/blob/b3eced56b4d9d5d3b8597aa506a0bcf954d291bc/docs/configuration.md?plain=1#L296) and specifying the model URL to be used. A pull request to warn the user when the default value for `allowed_urls` is used has been merged - https://github.com/pytorch/serve/pull/2534. TorchServe release `0.8.2` includes this change.

  ## Patches

  ## TorchServe release 0.8.2 includes fixes to address the previously listed issue:

  https://github.com/pytorch/serve/releases/tag/v0.8.2

  **Tags for upgraded DLC release**
  User can use the following new image tags to pull DLCs that ship with patched TorchServe version 0.8.2:
  x86 GPU

  * v1.9-pt-ec2-2.0.1-inf-gpu-py310
  * v1.8-pt-sagemaker-2.0.1-inf-gpu-py310

  x86 CPU

  * v1.8-pt-ec2-2.0.1-inf-cpu-py310
  * v1.7-pt-sagemaker-2.0.1-inf-cpu-py310

  Graviton

  * v1.7-pt-graviton-ec2-2.0.1-inf-cpu-py310
  * v1.5-pt-graviton-sagemaker-2.0.1-inf-cpu-py310

  Neuron

  * 1.13.1-neuron-py310-sdk2.13.2-ubuntu20.04
  * 1.13.1-neuronx-py310-sdk2.13.2-ubuntu20.04
  * 1.13.1-neuronx-py310-sdk2.13.2-ubuntu20.04

  The full DLC image URI details can be found at: https://github.com/aws/deep-learning-containers/blob/master/available_images.md#available-deep-learning-containers-images

  ## References
  https://github.com/pytorch/serve/blob/b3eced56b4d9d5d3b8597aa506a0bcf954d291bc/docs/configuration.md?plain=1#L296
  https://github.com/pytorch/serve/pull/2534
  https://github.com/pytorch/serve/releases/tag/v0.8.2
  https://github.com/aws/deep-learning-containers/blob/master/available_images.md#available-deep-learning-containers-images

  ## Credit
  We would like to thank Oligo Security for responsibly disclosing this issue and working with us on its resolution.
  If you have any questions or comments about this advisory, we ask that you contact AWS/Amazon Security via our [vulnerability reporting page](https://aws.amazon.com/security/vulnerability-reporting[)](https://aws.amazon.com/security/vulnerability-reporting)) or directly via email to [aws-security@amazon.com](mailto:aws-security@amazon.com). Please do not create a public GitHub issue.
impacted_packages:
  - purl: pkg:pypi/torchserve
    affected_versions: vers:pypi/>=0.1.0|<0.8.2
    fixed_versions: vers:pypi/0.8.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-8fxr-qfr9-p34w/GHSA-8fxr-qfr9-p34w.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: http://packetstormsecurity.com/files/175095/PyTorch-Model-Server-Registration-Deserialization-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/pull/2534
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/releases/tag/v0.8.2
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/security/advisories/GHSA-8fxr-qfr9-p34w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-43654
    reference_type:
    reference_id: CVE-2023-43654
