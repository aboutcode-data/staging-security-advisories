advisory_id: GHSA-m6m5-pp4g-fcc8
datasource_id: github_osv_importer_v2/GHSA-m6m5-pp4g-fcc8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-m6m5-pp4g-fcc8/GHSA-m6m5-pp4g-fcc8.json
aliases: []
summary: |
  S3 storage write is not aborted on errors leading to unbounded memory usage
  ### Impact

  Anyone using storage.blob.s3 introduced in 0.5.0 with storage.imapsql.
  ```
  storage.imapsql local_mailboxes {
    ...
    msg_store s3 {
      ...
    }
  }
  ```

  ### Patches

  The relevant commit is pushed to master and will be included in the 0.5.1 release.

  No special handling of the issue has been done due to the small amount of affected users.

  ### Workarounds

  None.

  ### References

  * Original report: https://github.com/foxcpp/maddy/issues/395
  * Fix: https://github.com/foxcpp/maddy/commit/07c8495ee4394fabbf5aac4df8aebeafb2fb29d8
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-m6m5-pp4g-fcc8/GHSA-m6m5-pp4g-fcc8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-772
references:
  - url: https://github.com/foxcpp/maddy
    reference_type:
    reference_id:
  - url: https://github.com/foxcpp/maddy/security/advisories/GHSA-m6m5-pp4g-fcc8
    reference_type:
    reference_id:
