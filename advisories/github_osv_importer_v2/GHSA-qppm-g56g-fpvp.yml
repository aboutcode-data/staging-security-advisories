advisory_id: GHSA-qppm-g56g-fpvp
datasource_id: github_osv_importer_v2/GHSA-qppm-g56g-fpvp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-qppm-g56g-fpvp/GHSA-qppm-g56g-fpvp.json
aliases:
  - CVE-2025-66803
summary: |
  Turbo Frame responses can restore stale session cookies
  ###  Summary
  A race condition in Turbo Frames allows delayed HTTP responses to restore stale session cookies after session-modifying operations.

  ### Details
  Browsers automatically process Set-Cookie headers from HTTP responses. When a Turbo Frame request is in-flight during a session-modifying action (such as logout), the delayed response may include a Set-Cookie header reflecting the session state at request time. This can result in stale session cookies being restored after the session was intentionally modified or invalidated.

  This condition can occur naturally on slow networks. An active network attacker capable of delaying responses could potentially exploit this to restore previous session state.

    ### Impact
   Applications using Turbo Frames with cookie-based session storage may experience:
    - Session state reversion after logout
    - Unintended restoration of previous authentication state

  The impact is limited to applications using client-side cookie storage for sessions. Applications using server-side session stores (Redis, database, etc.) are not meaningfully affected, as the server-side session state remains authoritative.

  ###  Patches
    Upgrade to Turbo 8.0.21 or later. The fix cancels in-flight Turbo Frame requests when:
    - The frame element is disconnected from the DOM
    - The frame's disabled attribute is set
    - The frame's src attribute is cleared

  ###  Workarounds
    - Use server-side session storage instead of a cookie store like Rails's cookie store
    - Ensure logout flows remove or disable Turbo Frame elements before invalidating sessions

  ###  References
    - https://github.com/hotwired/turbo/pull/1399
impacted_packages:
  - purl: pkg:npm/%40hotwired/turbo
    affected_versions: vers:npm/<=8.0.20
    fixed_versions: vers:npm/8.0.21
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '1.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-qppm-g56g-fpvp/GHSA-qppm-g56g-fpvp.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-362
  - CWE-613
  - CWE-367
references:
  - url: https://github.com/hotwired/turbo
    reference_type:
    reference_id:
  - url: https://github.com/hotwired/turbo/commit/899df356e9f4b3303cca217cd14b3f846edda10d
    reference_type:
    reference_id:
  - url: https://github.com/hotwired/turbo/pull/1399
    reference_type:
    reference_id:
  - url: https://github.com/hotwired/turbo/releases/tag/v8.0.21
    reference_type:
    reference_id:
  - url: https://github.com/hotwired/turbo/security/advisories/GHSA-qppm-g56g-fpvp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66803
    reference_type:
    reference_id:
  - url: https://turbo.hotwired.dev/handbook/frames
    reference_type:
    reference_id:
