advisory_id: GHSA-5vm8-hhgr-jcjp
datasource_id: github_osv_importer_v2/GHSA-5vm8-hhgr-jcjp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-5vm8-hhgr-jcjp/GHSA-5vm8-hhgr-jcjp.json
aliases: []
summary: |
  Cross-site scripting vulnerability in TinyMCE
  ### Impact
  A cross-site scripting (XSS) vulnerability was discovered in the URL sanitization logic of the core parser for `form` elements. The vulnerability allowed arbitrary JavaScript execution when inserting a specially crafted piece of content into the editor using the clipboard or APIs, and then submitting the form. However, as TinyMCE does not allow forms to be submitted while editing, the vulnerability could only be triggered when the content was previewed or rendered outside of the editor. This impacts all users who are using TinyMCE 5.7.0 or lower.

  ### Patches
  This vulnerability has been patched in TinyMCE 5.7.1 by improved URL sanitization logic.

  ### Workarounds
  To work around this vulnerability, either:
  - Upgrade to TinyMCE 5.7.1 or higher
  - Manually sanitize `form` URL attributes using a [TinyMCE node filter](https://www.tiny.cloud/docs/api/tinymce.html/tinymce.html.domparser/#addnodefilter).
  - Disable `form` elements in your content using the [invalid_elements](https://www.tiny.cloud/docs/configure/content-filtering/#invalid_elements) setting.

  #### Example: Sanitizing using a node filter
  ```js
  editor.parser.addNodeFilter('form', function(nodes) {
    nodes.forEach(function(node) {
      if (node.attributes) {
        node.attributes.forEach(function(attr) {
          var name = attr.name;
          var value = attr.value;
          // Sanitize the attribute value here or remove it entirely
          var sanitizedValue = ...;
          node.attr(name, santizedValue);
        });
      }
    });
  });
  ```

  #### Example: Using invalid_elements
  ```js
  invalid_elements: 'form'
  ```

  ### Acknowledgements
  Tiny Technologies would like to thank Mikhail Khramenkov at Solar Security Research Team for discovering this vulnerability.

  ### References
  https://www.tiny.cloud/docs/release-notes/release-notes571/#securityfixes

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in the [TinyMCE repo](https://github.com/tinymce/tinymce/issues)
  * Email us at [infosec@tiny.cloud](mailto:infosec@tiny.cloud)
impacted_packages:
  - purl: pkg:npm/tinymce
    affected_versions: vers:npm/<5.7.1
    fixed_versions: vers:npm/5.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/tinymce/tinymce/security/advisories/GHSA-5vm8-hhgr-jcjp
    reference_type:
    reference_id:
