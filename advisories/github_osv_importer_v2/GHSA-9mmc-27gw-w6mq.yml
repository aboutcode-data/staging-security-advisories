advisory_id: GHSA-9mmc-27gw-w6mq
datasource_id: github_osv_importer_v2/GHSA-9mmc-27gw-w6mq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-9mmc-27gw-w6mq/GHSA-9mmc-27gw-w6mq.json
aliases:
  - CVE-2022-32170
summary: |
  Bytebase allows low-privilege users to view admin projects
  ### Overview
  The "Bytebase" application does not restrict low privilege user from accessing admin projects

  ### Details
  The "Bytebase" application does not restrict low privilege user from accessing admin projects for which an unauthorized user can view the "projects" created by "Admin". The affected endpoint is `/api/project?user=${userId}`.

  ### PoC
  1. Log in to the application as both "Admin" (`admin@example.com:admin`) and Developer "User" (`user@admin.com:user`) and then click on "Projects".
  2. Now open "Burp suite" and turn "Intercept on" and from "admin" dashboard click on "projects" and see the "user id" of "admin" in the capture request.
  3. Note the "user id" and "Forward" the request and again capture the request of "projects" from the "user" dashboard and change "user id" to "admin user id" and "Forward" the request.
  4. Now "user" can see the "projects" created by "admin".
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-9mmc-27gw-w6mq/GHSA-9mmc-27gw-w6mq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
references:
  - url: https://github.com/bytebase/bytebase
    reference_type:
    reference_id:
  - url: https://github.com/bytebase/bytebase/blob/1.0.4/frontend/src/store/modules/project.ts#L166-L197
    reference_type:
    reference_id:
  - url: https://www.mend.io/vulnerability-database/CVE-2022-32170
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-32170
    reference_type:
    reference_id: CVE-2022-32170
