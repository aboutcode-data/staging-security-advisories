advisory_id: GHSA-8mjx-h23h-w2pg
datasource_id: github_osv_importer_v2/GHSA-8mjx-h23h-w2pg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-8mjx-h23h-w2pg/GHSA-8mjx-h23h-w2pg.json
aliases:
  - CVE-2021-28034
summary: |
  Double free in stack_dst
  Affected versions of stack_dst used a push_inner function that increased the internal length of the array and then called val.clone(). If the val.clone() call panics, the stack could drop an already dropped element or drop uninitialized memory. This issue was fixed in `2a4d538` by increasing the length of the array after elements are cloned.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-8mjx-h23h-w2pg/GHSA-8mjx-h23h-w2pg.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-415
references:
  - url: https://github.com/thepowersgang/stack_dst-rs
    reference_type:
    reference_id:
  - url: https://github.com/thepowersgang/stack_dst-rs/commit/2a4d538
    reference_type:
    reference_id:
  - url: https://github.com/thepowersgang/stack_dst-rs/commit/2a4d53809e3000f40085f2b229b6b1a33759881d
    reference_type:
    reference_id:
  - url: https://github.com/thepowersgang/stack_dst-rs/issues/5
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0033.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28034
    reference_type:
    reference_id: CVE-2021-28034
