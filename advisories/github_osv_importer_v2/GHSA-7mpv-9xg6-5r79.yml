advisory_id: GHSA-7mpv-9xg6-5r79
datasource_id: github_osv_importer_v2/GHSA-7mpv-9xg6-5r79
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-7mpv-9xg6-5r79/GHSA-7mpv-9xg6-5r79.json
aliases:
  - CVE-2025-31496
summary: |
  Apollo Compiler Named Fragment Processing Vulnerability
  # Impact

  ## Summary

  A vulnerability in Apollo Compiler allowed queries with deeply nested and reused named fragments to be prohibitively expensive to validate. This could lead to excessive resource consumption and denial of service in applications.

  ## Details

  Named fragments were being processed once per fragment spread in some cases during query validation, leading to exponential resource usage when deeply nested and reused fragments were involved.

  ## Fix/Mitigation

  The validation logic has been updated to process each named fragment only once, preventing redundant traversal.

  # Patches
  This has been remediated in `apollo-compiler` version 1.27.0.

  # Workarounds
  No known direct workarounds exist.

  ## Acknowledgements
  We appreciate the efforts of the security community in identifying and improving the performance and security of query validation mechanisms.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-7mpv-9xg6-5r79/GHSA-7mpv-9xg6-5r79.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
references:
  - url: https://github.com/apollographql/apollo-rs
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/apollo-rs/pull/952
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/apollo-rs/security/advisories/GHSA-7mpv-9xg6-5r79
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-31496
    reference_type:
    reference_id: CVE-2025-31496
