advisory_id: GHSA-hrmc-jmp7-mpm2
datasource_id: github_osv_importer_v2/GHSA-hrmc-jmp7-mpm2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-hrmc-jmp7-mpm2/GHSA-hrmc-jmp7-mpm2.json
aliases:
  - CVE-2024-45758
summary: |
  H2O.ai H2O vulnerable to deserialization attacks via a JDBC Connection URL
  H2O.ai H2O through 3.46.0.4 allows attackers to arbitrarily set the JDBC URL, leading to deserialization attacks, file reads, and command execution. Exploitation can occur when an attacker has access to post to the ImportSQLTable URI with a JSON document containing a connection_url property with any typical JDBC Connection URL attack payload such as one that uses queryInterceptors.
impacted_packages:
  - purl: pkg:maven/ai.h2o/h2o-core
    affected_versions: vers:maven/<=3.46.0.7
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/h2o
    affected_versions: vers:pypi/<=3.46.0.7
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-hrmc-jmp7-mpm2/GHSA-hrmc-jmp7-mpm2.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://gist.github.com/AfterSnows/c24ca3c26dc89ab797e610e92a6a9acb
    reference_type:
    reference_id:
  - url: https://github.com/h2oai/h2o-3
    reference_type:
    reference_id:
  - url: https://github.com/h2oai/h2o-3/commit/f714edd6b8429c7a7211b779b6ec108a95b7382d
    reference_type:
    reference_id:
  - url: https://github.com/h2oai/h2o-3/issues/16425
    reference_type:
    reference_id:
  - url: https://github.com/h2oai/h2o-3/issues/16622
    reference_type:
    reference_id:
  - url: https://github.com/h2oai/h2o-3/pull/16624
    reference_type:
    reference_id:
  - url: https://spear-shield.notion.site/Unauthenticated-Remote-Code-Execution-via-Unrestricted-JDBC-Connection-87a958a4874044199cbb86422d1f6068
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45758
    reference_type:
    reference_id: CVE-2024-45758
