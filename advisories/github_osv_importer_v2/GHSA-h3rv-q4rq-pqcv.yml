advisory_id: GHSA-h3rv-q4rq-pqcv
datasource_id: github_osv_importer_v2/GHSA-h3rv-q4rq-pqcv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-h3rv-q4rq-pqcv/GHSA-h3rv-q4rq-pqcv.json
aliases:
  - CVE-2026-26988
summary: "LibreNMS: SQL Injection in ajax_table.php spreads through a covert data stream.\n\
  ### Summary\n*SQL Injection in IPv6 Address Search functionality via `address` parameter**\n\
  \nA SQL injection vulnerability exists in the `ajax_table.php` endpoint. The application fails\
  \ to properly sanitize or parameterize user input when processing IPv6 address searches. Specifically,\
  \ the `address` parameter is split into an address and a prefix, and the prefix portion is\
  \ directly concatenated into the SQL query string without validation. This allows an attacker\
  \ to inject arbitrary SQL commands, potentially leading to unauthorized data access or database\
  \ manipulation.\n\n### Details\nThe vulnerability is located in the logic that handles address\
  \ searching when `search_type` is set to `ipv6`.\n\nThe application takes the user-supplied\
  \ `address` parameter and splits it using the `/` delimiter:\n```PHP\n[$address, $prefix]\
  \ = explode('/', $vars['address']);\n```\nIf the search_type is ipv6 and the $prefix variable\
  \ is not empty, the code constructs the SQL query by directly concatenating the $prefix variable\
  \ into the string:\n```\n} elseif ($vars['search_type'] == 'ipv6') {\n    // ... code omitted\
  \ ...\n    if (! empty($prefix)) {\n        // VULNERABILITY: Direct concatenation of user\
  \ input\n        $sql .= \" AND ipv6_prefixlen = '$prefix'\";\n    }\n}\n```\nUnlike the ipv4\
  \ block, which attempts to use prepared statements (binding parameters via $param[]), the\
  \ ipv6 block treats the prefix as a raw string. By supplying an input containing a /, an attacker\
  \ can populate the $prefix variable. If this variable contains single quotes ('), it breaks\
  \ out of the string literal in the SQL statement, enabling SQL injection.\n\nVulnerable Code\
  \ Snippet:\n```\nif (! empty($prefix)) {\n    $sql .= \" AND ipv6_prefixlen = '$prefix'\"\
  ;\n}\n```\n### PoC\nTo reproduce this vulnerability, an attacker can send a specially crafted\
  \ HTTP POST request to the ajax_table.php endpoint.\n\nPayload breakdown:\n\n- search_type=ipv6:\
  \ Forces the execution flow into the vulnerable elseif block.\n\n- address=snow/1nd'\":\n\n\
  \  - The explode function splits this into $address = 'snow' and $prefix = \"1nd'\"\".\n\n\
  \  - The SQL query becomes: ... AND ipv6_prefixlen = '1nd'\"'.\n\n  - The single quote ' closes\
  \ the string definition in the SQL query, and the subsequent characters allow for SQL syntax\
  \ manipulation.\n\nReproduction Steps:\n\n1. Access the application instance.\n\n2. Send the\
  \ following request (adjusting the host as necessary):\n```\nPOST /ajax_table.php HTTP/1.1\n\
  Host: localhost\nid=address-search&search_type=ipv6&address=snow/1nd'\" \n```\n### Impact\n\
  This vulnerability allows an attacker to execute arbitrary SQL queries against the database."
impacted_packages:
  - purl: pkg:composer/librenms/librenms
    affected_versions: vers:composer/<26.2.0
    fixed_versions: vers:composer/26.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/15429580baba03ed1dd377bada1bde4b7a1175a1
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/pull/18777
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-h3rv-q4rq-pqcv
    reference_type:
    reference_id:
