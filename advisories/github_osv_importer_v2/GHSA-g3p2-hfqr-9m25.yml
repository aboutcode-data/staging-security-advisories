advisory_id: GHSA-g3p2-hfqr-9m25
datasource_id: github_osv_importer_v2/GHSA-g3p2-hfqr-9m25
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-g3p2-hfqr-9m25/GHSA-g3p2-hfqr-9m25.json
aliases:
  - CVE-2021-22968
summary: |
  Improper file handling in concrete5/core
  A bypass of adding remote files in Concrete CMS (previously concrete5) File Manager leads to remote code execution in Concrete CMS (concrete5) versions 8.5.6 and below. The external file upload feature stages files in the public directory even if they have disallowed file extensions. They are stored in a directory with a random name, but it's possible to stall the uploads and brute force the directory name. You have to be an admin with the ability to upload files, but this bug gives you the ability to upload restricted file types and execute them depending on server configuration. To fix this, a check for allowed file extensions was added before downloading files to a tmp directory
impacted_packages:
  - purl: pkg:composer/concrete5/core
    affected_versions: vers:composer/<8.5.7
    fixed_versions: vers:composer/8.5.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-g3p2-hfqr-9m25/GHSA-g3p2-hfqr-9m25.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-330
  - CWE-98
references:
  - url: https://documentation.concretecms.org/developers/introduction/version-history/857-release-notes
    reference_type:
    reference_id:
  - url: https://github.com/olsgreen/concrete5-core
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1350444
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-22968
    reference_type:
    reference_id: CVE-2021-22968
