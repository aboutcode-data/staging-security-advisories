advisory_id: GHSA-2c6m-6gqh-6qg3
datasource_id: github_osv_importer_v2/GHSA-2c6m-6gqh-6qg3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-2c6m-6gqh-6qg3/GHSA-2c6m-6gqh-6qg3.json
aliases:
  - CVE-2022-39321
summary: |
  Docker Command Escaping in the GitHub Actions Runner
  ### Impact

  The actions runner invokes the docker cli directly in order to run job containers, service containers, or container actions. A bug in the logic for how the environment is encoded into these docker commands was discovered that allows an input to escape the environment variable and modify that docker command invocation directly. Jobs that use [container actions](https://docs.github.com/en/actions/creating-actions/creating-a-docker-container-action), [job containers](https://docs.github.com/en/actions/using-jobs/running-jobs-in-a-container), or [service containers](https://docs.github.com/en/actions/using-containerized-services/about-service-containers) alongside untrusted user inputs in environment variables may be vulnerable.

  ### Patches
  The Actions Runner has been patched, both on `github.com` and hotfixes for GHES and GHAE customers. Please update to one of the following versions of the runner:
  - 2.296.2
  - 2.293.1
  - 2.289.4
  - 2.285.2
  - 2.283.4

  GHES and GHAE customers may want to patch their instance in order to have their runners automatically upgrade to these new runner versions.

  ### Workarounds
  You may want to consider removing any container actions, job containers, or service containers from your jobs until you are able to upgrade your runner versions.


  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [the actions runner](https://github.com/actions/runner)
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-2c6m-6gqh-6qg3/GHSA-2c6m-6gqh-6qg3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/actions/runner
    reference_type:
    reference_id:
  - url: https://github.com/actions/runner/pull/2107
    reference_type:
    reference_id:
  - url: https://github.com/actions/runner/pull/2108
    reference_type:
    reference_id:
  - url: https://github.com/actions/runner/security/advisories/GHSA-2c6m-6gqh-6qg3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39321
    reference_type:
    reference_id: CVE-2022-39321
