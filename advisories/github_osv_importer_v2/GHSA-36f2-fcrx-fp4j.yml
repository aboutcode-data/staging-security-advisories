advisory_id: GHSA-36f2-fcrx-fp4j
datasource_id: github_osv_importer_v2/GHSA-36f2-fcrx-fp4j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-36f2-fcrx-fp4j/GHSA-36f2-fcrx-fp4j.json
aliases:
  - CVE-2021-29456
summary: "Authelia allows open redirects on the logout endpoint\n### Impact\nUtilizing a HTTP\
  \ query parameter an attacker is able to redirect users from the web application to any domain.\
  \ The URL of the intended redirect should always be checked for safety prior to forwarding\
  \ the user. Other endpoints of the web application already do this, they check both that the\
  \ domain is using the HTTPS protocol and that it exists on a domain associated with the application.\n\
  \nAn attacker is able to use this unintended functionality to redirect users to malicious\
  \ sites. This particular security issue allows the attacker to make a phishing attempt seem\
  \ much more trustworthy to a user of the web application as the initial site before redirection\
  \ is familiar to them, as well as the actual URL which they have theoretically visited frequently.\
  \ \n\nWhile this security issue does not directly impact the security of the web application,\
  \ it is still not an acceptable scenario for the reasons mentioned above. \n\n### Patches\n\
  f0cb75e1e102f95f91e9254c66c797e821857690 fix(handlers): logout redirection validation (#1908)\
  \ [v4.28.0](https://github.com/authelia/authelia/releases/tag/v4.28.0)\n\n### Workarounds\n\
  Using a reverse proxy to strip the query parameter from the affected endpoint. \n\n### References\n\
  https://github.com/authelia/authelia/pull/1908\n\n[CWE-601](https://cwe.mitre.org/data/definitions/601.html)\n\
  \n[Authelia v4.28.0](https://github.com/authelia/authelia/tree/v4.28.0)\n\n### For more information\n\
  If you have any questions or comments about this advisory, please [contact us](https://github.com/authelia/authelia#contact-options).\
  \ You may also contact us to request creating a back-ported fix for this if you are able to\
  \ explain why you cannot upgrade; however upgrading is highly preferable."
impacted_packages: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-36f2-fcrx-fp4j/GHSA-36f2-fcrx-fp4j.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/authelia/authelia
    reference_type:
    reference_id:
  - url: https://github.com/authelia/authelia/security/advisories/GHSA-36f2-fcrx-fp4j
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29456
    reference_type:
    reference_id: CVE-2021-29456
