advisory_id: GHSA-h7cm-jvpp-69xf
datasource_id: github_osv_importer_v2/GHSA-h7cm-jvpp-69xf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-h7cm-jvpp-69xf/GHSA-h7cm-jvpp-69xf.json
aliases:
  - CVE-2024-35182
summary: |
  Meshery SQL Injection vulnerability
  Meshery is an open source, cloud native manager that enables the design and management of Kubernetes-based infrastructure and applications. A SQL injection vulnerability in Meshery prior to version 0.7.22 may lead to arbitrary file write by using a SQL injection stacked queries payload, and the ATTACH DATABASE command. Additionally, attackers may be able to access and modify any data stored in the database, like performance profiles (which may contain session cookies), Meshery application data, or any Kubernetes configuration added to the system. The Meshery project exposes the function `GetAllEvents` at the API URL `/api/v2/events`. The sort query parameter read in `events_streamer.go` is directly used to build a SQL query in `events_persister.go`. Version 0.7.22 fixes this issue by using the `SanitizeOrderInput` function.
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-h7cm-jvpp-69xf/GHSA-h7cm-jvpp-69xf.json
  - score: '6.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:L/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-h7cm-jvpp-69xf/GHSA-h7cm-jvpp-69xf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/layer5io/meshery
    reference_type:
    reference_id:
  - url: https://github.com/meshery/meshery/blob/b331f45c9083d7abf6b90105072b04cd22473de7/server/handlers/events_streamer.go#L52
    reference_type:
    reference_id:
  - url: https://github.com/meshery/meshery/blob/b331f45c9083d7abf6b90105072b04cd22473de7/server/models/events_persister.go#L47
    reference_type:
    reference_id:
  - url: https://github.com/meshery/meshery/commit/b55f6064d0c6a965aee38f30281f99da7dc4420c
    reference_type:
    reference_id:
  - url: https://github.com/meshery/meshery/pull/10280
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2024-013_GHSL-2024-014_Meshery
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35182
    reference_type:
    reference_id: CVE-2024-35182
