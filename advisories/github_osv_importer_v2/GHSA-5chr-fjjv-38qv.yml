advisory_id: GHSA-5chr-fjjv-38qv
datasource_id: github_osv_importer_v2/GHSA-5chr-fjjv-38qv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-5chr-fjjv-38qv/GHSA-5chr-fjjv-38qv.json
aliases:
  - CVE-2024-10940
summary: |
  langchain-core allows unauthorized users to read arbitrary files from the host file system
  A vulnerability in langchain-core versions >=0.1.17,<0.1.53, >=0.2.0,<0.2.43, and >=0.3.0,<0.3.15 allows unauthorized users to read arbitrary files from the host file system. The issue arises from the ability to create langchain_core.prompts.ImagePromptTemplate's (and by extension langchain_core.prompts.ChatPromptTemplate's) with input variables that can read any user-specified path from the server file system. If the outputs of these prompt templates are exposed to the user, either directly or through downstream model outputs, it can lead to the exposure of sensitive information.
impacted_packages:
  - purl: pkg:pypi/langchain-core
    affected_versions: vers:pypi/>=0.1.17|<0.1.53
    fixed_versions: vers:pypi/0.1.53
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/langchain-core
    affected_versions: vers:pypi/>=0.2.0|<0.2.43
    fixed_versions: vers:pypi/0.2.43
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/langchain-core
    affected_versions: vers:pypi/>=0.3.0|<0.3.15
    fixed_versions: vers:pypi/0.3.15
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-5chr-fjjv-38qv/GHSA-5chr-fjjv-38qv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-497
references:
  - url: https://github.com/langchain-ai/langchain
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchain/commit/7d481f10102f43559cc57bcad7eba291067939ee
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchain/commit/c1e742347f9701aadba8920e4d1f79a636e50b68
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchain/commit/e711034713259ae448981bc0fd1d7a5671499c31
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/be1ee1cb-2147-4ff4-a57b-b6045271cf27
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-10940
    reference_type:
    reference_id: CVE-2024-10940
