advisory_id: GHSA-m445-w3xr-vp2f
datasource_id: github_osv_importer_v2/GHSA-m445-w3xr-vp2f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-m445-w3xr-vp2f/GHSA-m445-w3xr-vp2f.json
aliases:
  - CVE-2024-41956
summary: |
  soft-serve vulnerable to arbitrary code execution by crafting git-lfs requests
  ### Impact
  Any servers using soft-serve server and git

  ### Patches
  >0.7.5

  ### Workarounds
  None.

  ### References
  n/a.

  ---

  It is possible for a user who can commit files to a repository hosted by Soft Serve to execute arbitrary code via environment manipulation and Git.

  The issue is that Soft Serve passes all environment variables given by the client to git subprocesses. This includes environment variables that control program execution, such as `LD_PRELOAD`.

  This can be exploited to execute arbitrary code by, for example, uploading a malicious shared object file to Soft Serve via Git LFS (uploading it via LFS ensures that it is not compressed on disk and easier to work with). The file will be stored under its SHA256 hash, so it has a predictable name.

  This file can then be referenced in `LD_PRELOAD` via a Soft Serve SSH session that causes git to be invoked. For example:

  ```bash
  LD_PRELOAD=/.../data/lfs/1/objects/a2/b5/a2b585befededf5f95363d06d83655229e393b1b45f76d9f989a336668665a2f ssh server git-upload-pack repo
  ```

  The example LFS file patches a shared library function called by git to execute a shell.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-m445-w3xr-vp2f/GHSA-m445-w3xr-vp2f.json
  - score: '8.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-m445-w3xr-vp2f/GHSA-m445-w3xr-vp2f.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/charmbracelet/soft-serve
    reference_type:
    reference_id:
  - url: https://github.com/charmbracelet/soft-serve/commit/4daebdd422a6ba8c04162d023f8be355a8fe3184
    reference_type:
    reference_id:
  - url: https://github.com/charmbracelet/soft-serve/security/advisories/GHSA-m445-w3xr-vp2f
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3019
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41956
    reference_type:
    reference_id: CVE-2024-41956
