advisory_id: GHSA-xmh9-rg6f-j3mr
datasource_id: github_osv_importer_v2/GHSA-xmh9-rg6f-j3mr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-xmh9-rg6f-j3mr/GHSA-xmh9-rg6f-j3mr.json
aliases: []
summary: "Verification flaw in Solid identity-token-verifier\n### Impact\n#### Severity\nAny\
  \ Pod on a Solid server using a vulnerable version of the identity-token-verifier library\
  \ is at risk of a spoofed Demonstration of Proof-of-Possession (DPoP) token binding. This\
  \ vulnerability could give total and complete access to a targeted Pod.\n\n#### Summary\n\
  A verification flaw in the implementation of the identity token verifier library (https://github.com/solid/identity-token-verifier)\
  \ allows DPoP proofs to be spoofed. \n\nDPoP proofs are used to bind access tokens to a private\
  \ key meant to be in sole possession of a specific user. Instead of verifying against the\
  \ hash of an embedded public key, the library instead verifies against a field that an attacker\
  \ can modify to spoof another userâ€™s DPoP. \n\nA stolen DPoP proof, when used in the right\
  \ context, therefore allows the rebinding of a DPoP-bound access token. Any attacker in possession\
  \ of a targeted access token could build an attack environment to replay it on any Pod service\
  \ with this vulnerability.  \n\n\n### Patches\nA new version 0.5.2 of identity-token-verifier\
  \ fixes the verification: https://github.com/solid/identity-token-verifier/blob/7e18d86d65ee681e8ae912b6a032a1bae3cae570/src/lib/DPoP.ts#L25-L35\n\
  \n### Workarounds\nNone\n\n### References\n_Are there any links users can visit to find out\
  \ more?_\n\n### For more information\nIf you have any questions or comments about this advisory:\n\
  * Open an issue in the [identity-token-verifier](https://github.com/solid/identity-token-verifier/)\
  \ repository.\n* Email: info@solidproject.org"
impacted_packages:
  - purl: pkg:npm/%40solid/identity-token-verifier
    affected_versions: vers:npm/<0.5.2
    fixed_versions: vers:npm/0.5.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-290
references:
  - url: https://github.com/solid/identity-token-verifier/commit/fbdeb4aa8c12694b3744cd0454acb826817d9e6c
    reference_type:
    reference_id:
  - url: https://github.com/solid/identity-token-verifier/releases/tag/0.5.2
    reference_type:
    reference_id:
  - url: https://github.com/solid/identity-token-verifier/security/advisories/GHSA-xmh9-rg6f-j3mr
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/@solid/identity-token-verifier
    reference_type:
    reference_id:
