advisory_id: GHSA-qwp8-x4ff-5h87
datasource_id: github_osv_importer_v2/GHSA-qwp8-x4ff-5h87
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/02/GHSA-qwp8-x4ff-5h87/GHSA-qwp8-x4ff-5h87.json
aliases:
  - CVE-2025-24959
summary: |
  ZX Allows Environment Variable Injection for dotenv API
  ### Impact
  This vulnerability is an **Environment Variable Injection** issue in `dotenv.stringify`, affecting `google/zx`  version **8.3.1**.

  An attacker with control over environment variable values can inject unintended environment variables into `process.env`. This can lead to **arbitrary command execution** or **unexpected behavior** in applications that rely on environment variables for security-sensitive operations. Applications that process untrusted input and pass it through `dotenv.stringify` are particularly vulnerable.

  ### Patches
  This issue has been **patched** in version **8.3.2**. Users should **immediately upgrade** to this version to mitigate the vulnerability.

  ### Workarounds
  If upgrading is not feasible, users can mitigate the vulnerability by **sanitizing user-controlled environment variable values** before passing them to `dotenv.stringify`. Specifically, avoid using `"`, `'`, and backticks in values, or enforce strict validation of environment variables before usage.

  ### References
  - [Issue Report](https://github.com/google/zx/issues/)
  - [Security Policy](https://github.com/google/zx/security/policy)
  - [Google Vulnerability Disclosure](https://g.co/vulnz)
  - [Patch](https://github.com/google/zx/pull/1094)
impacted_packages:
  - purl: pkg:npm/zx
    affected_versions: vers:npm/8.3.1
    fixed_versions: vers:npm/8.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/02/GHSA-qwp8-x4ff-5h87/GHSA-qwp8-x4ff-5h87.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-74
references:
  - url: https://github.com/google/zx
    reference_type:
    reference_id:
  - url: https://github.com/google/zx/commit/5ba714d14ecf0555a74d4db96622840ac19839c5
    reference_type:
    reference_id:
  - url: https://github.com/google/zx/pull/1094
    reference_type:
    reference_id:
  - url: https://github.com/google/zx/security/advisories/GHSA-qwp8-x4ff-5h87
    reference_type:
    reference_id:
  - url: https://github.com/webpod/envapi/blob/v0.2.1/src/main/ts/envapi.ts#L74-L77
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-24959
    reference_type:
    reference_id: CVE-2025-24959
