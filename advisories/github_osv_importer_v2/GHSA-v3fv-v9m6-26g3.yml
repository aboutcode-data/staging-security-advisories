advisory_id: GHSA-v3fv-v9m6-26g3
datasource_id: github_osv_importer_v2/GHSA-v3fv-v9m6-26g3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-v3fv-v9m6-26g3/GHSA-v3fv-v9m6-26g3.json
aliases:
  - CVE-2023-33001
summary: |
  Jenkins HashiCorp Vault Plugin has improper masking of credentials
  Jenkins HashiCorp Vault Plugin 360.v0a_1c04cf807d and earlier does not properly mask (i.e., replace with asterisks) credentials printed in the build log from Pipeline steps like `sh` and `bat`, when both of the following conditions are met:

  - The credentials are printed in build steps executing on an agent (typically inside a `node` block).

  - Push mode for durable task logging is enabled. This is a hidden option in Pipeline: Nodes and Processes that can be enabled through the Java system property `org.jenkinsci.plugins.workflow.steps.durable_task.DurableTaskStep.USE_WATCHING`. It is also automatically enabled by some plugins, e.g., OpenTelemetry and Pipeline Logging over CloudWatch.

  An improvement in Credentials Binding 523.525.vb_72269281873 implements a workaround that applies build log masking even in affected plugins. This workaround is temporary and potentially incomplete, so it is still recommended that affected plugins be updated to resolve this issue.

  As of publication of this advisory, there is no fix.
impacted_packages:
  - purl: pkg:maven/com.datapipe.jenkins.plugins/hashicorp-vault-plugin
    affected_versions: vers:maven/<=360.v0a
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-v3fv-v9m6-26g3/GHSA-v3fv-v9m6-26g3.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: https://www.jenkins.io/security/advisory/2023-05-16/#SECURITY-3077
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-33001
    reference_type:
    reference_id: CVE-2023-33001
