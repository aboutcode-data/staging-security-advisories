advisory_id: GHSA-fghv-69vj-qj49
datasource_id: github_osv_importer_v2/GHSA-fghv-69vj-qj49
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-fghv-69vj-qj49/GHSA-fghv-69vj-qj49.json
aliases:
  - CVE-2025-58056
summary: |
  Netty vulnerable to request smuggling due to incorrect parsing of chunk extensions
  ## Summary
  A flaw in netty's parsing of chunk extensions in HTTP/1.1 messages with chunked encoding can lead to request smuggling issues with some reverse proxies.

  ## Details
  When encountering a newline character (LF) while parsing a chunk extension, netty interprets the newline as the end of the chunk-size line regardless of whether a preceding carriage return (CR) was found. This is in violation of the HTTP 1.1 standard which specifies that the chunk extension is terminated by a CRLF sequence (see the [RFC](https://datatracker.ietf.org/doc/html/rfc9112#name-chunked-transfer-coding)).

  This is by itself harmless, but consider an intermediary with a similar parsing flaw: while parsing a chunk extension, the intermediary interprets an LF without a preceding CR as simply part of the chunk extension (this is also in violation of the RFC, because whitespace characters are not allowed in chunk extensions). We can use this discrepancy to construct an HTTP request that the intermediary will interpret as one request but netty will interpret as two (all lines ending with CRLF, notice the LFs in the chunk extension):

  ```
  POST /one HTTP/1.1
  Host: localhost:8080
  Transfer-Encoding: chunked

  48;\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n0

  POST /two HTTP/1.1
  Host: localhost:8080
  Transfer-Encoding: chunked

  0

  ```

  The intermediary will interpret this as a single request. Once forwarded to netty, netty will interpret it as two separate requests. This is a problem, because attackers can then the intermediary, as well as perform standard request smuggling attacks against other live users (see [this Portswigger article](https://portswigger.net/web-security/request-smuggling/exploiting)).

  ## Impact
  This is a request smuggling issue which can be exploited for bypassing front-end access control rules as well as corrupting the responses served to other live clients.

  The impact is high, but it only affects setups that use a front-end which:
  1. Interprets LF characters (without preceding CR) in chunk extensions as part of the chunk extension.
  2. Forwards chunk extensions without normalization.

  ## Disclosure

   - This vulnerability was disclosed on June 18th, 2025 here: https://w4ke.info/2025/06/18/funky-chunks.html

  ## Discussion
  Discussion for this vulnerability can be found here:
   - https://github.com/netty/netty/issues/15522
   - https://github.com/JLLeitschuh/unCVEed/issues/1

  ## Credit

   - Credit to @JeppW for uncovering this vulnerability.
   - Credit to @JLLeitschuh at [Socket](https://socket.dev/) for coordinating the vulnerability disclosure.
impacted_packages:
  - purl: pkg:maven/io.netty/netty-codec-http
    affected_versions: vers:maven/<4.1.125.Final
    fixed_versions: vers:maven/4.1.125.Final
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/io.netty/netty-codec-http
    affected_versions: vers:maven/>=4.2.0.Alpha1|<4.2.5.Final
    fixed_versions: vers:maven/4.2.5.Final
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-444
references:
  - url: https://datatracker.ietf.org/doc/html/rfc9112#name-chunked-transfer-coding
    reference_type:
    reference_id:
  - url: https://github.com/github/advisory-database/pull/6092
    reference_type:
    reference_id:
  - url: https://github.com/JLLeitschuh/unCVEed/issues/1
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty/commit/edb55fd8e0a3bcbd85881e423464f585183d1284
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty/issues/15522
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty/pull/15611
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty/security/advisories/GHSA-fghv-69vj-qj49
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-58056
    reference_type:
    reference_id:
  - url: https://w4ke.info/2025/06/18/funky-chunks.html
    reference_type:
    reference_id:
