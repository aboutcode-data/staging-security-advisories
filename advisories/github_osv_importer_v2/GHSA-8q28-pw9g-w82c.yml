advisory_id: GHSA-8q28-pw9g-w82c
datasource_id: github_osv_importer_v2/GHSA-8q28-pw9g-w82c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-8q28-pw9g-w82c/GHSA-8q28-pw9g-w82c.json
aliases:
  - CVE-2023-40195
summary: |
  Apache Airflow vulnerable arbitrary code execution via Spark server
  Deserialization of Untrusted Data, Inclusion of Functionality from Untrusted Control Sphere vulnerability in Apache Software Foundation Apache Airflow Spark Provider.

  When the Apache Spark provider is installed on an Airflow deployment, an Airflow user that is authorized to configure Spark hooks can effectively run arbitrary code on the Airflow node by pointing it at a malicious Spark server. Prior to version 4.1.3, this was not called out in the documentation explicitly, so it is possible that administrators provided authorizations to configure Spark hooks without taking this into account. We recommend administrators to review their configurations to make sure the authorization to configure Spark hooks is only provided to fully trusted users.

  To view the warning in the docs please visitÂ  https://airflow.apache.org/docs/apache-airflow-providers-apache-spark/4.1.3/connections/spark.html
impacted_packages:
  - purl: pkg:pypi/apache-airflow-providers-apache-spark
    affected_versions: vers:pypi/<4.1.3
    fixed_versions: vers:pypi/4.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-8q28-pw9g-w82c/GHSA-8q28-pw9g-w82c.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-8q28-pw9g-w82c/GHSA-8q28-pw9g-w82c.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/6850b5c777fa515e110ad1daa85242209a8ec6c0
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/pull/33233
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/apache-airflow-providers-apache-spark/PYSEC-2023-156.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/fzy95b1d6zv31j5wrx3znhzcscck2o24
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-40195
    reference_type:
    reference_id: CVE-2023-40195
