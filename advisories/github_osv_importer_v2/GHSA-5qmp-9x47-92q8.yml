advisory_id: GHSA-5qmp-9x47-92q8
datasource_id: github_osv_importer_v2/GHSA-5qmp-9x47-92q8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/02/GHSA-5qmp-9x47-92q8/GHSA-5qmp-9x47-92q8.json
aliases:
  - CVE-2025-23387
summary: "Rancher's SAML-based login via CLI can be denied by unauthenticated users\n### Impact\n\
  A vulnerability has been identified within Rancher where it is possible for an unauthenticated\
  \ user to list all CLI authentication tokens and delete them before the CLI is able to get\
  \ the token value. This effectively prevents users from logging in via the CLI when using\
  \ rancher token as the execution command (instead of the token directly being in the kubeconfig).\
  \ \n\nNote that this token is not the kubeconfig token and if an attacker is able to intercept\
  \ it they can't use it to impersonate a real user since it is encrypted.\n\nThis happens because\
  \ for SAML-based authentication providers, the login flow from the CLI works by generating\
  \ a link to be pasted in the browser, and then polling every 10 seconds for the `/v3-public/authTokens/<token\
  \ name>` endpoint.  The `<token name>` is randomly generated by the CLI. Once the login flow\
  \ succeeds, Rancher creates an auth token (with an encrypted token value). The CLI then deletes\
  \ the authToken.\n\n\nRancher deployments using only the local authentication provider, or\
  \ non-SAML-based authentication providers, are not impacted by this vulnerability. SAML-based\
  \ users not using the CLI are also not impacted.\n\n\nPlease consult the associated  [MITRE\
  \ ATT&CK - Technique - Account Access Removal](https://attack.mitre.org/techniques/T1531/)\
  \ for further information about this category of attack.\n\n### Patches\nThe fix involves\
  \ removing GET and DELETE methods for the authTokens collection.\n\nPatched versions include\
  \ releases `v2.8.13`, `v2.9.7` and `v2.10.3`.\n\n### Workarounds\nUsers can refrain from using\
  \ the Rancher CLI to log in as a workaround. Otherwise, users are advised to upgrade to a\
  \ patched version of Rancher Manager.\n\n### References\nIf you have any questions or comments\
  \ about this advisory:\n- Reach out to the [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy)\
  \ for security related inquiries.\n- Open an issue in the [Rancher](https://github.com/rancher/rancher/issues/new/choose)\
  \ repository.\n- Verify with our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/)\
  \ and [product support lifecycle](https://www.suse.com/lifecycle/)."
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/02/GHSA-5qmp-9x47-92q8/GHSA-5qmp-9x47-92q8.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-23387
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/commit/2481630c4a5a75d81eb69d10d7558ea833395a1e
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/commit/bedd911b9b321436faa2d9e20a161f6ac396aa74
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/commit/ceeedb1aa67c319f4873615f19c3f56a66f39706
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/commit/dfa034d05a55b5e57990a1f700176dcd8e963dbc
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/pull/48616
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/pull/48998
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/pull/48999
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/pull/49000
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/releases/tag/v2.10.3
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/releases/tag/v2.8.13
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/releases/tag/v2.9.7
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/security/advisories/GHSA-5qmp-9x47-92q8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23387
    reference_type:
    reference_id: CVE-2025-23387
