advisory_id: GHSA-6q78-6xvr-26fg
datasource_id: github_osv_importer_v2/GHSA-6q78-6xvr-26fg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-6q78-6xvr-26fg/GHSA-6q78-6xvr-26fg.json
aliases:
  - CVE-2019-1003001
summary: |
  Jenkins Groovy Plugin sandbox bypass vulnerability
  Jenkins Script Security sandbox protection could be circumvented during the script compilation phase by applying AST transforming annotations such as `@Grab` to source code elements.

  Both the pipeline validation REST APIs and actual script/pipeline execution are affected.

  This allowed users with Overall/Read permission, or able to control Jenkinsfile or sandboxed Pipeline shared library contents in SCM, to bypass the sandbox protection and execute arbitrary code on the Jenkins controller.

  All known unsafe AST transformations in Groovy are now prohibited in sandboxed scripts.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins.workflow/workflow-cps-parent
    affected_versions: vers:maven/<=2.61
    fixed_versions: vers:maven/2.61.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.plugins/pipeline-model-definition
    affected_versions: vers:maven/<=1.3.4
    fixed_versions: vers:maven/1.3.4.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.plugins/script-security
    affected_versions: vers:maven/<=1.49
    fixed_versions: vers:maven/1.50
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-6q78-6xvr-26fg/GHSA-6q78-6xvr-26fg.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: http://packetstormsecurity.com/files/152132/Jenkins-ACL-Bypass-Metaprogramming-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHBA-2019:0326
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHBA-2019:0327
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/pipeline-model-definition-plugin/commit/6d7884dec610bf34503d24d494d994e9fc607642
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/script-security-plugin/commit/2c5122e50742dd16492f9424992deb21cc07837c
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/workflow-cps-plugin/commit/66c3e7aafe7888d4e1fe9995a688bb3fb742d742
    reference_type:
    reference_id:
  - url: https://jenkins.io/security/advisory/2019-01-08/#SECURITY-1266
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/46572
    reference_type:
    reference_id:
  - url: http://www.rapid7.com/db/modules/exploit/multi/http/jenkins_metaprogramming
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-1003001
    reference_type:
    reference_id: CVE-2019-1003001
