advisory_id: GHSA-743r-5g92-5vgf
datasource_id: github_osv_importer_v2/GHSA-743r-5g92-5vgf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-743r-5g92-5vgf/GHSA-743r-5g92-5vgf.json
aliases:
  - CVE-2021-40829
summary: |
  Improper certificate management in AWS IoT Device SDK v2
  Connections initialized by the AWS IoT Device SDK v2 for Java (versions prior to 1.4.2), Python (versions prior to 1.6.1), C++ (versions prior to 1.12.7) and Node.js (versions prior to 1.5.3) did not verify server certificate hostname during TLS handshake when overriding Certificate Authorities (CA) in their trust stores on MacOS. This issue has been addressed in aws-c-io submodule versions 0.10.5 onward. This issue affects: Amazon Web Services AWS IoT Device SDK v2 for Java versions prior to 1.4.2 on macOS. Amazon Web Services AWS IoT Device SDK v2 for Python versions prior to 1.6.1 on macOS. Amazon Web Services AWS IoT Device SDK v2 for C++ versions prior to 1.12.7 on macOS. Amazon Web Services AWS IoT Device SDK v2 for Node.js versions prior to 1.5.3 on macOS. Amazon Web Services AWS-C-IO 0.10.4 on macOS.
impacted_packages:
  - purl: pkg:maven/software.amazon.awssdk.iotdevicesdk/aws-iot-device-sdk
    affected_versions: vers:maven/<1.4.2
    fixed_versions: vers:maven/1.4.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/aws-iot-device-sdk-v2
    affected_versions: vers:npm/<1.5.3
    fixed_versions: vers:npm/1.5.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/awsiotsdk
    affected_versions: vers:pypi/<1.6.1
    fixed_versions: vers:pypi/1.6.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-743r-5g92-5vgf/GHSA-743r-5g92-5vgf.json
  - score: '7.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-743r-5g92-5vgf/GHSA-743r-5g92-5vgf.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-295
references:
  - url: https://github.com/advisories/GHSA-743r-5g92-5vgf
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-cpp-v2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-java-v2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-java-v2/commits/v1.4.2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-js-v2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-python-v2
    reference_type:
    reference_id:
  - url: https://github.com/awslabs/aws-c-io
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/awsiotsdk/PYSEC-2021-862.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-40829
    reference_type:
    reference_id: CVE-2021-40829
