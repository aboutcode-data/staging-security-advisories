advisory_id: GHSA-7w2c-w47h-789w
datasource_id: github_osv_importer_v2/GHSA-7w2c-w47h-789w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-7w2c-w47h-789w/GHSA-7w2c-w47h-789w.json
aliases:
  - CVE-2023-34246
summary: |
  Doorkeeper Improper Authentication vulnerability
  OAuth RFC 8252 says  https://www.rfc-editor.org/rfc/rfc8252#section-8.6

  > the authorization server SHOULD NOT process authorization requests automatically without user consent or interaction, except when the identity of the client can be assured. **This includes the case where the user has previously approved an authorization request for a given client id**

  But Doorkeeper automatically processes authorization requests without user consent for public clients that have been previously approved. Public clients are inherently vulnerable to impersonation, their identity cannot be assured.

  Issue https://github.com/doorkeeper-gem/doorkeeper/issues/1589

  Fix https://github.com/doorkeeper-gem/doorkeeper/pull/1646
impacted_packages:
  - purl: pkg:gem/doorkeeper
    affected_versions: vers:gem/<5.6.6
    fixed_versions: vers:gem/5.6.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-7w2c-w47h-789w/GHSA-7w2c-w47h-789w.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/doorkeeper-gem/doorkeeper
    reference_type:
    reference_id:
  - url: https://github.com/doorkeeper-gem/doorkeeper/issues/1589
    reference_type:
    reference_id:
  - url: https://github.com/doorkeeper-gem/doorkeeper/pull/1646
    reference_type:
    reference_id:
  - url: https://github.com/doorkeeper-gem/doorkeeper/releases/tag/v5.6.6
    reference_type:
    reference_id:
  - url: https://github.com/doorkeeper-gem/doorkeeper/security/advisories/GHSA-7w2c-w47h-789w
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/doorkeeper/CVE-2023-34246.yml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/07/msg00016.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/12/msg00010.html
    reference_type:
    reference_id:
  - url: https://www.rfc-editor.org/rfc/rfc8252#section-8.6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34246
    reference_type:
    reference_id: CVE-2023-34246
