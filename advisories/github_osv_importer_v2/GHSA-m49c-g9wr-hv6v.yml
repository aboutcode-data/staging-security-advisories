advisory_id: GHSA-m49c-g9wr-hv6v
datasource_id: github_osv_importer_v2/GHSA-m49c-g9wr-hv6v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-m49c-g9wr-hv6v/GHSA-m49c-g9wr-hv6v.json
aliases:
  - CVE-2025-59340
summary: "jinjava has Sandbox Bypass via JavaType-Based Deserialization\n### Summary\n\njinjavaâ€™s\
  \ current sandbox restrictions prevent direct access to dangerous methods such as `getClass()`,\
  \ and block instantiation of Class objects. However, these protections can be bypassed.\n\n\
  By using mapper.getTypeFactory().constructFromCanonical(), it is possible to instruct the\
  \ underlying ObjectMapper to deserialize attacker-controlled input into arbitrary classes.\
  \ This enables the creation of semi-arbitrary class instances without directly invoking restricted\
  \ methods or class literals.\n\nAs a result, an attacker can escape the sandbox and instantiate\
  \ classes such as java.net.URL, opening up the ability to access local files and URLs(e.g.,\
  \ file:///etc/passwd). With further chaining, this primitive can potentially lead to remote\
  \ code execution (RCE).\n\n### Details\n\njinjava templates expose a built-in variable `____int3rpr3t3r____`,\
  \ which provides direct access to the jinjavaInterpreter instance.\nThis variable was previously\
  \ abused and protections were added to prevent call method from `JinjavaInterpreter` instances\
  \ (see [Add interpreter to blacklist](https://github.com/HubSpot/jinjava/commit/1b9aaa4b420c58b4a301cf4b7d26207f1c8d1165)).\n\
  However, interacting with the properties of `JinjavaInterpreter` instances remains [unrestricted](https://github.com/HubSpot/jinjava/blob/jinjava-2.8.0/src/main/java/com/hubspot/jinjava/el/ext/JinjavaBeanELResolver.java#L80-L84).\n\
  \nFrom `____int3rpr3t3r____`, it is possible to traverse to the `config` field, which exposes\
  \ an ObjectMapper. By invoking `readValue(String content, JavaType valueType)` on this ObjectMapper,\
  \ an attacker can instantiate arbitrary classes specified via `JavaType`.\n\nAlthough jinjava\
  \ explicitly restricts dangerous classes such as `Class`, `ClassLoader`, and so on inside\
  \ `JinjavaBeanELResolver`, the `JavaType` class itself is [not restricted](https://github.com/HubSpot/jinjava/blob/jinjava-2.8.0/src/main/java/com/hubspot/jinjava/el/ext/JinjavaBeanELResolver.java#L246-L262).\
  \ \n\nAs a result, an attacker can leverage `JavaType` construction (`constructFromCanonical`)\
  \ to instantiate semi-arbitrary classes without directly calling restricted methods.\n\nThis\
  \ allows sandbox escape and the creation of powerful primitives. \n\n### Impact\nEscape the\
  \ Jinjava sandbox and instantiate a wide range of classes using JavaType.\nThis capability\
  \ can be used to read arbitrary files and to perform full read SSRF by creating network-related\
  \ objects.\nIn certain environments, depending on the available classes, this primitive can\
  \ even lead to complete remote code execution."
impacted_packages:
  - purl: pkg:maven/com.hubspot.jinjava/jinjava
    affected_versions: vers:maven/2.8.0
    fixed_versions: vers:maven/2.8.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.hubspot.jinjava/jinjava
    affected_versions: vers:maven/<2.7.5
    fixed_versions: vers:maven/2.7.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-m49c-g9wr-hv6v/GHSA-m49c-g9wr-hv6v.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1336
references:
  - url: https://github.com/HubSpot/jinjava
    reference_type:
    reference_id:
  - url: https://github.com/HubSpot/jinjava/commit/66df351e7e8ad71ca04dcacb4b65782af820b8b1
    reference_type:
    reference_id:
  - url: https://github.com/HubSpot/jinjava/releases/tag/jinjava-2.7.5
    reference_type:
    reference_id:
  - url: https://github.com/HubSpot/jinjava/releases/tag/jinjava-2.8.1
    reference_type:
    reference_id:
  - url: https://github.com/HubSpot/jinjava/security/advisories/GHSA-m49c-g9wr-hv6v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59340
    reference_type:
    reference_id:
