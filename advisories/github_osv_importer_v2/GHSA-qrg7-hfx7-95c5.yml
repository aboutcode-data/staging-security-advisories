advisory_id: GHSA-qrg7-hfx7-95c5
datasource_id: github_osv_importer_v2/GHSA-qrg7-hfx7-95c5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-qrg7-hfx7-95c5/GHSA-qrg7-hfx7-95c5.json
aliases:
  - CVE-2022-31249
summary: |
  Command injection in Git package in Wrangler
  ### Impact

  A command injection vulnerability was discovered in Wrangler's Git package affecting versions up to and including `v1.0.0`.

  Wrangler's Git package uses the underlying Git binary present in the host OS or container image to execute Git operations. Specially crafted commands can be passed to Wrangler that will change their behavior and cause confusion when executed through Git, resulting in command injection in the underlying host.

  ### Workarounds

  A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.

  ### Patches

  Patched versions include `v1.0.1` and later and the backported tags - `v0.7.4-security1`, `v0.8.5-security1` and `v0.8.11`.

  ### For more information

  If you have any questions or comments about this advisory:

  * Reach out to [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy) for security related inquiries.
  * Open an issue in [Rancher](https://github.com/rancher/rancher/issues/new/choose) or [Wrangler](https://github.com/rancher/wrangler/issues/new) repository.
  * Verify our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/) and [product support lifecycle](https://www.suse.com/lifecycle/).
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-qrg7-hfx7-95c5/GHSA-qrg7-hfx7-95c5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
  - CWE-88
  - CWE-78
references:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=1200299
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-qrg7-hfx7-95c5
    reference_type:
    reference_id:
  - url: https://github.com/rancher/wrangler
    reference_type:
    reference_id:
  - url: https://github.com/rancher/wrangler/commit/12397eec50155cb2d24aa70bdf9e90c5f3b9a727
    reference_type:
    reference_id:
  - url: https://github.com/rancher/wrangler/commit/341018c8fef3e12867c7cb2649bd2cecac75f287
    reference_type:
    reference_id:
  - url: https://github.com/rancher/wrangler/commit/5a387e13e8d51e3340d9e5012a1951f0cca5fc90
    reference_type:
    reference_id:
  - url: https://github.com/rancher/wrangler/commit/8649ecc062204f28764fd80157a621cbae89c9cf
    reference_type:
    reference_id:
  - url: https://github.com/rancher/wrangler/compare/v0.7.2...v0.7.4-security1
    reference_type:
    reference_id:
  - url: https://github.com/rancher/wrangler/compare/v0.8.4...v0.8.5-security1
    reference_type:
    reference_id:
  - url: https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2023-1519
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31249
    reference_type:
    reference_id: CVE-2022-31249
