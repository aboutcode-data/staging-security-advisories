advisory_id: GHSA-jw37-5gqr-cf9j
datasource_id: github_osv_importer_v2/GHSA-jw37-5gqr-cf9j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/08/GHSA-jw37-5gqr-cf9j/GHSA-jw37-5gqr-cf9j.json
aliases:
  - CVE-2020-15152
summary: |
  Server-Side Request Forgery in ftp-srv
  ### Background

  The FTP protocol creates two connections, one for commands and one for transferring data.
  This second data connection can be created in two ways, on the server by sending the PASV command, or on the client by sending the PORT command.

  The PORT command sends the IP and port for the server to connect to the client with.

  ### Issue
  Since the client can send an arbitrary IP with the PORT command, this can be used to cause the server to make a connection elsewhere.

  ### Patches

  * _fix: disallow PORT connections to alternate hosts_: e449e75219d918c400dec65b4b0759f60476abca

  Deprecation notices have been published for older versions.

  ### Workarounds

  Blacklisting the FTP Command `PORT` will prevent the server from exposing this behaviour through active connections until a fix is applied.
  ```js
  const ftp = new FtpSrv({
    blacklist: ['PORT']
  });
  ```

  ### References
  https://www.npmjs.com/advisories/1445

  ### Credits

  Thank you to;
  @trs for fixing it
  @andreeleuterio for reporting it to us for an anonymous user (Vincent) through the NPM platform
  @quiquelhappy for bringing it to our attention after it slipped through the cracks during Christmas

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue at [https://github.com/autovance/ftp-srv](https://github.com/autovance/ftp-srv)
  * Email us directly; security@autovance.com
impacted_packages:
  - purl: pkg:npm/ftp-srv
    affected_versions: vers:npm/>=1.0.0|<2.19.6
    fixed_versions: vers:npm/2.19.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/ftp-srv
    affected_versions: vers:npm/>=3.0.0|<3.1.2
    fixed_versions: vers:npm/3.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/ftp-srv
    affected_versions: vers:npm/>=4.0.0|<4.3.4
    fixed_versions: vers:npm/4.3.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/08/GHSA-jw37-5gqr-cf9j/GHSA-jw37-5gqr-cf9j.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/autovance/ftp-srv/commit/5508c2346cf23b24c20070ff2e8a47c647d3d5b5
    reference_type:
    reference_id:
  - url: https://github.com/autovance/ftp-srv/commit/e449e75219d918c400dec65b4b0759f60476abca
    reference_type:
    reference_id:
  - url: https://github.com/autovance/ftp-srv/commit/fb32b012c3baf48ee804e1dc36544cbba70b00d3
    reference_type:
    reference_id:
  - url: https://github.com/autovance/ftp-srv/security/advisories/GHSA-jw37-5gqr-cf9j
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1445
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/ftp-srv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15152
    reference_type:
    reference_id: CVE-2020-15152
