advisory_id: GHSA-7498-c9fm-g64p
datasource_id: github_osv_importer_v2/GHSA-7498-c9fm-g64p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7498-c9fm-g64p/GHSA-7498-c9fm-g64p.json
aliases:
  - CVE-2019-17109
summary: |
  koji hub allows arbitrary upload destinations
  The way that the hub code validates upload paths allows for an attacker to choose an arbitrary destination for the uploaded file.
  Uploading still requires login. However, an attacker with credentials could damage the integrity of the Koji system.

  ### Workaround
  There is no known workaround. All Koji admins are encouraged to update to a fixed version as soon as possible.

  ### Fix
  Koji versions 1.14.3, 1.15.3, 1.16.3, 1.17.1, and 1.18.1 all include patches to solve this vulnerability.
impacted_packages:
  - purl: pkg:pypi/koji
    affected_versions: vers:pypi/>=1.14.0|<1.14.3
    fixed_versions: vers:pypi/1.14.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/koji
    affected_versions: vers:pypi/>=1.15.0|<1.15.3
    fixed_versions: vers:pypi/1.15.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/koji
    affected_versions: vers:pypi/>=1.16.0|<1.16.3
    fixed_versions: vers:pypi/1.16.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/koji
    affected_versions: vers:pypi/>=1.17.0|<1.17.1
    fixed_versions: vers:pypi/1.17.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/koji
    affected_versions: vers:pypi/>=1.18.0|<1.18.1
    fixed_versions: vers:pypi/1.18.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7498-c9fm-g64p/GHSA-7498-c9fm-g64p.json
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7498-c9fm-g64p/GHSA-7498-c9fm-g64p.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://docs.pagure.org/koji/CVE-2019-17109
    reference_type:
    reference_id:
  - url: https://github.com/koji-project/koji
    reference_type:
    reference_id:
  - url: https://github.com/koji-project/koji/blob/d0507c4d2d2269daa984db642e3bd957dff18948/docs/source/CVEs/CVE-2019-17109.rst
    reference_type:
    reference_id:
  - url: https://github.com/koji-project/koji/commit/91d6f0b607c7f5af666dfb56931f1db4e38c28a5
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/koji/PYSEC-2019-183.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4BGUXMZIAQFFNNQ7PEFDAYQCXXKJR76U
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7PSCCFHLNVFLDPC7DB4UJGXD6ZWBSY57
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DEQYYGWLJBQQVTAC7E7XSDGVF27NPMPB
    reference_type:
    reference_id:
  - url: https://pagure.io/koji/commits/master
    reference_type:
    reference_id:
  - url: https://pagure.io/koji/issue/1634
    reference_type:
    reference_id:
  - url: https://pagure.io/koji/pull-request/1686
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2019/10/09/5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-17109
    reference_type:
    reference_id: CVE-2019-17109
