advisory_id: GHSA-gggm-66rh-pp98
datasource_id: github_osv_importer_v2/GHSA-gggm-66rh-pp98
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-gggm-66rh-pp98/GHSA-gggm-66rh-pp98.json
aliases:
  - CVE-2023-38503
summary: |
  Incorrect Permission Checking for GraphQL Subscriptions
  ### Summary

  CWE-200: Exposure of Sensitive Information to an Unauthorized Actor
  Access to information you should not have access to when the permissions rely on `$CURRENT_USER` for filtering.

  ### Details

  The permission filters (i.e. `user_created IS $CURRENT_USER`) are not properly checked when using GraphQL subscription resulting in unauthorized users getting event on their subscription which they should not be receiving according to the permissions.
  This can be any collection but out-of-the box the `directus_users` collection is configured with such a permissions filter allowing you to get updates for other users when changes happen.

  An example:
  ```graphql
  subscription {
    directus_users_mutated {
      event
      data {
        id
        last_access
        last_page
      }
    }
  }
  ```

  ### Patches
  https://github.com/directus/directus/pull/19155

  ### Workarounds
  Disable GraphQL Subscriptions

  ### References
impacted_packages:
  - purl: pkg:npm/directus
    affected_versions: vers:npm/>=10.3.0|<10.5.0
    fixed_versions: vers:npm/10.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-gggm-66rh-pp98/GHSA-gggm-66rh-pp98.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-863
references:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/pull/19155
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-gggm-66rh-pp98
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38503
    reference_type:
    reference_id: CVE-2023-38503
