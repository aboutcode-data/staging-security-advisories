advisory_id: GHSA-3vhc-576x-3qv4
datasource_id: github_osv_importer_v2/GHSA-3vhc-576x-3qv4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-3vhc-576x-3qv4/GHSA-3vhc-576x-3qv4.json
aliases:
  - CVE-2026-22818
summary: |
  Hono JWK Auth Middleware has JWT algorithm confusion when JWK lacks "alg" (untrusted header.alg fallback)
  ## Summary

  A flaw in Hono’s JWK/JWKS JWT verification middleware allowed the algorithm specified in the JWT header to influence signature verification when the selected JWK did not explicitly define an algorithm. This could enable JWT algorithm confusion and, in certain configurations, allow forged tokens to be accepted.

  ## Details

  When verifying JWTs using JWKs or a JWKS endpoint, the middleware selected the verification algorithm based on the JWK’s `alg` field if present. If the JWK did not specify an algorithm, the middleware fell back to using the `alg` value provided in the unverified JWT header.

  Because the `alg` field in a JWK is optional and commonly omitted in real-world JWKS configurations, this behavior could allow an attacker to influence which algorithm is used for verification. In some environments, this may result in authentication or authorization bypass through crafted JWTs.

  The practical impact depends on application configuration, including which algorithms are accepted and how JWTs are used to make authorization decisions.

  ## Impact

  In affected configurations, an attacker may be able to forge JWTs with attacker-controlled claims, potentially leading to authentication or authorization bypass.

  Applications that do not use the JWK/JWKS middleware, do not rely on JWT-based authentication, or explicitly restrict allowed algorithms are not affected.

  ## Resolution

  Update to the latest patched release.

  **Breaking change:**

  The JWK/JWKS JWT verification middleware has been updated to require an explicit allowlist of asymmetric algorithms when verifying tokens. The middleware no longer derives the verification algorithm from untrusted JWT header values.

  Instead, callers must explicitly specify which asymmetric algorithms are permitted, and only tokens signed with those algorithms will be accepted. This prevents JWT algorithm confusion by ensuring that algorithm selection is fully controlled by application
  configuration.

  As part of this fix, the `alg` option is now required when using the JWK/JWKS middleware, and symmetric (HS*) algorithms are no longer accepted in this context.

  ### Before (vulnerable configuration)

  ```ts
  import { jwk } from 'hono/jwk'

  app.use(
    '/auth/*',
    jwk({
      jwks_uri: 'https://example.com/.well-known/jwks.json',
      // alg was optional
    })
  )
  ```

  ### After (patched configuration)

  ```ts
  import { jwk } from 'hono/jwk'

  app.use(
    '/auth/*',
    jwk({
      jwks_uri: 'https://example.com/.well-known/jwks.json',
      alg: ['RS256'], // required: explicit asymmetric algorithm allowlist
    })
  )
  ```
impacted_packages:
  - purl: pkg:npm/hono
    affected_versions: vers:npm/<4.11.4
    fixed_versions: vers:npm/4.11.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-3vhc-576x-3qv4/GHSA-3vhc-576x-3qv4.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-347
references:
  - url: https://github.com/honojs/hono
    reference_type:
    reference_id:
  - url: https://github.com/honojs/hono/commit/190f6e28e2ca85ce3d1f2f54db1310f5f3eab134
    reference_type:
    reference_id:
  - url: https://github.com/honojs/hono/security/advisories/GHSA-3vhc-576x-3qv4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22818
    reference_type:
    reference_id:
