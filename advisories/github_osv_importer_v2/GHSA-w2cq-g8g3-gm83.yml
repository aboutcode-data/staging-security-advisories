advisory_id: GHSA-w2cq-g8g3-gm83
datasource_id: github_osv_importer_v2/GHSA-w2cq-g8g3-gm83
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-w2cq-g8g3-gm83/GHSA-w2cq-g8g3-gm83.json
aliases:
  - CVE-2025-55164
summary: |
  content-security-policy-parser Prototype Pollution Vulnerability May Lead to RCE
  ### Impact
  A prototype pollution vulnerability exists in versions 0.5.0 and earlier, wherein if you provide a policy name called `__proto__` you can override the Object prototype.

  For example:

  ```
  const parse = require('content-security-policy-parser');

  const x = parse("default-src 'self'; __proto__ foobar");
  console.log('raw print:', x);
  console.log('toString:', x.toString());
  ```

  Outputs:

  ```
  raw print: Array { 'default-src': [ "'self'" ] }
  toString: foobar
  ```

  Whilst no gadget exists in this library, it is possible via other libraries expose functionality that enable RCE. It is customary to label prototype pollution vulnerabilities in this way. The most common effect of this is denial of service, as you can trivially overwrite properties.

  As the content security policy is provided in HTTP queries, it is incredibly likely that network exploitation is possible.

  ### Patches
  There has been a patch implemented a year ago (11 Feb 2024), but low uptake of patched versions has not been observed in the wild - only 17% of weekly downloads are of patched versions.

  ### Workarounds
  By disabling prototype method in NodeJS you can neutralise all possible prototype pollution attacks. Provide either `--disable-proto=delete` (recommended) or `--disable-proto=throw` as an argument to `node` to enable this feature.

  ### References
  [Issue revealing the problem, January 26 2024](https://github.com/helmetjs/content-security-policy-parser/issues/11)
  [Commit fixing the problem](https://github.com/helmetjs/content-security-policy-parser/commit/b13a52554f0168af393e3e38ed4a94e9e6aea9dc)

  Credit to @EvanHahn for patching the vulnerability promptly, and @pnappa (Patrick Nappa) for discovery.
impacted_packages:
  - purl: pkg:npm/content-security-policy-parser
    affected_versions: vers:npm/<0.6.0
    fixed_versions: vers:npm/0.6.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-w2cq-g8g3-gm83/GHSA-w2cq-g8g3-gm83.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1321
references:
  - url: https://github.com/helmetjs/content-security-policy-parser
    reference_type:
    reference_id:
  - url: https://github.com/helmetjs/content-security-policy-parser/commit/b13a52554f0168af393e3e38ed4a94e9e6aea9dc
    reference_type:
    reference_id:
  - url: https://github.com/helmetjs/content-security-policy-parser/issues/11
    reference_type:
    reference_id:
  - url: https://github.com/helmetjs/content-security-policy-parser/security/advisories/GHSA-w2cq-g8g3-gm83
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-55164
    reference_type:
    reference_id: CVE-2025-55164
