advisory_id: GHSA-rh87-q4vg-m45j
datasource_id: github_osv_importer_v2/GHSA-rh87-q4vg-m45j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-rh87-q4vg-m45j/GHSA-rh87-q4vg-m45j.json
aliases:
  - CVE-2022-36015
summary: |
  TensorFlow vulnerable to integer overflow in math ops
  ### Impact
  When [`RangeSize`](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/ops/math_ops.cc) receives values that do not fit into an `int64_t`, it crashes.
  ```cpp
    auto size = (std::is_integral<T>::value
                     ? ((Eigen::numext::abs(limit - start) +
                         Eigen::numext::abs(delta) - T(1)) /
                        Eigen::numext::abs(delta))
                     : (Eigen::numext::ceil(
                           Eigen::numext::abs((limit - start) / delta))));

    // This check does not cover all cases.
    if (size > std::numeric_limits<int64_t>::max()) {
      return errors::InvalidArgument("Requires ((limit - start) / delta) <= ",
                                     std::numeric_limits<int64_t>::max());
    }

    c->set_output(0, c->Vector(static_cast<int64_t>(size)));
    return Status::OK();
  }
  ```

  ### Patches
  We have patched the issue in GitHub commit [37e64539cd29fcfb814c4451152a60f5d107b0f0](https://github.com/tensorflow/tensorflow/commit/37e64539cd29fcfb814c4451152a60f5d107b0f0).
  The fix will be included in TensorFlow 2.10.0. We will also cherrypick this commit on TensorFlow 2.9.1, TensorFlow 2.8.1, and TensorFlow 2.7.2, as these are also affected and still in supported range.


  ### For more information
  Please consult [our security guide](https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/<2.7.2
    fixed_versions: vers:pypi/2.7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/>=2.8.0|<2.8.1
    fixed_versions: vers:pypi/2.8.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/>=2.9.0|<2.9.1
    fixed_versions: vers:pypi/2.9.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/<2.7.2
    fixed_versions: vers:pypi/2.7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/>=2.8.0|<2.8.1
    fixed_versions: vers:pypi/2.8.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/>=2.9.0|<2.9.1
    fixed_versions: vers:pypi/2.9.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/<2.7.2
    fixed_versions: vers:pypi/2.7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/>=2.8.0|<2.8.1
    fixed_versions: vers:pypi/2.8.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/>=2.9.0|<2.9.1
    fixed_versions: vers:pypi/2.9.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-190
references:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/ops/math_ops.cc
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/37e64539cd29fcfb814c4451152a60f5d107b0f0
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/releases/tag/v2.10.0
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-rh87-q4vg-m45j
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-36015
    reference_type:
    reference_id: CVE-2022-36015
