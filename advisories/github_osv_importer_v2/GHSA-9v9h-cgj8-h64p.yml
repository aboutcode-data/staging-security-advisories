advisory_id: GHSA-9v9h-cgj8-h64p
datasource_id: github_osv_importer_v2/GHSA-9v9h-cgj8-h64p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-9v9h-cgj8-h64p/GHSA-9v9h-cgj8-h64p.json
aliases:
  - CVE-2024-0727
summary: |
  Null pointer dereference in PKCS12 parsing
  Issue summary: Processing a maliciously formatted PKCS12 file may lead OpenSSL
  to crash leading to a potential Denial of Service attack

  Impact summary: Applications loading files in the PKCS12 format from untrusted
  sources might terminate abruptly.

  A file in PKCS12 format can contain certificates and keys and may come from an
  untrusted source. The PKCS12 specification allows certain fields to be NULL, but
  OpenSSL does not correctly check for this case. This can lead to a NULL pointer
  dereference that results in OpenSSL crashing. If an application processes PKCS12
  files from an untrusted source using the OpenSSL APIs then that application will
  be vulnerable to this issue.

  OpenSSL APIs that are vulnerable to this are: PKCS12_parse(),
  PKCS12_unpack_p7data(), PKCS12_unpack_p7encdata(), PKCS12_unpack_authsafes()
  and PKCS12_newpass().

  We have also fixed a similar issue in SMIME_write_PKCS7(). However since this
  function is related to writing data we do not consider it security significant.

  The FIPS modules in 3.2, 3.1 and 3.0 are not affected by this issue.
impacted_packages:
  - purl: pkg:pypi/cryptography
    affected_versions: vers:pypi/<42.0.2
    fixed_versions: vers:pypi/42.0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-9v9h-cgj8-h64p/GHSA-9v9h-cgj8-h64p.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-476
references:
  - url: https://github.com/alexcrichton/openssl-src-rs/commit/add20f73b6b42be7451af2e1044d4e0e778992b2
    reference_type:
    reference_id:
  - url: https://github.com/github/advisory-database/pull/3472
    reference_type:
    reference_id:
  - url: https://github.com/openssl/openssl/pull/23362
    reference_type:
    reference_id:
  - url: https://github.com/pyca/cryptography/commit/3519591d255d4506fbcd0d04037d45271903c64d
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/10/msg00033.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/11/msg00000.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240208-0006
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/03/11/1
    reference_type:
    reference_id:
  - url: https://github.openssl.org/openssl/extended-releases/commit/aebaa5883e31122b404e450732dc833dc9dee539
    reference_type: commit
    reference_id: 1.0.2zj git commit
  - url: https://github.openssl.org/openssl/extended-releases/commit/03b3941d60c4bce58fab69a0c22377ab439bc0e8
    reference_type: commit
    reference_id: 1.1.1x git commit
  - url: https://github.com/openssl/openssl/commit/09df4395b5071217b76dc7d3d2e630eb8c5a79c2
    reference_type: commit
    reference_id: 3.0.13 git commit
  - url: https://github.com/openssl/openssl/commit/d135eeab8a5dbf72b3da5240bab9ddb7678dbd2c
    reference_type: commit
    reference_id: 3.1.5 git commit
  - url: https://github.com/openssl/openssl/commit/775acfdbd0c6af9ac855f34969cdab0c0c90844a
    reference_type: commit
    reference_id: 3.2.1 git commit
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-0727
    reference_type:
    reference_id: CVE-2024-0727
  - url: https://www.openssl.org/news/secadv/20240125.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
