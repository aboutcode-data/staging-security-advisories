advisory_id: GHSA-jrh7-mhhx-6h88
datasource_id: github_osv_importer_v2/GHSA-jrh7-mhhx-6h88
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-jrh7-mhhx-6h88/GHSA-jrh7-mhhx-6h88.json
aliases:
  - CVE-2021-21393
summary: |
  Denial of service (via resource exhaustion) due to improper input validation on groups/communities endpoints
  ### Impact
  Missing input validation of some parameters on the groups (also known as communities) endpoints could cause excessive use of disk space and memory leading to resource exhaustion. Additionally clients may have issues rendering large fields.

  ### Patches
  This issue is fixed by #9321 and #9393.

  ### Workarounds
  The groups feature can be disabled (by setting `enable_group_creation` to `False`) to mitigate this issue. Note that it is disabled by default.

  ### Other information
  Note that the groups feature is not part of the [Matrix specification](https://matrix.org/docs/spec/) and the chosen maximum lengths are arbitrary. Not all clients might abide by them.
impacted_packages:
  - purl: pkg:pypi/matrix-synapse
    affected_versions: vers:pypi/<1.28.0
    fixed_versions: vers:pypi/1.28.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-jrh7-mhhx-6h88/GHSA-jrh7-mhhx-6h88.json
  - score: '6.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-jrh7-mhhx-6h88/GHSA-jrh7-mhhx-6h88.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/3f58fc848d0002de4605bed91603a1f9f245d128
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/d2f0ec12d5c8f113095408888e87e191ac546499
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/pull/9321
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/pull/9393
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-jrh7-mhhx-6h88
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-26.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY
    reference_type:
    reference_id:
  - url: https://pypi.org/project/matrix-synapse
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21393
    reference_type:
    reference_id: CVE-2021-21393
