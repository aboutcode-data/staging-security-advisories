advisory_id: GHSA-wcx9-ccpj-hx3c
datasource_id: github_osv_importer_v2/GHSA-wcx9-ccpj-hx3c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-wcx9-ccpj-hx3c/GHSA-wcx9-ccpj-hx3c.json
aliases: []
summary: |
  Coder vulnerable to post-auth URL redirection to untrusted site ('Open Redirect')
  ### Summary
  An issue on Coder's login page allows attackers to craft a Coder URL that when clicked by a logged in user could redirect them to a website the attacker controls, e.g. https://google.com.

  ### Details
  On the login page, Coder checks for the presence of a `redirect` query parameter. On successful login, the user would be redirected to the location of the parameter. Improper sanitization allows attackers to specify a URL outside of the Coder application to redirect users to.

  ### Impact
  Coder users could potentially be redirected to a untrusted website if tricked into clicking a URL crafted by the attacker. Coder authentication tokens are **not** leaked to the resulting website.

  To check if your deployment is vulnerable, visit the following URL for your Coder deployment:
  - `https://<coder url>/login?redirect=https%3A%2F%2Fcoder.com%2Fdocs`

  ### Patched Versions
  This vulnerability is remedied in
  - v2.16.1
  - v2.15.3
  - v2.14.4

  All versions prior to 2.3.1 are not affected.

  ### Thanks
  - https://github.com/jchristov

  ### References
  https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c
  https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-wcx9-ccpj-hx3c/GHSA-wcx9-ccpj-hx3c.json
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:A/AC:L/AT:N/PR:N/UI:P/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-wcx9-ccpj-hx3c/GHSA-wcx9-ccpj-hx3c.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/coder/coder
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c
    reference_type:
    reference_id:
