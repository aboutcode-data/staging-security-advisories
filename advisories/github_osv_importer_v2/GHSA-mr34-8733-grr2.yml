advisory_id: GHSA-mr34-8733-grr2
datasource_id: github_osv_importer_v2/GHSA-mr34-8733-grr2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-mr34-8733-grr2/GHSA-mr34-8733-grr2.json
aliases:
  - CVE-2024-21635
summary: "Memos' Access Tokens Stay Valid after User Password Change\n### Summary\nAccess Tokens\
  \ are used to authenticate application access. When a user changes their password, the existing\
  \ list of Access Tokens stay valid instead of expiring. If a user finds that their account\
  \ has been compromised, they can update their password. \n\nThe bad actor though will still\
  \ have access to their account because the bad actor's Access Token stays on the list as a\
  \ valid token. The user will have to manually delete the bad actor's Access Token to secure\
  \ their account. The list of Access Tokens has a generic Description which makes it hard to\
  \ pinpoint a bad actor in a list of Access Tokens. \n\n### Details\n\nTo improve Memos security,\
  \ all Access Tokens will need to be revoked when a user changes their password. This removes\
  \ the session for all the user's devices and prompts the user to log in again. You can treat\
  \ the old Access Tokens as \"invalid\" because those Access Tokens were created with the older\
  \ password.\n\n### PoC\n\n1. Have 2 devices on hand\n2. Log onto your Memos account on both\
  \ devices. Notice how Access Tokens are created for each.\n3. On one device, successfully\
  \ change the password. Refresh the page on the 2nd device and notice how it doesn't log out\
  \ the user.\n4. On the 2nd device, change the password again. Refresh the page on the 1st\
  \ device and notice how it doesn't log out the user.\n\n### Impact\n\nA bad actor will still\
  \ have access to the user's account because the Access Token does not expire on a password\
  \ update. Having multi-factor authentication will vastly improve account security in Account\
  \ Takeover cases instead of just relying on a password."
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-mr34-8733-grr2/GHSA-mr34-8733-grr2.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: http://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures
    reference_type:
    reference_id:
  - url: https://github.com/usememos/memos
    reference_type:
    reference_id:
  - url: https://github.com/usememos/memos/security/advisories/GHSA-mr34-8733-grr2
    reference_type:
    reference_id:
  - url: https://owasp.org/Top10/A04_2021-Insecure_Design
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-21635
    reference_type:
    reference_id: CVE-2024-21635
