advisory_id: GHSA-38r5-34mr-mvm7
datasource_id: github_osv_importer_v2/GHSA-38r5-34mr-mvm7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-38r5-34mr-mvm7/GHSA-38r5-34mr-mvm7.json
aliases:
  - CVE-2020-29662
summary: |
  "catalog's registry v2 api exposed on unauthenticated path in Harbor"
  ### **Impact**
  Javier Provecho, member of the TCCT (Telefonica Cloud & Cybersecurity Tech better known as ElevenPaths) SRE team discovered a vulnerability regarding Harbor’s v2 API.

  The catalog’s registry v2 api is exposed on an unauthenticated path. The current catalog API path is served at the following path and it requires to be authenticated as an admin.

  "GET /v2/_catalog"

  However, the authorization can be bypassed by using the following path

  "GET /v2/_catalog/"

  ### **Patches**
  If your product uses the affected releases of Harbor, update to either version v2.1.2 or v2.0.5 to fix this issue immediately

  https://github.com/goharbor/harbor/releases/tag/v2.1.2
  https://github.com/goharbor/harbor/releases/tag/v2.0.5

  ### **Workarounds**
  If you cannot access a patched release, it can be mitigated by disabling that API. For example, redirecting it to a 404 sink hole in the ingress.

  ### **For more information**
  If you have any questions or comments about this advisory, contact cncf-harbor-security@lists.cncf.io
  View our security policy at https://github.com/goharbor/harbor/security/policy
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-29662
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-38r5-34mr-mvm7/GHSA-38r5-34mr-mvm7.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-319
  - CWE-287
references:
  - url: https://github.com/goharbor/harbor/commit/3481722f140e1fdf6e6d290b0cd5c86e509feed4
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/commit/c7c409a8e5a8b3fd42841dda84759c9d77977853
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/pull/13676
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/releases/tag/v2.0.5
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/releases/tag/v2.1.2
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/security/advisories/GHSA-38r5-34mr-mvm7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-29662
    reference_type:
    reference_id: CVE-2020-29662
