advisory_id: GHSA-jpgw-2r9m-8qfw
datasource_id: github_osv_importer_v2/GHSA-jpgw-2r9m-8qfw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-jpgw-2r9m-8qfw/GHSA-jpgw-2r9m-8qfw.json
aliases:
  - CVE-2023-36809
summary: "Kiwi TCMS's misconfigured HTTP headers allow stored XSS execution with Firefox\n###\
  \ Impact\n\nKiwi TCMS allows users to upload attachments to test plans, test cases, etc. Earlier\
  \ versions of Kiwi TCMS had introduced\nchanges which were meant to serve all uploaded files\
  \ as plain text in order to prevent browsers from executing potentially dangerous files when\
  \ such files are accessed directly! \n\nThe previous Nginx configuration was incorrect allowing\
  \ certain browsers like Firefox to ignore the `Content-Type: text/plain` header on some occasions\
  \ thus allowing potentially dangerous scripts to be executed. \n\nAdditionally file upload\
  \ validators and parts of the HTML rendering code have been found to require additional sanitation\
  \ and improvements.\n\n### Patches\n\n- Updated Nginx content type configuration\n- Improved\
  \ file upload validation code to prevent more potentially dangerous uploads\n- Sanitization\
  \ of test plan names used in the `tree_view_html()` function\n\n### References\n\nDisclosed\
  \ by [M Nadeem Qazi](https://huntr.dev/bounties/511489dd-ba38-4806-9029-b28ab2830aa8/) and\n\
  [Mahshooq Zubair](https://huntr.dev/bounties/c6eeb346-fa99-4d41-bc40-b68f8d689223/)."
impacted_packages:
  - purl: pkg:pypi/kiwitcms
    affected_versions: vers:pypi/<12.5
    fixed_versions: vers:pypi/12.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-jpgw-2r9m-8qfw/GHSA-jpgw-2r9m-8qfw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
  - CWE-79
references:
  - url: https://github.com/kiwitcms/Kiwi
    reference_type:
    reference_id:
  - url: https://github.com/kiwitcms/kiwi/commit/195ea53eaaf360c19227c864cc0fe58910032c3c
    reference_type:
    reference_id:
  - url: https://github.com/kiwitcms/kiwi/commit/ffb00450be52fe11a82a2507632c2328cae4ec9d
    reference_type:
    reference_id:
  - url: https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-jpgw-2r9m-8qfw
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/511489dd-ba38-4806-9029-b28ab2830aa8
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/c6eeb346-fa99-4d41-bc40-b68f8d689223
    reference_type:
    reference_id:
  - url: https://kiwitcms.org/blog/kiwi-tcms-team/2023/07/04/kiwi-tcms-125
    reference_type:
    reference_id:
  - url: https://www.github.com/kiwitcms/kiwi/commit/195ea53eaaf360c19227c864cc0fe58910032c3c
    reference_type:
    reference_id:
  - url: https://www.github.com/kiwitcms/kiwi/commit/ffb00450be52fe11a82a2507632c2328cae4ec9d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-36809
    reference_type:
    reference_id: CVE-2023-36809
