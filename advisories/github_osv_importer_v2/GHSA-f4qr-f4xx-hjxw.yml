advisory_id: GHSA-f4qr-f4xx-hjxw
datasource_id: github_osv_importer_v2/GHSA-f4qr-f4xx-hjxw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-f4qr-f4xx-hjxw/GHSA-f4qr-f4xx-hjxw.json
aliases:
  - CVE-2022-35980
summary: "OpenSearch vulnerable to Improper Authorization of Index Containing Sensitive Information\n\
  ### Impact\nRequests to an OpenSearch cluster configured with advanced access control features\
  \ ([document level security (DLS)](https://opensearch.org/docs/latest/security-plugin/access-control/document-level-security/),\
  \ [field level security (FLS)](https://opensearch.org/docs/latest/security-plugin/access-control/field-level-security/),\
  \ and/or [field masking](https://opensearch.org/docs/latest/security-plugin/access-control/field-masking/))\
  \ will not be filtered when the query's search pattern matches an aliased index.\n\nOpenSearch\
  \ Dashboards creates an alias to `.kibana` by default, so filters with the index pattern of\
  \ `*` to restrict access to documents or fields will not be applied.\n\nThis issue allows\
  \ requests to access sensitive information when customer have acted to restrict access that\
  \ specific information. \n\n### Patches\nOpenSearch 2.2.0+ contains the fix for this issue.\
  \ OpenSearch Security Plugin 2.2.0.0 is compatible with OpenSearch 2.2.0.\n\n### Workarounds\n\
  There is no recommended work around.\n\n### References\nSee pull request #1999 for additional\
  \ details.\n\n### For more information\nIf you have any questions or comments about this advisory\
  \ we ask that contact AWS/Amazon Security via our [vulnerability reporting page](http://aws.amazon.com/security/vulnerability-reporting/)\
  \ or directly via email to aws-security@amazon.com. Please do **not** create a public GitHub\
  \ issue."
impacted_packages:
  - purl: pkg:maven/org.opensearch.plugin/opensearch-security
    affected_versions: vers:maven/<=2.1.0.0
    fixed_versions: vers:maven/2.2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-f4qr-f4xx-hjxw/GHSA-f4qr-f4xx-hjxw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-612
references:
  - url: https://github.com/opensearch-project/security
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/security/commit/7eaaafec2939d7db23a02ffca9cc68e0343de246
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/security/pull/1999
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/security/security/advisories/GHSA-f4qr-f4xx-hjxw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-35980
    reference_type:
    reference_id: CVE-2022-35980
