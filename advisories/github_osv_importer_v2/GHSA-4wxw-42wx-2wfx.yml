advisory_id: GHSA-4wxw-42wx-2wfx
datasource_id: github_osv_importer_v2/GHSA-4wxw-42wx-2wfx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-4wxw-42wx-2wfx/GHSA-4wxw-42wx-2wfx.json
aliases:
  - CVE-2023-50292
summary: |
  Apache Solr Schema Designer blindly "trusts" all configsets
  Incorrect Permission Assignment for Critical Resource, Improper Control of Dynamically-Managed Code Resources vulnerability in Apache Solr.

  This issue affects Apache Solr from 8.10.0 through 8.11.2, from 9.0.0 before 9.3.0.

  The Schema Designer was introduced to allow users to more easily configure and test new Schemas and configSets.
  However, when the feature was created, the "trust" (authentication) of these configSets was not considered.
  External library loading is only available to configSets that are "trusted" (created by authenticated users), thus non-authenticated users are unable to perform Remote Code Execution.
  Since the Schema Designer loaded configSets without taking their "trust" into account, configSets that were created by unauthenticated users were allowed to load external libraries when used in the Schema Designer.

  Users are recommended to upgrade to version 9.3.0 or 8.11.3, both of which fix the issue.
impacted_packages:
  - purl: pkg:maven/org.apache.solr/solr-core
    affected_versions: vers:maven/>=9.0.0|<9.3.0
    fixed_versions: vers:maven/9.3.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.solr/solr-core
    affected_versions: vers:maven/>=8.10.0|<8.11.3
    fixed_versions: vers:maven/8.11.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-732
references:
  - url: https://github.com/apache/lucene-solr/commit/6e9ed203b30958396bdfd41760d426b386646865
    reference_type:
    reference_id:
  - url: https://github.com/apache/solr/commit/d07751cfaa8065bea8bd43f59e758e50d50c2419
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/SOLR-16777
    reference_type:
    reference_id:
  - url: https://solr.apache.org/security.html#cve-2023-50298-apache-solr-can-expose-zookeeper-credentials-via-streaming-expressions
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/02/09/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-50292
    reference_type:
    reference_id: CVE-2023-50292
