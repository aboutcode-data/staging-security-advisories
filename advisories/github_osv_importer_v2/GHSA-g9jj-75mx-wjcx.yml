advisory_id: GHSA-g9jj-75mx-wjcx
datasource_id: github_osv_importer_v2/GHSA-g9jj-75mx-wjcx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-g9jj-75mx-wjcx/GHSA-g9jj-75mx-wjcx.json
aliases:
  - CVE-2025-32968
summary: |
  org.xwiki.platform:xwiki-platform-oldcore allows SQL injection in short form select requests through the script query API
  ### Impact

  It is possible for a user with SCRIPT right to escape from the HQL execution context and perform a blind SQL injection to execute arbitrary SQL statements on the database backend.

  Depending on the used database backend, the attacker may be able to not only obtain confidential information such as password hashes from the database, but also execute UPDATE/INSERT/DELETE queries.

  The vulnerability may be tested in a default installation of XWIki Standard Flavor, including using the official Docker containers.

  For example, with a MySQL or MariaDB database, you can use the following script (which a user having SCRIPT right but not PROGRAMMING right) to get the content of the xwikistrings table (which contain all the short string fields stored in objects, including passwords):

  ```
  {{velocity}}
  $services.query.hql("where 1<>'1\'' union select concat(XWS_NAME, XWS_VALUE) from xwikistrings #'").execute()
  {{/velocity}}
  ```

  ### Patches

  This has been patched in 16.10.1, 16.4.6 and 15.10.16.

  ### Workarounds

  There is no known workaround, other than upgrading XWiki.

  The protection added to this REST API is the same as the one used to validate complete select queries, making it more consistent. However, while the script API always had this protection for complete queries, it's important to note that it's a very strict protection and some valid, but complex, queries might suddenly require the author to have programming right.

  ### References

  https://jira.xwiki.org/browse/XWIKI-22718

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  * Email us at [Security Mailing List](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-oldcore
    affected_versions: vers:maven/>=1.6-milestone-1|<15.10.16
    fixed_versions: vers:maven/15.10.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-oldcore
    affected_versions: vers:maven/>=16.0.0-rc-1|<16.4.6
    fixed_versions: vers:maven/16.4.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-oldcore
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.10.1
    fixed_versions: vers:maven/16.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-g9jj-75mx-wjcx/GHSA-g9jj-75mx-wjcx.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g9jj-75mx-wjcx
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22718
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32968
    reference_type:
    reference_id: CVE-2025-32968
