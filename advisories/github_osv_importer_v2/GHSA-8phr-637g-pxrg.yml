advisory_id: GHSA-8phr-637g-pxrg
datasource_id: github_osv_importer_v2/GHSA-8phr-637g-pxrg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-8phr-637g-pxrg/GHSA-8phr-637g-pxrg.json
aliases:
  - CVE-2023-48295
summary: |
  LibreNMS Cross-site Scripting at Device groups Deletion feature
  ### Summary
  XSS attacks occurs when application is not sanitising inputs properly and rendering the code from user input to browser which could allow an attacker to execute malicious javascript code.

  ### PoC
  1. Login
  2. Create a device group in /device-groups
  3. Name it as `"><img src=x onerror=alert(1);>`
  4. save it
  5. Go to services and create a service template and add that device group into that and save it
  6. After that go back to device groups and delete that device, you will see XSS payload popup in message
  <img width="1043" alt="Screenshot 2023-11-08 at 9 15 56 PM" src="https://user-images.githubusercontent.com/31764504/281489434-9beaebd6-b9ce-4098-a8e0-d67b185062b5.png">


  ### Vulnerable code:
  https://github.com/librenms/librenms/blob/63eeeb71722237d1461a37bb6da99fda25e02c91/app/Http/Controllers/DeviceGroupController.php#L173C21-L173C21

  Line 173 is not sanitizing device name properly
  <img width="793" alt="Screenshot 2023-11-08 at 9 26 14 PM" src="https://user-images.githubusercontent.com/31764504/281490570-5ae6e73a-37ce-4683-8bc8-81655abd8d09.png">

  ### Impact
  Cross site scripting can lead to cookie stealing attacks
impacted_packages:
  - purl: pkg:composer/librenms/librenms
    affected_versions: vers:composer/<23.11.0
    fixed_versions: vers:composer/23.11.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-8phr-637g-pxrg/GHSA-8phr-637g-pxrg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/blob/63eeeb71722237d1461a37bb6da99fda25e02c91/app/Http/Controllers/DeviceGroupController.php#L173C21-L173C21
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/faf66035ea1f4c1c4f34559b9d0ed40ee4a19f90
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-8phr-637g-pxrg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-48295
    reference_type:
    reference_id: CVE-2023-48295
