advisory_id: GHSA-f3fp-gc8g-vw66
datasource_id: github_osv_importer_v2/GHSA-f3fp-gc8g-vw66
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-f3fp-gc8g-vw66/GHSA-f3fp-gc8g-vw66.json
aliases:
  - CVE-2022-29162
summary: |
  Default inheritable capabilities for linux container should be empty
  ### Impact

  A bug was found in runc where `runc exec --cap` executed processes with non-empty inheritable Linux process capabilities, creating an atypical Linux environment and enabling programs with inheritable file capabilities to elevate those capabilities to the permitted set during execve(2).

  This bug did not affect the container security sandbox as the inheritable set never contained more capabilities than were included in the container's bounding set.

  ### Patches
  This bug has been fixed in runc 1.1.2. Users should update to this version as soon as possible.

  This fix changes `runc exec --cap` behavior such that the additional capabilities granted to the process being executed (as specified via `--cap` arguments) do not include inheritable capabilities.

  In addition, `runc spec` is changed to not set any inheritable capabilities in the created example OCI spec (`config.json`) file.

  ### Credits
  The opencontainers project would like to thank [Andrew G. Morgan](https://github.com/AndrewGMorgan) for responsibly disclosing this issue in accordance with the [opencontainers org security policy](https://github.com/opencontainers/.github/blob/master/SECURITY.md).

  ### For more information
  If you have any questions or comments about this advisory:

  * [Open an issue](https://github.com/opencontainers/runc/issues/new)
  * Email us at [security@opencontainers.org](mailto:security@opencontainers.org) if you think youâ€™ve found a security bug
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-f3fp-gc8g-vw66/GHSA-f3fp-gc8g-vw66.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-276
references:
  - url: github.com/opencontainers/runc
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/commit/d04de3a9b72d7a2455c1885fc75eb36d02cd17b5
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/releases/tag/v1.1.2
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/security/advisories/GHSA-f3fp-gc8g-vw66
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/03/msg00023.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/AVPZBV7ISA7QKRPTC7ZXWKMIQI2HZEBB
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/D77CKD3AXPMU4PMQIQI5Q74SI4JATNND
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GPQU4YC4AAY54JDXGDQHJEYKSXXG5T2Y
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29162
    reference_type:
    reference_id: CVE-2022-29162
