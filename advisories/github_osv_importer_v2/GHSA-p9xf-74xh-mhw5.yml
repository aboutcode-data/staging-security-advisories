advisory_id: GHSA-p9xf-74xh-mhw5
datasource_id: github_osv_importer_v2/GHSA-p9xf-74xh-mhw5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-p9xf-74xh-mhw5/GHSA-p9xf-74xh-mhw5.json
aliases:
  - CVE-2023-37477
summary: "1Panel command injection vulnerability in Firewall ip functionality\n### Summary\n\
  An OS command injection vulnerability exists in 1Panel firewall functionality. A specially-crafted\
  \ HTTP request can lead to arbitrary command execution. An attacker can make an authenticated\
  \ HTTP request to trigger this vulnerability.\n\n### Details\n1Panel firewall functionality\
  \ `/hosts/firewall/ip` endpoint read user input without validation, the attacker extends the\
  \ default functionality of the application, which execute system commands.\n\n### PoC\nthe\
  \ payload `; sleep 3 #` will lead server response in 3 seconds \n![image](https://user-images.githubusercontent.com/4935500/252299676-bc4a8b92-e475-40ee-a92a-fec9fad7a6c3.png)\n\
  \nthe payload `; sleep 6 #` will lead server response in 6 seconds \n![image](https://user-images.githubusercontent.com/4935500/252299871-766cc411-69e5-4c6c-b4ff-7774fa974ea0.png)\n\
  \n### Impact\nAn attacker can execute arbitrary code on the target system, which can lead\
  \ to a complete compromise of the system.\n\n### Patches\n\nThe vulnerability has been fixed\
  \ in v1.4.3.\n\n### Workarounds\n\nIt is recommended to upgrade the version to v1.4.3.\n\n\
  ### References\n\nIf you have any questions or comments about this advisory:\n\nOpen an issue\
  \ in https://github.com/1Panel-dev/1Panel\nEmail us at wanghe@fit2cloud.com"
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-p9xf-74xh-mhw5/GHSA-p9xf-74xh-mhw5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/1Panel-dev/1Panel
    reference_type:
    reference_id:
  - url: https://github.com/1Panel-dev/1Panel/commit/e17b80cff4975ee343568ff526b62319f499005d
    reference_type:
    reference_id:
  - url: https://github.com/1Panel-dev/1Panel/releases/tag/v1.4.3
    reference_type:
    reference_id:
  - url: https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-p9xf-74xh-mhw5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-37477
    reference_type:
    reference_id: CVE-2023-37477
