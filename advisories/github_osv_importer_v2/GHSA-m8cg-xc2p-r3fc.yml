advisory_id: GHSA-m8cg-xc2p-r3fc
datasource_id: github_osv_importer_v2/GHSA-m8cg-xc2p-r3fc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-m8cg-xc2p-r3fc/GHSA-m8cg-xc2p-r3fc.json
aliases:
  - CVE-2023-25809
summary: |
  rootless: `/sys/fs/cgroup` is writable when cgroupns isn't unshared in runc
  ### Impact
  It was found that rootless runc makes `/sys/fs/cgroup` writable in following conditons:
  1. when runc is executed inside the user namespace, and the `config.json` does not specify the cgroup namespace to be unshared (e.g.., `(docker|podman|nerdctl) run --cgroupns=host`, with Rootless Docker/Podman/nerdctl)
  2. or, when runc is executed outside the user namespace, and `/sys` is mounted with `rbind, ro` (e.g., `runc spec --rootless`; this condition is very rare)

  A container may gain the write access to user-owned cgroup hierarchy `/sys/fs/cgroup/user.slice/...` on the host .
  Other users's cgroup hierarchies are not affected.

  ### Patches
  v1.1.5 (planned)

  ### Workarounds
  - Condition 1: Unshare the cgroup namespace (`(docker|podman|nerdctl) run --cgroupns=private)`. This is the default behavior of Docker/Podman/nerdctl on cgroup v2 hosts.
  - Condition 2 (very rare): add `/sys/fs/cgroup` to `maskedPaths`
impacted_packages: []
severities:
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-m8cg-xc2p-r3fc/GHSA-m8cg-xc2p-r3fc.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-281
references:
  - url: https://github.com/opencontainers/runc
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/commit/0d62b950e60f6980b54fe3bafd9a9c608dc1df17
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/security/advisories/GHSA-m8cg-xc2p-r3fc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-25809
    reference_type:
    reference_id: CVE-2023-25809
