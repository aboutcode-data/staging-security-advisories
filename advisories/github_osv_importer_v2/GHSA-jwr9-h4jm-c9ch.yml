advisory_id: GHSA-jwr9-h4jm-c9ch
datasource_id: github_osv_importer_v2/GHSA-jwr9-h4jm-c9ch
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-jwr9-h4jm-c9ch/GHSA-jwr9-h4jm-c9ch.json
aliases:
  - CVE-2021-21625
summary: |
  Missing permission checks in Jenkins CloudBees AWS Credentials Plugin allows enumerating credentials IDs
  CloudBees AWS Credentials Plugin 1.28 and earlier does not perform a permission check in a helper method for HTTP endpoints.

  This allows attackers with Overall/Read permission to enumerate credentials IDs of AWS credentials stored in Jenkins if any of the following plugins are installed:

  - [Amazon Elastic Container Service (ECS) / Fargate](https://plugins.jenkins.io/amazon-ecs)
  - [AWS Parameter Store Build Wrapper](https://plugins.jenkins.io/aws-parameter-store)
  - [AWS SAM](https://plugins.jenkins.io/aws-sam)\n\nFurther plugins may use this helper method as well without performing a permission check themselves.

  Credentials IDs obtained this way can be used as part of an attack to capture the credentials using another vulnerability.

  CloudBees AWS Credentials Plugin 1.28.1 performs permission checks in the helper method for HTTP endpoints.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/aws-credentials
    affected_versions: vers:maven/<=1.28
    fixed_versions: vers:maven/1.28.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-jwr9-h4jm-c9ch/GHSA-jwr9-h4jm-c9ch.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/jenkinsci/aws-credentials-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/aws-credentials-plugin/commit/dd477a071bd633d9118c63dc3f19a2fd0590aecb
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2021-03-18/#SECURITY-2032
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/03/18/5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21625
    reference_type:
    reference_id: CVE-2021-21625
