advisory_id: GHSA-5pq5-9phv-q5j3
datasource_id: github_osv_importer_v2/GHSA-5pq5-9phv-q5j3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-5pq5-9phv-q5j3/GHSA-5pq5-9phv-q5j3.json
aliases:
  - CVE-2020-8819
summary: |
  CardGate Payments plugin for WooCommerce does not validate request origin
  An issue was discovered in the CardGate Payments plugin through 3.1.15 for WooCommerce. Lack of origin authentication in the IPN callback processing function in cardgate/cardgate.php allows an attacker to remotely replace critical plugin settings (merchant ID, secret key, etc.) and therefore bypass the payment process (e.g., spoof an order status by manually sending an IPN callback request with a valid signature but without real payment) and/or receive all of the subsequent payments.
impacted_packages:
  - purl: pkg:composer/cardgate/woocommerce
    affected_versions: vers:composer/<=3.1.15
    fixed_versions: vers:composer/3.1.16
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-5pq5-9phv-q5j3/GHSA-5pq5-9phv-q5j3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-346
references:
  - url: http://packetstormsecurity.com/files/156504/WordPress-WooCommerce-CardGate-Payment-Gateway-3.1.15-Bypass.html
    reference_type:
    reference_id:
  - url: https://github.com/cardgate/woocommerce
    reference_type:
    reference_id:
  - url: https://github.com/cardgate/woocommerce/blob/f2111af7b1a3fd701c1c5916137f3ac09482feeb/cardgate/cardgate.php#L426-L442
    reference_type:
    reference_id:
  - url: https://github.com/cardgate/woocommerce/issues/18
    reference_type:
    reference_id:
  - url: https://github.com/cardgate/woocommerce/pull/17/commits/0b83588d604c8c56c7fded43144fcced96b2ada9
    reference_type:
    reference_id:
  - url: https://wpvulndb.com/vulnerabilities/10097
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/48134
    reference_type:
    reference_id:
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/php/webapps/48134.php
    reference_type: exploit
    reference_id: CVE-2020-8819
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-8819
    reference_type:
    reference_id: CVE-2020-8819
