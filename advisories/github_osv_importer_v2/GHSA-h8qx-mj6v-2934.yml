advisory_id: GHSA-h8qx-mj6v-2934
datasource_id: github_osv_importer_v2/GHSA-h8qx-mj6v-2934
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-h8qx-mj6v-2934/GHSA-h8qx-mj6v-2934.json
aliases:
  - CVE-2020-25828
summary: |
  MediaWiki Cross-site Scripting (XSS) vulnerability
  An issue was discovered in MediaWiki before 1.31.9 and 1.32.x through 1.34.x before 1.34.3. The non-jqueryMsg version of mw.message().parse() doesn't escape HTML. This affects both message contents (which are generally safe) and the parameters (which can be based on user input). (When jqueryMsg is loaded, it correctly accepts only whitelisted tags in message contents, and escapes all parameters. Situations with an unloaded jqueryMsg are rare in practice, but can for example occur for Special:SpecialPages on a wiki with no extensions installed.)
impacted_packages:
  - purl: pkg:composer/mediawiki/core
    affected_versions: vers:composer/>=1.31.0|<1.31.9
    fixed_versions: vers:composer/1.31.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/mediawiki/core
    affected_versions: vers:composer/>=1.32.0|<1.34.3
    fixed_versions: vers:composer/1.34.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/mediawiki/core
    affected_versions: vers:composer/>=1.35.0-rc.0|<1.35.0
    fixed_versions: vers:composer/1.35.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-h8qx-mj6v-2934/GHSA-h8qx-mj6v-2934.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/mediawiki/core/CVE-2020-25828.yaml
    reference_type:
    reference_id:
  - url: https://github.com/wikimedia/mediawiki
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RTTPZ7XMDS66I442OLLHXBDNP2LCBJU6
    reference_type:
    reference_id:
  - url: https://lists.wikimedia.org/pipermail/mediawiki-announce
    reference_type:
    reference_id:
  - url: https://lists.wikimedia.org/pipermail/mediawiki-l/2020-September/048480.html
    reference_type:
    reference_id:
  - url: https://lists.wikimedia.org/pipermail/mediawiki-l/2020-September/048488.html
    reference_type:
    reference_id:
  - url: https://phabricator.wikimedia.org/T115888
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-25828
    reference_type:
    reference_id: CVE-2020-25828
