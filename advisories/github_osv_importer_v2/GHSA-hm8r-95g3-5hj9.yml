advisory_id: GHSA-hm8r-95g3-5hj9
datasource_id: github_osv_importer_v2/GHSA-hm8r-95g3-5hj9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hm8r-95g3-5hj9/GHSA-hm8r-95g3-5hj9.json
aliases:
  - CVE-2024-29179
summary: |
  phpMyFAQ Stored Cross-site Scripting at File Attachments
  ### Summary
  An attacker with admin privileges can upload an attachment containing JS code without extension and the application will render it as HTML which allows for XSS attacks.

  ### Details
  When attachments are uploaded without an extension, the application renders it as HTML by default. Therefore allowing attackers to upload .html files containing javascript code to perform XSS attacks. The direct file path to the uploaded attachment is also easily obtainable as it is made up of substrings of the file's MD5 hashes.

  ### PoC
  1. Admin users can upload attachments containing XSS payloads in files without extensions to bypass the .html extension check.
  ![image](https://github.com/thorsten/phpMyFAQ/assets/63487456/5c3c4222-550e-44c7-95ee-fd85562fffd5)

  2. Since the path of the uploaded file is built entirely on the fileâ€™s MD5 hash and the attachment directory, it is possible for an attacker to know the direct path of the uploaded file.

    E.g file MD5 hash: 38fff51cb7248a06d6142c6bdf846831

      URL will be: http://127.0.0.1/phpmyfaq/attachments/38fff/51cb7/248a0/6d6142c6bdf846831

      - /attachments
      - /38fff (first 5 chars of MD5 hash)
      - /51cb7 (next 5 chars of MD5 hash)
      - /248a0 (next 5 chars of MD5 hash)
      - /6d6142c6bdf846831 (remaining chars of MD5 hash)

  3.  Even though the attachment was uploaded without a file extension, it is still rendered as .html, hence triggering the XSS payload.
  ![image](https://github.com/thorsten/phpMyFAQ/assets/63487456/663954ec-0210-4788-a841-7daa3fb547c3)

  ### Impact
  This allows an attacker to execute arbitrary client side JavaScript within the context of another user's phpMyFAQ session.
impacted_packages:
  - purl: pkg:composer/phpmyfaq/phpmyfaq
    affected_versions: vers:composer/3.2.5
    fixed_versions: vers:composer/3.2.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hm8r-95g3-5hj9/GHSA-hm8r-95g3-5hj9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/thorsten/phpMyFAQ
    reference_type:
    reference_id:
  - url: https://github.com/thorsten/phpMyFAQ/security/advisories/GHSA-hm8r-95g3-5hj9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-29179
    reference_type:
    reference_id: CVE-2024-29179
