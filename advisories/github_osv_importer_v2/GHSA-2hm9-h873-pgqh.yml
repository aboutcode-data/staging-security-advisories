advisory_id: GHSA-2hm9-h873-pgqh
datasource_id: github_osv_importer_v2/GHSA-2hm9-h873-pgqh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-2hm9-h873-pgqh/GHSA-2hm9-h873-pgqh.json
aliases:
  - CVE-2023-43645
summary: |
  OpenFGA Vulnerable to DoS from circular relationship definitions
  ## Overview
  OpenFGA is vulnerable to a DoS attack when certain Check calls are executed against authorization models that contain circular relationship definitions. When the call is made, it's possible for the server to exhaust resources and die.

  ## Am I Affected?
  Yes, if your store contains an authorization model that allows circular relationships. For example, with this model:

  ```
  model
    schema 1.1

  type user

  type group
    relations
      define memberA: [user] or memberB or memberC or memberD or memberE
      define memberB: [user] or memberA or memberC or memberD or memberE
      define memberC: [user] or memberA or memberB or memberD or memberE
      define memberD: [user] or memberA or memberB or memberC or memberE
      define memberE: [user] or memberA or memberB or memberC or memberD
  ```

  This Check: `(user:anne, memberA, group:X)` can exhaust memory in the server.

  ## Fix
  Upgrade to v1.3.2 and update any offending models.

    **[BREAKING]** If your model contained cycles or a relation definition that has the relation itself in its evaluation path, then Checks and queries that require evaluation will no longer be evaluated on v1.3.2+ and will return errors instead. You will need to update your models to remove the cycles.
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-2hm9-h873-pgqh/GHSA-2hm9-h873-pgqh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-835
references:
  - url: https://github.com/openfga/openfga
    reference_type:
    reference_id:
  - url: https://github.com/openfga/openfga/commit/725296025fd81227c89525808652c6acd4a605f6
    reference_type:
    reference_id:
  - url: https://github.com/openfga/openfga/security/advisories/GHSA-2hm9-h873-pgqh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-43645
    reference_type:
    reference_id: CVE-2023-43645
