advisory_id: GHSA-4mpj-488r-vh6m
datasource_id: github_osv_importer_v2/GHSA-4mpj-488r-vh6m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-4mpj-488r-vh6m/GHSA-4mpj-488r-vh6m.json
aliases:
  - CVE-2021-42767
summary: |
  Neo4j Graph Database vulnerable to Path Traversal
  ### Impact
  Directory Traversal Vulnerabilities found in several functions of apoc plugins in Neo4j Graph database. The attacker can retrieve and download files from outside the configured directory on the affected server. Under some circumstances, the attacker can also create files.

  ### Patches
  The users should aim to use the latest released version compatible with their Neo4j version. The minimum versions containing patch for this vulnerability (for Neo4j 4.2, 4.3, and 4.4 bundled with APOC, upgrade to the appropriate patched version):
  3.5 - bundle n/a, standalone 3.5.0.17
  4.2 - bundle 4.2.13, standalone 4.2.0.10
  4.3 - bundle 4.3.9, standalone 4.3.0.4
  4.4 - bundle 4.4.2, standalone 4.4.0.1

  ### Workarounds
  If you cannot upgrade the library, you can control the [allowlist of the functions](https://neo4j.com/docs/operations-manual/current/reference/configuration-settings/#config_dbms.security.procedures.allowlist) that can be used in your system:


  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [neo4j-apoc-procedures](https://github.com/neo4j-contrib/neo4j-apoc-procedures)
  * Email us at [security@neo4j.com](mailto:security@neo4j.com)

  ### Credits
  We want to publicly recognize the contribution of Nicolai Gr√∏dum from the Red Team of PwC Norway for reporting this issue and following the responsible disclosure [policy](https://neo4j.com/trust-center/responsible-disclosure/).
impacted_packages:
  - purl: pkg:maven/org.neo4j.procedure/apoc
    affected_versions: vers:maven/<3.5.17
    fixed_versions: vers:maven/3.5.17
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.neo4j.procedure/apoc
    affected_versions: vers:maven/>=4.2.0|<4.2.10
    fixed_versions: vers:maven/4.2.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.neo4j.procedure/apoc
    affected_versions: vers:maven/<=4.3.0.3
    fixed_versions: vers:maven/4.3.0.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.neo4j.procedure/apoc
    affected_versions: vers:maven/4.4.0.0
    fixed_versions: vers:maven/4.4.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-4mpj-488r-vh6m/GHSA-4mpj-488r-vh6m.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/neo4j-contrib/neo4j-apoc-procedures/security/advisories/GHSA-4mpj-488r-vh6m
    reference_type:
    reference_id:
  - url: https://neo4j.com
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-42767
    reference_type:
    reference_id: CVE-2021-42767
