advisory_id: GHSA-v662-xpcc-9xf6
datasource_id: github_osv_importer_v2/GHSA-v662-xpcc-9xf6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-v662-xpcc-9xf6/GHSA-v662-xpcc-9xf6.json
aliases:
  - CVE-2021-21379
summary: |
  It's possible to execute anything with the rights of the author of a macro which uses the {{wikimacrocontent}} macro
  ### Impact

  The `{{wikimacrocontent}}` executes the content with the rights of the wiki macro author instead of the caller of that wiki macro. This makes possible to inject scripts through it and they will be executed with the rights of the wiki macro (very often a user which has Programming rights).

  Fortunately, no such macro exists by default in XWiki Standard but one could have been created or installed with an extension.

  ### Patches

  It has been patched in versions XWiki 12.6.3, 11.10.11 and 12.8-rc-1.

  ### Workarounds

  There is no easy workaround other than disabling the affected macros.
  Inserting content in a safe way or knowing what is the user who called the wiki macro is not easy.

  ### References

  https://jira.xwiki.org/browse/XWIKI-17759

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki](https://jira.xwiki.org)
  * Email us at [our security mailing list](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store
    affected_versions: vers:maven/>=11.4|<11.10.11
    fixed_versions: vers:maven/11.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store
    affected_versions: vers:maven/>=12.0|<12.6.3
    fixed_versions: vers:maven/12.6.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store
    affected_versions: vers:maven/<=12.7.1
    fixed_versions: vers:maven/12.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-281
references:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-v662-xpcc-9xf6
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-17759
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21379
    reference_type:
    reference_id: CVE-2021-21379
