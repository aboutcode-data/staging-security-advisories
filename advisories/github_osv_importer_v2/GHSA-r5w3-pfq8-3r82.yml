advisory_id: GHSA-r5w3-pfq8-3r82
datasource_id: github_osv_importer_v2/GHSA-r5w3-pfq8-3r82
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-r5w3-pfq8-3r82/GHSA-r5w3-pfq8-3r82.json
aliases:
  - CVE-2021-21678
summary: |
  Jenkins SAML Plugin allows bypassing CSRF protection for any URL
  An extension point in Jenkins allows selectively disabling cross-site request forgery (CSRF) protection for specific URLs. SAML Plugin implements this extension point for the URL that users are redirected to after login.

  In Jenkins SAML Plugin 2.0.7 and earlier this implementation is too permissive, allowing attackers to craft URLs that would bypass the CSRF protection of any target URL.\n\nThis vulnerability was originally introduced in Jenkins SAML Plugin 1.1.3.

  Jenkins SAML Plugin 2.0.8 restricts which URLs it disables cross-site request forgery (CSRF) protection for to the one URL that needs it.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/saml
    affected_versions: vers:maven/<=2.0.7
    fixed_versions: vers:maven/2.0.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-r5w3-pfq8-3r82/GHSA-r5w3-pfq8-3r82.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
  - CWE-693
references:
  - url: https://github.com/jenkinsci/saml-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/saml-plugin/commit/e063317ee7e1c64a096e0ac323c7155b786c8b9d
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2021-08-31/#SECURITY-2469
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/08/31/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21678
    reference_type:
    reference_id: CVE-2021-21678
