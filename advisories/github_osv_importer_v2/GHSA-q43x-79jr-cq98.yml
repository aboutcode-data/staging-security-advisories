advisory_id: GHSA-q43x-79jr-cq98
datasource_id: github_osv_importer_v2/GHSA-q43x-79jr-cq98
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-q43x-79jr-cq98/GHSA-q43x-79jr-cq98.json
aliases:
  - CVE-2025-48939
summary: |
  tarteaucitron.js vulnerable to DOM Clobbering via document.currentScript
  A vulnerability was identified in tarteaucitron.js where document.currentScript was accessed without verifying that it referenced an actual `<script>` element. If an attacker injected an HTML element such as:

  ```
  <img name="currentScript" src="https://malicious.example.com">
  ```

  it could clobber the document.currentScript property. This causes the script to resolve incorrectly to an <img> element instead of the <script> tag, leading to unexpected behavior or failure to load the script path correctly.

  This issue arises because in some browser environments, named DOM elements (e.g., name="currentScript") become properties on the global document object.

  ## Impact
  An attacker with control over the HTML could exploit this to change the CDN domain of tarteaucitron.

  ## Fix https://github.com/AmauriC/tarteaucitron.js/commit/230a3b69d363837acfa895823d841e0608826ba3
  The issue was resolved by verifying that document.currentScript is an instance of HTMLScriptElement. If not, the script now falls back safely to the last <script> tag on the page.
impacted_packages:
  - purl: pkg:npm/tarteaucitronjs
    affected_versions: vers:npm/<1.22.0
    fixed_versions: vers:npm/1.22.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:C/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-q43x-79jr-cq98/GHSA-q43x-79jr-cq98.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-138
references:
  - url: https://github.com/AmauriC/tarteaucitron.js
    reference_type:
    reference_id:
  - url: https://github.com/AmauriC/tarteaucitron.js/commit/230a3b69d363837acfa895823d841e0608826ba3
    reference_type:
    reference_id:
  - url: https://github.com/AmauriC/tarteaucitron.js/security/advisories/GHSA-q43x-79jr-cq98
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-48939
    reference_type:
    reference_id: CVE-2025-48939
