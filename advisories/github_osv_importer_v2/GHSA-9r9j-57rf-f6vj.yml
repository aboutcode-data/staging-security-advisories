advisory_id: GHSA-9r9j-57rf-f6vj
datasource_id: github_osv_importer_v2/GHSA-9r9j-57rf-f6vj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-9r9j-57rf-f6vj/GHSA-9r9j-57rf-f6vj.json
aliases:
  - CVE-2022-36097
summary: "XWiki Platform Attachment UI vulnerable to cross-site scripting in the move attachment\
  \ form\n### Impact\n\nIt's possible to store JavaScript in an attachment name, which will\
  \ be executed by anyone trying to move the corresponding attachment.\n\nFor example, an attachment\
  \ with name `><img src=1 onerror=alert(1)>.jpg` will execute the alert.\n\n### Patches\nThis\
  \ issue has been patched in XWiki 14.4RC1.\n\n### Workarounds\nIt is possible to fix the vulnerability\
  \ by copying [moveStep1.vm](https://raw.githubusercontent.com/xwiki/xwiki-platform/xwiki-platform-14.0-rc-1/xwiki-platform-core/xwiki-platform-attachment/xwiki-platform-attachment-api/src/main/resources/templates/attachment/moveStep1.vm)\
  \ to `webapp/xwiki/templates/moveStep1.vm` and replace \n\n```\n#set($titleToDisplay = $services.localization.render('attachment.move.title',\
  \ \n  [$attachment.name, $escapetool.xml($doc.plainTitle), $doc.getURL()]))\n```\n\nby \n\n\
  ```\n#set($titleToDisplay = $services.localization.render('attachment.move.title', [\n  $escapetool.xml($attachment.name),\
  \ \n  $escapetool.xml($doc.plainTitle), \n  $escapetool.xml($doc.getURL())\n]))\n```\n\nSee\
  \ the corresponding [patch](https://github.com/xwiki/xwiki-platform/commit/fbc4bfbae4f6ce8109addb281de86a03acdb9277).\n\
  \n### References\n\n- https://jira.xwiki.org/browse/XWIKI-19667\n\n### For more information\n\
  \nIf you have any questions or comments about this advisory:\n\n- Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)\n\
  - Email us at [Security Mailing List](mailto:security@xwiki.org)"
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-attachment-ui
    affected_versions: vers:maven/>=14.0-rc-1|<14.4-rc-1
    fixed_versions: vers:maven/14.4-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-9r9j-57rf-f6vj/GHSA-9r9j-57rf-f6vj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-80
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/fbc4bfbae4f6ce8109addb281de86a03acdb9277
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9r9j-57rf-f6vj
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19667
    reference_type:
    reference_id:
  - url: https://raw.githubusercontent.com/xwiki/xwiki-platform/xwiki-platform-14.0-rc-1/xwiki-platform-core/xwiki-platform-attachment/xwiki-platform-attachment-api/src/main/resources/templates/attachment/moveStep1.vm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-36097
    reference_type:
    reference_id: CVE-2022-36097
