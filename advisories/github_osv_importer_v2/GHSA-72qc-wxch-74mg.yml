advisory_id: GHSA-72qc-wxch-74mg
datasource_id: github_osv_importer_v2/GHSA-72qc-wxch-74mg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-72qc-wxch-74mg/GHSA-72qc-wxch-74mg.json
aliases:
  - CVE-2025-66469
summary: "NiceGUI Reflected XSS in ui.add_css, ui.add_scss, and ui.add_sass via Style Injection\n\
  ### Summary\nA Cross-Site Scripting (XSS) vulnerability exists in `ui.add_css`, `ui.add_scss`,\
  \ and `ui.add_sass` functions in NiceGUI (v3.3.1 and earlier).\n\nThese functions allow developers\
  \ to inject styles dynamically. However, they lack proper sanitization or encoding for the\
  \ JavaScript context they generate. An attacker can break out of the intended `<style>` or\
  \ `<script>` tags by injecting closing tags (e.g., `</style>` or `</script>`), allowing for\
  \ the execution of arbitrary JavaScript.\n\n### Details\nThe vulnerability stems from how\
  \ these functions inject content into the DOM using `client.run_javascript` (or `add_head_html`\
  \ internally) without sufficient escaping for the transport layer.\n\n* **`ui.add_css`**:\
  \ Injects content into a `<style>` tag. Input containing `</style>` closes the tag prematurely,\
  \ allowing subsequent HTML/JS injection.\n* **`ui.add_scss` / `ui.add_sass`**: These rely\
  \ on client-side compilation within `<script>` tags. Input containing `</script>` breaks the\
  \ execution context, allowing XSS.\n\n### PoC\n**Scenario:** A developer allows users to customize\
  \ a theme color via a URL parameter.\n\n```python\nfrom nicegui import ui\n\n@ui.page('/')\n\
  def main(color: str = 'blue'):\n    # Vulnerable implementation of dynamic theming\n    ui.add_css(f'.q-btn\
  \ {{ background-color: {color} !important; }}')\n    ui.button('Click Me')\n\nui.run(port=8082)\n\
  ```\n**Attack Vector:**\nAccessing the following URL executes arbitrary JavaScript:\n`http://localhost:8082/?color=red;}</style><img\
  \ src=x onerror=alert(document.domain)><style>`\n\n### Impact\n* **Type:** Reflected XSS\n\
  * **Severity:** Moderate \n* **Affected Components:** Applications using `ui.add_css`, `ui.add_scss`,\
  \ or `ui.add_sass` with untrusted input (e.g., dynamic theming based on user input)."
impacted_packages:
  - purl: pkg:pypi/nicegui
    affected_versions: vers:pypi/<=3.3.1
    fixed_versions: vers:pypi/3.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-72qc-wxch-74mg/GHSA-72qc-wxch-74mg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/zauberzeug/nicegui
    reference_type:
    reference_id:
  - url: https://github.com/zauberzeug/nicegui/commit/a8fd25b7d5e23afb1952d0f60a1940e18b5f1ca8
    reference_type:
    reference_id:
  - url: https://github.com/zauberzeug/nicegui/security/advisories/GHSA-72qc-wxch-74mg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66469
    reference_type:
    reference_id:
