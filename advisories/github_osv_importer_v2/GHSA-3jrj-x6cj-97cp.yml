advisory_id: GHSA-3jrj-x6cj-97cp
datasource_id: github_osv_importer_v2/GHSA-3jrj-x6cj-97cp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-3jrj-x6cj-97cp/GHSA-3jrj-x6cj-97cp.json
aliases:
  - CVE-2021-43559
summary: |
  Moodle contains CSRF vulnerability
  A flaw was found in Moodle in versions 3.11 to 3.11.3, 3.10 to 3.10.7, 3.9 to 3.9.10 and earlier unsupported versions. The "delete related badge" functionality did not include the necessary token check to prevent a CSRF risk.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<=3.11.3
    fixed_versions: vers:composer/3.11.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<=3.10.7
    fixed_versions: vers:composer/3.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<=3.9.10
    fixed_versions: vers:composer/3.9.11
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-3jrj-x6cj-97cp/GHSA-3jrj-x6cj-97cp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2021517
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/20d41ebae4eb28269298504c68db511a05ec4969
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=429099
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43559
    reference_type:
    reference_id: CVE-2021-43559
