advisory_id: GHSA-xmjj-3c76-5w84
datasource_id: github_osv_importer_v2/GHSA-xmjj-3c76-5w84
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-xmjj-3c76-5w84/GHSA-xmjj-3c76-5w84.json
aliases:
  - CVE-2022-24814
summary: |
  Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') in directus
  ### Impact

  Unauthorized JavaScript can be executed by inserting an iframe into the rich text html interface that links to a file uploaded HTML file that loads another uploaded JS file in its script tag. This satisfies the regular content security policy header, which in turn allows the file to run any arbitrary JS.

  ### Patches

  This was resolved in https://github.com/directus/directus/pull/12020 which is released in 9.7.0

  ### Workarounds

  You can disable the live embed in the WYSIWYG by adding `{ "media_live_embeds": false }` to the _Options Overrides_ option of the Rich Text HTML interface.

  ### References

  https://github.com/directus/directus/pull/12020

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [directus/directus](https://github.com/directus/directus)
  * Email us at [security@directus.io](mailto:security@directus.io)
impacted_packages:
  - purl: pkg:npm/directus
    affected_versions: vers:npm/<9.7.0
    fixed_versions: vers:npm/9.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-xmjj-3c76-5w84/GHSA-xmjj-3c76-5w84.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/pull/12020
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/releases/tag/v9.7.0
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-xmjj-3c76-5w84
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24814
    reference_type:
    reference_id: CVE-2022-24814
