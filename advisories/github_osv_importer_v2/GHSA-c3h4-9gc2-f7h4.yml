advisory_id: GHSA-c3h4-9gc2-f7h4
datasource_id: github_osv_importer_v2/GHSA-c3h4-9gc2-f7h4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-c3h4-9gc2-f7h4/GHSA-c3h4-9gc2-f7h4.json
aliases:
  - CVE-2024-41799
summary: "tgstation-server's DreamMaker environment files outside the deployment directory can\
  \ be compiled and ran by insufficiently permissioned users\n### Impact\n_What kind of vulnerability\
  \ is it? Who is impacted?_\n\nLow permission users using the \"Set .dme Path\" privilege could\
  \ potentially set malicious .dme files existing on the host machine to be compiled and executed.\
  \ \n\nThese .dme files could be uploaded via tgstation-server (requiring a separate, isolated\
  \ privilege) or some other means.\n\nA server configured to execute in BYOND's trusted security\
  \ level (requiring a third separate, isolated privilege OR being set by another user) could\
  \ lead to this escalating into remote code execution via BYOND's shell() proc.\n\nThe ability\
  \ to execute this kind of attack is a known side effect of having privileged TGS users, but\
  \ normally requires multiple privileges with known weaknesses. This vector is not intentional\
  \ as it does not require control over the where deployment code is sourced from and _may_\
  \ not require remote write access to an instance's `Configuration` directory.\n\n### Patches\n\
  _Has the problem been patched? What versions should users upgrade to?_\n\nThis problem is\
  \ patched by pull request #1835 and fixed in versions 6.8.0 and above.\n\n### Workarounds\n\
  _Is there a way for users to fix or remediate the vulnerability without upgrading?_\n\nDo\
  \ not give un-trusted users the Deployment permission to set a .dme path on instances."
impacted_packages:
  - purl: pkg:nuget/Tgstation.Server.Api
    affected_versions: vers:nuget/>=4.0.0|<6.8.0
    fixed_versions: vers:nuget/6.8.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Tgstation.Server.Host
    affected_versions: vers:nuget/>=4.0.0|<6.8.0
    fixed_versions: vers:nuget/6.8.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:L/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-c3h4-9gc2-f7h4/GHSA-c3h4-9gc2-f7h4.json
  - score: '7.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:L/VA:H/SC:H/SI:L/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-c3h4-9gc2-f7h4/GHSA-c3h4-9gc2-f7h4.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/tgstation/tgstation-server
    reference_type:
    reference_id:
  - url: https://github.com/tgstation/tgstation-server/commit/374852fe5ae306415eb5aafb2d16b06897d7afe4
    reference_type:
    reference_id:
  - url: https://github.com/tgstation/tgstation-server/pull/1835
    reference_type:
    reference_id:
  - url: https://github.com/tgstation/tgstation-server/security/advisories/GHSA-c3h4-9gc2-f7h4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41799
    reference_type:
    reference_id: CVE-2024-41799
