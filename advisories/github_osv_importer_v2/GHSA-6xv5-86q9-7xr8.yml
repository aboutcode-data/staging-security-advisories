advisory_id: GHSA-6xv5-86q9-7xr8
datasource_id: github_osv_importer_v2/GHSA-6xv5-86q9-7xr8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-6xv5-86q9-7xr8/GHSA-6xv5-86q9-7xr8.json
aliases: []
summary: |
  SecureJoin: on windows, paths outside of the rootfs could be inadvertently produced
  ### Impact
  For Windows users of `github.com/cyphar/filepath-securejoin`, until v0.2.4 it was possible for certain rootfs and path combinations (in particular, where a malicious Unix-style `/`-separated unsafe path was used with a Windows-style rootfs path) to result in generated paths that were outside of the provided rootfs.

  It is unclear to what extent this has a practical impact on real users, but given the possible severity of the issue we have released an emergency patch release that resolves this issue.

  Thanks to  @pjbgf for discovering, debugging, and fixing this issue (as well as writing some tests for it).

  ### Patches
  c121231e1276e11049547bee5ce68d5a2cfe2d9b is the patch fixing this issue. v0.2.4 contains the fix.

  ### Workarounds
  Users could use `filepath.FromSlash()` on all unsafe paths before passing them to `filepath-securejoin`.

  ### References
  See #9.
impacted_packages: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/cyphar/filepath-securejoin
    reference_type:
    reference_id:
  - url: https://github.com/cyphar/filepath-securejoin/commit/c121231e1276e11049547bee5ce68d5a2cfe2d9b
    reference_type:
    reference_id:
  - url: https://github.com/cyphar/filepath-securejoin/pull/9
    reference_type:
    reference_id:
  - url: https://github.com/cyphar/filepath-securejoin/releases/tag/v0.2.4
    reference_type:
    reference_id:
  - url: https://github.com/cyphar/filepath-securejoin/security/advisories/GHSA-6xv5-86q9-7xr8
    reference_type:
    reference_id:
