advisory_id: GHSA-rvx8-p3xp-fj3p
datasource_id: github_osv_importer_v2/GHSA-rvx8-p3xp-fj3p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-rvx8-p3xp-fj3p/GHSA-rvx8-p3xp-fj3p.json
aliases:
  - CVE-2023-44383
summary: |
  October CMS stored XSS by authenticated backend user with improper configuration
  ### Impact

  A user with access to the media manager that stores SVG files could create a stored XSS attack against themselves and any other user with access to the media manager when SVG files are supported.

  SVG files are supported by default in v3 for convenience; however, this has resulted in multiple mistaken vulnerability reports from security researchers. As per the documentation, if a backend user is not trusted, the advice is to remove the `svg` extension from the list of supported file types.

  ### Patches

  The issue has been patched in v3.5.2 by including an SVG sanister. It is enabled by default for new installations but must be enabled for existing sites in the **config/media.php** file.

  ```
  'clean_vectors' => true,
  ```

  ### Workarounds

  If you cannot upgrade for this patch, follow the pervious advice and remove `svg` from the supported file types.

  ### References

  - https://github.com/octobercms/october/blob/3.x/config/media.php

  Credits to:
  - Faris Krivic
  - Okan Kurtulus
  - Aldin Visnjic
  - Bug Shankar

  ### For more information
  If you have any questions or comments about this advisory:
  * Email us at [hello@octobercms.com](mailto:hello@octobercms.com)
impacted_packages:
  - purl: pkg:composer/october/system
    affected_versions: vers:composer/>=3.0.0|<3.5.2
    fixed_versions: vers:composer/3.5.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-rvx8-p3xp-fj3p/GHSA-rvx8-p3xp-fj3p.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/octobercms/october
    reference_type:
    reference_id:
  - url: https://github.com/octobercms/october/commit/b7eed0bbf54d07ff310fcdc7037a8e8bf1f5043b
    reference_type:
    reference_id:
  - url: https://github.com/octobercms/october/security/advisories/GHSA-rvx8-p3xp-fj3p
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-44383
    reference_type:
    reference_id: CVE-2023-44383
