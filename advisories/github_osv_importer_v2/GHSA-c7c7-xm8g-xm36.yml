advisory_id: GHSA-c7c7-xm8g-xm36
datasource_id: github_osv_importer_v2/GHSA-c7c7-xm8g-xm36
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/11/GHSA-c7c7-xm8g-xm36/GHSA-c7c7-xm8g-xm36.json
aliases:
  - CVE-2018-18830
summary: |
  Unrestricted Upload of File with Dangerous Type in mingsoft:ms-mcms
  An issue was discovered in com\mingsoft\basic\action\web\FileAction.java in MCMS 4.6.5. Since the upload interface does not verify the user login status, you can use this interface to upload files without setting a cookie. First, start an upload of JSP code with a .png filename, and then intercept the data packet. In the name parameter, change the suffix to jsp. In the response, the server returns the storage path of the file, which can be accessed to execute arbitrary JSP code.
impacted_packages:
  - purl: pkg:maven/net.mingsoft/ms-mcms
    affected_versions: vers:maven/<=4.6.5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/11/GHSA-c7c7-xm8g-xm36/GHSA-c7c7-xm8g-xm36.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://gitee.com/mingSoft/MCMS
    reference_type:
    reference_id:
  - url: https://gitee.com/mingSoft/MCMS/issues/IO0IQ
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-c7c7-xm8g-xm36
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-18830
    reference_type:
    reference_id: CVE-2018-18830
