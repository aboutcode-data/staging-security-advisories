advisory_id: GHSA-gwch-7m8v-7544
datasource_id: github_osv_importer_v2/GHSA-gwch-7m8v-7544
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-gwch-7m8v-7544/GHSA-gwch-7m8v-7544.json
aliases:
  - CVE-2026-25499
summary: |
  terraform-provider-proxmox has insecure sudo recommendation in the documentation
  > Note: It is uncertain whether this constitutes a vulnerability or should be filed as an issue instead.

  ### Summary

  In the SSH configuration documentation, the sudoer line that was suggested can be escalated to edit any files in the system.

  ### Details

  The following line were suggested for addition in the sudoers file:

  ```bash
  terraform ALL=(root) NOPASSWD: /usr/bin/tee /var/lib/vz/*
  ```

  But this is highly insecure as  the folder can be escaped using `../` and any files can be edited on the system.

  ### PoC

  Using a `terraform` user with the previously mentioned line in the `/etc/sudoers` file, a `/etc/sudoers.d/sudo` file can be added using this command:

  `echo "ALL=(ALL) NOPASSWD:ALL" | tee /var/lib/vz/../../../etc/sudoers.d/sudo`

  This grants access to the full root of the node.

  ### Impact

  This breaches the access limits of the Terraform user.

  ### Suggested workaround

  Use a strict regex on the command to allow only the names that should be pushed by this user.

  Example for cloudinit yaml files:

  ```bash
  terraform ALL=(root) NOPASSWD: /usr/bin/tee /var/lib/vz/snippets/[A-Za-z0-9-]*\\.yaml
  ```
impacted_packages: []
severities:
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-gwch-7m8v-7544/GHSA-gwch-7m8v-7544.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1188
  - CWE-22
references:
  - url: https://github.com/bpg/terraform-provider-proxmox
    reference_type:
    reference_id:
  - url: https://github.com/bpg/terraform-provider-proxmox/commit/bd604c41a31e2a55dd6acc01b0608be3ea49c023
    reference_type:
    reference_id:
  - url: https://github.com/bpg/terraform-provider-proxmox/security/advisories/GHSA-gwch-7m8v-7544
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25499
    reference_type:
    reference_id:
