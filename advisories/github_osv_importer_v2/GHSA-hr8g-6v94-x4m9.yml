advisory_id: GHSA-hr8g-6v94-x4m9
datasource_id: github_osv_importer_v2/GHSA-hr8g-6v94-x4m9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-hr8g-6v94-x4m9/GHSA-hr8g-6v94-x4m9.json
aliases:
  - CVE-2023-33201
summary: |
  Bouncy Castle For Java LDAP injection vulnerability
  Bouncy Castle provides the `X509LDAPCertStoreSpi.java` class which can be used in conjunction with the CertPath API for validating certificate paths. Pre-1.73 the implementation did not check the X.500 name of any certificate, subject, or issuer being passed in for LDAP wild cards, meaning the presence of a wild car may lead to Information Disclosure.

  A potential attack would be to generate a self-signed certificate with a subject name that contains special characters, e.g: `CN=Subject*)(objectclass=`. This will be included into the filter and provides the attacker ability to specify additional attributes in the search query. This can be exploited as a blind LDAP injection: an attacker can enumerate valid attribute values using the boolean blind injection technique. The exploitation depends on the structure of the target LDAP directory, as well as what kind of errors are exposed to the user.

  Changes to the `X509LDAPCertStoreSpi.java` class add the additional checking of any X.500 name used to correctly escape wild card characters.
impacted_packages:
  - purl: pkg:maven/org.bouncycastle/bcprov-jdk18on
    affected_versions: vers:maven/<1.74
    fixed_versions: vers:maven/1.74
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-jdk15to18
    affected_versions: vers:maven/<1.74
    fixed_versions: vers:maven/1.74
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-jdk14
    affected_versions: vers:maven/>=1.49|<1.74
    fixed_versions: vers:maven/1.74
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-ext-jdk14
    affected_versions: vers:maven/>=1.49|<1.74
    fixed_versions: vers:maven/1.74
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-ext-jdk15to18
    affected_versions: vers:maven/<1.74
    fixed_versions: vers:maven/1.74
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-ext-jdk18on
    affected_versions: vers:maven/<1.74
    fixed_versions: vers:maven/1.74
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-debug-jdk14
    affected_versions: vers:maven/>=1.49|<1.74
    fixed_versions: vers:maven/1.74
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-debug-jdk15to18
    affected_versions: vers:maven/<1.74
    fixed_versions: vers:maven/1.74
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-debug-jdk18on
    affected_versions: vers:maven/<1.74
    fixed_versions: vers:maven/1.74
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-jdk15on
    affected_versions: vers:maven/>=1.49|<=1.70
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-ext-jdk15on
    affected_versions: vers:maven/>=1.49|<=1.70
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.bouncycastle/bcprov-debug-jdk15on
    affected_versions: vers:maven/>=1.49|<=1.70
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-hr8g-6v94-x4m9/GHSA-hr8g-6v94-x4m9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-295
references:
  - url: https://bouncycastle.org
    reference_type:
    reference_id:
  - url: https://bouncycastle.org/releasenotes.html#r1rv74
    reference_type:
    reference_id:
  - url: https://github.com/bcgit/bc-java
    reference_type:
    reference_id:
  - url: https://github.com/bcgit/bc-java/commit/ccf93ca736b89250ff4ce079a5aa56f5cbf0ebbd
    reference_type:
    reference_id:
  - url: https://github.com/bcgit/bc-java/commit/e8c409a8389c815ea3fda5e8b94c92fdfe583bcc
    reference_type:
    reference_id:
  - url: https://github.com/bcgit/bc-java/commits/main/prov/src/main/java/org/bouncycastle/jce/provider/X509LDAPCertStoreSpi.java
    reference_type:
    reference_id:
  - url: https://github.com/bcgit/bc-java/wiki/CVE-2023-33201
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/08/msg00000.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230824-0008
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-33201
    reference_type:
    reference_id: CVE-2023-33201
