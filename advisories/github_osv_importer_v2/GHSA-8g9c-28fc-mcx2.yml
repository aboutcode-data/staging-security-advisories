advisory_id: GHSA-8g9c-28fc-mcx2
datasource_id: github_osv_importer_v2/GHSA-8g9c-28fc-mcx2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-8g9c-28fc-mcx2/GHSA-8g9c-28fc-mcx2.json
aliases: []
summary: |
  Duplicate Advisory: Microsoft Identity Denial of service vulnerability
  ### Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-59j7-ghrg-fj52. This link is maintained to preserve external references.

  ### Original Description

  ### Impact
  An attacker could exploit this vulnerability by crafting a malicious JSON Web Encryption (JWE) token with a high compression ratio. This token, when processed by a server, leads to excessive memory allocation and processing time during decompression, causing a denial-of-service (DoS) condition.

  It's important to note that the attacker must have access to the public encrypt key registered with the IDP(Entra ID) for successful exploitation.

  _According to the CVSS metric, a successful exploitation could lead to a scope change (S:C). What does this mean for this vulnerability?_
  A scope change (S:C) in the CVSS metric indicates that successful exploitation of this vulnerability could extend beyond the immediate processing of malicious tokens, affecting the overall availability of the system by causing a denial-of-service (DoS) condition.

  ### Patches
  The vulnerability has been fixed. Users should update **all** their Microsoft.IdentityModel versions to 7.1.2 (for 7x) or higher, 6.34.0 (for 6x) or higher, and 5.7.0 (for 5x).

  ### Workarounds
  No, users must upgrade.

  ### References
  https://aka.ms/IdentityModel/Jan2024/zip
impacted_packages:
  - purl: pkg:nuget/Microsoft.IdentityModel.JsonWebTokens
    affected_versions: vers:nuget/<5.7.0
    fixed_versions: vers:nuget/5.7.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Microsoft.IdentityModel.JsonWebTokens
    affected_versions: vers:nuget/>=6.5.0|<6.34.0
    fixed_versions: vers:nuget/6.34.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Microsoft.IdentityModel.JsonWebTokens
    affected_versions: vers:nuget/>=7.0.0-preview|<7.1.2
    fixed_versions: vers:nuget/7.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/System.IdentityModel.Tokens.Jwt
    affected_versions: vers:nuget/<5.7.0
    fixed_versions: vers:nuget/5.7.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/System.IdentityModel.Tokens.Jwt
    affected_versions: vers:nuget/>=6.5.0|<6.34.0
    fixed_versions: vers:nuget/6.34.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/System.IdentityModel.Tokens.Jwt
    affected_versions: vers:nuget/>=7.0.0-preview|<7.1.2
    fixed_versions: vers:nuget/7.1.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-8g9c-28fc-mcx2/GHSA-8g9c-28fc-mcx2.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet
    reference_type:
    reference_id:
  - url: https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/releases/tag/5.7.0
    reference_type:
    reference_id:
  - url: https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/releases/tag/6.34.0
    reference_type:
    reference_id:
  - url: https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/releases/tag/7.1.2
    reference_type:
    reference_id:
  - url: https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/security/advisories/GHSA-8g9c-28fc-mcx2
    reference_type:
    reference_id:
  - url: https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21319
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-21319
    reference_type:
    reference_id: CVE-2024-21319
