advisory_id: GHSA-g5hv-r743-v8pm
datasource_id: github_osv_importer_v2/GHSA-g5hv-r743-v8pm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-g5hv-r743-v8pm/GHSA-g5hv-r743-v8pm.json
aliases:
  - CVE-2024-39877
summary: |
  Apache Airflow has DAG Author Code Execution possibility in airflow-scheduler
  Apache Airflow 2.4.0, and versions before 2.9.3, has a vulnerability that allows authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context, which should be forbidden according to the Airflow Security model. Users should upgrade to version 2.9.3 or later which has removed the vulnerability.
impacted_packages:
  - purl: pkg:pypi/apache-airflow
    affected_versions: vers:pypi/>=2.4.0|<2.9.3
    fixed_versions: vers:pypi/2.9.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-g5hv-r743-v8pm/GHSA-g5hv-r743-v8pm.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-g5hv-r743-v8pm/GHSA-g5hv-r743-v8pm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-277
  - CWE-94
references:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/8159f6e24704f5e0e3b3217cf79ecf5083dce531
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/pull/40522
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/apache-airflow/PYSEC-2024-190.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/1xhj9dkp37d6pzn24ll2mf94wbqnb2y1
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/07/16/7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-39877
    reference_type:
    reference_id: CVE-2024-39877
