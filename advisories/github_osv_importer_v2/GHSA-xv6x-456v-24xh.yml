advisory_id: GHSA-xv6x-456v-24xh
datasource_id: github_osv_importer_v2/GHSA-xv6x-456v-24xh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-xv6x-456v-24xh/GHSA-xv6x-456v-24xh.json
aliases:
  - CVE-2022-46181
summary: |
  gotify/server vulnerable to Cross-site Scripting in the application image file upload
  ### Impact

  The XSS vulnerability allows authenticated users to upload .html files. With that, an attacker could execute client side scripts **if** another user opened a link, such as:

  ```
  https://push.example.org/image/[alphanumeric string].html
  ```

  An attacker could potentially take over the account of the user that clicked the link. Keep in mind, the Gotify UI won't natively expose such a malicious link, so an attacker has to get the user to open the malicious link in a context outside of Gotify.

  ### Patches

  The vulnerability has been fixed in version 2.2.2.

  ### Workarounds

  You can block access to non image files via a reverse proxy in the `./image` directory.

  ### References

  https://github.com/gotify/server/pull/534
  https://github.com/gotify/server/pull/535

  ---

  Thanks to rickshang (aka 无在无不在) for discovering and reporting this bug.
impacted_packages: []
severities:
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-xv6x-456v-24xh/GHSA-xv6x-456v-24xh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/gotify/server
    reference_type:
    reference_id:
  - url: https://github.com/gotify/server/pull/534
    reference_type:
    reference_id:
  - url: https://github.com/gotify/server/pull/535
    reference_type:
    reference_id:
  - url: https://github.com/gotify/server/security/advisories/GHSA-xv6x-456v-24xh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-46181
    reference_type:
    reference_id: CVE-2022-46181
