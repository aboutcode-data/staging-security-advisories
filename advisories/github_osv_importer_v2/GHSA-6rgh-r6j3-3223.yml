advisory_id: GHSA-6rgh-r6j3-3223
datasource_id: github_osv_importer_v2/GHSA-6rgh-r6j3-3223
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-6rgh-r6j3-3223/GHSA-6rgh-r6j3-3223.json
aliases:
  - CVE-2024-47049
summary: |
  czim/file-handling vulnerable to SSRF and directory traversal
  The czim/file-handling package before 1.5.0 and 2.x before 2.3.0 (used with PHP Composer) does not properly validate URLs within makeFromUrl and makeFromAny, leading to SSRF, and to directory traversal for the reading of local files.
impacted_packages:
  - purl: pkg:composer/czim/file-handling
    affected_versions: vers:composer/<1.5.0
    fixed_versions: vers:composer/1.5.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/czim/file-handling
    affected_versions: vers:composer/>=2.0.0|<2.3.0
    fixed_versions: vers:composer/2.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-6rgh-r6j3-3223/GHSA-6rgh-r6j3-3223.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-6rgh-r6j3-3223/GHSA-6rgh-r6j3-3223.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
  - CWE-22
references:
  - url: https://github.com/czim/file-handling
    reference_type:
    reference_id:
  - url: https://github.com/czim/file-handling/blob/2.3.0/SECURITY.md
    reference_type:
    reference_id:
  - url: https://github.com/czim/file-handling/commit/95dfda850536bf35e684619598b9d02f4c97680d
    reference_type:
    reference_id:
  - url: https://github.com/czim/file-handling/commit/dcf879896efe3457f51af9c8eab9f70dfc709a99
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47049
    reference_type:
    reference_id: CVE-2024-47049
