advisory_id: GHSA-4hvc-qwr2-f8rv
datasource_id: github_osv_importer_v2/GHSA-4hvc-qwr2-f8rv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-4hvc-qwr2-f8rv/GHSA-4hvc-qwr2-f8rv.json
aliases:
  - CVE-2023-42809
summary: |
  Redisson vulnerable to Deserialization of Untrusted Data
  Redisson is a Java Redis client that uses the Netty framework. Prior to version 3.22.0, some of the messages received from the Redis server contain Java objects that the client deserializes without further validation. Attackers that manage to trick clients into communicating with a malicious server can include especially crafted objects in its responses that, once deserialized by the client, force it to execute arbitrary code. This can be abused to take control of the machine the client is running in. Version 3.22.0 contains a patch for this issue.

  Some post-fix advice is available. Do NOT use `Kryo5Codec` as deserialization codec, as it is still vulnerable to arbitrary object deserialization due to the `setRegistrationRequired(false)` call. On the contrary, `KryoCodec` is safe to use. The fix applied to `SerializationCodec` only consists of adding an optional allowlist of class names, even though making this behavior the default is recommended. When instantiating `SerializationCodec` please use the `SerializationCodec(ClassLoader classLoader, Set<String> allowedClasses)` constructor to restrict the allowed classes for deserialization.
impacted_packages:
  - purl: pkg:maven/org.redisson/redisson
    affected_versions: vers:maven/<3.22.0
    fixed_versions: vers:maven/3.22.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-4hvc-qwr2-f8rv/GHSA-4hvc-qwr2-f8rv.json
  - score: '9.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-4hvc-qwr2-f8rv/GHSA-4hvc-qwr2-f8rv.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://github.com/redisson/redisson
    reference_type:
    reference_id:
  - url: https://github.com/redisson/redisson/commit/fe6a2571801656ff1599ef87bdee20f519a5d1fe
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2023-053_Redisson
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-42809
    reference_type:
    reference_id: CVE-2023-42809
