advisory_id: GHSA-xhw3-wmx2-76wf
datasource_id: github_osv_importer_v2/GHSA-xhw3-wmx2-76wf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-xhw3-wmx2-76wf/GHSA-xhw3-wmx2-76wf.json
aliases:
  - CVE-2022-30950
summary: |
  Buffer overflow in Jenkins WMI Windows Agents plugin
  WMI Windows Agents Plugin 1.8 and earlier includes the Windows Remote Command library. It provides a general-purpose remote command execution capability that Jenkins uses to check if Java is available, and if not, to install it.

  This library has a buffer overflow vulnerability that may allow users able to connect to a named pipe to execute commands on the Windows agent machine.

  Additionally, while the processes are started as the user who connects to the named pipe, no access control takes place, potentially allowing users to start processes even if theyâ€™re not allowed to log in.

  WMI Windows Agents Plugin 1.8.1 no longer includes the Windows Remote Command library. A Java runtime is expected to be available on agent machines and WMI Windows Agents Plugin 1.8.1 does not install a JDK automatically otherwise.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/windows-slaves
    affected_versions: vers:maven/<1.8.1
    fixed_versions: vers:maven/1.8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-xhw3-wmx2-76wf/GHSA-xhw3-wmx2-76wf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-120
references:
  - url: https://github.com/jenkinsci/windows-slaves-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/windows-slaves-plugin/commit/4638cf0e56caf839eadfdf0fab545abd2a9ac65e
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2022-05-17/#SECURITY-2604
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2022/05/17/8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-30950
    reference_type:
    reference_id: CVE-2022-30950
