advisory_id: GHSA-r364-m2j9-mf4h
datasource_id: github_osv_importer_v2/GHSA-r364-m2j9-mf4h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-r364-m2j9-mf4h/GHSA-r364-m2j9-mf4h.json
aliases:
  - CVE-2024-2206
summary: |
  gradio Server-Side Request Forgery vulnerability
  An SSRF vulnerability exists in the gradio-app/gradio due to insufficient validation of user-supplied URLs in the `/proxy` route. Attackers can exploit this vulnerability by manipulating the `self.replica_urls` set through the `X-Direct-Url` header in requests to the `/` and `/config` routes, allowing the addition of arbitrary URLs for proxying. This flaw enables unauthorized proxying of requests and potential access to internal endpoints within the Hugging Face space. The issue arises from the application's inadequate checking of safe URLs in the `build_proxy_request` function.
impacted_packages:
  - purl: pkg:pypi/gradio
    affected_versions: vers:pypi/<4.18.0
    fixed_versions: vers:pypi/4.18.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-r364-m2j9-mf4h/GHSA-r364-m2j9-mf4h.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/gradio-app/gradio
    reference_type:
    reference_id:
  - url: https://github.com/gradio-app/gradio/commit/49d9c48537aa706bf72628e3640389470138bdc6
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/2286c1ed-b889-45d6-adda-7014ea06d98e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-2206
    reference_type:
    reference_id: CVE-2024-2206
