advisory_id: GHSA-434x-w66g-qw3r
datasource_id: github_osv_importer_v2/GHSA-434x-w66g-qw3r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-434x-w66g-qw3r/GHSA-434x-w66g-qw3r.json
aliases:
  - CVE-2026-25541
summary: |
  bytes has integer overflow in BytesMut::reserve
  # Details

  In the unique reclaim path of `BytesMut::reserve`, the condition
  ```rs
  if v_capacity >= new_cap + offset
  ```
  uses an unchecked addition. When `new_cap + offset` overflows `usize` in release builds, this condition may incorrectly pass, causing `self.cap` to be set to a value that exceeds the actual allocated capacity. Subsequent APIs such as `spare_capacity_mut()` then trust this corrupted `cap` value and may create out-of-bounds slices, leading to UB.

  This behavior is observable in release builds (integer overflow wraps), whereas debug builds panic due to overflow checks.

  ## PoC

  ```rs
  use bytes::*;

  fn main() {
      let mut a = BytesMut::from(&b"hello world"[..]);
      let mut b = a.split_off(5);

      // Ensure b becomes the unique owner of the backing storage
      drop(a);

      // Trigger overflow in new_cap + offset inside reserve
      b.reserve(usize::MAX - 6);

      // This call relies on the corrupted cap and may cause UB & HBO
      b.put_u8(b'h');
  }
  ```

  # Workarounds

  Users of `BytesMut::reserve` are only affected if integer overflow checks are configured to wrap. When integer overflow is configured to panic, this issue does not apply.

  This vulnerability is also known as [RUSTSEC-2026-0007](https://rustsec.org/advisories/RUSTSEC-2026-0007.html).
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-434x-w66g-qw3r/GHSA-434x-w66g-qw3r.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-680
references:
  - url: https://github.com/tokio-rs/bytes
    reference_type:
    reference_id:
  - url: https://github.com/tokio-rs/bytes/commit/d0293b0e35838123c51ca5dfdf468ecafee4398f
    reference_type:
    reference_id:
  - url: https://github.com/tokio-rs/bytes/releases/tag/v1.11.1
    reference_type:
    reference_id:
  - url: https://github.com/tokio-rs/bytes/security/advisories/GHSA-434x-w66g-qw3r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25541
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2026-0007.html
    reference_type:
    reference_id:
