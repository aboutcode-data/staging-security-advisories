advisory_id: GHSA-wr6v-9f75-vh2g
datasource_id: github_osv_importer_v2/GHSA-wr6v-9f75-vh2g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-wr6v-9f75-vh2g/GHSA-wr6v-9f75-vh2g.json
aliases:
  - CVE-2024-23653
summary: |
  Buildkit's interactive containers API does not validate entitlements check
  ### Impact
  In addition to running containers as build steps, BuildKit also provides APIs for running interactive containers based on built images. It was possible to use these APIs to ask BuildKit to run a container with elevated privileges. Normally, running such containers is only allowed if special `security.insecure` entitlement is enabled both by buildkitd configuration and allowed by the user initializing the build request.

  ### Patches
  The issue has been fixed in v0.12.5 .

  ### Workarounds
  Avoid using BuildKit frontends from untrusted sources. A frontend image is usually specified as the `#syntax` line on your Dockerfile, or with `--frontend` flag when using `buildctl build` command.

  ### References
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-wr6v-9f75-vh2g/GHSA-wr6v-9f75-vh2g.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/moby/buildkit
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/commit/5026d95aa3336e97cfe46e3764f52d08bac7a10e
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/commit/92cc595cfb12891d4b3ae476e067c74250e4b71e
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/pull/4602
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/releases/tag/v0.12.5
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/security/advisories/GHSA-wr6v-9f75-vh2g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23653
    reference_type:
    reference_id: CVE-2024-23653
