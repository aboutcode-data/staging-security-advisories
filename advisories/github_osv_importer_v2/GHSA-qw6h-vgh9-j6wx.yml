advisory_id: GHSA-qw6h-vgh9-j6wx
datasource_id: github_osv_importer_v2/GHSA-qw6h-vgh9-j6wx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-qw6h-vgh9-j6wx/GHSA-qw6h-vgh9-j6wx.json
aliases:
  - CVE-2024-43796
summary: |
  express vulnerable to XSS via response.redirect()
  ### Impact

  In express <4.20.0, passing untrusted user input - even after sanitizing it - to `response.redirect()` may execute untrusted code

  ### Patches

  this issue is patched in express 4.20.0

  ### Workarounds

  users are encouraged to upgrade to the patched version of express, but otherwise can workaround this issue by making sure any untrusted inputs are safe, ideally by validating them against an explicit allowlist

  ### Details

  successful exploitation of this vector requires the following:

  1. The attacker MUST control the input to response.redirect()
  1. express MUST NOT redirect before the template appears
  1. the browser MUST NOT complete redirection before:
  1. the user MUST click on the link in the template
impacted_packages:
  - purl: pkg:npm/express
    affected_versions: vers:npm/<4.20.0
    fixed_versions: vers:npm/4.20.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/express
    affected_versions: vers:npm/>=5.0.0-alpha.1|<5.0.0
    fixed_versions: vers:npm/5.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-qw6h-vgh9-j6wx/GHSA-qw6h-vgh9-j6wx.json
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-qw6h-vgh9-j6wx/GHSA-qw6h-vgh9-j6wx.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/expressjs/express
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/express/commit/54271f69b511fea198471e6ff3400ab805d6b553
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/express/security/advisories/GHSA-qw6h-vgh9-j6wx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43796
    reference_type:
    reference_id: CVE-2024-43796
