advisory_id: GHSA-2grw-mc9r-822r
datasource_id: github_osv_importer_v2/GHSA-2grw-mc9r-822r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-2grw-mc9r-822r/GHSA-2grw-mc9r-822r.json
aliases:
  - CVE-2024-28107
summary: "phpMyFAQ SQL injections at insertentry & saveentry\n### Summary\nA SQL injection vulnerability\
  \ has been discovered in the `insertentry` & `saveentry` when modifying records due to improper\
  \ escaping of the email address. This allows any authenticated user with the rights to add/edit\
  \ FAQ news to exploit this vulnerability to exfiltrate data, take over accounts and in some\
  \ cases, even achieve RCE.\n\n### PoC 1 - SQL Injection at insertentry:\n1. Browse to “/admin/?action=editentry”,\
  \ edit record and save. Intercept the POST request to \"/admin/?action=insertentry\" and modify\
  \ the email and notes parameters in the body to the payloads below:\n    a. `email=test'/*@email.com`\n\
  \    b. `notes=*/,1,1,1,1,null,1);select+pg_sleep(5)--`\n\n2. Send the request and notice\
  \ the `pg_sleep(5)` command is executed with a time delay of 5 seconds in the response. This\
  \ verifies that the SQL injection vulnerability exists.  \n    ![image](https://github.com/thorsten/phpMyFAQ/assets/63487456/1000482f-3b00-462a-be8a-1eb21f720aca)\n\
  \n### PoC 2 - SQL Injection at saveentry\n1. Browse to “/admin/?action=editentry”, edit record\
  \ and save. Intercept the POST request to \"/admin/?action=saveentry\" and modify the email\
  \ and notes parameters in the body to the payloads below:\n    a. `email=test'/*@email.com`\n\
  \    b. `*/,notes=(select+pg_sleep(5))--`\n 2. Send the request and notice the `pg_sleep(5)`\
  \ command is executed with a time delay of 5 seconds in the response. This verifies that the\
  \ SQL injection vulnerability exists.\n    ![image](https://github.com/thorsten/phpMyFAQ/assets/63487456/b1880ad1-1461-4735-9a67-9aa4d6c19b13)\n\
  \n\n### Impact\nThe SQL injection vulnerability discovered allows authenticated users with\
  \ appropriate privileges to execute malicious SQL queries, potentially leading to data exfiltration,\
  \ account takeover, and even remote code execution. Attackers can exploit the vulnerability\
  \ to read sensitive data from the database, such as user credentials and system files, compromising\
  \ the confidentiality and integrity of the system. Moreover, successful exploitation may enable\
  \ attackers to gain unauthorized access to user accounts or execute arbitrary commands on\
  \ the server, impacting both system administrators and end users."
impacted_packages:
  - purl: pkg:composer/phpmyfaq/phpmyfaq
    affected_versions: vers:composer/3.2.5
    fixed_versions: vers:composer/3.2.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-2grw-mc9r-822r/GHSA-2grw-mc9r-822r.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/thorsten/phpMyFAQ
    reference_type:
    reference_id:
  - url: https://github.com/thorsten/phpMyFAQ/commit/d0fae62a72615d809e6710861c1a7f67ac893007
    reference_type:
    reference_id:
  - url: https://github.com/thorsten/phpMyFAQ/security/advisories/GHSA-2grw-mc9r-822r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-28107
    reference_type:
    reference_id: CVE-2024-28107
