advisory_id: GHSA-hqv9-6jqw-9g8m
datasource_id: github_osv_importer_v2/GHSA-hqv9-6jqw-9g8m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-hqv9-6jqw-9g8m/GHSA-hqv9-6jqw-9g8m.json
aliases:
  - CVE-2023-37280
summary: |
  Pimcore admin UI vulnerable to Cross-site Scripting in 2 factor authentication setup page
  ### Summary

  Unauthenticated HTML Injection / XSS Possible.
  Conditions: 2factor authentication must not set before

   Vulnerable Endpoint: /admin/login/2fa-setup

   Vulnerable Param: error=
  How it works, So basically any admin, who has not setup 2 factor authentication before is vulnerable for this attack, without need for any form of privilege, causing the application to execute arbitrary scripts / HTML Contents.

  Another potential attack vector, as it's a 2fa page and it has QR Code, attacker can replace this QR Code with something he has, leading to increase threat to the admin.

  This attack can be used to execute arbitrary scripts or HTML Injection, causing the target application to execute these resulting in cookie steeling, defacement or Injecting phishing URLs on the target application.

  ### Patches
  Update to version 1.0.3 or apply this patches manually
  https://github.com/pimcore/admin-ui-classic-bundle/commit/5fcd19bdc89a3fe4cb8ad8c356590e1e4740c743.patch

  ### Workarounds
  Apply patches manually: https://github.com/pimcore/admin-ui-classic-bundle/commit/5fcd19bdc89a3fe4cb8ad8c356590e1e4740c743.patch

  ### References
  https://huntr.dev/bounties/1fa1cc3b-75ff-4d34-99ae-4a705eb623e7/
impacted_packages:
  - purl: pkg:composer/pimcore/admin-ui-classic-bundle
    affected_versions: vers:composer/<1.0.3
    fixed_versions: vers:composer/1.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-hqv9-6jqw-9g8m/GHSA-hqv9-6jqw-9g8m.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/pimcore/admin-ui-classic-bundle
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/admin-ui-classic-bundle/commit/5fcd19bdc89a3fe4cb8ad8c356590e1e4740c743
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/admin-ui-classic-bundle/pull/147
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/admin-ui-classic-bundle/security/advisories/GHSA-hqv9-6jqw-9g8m
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/1fa1cc3b-75ff-4d34-99ae-4a705eb623e7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-37280
    reference_type:
    reference_id: CVE-2023-37280
