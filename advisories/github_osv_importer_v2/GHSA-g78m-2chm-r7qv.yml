advisory_id: GHSA-g78m-2chm-r7qv
datasource_id: github_osv_importer_v2/GHSA-g78m-2chm-r7qv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/06/GHSA-g78m-2chm-r7qv/GHSA-g78m-2chm-r7qv.json
aliases:
  - CVE-2020-7662
summary: |
  Regular Expression Denial of Service in websocket-extensions (NPM package)
  ### Impact

  The ReDoS flaw allows an attacker to exhaust the server's capacity to process
  incoming requests by sending a WebSocket handshake request containing a header
  of the following form:

      Sec-WebSocket-Extensions: a; b="\c\c\c\c\c\c\c\c\c\c ...

  That is, a header containing an unclosed string parameter value whose content is
  a repeating two-byte sequence of a backslash and some other character. The
  parser takes exponential time to reject this header as invalid, and this will
  block the processing of any other work on the same thread. Thus if you are
  running a single-threaded server, such a request can render your service
  completely unavailable.

  ### Patches

  Users should upgrade to version 0.1.4.

  ### Workarounds

  There are no known work-arounds other than disabling any public-facing
  WebSocket functionality you are operating.

  ### References

  - https://blog.jcoglan.com/2020/06/02/redos-vulnerability-in-websocket-extensions/
impacted_packages:
  - purl: pkg:npm/websocket-extensions
    affected_versions: vers:npm/<0.1.4
    fixed_versions: vers:npm/0.1.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/06/GHSA-g78m-2chm-r7qv/GHSA-g78m-2chm-r7qv.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://blog.jcoglan.com/2020/06/02/redos-vulnerability-in-websocket-extensions
    reference_type:
    reference_id:
  - url: https://github.com/faye/websocket-extensions-node
    reference_type:
    reference_id:
  - url: https://github.com/faye/websocket-extensions-node/commit/29496f6838bfadfe5a2f85dff33ed0ba33873237
    reference_type:
    reference_id:
  - url: https://github.com/faye/websocket-extensions-node/security/advisories/GHSA-g78m-2chm-r7qv
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-WEBSOCKETEXTENSIONS-570623
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-7662
    reference_type:
    reference_id: CVE-2020-7662
