advisory_id: GHSA-7q3h-j95q-3vjh
datasource_id: github_osv_importer_v2/GHSA-7q3h-j95q-3vjh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-7q3h-j95q-3vjh/GHSA-7q3h-j95q-3vjh.json
aliases:
  - CVE-2024-21519
summary: |
  Arbitrary File Creation in opencart
  This affects versions of the package opencart/opencart from 4.0.0.0. An Arbitrary File Creation issue was identified via the database restoration functionality. By injecting PHP code into the database, an attacker with admin privileges can create a backup file with an arbitrary filename (including the extension), within /system/storage/backup.

  **Note:**

  It is less likely for the created file to be available within the web root, as part of the security recommendations for the application suggest moving the storage path outside of the web root.
impacted_packages:
  - purl: pkg:composer/opencart/opencart
    affected_versions: vers:composer/>=4.0.0+0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-7q3h-j95q-3vjh/GHSA-7q3h-j95q-3vjh.json
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:A/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-7q3h-j95q-3vjh/GHSA-7q3h-j95q-3vjh.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/opencart/opencart
    reference_type:
    reference_id:
  - url: https://github.com/opencart/opencart/blob/4.0.2.3/upload/admin/controller/tool/upload.php%23L353
    reference_type:
    reference_id:
  - url: https://github.com/opencart/opencart/blob/master/upload/admin/controller/tool/upload.php%23L353
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-PHP-OPENCARTOPENCART-7266579
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-21519
    reference_type:
    reference_id: CVE-2024-21519
