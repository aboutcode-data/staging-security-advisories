advisory_id: GHSA-7mx2-7q8p-pgmw
datasource_id: github_osv_importer_v2/GHSA-7mx2-7q8p-pgmw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-7mx2-7q8p-pgmw/GHSA-7mx2-7q8p-pgmw.json
aliases: []
summary: |
  Symfony may allow a user to switch to using another user's identity
  Symfony 2.0.6 has just been released. It addresses a security vulnerability in the EntityUserProvider as provided in the Doctrine bridge.

  If you let your users update their login/username from a form, and if you are using Doctrine as a user provider, then you are vulnerable and you should upgrade as soon as possible.

  The issue is that it is possible for a user to switch to another one. Here is how to reproduce it: The current user changes its username via a form to another existing username. When the form is submitted, he will have a validation error (as the username already exists) but the user object in the session will still be modified to the new username. This user from the session will be used for the next requests and so the user will be switched to this other user.

  The fix is to always refresh the user via the primary key (which cannot be updated via a form) instead of the username.

  If you cannot upgrade immediately, please apply the following patch: https://github.com/symfony/symfony/commit/9d2ab9ca9c1762
impacted_packages:
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=2.0.0|<2.0.6
    fixed_versions: vers:composer/2.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-7mx2-7q8p-pgmw/GHSA-7mx2-7q8p-pgmw.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/2011-11-16.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/9d2ab9ca9c1762
    reference_type:
    reference_id:
  - url: https://symfony.com/blog/security-release-symfony-2-0-6
    reference_type:
    reference_id:
