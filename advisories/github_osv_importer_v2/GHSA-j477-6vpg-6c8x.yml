advisory_id: GHSA-j477-6vpg-6c8x
datasource_id: github_osv_importer_v2/GHSA-j477-6vpg-6c8x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-j477-6vpg-6c8x/GHSA-j477-6vpg-6c8x.json
aliases:
  - CVE-2026-1237
summary: |
  Juju has broken CMR authorization
  ### Impact

  Cross-model Relation authorization is broken and has a potential security vulnerability. If the controller does not have the root key to verify the macaroon (or if the macaroon has expired), an unvalidated and therefore untrusted macaroon is used to extract declared caveats. Facts from these caveats are then blindly used to mint a new macaroon that becomes valid.

  ### Scenario

  A user knows that user X has access to offer Y. The user mints a macaroon stating that user X has access to offer Y and sends it to the controller in a request. The controller fails to verify the macaroon because it lacks the root key and mints a new macaroon requiring proof that user X has access to offer Y. Since user X does have access and the discharge endpoint does not require authentication, the controller returns the new macaroon. The user can then use the returned macaroon to consume the offer as user X.

  ### Patches

  N/A

  ### Workarounds

  A previous proposal via [this PR](https://github.com/juju/juju/pull/21062) addresses the issue but would break model migrations since macaroon root keys are not included in model descriptions. Additionally, root keys are not model-scoped, making it unclear which keys to transfer during migration.
impacted_packages: []
severities:
  - score: '2.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:A/AC:H/AT:P/PR:L/UI:N/VC:L/VI:L/VA:L/SC:L/SI:L/SA:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-j477-6vpg-6c8x/GHSA-j477-6vpg-6c8x.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-347
references:
  - url: https://github.com/juju/juju
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/pull/21062
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/security/advisories/GHSA-j477-6vpg-6c8x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-1237
    reference_type:
    reference_id:
