advisory_id: GHSA-fm67-cv37-96ff
datasource_id: github_osv_importer_v2/GHSA-fm67-cv37-96ff
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-fm67-cv37-96ff/GHSA-fm67-cv37-96ff.json
aliases:
  - CVE-2022-31117
summary: |
  Potential double free of buffer during string decoding
  ### Impact
  _What kind of vulnerability is it? Who is impacted?_

  When an error occurs while reallocating the buffer for string decoding, the buffer gets freed twice.

  Due to how UltraJSON uses the internal decoder, this double free is impossible to trigger from Python.

  ### Patches
  _Has the problem been patched? What versions should users upgrade to?_

  Users should upgrade to UltraJSON 5.4.0.

  ### Workarounds
  _Is there a way for users to fix or remediate the vulnerability without upgrading?_

  There is no workaround.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [UltraJSON](http://github.com/ultrajson/ultrajson/issues)
impacted_packages:
  - purl: pkg:pypi/ujson
    affected_versions: vers:pypi/<5.4.0
    fixed_versions: vers:pypi/5.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-fm67-cv37-96ff/GHSA-fm67-cv37-96ff.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-415
references:
  - url: https://github.com/ultrajson/ultrajson
    reference_type:
    reference_id:
  - url: https://github.com/ultrajson/ultrajson/commit/9c20de0f77b391093967e25d01fb48671104b15b
    reference_type:
    reference_id:
  - url: https://github.com/ultrajson/ultrajson/security/advisories/GHSA-fm67-cv37-96ff
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NAU5N4A7EUK2AMUCOLYDD5ARXAJYZBD2
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OPPU5FZP3LCTXYORFH7NHUMYA5X66IA7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31117
    reference_type:
    reference_id: CVE-2022-31117
