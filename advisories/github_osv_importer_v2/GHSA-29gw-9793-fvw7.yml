advisory_id: GHSA-29gw-9793-fvw7
datasource_id: github_osv_importer_v2/GHSA-29gw-9793-fvw7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-29gw-9793-fvw7/GHSA-29gw-9793-fvw7.json
aliases:
  - CVE-2023-24816
summary: "IPython vulnerable to command injection via set_term_title\nIPython provides an interactive\
  \ Python shell and Jupyter kernel to use Python interactively. Versions prior to 8.10.0 are\
  \ vulnerable to command injection in the `set_term_title` [function](https://github.com/ipython/ipython/blob/3f0bf05f072a91b2a3042d23ce250e5e906183fd/IPython/utils/terminal.py#L103-L117)\
  \ under specific conditions. This has been patched in version 8.10.0.\n\n### Impact \nUsers\
  \ are only vulnerable when calling this function in Windows in a Python environment where\
  \ [ctypes](https://docs.python.org/3/library/ctypes.html) is not available. The dependency\
  \ on ctypes in `IPython.utils._process_win32` prevents the vulnerable code from ever being\
  \ reached (making it effectively dead code). However, as a library that could be used by another\
  \ tool, `set_term_title` could introduce a vulnerability for dependencies. Currently `set_term_title`\
  \ is only called with (semi-)trusted input that contain the current working directory of the\
  \ current IPython session. If an attacker can control directory names, and manage to get a\
  \ user to `cd` into this directory, then the attacker can execute arbitrary commands contained\
  \ in the folder names."
impacted_packages:
  - purl: pkg:pypi/ipython
    affected_versions: vers:pypi/<8.10.0
    fixed_versions: vers:pypi/8.10.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-29gw-9793-fvw7/GHSA-29gw-9793-fvw7.json
  - score: '2.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:N/UI:P/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-29gw-9793-fvw7/GHSA-29gw-9793-fvw7.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-78
references:
  - url: https://github.com/Carreau/ipython/blob/7557ade0ed927475d5ab5b573d0ea4febfb22683/docs/source/whatsnew/version8.rst#ipython-810
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython/blob/3f0bf05f072a91b2a3042d23ce250e5e906183fd/IPython/utils/terminal.py#L103-L117
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython/blob/56e6925dfa50e2c7f4a6471547b8176275db7c25/IPython/utils/_process_win32.py#L20
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython/commit/385d69325319a5972ee9b5983638e3617f21cb1f
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython/commit/991849c247fc208628879e7ca2923b3c218a5a75
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython/security/advisories/GHSA-29gw-9793-fvw7
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/ipython/PYSEC-2023-17.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-24816
    reference_type:
    reference_id: CVE-2023-24816
