advisory_id: GHSA-m2mj-pr4f-h9jp
datasource_id: github_osv_importer_v2/GHSA-m2mj-pr4f-h9jp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-m2mj-pr4f-h9jp/GHSA-m2mj-pr4f-h9jp.json
aliases:
  - CVE-2023-48299
summary: |
  TorchServe ZipSlip
  ### Impact
  Using the model/workflow management API, there is a chance of uploading potentially harmful archives that contain files that are extracted to any location on the filesystem that is within the process permissions. Leveraging this issue could aid third-party actors in hiding harmful code in open-source/public models, which can be downloaded from the internet, and take advantage of machines running Torchserve.

  ### Patches
  The ZipSlip issue in TorchServe has been fixed by validating the paths of files contained within a zip archive before extracting them: https://github.com/pytorch/serve/pull/2634

  TorchServe release 0.9.0 includes fixes to address the ZipSlip vulnerability:
  https://github.com/pytorch/serve/releases/tag/v0.9.0

  ### References
  https://github.com/pytorch/serve/pull/2634
  https://github.com/pytorch/serve/releases/tag/v0.9.0

  ### Credit
  We would like to thank Oligo Security for responsibly disclosing this issue.

  If you have any questions or comments about this advisory, we ask that you contact AWS Security via our [vulnerability reporting page](https://aws.amazon.com/security/vulnerability-reporting) or directly via email to [aws-security@amazon.com](mailto:aws-security@amazon.com). Please do not create a public GitHub issue.
impacted_packages:
  - purl: pkg:pypi/torchserve
    affected_versions: vers:pypi/>=0.1.0|<0.9.0
    fixed_versions: vers:pypi/0.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-m2mj-pr4f-h9jp/GHSA-m2mj-pr4f-h9jp.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/pytorch/serve
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/commit/bfb3d42396727614aef625143b4381e64142f9bb
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/pull/2634
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/releases/tag/v0.9.0
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/security/advisories/GHSA-m2mj-pr4f-h9jp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-48299
    reference_type:
    reference_id: CVE-2023-48299
