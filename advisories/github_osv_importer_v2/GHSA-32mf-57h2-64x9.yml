advisory_id: GHSA-32mf-57h2-64x9
datasource_id: github_osv_importer_v2/GHSA-32mf-57h2-64x9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-32mf-57h2-64x9/GHSA-32mf-57h2-64x9.json
aliases:
  - CVE-2025-53836
summary: |
  XWiki Rendering is vulnerable to RCE attacks when processing nested macros
  ### Impact

  The default macro content parser didn't preserve the restricted attribute of the transformation context when executing nested macros. This allows executing macros that are normally forbidden in restricted mode, in particular script macros. The [cache](https://extensions.xwiki.org/xwiki/bin/view/Extension/Cache%20Macro) and [chart](https://extensions.xwiki.org/xwiki/bin/view/Extension/Chart%20Macro) macros that are bundled in XWiki use the vulnerable feature. The following XWiki syntax, when used inside a comment in XWiki, demonstrates the privilege escalation from comment right to programming right and thus remote code execution (RCE) that is possible due to this:

  ```
  {{cache}}{{groovy}}println("Hello from Groovy!"){{/groovy}}{{/cache}}
  ```

  This vulnerability exists since the restricted attribute has been added to the transformation context in version 4.2.

  ### Patches
  This has been patched in XWiki 13.10.11, 14.4.7 and 14.10.

  ### Workarounds
  To avoid the exploitation of this bug, comments can be disabled for untrusted users until an upgrade to a patched version has been performed. Note that users with edit rights will still be able to add comments via the object editor even if comments have been disabled.

  ### Resources
  * https://github.com/xwiki/xwiki-rendering/commit/c73fa3ccd4ac59057e48e5d4325f659e78e8f86d
  * https://jira.xwiki.org/browse/XRENDERING-689
  * https://jira.xwiki.org/browse/XWIKI-20375

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  * Email us at [Security Mailing List](mailto:security@xwiki.org)

  ### Attribution

  This vulnerability has been reported on Intigriti by RenÃ© de Sain @renniepak.
impacted_packages:
  - purl: pkg:maven/org.xwiki.rendering/xwiki-rendering-transformation-macro
    affected_versions: vers:maven/>=4.2-milestone-1|<13.10.11
    fixed_versions: vers:maven/13.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.rendering/xwiki-rendering-transformation-macro
    affected_versions: vers:maven/>=14.0|<14.4.7
    fixed_versions: vers:maven/14.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.rendering/xwiki-rendering-transformation-macro
    affected_versions: vers:maven/>=14.5|<14.10
    fixed_versions: vers:maven/14.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-32mf-57h2-64x9/GHSA-32mf-57h2-64x9.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
  - CWE-94
references:
  - url: https://github.com/xwiki/xwiki-rendering
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-rendering/commit/c73fa3ccd4ac59057e48e5d4325f659e78e8f86d
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-rendering/security/advisories/GHSA-32mf-57h2-64x9
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XRENDERING-689
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20375
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-53836
    reference_type:
    reference_id: CVE-2025-53836
