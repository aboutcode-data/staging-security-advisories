advisory_id: GHSA-65v7-wg35-2qpm
datasource_id: github_osv_importer_v2/GHSA-65v7-wg35-2qpm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-65v7-wg35-2qpm/GHSA-65v7-wg35-2qpm.json
aliases: []
summary: |
  Sylius Resource Bundle Cross-Site Request Forgery vulnerability
  Sylius 1.0.0 to 1.0.16, 1.1.0 to 1.1.8, 1.2.0 to 1.2.1 versions of AdminBundle and ResourceBundle are affected by this security issue.

  This issue has been fixed in Sylius 1.0.17, 1.1.9 and 1.2.2. Development branch for 1.3 release has also been fixed.

  ### Description

  The following actions in the admin panel did not require a CSRF token:

  - marking order’s payment as completed
  - marking order’s payment as refunded
  - marking product review as accepted
  - marking product review as rejected

  ### Resolution

  The issue is fixed by adding a required CSRF token to those actions.

  We also fixed `ResourceController`‘s  `applyStateMachineTransitionAction` method by adding a CSRF token check. If you use that action in the API context, you can disable it by adding `csrf_protection:` false to its routing configuration
impacted_packages:
  - purl: pkg:composer/sylius/resource-bundle
    affected_versions: vers:composer/>=1.0.0|<1.0.17
    fixed_versions: vers:composer/1.0.17
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/resource-bundle
    affected_versions: vers:composer/>=1.1.0|<1.1.9
    fixed_versions: vers:composer/1.1.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/resource-bundle
    affected_versions: vers:composer/>=1.2.0|<1.2.2
    fixed_versions: vers:composer/1.2.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-65v7-wg35-2qpm/GHSA-65v7-wg35-2qpm.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/sylius/sylius/2018-07-09.yaml
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/SyliusResourceBundle
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/SyliusResourceBundle/commit/9720ac5a0a39ea2c2a395ef16a94a00aa86c418b
    reference_type:
    reference_id:
  - url: https://sylius.com/blog/csrf-vulnerability-in-admin-panel
    reference_type:
    reference_id:
