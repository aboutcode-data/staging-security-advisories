advisory_id: GHSA-q69p-5h74-w36f
datasource_id: github_osv_importer_v2/GHSA-q69p-5h74-w36f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/11/GHSA-q69p-5h74-w36f/GHSA-q69p-5h74-w36f.json
aliases:
  - CVE-2017-1000043
summary: |
  Content Injection via TileJSON Name in mapbox.js
  Versions 1.x prior to 1.6.6 and 2.x prior to 2.2.4 of `mapbox.js` are vulnerable to a cross-site-scripting attack in certain uncommon usage scenarios.

  If `L.mapbox.map` or `L.mapbox.shareControl` are used in a manner that gives users control of the TileJSON content, it is possible to inject script content into the name value of the TileJSON. After clicking on the share control, the malicious code will execute in the context of the page using Mapbox.js.



  ## Recommendation

  Version 1.x: Update to version 1.6.6 or later.
  Version 2.x: Update to version 2.2.4 or later.
impacted_packages:
  - purl: pkg:npm/mapbox.js
    affected_versions: vers:npm/<1.6.6
    fixed_versions: vers:npm/1.6.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/mapbox.js
    affected_versions: vers:npm/>=2.0.0|<2.2.4
    fixed_versions: vers:npm/2.2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/mapbox-rails
    affected_versions: vers:gem/>=1.0.0|<1.6.6
    fixed_versions: vers:gem/1.6.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/mapbox-rails
    affected_versions: vers:gem/>=2.0.0|<2.2.4
    fixed_versions: vers:gem/2.2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/11/GHSA-q69p-5h74-w36f/GHSA-q69p-5h74-w36f.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/advisories/GHSA-q69p-5h74-w36f
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/mapbox-rails/CVE-2017-1000043.yml
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/99245
    reference_type:
    reference_id:
  - url: https://nodesecurity.io/advisories/74
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/74
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-1000043
    reference_type:
    reference_id: CVE-2017-1000043
