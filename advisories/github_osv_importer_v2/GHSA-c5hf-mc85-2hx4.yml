advisory_id: GHSA-c5hf-mc85-2hx4
datasource_id: github_osv_importer_v2/GHSA-c5hf-mc85-2hx4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-c5hf-mc85-2hx4/GHSA-c5hf-mc85-2hx4.json
aliases:
  - CVE-2022-0984
summary: |
  Missing authorization in Moodle
  Users with the capability to configure badge criteria (teachers and managers by default) were able to configure course badges with profile field criteria, which should only be available for site badges.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.11.0|<3.11.6
    fixed_versions: vers:composer/3.11.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.10.0|<3.10.10
    fixed_versions: vers:composer/3.10.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<3.9.13
    fixed_versions: vers:composer/3.9.13
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-c5hf-mc85-2hx4/GHSA-c5hf-mc85-2hx4.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2064118
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2064125
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/cdc78a16a5da95a17fb10bf1c66689237f5a3f7d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-0984
    reference_type:
    reference_id: CVE-2022-0984
