advisory_id: GHSA-grvv-h2f9-7v9c
datasource_id: github_osv_importer_v2/GHSA-grvv-h2f9-7v9c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-grvv-h2f9-7v9c/GHSA-grvv-h2f9-7v9c.json
aliases:
  - CVE-2022-36009
summary: |
  gomatrixserverlib and Dendrite vulnerable to incorrect parsing of the event default power level in event auth
  ### Impact

  The power level parsing within gomatrixserverlib was failing to parse the `"events_default"` key of the `m.room.power_levels` event, defaulting the event default power level to zero in all cases.

  In rooms where the `"events_default"` power level had been changed, this could result in events either being incorrectly authorised or rejected by Dendrite servers.

  ### Patches

  gomatrixserverlib contains a fix as of commit `723fd49` and Dendrite 0.9.3 has been updated accordingly.

  ### Workarounds

  Matrix rooms where the `"events_default"` power level has not been changed from the default of zero are not vulnerable.

  ### For more information

  If you have any questions or comments about this advisory, e-mail us at [security@matrix.org](mailto:security@matrix.org).
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-grvv-h2f9-7v9c/GHSA-grvv-h2f9-7v9c.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/matrix-org/gomatrixserverlib
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/gomatrixserverlib/commit/723fd495dde835d078b9f2074b6b62c06dea4575
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/gomatrixserverlib/security/advisories/GHSA-grvv-h2f9-7v9c
    reference_type:
    reference_id:
  - url: https://matrix.org/docs/guides/moderation/#power-levels
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-0952
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-36009
    reference_type:
    reference_id: CVE-2022-36009
