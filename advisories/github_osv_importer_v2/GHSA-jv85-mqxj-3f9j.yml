advisory_id: GHSA-jv85-mqxj-3f9j
datasource_id: github_osv_importer_v2/GHSA-jv85-mqxj-3f9j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-jv85-mqxj-3f9j/GHSA-jv85-mqxj-3f9j.json
aliases:
  - CVE-2022-23485
summary: |
  Sentry vulnerable to invite code reuse via cookie manipulation
  With a known valid invite link (i.e. not already accepted or expired) an unauthenticated attacker can manipulate the cookie to allow the same invite link to be reused on multiple accounts when joining an organization.

  ### Impact
  An attacker with a valid invite link can create multiple users and join the organization from which the invite link was generated.

  ### Patches
  This issue was patched in version 22.11.0.

  ### Workarounds
  Sentry SaaS customers do not need to take action.

  Self-hosted Sentry installs can disable the invite functionality until they are ready to deploy the patched version by editing their `sentry.conf.py` file (usually located at `~/.sentry/`).

  1. Add the following line into `sentry.conf.py`:

      ```python
       SENTRY_FEATURES["organizations:invite-members"] = False
      ```
  2. Restart the Sentry web service.

      ```
      docker compose restart web
      ```

  ### For more information
  If you have any questions or comments about this advisory:
  * [Visit our FAQs on this CVE](https://help.sentry.io/account/security/cve-2022-23485-faqs/)
  * Open an issue in [getsentry/sentry](http://github.com/getsentry/sentry)
  * Email us at security[@]sentry.io
impacted_packages:
  - purl: pkg:pypi/sentry
    affected_versions: vers:pypi/>=20.6.0|<22.11.0
    fixed_versions: vers:pypi/22.11.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-jv85-mqxj-3f9j/GHSA-jv85-mqxj-3f9j.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
  - CWE-284
references:
  - url: https://github.com/getsentry/sentry
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry/commit/565f971da955d57c754a47f5802fe9f9f7c66b39
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry/security/advisories/GHSA-jv85-mqxj-3f9j
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/sentry/PYSEC-2022-43011.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23485
    reference_type:
    reference_id: CVE-2022-23485
