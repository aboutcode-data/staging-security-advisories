advisory_id: GHSA-vqp6-rc3h-83cp
datasource_id: github_osv_importer_v2/GHSA-vqp6-rc3h-83cp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-vqp6-rc3h-83cp/GHSA-vqp6-rc3h-83cp.json
aliases:
  - CVE-2022-41924
summary: "Tailscale Windows daemon is vulnerable to RCE via CSRF\nA vulnerability identified\
  \ in the Tailscale Windows client allows a malicious website to reconfigure the Tailscale\
  \ daemon `tailscaled`, which can then be used to remotely execute code.\n\n**Affected platforms:**\
  \ Windows\n**Patched Tailscale client versions:** v1.32.3 or later, v1.33.257 or later (unstable)\n\
  \n### What happened?\nIn the Tailscale Windows client, the local API was bound to a local\
  \ TCP socket, and communicated with the Windows client GUI in cleartext with no Host header\
  \ verification. This allowed an attacker-controlled website visited by the node to rebind\
  \ DNS to an attacker-controlled DNS server, and then make local API requests in the client,\
  \ including changing the coordination server to an attacker-controlled coordination server.\n\
  \n### Who is affected?\nAll Windows clients prior to version v.1.32.3 are affected.\n\n###\
  \ What should I do?\nIf you are running Tailscale on Windows, upgrade to v1.32.3 or later\
  \ to remediate the issue.\n\n### What is the impact?\nAn attacker-controlled coordination\
  \ server can send malicious URL responses to the client, including pushing executables or\
  \ installing an SMB share. These allow the attacker to remotely execute code on the node.\n\
  \nReviewing all logs confirms this vulnerability was not triggered or exploited. \n\n### Credits\n\
  We would like to thank [Emily Trau](https://github.com/emilytrau) and [Jamie McClymont (CyberCX)](https://twitter.com/JJJollyjim)\
  \ for reporting this issue. Further detail is available in [their blog post](https://emily.id.au/tailscale).\n\
  \n### References\n* [TS-2022-004](https://tailscale.com/security-bulletins/#ts-2022-004)\n\
  * [Researcher blog post](https://emily.id.au/tailscale)\n\n### For more information\nIf you\
  \ have any questions or comments about this advisory, [contact Tailscale support](https://tailscale.com/contact/support/)."
impacted_packages: []
severities:
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-vqp6-rc3h-83cp/GHSA-vqp6-rc3h-83cp.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
  - CWE-346
references:
  - url: https://emily.id.au/tailscale
    reference_type:
    reference_id:
  - url: https://github.com/tailscale/tailscale
    reference_type:
    reference_id:
  - url: https://github.com/tailscale/tailscale/releases/tag/v1.32.3
    reference_type:
    reference_id:
  - url: https://github.com/tailscale/tailscale/security/advisories/GHSA-vqp6-rc3h-83cp
    reference_type:
    reference_id:
  - url: https://tailscale.com/security-bulletins/#ts-2022-004
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-41924
    reference_type:
    reference_id: CVE-2022-41924
