advisory_id: GHSA-rw54-6826-c8j5
datasource_id: github_osv_importer_v2/GHSA-rw54-6826-c8j5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-rw54-6826-c8j5/GHSA-rw54-6826-c8j5.json
aliases:
  - CVE-2023-50714
summary: |
  yiisoft/yii2-authclient's Oauth2 PKCE implementation is vulnerable
  ### Impact
  _What kind of vulnerability is it? Who is impacted?_

  Original Report:

  > The Oauth2 PKCE implementation is vulnerable in 2 ways:
  > 1. The `authCodeVerifier` should be removed after usage (similar to 'authState')
  > 2. There is a risk for a "downgrade attack" if PKCE is being relied on for CSRF protection.

  ### Patches
  _Has the problem been patched? What versions should users upgrade to?_

  2.2.15

  ### Workarounds
  _Is there a way for users to fix or remediate the vulnerability without upgrading?_

  not known yet.

  ### References
  _Are there any links users can visit to find out more?_
impacted_packages:
  - purl: pkg:composer/yiisoft/yii2-authclient
    affected_versions: vers:composer/<2.2.15
    fixed_versions: vers:composer/2.2.15
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-rw54-6826-c8j5/GHSA-rw54-6826-c8j5.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-347
  - CWE-287
references:
  - url: https://github.com/yiisoft/yii2-authclient
    reference_type:
    reference_id:
  - url: https://github.com/yiisoft/yii2-authclient/blob/0d1c3880f4d79e20aa1d77c012650b54e69695ff/src/OAuth1.php#L158
    reference_type:
    reference_id:
  - url: https://github.com/yiisoft/yii2-authclient/blob/0d1c3880f4d79e20aa1d77c012650b54e69695ff/src/OAuth2.php#L121
    reference_type:
    reference_id:
  - url: https://github.com/yiisoft/yii2-authclient/blob/0d1c3880f4d79e20aa1d77c012650b54e69695ff/src/OpenIdConnect.php#L420
    reference_type:
    reference_id:
  - url: https://github.com/yiisoft/yii2-authclient/commit/721ed974bc44137437b0cdc8454e137fff8db213
    reference_type:
    reference_id:
  - url: https://github.com/yiisoft/yii2-authclient/security/advisories/GHSA-rw54-6826-c8j5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-50714
    reference_type:
    reference_id: CVE-2023-50714
