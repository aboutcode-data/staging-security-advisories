advisory_id: GHSA-rrqm-p222-8ph2
datasource_id: github_osv_importer_v2/GHSA-rrqm-p222-8ph2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/02/GHSA-rrqm-p222-8ph2/GHSA-rrqm-p222-8ph2.json
aliases:
  - CVE-2021-21304
summary: |
  Prototype Pollution in Dynamoose
  ### Impact

  In Dynamoose versions 2.0.0-2.6.0 there was a prototype pollution vulnerability in the internal utility method [`lib/utils/object/set.ts`](https://github.com/dynamoose/dynamoose/blob/master/lib/utils/object/set.ts). This method is used throughout the codebase for various operations throughout Dynamoose.

  We have not seen any evidence of this vulnerability being exploited.

  We do not believe this issue impacts v1.x.x since this method was added as part of the v2 rewrite. This vulnerability also impacts v2.x.x beta/alpha versions.

  ### Patches

  v2.7.0 includes a patch for this vulnerability.

  ### Workarounds

  We are unaware of any workarounds to patch this vulnerability other than upgrading to v2.7.0 or greater.

  ### References

  - Patch commit hash: 324c62b4709204955931a187362f8999805b1d8e

  ### For more information

  If you have any questions or comments about this advisory:

  * [Contact me](https://charlie.fish/contact)
  * [Read our Security Policy](https://github.com/dynamoose/dynamoose/blob/master/SECURITY.md)

  ### Credit

  - GitHub CodeQL Code Scanning
impacted_packages:
  - purl: pkg:npm/dynamoose
    affected_versions: vers:npm/>=2.0.0|<2.7.0
    fixed_versions: vers:npm/2.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/02/GHSA-rrqm-p222-8ph2/GHSA-rrqm-p222-8ph2.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1321
  - CWE-915
references:
  - url: https://github.com/dynamoose/dynamoose
    reference_type:
    reference_id:
  - url: https://github.com/dynamoose/dynamoose/commit/324c62b4709204955931a187362f8999805b1d8e
    reference_type:
    reference_id:
  - url: https://github.com/dynamoose/dynamoose/releases/tag/v2.7.0
    reference_type:
    reference_id:
  - url: https://github.com/dynamoose/dynamoose/security/advisories/GHSA-rrqm-p222-8ph2
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/dynamoose
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21304
    reference_type:
    reference_id: CVE-2021-21304
