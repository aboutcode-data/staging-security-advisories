advisory_id: GHSA-95qg-89c2-w5hj
datasource_id: github_osv_importer_v2/GHSA-95qg-89c2-w5hj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-95qg-89c2-w5hj/GHSA-95qg-89c2-w5hj.json
aliases:
  - CVE-2025-69257
summary: |
  theshit vulnerable to unsafe loading of user-owned Python rules when running as root
  ### Impact

  **Vulnerability Type:** Local Privilege Escalation (LPE) / Arbitrary Code Execution.

  The application loads custom Python rules and configuration files from user-writable locations (e.g., `~/.config/theshit/`) without validating ownership or permissions when executed with elevated privileges.

  If the tool is invoked with `sudo` or otherwise runs with an effective UID of root, it continues to trust configuration files originating from the unprivileged user's environment. This allows a local attacker to inject arbitrary Python code via a malicious rule or configuration file, which is then executed with root privileges.

  **Who is impacted:**
  Any system where this tool is executed with elevated privileges is affected. In environments where the tool is permitted to run via `sudo` without a password (`NOPASSWD`), a local unprivileged user can escalate privileges to root without additional interaction.

  ### Patches

  The issue has been fixed in version **0.1.1**.

  The patch introduces strict ownership and permission checks for all configuration files and custom rules. The application now enforces that rules are only loaded if they are owned by the effective user executing the tool.

  When executed with elevated privileges (`EUID=0`), the application refuses to load any files that are not owned by root or that are writable by non-root users. When executed as a non-root user, it similarly refuses to load rules owned by other users. This prevents both vertical and horizontal privilege escalation via execution of untrusted code.

  ### Workarounds

  If upgrading is not possible, users should avoid executing the pplication with `sudo` or as the root user.

  As a temporary mitigation, ensure that directories containing custom rules and configuration files are owned by root and are not writable by non-root users. Administrators may also audit existing custom rules before running the tool with elevated privileges.

  ### References

  * [Commit fixing the issue](https://github.com/AsfhtgkDavid/theshit/commit/3dc12905cafb5fd47fff4071a05c231f925ac113)
  * CWE-269: Improper Privilege Management
  * CWE-284: Improper Access Control
  * CWE-829: Inclusion of Functionality from Untrusted Control Sphere
impacted_packages: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-95qg-89c2-w5hj/GHSA-95qg-89c2-w5hj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/AsfhtgkDavid/theshit
    reference_type:
    reference_id:
  - url: https://github.com/AsfhtgkDavid/theshit/commit/8e0b565e7876a83b0e1cfbacb8af39dadfdcc500
    reference_type:
    reference_id:
  - url: https://github.com/AsfhtgkDavid/theshit/security/advisories/GHSA-95qg-89c2-w5hj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-69257
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2025-0139.html
    reference_type:
    reference_id:
