advisory_id: GHSA-x77r-7m5w-pqq2
datasource_id: github_osv_importer_v2/GHSA-x77r-7m5w-pqq2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-x77r-7m5w-pqq2/GHSA-x77r-7m5w-pqq2.json
aliases:
  - CVE-2021-21679
summary: |
  Jenkins Azure AD Plugin allows bypassing CSRF protection for any URL
  An extension point in Jenkins allows selectively disabling cross-site request forgery (CSRF) protection for specific URLs. Jenkins Azure AD Plugin implements this extension point for URLs used by a JavaScript component.

  In Jenkins Azure AD Plugin 179.vf6841393099e and earlier this implementation is too permissive, allowing attackers to craft URLs that would bypass the CSRF protection of any target URL.

  This vulnerability was originally introduced in Azure AD Plugin 164.v5b48baa961d2.

  Azure AD Plugin 180.v8b1e80e6f242 no longer allows bypassing CSRF protection for URLs used by the JavaScript component. Instead, that component was reconfigured to pass the expected CSRF token.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/azure-ad
    affected_versions: vers:maven/<=179.vf6841393099e
    fixed_versions: vers:maven/180.v8b1e80e6f242
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-x77r-7m5w-pqq2/GHSA-x77r-7m5w-pqq2.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
  - CWE-693
references:
  - url: https://github.com/jenkinsci/azure-ad-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/azure-ad-plugin/commit/8b1e80e6f242275127ebb177e2a755a2104b4853
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2021-08-31/#SECURITY-2470
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/08/31/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21679
    reference_type:
    reference_id: CVE-2021-21679
