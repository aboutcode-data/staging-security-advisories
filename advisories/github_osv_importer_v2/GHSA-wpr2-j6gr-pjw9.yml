advisory_id: GHSA-wpr2-j6gr-pjw9
datasource_id: github_osv_importer_v2/GHSA-wpr2-j6gr-pjw9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-wpr2-j6gr-pjw9/GHSA-wpr2-j6gr-pjw9.json
aliases: []
summary: |
  OpenTofu potential leaking of secret variable values when using static evaluation in v1.8
  ### Impact
  Users who have opted into static evaluation of module sources, versions, and backend configurations may be at risk of exposing sensitive variables and locals.  This is a workflow that should not be possible and explicitly show errors.

  ### Workarounds
  Check that you are not using sensitive variables in module sources and versions, as well as backend configurations.  The patch will add explicit errors and prevent this from being possible.

  ### Examples
  ```hcl
  variable "backend_path" {
          type = string
          sensitive = true
  }

  terraform {
          backend "local" {
                  path = var.backend_path
          }
  }
  ```

  ```hcl
  variable "mod_info" {
          type = string
          sensitive = true
  }

  module "foo" {
          source = var.mod_info
          //version = var.mod_info
  }
  ```
impacted_packages: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-wpr2-j6gr-pjw9/GHSA-wpr2-j6gr-pjw9.json
  - score: '2.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-wpr2-j6gr-pjw9/GHSA-wpr2-j6gr-pjw9.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/opentofu/opentofu
    reference_type:
    reference_id:
  - url: https://github.com/opentofu/opentofu/security/advisories/GHSA-wpr2-j6gr-pjw9
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3182
    reference_type:
    reference_id:
