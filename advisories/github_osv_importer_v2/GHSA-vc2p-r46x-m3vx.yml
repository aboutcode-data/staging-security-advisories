advisory_id: GHSA-vc2p-r46x-m3vx
datasource_id: github_osv_importer_v2/GHSA-vc2p-r46x-m3vx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-vc2p-r46x-m3vx/GHSA-vc2p-r46x-m3vx.json
aliases:
  - CVE-2020-28247
summary: |
  Argument injection in lettre
  ### Impact

  Affected versions of lettre allowed argument injection to the sendmail command. It was possible, using forged to addresses, to pass arbitrary arguments to the sendmail executable.

  Depending on the implementation (original sendmail, postfix, exim, etc.) it could be possible in some cases to write email data into abritrary files (using sendmail's logging features).

  *NOTE*: This vulnerability only affects the sendmail transport. Others, including smtp, are not affected.

  ### Fix

  The flaw is corrected by modifying the executed command to stop parsing arguments before passing the destination addresses.

  ### References

  * [RUSTSEC-2020-0069](https://rustsec.org/advisories/RUSTSEC-2020-0069.html)
  * [CVE-2020-28247](https://nvd.nist.gov/vuln/detail/CVE-2020-28247)
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-vc2p-r46x-m3vx/GHSA-vc2p-r46x-m3vx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
references:
  - url: https://github.com/lettre/lettre
    reference_type:
    reference_id:
  - url: https://github.com/lettre/lettre/pull/508/commits/bbe7cc5381c5380b54fb8bbb4f77a3725917ff0b
    reference_type:
    reference_id:
  - url: https://github.com/lettre/lettre/security/advisories/GHSA-vc2p-r46x-m3vx
    reference_type:
    reference_id:
  - url: https://github.com/RustSec/advisory-db/pull/478/files
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2020-0069.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-28247
    reference_type:
    reference_id: CVE-2020-28247
