advisory_id: GHSA-6r92-cgxc-r5fg
datasource_id: github_osv_importer_v2/GHSA-6r92-cgxc-r5fg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-6r92-cgxc-r5fg/GHSA-6r92-cgxc-r5fg.json
aliases:
  - CVE-2024-21909
summary: |
  Denial of service in CBOR library
  ### Impact
  Due to this library's use of an inefficient algorithm, it is vulnerable to a denial of service attack when a maliciously crafted input is passed to `DecodeFromBytes` or other CBOR decoding mechanisms in this library.

  Affected versions _include_ versions 4.0.0 through 4.5.0.

  This vulnerability was privately reported to me.

  ### Patches
  This issue has been fixed in version 4.5.1.  Users should use the latest version of this library. (The latest version is not necessarily 4.5.1.  Check the [NuGet page](https://www.nuget.org/packages/PeterO.Cbor) to see the latest version's version number.)

  ### Workarounds

  Again, users should use the latest version of this library.

  In the meantime, note that the inputs affected by this issue are all CBOR maps or contain CBOR maps.  An input that decodes to a single CBOR object is not capable of containing a CBOR map if&mdash;

  - it begins with a byte other than 0x80 through 0xDF, or
  - it does not contain a byte in the range 0xa0 through 0xBF.

  Such an input is not affected by this vulnerability and an application can choose to perform this check before passing it to a CBOR decoding mechanism.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [the CBOR repository](https://github.com/peteroupc/CBOR).
impacted_packages:
  - purl: pkg:nuget/PeterO.Cbor
    affected_versions: vers:nuget/>=4.0.0|<4.5.1
    fixed_versions: vers:nuget/4.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-407
references:
  - url: https://github.com/peteroupc/CBOR
    reference_type:
    reference_id:
  - url: https://github.com/peteroupc/CBOR/commit/b4117dbbb4cd5a4a963f9d0c9aa132f033e15b95
    reference_type:
    reference_id:
  - url: https://github.com/peteroupc/CBOR/compare/v4.5...v4.5.1
    reference_type:
    reference_id:
  - url: https://github.com/peteroupc/CBOR/security/advisories/GHSA-6r92-cgxc-r5fg
    reference_type:
    reference_id:
