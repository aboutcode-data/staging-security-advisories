advisory_id: GHSA-jgpm-2862-q5m8
datasource_id: github_osv_importer_v2/GHSA-jgpm-2862-q5m8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-jgpm-2862-q5m8/GHSA-jgpm-2862-q5m8.json
aliases:
  - CVE-2019-1003024
summary: |
  Jenkins Script Security Plugin sandbox bypass vulnerability
  The previously implemented script security sandbox protections prohibiting the use of unsafe AST transforming annotations such as `@Grab` ([2019-01-08 fix for SECURITY-1266](https://www.jenkins.io/security/advisory/2019-01-08/#SECURITY-1266)) could be circumvented through use of various Groovy language features:

  - Use of `AnnotationCollector`
  - Import aliasing
  - Referencing annotation types using their full class name

  This allowed users with Overall/Read permission, or the ability to control Jenkinsfile or sandboxed Pipeline shared library contents in SCM, to bypass the sandbox protection and execute arbitrary code on the Jenkins controller.

  Using `AnnotationCollector` is now newly prohibited in sandboxed scripts such as Pipelines. Importing any of the annotations considered unsafe will now result in an error. During the compilation phase, both simple and full class names of prohibited annotations are rejected for element annotations.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/script-security
    affected_versions: vers:maven/<=1.52
    fixed_versions: vers:maven/1.53
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-jgpm-2862-q5m8/GHSA-jgpm-2862-q5m8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://access.redhat.com/errata/RHSA-2019:0739
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/script-security-plugin/commit/3228c88e84f0b2f24845b6466cae35617e082059
    reference_type:
    reference_id:
  - url: https://jenkins.io/security/advisory/2019-02-19/#SECURITY-1320
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20200227084947/http://www.securityfocus.com/bid/107295
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-1003024
    reference_type:
    reference_id: CVE-2019-1003024
