advisory_id: GHSA-55rf-8q29-4g43
datasource_id: github_osv_importer_v2/GHSA-55rf-8q29-4g43
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-55rf-8q29-4g43/GHSA-55rf-8q29-4g43.json
aliases:
  - CVE-2024-40633
summary: "Sylius has a security vulnerability via adjustments API endpoint\n### Impact\nA security\
  \ vulnerability was discovered in the `/api/v2/shop/adjustments/{id}` endpoint, which retrieves\
  \ order adjustments based on incremental integer IDs. The vulnerability allows an attacker\
  \ to enumerate valid adjustment IDs and retrieve order tokens. Using these tokens, an attacker\
  \ can access guest customer order details - sensitive guest customer information. \n\n###\
  \ Patches\nThe issue is fixed in versions: 1.12.19, 1.13.4 and above. The `/api/v2/shop/adjustments/{id}`\
  \ will always return `404` status.\n\n### Workarounds\n\nUsing YAML configuration:\n\nCreate\
  \ `config/api_platform/Adjustment.yaml` file:\n\n```yaml\n# config/api_platform/Adjustment.yaml\n\
  \n'%sylius.model.adjustment.class%':\n    itemOperations:\n        shop_get:\n           \
  \ controller: ApiPlatform\\Core\\Action\\NotFoundAction\n            read: false\n       \
  \     output: false\n```\n\nOr using XML configuration:\n\nCopy the original configuration\
  \ from vendor:\n\n```bash\ncp vendor/sylius/sylius/src/Sylius/Bundle/ApiBundle/Resources/config/api_resources/Adjustment.xml\
  \ config/api_platform\n```\n\nAnd change the `shop_get` operation in copied `config/api_platform/Adjustment.xml`\
  \ file:\n\n```xml\n<!-- config/api_platform/Adjustment.xml -->\n\n...\n<itemOperation name=\"\
  shop_get\">\n    <attribute name=\"method\">GET</attribute>\n    <attribute name=\"path\"\
  >/shop/adjustments/{id}</attribute>\n    <attribute name=\"controller\">ApiPlatform\\Core\\\
  Action\\NotFoundAction</attribute>\n    <attribute name=\"read\">false</attribute>\n    <attribute\
  \ name=\"output\">false</attribute>\n</itemOperation>\n...\n```\n\n### For more information\n\
  If you have any questions or comments about this advisory:\n\n- Open an issue in [Sylius issues](https://github.com/Sylius/Sylius/issues)\n\
  - Email us at [security@sylius.com](mailto:security@sylius.com)"
impacted_packages:
  - purl: pkg:composer/sylius/sylius
    affected_versions: vers:composer/<1.12.19
    fixed_versions: vers:composer/1.12.19
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/sylius
    affected_versions: vers:composer/>=1.13.0-alpha.1|<1.13.4
    fixed_versions: vers:composer/1.13.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-55rf-8q29-4g43/GHSA-55rf-8q29-4g43.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-55rf-8q29-4g43/GHSA-55rf-8q29-4g43.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-639
references:
  - url: https://github.com/Sylius/Sylius
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/Sylius/commit/d833b2871caa3b8d1f0a8207378bb778f0b90464
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/Sylius/security/advisories/GHSA-55rf-8q29-4g43
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-40633
    reference_type:
    reference_id: CVE-2024-40633
