advisory_id: GHSA-qjvc-p88j-j9rm
datasource_id: github_osv_importer_v2/GHSA-qjvc-p88j-j9rm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-qjvc-p88j-j9rm/GHSA-qjvc-p88j-j9rm.json
aliases:
  - CVE-2024-48921
summary: "Kyverno's PolicyException objects can be created in any namespace by default\n###\
  \ Summary\nA kyverno ClusterPolicy, ie. \"disallow-privileged-containers,\" can be overridden\
  \ by the creation of a PolicyException in a random namespace.\n\n### Details\nBy design, PolicyExceptions\
  \ are consumed from any namespace. Administrators may not recognize that this allows users\
  \ with privileges to non-kyverno namespaces to create exceptions.\n\n### PoC\n1. Administrator\
  \ creates \"disallow-privileged-containers\" ClusterPolicy that applies to resources in the\
  \ namespace \"ubuntu-restricted\"\n2. Cluster user creates a PolicyException object for \"\
  disallow-privileged-containers\" in namespace \"ubuntu-restricted\"\n3. Cluster user creates\
  \ a pod with a privileged container in \"ubuntu-restricted\" \n4. Cluster user escalates to\
  \ root on the node from the privileged container\n\n### Impact\nAdministrators attempting\
  \ to enforce cluster security through kyverno policies, but that allow less privileged users\
  \ to create resources"
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-qjvc-p88j-j9rm/GHSA-qjvc-p88j-j9rm.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-qjvc-p88j-j9rm/GHSA-qjvc-p88j-j9rm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
  - CWE-863
references:
  - url: https://github.com/kyverno/kyverno
    reference_type:
    reference_id:
  - url: https://github.com/kyverno/kyverno/security/advisories/GHSA-qjvc-p88j-j9rm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-48921
    reference_type:
    reference_id: CVE-2024-48921
