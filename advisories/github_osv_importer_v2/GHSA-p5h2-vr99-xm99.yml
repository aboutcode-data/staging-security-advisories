advisory_id: GHSA-p5h2-vr99-xm99
datasource_id: github_osv_importer_v2/GHSA-p5h2-vr99-xm99
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-p5h2-vr99-xm99/GHSA-p5h2-vr99-xm99.json
aliases: []
summary: |
  silverstripe/framework ChangePasswordForm does not check `Member::canLogIn()`
  After performing a password reset, `ChangePasswordForm::doChangePassword()` logs in the user without checking `Member::canLogIn()`. This presents an issue for sites that are using the extension point in that method to deny access to users (for example members that have not been “approved”, or members that have had their access revoked temporarily). It looks like `Member::canLogIn()` was originally designed to only be used for checking whether the user is locked out (due to too many incorrect login attempts) but has been opened up to other uses.
impacted_packages:
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/>=3.1.19-rc1|<3.1.20
    fixed_versions: vers:composer/3.1.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/>=3.2.4-rc1|<3.2.5
    fixed_versions: vers:composer/3.2.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/>=3.3.2-rc1|<3.3.3
    fixed_versions: vers:composer/3.3.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/>=3.4.0-rc1|<3.4.1
    fixed_versions: vers:composer/3.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-p5h2-vr99-xm99/GHSA-p5h2-vr99-xm99.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2016-011-1.yaml
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework/commit/2b30ade44d333a4da4d13b31ffa28d0a34597442
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework/commit/6606d986634f5b5dec16462acaa8d9a513c29fec
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework/commit/6d41db77fa78f473db7bcff389456c980ef4e412
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework/commit/782c18fd13b9fb92707d0ea3b231023204928297
    reference_type:
    reference_id:
  - url: https://www.silverstripe.org/download/security-releases/ss-2016-011
    reference_type:
    reference_id:
