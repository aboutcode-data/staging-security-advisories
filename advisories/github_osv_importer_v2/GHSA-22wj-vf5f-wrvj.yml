advisory_id: GHSA-22wj-vf5f-wrvj
datasource_id: github_osv_importer_v2/GHSA-22wj-vf5f-wrvj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-22wj-vf5f-wrvj/GHSA-22wj-vf5f-wrvj.json
aliases:
  - CVE-2022-45868
summary: |
  Password exposure in H2 Database
  The web-based admin console in H2 Database Engine through 2.1.214 can be started via the CLI with the argument -webAdminPassword, which allows the user to specify the password in cleartext for the web admin console. Consequently, a local user (or an attacker that has obtained local access through some means) would be able to discover the password by listing processes and their arguments. NOTE: the vendor states "This is not a vulnerability of H2 Console ... Passwords should never be passed on the command line and every qualified DBA or system administrator is expected to know that."
impacted_packages:
  - purl: pkg:maven/com.h2database/h2
    affected_versions: vers:maven/>=1.4.198|<2.2.220
    fixed_versions: vers:maven/2.2.220
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-22wj-vf5f-wrvj/GHSA-22wj-vf5f-wrvj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-312
  - CWE-200
references:
  - url: https://github.com/advisories/GHSA-22wj-vf5f-wrvj
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database/blob/96832bf5a97cdc0adc1f2066ed61c54990d66ab5/h2/src/main/org/h2/server/web/WebServer.java#L346-L347
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database/commit/581ed18ff9d6b3761d851620ed88a3994a351a0d
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database/issues/3686
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database/pull/3833
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database/releases/tag/version-2.2.220
    reference_type:
    reference_id:
  - url: https://sites.google.com/sonatype.com/vulnerabilities/sonatype-2022-6243
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-45868
    reference_type:
    reference_id: CVE-2022-45868
