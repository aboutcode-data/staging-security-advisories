advisory_id: GHSA-fq6h-4g8v-qqvm
datasource_id: github_osv_importer_v2/GHSA-fq6h-4g8v-qqvm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-fq6h-4g8v-qqvm/GHSA-fq6h-4g8v-qqvm.json
aliases:
  - CVE-2024-24815
summary: |
  CKEditor4 Cross-site Scripting vulnerability caused by incorrect CDATA detection
  ### Affected packages
  The vulnerability has been discovered in the core HTML parsing module and may affect all editor instances that:
  * Enabled [full-page editing](https://ckeditor.com/docs/ckeditor4/latest/features/fullpage.html) mode,
  * or enabled [CDATA](https://ckeditor.com/docs/ckeditor4/latest/api/CKEDITOR_dtd.html#property-S-cdata) elements in [Advanced Content Filtering](https://ckeditor.com/docs/ckeditor4/latest/guide/dev_advanced_content_filter.html) configuration (defaults to `script` and `style` elements).

  ### Impact

  A potential vulnerability has been discovered in CKEditor 4 HTML processing core module. The vulnerability allowed to inject malformed HTML content bypassing Advanced Content Filtering mechanism, which could result in executing JavaScript code. An attacker could abuse faulty CDATA content detection and use it to prepare an intentional attack on the editor. It affects all users using the CKEditor 4 at version < 4.24.0-lts.

  ### Patches
  The problem has been recognized and patched. The fix will be available in version 4.24.0-lts.

  ### For more information
  Email us at [security@cksource.com](mailto:security@cksource.com) if you have any questions or comments about this advisory.

  ### Acknowledgements
  The CKEditor 4 team would like to thank [Michal FrÃ½ba](https://cz.linkedin.com/in/michal-fryba) from [ALEF NULA](https://www.alefnula.com/) for recognizing and reporting this vulnerability.
impacted_packages:
  - purl: pkg:npm/ckeditor4
    affected_versions: vers:npm/<4.24.0-lts
    fixed_versions: vers:npm/4.24.0-lts
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/ckeditor/ckeditor
    affected_versions: vers:composer/<4.24.0
    fixed_versions: vers:composer/4.24.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-fq6h-4g8v-qqvm/GHSA-fq6h-4g8v-qqvm.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://ckeditor.com/docs/ckeditor4/latest/api/CKEDITOR_dtd.html#property-S-cdata
    reference_type:
    reference_id:
  - url: https://ckeditor.com/docs/ckeditor4/latest/features/fullpage.html
    reference_type:
    reference_id:
  - url: https://ckeditor.com/docs/ckeditor4/latest/guide/dev_advanced_content_filter.html
    reference_type:
    reference_id:
  - url: https://github.com/ckeditor/ckeditor4
    reference_type:
    reference_id:
  - url: https://github.com/ckeditor/ckeditor4/commit/8ed1a3c93d0ae5f49f4ecff5738ab8a2972194cb
    reference_type:
    reference_id:
  - url: https://github.com/ckeditor/ckeditor4/security/advisories/GHSA-fq6h-4g8v-qqvm
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-contrib-2024-009
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-24815
    reference_type:
    reference_id: CVE-2024-24815
