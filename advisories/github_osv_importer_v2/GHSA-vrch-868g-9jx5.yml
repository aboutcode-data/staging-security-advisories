advisory_id: GHSA-vrch-868g-9jx5
datasource_id: github_osv_importer_v2/GHSA-vrch-868g-9jx5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-vrch-868g-9jx5/GHSA-vrch-868g-9jx5.json
aliases:
  - CVE-2025-47952
summary: "Traefik allows path traversal using url encoding\n## Impact\n\nThere is a potential\
  \ vulnerability in Traefik managing the requests using a `PathPrefix`, `Path` or `PathRegex`\
  \ matcher.\n\nWhen Traefik is configured to route the requests to a backend using a matcher\
  \ based on the path, if the URL contains a URL encoded string in its path, it’s possible to\
  \ target a backend, exposed using another router, by-passing the middlewares chain.\n\n##\
  \ Example\n\n```yaml\napiVersion: traefik.io/v1alpha1\nkind: IngressRoute\nmetadata:\n  name:\
  \ my-service\nspec:\n  routes:\n    - match: PathPrefix(‘/service’)\n      kind: Rule\n  \
  \    services:\n        - name: service-a\n          port: 8080\n      middlewares:\n    \
  \    - name: my-middleware-a\n    - match: PathPrefix(‘/service/sub-path’)\n      kind: Rule\n\
  \      services:\n        - name: service-a\n          port: 8080\n```\n\nIn such a case,\
  \ the request `http://mydomain.example.com/service/sub-path/%2e%2e/other-path` will reach\
  \ the backend `my-service-a` without operating the middleware `my-middleware-a` unless the\
  \ computed path is `http://mydomain.example.com/service/other-path` and should be computes\
  \ by the first router (operating `my-middleware-a`).\n\n## Patches\n\n- https://github.com/traefik/traefik/releases/tag/v2.11.25\n\
  - https://github.com/traefik/traefik/releases/tag/v3.4.1\n\n## For more information\n\nIf\
  \ you have any questions or comments about this advisory, please [open an issue](https://github.com/traefik/traefik/issues).\n\
  \n<details>\n<summary>Original Description</summary>\n### Summary\n\nPath traversal with \"\
  /../\" using URL encodings (\"/%2e%2e\") allows for circumventing routing rules. \n\n### Details\n\
  \nWhen having defined a route, you can path traverse using the URL encoded variant of /../\
  \ and reach endpoints that are not made publicly available. This issue has been found and\
  \ fixed earlier with regular /../ and has been fixed in this CVE. This URL encoding trick\
  \ works around that\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-32431\n\nSimply implementing\
  \ a check on the URL encoding won't be sufficient as path traversal can take numerous formats.\
  \ See examples here:\nhttps://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html\n\
  \n### PoC\n\nSetup a service with two endpoints: \"/public\" and \"/private\", which returns\
  \ a 200 OK for both\nSetup a Traefik proxy with a single route which points to the service\
  \ using path /public\n\nRegular requests to traefik /public will return 200 OK and to /private\
  \ should return 404 (response by Traefik)\nWhen making a request to /public/%2e%2e/private\
  \ you should receive a 200 OK.\n\n### Impact\nImpacts all traefik implementations with path\
  \ prefix routes that expose only part of the downstream api\n\n### Suggestion\nProvide configuration\
  \ property which disables all path traversals. Steps:\n1. Decode URL\n2. Evaluate and construct\
  \ relative path (do traversal before route evaluation)\n3. Compare relative/evaluated path\
  \ to configured routes (PathPrefix/pathRegexp)\n</details>"
impacted_packages: []
severities:
  - score: '2.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-vrch-868g-9jx5/GHSA-vrch-868g-9jx5.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/traefik/traefik
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/commit/08d5dfee0164aa54dd44a467870042e18e8d3f00
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/releases/tag/v2.11.25
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/releases/tag/v3.4.1
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/security/advisories/GHSA-vrch-868g-9jx5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-47952
    reference_type:
    reference_id: CVE-2025-47952
