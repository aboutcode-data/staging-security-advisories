advisory_id: GHSA-96jw-3xw4-mq9p
datasource_id: github_osv_importer_v2/GHSA-96jw-3xw4-mq9p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-96jw-3xw4-mq9p/GHSA-96jw-3xw4-mq9p.json
aliases:
  - CVE-2021-21623
summary: |
  Incorrect permission checks in Jenkins Matrix Authorization Strategy Plugin may allow accessing some items
  Items (like jobs) can be organized hierarchically in Jenkins, using the Folders Plugin or something similar. An item is expected to be accessible only if all its ancestors are accessible as well.

  Matrix Authorization Strategy Plugin 2.6.5 and earlier does not correctly perform permission checks to determine whether an item should be accessible.

  This allows attackers with Item/Read permission on nested items to access them, even if they lack Item/Read permission for parent folders.\n\nMatrix Authorization Strategy Plugin 2.6.6 requires Item/Read permission on parent items to grant Item/Read permission on an individual item.

  As a workaround in older releases, do not grant permissions on individual items to users who do not have access to parent items.

  In case of problems, the [Java system property](https://www.jenkins.io/doc/book/managing/system-properties/) `hudson.security.AuthorizationMatrixProperty.checkParentPermissions` can be set to false, completely disabling this fix.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/matrix-auth
    affected_versions: vers:maven/<=2.6.5
    fixed_versions: vers:maven/2.6.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-96jw-3xw4-mq9p/GHSA-96jw-3xw4-mq9p.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/jenkinsci/matrix-auth-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/matrix-auth-plugin/commit/bbe358575155912b818ab3c6e8b9623f21ad3418
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2021-03-18/#SECURITY-2180
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/03/18/5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21623
    reference_type:
    reference_id: CVE-2021-21623
