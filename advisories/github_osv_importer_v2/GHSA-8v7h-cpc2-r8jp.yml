advisory_id: GHSA-8v7h-cpc2-r8jp
datasource_id: github_osv_importer_v2/GHSA-8v7h-cpc2-r8jp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-8v7h-cpc2-r8jp/GHSA-8v7h-cpc2-r8jp.json
aliases:
  - CVE-2022-24800
summary: |
  October CMS upload process vulnerable to RCE via Race Condition
  ### Impact

  This advisory affects plugins that expose the `October\Rain\Database\Attach\File::fromData` as a public interface. This vulnerability does not affect vanilla installations of October CMS since this method is not exposed or used by the system internally or externally.

  When the developer allows the user to specify their own filename in the `fromData` method, an unauthenticated user can perform remote code execution (RCE) by exploiting a race condition in the temporary storage directory.

  ### Patches

  The issue has been patched in Build 476 (v1.0.476) and v1.1.12 and v2.2.15.

  ### Workarounds

  Apply https://github.com/octobercms/library/commit/fe569f3babf3f593be2b1e0a4ae0283506127a83 to your installation manually if unable to upgrade to Build 476 (v1.0.476) or v1.1.12 or v2.2.15.

  ### References

  Credits to:
  - DucNT, HungTD and GiangVQ from RedTeam@VNG Security Response Center.

  ### For more information

  If you have any questions or comments about this advisory:
  - Email us at [hello@octobercms.com](mailto:hello@octobercms.com)
impacted_packages:
  - purl: pkg:composer/october/system
    affected_versions: vers:composer/<1.0.476
    fixed_versions: vers:composer/1.0.476
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/october/system
    affected_versions: vers:composer/>=1.1.0|<1.1.12
    fixed_versions: vers:composer/1.1.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/october/system
    affected_versions: vers:composer/>=2.0.0|<2.2.15
    fixed_versions: vers:composer/2.2.15
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-8v7h-cpc2-r8jp/GHSA-8v7h-cpc2-r8jp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-362
references:
  - url: https://github.com/octobercms/library/commit/fe569f3babf3f593be2b1e0a4ae0283506127a83
    reference_type:
    reference_id:
  - url: https://github.com/octobercms/october
    reference_type:
    reference_id:
  - url: https://github.com/octobercms/october/security/advisories/GHSA-8v7h-cpc2-r8jp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24800
    reference_type:
    reference_id: CVE-2022-24800
