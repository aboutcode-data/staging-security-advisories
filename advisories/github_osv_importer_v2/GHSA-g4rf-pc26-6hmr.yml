advisory_id: GHSA-g4rf-pc26-6hmr
datasource_id: github_osv_importer_v2/GHSA-g4rf-pc26-6hmr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-g4rf-pc26-6hmr/GHSA-g4rf-pc26-6hmr.json
aliases:
  - CVE-2021-21377
summary: |
  OMERO webclient does not validate URL redirects on login or switching group.
  ### Background
  OMERO.web supports redirection to a given URL after performing login or switching the group context. These URLs are not validated, allowing redirection to untrusted sites. OMERO.web 5.9.0 adds URL validation before redirecting. External URLs are not considered valid, unless specified in the ``omero.web.redirect_allowed_hosts`` setting.

  ### Impact
  OMERO.web before 5.9.0

  ### Patches
  5.9.0

  ### Workarounds
  No workaround

  ### References

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [omero-web](https://github.com/ome/omero-web)
  * Email us at [security](mailto:security@openmicroscopy.org.uk)
impacted_packages:
  - purl: pkg:pypi/omero-web
    affected_versions: vers:pypi/<5.9.0
    fixed_versions: vers:pypi/5.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-g4rf-pc26-6hmr/GHSA-g4rf-pc26-6hmr.json
  - score: '5.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:P/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-g4rf-pc26-6hmr/GHSA-g4rf-pc26-6hmr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/ome/omero-web
    reference_type:
    reference_id:
  - url: https://github.com/ome/omero-web/blob/master/CHANGELOG.md#590-march-2021
    reference_type:
    reference_id:
  - url: https://github.com/ome/omero-web/commit/952f8e5d28532fbb14fb665982211329d137908c
    reference_type:
    reference_id:
  - url: https://github.com/ome/omero-web/security/advisories/GHSA-g4rf-pc26-6hmr
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/omero-web/PYSEC-2021-32.yaml
    reference_type:
    reference_id:
  - url: https://pypi.org/project/omero-web
    reference_type:
    reference_id:
  - url: https://www.openmicroscopy.org/security/advisories/2021-SV2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21377
    reference_type:
    reference_id: CVE-2021-21377
