advisory_id: GHSA-c2gg-4gq4-jv5j
datasource_id: github_osv_importer_v2/GHSA-c2gg-4gq4-jv5j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-c2gg-4gq4-jv5j/GHSA-c2gg-4gq4-jv5j.json
aliases:
  - CVE-2024-31997
summary: |
  XWiki Platform remote code execution from account through UIExtension parameters
  ### Impact
  Parameters of UI extensions are always interpreted as Velocity code and executed with programming rights. Any user with edit right on any document like the user's own profile can create UI extensions. This allows remote code execution and thereby impacts the confidentiality, integrity and availability of the whole XWiki installation.

  To reproduce, edit your user profile with the object editor and add a UIExtension object with the following values:
  ```
  Extension Point ID: org.xwiki.platform.panels.Applications
  Extension ID: platform.panels.myFakeApplication
  Extension parameters:Â 
  label=I got programming right: $services.security.authorization.hasAccess('programming')
  target=Main.WebHome
  targetQueryString=
  icon=icon:bomb
  Extension Scope: "Current User".
  ```

  Save the document and open any document. If an application entry with the text "I got programming right: true" is displayed, the attack succeeded, if the code in "label" is displayed literally, the XWiki installation isn't vulnerable.

  ### Patches
  This vulnerability has been patched in XWiki 14.10.19, 15.5.4 and 15.9-RC1.

  ### Workarounds
  We're not aware of any workarounds apart from upgrading.

  ### References
  * https://jira.xwiki.org/browse/XWIKI-21335
  * https://github.com/xwiki/xwiki-platform/commit/171e7c7d0e56deaa7b3678657ae26ef95379b1ea
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-uiextension-api
    affected_versions: vers:maven/<14.10.19
    fixed_versions: vers:maven/14.10.19
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-uiextension-api
    affected_versions: vers:maven/>=15.0-rc-1|<15.5.4
    fixed_versions: vers:maven/15.5.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-uiextension-api
    affected_versions: vers:maven/>=15.6-rc-1|<15.9-rc-1
    fixed_versions: vers:maven/15.9-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-c2gg-4gq4-jv5j/GHSA-c2gg-4gq4-jv5j.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/171e7c7d0e56deaa7b3678657ae26ef95379b1ea
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/1b2574eb966457ca4ef34e557376b8751d1be90d
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/56748e154a9011f0d6239bec0823eaaeab6ec3f7
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-c2gg-4gq4-jv5j
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-21335
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-31997
    reference_type:
    reference_id: CVE-2024-31997
