advisory_id: GHSA-5gc4-cx9x-9c43
datasource_id: github_osv_importer_v2/GHSA-5gc4-cx9x-9c43
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-5gc4-cx9x-9c43/GHSA-5gc4-cx9x-9c43.json
aliases:
  - CVE-2022-21122
summary: |
  Code Injection in metacalc
  The package metacalc before 0.0.2 is vulnerable to Arbitrary Code Execution when it exposes JavaScript's Math class to the v8 context. As the Math class is exposed to user-land, it can be used to get access to JavaScript's Function constructor.
impacted_packages:
  - purl: pkg:npm/metacalc
    affected_versions: vers:npm/<0.0.2
    fixed_versions: vers:npm/0.0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-5gc4-cx9x-9c43/GHSA-5gc4-cx9x-9c43.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/metarhia/metacalc
    reference_type:
    reference_id:
  - url: https://github.com/metarhia/metacalc/commit/625c23d63eabfa16fc815f5832b147b08d2144bd
    reference_type:
    reference_id:
  - url: https://github.com/metarhia/metacalc/pull/16
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-METACALC-2826197
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21122
    reference_type:
    reference_id: CVE-2022-21122
