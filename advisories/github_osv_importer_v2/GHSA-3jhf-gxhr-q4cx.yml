advisory_id: GHSA-3jhf-gxhr-q4cx
datasource_id: github_osv_importer_v2/GHSA-3jhf-gxhr-q4cx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-3jhf-gxhr-q4cx/GHSA-3jhf-gxhr-q4cx.json
aliases:
  - CVE-2025-53010
summary: |
  MaterialX Null Pointer Dereference in getShaderNodes due to Unchecked nodeGraph->getOutput return
  ### Summary

  When parsing shader nodes in a MTLX file, the MaterialXCore code accesses a potentially null pointer, which can lead to crashes with maliciously crafted files.

  ### Details

  In `src/MaterialXCore/Material.cpp`, in function `getShaderNodes`, the following code fetches the output nodes for a given `nodegraph` input node:

  ```cpp
  // SNIP...
          else if (input->hasNodeGraphString())
          {
              // Check upstream nodegraph connected to the input.
              // If no explicit output name given then scan all outputs on the nodegraph.
              ElementPtr parent = materialNode->getParent();
              NodeGraphPtr nodeGraph = parent->getChildOfType<NodeGraph>(input->getNodeGraphString());
              if (!nodeGraph)
              {
                  continue;
              }
              vector<OutputPtr> outputs;
              if (input->hasOutputString())
              {
                  outputs.push_back(nodeGraph->getOutput(input->getOutputString())); // <--- null ptr is returned
              }
              else
              {
                  outputs = nodeGraph->getOutputs();
              }
              for (OutputPtr output : outputs)
              {
                  NodePtr upstreamNode = output->getConnectedNode(); // <--- CRASHES HERE
                  if (upstreamNode && !shaderNodeSet.count(upstreamNode))
                  {
                      if (!target.empty() && !upstreamNode->getNodeDef(target))
                      {
                          continue;
                      }
                      shaderNodeVec.push_back(upstreamNode);
                      shaderNodeSet.insert(upstreamNode);
                  }
              }
          }
      }
  // SNIP...
  ```

  The issues arise because the `nodeGraph->getOutput(input->getOutputString())` call can return a null pointer, therefore when trying to call `output->getConnectedNode()`, this results in a crash    .


  ### PoC

  Please download `nullptr_getshadernodes.mltx` from the following link:

  https://github.com/ShielderSec/poc/tree/main/CVE-2025-53010

  `build/bin/MaterialXView --material nullptr_getshadernodes.mtlx`


  ### Impact

  An attacker could intentionally crash a target program that uses OpenEXR by sending a malicious MTLX file.
impacted_packages:
  - purl: pkg:pypi/materialx
    affected_versions: vers:pypi/1.39.2
    fixed_versions: vers:pypi/1.39.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-3jhf-gxhr-q4cx/GHSA-3jhf-gxhr-q4cx.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-476
references:
  - url: https://github.com/AcademySoftwareFoundation/MaterialX
    reference_type:
    reference_id:
  - url: https://github.com/AcademySoftwareFoundation/MaterialX/commit/e13344ba13326869d7820b444705f24d56fab73d
    reference_type:
    reference_id:
  - url: https://github.com/AcademySoftwareFoundation/MaterialX/security/advisories/GHSA-3jhf-gxhr-q4cx
    reference_type:
    reference_id:
  - url: https://github.com/ShielderSec/poc/tree/main/CVE-2025-53010
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-53010
    reference_type:
    reference_id: CVE-2025-53010
