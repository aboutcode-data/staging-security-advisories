advisory_id: GHSA-h653-95qw-h2mp
datasource_id: github_osv_importer_v2/GHSA-h653-95qw-h2mp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-h653-95qw-h2mp/GHSA-h653-95qw-h2mp.json
aliases:
  - CVE-2019-14858
summary: |
  Ansible leaks sensitive information to logs when told not to
  A vulnerability was found in Ansible engine 2.x up to 2.8 and Ansible tower 3.x up to 3.5. When a module has an argument_spec with sub parameters marked as `no_log`, passing an invalid parameter name to the module will cause the task to fail before the `no_log` options in the sub parameters are processed. As a result, data in the sub parameter fields will not be masked and will be displayed if Ansible is run with increased verbosity and present in the module invocation arguments for the task.
impacted_packages:
  - purl: pkg:pypi/ansible
    affected_versions: vers:pypi/>=2.9.0a1|<2.9.0rc4
    fixed_versions: vers:pypi/2.9.0rc4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/ansible
    affected_versions: vers:pypi/>=2.8.0a1|<2.8.6
    fixed_versions: vers:pypi/2.8.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/ansible
    affected_versions: vers:pypi/>=2.7.0a1|<2.7.14
    fixed_versions: vers:pypi/2.7.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/ansible
    affected_versions: vers:pypi/>=2.0|<2.6.20
    fixed_versions: vers:pypi/2.6.20
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-h653-95qw-h2mp/GHSA-h653-95qw-h2mp.json
  - score: '6.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-h653-95qw-h2mp/GHSA-h653-95qw-h2mp.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00021.html
    reference_type:
    reference_id:
  - url: http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00026.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2019:3201
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2019:3202
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2019:3203
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2019:3207
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2020:0756
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-14858
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/0fd656e9964a91f2e8b1e9bbf78c74661ab9d37b
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/3dfb8e81bb5f776a6b00c7a90dd087e85b71f8bb
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/87f8d77d70476454f7fe2381bd363a329ce4266c
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/f610ed3a4eb87eb557200606279796921fa9b722
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/pull/63405
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2019-171.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-14858
    reference_type:
    reference_id: CVE-2019-14858
