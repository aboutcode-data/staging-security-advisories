advisory_id: GHSA-vx9j-46rh-fqr8
datasource_id: github_osv_importer_v2/GHSA-vx9j-46rh-fqr8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2017/10/GHSA-vx9j-46rh-fqr8/GHSA-vx9j-46rh-fqr8.json
aliases:
  - CVE-2016-2097
summary: |
  actionview contains Path Traversal vulnerability
  There is a possible directory traversal and information leak vulnerability in Action View. This was meant to be fixed on CVE-2016-0752. However the 3.2 patch was not covering all possible scenarios. This vulnerability has been assigned the CVE identifier CVE-2016-2097.

  Versions Affected:  3.2.x, 4.0.x, 4.1.x
  Not affected:       4.2+
  Fixed Versions:     3.2.22.2, 4.1.14.2

  Impact
  ------
  Applications that pass unverified user input to the `render` method in a controller may be vulnerable to an information leak vulnerability.

  Impacted code will look something like this:

  ```ruby
  def index
    render params[:id]
  end
  ```

  Carefully crafted requests can cause the above code to render files from unexpected places like outside the application's view directory, and can possibly escalate this to a remote code execution attack.

  All users running an affected release should either upgrade or use one of the workarounds immediately.

  Releases
  --------
  The FIXED releases are available at the normal locations.

  Workarounds
  -----------
  A workaround to this issue is to not pass arbitrary user input to the `render` method. Instead, verify that data before passing it to the `render` method.

  For example, change this:

  ```ruby
  def index
    render params[:id]
  end
  ```

  To this:

  ```ruby
  def index
    render verify_template(params[:id])
  end

  private
  def verify_template(name)
    # add verification logic particular to your application here
  end
  ```

  Patches
  -------
  To aid users who aren't able to upgrade immediately we have provided patches for it. It is in git-am format and consist of a single changeset.

  * 3-2-render_data_leak_2.patch - Patch for 3.2 series
  * 4-1-render_data_leak_2.patch - Patch for 4.1 series

  Credits
  -------
  Thanks to both Jyoti Singh and Tobias Kraze from makandra for reporting this and working with us in the patch!
impacted_packages:
  - purl: pkg:gem/actionview
    affected_versions: vers:gem/<=3.2.22.1
    fixed_versions: vers:gem/3.2.22.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionview
    affected_versions: vers:gem/<=4.1.14.1
    fixed_versions: vers:gem/4.1.14.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/<=3.2.22.1
    fixed_versions: vers:gem/3.2.22.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/<=4.1.14.1
    fixed_versions: vers:gem/4.1.14.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2017/10/GHSA-vx9j-46rh-fqr8/GHSA-vx9j-46rh-fqr8.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2016-03/msg00080.html
    reference_type:
    reference_id:
  - url: http://lists.opensuse.org/opensuse-security-announce/2016-03/msg00083.html
    reference_type:
    reference_id:
  - url: http://lists.opensuse.org/opensuse-security-announce/2016-04/msg00006.html
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/8a1d3ea617ffb0c8ae8467fa439bf63a3bfc4324
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2016-2097.yml
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionview/CVE-2016-2097.yml
    reference_type:
    reference_id:
  - url: https://groups.google.com/forum/#!topic/rubyonrails-security/ddY6HgqB2z4
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20160322002234/http://www.securitytracker.com/id/1035122
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20200228015320/http://www.securityfocus.com/bid/83726
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20201221115217/https://groups.google.com/forum/message/raw?msg=rubyonrails-security/ddY6HgqB2z4/we0RasMZIAAJ
    reference_type:
    reference_id:
  - url: http://weblog.rubyonrails.org/2016/2/29/Rails-4-2-5-2-4-1-14-2-3-2-22-2-have-been-released
    reference_type:
    reference_id:
  - url: http://www.debian.org/security/2016/dsa-3509
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2016-2097
    reference_type:
    reference_id: CVE-2016-2097
