advisory_id: GHSA-x489-jjwm-52g7
datasource_id: github_osv_importer_v2/GHSA-x489-jjwm-52g7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/08/GHSA-x489-jjwm-52g7/GHSA-x489-jjwm-52g7.json
aliases:
  - CVE-2015-7225
summary: |
  Tinfoil Devise-two-factor does not "burn" a successfully validated one-time password (OTP)
  Tinfoil Devise-two-factor before 2.0.0 does not strictly follow [RFC 6238 ยง 5.2 ](https://datatracker.ietf.org/doc/html/rfc6238#section-5.2) and does not "burn" a successfully validated one-time password (aka OTP), which allows physically proximate attackers with a target user's login credentials to log in as said user by obtaining the OTP through performing a man-in-the-middle attack between the provider and verifier, or "shoulder surfing", and replaying the OTP in the current time-step.
impacted_packages:
  - purl: pkg:gem/devise-two-factor
    affected_versions: vers:gem/<2.0.0
    fixed_versions: vers:gem/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/08/GHSA-x489-jjwm-52g7/GHSA-x489-jjwm-52g7.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=798466
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-x489-jjwm-52g7
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/devise-two-factor/CVE-2015-7225.yml
    reference_type:
    reference_id:
  - url: https://github.com/tinfoil/devise-two-factor
    reference_type:
    reference_id:
  - url: https://github.com/tinfoil/devise-two-factor/blob/master/UPGRADING.md
    reference_type:
    reference_id:
  - url: https://github.com/tinfoil/devise-two-factor/issues/45#issuecomment-139335608
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20210122192452/https://www.securityfocus.com/bid/76789
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2015/06/20/4
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2015/09/06/2
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2015/09/17/2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2015-7225
    reference_type:
    reference_id: CVE-2015-7225
