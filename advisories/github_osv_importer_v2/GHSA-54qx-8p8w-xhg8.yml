advisory_id: GHSA-54qx-8p8w-xhg8
datasource_id: github_osv_importer_v2/GHSA-54qx-8p8w-xhg8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-54qx-8p8w-xhg8/GHSA-54qx-8p8w-xhg8.json
aliases:
  - CVE-2022-36071
summary: |
  SFTPGo vulnerable to recovery codes abuse
  ### Impact

  SFTPGo WebAdmin and WebClient support login using TOTP (Time-based One Time Passwords) as a seconday authentication factor. Because TOTPs are often configured on mobile devices that can be lost, stolen or damaged, SFTPGo also supports recovery codes. These are a set of one time use codes that can be used instead of the TOTP.

  In SFTPGo versions from v2.2.0 to v2.3.3 recovery codes can be generated before enabling two-factor authentication.
  An attacker who knows the user's password could potentially generate some recovery codes and then bypass two-factor authentication after it is enabled on the account at a later time.

  ### Patches

  Fixed in v2.3.4.
  Recovery codes can now only be generated after enabling two-factor authentication and are deleted after disabling it.

  ### Workarounds

  Regenerate recovery codes after enabling two-factor authentication.

  ### References

  https://github.com/drakkan/sftpgo/issues/965
impacted_packages: []
severities:
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-54qx-8p8w-xhg8/GHSA-54qx-8p8w-xhg8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-916
  - CWE-287
references:
  - url: https://github.com/drakkan/sftpgo
    reference_type:
    reference_id:
  - url: https://github.com/drakkan/sftpgo/issues/965
    reference_type:
    reference_id:
  - url: https://github.com/drakkan/sftpgo/security/advisories/GHSA-54qx-8p8w-xhg8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-36071
    reference_type:
    reference_id: CVE-2022-36071
