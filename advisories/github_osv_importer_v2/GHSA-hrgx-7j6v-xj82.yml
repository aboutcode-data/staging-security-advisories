advisory_id: GHSA-hrgx-7j6v-xj82
datasource_id: github_osv_importer_v2/GHSA-hrgx-7j6v-xj82
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-hrgx-7j6v-xj82/GHSA-hrgx-7j6v-xj82.json
aliases:
  - CVE-2022-0087
summary: "Reflected cross-site scripting (XSS) vulnerability\nThis security advisory relates\
  \ to a capability for an attacker to exploit a reflected cross-site scripting vulnerability\
  \ when using the `@keystone-6/auth` package.\n\n#### Impact\nThe vulnerability can impact\
  \ users of the administration user interface when following an untrusted link to the `signin`\
  \ or `init` page.\nThis is a targeted attack and may present itself in the form of phishing\
  \ and or chained in conjunction with some other vulnerability.\n\n## Vulnerability mitigation\n\
  Please upgrade to `@keystone-6/auth >= 1.0.2`, where this vulnerability has been closed.\n\
  If you are using `@keystone-next/auth`,  we **strongly** recommend you upgrade to `@keystone-6`.\n\
  \n### Workarounds\nIf for some reason you cannot upgrade the dependencies in software, you\
  \ could alternatively\n\n- disable the administration user interface, or \n- if using a reverse-proxy,\
  \ strip query parameters when accessing the administration interface\n\n### References\nhttps://owasp.org/www-community/attacks/xss/\n\
  \nThanks to Shivansh Khari (@Shivansh-Khari) for discovering and reporting this vulnerability"
impacted_packages:
  - purl: pkg:npm/%40keystone-6/auth
    affected_versions: vers:npm/<1.0.2
    fixed_versions: vers:npm/1.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40keystone-next/auth
    affected_versions: vers:npm/<=37.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-hrgx-7j6v-xj82/GHSA-hrgx-7j6v-xj82.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/keystonejs/keystone
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/commit/96bf833a23b1a0a5d365cf394467a943cc481b38
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/security/advisories/GHSA-hrgx-7j6v-xj82
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/c9d7374f-2cb9-4bac-9c90-a965942f413e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-0087
    reference_type:
    reference_id: CVE-2022-0087
