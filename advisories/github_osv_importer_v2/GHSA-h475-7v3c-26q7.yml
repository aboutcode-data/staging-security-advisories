advisory_id: GHSA-h475-7v3c-26q7
datasource_id: github_osv_importer_v2/GHSA-h475-7v3c-26q7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-h475-7v3c-26q7/GHSA-h475-7v3c-26q7.json
aliases:
  - CVE-2023-25826
summary: |
  Command injection in OpenTSDB
  Due to insufficient validation of parameters passed to the legacy HTTP query API, it is possible to inject crafted OS commands into multiple parameters and execute malicious code on the OpenTSDB host system. This exploit exists due to an incomplete fix that was made when this vulnerability was previously disclosed as CVE-2020-35476. Regex validation that was implemented to restrict allowed input to the query API does not work as intended, allowing crafted commands to bypass validation.
impacted_packages:
  - purl: pkg:maven/net.opentsdb/opentsdb
    affected_versions: vers:maven/<=2.4.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-h475-7v3c-26q7/GHSA-h475-7v3c-26q7.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: http://packetstormsecurity.com/files/174570/OpenTSDB-2.4.1-Unauthenticated-Command-Injection.html
    reference_type:
    reference_id:
  - url: https://github.com/OpenTSDB/opentsdb
    reference_type:
    reference_id:
  - url: https://github.com/OpenTSDB/opentsdb/pull/2275
    reference_type:
    reference_id:
  - url: https://www.synopsys.com/blogs/software-security/opentsdb
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-25826
    reference_type:
    reference_id: CVE-2023-25826
