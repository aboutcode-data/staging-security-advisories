advisory_id: GHSA-jcxm-7wvp-g6p5
datasource_id: github_osv_importer_v2/GHSA-jcxm-7wvp-g6p5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/12/GHSA-jcxm-7wvp-g6p5/GHSA-jcxm-7wvp-g6p5.json
aliases:
  - CVE-2024-54134
summary: |
  Modified package published to npm, containing malware that exfiltrates private key material
  Earlier today, a publish-access account was compromised for `@solana/web3.js`, a JavaScript library that is commonly used by Solana dapps. This allowed an attacker to publish unauthorized and malicious packages that were modified, allowing them to steal private key material and drain funds from dapps, like bots, that handle private keys directly. This issue should not affect non-custodial wallets, as they generally do not expose private keys during transactions. This is not an issue with the Solana protocol itself, but with a specific JavaScript client library and only appears to affect projects that directly handle private keys and that updated within the window of 3:20pm UTC and 8:25pm UTC on Tuesday, December 3, 2024.

  These two unauthorized versions (1.95.6 and 1.95.7) were caught within hours and have since been unpublished.

  We are asking all Solana app developers to upgrade to version 1.95.8. Developers pinned to `latest` should also upgrade to 1.95.8.

  Developers that suspect they might be compromised should rotate any suspect authority keys, including multisigs, program authorities, server keypairs, and so on.
impacted_packages:
  - purl: pkg:npm/%40solana/web3.js
    affected_versions: vers:npm/>=1.95.6|<1.95.8
    fixed_versions: vers:npm/1.95.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:N/VA:N/SC:H/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/12/GHSA-jcxm-7wvp-g6p5/GHSA-jcxm-7wvp-g6p5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/advisories/GHSA-2mhj-xmf4-pr8m
    reference_type:
    reference_id:
  - url: https://github.com/solana-labs/solana-web3.js
    reference_type:
    reference_id:
  - url: https://github.com/solana-labs/solana-web3.js/security/advisories/GHSA-jcxm-7wvp-g6p5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-54134
    reference_type:
    reference_id: CVE-2024-54134
