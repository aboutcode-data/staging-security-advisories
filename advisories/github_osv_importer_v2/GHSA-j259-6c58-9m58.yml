advisory_id: GHSA-j259-6c58-9m58
datasource_id: github_osv_importer_v2/GHSA-j259-6c58-9m58
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-j259-6c58-9m58/GHSA-j259-6c58-9m58.json
aliases:
  - CVE-2022-35942
summary: |
  loopback-connector-postgresql Vulnerable to Improper Sanitization of `contains` Filter
  Improper input validation on the `contains` LoopBack filter may allow for arbitrary SQL injection.

  ### Impact

  When the extended filter property `contains` is permitted to be interpreted by the Postgres connector, it is possible to inject arbitrary SQL which may affect the confidentiality and integrity of data stored on the connected database.

  This affects users who does any of the following:

  - Connect to the database via the DataSource with `allowExtendedProperties: true` setting OR
  - Uses the connector's CRUD methods directly OR
  - Uses the connector's other methods to interpret the LoopBack filter.

  ### Patches

  Patch release `loopback-connector-postgresql@5.5.1` has been published of which resolves this issue.

  ### Workarounds

  Users who are unable to upgrade should do the following if applicable:

  - Remove `allowExtendedProperties: true` DataSource setting
  - Add `allowExtendedProperties: false` DataSource setting
  - When passing directly to the connector functions, manually sanitize the user input for the `contains` LoopBack filter beforehand.
impacted_packages:
  - purl: pkg:npm/loopback-connector-postgresql
    affected_versions: vers:npm/<5.5.1
    fixed_versions: vers:npm/5.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-j259-6c58-9m58/GHSA-j259-6c58-9m58.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-89
references:
  - url: https://github.com/loopbackio/loopback-connector-postgresql
    reference_type:
    reference_id:
  - url: https://github.com/loopbackio/loopback-connector-postgresql/commit/d57406c6737692a3a106b58a35406290cddb23e5
    reference_type:
    reference_id:
  - url: https://github.com/loopbackio/loopback-connector-postgresql/security/advisories/GHSA-j259-6c58-9m58
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-35942
    reference_type:
    reference_id: CVE-2022-35942
