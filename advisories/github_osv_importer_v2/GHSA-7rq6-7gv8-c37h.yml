advisory_id: GHSA-7rq6-7gv8-c37h
datasource_id: github_osv_importer_v2/GHSA-7rq6-7gv8-c37h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-7rq6-7gv8-c37h/GHSA-7rq6-7gv8-c37h.json
aliases:
  - CVE-2021-41238
summary: "Missing Authorization with Default Settings in Dashboard UI\nDashboard UI in Hangfire.Core\
  \ uses authorization filters to protect it from showing sensitive data to unauthorized users.\
  \ By default when no custom authorization filters specified, `LocalRequestsOnlyAuthorizationFilter`\
  \ filter is being used to allow only local requests and prohibit all the remote requests to\
  \ provide sensible, protected by default settings.\n\nHowever due to the recent changes, in\
  \ version 1.7.25 no authorization filters are used by default, allowing remote requests to\
  \ succeed.\n\n### Impact\n\nMissing authorization when default options are used for the Dashboard\
  \ UI, e.g. when no custom authorization rules are used as recommended in the [Using Dashboard](https://docs.hangfire.io/en/latest/configuration/using-dashboard.html#configuring-authorization)\
  \ documentation article. \n\n#### Impacted\n\nIf you are using `UseHangfireDashboard` method\
  \ with default `DashboardOptions.Authorization` property value, then your installation is\
  \ impacted:\n\n```csharp\napp.UseHangfireDashboard(); // Impacted\napp.UseHangfireDashboard(\"\
  /hangfire\", new DashboardOptions()); // Impacted\n```\n\n#### Not Impacted\n\nIf any other\
  \ authorization filter is specified in the `DashboardOptions.Authorization` property, the\
  \ you are not impacted:\n\n```csharp\napp.UseHangfireDashboard(\"/hangfire\", new DashboardOptions\n\
  {\n    Authorization = new []{ new SomeAuthorizationFilter(); } // Not impacted\n});\n```\n\
  \n### Patches\n\nPatch is already available in version [1.7.26](https://github.com/HangfireIO/Hangfire/releases/tag/v1.7.26)\
  \ and already available on NuGet.org, please see [Hangfire.Core 1.7.26](https://www.nuget.org/packages/Hangfire.Core/1.7.26).\
  \ Default authorization rules now prohibit remote requests by default again by including the\
  \ `LocalRequestsOnlyAuthorizationFilter` filter to the default settings. Please upgrade to\
  \ the newest version in order to mitigate the issue.\n\n### Workarounds\n\nIt is possible\
  \ to fix the issue by using the `LocalRequestsOnlyAuthorizationFilter` explicitly when configuring\
  \ the Dashboard UI. In this case upgrade is not required.\n\n```csharp\n// using Hangfire.Dashboard;\n\
  \napp.UseHangfireDashboard(\"/hangfire\", new DashboardOptions\n{\n    Authorization = new\
  \ []{ new LocalRequestsOnlyAuthorizationFilter(); }\n});\n```\n\n### References\n\nOriginal\
  \ GitHub Issue: https://github.com/HangfireIO/Hangfire/issues/1958"
impacted_packages:
  - purl: pkg:nuget/Hangfire.Core
    affected_versions: vers:nuget/1.7.25
    fixed_versions: vers:nuget/1.7.26
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-7rq6-7gv8-c37h/GHSA-7rq6-7gv8-c37h.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/HangfireIO/Hangfire
    reference_type:
    reference_id:
  - url: https://github.com/HangfireIO/Hangfire/issues/1958
    reference_type:
    reference_id:
  - url: https://github.com/HangfireIO/Hangfire/security/advisories/GHSA-7rq6-7gv8-c37h
    reference_type:
    reference_id:
  - url: https://www.nuget.org/packages/Hangfire.Core
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41238
    reference_type:
    reference_id: CVE-2021-41238
