advisory_id: GHSA-6q4m-7476-932w
datasource_id: github_osv_importer_v2/GHSA-6q4m-7476-932w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-6q4m-7476-932w/GHSA-6q4m-7476-932w.json
aliases:
  - CVE-2023-27581
summary: "github-slug-action vulnerable to arbitrary code execution\n### Impact\n\nThis action\
  \ uses the `github.head_ref` parameter in an insecure way. \n\nThis vulnerability can be triggered\
  \ by any user on GitHub on any workflow using the action on pull requests. They just need\
  \ to create a pull request with a branch name, which can contain the attack payload. (Note\
  \ that first-time PR requests will not be run - but the attacker can submit a valid PR before\
  \ submitting an invalid PR).  This can be used to execute code on the GitHub runners (potentially\
  \ use it for crypto-mining, and waste your resources) and to exfiltrate any secrets you use\
  \ in the CI pipeline.\n\n### Patches\n\n> Pass the variable as an environment variable and\
  \ then use the environment variable instead of substituting it directly.\n\nPatched action\
  \ is available on tag **v4**, tag **v4.4.1**, and any tag beyond.\n\n### Workarounds\n\nNo\
  \ workaround is available if impacted, please upgrade the version\n\n> ℹ️ **v3** and **v4**\
  \ are compatibles.\n\n### References\n\n[Here](https://securitylab.github.com/research/github-actions-untrusted-input/)\
  \ is a set of blog posts by Github's security team explaining this issue.\n\n### Thanks\n\n\
  Thanks to the team of researchers from Purdue University, who are working on finding vulnerabilities\
  \ in CI/CD configurations of open-source software. Their tool detected this security vulnerability."
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-6q4m-7476-932w/GHSA-6q4m-7476-932w.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
references:
  - url: https://github.com/rlespinasse/github-slug-action
    reference_type:
    reference_id:
  - url: https://github.com/rlespinasse/github-slug-action/commit/102b1a064a9b145e56556e22b18b19c624538d94
    reference_type:
    reference_id:
  - url: https://github.com/rlespinasse/github-slug-action/releases/tag/v4.4.1
    reference_type:
    reference_id:
  - url: https://github.com/rlespinasse/github-slug-action/security/advisories/GHSA-6q4m-7476-932w
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/research/github-actions-untrusted-input
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-27581
    reference_type:
    reference_id: CVE-2023-27581
