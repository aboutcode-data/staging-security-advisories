advisory_id: GHSA-8gmx-cpcg-f8h5
datasource_id: github_osv_importer_v2/GHSA-8gmx-cpcg-f8h5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-8gmx-cpcg-f8h5/GHSA-8gmx-cpcg-f8h5.json
aliases:
  - CVE-2021-30455
summary: |
  Double-free in id-map
  The clone_from implementation for IdMap drops the values present in the map and then begins cloning values from the other map. If a .clone() call pancics, then the afformentioned dropped elements can be freed again.
  get_or_insert

  get_or_insert reserves space for a value, before calling the user provided insertion function f. If the function f panics then uninitialized or previously freed memory can be dropped.
  remove_set

  When removing a set of elements, ptr::drop_in_place is called on each of the element to be removed. If the Drop impl of one of these elements panics then the previously dropped elements can be dropped again.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-8gmx-cpcg-f8h5/GHSA-8gmx-cpcg-f8h5.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-415
references:
  - url: https://github.com/andrewhickman/id-map
    reference_type:
    reference_id:
  - url: https://github.com/andrewhickman/id-map/issues/3
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0052.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-30455
    reference_type:
    reference_id: CVE-2021-30455
