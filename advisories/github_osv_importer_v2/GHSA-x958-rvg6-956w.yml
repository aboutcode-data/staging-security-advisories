advisory_id: GHSA-x958-rvg6-956w
datasource_id: github_osv_importer_v2/GHSA-x958-rvg6-956w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-x958-rvg6-956w/GHSA-x958-rvg6-956w.json
aliases:
  - CVE-2025-48937
summary: |
  matrix-sdk-crypto vulnerable to sender of encrypted events being spoofed by homeserver administrator
  ### Summary

  matrix-sdk-crypto since version 0.8.0 up to 0.11.0 does not correctly validate the sender of an encrypted event. Accordingly, a malicious homeserver operator can modify events served to clients, making those events appear to the recipient as if they were sent by another user.

  Although the CVSS score is 4.9 (AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N), we consider this a High Severity security issue.

  ### Details

  The Matrix specification [requires](https://spec.matrix.org/v1.14/client-server-api/#mmegolmv1aes-sha2) that clients ensure that "the eventâ€™s `sender`, `room_id`, and the recorded `session_id` match a trusted session". The vulnerable matrix-sdk-crypto versions check that the `room_id` matches that of the session denoted by `session_id`, but do not check the `sender`.

  ### Patches

  The issue is resolved by [13c1d20](https://github.com/matrix-org/matrix-rust-sdk/commit/13c1d2048286bbabf5e7bc6b015aafee98f04d55), included in versions 0.11.1 and 0.12.0 of matrix-sdk-crypto.

  ### Workarounds

  Since a successful attack requires administrator access to the homeserver, users who trust the administrators of their local homeserver are not affected.

  ### References

   * https://spec.matrix.org/v1.14/client-server-api/#mmegolmv1aes-sha2
impacted_packages: []
severities:
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-x958-rvg6-956w/GHSA-x958-rvg6-956w.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-290
references:
  - url: https://github.com/matrix-org/matrix-rust-sdk
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk/commit/13c1d2048286bbabf5e7bc6b015aafee98f04d55
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk/commit/56980745b4f27f7dc72ac296e6aa003e5d92a75b
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-x958-rvg6-956w
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2025-0041.html
    reference_type:
    reference_id:
  - url: https://spec.matrix.org/v1.14/client-server-api/#mmegolmv1aes-sha2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-48937
    reference_type:
    reference_id: CVE-2025-48937
