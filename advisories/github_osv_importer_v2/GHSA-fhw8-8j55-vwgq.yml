advisory_id: GHSA-fhw8-8j55-vwgq
datasource_id: github_osv_importer_v2/GHSA-fhw8-8j55-vwgq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-fhw8-8j55-vwgq/GHSA-fhw8-8j55-vwgq.json
aliases:
  - CVE-2022-45047
summary: |
  Unsafe deserialization in Apache MINA SSHD
  Class org.apache.sshd.server.keyprovider.SimpleGeneratorHostKeyProvider in Apache MINA SSHD <= 2.9.1 uses Java deserialization to load a serialized java.security.PrivateKey. The class is one of several implementations that an implementor using Apache MINA SSHD can choose for loading the host keys of an SSH server.

  Until version 2.1.0, the code affected by this vulnerability appeared in `org.apache.sshd:sshd-core`. Version 2.1.0 contains a [commit](https://github.com/apache/mina-sshd/commit/10de190e7d3f9189deb76b8d08c72334a1fe2df0) where the code was moved to the package `org.apache.sshd:sshd-common`, which did not exist until version 2.1.0.
impacted_packages:
  - purl: pkg:maven/org.apache.sshd/sshd-common
    affected_versions: vers:maven/<2.9.2
    fixed_versions: vers:maven/2.9.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.sshd/sshd-core
    affected_versions: vers:maven/<2.1.0
    fixed_versions: vers:maven/2.9.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-fhw8-8j55-vwgq/GHSA-fhw8-8j55-vwgq.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://github.com/apache/mina-sshd
    reference_type:
    reference_id:
  - url: https://github.com/apache/mina-sshd/commit/03238d51586f6b3c0bdbb1a23cf16799344d6c32
    reference_type:
    reference_id:
  - url: https://github.com/apache/mina-sshd/commit/10de190e7d3f9189deb76b8d08c72334a1fe2df0
    reference_type:
    reference_id:
  - url: https://github.com/apache/mina-sshd/commit/5a8fe830b2a2308a2b24ac8115a391af477f64f5
    reference_type:
    reference_id:
  - url: https://www.mail-archive.com/dev@mina.apache.org/msg39312.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-45047
    reference_type:
    reference_id: CVE-2022-45047
