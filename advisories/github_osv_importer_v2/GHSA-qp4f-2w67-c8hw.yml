advisory_id: GHSA-qp4f-2w67-c8hw
datasource_id: github_osv_importer_v2/GHSA-qp4f-2w67-c8hw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-qp4f-2w67-c8hw/GHSA-qp4f-2w67-c8hw.json
aliases:
  - CVE-2020-2099
summary: |
  Inbound TCP Agent Protocol/3 authentication bypass in Jenkins
  Jenkins 2.213 and earlier, LTS 2.204.1 and earlier includes support for the Inbound TCP Agent Protocol/3 for communication between controller and agents. While [this protocol has been deprecated in 2018](https://www.jenkins.io/changelog-old/#v2.128) and was recently removed from Jenkins in 2.214, it could still easily be enabled in Jenkins LTS 2.204.1, 2.213, and older.

  This protocol incorrectly reuses encryption parameters which allow an unauthenticated remote attacker to determine the connection secret. This secret can then be used to connect attacker-controlled Jenkins agents to the Jenkins controller.

  Jenkins 2.204.2 no longer allows for the use of Inbound TCP Agent Protocol/3 by default. The system property `jenkins.slaves.JnlpSlaveAgentProtocol3.ALLOW_UNSAFE` can be set to `true` to allow enabling the Inbound TCP Agent Protocol/3 in Jenkins 2.204.2, but doing so is strongly discouraged.

  Inbound TCP Agent Protocol/3 was removed completely from Jenkins 2.214 and will not be part of Jenkins LTS after the end of the 2.204.x line.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.main/jenkins-core
    affected_versions: vers:maven/<2.204.2
    fixed_versions: vers:maven/2.204.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.main/jenkins-core
    affected_versions: vers:maven/>=2.205|<2.214
    fixed_versions: vers:maven/2.214
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-qp4f-2w67-c8hw/GHSA-qp4f-2w67-c8hw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-330
  - CWE-323
references:
  - url: https://access.redhat.com/errata/RHSA-2020:0681
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2020:0683
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/jenkins
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/jenkins/commit/5054bc6e12e1022993d719f66e289ab1d22ae854
    reference_type:
    reference_id:
  - url: https://jenkins.io/security/advisory/2020-01-29/#SECURITY-1682
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2020/01/29/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-2099
    reference_type:
    reference_id: CVE-2020-2099
  - url: https://access.redhat.com/errata/RHBA-2020:0402
    reference_type:
    reference_id: RHBA-2020:0402
  - url: https://access.redhat.com/errata/RHBA-2020:0675
    reference_type:
    reference_id: RHBA-2020:0675
