advisory_id: GHSA-2jrm-gww7-wch2
datasource_id: github_osv_importer_v2/GHSA-2jrm-gww7-wch2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-2jrm-gww7-wch2/GHSA-2jrm-gww7-wch2.json
aliases:
  - CVE-2021-20187
summary: |
  Moodle Arbitrary PHP code execution by site admins via Shibboleth configuration
  It was found in Moodle before version 3.10.1, 3.9.4, 3.8.7 and 3.5.16 that it was possible for site administrators to execute arbitrary PHP scripts via a PHP include used during Shibboleth authentication.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.5.0|<3.5.16
    fixed_versions: vers:composer/3.5.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.8.0|<3.8.7
    fixed_versions: vers:composer/3.8.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.9.0|<3.9.4
    fixed_versions: vers:composer/3.9.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.10.0|<3.10.1
    fixed_versions: vers:composer/3.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-2jrm-gww7-wch2/GHSA-2jrm-gww7-wch2.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-829
  - CWE-94
references:
  - url: https://github.com/moodle/moodle
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=417171
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-20187
    reference_type:
    reference_id: CVE-2021-20187
