advisory_id: GHSA-qxp6-27gw-99cj
datasource_id: github_osv_importer_v2/GHSA-qxp6-27gw-99cj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-qxp6-27gw-99cj/GHSA-qxp6-27gw-99cj.json
aliases:
  - CVE-2021-21615
summary: |
  Time-of-check Time-of-use (TOCTOU) Race Condition in Jenkins
  Due to a time-of-check to time-of-use (TOCTOU) race condition, the file browser for workspaces, archived artifacts, and `$JENKINS_HOME/userContent/` follows symbolic links to locations outside the directory being browsed in Jenkins 2.275 and LTS 2.263.2.

  This allows attackers with Job/Workspace permission and the ability to control workspace contents, e.g., with Job/Configure permission or the ability to change SCM contents, to create symbolic links that allow them to access files outside workspaces using the workspace browser.

  This issue is caused by an incorrectly applied fix for SECURITY-1452 / CVE-2021-21602 in the [2021-01-13 security advisory](https://www.jenkins.io/security/advisory/2021-01-13/#SECURITY-1452).

  Jenkins 2.276, LTS 2.263.3 no longer differentiates the check and the use of symlinks in workspace browsers.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.main/jenkins-core
    affected_versions: vers:maven/<=2.263.2
    fixed_versions: vers:maven/2.263.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.main/jenkins-core
    affected_versions: vers:maven/<=2.275
    fixed_versions: vers:maven/2.276
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-qxp6-27gw-99cj/GHSA-qxp6-27gw-99cj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-367
references:
  - url: https://www.jenkins.io/security/advisory/2021-01-26/#SECURITY-2197
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/01/26/2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21615
    reference_type:
    reference_id: CVE-2021-21615
