advisory_id: GHSA-wp3j-rvfp-624h
datasource_id: github_osv_importer_v2/GHSA-wp3j-rvfp-624h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-wp3j-rvfp-624h/GHSA-wp3j-rvfp-624h.json
aliases:
  - CVE-2015-3900
summary: |
  RubyGems vulnerable to DNS hijack attack
  RubyGems 2.0.x before 2.0.16, 2.2.x before 2.2.4, and 2.4.x before 2.4.7 does not validate the hostname when fetching gems or making API requests, which allows remote attackers to redirect requests to arbitrary domains via a crafted DNS SRV record, aka a "DNS hijack attack."
impacted_packages:
  - purl: pkg:gem/rubygems-update
    affected_versions: vers:gem/>=2.0.0|<2.0.16
    fixed_versions: vers:gem/2.0.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rubygems-update
    affected_versions: vers:gem/>=2.2.0|<2.2.4
    fixed_versions: vers:gem/2.2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rubygems-update
    affected_versions: vers:gem/>=2.4.0|<2.4.7
    fixed_versions: vers:gem/2.4.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-350
references:
  - url: http://blog.rubygems.org/2015/05/14/CVE-2015-3900.html
    reference_type:
    reference_id:
  - url: http://lists.fedoraproject.org/pipermail/package-announce/2015-August/163502.html
    reference_type:
    reference_id:
  - url: http://lists.fedoraproject.org/pipermail/package-announce/2015-August/163600.html
    reference_type:
    reference_id:
  - url: http://lists.fedoraproject.org/pipermail/package-announce/2015-August/164236.html
    reference_type:
    reference_id:
  - url: http://rhn.redhat.com/errata/RHSA-2015-1657.html
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rubygems-update/CVE-2015-3900.yml
    reference_type:
    reference_id:
  - url: https://puppet.com/security/cve/CVE-2015-3900
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20170331091241/https://puppet.com/security/cve/CVE-2015-3900
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20200228055155/http://www.securityfocus.com/bid/75482
    reference_type:
    reference_id:
  - url: https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2015-007/?fid=6356
    reference_type:
    reference_id:
  - url: https://www.trustwave.com/Resources/SpiderLabs-Blog/Attacking-Ruby-Gem-Security-with-CVE-2015-3900
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2015/06/26/2
    reference_type:
    reference_id:
  - url: http://www.oracle.com/technetwork/topics/security/bulletinoct2015-2511968.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2015-3900
    reference_type:
    reference_id: CVE-2015-3900
