advisory_id: GHSA-qwrj-9hmp-gpxh
datasource_id: github_osv_importer_v2/GHSA-qwrj-9hmp-gpxh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-qwrj-9hmp-gpxh/GHSA-qwrj-9hmp-gpxh.json
aliases:
  - CVE-2022-31145
summary: |
  FlyteAdmin Insufficient AccessToken Expiration Check
  ### Impact
  Authenticated users using an external identity provider can continue to use Access Tokens and ID Tokens even after they expire.
  Using flyteadmin as the OAuth2 Authorization Server is unaffected by this issue.

  ### Patches
  1.1.30

  ### Workarounds
  Rotating signing keys immediately will:
  * Invalidate all open sessions,
  * Force all users to attempt to obtain new tokens.

  Continue to rotate keys until flyteadmin has been upgraded,

  Hide flyteadmin deployment ingress url from the internet.

  ### References
  https://github.com/flyteorg/flyteadmin/pull/455

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [flyte repo](https://github.com/flyteorg/flyte/issues)
  * Email us at [flyte](mailto:admin@flyte.org)
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-qwrj-9hmp-gpxh/GHSA-qwrj-9hmp-gpxh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-298
  - CWE-613
references:
  - url: https://github.com/flyteorg/flyteadmin
    reference_type:
    reference_id:
  - url: https://github.com/flyteorg/flyteadmin/commit/a1ec282d02706e074bc4986fd0412e5da3b9d00a
    reference_type:
    reference_id:
  - url: https://github.com/flyteorg/flyteadmin/pull/455
    reference_type:
    reference_id:
  - url: https://github.com/flyteorg/flyteadmin/releases/tag/v1.1.31
    reference_type:
    reference_id:
  - url: https://github.com/flyteorg/flyteadmin/security/advisories/GHSA-qwrj-9hmp-gpxh
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-0519
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31145
    reference_type:
    reference_id: CVE-2022-31145
