advisory_id: GHSA-h6j3-j35f-v2x7
datasource_id: github_osv_importer_v2/GHSA-h6j3-j35f-v2x7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-h6j3-j35f-v2x7/GHSA-h6j3-j35f-v2x7.json
aliases: []
summary: |
  PocketMine-MP server crash with certain invalid JSON payloads in `LoginPacket` due to dependency vulnerability (3rd time)
  ### Impact
  An attacker could crash PocketMine-MP by sending malformed JSON in LoginPacket.

  [netresearch/jsonmapper](https://github.com/cweiske/JsonMapper) allows objects to be hydrated from scalar types in JSON. However, due to the lack of validation in the code for this feature, it may output improperly initialized objects if applied to objects whose constructors don't handle the input values.

  Code handling these objects in PocketMine-MP could then crash due to `@required` properties not being set within the objects.

  In addition, because JsonMapper does not respect `bStrictObjectTypes` when processing arrays, it's not possible to avoid the issue by disabling the feature.

  Due to the relatively high number of security issues arising from unexpected behaviour in JsonMapper, the team is exploring options to replace it.

  ### Patches
  In the meantime, the issue was fixed by pmmp/netresearch-jsonmapper@b96a209f9e8b76b899a0d0918493cd87eb3c02a7 and 6872661fd03649cc7a8762c41c16e9ee5a4de1c9.

  ### Workarounds
  Detecting the malicious data that triggers this issue is of rather high difficulty, so it's not likely that a plugin would be able to easily remediate this.

  ### References
  https://github.com/cweiske/jsonmapper/pull/225
  https://github.com/cweiske/jsonmapper/issues/226
impacted_packages:
  - purl: pkg:composer/pocketmine/pocketmine-mp
    affected_versions: vers:composer/<5.11.1
    fixed_versions: vers:composer/5.11.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-h6j3-j35f-v2x7/GHSA-h6j3-j35f-v2x7.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/cweiske/jsonmapper/issues/226
    reference_type:
    reference_id:
  - url: https://github.com/cweiske/jsonmapper/pull/225
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/netresearch-jsonmapper/commit/b96a209f9e8b76b899a0d0918493cd87eb3c02a7
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/commit/6872661fd03649cc7a8762c41c16e9ee5a4de1c9
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-h6j3-j35f-v2x7
    reference_type:
    reference_id:
