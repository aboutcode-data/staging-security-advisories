advisory_id: GHSA-x3cf-w64x-4cp2
datasource_id: github_osv_importer_v2/GHSA-x3cf-w64x-4cp2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-x3cf-w64x-4cp2/GHSA-x3cf-w64x-4cp2.json
aliases:
  - CVE-2018-19789
summary: |
  Symfony Path Disclosure
  An issue was discovered in Symfony 2.7.x before 2.7.50, 2.8.x before 2.8.49, 3.x before 3.4.20, 4.0.x before 4.0.15, 4.1.x before 4.1.9, and 4.2.x before 4.2.1. When using the scalar type hint `string` in a setter method (e.g. `setName(string $name)`) of a class that's the `data_class` of a form, and when a file upload is submitted to the corresponding field instead of a normal text input, then `UploadedFile::__toString()` is called which will then return and disclose the path of the uploaded file. If combined with a local file inclusion issue in certain circumstances this could escalate it to a Remote Code Execution.
impacted_packages:
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=2.7.0|<2.7.50
    fixed_versions: vers:composer/2.7.50
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=2.8.0|<2.8.49
    fixed_versions: vers:composer/2.8.49
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=3.0.0|<3.4.20
    fixed_versions: vers:composer/3.4.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=4.0.0|<4.0.15
    fixed_versions: vers:composer/4.0.15
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=4.1.0|<4.1.9
    fixed_versions: vers:composer/4.1.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=4.2.0|<4.2.1
    fixed_versions: vers:composer/4.2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/form
    affected_versions: vers:composer/>=2.7.0|<2.7.50
    fixed_versions: vers:composer/2.7.50
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/form
    affected_versions: vers:composer/>=2.8.0|<2.8.49
    fixed_versions: vers:composer/2.8.49
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/form
    affected_versions: vers:composer/>=3.0.0|<3.4.20
    fixed_versions: vers:composer/3.4.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/form
    affected_versions: vers:composer/>=4.0.0|<4.0.15
    fixed_versions: vers:composer/4.0.15
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/form
    affected_versions: vers:composer/>=4.1.0|<4.1.9
    fixed_versions: vers:composer/4.1.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/form
    affected_versions: vers:composer/>=4.2.0|<4.2.1
    fixed_versions: vers:composer/4.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-x3cf-w64x-4cp2/GHSA-x3cf-w64x-4cp2.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/form/CVE-2018-19789.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2018-19789.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/b65e6f1a47b68f2713b60cdac9cc3a4af62a2d1c
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2019/03/msg00009.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4TD3E7FZIXLVFG3SMFJPDEKPZ26TJOW7
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/JZMRJ7VTHCY5AZK24G4QGX36RLUDTDKE
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OA4WVFN5FYPIXAPLWZI6N425JHHDSWAZ
    reference_type:
    reference_id:
  - url: https://seclists.org/bugtraq/2019/May/21
    reference_type:
    reference_id:
  - url: https://symfony.com/blog/cve-2018-19789-disclosure-of-uploaded-files-full-path
    reference_type:
    reference_id:
  - url: https://symfony.com/cve-2018-19789
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20210124224817/http://www.securityfocus.com/bid/106249
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2019/dsa-4441
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-19789
    reference_type:
    reference_id: CVE-2018-19789
