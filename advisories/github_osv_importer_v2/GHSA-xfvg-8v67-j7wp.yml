advisory_id: GHSA-xfvg-8v67-j7wp
datasource_id: github_osv_importer_v2/GHSA-xfvg-8v67-j7wp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-xfvg-8v67-j7wp/GHSA-xfvg-8v67-j7wp.json
aliases:
  - CVE-2026-27621
summary: "TypiCMS Core has Stored Cross-Site Scripting (XSS) via SVG File Upload\n#### I. Summary\n\
  \nA Stored Cross-Site Scripting (XSS) vulnerability exists in the file upload module of TypiCMS.\
  \ The application allows users with file upload permissions to upload SVG files. While there\
  \ is a MIME type validation, the content of the SVG file is not sanitized. An attacker can\
  \ upload a specially crafted SVG file containing malicious JavaScript code. When another user\
  \ (such as an administrator) views or accesses this file through the application, the script\
  \ executes in their browser, leading to a compromise of that user's session.\n\nThe issue\
  \ is exacerbated by a bug in the SVG parsing logic, which can cause a 500 error if the uploaded\
  \ SVG does not contain a `viewBox` attribute. However, this does not mitigate the XSS vulnerability,\
  \ as an attacker can easily include a valid `viewBox` attribute in their malicious payload.\n\
  \n#### II. Vulnerability Details\n\n*   **Vulnerability Type:** Stored Cross-Site Scripting\
  \ (XSS) (CWE-79)\n*   **Affected Component:** `TypiCMS\\Modules\\Core\\Http\\Requests\\FileFormRequest.php`\
  \ and `TypiCMS\\Modules\\Core\\Services\\FileUploader.php`.\n*  **Affected Versions:** <=\
  \ 16.0.5\n\nThe vulnerability stems from two main points:\n\n1.  **Permissive File Validation:**\
  \ The `FileFormRequest` explicitly whitelists `svg` as an allowed MIME type for uploads.\n\
  2.  **Lack of Content Sanitization:** The `FileUploader` service saves the SVG file to the\
  \ server without parsing and sanitizing its content to remove potentially malicious elements\
  \ like `<script>` tags or `on*` event handlers.\n\nWhen the default filesystem disk is set\
  \ to `public`, the uploaded SVG file is stored in a publicly accessible directory, making\
  \ it trivial to access the file via a direct URL and trigger the XSS payload.\n\n#### III.\
  \ Proof of Concept (PoC)\n\n1.  **Create a Malicious SVG File:**\n    Create a file named\
  \ `malicious.svg` with the following content. The `viewBox` attribute is included to bypass\
  \ the application's parsing bug.\n\n    ```xml\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\
  \ viewBox=\"0 0 100 100\">\n        <script>\n            // A simple PoC to demonstrate the\
  \ vulnerability\n            alert('XSS in TypiCMS! Your session cookie is: ' + document.cookie);\n\
  \        </script>\n        <text x=\"10\" y=\"50\">If you see this, the script has run.</text>\n\
  \    </svg>\n    ```\n\n2.  **Upload the Malicious File:**\n    *   Log in to the TypiCMS\
  \ admin panel as a user with permissions to upload files.\n    *   Navigate to the \"Files\"\
  \ module (e.g., `/admin/files`).\n    *   Upload the `malicious.svg` file. The application\
  \ will accept the file and store it.\n<img width=\"2540\" height=\"1217\" alt=\"image\" src=\"\
  https://github.com/user-attachments/assets/beb8ace9-ac39-442c-a2bc-3fbfb09f8c32\" />\n<img\
  \ width=\"1718\" height=\"671\" alt=\"image\" src=\"https://github.com/user-attachments/assets/9cd4a3f8-28e3-4223-8203-7ab292eaf95f\"\
  \ />\n\n3.  **Trigger the XSS:**\n    *   The application will provide a public URL for the\
  \ uploaded file, typically in the format `http://<your-site>/storage/files/malicious.svg`.\n\
  \    *   Anyone who navigates to this URL will have the embedded JavaScript executed in their\
  \ browser.\n    *   An attacker can send this link to a privileged user (e.g., an administrator).\
  \ When the administrator clicks the link, their session cookies can be stolen, or the attacker\
  \ can perform actions on their behalf.\n    \n<img width=\"2091\" height=\"704\" alt=\"image\"\
  \ src=\"https://github.com/user-attachments/assets/99c915bb-a518-46aa-b237-390cd58f34e7\"\
  \ />\n<img width=\"1457\" height=\"996\" alt=\"image\" src=\"https://github.com/user-attachments/assets/0ed000ec-78cf-4ed8-8cd5-2886fbb2afc0\"\
  \ />\n\n\n#### IV. Impact\n\nSuccessful exploitation of this vulnerability allows an attacker\
  \ to execute arbitrary JavaScript in the context of the victim's browser. Although the use\
  \ of the `HttpOnly` flag on session cookies prevents direct theft of the session ID via `document.cookie`,\
  \ the attacker can still achieve a full compromise of the victim's account by performing actions\
  \ on their behalf.\n\nThe impact includes:\n\n*   **Account Takeover via Action Forgery:**\
  \ The attacker's script can make authenticated requests to the application's API from the\
  \ victim's browser. This allows the attacker to perform any action the victim is authorized\
  \ to do, such as:\n    *   Creating a new administrator account for the attacker.\n    * \
  \  Changing the victim's email address and password.\n    *   Deleting or modifying all content,\
  \ users, and settings.\n\n*   **Sensitive Information Disclosure:** The script can read the\
  \ content of any page the victim views within the admin panel. This includes lists of users\
  \ (with names and emails), private application settings, and other sensitive data, which can\
  \ then be exfiltrated to an attacker-controlled server.\n\n*   **Phishing and Social Engineering:**\
  \ The script can manipulate the admin panel's UI to display fake login forms to trick the\
  \ user into re-entering their credentials, or redirect them to a malicious website.\n\n* \
  \  **Keystroke Logging:** The script can capture any information the victim types into forms\
  \ on the compromised page.\n\nBecause the attacker can perform any action as an authenticated\
  \ administrator, this vulnerability effectively leads to a **full application compromise**,\
  \ even without direct access to the session cookie. The risk is **High**.\n\n\n#### V. Recommended\
  \ Patches and Mitigations\n\nIt is recommended to apply a defense-in-depth approach to mitigate\
  \ this vulnerability.\n\n1.  **Primary Fix: Sanitize SVG Content:**\n    The most robust solution\
  \ is to sanitize SVG files upon upload. Before saving the file, it should be parsed to remove\
  \ all potentially dangerous elements, including `<script>`, `<style>`, `<foreignObject>` tags,\
  \ and all `on*` event attributes. This can be achieved using a dedicated SVG sanitization\
  \ library.\n\n2.  **Secondary Fix: Disable SVG Uploads:**\n    If SVG uploads are not a critical\
  \ feature for the application, the simplest and most secure solution is to disable them entirely.\
  \ This can be done by removing `'svg'` from the list of allowed MIME types in `TypiCMS\\Modules\\\
  Core\\Http\\Requests\\FileFormRequest.php`.\n\n    ```php\n    // In FileFormRequest.php\n\
  \    // BEFORE:\n    $fileRule = 'mimes:jpeg,gif,png,...,svg,...|max:...';\n\n    // AFTER:\n\
  \    $fileRule = 'mimes:jpeg,gif,png,...,pdf,...|max:...'; // Removed 'svg'\n    ```\n\n3.\
  \  **Hardening - Content-Security-Policy (CSP):**\n    Implement a strict Content-Security-Policy\
  \ (CSP) header for the application. A well-configured CSP can prevent the execution of inline\
  \ scripts, which would mitigate the impact of this XSS vulnerability.\n\n4.  **Hardening -\
  \ Serve User Content from a Separate Domain:**\n    Serve all user-uploaded files from a separate,\
  \ cookie-less domain. This is a highly effective security measure that isolates user-generated\
  \ content from the main application, preventing scripts from accessing session cookies or\
  \ interacting with the application's DOM."
impacted_packages:
  - purl: pkg:composer/typicms/core
    affected_versions: vers:composer/<16.1.7
    fixed_versions: vers:composer/16.1.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:A/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-xfvg-8v67-j7wp/GHSA-xfvg-8v67-j7wp.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/TypiCMS/Core
    reference_type:
    reference_id:
  - url: https://github.com/TypiCMS/Core/commit/d480a0be1e8e7c0600bb9a325bb11920ee66497d
    reference_type:
    reference_id:
  - url: https://github.com/TypiCMS/Core/security/advisories/GHSA-xfvg-8v67-j7wp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-27621
    reference_type:
    reference_id: CVE-2026-27621
