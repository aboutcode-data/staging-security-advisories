advisory_id: GHSA-8wm5-8h9c-47pc
datasource_id: github_osv_importer_v2/GHSA-8wm5-8h9c-47pc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-8wm5-8h9c-47pc/GHSA-8wm5-8h9c-47pc.json
aliases:
  - CVE-2022-25168
summary: |
  Apache Hadoop argument injection vulnerability
  Apache Hadoop's `FileUtil.unTar(File, File)` API does not escape the input file name before being passed to the shell. An attacker can inject arbitrary commands. This is only used in Hadoop 3.3 InMemoryAliasMap.completeBootstrapTransfer, which is only ever run by a local user. It has been used in Hadoop 2.x for yarn localization, which does enable remote code execution. It is used in Apache Spark, from the SQL command ADD ARCHIVE. As the ADD ARCHIVE command adds new binaries to the classpath, being able to execute shell scripts does not confer new permissions to the caller. SPARK-38305. "Check existence of file before untarring/zipping", which is included in 3.3.0, 3.1.4, 3.2.2, prevents shell commands being executed, regardless of which version of the hadoop libraries are in use. Users should upgrade to Apache Hadoop 2.10.2, 3.2.4, 3.3.3 or upper (including HADOOP-18136).
impacted_packages:
  - purl: pkg:maven/org.apache.hadoop/hadoop-common
    affected_versions: vers:maven/>=2.0.0|<2.10.2
    fixed_versions: vers:maven/2.10.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.hadoop/hadoop-common
    affected_versions: vers:maven/>=3.0.0-alpha|<3.2.4
    fixed_versions: vers:maven/3.2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.hadoop/hadoop-common
    affected_versions: vers:maven/>=3.3.0|<3.3.3
    fixed_versions: vers:maven/3.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-8wm5-8h9c-47pc/GHSA-8wm5-8h9c-47pc.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-88
  - CWE-78
references:
  - url: https://github.com/apache/hadoop
    reference_type:
    reference_id:
  - url: https://github.com/apache/hadoop/commit/cae749b076f35f0be13a926ee8cfbb7ce4402746
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/mxqnb39jfrwgs3j6phwvlrfq4mlox130
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220915-0007
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-25168
    reference_type:
    reference_id: CVE-2022-25168
