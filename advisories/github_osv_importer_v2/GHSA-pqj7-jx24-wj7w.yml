advisory_id: GHSA-pqj7-jx24-wj7w
datasource_id: github_osv_importer_v2/GHSA-pqj7-jx24-wj7w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-pqj7-jx24-wj7w/GHSA-pqj7-jx24-wj7w.json
aliases:
  - CVE-2023-29195
summary: "VTAdmin users that can create shards can deny access to other functions\n### Impact\n\
  Users can either intentionally or inadvertently create a shard containing `/` characters from\
  \ VTAdmin such that from that point on, anyone who tries to create a new shard from VTAdmin\
  \ will receive an error. \nAttempting to view the keyspace(s) will also no longer work.\n\
  Creating a shard using `vtctldclient` does not have the same problem because the CLI validates\
  \ the input correctly.\n\n### Patches\nv16.0.2, corresponding to [0.16.2 on pkg.go.dev](https://pkg.go.dev/vitess.io/vitess@v0.16.2)\n\
  \n### Workarounds\n- Always use `vtctldclient` to create shards, instead of using VTAdmin\n\
  - Disable creating shards from VTAdmin using RBAC\n- Delete the topology record for the offending\
  \ shard using the client for your topology server. For example, if you created a shard called\
  \ `a/b` in keyspace `commerce`, and you are running etcd, it can be deleted by doing something\
  \ like\n```\n% etcdctl --endpoints \"http://${ETCD_SERVER}\" del /vitess/global/keyspaces/commerce/shards/a/b/Shard\n\
  ```\n\n### References\nhttps://github.com/vitessio/vitess/issues/12842\n\nFound during a security\
  \ audit sponsored by the [CNCF](https://cncf.io) and facilitated by [OSTIF](https://ostif.org)."
impacted_packages: []
severities:
  - score: '4.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-pqj7-jx24-wj7w/GHSA-pqj7-jx24-wj7w.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-703
references:
  - url: https://github.com/vitessio/vitess
    reference_type:
    reference_id:
  - url: https://github.com/vitessio/vitess/commit/9dcbd7de3180f47e94f54989fb5c66daea00c920
    reference_type:
    reference_id:
  - url: https://github.com/vitessio/vitess/issues/12842
    reference_type:
    reference_id:
  - url: https://github.com/vitessio/vitess/pull/12843
    reference_type:
    reference_id:
  - url: https://github.com/vitessio/vitess/releases/tag/v16.0.2
    reference_type:
    reference_id:
  - url: https://github.com/vitessio/vitess/security/advisories/GHSA-pqj7-jx24-wj7w
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vitess.io/vitess@v0.16.2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29195
    reference_type:
    reference_id: CVE-2023-29195
