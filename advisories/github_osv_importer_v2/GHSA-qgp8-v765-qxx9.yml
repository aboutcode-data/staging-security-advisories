advisory_id: GHSA-qgp8-v765-qxx9
datasource_id: github_osv_importer_v2/GHSA-qgp8-v765-qxx9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-qgp8-v765-qxx9/GHSA-qgp8-v765-qxx9.json
aliases:
  - CVE-2025-4144
summary: |
  @cloudflare/workers-oauth-provider PKCE bypass via downgrade attack
  ### Summary
  PKCE was implemented in the OAuth implementation in workers-oauth-provider that is part of[ MCP framework](https://github.com/cloudflare/workers-mcp). However, it was found that an attacker could cause the check to be skipped.

  ### Impact
  PKCE is a defense-in-depth mechanism against certain kinds of attacks and was an optional extension in OAuth 2.0 which became required in the OAuth 2.1 draft. (Note that the MCP specification requires OAuth 2.1.)
  This bug completely bypasses PKCE protection.


  ### Patches
  Fixed in: https://github.com/cloudflare/workers-oauth-provider/pull/27

  We patched up the vulnerabilities in the latest version, v 0.0.5 of the Workers OAuth provider (https://www.npmjs.com/package/@cloudflare/workers-oauth-provider). You'll need to update your MCP servers to use that version to resolve the vulnerability.

  ### Workarounds
  None
impacted_packages:
  - purl: pkg:npm/%40cloudflare/workers-oauth-provider
    affected_versions: vers:npm/<0.0.5
    fixed_versions: vers:npm/0.0.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-qgp8-v765-qxx9/GHSA-qgp8-v765-qxx9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/cloudflare/workers-oauth-provider
    reference_type:
    reference_id:
  - url: https://github.com/cloudflare/workers-oauth-provider/pull/27
    reference_type:
    reference_id:
  - url: https://github.com/cloudflare/workers-oauth-provider/security/advisories/GHSA-qgp8-v765-qxx9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-4144
    reference_type:
    reference_id: CVE-2025-4144
