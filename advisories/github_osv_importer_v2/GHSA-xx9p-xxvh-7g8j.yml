advisory_id: GHSA-xx9p-xxvh-7g8j
datasource_id: github_osv_importer_v2/GHSA-xx9p-xxvh-7g8j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-xx9p-xxvh-7g8j/GHSA-xx9p-xxvh-7g8j.json
aliases:
  - CVE-2023-47641
summary: |
  Aiohttp has inconsistent interpretation of `Content-Length` vs. `Transfer-Encoding` differing in C and Python fallbacks
  ### Impact

  Aiohttp has a security vulnerability regarding the inconsistent interpretation of the http protocol. As we know that HTTP/1.1 is persistent, if we have both Content-Length(CL) and Transfer-Encoding(TE) it can lead to incorrect interpretation of two entities that parse the HTTP and we can poison other sockets with this incorrect interpretation.

  A possible Proof-of-Concept (POC) would be a configuration with a reverse proxy(frontend) that accepts both CL and TE headers and aiohttp as backend. As aiohttp parses anything with chunked, we can pass a chunked123 as TE, the frontend entity will ignore this header and will parse Content-Length. I can give a Dockerfile with the configuration if you want.

  The impact of this vulnerability is that it is possible to bypass any proxy rule, poisoning sockets to other users like passing Authentication Headers, also if it is present an Open Redirect (just like CVE-2021-21330) we can combine it to redirect random users to our website and log the request.


  ### References

  - https://github.com/aio-libs/aiohttp/commit/f016f0680e4ace6742b03a70cb0382ce86abe371
impacted_packages:
  - purl: pkg:pypi/aiohttp
    affected_versions: vers:pypi/<3.8.0
    fixed_versions: vers:pypi/3.8.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-xx9p-xxvh-7g8j/GHSA-xx9p-xxvh-7g8j.json
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:L/VI:N/VA:N/SC:L/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-xx9p-xxvh-7g8j/GHSA-xx9p-xxvh-7g8j.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-444
references:
  - url: https://github.com/aio-libs/aiohttp
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/commit/f016f0680e4ace6742b03a70cb0382ce86abe371
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/releases/tag/v3.8.0
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/security/advisories/GHSA-xx9p-xxvh-7g8j
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/aiohttp/PYSEC-2023-247.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/02/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-47641
    reference_type:
    reference_id: CVE-2023-47641
