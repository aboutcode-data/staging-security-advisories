advisory_id: GHSA-gcj7-j438-hjj2
datasource_id: github_osv_importer_v2/GHSA-gcj7-j438-hjj2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-gcj7-j438-hjj2/GHSA-gcj7-j438-hjj2.json
aliases:
  - CVE-2022-24825
summary: |
  Smokescreen SSRF via deny list bypass
  The primary use case for Smokescreen is to prevent server-side request forgery (SSRF) attacks in which external attackers leverage the behavior of applications to connect to or scan internal infrastructure.

  Smokescreen also offers an option to deny access to additional (e.g., external) URLs by way of a deny list. There was an issue in Smokescreen that made it possible to bypass the deny list feature by appending a dot to the end of user-supplied URLs, or by providing input in a different letter case.

  ### Recommendation
  Upgrade Smokescreen to version 0.0.3 or later.

  ### Acknowledgements
  Thanks to [Grzegorz Niedziela](https://twitter.com/gregxsunday) for reporting the issue.

  ### For more information
  Email us at security@stripe.com
impacted_packages: []
severities:
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-gcj7-j438-hjj2/GHSA-gcj7-j438-hjj2.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: github.com/stripe/smokescreen
    reference_type:
    reference_id:
  - url: https://github.com/stripe/smokescreen/commit/fafb6ae48c6c40aa011d87b61306abc48db8797b
    reference_type:
    reference_id:
  - url: https://github.com/stripe/smokescreen/security/advisories/GHSA-gcj7-j438-hjj2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24825
    reference_type:
    reference_id: CVE-2022-24825
