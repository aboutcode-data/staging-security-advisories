advisory_id: GHSA-2m6g-crv8-p3c6
datasource_id: github_osv_importer_v2/GHSA-2m6g-crv8-p3c6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-2m6g-crv8-p3c6/GHSA-2m6g-crv8-p3c6.json
aliases:
  - CVE-2022-36079
summary: |
  Parse Server vulnerable to brute force guessing of user sensitive data via search patterns
  ### Impact

  Internal fields (keys used internally by Parse Server, prefixed by `_`) and protected fields (user defined) can be used as query constraints. Internal and protected fields are removed by Parse Server from query results and are only returned to the client using a valid master key. However, using query constraints, these fields can be guessed by enumerating until Parse Server returns a response object.

  ### Patches

  The patch requires the master key to use internal and protected fields as query constraints.

  ### Workarounds

  Implement a Parse Cloud Trigger `beforeFind` and manually remove the query constraints, such as:

  ```js
  Parse.Cloud.beforeFind('TestObject', ({ query }) => {
    for (const key in query._where || []) {
      // Repeat logic for protected fields
      if (key.charAt(0) === '_') {
        delete query._where[key];
      }
    }
  });
  ```

  ### References

  - https://github.com/parse-community/parse-server/security/advisories/GHSA-2m6g-crv8-p3c6
impacted_packages:
  - purl: pkg:npm/parse-server
    affected_versions: vers:npm/<4.10.14
    fixed_versions: vers:npm/4.10.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/parse-server
    affected_versions: vers:npm/>=5.0.0|<5.2.5
    fixed_versions: vers:npm/5.2.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-2m6g-crv8-p3c6/GHSA-2m6g-crv8-p3c6.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/parse-community/parse-server
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/commit/634c44acd18f6ee6ec60fac89a2b602d92799bec
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/commit/e39d51bd329cd978589983bd659db46e1d45aad4
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/issues/8143
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/issues/8144
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/releases/tag/4.10.14
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/releases/tag/5.2.5
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/security/advisories/GHSA-2m6g-crv8-p3c6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-36079
    reference_type:
    reference_id: CVE-2022-36079
