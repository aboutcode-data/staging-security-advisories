advisory_id: GHSA-2rmr-xw8m-22q9
datasource_id: github_osv_importer_v2/GHSA-2rmr-xw8m-22q9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-2rmr-xw8m-22q9/GHSA-2rmr-xw8m-22q9.json
aliases:
  - CVE-2023-46729
summary: |
  Sentry Next.js vulnerable to SSRF via Next.js SDK tunnel endpoint
  ### Impact
  An unsanitized input of Next.js SDK tunnel endpoint allows sending HTTP requests to arbitrary URLs and reflecting the response back to the user. This could open door for other attack vectors:
  * client-side vulnerabilities: XSS/CSRF in the context of the trusted domain;
  * interaction with internal network;
  * read cloud metadata endpoints (AWS, Azure, Google Cloud, etc.);
  * local/remote port scan.

  This issue only affects users who have [Next.js SDK tunneling feature](https://docs.sentry.io/platforms/javascript/guides/nextjs/manual-setup/#configure-tunneling-to-avoid-ad-blockers) enabled.

  ### Patches
  The problem has been fixed in [sentry/nextjs@7.77.0](https://www.npmjs.com/package/@sentry/nextjs/v/7.77.0)

  ### Workarounds
  Disable tunneling by removing the `tunnelRoute` option from Sentry Next.js SDK config â€” `next.config.js` or `next.config.mjs`.

  ### References
  * [Sentry Next.js tunneling feature](https://docs.sentry.io/platforms/javascript/guides/nextjs/manual-setup/#configure-tunneling-to-avoid-ad-blockers)
  * [The fix](https://github.com/getsentry/sentry-javascript/pull/9415)
  * [More Information](https://blog.sentry.io/next-js-sdk-security-advisory-cve-2023-46729/)

  ### Credits
  * [Praveen Kumar](https://hackerone.com/mr_x_strange)
impacted_packages:
  - purl: pkg:npm/%40sentry/nextjs
    affected_versions: vers:npm/>=7.26.0|<7.77.0
    fixed_versions: vers:npm/7.77.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-2rmr-xw8m-22q9/GHSA-2rmr-xw8m-22q9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://blog.sentry.io/next-js-sdk-security-advisory-cve-2023-46729
    reference_type:
    reference_id:
  - url: https://docs.sentry.io/platforms/javascript/guides/nextjs/manual-setup/#configure-tunneling-to-avoid-ad-blockers
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript/commit/ddbda3c02c35aba8c5235e0cf07fc5bf656f81be
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript/pull/9415
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript/security/advisories/GHSA-2rmr-xw8m-22q9
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/@sentry/nextjs/v/7.77.0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-46729
    reference_type:
    reference_id: CVE-2023-46729
