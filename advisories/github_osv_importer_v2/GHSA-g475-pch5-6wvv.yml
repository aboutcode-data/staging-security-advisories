advisory_id: GHSA-g475-pch5-6wvv
datasource_id: github_osv_importer_v2/GHSA-g475-pch5-6wvv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-g475-pch5-6wvv/GHSA-g475-pch5-6wvv.json
aliases:
  - CVE-2020-5777
summary: |
  Authentication bypass in MAGMI
  MAGMI versions prior to 0.7.24 are vulnerable to a remote authentication bypass due to allowing default credentials in the event there is a database connection failure. A remote attacker can trigger this connection failure if the Mysql setting max_connections (default 151) is lower than Apache (or another web server) setting MaxRequestWorkers (formerly MaxClients) (default 256). This can be done by sending at least 151 simultaneous requests to the Magento website to trigger a "Too many connections" error, then use default magmi:magmi basic authentication to remotely bypass authentication.
impacted_packages:
  - purl: pkg:composer/dweeves/magmi
    affected_versions: vers:composer/<0.7.24
    fixed_versions: vers:composer/0.7.24
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-g475-pch5-6wvv/GHSA-g475-pch5-6wvv.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/dweeves/magmi-git/commit/dde71de5cfd505fe78e5caf21d6531b61450a16f
    reference_type:
    reference_id:
  - url: https://www.tenable.com/security/research/tra-2020-51
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5777
    reference_type:
    reference_id: CVE-2020-5777
