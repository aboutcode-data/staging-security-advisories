advisory_id: GHSA-5hhx-v7f6-x7gv
datasource_id: github_osv_importer_v2/GHSA-5hhx-v7f6-x7gv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-5hhx-v7f6-x7gv/GHSA-5hhx-v7f6-x7gv.json
aliases:
  - CVE-2025-65099
summary: |
  Claude Code vulnerable to command execution prior to startup trust dialog
  When using Claude Code with Yarn installed, Yarn config files can trigger code execution when running yarn --version. This could lead to a bypass of the directory trust dialog in Claude Code, as plugins and yarnPath could be executed prior to the user accepting the risks of working in an untrusted directory. Users on standard Claude Code auto-update will have received this fix automatically. Users performing manual updates are advised to update to the latest version.

  Thank you to Benjamin Faller, Redguard AG and Michael Hess for reporting this issue!
impacted_packages:
  - purl: pkg:npm/%40anthropic-ai/claude-code
    affected_versions: vers:npm/<1.0.39
    fixed_versions: vers:npm/1.0.39
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-5hhx-v7f6-x7gv/GHSA-5hhx-v7f6-x7gv.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/anthropics/claude-code
    reference_type:
    reference_id:
  - url: https://github.com/anthropics/claude-code/security/advisories/GHSA-5hhx-v7f6-x7gv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-65099
    reference_type:
    reference_id:
