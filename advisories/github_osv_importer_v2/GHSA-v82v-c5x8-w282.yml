advisory_id: GHSA-v82v-c5x8-w282
datasource_id: github_osv_importer_v2/GHSA-v82v-c5x8-w282
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-v82v-c5x8-w282/GHSA-v82v-c5x8-w282.json
aliases:
  - CVE-2026-25516
summary: |
  NiceGUI's XSS vulnerability in ui.markdown() allows arbitrary JavaScript execution through unsanitized HTML content
  ## Description

  The `ui.markdown()` component uses the `markdown2` library to convert markdown content to HTML, which is then rendered via `innerHTML`. By default, `markdown2` allows raw HTML to pass through unchanged. This means that if an application renders user-controlled content through `ui.markdown()`, an attacker can inject malicious HTML containing JavaScript event handlers.

  Unlike other NiceGUI components that render HTML (`ui.html()`, `ui.chat_message()`, `ui.interactive_image()`), the `ui.markdown()` component does not provide or require a `sanitize` parameter, leaving applications vulnerable to XSS attacks.

  ## Proof of Concept

  ```python
  from nicegui import ui

  # User-controlled input containing malicious payload
  user_input = 'Hello! <img src=x onerror="alert(\'XSS\')">'

  ui.markdown(user_input)  # XSS executes when page loads

  ui.run()
  ```

  When this page loads, the JavaScript in the `onerror` handler executes, potentially allowing an attacker to:
  - Steal session cookies or authentication tokens
  - Perform actions on behalf of the user
  - Redirect users to malicious sites
  - Modify page content

  ## Impact

  Applications that render user-provided content through `ui.markdown()` are vulnerable to stored or reflected XSS attacks. This is particularly concerning for:
  - Chat applications displaying user messages
  - CMS or documentation systems with user-editable content
  - Any application that displays markdown from untrusted sources

  ## Remediation

  A release has been published in version 3.7.0.

  ### For Users (Immediate Workaround)

  Until a fix is released, **do not pass untrusted content directly to `ui.markdown()`**. Instead, use one of these approaches:

  **Option 1: Convert and sanitize manually using `ui.html()`**

  ```python
  import markdown2
  from html_sanitizer import Sanitizer

  sanitizer = Sanitizer()

  def safe_markdown(content: str) -> None:
      """Render markdown with HTML sanitization."""
      html = markdown2.markdown(content)
      ui.html(sanitizer.sanitize(html), sanitize=False)

  # Usage
  safe_markdown(user_input)
  ```

  **Option 2: Escape HTML before markdown conversion (if raw HTML not needed)**

  ```python
  import html

  # Escape HTML entities - prevents any HTML from being interpreted
  ui.markdown(html.escape(user_input))
  ```

  ### Proposed Fix

  Add a `sanitize` parameter to `ui.markdown()` consistent with other HTML-rendering components, and/or add an `escape_html` parameter.
impacted_packages:
  - purl: pkg:pypi/nicegui
    affected_versions: vers:pypi/<=3.6.1
    fixed_versions: vers:pypi/3.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-v82v-c5x8-w282/GHSA-v82v-c5x8-w282.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/zauberzeug/nicegui
    reference_type:
    reference_id:
  - url: https://github.com/zauberzeug/nicegui/commit/f1f7533577875af7d23f161ed3627f73584cb561
    reference_type:
    reference_id:
  - url: https://github.com/zauberzeug/nicegui/security/advisories/GHSA-v82v-c5x8-w282
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25516
    reference_type:
    reference_id:
