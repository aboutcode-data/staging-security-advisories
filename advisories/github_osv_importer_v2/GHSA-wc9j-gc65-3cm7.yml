advisory_id: GHSA-wc9j-gc65-3cm7
datasource_id: github_osv_importer_v2/GHSA-wc9j-gc65-3cm7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-wc9j-gc65-3cm7/GHSA-wc9j-gc65-3cm7.json
aliases:
  - CVE-2023-41034
summary: "DDFFileParser is vulnerable to XXE Attacks\n### Impact\n`DDFFileParser` and `DefaultDDFFileValidator`\
  \ (and so `ObjectLoader`) are vulnerable to [XXE Attacks](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing).\n\
  \n[DDF file](https://github.com/eclipse-leshan/leshan/wiki/Adding-new-objects#the-lwm2m-model)\
  \ is a LWM2M format used to store LWM2M object description.   \nLeshan users are impacted\
  \ only if they parse untrusted DDF files (e.g. if they let external users provide their own\
  \ model), in that case they MUST upgrade to fixed version.\nIf you parse only trusted DDF\
  \ file and validate only with trusted xml schema, upgrading is not mandatory. \n\n### Patches\n\
  This is fixed in **v1.5.0** and **2.0.0-M13**.\n\n### Workarounds\nNo easy way. Eventually\
  \ writing your own `DDFFileParser`/`DefaultDDFFileValidator` (and so `ObjectLoader`) creating\
  \ a `DocumentBuilderFactory` with : \n```java\n// For DDFFileParser\nDocumentBuilderFactory\
  \ factory = DocumentBuilderFactory.newInstance();\nfactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING,\
  \ true);\nfactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\
  \ // Disable DTDs\nfactory.setXIncludeAware(false); // Disable XML Inclusions\nfactory.setExpandEntityReferences(false);\
  \ // disable expand entity reference nodes\n\n// For DefaultDDFFileValidator\nSchemaFactory\
  \ factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\nfactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING,\
  \ true);\nfactory.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\nfactory.setProperty(XMLConstants.ACCESS_EXTERNAL_SCHEMA,\
  \ \"\");\n``` \n\n### References\n- https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing\n\
  - https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html\n\
  - https://semgrep.dev/docs/cheat-sheets/java-xxe/\n- https://community.veracode.com/s/article/Java-Remediation-Guidance-for-XXE"
impacted_packages:
  - purl: pkg:maven/org.eclipse.leshan/leshan-core
    affected_versions: vers:maven/<1.5.0
    fixed_versions: vers:maven/1.5.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.leshan/leshan-core
    affected_versions: vers:maven/>=2.0.0-M1|<2.0.0-M13
    fixed_versions: vers:maven/2.0.0-M13
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-wc9j-gc65-3cm7/GHSA-wc9j-gc65-3cm7.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://github.com/eclipse-leshan/leshan
    reference_type:
    reference_id:
  - url: https://github.com/eclipse-leshan/leshan/commit/29577d2879ba8e7674c3b216a7f01193fc7ae013
    reference_type:
    reference_id:
  - url: https://github.com/eclipse-leshan/leshan/commit/4d3e63ac271a817f81fba3e3229c519af7a3049c
    reference_type:
    reference_id:
  - url: https://github.com/eclipse-leshan/leshan/security/advisories/GHSA-wc9j-gc65-3cm7
    reference_type:
    reference_id:
  - url: https://github.com/eclipse-leshan/leshan/wiki/Adding-new-objects#the-lwm2m-model
    reference_type:
    reference_id:
  - url: https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41034
    reference_type:
    reference_id: CVE-2023-41034
