advisory_id: GHSA-fr2w-mp56-g4xp
datasource_id: github_osv_importer_v2/GHSA-fr2w-mp56-g4xp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-fr2w-mp56-g4xp/GHSA-fr2w-mp56-g4xp.json
aliases:
  - CVE-2022-2111
summary: |
  Unrestricted Attachment Upload
  ### Impact

  InvenTree allows unrestricted upload of files as attachments to various database fields. Potentially dangerous files (such as HTML files containing malicious javascript) can be uploaded, and (when opened by the user) run the malicious code directly in the users browser.

  ![image](https://user-images.githubusercontent.com/10080325/173549827-af2d7a5c-1359-4d68-a920-dfdd0ccc882e.png)

  *Note that the upload of malicious files must be performed by an authenticated user account*

  ### Solution

  The solution for this vulnerability is to ensure that attachment files are downloaded to the local machine before opening, rather than opening the file in the current browser context.

  ### Patches

  - The issue is addressed in the upcoming 0.8.0 release
  - This fix will also be back-ported to the 0.7.x branch, applied to the 0.7.2 release

  ### Workarounds

  Users can alleviate risk of opening malicious files by right-clicking on the attachment link and selecting "Save link as"

  ![image](https://user-images.githubusercontent.com/10080325/173550035-2de4bf01-f0d3-4be8-ac45-6fbcf66a95e7.png)

  This minimizes risk (e.g. of XSS attacks) by opening the HTML file from the users computer

  ### References

  https://huntr.dev/bounties/a0e5c68e-0f75-499b-bd7b-d935fb8c0cd1/

  ### For more information
  If you have any questions or comments about this advisory:

  * Open an issue in [github](http://github.com/inventree/inventree)
  * Email us at [security@inventree.org](mailto:security@inventree.org)
impacted_packages:
  - purl: pkg:pypi/inventree
    affected_versions: vers:pypi/<0.7.2
    fixed_versions: vers:pypi/0.7.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-fr2w-mp56-g4xp/GHSA-fr2w-mp56-g4xp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://github.com/inventree/inventree/commit/26bf51c20a1c9b3130ac5dd2e17649bece5ff84f
    reference_type:
    reference_id:
  - url: https://github.com/inventree/inventree-python
    reference_type:
    reference_id:
  - url: https://github.com/inventree/InvenTree/security/advisories/GHSA-fr2w-mp56-g4xp
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/a0e5c68e-0f75-499b-bd7b-d935fb8c0cd1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-2111
    reference_type:
    reference_id: CVE-2022-2111
