advisory_id: GHSA-cjw8-79x6-5cj4
datasource_id: github_osv_importer_v2/GHSA-cjw8-79x6-5cj4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-cjw8-79x6-5cj4/GHSA-cjw8-79x6-5cj4.json
aliases:
  - CVE-2026-24040
summary: |
  jsPDF has Shared State Race Condition in addJS Plugin
  ### Impact

  The addJS method in the jspdf Node.js build utilizes a shared module-scoped variable (text) to store JavaScript content. When used in a concurrent environment (e.g., a Node.js web server), this variable is shared across all requests.

  If multiple requests generate PDFs simultaneously, the JavaScript content intended for one user may be overwritten by a subsequent request before the document is generated. This results in Cross-User Data Leakage, where the PDF generated for User A contains the JavaScript payload (and any embedded sensitive data) intended for User B.

  Typically, this only affects server-side environments, although the same race conditions might occur if jsPDF runs client-side.

  ```js
  import { jsPDF } from "jspdf";

  const docA = new jsPDF();
  const docB = new jsPDF();

  // 1. User A sets their script (stored in shared 'text' variable)
  docA.addJS('console.log("Secret A");');

  // 2. User B sets their script (overwrites shared 'text' variable)
  docB.addJS('console.log("Secret B");');

  // 3. User A saves their PDF (reads current 'text' variable)
  docA.save("userA.pdf");

  // Result: userA.pdf contains "Secret B" instead of "Secret A"
  ```

  ### Patches
  The vulnerability has been fixed in jspdf@4.0.1. The fix moves the shared variable into the function scope, ensuring isolation between instances.

  ### Workarounds
  Avoid using the addJS method in concurrent server-side environments. If usage is required, ensure requests are processed sequentially (e.g., using a queue) rather than in parallel.
impacted_packages:
  - purl: pkg:npm/jspdf
    affected_versions: vers:npm/<=4.0.0
    fixed_versions: vers:npm/4.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-cjw8-79x6-5cj4/GHSA-cjw8-79x6-5cj4.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-362
references:
  - url: https://github.com/parallax/jsPDF
    reference_type:
    reference_id:
  - url: https://github.com/parallax/jsPDF/commit/2863e5c26afef211a545e8c174ab4d5fce3b8c0e
    reference_type:
    reference_id:
  - url: https://github.com/parallax/jsPDF/releases/tag/v4.1.0
    reference_type:
    reference_id:
  - url: https://github.com/parallax/jsPDF/security/advisories/GHSA-cjw8-79x6-5cj4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-24040
    reference_type:
    reference_id:
