advisory_id: GHSA-7fqr-97j7-jgf4
datasource_id: github_osv_importer_v2/GHSA-7fqr-97j7-jgf4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-7fqr-97j7-jgf4/GHSA-7fqr-97j7-jgf4.json
aliases:
  - CVE-2023-48241
summary: |
  Whole content of all documents of all wikis exposed to anybody with view right on Solr suggest service
  ### Impact
  The Solr-based search suggestion provider that also duplicates as generic JavaScript API for search results in XWiki exposes the content of all documents of all wikis to anybody who has access to it, by default it is public. This exposes all information stored in the wiki (but not some protected information like password hashes). While there is a right check normally, the right check can be circumvented by explicitly requesting fields from Solr that don't include the data for the right check. This can be reproduced by opening `<xwiki-server>/xwiki/bin/get/XWiki/SuggestSolrService?outputSyntax=plain&media=json&nb=1000&query=q%3D*%3A*%0Aq.op%3DAND%0Afq%3Dtype%3ADOCUMENT%0Afl%3Dtitle_%2C+reference%2C+links%2C+doccontentraw_%2C+objcontent__&input=+` where `<xwiki-server>` is the URL of the XWiki installation. If this displays any results, the wiki is vulnerable.

  ### Patches
  This has been fixed in XWiki 15.6RC1, 15.5.1 and 14.10.15 by not listing documents whose rights cannot be checked.

  ### Workarounds
  We're not aware of a workaround apart from upgrading to a fixed version.

  ### References
  * https://jira.xwiki.org/browse/XWIKI-21138
  * https://github.com/xwiki/xwiki-platform/commit/93b8ec702d7075f0f5794bb05dfb651382596764
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-search-solr-query
    affected_versions: vers:maven/>=6.3-milestone-2|<14.10.15
    fixed_versions: vers:maven/14.10.15
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-search-solr-query
    affected_versions: vers:maven/>=15.0-rc-1|<15.5.1
    fixed_versions: vers:maven/15.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-7fqr-97j7-jgf4/GHSA-7fqr-97j7-jgf4.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/93b8ec702d7075f0f5794bb05dfb651382596764
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-7fqr-97j7-jgf4
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-21138
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-48241
    reference_type:
    reference_id: CVE-2023-48241
