advisory_id: GHSA-8r99-h8j2-rw64
datasource_id: github_osv_importer_v2/GHSA-8r99-h8j2-rw64
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-8r99-h8j2-rw64/GHSA-8r99-h8j2-rw64.json
aliases: []
summary: |
  Twisted vulnerable to HTTP Request Smuggling Attacks
  ### Impact
  Twisted Web is vulnerable to request smuggling attacks:

  1. "When presented with two content-length headers, Twisted Web ignored the first header. When the second content-length was set to zero this caused Twisted Web to interpret the request body as a pipelined request. According to RFC 7230 Section 3.3.3#4, if a message is received with multiple content-length headers with differing value, then the server must reject the message with a 400 response." (Jake Miller of Bishop Fox Security)
  2. " When presented with a content-length and a chunked encoding header, the content-length took precedence and the remainder of the request body was interpreted by Twisted Web as a pipelined request. According to RFC 7230 Section 3.3.3#3, if a message with both content-length and chunked encoding is accepted, transfer-encoding overrides the content-length." (Jake Miller of Bishop Fox Security)
  3. ~"Twisted should not allow BWS between the filed-name and colon." (ZeddYu Lu)~ _closed in 9646_
  4. "Two CL header with different values is also not allowed." (ZeddYu Lu)
  5. "Only accept identity and chunked Transport-Encoding." (ZeddYu Lu)

  ### Patches
  https://github.com/twisted/twisted/commit/20c787a14a09e7cbd5dfd8df08ceff00d1fcc081
  https://github.com/twisted/twisted/commit/4a7d22e490bb8ff836892cc99a1f54b85ccb0281

  ### Workarounds
  N/A

  ### References
  https://portswigger.net/web-security/request-smuggling
impacted_packages:
  - purl: pkg:pypi/twisted
    affected_versions: vers:pypi/<20.3.0
    fixed_versions: vers:pypi/20.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/twisted/twisted
    reference_type:
    reference_id:
  - url: https://github.com/twisted/twisted/commit/20c787a14a09e7cbd5dfd8df08ceff00d1fcc081
    reference_type:
    reference_id:
  - url: https://github.com/twisted/twisted/commit/4a7d22e490bb8ff836892cc99a1f54b85ccb0281
    reference_type:
    reference_id:
  - url: https://github.com/twisted/twisted/security/advisories/GHSA-8r99-h8j2-rw64
    reference_type:
    reference_id:
