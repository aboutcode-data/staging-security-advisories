advisory_id: GHSA-4vr9-8cjf-vf9c
datasource_id: github_osv_importer_v2/GHSA-4vr9-8cjf-vf9c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-4vr9-8cjf-vf9c/GHSA-4vr9-8cjf-vf9c.json
aliases:
  - CVE-2020-26281
summary: |
  Async-h1 request smuggling possible with long unread bodies
  ### Impact
  This vulnerability affects any webserver that uses async-h1 behind a reverse proxy, including all such Tide applications.

  If the server does not read the body of a request which is longer than some buffer length, async-h1 will attempt to read a subsequent request from the body content starting at that offset into the body.

  One way to exploit this vulnerability would be for an adversary to craft a request such that the body contains a request that would not be noticed by a reverse proxy, allowing it to forge forwarded/x-forwarded headers. If an application trusted the authenticity of these headers, it could be misled by the smuggled request.

  Another potential concern with this vulnerability is that if a reverse proxy is sending multiple http clients' requests along the same keep-alive connection, it would be possible for the smuggled request to specify a long content and capture another user's request in its body. This content could be captured in a post request to an endpoint that allows the content to be subsequently retrieved by the adversary.


  ### Patches
  This has been addressed in async-h1 2.3.0 and previous versions have been yanked.

  ### Workarounds
  none

  ### References
  https://github.com/http-rs/async-h1/releases/tag/v2.3.0

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [async-h1](https://github.com/http-rs/async-h1)
  * Contact a core team member on [zulip](https://http-rs.zulip-chat.com) or [discord](https://discord.gg/x2gKzst)
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-4vr9-8cjf-vf9c/GHSA-4vr9-8cjf-vf9c.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-444
references:
  - url: https://github.com/http-rs/async-h1
    reference_type:
    reference_id:
  - url: https://github.com/http-rs/async-h1/releases/tag/v2.3.0
    reference_type:
    reference_id:
  - url: https://github.com/http-rs/async-h1/security/advisories/GHSA-4vr9-8cjf-vf9c
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2020-0093.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-26281
    reference_type:
    reference_id: CVE-2020-26281
