advisory_id: GHSA-39xg-8p43-h76x
datasource_id: github_osv_importer_v2/GHSA-39xg-8p43-h76x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-39xg-8p43-h76x/GHSA-39xg-8p43-h76x.json
aliases:
  - CVE-2020-36203
summary: |
  Data races in reffers
  ARefss<'a, V> is a type that is assumed to contain objects that are Send + Sync.

  In the affected versions of this crate, Send/Sync traits are unconditionally implemented for ARefss<'a, V>.

  By using the ARefss::map() API, we can insert a !Send or !Sync object into ARefss<'a, V>. After that, it is possible to create a data race to the inner object of ARefss<'a, V>, which can lead to undefined behavior & memory corruption.

  The flaw was corrected in commit `6dd7ca0` by adding trait bound V: Send + Sync to ARefss::map() API.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-39xg-8p43-h76x/GHSA-39xg-8p43-h76x.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-787
  - CWE-362
references:
  - url: https://github.com/diwic/reffers-rs
    reference_type:
    reference_id:
  - url: https://github.com/diwic/reffers-rs/commit/6dd7ca0d50f2464df708975cdafcfaeeb6d41c66
    reference_type:
    reference_id:
  - url: https://github.com/diwic/reffers-rs/issues/7
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2020-0094.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-36203
    reference_type:
    reference_id: CVE-2020-36203
