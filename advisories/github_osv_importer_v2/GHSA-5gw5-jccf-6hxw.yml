advisory_id: GHSA-5gw5-jccf-6hxw
datasource_id: github_osv_importer_v2/GHSA-5gw5-jccf-6hxw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-5gw5-jccf-6hxw/GHSA-5gw5-jccf-6hxw.json
aliases:
  - CVE-2024-29198
summary: |
  GeoServer Vulnerable to Unauthenticated SSRF via TestWfsPost
  ### Summary

  It possible to achieve Service Side Request Forgery (SSRF) via the Demo request endpoint if Proxy Base URL has not been set.

  ### Details

  A unauthenticated user can supply a request that will be issued by the server. This can be used to enumerate internal networks and also in the case of cloud instances can be used to obtain sensitive data.

  ### Mitigation

  1. When using GeoServer with a proxy, manage the proxy base value as a system administrator, use the application property ``PROXY_BASE_URL`` to provide a non-empty value that cannot be overridden by the user interface or incoming request.

  2. When using GeoServer directly without a proxy, block all access to TestWfsPost by editing the web.xml file. Adding this block right before the end:

     ```xml
        <security-constraint>
             <web-resource-collection>
                 <web-resource-name>BlockDemoRequests</web-resource-name>
                 <url-pattern>/TestWfsPost/*</url-pattern>
             </web-resource-collection>
             <auth-constraint>
                 <role-name>BLOCKED</role-name>
             </auth-constraint>
         </security-constraint>
     ```

  ### Resolution

  Upgrading to GeoServer 2.24.4, or 2.25.2, removes the ``TestWfsPost`` servlet resolving this issue.

  The demo request page functionality is now implemented directly in the browser.

  ### Reference

  - https://osgeo-org.atlassian.net/browse/GEOS-11794
  - https://osgeo-org.atlassian.net/browse/GEOS-11390
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40822
impacted_packages:
  - purl: pkg:maven/org.geoserver/gs-wfs
    affected_versions: vers:maven/>=2.0.0|<2.24.4
    fixed_versions: vers:maven/2.24.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.geoserver.web/gs-app
    affected_versions: vers:maven/>=2.0.0|<2.24.4
    fixed_versions: vers:maven/2.24.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.geoserver/gs-wfs
    affected_versions: vers:maven/>=2.25.0|<2.25.2
    fixed_versions: vers:maven/2.25.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.geoserver.web/gs-app
    affected_versions: vers:maven/>=2.25.0|<2.25.2
    fixed_versions: vers:maven/2.25.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-5gw5-jccf-6hxw/GHSA-5gw5-jccf-6hxw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/geoserver/geoserver
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/security/advisories/GHSA-5gw5-jccf-6hxw
    reference_type:
    reference_id:
  - url: https://osgeo-org.atlassian.net/browse/GEOS-11390
    reference_type:
    reference_id:
  - url: https://osgeo-org.atlassian.net/browse/GEOS-11794
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-40822
    reference_type:
    reference_id: CVE-2021-40822
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-29198
    reference_type:
    reference_id: CVE-2024-29198
