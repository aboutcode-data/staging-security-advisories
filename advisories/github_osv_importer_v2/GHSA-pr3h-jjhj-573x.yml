advisory_id: GHSA-pr3h-jjhj-573x
datasource_id: github_osv_importer_v2/GHSA-pr3h-jjhj-573x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/06/GHSA-pr3h-jjhj-573x/GHSA-pr3h-jjhj-573x.json
aliases:
  - CVE-2018-3760
summary: "Sprockets path traversal leads to information leak\nSpecially crafted requests can\
  \ be used to access files that exist on the filesystem that is outside an application's root\
  \ directory, when the Sprockets server is used in production.\n  \nAll users running an affected\
  \ release should either upgrade or use one of the work arounds immediately.\n  \n### Workaround:\n\
  \  \nIn Rails applications, work around this issue, set `config.assets.compile = false` and\
  \ `config.public_file_server.enabled = true` in an initializer and precompile the assets.\n\
  \nThis work around will not be possible in all hosting environments and upgrading is advised."
impacted_packages:
  - purl: pkg:gem/sprockets
    affected_versions: vers:gem/>=3.0.0|<3.7.2
    fixed_versions: vers:gem/3.7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/sprockets
    affected_versions: vers:gem/<=4.0.0.beta7
    fixed_versions: vers:gem/4.0.0.beta8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/sprockets
    affected_versions: vers:gem/<2.12.5
    fixed_versions: vers:gem/2.12.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/06/GHSA-pr3h-jjhj-573x/GHSA-pr3h-jjhj-573x.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-22
references:
  - url: https://access.redhat.com/errata/RHSA-2018:2244
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:2245
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:2561
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:2745
    reference_type:
    reference_id:
  - url: https://github.com/rails/sprockets
    reference_type:
    reference_id:
  - url: https://github.com/rails/sprockets/commit/18b8a7f07a50c245e9aee7854ecdbe606bbd8bb5
    reference_type:
    reference_id:
  - url: https://github.com/rails/sprockets/commit/9c34fa05900b968d74f08ccf40917848a7be9441
    reference_type:
    reference_id:
  - url: https://github.com/rails/sprockets/commit/c09131cf5b2c479263939c8582e22b98ed616c5f
    reference_type:
    reference_id:
  - url: https://groups.google.com/d/msg/rubyonrails-security/ft_J--l55fM/7roDfQ50BwAJ
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2018/dsa-4242
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-3760
    reference_type:
    reference_id: CVE-2018-3760
