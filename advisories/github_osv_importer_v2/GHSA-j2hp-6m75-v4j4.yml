advisory_id: GHSA-j2hp-6m75-v4j4
datasource_id: github_osv_importer_v2/GHSA-j2hp-6m75-v4j4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-j2hp-6m75-v4j4/GHSA-j2hp-6m75-v4j4.json
aliases:
  - CVE-2025-24354
summary: "imgproxy is vulnerable to SSRF against 0.0.0.0\n### Summary\n\nImgproxy does not block\
  \ the `0.0.0.0` address, even with `IMGPROXY_ALLOW_LOOPBACK_SOURCE_ADDRESSES` set to false.\
  \ This can expose services on the local host.\n\n### Details\n\nimgproxy protects against\
  \ SSRF against a loopback address with the following check ([source](https://github.com/imgproxy/imgproxy/blob/0f37d62fd8326a32c213b30dd52e2319770885d8/security/source.go#L43C1-L47C1)):\n\
  \n```\nif !config.AllowLoopbackSourceAddresses && ip.IsLoopback() {\n\treturn ErrSourceAddressNotAllowed\n\
  }\n```\n\nThis check is insufficient to prevent accessing services on the local host, as services\
  \ may receive traffic on `0.0.0.0`. Go's `IsLoopback` ([source](https://github.com/golang/go/blob/40b3c0e58a0ae8dec4684a009bf3806769e0fc41/src/net/ip.go#L126-L131))\
  \ strictly follows the definition of loopback IPs beginning with `127`. `0.0.0.0` is not blocked."
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-j2hp-6m75-v4j4/GHSA-j2hp-6m75-v4j4.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/imgproxy/imgproxy
    reference_type:
    reference_id:
  - url: https://github.com/imgproxy/imgproxy/commit/3d4fed6842aa8930ec224d0ad75b0079b858e081
    reference_type:
    reference_id:
  - url: https://github.com/imgproxy/imgproxy/security/advisories/GHSA-j2hp-6m75-v4j4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-24354
    reference_type:
    reference_id: CVE-2025-24354
