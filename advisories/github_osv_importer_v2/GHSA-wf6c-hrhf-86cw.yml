advisory_id: GHSA-wf6c-hrhf-86cw
datasource_id: github_osv_importer_v2/GHSA-wf6c-hrhf-86cw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-wf6c-hrhf-86cw/GHSA-wf6c-hrhf-86cw.json
aliases:
  - CVE-2025-27506
summary: "NocoDB Vulnerable to Reflected Cross-Site Scripting on Reset Password Page\n### Summary\n\
  \nThe API endpoint related to the password reset function is vulnerable to Reflected Cross-Site-Scripting.\
  \ \n\n### Details\n\nThroughout the source-code analysis, it has been found that the endpoint\
  \ /api/v1/db/auth/password/reset/:tokenId is vulnerable to Reflected Cross-Site-Scripting.\n\
  \ \nThe flaw occurs due to implementation of the client-side template engine ejs, specifically\
  \ on file resetPassword.ts where the template is using the insecure function “<%-“ \nhttps://github.com/nocodb/nocodb/blob/ba5a191b33259d984fc92df225f7d82ede2ddb56/packages/nocodb/src/modules/auth/ui/auth/resetPassword.ts#L71\
  \  \nwhich is rendered by the function renderPasswordReset: \nhttps://github.com/nocodb/nocodb/blob/ba5a191b33259d984fc92df225f7d82ede2ddb56/packages/nocodb/src/modules/auth/auth.controller.ts#L251\n\
  \n### PoC\n\nSend the request below to a vulnerable instance: \n`/api/v1/db/auth/password/reset/asdsad%3C%2F%73%63%72%69%70%74%3E%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E/`\n\
  \n![image](https://github.com/user-attachments/assets/28d8e7c6-efb9-49df-b049-56dab229d74f)\n\
  \n### Impact\n\nThe vulnerability affect end-users, allowing an attacker to craft and send\
  \ a malicious link to the victim which leads running script on their browser.\n\n### Credits\n\
  [l34k3d](https://github.com/xL34K3D)\n[ottoboni](https://github.com/gabrielott)"
impacted_packages:
  - purl: pkg:npm/nocodb
    affected_versions: vers:npm/<0.258.0
    fixed_versions: vers:npm/0.258.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-wf6c-hrhf-86cw/GHSA-wf6c-hrhf-86cw.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/nocodb/nocodb
    reference_type:
    reference_id:
  - url: https://github.com/nocodb/nocodb/blob/ba5a191b33259d984fc92df225f7d82ede2ddb56/packages/nocodb/src/modules/auth/auth.controller.ts#L251
    reference_type:
    reference_id:
  - url: https://github.com/nocodb/nocodb/blob/ba5a191b33259d984fc92df225f7d82ede2ddb56/packages/nocodb/src/modules/auth/ui/auth/resetPassword.ts#L71
    reference_type:
    reference_id:
  - url: https://github.com/nocodb/nocodb/commit/ea821edb133e621e26183ae65c8ff9ee5d6f2723
    reference_type:
    reference_id:
  - url: https://github.com/nocodb/nocodb/security/advisories/GHSA-wf6c-hrhf-86cw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-27506
    reference_type:
    reference_id: CVE-2025-27506
