advisory_id: GHSA-5wvv-q5fv-2388
datasource_id: github_osv_importer_v2/GHSA-5wvv-q5fv-2388
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-5wvv-q5fv-2388/GHSA-5wvv-q5fv-2388.json
aliases: []
summary: |
  hyper-staticfile's location header incorporates user input, allowing open redirect
  When `hyper-staticfile` performs a redirect for a directory request (e.g. a request for `/dir` that redirects to `/dir/`), the `Location` header value was derived from user input (the request path), simply appending a slash. The intent was to perform an origin-relative redirect, but specific inputs allowed performing a scheme-relative redirect instead.

  An attacker could craft a special URL that would appear to be for the correct domain, but immediately redirects to a malicious domain. Such a URL can benefit phishing attacks, for example an innocent looking link in an email.
impacted_packages: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/stephank/hyper-staticfile
    reference_type:
    reference_id:
  - url: https://github.com/stephank/hyper-staticfile/commit/4db4afb811c553bc3d54a01a9985b9e6dfc5a115
    reference_type:
    reference_id:
  - url: https://github.com/stephank/hyper-staticfile/commit/f12cadc6666c6f555d29725f5bc45da2103f24ea
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2022-0072.html
    reference_type:
    reference_id:
