advisory_id: GHSA-9x5g-62gj-wqf2
datasource_id: github_osv_importer_v2/GHSA-9x5g-62gj-wqf2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-9x5g-62gj-wqf2/GHSA-9x5g-62gj-wqf2.json
aliases:
  - CVE-2025-64746
summary: "Directus has Improper Permission Handling on Deleted Fields\n### Summary\nDirectus\
  \ does not properly clean up field-level permissions when a field is deleted. If a new field\
  \ with the same name is created later, the system automatically re-applies the old permissions,\
  \ which can lead to unauthorized access.\n\n### Details\nWhen a field is removed from a collection,\
  \ its reference in the permissions table remains intact. This stale reference creates a security\
  \ gap: if another field is later created using the same name, it inherits the outdated permission\
  \ entry.  \nThis behavior can unintentionally grant roles access to data they should not be\
  \ able to read or modify.\n\nThe issue is particularly risky in multi-tenant or production\
  \ environments, where administrators may reuse field names, assuming old permissions have\
  \ been fully cleared.\n\n\t1.\tCreate a collection named test_collection.\n\t2.\tAdd a field\
  \ called secret_field.\n\t3.\tAssign a role with read permissions specifically tied to secret_field.\n\
  \t4.\tRemove the secret_field from the collection.\n\t5.\tCreate a new field with the exact\
  \ same name secret_field.\n\t6.\tNotice that the previously assigned permissions are still\
  \ active, granting access to the newly created field without reconfiguration.\n\n### Impact\n\
  \nWhen creating new fields with the same name as previously deleted fields it may inherit\
  \ the permissions of that previously deleted field. This can potentially result in accidentally\
  \ giving access to this new field in existing policies."
impacted_packages:
  - purl: pkg:npm/directus
    affected_versions: vers:npm/<11.13.0
    fixed_versions: vers:npm/11.13.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-9x5g-62gj-wqf2/GHSA-9x5g-62gj-wqf2.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
  - CWE-284
references:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/commit/84d7636969083387164ce5d2fd15a65e11e2d0b8
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-9x5g-62gj-wqf2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64746
    reference_type:
    reference_id:
