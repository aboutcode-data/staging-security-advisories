advisory_id: GHSA-6mjq-h674-j845
datasource_id: github_osv_importer_v2/GHSA-6mjq-h674-j845
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-6mjq-h674-j845/GHSA-6mjq-h674-j845.json
aliases:
  - CVE-2023-34462
summary: "netty-handler SniHandler 16MB allocation\n### Summary\nThe `SniHandler` can allocate\
  \ up to 16MB of heap for each channel during the TLS handshake. When the handler or the channel\
  \ does not have an idle timeout, it can be used to make a TCP server using the `SniHandler`\
  \ to allocate 16MB of heap.\n\n### Details\nThe `SniHandler` class is a handler that waits\
  \ for the TLS handshake to configure a `SslHandler` according to the indicated server name\
  \ by the `ClientHello` record. For this matter it allocates a `ByteBuf` using the value defined\
  \ in the `ClientHello` record. \n\nNormally the value of the packet should be smaller than\
  \ the handshake packet but there are not checks done here and the way the code is written,\
  \ it is possible to craft a packet that makes the `SslClientHelloHandler`\n\n1/ allocate a\
  \ 16MB `ByteBuf`\n2/ not fail `decode` method `in` buffer\n3/ get out of the loop without\
  \ an exception\n\nThe combination of this without the use of a timeout makes  easy to connect\
  \ to a TCP server and allocate 16MB of heap memory per connection.\n\n### Impact\nIf the user\
  \ has no idle timeout handler configured it might be possible for a remote peer to send a\
  \ client hello packet which lead the server to buffer up to 16MB of data per connection. This\
  \ could lead to a OutOfMemoryError and so result in a DDOS."
impacted_packages:
  - purl: pkg:maven/io.netty/netty-handler
    affected_versions: vers:maven/<4.1.94.Final
    fixed_versions: vers:maven/4.1.94.Final
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-6mjq-h674-j845/GHSA-6mjq-h674-j845.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
  - CWE-400
references:
  - url: https://github.com/netty/netty
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty/commit/535da17e45201ae4278c0479e6162bb4127d4c32
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty/security/advisories/GHSA-6mjq-h674-j845
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230803-0001
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240621-0007
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2023/dsa-5558
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34462
    reference_type:
    reference_id: CVE-2023-34462
