advisory_id: GHSA-3r8j-pmch-5j2h
datasource_id: github_osv_importer_v2/GHSA-3r8j-pmch-5j2h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/12/GHSA-3r8j-pmch-5j2h/GHSA-3r8j-pmch-5j2h.json
aliases:
  - CVE-2019-16768
summary: "Internal exception message exposure for login action in Sylius\n## Internal exception\
  \ message exposure for login action\n\n### Impact\nException messages from internal exceptions\
  \ (like database exception) are wrapped by `\\Symfony\\Component\\Security\\Core\\Exception\\\
  AuthenticationServiceException` and propagated through the system to UI. Therefore, some internal\
  \ system information may leak and be visible to the customer. \n\nA validation message with\
  \ the exception details will be presented to the user when one will try to log into the shop.\
  \ \n\n### Patches\n_Has the problem been patched? What versions should users upgrade to?_\n\
  \n### Workarounds\nThe `src/Sylius/Bundle/UiBundle/Resources/views/Security/_login.html.twig`\
  \ file should be overridden and lines https://github.com/Sylius/Sylius/blob/1.4/src/Sylius/Bundle/UiBundle/Resources/views/Security/_login.html.twig#L13-L17\
  \ should be replaced with\n```twig\n        {% if last_error %}\n            <div class=\"\
  ui left aligned basic segment\">\n                {{ messages.error(last_error.messageKey)\
  \ }}\n            </div>\n        {% endif %}\n``` \n\nThe `messageKey` field should be used\
  \ instead of the `message`."
impacted_packages:
  - purl: pkg:composer/sylius/sylius
    affected_versions: vers:composer/<1.3.14
    fixed_versions: vers:composer/1.3.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/sylius
    affected_versions: vers:composer/>=1.4.0|<1.4.10
    fixed_versions: vers:composer/1.4.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/sylius
    affected_versions: vers:composer/>=1.5.0|<1.5.7
    fixed_versions: vers:composer/1.5.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/sylius
    affected_versions: vers:composer/>=1.6.0|<1.6.3
    fixed_versions: vers:composer/1.6.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/12/GHSA-3r8j-pmch-5j2h/GHSA-3r8j-pmch-5j2h.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-209
references:
  - url: https://github.com/advisories/GHSA-3r8j-pmch-5j2h
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/Sylius/commit/be245302dfc594d8690fe50dd47631d186aa945f
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/Sylius/security/advisories/GHSA-3r8j-pmch-5j2h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-16768
    reference_type:
    reference_id: CVE-2019-16768
