advisory_id: GHSA-v6x6-4v4x-2fx9
datasource_id: github_osv_importer_v2/GHSA-v6x6-4v4x-2fx9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-v6x6-4v4x-2fx9/GHSA-v6x6-4v4x-2fx9.json
aliases:
  - CVE-2024-6862
summary: |
  Withdrawn Advisory: Lunary Cross-Site Request Forgery (CSRF) vulnerability
  ## Withdrawn Advisory
  This advisory has been withdrawn because the [lunary npm package](https://www.npmjs.com/package/lunary) is connected to https://github.com/lunary-ai/lunary-js, not the https://github.com/lunary-ai/lunary repo that is discussed in this advisory.

  **The underlying vulnerability report is still valid**, but it doesn't affect a product in a [GitHub Advisory Database supported ecosystem](https://docs.github.com/en/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database#github-reviewed-advisories).

  This link is maintained to preserve external references.

  ## Original Description
  A Cross-Site Request Forgery (CSRF) vulnerability exists in lunary-ai/lunary version 1.2.34 due to overly permissive CORS settings. This vulnerability allows an attacker to sign up for and create projects or use the instance as if they were a user with local access. The main attack vector is for instances hosted locally on personal machines, which are not publicly accessible. The CORS settings in the backend permit all origins, exposing unauthenticated endpoints to CSRF attacks.
impacted_packages:
  - purl: pkg:npm/lunary
    affected_versions: vers:npm/<1.4.10
    fixed_versions: vers:npm/1.4.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40lunary/backend
    affected_versions: vers:npm/<1.4.10
    fixed_versions: vers:npm/1.4.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-v6x6-4v4x-2fx9/GHSA-v6x6-4v4x-2fx9.json
  - score: '6.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:A/VC:N/VI:N/VA:N/SC:H/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-v6x6-4v4x-2fx9/GHSA-v6x6-4v4x-2fx9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://github.com/lunary-ai/lunary
    reference_type:
    reference_id:
  - url: https://github.com/lunary-ai/lunary/commit/3451fcd7b9d95e9091d62c515752f39f2faa6e54
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/0b1d851e-3455-480c-ad5a-23565894976f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-6862
    reference_type:
    reference_id: CVE-2024-6862
