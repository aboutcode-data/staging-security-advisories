advisory_id: GHSA-c7vf-m394-m4x4
datasource_id: github_osv_importer_v2/GHSA-c7vf-m394-m4x4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-c7vf-m394-m4x4/GHSA-c7vf-m394-m4x4.json
aliases:
  - CVE-2024-21495
summary: |
  Use of Insufficiently Random Values in github.com/greenpau/caddy-security
  Versions of the package github.com/greenpau/caddy-security before 1.0.42 are vulnerable to Insecure Randomness due to using an insecure random number generation library which could possibly be predicted via a brute-force search. Attackers could use the potentially predictable nonce value used for authentication purposes in the OAuth flow to conduct OAuth replay attacks. In addition, insecure randomness is used while generating multifactor authentication (MFA) secrets and creating API keys in the database package.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-c7vf-m394-m4x4/GHSA-c7vf-m394-m4x4.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-330
references:
  - url: github.com/greenpau/caddy-security
    reference_type:
    reference_id:
  - url: https://blog.trailofbits.com/2023/09/18/security-flaws-in-an-sso-plugin-for-caddy
    reference_type:
    reference_id:
  - url: https://github.com/greenpau/caddy-security/issues/265
    reference_type:
    reference_id:
  - url: https://github.com/greenpau/go-authcrunch/commit/ecd3725baf2683eb1519bb3c81ae41085fbf7dc2
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-GOLANG-GITHUBCOMGREENPAUCADDYSECURITY-6248275
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-21495
    reference_type:
    reference_id: CVE-2024-21495
