advisory_id: GHSA-hq75-xg7r-rx6c
datasource_id: github_osv_importer_v2/GHSA-hq75-xg7r-rx6c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-hq75-xg7r-rx6c/GHSA-hq75-xg7r-rx6c.json
aliases: []
summary: "Better Call routing bug can lead to Cache Deception\n### Summary\n\nUsing a CDN that\
  \ caches (`/**/*.png`, `/**/*.json`, `/**/*.css`, etc...) requests, a cache deception can\
  \ emerge. This could lead to unauthorized access to user sessions and personal data when cached\
  \ responses are served to other users.\n\n### Details\n\nThe vulnerability occurs in the request\
  \ processing logic where path sanitization is insufficient. The library splits the path using\
  \ `config.basePath` but doesn't properly validate the remaining path components. This allows\
  \ specially crafted requests that appear to be static assets (like `/api/auth/get-session/api/auth/image.png`\
  \ assuming `config.basePath`=`/api/auth`) to bypass typical CDN cache exclusion rules while\
  \ actually returning sensitive data.\n\nThe problematic code [here](https://github.com/Bekacru/better-call/blob/8b6f13e24fad7f4666a582601517bb3232d4f4af/src/router.ts#L124):\n\
  ```js\n\tconst processRequest = async (request: Request) => {\n\t\tconst url = new URL(request.url);\n\
  \t\tconst path = config?.basePath ? url.pathname.split(config.basePath)[1] : url.pathname;\n\
  ```\n\nSince this library is largely coupled with `better-auth`, it becomes more clear why\
  \ this can be dangerous with an example request:\n\n<img width=\"800\" alt=\"image\" src=\"\
  https://github.com/user-attachments/assets/2ab7c4dd-0700-4f59-863f-79f2b5edbb37\" />\n\n###\
  \ Impact\n\nThis is a cache deception vulnerability affecting `better-call` users with CDN\
  \ caching enabled. which can expose sensitive data."
impacted_packages:
  - purl: pkg:npm/better-call
    affected_versions: vers:npm/<1.0.12
    fixed_versions: vers:npm/1.0.12
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-hq75-xg7r-rx6c/GHSA-hq75-xg7r-rx6c.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-525
references:
  - url: https://github.com/Bekacru/better-call
    reference_type:
    reference_id:
  - url: https://github.com/Bekacru/better-call/commit/7c7d31b
    reference_type:
    reference_id:
  - url: https://github.com/Bekacru/better-call/security/advisories/GHSA-hq75-xg7r-rx6c
    reference_type:
    reference_id:
