advisory_id: GHSA-rgrf-6mf5-m882
datasource_id: github_osv_importer_v2/GHSA-rgrf-6mf5-m882
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-rgrf-6mf5-m882/GHSA-rgrf-6mf5-m882.json
aliases:
  - CVE-2024-22194
summary: |
  cdo-local-uuid vulnerable to insertion of artifact derived from developer's Present Working Directory into demonstration code
  ### Impact
  _What kind of vulnerability is it? Who is impacted?_

  An information leakage vulnerability is present in [`cdo-local-uuid`](https://pypi.org/project/cdo-local-uuid/) at version `0.4.0`, and in [`case-utils`](https://pypi.org/project/case-utils/) in unpatched versions (matching the pattern `0.x.0`) at and since `0.5.0`, before `0.15.0`.

  The vulnerability stems from a Python function, `cdo_local_uuid.local_uuid()`, and its original implementation `case_utils.local_uuid()`.  Henceforth, both will be called `local_uuid()`.

  `local_uuid()` generates UUIDv5s using a deterministic pseudorandom number stream.  This was written to make graph application demonstrations generate consistent, version-controllable output with minimal noise caused by demonstration re-runs.  Part of the information used to keep individual examples' generated output distinct from one another is seed information from the caller's environment, particularly the program's argument vector.  The present working directory is also included as part of the seed information, but for reasons including maintaining user environment privacy, as well as keeping generated identifiers consistent regardless of where a source tree is housed on a user's file system, the present working directory is trimmed from the left to exclude path information outside of a supplied "Top" source directory.  (In context of the Make scripting language, this "top" directory is typically in a variable called `top_srcdir`.  In context of Git-based project management, this directory is expected to be the root directory of a freshly "Cloned" project, e.g., where `.git` is stored.)

  Under certain conditions, a user's present working directory, as an absolute path, was incorporated into seed data for the `local_uuid()` deterministic pseudorandom number stream.  This violates an expectation made in the documented purpose of the `local_uuid()` function, and leaks information about a calling user's environment.

  The conditions are:

  * Given a project with top source directory `top_srcdir`, for instance `/home/user1/Documents/Project1`;
  * Given a Python script housed directly in `top_srcdir`, for instance at `${top_srcdir}/example.py`, written to support the deterministic mode of `local_uuid()`;
  * Given a call to that Python script that follows the documentation for `local_uuid()`;

  The absolute path for `top_srcdir` was then included in the seed information for the UUIDv5 stream, when what was intended was a relative path spelling.  That is, instead of `./example.py` being in the seed data, `/home/user1/Documents/Project1/example.py` was in the seed data.

  This does not leak the present working directory directly.  But, given other knowledge of how a program had been called to generate data using `local_uuid()` under these conditions, it becomes possible to determine that a chosen path can lead to a known UUIDv5 value.  Note that it is not necessarily knowable that the chosen path is the *only* solution to a sequence reconstruction; but, the path can be confirmed to be *a* solution.


  ### Patches
  _Has the problem been patched? What versions should users upgrade to?_

  The issue has been patched, in the `cdo-local-uuid` source repository and the `case-utils` source repository.

  Users should upgrade to any of these versions minimally:

  * `case-utils == 0.5.1`
  * `case-utils == 0.6.1`
  * `case-utils == 0.7.1`
  * `case-utils == 0.8.1`
  * `case-utils == 0.9.1`
  * `case-utils == 0.10.1`
  * `case-utils == 0.11.1`
  * `case-utils == 0.12.1`
  * `case-utils == 0.13.1`
  * `case-utils == 0.14.1`
  * `case-utils >= 0.15.0`
  * `cdo-local-uuid == 0.5.0`

  All `case-utils` releases that contain the patch have the commit `ea630cce66b26dae6d7fa7e02451d6e25456a5f2` in their Git history.  Anyone interested in confirming the presence of this commit in a certain branch or tag can run the following test (written in Bash), substituting the desired branch name for the assigned value of `my_git_ref_of_interest`:

  ```bash
  #!/bin/bash
  # Present working directory ($PWD) should be in a clone of this repository:
  # https://github.com/casework/CASE-Utilities-Python
  my_git_ref_of_interest=main
  test \
    "xea630cce66b26dae6d7fa7e02451d6e25456a5f2" \
    == \
    "x$(git merge-base ea630cc ${my_git_ref_of_interest})"
  echo $?  # Should print '0'
  ```

  Note that other releases have been posted atop some of those minimal versions recommended for upgrading, named, e.g., `0.5.1.post0`.  These releases were posted to update internal library version numbers, and otherwise contain no functional changes, in accordance with Python Packaging guidance:

  * https://packaging.python.org/en/latest/specifications/version-specifiers/#post-release-separators


  ### Workarounds
  _Is there a way for users to fix or remediate the vulnerability without upgrading?_

  If the script calling `cdo_local_uuid.local_uuid()` is moved out of the "Top" source directory, the issue is addressed.


  ### References
  _Are there any links users can visit to find out more?_

  The issue is addressed in this Pull Request:

  * https://github.com/Cyber-Domain-Ontology/CDO-Utility-Local-UUID/pull/3

  Tests to reproduce the issue's conditions and confirm it has been addressed are in this Pull Requested:

  * https://github.com/Cyber-Domain-Ontology/CDO-Utility-Local-UUID/pull/4

  <!--
  CVSS3.1 vector determined by rubric diagrams at this page:
  https://www.first.org/cvss/v3.1/user-guide
  -->
impacted_packages:
  - purl: pkg:pypi/cdo-local-uuid
    affected_versions: vers:pypi/0.4.0
    fixed_versions: vers:pypi/0.5.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/case-utils
    affected_versions: vers:pypi/0.5.0
    fixed_versions: vers:pypi/0.5.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/case-utils
    affected_versions: vers:pypi/0.6.0
    fixed_versions: vers:pypi/0.6.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/case-utils
    affected_versions: vers:pypi/0.7.0
    fixed_versions: vers:pypi/0.7.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/case-utils
    affected_versions: vers:pypi/0.8.0
    fixed_versions: vers:pypi/0.8.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/case-utils
    affected_versions: vers:pypi/0.9.0
    fixed_versions: vers:pypi/0.9.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/case-utils
    affected_versions: vers:pypi/0.10.0
    fixed_versions: vers:pypi/0.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/case-utils
    affected_versions: vers:pypi/0.11.0
    fixed_versions: vers:pypi/0.11.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/case-utils
    affected_versions: vers:pypi/0.12.0
    fixed_versions: vers:pypi/0.12.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/case-utils
    affected_versions: vers:pypi/0.13.0
    fixed_versions: vers:pypi/0.13.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/case-utils
    affected_versions: vers:pypi/0.14.0
    fixed_versions: vers:pypi/0.14.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-rgrf-6mf5-m882/GHSA-rgrf-6mf5-m882.json
  - score: '0.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:P/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-rgrf-6mf5-m882/GHSA-rgrf-6mf5-m882.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-215
  - CWE-337
references:
  - url: https://github.com/casework/CASE-Utilities-Python/commit/00864cd12de7c50d882dd1a74915d32e939c25f9
    reference_type:
    reference_id:
  - url: https://github.com/casework/CASE-Utilities-Python/commit/1cccae8eb3cf94b3a28f6490efa0fbf5c82ebd6b
    reference_type:
    reference_id:
  - url: https://github.com/casework/CASE-Utilities-Python/commit/5acb929dfb599709d1c8c90d1824dd79e0fd9e10
    reference_type:
    reference_id:
  - url: https://github.com/casework/CASE-Utilities-Python/commit/7e02d18383eabbeb9fb4ec97d81438c9980a4790
    reference_type:
    reference_id:
  - url: https://github.com/casework/CASE-Utilities-Python/commit/80551f49241c874c7c50e14abe05c5017630dad2
    reference_type:
    reference_id:
  - url: https://github.com/casework/CASE-Utilities-Python/commit/939775f956796d0432ecabbf62782ed7ad1007b5
    reference_type:
    reference_id:
  - url: https://github.com/casework/CASE-Utilities-Python/commit/db428a0745dac4fdd888ced9c52f617695519f9d
    reference_type:
    reference_id:
  - url: https://github.com/casework/CASE-Utilities-Python/commit/e4ffadc3d56fd303b8f465d727c4a58213d311a1
    reference_type:
    reference_id:
  - url: https://github.com/casework/CASE-Utilities-Python/commit/fca7388f09feccd3b9ea88e6df9c7a43a5349452
    reference_type:
    reference_id:
  - url: https://github.com/casework/CASE-Utilities-Python/commit/fdc32414eccfcbde6be0fd91b7f491cc0779b02d#diff-e60b9cb8fb480ed27283a030a0898be3475992d78228f4045b12ce5cbb2f0509
    reference_type:
    reference_id:
  - url: https://github.com/Cyber-Domain-Ontology/CDO-Utility-Local-UUID
    reference_type:
    reference_id:
  - url: https://github.com/Cyber-Domain-Ontology/CDO-Utility-Local-UUID/commit/9e78f7cb1075728d0aafc918514f32a1392cd235
    reference_type:
    reference_id:
  - url: https://github.com/Cyber-Domain-Ontology/CDO-Utility-Local-UUID/pull/3
    reference_type:
    reference_id:
  - url: https://github.com/Cyber-Domain-Ontology/CDO-Utility-Local-UUID/pull/4
    reference_type:
    reference_id:
  - url: https://github.com/Cyber-Domain-Ontology/CDO-Utility-Local-UUID/security/advisories/GHSA-rgrf-6mf5-m882
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/case-utils/PYSEC-2024-5.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/cdo-local-uuid/PYSEC-2024-6.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22194
    reference_type:
    reference_id: CVE-2024-22194
