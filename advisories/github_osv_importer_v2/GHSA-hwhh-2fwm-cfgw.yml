advisory_id: GHSA-hwhh-2fwm-cfgw
datasource_id: github_osv_importer_v2/GHSA-hwhh-2fwm-cfgw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/03/GHSA-hwhh-2fwm-cfgw/GHSA-hwhh-2fwm-cfgw.json
aliases:
  - CVE-2018-1000088
summary: |
  Doorkeeper is vulnerable to stored XSS and code execution
  Doorkeeper version 2.1.0 through 4.2.5 contains a Cross Site Scripting (XSS) vulnerability in web view's OAuth app form, user authorization prompt web view that can result in Stored XSS on the OAuth Client's name will cause users interacting with it will execute payload. This attack appear to be exploitable via The victim must be tricked to click an opaque link to the web view that runs the XSS payload. A malicious version virtually indistinguishable from a normal link. This vulnerability appears to have been fixed in 4.2.6, 4.3.0.
impacted_packages:
  - purl: pkg:gem/doorkeeper
    affected_versions: vers:gem/<=4.2.5
    fixed_versions: vers:gem/4.2.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/03/GHSA-hwhh-2fwm-cfgw/GHSA-hwhh-2fwm-cfgw.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://blog.justinbull.ca/cve-2018-1000088-stored-xss-in-doorkeeper
    reference_type:
    reference_id:
  - url: https://github.com/doorkeeper-gem/doorkeeper
    reference_type:
    reference_id:
  - url: https://github.com/doorkeeper-gem/doorkeeper/commit/7b1a8373ecd69768c896000c7971dbf48948c1b5
    reference_type:
    reference_id:
  - url: https://github.com/doorkeeper-gem/doorkeeper/issues/969
    reference_type:
    reference_id:
  - url: https://github.com/doorkeeper-gem/doorkeeper/pull/970
    reference_type:
    reference_id:
  - url: https://github.com/doorkeeper-gem/doorkeeper/releases/tag/v4.3.0
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/doorkeeper/CVE-2018-1000088.yml
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/pull/328/files
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-1000088
    reference_type:
    reference_id: CVE-2018-1000088
