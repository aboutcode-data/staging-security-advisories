advisory_id: GHSA-c8fj-4pm8-mp2c
datasource_id: github_osv_importer_v2/GHSA-c8fj-4pm8-mp2c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-c8fj-4pm8-mp2c/GHSA-c8fj-4pm8-mp2c.json
aliases:
  - CVE-2022-36051
summary: |
  Broken Authorization in ZITADEL Actions
  ### Impact

  **Actions**, introduced in ZITADEL **1.42.0** on the API and **1.56.0** for Console, is a feature, where users with role `ORG_OWNER` are able to create Javascript Code, which is invoked by the system at certain points during the login.
  **Actions**, for example, allow creating authorizations (user grants) on newly created users programmatically.
  Due to a missing authorization check, **Actions** were able to grant authorizations for projects that belong to other organisations inside the same Instance. Granting authorizations via API and Console is not affected by this vulnerability.

  ### Patches

  2.x versions are fixed on >= [2.2.0](https://github.com/zitadel/zitadel/releases/tag/v2.2.0)
  1.x versions are fixed on >= [1.87.1](https://github.com/zitadel/zitadel/releases/tag/v1.87.1)

  ZITADEL recommends upgrading to the latest versions available in due course.

  ### Workarounds

  There is no workaround since a patch is already available.

  ### Who did disclose this

  During our recurring white box penetration test our external security consultant found this issue.
  The full report will be made public after the complete review.

  ### References

  https://docs.zitadel.com/docs/guides/manage/customize/behavior
  https://docs.zitadel.com/docs/apis/actions
  https://zitadel.com/blog/pentest-results-h1-2021

  ### Questions

  If you have any questions or comments about this advisory:
  * Email us at [security@zitadel.com](mailto:security@zitadel.com)
impacted_packages: []
severities:
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-c8fj-4pm8-mp2c/GHSA-c8fj-4pm8-mp2c.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
  - CWE-436
references:
  - url: github.com/zitadel/zitadel
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/pull/4237
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/pull/4238
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v1.87.1
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.2.0
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/security/advisories/GHSA-c8fj-4pm8-mp2c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-36051
    reference_type:
    reference_id: CVE-2022-36051
