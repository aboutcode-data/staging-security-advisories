advisory_id: GHSA-7hv8-3fr9-j2hv
datasource_id: github_osv_importer_v2/GHSA-7hv8-3fr9-j2hv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-7hv8-3fr9-j2hv/GHSA-7hv8-3fr9-j2hv.json
aliases:
  - CVE-2023-25571
summary: |
  Cross site scripting Vulnerability in backstage Software Catalog
  ### Impact

  This vulnerability allows a malicious actor with access to add or modify content in an instance of the Backstage software catalog to inject script URLs in the entities stored in the catalog. If users of the catalog then click on said URLs, that can lead to an XSS attack.

  ### Patches

  This vulnerability has been patched in both the frontend and backend implementations. The default `Link` component from `@backstage/core-components` will now reject `javascript:` URLs, and there is a global override of `window.open` to do the same.

  In addition the catalog model as well as the catalog backend now has additional validation built in that prevents `javascript:` URLs in known annotations.

  ### Workarounds

  The general practice of limiting access to modifying catalog content and requiring code reviews greatly helps mitigate this vulnerability.

  ### For more information

  If you have any questions or comments about this advisory:

  * Open an issue in the [Backstage repository](https://github.com/backstage/backstage)
  * Visit our chat, linked to in the [Backstage README](https://github.com/backstage/backstage)
impacted_packages:
  - purl: pkg:npm/%40backstage/core-components
    affected_versions: vers:npm/<0.12.4
    fixed_versions: vers:npm/0.12.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40backstage/catalog-model
    affected_versions: vers:npm/<1.2.0
    fixed_versions: vers:npm/1.2.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40backstage/plugin-catalog-backend
    affected_versions: vers:npm/<1.7.2
    fixed_versions: vers:npm/1.7.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-7hv8-3fr9-j2hv/GHSA-7hv8-3fr9-j2hv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/backstage/backstage
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/commit/3d1371954512f7fa8bd0e2d357e00eada2c3e8a8
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/security/advisories/GHSA-7hv8-3fr9-j2hv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-25571
    reference_type:
    reference_id: CVE-2023-25571
