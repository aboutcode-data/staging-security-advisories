advisory_id: GHSA-7g54-vgp6-jj5w
datasource_id: github_osv_importer_v2/GHSA-7g54-vgp6-jj5w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7g54-vgp6-jj5w/GHSA-7g54-vgp6-jj5w.json
aliases:
  - CVE-2016-6798
summary: |
  XML External Entity Reference in Apache Sling
  In the XSS Protection API module before 1.0.12 in Apache Sling, the method XSS.getValidXML() uses an insecure SAX parser to validate the input string, which allows for XXE attacks in all scripts which use this method to validate user input, potentially allowing an attacker to read sensitive data on the filesystem, perform same-site-request-forgery (SSRF), port-scanning behind the firewall or DoS the application.
impacted_packages:
  - purl: pkg:maven/org.apache.sling/org.apache.sling.xss
    affected_versions: vers:maven/<1.0.12
    fixed_versions: vers:maven/1.0.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.sling/org.apache.sling.xss.compat
    affected_versions: vers:maven/<1.1.0
    fixed_versions: vers:maven/1.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7g54-vgp6-jj5w/GHSA-7g54-vgp6-jj5w.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://github.com/apache/sling-org-apache-sling-xss/commit/de32b144ad2be3367559f6184d560db42a220529
    reference_type:
    reference_id:
  - url: https://github.com/jensdietrich/xshady-release/tree/main/CVE-2016-6798
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/b72c3a511592ec70729b3ec2d29302b6ce87bbeab62d4745617a6bd0@%3Cdev.sling.apache.org%3E
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/99873
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2016-6798
    reference_type:
    reference_id: CVE-2016-6798
