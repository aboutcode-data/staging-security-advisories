advisory_id: GHSA-rchw-322g-f7rm
datasource_id: github_osv_importer_v2/GHSA-rchw-322g-f7rm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-rchw-322g-f7rm/GHSA-rchw-322g-f7rm.json
aliases:
  - CVE-2026-28279
summary: |
  osctrl is Vulnerable to OS Command Injection via Environment Configuration
  ### Summary
  An OS command injection vulnerability exists in the `osctrl-admin` environment configuration. An authenticated administrator can inject arbitrary shell commands via the hostname parameter when creating or editing environments. These commands are embedded into enrollment one-liner scripts generated using Go's `text/template` package (which does not perform shell escaping) and execute on every endpoint that enrolls using the compromised environment.

  ### Impact
  An attacker with administrator access can achieve remote code execution on every endpoint that enrolls using the compromised environment. Commands execute as root/SYSTEM (the privilege level used for osquery enrollment) before osquery is installed, leaving no agent-level audit trail. This enables backdoor installation, credential exfiltration, and full endpoint compromise.

  ### Patches
  Fixed in osctrl `v0.5.0`. Users should upgrade immediately.

  ### Workarounds
  Restrict osctrl administrator access to trusted personnel. Review existing environment configurations for suspicious hostnames. Monitor enrollment scripts for unexpected commands.

  ### Credits

  Leon Johnson and Kwangyun Keum from TikTok USDS JV Offensive Security Operations (Offensive Privacy Team)

  https://github.com/Kwangyun → @Kwangyun
  https://github.com/sho-luv → @sho-luv
impacted_packages: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-rchw-322g-f7rm/GHSA-rchw-322g-f7rm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/jmpsec/osctrl
    reference_type:
    reference_id:
  - url: https://github.com/jmpsec/osctrl/pull/777
    reference_type:
    reference_id:
  - url: https://github.com/jmpsec/osctrl/pull/780
    reference_type:
    reference_id:
  - url: https://github.com/jmpsec/osctrl/security/advisories/GHSA-rchw-322g-f7rm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-28279
    reference_type:
    reference_id: CVE-2026-28279
