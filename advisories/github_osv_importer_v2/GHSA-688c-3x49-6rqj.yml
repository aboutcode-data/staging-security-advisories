advisory_id: GHSA-688c-3x49-6rqj
datasource_id: github_osv_importer_v2/GHSA-688c-3x49-6rqj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/03/GHSA-688c-3x49-6rqj/GHSA-688c-3x49-6rqj.json
aliases:
  - CVE-2018-1000119
summary: |
  rack-protection gem timing attack vulnerability when validating CSRF token
  Sinatra rack-protection versions 1.5.4 and 2.0.0.rc3 and earlier contains a timing attack vulnerability in the CSRF token checking that can result in signatures can be exposed. This attack appear to be exploitable via network connectivity to the ruby application. This vulnerability appears to have been fixed in 1.5.5 and 2.0.0.
impacted_packages:
  - purl: pkg:gem/rack-protection
    affected_versions: vers:gem/<1.5.5
    fixed_versions: vers:gem/1.5.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack-protection
    affected_versions: vers:gem/<=2.0.0.rc3
    fixed_versions: vers:gem/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/03/GHSA-688c-3x49-6rqj/GHSA-688c-3x49-6rqj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-203
references:
  - url: https://access.redhat.com/errata/RHSA-2018:1060
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack-protection/CVE-2018-1000119.yml
    reference_type:
    reference_id:
  - url: https://github.com/sinatra/rack-protection
    reference_type:
    reference_id:
  - url: https://github.com/sinatra/rack-protection/pull/98
    reference_type:
    reference_id:
  - url: https://github.com/sinatra/sinatra/commit/8aa6c42ef724f93ae309fb7c5668e19ad547eceb#commitcomment-27964109
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2018/dsa-4247
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-1000119
    reference_type:
    reference_id: CVE-2018-1000119
