advisory_id: GHSA-3g9q-cmgv-g4p6
datasource_id: github_osv_importer_v2/GHSA-3g9q-cmgv-g4p6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-3g9q-cmgv-g4p6/GHSA-3g9q-cmgv-g4p6.json
aliases:
  - CVE-2022-45381
summary: |
  Arbitrary file read vulnerability in Jenkins Pipeline Utility Steps Plugin
  Pipeline Utility Steps Plugin implements a `readProperties` Pipeline step that supports interpolation of variables using the Apache Commons Configuration library.

  Pipeline Utility Steps Plugin 2.13.1 and earlier does not restrict the set of enabled prefix interpolators and bundles versions of this library that enable the `file:` prefix interpolator by default.

  This allows attackers able to configure Pipelines to read arbitrary files from the Jenkins controller file system.

  Pipeline Utility Steps Plugin 2.13.2 restricts the set of prefix interpolators enabled by default to `base64Decoder:`, `base64Encoder:`, `date:`, `urlDecoder:`, and `urlEncoder:`.

  Administrators can set the [Java system property](https://www.jenkins.io/doc/book/managing/system-properties/) `org.jenkinsci.plugins.pipeline.utility.steps.conf.ReadPropertiesStepExecution.CUSTOM_PREFIX_INTERPOLATOR_LOOKUPS` to customize which prefix interpolators are enabled.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/pipeline-utility-steps
    affected_versions: vers:maven/<=2.13.1
    fixed_versions: vers:maven/2.13.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-3g9q-cmgv-g4p6/GHSA-3g9q-cmgv-g4p6.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/jenkinsci/pipeline-utility-steps-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/pipeline-utility-steps-plugin/commit/01be8ac0045027128fc1e9cf3a8b0709d08291ea
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2022-11-15/#SECURITY-2949
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2022/11/15/4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-45381
    reference_type:
    reference_id: CVE-2022-45381
