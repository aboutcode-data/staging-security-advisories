advisory_id: GHSA-x7wv-5qg4-vmr6
datasource_id: github_osv_importer_v2/GHSA-x7wv-5qg4-vmr6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-x7wv-5qg4-vmr6/GHSA-x7wv-5qg4-vmr6.json
aliases:
  - CVE-2025-32973
summary: |
  org.xwiki.platform:xwiki-platform-component-wiki provides no warning when granting XWiki.ComponentClass programming right
  ### Impact

  When a user with programming right edits a document in XWiki that was last edited by a user without programming right and contains an `XWiki.ComponentClass`, there is no warning that this will grant programming right to this object. An attacker who created such a malicious object could use this to gain programming right on the wiki. For this, the attacker needs to have edit right on at least one page to place this object and then get an admin user to edit that document.

  To reproduce the problem, as a user without programming right, add an object of type `XWiki.ComponentClass` to any page and then edit the page as a user with programming right. There should be warning displayed, if not, the XWiki installation is vulnerable.

  While such a warning didn't exist in any version of XWiki, only in XWiki 15.9 RC1 these kinds of warnings have been introduced which is why this is considered the first version that has this vulnerability. Before that, the advice was to be careful when editing pages edited by untrusted users.

  ### Patches
  This problem has been patched in XWiki 15.10.2, 16.4.3, and 16.8.0 RC1.

  ### Workarounds
  We're not aware of any workarounds apart from not editing pages that might have been edited by untrusted users as a user with programming rights, e.g., by using separate user accounts for admin and non-admin tasks.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-component-wiki
    affected_versions: vers:maven/>=15.9-rc-1|<15.10.12
    fixed_versions: vers:maven/15.10.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-component-wiki
    affected_versions: vers:maven/>=16.0.0-rc-1|<16.4.3
    fixed_versions: vers:maven/16.4.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-component-wiki
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.8.0-rc-1
    fixed_versions: vers:maven/16.8.0-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-x7wv-5qg4-vmr6/GHSA-x7wv-5qg4-vmr6.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/1a6f1b2e050770331c9a63d12a3fd8a36d199f62
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-x7wv-5qg4-vmr6
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22460
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32973
    reference_type:
    reference_id: CVE-2025-32973
