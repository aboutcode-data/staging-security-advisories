advisory_id: GHSA-f7qw-jj9c-rpq9
datasource_id: github_osv_importer_v2/GHSA-f7qw-jj9c-rpq9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-f7qw-jj9c-rpq9/GHSA-f7qw-jj9c-rpq9.json
aliases:
  - CVE-2023-32684
summary: |
  In Lima, a malicious disk image could read a single file on the host filesystem as a qcow2/vmdk backing file
  > **Note**
  >
  > The official templates of Lima, and the well-known third party products (Colima, Rancher Desktop, and Finch) are *unlikely* to be affected by this issue.

  ### Impact
  A virtual machine instance with a malicious disk image could read a single file on the host filesystem, even when no filesystem is mounted from the host.

  To exploit this issue, the attacker has to embed the target file path (an absolute or a relative path from the instance directory) in a malicious disk image, as the [qcow2 (or vmdk) backing file path string](https://gitlab.com/qemu-project/qemu/-/blob/v8.0.0/docs/interop/qcow2.txt#L23-L34).
  As Lima refuses to run as the root, it is practically impossible for the attacker to read the entire host disk via `/dev/rdiskN`.
  Also, practically, the attacker cannot read at least the first 512 bytes (MBR) of the target file.

  ### Patches
  Patched in Lima v0.16.0, by prohibiting using a backing file path in the VM base image.

  ### Workarounds
  Do not use an untrusted disk image.
impacted_packages: []
severities:
  - score: '2.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-f7qw-jj9c-rpq9/GHSA-f7qw-jj9c-rpq9.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-552
references:
  - url: https://github.com/lima-vm/lima
    reference_type:
    reference_id:
  - url: https://github.com/lima-vm/lima/commit/01dbd4d9cabe692afa4517be3995771f0ebb38a5
    reference_type:
    reference_id:
  - url: https://github.com/lima-vm/lima/releases/tag/v0.16.0
    reference_type:
    reference_id:
  - url: https://github.com/lima-vm/lima/security/advisories/GHSA-f7qw-jj9c-rpq9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-32684
    reference_type:
    reference_id: CVE-2023-32684
