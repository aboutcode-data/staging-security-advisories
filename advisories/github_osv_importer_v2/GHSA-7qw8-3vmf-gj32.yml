advisory_id: GHSA-7qw8-3vmf-gj32
datasource_id: github_osv_importer_v2/GHSA-7qw8-3vmf-gj32
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-7qw8-3vmf-gj32/GHSA-7qw8-3vmf-gj32.json
aliases:
  - CVE-2025-53011
summary: |
  MaterialX Null Pointer Dereference in MaterialXCore Shader Generation due to Unchecked implGraphOutput
  ### Summary

  When parsing shader nodes in a MTLX file, the MaterialXCore code accesses a potentially null pointer, which can lead to crashes with maliciously crafted files.

  ### Details

  In `source/MaterialXCore/Material.cpp`, the following code extracts the output nodes for a given implementation graph:

  ```cpp
     InterfaceElementPtr impl = materialNodeDef->getImplementation();
              if (impl && impl->isA<NodeGraph>())
              {
                  NodeGraphPtr implGraph = impl->asA<NodeGraph>();
                  for (OutputPtr defOutput : materialNodeDef->getOutputs())
                  {
                      if (defOutput->getType() == MATERIAL_TYPE_STRING)
                      {
                          OutputPtr implGraphOutput = implGraph->getOutput(defOutput->getName());
                          for (GraphIterator it = implGraphOutput->traverseGraph().begin(); it != GraphIterator::end(); ++it)
                          {
                              ElementPtr upstreamElem = it.getUpstreamElement();
                              if (!upstreamElem)
                              {
                                  it.setPruneSubgraph(true);
                                  continue;
                              }
                              NodePtr upstreamNode = upstreamElem->asA<Node>();
                              if (upstreamNode && upstream
  ```

  However, when defining the `implGraphOutput` variable by getting the output node, the code doesn't check whether its value is null before accessing its iterator `traverseGraph()`. This leads to a potential null pointer dereference.

  ### PoC

  Please download `nullptr_implgraph.mtlx` from the following link:

  https://github.com/ShielderSec/poc/tree/main/CVE-2025-53011

  `build/bin/MaterialXView --material nullptr_implgraph.mtlx`

  ### Impact

  An attacker could intentionally crash a target program that uses MaterialX by sending a malicious MTLX file.
impacted_packages:
  - purl: pkg:pypi/materialx
    affected_versions: vers:pypi/1.39.2
    fixed_versions: vers:pypi/1.39.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-7qw8-3vmf-gj32/GHSA-7qw8-3vmf-gj32.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-476
references:
  - url: https://github.com/AcademySoftwareFoundation/MaterialX
    reference_type:
    reference_id:
  - url: https://github.com/AcademySoftwareFoundation/MaterialX/commit/7ac1c71de5187dc29793292b5a8dc6d784192ecf
    reference_type:
    reference_id:
  - url: https://github.com/AcademySoftwareFoundation/MaterialX/releases/tag/v1.39.3
    reference_type:
    reference_id:
  - url: https://github.com/AcademySoftwareFoundation/MaterialX/security/advisories/GHSA-7qw8-3vmf-gj32
    reference_type:
    reference_id:
  - url: https://github.com/ShielderSec/poc/tree/main/CVE-2025-53011
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-53011
    reference_type:
    reference_id: CVE-2025-53011
