advisory_id: GHSA-xh3v-6f9j-wxw3
datasource_id: github_osv_importer_v2/GHSA-xh3v-6f9j-wxw3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-xh3v-6f9j-wxw3/GHSA-xh3v-6f9j-wxw3.json
aliases:
  - CVE-2022-25275
summary: |
  Drupal core Information Disclosure vulnerability
  In some situations, the Image module does not correctly check access to image files not stored in the standard public files directory when generating derivative images using the image styles system.

  Access to a non-public file is checked only if it is stored in the "private" file system. However, some contributed modules provide additional file systems, or schemes, which may lead to this vulnerability.

  This vulnerability is mitigated by the fact that it only applies when the site sets (Drupal 9) `$config['image.settings']['allow_insecure_derivatives']` or (Drupal 7) `$conf['image_allow_insecure_derivatives']` to TRUE. The recommended and default setting is FALSE, and Drupal core does not provide a way to change that in the admin UI.

  Some sites may require configuration changes following this security release. Review the release notes for your Drupal version if you have issues accessing files or image styles after updating.
impacted_packages:
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/>=7.0.0|<7.91.0
    fixed_versions: vers:composer/7.91.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/>=8.0.0|<9.3.19
    fixed_versions: vers:composer/9.3.19
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/>=9.4.0|<9.4.3
    fixed_versions: vers:composer/9.4.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-xh3v-6f9j-wxw3/GHSA-xh3v-6f9j-wxw3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/drupal/core
    reference_type:
    reference_id:
  - url: https://github.com/drupal/core/commit/2d5f47fc8a166115f56c2330a81e83abe22445cf
    reference_type:
    reference_id:
  - url: https://github.com/drupal/core/commit/e2fbf63700819cb470a1be425798f1a3f2020116
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/core/CVE-2022-25275.yaml
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2022-012
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-25275
    reference_type:
    reference_id: CVE-2022-25275
