advisory_id: GHSA-g9cg-h3jm-cwrc
datasource_id: github_osv_importer_v2/GHSA-g9cg-h3jm-cwrc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/09/GHSA-g9cg-h3jm-cwrc/GHSA-g9cg-h3jm-cwrc.json
aliases: []
summary: |
  Prototype Pollution in @hapi/subtext
  Versions of `@hapi/pez` prior to 4.1.2 or 5.0.1 are vulnerable to Prototype Pollution. A multipart payload can be constructed in a way that one of the parts’ content can be set as the entire payload object’s prototype. If this prototype contains data, it may bypass other validation rules which enforce access and privacy. If this prototype evaluates to null, it can cause unhandled exceptions when the request payload is accessed.

  ## Recommendation

  Upgrade to versions 5.0.1 or later. There is a fix available for version 4.1.2,  but it only available for direct download from the repository.
impacted_packages:
  - purl: pkg:npm/%40hapi/pez
    affected_versions: vers:npm/<5.0.1
    fixed_versions: vers:npm/5.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1321
references:
  - url: https://github.com/hapijs/pez
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1480
    reference_type:
    reference_id:
