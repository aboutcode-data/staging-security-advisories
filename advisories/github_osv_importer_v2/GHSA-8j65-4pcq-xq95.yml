advisory_id: GHSA-8j65-4pcq-xq95
datasource_id: github_osv_importer_v2/GHSA-8j65-4pcq-xq95
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-8j65-4pcq-xq95/GHSA-8j65-4pcq-xq95.json
aliases:
  - CVE-2021-29489
summary: |
  Options structure open to Cross-site Scripting if passed unfiltered
  ### Impact
  In Highcharts versions 8 and earlier, the chart options structure was not systematically filtered for XSS vectors. The potential impact was that content from untrusted sources could execute code in the end user's browser. Especially when using the `useHTML` flag, HTML string options would be inserted unfiltered directly into the DOM. When `useHTML` was false, malicious code could be inserted by using various character replacement tricks or malformed HTML.

  If your chart configuration comes from a trusted source like a static setup or pre-filtered HTML (or no markup at all in the configuration), you are not impacted.

  ### Patches
  In version 9, the whole rendering layer was refactored to use an DOMParser, an AST and tag and HTML allow-listing to make sure only safe content entered the DOM. In addition, prototype pollution was stopped.

  ### Workarounds
  Implementers who are not able to upgrade may apply [DOMPurify](https://github.com/cure53/DOMPurify) recursively [to the options structure](https://jsfiddle.net/highcharts/zd3wcm5L/) to filter out malicious markup.

  ### References
  * Details on the improved [Highcharts security](https://www.highcharts.com/docs/chart-concepts/security)
  * [The AST and TextBuilder refactoring](https://github.com/highcharts/highcharts/pull/14913)
  * [The fix for prototype pollution](https://github.com/highcharts/highcharts/pull/14884)

  ### For more information
  If you have any questions or comments about this advisory:
  * Visit our [support page](https://www.highcharts.com/blog/support/)
  * For more Email us at [security@highcharts.com](mailto:security@highcharts.com)
impacted_packages:
  - purl: pkg:npm/highcharts
    affected_versions: vers:npm/<9.0.0
    fixed_versions: vers:npm/9.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-8j65-4pcq-xq95/GHSA-8j65-4pcq-xq95.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/highcharts/highcharts
    reference_type:
    reference_id:
  - url: https://github.com/highcharts/highcharts/security/advisories/GHSA-8j65-4pcq-xq95
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20210622-0005
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/highcharts
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29489
    reference_type:
    reference_id: CVE-2021-29489
