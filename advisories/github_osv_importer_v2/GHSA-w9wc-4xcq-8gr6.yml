advisory_id: GHSA-w9wc-4xcq-8gr6
datasource_id: github_osv_importer_v2/GHSA-w9wc-4xcq-8gr6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-w9wc-4xcq-8gr6/GHSA-w9wc-4xcq-8gr6.json
aliases:
  - CVE-2022-46157
summary: "Akeneo PIM Community Edition vulnerable to remote php code execution\n### Impact\n\
  Akeneo PIM Community Edition versions before v5.0.119 and v6.0.53 allows remote authenticated\
  \ users to execute arbitrary PHP code on the server by uploading a crafted image.\n\n\n###\
  \ Patches\n\nAkeneo PIM Community Edition after the versions aforementioned provides patched\
  \ Apache HTTP server configuration file, for docker setup and in documentation sample, to\
  \ fix this vulnerability.  \nCommunity Edition users must change their Apache HTTP server\
  \ configuration accordingly to be protected.\nThe patch for Cloud Based Akeneo PIM Services\
  \ customers has been applied since 30th October 2022. \n\n### Workarounds\n\nReplace any reference\
  \ to `<FilesMatch \\.php$>` in your apache httpd configurations with: `<Location \"/index.php\"\
  >`, as shown in https://github.com/akeneo/pim-community-dev/blob/b4d79bb073c8b68ea26ab227c97cc78d86c4cba1/docker/httpd.conf#L39.\n\
  \n<!--\n### References\n_Are there any links users can visit to find out more?_\n\n\n### For\
  \ more information\n If you have any questions or comments about this advisory:\n* Open an\
  \ issue in [example link to repo](http://example.com)\n* Email us at [example email address](mailto:example@example.com)\n\
  -->"
impacted_packages:
  - purl: pkg:composer/akeneo/pim-community-dev
    affected_versions: vers:composer/>=6.0.0|<6.0.53
    fixed_versions: vers:composer/6.0.53
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/akeneo/pim-community-dev
    affected_versions: vers:composer/<5.0.119
    fixed_versions: vers:composer/5.0.119
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-w9wc-4xcq-8gr6/GHSA-w9wc-4xcq-8gr6.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
  - CWE-94
references:
  - url: https://github.com/akeneo/pim-community-dev
    reference_type:
    reference_id:
  - url: https://github.com/akeneo/pim-community-dev/blob/b4d79bb073c8b68ea26ab227c97cc78d86c4cba1/docker/httpd.conf#L39
    reference_type:
    reference_id:
  - url: https://github.com/akeneo/pim-community-dev/commit/891a2f70a9a200f199de06fe64d376d03787a81a
    reference_type:
    reference_id:
  - url: https://github.com/akeneo/pim-community-dev/security/advisories/GHSA-w9wc-4xcq-8gr6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-46157
    reference_type:
    reference_id: CVE-2022-46157
