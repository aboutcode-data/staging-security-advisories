advisory_id: GHSA-m3cq-xcx9-3gvm
datasource_id: github_osv_importer_v2/GHSA-m3cq-xcx9-3gvm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-m3cq-xcx9-3gvm/GHSA-m3cq-xcx9-3gvm.json
aliases:
  - CVE-2022-47633
summary: |
  kyverno verifyImages rule bypass possible with malicious proxy/registry
  ### Impact

  Users of Kyverno on versions 1.8.3 or 1.8.4 who use `verifyImages` rules to verify container image signatures, and do not prevent use of unknown registries.

  ### Patches

  This issue has been fixed in version [1.8.5](https://github.com/kyverno/kyverno/releases/tag/v1.8.5)

  ### Workarounds

  Configure a Kyverno policy to restrict registries to a set of secure trusted image registries ([sample](https://kyverno.io/policies/best-practices/restrict_image_registries/restrict_image_registries/)).

  ### References
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-m3cq-xcx9-3gvm/GHSA-m3cq-xcx9-3gvm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/kyverno/kyverno
    reference_type:
    reference_id:
  - url: https://github.com/kyverno/kyverno/compare/v1.8.4...v1.8.5
    reference_type:
    reference_id:
  - url: https://github.com/kyverno/kyverno/pull/5713
    reference_type:
    reference_id:
  - url: https://github.com/kyverno/kyverno/releases/tag/v1.8.5
    reference_type:
    reference_id:
  - url: https://github.com/kyverno/kyverno/security/advisories/GHSA-m3cq-xcx9-3gvm
    reference_type:
    reference_id:
  - url: https://kyverno.io/docs/writing-policies/verify-images
    reference_type:
    reference_id:
  - url: https://kyverno.io/policies/best-practices/restrict_image_registries/restrict_image_registries
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-1180
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20230426095744/https://kyverno.io/policies/best-practices/restrict_image_registries/restrict_image_registries
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-47633
    reference_type:
    reference_id: CVE-2022-47633
