advisory_id: GHSA-8v38-pw62-9cw2
datasource_id: github_osv_importer_v2/GHSA-8v38-pw62-9cw2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-8v38-pw62-9cw2/GHSA-8v38-pw62-9cw2.json
aliases:
  - CVE-2022-0639
summary: |
  url-parse Incorrectly parses URLs that include an '@'
  A specially crafted URL with an '@' sign but empty user info and no hostname, when parsed with url-parse, url-parse will return the incorrect href. In particular,

  ```js
  parse(\"http://@/127.0.0.1\")
  ```
  Will return:
  ```yaml
  {
   slashes: true,
   protocol: 'http:',
   hash: '',
   query: '',
   pathname: '/127.0.0.1',
   auth: '',
   host: '',
   port: '',
   hostname: '',
   password: '',
   username: '',
   origin: 'null',
   href: 'http:///127.0.0.1'
   }
  ```
  If the 'hostname' or 'origin' attributes of the output from url-parse are used in security decisions and the final 'href' attribute of the output is then used to make a request, the decision may be incorrect.
impacted_packages:
  - purl: pkg:npm/url-parse
    affected_versions: vers:npm/>=1.0.0|<1.5.7
    fixed_versions: vers:npm/1.5.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-8v38-pw62-9cw2/GHSA-8v38-pw62-9cw2.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-639
references:
  - url: https://github.com/unshiftio/url-parse
    reference_type:
    reference_id:
  - url: https://github.com/unshiftio/url-parse/commit/ef45a1355375a8244063793a19059b4f62fc8788
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/83a6bc9a-b542-4a38-82cd-d995a1481155
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/02/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/12/msg00024.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-0639
    reference_type:
    reference_id: CVE-2022-0639
