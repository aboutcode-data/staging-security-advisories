advisory_id: GHSA-rfcf-m67m-jcrq
datasource_id: github_osv_importer_v2/GHSA-rfcf-m67m-jcrq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-rfcf-m67m-jcrq/GHSA-rfcf-m67m-jcrq.json
aliases:
  - CVE-2021-32693
summary: |
  Authentication granted to all firewalls instead of just one
  Description
  -----------

  When an application defines multiple firewalls, the authenticated token delivered by one of the firewalls is available to all other firewalls. This can be abused when the application defines different providers for different parts of an application. In such a situation, a user authenticated on one part of the application is considered authenticated on the whole application.

  Resolution
  ----------

  We now ensure that the authenticated token is only available for the firewall that generates it.

  The patch for this issue is available [here](https://github.com/symfony/symfony/commit/3084764ad82f29dbb025df19978b9cbc3ab34728) for branch 5.3.

  Credits
  -------

  I would like to thank Bogdan, gndk, Paweł Warchoł, Warxcell, and Adrien Lamotte for reporting the issue and Wouter J for fixing the issue.
impacted_packages:
  - purl: pkg:composer/symfony/security-http
    affected_versions: vers:composer/>=5.3.0|<5.3.2
    fixed_versions: vers:composer/5.3.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=5.3.0|<5.3.2
    fixed_versions: vers:composer/5.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-rfcf-m67m-jcrq/GHSA-rfcf-m67m-jcrq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/security-http/CVE-2021-32693.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2021-32693.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/security-http
    reference_type:
    reference_id:
  - url: https://github.com/symfony/security-http/commit/6bf4c31219773a558b019ee12e54572174ff8129
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/3084764ad82f29dbb025df19978b9cbc3ab34728
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/security/advisories/GHSA-rfcf-m67m-jcrq
    reference_type:
    reference_id:
  - url: https://symfony.com/blog/cve-2021-32693-authentication-granted-to-all-firewalls-instead-of-just-one
    reference_type:
    reference_id:
  - url: https://symfony.com/cve-2021-32693
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32693
    reference_type:
    reference_id: CVE-2021-32693
