advisory_id: GHSA-c735-g9f2-2mvp
datasource_id: github_osv_importer_v2/GHSA-c735-g9f2-2mvp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-c735-g9f2-2mvp/GHSA-c735-g9f2-2mvp.json
aliases:
  - CVE-2020-2160
summary: |
  Cross-Site Request Forgery in Jenkins
  An extension point in Jenkins allows selectively disabling cross-site request forgery (CSRF) protection for specific URLs.

  Implementations of that extension point received a different representation of the URL path than the Stapler web framework uses to dispatch requests in Jenkins 2.227 and earlier, LTS 2.204.5 and earlier. This discrepancy allowed attackers to craft URLs that would bypass the CSRF protection of any target URL.

  Jenkins now uses the same representation of the URL path to decide whether CSRF protection is needed for a given URL as the Stapler web framework uses.

  In case of problems, administrators can disable this security fix by setting the system property `hudson.security.csrf.CrumbFilter.UNPROCESSED_PATHINFO` to `true`.

  As an additional safeguard, semicolon (`;`) characters in the path part of a URL are now banned by default. Administrators can disable this protection by setting the system property `jenkins.security.SuspiciousRequestFilter.allowSemicolonsInPath` to `true`.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.main/jenkins-core
    affected_versions: vers:maven/<=2.204.5
    fixed_versions: vers:maven/2.204.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.main/jenkins-core
    affected_versions: vers:maven/<=2.227
    fixed_versions: vers:maven/2.228
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-c735-g9f2-2mvp/GHSA-c735-g9f2-2mvp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
  - CWE-435
references:
  - url: https://github.com/jenkinsci/jenkins
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/jenkins/commit/f479652171f4ab854747de64b22bf59adb35fb8f
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/jenkins/commit/f7cf28355973df1ca6eb19066370bf70b10742f7
    reference_type:
    reference_id:
  - url: https://jenkins.io/security/advisory/2020-03-25/#SECURITY-1774
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2020/03/25/2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-2160
    reference_type:
    reference_id: CVE-2020-2160
