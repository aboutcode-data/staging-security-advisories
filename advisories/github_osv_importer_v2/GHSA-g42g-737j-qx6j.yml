advisory_id: GHSA-g42g-737j-qx6j
datasource_id: github_osv_importer_v2/GHSA-g42g-737j-qx6j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-g42g-737j-qx6j/GHSA-g42g-737j-qx6j.json
aliases:
  - CVE-2021-25735
summary: |
  Access Restriction Bypass in kube-apiserver
  A vulnerability in Kubernetes `kube-apiserver` could allow node updates to bypass a _Validating Admission Webhook_ and allow unauthorized node updates. The information that is provided to the admission controller could contain old configurations that overwrite values used for validation. Since the overwriting takes place before the validation, this could lead the admission controller to accept requests that should be blocked. The vulnerability can be exploited when an update action on node resources is performed and an admission controller is in place and configured to validate the action.

  Users are only affected by this vulnerability if they are running a _Validating Admission Webhook_ for Nodes that denies admission based partially on the old state of the Node object. It only impacts validating admission plugins that rely on old values in certain fields and does not impact calls from kubelets that go through the built-in NodeRestriction admission plugin.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-g42g-737j-qx6j/GHSA-g42g-737j-qx6j.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
  - CWE-284
  - CWE-372
references:
  - url: https://github.com/kubernetes/kubernetes
    reference_type:
    reference_id:
  - url: https://github.com/kubernetes/kubernetes/commit/00e81db174ef7aca497be5f42d87e46d14df2a90
    reference_type:
    reference_id:
  - url: https://github.com/kubernetes/kubernetes/issues/100096
    reference_type:
    reference_id:
  - url: https://github.com/kubernetes/kubernetes/pull/99946
    reference_type:
    reference_id:
  - url: https://groups.google.com/g/kubernetes-security-announce/c/FKAGqT4jx9Y
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/k8s.io/kubernetes@v1.23.5/cmd/kube-apiserver
    reference_type:
    reference_id:
  - url: https://sysdig.com/blog/cve-2021-25735-kubernetes-admission-bypass
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1937562
    reference_type: bug
    reference_id: '1937562'
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-25735
    reference_type:
    reference_id: CVE-2021-25735
