advisory_id: GHSA-p3r5-x3hr-gpg5
datasource_id: github_osv_importer_v2/GHSA-p3r5-x3hr-gpg5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-p3r5-x3hr-gpg5/GHSA-p3r5-x3hr-gpg5.json
aliases:
  - CVE-2023-41887
summary: "OpenRefine Remote Code execution in project import with mysql jdbc url attack\n###\
  \ Summary\nAn remote Code exec vulnerability allows any unauthenticated user to exec code\
  \ on the server.\n\n### Details\nHi,Team,\ni find openrefine support to import data from database,When\
  \ use mysql jdbc to connect to database,It is vulnerable to jdbc url attacks,for example,unauthenticated\
  \ attacker can get rce on the server through the mysql userializable If the mysql-connector-java\
  \ version used on the server side is less than 8.20.\nIn order for the server to enable deserialization\
  \ we need to set the `autoDeserialize` and `queryInterceptors` parameters in the connection\
  \ string,As same with https://github.com/OpenRefine/OpenRefine/security/advisories/GHSA-qqh2-wvmv-h72m,\
  \ since the concatenation string is a direct concatenation, it is possible to inject the required\
  \ parameters after the other parameters.\n![image](https://user-images.githubusercontent.com/24366795/262581108-e98dfe16-ee67-463f-8c49-7c318bf0d6f3.png)\n\
  \nAnd there is a commons-beanutils dependency library on the server side, which contains an\
  \ RCE-capable deserialization exploit chain\n\n### PoC\nenv:\ncentos 7\nopenrefine 3.7.4\n\
  jdk11\nmysql-connector-java version 8.14.0\nyou can use the tool https://github.com/4ra1n/mysql-fake-server\
  \ to running a malicious mysql server.    \nfor example use the CB 1.9 Gadget to exec command\
  \ `touch /tmp/hacked`.  \n![image](https://user-images.githubusercontent.com/24366795/262583287-7351a00a-32bf-4cb3-8d86-65ff0a112360.png)\
  \  \nset the `user` to `base64ZGVzZXJfQ0JfdG91Y2ggL3RtcC9oYWNrZWQ=`(`touch /tmp/hacked` base64\
  \ encode),`dataBaseName` to `test?autoDeserialize=true&queryInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor#`.\
  \  \n![image](https://user-images.githubusercontent.com/24366795/262583657-9cfb9caa-02ed-4f6b-b110-650108803172.png)\n\
  ![image](https://user-images.githubusercontent.com/24366795/262583815-a17d5530-bae8-4b4f-9392-4ea41b328c7d.png)\
  \  \n command `touch /tmp/hacked` is executed.  \n![image](https://user-images.githubusercontent.com/24366795/262583979-823d5843-578f-4af6-b84f-a1422aa1b863.png)\n\
  \n### Impact\nAn remote Code exec vulnerability allows any unauthenticated user to exec code\
  \ on the server."
impacted_packages:
  - purl: pkg:maven/org.openrefine/database
    affected_versions: vers:maven/<=3.7.4
    fixed_versions: vers:maven/3.7.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-p3r5-x3hr-gpg5/GHSA-p3r5-x3hr-gpg5.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/OpenRefine/OpenRefine
    reference_type:
    reference_id:
  - url: https://github.com/OpenRefine/OpenRefine/commit/693fde606d4b5b78b16391c29d110389eb605511
    reference_type:
    reference_id:
  - url: https://github.com/OpenRefine/OpenRefine/security/advisories/GHSA-p3r5-x3hr-gpg5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41887
    reference_type:
    reference_id: CVE-2023-41887
