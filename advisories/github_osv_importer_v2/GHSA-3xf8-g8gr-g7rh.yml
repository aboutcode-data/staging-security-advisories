advisory_id: GHSA-3xf8-g8gr-g7rh
datasource_id: github_osv_importer_v2/GHSA-3xf8-g8gr-g7rh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-3xf8-g8gr-g7rh/GHSA-3xf8-g8gr-g7rh.json
aliases:
  - CVE-2024-24823
summary: |
  Graylog session fixation vulnerability through cookie injection
  ### Impact
  Reauthenticating with an existing session cookie would re-use that session id, even if for different user credentials.
  In this case, the pre-existing session could be used to gain elevated access to an existing Graylog login session, provided the malicious user could successfully inject their session cookie into someone else's browser.

  The complexity of such an attack is high, because it requires presenting a spoofed login screen and injection of a session cookie into an existing browser, potentially through an XSS attack. No such attack has been discovered.

  ### Patches
  Graylog 5.1.11 and 5.2.4, and any versions of the 6.0 development branch contain patches to not re-use sessions under any circumstances, making this type of attack impossible.

  ### Workarounds
  Using short session expiration and explicit log outs of unused sessions can help limiting the attack vector. Unpatched this vulnerability exists, but is relatively hard to exploit.
  A proxy could be leveraged to clear the `authentication` cookie for the Graylog server URL for the `/api/system/sessions` endpoint, as that is the only one vulnerable.

  Analysis provided by Fabian Yamaguchi - Whirly Labs (Pty) Ltd
impacted_packages:
  - purl: pkg:maven/org.graylog2/graylog2-server
    affected_versions: vers:maven/>=4.3.0|<5.1.11
    fixed_versions: vers:maven/5.1.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.graylog2/graylog2-server
    affected_versions: vers:maven/>=5.2.0-alpha.1|<5.2.4
    fixed_versions: vers:maven/5.2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-3xf8-g8gr-g7rh/GHSA-3xf8-g8gr-g7rh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-384
references:
  - url: https://github.com/Graylog2/graylog2-server
    reference_type:
    reference_id:
  - url: https://github.com/Graylog2/graylog2-server/commit/1596b749db86368ba476662f23a0f0c5ec2b5097
    reference_type:
    reference_id:
  - url: https://github.com/Graylog2/graylog2-server/commit/b93a66353f35a94a4e8f3f75ac4f5cdc5a2d4a6a
    reference_type:
    reference_id:
  - url: https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-3xf8-g8gr-g7rh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-24823
    reference_type:
    reference_id: CVE-2024-24823
