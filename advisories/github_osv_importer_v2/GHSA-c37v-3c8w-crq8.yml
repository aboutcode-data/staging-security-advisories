advisory_id: GHSA-c37v-3c8w-crq8
datasource_id: github_osv_importer_v2/GHSA-c37v-3c8w-crq8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-c37v-3c8w-crq8/GHSA-c37v-3c8w-crq8.json
aliases:
  - CVE-2025-48374
summary: |
  zot logs secrets
  ### Summary
  When using Keycloak as an oidc provider, the clientsecret gets printed into the container stdout logs for an example at container startup.

  ### Details
  Container Image (15.04.2025): ghcr.io/project-zot/zot-linux-amd64:latest
  Here is an example how the configuration can look which causes the above stated problem:

  `    http:
        address: "0.0.0.0"
        port: 5000
        externalUrl: "https://zot.example.com"
        auth: {
          failDelay: 1,
          openid: {
            providers: {
              oidc: {
                name: "Keycloak",
                clientid: "zot-client-id",
                clientsecret: fsdfkmmiwljasdklfsjaskldjfkljewijrf234i52k3j45l,
                keypath: "",
                issuer: "https://keycloak.example.com/realms/example",
                scopes: ["openid"]
              }
            }
          }
        }
  `

  ### PoC
  Set up a blank new zot k8s deployment with the code snippet above.

  ### Impact
  exposure of secrets, on configuring a oidc provider
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-c37v-3c8w-crq8/GHSA-c37v-3c8w-crq8.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: https://github.com/project-zot/zot
    reference_type:
    reference_id:
  - url: https://github.com/project-zot/zot/commit/8a99a3ed231fdcd8467e986182b4705342b6a15e
    reference_type:
    reference_id:
  - url: https://github.com/project-zot/zot/security/advisories/GHSA-c37v-3c8w-crq8
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3705
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-48374
    reference_type:
    reference_id: CVE-2025-48374
