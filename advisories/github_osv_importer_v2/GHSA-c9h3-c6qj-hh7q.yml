advisory_id: GHSA-c9h3-c6qj-hh7q
datasource_id: github_osv_importer_v2/GHSA-c9h3-c6qj-hh7q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-c9h3-c6qj-hh7q/GHSA-c9h3-c6qj-hh7q.json
aliases:
  - CVE-2022-34917
summary: |
  Apache Kafka vulnerability can lead to brokers hitting OutOfMemoryException, causing Denial of Service
  A security vulnerability has been identified in Apache Kafka. It affects all releases since 2.8.0. The vulnerability allows malicious unauthenticated clients to allocate large amounts of memory on brokers. This can lead to brokers hitting OutOfMemoryException and causing denial of service. Example scenarios: - Kafka cluster without authentication: Any clients able to establish a network connection to a broker can trigger the issue. - Kafka cluster with SASL authentication: Any clients able to establish a network connection to a broker, without the need for valid SASL credentials, can trigger the issue. - Kafka cluster with TLS authentication: Only clients able to successfully authenticate via TLS can trigger the issue. We advise the users to upgrade the Kafka installations to one of the 3.2.3, 3.1.2, 3.0.2, 2.8.2 versions.
impacted_packages:
  - purl: pkg:maven/org.apache.kafka/kafka
    affected_versions: vers:maven/>=2.8.0|<2.8.2
    fixed_versions: vers:maven/2.8.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.kafka/kafka
    affected_versions: vers:maven/>=3.0.0|<3.0.2
    fixed_versions: vers:maven/3.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.kafka/kafka
    affected_versions: vers:maven/>=3.1.0|<3.1.2
    fixed_versions: vers:maven/3.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.kafka/kafka
    affected_versions: vers:maven/>=3.2.0|<3.2.3
    fixed_versions: vers:maven/3.2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-c9h3-c6qj-hh7q/GHSA-c9h3-c6qj-hh7q.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
  - CWE-789
  - CWE-400
references:
  - url: https://github.com/apache/kafka/commit/14951a83e3fdead212156e5532359500d72f68bc
    reference_type:
    reference_id:
  - url: https://github.com/apache/kafka/commit/2bfa24b2bd416e7b8c4a0c566b984c43904fdecb
    reference_type:
    reference_id:
  - url: https://github.com/apache/kafka/commit/aaceb6b79bfcb1d32874ccdbc8f3138d1c1c00fb
    reference_type:
    reference_id:
  - url: https://github.com/apache/kafka/commit/c1295662768e64b4467e27c3d5158f95f2307657
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/KAFKA-14063
    reference_type:
    reference_id:
  - url: https://kafka.apache.org/cve-list
    reference_type:
    reference_id:
  - url: https://kafka.apache.org/cve-list#CVE-2022-34917
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-34917
    reference_type:
    reference_id: CVE-2022-34917
