advisory_id: GHSA-x462-89pf-6r5h
datasource_id: github_osv_importer_v2/GHSA-x462-89pf-6r5h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-x462-89pf-6r5h/GHSA-x462-89pf-6r5h.json
aliases:
  - CVE-2021-21404
summary: |
  Crash due to malformed relay protocol message
  ### Impact

  1. `syncthing` can be caused to crash and exit if sent a malformed relay
     protocol message message with a negative length field.

  2. The relay server `strelaysrv` can be caused to crash and exit if sent
     a malformed relay protocol message with a negative length field.

  At no point is sensitive data exposed or liable to be altered due to this
  issue. Sensitive data is never exposed to relay operators. Syncthing itself
  would need to be lured to connect to a malicious relay server in order to
  exploit the issue.

  ### Patches

  Fixed in version 1.15.0.

  ### Workarounds

  1. No known workaround for `strelaysrv`.

  2. `syncthing` can be configured to not use relays, or to only use specific,
     trusted relays. If Syncthing is used in a closed environment or with
     relaying disabled, i.e., it does not communicate with unknown relays,
     Syncthing is not vulnerable.

  ### For more information

  If you have any questions or comments about this advisory, please discuss it [on the forum](https://forum.syncthing.net/).

  Thanks to Wojciech Paciorek for discovering and reporting this issue.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-x462-89pf-6r5h/GHSA-x462-89pf-6r5h.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/syncthing/syncthing/commit/fb4fdaf4c0a79c22cad000c42ac1394e3ccb6a97
    reference_type:
    reference_id:
  - url: https://github.com/syncthing/syncthing/releases/tag/v1.15.0
    reference_type:
    reference_id:
  - url: https://github.com/syncthing/syncthing/security/advisories/GHSA-x462-89pf-6r5h
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/github.com/syncthing/syncthing
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21404
    reference_type:
    reference_id: CVE-2021-21404
