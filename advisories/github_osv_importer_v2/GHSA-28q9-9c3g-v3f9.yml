advisory_id: GHSA-28q9-9c3g-v3f9
datasource_id: github_osv_importer_v2/GHSA-28q9-9c3g-v3f9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-28q9-9c3g-v3f9/GHSA-28q9-9c3g-v3f9.json
aliases: []
summary: |
  lakeFS vulnerable to authenticated users deleting files they are not authorized to delete
  ### Impact

  Authenticated users can send a request to delete-objects through the s3 gateway and delete files they are not authorized to delete.

  ### Patches

  lakeFS v0.82.0 and later

  ### Workarounds

  Drop specific request to the lakeFS listen port. Any request with "Authorization" header and value that starts with "AWS".

  ### References

  [advisories/GHSA-28q9-9c3g-v3f9](https://github.com/treeverse/lakeFS/security/advisories/GHSA-28q9-9c3g-v3f9)

  ### For more information
  If you have any questions or comments about this advisory:

  Ask on the [lakeFS Slack](https://github.com/treeverse/lakeFS/security/advisories/lakefs.io/slack) #help channel
  Email us at [security@treeverse.io](mailto:security@treeverse.io)
impacted_packages: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-281
  - CWE-284
references:
  - url: https://github.com/treeverse/lakeFS
    reference_type:
    reference_id:
  - url: https://github.com/treeverse/lakeFS/commit/81182bf9c0cf57f3cec3c893cf739b2069305e37
    reference_type:
    reference_id:
  - url: https://github.com/treeverse/lakeFS/security/advisories/GHSA-28q9-9c3g-v3f9
    reference_type:
    reference_id:
