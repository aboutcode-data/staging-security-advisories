advisory_id: GHSA-cwwm-hr97-qfxm
datasource_id: github_osv_importer_v2/GHSA-cwwm-hr97-qfxm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-cwwm-hr97-qfxm/GHSA-cwwm-hr97-qfxm.json
aliases:
  - CVE-2025-49011
summary: "SpiceDB checks involving relations with caveats can result in no permission when permission\
  \ is expected\n### Impact\n\nOn schemas involving arrows with caveats on the arrow’ed relation,\
  \ when the path to resolve a CheckPermission request involves the evaluation of multiple caveated\
  \ branches, requests may return a negative response when a positive response is expected.\n\
  \nFor example, given this schema:\n\n```\ndefinition user {}\n\ndefinition office {\n\trelation\
  \ parent: office\n\trelation manager: user\n\tpermission read = manager + parent->read\n}\n\
  \ndefinition group {\n\trelation parent: office\n\tpermission read = parent->read\n}\n\ndefinition\
  \ document {\n\trelation owner: group with equals\n\tpermission read = owner->read\n}\n\n\
  caveat equals(actual string, required string) {\n\tactual == required\n}\n```\n\nand these\
  \ relationships:\n\n```\noffice:headoffice#manager@user:maria\noffice:branch1#parent@office:headoffice\n\
  group:admins#parent@office:branch1\ngroup:managers#parent@office:headoffice\ndocument:budget#owner@group:admins[equals:{\"\
  required\":\"admin\"}]\ndocument:budget#owner@group:managers[equals:{\"required\":\"manager\"\
  }]\n```\n\nPermission for `'document:budget#read@user:maria with {\"actual\" : \"admin\"}'`\
  \ is returned as NO_PERMISSION when HAS_PERMISSION is the correct answer.\n\n### Patches\n\
  Upgrade to v1.44.2.\n\n### Workarounds\nDo not use caveats in your schema over an arrow’ed\
  \ relation."
impacted_packages: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-cwwm-hr97-qfxm/GHSA-cwwm-hr97-qfxm.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-358
references:
  - url: https://github.com/authzed/spicedb
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/commit/fe8dd9f491f6975b3408c401e413a530eb181a67
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/releases/tag/v1.44.2
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/security/advisories/GHSA-cwwm-hr97-qfxm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49011
    reference_type:
    reference_id: CVE-2025-49011
