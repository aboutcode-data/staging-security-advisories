advisory_id: GHSA-ppf9-4ffw-hh4p
datasource_id: github_osv_importer_v2/GHSA-ppf9-4ffw-hh4p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-ppf9-4ffw-hh4p/GHSA-ppf9-4ffw-hh4p.json
aliases:
  - CVE-2026-27191
summary: |
  Feathers has an open redirect in OAuth callback enables account takeover
  ### Description

  The `redirect` query parameter is appended to the base origin without validation, allowing attackers to steal access tokens via URL authority injection. This leads to full account takeover, as the attacker obtains the victim's access token and can impersonate them.

  The application constructs the final redirect URL by concatenating the base origin with the user-supplied `redirect` parameter:
  ```javascript
  // https://github.com/feathersjs/feathers/blob/dove/packages/authentication-oauth/src/service.ts#L158C3-L176C4
  const { redirect } = query;
  ...
  session.redirect = redirect;

  // https://github.com/feathersjs/feathers/blob/dove/packages/authentication-oauth/src/strategy.ts#L98
  const redirectUrl = `${redirect}${queryRedirect}`;
  ```

  Where:
  - `redirect` = base origin from config (e.g., `https://target.com`)
  - `queryRedirect` = user input from `?redirect=` parameter

  This is exploitable when the `origins` array is configured and origin values do not end with `/`.  An attacker can supply `@attacker.com` as the redirect value results in `https://target.com@attacker.com#access_token=...`, where the browser interprets `attacker.com` as the host, leading to full account takeover.

  **Credits**:  Abdelwahed Madani Yousfi (@vvxhid) / Edoardo Geraci (@b0-n0-b0) / Thomas Rinsma (@ThomasRinsma) From Codean Labs.
impacted_packages:
  - purl: pkg:npm/%40feathersjs/authentication-oauth
    affected_versions: vers:npm/<=5.0.39
    fixed_versions: vers:npm/5.0.40
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:P/PR:N/UI:A/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-ppf9-4ffw-hh4p/GHSA-ppf9-4ffw-hh4p.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/feathersjs/feathers
    reference_type:
    reference_id:
  - url: https://github.com/feathersjs/feathers/commit/ee19a0ae9bc2ebf23b1fe598a1f7361981b65401
    reference_type:
    reference_id:
  - url: https://github.com/feathersjs/feathers/releases/tag/v5.0.40
    reference_type:
    reference_id:
  - url: https://github.com/feathersjs/feathers/security/advisories/GHSA-ppf9-4ffw-hh4p
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-27191
    reference_type:
    reference_id: CVE-2026-27191
