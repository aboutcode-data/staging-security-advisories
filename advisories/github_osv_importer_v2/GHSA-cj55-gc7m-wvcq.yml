advisory_id: GHSA-cj55-gc7m-wvcq
datasource_id: github_osv_importer_v2/GHSA-cj55-gc7m-wvcq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-cj55-gc7m-wvcq/GHSA-cj55-gc7m-wvcq.json
aliases:
  - CVE-2024-45258
summary: |
  req may send an unintended request when a malformed URL is provided
  The `req` library is a widely used HTTP library in Go. However, it does not handle malformed URLs effectively. As a result, after parsing a malformed URL, the library may send HTTP requests to unexpected destinations, potentially leading to security vulnerabilities or unintended behavior in applications relying on this library for handling HTTP requests.

  Despite developers potentially utilizing the `net/url` library to parse malformed URLs and implement blocklists to prevent HTTP requests to listed URLs, inconsistencies exist between how the `net/url` and `req` libraries parse URLs. These discrepancies can lead to the failure of defensive strategies, resulting in potential security threats such as Server-Side Request Forgery (SSRF) and Remote Code Execution (RCE).
impacted_packages: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-cj55-gc7m-wvcq/GHSA-cj55-gc7m-wvcq.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-cj55-gc7m-wvcq/GHSA-cj55-gc7m-wvcq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-918
  - CWE-94
references:
  - url: https://github.com/imroc/req
    reference_type:
    reference_id:
  - url: https://github.com/imroc/req/commit/04e3ece5b380ecad9da3551c449f1b8a9aa76d3d
    reference_type:
    reference_id:
  - url: https://github.com/imroc/req/compare/v3.43.3...v3.43.4
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3098
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45258
    reference_type:
    reference_id: CVE-2024-45258
