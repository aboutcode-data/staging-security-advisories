advisory_id: GHSA-qh58-9v3j-wcjc
datasource_id: github_osv_importer_v2/GHSA-qh58-9v3j-wcjc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-qh58-9v3j-wcjc/GHSA-qh58-9v3j-wcjc.json
aliases:
  - CVE-2025-4981
summary: |
  Mattermost allows authenticated users to write files to arbitrary locations
  Mattermost versions 10.5.x <= 10.5.5, 9.11.x <= 9.11.15, 10.8.x <= 10.8.0, 10.7.x <= 10.7.2, 10.6.x <= 10.6.5 fail to sanitize filenames in the archive extractor which allows authenticated users to write files to arbitrary locations on the filesystem via uploading archives with path traversal sequences in filenames, potentially leading to remote code execution. The vulnerability impacts instances where file uploads and document search by content is enabled (FileSettings.EnableFileAttachments = true and FileSettings.ExtractContent = true). These configuration settings are enabled by default.
impacted_packages: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-qh58-9v3j-wcjc/GHSA-qh58-9v3j-wcjc.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-427
references:
  - url: https://github.com/mattermost/mattermost
    reference_type:
    reference_id:
  - url: https://github.com/mattermost/mattermost/commit/65aec10162f612d98edf91cc66bf7e781868448b
    reference_type:
    reference_id:
  - url: https://mattermost.com/security-updates
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-4981
    reference_type:
    reference_id: CVE-2025-4981
