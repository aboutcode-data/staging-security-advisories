advisory_id: GHSA-3jgf-r68h-xfqm
datasource_id: github_osv_importer_v2/GHSA-3jgf-r68h-xfqm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-3jgf-r68h-xfqm/GHSA-3jgf-r68h-xfqm.json
aliases:
  - CVE-2024-34478
summary: |
  btcd susceptible to consensus failures
  btcd before 0.24.0 does not correctly implement the consensus rules outlined in BIP 68 and BIP 112, making it susceptible to consensus failures. Specifically, it uses the transaction version as a signed integer when it is supposed to be treated as unsigned. There can be a chain split and loss of funds.
impacted_packages: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-436
references:
  - url: https://delvingbitcoin.org/t/disclosure-btcd-consensus-bugs-due-to-usage-of-signed-transaction-version/455
    reference_type:
    reference_id:
  - url: https://github.com/btcsuite/btcd
    reference_type:
    reference_id:
  - url: https://github.com/btcsuite/btcd/blob/e4c88c3a3ecb1813529bf3dddc7a865bd418a6b8/blockchain/chain.go#L383C1-L392C3
    reference_type:
    reference_id:
  - url: https://github.com/btcsuite/btcd/blob/e4c88c3a3ecb1813529bf3dddc7a865bd418a6b8/txscript/opcode.go#L1172C1-L1178C3
    reference_type:
    reference_id:
  - url: https://github.com/btcsuite/btcd/commit/253b688c68b89eca7eb75d4d5443dbdbc928db3c
    reference_type:
    reference_id:
  - url: https://github.com/btcsuite/btcd/pull/1981
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-2818
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-34478
    reference_type:
    reference_id: CVE-2024-34478
