advisory_id: GHSA-q98f-2x4p-prjr
datasource_id: github_osv_importer_v2/GHSA-q98f-2x4p-prjr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-q98f-2x4p-prjr/GHSA-q98f-2x4p-prjr.json
aliases:
  - CVE-2022-24797
summary: |
  Exposure of debug and metrics endpoints in Pomerium
  ### Impact
  In distributed service mode, Pomerium's Authenticate service exposes pprof debug and prometheus metrics handlers to untrusted traffic.  This can leak potentially sensitive environmental information or lead to limited denial of service conditions.

  ### Patches
  v0.17.1

  ### Workarounds
  Block access to `/debug` and `/metrics` paths on the authenticate service.  This can be done with any L7 proxy, including Pomerium's own proxy service.

  ### References
  https://github.com/pomerium/pomerium/pull/3212

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [Pomerium](https://github.com/pomerium/pomerium)
  * Email us at [security@pomerium.com](mailto:security@pomerium.com)
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-q98f-2x4p-prjr/GHSA-q98f-2x4p-prjr.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:N/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-q98f-2x4p-prjr/GHSA-q98f-2x4p-prjr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/pomerium/pomerium
    reference_type:
    reference_id:
  - url: https://github.com/pomerium/pomerium/commit/b435f73e2b54088da2aca5e8c3aa1808293d6903
    reference_type:
    reference_id:
  - url: https://github.com/pomerium/pomerium/pull/3212
    reference_type:
    reference_id:
  - url: https://github.com/pomerium/pomerium/security/advisories/GHSA-q98f-2x4p-prjr
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-0413
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24797
    reference_type:
    reference_id: CVE-2022-24797
