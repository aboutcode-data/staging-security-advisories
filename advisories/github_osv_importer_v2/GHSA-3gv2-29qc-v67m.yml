advisory_id: GHSA-3gv2-29qc-v67m
datasource_id: github_osv_importer_v2/GHSA-3gv2-29qc-v67m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-3gv2-29qc-v67m/GHSA-3gv2-29qc-v67m.json
aliases:
  - CVE-2022-24895
summary: |
  Symfony vulnerable to Session Fixation of CSRF tokens
  Description
  -----------

  When authenticating users Symfony by default regenerates the session ID upon login, but preserves the rest of session attributes. Because this does not clear CSRF tokens upon login, this might enables [same-site attackers](https://canitakeyoursubdomain.name/) to bypass the CSRF protection mechanism by performing an attack similar to a session-fixation.

  Resolution
  ----------

  Symfony removes all CSRF tokens from the session on successful login.

  The patch for this issue is available [here](https://github.com/symfony/symfony/commit/5909d74ecee359ea4982fcf4331aaf2e489a1fd4) for branch 4.4.

  Credits
  -------

  We would like to thank Marco Squarcina for reporting the issue and Nicolas Grekas for fixing it.
impacted_packages:
  - purl: pkg:composer/symfony/security-bundle
    affected_versions: vers:composer/>=2.0.0|<4.4.50
    fixed_versions: vers:composer/4.4.50
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/security-bundle
    affected_versions: vers:composer/>=5.0.0|<5.4.20
    fixed_versions: vers:composer/5.4.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/security-bundle
    affected_versions: vers:composer/>=6.0.0|<6.0.20
    fixed_versions: vers:composer/6.0.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/security-bundle
    affected_versions: vers:composer/>=6.1.0|<6.1.12
    fixed_versions: vers:composer/6.1.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/security-bundle
    affected_versions: vers:composer/>=6.2.0|<6.2.6
    fixed_versions: vers:composer/6.2.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=2.0.0|<4.4.50
    fixed_versions: vers:composer/4.4.50
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=5.0.0|<5.4.20
    fixed_versions: vers:composer/5.4.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=6.0.0|<6.0.20
    fixed_versions: vers:composer/6.0.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=6.1.0|<6.1.12
    fixed_versions: vers:composer/6.1.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=6.2.0|<6.2.6
    fixed_versions: vers:composer/6.2.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-3gv2-29qc-v67m/GHSA-3gv2-29qc-v67m.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-384
  - CWE-613
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/security-bundle/CVE-2022-24895.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2022-24895.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/security-bundle/commit/076fd2088ada33d760758d98ff07ddedbf567946
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/5909d74ecee359ea4982fcf4331aaf2e489a1fd4
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/security/advisories/GHSA-3gv2-29qc-v67m
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/07/msg00014.html
    reference_type:
    reference_id:
  - url: https://symfony.com/cve-2022-24895
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24895
    reference_type:
    reference_id: CVE-2022-24895
