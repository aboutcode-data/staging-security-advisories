advisory_id: GHSA-rhm7-7469-rcpw
datasource_id: github_osv_importer_v2/GHSA-rhm7-7469-rcpw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-rhm7-7469-rcpw/GHSA-rhm7-7469-rcpw.json
aliases:
  - CVE-2024-43372
summary: |
  Persistent Cross-site Scripting in eZ Platform Rich Text Field Type
  ### Impact
  The validator for the RichText fieldtype blocklists `javascript:` and `vbscript:` in links to prevent XSS. This can leave other options open, and the check can be circumvented using upper case. Content editing permissions for RichText content is required to exploit this vulnerability, which typically means Editor role or higher. The fix implements an allowlist instead, which allows only approved link protocols. The new check is case insensitive.

  ### Patches
  - See "Patched versions".
  - https://github.com/ezsystems/ezplatform-richtext/commit/6131975108fa9756e17043e7a06a4e72f786f842 (and follow-ups https://github.com/ezsystems/ezplatform-richtext/commit/8b75c603dfd1ad6f6f3db15ae2324876683cbaf9 and https://github.com/ezsystems/ezplatform-richtext/commit/7bbc6d024c6146d1e1ba84d27a3ebffe9459613e and https://github.com/ezsystems/ezplatform-richtext/commit/2c652915625c47b493a2be06924f4c87d1df7d8e and https://github.com/ezsystems/ezplatform-richtext/commit/dbe816f3ff4c903cc508dfdcdca8791c8284d292)

  ### Workarounds
  None.

  ### References
  - Same issue in v4.6: https://github.com/ibexa/fieldtype-richtext/security/advisories/GHSA-hvcf-6324-cjh7
  - Ibexa advisory: https://developers.ibexa.co/security-advisories/ibexa-sa-2024-005-persistent-xss-in-richtext

  ### Credit
  This vulnerability was discovered and reported to Ibexa by Alec Romano: https://github.com/4rdr
  We thank them for reporting it responsibly to us.

  How to report security issues:
  https://doc.ibexa.co/en/latest/infrastructure_and_maintenance/security/reporting_issues/
impacted_packages:
  - purl: pkg:composer/ezsystems/ezplatform-richtext
    affected_versions: vers:composer/>=3.3.0|<3.3.40
    fixed_versions: vers:composer/3.3.40
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://developers.ibexa.co/security-advisories/ibexa-sa-2024-005-persistent-xss-in-richtext
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/commit/2c652915625c47b493a2be06924f4c87d1df7d8e
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/commit/6131975108fa9756e17043e7a06a4e72f786f842
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/commit/7bbc6d024c6146d1e1ba84d27a3ebffe9459613e
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/commit/8b75c603dfd1ad6f6f3db15ae2324876683cbaf9
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/commit/dbe816f3ff4c903cc508dfdcdca8791c8284d292
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/security/advisories/GHSA-rhm7-7469-rcpw
    reference_type:
    reference_id:
  - url: https://github.com/ibexa/fieldtype-richtext/security/advisories/GHSA-hvcf-6324-cjh7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43369
    reference_type:
    reference_id: CVE-2024-43369
