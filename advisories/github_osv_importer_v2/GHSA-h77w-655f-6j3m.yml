advisory_id: GHSA-h77w-655f-6j3m
datasource_id: github_osv_importer_v2/GHSA-h77w-655f-6j3m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-h77w-655f-6j3m/GHSA-h77w-655f-6j3m.json
aliases:
  - CVE-2020-9309
summary: |
  Silverstripe CMS malicious file upload enables script execution
  Silverstripe CMS through 4.5 can be susceptible to script execution from malicious upload contents under allowed file extensions (for example HTML code in a TXT file). When these files are stored as protected or draft files, the MIME detection can cause browsers to execute the file contents. Uploads stored as protected or draft files are allowed by default for authorised users only, but can also be enabled through custom logic as well as modules such as silverstripe/userforms. Sites using the previously optional silverstripe/mimevalidator module can configure MIME whitelists rather than extension whitelists, and hence prevent this issue. Sites on the Common Web Platform (CWP) use this module by default, and are not affected.
impacted_packages:
  - purl: pkg:composer/silverstripe/cms
    affected_versions: vers:composer/<=4.5.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-h77w-655f-6j3m/GHSA-h77w-655f-6j3m.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://github.com/silverstripe/silverstripe-cms
    reference_type:
    reference_id:
  - url: https://www.silverstripe.org/download/security-releases/CVE-2020-9309
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-9309
    reference_type:
    reference_id: CVE-2020-9309
