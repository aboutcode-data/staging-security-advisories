advisory_id: GHSA-c6qr-h5vq-59jc
datasource_id: github_osv_importer_v2/GHSA-c6qr-h5vq-59jc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/06/GHSA-c6qr-h5vq-59jc/GHSA-c6qr-h5vq-59jc.json
aliases:
  - CVE-2020-8185
summary: |
  Untrusted users can run pending migrations in production in Rails
  There is a vulnerability in versions of Rails prior to 6.0.3.2 that allowed an untrusted user to run any pending migrations on a Rails app running in production.

  This vulnerability has been assigned the CVE identifier CVE-2020-8185.

  Versions Affected:  6.0.0 < rails < 6.0.3.2
  Not affected:       Applications with `config.action_dispatch.show_exceptions = false` (this is not a default setting in production)
  Fixed Versions:     rails >= 6.0.3.2

  Impact
  ------

  Using this issue, an attacker would be able to execute any migrations that are pending for a Rails app running in production mode. It is important to note that an attacker is limited to running migrations the application developer has already defined in their application and ones that have not already run.

  Workarounds
  -----------

  Until such time as the patch can be applied, application developers should disable the ActionDispatch middleware in their production environment via a line such as this one in their config/environment/production.rb:

  `config.middleware.delete ActionDispatch::ActionableExceptions`
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/<=6.0.3.1
    fixed_versions: vers:gem/6.0.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/06/GHSA-c6qr-h5vq-59jc/GHSA-c6qr-h5vq-59jc.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/rails/rails/commit/2121b9d20b60ed503aa041ef7b926d331ed79fc2
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2020-8185.yml
    reference_type:
    reference_id:
  - url: https://groups.google.com/g/rubyonrails-security/c/pAe9EV8gbM0
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/899069
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XJ7NUWXAEVRQCROIIBV4C6WXO6IR3KSB
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-8185
    reference_type:
    reference_id: CVE-2020-8185
