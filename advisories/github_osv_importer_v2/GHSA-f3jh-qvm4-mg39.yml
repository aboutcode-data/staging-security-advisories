advisory_id: GHSA-f3jh-qvm4-mg39
datasource_id: github_osv_importer_v2/GHSA-f3jh-qvm4-mg39
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-f3jh-qvm4-mg39/GHSA-f3jh-qvm4-mg39.json
aliases:
  - CVE-2024-22257
summary: |
  Erroneous authentication pass in Spring Security
  In Spring Security, versions 5.7.x prior to 5.7.12, 5.8.x prior to 5.8.11, versions 6.0.x prior to 6.0.9, versions 6.1.x prior to 6.1.8, versions 6.2.x prior to 6.2.3, an application is possible vulnerable to broken access control when it directly uses the AuthenticatedVoter#vote passing a null Authentication parameter.

  Specifically, an application is vulnerable if:

  The application uses AuthenticatedVoter directly and a null authentication parameter is passed to it resulting in an erroneous true return value.

  An application is not vulnerable if any of the following is true:

  * The application does not use AuthenticatedVoter#vote directly.
  * The application does not pass null to AuthenticatedVoter#vote.

  Note that AuthenticatedVoter is deprecated since 5.8, use implementations of AuthorizationManager as a replacement.
impacted_packages:
  - purl: pkg:maven/org.springframework.security/spring-security-core
    affected_versions: vers:maven/<5.7.12
    fixed_versions: vers:maven/5.7.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.springframework.security/spring-security-core
    affected_versions: vers:maven/>=5.8.0|<5.8.11
    fixed_versions: vers:maven/5.8.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.springframework.security/spring-security-core
    affected_versions: vers:maven/>=6.0.0|<6.1.8
    fixed_versions: vers:maven/6.1.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.springframework.security/spring-security-core
    affected_versions: vers:maven/>=6.2.0|<6.2.3
    fixed_versions: vers:maven/6.2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-f3jh-qvm4-mg39/GHSA-f3jh-qvm4-mg39.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
  - CWE-287
references:
  - url: https://github.com/spring-projects/spring-security
    reference_type:
    reference_id:
  - url: https://github.com/spring-projects/spring-security/commit/5a7f12f1a9fdb4edaab6f61495f1d781a7273b61
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240419-0005
    reference_type:
    reference_id:
  - url: https://spring.io/security/cve-2024-22257
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22257
    reference_type:
    reference_id: CVE-2024-22257
