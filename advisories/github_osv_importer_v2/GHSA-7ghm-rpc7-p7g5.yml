advisory_id: GHSA-7ghm-rpc7-p7g5
datasource_id: github_osv_importer_v2/GHSA-7ghm-rpc7-p7g5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7ghm-rpc7-p7g5/GHSA-7ghm-rpc7-p7g5.json
aliases:
  - CVE-2013-2115
summary: |
  Code injection in Apache Struts
  A vulnerability introduced by forcing parameter inclusion in the URL and Anchor Tag allows remote command execution, session access and manipulation and XSS attacks.

  both the s:url and s:a tag provide an includeParams attribute.

  The main scope of that attribute is to understand whether includes http request parameter or not.

  The allowed values of includeParams are:

      none - include no parameters in the URL (default)
      get - include only GET parameters in the URL
      all - include both GET and POST parameters in the URL

  A request that included a specially crafted request parameter could be used to inject arbitrary OGNL code into the stack, afterward used as request parameter of an URL or A tag , which will cause a further evaluation.

  The second evaluation happens when the URL/A tag tries to resolve every parameters present in the original request.
  This lets malicious users put arbitrary OGNL statements into any request parameter (not necessarily managed by the code) and have it evaluated as an OGNL expression to enable method execution and execute arbitrary methods, bypassing Struts and OGNL library protections.

  The issue was originally addressed by Struts 2.3.14.1 and Security Announcement [S2-013](https://cwiki.apache.org/confluence/display/WW/S2-013). However, the solution introduced with 2.3.14.1 did not address all possible attack vectors, such that every version of Struts 2 before 2.3.14.2 is still vulnerable to such attacks.
impacted_packages:
  - purl: pkg:maven/org.apache.struts/struts2-core
    affected_versions: vers:maven/>=2.0.0|<2.3.14.2
    fixed_versions: vers:maven/2.3.14.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.struts.xwork/xwork-core
    affected_versions: vers:maven/>=2.0.0|<2.3.14.2
    fixed_versions: vers:maven/2.3.14.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7ghm-rpc7-p7g5/GHSA-7ghm-rpc7-p7g5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=967656
    reference_type:
    reference_id:
  - url: https://cwiki.apache.org/confluence/display/WW/S2-013
    reference_type:
    reference_id:
  - url: https://cwiki.apache.org/confluence/display/WW/S2-014
    reference_type:
    reference_id:
  - url: https://github.com/apache/struts
    reference_type:
    reference_id:
  - url: https://github.com/apache/struts/commit/d7804297e319c7a12245e1b536e565fcea6d650
    reference_type:
    reference_id:
  - url: https://github.com/apache/struts/commit/d934c6e7430b7b98e43a0a085a2304bd31a75c3d
    reference_type:
    reference_id:
  - url: https://github.com/apache/struts/commit/ea96d18d0f75c390d2595648efa3563785c272c6
    reference_type:
    reference_id:
  - url: https://github.com/apache/struts/commit/fed4f8e8a4ec69b5e7612b92d8ce3e476680474
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/WW-4063
    reference_type:
    reference_id:
  - url: http://struts.apache.org/development/2.x/docs/s2-014.html
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20140212000331/http://www.securityfocus.com/bid/60167
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2013-2115
    reference_type:
    reference_id: CVE-2013-2115
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/multiple/remote/25980.rb
    reference_type: exploit
    reference_id: CVE-2013-2115;OSVDB-93645;CVE-2013-1966
