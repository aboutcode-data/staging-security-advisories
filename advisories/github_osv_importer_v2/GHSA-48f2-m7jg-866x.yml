advisory_id: GHSA-48f2-m7jg-866x
datasource_id: github_osv_importer_v2/GHSA-48f2-m7jg-866x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-48f2-m7jg-866x/GHSA-48f2-m7jg-866x.json
aliases:
  - CVE-2022-29254
summary: |
  Failed payment recorded has completed in Silverstripe Omnipay
  ### Impact
  For a subset of Omnipay gateways (those that use intermediary states like `isNotification()` or `isRedirect()`), if the payment identifier or success URL is exposed it is possible for payments to be prematurely marked as completed without payment being taken. This is mitigated by the fact that most payment gateways hide this information from users, however some issuing banks offer flawed 3DSecure implementations that may inadvertently expose this data.

  ### Patches
  The following versions have been patched to fix this issue:

  - `2.5.2`
  - `3.0.2`
  - `3.1.4`
  - `3.2.1`

  ### Workarounds
  There are no known workarounds for this vulnerability.

  ### References
  N/A.

  ### For more information
  If you have any questions or comments about this advisory:
  * Email us at [security@silverstripe.org](mailto:security@silverstripe.org)
impacted_packages:
  - purl: pkg:composer/silverstripe/silverstripe-omnipay
    affected_versions: vers:composer/<2.5.2
    fixed_versions: vers:composer/2.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/silverstripe/silverstripe-omnipay
    affected_versions: vers:composer/>=3.0.0|<3.0.2
    fixed_versions: vers:composer/3.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/silverstripe/silverstripe-omnipay
    affected_versions: vers:composer/>=3.1.0|<3.1.4
    fixed_versions: vers:composer/3.1.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/silverstripe/silverstripe-omnipay
    affected_versions: vers:composer/>=3.2.0|<3.2.1
    fixed_versions: vers:composer/3.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-48f2-m7jg-866x/GHSA-48f2-m7jg-866x.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-436
  - CWE-437
references:
  - url: https://github.com/silverstripe/silverstripe-omnipay
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/commit/7dee9a1e0a5f54c2dc06e018cff3d9a19044e01b
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/releases/tag/2.5.2
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/releases/tag/3.0.2
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/releases/tag/3.1.4
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/releases/tag/3.2.1
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/security/advisories/GHSA-48f2-m7jg-866x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29254
    reference_type:
    reference_id: CVE-2022-29254
