advisory_id: GHSA-v8gg-4mq2-88q4
datasource_id: github_osv_importer_v2/GHSA-v8gg-4mq2-88q4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-v8gg-4mq2-88q4/GHSA-v8gg-4mq2-88q4.json
aliases:
  - CVE-2023-36472
summary: |
  Strapi may leak sensitive user information, user reset password, tokens via content-manager views
  ### Summary
  I can get access to user  reset password tokens if I have the configure view permissions
  ![b37a6fd9eae06027e7d91266f1908a3d](https://user-images.githubusercontent.com/34578426/246782921-fbc007d3-ffec-45de-a1f1-a4287cd507ac.png)
  ![6c1da5b3bfbb3bca97c8d064be0ecb05](https://user-images.githubusercontent.com/34578426/246783044-7d716dde-6f27-4d01-9521-42720c6ce92e.gif)

  ### Details
  /content-manager/relations route does not remove private fields or ensure that they can't be selected

  ### PoC
  Install fresh strapi instance
  start up strapi and create an account
  create a new content-type
  give the content-type a relation with admin users and save
  go to Admin panel roles Author and then plugins.
  Enable for content-manager collection types the configure view
  In the collection time now only give them access to the collection you created for this.
  Create a new admin user account with the Author role
  Log out and request a password reset for the main admin user.
  Login on the newly created account
  go to the collection type you created for this test and click the create new entry button,
  click in the create new entry view on configure view.
  select the admin user relation we created click on resetPasswordToken
  Now go back to the create an entry view and when selection the relation we created we now see the reset tokken

  ### Impact
  Impact is that the none admin user now has the reset token of the admin users account and can resets its password using that to escalate his privilege's

  Still you need the configure view permission to be able to escalate your privilege's
impacted_packages:
  - purl: pkg:npm/%40strapi/plugin-content-manager
    affected_versions: vers:npm/<4.11.7
    fixed_versions: vers:npm/4.11.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40strapi/admin
    affected_versions: vers:npm/<4.11.7
    fixed_versions: vers:npm/4.11.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40strapi/utils
    affected_versions: vers:npm/<4.11.7
    fixed_versions: vers:npm/4.11.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-v8gg-4mq2-88q4/GHSA-v8gg-4mq2-88q4.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/strapi/strapi
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/releases/tag/v4.11.7
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/security/advisories/GHSA-v8gg-4mq2-88q4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-36472
    reference_type:
    reference_id: CVE-2023-36472
