advisory_id: GHSA-257v-vj4p-3w2h
datasource_id: github_osv_importer_v2/GHSA-257v-vj4p-3w2h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-257v-vj4p-3w2h/GHSA-257v-vj4p-3w2h.json
aliases:
  - CVE-2021-29060
summary: |
  Regular Expression Denial of Service (ReDOS)
  In the npm package `color-string`, there is a  ReDos (Regular Expression Denial of Service) vulnerability regarding an exponential time complexity for
  linearly increasing input lengths for `hwb()` color strings.

  Strings reaching more than 5000 characters would see several
  milliseconds of processing time; strings reaching more than
  50,000 characters began seeing 1500ms (1.5s) of processing time.

  The cause was due to a the regular expression that parses
  hwb() strings - specifically, the hue value - where
  the integer portion of the hue value used a 0-or-more quantifier
  shortly thereafter followed by a 1-or-more quantifier.

  This caused excessive backtracking and a cartesian scan,
  resulting in exponential time complexity given a linear
  increase in input length.
impacted_packages:
  - purl: pkg:npm/color-string
    affected_versions: vers:npm/<1.5.5
    fixed_versions: vers:npm/1.5.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-257v-vj4p-3w2h/GHSA-257v-vj4p-3w2h.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
references:
  - url: https://github.com/Qix-/color-string/commit/0789e21284c33d89ebc4ab4ca6f759b9375ac9d3
    reference_type:
    reference_id:
  - url: https://github.com/Qix-/color-string/releases/tag/1.5.5
    reference_type:
    reference_id:
  - url: https://github.com/yetingli/PoCs/blob/main/CVE-2021-29060/Color-String.md
    reference_type:
    reference_id:
  - url: https://github.com/yetingli/SaveResults/blob/main/js/color-string.js
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/color-string
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29060
    reference_type:
    reference_id: CVE-2021-29060
