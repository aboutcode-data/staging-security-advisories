advisory_id: GHSA-fqfj-cmh6-hj49
datasource_id: github_osv_importer_v2/GHSA-fqfj-cmh6-hj49
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/06/GHSA-fqfj-cmh6-hj49/GHSA-fqfj-cmh6-hj49.json
aliases:
  - CVE-2019-11027
summary: |
  ruby-openid SSRF via claimed_id request
  Ruby OpenID (aka ruby-openid) through 2.8.0 is vulnerable to SSRF. Ruby-openid performs discovery first, and then verification. This allows an attacker to change the URL used for discovery and trick the server into connecting to the URL, which might be a private server not publicly accessible. Severity can range from medium to critical, depending on how a web application developer chose to employ the ruby-openid library. Developers who based their OpenID integration heavily on the "example app" provided by the project are at highest risk.
impacted_packages:
  - purl: pkg:gem/ruby-openid
    affected_versions: vers:gem/<2.9.0
    fixed_versions: vers:gem/2.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/06/GHSA-fqfj-cmh6-hj49/GHSA-fqfj-cmh6-hj49.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/openid/ruby-openid
    reference_type:
    reference_id:
  - url: https://github.com/openid/ruby-openid/commit/d181a8a2099c64365a1d24b29f6b6b646673a131
    reference_type:
    reference_id:
  - url: https://github.com/openid/ruby-openid/issues/122
    reference_type:
    reference_id:
  - url: https://github.com/openid/ruby-openid/releases/tag/v2.9.0
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/ruby-openid/CVE-2019-11027.yml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2019/10/msg00014.html
    reference_type:
    reference_id:
  - url: https://marc.info/?l=openid-security&m=155154717027534&w=2
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202003-09
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-11027
    reference_type:
    reference_id: CVE-2019-11027
