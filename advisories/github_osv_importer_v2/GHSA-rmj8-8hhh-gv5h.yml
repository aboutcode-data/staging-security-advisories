advisory_id: GHSA-rmj8-8hhh-gv5h
datasource_id: github_osv_importer_v2/GHSA-rmj8-8hhh-gv5h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-rmj8-8hhh-gv5h/GHSA-rmj8-8hhh-gv5h.json
aliases:
  - CVE-2022-23634
summary: "Puma used with Rails may lead to Information Exposure\n### Impact\nPrior to `puma`\
  \ version `5.6.2`, `puma` may not always call `close` on the response body. Rails, prior to\
  \ version `7.0.2.2`, depended on the response body being closed in order for its `CurrentAttributes`\
  \ implementation to work correctly.\n\nFrom Rails:\n\n> Under certain circumstances response\
  \ bodies will not be closed, for example a bug in a webserver[1] or a bug in a Rack middleware.\
  \ In the event a response is not notified of a close, ActionDispatch::Executor will not know\
  \ to reset thread local state for the next request. This can lead to data being leaked to\
  \ subsequent requests, especially when interacting with ActiveSupport::CurrentAttributes.\n\
  \nThe combination of these two behaviors (Puma not closing the body + Rails' Executor implementation)\
  \ causes information leakage.\n\n### Patches\nThis problem is fixed in Puma versions 5.6.2\
  \ and 4.3.11.\n\nThis problem is fixed in Rails versions 7.02.2, 6.1.4.6, 6.0.4.6, and 5.2.6.2.\n\
  \nSee: \nhttps://github.com/advisories/GHSA-wh98-p28r-vrc9 \nfor details about the rails vulnerability\n\
  \nUpgrading to a patched Rails _or_ Puma version fixes the vulnerability.\n\n### Workarounds\n\
  \nUpgrade to Rails versions 7.02.2, 6.1.4.6, 6.0.4.6, and 5.2.6.2.\n\nThe [Rails CVE](https://groups.google.com/g/ruby-security-ann/c/FkTM-_7zSNA/m/K2RiMJBlBAAJ?utm_medium=email&utm_source=footer&pli=1)\
  \ includes a middleware that can be used instead.\n\n### References\n\n* Rails CVE: [CVE-2022-23633](https://groups.google.com/g/ruby-security-ann/c/FkTM-_7zSNA/m/K2RiMJBlBAAJ?utm_medium=email&utm_source=footer&pli=1)\n\
  \n### For more information\nIf you have any questions or comments about this advisory:\n*\
  \ Open an issue in [puma](https://github.com/puma/puma)\n* See our [security policy](https://github.com/puma/puma/security/policy)"
impacted_packages:
  - purl: pkg:gem/puma
    affected_versions: vers:gem/>=5.0.0|<5.6.2
    fixed_versions: vers:gem/5.6.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/puma
    affected_versions: vers:gem/<4.3.11
    fixed_versions: vers:gem/4.3.11
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-rmj8-8hhh-gv5h/GHSA-rmj8-8hhh-gv5h.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-404
  - CWE-200
references:
  - url: https://github.com/advisories/GHSA-rmj8-8hhh-gv5h
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-wh98-p28r-vrc9
    reference_type:
    reference_id:
  - url: https://github.com/puma/puma
    reference_type:
    reference_id:
  - url: https://github.com/puma/puma/commit/b70f451fe8abc0cff192c065d549778452e155bb
    reference_type:
    reference_id:
  - url: https://github.com/puma/puma/security/advisories/GHSA-rmj8-8hhh-gv5h
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/puma/CVE-2022-23634.yml
    reference_type:
    reference_id:
  - url: https://groups.google.com/g/ruby-security-ann/c/FkTM-_7zSNA/m/K2RiMJBlBAAJ?utm_medium=email&utm_source=footer&pli=1
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/05/msg00034.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/08/msg00015.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/F6YWGIIKL7KKTS3ZOAYMYPC7D6WQ5OA5
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L7NESIBFCNSR3XH7LXDPKVMSUBNUB43G
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TUBFJ44NCKJ34LECZRAP4N5VL6USJSIB
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202208-28
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2022/dsa-5146
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23634
    reference_type:
    reference_id: CVE-2022-23634
