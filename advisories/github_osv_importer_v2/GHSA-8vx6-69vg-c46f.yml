advisory_id: GHSA-8vx6-69vg-c46f
datasource_id: github_osv_importer_v2/GHSA-8vx6-69vg-c46f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-8vx6-69vg-c46f/GHSA-8vx6-69vg-c46f.json
aliases:
  - CVE-2023-2512
summary: |
  Buffer under-read in workerd
  ### Impact
  Prior to version v1.20230419.0, the FormData API implementation was subject to an integer overflow. If a FormData instance contained more than 2^31 elements, the `forEach()` method could end up reading from the wrong location in memory while iterating over elements. This would most likely lead to a segmentation fault, but could theoretically allow arbitrary undefined behavior.

  In order for the bug to be exploitable, the process would need to be able to allocate 160GB of RAM. Due to this, the bug was never exploitable on the Cloudflare Workers platform, but could theoretically be exploitable on deployments of workerd running on machines with a huge amount of memory. Moreover, in order to be remotely exploited, an attacker would have to upload a single form-encoded HTTP request of at least tens of gigabytes in size. The application code would then have to use `request.formData()` to parse the request and `formData.forEach()` to iterate over this data. Due to these limitations, the exploitation likelihood was considered Low.

  ### Patches
  A fix that addresses this vulnerability has been released in version v1.20230419.0 and users are encouraged to update to the latest version available.

  ### References
  Release - https://github.com/cloudflare/workerd/releases/tag/v1.20230419.0
impacted_packages:
  - purl: pkg:npm/workerd
    affected_versions: vers:npm/<1.20230419.0
    fixed_versions: vers:npm/1.20230419.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-8vx6-69vg-c46f/GHSA-8vx6-69vg-c46f.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-190
  - CWE-127
  - CWE-125
references:
  - url: https://github.com/cloudflare/workerd
    reference_type:
    reference_id:
  - url: https://github.com/cloudflare/workerd/releases/tag/v1.20230419.0
    reference_type:
    reference_id:
  - url: https://github.com/cloudflare/workerd/security/advisories/GHSA-8vx6-69vg-c46f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-2512
    reference_type:
    reference_id: CVE-2023-2512
