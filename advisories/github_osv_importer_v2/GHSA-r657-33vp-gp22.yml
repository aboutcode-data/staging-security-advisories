advisory_id: GHSA-r657-33vp-gp22
datasource_id: github_osv_importer_v2/GHSA-r657-33vp-gp22
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-r657-33vp-gp22/GHSA-r657-33vp-gp22.json
aliases:
  - CVE-2022-39231
summary: |
  parse-server auth adapter app ID validation can be circumvented
  ### Impact

  Validation of the authentication adapter app ID for _Facebook_ and _Spotify_ may be circumvented.

  This fixes a vulnerability that affects configurations which allow users to authenticate using the Parse Server authentication adapter for _Facebook_ or _Spotify_ and where the server-side authentication adapter configuration `appIds` is set as a string (e.g. `abc`) instead of an array of strings (e.g. `["abc"]`). The vulnerability makes it possible to authenticate requests which are coming from a _Facebook_ or _Spotify_ app with a different app ID than the one specified in the `appIds` configuration.

  Both adapters still validate the access token with the respective authentication provider. An app ID is automatically assigned by the authentication provider. For this vulnerability to be exploited, an attacker would have to be assigned an app ID by the authentication provider which is a sub-set of the server-side configured app ID.

  The documentation did not explicitly specify that the parameter `appIds` must be set as an array of strings and setting a string also worked. Therefore, there is a possibility that there are deployments where `appIds` is set as a string, making them vulnerable.

  ### Patches

  The fix makes Parse Server check the type of the value set for `appIds` and throws an error if the value is not an array.

  ### Workarounds

  No known workarounds.

  ### References

  - GitHub advisory [GHSA-r657-33vp-gp22](https://github.com/parse-community/parse-server/security/advisories/GHSA-r657-33vp-gp22)
impacted_packages:
  - purl: pkg:npm/parse-server
    affected_versions: vers:npm/<4.10.16
    fixed_versions: vers:npm/4.10.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/parse-server
    affected_versions: vers:npm/>=5.0.0|<5.2.7
    fixed_versions: vers:npm/5.2.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-r657-33vp-gp22/GHSA-r657-33vp-gp22.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/parse-community/parse-server
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/commit/8c8ec715739e0f851338cfed794409ebac66c51b
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/releases/tag/4.10.16
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/releases/tag/5.2.7
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/security/advisories/GHSA-r657-33vp-gp22
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39231
    reference_type:
    reference_id: CVE-2022-39231
