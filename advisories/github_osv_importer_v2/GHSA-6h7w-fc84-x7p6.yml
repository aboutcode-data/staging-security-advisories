advisory_id: GHSA-6h7w-fc84-x7p6
datasource_id: github_osv_importer_v2/GHSA-6h7w-fc84-x7p6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-6h7w-fc84-x7p6/GHSA-6h7w-fc84-x7p6.json
aliases:
  - CVE-2021-32643
summary: |
  StaticFile.fromUrl can leak presence of a directory
  ### Impact

  `StaticFile.fromUrl` can leak the presence of a directory on a server when the `URL` scheme is not `file://`, and the URL points to a fetchable resource under its scheme and authority.  The function returns `F[None]`, indicating no resource, if `url.getFile` is a directory, without first checking the scheme or authority of the URL.  If a URL connection to the scheme and URL would return a stream, and the path in the URL exists as a directory on the server, the presence of the directory on the server could be inferred from the 404 response.  The contents and other metadata about the directory are not exposed.

  This affects http4s versions:
  * 0.21.7 through 0.21.23
  * 0.22.0-M1 through 0.22.0-M8
  * 0.23.0-M1
  * 1.0.0-M1 through 1.0.0-M22

  ### Patches

  The [patch](https://github.com/http4s/http4s/commit/52e1890665410b4385e37b96bc49c5e3c708e4e9) is available in the following versions:

  * v0.21.24
  * v0.22.0-RC1
  * v0.23.0-RC1
  * v1.0.0-M23

  Note: a previous version of this advisory incorrectly referred to 0.22.0-M9 and 0.23.0-M2.

  ### Workarounds

  Don't call `StaticFile.fromUrl` with non-file URLs.

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [the http4s repository](https://github.com/http4s/http4s)
  * Disclose further vulnerabilities according to the [http4s security policy](https://github.com/http4s/http4s/blob/main/SECURITY.md)
impacted_packages:
  - purl: pkg:maven/org.http4s/http4s-core
    affected_versions: vers:maven/>=0.21.7|<0.21.24
    fixed_versions: vers:maven/0.21.24
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.http4s/http4s-core
    affected_versions: vers:maven/<=0.22.0-M8
    fixed_versions: vers:maven/0.22.0-RC1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.http4s/http4s-core
    affected_versions: vers:maven/0.23.0-M1
    fixed_versions: vers:maven/0.23.0-RC1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.http4s/http4s-core
    affected_versions: vers:maven/<=1.0.0-M22
    fixed_versions: vers:maven/1.0.0-M23
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-6h7w-fc84-x7p6/GHSA-6h7w-fc84-x7p6.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/http4s/http4s/commit/52e1890665410b4385e37b96bc49c5e3c708e4e9
    reference_type:
    reference_id:
  - url: https://github.com/http4s/http4s/security/advisories/GHSA-6h7w-fc84-x7p6
    reference_type:
    reference_id:
  - url: https://mvnrepository.com/artifact/org.http4s/http4s-core
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32643
    reference_type:
    reference_id: CVE-2021-32643
