advisory_id: GHSA-m2jw-cj8v-937r
datasource_id: github_osv_importer_v2/GHSA-m2jw-cj8v-937r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/02/GHSA-m2jw-cj8v-937r/GHSA-m2jw-cj8v-937r.json
aliases:
  - CVE-2025-27145
summary: |
  copyparty renders unsanitized filenames as HTML when user uploads empty files
  ## Summary

  A [DOM-Based XSS](https://capec.mitre.org/data/definitions/588.html) was discovered in [copyparty](https://github.com/9001/copyparty), a portable fileserver. The vulnerability is considered low-risk.

  ## Details

  By handing someone a maliciously-named file, and then tricking them into dragging the file into copyparty's Web-UI, an attacker could execute arbitrary javascript with the same privileges as that user. For example, this could give unintended read-access to files owned by that user. The bug is triggered by the drag-drop action itself; it is not necessary to actually initiate the upload. The file must be empty (zero bytes).

  Note: As a general-purpose webserver, it is intentionally possible to upload HTML-files with arbitrary javascript in `<script>` tags, which will execute when the file is opened. The difference is that this vulnerability would trigger execution of javascript during the act of uploading, and not when the uploaded file was opened.

  ## Proof of Concept (POC)

  1. Create an empty file named `<img src=x onerror="alert(1)">`
  2. Drag-and-drop the file into the browser to initiate an upload
  3. The `alert(1)` is executed
impacted_packages:
  - purl: pkg:pypi/copyparty
    affected_versions: vers:pypi/<1.16.15
    fixed_versions: vers:pypi/1.16.15
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/02/GHSA-m2jw-cj8v-937r/GHSA-m2jw-cj8v-937r.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-83
  - CWE-79
references:
  - url: https://github.com/9001/copyparty
    reference_type:
    reference_id:
  - url: https://github.com/9001/copyparty/commit/438ea6ccb06f39d7cbb4b6ee7ad44606e21a63dd
    reference_type:
    reference_id:
  - url: https://github.com/9001/copyparty/releases/tag/v1.16.15
    reference_type:
    reference_id:
  - url: https://github.com/9001/copyparty/security/advisories/GHSA-m2jw-cj8v-937r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-27145
    reference_type:
    reference_id: CVE-2025-27145
