advisory_id: GHSA-jhww-fx2j-3rf7
datasource_id: github_osv_importer_v2/GHSA-jhww-fx2j-3rf7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-jhww-fx2j-3rf7/GHSA-jhww-fx2j-3rf7.json
aliases:
  - CVE-2023-46725
summary: |
  FoodCoopShop Server-Side Request Forgery vulnerability
  There is a potential SSRF vulnerability in foodcoopshop. Since there is no security policy on your Github, I tried to use the emails to contact you.

  The potential issue is in the Network module, where a manufacturer account can use the /api/updateProducts.json endpoint to make the server send a request to arbitrary host.
  For example, use
  ```
  data[data][0][remoteProductId]=352&data[data][0][image]=http://localhost:8888/
  ```
  will make the server send a request to localhost:8888. This means that it can be used as a proxy into the internal network where the server is.

  To make matters worse, the checks on valid image is not enough. There is time of check time of use issue there.
  For example, by using a custom server that returns 200 on HEAD requests, then return a valid image on first GET request and then a 302 redirect to final target on second GET request, the server will copy whatever file
  at the redirect destination, making this a full SSRF.
  (An example python server that can do this is at https://pastebin.com/8K5Brwbq This will make the server download whatever at the redirect target)

  You can check https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html for more information on SSRF, their impact and how to properly fix it.

  Regards
impacted_packages:
  - purl: pkg:composer/foodcoopshop/foodcoopshop
    affected_versions: vers:composer/>=3.2.0|<3.6.1
    fixed_versions: vers:composer/3.6.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-jhww-fx2j-3rf7/GHSA-jhww-fx2j-3rf7.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
  - CWE-367
references:
  - url: https://github.com/foodcoopshop/foodcoopshop
    reference_type:
    reference_id:
  - url: https://github.com/foodcoopshop/foodcoopshop/commit/0d5bec5c4c22e1affe7fd321a30e3f3a4d99e808
    reference_type:
    reference_id:
  - url: https://github.com/foodcoopshop/foodcoopshop/pull/972
    reference_type:
    reference_id:
  - url: https://github.com/foodcoopshop/foodcoopshop/security/advisories/GHSA-jhww-fx2j-3rf7
    reference_type:
    reference_id:
  - url: https://pastebin.com/8K5Brwbq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-46725
    reference_type:
    reference_id: CVE-2023-46725
