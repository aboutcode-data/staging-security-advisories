advisory_id: GHSA-qxrv-gp6x-rc23
datasource_id: github_osv_importer_v2/GHSA-qxrv-gp6x-rc23
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-qxrv-gp6x-rc23/GHSA-qxrv-gp6x-rc23.json
aliases:
  - CVE-2024-41132
summary: |
  SixLabors ImageSharp has Excessive Memory Allocation in Gif Decoder
  ### Impact
  _What kind of vulnerability is it? Who is impacted?_

  A vulnerability discovered in the ImageSharp library, where the processing of specially crafted files can lead to excessive memory usage in the Gif decoder. The vulnerability is triggered when ImageSharp attempts to process image files that are designed to exploit this flaw.

  ### Patches
  _Has the problem been patched? What versions should users upgrade to?_

  The problem has been patched. All users are advised to upgrade to v3.1.5 or v2.1.9.

  ### Workarounds
  _Is there a way for users to fix or remediate the vulnerability without upgrading?_

  Before calling `Image.Decode(Async)`, use `Image.Identify` to determine the image dimensions in order to enforce a limit.

  ### References
  _Are there any links users can visit to find out more?_
  - https://github.com/SixLabors/ImageSharp/pull/2759
  - https://github.com/SixLabors/ImageSharp/pull/2764
  - https://github.com/SixLabors/ImageSharp/pull/2770
  - ImageSharp: [Security Considerations](https://docs.sixlabors.com/articles/imagesharp/security.html)
  - ImageSharp.Web: [Securing Processing Commands](https://docs.sixlabors.com/articles/imagesharp.web/processingcommands.html#securing-processing-commands)
impacted_packages:
  - purl: pkg:nuget/SixLabors.ImageSharp
    affected_versions: vers:nuget/<2.1.9
    fixed_versions: vers:nuget/2.1.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/SixLabors.ImageSharp
    affected_versions: vers:nuget/>=3.0.0|<3.1.5
    fixed_versions: vers:nuget/3.1.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-qxrv-gp6x-rc23/GHSA-qxrv-gp6x-rc23.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-qxrv-gp6x-rc23/GHSA-qxrv-gp6x-rc23.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
  - CWE-789
references:
  - url: https://docs.sixlabors.com/articles/imagesharp/security.html
    reference_type:
    reference_id:
  - url: https://docs.sixlabors.com/articles/imagesharp.web/processingcommands.html#securing-processing-commands
    reference_type:
    reference_id:
  - url: https://github.com/SixLabors/ImageSharp
    reference_type:
    reference_id:
  - url: https://github.com/SixLabors/ImageSharp/commit/59de13c8cc47f2b402e2c43aa7024511d029d515
    reference_type:
    reference_id:
  - url: https://github.com/SixLabors/ImageSharp/commit/9816ca45016c5d3859986f3c600e8934bc450a56
    reference_type:
    reference_id:
  - url: https://github.com/SixLabors/ImageSharp/commit/b496109051cc39feee1f6cde48fca6481de17f9a
    reference_type:
    reference_id:
  - url: https://github.com/SixLabors/ImageSharp/pull/2759
    reference_type:
    reference_id:
  - url: https://github.com/SixLabors/ImageSharp/pull/2764
    reference_type:
    reference_id:
  - url: https://github.com/SixLabors/ImageSharp/pull/2770
    reference_type:
    reference_id:
  - url: https://github.com/SixLabors/ImageSharp/security/advisories/GHSA-qxrv-gp6x-rc23
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41132
    reference_type:
    reference_id: CVE-2024-41132
