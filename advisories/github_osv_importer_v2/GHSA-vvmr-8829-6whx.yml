advisory_id: GHSA-vvmr-8829-6whx
datasource_id: github_osv_importer_v2/GHSA-vvmr-8829-6whx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-vvmr-8829-6whx/GHSA-vvmr-8829-6whx.json
aliases:
  - CVE-2022-23601
summary: |
  CSRF token missing in Symfony
  Description
  -----------

  The Symfony form component provides a CSRF protection mechanism by using a random token injected in the form and using the session to store and control the token submitted by the user.
  When using the FrameworkBundle, this protection can be enabled or disabled with the configuration. If the configuration is not specified, by default, the mechanism is enabled as long as the session is enabled.

  In a recent change in the way the configuration is loaded, the default behavior has been dropped and, as a result, the CSRF protection is not enabled in form when not explicitly enabled, which makes the application sensible to CSRF attacks.

  Resolution
  ----------

  Symfony restored the default configuration to enable the CSRF protection by default.

  The patch for this issue is available [here](https://github.com/symfony/symfony/commit/f0ffb775febdf07e57117aabadac96fa37857f50) for branch 5.3.

  Credits
  -------

  We would like to thank Catalin Dan and David Lochner for reporting the issue and Jérémy Derussé for fixing the issue.
impacted_packages:
  - purl: pkg:composer/symfony/framework-bundle
    affected_versions: vers:composer/5.3.14
    fixed_versions: vers:composer/5.3.15
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/framework-bundle
    affected_versions: vers:composer/5.4.3
    fixed_versions: vers:composer/5.4.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/framework-bundle
    affected_versions: vers:composer/6.0.3
    fixed_versions: vers:composer/6.0.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-vvmr-8829-6whx/GHSA-vvmr-8829-6whx.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/framework-bundle/CVE-2022-23601.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2022-23601.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/f0ffb775febdf07e57117aabadac96fa37857f50
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/security/advisories/GHSA-vvmr-8829-6whx
    reference_type:
    reference_id:
  - url: https://symfony.com/cve-2022-23601
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23601
    reference_type:
    reference_id: CVE-2022-23601
