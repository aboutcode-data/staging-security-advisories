advisory_id: GHSA-rpq8-q44m-2rpg
datasource_id: github_osv_importer_v2/GHSA-rpq8-q44m-2rpg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-rpq8-q44m-2rpg/GHSA-rpq8-q44m-2rpg.json
aliases:
  - CVE-2025-32016
summary: "Microsoft Identity Web Exposes Client Secrets and Certificate Information in Service\
  \ Logs\n### Impact\n_What kind of vulnerability is it? Who is impacted?_\n\n**Description:**\
  \ This vulnerability affects confidential client applications, including daemons, web apps,\
  \ and web APIs. Under specific circumstances, sensitive information such as client secrets\
  \ or certificate details may be exposed in the service logs of these applications. Service\
  \ logs are intended to be handled securely.\n\n**Impact:** The vulnerability impacts service\
  \ logs that meet the following criteria:\n\n- **Logging Level:** Logs are generated at the\
  \ information level.\n- **Credential Descriptions:** containing:\n    - Local file paths with\
  \ passwords.\n    - Base64 encoded values.\n    - Client secret.\n    \nAdditionally, logs\
  \ of services using Base64 encoded certificates or certificate paths with password credential\
  \ descriptions are also affected if the certificates are invalid or expired, regardless of\
  \ the log level. Note that these credentials are not usable due to their invalid or expired\
  \ status.\n\nIf your service logs are handled securely, you are not impacted. \n\nOtherwise,\
  \ the following table shows when you can be impacted \n  | Log Level Information for Microsoft.Identity.Web\
  \ | Invalid Certificate\n-- | -- | --\nOne of the ClientCredentials credential description\
  \ has a CredentialSource = Base64Encoded or (CredentialSource = Path) | Impacted | Impacted\n\
  One of the ClientCredentials credential description is a Client secret (CredentialSource =\
  \ ClientSecret) | Impacted | Not impacted\nOther credential descriptions | Not Impacted |\
  \ Not Impacted\n\n### Patches\n_Has the problem been patched? What versions should users upgrade\
  \ to?_\nTo mitigate this vulnerability, update to Microsoft.Identity.Web 3.8.2 or Microsoft.Identity.Abstractions\
  \ 9.0.0.\n\n### Workarounds\n_Is there a way for users to fix or remediate the vulnerability\
  \ without upgrading?_\nYou can work around the issue in the following ways: \n\n- Ensure that\
  \ service logs are handled securely and access to logs is restricted\n\n- Don’t use `LogLevel\
  \ = Information` for the Microsoft.Identity.Web namespace \n\n### Recommendation for production\
  \ environment\nAvoid using `ClientCredentials` with [`CredentialDescriptions`](https://learn.microsoft.com/en-us/dotnet/api/microsoft.identity.abstractions.credentialdescription.base64encodedvalue?view=msal-model-dotnet-latest)\
  \ which `CredentialSource` is `ClientSecret`, or `Base64Encoded`, or `Path`. Rather use certificate\
  \ from KeyVault or a certificate store, or Federation identity credential with Managed identity.\n\
  \n### References\n_Are there any links users can visit to find out more?_"
impacted_packages:
  - purl: pkg:nuget/Microsoft.Identity.Web
    affected_versions: vers:nuget/>=3.2.0|<3.8.2
    fixed_versions: vers:nuget/3.8.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Microsoft.Identity.Abstractions
    affected_versions: vers:nuget/>=7.1.0|<9.0.0
    fixed_versions: vers:nuget/9.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-rpq8-q44m-2rpg/GHSA-rpq8-q44m-2rpg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: https://github.com/AzureAD/microsoft-identity-web
    reference_type:
    reference_id:
  - url: https://github.com/AzureAD/microsoft-identity-web/security/advisories/GHSA-rpq8-q44m-2rpg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32016
    reference_type:
    reference_id: CVE-2025-32016
