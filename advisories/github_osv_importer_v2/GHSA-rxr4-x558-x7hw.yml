advisory_id: GHSA-rxr4-x558-x7hw
datasource_id: github_osv_importer_v2/GHSA-rxr4-x558-x7hw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-rxr4-x558-x7hw/GHSA-rxr4-x558-x7hw.json
aliases:
  - CVE-2018-20991
summary: |
  Double free in smallvec
  If an iterator passed to SmallVec::insert_many panicked in Iterator::next, destructors were run during unwinding while the vector was in an inconsistent state, possibly causing a double free (a destructor running on two copies of the same value).

  This is fixed in smallvec 0.6.3 by ensuring that the vector's length is not updated to include moved items until they have been removed from their original positions. Items may now be leaked if Iterator::next panics, but they will not be dropped more than once.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-rxr4-x558-x7hw/GHSA-rxr4-x558-x7hw.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-415
references:
  - url: https://github.com/servo/rust-smallvec
    reference_type:
    reference_id:
  - url: https://github.com/servo/rust-smallvec/issues/96
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2018-0003.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-20991
    reference_type:
    reference_id: CVE-2018-20991
