advisory_id: GHSA-q4hm-fwc9-hmv6
datasource_id: github_osv_importer_v2/GHSA-q4hm-fwc9-hmv6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-q4hm-fwc9-hmv6/GHSA-q4hm-fwc9-hmv6.json
aliases:
  - CVE-2021-23331
summary: |
  Insecure temporary file used in com.squareup:connect
  This affects all versions of package com.squareup:connect. The method prepareDownloadFilecreates creates a temporary file with the permissions bits of -rw-r--r-- on unix-like systems. On unix-like systems, the system temporary directory is shared between users. As such, the contents of the file downloaded by downloadFileFromResponse will be visible to all other users on the local system. A workaround fix for this issue is to set the system property java.io.tmpdir to a safe directory as remediation. Note: This version of the SDK is end of life and no longer maintained, please upgrade to the latest version.
impacted_packages:
  - purl: pkg:maven/com.squareup/connect
    affected_versions: vers:maven/<=2.20191120.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-q4hm-fwc9-hmv6/GHSA-q4hm-fwc9-hmv6.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-377
references:
  - url: https://github.com/square/connect-java-sdk
    reference_type:
    reference_id:
  - url: https://github.com/square/connect-java-sdk/blob/master/src/main/java/com/squareup/connect/ApiClient.java%23L613
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JAVA-COMSQUAREUP-1065988
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-23331
    reference_type:
    reference_id: CVE-2021-23331
