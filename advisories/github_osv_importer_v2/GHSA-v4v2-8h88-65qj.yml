advisory_id: GHSA-v4v2-8h88-65qj
datasource_id: github_osv_importer_v2/GHSA-v4v2-8h88-65qj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-v4v2-8h88-65qj/GHSA-v4v2-8h88-65qj.json
aliases:
  - CVE-2023-49276
summary: |
  Attribute Injection leading to XSS(Cross-Site-Scripting)
  ### Summary
  Google Analytics element Attribute Injection leading to XSS

  ### Details
  Since the custom status interface can set an independent Google Analytics ID and the template has not been sanitized, there is an attribute injection vulnerability here, which can lead to XSS attacks.
  ![image](https://user-images.githubusercontent.com/110759348/282278047-667b774b-421f-449a-8f95-3f3906ae4216.png)

  ### PoC
  1. Run the latest version of the louislam/uptime-kuma container and initialize the account password.
  2. Create a new status page.
  3. Edit the status page and change the Google Analytics ID to following payload(it only works for firefox. Any attribute can be injected, but this seems the most intuitive):
  ```
  123123" onafterscriptexecute=alert(window.name+1),eval(window.name) a="x
  ```

  4. Click Save and return to the interface. XSS occurs.
  screenshots:
  ![image](https://user-images.githubusercontent.com/110759348/282287393-4874974f-9416-4941-9c2e-a92ee2412197.png)

  ![9d0603e634fb7da2e83a0a45dc0a36ac](https://user-images.githubusercontent.com/110759348/282287346-1deb0382-520f-47cf-b191-9b7d19c47879.png)
impacted_packages:
  - purl: pkg:npm/uptime-kuma
    affected_versions: vers:npm/<=1.23.6
    fixed_versions: vers:npm/1.23.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-v4v2-8h88-65qj/GHSA-v4v2-8h88-65qj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/louislam/uptime-kuma
    reference_type:
    reference_id:
  - url: https://github.com/louislam/uptime-kuma/commit/f28dccf4e11f041564293e4f407e69ab9ee2277f
    reference_type:
    reference_id:
  - url: https://github.com/louislam/uptime-kuma/security/advisories/GHSA-v4v2-8h88-65qj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-49276
    reference_type:
    reference_id: CVE-2023-49276
