advisory_id: GHSA-68w7-72jg-6qpp
datasource_id: github_osv_importer_v2/GHSA-68w7-72jg-6qpp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-68w7-72jg-6qpp/GHSA-68w7-72jg-6qpp.json
aliases:
  - CVE-2024-0057
summary: "NuGet Client Security Feature Bypass Vulnerability\n### Description\nMicrosoft is\
  \ releasing this security advisory to provide information about a vulnerability in .NET 6.0,\
  \ .NET 7.0 and .NET 8.0. This advisory also provides guidance on what developers can do to\
  \ update their applications to address this vulnerability. \n\nA security feature bypass vulnerability\
  \ exists when Microsoft .NET Framework-based applications use X.509 chain building APIs but\
  \ do not completely validate the X.509 certificate due to a logic flaw. An attacker could\
  \ present an arbitrary untrusted certificate with malformed signatures, triggering a bug in\
  \ the framework. The framework will correctly report that X.509 chain building failed, but\
  \ it will return an incorrect reason code for the failure. Applications which utilize this\
  \ reason code to make their own chain building trust decisions may inadvertently treat this\
  \ scenario as a successful chain build. This could allow an adversary to subvert the app's\
  \ typical authentication logic. \n\n### Affected software\n#### NuGet & NuGet Packages\n-\
  \ Any NuGet.exe, NuGet.CommandLine, NuGet.Packaging 6.8.0 version or earlier. \n- Any NuGet.exe,\
  \ NuGet.CommandLine, NuGet.Packaging 6.7.0 version or earlier. \n- Any NuGet.exe, NuGet.CommandLine,\
  \ NuGet.Packaging 6.6.1 version or earlier. \n- Any NuGet.exe, NuGet.CommandLine, NuGet.Packaging\
  \ 6.4.2 version or earlier. \n- Any NuGet.exe, NuGet.CommandLine, NuGet.Packaging 6.3.3 version\
  \ or earlier. \n- Any NuGet.exe, NuGet.CommandLine, NuGet.Packaging 6.0.5 version or earlier.\
  \ \n- Any NuGet.exe, NuGet.CommandLine, NuGet.Packaging 5.11.5 version or earlier. \n\n####\
  \ .NET SDK(s)\n- Any .NET SDK 6.0.126 or earlier, or 6.0.418 or earlier.\n- Any .NET SDK 7.0.115\
  \ or earlier, or 7.0.312 or earlier, or 7.0.405 or earlier.\n- Any .NET SDK 8.0.101 or earlier.\n\
  \ \n### Patches\nTo fix the issue, please install the latest version of .NET 6.0, .NET 7.0\
  \ or .NET 8.0 and NuGet (NuGet.exe, NuGet.CommandLine, NuGet. Packaging versions). If you\
  \ have installed one or more .NET SDKs through Visual Studio, Visual Studio will prompt you\
  \ to update Visual Studio, which will also update your .NET SDKs. \n- If you're using NuGet.exe\
  \ 6.8.0 or lower, you should download and install 6.8.1 from https://dist.nuget.org/win-x86-commandline/v6.8.1/nuget.exe.\
  \ \n- If you're using NuGet.exe 6.7.0 or lower, you should download and install 6.7.1 from https://dist.nuget.org/win-x86-commandline/v6.7.1/nuget.exe.\
  \ \n- If you're using NuGet.exe 6.6.1 or lower, you should download and install 6.6.2 from https://dist.nuget.org/win-x86-commandline/v6.6.2/nuget.exe.\
  \ \n- If you're using NuGet.exe 6.4.2 or lower, you should download and install 6.4.3 from https://dist.nuget.org/win-x86-commandline/v6.4.3/nuget.exe.\
  \ \n- If you're using NuGet.exe 6.3.3 or lower, you should download and install 6.3.4 from https://dist.nuget.org/win-x86-commandline/v6.3.4/nuget.exe.\
  \ \n- If you're using NuGet.exe 6.0.5 or lower, you should download and install 6.0.6 from https://dist.nuget.org/win-x86-commandline/v6.0.6/nuget.exe.\
  \ \n- If you're using NuGet.exe 5.11.5 or lower, you should download and install 5.11.6 from https://dist.nuget.org/win-x86-commandline/v5.11.6/nuget.exe.\
  \ \n- If you're using .NET 8.0, you should download and install .NET 8.0.102 SDK (for Visual\
  \ Studio 2022 v17.8) from https://dotnet.microsoft.com/download/dotnet-core/8.0 . \n- If you're\
  \ using .NET 7.0, you should download and install SDK 7.0.116 (for Visual Studio 2022 v17.4),\
  \ or SDK 7.0.313 (for Visual Studio 2022 v17.6), or 7.0.406 (for Visual Studio 2022 v17.7)\
  \ from https://dotnet.microsoft.com/download/dotnet-core/7.0 . \n- If you're using .NET 6.0,\
  \ you should download and install SDK 6.0.127 or SDK 6.0.419 (for Visual Studio 2022 v17.3)\
  \ from https://dotnet.microsoft.com/download/dotnet-core/6.0 . \n\n### Other details\nAnnouncement\
  \ for this issue can be found at https://github.com/NuGet/Announcements/issues/71 \n\nMSRC\
  \ details for this can be found at [CVE-2024-0057 - Security Update Guide - Microsoft - NET,\
  \ .NET Framework, and Visual Studio Security Feature Bypass Vulnerability](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-0057)"
impacted_packages:
  - purl: pkg:nuget/NuGet.CommandLine
    affected_versions: vers:nuget/>=4.6.0|<5.11.6
    fixed_versions: vers:nuget/5.11.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.Packaging
    affected_versions: vers:nuget/>=4.6.0|<5.11.6
    fixed_versions: vers:nuget/5.11.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.CommandLine
    affected_versions: vers:nuget/>=6.0.0|<6.0.6
    fixed_versions: vers:nuget/6.0.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.Packaging
    affected_versions: vers:nuget/>=6.0.0|<6.0.6
    fixed_versions: vers:nuget/6.0.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.CommandLine
    affected_versions: vers:nuget/>=6.3.0|<6.3.4
    fixed_versions: vers:nuget/6.3.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.Packaging
    affected_versions: vers:nuget/>=6.3.0|<6.3.4
    fixed_versions: vers:nuget/6.3.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.CommandLine
    affected_versions: vers:nuget/>=6.4.0|<6.4.3
    fixed_versions: vers:nuget/6.4.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.Packaging
    affected_versions: vers:nuget/>=6.4.0|<6.4.3
    fixed_versions: vers:nuget/6.4.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.CommandLine
    affected_versions: vers:nuget/>=6.6.0|<6.6.2
    fixed_versions: vers:nuget/6.6.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.Packaging
    affected_versions: vers:nuget/>=6.6.0|<6.6.2
    fixed_versions: vers:nuget/6.6.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.CommandLine
    affected_versions: vers:nuget/6.7.0
    fixed_versions: vers:nuget/6.7.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.Packaging
    affected_versions: vers:nuget/6.7.0
    fixed_versions: vers:nuget/6.7.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.CommandLine
    affected_versions: vers:nuget/6.8.0
    fixed_versions: vers:nuget/6.8.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/NuGet.Packaging
    affected_versions: vers:nuget/6.8.0
    fixed_versions: vers:nuget/6.8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-68w7-72jg-6qpp/GHSA-68w7-72jg-6qpp.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/NuGet/NuGet.Client
    reference_type:
    reference_id:
  - url: https://github.com/NuGet/NuGet.Client/commit/3333f352ec47f0ebb489f20353dea7017f6cb00c
    reference_type:
    reference_id:
  - url: https://github.com/NuGet/NuGet.Client/commit/5e1ba955cca14328d2cb5723f211d5fbc9bcacb3
    reference_type:
    reference_id:
  - url: https://github.com/NuGet/NuGet.Client/security/advisories/GHSA-68w7-72jg-6qpp
    reference_type:
    reference_id:
  - url: https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-0057
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240208-0007
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-0057
    reference_type:
    reference_id: CVE-2024-0057
