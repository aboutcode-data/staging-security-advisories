advisory_id: GHSA-3rcw-9p9x-582v
datasource_id: github_osv_importer_v2/GHSA-3rcw-9p9x-582v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-3rcw-9p9x-582v/GHSA-3rcw-9p9x-582v.json
aliases:
  - CVE-2021-41228
summary: "Code injection in `saved_model_cli`\n### Impact\nTensorFlow's `saved_model_cli` tool\
  \ is vulnerable to a code injection as it [calls `eval` on user supplied strings](https://github.com/tensorflow/tensorflow/blob/87462bfac761435a46641ff2f10ad0b6e5414a4b/tensorflow/python/tools/saved_model_cli.py#L524-L550)\n\
  \  \n```python\ndef preprocess_input_exprs_arg_string(input_exprs_str):\n  ... \n  for input_raw\
  \ in filter(bool, input_exprs_str.split(';')):\n    ...\n    input_key, expr = input_raw.split('=',\
  \ 1)\n    input_dict[input_key] = eval(expr)\n  ...\n``` \n  \nThis can be used by attackers\
  \ to run arbitrary code on the plaform where the CLI tool runs.\nHowever, given that the tool\
  \ is always run manually, the impact of this is not severe. We have patched this by adding\
  \ a `safe` flag which defaults to `True` and an explicit warning for users. \n\n### Patches\n\
  We have patched the issue in GitHub commit [8b202f08d52e8206af2bdb2112a62fafbc546ec7](https://github.com/tensorflow/tensorflow/commit/8b202f08d52e8206af2bdb2112a62fafbc546ec7).\n\
  \nThe fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow\
  \ 2.6.1, TensorFlow 2.5.2, and TensorFlow 2.4.4, as these are also affected and still in supported\
  \ range.\n\n### For more information\nPlease consult [our security guide](https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md)\
  \ for more information regarding the security model and how to contact us with issues and\
  \ questions.\n\n### Attribution\nThis vulnerability has been reported by Omer Kaspi from Vdoo."
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/>=2.5.0|<2.5.2
    fixed_versions: vers:pypi/2.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/<2.4.4
    fixed_versions: vers:pypi/2.4.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/>=2.6.0|<2.6.1
    fixed_versions: vers:pypi/2.6.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/>=2.5.0|<2.5.2
    fixed_versions: vers:pypi/2.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/<2.4.4
    fixed_versions: vers:pypi/2.4.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/>=2.6.0|<2.6.1
    fixed_versions: vers:pypi/2.6.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/>=2.5.0|<2.5.2
    fixed_versions: vers:pypi/2.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/<2.4.4
    fixed_versions: vers:pypi/2.4.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/>=2.6.0|<2.6.1
    fixed_versions: vers:pypi/2.6.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-3rcw-9p9x-582v/GHSA-3rcw-9p9x-582v.json
  - score: '5.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:H/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-3rcw-9p9x-582v/GHSA-3rcw-9p9x-582v.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
  - CWE-94
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-637.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-835.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-420.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/8b202f08d52e8206af2bdb2112a62fafbc546ec7
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-3rcw-9p9x-582v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41228
    reference_type:
    reference_id: CVE-2021-41228
