advisory_id: GHSA-hg5x-3w3x-7g96
datasource_id: github_osv_importer_v2/GHSA-hg5x-3w3x-7g96
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-hg5x-3w3x-7g96/GHSA-hg5x-3w3x-7g96.json
aliases:
  - CVE-2023-29512
summary: |
  xwiki-platform-web-templates vulnerable to Eval Injection
  ### Impact
  Any user with edit rights on a page (e.g., it's own user page), can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation. The root cause is improper escaping of the information loaded from attachments in `imported.vm`, `importinline.vm`, and `packagelist.vm`. This page is installed by default.

  Reproduction steps are described in https://jira.xwiki.org/browse/XWIKI-20267

  ### Patches
  The vulnerability has been patched in XWiki 15.0-rc-1, 14.10.1, 14.4.8, and 13.10.11.

  ### Workarounds
  The issue can be fixed by applying this [patch](https://github.com/xwiki/xwiki-platform/commit/e4bbdc23fea0be4ef1921d1a58648028ce753344) on `imported.vm`, `importinline.vm`, and `packagelist.vm`.

  ### References
  - https://github.com/xwiki/xwiki-platform/commit/e4bbdc23fea0be4ef1921d1a58648028ce753344
  - https://jira.xwiki.org/browse/XWIKI-20267


  ### For more information

  If you have any questions or comments about this advisory:

  *    Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  *    Email us at [Security Mailing List](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=1.0B1|<13.10.11
    fixed_versions: vers:maven/13.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=14.0-rc-1|<14.4.8
    fixed_versions: vers:maven/14.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=14.5|<14.10.1
    fixed_versions: vers:maven/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-hg5x-3w3x-7g96/GHSA-hg5x-3w3x-7g96.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-74
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/e4bbdc23fea0be4ef1921d1a58648028ce753344
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-hg5x-3w3x-7g96
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20267
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29512
    reference_type:
    reference_id: CVE-2023-29512
