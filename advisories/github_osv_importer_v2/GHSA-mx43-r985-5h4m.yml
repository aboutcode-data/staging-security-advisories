advisory_id: GHSA-mx43-r985-5h4m
datasource_id: github_osv_importer_v2/GHSA-mx43-r985-5h4m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-mx43-r985-5h4m/GHSA-mx43-r985-5h4m.json
aliases:
  - CVE-2020-12283
summary: |
  Open redirect vulnerability in Sourcegraph
  ### Impact

  An open redirect vulnerability that allows users to be targeted for phishing attacks has been found in Sourcegraph instances configured with OAuth, OpenID, or SAML authentication enabled. Users targeted by these phishing attacks could have their authentication tokens silently harvested by an attacker.

  ### Specific Go Packages Affected
  github.com/sourcegraph/sourcegraph/cmd/frontend/auth

  ### Resolution

  Sourcegraph v3.14.4 and v3.15.1 have been released which resolve the vulnerability. ([associated change](https://github.com/sourcegraph/sourcegraph/pull/10167))

  ### Workarounds

  Disabling OAuth, OpenID and/or SAML sign-in options until upgraded to the patched versions will secure Sourcegraph / workaround the issue.

  ### Timeline

  - Apr 23, 8 AM PST: GitHub Security Lab reported the issue to Sourcegraph.
  - Apr 23, 11 PM PST: A Sourcegraph engineer proposed a resolution for the vulnerability. https://github.com/sourcegraph/sourcegraph/pull/10167
  - Apr 24, 3 AM PST: The proposed resolution was reviewed, approved, and merged.
  - Apr 28, 2 PM PST: Patch releases for 3.14.4 and 3.15.1 were published.
  - Apr 29, 10 PM PST: Mitre publicly disclosed [CVE-2020-12283](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12283).
  - Apr 30, 11 AM PST: Sourcegraph issued a GitHub security advisory and notified all affected users.

  ### References

  - [Mitre: CVE-2020-12283](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12283)
  - [GitHub Security Lab: GHSL-2020-085](https://securitylab.github.com/advisories/GHSL-2020-085-sourcegraph)
  - [detectify's blog post on open redirect vulnerabilities
  ](https://blog.detectify.com/2019/05/16/the-real-impact-of-an-open-redirect/)

  ### For more information

  If you have any questions or comments about this advisory, please contact us at [support@sourcegraph.com](mailto:support@sourcegraph.com) and include `CVE-2020-12283` in the title.
impacted_packages: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-mx43-r985-5h4m/GHSA-mx43-r985-5h4m.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/sourcegraph/sourcegraph
    reference_type:
    reference_id:
  - url: https://github.com/sourcegraph/sourcegraph/blob/master/CHANGELOG.md
    reference_type:
    reference_id:
  - url: https://github.com/sourcegraph/sourcegraph/commit/c0f48172e815c7f66471a38f0a06d1fc32a77a64
    reference_type:
    reference_id:
  - url: https://github.com/sourcegraph/sourcegraph/compare/v3.15.0...v3.15.1
    reference_type:
    reference_id:
  - url: https://github.com/sourcegraph/sourcegraph/pull/10167
    reference_type:
    reference_id:
  - url: https://github.com/sourcegraph/sourcegraph/security/advisories/GHSA-mx43-r985-5h4m
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2020-085-sourcegraph
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-12283
    reference_type:
    reference_id: CVE-2020-12283
