advisory_id: GHSA-6hf3-mhgc-cm65
datasource_id: github_osv_importer_v2/GHSA-6hf3-mhgc-cm65
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-6hf3-mhgc-cm65/GHSA-6hf3-mhgc-cm65.json
aliases:
  - CVE-2026-27004
summary: |
  OpenClaw session tool visibility hardening and Telegram webhook secret fallback
  ## Vulnerability

  In some shared-agent deployments, OpenClaw session tools (`sessions_list`, `sessions_history`, `sessions_send`) allowed broader session targeting than some operators intended. This is primarily a configuration/visibility-scoping issue in multi-user environments where peers are not equally trusted.

  In Telegram webhook mode, monitor startup also did not fall back to per-account `webhookSecret` when only the account-level secret was configured.

  ## Typical Use Case Context

  Most regular OpenClaw deployments run a single agent, or run in trusted environments. In those setups, practical risk from this issue is generally low.

  ## Impact

  - Shared-agent, multi-user, less-trusted environments: session-tool access could expose transcript content across peer sessions.
  - Single-agent or trusted environments: practical impact is limited.
  - Telegram webhook mode: account-level secret wiring could be missed unless an explicit monitor webhook secret override was provided.

  ## Affected Packages / Versions

  - Package: npm `openclaw`
  - Affected versions: `<= 2026.2.14`
  - Patched version: `2026.2.15` (planned next release)

  ## Remediation

  - Add and enforce `tools.sessions.visibility` (`self | tree | agent | all`) across session tools, defaulting to `tree`.
  - Keep sandbox clamping behavior so sandboxed runs can be restricted to spawned/session-tree visibility.
  - Resolve Telegram webhook secret from account config fallback in monitor webhook startup.

  ## Fix Commit(s)

  - `c6c53437f7da033b94a01d492e904974e7bda74c`

  Thanks @aether-ai-agent for reporting.
impacted_packages:
  - purl: pkg:npm/openclaw
    affected_versions: vers:npm/<2026.2.15
    fixed_versions: vers:npm/2026.2.15
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-6hf3-mhgc-cm65/GHSA-6hf3-mhgc-cm65.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-209
  - CWE-346
references:
  - url: https://github.com/openclaw/openclaw
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/commit/c6c53437f7da033b94a01d492e904974e7bda74c
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/security/advisories/GHSA-6hf3-mhgc-cm65
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-27004
    reference_type:
    reference_id:
