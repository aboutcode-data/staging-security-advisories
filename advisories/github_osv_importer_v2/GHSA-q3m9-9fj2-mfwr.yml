advisory_id: GHSA-q3m9-9fj2-mfwr
datasource_id: github_osv_importer_v2/GHSA-q3m9-9fj2-mfwr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-q3m9-9fj2-mfwr/GHSA-q3m9-9fj2-mfwr.json
aliases:
  - CVE-2021-32806
summary: |
  URL Redirection to Untrusted Site ('Open Redirect') in Products.isurlinportal
  ### Impact
  Various parts of Plone use the 'is url in portal' check for security, mostly to see if it is safe to redirect to a url. A url like `https://example.org` is not in the portal.
  But the url `https:example.org` without slashes tricks our code and it _is_ considered to be in the portal.
  When redirecting, some browsers go to `https://example.org`, others give an error.
  Attackers may use this to redirect you to their site, especially as part of a phishing attack.

  ### Patches
  The problem has been patched in `Products.isurlinportal` 1.2.0.
  This is a recommended upgrade for all users of Plone 4.3 and 5, on Python 2.7 or higher.
  It has not been tested on earlier Plone or Python versions.
  Upcoming Plone 5.2.5 and higher will include the new version.

  ### Discovered
  This vulnerability was discovered and reported by Yuji Tounai of Mitsui Bussan Secure Directions, Inc. Thank you!

  ### For more information
  If you have any questions or comments about this advisory:
  * Email the Plone Security Team at [security@plone.org](mailto:security@plone.org), especially when you think you have discovered a security problem or when you are not sure.
  * Open an issue in [the tracker](https://github.com/plone/Products.isurlinportal/issues) if your question or comment can be public.
impacted_packages:
  - purl: pkg:pypi/products.isurlinportal
    affected_versions: vers:pypi/<1.2.0
    fixed_versions: vers:pypi/1.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-q3m9-9fj2-mfwr/GHSA-q3m9-9fj2-mfwr.json
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-q3m9-9fj2-mfwr/GHSA-q3m9-9fj2-mfwr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: http://jvn.jp/en/jp/JVN50804280/index.html
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.isurlinportal
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.isurlinportal/commit/d4fd34990d18adf05a10dc5e2bb4b066798280ba
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.isurlinportal/security/advisories/GHSA-q3m9-9fj2-mfwr
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/products-isurlinportal/PYSEC-2021-323.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32806
    reference_type:
    reference_id: CVE-2021-32806
