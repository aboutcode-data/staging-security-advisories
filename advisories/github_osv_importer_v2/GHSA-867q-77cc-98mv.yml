advisory_id: GHSA-867q-77cc-98mv
datasource_id: github_osv_importer_v2/GHSA-867q-77cc-98mv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-867q-77cc-98mv/GHSA-867q-77cc-98mv.json
aliases:
  - CVE-2021-21429
summary: |
  Creation of Temporary File in Directory with Insecure Permissions in the OpenAPI Generator Maven plugin
  ### Impact

  Using `File.createTempFile` in JDK will result in creating and using insecure temporary files that can leave application and system data vulnerable to attacks. This vulnerability only impacts unix-like systems where the local system temporary directory is shared between all users. This vulnerability does not impact Windows or modern versions of MacOS.

  OpenAPI Generator Maven plug-in creates insecure temporary files during the code generation process. It creates insecure temporary files to store the OpenAPI specification files provided by the users and these temporary files can be read by any users in the system.

  The impact of this vulnerability is information disclosure of the contents of the specification file to other local users.

  ### Patches
  The issue has been patched with `Files.createTempFile` and released in the v5.1.0 stable version.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [OpenAPI Generator Github repo](https://github.com/openAPITools/openapi-generator/)
  * Email us at [security@openapitools.org](mailto:security@openapitools.org)
impacted_packages:
  - purl: pkg:maven/org.openapitools/openapi-generator-maven-plugin
    affected_versions: vers:maven/<5.1.0
    fixed_versions: vers:maven/5.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-867q-77cc-98mv/GHSA-867q-77cc-98mv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-377
  - CWE-552
  - CWE-378
  - CWE-379
references:
  - url: https://github.com/OpenAPITools/openapi-generator/blob/06ad7a51eff04393203cfa715e54e1fb59d984fe/modules/openapi-generator-maven-plugin/src/main/java/org/openapitools/codegen/plugin/CodeGenMojo.java#L782-L799
    reference_type:
    reference_id:
  - url: https://github.com/OpenAPITools/openapi-generator/pull/8795
    reference_type:
    reference_id:
  - url: https://github.com/OpenAPITools/openapi-generator/security/advisories/GHSA-867q-77cc-98mv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21429
    reference_type:
    reference_id: CVE-2021-21429
