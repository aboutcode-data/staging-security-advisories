advisory_id: GHSA-69ch-w2m2-3vjp
datasource_id: github_osv_importer_v2/GHSA-69ch-w2m2-3vjp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-69ch-w2m2-3vjp/GHSA-69ch-w2m2-3vjp.json
aliases:
  - CVE-2022-32149
summary: |
  golang.org/x/text/language Denial of service via crafted Accept-Language header
  The BCP 47 tag parser has quadratic time complexity due to inherent aspects of its design. Since the parser is, by design, exposed to untrusted user input, this can be leveraged to force a program to consume significant time parsing Accept-Language headers. The parser cannot be easily rewritten to fix this behavior for various reasons. Instead the solution implemented in this CL is to limit the total complexity of tags passed into ParseAcceptLanguage by limiting the number of dashes in the string to 1000. This should be more than enough for the majority of real world use cases, where the number of tags being sent is likely to be in the single digits.

  ### Specific Go Packages Affected
  golang.org/x/text/language
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-69ch-w2m2-3vjp/GHSA-69ch-w2m2-3vjp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-772
references:
  - url: https://github.com/golang/go/issues/56152
    reference_type:
    reference_id:
  - url: https://github.com/golang/text
    reference_type:
    reference_id:
  - url: https://github.com/golang/text/commit/434eadcdbc3b0256971992e8c70027278364c72c
    reference_type:
    reference_id:
  - url: https://go.dev/cl/442235
    reference_type:
    reference_id:
  - url: https://go.dev/issue/56152
    reference_type:
    reference_id:
  - url: https://groups.google.com/g/golang-announce/c/-hjNw559_tE/m/KlGTfid5CAAJ
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-1059
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230203-0006
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-32149
    reference_type:
    reference_id: CVE-2022-32149
