advisory_id: GHSA-557v-xcg6-rm5m
datasource_id: github_osv_importer_v2/GHSA-557v-xcg6-rm5m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-557v-xcg6-rm5m/GHSA-557v-xcg6-rm5m.json
aliases:
  - CVE-2023-51651
summary: |
  Potential URI resolution path traversal in the AWS SDK for PHP
  ### Impact
  Within the scope of requests to S3 object keys and/or prefixes containing a Unix double-dot, a URI path traversal is possible. The issue exists in the`buildEndpoint` method in the `RestSerializer` component of the AWS SDK for PHP v3 prior to 3.288.1. The `buildEndpoint` method relies on the Guzzle Psr7 `UriResolver` utility, which strips dot segments from the request path in accordance with RFC 3986. Under certain conditions, this could lead to an arbitrary object being accessed.

  Versions of the AWS SDK for PHP v3 before 3.288.1 are affected by this issue.

  ### Patches
  Upgrade to the AWS SDK for PHP >= 3.288.1, if you are on version < 3.288.1.

  ### References
  RFC 3986 - [https://datatracker.ietf.org/doc/html/rfc3986](https://datatracker.ietf.org/doc/html/rfc3986#section-5.2.4)

  ### For more information
  If you have any questions or comments about this advisory, please contact [AWS's Security team](mailto:aws-security@amazon.com).
impacted_packages:
  - purl: pkg:composer/aws/aws-sdk-php
    affected_versions: vers:composer/<3.288.1
    fixed_versions: vers:composer/3.288.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-557v-xcg6-rm5m/GHSA-557v-xcg6-rm5m.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/aws/aws-sdk-php
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sdk-php/commit/aebc9f801438746ac4ade327551576cb75f635f2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sdk-php/releases/tag/3.288.1
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sdk-php/security/advisories/GHSA-557v-xcg6-rm5m
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/aws/aws-sdk-php/CVE-2023-51651.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-51651
    reference_type:
    reference_id: CVE-2023-51651
