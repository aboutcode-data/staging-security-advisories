advisory_id: GHSA-m2jh-fxw4-gphm
datasource_id: github_osv_importer_v2/GHSA-m2jh-fxw4-gphm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-m2jh-fxw4-gphm/GHSA-m2jh-fxw4-gphm.json
aliases:
  - CVE-2021-41114
summary: |
  HTTP Host Header Injection
  ### Meta
  * CVSS: `CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:F/RL:O/RC:C` (3.5)

  ### Problem
  It has been discovered that TYPO3 CMS is susceptible to host spoofing due to improper validation of the HTTP _Host_ header. TYPO3 uses the HTTP _Host_ header, for example, to generate absolute URLs during the frontend rendering process. Since the host header itself is provided by the client, it can be forged to any value, even in a name-based virtual hosts environment.

  This vulnerability is the same as described in [TYPO3-CORE-SA-2014-001 (CVE-2014-3941)](https://typo3.org/security/advisory/typo3-core-sa-2014-001/). A regression, introduced during TYPO3 v11 development, led to this situation. The already existing setting _$GLOBALS['TYPO3_CONF_VARS']['SYS']['trustedHostsPattern']_ (used as an effective mitigation strategy in previous TYPO3 versions) was not evaluated anymore, and reintroduced the vulnerability.

  ### Solution
  Update your instance to TYPO3 version 11.5.0 which addresses the problem described.

  ### Credits
  Thanks to TYPO3 framework merger Benjamin Franzke who reported and fixed the issue.

  ### References
  * [TYPO3-CORE-SA-2021-015](https://typo3.org/security/advisory/typo3-core-sa-2021-015)
  * [CVE-2014-3941](https://nvd.nist.gov/vuln/detail/CVE-2014-3941) reintroduced in TYPO3 v11.0.0
impacted_packages:
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/>=11.0.0|<11.5.0
    fixed_versions: vers:composer/11.5.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms
    affected_versions: vers:composer/>=11.0.0|<11.5.0
    fixed_versions: vers:composer/11.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-m2jh-fxw4-gphm/GHSA-m2jh-fxw4-gphm.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-644
  - CWE-20
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms-core/CVE-2021-41114.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms/CVE-2021-41114.yaml
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3/commit/5cbff85506cebe343e5ae59228977547cf8e3cf4
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3/security/advisories/GHSA-m2jh-fxw4-gphm
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2021-015
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2014-3941
    reference_type:
    reference_id: CVE-2014-3941
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41114
    reference_type:
    reference_id: CVE-2021-41114
