advisory_id: GHSA-8xww-x3g3-6jcv
datasource_id: github_osv_importer_v2/GHSA-8xww-x3g3-6jcv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-8xww-x3g3-6jcv/GHSA-8xww-x3g3-6jcv.json
aliases:
  - CVE-2023-22795
summary: |
  ReDoS based DoS vulnerability in Action Dispatch
  There is a possible regular expression based DoS vulnerability in Action Dispatch related to the If-None-Match header. This vulnerability has been assigned the CVE identifier CVE-2023-22795.

  Versions Affected: All Not affected: None Fixed Versions: 5.2.8.15 (Rails LTS), 6.1.7.1, 7.0.4.1

  Impact

  A specially crafted HTTP If-None-Match header can cause the regular expression engine to enter a state of catastrophic backtracking, when on a version of Ruby below 3.2.0. This can cause the process to use large amounts of CPU and memory, leading to a possible DoS vulnerability All users running an affected release should either upgrade or use one of the workarounds immediately.
  Releases

  The FIXED releases are available at the normal locations.
  Workarounds

  We recommend that all users upgrade to one of the FIXED versions. In the meantime, users can mitigate this vulnerability by using a load balancer or other device to filter out malicious If-None-Match headers before they reach the application.

  Users on Ruby 3.2.0 or greater are not affected by this vulnerability.
  Patches

  To aid users who arenâ€™t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.

      6-1-Avoid-regex-backtracking-on-If-None-Match-header.patch - Patch for 6.1 series
      7-0-Avoid-regex-backtracking-on-If-None-Match-header.patch - Patch for 7.0 series

  Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=4.0.0.beta1|<6.1.7.1
    fixed_versions: vers:gem/6.1.7.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=7.0.0|<7.0.4.1
    fixed_versions: vers:gem/7.0.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
references:
  - url: https://discuss.rubyonrails.org/t/cve-2023-22795-possible-redos-based-dos-vulnerability-in-action-dispatch/82118
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/8d82687f3b04b2803320b64f985308239a8c3d2f
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/8dc45950619a4c64d16fb9370570c996d201f9b0
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/cd461c3e64e09cdcb1e379d1c35423c5e2caa592
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/releases/tag/v6.1.7.1
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/releases/tag/v7.0.4.1
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2023-22795.yml
    reference_type:
    reference_id:
  - url: https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-22795
    reference_type:
    reference_id: CVE-2023-22795
