advisory_id: GHSA-8477-3v39-ggpm
datasource_id: github_osv_importer_v2/GHSA-8477-3v39-ggpm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-8477-3v39-ggpm/GHSA-8477-3v39-ggpm.json
aliases:
  - CVE-2018-5382
summary: |
  Improper Validation of Integrity Check Value in Bouncy Castle
  The default BKS keystore use an HMAC that is only 16 bits long, which can allow an attacker to compromise the integrity of a BKS keystore. Bouncy Castle release 1.47 changes the BKS format to a format which uses a 160 bit HMAC instead. This applies to any BKS keystore generated prior to BC 1.47. For situations where people need to create the files for legacy reasons a specific keystore type "BKS-V1" was introduced in 1.49. It should be noted that the use of "BKS-V1" is discouraged by the library authors and should only be used where it is otherwise safe to do so, as in where the use of a 16 bit checksum for the file integrity check is not going to cause a security issue in itself.
impacted_packages:
  - purl: pkg:maven/org.bouncycastle/bcprov-jdk15on
    affected_versions: vers:maven/<1.50
    fixed_versions: vers:maven/1.50
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-8477-3v39-ggpm/GHSA-8477-3v39-ggpm.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-354
references:
  - url: https://access.redhat.com/errata/RHSA-2018:2927
    reference_type:
    reference_id:
  - url: https://www.bouncycastle.org/releasenotes.html
    reference_type:
    reference_id:
  - url: https://www.kb.cert.org/vuls/id/306792
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuoct2020.html
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/103453
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-5382
    reference_type:
    reference_id: CVE-2018-5382
