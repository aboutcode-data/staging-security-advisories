advisory_id: GHSA-86rg-pf4c-5grg
datasource_id: github_osv_importer_v2/GHSA-86rg-pf4c-5grg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-86rg-pf4c-5grg/GHSA-86rg-pf4c-5grg.json
aliases:
  - CVE-2023-6944
summary: |
  @backstage/backend-app-api leaks GitLab access tokens
  A flaw was found in the Red Hat Developer Hub (RHDH). The catalog-import function leaks GitLab access tokens on the frontend when the base64 encoded GitLab token includes a newline at the end of the string. The sanitized error can display on the frontend, including the raw access token. Upon gaining access to this token and depending on permissions, an attacker could push malicious code to repositories, delete resources in Git, revoke or generate new keys, and sign code illegitimately.
impacted_packages:
  - purl: pkg:npm/%40backstage/backend-app-api
    affected_versions: vers:npm/<0.5.9-next.1
    fixed_versions: vers:npm/0.5.9-next.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-86rg-pf4c-5grg/GHSA-86rg-pf4c-5grg.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-209
references:
  - url: https://access.redhat.com/security/cve/CVE-2023-6944
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2255204
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/blob/master/docs/releases/v1.21.0-next.2-changelog.md
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/commit/0382db60f6c8e8715a702bde6408ad10a48d8e11
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/issues/21503
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/pull/21582
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-6944
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-6944
    reference_type:
    reference_id: CVE-2023-6944
  - url: https://access.redhat.com/errata/RHBA-2024:5869
    reference_type:
    reference_id: RHBA-2024:5869
