advisory_id: GHSA-2xx4-jj5v-6mff
datasource_id: github_osv_importer_v2/GHSA-2xx4-jj5v-6mff
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-2xx4-jj5v-6mff/GHSA-2xx4-jj5v-6mff.json
aliases:
  - CVE-2023-37896
summary: "Nuclei Path Traversal vulnerability\n## Overview\n\nWe have identified and addressed\
  \ a security issue in the Nuclei project that affected users utilizing Nuclei as **Go code\
  \ (SDK)** running **custom templates**. This issue did not affect CLI users. The problem was\
  \ related to sanitization issues with payloads loading in `sandbox` mode.\n\n## Details\n\n\
  In the previous versions, there was a potential risk with payloads loading in sandbox mode.\
  \ The issue occurred due to relative paths not being converted to absolute paths before doing\
  \ the check for `sandbox` flag allowing arbitrary files to be read on the filesystem in certain\
  \ cases when using Nuclei from `Go` SDK implementation. \n\nThis issue has been fixed in the\
  \ latest release, v2.9.9. We have also enabled sandbox by default for filesystem loading.\
  \ This can be optionally disabled if required.\n\nThe `-sandbox` option has been **deprecated**\
  \ and is now divided into two new options: `-lfa` (allow local file access) which is disabled\
  \ by default and `-lna` (restrict local network access) which can be optionally disabled by\
  \ user. The `-lfa` allows file (payload) access anywhere on the system (disabling sandbox\
  \ effectively), and `-lna` blocks connections to the local/private network.\n\n## Affected\
  \ Versions\n\nThis issue affected all versions of Nuclei prior to v2.9.9.\n\n## Patches\n\n\
  We recommend all users upgrade to the latest version, [v2.9.9](https://github.com/projectdiscovery/nuclei/releases/tag/v2.9.9),\
  \ which includes the security fix.\n\n### References\n\n- [patch](https://github.com/projectdiscovery/nuclei/pull/3927)\n\
  - [releases](https://github.com/projectdiscovery/nuclei/releases/tag/v2.9.9)\n\n## Acknowledgments\n\
  \nWe would like to thank **keomutchoiboi** who reported this issue to us via our security\
  \ email, [security@projectdiscovery.io](mailto:security@projectdiscovery.io). We appreciate\
  \ the responsible disclosure of this issue."
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-2xx4-jj5v-6mff/GHSA-2xx4-jj5v-6mff.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/projectdiscovery/nuclei
    reference_type:
    reference_id:
  - url: https://github.com/projectdiscovery/nuclei/pull/3927
    reference_type:
    reference_id:
  - url: https://github.com/projectdiscovery/nuclei/releases/tag/v2.9.9
    reference_type:
    reference_id:
  - url: https://github.com/projectdiscovery/nuclei/security/advisories/GHSA-2xx4-jj5v-6mff
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-37896
    reference_type:
    reference_id: CVE-2023-37896
