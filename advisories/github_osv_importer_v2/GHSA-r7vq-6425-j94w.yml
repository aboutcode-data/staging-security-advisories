advisory_id: GHSA-r7vq-6425-j94w
datasource_id: github_osv_importer_v2/GHSA-r7vq-6425-j94w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-r7vq-6425-j94w/GHSA-r7vq-6425-j94w.json
aliases: []
summary: |
  Python-TUF vulnerable to incorrect threshold signature computation for new root metadata
  ### Impact

  The function `_verify_root_self_signed()`, introduced in [v0.14.0](https://github.com/theupdateframework/tuf/releases/tag/v0.14.0), and which verifies self-signatures in a new root metadata file, counted multiple signatures by any new root key towards the new threshold. That is, any single new root key could theoretically provide enough signatures to meet the threshold for new key self-signatures required during root metadata update.

  A scenario where this attack could be relevant is amazingly unlikely in practice to the point where labeling this issue as a security advisory is potentially overstating the impact of the issue. Given that new root keys only become trusted by the client after a successful root metadata update, which also requires the quorum of signatures from old trusted root keys, this issue has been evaluated as low in severity.

  In particular, in order to exploit this vulnerability, an attacker must:

  1. Control one new root key.
  2. Craft a new root metadata file such that there is a number of signatures by this new root key greater than or equal to the new threshold.
  3. Cause a valid threshold of the old root keys to sign this new root metadata file.
  4. Cause this new root metadata file to be published on the repository.
  5. Cause clients to rotate to this new root metadata file.

  ### Patches
  A [fix](https://github.com/theupdateframework/tuf/commit/83ac7be525b733f79a7e9bc573ec580ec835f179) is available since [version 0.16.0](https://github.com/theupdateframework/tuf/releases/tag/v0.16.0).

  ### Workarounds
  No workarounds are known for this issue.

  ### References
  * Pull request resolving the issue [PR 1218](https://github.com/theupdateframework/tuf/pull/1218)
  * Pull request which introduced the faulty computation of signature threshold on new root metadata [PR 1101](https://github.com/theupdateframework/tuf/pull/1101)
  * A similar previous issue with incorrectly computed signature thresholds in tuf is described in [GHSA-pwqf-9h7j-7mv8](https://github.com/theupdateframework/tuf/security/advisories/GHSA-pwqf-9h7j-7mv8)
impacted_packages:
  - purl: pkg:pypi/tuf
    affected_versions: vers:pypi/<=0.15.0
    fixed_versions: vers:pypi/0.16.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/theupdateframework/python-tuf
    reference_type:
    reference_id:
  - url: https://github.com/theupdateframework/python-tuf/pull/1218
    reference_type:
    reference_id:
  - url: https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-pwqf-9h7j-7mv8
    reference_type:
    reference_id:
  - url: https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-r7vq-6425-j94w
    reference_type:
    reference_id:
  - url: https://github.com/theupdateframework/tuf/pull/1101
    reference_type:
    reference_id:
