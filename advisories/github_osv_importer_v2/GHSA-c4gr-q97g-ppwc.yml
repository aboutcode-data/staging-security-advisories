advisory_id: GHSA-c4gr-q97g-ppwc
datasource_id: github_osv_importer_v2/GHSA-c4gr-q97g-ppwc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-c4gr-q97g-ppwc/GHSA-c4gr-q97g-ppwc.json
aliases:
  - CVE-2024-30250
summary: |
  In Astro-Shield, setting a correct `integrity` attribute to injected code allows to bypass the allow-lists
  ### Impact

  Versions from 1.2.0 to 1.3.1 of Astro-Shield allow to bypass the allow-lists for cross-origin resources by introducing valid `integrity` attributes to the injected code. This implies that the injected SRI hash would be added to the generated CSP header, which would lead the browser to believe that the injected resource is legit.

  To exploit this vulnerability, the attacker needs to first inject code into the rendered pages by exploiting other not-related potential vulnerabilities.

  ### Patches

  Version [1.3.2](https://github.com/kindspells/astro-shield/releases/tag/1.3.2) provides a patch.

  ### Workarounds
  - To not use the middleware functionality of Astro-Shield.
  - To use the middleware functionality of Astro-Shield ONLY for content that cannot be controlled in any way by external users.

  ### References
  _Are there any links users can visit to find out more?_
impacted_packages:
  - purl: pkg:npm/%40kindspells/astro-shield
    affected_versions: vers:npm/>=1.2.0|<1.3.2
    fixed_versions: vers:npm/1.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-c4gr-q97g-ppwc/GHSA-c4gr-q97g-ppwc.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-c4gr-q97g-ppwc/GHSA-c4gr-q97g-ppwc.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-345
references:
  - url: https://github.com/kindspells/astro-shield
    reference_type:
    reference_id:
  - url: https://github.com/kindspells/astro-shield/commit/1221019306f501bf5fa9bcfb5a23a2321d34ba0a
    reference_type:
    reference_id:
  - url: https://github.com/kindspells/astro-shield/commit/5ae8b8ef4f681d3a81431ee7e79d5dec545c6e1f
    reference_type:
    reference_id:
  - url: https://github.com/kindspells/astro-shield/releases/tag/1.3.2
    reference_type:
    reference_id:
  - url: https://github.com/kindspells/astro-shield/security/advisories/GHSA-c4gr-q97g-ppwc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-30250
    reference_type:
    reference_id: CVE-2024-30250
