advisory_id: GHSA-qcgx-7p5f-hxvr
datasource_id: github_osv_importer_v2/GHSA-qcgx-7p5f-hxvr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-qcgx-7p5f-hxvr/GHSA-qcgx-7p5f-hxvr.json
aliases:
  - CVE-2022-24784
summary: |
  Discoverability of user password hash in Statamic CMS
  ## Description

  It was possible to confirm a single character of a user's password hash (just the hash, not the password) using a specially crafted regular expression filter in the users endpoint of the REST API. Many requests could eventually uncover the entire hash.

  The hash would not be in the response, however the presence or absence of a result would confirm if the character was in the right position. It would take a long time since the API has throttling enabled by default.

  Additionally, the REST API would need to be enabled, as well as the users endpoint. Both of which are disabled by default.

  ## Resolution

  Filtering by password or password hash has been disabled.

  ## Credits

  We would like to thank Thibaud Kehler for reporting the issue.
impacted_packages:
  - purl: pkg:composer/statamic/cms
    affected_versions: vers:composer/<3.2.39
    fixed_versions: vers:composer/3.2.39
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/statamic/cms
    affected_versions: vers:composer/>=3.3.0|<3.3.2
    fixed_versions: vers:composer/3.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-qcgx-7p5f-hxvr/GHSA-qcgx-7p5f-hxvr.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-326
  - CWE-200
  - CWE-203
references:
  - url: https://github.com/statamic/cms
    reference_type:
    reference_id:
  - url: https://github.com/statamic/cms/issues/5604
    reference_type:
    reference_id:
  - url: https://github.com/statamic/cms/pull/5568
    reference_type:
    reference_id:
  - url: https://github.com/statamic/cms/security/advisories/GHSA-qcgx-7p5f-hxvr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24784
    reference_type:
    reference_id: CVE-2022-24784
