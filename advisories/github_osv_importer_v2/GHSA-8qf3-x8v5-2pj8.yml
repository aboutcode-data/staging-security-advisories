advisory_id: GHSA-8qf3-x8v5-2pj8
datasource_id: github_osv_importer_v2/GHSA-8qf3-x8v5-2pj8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-8qf3-x8v5-2pj8/GHSA-8qf3-x8v5-2pj8.json
aliases:
  - CVE-2025-54368
summary: |
  uv allows ZIP payload obfuscation through parsing differentials
  ## Impact

  In versions 0.8.5 and earlier of uv, remote ZIP archives were handled in a streamwise fashion, and file entries were not reconciled against the archive's central directory. This enabled two parser differentials against other Python package installers:

  1. An attacker could contrive a ZIP archive that would extract with legitimate contents on some package installers, and malicious contents on others due to multiple local file entries. The attacker could choose which installer to target.
  2. An attacker could contrive a "stacked" ZIP input with multiple internal ZIPs, which would be handled differently by different package installers. The attacker could choose which installer to target.

  In both cases, the outcome is that an attacker can produce a ZIP with a consistent digest that expands differently with different installers.

  The [ZIP standard](https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT) is ambiguous with respect to these behavior differentials. Consequently, these same differentials may be accepted ZIP parsers other than those used in uv. This advisory is for uv in particular, but all consumers of ZIP-based Python package distributions, e.g., pip, are potentially susceptible to similar parser differentials in other ZIP parsers.

  The practical impact of these differentials is limited by a number of factors:

  - To be compromised via this vulnerability, user interaction of some sort is required. In particular, the user must run `uv install $package` with an attacker-controlled `$package`.
  - When using wheel distributions, installation of the malicious package is not sufficient for execution of malicious code, the vicim would need to perform a separate invocation, e.g., `python -c "import $package"`.
  - If a ZIP-based source distribution (which are less common than tarball source distributions), is encountered, malicious code can be executed during package resolution or installation. uv may invoke the malicious code when building the source distribution into a wheel.
  - The practical impact of these differentials is limited by a coordinated fix to [Warehouse](https://github.com/pypi/warehouse), PyPI's backend: Warehouse now rejects ZIPs exhibiting these differentials, limiting the ability of an attacker to distribute malicious ZIP distributions via PyPI. As part of that coordinated fix, a review of Warehouse revealed no evidence of exploitation.

  ## Patches

  Versions 0.8.6 and newer of uv address both of the parser differentials above, by refusing to process ZIPs with duplicated local file entries or stacked contents.

  ## Workarounds

  Users are advised to upgrade to 0.8.6 or newer to address this advisory.

  Most users should experience no breaking changes as a result of the patch above. However, users who do experience breakage should carefully review their distributions for signs of malicious intent. Users may choose to set `UV_INSECURE_NO_ZIP_VALIDATION=1` to revert to the previous behavior.

  ## Attribution

  This vulnerability was discovered separately by two different individuals: Caleb Brown (Google) and Tim Hatch (Netflix).
impacted_packages:
  - purl: pkg:pypi/uv
    affected_versions: vers:pypi/<=0.8.5
    fixed_versions: vers:pypi/0.8.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:P/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-8qf3-x8v5-2pj8/GHSA-8qf3-x8v5-2pj8.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-436
references:
  - url: https://astral.sh/blog/uv-security-advisory-cve-2025-54368
    reference_type:
    reference_id:
  - url: https://blog.pypi.org/posts/2025-08-07-wheel-archive-confusion-attacks
    reference_type:
    reference_id:
  - url: https://github.com/astral-sh/uv
    reference_type:
    reference_id:
  - url: https://github.com/astral-sh/uv/commit/7f1eaf48c193e045ca2c62c4581048765c55505f
    reference_type:
    reference_id:
  - url: https://github.com/astral-sh/uv/security/advisories/GHSA-8qf3-x8v5-2pj8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54368
    reference_type:
    reference_id: CVE-2025-54368
