advisory_id: GHSA-7rh7-c77v-6434
datasource_id: github_osv_importer_v2/GHSA-7rh7-c77v-6434
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-7rh7-c77v-6434/GHSA-7rh7-c77v-6434.json
aliases:
  - CVE-2025-54576
summary: |
  OAuth2-Proxy has authentication bypass in oauth2-proxy skip_auth_routes due to Query Parameter inclusion
  ### Impact
  This vulnerability affects oauth2-proxy deployments using the `skip_auth_routes` configuration option with regex patterns. The vulnerability allows attackers to bypass authentication by crafting URLs with query parameters that satisfy the configured regex patterns, potentially gaining unauthorized access to protected resources.

  The issue stems from `skip_auth_routes` matching against the full request URI (path + query parameters) instead of just the path as documented. This discrepancy enables authentication bypass attacks where attackers append malicious query parameters to access protected endpoints.

  Example Attack:

  * Configuration: `skip_auth_routes = [ "^/foo/.*/bar$" ]`
  * Intended behavior: Allow `/foo/something/bar`
  * Actual vulnerability: Also allows `/foo/critical_endpoint?param=/bar`

  Deployments using `skip_auth_routes` with regex patterns containing wildcards or broad matching patterns are most at risk, especially when backend services ignore unknown query parameters.


  ### Patches
  A patch has been released with version [v7.11.0](https://github.com/oauth2-proxy/oauth2-proxy/releases/tag/v7.11.0).

  ### Workarounds

  Immediate mitigations:

  1. Review regex patterns: Audit all `skip_auth_routes` configurations for overly permissive patterns
  2. Use precise patterns: Replace wildcard patterns with exact path matches where possible
  3. Anchor patterns: Ensure regex patterns are properly anchored (start with `^` and end with `$`)
  4. Path-only matching: Consider implementing custom validation that strips query parameters before regex matching

  Example secure configuration:

  ```toml
  # Instead of: "^/public/.*"
  # Use specific paths: "^/public/assets$", "^/public/health$"
  skip_auth_routes = ["^/public/assets$", "^/public/health$", "^/api/status$"]
   ```
impacted_packages: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-7rh7-c77v-6434/GHSA-7rh7-c77v-6434.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-290
references:
  - url: https://github.com/oauth2-proxy/oauth2-proxy
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/blob/f4b33b64bd66ad28e9b0d63bea51837b83c00ca1/oauthproxy.go#L582-L584
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/blob/f4b33b64bd66ad28e9b0d63bea51837b83c00ca1/pkg/requests/util/util.go#L37-L44
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/commit/9ffafad4b2d2f9f7668e5504565f356a7c047b77
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/releases/tag/v7.11.0
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-7rh7-c77v-6434
    reference_type:
    reference_id:
  - url: https://oauth2-proxy.github.io/oauth2-proxy/configuration/overview/#proxy-options
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54576
    reference_type:
    reference_id: CVE-2025-54576
