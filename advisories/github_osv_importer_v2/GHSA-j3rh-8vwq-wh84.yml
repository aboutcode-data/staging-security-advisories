advisory_id: GHSA-j3rh-8vwq-wh84
datasource_id: github_osv_importer_v2/GHSA-j3rh-8vwq-wh84
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/06/GHSA-j3rh-8vwq-wh84/GHSA-j3rh-8vwq-wh84.json
aliases:
  - CVE-2019-16303
summary: |
  JHipster Kotlin using insecure source of randomness `RandomStringUtils` before v1.2.0
  JHipster Kotlin is using an insecure source of randomness to generate all of its random values. JHipster Kotlin relies upon apache commons lang3 `RandomStringUtils`.

  From the documentation:

  > Caveat: Instances of Random, upon which the implementation of this class relies, are not cryptographically secure.
  > \- https://commons.apache.org/proper/commons-lang/javadocs/api-3.9/org/apache/commons/lang3/RandomStringUtils.html

  Here are the examples of JHipster Kotlin's use of an insecure PRNG:

  https://github.com/jhipster/jhipster-kotlin/blob/193ae8f13c0be686f9687e78bacfedb144c47d8c/generators/server/templates/src/main/kotlin/package/service/util/RandomUtil.kt.ejs#L32

  ## Proof Of Concepts Already Exist

  There has been a POC of taking one RNG value generated `RandomStringUtils` and reversing it to generate all of the past/future RNG values public since March 3rd, 2018.

  https://medium.com/@alex91ar/the-java-soothsayer-a-practical-application-for-insecure-randomness-c67b0cd148cd

  POC Repository: https://github.com/alex91ar/randomstringutils


  ## Potential Impact Technical

  All that is required is to get one password reset token from a JHipster Kotlin generated service and using the POC above, you can reverse what all future password reset tokens to be generated by this server. This allows an attacker to pick and choose what account they would like to takeover by sending account password reset requests for targeted accounts.

  ## Potential Impact Scale

  Not as large as for the original jhipster project as the kotlin blueprint is not that widely used.

  ### Patches

  Update your generated applications to > 1.2.0

  ### Workarounds

  Change the content of `RandomUtil.kt` like this:

  ```kotlin
  import java.security.SecureRandom
  import org.apache.commons.lang3.RandomStringUtils

  private const val DEF_COUNT = 20

  object RandomUtil {
      private val secureRandom: SecureRandom = SecureRandom()

      init {
          secureRandom.nextBytes(byteArrayOf(64.toByte()))
      }

      private fun generateRandomAlphanumericString(): String {
          return RandomStringUtils.random(DEF_COUNT, 0, 0, true, true, null, secureRandom)
      }

      /**
      * Generate a password.
      *
      * @return the generated password.
      */
      fun generatePassword(): String = generateRandomAlphanumericString()
  }
  ```

  Important is to exchange **every** call of `RandomStringUtils.randomAlphaNumeric`.



  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [JHipster Kotlin](https://github.com/jhipster/jhipster-kotlin)
impacted_packages:
  - purl: pkg:npm/generator-jhipster-kotlin
    affected_versions: vers:npm/<1.2.0
    fixed_versions: vers:npm/1.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/06/GHSA-j3rh-8vwq-wh84/GHSA-j3rh-8vwq-wh84.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-338
references:
  - url: https://github.com/jhipster/generator-jhipster
    reference_type:
    reference_id:
  - url: https://github.com/jhipster/generator-jhipster/commit/88448b85fd3e8e49df103f0061359037c2c68ea7
    reference_type:
    reference_id:
  - url: https://github.com/jhipster/generator-jhipster/issues/10401
    reference_type:
    reference_id:
  - url: https://github.com/jhipster/generator-jhipster/security/advisories/GHSA-mwp6-j9wf-968c
    reference_type:
    reference_id:
  - url: https://github.com/jhipster/jhipster-kotlin/commit/deec3587ef7721cf5de5b960d43e9b68beff6193
    reference_type:
    reference_id:
  - url: https://github.com/jhipster/jhipster-kotlin/issues/183
    reference_type:
    reference_id:
  - url: https://github.com/jhipster/jhipster-kotlin/security/advisories/GHSA-j3rh-8vwq-wh84
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r6d243e7e3f25daeb242dacf3def411fba32a9388d3ff84918cb28ddd@%3Cissues.commons.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/rc3f00f5d3d2ec0e2381a3b9096d5f5b4d46ec1587ee7e251a3dbb897@%3Cissues.commons.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/rc87fa35a48b5d70b06af6fb81785ed82e82686eb83307aae6d250dc9@%3Cissues.commons.apache.org%3E
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-GENERATORJHIPSTER-466980
    reference_type:
    reference_id:
  - url: https://www.jhipster.tech/2019/09/13/jhipster-release-6.3.0.html
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1187
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1188
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-16303
    reference_type:
    reference_id: CVE-2019-16303
