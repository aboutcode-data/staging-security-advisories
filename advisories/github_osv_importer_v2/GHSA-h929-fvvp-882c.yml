advisory_id: GHSA-h929-fvvp-882c
datasource_id: github_osv_importer_v2/GHSA-h929-fvvp-882c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-h929-fvvp-882c/GHSA-h929-fvvp-882c.json
aliases: []
summary: |
  Duplicate Advisory: EVE Seals Vault Key With SHA1 PCRs
  ### Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-wc42-fcjp-v8vq. This link is maintained to preserve external references.

  ### Original Description
  Vault Key Sealed With SHA1 PCRs






  The measured boot solution implemented in EVE OS leans on a PCR locking mechanism.

  Different parts of the system update different PCR values in the TPM, resulting in a unique
  value for each PCR entry.

  These PCRs are then used in order to seal/unseal a key from the TPM which is used to
  encrypt/decrypt the “vault” directory.

  This “vault” directory is the most sensitive point in the system and as such, its content should
  be protected.

  This mechanism is noted in Zededa’s documentation as the “measured boot” mechanism,
  designed to protect said “vault”.

  The code that’s responsible for generating and fetching the key from the TPM assumes that
  SHA256 PCRs are used in order to seal/unseal the key, and as such their presence is being
  checked.

  The issue here is that the key is not sealed using SHA256 PCRs, but using SHA1 PCRs.
  This leads to several issues:

  • Machines that have their SHA256 PCRs enabled but SHA1 PCRs disabled, as well
  as not sealing their keys at all, meaning the “vault” is not protected from an attacker.

  • SHA1 is considered insecure and reduces the complexity level required to unseal the
  key in machines which have their SHA1 PCRs enabled.



  An attacker can very easily retrieve the contents of the “vault”, which will effectively render
  the “measured boot” mechanism meaningless.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-h929-fvvp-882c/GHSA-h929-fvvp-882c.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-328
  - CWE-327
references:
  - url: https://asrg.io/security-advisories/cve-2023-43635
    reference_type:
    reference_id:
  - url: https://asrg.io/security-advisories/vault-key-sealed-with-sha1-pcrs
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-43635
    reference_type:
    reference_id: CVE-2023-43635
