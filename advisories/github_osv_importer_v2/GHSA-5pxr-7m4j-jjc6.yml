advisory_id: GHSA-5pxr-7m4j-jjc6
datasource_id: github_osv_importer_v2/GHSA-5pxr-7m4j-jjc6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-5pxr-7m4j-jjc6/GHSA-5pxr-7m4j-jjc6.json
aliases:
  - CVE-2024-37160
summary: |
  Cross-site scripting (XSS) vulnerability in Description metadata
  ### Summary
  Regardless of the role or privileges, no user should be able to inject malicious JavaScript (JS) scripts into the body HTML. an XSS (Cross-Site Scripting) vulnerability, specifically a Stored XSS, which affects all pages of the website. Once the JS script is embedded in the body HTML, the XSS will trigger on any page a victim visits, such as the about, blog, contact, or any other pages, except for the panel.

  ### Impact
  This vulnerability allows attackers to inject malicious JS or HTML through a crafted payload into the vulnerable spot, achieving persistence and attacking numerous visitors or anyone accessing the website. The attack can be widespread and affect many users because the malicious JS will execute on every page, unlike an injection on a specific page (e.g., injecting on the About page would only affect that page). In this case, a single injection point leads to the execution of the malicious JS on all pages.

  ### Patches
  - [**Formwork 1.13.1**](https://github.com/getformwork/formwork/releases/tag/1.13.1) has been released with a patch that solves this vulnerability by escaping all metadata attributes.
  - [**Formwork 2.x** (f531201)](https://github.com/getformwork/formwork/commit/f5312015a5a5e89b95ef2bd07e496f8474d579c5) also escapes metadata attributes.

  ### Details
  An attackers (requires administrator privilege) to execute arbitrary web scripts by modifying site options via /panel/options/site. This type of attack is suitable for persistence, affecting visitors across all pages (except the dashboard).
impacted_packages:
  - purl: pkg:composer/getformwork/formwork
    affected_versions: vers:composer/<1.13.1
    fixed_versions: vers:composer/1.13.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/getformwork/formwork
    affected_versions: vers:composer/2.0.0-beta.1
    fixed_versions: vers:composer/2.0.0-beta.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-5pxr-7m4j-jjc6/GHSA-5pxr-7m4j-jjc6.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/getformwork/formwork
    reference_type:
    reference_id:
  - url: https://github.com/getformwork/formwork/commit/9d471204f7ebb51c3c27131581c2b834315b5e0b
    reference_type:
    reference_id:
  - url: https://github.com/getformwork/formwork/commit/f5312015a5a5e89b95ef2bd07e496f8474d579c5
    reference_type:
    reference_id:
  - url: https://github.com/getformwork/formwork/security/advisories/GHSA-5pxr-7m4j-jjc6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37160
    reference_type:
    reference_id: CVE-2024-37160
