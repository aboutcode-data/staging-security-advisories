advisory_id: GHSA-gwpm-pm6x-h7rj
datasource_id: github_osv_importer_v2/GHSA-gwpm-pm6x-h7rj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-gwpm-pm6x-h7rj/GHSA-gwpm-pm6x-h7rj.json
aliases: []
summary: |
  ZendFramework Cross-site Scripting vector in `Zend_Filter_StripTags`
  `Zend_Filter_StripTags` is a filtering class analogous to PHP's `strip_tags()` function. In addition to stripping HTML tags and selectively keeping those provided in a whitelist, it also provides the ability to whitelist specific attributes to retain per whitelisted tag.

  The reporter discovered that attributes that contained whitespace, and in paricular, line breaks, surrounding the attribute assignment operator would not be stripped, regardless of whether or not they were whitelisted. As examples of input affected:
  ```
  <!-- newlines before and/or after assignment: -->
  <a href="http://framework.zend.com/issues" onclick
  =
  "alert('Broken'); return false;">Issues</a>
  ```
  When passed to the following code:
  ```
  $filter = new Zend_Filter_StripTags(array('a' => array('href')));
  $value  = $filter->($html);
  ```
  then the "onclick" attribute would remain, even though it was not specified in the tag's whitelist. This could open potential cross-site scripting attack (XSS) vectors.

  ## Recommendations
  If you were using `Zend_Filter_StripTags` and utlizing the attribute whitelisting functionality, you should immediately upgrade to Zend Framework 1.7.6 or above; regardless, it is always best to run the most current version of the framework.

  Also, if relying on `Zend_Filter_StripTags` to prevent XSS, the only way to reliably do so is to strip all tags, and never to whitelist. If you are whitelisting, you should consider finding a reliable XSS filter through which to run your output; we recommend HTML Purifier.
impacted_packages:
  - purl: pkg:composer/zendframework/zendframework1
    affected_versions: vers:composer/>=1.7.0|<1.7.6
    fixed_versions: vers:composer/1.7.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-gwpm-pm6x-h7rj/GHSA-gwpm-pm6x-h7rj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://framework.zend.com/security/advisory/ZF2009-02
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/zendframework/zendframework1/ZF2009-02.yaml
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zf1
    reference_type:
    reference_id:
