advisory_id: GHSA-m3c4-prhw-mrx6
datasource_id: github_osv_importer_v2/GHSA-m3c4-prhw-mrx6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-m3c4-prhw-mrx6/GHSA-m3c4-prhw-mrx6.json
aliases:
  - CVE-2026-22864
summary: |
  Deno has an incomplete fix for command-injection prevention on Windows — case-insensitive extension bypass
  ### Summary
  A prior patch aimed to block spawning Windows batch/shell files by returning an error when a spawned path’s extension matched `.bat` or `.cmd`. That check performs a case-sensitive comparison against lowercase literals and therefore can be bypassed when the extension uses alternate casing (for example `.BAT, .Bat`, etc.).

  ### POC
  ```javascript
  const command = new Deno.Command('./test.BAT', {
    args: ['&calc.exe'],
  });
  const child = command.spawn();
  ```
  This causes `calc.exe` to be launched; see the attached screenshot for evidence.

  **Patched in `CVE-2025-61787` — prevents execution of `.bat` and `.cmd` files:**
  ![photo_2025-10-10 02 27 23](https://github.com/user-attachments/assets/43df25e2-e2e1-48aa-8060-cb0a22637f1f)

  **Bypass of the patched vulnerability:**
  ![photo_2025-10-10 02 27 25](https://github.com/user-attachments/assets/2be1afb4-84a1-4883-8e18-6a174fdd3615)


  ### Impact
  The script launches calc.exe on Windows, demonstrating that passing user-controlled arguments to a spawned batch script can result in command-line injection.

  ### Mitigation

  Users should update to Deno v2.5.6 or newer.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-m3c4-prhw-mrx6/GHSA-m3c4-prhw-mrx6.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
references:
  - url: https://github.com/denoland/deno
    reference_type:
    reference_id:
  - url: https://github.com/denoland/deno/releases/tag/v2.5.6
    reference_type:
    reference_id:
  - url: https://github.com/denoland/deno/security/advisories/GHSA-m3c4-prhw-mrx6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22864
    reference_type:
    reference_id:
