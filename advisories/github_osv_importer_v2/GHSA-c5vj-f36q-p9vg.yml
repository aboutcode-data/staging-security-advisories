advisory_id: GHSA-c5vj-f36q-p9vg
datasource_id: github_osv_importer_v2/GHSA-c5vj-f36q-p9vg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-c5vj-f36q-p9vg/GHSA-c5vj-f36q-p9vg.json
aliases:
  - CVE-2023-27580
summary: |
  Password Shucking Vulnerability
  ### Impact
  An improper implementation was found in the password storage process.

  All hashed passwords stored in Shield v1.0.0-beta.3 or earlier are easier to crack than expected due to the vulnerability. Therefore, they should be removed as soon as possible.

  If an attacker gets (1) the user's hashed password by Shield, and (2) the hashed password (SHA-384 hash without salt) from somewhere, the attacker may easily crack the user's password.

  ### Patches
  Upgrade to Shield v1.0.0-beta.4 or later.

  After upgrading, all usersâ€™ hashed passwords should be updated (saved to the database).
  See https://github.com/codeigniter4/shield/blob/develop/UPGRADING.md for details.

  ### Workarounds
  None.

  ### References
  - https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#pre-hashing-passwords
  - https://blog.ircmaxell.com/2015/03/security-issue-combining-bcrypt-with.html
  - https://www.scottbrady91.com/authentication/beware-of-password-shucking

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue or discussion in [codeigniter4/shield](https://github.com/codeigniter4/shield)
  * Email us at [security@codeigniter.com](mailto:security@codeigniter.com)
impacted_packages:
  - purl: pkg:composer/codeigniter4/shield
    affected_versions: vers:composer/<1.0.0-beta.4
    fixed_versions: vers:composer/1.0.0-beta.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-c5vj-f36q-p9vg/GHSA-c5vj-f36q-p9vg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-916
references:
  - url: https://blog.ircmaxell.com/2015/03/security-issue-combining-bcrypt-with.html
    reference_type:
    reference_id:
  - url: https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#pre-hashing-passwords
    reference_type:
    reference_id:
  - url: https://github.com/codeigniter4/shield
    reference_type:
    reference_id:
  - url: https://github.com/codeigniter4/shield/blob/develop/UPGRADING.md
    reference_type:
    reference_id:
  - url: https://github.com/codeigniter4/shield/commit/ea9688dd01d100193d834117dbfc2cfabcf9ea0b
    reference_type:
    reference_id:
  - url: https://github.com/codeigniter4/shield/security/advisories/GHSA-c5vj-f36q-p9vg
    reference_type:
    reference_id:
  - url: https://www.scottbrady91.com/authentication/beware-of-password-shucking
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-27580
    reference_type:
    reference_id: CVE-2023-27580
