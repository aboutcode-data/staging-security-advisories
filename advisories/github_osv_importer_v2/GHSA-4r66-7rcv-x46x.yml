advisory_id: GHSA-4r66-7rcv-x46x
datasource_id: github_osv_importer_v2/GHSA-4r66-7rcv-x46x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-4r66-7rcv-x46x/GHSA-4r66-7rcv-x46x.json
aliases: []
summary: |
  SiYuan vulnerable to RCE via zip slip and Command Injection via PandocBin
  ### Summary
  Siyuan is vulnerable to RCE. The issue stems from a "Zip Slip" vulnerability during zip file extraction, combined with the ability to overwrite system executables and subsequently trigger their execution.

  ### Steps to reproduce
  1. Authenticate
  2. Create zip slip payload with path traversal entry `../../../../opt/siyuan/startup.sh`. startup.sh contains malicious code like:
  ```bash
  #!/bin/sh
  echo 'you have been pwned' > /siyuan/workspace/data/pwned.txt
  echo "pandoc 3.1.0"
  ```
  3. Upload zip to workspace via `/api/file/putFile`
  4. Extract zip via `/api/archive/unzip`, overwrites the existing executable `startup.sh` while maintaining the +x permission
  5. Trigger execution by calling `/api/setting/setExport` with `pandocBin=/opt/siyuan/startup.sh`. This calls `IsValidPandocBin()` which executes `startup.sh --version` that outputs "pandoc 3.1.0" and executes any arbitrary malicious code
impacted_packages: []
severities:
  - score: '8.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-4r66-7rcv-x46x/GHSA-4r66-7rcv-x46x.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/siyuan-note/siyuan
    reference_type:
    reference_id:
  - url: https://github.com/siyuan-note/siyuan/security/advisories/GHSA-4r66-7rcv-x46x
    reference_type:
    reference_id:
