advisory_id: GHSA-3r7g-wrpr-j5g4
datasource_id: github_osv_importer_v2/GHSA-3r7g-wrpr-j5g4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-3r7g-wrpr-j5g4/GHSA-3r7g-wrpr-j5g4.json
aliases:
  - CVE-2022-24857
summary: |
  Improper Authentication in django-mfa3
  ### Impact

  django-mfa3 is a library that implements multi factor authentication for the django web framework. It achieves this by modifying the regular login view. Django however has a second login view for its admin area. This second login view was not modified, so the multi factor authentication can be bypassed.

  You are affected if you have activated both django-mfa3 (< 0.5.0) and django.contrib.admin and have not taken any other measures to prevent users from accessing the admin login view.

  ### Patches

  The issue has been fixed in django-mfa3 0.5.0.

  ### Workarounds

  It is possible to work around the issue by overwriting the admin login route, e.g. by adding the following URL definition *before* the admin routes:

      url('admin/login/', lambda request: redirect(settings.LOGIN_URL)

  ### References

  - [django-mfa3 changelog](https://github.com/xi/django-mfa3/blob/main/CHANGES.md#050-2022-04-15)
impacted_packages:
  - purl: pkg:pypi/django-mfa3
    affected_versions: vers:pypi/<0.5.0
    fixed_versions: vers:pypi/0.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-3r7g-wrpr-j5g4/GHSA-3r7g-wrpr-j5g4.json
  - score: '8.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-3r7g-wrpr-j5g4/GHSA-3r7g-wrpr-j5g4.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/django-mfa3/PYSEC-2022-192.yaml
    reference_type:
    reference_id:
  - url: https://github.com/xi/django-mfa3
    reference_type:
    reference_id:
  - url: https://github.com/xi/django-mfa3/blob/main/CHANGES.md#050-2022-04-15
    reference_type:
    reference_id:
  - url: https://github.com/xi/django-mfa3/commit/32f656e22df120b84bdf010e014bb19bd97971de
    reference_type:
    reference_id:
  - url: https://github.com/xi/django-mfa3/security/advisories/GHSA-3r7g-wrpr-j5g4
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220609-0003
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24857
    reference_type:
    reference_id: CVE-2022-24857
