advisory_id: GHSA-92v7-pq4h-58j5
datasource_id: github_osv_importer_v2/GHSA-92v7-pq4h-58j5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2017/10/GHSA-92v7-pq4h-58j5/GHSA-92v7-pq4h-58j5.json
aliases:
  - CVE-2014-3248
summary: |
  facter, hiera, mcollective-client, and puppet affected by untrusted search path vulnerability
  Untrusted search path vulnerability in Puppet Enterprise 2.8 before 2.8.7, Puppet before 2.7.26 and 3.x before 3.6.2, Facter 1.6.x and 2.x before 2.0.2, Hiera before 1.3.4, and Mcollective before 2.5.2, when running with Ruby 1.9.1 or earlier, allows local users to gain privileges via a Trojan horse file in the current working directory, as demonstrated using (1) `rubygems/defaults/operating_system.rb`, (2) `Win32API.rb`, (3) `Win32API.so`, (4) `safe_yaml.rb`, (5) `safe_yaml/deep.rb`, or (6) `safe_yaml/deep.so`; or (7) `operatingsystem.rb`, (8) `operatingsystem.so`, (9) `osfamily.rb`, or (10) `osfamily.so` in `puppet/confine`.
impacted_packages:
  - purl: pkg:gem/facter
    affected_versions: vers:gem/<1.7.6
    fixed_versions: vers:gem/1.7.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/facter
    affected_versions: vers:gem/>=2.0.0|<2.0.2
    fixed_versions: vers:gem/2.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/hiera
    affected_versions: vers:gem/<1.3.4
    fixed_versions: vers:gem/1.3.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/puppet
    affected_versions: vers:gem/<2.7.26
    fixed_versions: vers:gem/2.7.26
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/puppet
    affected_versions: vers:gem/>=3.0.0|<3.6.2
    fixed_versions: vers:gem/3.6.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/mcollective-client
    affected_versions: vers:gem/<2.5.2
    fixed_versions: vers:gem/2.5.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/facter/CVE-2014-3248.yml
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/hiera/CVE-2014-3248.yml
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/mcollective-client/CVE-2014-3248.yml
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/puppet/CVE-2014-3248.yml
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20141129061319/http://www.securityfocus.com/bid/68035
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20150204183209/http://rowediness.com/2014/06/13/cve-2014-3248-a-little-problem-with-puppet
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20150907182402/http://puppetlabs.com/security/cve/cve-2014-3248
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2014-3248
    reference_type:
    reference_id: CVE-2014-3248
