advisory_id: GHSA-hhh5-2cvx-vmfp
datasource_id: github_osv_importer_v2/GHSA-hhh5-2cvx-vmfp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-hhh5-2cvx-vmfp/GHSA-hhh5-2cvx-vmfp.json
aliases:
  - CVE-2025-66405
summary: |
  Portkey.ai Gateway: Server-Side Request Forgery (SSRF) in Custom Host
  ### Summary
  The gateway determines the destination baseURL by prioritizing the value in the x-portkey-custom-host request header. The proxy route then appends the client-specified path to perform an external fetch. This can be maliciously used by users for SSRF (CWE-918) attack

  ### Impact
  This vulnerability can be exploited to force the server to make requests to arbitrary hosts on the internal network. This could allow an attacker to exfiltrate sensitive data, for instance, by accessing the AWS metadata service.

  ### Patches
  The issue is patched in 1.14.0 (https://github.com/Portkey-AI/gateway/pull/1372)

  The vulnerability resides within the gateway's request processing function which handles the `x-portkey-custom-host` header. This parameter was passed directly or with insufficient validation/sanitization to an internal HTTP request function.

  **The fix (v1.14.0) implements a robust allow-list policy:**

  1. All custom host inputs are now strictly validated to ensure the resulting URI points only to trusted, expected external services.

  2. The implementation now explicitly blocks requests to non-routable IP addresses, loopback addresses, private networks and standard metadata endpoints.

  ### Credit
  This vulnerability was discovered and reported responsibly by @im-soohyun. We thank them for their adherence to coordinated vulnerability disclosure principles.

  ### References
  https://cwe.mitre.org/data/definitions/918.html
impacted_packages:
  - purl: pkg:npm/%40portkey-ai/gateway
    affected_versions: vers:npm/<1.14.0
    fixed_versions: vers:npm/1.14.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-hhh5-2cvx-vmfp/GHSA-hhh5-2cvx-vmfp.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/Portkey-AI/gateway
    reference_type:
    reference_id:
  - url: https://github.com/Portkey-AI/gateway/commit/b5a7825ba5f4e6918deb32d9969899ce2229a885
    reference_type:
    reference_id:
  - url: https://github.com/Portkey-AI/gateway/pull/1372
    reference_type:
    reference_id:
  - url: https://github.com/Portkey-AI/gateway/security/advisories/GHSA-hhh5-2cvx-vmfp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66405
    reference_type:
    reference_id:
