advisory_id: GHSA-43w2-9j62-hq99
datasource_id: github_osv_importer_v2/GHSA-43w2-9j62-hq99
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-43w2-9j62-hq99/GHSA-43w2-9j62-hq99.json
aliases:
  - CVE-2021-25900
summary: |
  Buffer overflow in SmallVec::insert_many
  A bug in the SmallVec::insert_many method caused it to allocate a buffer that was smaller than needed. It then wrote past the end of the buffer, causing a buffer overflow and memory corruption on the heap. This bug was only triggered if the iterator passed to insert_many yielded more items than the lower bound returned from its size_hint method.

  The flaw was corrected in smallvec 0.6.14 and 1.6.1, by ensuring that additional space is always reserved for each item inserted. The fix also simplified the implementation of insert_many to use less unsafe code, so it is easier to verify its correctness.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-43w2-9j62-hq99/GHSA-43w2-9j62-hq99.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-787
references:
  - url: https://github.com/servo/rust-smallvec
    reference_type:
    reference_id:
  - url: https://github.com/servo/rust-smallvec/commit/5757ac500d4e544485d796b542e4e589749c291b
    reference_type:
    reference_id:
  - url: https://github.com/servo/rust-smallvec/commit/9998ba0694a6b51aa6604748b00b6a98f0a0039e
    reference_type:
    reference_id:
  - url: https://github.com/servo/rust-smallvec/issues/252
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0003.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-25900
    reference_type:
    reference_id: CVE-2021-25900
