advisory_id: GHSA-p4g4-wgrh-qrg2
datasource_id: github_osv_importer_v2/GHSA-p4g4-wgrh-qrg2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-p4g4-wgrh-qrg2/GHSA-p4g4-wgrh-qrg2.json
aliases:
  - CVE-2020-15106
summary: |
  Panic due to malformed WALs in go.etcd.io/etcd
  ### Vulnerability type
  Data Validation

  ### Detail
  The size of a record is stored in the length field of a WAL file and no additional validation is done on this data. Therefore, it is possible to forge an extremely large frame size that can unintentionally panic at the expense of any RAFT participant trying to decode the WAL.

  ### Specific Go Packages Affected
  github.com/etcd-io/etcd/wal

  ### References
  Find out more on this vulnerability in the [security audit report](https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf)

  ### For more information
  If you have any questions or comments about this advisory:
  * Contact the [etcd security committee](https://github.com/etcd-io/etcd/blob/master/security/security-release-process.md#product-security-committee-psc)
impacted_packages: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-p4g4-wgrh-qrg2/GHSA-p4g4-wgrh-qrg2.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/etcd-io/etcd
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/commit/4571e528f49625d3de3170f219a45c3b3d38c675
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/commit/f4b650b51dc4a53a8700700dc12e1242ac56ba07
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/pull/11793
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/security/advisories/GHSA-p4g4-wgrh-qrg2
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2020-0005
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15106
    reference_type:
    reference_id: CVE-2020-15106
