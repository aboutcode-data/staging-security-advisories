advisory_id: GHSA-c33x-xqrf-c478
datasource_id: github_osv_importer_v2/GHSA-c33x-xqrf-c478
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-c33x-xqrf-c478/GHSA-c33x-xqrf-c478.json
aliases:
  - CVE-2024-22189
summary: |
  QUIC's Connection ID Mechanism vulnerable to Memory Exhaustion Attack
  An attacker can cause its peer to run out of memory by sending a large number of NEW_CONNECTION_ID frames that retire old connection IDs. The receiver is supposed to respond to each retirement frame with a RETIRE_CONNECTION_ID frame. The attacker can prevent the receiver from sending out (the vast majority of) these RETIRE_CONNECTION_ID frames by collapsing the peers congestion window (by selectively acknowledging received packets) and by manipulating the peer's RTT estimate.

  I published a more detailed description of the attack and its mitigation in this blog post: https://seemann.io/posts/2024-03-19-exploiting-quics-connection-id-management/.
  I also presented this attack in the IETF QUIC working group session at IETF 119: https://youtu.be/JqXtYcZAtIA?si=nJ31QKLBSTRXY35U&t=3683

  There's no way to mitigate this attack, please update quic-go to a version that contains the fix.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-c33x-xqrf-c478/GHSA-c33x-xqrf-c478.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
  - CWE-400
references:
  - url: https://github.com/quic-go/quic-go
    reference_type:
    reference_id:
  - url: https://github.com/quic-go/quic-go/commit/4a99b816ae3ab03ae5449d15aac45147c85ed47a
    reference_type:
    reference_id:
  - url: https://github.com/quic-go/quic-go/security/advisories/GHSA-c33x-xqrf-c478
    reference_type:
    reference_id:
  - url: https://seemann.io/posts/2024-03-19-exploiting-quics-connection-id-management
    reference_type:
    reference_id:
  - url: https://www.youtube.com/watch?v=JqXtYcZAtIA&t=3683s
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22189
    reference_type:
    reference_id: CVE-2024-22189
