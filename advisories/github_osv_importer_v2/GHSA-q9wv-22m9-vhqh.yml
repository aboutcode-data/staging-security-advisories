advisory_id: GHSA-q9wv-22m9-vhqh
datasource_id: github_osv_importer_v2/GHSA-q9wv-22m9-vhqh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-q9wv-22m9-vhqh/GHSA-q9wv-22m9-vhqh.json
aliases:
  - CVE-2022-41874
summary: |
  Tauri Filesystem Scope can be Partially Bypassed
  ### Impact

  Due to incorrect escaping of special characters in paths selected via the file dialog and drag and drop functionality, it was possible to partially bypass the `fs` scope definition. It was not possible to traverse into arbitrary paths, as the issue was limited to neighboring files and sub folders of already allowed paths.

  The impact differs on Windows, MacOS and Linux due to different specifications of valid path characters.

  On Linux or MacOS based systems it was possible to use the `*`, `**` and `[a-Z]` patterns inside a path, which allowed to read the content of sub directories and single character files in a folder, where only specific files or the directory itself were allowed.

  On Windows `[a-Z]` was the possible bypass pattern, as `*` is not treated as a valid path component. This implies that only single character files inside an already allowed directory were unintentionally accessible.

  This bypass depends on the file picker dialog or dragged files, as user selected paths are automatically added to the allow list at runtime.

  A successful bypass requires the user to select a pre-existing malicious file or directory during the file picker dialog and an adversary controlled logic to access these files. This means the issue by itself can not be abused and requires further intentional or unintentional privileges.

  ### Workaround

  Disable the `dialog` and `fileDropEnabled` component inside the `tauri.conf.json`.

  ### Patches

  The issue has been resolved in #5237 and the implementation now properly escapes the special characters. The patch has been included in releases: `1.0.7`, `1.1.2` and `1.2.0`

  ### For more information

  This issue was initially reported by MessyComposer in #5234.

  If you have any questions or comments about this advisory:

  Open an issue in tauri
  Email us at security@tauri.app
impacted_packages: []
severities:
  - score: '2.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-q9wv-22m9-vhqh/GHSA-q9wv-22m9-vhqh.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
references:
  - url: https://github.com/tauri-apps/tauri
    reference_type:
    reference_id:
  - url: https://github.com/tauri-apps/tauri/issues/5234
    reference_type:
    reference_id:
  - url: https://github.com/tauri-apps/tauri/pull/5237
    reference_type:
    reference_id:
  - url: https://github.com/tauri-apps/tauri/security/advisories/GHSA-q9wv-22m9-vhqh
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2022-0091.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-41874
    reference_type:
    reference_id: CVE-2022-41874
