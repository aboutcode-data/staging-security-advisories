advisory_id: GHSA-747p-wmpv-9c78
datasource_id: github_osv_importer_v2/GHSA-747p-wmpv-9c78
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-747p-wmpv-9c78/GHSA-747p-wmpv-9c78.json
aliases: []
summary: "AWS CLI: cli_history database does not restrict file permissions on Unix systems\n\
  **Summary**\nAWS CLI is a command line tool for interacting with AWS services. When the cli_history\
  \ feature is enabled, the history database file is created with default permissions, potentially\
  \ allowing other local users on a multi-user system to read the file.\n\n**Impact**\nWhen\
  \ cli_history is enabled, AWS CLI stores command history including command parameters and\
  \ API request/response data in a local SQLite database. On multi-user Unix systems, the default\
  \ file permissions may allow other local users to read this file, potentially exposing sensitive\
  \ information. This issue only affects users who have explicitly enabled cli_history, which\
  \ is disabled by default.\n\n**Impacted versions:** 1.13.0 - 1.44.37 (v1), 2.0.0 - 2.33.20\
  \ (v2)\n\n**Patches**\nThis issue has been addressed in the latest versions 2.33.21 and 1.44.38\
  \ of AWS CLI. We recommend upgrading to the latest version and ensuring any forked or derivative\
  \ code is patched to incorporate the new fixes. \n\n**Workarounds**\nUsers can manually set\
  \ restrictive permissions on the history database file. Alternatively, disable cli_history\
  \ by removing `cli_history = enabled` from the AWS config file.\n\n**Resources**\nIf there\
  \ are any questions or comments about this advisory, contact AWS Security via the [vulnerability\
  \ reporting page](https://aws.amazon.com/security/vulnerability-reporting) or directly via\
  \ email to [aws-security@amazon.com](mailto:aws-security@amazon.com). Please do not create\
  \ a public GitHub issue."
impacted_packages:
  - purl: pkg:pypi/awscli
    affected_versions: vers:pypi/>=1.13.0|<1.44.38
    fixed_versions: vers:pypi/1.44.38
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-747p-wmpv-9c78/GHSA-747p-wmpv-9c78.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-276
references:
  - url: https://github.com/aws/aws-cli
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cli/security/advisories/GHSA-747p-wmpv-9c78
    reference_type:
    reference_id:
