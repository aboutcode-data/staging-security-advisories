advisory_id: GHSA-84j7-475p-hp8v
datasource_id: github_osv_importer_v2/GHSA-84j7-475p-hp8v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/02/GHSA-84j7-475p-hp8v/GHSA-84j7-475p-hp8v.json
aliases:
  - CVE-2020-5247
summary: |
  HTTP Response Splitting in Puma
  In Puma (RubyGem) before 4.3.2 and 3.12.3, if an application using Puma allows untrusted input in a response header, an attacker can use newline characters (i.e. `CR`, `LF` or`/r`, `/n`) to end the header and inject malicious content, such as additional headers or an entirely new response body. This vulnerability is known as HTTP Response Splitting.

  While not an attack in itself, response splitting is a vector for several other attacks, such as cross-site scripting (XSS).

  This is related to CVE-2019-16254, which fixed this vulnerability for the WEBrick Ruby web server.

  This has been fixed in versions 4.3.2 and 3.12.3 by checking all headers for line endings and rejecting headers with those characters.
impacted_packages:
  - purl: pkg:gem/puma
    affected_versions: vers:gem/<3.12.3
    fixed_versions: vers:gem/3.12.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/puma
    affected_versions: vers:gem/<4.3.2
    fixed_versions: vers:gem/4.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/02/GHSA-84j7-475p-hp8v/GHSA-84j7-475p-hp8v.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-113
references:
  - url: https://github.com/puma/puma
    reference_type:
    reference_id:
  - url: https://github.com/puma/puma/commit/c36491756f68a9d6a8b3a49e7e5eb07fe6f1332f
    reference_type:
    reference_id:
  - url: https://github.com/puma/puma/security/advisories/GHSA-84j7-475p-hp8v
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/puma/CVE-2020-5247.yml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/05/msg00034.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BMJ3CGZ3DLBJ5WUUKMI5ZFXFJQMXJZIK
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DIHVO3CQMU7BZC7FCTSRJ33YDNS3GFPK
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NJ3LL5F5QADB6LM46GXZETREAKZMQNRD
    reference_type:
    reference_id:
  - url: https://owasp.org/www-community/attacks/HTTP_Response_Splitting
    reference_type:
    reference_id:
  - url: https://www.ruby-lang.org/en/news/2019/10/01/http-response-splitting-in-webrick-cve-2019-16254
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5247
    reference_type:
    reference_id: CVE-2020-5247
