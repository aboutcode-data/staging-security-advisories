advisory_id: GHSA-273r-mgr4-v34f
datasource_id: github_osv_importer_v2/GHSA-273r-mgr4-v34f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-273r-mgr4-v34f/GHSA-273r-mgr4-v34f.json
aliases:
  - CVE-2022-21676
summary: |
  Uncaught Exception in engine.io
  ### Impact

  A specially crafted HTTP request can trigger an uncaught exception on the Engine.IO server, thus killing the Node.js process.

  > RangeError: Invalid WebSocket frame: RSV2 and RSV3 must be clear
  >   at Receiver.getInfo (/.../node_modules/ws/lib/receiver.js:176:14)
  >   at Receiver.startLoop (/.../node_modules/ws/lib/receiver.js:136:22)
  >   at Receiver._write (/.../node_modules/ws/lib/receiver.js:83:10)
  >   at writeOrBuffer (internal/streams/writable.js:358:12)

  This impacts all the users of the [`engine.io`](https://www.npmjs.com/package/engine.io) package starting from version `4.0.0`, including those who uses depending packages like [`socket.io`](https://www.npmjs.com/package/socket.io).

  ### Patches

  A fix has been released for each major branch:

  | Version range | Fixed version |
  | --- | --- |
  | `engine.io@4.x.x` | `4.1.2` |
  | `engine.io@5.x.x` | `5.2.1` |
  | `engine.io@6.x.x` | `6.1.1` |

  Previous versions (`< 4.0.0`) are not impacted.

  For `socket.io` users:

  | Version range | `engine.io` version | Needs minor update? |
  | --- | --- | --- |
  | `socket.io@4.4.x` | `~6.1.0` | -
  | `socket.io@4.3.x` | `~6.0.0` | Please upgrade to `socket.io@4.4.x`
  | `socket.io@4.2.x` | `~5.2.0` | -
  | `socket.io@4.1.x` | `~5.1.1` | Please upgrade to `socket.io@4.4.x`
  | `socket.io@4.0.x` | `~5.0.0` | Please upgrade to `socket.io@4.4.x`
  | `socket.io@3.1.x` | `~4.1.0` | -
  | `socket.io@3.0.x` | `~4.0.0` | Please upgrade to `socket.io@3.1.x` or `socket.io@4.4.x` (see [here](https://socket.io/docs/v4/migrating-from-3-x-to-4-0/))

  In most cases, running `npm audit fix` should be sufficient. You can also use  `npm update engine.io --depth=9999`.

  ### Workarounds

  There is no known workaround except upgrading to a safe version.

  ### For more information

  If you have any questions or comments about this advisory:

  * Open an issue in [`engine.io`](https://github.com/socketio/engine.io)

  Thanks to Marcus Wejderot from Mevisio for the responsible disclosure.
impacted_packages:
  - purl: pkg:npm/engine.io
    affected_versions: vers:npm/>=4.0.0|<4.1.2
    fixed_versions: vers:npm/4.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/engine.io
    affected_versions: vers:npm/>=5.0.0|<5.2.1
    fixed_versions: vers:npm/5.2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/engine.io
    affected_versions: vers:npm/>=6.0.0|<6.1.1
    fixed_versions: vers:npm/6.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-273r-mgr4-v34f/GHSA-273r-mgr4-v34f.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-755
  - CWE-754
references:
  - url: https://github.com/socketio/engine.io
    reference_type:
    reference_id:
  - url: https://github.com/socketio/engine.io/commit/66f889fc1d966bf5bfa0de1939069153643874ab
    reference_type:
    reference_id:
  - url: https://github.com/socketio/engine.io/commit/a70800d7e96da32f6e6622804ef659ebc58659db
    reference_type:
    reference_id:
  - url: https://github.com/socketio/engine.io/commit/c0e194d44933bd83bf9a4b126fca68ba7bf5098c
    reference_type:
    reference_id:
  - url: https://github.com/socketio/engine.io/releases/tag/4.1.2
    reference_type:
    reference_id:
  - url: https://github.com/socketio/engine.io/releases/tag/5.2.1
    reference_type:
    reference_id:
  - url: https://github.com/socketio/engine.io/releases/tag/6.1.1
    reference_type:
    reference_id:
  - url: https://github.com/socketio/engine.io/security/advisories/GHSA-273r-mgr4-v34f
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220209-0002
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21676
    reference_type:
    reference_id: CVE-2022-21676
