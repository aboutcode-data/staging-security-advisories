advisory_id: GHSA-4rch-2fh8-94vw
datasource_id: github_osv_importer_v2/GHSA-4rch-2fh8-94vw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-4rch-2fh8-94vw/GHSA-4rch-2fh8-94vw.json
aliases:
  - CVE-2024-21511
summary: |
  MySQL2 for Node Arbitrary Code Injection
  Versions of the package mysql2 before 3.9.7 are vulnerable to Arbitrary Code Injection due to improper sanitization of the timezone parameter in the readCodeFor function by calling a native MySQL Server date/time function.
impacted_packages:
  - purl: pkg:npm/mysql2
    affected_versions: vers:npm/<3.9.7
    fixed_versions: vers:npm/3.9.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-4rch-2fh8-94vw/GHSA-4rch-2fh8-94vw.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/sidorares/node-mysql2
    reference_type:
    reference_id:
  - url: https://github.com/sidorares/node-mysql2/commit/7d4b098c7e29d5a6cb9eac2633bfcc2f0f1db713
    reference_type:
    reference_id:
  - url: https://github.com/sidorares/node-mysql2/pull/2608
    reference_type:
    reference_id:
  - url: https://github.com/sidorares/node-mysql2/releases/tag/v3.9.7
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-JS-MYSQL2-6670046
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-21511
    reference_type:
    reference_id: CVE-2024-21511
