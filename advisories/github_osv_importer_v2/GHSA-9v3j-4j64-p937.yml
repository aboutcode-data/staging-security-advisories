advisory_id: GHSA-9v3j-4j64-p937
datasource_id: github_osv_importer_v2/GHSA-9v3j-4j64-p937
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-9v3j-4j64-p937/GHSA-9v3j-4j64-p937.json
aliases:
  - CVE-2022-41951
summary: "OroPlatform vulnerable to path traversal during temporary file manipulations\n###\
  \ Impact\nPath Traversal is possible in `Oro\\Bundle\\GaufretteBundle\\FileManager::getTemporaryFileName`.\
  \ \nWith this method, an attacker can pass the path to a non-existent file, which will allow\
  \ writing the content to a new file that will be available during script execution. The file\
  \ will be deleted immediately after the script ends. \n\n### Workarounds\nApply patch\n```patch\n\
  --- a/vendor/oro/platform/src/Oro/Bundle/GaufretteBundle/FileManager.php\n+++ b/vendor/oro/platform/src/Oro/Bundle/GaufretteBundle/FileManager.php\n\
  @@ -614,6 +614,10 @@\n      */\n     public function getTemporaryFileName(string $suggestedFileName\
  \ = null): string\n     {\n+        if ($suggestedFileName) {\n+            $suggestedFileName\
  \ = basename($suggestedFileName);\n+        }\n+\n         $tmpDir = ini_get('upload_tmp_dir');\n\
  \         if (!$tmpDir || !is_dir($tmpDir) || !is_writable($tmpDir)) {\n             $tmpDir\
  \ = sys_get_temp_dir();\n\n```\n\nOr decorate `Oro\\Bundle\\GaufretteBundle\\FileManager::getTemporaryFileName`\
  \ in your customization and clear `$suggestedFileName` argument\n\n```php\n    public function\
  \ getTemporaryFileName(string $suggestedFileName = null): string\n    {\n        if ($suggestedFileName)\
  \ {\n            $suggestedFileName = basename($suggestedFileName);\n        }\n\n       \
  \ return parent::getTemporaryFileName($suggestedFileName);\n    }\n```\n\n### References\n\
  \ - [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal)\n - [How to Decorate\
  \ Services](https://symfony.com/doc/5.4/service_container/service_decoration.html)"
impacted_packages:
  - purl: pkg:composer/oro/platform
    affected_versions: vers:composer/>=4.1.0|<=4.1.13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/oro/platform
    affected_versions: vers:composer/>=4.2.0|<=4.2.10
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/oro/platform
    affected_versions: vers:composer/>=5.0.0|<5.0.8
    fixed_versions: vers:composer/5.0.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-9v3j-4j64-p937/GHSA-9v3j-4j64-p937.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/oroinc/platform
    reference_type:
    reference_id:
  - url: https://github.com/oroinc/platform/security/advisories/GHSA-9v3j-4j64-p937
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-41951
    reference_type:
    reference_id: CVE-2022-41951
