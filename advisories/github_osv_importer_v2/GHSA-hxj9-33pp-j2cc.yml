advisory_id: GHSA-hxj9-33pp-j2cc
datasource_id: github_osv_importer_v2/GHSA-hxj9-33pp-j2cc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-hxj9-33pp-j2cc/GHSA-hxj9-33pp-j2cc.json
aliases:
  - CVE-2025-66456
summary: "Elysia vulnerable to prototype pollution with multiple standalone schema validation\n\
  Prototype pollution vulnerability in `mergeDeep` after merging results of two standard schema\
  \ validations with the same key. Due to the ordering of merging, there must be an `any` type\
  \ that is set as a `standalone` guard, to allow for the `__proto__` prop to be merged.\n\n\
  When combined with GHSA-8vch-m3f4-q8jf this allows for a full RCE by an attacker.\n\n### Impact\n\
  Routes with more than 2 standalone schema validation, eg. zod\n\nExample vulnerable code:\n\
  ```typescript\nimport { Elysia } from \"elysia\"\nimport * as z from \"zod\"\n\nconst app\
  \ = new Elysia()\n\t.guard({\n\t\tschema: \"standalone\",\n\t\tbody: z.object({\n\t\t\tdata:\
  \ z.any()\n\t\t})\n\t})\n\t.post(\"/\", ({ body }) => ({ body, win: {}.foo }), {\n\t\tbody:\
  \ z.object({\n\t\t\tdata: z.object({\n\t\t\t\tmessageId: z.string(\"pollute-me\"),\n\t\t\t\
  })\n\t\t})\n\t})\n```\n\n### Patches\nPatched by 1.4.17 (https://github.com/elysiajs/elysia/pull/1564)\n\
  \nReference commit:\n- https://github.com/elysiajs/elysia/pull/1564/commits/26935bf76ebc43b4a43d48b173fc853de43bb51e\n\
  - https://github.com/elysiajs/elysia/pull/1564/commits/3af978663e437dccc6c1a2a3aff4b74e1574849e\n\
  \n### Workarounds\nRemove `__proto__` key from body\n\nExample plugin for removing `__proto__`\
  \ from body\n\n```typescript\nnew Elysia()\n\t.onTransform(({ body, headers }) => {\n\t\t\
  if (headers['content-type'] === 'application/json')\n\t\t\treturn JSON.parse(JSON.stringify(body),\
  \ (k, v) => {\n\t\t\t\tif (k === '__proto__') return\n\n\t\t\t\treturn v\n\t\t\t})\n\t})\n\
  ```"
impacted_packages:
  - purl: pkg:npm/elysia
    affected_versions: vers:npm/>=1.4.0|<1.4.17
    fixed_versions: vers:npm/1.4.17
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-hxj9-33pp-j2cc/GHSA-hxj9-33pp-j2cc.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1321
references:
  - url: https://github.com/elysiajs/elysia
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/commit/26935bf76ebc43b4a43d48b173fc853de43bb51e
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/commit/3af978663e437dccc6c1a2a3aff4b74e1574849e
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/pull/1564
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/security/advisories/GHSA-8vch-m3f4-q8jf
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/security/advisories/GHSA-hxj9-33pp-j2cc
    reference_type:
    reference_id:
  - url: https://github.com/sportshead/elysia-poc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66456
    reference_type:
    reference_id:
