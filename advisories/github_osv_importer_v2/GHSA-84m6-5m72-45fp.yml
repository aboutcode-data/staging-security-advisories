advisory_id: GHSA-84m6-5m72-45fp
datasource_id: github_osv_importer_v2/GHSA-84m6-5m72-45fp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-84m6-5m72-45fp/GHSA-84m6-5m72-45fp.json
aliases:
  - CVE-2025-32033
summary: |
  Apollo Router Operation Limits Vulnerable to Bypass via Integer Overflow
  # Impact

  ## Summary

  A vulnerability in Apollo Router allowed certain queries to bypass configured operation limits, specifically due to integer overflow.

  ## Details

  The operation limits plugin uses unsigned 32-bit integers to track limit counters (e.g. for a query's height). If a counter exceeded the maximum value for this data type (4,294,967,295), it wrapped around to 0, unintentionally allowing queries to bypass configured thresholds. This could occur for large queries if the payload limit were sufficiently increased, but could also occur for small queries with deeply nested and reused named fragments.

  ## Fix/Mitigation

  Logic was updated to ensure counter overflow is handled correctly and does not wrap around to 0.

  # Patches

  This has been remediated in `apollo-router` versions 1.61.2 and 2.1.1.

  # Workarounds

  The only known workaround is "Safelisting" or "Safelisting with IDs only" per [Safelisting with Persisted Queries - Apollo GraphQL Docs](https://www.apollographql.com/docs/graphos/routing/security/persisted-queries#router-security-levels).

  ## Acknowledgements

  We appreciate the efforts of the security community in identifying and improving the performance and security of operation limiting mechanisms.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-84m6-5m72-45fp/GHSA-84m6-5m72-45fp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-190
references:
  - url: https://github.com/apollographql/router
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/commit/ab6675a63174715ea6ff50881fc957831d4e9564
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/commit/bba032e183b861348a466d3123c7137a1ae18952
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/security/advisories/GHSA-84m6-5m72-45fp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32033
    reference_type:
    reference_id: CVE-2025-32033
