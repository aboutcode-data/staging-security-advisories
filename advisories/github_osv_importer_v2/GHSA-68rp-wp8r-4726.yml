advisory_id: GHSA-68rp-wp8r-4726
datasource_id: github_osv_importer_v2/GHSA-68rp-wp8r-4726
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-68rp-wp8r-4726/GHSA-68rp-wp8r-4726.json
aliases:
  - CVE-2026-27205
summary: |
  Flask session does not add `Vary: Cookie` header when accessed in some ways
  When the `session` object is accessed, Flask should set the `Vary: Cookie` header. This instructs caches not to cache the response, as it may contain information specific to a logged in user. This is handled in most cases, but some forms of access such as the Python `in` operator were overlooked.

  The severity depends on the application's use of the session, and the cache's behavior regarding cookies. The risk depends on all these conditions being met.

  1. The application must be hosted behind a caching proxy that does not ignore responses with cookies.
  2. The application does not set a `Cache-Control` header to indicate that a page is private or should not be cached.
  3. The application accesses the session in a way that does not access the values, only the keys, and does not mutate the session.
impacted_packages:
  - purl: pkg:pypi/flask
    affected_versions: vers:pypi/<3.1.3
    fixed_versions: vers:pypi/3.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-68rp-wp8r-4726/GHSA-68rp-wp8r-4726.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-524
references:
  - url: https://github.com/pallets/flask
    reference_type:
    reference_id:
  - url: https://github.com/pallets/flask/commit/089cb86dd22bff589a4eafb7ab8e42dc357623b4
    reference_type:
    reference_id:
  - url: https://github.com/pallets/flask/releases/tag/3.1.3
    reference_type:
    reference_id:
  - url: https://github.com/pallets/flask/security/advisories/GHSA-68rp-wp8r-4726
    reference_type:
    reference_id:
