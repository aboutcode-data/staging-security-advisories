advisory_id: GHSA-7vwx-582j-j332
datasource_id: github_osv_importer_v2/GHSA-7vwx-582j-j332
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-7vwx-582j-j332/GHSA-7vwx-582j-j332.json
aliases: []
summary: |
  OpenClaw MS Teams inbound attachment downloader leaks bearer tokens to allowlisted suffix domains
  ## Summary

  NOTE: This only affects deployments that enable the optional MS Teams extension (Teams channel). If you do not use MS Teams, you are not impacted.

  When OpenClaw downloads inbound MS Teams attachments / inline images, it may retry a URL with an `Authorization: Bearer <token>` header after receiving `401` or `403`.

  Because the default download allowlist uses suffix matching (and includes some multi-tenant suffix domains), a message that references an untrusted but allowlisted host could cause that bearer token to be sent to the wrong place.

  ## Affected Packages / Versions

  - Package: `openclaw` (npm)
  - Vulnerable: `<= 2026.1.30`
  - Patched: `>= 2026.2.1`

  ## Fix

  - Fix commit: `41cc5bcd4f1d434ad1bbdfa55b56f25025ecbf6b`
  - Upgrade to `openclaw >= 2026.2.1`

  ## Workarounds

  - If you do not need MS Teams, disable the MS Teams extension.
  - If you must stay on an older version, ensure the auth host allowlist is strict (only Microsoft-owned endpoints that require auth) and avoid wildcard or broad suffix entries.

  ## Credits

  Thanks @yueyueL for reporting.
impacted_packages:
  - purl: pkg:npm/openclaw
    affected_versions: vers:npm/<2026.2.1
    fixed_versions: vers:npm/2026.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-7vwx-582j-j332/GHSA-7vwx-582j-j332.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-201
references:
  - url: https://github.com/openclaw/openclaw
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/commit/41cc5bcd4f1d434ad1bbdfa55b56f25025ecbf6b
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/releases/tag/v2026.2.1
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/security/advisories/GHSA-7vwx-582j-j332
    reference_type:
    reference_id:
