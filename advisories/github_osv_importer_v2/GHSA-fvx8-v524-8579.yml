advisory_id: GHSA-fvx8-v524-8579
datasource_id: github_osv_importer_v2/GHSA-fvx8-v524-8579
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-fvx8-v524-8579/GHSA-fvx8-v524-8579.json
aliases:
  - CVE-2020-17495
summary: |
  django-celery-results Stores Sensitive Information In Cleartext
  django-celery-results prior to 2.4.0 stores task results in the database. Among the data it stores are the variables passed into the tasks. The variables may contain sensitive cleartext information that does not belong unencrypted in the database.

  In version 2.4.0 this is no longer the default behaviour but can be re-enabled with the `result_extended` flag in which case care should be taken to ensure any sensitive variables are scrubbed - see [here](https://github.com/celery/django-celery-results/issues/154#issuecomment-734706270) for an example.
impacted_packages:
  - purl: pkg:pypi/django-celery-results
    affected_versions: vers:pypi/<2.4.0
    fixed_versions: vers:pypi/2.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-fvx8-v524-8579/GHSA-fvx8-v524-8579.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-fvx8-v524-8579/GHSA-fvx8-v524-8579.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-312
references:
  - url: https://github.com/advisories/GHSA-fvx8-v524-8579
    reference_type:
    reference_id:
  - url: https://github.com/celery/django-celery-results
    reference_type:
    reference_id:
  - url: https://github.com/celery/django-celery-results/commit/ad508fe3433499e5fc94645412d911e174863f28
    reference_type:
    reference_id:
  - url: https://github.com/celery/django-celery-results/issues/142
    reference_type:
    reference_id:
  - url: https://github.com/celery/django-celery-results/issues/154
    reference_type:
    reference_id:
  - url: https://github.com/celery/django-celery-results/pull/316
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/django-celery-results/PYSEC-2020-38.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-17495
    reference_type:
    reference_id: CVE-2020-17495
