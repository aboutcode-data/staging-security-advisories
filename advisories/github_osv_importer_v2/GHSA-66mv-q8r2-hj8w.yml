advisory_id: GHSA-66mv-q8r2-hj8w
datasource_id: github_osv_importer_v2/GHSA-66mv-q8r2-hj8w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-66mv-q8r2-hj8w/GHSA-66mv-q8r2-hj8w.json
aliases:
  - CVE-2017-6928
summary: |
  Drupal access bypass vulnerability
  Drupal core 7.x versions before 7.57 when using Drupal's private file system, Drupal will check to make sure a user has access to a file before allowing the user to view or download it. This check fails under certain conditions in which one module is trying to grant access to the file and another is trying to deny it, leading to an access bypass vulnerability. This vulnerability is mitigated by the fact that it only occurs for unusual site configurations.
impacted_packages:
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/>=7.0.0|<7.57.0
    fixed_versions: vers:composer/7.57.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/drupal/drupal
    affected_versions: vers:composer/>=7.0.0|<7.57.0
    fixed_versions: vers:composer/7.57.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-66mv-q8r2-hj8w/GHSA-66mv-q8r2-hj8w.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-732
references:
  - url: https://github.com/drupal/core
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/core/CVE-2017-6928.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/drupal/CVE-2017-6928.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2018/02/msg00030.html
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2018/dsa-4123
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2018-001
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-6928
    reference_type:
    reference_id: CVE-2017-6928
