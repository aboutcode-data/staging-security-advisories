advisory_id: GHSA-mm7v-vpv8-xfc3
datasource_id: github_osv_importer_v2/GHSA-mm7v-vpv8-xfc3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-mm7v-vpv8-xfc3/GHSA-mm7v-vpv8-xfc3.json
aliases:
  - CVE-2019-15551
summary: |
  Double free in smallvec
  Attempting to call grow on a spilled SmallVec with a value equal to the current capacity causes it to free the existing data. This performs a double free immediately and may lead to use-after-free on subsequent accesses to the SmallVec contents. An attacker that controls the value passed to grow may exploit this flaw to obtain memory contents or gain remote code execution.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-mm7v-vpv8-xfc3/GHSA-mm7v-vpv8-xfc3.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-415
references:
  - url: https://github.com/servo/rust-smallvec
    reference_type:
    reference_id:
  - url: https://github.com/servo/rust-smallvec/commit/c20cfa8584e649f00dc0767ab6fad63a3f59a296
    reference_type:
    reference_id:
  - url: https://github.com/servo/rust-smallvec/commit/f96322b9243405cc82701cc73f1b19313b413ab4
    reference_type:
    reference_id:
  - url: https://github.com/servo/rust-smallvec/issues/148
    reference_type:
    reference_id:
  - url: https://github.com/servo/rust-smallvec/issues/149
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2019-0009.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-15551
    reference_type:
    reference_id: CVE-2019-15551
