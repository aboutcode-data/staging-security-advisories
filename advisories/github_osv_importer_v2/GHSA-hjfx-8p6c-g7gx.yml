advisory_id: GHSA-hjfx-8p6c-g7gx
datasource_id: github_osv_importer_v2/GHSA-hjfx-8p6c-g7gx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-hjfx-8p6c-g7gx/GHSA-hjfx-8p6c-g7gx.json
aliases:
  - CVE-2021-28678
summary: |
  Insufficient Verification of Data Authenticity in Pillow
  An issue was discovered in Pillow before 8.2.0. For BLP data, BlpImagePlugin did not properly check that reads (after jumping to file offsets) returned data. This could lead to a DoS where the decoder could be run a large number of times on empty data.
impacted_packages:
  - purl: pkg:pypi/pillow
    affected_versions: vers:pypi/>=5.1.0|<8.2.0
    fixed_versions: vers:pypi/8.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-hjfx-8p6c-g7gx/GHSA-hjfx-8p6c-g7gx.json
  - score: '6.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-hjfx-8p6c-g7gx/GHSA-hjfx-8p6c-g7gx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-345
references:
  - url: https://github.com/advisories/GHSA-hjfx-8p6c-g7gx
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pillow/PYSEC-2021-94.yaml
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow/pull/5377
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow/pull/5377/commits/496245aa4365d0827390bd0b6fbd11287453b3a1
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MQHA5HAIBOYI3R6HDWCLAGFTIQP767FL
    reference_type:
    reference_id:
  - url: https://pillow.readthedocs.io/en/stable/releasenotes/8.2.0.html#cve-2021-28678-fix-blp-dos
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202107-33
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28678
    reference_type:
    reference_id: CVE-2021-28678
