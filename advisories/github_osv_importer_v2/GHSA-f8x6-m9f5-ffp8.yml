advisory_id: GHSA-f8x6-m9f5-ffp8
datasource_id: github_osv_importer_v2/GHSA-f8x6-m9f5-ffp8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-f8x6-m9f5-ffp8/GHSA-f8x6-m9f5-ffp8.json
aliases:
  - CVE-2021-23814
summary: |
  Unrestricted Upload of File with Dangerous Type in unisharp/laravel-filemanager
  This affects the package unisharp/laravel-filemanager prior to version 2.6.2. The `upload()` function does not sufficiently validate the file type when uploading.

  An attacker may be able to reproduce the following steps:
  - Install a package with a web Laravel application.
  - Navigate to the Upload window
  - Upload an image file, then capture the request
  - Edit the request contents with a malicious file (webshell)
  - Enter the path of file uploaded on URL
  - Remote Code Execution

  **Note: Prevention for bad extensions can be done by using a whitelist in the config file(lfm.php). Corresponding document can be found in the [here](https://unisharp.github.io/laravel-filemanager/configfolder-categories).
impacted_packages:
  - purl: pkg:composer/unisharp/laravel-filemanager
    affected_versions: vers:composer/<2.6.2
    fixed_versions: vers:composer/2.6.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-f8x6-m9f5-ffp8/GHSA-f8x6-m9f5-ffp8.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://github.com/UniSharp/laravel-filemanager
    reference_type:
    reference_id:
  - url: https://github.com/UniSharp/laravel-filemanager/blob/master/src/Controllers/UploadController.php%23L26
    reference_type:
    reference_id:
  - url: https://github.com/UniSharp/laravel-filemanager/blob/master/src/Controllers/UploadController.php#L26
    reference_type:
    reference_id:
  - url: https://github.com/UniSharp/laravel-filemanager/commit/bd84899ce65a7f193e676dd8444e424fa50f64fa
    reference_type:
    reference_id:
  - url: https://github.com/UniSharp/laravel-filemanager/issues/1113#issuecomment-1812092975
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-PHP-UNISHARPLARAVELFILEMANAGER-1567199
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-23814
    reference_type:
    reference_id: CVE-2021-23814
