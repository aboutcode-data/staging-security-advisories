advisory_id: GHSA-jgh8-vchw-q3g7
datasource_id: github_osv_importer_v2/GHSA-jgh8-vchw-q3g7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-jgh8-vchw-q3g7/GHSA-jgh8-vchw-q3g7.json
aliases:
  - CVE-2023-24622
summary: |
  safeurl-python contains Server-Side Request Forgery
  ### Description
  In SafeURL it is possible to specify a list of domains that should be matched before a request is sent out. The regex used to compare domains did not work as intended.

  ### Impact
  The regex used was:

  `re.match("(?i)^%s" % domain, value)`

  This has two problems, first that only the beginning and not the end of the string is anchored. Second, that a dot in the domain matches any character as part of regex syntax.

  Therefore, an allowlist of ["victim.com"] could allow the domain "victimacomattacker.com" to be requested.

  This has lower impact since the usual attacker aim in an SSRF is to request internal resources such as private IP addresses rather than an attacker's own domain. But, in a case where SafeURL had specifically been used to try to limit requests to a particular allowlist, say for example a PDF renderer, the finding would be more severe.

  ### Patches
  Fixed in https://github.com/IncludeSecurity/safeurl-python/pull/5

  ### References
  [Server-side request forgery (SSRF)](https://portswigger.net/web-security/ssrf)
impacted_packages:
  - purl: pkg:pypi/safeurl-python
    affected_versions: vers:pypi/<1.2
    fixed_versions: vers:pypi/1.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-jgh8-vchw-q3g7/GHSA-jgh8-vchw-q3g7.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-jgh8-vchw-q3g7/GHSA-jgh8-vchw-q3g7.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/IncludeSecurity/safeurl-python
    reference_type:
    reference_id:
  - url: https://github.com/IncludeSecurity/safeurl-python/pull/5/commits/42dd0c8e5fc84e17e1d3578d18aaea169eece474
    reference_type:
    reference_id:
  - url: https://github.com/IncludeSecurity/safeurl-python/security/advisories/GHSA-jgh8-vchw-q3g7
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/safeurl-python/PYSEC-2023-298.yaml
    reference_type:
    reference_id:
