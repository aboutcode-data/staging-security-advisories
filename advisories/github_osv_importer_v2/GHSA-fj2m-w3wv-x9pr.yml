advisory_id: GHSA-fj2m-w3wv-x9pr
datasource_id: github_osv_importer_v2/GHSA-fj2m-w3wv-x9pr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-fj2m-w3wv-x9pr/GHSA-fj2m-w3wv-x9pr.json
aliases:
  - CVE-2022-39135
summary: |
  Apache Calcite before 1.32.0 vulnerable to potential XML External Entity (XXE) attack
  In Apache Calcite prior to version 1.32.0 the SQL operators EXISTS_NODE, EXTRACT_XML, XML_TRANSFORM and EXTRACT_VALUE do not restrict XML External Entity references in their configuration, which makes them vulnerable to a potential XML External Entity (XXE) attack. Therefore any client exposing these operators, typically by using Oracle dialect (the first three) or MySQL dialect (the last one), is affected by this vulnerability (the extent of it will depend on the user under which the application is running). From Apache Calcite 1.32.0 onwards, Document Type Declarations and XML External Entity resolution are disabled on the impacted operators.
impacted_packages:
  - purl: pkg:maven/org.apache.calcite/calcite-core
    affected_versions: vers:maven/<1.32.0
    fixed_versions: vers:maven/1.32.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-fj2m-w3wv-x9pr/GHSA-fj2m-w3wv-x9pr.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://lists.apache.org/thread/ohdnhlgm6jvt3srw8l7spkm2d5vwm082
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2022/11/21/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39135
    reference_type:
    reference_id: CVE-2022-39135
