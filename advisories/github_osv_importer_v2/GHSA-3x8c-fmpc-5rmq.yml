advisory_id: GHSA-3x8c-fmpc-5rmq
datasource_id: github_osv_importer_v2/GHSA-3x8c-fmpc-5rmq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/10/GHSA-3x8c-fmpc-5rmq/GHSA-3x8c-fmpc-5rmq.json
aliases:
  - CVE-2020-26891
summary: |
  Cross-site scripting (XSS) vulnerability in the fallback authentication endpoint
  ### Impact
  The fallback authentication endpoint served via Synapse was vulnerable to cross-site scripting (XSS) attacks. The impact depends on the configuration of the domain that Synapse is deployed on, but may allow access to cookies and other browser data, CSRF vulnerabilities, and access to other resources served on the same domain or parent domains.

  ### Patches
  This is fixed by #8444, which is included in Synapse v1.21.0.

  ### Workarounds
  If the homeserver is not configured to use reCAPTCHA, consent (terms of service), or single sign-on then the affected endpoint can be blocked at a reverse proxy:

  * `/_matrix/client/r0/auth/.*/fallback/web`
  * `/_matrix/client/unstable/auth/.*/fallback/web`
impacted_packages:
  - purl: pkg:pypi/matrix-synapse
    affected_versions: vers:pypi/<1.21.0
    fixed_versions: vers:pypi/1.21.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/10/GHSA-3x8c-fmpc-5rmq/GHSA-3x8c-fmpc-5rmq.json
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/10/GHSA-3x8c-fmpc-5rmq/GHSA-3x8c-fmpc-5rmq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/pull/8444
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/releases
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/releases/tag/v1.21.2
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-3x8c-fmpc-5rmq
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2020-238.yaml
    reference_type:
    reference_id:
  - url: https://matrix.org/blog/2020/10/15/synapse-1-21-2-released-and-security-advisory
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-26891
    reference_type:
    reference_id: CVE-2020-26891
