advisory_id: GHSA-xwv6-v7qx-f5jc
datasource_id: github_osv_importer_v2/GHSA-xwv6-v7qx-f5jc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-xwv6-v7qx-f5jc/GHSA-xwv6-v7qx-f5jc.json
aliases:
  - CVE-2022-25337
summary: |
  Code injection in ezsystems/ezpublish-kernel
  When image files are uploaded, they are made accessible under a name similar to the original file name. There are two issues with this. Both require access to uploading images in order to exploit them, this limits the impact. The first issue is that certain injection attacks can be possible, since not all possible attack vectors are removed from the original file name.

  The second issue is that direct access to the images is not access controlled. This is by design, for performance reasons, and documented as such. But it does mean that images not meant to be publicly accessible can be accessed, provided that the image path and filename is correctly deduced and/or guessed, through dictionary attacks and similar.
impacted_packages:
  - purl: pkg:composer/ezsystems/ezpublish-kernel
    affected_versions: vers:composer/>=7.5.0|<7.5.26
    fixed_versions: vers:composer/7.5.26
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-xwv6-v7qx-f5jc/GHSA-xwv6-v7qx-f5jc.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-74
references:
  - url: https://developers.ibexa.co/security-advisories/ibexa-sa-2022-001-image-filenames-sanitization
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezpublish-kernel
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-25337
    reference_type:
    reference_id: CVE-2022-25337
