advisory_id: GHSA-mmh6-5cpf-2c72
datasource_id: github_osv_importer_v2/GHSA-mmh6-5cpf-2c72
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-mmh6-5cpf-2c72/GHSA-mmh6-5cpf-2c72.json
aliases:
  - CVE-2024-29196
summary: |
  phpMyFAQ Path Traversal in Attachments
  ### Summary
  There is a Path Traversal vulnerability in Attachments that allows attackers with admin rights to upload malicious files to other locations of the web root.

  ### PoC
  1. In settings, the attachment location is vulnerable to path traversal and can be set to e.g ..\hacked
  ![image](https://github.com/thorsten/phpMyFAQ/assets/63487456/6167ba74-254c-4aed-9c16-759e5ceafd81)

  2. When the above is set, attachments files are now uploaded to e.g C:\Apps\XAMPP\htdocs\hacked instead of C:\Apps\XAMPP\htdocs\phpmyfaq\attachments

  3. Verify this by uploading an attachment and see that the "hacked" directory is now created in the web root folder with the attachment file inside.
  ![image](https://github.com/thorsten/phpMyFAQ/assets/63487456/325df0cc-e9ee-48bd-a7bb-1295199b4d9e)
  ![image](https://github.com/thorsten/phpMyFAQ/assets/63487456/beb10a6a-9d56-4607-8da6-49581991b1fe)

  ### Impact
  Attackers can potentially upload malicious files outside the specified directory.
impacted_packages:
  - purl: pkg:composer/phpmyfaq/phpmyfaq
    affected_versions: vers:composer/3.2.5
    fixed_versions: vers:composer/3.2.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-mmh6-5cpf-2c72/GHSA-mmh6-5cpf-2c72.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/thorsten/phpMyFAQ
    reference_type:
    reference_id:
  - url: https://github.com/thorsten/phpMyFAQ/commit/7ae2559f079cd5fc9948b6fdfb87581f93840f62
    reference_type:
    reference_id:
  - url: https://github.com/thorsten/phpMyFAQ/security/advisories/GHSA-mmh6-5cpf-2c72
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-29196
    reference_type:
    reference_id: CVE-2024-29196
