advisory_id: GHSA-wpv5-97wm-hp9c
datasource_id: github_osv_importer_v2/GHSA-wpv5-97wm-hp9c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-wpv5-97wm-hp9c/GHSA-wpv5-97wm-hp9c.json
aliases:
  - CVE-2025-61772
summary: |
  Rack's multipart parser buffers unbounded per-part headers, enabling DoS (memory exhaustion)
  ## Summary

  `Rack::Multipart::Parser` can accumulate unbounded data when a multipart partâ€™s header block never terminates with the required blank line (`CRLFCRLF`). The parser keeps appending incoming bytes to memory without a size cap, allowing a remote attacker to exhaust memory and cause a denial of service (DoS).

  ## Details

  While reading multipart headers, the parser waits for `CRLFCRLF` using:

  ```ruby
  @sbuf.scan_until(/(.*?\r\n)\r\n/m)
  ```

  If the terminator never appears, it continues appending data (`@sbuf.concat(content)`) indefinitely. There is no limit on accumulated header bytes, so a single malformed part can consume memory proportional to the request body size.

  ## Impact

  Attackers can send incomplete multipart headers to trigger high memory use, leading to process termination (OOM) or severe slowdown. The effect scales with request size limits and concurrency. All applications handling multipart uploads may be affected.

  ## Mitigation

  * Upgrade to a patched Rack version that caps per-part header size (e.g., 64 KiB).
  * Until then, restrict maximum request sizes at the proxy or web server layer (e.g., Nginx `client_max_body_size`).
impacted_packages:
  - purl: pkg:gem/rack
    affected_versions: vers:gem/<2.2.19
    fixed_versions: vers:gem/2.2.19
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions: vers:gem/>=3.1|<3.1.17
    fixed_versions: vers:gem/3.1.17
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions: vers:gem/>=3.2|<3.2.2
    fixed_versions: vers:gem/3.2.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-wpv5-97wm-hp9c/GHSA-wpv5-97wm-hp9c.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/rack/rack
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/589127f4ac8b5cf11cf88fb0cd116ffed4d2181e
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/d869fed663b113b95a74ad53e1b5cae6ab31f29e
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/e08f78c656c9394d6737c022bde087e0f33336fd
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/security/advisories/GHSA-wpv5-97wm-hp9c
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61772.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-61772
    reference_type:
    reference_id:
