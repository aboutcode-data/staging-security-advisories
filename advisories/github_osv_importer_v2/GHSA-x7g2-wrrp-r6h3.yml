advisory_id: GHSA-x7g2-wrrp-r6h3
datasource_id: github_osv_importer_v2/GHSA-x7g2-wrrp-r6h3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-x7g2-wrrp-r6h3/GHSA-x7g2-wrrp-r6h3.json
aliases:
  - CVE-2021-27913
summary: |
  Use of a Broken or Risky Cryptographic Algorithm
  ## ‚úçÔ∏è Description
  The function mt_rand is used to generate session tokens, this function is cryptographically flawed due to its nature being one pseudorandomness, an attacker can take advantage of the cryptographically insecure nature of this function to enumerate session tokens for accounts that are not under his/her control

  ## üïµÔ∏è‚Äç‚ôÇÔ∏è Proof of Concept
  Numerous examples and attack implementations can be found in this paper . If you're looking for a practical tool that can crack your mt_rand implementation's seed value, see this project and run the following commands in a console with php5 and OpenWall's tool installed:

  `root$ php -r 'mt_srand(13333337); echo mt_rand( ), "\n";'`
  After that, copy the output (1863134308) and execute the following commands:

  `root$ gcc php_mt_seed.c -o php_mt_seedroot$ ./php_mt_seed 1863134308`
  After waiting ~1 minute you should have a few possible seeds corresponding to their PHP versions, next to your installed PHP version you should see something akin to:

  seed = 0x00cb7359 = 13333337 (PHP 7.1.0+)
  Hey, that's your seed!

  ## üí• Impact
  An attacker could takeover accounts at random by enumerating and using access tokens.

  ## üìù References

  - https://openwall.com/php_mt_seedhttps://crypto.di.uoa.gr/CRYPTO.SEC/Randomness_Attacks_files/paper.pdf
  - https://github.com/mautic/mautic/blob/5213e320b4ef4d0c51bb84c1d46a1071e8e4f7fc/app/bundles/PointBundle/Controller/TriggerController.php#L187
  - https://github.com/mautic/mautic/releases/tag/3.3.4
  - https://github.com/mautic/mautic/releases/tag/4.0.0
impacted_packages:
  - purl: pkg:composer/mautic/core
    affected_versions: vers:composer/<3.3.4
    fixed_versions: vers:composer/3.3.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/mautic/core
    affected_versions: vers:composer/>=4.0.0-alpha1|<4.0.0
    fixed_versions: vers:composer/4.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-x7g2-wrrp-r6h3/GHSA-x7g2-wrrp-r6h3.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-327
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/mautic/core/CVE-2021-27913.yaml
    reference_type:
    reference_id:
  - url: https://github.com/mautic/mautic
    reference_type:
    reference_id:
  - url: https://github.com/mautic/mautic/commit/d1cad766a2de74e6c6b89d6d78c2a5f2e36ba91c
    reference_type:
    reference_id:
  - url: https://github.com/mautic/mautic/security/advisories/GHSA-x7g2-wrrp-r6h3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-27913
    reference_type:
    reference_id: CVE-2021-27913
