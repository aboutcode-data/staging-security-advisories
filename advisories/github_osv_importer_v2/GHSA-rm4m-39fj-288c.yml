advisory_id: GHSA-rm4m-39fj-288c
datasource_id: github_osv_importer_v2/GHSA-rm4m-39fj-288c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-rm4m-39fj-288c/GHSA-rm4m-39fj-288c.json
aliases:
  - CVE-2021-21624
summary: |
  Incorrect permission checks in Jenkins Role-based Authorization Strategy Plugin may allow accessing some items
  Items (like jobs) can be organized hierarchically in Jenkins, using the Folders Plugin or something similar. An item is expected to be accessible only if all its ancestors are accessible as well.

  Role-based Authorization Strategy Plugin 3.1 and earlier does not correctly perform permission checks to determine whether an item should be accessible.

  This allows attackers with Item/Read permission on nested items to access them, even if they lack Item/Read permission for parent folders.

  Role-based Authorization Strategy Plugin 3.1.1 requires Item/Read permission on parent items to grant Item/Read permission on an individual item.

  As a workaround in older releases, do not grant permissions on individual items to users who do not have access to parent items.

  In case of problems, the [Java system property](https://www.jenkins.io/doc/book/managing/system-properties/) `com.michelin.cio.hudson.plugins.rolestrategy.RoleMap.checkParentPermissions` can be set to false, completely disabling this fix.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/role-strategy
    affected_versions: vers:maven/<=3.1
    fixed_versions: vers:maven/3.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-rm4m-39fj-288c/GHSA-rm4m-39fj-288c.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/jenkinsci/role-strategy-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/role-strategy-plugin/commit/2490ed51c30f6df9db809a7dcf637ac8ac08233a
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2021-03-18/#SECURITY-2182
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/03/18/5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21624
    reference_type:
    reference_id: CVE-2021-21624
