advisory_id: GHSA-rfw5-cqjj-7v9r
datasource_id: github_osv_importer_v2/GHSA-rfw5-cqjj-7v9r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-rfw5-cqjj-7v9r/GHSA-rfw5-cqjj-7v9r.json
aliases:
  - CVE-2023-47639
summary: |
  API Platform Core can leak exceptions message that may contain sensitive information
  ### Summary

  Exception messages, that are not HTTP exceptions, are visible in the JSON error response.

  ### Details

  While we wanted to make our errors compatible with the [JSON Problem](https://datatracker.ietf.org/doc/html/rfc7807) specification, we ended up handling more exceptions then we did previously (introduced at https://github.com/api-platform/core/pull/5823). Instead of leaving that to Symfony, we ended up serializing errors with our normalizers which lead to not hiding the exception details. Note that the trace is hidden in production but the message is not, and the message can contain sensitive information.

  ### PoC

  At https://github.com/ili101/api-platform/tree/test3.2 it triggers an authentication exception as LDAP is not reachable. You can find the message available as a JSON response when trying to reach an endpoint.

  ### Impact

  Version 3.2 until 3.2.4 is impacted.
impacted_packages:
  - purl: pkg:composer/api-platform/core
    affected_versions: vers:composer/>=3.2.0|<3.2.5
    fixed_versions: vers:composer/3.2.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-rfw5-cqjj-7v9r/GHSA-rfw5-cqjj-7v9r.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-209
references:
  - url: https://github.com/api-platform/core
    reference_type:
    reference_id:
  - url: https://github.com/api-platform/core/commit/ba8a7e6538bccebf14c228e43a9339214c4d9201
    reference_type:
    reference_id:
  - url: https://github.com/api-platform/core/pull/5823
    reference_type:
    reference_id:
  - url: https://github.com/api-platform/core/security/advisories/GHSA-rfw5-cqjj-7v9r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-47639
    reference_type:
    reference_id: CVE-2023-47639
