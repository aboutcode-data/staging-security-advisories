advisory_id: GHSA-hc5c-r8m5-2gfh
datasource_id: github_osv_importer_v2/GHSA-hc5c-r8m5-2gfh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-hc5c-r8m5-2gfh/GHSA-hc5c-r8m5-2gfh.json
aliases: []
summary: |
  plone.restapi vulnerable to Stored Cross Site Scripting with SVG image in user portrait
  ### Impact
  There is a stored cross site scripting vulnerability for SVG images uploaded in user portraits.

  Note that a page that uses an image tag with an SVG image as source is never vulnerable, even when the SVG image contains malicious code. To exploit the vulnerability, an attacker would first need to upload an SVG image as user portrait, and then trick a user into following a link to this portrait.

  ### Patches
  A patch will be released in `plone.restapi` 8.43.3. This version is good for Plone 6.0, and for Plone 5.2 on Python 3.

  In `plone.restapi` 7 or earlier there was no `@portrait` endpoint yet, so there is nothing to fix in that version. It is still vulnerable to this attack, and needs a [fix in Zope 4](https://github.com/zopefoundation/Zope/security/advisories/GHSA-wm8q-9975-xh5v). These two vulnerabilities share the same CVE: CVE-2023-42458.

  ### Workarounds
  You could remove the portrait field from the member data schema, and possibly remove all portraits that are already in the database, but this seems a bit drastic.
impacted_packages:
  - purl: pkg:pypi/plone.restapi
    affected_versions: vers:pypi/>=8.0.0|<8.43.3
    fixed_versions: vers:pypi/8.43.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-hc5c-r8m5-2gfh/GHSA-hc5c-r8m5-2gfh.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-80
  - CWE-79
references:
  - url: https://github.com/plone/plone.restapi
    reference_type:
    reference_id:
  - url: https://github.com/plone/plone.restapi/commit/5f44c23ac69db7d6d933d77f177e07603cf05f8b
    reference_type:
    reference_id:
  - url: https://github.com/plone/plone.restapi/security/advisories/GHSA-hc5c-r8m5-2gfh
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope/security/advisories/GHSA-wm8q-9975-xh5v
    reference_type:
    reference_id:
