advisory_id: GHSA-45r6-j3cc-6mxx
datasource_id: github_osv_importer_v2/GHSA-45r6-j3cc-6mxx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-45r6-j3cc-6mxx/GHSA-45r6-j3cc-6mxx.json
aliases:
  - CVE-2022-40954
summary: |
  OS Command Injection in Apache Airflow
  Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') vulnerability in Apache Airflow Spark Provider, Apache Airflow allows an attacker to read arbtrary files in the task execution context, without write access to DAG files. This issue affects Spark Provider versions prior to 4.0.0. It also impacts any Apache Airflow versions prior to 2.3.0 in case Spark Provider is installed (Spark Provider 4.0.0 can only be installed for Airflow 2.3.0+). Note that you need to manually install the Spark Provider version 4.0.0 in order to get rid of the vulnerability on top of Airflow 2.3.0+ version that has lower version of the Spark Provider installed).
impacted_packages:
  - purl: pkg:pypi/apache-airflow
    affected_versions: vers:pypi/<2.3.0
    fixed_versions: vers:pypi/2.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-45r6-j3cc-6mxx/GHSA-45r6-j3cc-6mxx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/pull/27646
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/0tmdlnmjs5t4gsx5fy73tb6zd3jztq45
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-40954
    reference_type:
    reference_id: CVE-2022-40954
