advisory_id: GHSA-77hg-g8cc-5r37
datasource_id: github_osv_importer_v2/GHSA-77hg-g8cc-5r37
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-77hg-g8cc-5r37/GHSA-77hg-g8cc-5r37.json
aliases:
  - CVE-2012-1053
summary: |
  Puppet Privilege Escallation
  The change_user method in the SUIDManager (lib/puppet/util/suidmanager.rb) in Puppet 2.6.x before 2.6.14 and 2.7.x before 2.7.11, and Puppet Enterprise (PE) Users 1.0, 1.1, 1.2.x, 2.0.x before 2.0.3 does not properly manage group privileges, which allows local users to gain privileges via vectors related to (1) the change_user not dropping supplementary groups in certain conditions, (2) changes to the eguid without associated changes to the egid, or (3) the addition of the real gid to supplementary groups.
impacted_packages:
  - purl: pkg:gem/puppet
    affected_versions: vers:gem/>=2.6|<2.6.14
    fixed_versions: vers:gem/2.6.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/puppet
    affected_versions: vers:gem/>=2.7|<2.7.11
    fixed_versions: vers:gem/2.7.11
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://exchange.xforce.ibmcloud.com/vulnerabilities/73445
    reference_type:
    reference_id:
  - url: https://github.com/puppetlabs/puppet/commit/76d0749f0a9a496b70e7dc7e6d6d6ff692224e36
    reference_type:
    reference_id:
  - url: https://ubuntu.com/usn/usn-1372-1
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20120504011717/http://puppetlabs.com/security/cve/cve-2012-1053
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20120513215447/http://projects.puppetlabs.com/issues/12458
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20120513215653/http://projects.puppetlabs.com/issues/12457
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20120513223437/http://projects.puppetlabs.com/issues/12459
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20120527071855/http://www.securityfocus.com/bid/52158
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20120816020421/http://projects.puppetlabs.com/projects/1/wiki/Release_Notes#2.6.14
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2012/dsa-2419
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2012-1053
    reference_type:
    reference_id: CVE-2012-1053
