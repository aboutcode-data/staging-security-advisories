advisory_id: GHSA-2f46-4xjm-73x5
datasource_id: github_osv_importer_v2/GHSA-2f46-4xjm-73x5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-2f46-4xjm-73x5/GHSA-2f46-4xjm-73x5.json
aliases: []
summary: |
  Passbolt API Stored XSS on first/last name during setup
  ### Description
  An administrator can craft a user with a malicious first name and last name, using a payload such as
  ```
  <svg onload="confirm(document.domain)">'); ?></svg>
  ```
  The user will then receive the invitation email and click on the setup link. The setup start page served by the server will fire the XSS.

  ### Impact of issue
  An administrator could use this exploit to edit the setup start page for a given user, for example, trick the user into installing another extension. Even though the severity of this issue in itself is high, the likelihood is low because the exploit will be visible in clear by the user in the email notification, and also requires an action from a malicious administrator.

  ### Fix
  Sanitize the firstname and lastname in the page that is used to trigger the extension setup process.

  Additionally since v2.11 some default CSP are inserted in the server response headers to prevent inline-scripts or 3rd party domain scripts on pages served by the passbolt API. This is to cater for the case where the administrator has not set them up as part of the web server configuration.
impacted_packages:
  - purl: pkg:composer/passbolt/passbolt_api
    affected_versions: vers:composer/<2.11.0
    fixed_versions: vers:composer/2.11.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-2f46-4xjm-73x5/GHSA-2f46-4xjm-73x5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/passbolt/passbolt_api/2019-08-07-1.yaml
    reference_type:
    reference_id:
  - url: https://github.com/passbolt/passbolt_api
    reference_type:
    reference_id:
  - url: https://github.com/passbolt/passbolt_api/blob/master/CHANGELOG.md#2110---2019-08-08
    reference_type:
    reference_id:
  - url: https://github.com/passbolt/passbolt_api/commit/6135b483f72c6853e6085e329f5f8d7be60c9933
    reference_type:
    reference_id:
  - url: https://www.passbolt.com/incidents/20190807_multiple_vulnerabilities
    reference_type:
    reference_id:
