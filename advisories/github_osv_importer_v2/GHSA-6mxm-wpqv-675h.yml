advisory_id: GHSA-6mxm-wpqv-675h
datasource_id: github_osv_importer_v2/GHSA-6mxm-wpqv-675h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-6mxm-wpqv-675h/GHSA-6mxm-wpqv-675h.json
aliases:
  - CVE-2016-2152
summary: |
  Moodle XSS from profile fields from external db
  Multiple cross-site scripting (XSS) vulnerabilities in auth/db/auth.php in Moodle through 2.6.11, 2.7.x before 2.7.13, 2.8.x before 2.8.11, 2.9.x before 2.9.5, and 3.0.x before 3.0.3 allow remote attackers to inject arbitrary web script or HTML via an external DB profile field.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=2.7.0|<2.7.13
    fixed_versions: vers:composer/2.7.13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=2.8.0|<2.8.11
    fixed_versions: vers:composer/2.8.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=2.9.0|<2.9.5
    fixed_versions: vers:composer/2.9.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.0.0|<3.0.3
    fixed_versions: vers:composer/3.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-6mxm-wpqv-675h/GHSA-6mxm-wpqv-675h.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-50705
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/3b214760fb51ae2b0c85bbb2b272b9bc7c164657
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/4db8407d3eaba17a8d3f81957b8e93e9f2554055
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/4ee7394c8bfa95a63428385b542c2066cd2d8ea1
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/54d6ee8c0874d72705ffa4c7c17d7c90bc16c897
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/61da84e4148aa1de83a6389eb77abf3bbf09a349
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/82d0c0b5218e9ceb35a4e24b4a4e1e2e9cfc840c
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/ce597604763272396e5cb8ec93859a8568020b8b
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/d9d8e9c3fe92c5f25e319a38fe5617088965ad20
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/f4fcb1c4f76488d4571d3d265efce3813676c45d
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=330174
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20160424224349/http://www.securitytracker.com/id/1035333
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2016/03/21/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2016-2152
    reference_type:
    reference_id: CVE-2016-2152
