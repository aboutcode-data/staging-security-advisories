advisory_id: GHSA-m2wj-r6g3-fxfx
datasource_id: github_osv_importer_v2/GHSA-m2wj-r6g3-fxfx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-m2wj-r6g3-fxfx/GHSA-m2wj-r6g3-fxfx.json
aliases:
  - CVE-2023-46733
summary: |
  Symfony possible session fixation vulnerability
  ### Description

  SessionStrategyListener does not always migrate the session after a successful login. It only migrate the session when the logged-in user identifier changes. In some use cases, the user identifier doesn't change between the verification phase and the successful login, while the token itself changes from one type (partially-authenticated) to another (fully-authenticated). When this happens, the session id should be regenerated to prevent possible session fixations.

  ### Resolution

  Symfony now checks the type of the token in addition to the user identifier before deciding whether the session id should be regenerated.

  The patch for this issue is available [here](https://github.com/symfony/symfony/commit/dc356499d5ceb86f7cf2b4c7f032eca97061ed74) for branch 5.4.

  ### Credits

  We would like to thank Robert Meijers for reporting the issue and providing the fix.
impacted_packages:
  - purl: pkg:composer/symfony/security-http
    affected_versions: vers:composer/>=5.4.21|<5.4.31
    fixed_versions: vers:composer/5.4.31
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/security-http
    affected_versions: vers:composer/>=6.2.7|<6.3.8
    fixed_versions: vers:composer/6.3.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=5.4.21|<5.4.31
    fixed_versions: vers:composer/5.4.31
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=6.2.7|<6.3.8
    fixed_versions: vers:composer/6.3.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-m2wj-r6g3-fxfx/GHSA-m2wj-r6g3-fxfx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-384
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2023-46733.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/7467bd7e3f888b333102bc664b5e02ef1e7f88b9
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/dc356499d5ceb86f7cf2b4c7f032eca97061ed74
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/security/advisories/GHSA-m2wj-r6g3-fxfx
    reference_type:
    reference_id:
  - url: https://symfony.com/cve-2023-46733
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-46733
    reference_type:
    reference_id: CVE-2023-46733
