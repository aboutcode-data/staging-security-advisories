advisory_id: GHSA-mrph-w4hh-gx3g
datasource_id: github_osv_importer_v2/GHSA-mrph-w4hh-gx3g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-mrph-w4hh-gx3g/GHSA-mrph-w4hh-gx3g.json
aliases:
  - CVE-2026-23633
summary: |
  Gogs has arbitrary file read/write via Path Traversal in Git hook editing
  ## Vulnerability Description

  In the endpoint:

  ```
  /username/reponame/settings/hooks/git/:name
  ```

  the `:name` parameter:

  * Is URL-decoded by **macaron routing**, allowing decoded slashes (`/`)
  * Is then passed directly to:

  ```go
  git.Repository.Hook("custom_hooks", name)
  ```

  which internally resolves the path as:

  ```go
  filepath.Join(repoPath, "custom_hooks", name)
  ```

  Because no path sanitization is applied, supplying `../` sequences allows access to **arbitrary paths outside the repository**.

  ### As a Result:

  * **GET:** Arbitrary file contents are displayed in the hook edit page textarea (**Local File Inclusion**).
  * **POST:** Existing files can be overwritten with attacker-controlled content (**Arbitrary File Write**).

  ---

  ## Attack Prerequisites

  * The attacker is an authenticated user
  * The attacker has **Admin or higher privileges** on the target repository
  * The attacker has the **AllowGitHook** permission (or is a site administrator)
  * The target file is readable/writable by the **Gogs process OS permissions**

  ---

  ## Attack Scenario

  1. An attacker (with AllowGitHook + repository Admin privileges) accesses the Git hook edit URL
  2. A path containing `../` is supplied in `:name`, fully URL-encoded using `%2f`
  3. The server resolves `custom_hooks/../../...` without validation
  4. Arbitrary file contents are displayed and existing files can be overwritten

  ---

  ## Potential Impact

  * **Sensitive information disclosure:** `app.ini`, databases, logs, environment variables, etc.
  * **Configuration or data tampering:** Overwriting existing files
  * **Secondary impact:** Extraction of `SECRET_KEY` and database credentials may allow token forging or further compromise
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-mrph-w4hh-gx3g/GHSA-mrph-w4hh-gx3g.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/gogs/gogs
    reference_type:
    reference_id:
  - url: https://github.com/gogs/gogs/commit/4894629903f9508fe85567c44f68804f008f1655
    reference_type:
    reference_id:
  - url: https://github.com/gogs/gogs/releases/tag/v0.13.4
    reference_type:
    reference_id:
  - url: https://github.com/gogs/gogs/security/advisories/GHSA-mrph-w4hh-gx3g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23633
    reference_type:
    reference_id:
