advisory_id: GHSA-2q6j-gqc4-4gw3
datasource_id: github_osv_importer_v2/GHSA-2q6j-gqc4-4gw3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-2q6j-gqc4-4gw3/GHSA-2q6j-gqc4-4gw3.json
aliases:
  - CVE-2022-31021
summary: |
  Breaking unlinkability in Identity Mixer using malicious keys
  # CL Signatures Issuer Key Correctness Proof lacks of prime strength checking

  A weakness in the Hyperledger AnonCreds specification that is not mitigated in the Ursa and AnonCreds implementations is that the Issuer does not publish a key correctness proof demonstrating that a generated private key is sufficient to meet the unlinkability guarantees of AnonCreds. A sufficient private key is one in which it's components `p` and `q` are safe primes, such that:

  - `p` and `q` are both prime numbers
  - `p` and `q` are not equal
  - `p` and `q` have the same, sufficiently large, size
    - For example, using two values both 1024 bits long is sufficient, whereas using one value 2040 bits long and the other 8 bits long is not.

  The Ursa and AnonCreds CL-Signatures implementations always generate a sufficient private key. A malicious issuer could in theory create a custom CL Signature implementation (derived from the Ursa or AnonCreds CL-Signatures implementations) that uses weakened private keys such that presentations from holders could be shared by verifiers  to the issuer who could determine the holder to which the credential was issued.

  ### Impact

  This vulnerability could impact holders of AnonCreds credentials implemented using the CL-signature scheme in the Ursa and AnonCreds implementations of CL Signatures.

  ### Mitigations

  [Jan Camenisch and Markus Michels. Proving in zero-knowledge that a number is the product of two safe primes] (pages 12-13) demonstrates a key correctness proof that could be used to show the issuer has generated a sufficiently strong private key, proving the characteristics listed above.

  In a future version of AnonCreds, the additional key correctness proof could be published separately or added to the Credential Definition. In the meantime, Issuers in existing ecosystems can share such a proof with their ecosystem co-participants in an ad hoc manner.

  [Jan Camenisch and Markus Michels. Proving in zero-knowledge that a number is the product of two safe primes]: https://www.brics.dk/RS/98/29/BRICS-RS-98-29.pdf

  The lack of such a published key correctness proof allows a malicious Issuer to deliberately generate a private key that lacks the requirements listed above, enabling the Issuer to perform a brute force attack on presentations provided to colluding verifiers that breaks the unlinkability guarantee of AnonCreds.
impacted_packages: []
severities:
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-2q6j-gqc4-4gw3/GHSA-2q6j-gqc4-4gw3.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-829
references:
  - url: https://github.com/hyperledger-archives/ursa
    reference_type:
    reference_id:
  - url: https://github.com/hyperledger-archives/ursa/security/advisories/GHSA-2q6j-gqc4-4gw3
    reference_type:
    reference_id:
  - url: https://github.com/hyperledger/ursa/security/advisories/GHSA-2q6j-gqc4-4gw3
    reference_type:
    reference_id:
  - url: https://www.brics.dk/RS/98/29/BRICS-RS-98-29.pdf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31021
    reference_type:
    reference_id: CVE-2022-31021
