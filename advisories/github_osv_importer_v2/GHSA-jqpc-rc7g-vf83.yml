advisory_id: GHSA-jqpc-rc7g-vf83
datasource_id: github_osv_importer_v2/GHSA-jqpc-rc7g-vf83
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-jqpc-rc7g-vf83/GHSA-jqpc-rc7g-vf83.json
aliases:
  - CVE-2023-50715
summary: |
  User accounts disclosed to unauthenticated actors on the LAN
  ### Summary

  The login page discloses all active user accounts to any unauthenticated browsing request originating on the Local Area Network.

  ### Details

  Starting the [Home Assistant 2023.12 release](https://www.home-assistant.io/blog/2023/12/06/release-202312/), the login page returns all currently active user accounts to browsing requests from the Local Area Network. Tests showed that this occurs when:

  - The request is not authenticated and
  - The request originated locally, meaning on the Home Assistant host local subnet or any other private subnet (`10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, fd00::/8, ::ffff:10.0.0.0/104, ::ffff:172.16.0.0/108, ::ffff:192.168.0.0/112`)

  The rationale behind this is to make the login more user-friendly (see [release blog post](https://www.home-assistant.io/blog/2023/12/06/release-202312/)) and an experience better aligned with other applications that have multiple user-profiles.

  However, as a result, all accounts are displayed regardless of them having logged in or not and for any device that navigates to the server. This disclosure is mitigated by the fact that it only occurs for requests originating from a LAN address. But note that this applies to the local subnet where Home Assistant resides and to any private subnet that can reach it.

  ### PoC

  1. Place a Home Assistant instance on a private subnet, i.e., 192.168.1.0/24.
  2. Create a few users, let's say, three.
  3. From any (or another) private subnet on the LAN, like 192.168.2.0/24, open an incognito browser window (to ensure that the browser has no cookies from Home Assistant and therefore is demonstrably unauthenticated) and navigate to the Home Assistant URL.
  4. The login page will display all three users, including their profile photo.

  ### Impact

  The following CVSS string could be shaped to describe the overall impact of this issue:
  AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

  As seen, the Exploitability metrics are high, and the Impact metrics are low. This is fitting because the problem does not constitute a critical one, but at the same time, it is trivial to exploit. Still, since the mitigation can be so easily implemented in code to eliminate a typical case of information disclosure, it would certainly be worth pursuing.
impacted_packages:
  - purl: pkg:pypi/homeassistant
    affected_versions: vers:pypi/<2023.12.3
    fixed_versions: vers:pypi/2023.12.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-jqpc-rc7g-vf83/GHSA-jqpc-rc7g-vf83.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/home-assistant/core
    reference_type:
    reference_id:
  - url: https://github.com/home-assistant/core/commit/dbfc5ea8f96bde6cd165892f5a6a6f9a65731c76
    reference_type:
    reference_id:
  - url: https://github.com/home-assistant/core/security/advisories/GHSA-jqpc-rc7g-vf83
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-50715
    reference_type:
    reference_id: CVE-2023-50715
