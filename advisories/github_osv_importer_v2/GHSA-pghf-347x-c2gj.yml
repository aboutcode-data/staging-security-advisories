advisory_id: GHSA-pghf-347x-c2gj
datasource_id: github_osv_importer_v2/GHSA-pghf-347x-c2gj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-pghf-347x-c2gj/GHSA-pghf-347x-c2gj.json
aliases:
  - CVE-2021-30459
summary: |
  SQL Injection via in django-debug-toolbar
  ### Impact
  With Django Debug Toolbar attackers are able to execute SQL by changing the `raw_sql` input of the SQL explain, analyze or select forms and submitting the form.

  **NOTE:** This is a high severity issue for anyone using the toolbar in a **production environment**.

  Generally the Django Debug Toolbar team only maintains the latest version of django-debug-toolbar, but an exception was made because of the high severity of this issue.

  ### Patches
  Please upgrade to one of the following versions, depending on the major version you're using:

  - Version 1.x: [django-debug-toolbar 1.11.1](https://pypi.org/project/django-debug-toolbar/1.11.1/)
  - Version 2.x: [django-debug-toolbar 2.2.1](https://pypi.org/project/django-debug-toolbar/2.2.1/)
  - Version 3.x: [django-debug-toolbar 3.2.1](https://pypi.org/project/django-debug-toolbar/3.2.1/)

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in the [django-debug-toolbar repo](https://github.com/jazzband/django-debug-toolbar/issues/new)  (Please NO SENSITIVE INFORMATION, send an email instead!)
  * Email us at [security@jazzband.co](mailto:security@jazzband.co)
impacted_packages:
  - purl: pkg:pypi/django-debug-toolbar
    affected_versions: vers:pypi/>=0.10.0|<1.11.1
    fixed_versions: vers:pypi/1.11.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/django-debug-toolbar
    affected_versions: vers:pypi/>=2.0a1|<2.2.1
    fixed_versions: vers:pypi/2.2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/django-debug-toolbar
    affected_versions: vers:pypi/>=3.0a1|<3.2.1
    fixed_versions: vers:pypi/3.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-pghf-347x-c2gj/GHSA-pghf-347x-c2gj.json
  - score: '7.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-pghf-347x-c2gj/GHSA-pghf-347x-c2gj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-30459
    reference_type:
    reference_id:
  - url: https://github.com/jazzband/django-debug-toolbar
    reference_type:
    reference_id:
  - url: https://github.com/jazzband/django-debug-toolbar/releases
    reference_type:
    reference_id:
  - url: https://github.com/jazzband/django-debug-toolbar/security/advisories/GHSA-pghf-347x-c2gj
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/django-debug-toolbar/PYSEC-2021-10.yaml
    reference_type:
    reference_id:
  - url: https://www.djangoproject.com/weblog/2021/apr/14/debug-toolbar-security-releases
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-30459
    reference_type:
    reference_id: CVE-2021-30459
