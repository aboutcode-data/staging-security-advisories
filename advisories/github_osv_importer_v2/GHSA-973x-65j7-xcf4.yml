advisory_id: GHSA-973x-65j7-xcf4
datasource_id: github_osv_importer_v2/GHSA-973x-65j7-xcf4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-973x-65j7-xcf4/GHSA-973x-65j7-xcf4.json
aliases:
  - CVE-2024-36114
summary: |
  Decompressors can crash the JVM and leak memory content in Aircompressor
  ### Summary
  All decompressor implementations of Aircompressor (LZ4, LZO, Snappy, Zstandard) can crash the JVM for certain input, and in some cases also leak the content of other memory of the Java process (which could contain sensitive information).

  ### Details
  When decompressing certain data, the decompressors try to access memory outside the bounds of the given byte arrays or byte buffers. Because Aircompressor uses the JDK class `sun.misc.Unsafe` to speed up memory access, no additional bounds checks are performed and this has similar security consequences as out-of-bounds access in C or C++, namely it can lead to non-deterministic behavior or crash the JVM.

  Users should update to Aircompressor 0.27 or newer where these issues have been fixed.

  ### Impact
  When decompressing data from untrusted users, this can be exploited for a denial-of-service attack by crashing the JVM, or to leak other sensitive information from the Java process.
impacted_packages:
  - purl: pkg:maven/io.airlift/aircompressor
    affected_versions: vers:maven/<0.27
    fixed_versions: vers:maven/0.27
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-973x-65j7-xcf4/GHSA-973x-65j7-xcf4.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-787
  - CWE-125
references:
  - url: https://github.com/airlift/aircompressor
    reference_type:
    reference_id:
  - url: https://github.com/airlift/aircompressor/commit/15e68df9eb0c2bfde7f796231ee7cd1982965071
    reference_type:
    reference_id:
  - url: https://github.com/airlift/aircompressor/commit/2cea90a45534f9aacbb77426fb64e975504dee6e
    reference_type:
    reference_id:
  - url: https://github.com/airlift/aircompressor/commit/cf66151541edb062ea88b6f3baab3f95e48b7b7f
    reference_type:
    reference_id:
  - url: https://github.com/airlift/aircompressor/commit/d01ecb779375a092d00e224abe7869cdf49ddc3e
    reference_type:
    reference_id:
  - url: https://github.com/airlift/aircompressor/security/advisories/GHSA-973x-65j7-xcf4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-36114
    reference_type:
    reference_id: CVE-2024-36114
