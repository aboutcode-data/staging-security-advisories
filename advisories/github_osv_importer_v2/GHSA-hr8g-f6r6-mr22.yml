advisory_id: GHSA-hr8g-f6r6-mr22
datasource_id: github_osv_importer_v2/GHSA-hr8g-f6r6-mr22
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-hr8g-f6r6-mr22/GHSA-hr8g-f6r6-mr22.json
aliases:
  - CVE-2022-30595
summary: |
  Buffer over-flow in Pillow
  When reading a TGA file with RLE packets that cross scan lines, Pillow reads the information past the end of the first line without deducting that from the length of the remaining file data. This vulnerability was introduced in Pillow 9.1.0, and can cause a heap buffer overflow.

  Opening an image with a zero or negative height has been found to bypass a decompression bomb check. This will now raise a SyntaxError instead, in turn raising a PIL.UnidentifiedImageError.
impacted_packages:
  - purl: pkg:pypi/pillow
    affected_versions: vers:pypi/9.1.0
    fixed_versions: vers:pypi/9.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-hr8g-f6r6-mr22/GHSA-hr8g-f6r6-mr22.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-hr8g-f6r6-mr22/GHSA-hr8g-f6r6-mr22.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-120
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pillow/PYSEC-2022-43145.yaml
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow/blob/main/src/libImaging/TgaRleDecode.c
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow/commit/c846cc881ebe34e3518412c2e3636433d9947280
    reference_type:
    reference_id:
  - url: https://pillow.readthedocs.io/en/stable/releasenotes/9.1.1.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-30595
    reference_type:
    reference_id: CVE-2022-30595
