advisory_id: GHSA-68r2-fwcg-qpm8
datasource_id: github_osv_importer_v2/GHSA-68r2-fwcg-qpm8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-68r2-fwcg-qpm8/GHSA-68r2-fwcg-qpm8.json
aliases:
  - CVE-2025-24814
summary: |
  Apache Solr vulnerable to Execution with Unnecessary Privileges
  Core creation allows users to replace "trusted" configset files with arbitrary configuration

  Solr instances that (1) use the "FileSystemConfigSetService" component (the default in "standalone" or "user-managed" mode), and (2) are running without authentication and authorization are vulnerable to a sort of privilege escalation wherein individual "trusted" configset files can be ignored in favor of potentially-untrusted replacements available elsewhere on the filesystem.  These replacement config files are treated as "trusted" and can use "<lib>" tags to add to Solr's classpath, which an attacker might use to load malicious code as a searchComponent or other plugin.

  This issue affects all Apache Solr versions up through Solr 9.7.  Users can protect against the vulnerability by enabling authentication and authorization on their Solr clusters or switching to SolrCloud (and away from "FileSystemConfigSetService").  Users are also recommended to upgrade to Solr 9.8.0, which mitigates this issue by disabling use of "<lib>" tags by default.
impacted_packages:
  - purl: pkg:maven/org.apache.solr/solr-core
    affected_versions: vers:maven/<9.8.0
    fixed_versions: vers:maven/9.8.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-68r2-fwcg-qpm8/GHSA-68r2-fwcg-qpm8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-250
references:
  - url: https://github.com/apache/solr
    reference_type:
    reference_id:
  - url: https://github.com/apache/solr/commit/f492e24881c5724a1b1baecfc9549e2cb0257525
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/SOLR-16781
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/gl291pn8x9f9n52ys5l0pc0b6qtf0qw1
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20250214-0002
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2025/01/26/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-24814
    reference_type:
    reference_id: CVE-2025-24814
