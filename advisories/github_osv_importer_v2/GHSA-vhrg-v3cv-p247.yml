advisory_id: GHSA-vhrg-v3cv-p247
datasource_id: github_osv_importer_v2/GHSA-vhrg-v3cv-p247
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-vhrg-v3cv-p247/GHSA-vhrg-v3cv-p247.json
aliases:
  - CVE-2017-4995
summary: |
  Deserialization of Untrusted Data in Spring Security
  An issue was discovered in Pivotal Spring Security 4.2.0.RELEASE through 4.2.2.RELEASE, and Spring Security 5.0.0.M1. When configured to enable default typing, Jackson contained a deserialization vulnerability that could lead to arbitrary code execution. Jackson fixed this vulnerability by blacklisting known "deserialization gadgets." Spring Security configures Jackson with global default typing enabled, which means that (through the previous exploit) arbitrary code could be executed if all of the following is true: (1) Spring Security's Jackson support is being leveraged by invoking SecurityJackson2Modules.getModules(ClassLoader) or SecurityJackson2Modules.enableDefaultTyping(ObjectMapper); (2) Jackson is used to deserialize data that is not trusted (Spring Security does not perform deserialization using Jackson, so this is an explicit choice of the user); and (3) there is an unknown (Jackson is not blacklisting it already) "deserialization gadget" that allows code execution present on the classpath. Jackson provides a blacklisting approach to protecting against this type of attack, but Spring Security should be proactive against blocking unknown "deserialization gadgets" when Spring Security enables default typing.
impacted_packages:
  - purl: pkg:maven/org.springframework.security/spring-security-core
    affected_versions: vers:maven/<=4.2.2.RELEASE
    fixed_versions: vers:maven/4.2.3.RELEASE
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.springframework.security/spring-security-core
    affected_versions: vers:maven/5.0.0.M1
    fixed_versions: vers:maven/5.0.0.M2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-vhrg-v3cv-p247/GHSA-vhrg-v3cv-p247.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://github.com/FasterXML/jackson-databind/commit/60d459cedcf079c6106ae7da2ac562bc32dcabe1
    reference_type:
    reference_id:
  - url: https://github.com/FasterXML/jackson-databind/commit/6ce32ffd18facac6abdbbf559c817b47fcb622c
    reference_type:
    reference_id:
  - url: https://github.com/FasterXML/jackson-databind/issues/1599
    reference_type:
    reference_id:
  - url: https://github.com/spring-projects/spring-security/issues/4370
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/4641ed8616ccc2c1fbddac2c3dc9900c96387bc226eaf0232d61909b@%3Ccommits.cassandra.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r42ac3e39e6265db12d9fc6ae1cd4b5fea7aed9830dc6f6d58228fed7@%3Ccommits.cassandra.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/rf7f87810c38dc9abf9f93989f76008f504cbf7c1a355214640b2d04c@%3Ccommits.cassandra.apache.org%3E
    reference_type:
    reference_id:
  - url: https://pivotal.io/security/cve-2017-4995
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-4995
    reference_type:
    reference_id: CVE-2017-4995
