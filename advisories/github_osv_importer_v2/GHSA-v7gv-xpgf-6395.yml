advisory_id: GHSA-v7gv-xpgf-6395
datasource_id: github_osv_importer_v2/GHSA-v7gv-xpgf-6395
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-v7gv-xpgf-6395/GHSA-v7gv-xpgf-6395.json
aliases:
  - CVE-2024-10451
summary: |
  Keycloak Build Process Exposes Sensitive Data
  A flaw was found in Keycloak. This issue occurs because sensitive runtime values, such as passwords, may be captured during the Keycloak build process and embedded as default values in bytecode, leading to unintended information disclosure. In Keycloak 26, sensitive data specified directly in environment variables during the build process is also stored as a default values, making it accessible during runtime. Indirect usage of environment variables for SPI options and Quarkus properties is also vulnerable due to unconditional expansion by PropertyMapper logic, capturing sensitive data as default values in all Keycloak versions up to 26.0.2.
impacted_packages:
  - purl: pkg:maven/org.keycloak/keycloak-quarkus-server
    affected_versions: vers:maven/<24.0.9
    fixed_versions: vers:maven/24.0.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.keycloak/keycloak-quarkus-server
    affected_versions: vers:maven/>=25.0.0|<26.0.6
    fixed_versions: vers:maven/26.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-v7gv-xpgf-6395/GHSA-v7gv-xpgf-6395.json
  - score: '8.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-v7gv-xpgf-6395/GHSA-v7gv-xpgf-6395.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-798
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-10451
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak/commit/198214310eb45b86707f823ccb5a2d65c814b528
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak/security/advisories/GHSA-v7gv-xpgf-6395
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2322096
    reference_type: bug
    reference_id: 2322096
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-10451
    reference_type:
    reference_id: CVE-2024-10451
  - url: https://access.redhat.com/errata/RHSA-2024:10175
    reference_type:
    reference_id: RHSA-2024:10175
  - url: https://access.redhat.com/errata/RHSA-2024:10176
    reference_type:
    reference_id: RHSA-2024:10176
  - url: https://access.redhat.com/errata/RHSA-2024:10177
    reference_type:
    reference_id: RHSA-2024:10177
  - url: https://access.redhat.com/errata/RHSA-2024:10178
    reference_type:
    reference_id: RHSA-2024:10178
