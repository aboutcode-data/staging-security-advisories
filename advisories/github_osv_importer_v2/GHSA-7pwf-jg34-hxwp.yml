advisory_id: GHSA-7pwf-jg34-hxwp
datasource_id: github_osv_importer_v2/GHSA-7pwf-jg34-hxwp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7pwf-jg34-hxwp/GHSA-7pwf-jg34-hxwp.json
aliases:
  - CVE-2022-24878
summary: |
  Improper path handling in Kustomization files allows for denial of service
  The kustomize-controller enables the use of Kustomizeâ€™s functionality when applying Kubernetes declarative state onto a cluster. A malicious user can use a specially crafted `kustomization.yaml` to cause Denial of Service at controller level.

  In multi-tenancy deployments this can lead to multiple tenants not being able to apply their Kustomizations until the malicious `kustomization.yaml` is removed and the controller restarted.

  ### Impact

  Within the affected versions, users with write access to a Flux source are able to craft a malicious `kustomization.yaml` file which causes the controller to enter an endless loop.

  ### Patches

  This vulnerability was fixed in kustomize-controller v0.24.0 and included in flux2 v0.29.0 released on 2022-04-20. The changes introduce better handling of Kustomization files blocking references that could lead to endless loops.

  ### Credits

  The Flux engineering team found and patched this vulnerability.

  ### For more information

  If you have any questions or comments about this advisory please open an issue in the [flux2 repository](http://github.com/fluxcd/flux2).
impacted_packages: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7pwf-jg34-hxwp/GHSA-7pwf-jg34-hxwp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-674
references:
  - url: https://github.com/fluxcd/flux2
    reference_type:
    reference_id:
  - url: https://github.com/fluxcd/flux2/security/advisories/GHSA-7pwf-jg34-hxwp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24878
    reference_type:
    reference_id: CVE-2022-24878
