advisory_id: GHSA-jqxr-vjvv-899m
datasource_id: github_osv_importer_v2/GHSA-jqxr-vjvv-899m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-jqxr-vjvv-899m/GHSA-jqxr-vjvv-899m.json
aliases:
  - CVE-2023-34247
summary: |
  @keystone-6/auth Open Redirect vulnerability
  ### Summary
  There is an open redirect in the `@keystone-6/auth` package, where the redirect leading `/` filter can be bypassed.

  ### Impact
  Users may be redirected to domains other than the relative host, thereby it might be used by attackers to re-direct users to an unexpected location.

  ### Mitigations
  - Don't use the `@keystone-6/auth` package

  ### References
  - [CWE-601: URL Redirection to Untrusted Site ('Open Redirect')](https://cwe.mitre.org/data/definitions/601.html)
  - [OWASP: Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html)

  #### Similar Vulnerability Reports
  - [CVE-2023-0748](https://nvd.nist.gov/vuln/detail/CVE-2023-0748)
  - [CVE-2022-2252](https://nvd.nist.gov/vuln/detail/CVE-2022-2252)

  #### Credits
  Thanks to [morioka12](https://github.com/scgajge12) for reporting this problem.

  If you have any questions around this security advisory, please don't hesitate to contact us at [security@keystonejs.com](mailto:security@keystonejs.com), or [open an issue on GitHub](https://github.com/keystonejs/keystone/issues/new/choose).

  If you have a security flaw to report for any software in this repository, please see our [SECURITY policy](https://github.com/keystonejs/keystone/blob/main/SECURITY.md).
impacted_packages:
  - purl: pkg:npm/%40keystone-6/auth
    affected_versions: vers:npm/<7.0.0
    fixed_versions: vers:npm/7.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:R/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-jqxr-vjvv-899m/GHSA-jqxr-vjvv-899m.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/keystonejs/keystone
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/pull/8626
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/security/advisories/GHSA-jqxr-vjvv-899m
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34247
    reference_type:
    reference_id: CVE-2023-34247
