advisory_id: GHSA-m87f-9fvv-2mgg
datasource_id: github_osv_importer_v2/GHSA-m87f-9fvv-2mgg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-m87f-9fvv-2mgg/GHSA-m87f-9fvv-2mgg.json
aliases:
  - CVE-2021-39207
summary: |
  Deserialization of Untrusted Data in parlai
  ### Impact
  Due to use of unsafe YAML deserialization logic, an attacker with the ability to modify local YAML configuration files could provide malicious input, resulting in remote code execution or similar risks.

  ### Patches
  The issue can be patched by upgrading to v1.1.0 or later. It can also be patched by replacing YAML deserialization with equivalent safe_load calls.

  ### References

  - https://github.com/facebookresearch/ParlAI/commit/507d066ef432ea27d3e201da08009872a2f37725
  - https://github.com/facebookresearch/ParlAI/commit/4374fa2aba383db6526ab36e939eb1cf8ef99879
  - https://anon-artist.github.io/blogs/blog3.html
impacted_packages:
  - purl: pkg:pypi/parlai
    affected_versions: vers:pypi/<1.1.0
    fixed_versions: vers:pypi/1.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-m87f-9fvv-2mgg/GHSA-m87f-9fvv-2mgg.json
  - score: '5.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-m87f-9fvv-2mgg/GHSA-m87f-9fvv-2mgg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: http://packetstormsecurity.com/files/164136/Facebook-ParlAI-1.0.0-Code-Execution-Deserialization.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-mwgj-7x7j-6966
    reference_type:
    reference_id:
  - url: https://github.com/facebookresearch/ParlAI
    reference_type:
    reference_id:
  - url: https://github.com/facebookresearch/ParlAI/commit/4374fa2aba383db6526ab36e939eb1cf8ef99879
    reference_type:
    reference_id:
  - url: https://github.com/facebookresearch/ParlAI/commit/507d066ef432ea27d3e201da08009872a2f37725
    reference_type:
    reference_id:
  - url: https://github.com/facebookresearch/ParlAI/releases/tag/v1.1.0
    reference_type:
    reference_id:
  - url: https://github.com/facebookresearch/ParlAI/security/advisories/GHSA-m87f-9fvv-2mgg
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/parlai/PYSEC-2021-330.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/parlai/PYSEC-2021-334.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39207
    reference_type:
    reference_id: CVE-2021-39207
