advisory_id: GHSA-pfq2-hh62-7m96
datasource_id: github_osv_importer_v2/GHSA-pfq2-hh62-7m96
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-pfq2-hh62-7m96/GHSA-pfq2-hh62-7m96.json
aliases: []
summary: "Renovate vulnerable to arbitrary command injection via Gradle Wrapper and malicious\
  \ `distributionUrl`\n### Summary\nRenovate can be tricked into executing shell code while\
  \ updating the Gradle Wrapper. A malicious `distributionUrl` in `gradle/wrapper/gradle-wrapper.properties`\
  \ can lead to command execution in the Renovate runtime.\n\n### Details\nWhen Renovate handles\
  \ Gradle Wrapper artifacts, it may run a wrapper update command such as:\n- `./gradlew :wrapper\
  \ --gradle-distribution-url <value>`\n\nIn the observed behavior, Renovate executes this via\
  \ a shell (e.g., `/bin/sh -c ...`).  \nIf `distributionUrl` contains shell command substitution\
  \ syntax like `$(...)`, the shell evaluates it **before** Gradle validates/parses the URL.\n\
  \nAfter that, Gradle attempts to parse the URL as a URI and fails with `URISyntaxException`,\
  \ but the shell substitution has already executed.\n\nThis is reproducible even when `allowScripts`\
  \ is disabled (default is OFF), because this execution happens as part of Gradle Wrapper artifact\
  \ handling rather than “repository install scripts”.\n\nPrerequisites / attack conditions:\n\
  - The attacker must be able to get a malicious `gradle-wrapper.properties` into a repository\
  \ that Renovate scans (e.g., direct write access, or a maintainer merges an attacker’s change/PR).\n\
  - Renovate must be configured to process Gradle Wrapper updates/artifacts for that repository\
  \ (default behavior for the Gradle Wrapper manager).\n\n### PoC\n1. Create a repository with\
  \ a Gradle Wrapper (`gradlew`, `gradlew.bat`, `gradle/wrapper/gradle-wrapper.jar`, and `gradle/wrapper/gradle-wrapper.properties`).\n\
  2. Set `distributionUrl` in `gradle-wrapper.properties` to include `$(...)`.\n3. Run Renovate\
  \ against the repository.\n4. Observe that a file is created during Renovate’s wrapper update\
  \ step **before** Gradle fails with `URISyntaxException`.\n\nA [screen recording](https://drive.google.com/file/d/1nveSCgyz4pKPCZuelqDD_xGEO00DXr4P/view)\
  \ is attached showing end-to-end reproduction. In the demo, the payload creates `/tmp/passwd_dump`\
  \ containing `/etc/passwd`, demonstrating that file read/exfiltration is possible within the\
  \ Renovate execution context.\n\n### Impact\nThis allows arbitrary command execution in the\
  \ Renovate runtime during Gradle Wrapper updates. Depending on deployment, this may expose\
  \ credentials/tokens available to the bot and may allow an attacker to modify repositories\
  \ or access internal resources reachable from the Renovate environment.\n\n### Remediation\n\
  \nUpgrading to Renovate [42.68.5](https://github.com/renovatebot/renovate/releases/tag/42.68.5)\
  \ (2025-12-31) fixes this issue, and closes out other risks of shell evaluation for commands\
  \ run by Renovate.\n\nIf using the `composer`, `yarn` (v1) or `flux` managers, please upgrade\
  \ to [42.74.5](https://github.com/renovatebot/renovate/releases/tag/42.74.5) (2026-01-08),\
  \ as there were follow-up fixes to keep these managers working."
impacted_packages:
  - purl: pkg:npm/renovate
    affected_versions: vers:npm/>=32.124.0|<42.68.5
    fixed_versions: vers:npm/42.68.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-pfq2-hh62-7m96/GHSA-pfq2-hh62-7m96.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/renovatebot/renovate
    reference_type:
    reference_id:
  - url: https://github.com/renovatebot/renovate/releases/tag/42.68.5
    reference_type:
    reference_id:
  - url: https://github.com/renovatebot/renovate/security/advisories/GHSA-pfq2-hh62-7m96
    reference_type:
    reference_id:
