advisory_id: GHSA-8jpw-gpr4-8cmh
datasource_id: github_osv_importer_v2/GHSA-8jpw-gpr4-8cmh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-8jpw-gpr4-8cmh/GHSA-8jpw-gpr4-8cmh.json
aliases:
  - CVE-2025-64748
summary: |
  Directus's conceal fields are searchable if read permissions enabled
  ## Summary

  A vulnerability allows authenticated users to search concealed/sensitive fields when they have read permissions. While actual values remain masked (`****`), successful matches can be detected through returned records, enabling enumeration attacks on sensitive data.

  ## Details

  The system permits search operations on concealed fields in the `directus_users` collection, including `token`, `tfa_secret`, `password`. Matching records are returned with masked values, but their presence confirms the searched value exists.

  The "Recommended Defaults" for "App Access" grant users full read permissions to their role/user records, inadvertently enabling them to search for any user's tokens, TFA secrets, and password hashes. Attackers can leverage known password hashes from breach databases to identify accounts with compromised passwords.

  # Impact

  This vulnerability enables:
  - **Token enumeration** - Verification of valid authentication tokens
  - **Password hash matching** - Identification of accounts using known compromised passwords
  - **Information disclosure** - Confirmation of sensitive value existence without viewing actual data
  - **Increased attack surface** - Default permissions automatically expose all deployments using recommended settings

  The risk is particularly high for password fields, where attackers can cross-reference publicly available hash databases to identify vulnerable accounts.
impacted_packages:
  - purl: pkg:npm/directus
    affected_versions: vers:npm/<11.13.0
    fixed_versions: vers:npm/11.13.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40directus/api
    affected_versions: vers:npm/<32.0.0
    fixed_versions: vers:npm/32.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-8jpw-gpr4-8cmh/GHSA-8jpw-gpr4-8cmh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-201
references:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/commit/7737d56e096f95edfbdf861a3c08999ad31ce204
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-8jpw-gpr4-8cmh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64748
    reference_type:
    reference_id:
