advisory_id: GHSA-vfj6-275q-4pvm
datasource_id: github_osv_importer_v2/GHSA-vfj6-275q-4pvm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/10/GHSA-vfj6-275q-4pvm/GHSA-vfj6-275q-4pvm.json
aliases:
  - CVE-2017-18638
summary: "graphite.composer.views.send_email vulnerable to SSRF\n### Impact\nsend_email in graphite-web/webapp/graphite/composer/views.py\
  \ in Graphite through 1.1.5 is vulnerable to SSRF. The vulnerable SSRF endpoint can be used\
  \ by an attacker to have the Graphite web server request any resource. The response to this\
  \ SSRF request is encoded into an image file and then sent to an e-mail address that can be\
  \ supplied by the attacker. Thus, an attacker can exfiltrate any information. Email will be\
  \ send through SMTP server configured in Graphite, by default it's 'localhost'\n\n### Patches\n\
  Problem was patched in Graphite-web 1.1.6. Also patches was released for graphite-web [1.0.x](https://github.com/graphite-project/graphite-web/pull/2501)\
  \ and [0.9.x](https://github.com/graphite-project/graphite-web/pull/2500), and we'll discuss\
  \ releases of non-supported branches later.\n\n### Workarounds\nYou can manually remove function\
  \ `send_email` from file `webapp/graphite/composer/views.py`. This function are not in use\
  \ and will not affect your Graphite installation.\n\n### References\nFor more information\
  \ check this graphite-web Github issue #2008 \n\n### For more information\nIf you have any\
  \ questions or comments about this advisory:\n* Add comment in [issue #2008](https://github.com/graphite-project/graphite-web/issues/2008)"
impacted_packages:
  - purl: pkg:pypi/graphite-web
    affected_versions: vers:pypi/<1.1.6
    fixed_versions: vers:pypi/1.1.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/10/GHSA-vfj6-275q-4pvm/GHSA-vfj6-275q-4pvm.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/10/GHSA-vfj6-275q-4pvm/GHSA-vfj6-275q-4pvm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html#second-bug-internal-graphite-ssrf
    reference_type:
    reference_id:
  - url: https://github.com/graphite-project/graphite-web
    reference_type:
    reference_id:
  - url: https://github.com/graphite-project/graphite-web/commit/71726a0e41a5263f49b973a7b856505a5b931c1f
    reference_type:
    reference_id:
  - url: https://github.com/graphite-project/graphite-web/issues/2008
    reference_type:
    reference_id:
  - url: https://github.com/graphite-project/graphite-web/pull/2499
    reference_type:
    reference_id:
  - url: https://github.com/graphite-project/graphite-web/security/advisories/GHSA-vfj6-275q-4pvm
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/graphite-web/PYSEC-2019-151.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2019/10/msg00030.html
    reference_type:
    reference_id:
  - url: https://www.youtube.com/watch?v=ds4Gp4xoaeA
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-18638
    reference_type:
    reference_id: CVE-2017-18638
