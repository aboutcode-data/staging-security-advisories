advisory_id: GHSA-9fcx-cv56-w58p
datasource_id: github_osv_importer_v2/GHSA-9fcx-cv56-w58p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-9fcx-cv56-w58p/GHSA-9fcx-cv56-w58p.json
aliases:
  - CVE-2021-27916
summary: |
  Mautic vulnerable to Relative Path Traversal / Arbitrary File Deletion due to GrapesJS builder
  ### Impact
  Prior to the patched version, logged in users of Mautic are vulnerable to Relative Path Traversal/Arbitrary File Deletion.  Regardless of the level of access the Mautic user had, they could delete files other than those in the media folders such as system files, libraries or other important files.

  This vulnerability exists in the implementation of the GrapesJS builder in Mautic.

  ### Patches
  Update to 4.4.12 or 5.0.4.

  ### Workarounds
  No

  ### References
  - https://cwe.mitre.org/data/definitions/23.html
  - https://cwe.mitre.org/data/definitions/22.html
  - https://attack.mitre.org/techniques/T1630/002/

  ### For more information

  If you have any questions or comments about this advisory:

  Email us at [security@mautic.org](mailto:security@mautic.org)
impacted_packages:
  - purl: pkg:composer/mautic/core
    affected_versions: vers:composer/>=3.3.0|<4.4.12
    fixed_versions: vers:composer/4.4.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/mautic/core
    affected_versions: vers:composer/>=5.0.0-alpha|<5.0.4
    fixed_versions: vers:composer/5.0.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-9fcx-cv56-w58p/GHSA-9fcx-cv56-w58p.json
  - score: '7.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-9fcx-cv56-w58p/GHSA-9fcx-cv56-w58p.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-23
  - CWE-22
references:
  - url: https://github.com/mautic/mautic
    reference_type:
    reference_id:
  - url: https://github.com/mautic/mautic/commit/546045ff9c74dd8b3dac36c4ab3674380262c65a
    reference_type:
    reference_id:
  - url: https://github.com/mautic/mautic/commit/95e8df3ae6730c725f1848d70e7992da369518f3
    reference_type:
    reference_id:
  - url: https://github.com/mautic/mautic/security/advisories/GHSA-9fcx-cv56-w58p
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-27916
    reference_type:
    reference_id: CVE-2021-27916
