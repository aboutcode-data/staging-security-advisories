advisory_id: GHSA-xfhv-wqj6-rx99
datasource_id: github_osv_importer_v2/GHSA-xfhv-wqj6-rx99
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-xfhv-wqj6-rx99/GHSA-xfhv-wqj6-rx99.json
aliases:
  - CVE-2025-24791
summary: |
  snowflake-sdk may incorrectly validate temporary credential cache file permissions
  ### Issue
  Snowflake discovered and remediated a vulnerability in the Snowflake NodeJS Driver. File permissions checks of the temporary credential cache could be bypassed by an attacker with write access to the local cache directory.

  This vulnerability affects versions 1.12.0 through 2.0.1 on Linux. Snowflake fixed the issue in version 2.0.2.

  ### Vulnerability Details
  On Linux, when either EXTERNALBROWSER or USERNAME_PASSWORD_MFA authentication methods are used with temporary credential caching enabled, the Snowflake NodeJS Driver will cache temporary credentials in a local file. Due to a bug, the check verifying that the cache file can be accessed only by the user running the Driver always succeeded, but didnâ€™t verify the permissions or the ownership correctly. An attacker with write access to the local cache folder could plant an empty file there and the Driver would use it to store temporary credentials instead of rejecting it due to overly broad permissions.

  ### Solution
  Snowflake released version 2.0.2 of the Snowflake NodeJS Driver, which fixes this issue. We recommend users upgrade to version 2.0.2.

  ### Additional Information
  If you discover a security vulnerability in one of our products or websites, please report the issue to HackerOne. For more information, please see our [Vulnerability Disclosure Policy](https://hackerone.com/snowflake?type=team).
impacted_packages:
  - purl: pkg:npm/snowflake-sdk
    affected_versions: vers:npm/<=2.0.1
    fixed_versions: vers:npm/2.0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-xfhv-wqj6-rx99/GHSA-xfhv-wqj6-rx99.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-281
references:
  - url: https://github.com/snowflakedb/snowflake-connector-nodejs
    reference_type:
    reference_id:
  - url: https://github.com/snowflakedb/snowflake-connector-nodejs/commit/89731b3a4d61a75b721d13d4e47a7a3712ffa45f
    reference_type:
    reference_id:
  - url: https://github.com/snowflakedb/snowflake-connector-nodejs/security/advisories/GHSA-xfhv-wqj6-rx99
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-24791
    reference_type:
    reference_id: CVE-2025-24791
