advisory_id: GHSA-3327-jr93-7hq3
datasource_id: github_osv_importer_v2/GHSA-3327-jr93-7hq3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-3327-jr93-7hq3/GHSA-3327-jr93-7hq3.json
aliases:
  - CVE-2017-6930
summary: |
  Drupal access bypass vulnerability
  In Drupal versions 8.4.x versions before 8.4.5 when using node access controls with a multilingual site, Drupal marks the untranslated version of a node as the default fallback for access queries. This fallback is used for languages that do not yet have a translated version of the created node. This can result in an access bypass vulnerability. This issue is mitigated by the fact that it only applies to sites that a) use the Content Translation module; and b) use a node access module such as Domain Access which implement hook_node_access_records().
impacted_packages:
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/>=8.4.0|<8.4.5
    fixed_versions: vers:composer/8.4.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/drupal/drupal
    affected_versions: vers:composer/>=8.4.0|<8.4.5
    fixed_versions: vers:composer/8.4.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-3327-jr93-7hq3/GHSA-3327-jr93-7hq3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
references:
  - url: https://github.com/drupal/core
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/core/CVE-2017-6930.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/drupal/CVE-2017-6930.yaml
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2018-001
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-6930
    reference_type:
    reference_id: CVE-2017-6930
