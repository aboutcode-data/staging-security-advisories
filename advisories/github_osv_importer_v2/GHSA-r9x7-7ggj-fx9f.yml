advisory_id: GHSA-r9x7-7ggj-fx9f
datasource_id: github_osv_importer_v2/GHSA-r9x7-7ggj-fx9f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-r9x7-7ggj-fx9f/GHSA-r9x7-7ggj-fx9f.json
aliases:
  - CVE-2025-64711
summary: |
  PrivateBin vulnerable to malicious filename use for self-XSS / HTML injection locally for users
  ## Summary

  Dragging a file whose filename contains HTML is reflected verbatim into the page via the drag-and-drop helper, so any user who drops a crafted file on PrivateBin will execute arbitrary JavaScript within their own session (self-XSS). This allows an attacker who can entice a victim to drag or otherwise attach such a file to exfiltrate plaintext, encryption keys, or stored pastes before they are encrypted or sent.

  **Note 1:** as the malicious filename must contain the `>` character, the victim must not be using Windows for this to work, since this OS simply forbids this character in filenames.

  **Note 2:** most PrivateBin instances use the Content-Security-Policy header to prevent most use-cases of this vulnerability. This report will describe the impact as if this header had been disabled by the PrivateBin instance owner.

  ## Affected versions

  PrivateBin versions since 1.7.7 and before 2.0.3.

  ## Conditions

  * Only macIOS or Linux users are affected, due to the way the `>` character is treated in a file name on Windows.
  * The PrivateBIn instance needs to have file upload enabled.
  * An attacker needs to have access to the local file system or somehow convince the user to create (or download) a malicious file (name).
  * An attacker needs to convince the user to attach that malicious file to PrivateBin.

  ## Impact

  Any Mac / Linux user who can be tricked into dragging a maliciously named file into the editor is impacted; code runs in the origin of the PrivateBin instance they are using. Attackers can steal plaintext, passphrases, or manipulate the UI before data is encrypted, defeating the zero-knowledge guarantees for that victim session, assuming counter-measures like Content-Security-Policy (CSP) have been disabled.

  If CSP is not disabled, similar HTML injection attacks as described in CVE-2025-62796 may be possible - like redirecting to a foreign website, phishing etc.

  ### Real-life impact

  As the whole exploit needs to be included in the file name of the attached file and only affects the local session of the user (aka it is neither persistent nor remotely executable) _and_ that user needs to interact and actively attach that file to the paste, the impact is considered to be practically low.

  ## Technical Description

  When a file is dropped, `readFileData` collects all filenames and calls `printDragAndDropFileNames`:

  ```js
  const fileNames = loadedFiles.map((loadedFile => loadedFile.name));
  printDragAndDropFileNames(fileNames);
  ```

  `printDragAndDropFileNames` then renders those names:

  ```js
          function printDragAndDropFileNames(fileNames) {
              $dragAndDropFileNames.html(fileNames.join('<br>'));
          }
  ```

  This will insecurely render the user-submitted filenames as HTML.

  This vulnerability has been introduced in [this commit](https://github.com/PrivateBin/PrivateBin/commit/095a5be0b6390a6e47b97d3668a23f6edec95c15) (introduced in 1.7.7).

  The previous render method was using `.text()`:

  ```js
  $dragAndDropFileName.text(loadedFile.name);
  ```

  ## Reproduction Steps

  1. On a Unix-like system, create a file with an HTML/JS payload in its name, e.g. by running `touch '"><img src=x onerror=alert(document.domain)>.txt'`.
  2. Deploy or use any PrivateBin instance with attachments enabled (including https://privatebin.net/).
  3. Open the UI in a browser and start a new paste.
  4. Drag the crafted file anywhere on the page
  5. As soon as it is dropped, the filename is inserted into `#dragAndDropFileName` as HTML and the onerror handler fires (assuming CSP is disabled), showing the alert.

  ## Mitigation

  PrivateBin strongly recommends users to **upgrade to the latest release**. However, here are some workarounds that may help users to mitigate this vulnerability without upgrade:

  * Update the [CSP in your configuration file](https://github.com/PrivateBin/PrivateBin/wiki/Configuration#cspheader) to the latest recommended settings and check that it isn't getting reverted or overwritten by the web server, reverse proxy or CDN, i.e. using [PrivateBin's offered check service](https://privatebin.info/directory/check).
     **Note:** Users should check the CSP independently, even if they've upgrade to a fixed version.
  * Deploying PrivateBin on a separate domain may limit the scope of the vulnerability to PrivateBin itself and thus, as described in the “Impact” section, effectively prevent any damage by the vulnerability to other resources users are hosting.
  * As explained in the impact assessment, disabling attachments also prevents this issue.

  ### Patches

  The issue has been patched in version 2.0.3.

  ## Credits

  PrivateBin would like to thank [Benoit Esnard](https://github.com/esnard), who reported this vulnerability.

  In general, PrivateBin would like to thank everyone reporting issues and potential vulnerabilities.

  If a user thinks they have found a vulnerability or potential security risk, [PrivateBin would kindly ask you to follow our security policy](https://github.com/PrivateBin/PrivateBin/blob/master/SECURITY.md) and report it. PrivateBin will then assess the report and will take the necessary actions to address it.

  ## Timeline

  - 2025-11-09 Received report via GitHub Security Advisory
  - 2025-11-10 Discussed and reproduced issue, created a patch
  - 2025-11-11 Further work on patch
  - 2025-11-12 Released patch with PrivateBin 2.0.3
impacted_packages:
  - purl: pkg:composer/privatebin/privatebin
    affected_versions: vers:composer/>=1.7.7|<2.0.3
    fixed_versions: vers:composer/2.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-r9x7-7ggj-fx9f/GHSA-r9x7-7ggj-fx9f.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/PrivateBin/PrivateBin
    reference_type:
    reference_id:
  - url: https://github.com/PrivateBin/PrivateBin/commit/f9550e513381208b36595ee2404e968144bba78b
    reference_type:
    reference_id:
  - url: https://github.com/PrivateBin/PrivateBin/security/advisories/GHSA-r9x7-7ggj-fx9f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64711
    reference_type:
    reference_id:
