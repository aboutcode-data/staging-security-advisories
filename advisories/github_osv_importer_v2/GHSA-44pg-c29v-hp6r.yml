advisory_id: GHSA-44pg-c29v-hp6r
datasource_id: github_osv_importer_v2/GHSA-44pg-c29v-hp6r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-44pg-c29v-hp6r/GHSA-44pg-c29v-hp6r.json
aliases: []
summary: |
  Laravel Guard bypass in Eloquent models
  In laravel releases before 6.18.34 and 7.23.2. It was possible to mass assign Eloquent attributes that included the model's table name:
  ```
  $model->fill(['users.name' => 'Taylor']);
  ```
  When doing so, Eloquent would remove the table name from the attribute for you. This was a "convenience" feature of Eloquent and was not documented.

  However, when paired with validation, this can lead to unexpected and unvalidated values being saved to the database. For this reason, we have removed the automatic stripping of table names from mass-asignment operations so that the attributes go through the typical "fillable" / "guarded" logic. Any attributes containing table names that are not explicitly declared as fillable will be discarded.

  This security release will be a breaking change for applications that were relying on the undocumented table name stripping during mass assignment. Since this feature was relatively unknown and undocumented, we expect the vast majority of Laravel applications to be able to upgrade without issues.
impacted_packages:
  - purl: pkg:composer/laravel/framework
    affected_versions: vers:composer/>=5.5.0|<=5.5.49
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/laravel/framework
    affected_versions: vers:composer/>=6.0.0|<6.18.34
    fixed_versions: vers:composer/6.18.34
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/laravel/framework
    affected_versions: vers:composer/>=7.0.0|<7.23.2
    fixed_versions: vers:composer/7.23.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://blog.laravel.com/security-release-laravel-61834-7232
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/laravel/framework/2020-08-06-1.yaml
    reference_type:
    reference_id:
  - url: https://github.com/laravel/framework
    reference_type:
    reference_id:
