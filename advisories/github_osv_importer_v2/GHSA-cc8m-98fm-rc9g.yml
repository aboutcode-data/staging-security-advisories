advisory_id: GHSA-cc8m-98fm-rc9g
datasource_id: github_osv_importer_v2/GHSA-cc8m-98fm-rc9g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-cc8m-98fm-rc9g/GHSA-cc8m-98fm-rc9g.json
aliases:
  - CVE-2026-23742
summary: "Skipper is vulnerable to arbitrary code execution through lua filters\n### Impact\n\
  \nArbitrary code execution through [lua filters](https://opensource.zalando.com/skipper/reference/scripts/).\n\
  \nThe default skipper configuration before v0.23 was `-lua-sources=inline,file`. \nThe problem\
  \ starts if untrusted users can create lua filters, because of `-lua-sources=inline` , for\
  \ example through a Kubernetes Ingress resource. The configuration `inline` allows these user\
  \ to create a script that is able to read the filesystem accessible to the skipper process\
  \ and if the user has access to read the logs they an read skipper secrets.\n\nKubernetes\
  \ example (vulnerability is not limited to Kubernetes)\n```lua\nfunction request(ctx, params)\n\
  \  local file = io.open('/var/run/secrets/kubernetes.io/serviceaccount/token', 'r')\n  if\
  \ file then\n    local token = file:read('*all')\n    file:close()\n    error('[EXFIL] ' ..\
  \ token)  -- Exfiltrate via error logs\n  end\nend\n```\n\n### Patches\n\nhttps://github.com/zalando/skipper/releases/tag/v0.23.0\
  \ disables Lua by default.\n\n### Workarounds\n\nYou can reduce support of how you can pass\
  \ lua filter script data by providing config for lua sources https://opensource.zalando.com/skipper/reference/scripts/#enable-and-disable-lua-sources.\
  \ For example `-lua-sources=file` will only be exploitable if the attacker can create a lua\
  \ script file on the target system. \n\n### References\n\nhttps://opensource.zalando.com/skipper/reference/scripts/#enable-and-disable-lua-sources"
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-cc8m-98fm-rc9g/GHSA-cc8m-98fm-rc9g.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-522
  - CWE-250
  - CWE-94
references:
  - url: https://github.com/zalando/skipper
    reference_type:
    reference_id:
  - url: https://github.com/zalando/skipper/commit/0b52894570773b29e2f3c571b94b4211ef8fa714
    reference_type:
    reference_id:
  - url: https://github.com/zalando/skipper/releases/tag/v0.23.0
    reference_type:
    reference_id:
  - url: https://github.com/zalando/skipper/security/advisories/GHSA-cc8m-98fm-rc9g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23742
    reference_type:
    reference_id:
