advisory_id: GHSA-p3f3-5ccg-83xq
datasource_id: github_osv_importer_v2/GHSA-p3f3-5ccg-83xq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-p3f3-5ccg-83xq/GHSA-p3f3-5ccg-83xq.json
aliases:
  - CVE-2024-40637
summary: |
  dbt has an implicit override for built-in materializations from installed packages
  ### Impact
  _What kind of vulnerability is it? Who is impacted?_

  When a user installs a [package](https://docs.getdbt.com/docs/build/packages) in dbt, it has the ability to override macros, materializations, and other core components of dbt. This is by design, as it allows packages to extend and customize dbt's functionality. However, this also means that a malicious package could potentially override these components with harmful code.

  ### Patches
  _Has the problem been patched? What versions should users upgrade to?_

  Fixed on 1.8.0, and patched for 1.6.14 and 1.7.14 releases.

  ### Workarounds
  _Is there a way for users to fix or remediate the vulnerability without upgrading?_

  Previously, a materialization defined in a package that shared a name with one of the built-in materializations would be preferred by default, without user action which is surprising and makes it more difficult to detect the insecure behaviour. We've changed the default behaviour to require explicit overrides by users in `1.8.0`, and provided the ability to opt-out of built-in materialization overrides in 1.6 and 1.7 via the `flags.require_explicit_package_overrides_for_builtin_materializations: False` configuration in `dbt_project.yml`

  Versions older than 1.6 are EOL.

  ### References
  _Are there any links users can visit to find out more?_
  * dbt documentation: https://docs.getdbt.com/reference/global-configs/legacy-behaviors#behavior-change-flags
  * https://www.elementary-data.com/post/are-dbt-packages-secure-the-answer-lies-in-your-dwh-policies
  * https://www.equalexperts.com/blog/tech-focus/are-you-at-risk-from-this-critical-dbt-vulnerability/
  * https://tempered.works/posts/2024/07/06/preventing-data-theft-with-gcp-service-controls/
impacted_packages:
  - purl: pkg:pypi/dbt-core
    affected_versions: vers:pypi/>=1.6.0|<1.6.14
    fixed_versions: vers:pypi/1.6.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/dbt-core
    affected_versions: vers:pypi/>=1.7.0|<1.7.14
    fixed_versions: vers:pypi/1.7.14
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-p3f3-5ccg-83xq/GHSA-p3f3-5ccg-83xq.json
  - score: '2.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-p3f3-5ccg-83xq/GHSA-p3f3-5ccg-83xq.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
  - CWE-913
  - CWE-74
references:
  - url: https://docs.getdbt.com/docs/build/packages
    reference_type:
    reference_id:
  - url: https://docs.getdbt.com/reference/global-configs/legacy-behaviors#behavior-change-flags
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core/commit/3c82a0296d227cb1be295356df314c11716f4ff6
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core/commit/87ac4deb00cc9fe334706e42a365903a1d581624
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core/security/advisories/GHSA-p3f3-5ccg-83xq
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/dbt-core/PYSEC-2024-66.yaml
    reference_type:
    reference_id:
  - url: https://tempered.works/posts/2024/07/06/preventing-data-theft-with-gcp-service-controls
    reference_type:
    reference_id:
  - url: https://www.elementary-data.com/post/are-dbt-packages-secure-the-answer-lies-in-your-dwh-policies
    reference_type:
    reference_id:
  - url: https://www.equalexperts.com/blog/tech-focus/are-you-at-risk-from-this-critical-dbt-vulnerability
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-40637
    reference_type:
    reference_id: CVE-2024-40637
