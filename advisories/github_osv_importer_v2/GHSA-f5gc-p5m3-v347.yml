advisory_id: GHSA-f5gc-p5m3-v347
datasource_id: github_osv_importer_v2/GHSA-f5gc-p5m3-v347
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/12/GHSA-f5gc-p5m3-v347/GHSA-f5gc-p5m3-v347.json
aliases:
  - CVE-2020-29128
summary: |
  XXE in petl
  ### Impact
  Information Disclosure

  ### Summary

  [petl](https://github.com/petl-developers/petl) is a Python library that provides functions for extraction, transformation, and loading (ETL) of data.

  petl before 1.68, in some configurations, allows resolution of entities in XML input.

  An attacker who is able to submit XML input to an application using petl can disclose arbitrary files on the file system in the context of the user under which the application is running.

  ### Affected Applications

  Applications that:

  - accept attacker-supplied XML input that is processed using petl < 1.68
  - return the response generated by petl back to the attacker
  - configure lxml as the underlying XML processing library used by petl
  - have read privileges in filesystem files with sensitive information

  ### Mitigation
  Update to petl >= 1.68

  ### Workarounds

  - Assure there is no user/external access to the application using [petl](https://github.com/petl-developers/petl)
  - Assure your application is not using the function [fromxml()](https://petl.readthedocs.io/en/stable/io.html#petl.io.xml.fromxml)

  ### References
  - https://github.com/nvn1729/advisories/blob/master/cve-2020-29128.md
  - https://github.com/petl-developers/petl/pull/527
  - https://github.com/petl-developers/petl/releases/tag/v1.6.8
  - https://petl.readthedocs.io/en/stable/changes.html
  - https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing

  ### For more information
  If you have any questions or comments about this advisory:
  * Add a comment in the Github [issue](https://github.com/petl-developers/petl/pull/527)

  Thaks to Naveen Sunkavally.
impacted_packages:
  - purl: pkg:pypi/petl
    affected_versions: vers:pypi/<1.6.8
    fixed_versions: vers:pypi/1.6.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/12/GHSA-f5gc-p5m3-v347/GHSA-f5gc-p5m3-v347.json
  - score: '8.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/12/GHSA-f5gc-p5m3-v347/GHSA-f5gc-p5m3-v347.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://github.com/nvn1729/advisories/blob/master/cve-2020-29128.md
    reference_type:
    reference_id:
  - url: https://github.com/petl-developers/petl
    reference_type:
    reference_id:
  - url: https://github.com/petl-developers/petl/commit/07420ef8463cc387aea84e2d6241cf556574e2a5
    reference_type:
    reference_id:
  - url: https://github.com/petl-developers/petl/compare/v1.6.7...v1.6.8
    reference_type:
    reference_id:
  - url: https://github.com/petl-developers/petl/issues/526
    reference_type:
    reference_id:
  - url: https://github.com/petl-developers/petl/pull/527
    reference_type:
    reference_id:
  - url: https://github.com/petl-developers/petl/releases/tag/v1.6.8
    reference_type:
    reference_id:
  - url: https://github.com/petl-developers/petl/security/advisories/GHSA-f5gc-p5m3-v347
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/petl/PYSEC-2020-75.yaml
    reference_type:
    reference_id:
  - url: https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing
    reference_type:
    reference_id:
  - url: https://petl.readthedocs.io/en/stable/changes.html
    reference_type:
    reference_id:
