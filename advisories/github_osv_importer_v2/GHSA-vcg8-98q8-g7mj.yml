advisory_id: GHSA-vcg8-98q8-g7mj
datasource_id: github_osv_importer_v2/GHSA-vcg8-98q8-g7mj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-vcg8-98q8-g7mj/GHSA-vcg8-98q8-g7mj.json
aliases:
  - CVE-2020-1740
summary: |
  Exposure of Sensitive Information to an Unauthorized Actor and Insecure Temporary File in Ansible
  A flaw was found in Ansible Engine when using Ansible Vault for editing encrypted files. When a user executes "ansible-vault edit", another user on the same computer can read the old and new secret, as it is created in a temporary file with mkstemp and the returned file descriptor is closed and the method write_data is called to write the existing secret in the file. This method will delete the file before recreating it insecurely. All versions in 2.7.x, 2.8.x and 2.9.x branches are believed to be vulnerable.
impacted_packages:
  - purl: pkg:pypi/ansible
    affected_versions: vers:pypi/<2.7.17
    fixed_versions: vers:pypi/2.7.17
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/ansible
    affected_versions: vers:pypi/>=2.8.0a1|<2.8.11
    fixed_versions: vers:pypi/2.8.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/ansible
    affected_versions: vers:pypi/>=2.9.0a1|<2.9.7
    fixed_versions: vers:pypi/2.9.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-vcg8-98q8-g7mj/GHSA-vcg8-98q8-g7mj.json
  - score: '5.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-vcg8-98q8-g7mj/GHSA-vcg8-98q8-g7mj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-377
  - CWE-200
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-1740
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-vcg8-98q8-g7mj
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/28f9fbdb5e281976e33f443193047068afb97a9b
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/2a563514f070a0a8ba64aebf6bce21194be96c73
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/685a4b6d3ff72186d2b4ffce73172a5446a71ccc
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/ef32a5bf96a89107986375516285253c1380d7ef
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/issues/67798
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2020-12.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2020/05/msg00005.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DKPA4KC3OJSUFASUYMG66HKJE7ADNGFW
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MRRYUU5ZBLPBXCYG6CFP35D64NP2UB2S
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WQVOQD4VAIXXTVQAJKTN7NUGTJFE2PCB
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202006-11
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-1740
    reference_type:
    reference_id: CVE-2020-1740
