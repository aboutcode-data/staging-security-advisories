advisory_id: GHSA-fwcm-636p-68r5
datasource_id: github_osv_importer_v2/GHSA-fwcm-636p-68r5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/02/GHSA-fwcm-636p-68r5/GHSA-fwcm-636p-68r5.json
aliases:
  - CVE-2021-21288
summary: |
  Server-side request forgery in CarrierWave
  ### Impact
  [CarrierWave download feature](https://github.com/carrierwaveuploader/carrierwave#uploading-files-from-a-remote-location) has an SSRF vulnerability, allowing attacks to provide DNS entries or IP addresses that are intended for internal use and gather information about the Intranet infrastructure of the platform.

  ### Patches
  Upgrade to [2.1.1](https://rubygems.org/gems/carrierwave/versions/2.1.1) or [1.3.2](https://rubygems.org/gems/carrierwave/versions/1.3.2).

  ### Workarounds
  Using proper network segmentation and applying the principle of least privilege to outbound connections from application servers can reduce the severity of SSRF vulnerabilities. Ideally the vulnerable gem should run on an isolated server without access to any internal network resources or cloud metadata access.

  ### References
  [Server-Side Request Forgery Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html)

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [CarrierWave repo](https://github.com/carrierwaveuploader/carrierwave)
  * Email me at [mit.shibuya@gmail.com](mailto:mit.shibuya@gmail.com)
impacted_packages:
  - purl: pkg:gem/carrierwave
    affected_versions: vers:gem/<1.3.2
    fixed_versions: vers:gem/1.3.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/carrierwave
    affected_versions: vers:gem/>=2.0.0|<2.1.1
    fixed_versions: vers:gem/2.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/02/GHSA-fwcm-636p-68r5/GHSA-fwcm-636p-68r5.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/carrierwaveuploader/carrierwave
    reference_type:
    reference_id:
  - url: https://github.com/carrierwaveuploader/carrierwave/blob/master/CHANGELOG.md#132---2021-02-08
    reference_type:
    reference_id:
  - url: https://github.com/carrierwaveuploader/carrierwave/blob/master/CHANGELOG.md#211---2021-02-08
    reference_type:
    reference_id:
  - url: https://github.com/carrierwaveuploader/carrierwave/commit/012702eb3ba1663452aa025831caa304d1a665c0
    reference_type:
    reference_id:
  - url: https://github.com/carrierwaveuploader/carrierwave/security/advisories/GHSA-fwcm-636p-68r5
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/carrierwave/CVE-2021-21288.yml
    reference_type:
    reference_id:
  - url: https://rubygems.org/gems/carrierwave
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21288
    reference_type:
    reference_id: CVE-2021-21288
