advisory_id: GHSA-ww4x-rwq6-qpgf
datasource_id: github_osv_importer_v2/GHSA-ww4x-rwq6-qpgf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/05/GHSA-ww4x-rwq6-qpgf/GHSA-ww4x-rwq6-qpgf.json
aliases:
  - CVE-2015-9284
summary: |
  OmniAuth Ruby gem Cross-site Request Forgery in request phase
  The request phase of the OmniAuth Ruby gem (1.9.2 and earlier) is vulnerable to Cross-Site Request Forgery when used as part of the Ruby on Rails framework, allowing accounts to be connected without user intent, user interaction, or feedback to the user. This permits a secondary account to be able to sign into the web application as the primary account.

  As of v2 OmniAuth no longer has the vulnerable configuration by default, but it is still possible to configure OmniAuth in such a way that the web application becomes vulnerable to Cross-Site Request Forgery. There is a recommended remediation described [here](https://github.com/omniauth/omniauth/wiki/Resolving-CVE-2015-9284).
impacted_packages:
  - purl: pkg:gem/omniauth
    affected_versions: vers:gem/<=1.9.2
    fixed_versions: vers:gem/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/05/GHSA-ww4x-rwq6-qpgf/GHSA-ww4x-rwq6-qpgf.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://github.com/omniauth/omniauth
    reference_type:
    reference_id:
  - url: https://github.com/omniauth/omniauth/issues/1031
    reference_type:
    reference_id:
  - url: https://github.com/omniauth/omniauth/pull/809
    reference_type:
    reference_id:
  - url: https://github.com/omniauth/omniauth-rails/pull/1
    reference_type:
    reference_id:
  - url: https://github.com/omniauth/omniauth/releases/tag/v1.9.2
    reference_type:
    reference_id:
  - url: https://github.com/omniauth/omniauth/releases/tag/v2.0.0
    reference_type:
    reference_id:
  - url: https://github.com/omniauth/omniauth/wiki/Resolving-CVE-2015-9284
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/omniauth/CVE-2015-9284.yml
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/commit/aef9f623c0be838234d53baf18977564804da397
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2015/05/26/11
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2015-9284
    reference_type:
    reference_id: CVE-2015-9284
