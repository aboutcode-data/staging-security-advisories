advisory_id: GHSA-9rr6-jpg7-9jg6
datasource_id: github_osv_importer_v2/GHSA-9rr6-jpg7-9jg6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-9rr6-jpg7-9jg6/GHSA-9rr6-jpg7-9jg6.json
aliases:
  - CVE-2021-38296
summary: |
  Authentication Bypass by Capture-replay in Apache Spark
  Apache Spark supports end-to-end encryption of RPC connections via "spark.authenticate" and "spark.network.crypto.enabled". In versions 3.1.2 and earlier, it uses a bespoke mutual authentication protocol that allows for full encryption key recovery. After an initial interactive attack, this would allow someone to decrypt plaintext traffic offline. Note that this does not affect security mechanisms controlled by "spark.authenticate.enableSaslEncryption", "spark.io.encryption.enabled", "spark.ssl", "spark.ui.strictTransportSecurity". Update to Apache Spark 3.1.3 or later
impacted_packages:
  - purl: pkg:maven/org.apache.spark/spark-core
    affected_versions: vers:maven/<3.1.3
    fixed_versions: vers:maven/3.1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/pyspark
    affected_versions: vers:pypi/<3.1.3
    fixed_versions: vers:pypi/3.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-9rr6-jpg7-9jg6/GHSA-9rr6-jpg7-9jg6.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-9rr6-jpg7-9jg6/GHSA-9rr6-jpg7-9jg6.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-294
references:
  - url: https://github.com/advisories/GHSA-9rr6-jpg7-9jg6
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pyspark/PYSEC-2022-186.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/70x8fw2gx3g9ty7yk0f2f1dlpqml2smd
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpujul2022.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-38296
    reference_type:
    reference_id: CVE-2021-38296
