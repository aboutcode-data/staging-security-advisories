advisory_id: GHSA-hw5f-6wvv-xcrh
datasource_id: github_osv_importer_v2/GHSA-hw5f-6wvv-xcrh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-hw5f-6wvv-xcrh/GHSA-hw5f-6wvv-xcrh.json
aliases:
  - CVE-2024-37897
summary: |
  SFTPGo has insufficient access control for password reset
  ### Impact

  SFTPGo WebAdmin and WebClient support password reset. This feature is disabled in the default configuration.
  In SFTPGo versions prior to v2.6.1, if the feature is enabled, even users with access restrictions (e.g. expired) can reset their password and log in.

  ### Patches

  Fixed in v2.6.1.

  ### Workarounds

  The following workarounds are available:

  - keep the password reset feature disabled.
  - Set a blank email address for users and admins with access restrictions so they cannot receive the email with the reset code and exploit the vulnerability.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-hw5f-6wvv-xcrh/GHSA-hw5f-6wvv-xcrh.json
  - score: '6.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-hw5f-6wvv-xcrh/GHSA-hw5f-6wvv-xcrh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
  - CWE-287
references:
  - url: https://github.com/drakkan/sftpgo
    reference_type:
    reference_id:
  - url: https://github.com/drakkan/sftpgo/commit/1f8ac8bfe16100b0484d6c91e1e8361687324423
    reference_type:
    reference_id:
  - url: https://github.com/drakkan/sftpgo/commit/3462bba3f41cbc75486474991b9e3ac1b5f1e583
    reference_type:
    reference_id:
  - url: https://github.com/drakkan/sftpgo/releases/tag/v2.6.1
    reference_type:
    reference_id:
  - url: https://github.com/drakkan/sftpgo/security/advisories/GHSA-hw5f-6wvv-xcrh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37897
    reference_type:
    reference_id: CVE-2024-37897
