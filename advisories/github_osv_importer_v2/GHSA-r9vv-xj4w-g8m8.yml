advisory_id: GHSA-r9vv-xj4w-g8m8
datasource_id: github_osv_importer_v2/GHSA-r9vv-xj4w-g8m8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-r9vv-xj4w-g8m8/GHSA-r9vv-xj4w-g8m8.json
aliases:
  - CVE-2016-4978
summary: |
  Apache ActiveMQ Artemis RCE Via Deserialization Gadget Chain
  The getObject method of the `javax.jms.ObjectMessage` class in the (1) JMS Core client, (2) Artemis broker, and (3) Artemis REST component in Apache ActiveMQ Artemis before 1.4.0 might allow remote authenticated users with permission to send messages to the Artemis broker to deserialize arbitrary objects and execute arbitrary code by leveraging gadget classes being present on the Artemis classpath.
impacted_packages:
  - purl: pkg:maven/org.apache.activemq/artemis-pom
    affected_versions: vers:maven/<1.4.0
    fixed_versions: vers:maven/1.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-r9vv-xj4w-g8m8/GHSA-r9vv-xj4w-g8m8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: http://mail-archives.apache.org/mod_mbox/activemq-users/201609.mbox/%3CCAH6wpnqzeNtpykT7emtDU1-GV7AvjFP5-YroWcCC4UZyQEFvtA%40mail.gmail.com%3E
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:1447
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:1448
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:1449
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:1450
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:1451
    reference_type:
    reference_id:
  - url: https://github.com/apache/activemq-artemis
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/7260bd0955c12aac5bd892039d3356ba3aa0ff4caaf2aa4fd4fe84a2@%3Cissues.activemq.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/7260bd0955c12aac5bd892039d3356ba3aa0ff4caaf2aa4fd4fe84a2%40%3Cissues.activemq.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/d4ffbc6a43a915324a394b2913ceb7d07bc352f2d08caa19df0aff02@%3Cissues.activemq.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/d4ffbc6a43a915324a394b2913ceb7d07bc352f2d08caa19df0aff02%40%3Cissues.activemq.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/rb2fd3bf2dce042e0ab3f3c94c4767c96bb2e7e6737624d63162df36d@%3Ccommits.activemq.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/rb2fd3bf2dce042e0ab3f3c94c4767c96bb2e7e6737624d63162df36d%40%3Ccommits.activemq.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/rc96ad63f148f784c84ea7f0a178c84a8985c6afccabbcd9847a82088@%3Ccommits.activemq.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/rc96ad63f148f784c84ea7f0a178c84a8985c6afccabbcd9847a82088%40%3Ccommits.activemq.apache.org%3E
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20210123172653/http://www.securityfocus.com/bid/93142
    reference_type:
    reference_id:
  - url: https://www.blackhat.com/docs/us-16/materials/us-16-Kaiser-Pwning-Your-Java-Messaging-With-Deserialization-Vulnerabilities.pdf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2016-4978
    reference_type:
    reference_id: CVE-2016-4978
  - url: https://access.redhat.com/errata/RHSA-2017:1834
    reference_type:
    reference_id: RHSA-2017:1834
  - url: https://access.redhat.com/errata/RHSA-2017:1835
    reference_type:
    reference_id: RHSA-2017:1835
  - url: https://access.redhat.com/errata/RHSA-2017:1836
    reference_type:
    reference_id: RHSA-2017:1836
  - url: https://access.redhat.com/errata/RHSA-2017:1837
    reference_type:
    reference_id: RHSA-2017:1837
  - url: https://access.redhat.com/errata/RHSA-2017:3454
    reference_type:
    reference_id: RHSA-2017:3454
  - url: https://access.redhat.com/errata/RHSA-2017:3455
    reference_type:
    reference_id: RHSA-2017:3455
  - url: https://access.redhat.com/errata/RHSA-2017:3456
    reference_type:
    reference_id: RHSA-2017:3456
  - url: https://access.redhat.com/errata/RHSA-2017:3458
    reference_type:
    reference_id: RHSA-2017:3458
