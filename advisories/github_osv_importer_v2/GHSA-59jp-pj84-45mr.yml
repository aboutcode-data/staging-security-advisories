advisory_id: GHSA-59jp-pj84-45mr
datasource_id: github_osv_importer_v2/GHSA-59jp-pj84-45mr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-59jp-pj84-45mr/GHSA-59jp-pj84-45mr.json
aliases:
  - CVE-2026-22772
summary: "Fulcio is vulnerable to Server-Side Request Forgery (SSRF) via MetaIssuer Regex Bypass\n\
  # Security Disclosure: SSRF via MetaIssuer Regex Bypass\n\n## Summary\n\nFulcio's `metaRegex()`\
  \ function uses unanchored regex, allowing attackers to bypass MetaIssuer URL validation and\
  \ trigger SSRF to arbitrary internal services.\n\nSince the SSRF only can trigger GET requests,\
  \ the request cannot mutate state. The response from the GET request is not returned to the\
  \ caller so data exfiltration is not possible. A malicious actor could attempt to probe an\
  \ internal network through [Blind SSRF](https://portswigger.net/web-security/ssrf/blind).\n\
  \n## Impact\n\n- SSRF to cloud metadata (169.254.169.254)\n- SSRF to internal Kubernetes APIs\n\
  - SSRF to any service accessible from Fulcio's network\n- Affects ALL deployments using MetaIssuers\n\
  \n## Patches\n\nUpgrade to v1.8.5.\n\n## Workarounds\n\nNone. If anchors are included in the\
  \ meta issuer configuration URL, they will be escaped before the regular expression is compiled,\
  \ not making this a sufficient mitigation. Deployments must upgrade to the latest Fulcio release\
  \ v1.8.5.\n\n## Affected Code\n\n**File**: `pkg/config/config.go`  \n**Function**: `metaRegex()`\
  \ (lines 143-156)\n\n```go\nfunc metaRegex(issuer string) (*regexp.Regexp, error) {\n    quoted\
  \ := regexp.QuoteMeta(issuer)\n    replaced := strings.ReplaceAll(quoted, regexp.QuoteMeta(\"\
  *\"), \"[-_a-zA-Z0-9]+\")\n    return regexp.Compile(replaced)  // Missing ^ and $ anchors\n\
  }\n```\n\n## The Bug\n\nThe regex has no `^` (start) or `$` (end) anchors. Go's `regexp.MatchString()`\
  \ does substring matching, so:\n\n```\nPattern:  https://oidc.eks.*.amazonaws.com/id/*\nRegex:\
  \    https://oidc\\.eks\\.[-_a-zA-Z0-9]+\\.amazonaws\\.com/id/[-_a-zA-Z0-9]+\n\nInput:   \
  \ https://attacker.com/x/https://oidc.eks.foo.amazonaws.com/id/bar\nResult:   MATCHES (substring\
  \ found)\n```\n\n## Exploit\n\n1. Attacker sends JWT with `iss` claim: `https://attacker.com/path/https://oidc.eks.x.amazonaws.com/id/y`\n\
  2. Fulcio's `GetIssuer()` matches this against MetaIssuer patterns\n3. Unanchored regex matches\
  \ the embedded pattern as substring\n4. Fulcio calls `oidc.NewProvider()` with attacker's\
  \ URL\n5. HTTP request goes to `attacker.com`, not `amazonaws.com`\n6. Attacker returns OIDC\
  \ discovery with `jwks_uri` pointing to internal service\n7. Fulcio fetches from internal\
  \ service â†’ SSRF"
impacted_packages: []
severities:
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-59jp-pj84-45mr/GHSA-59jp-pj84-45mr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/sigstore/fulcio
    reference_type:
    reference_id:
  - url: https://github.com/sigstore/fulcio/commit/eaae2f2be56df9dea5f9b439ec81bedae4c0978d
    reference_type:
    reference_id:
  - url: https://github.com/sigstore/fulcio/security/advisories/GHSA-59jp-pj84-45mr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22772
    reference_type:
    reference_id:
