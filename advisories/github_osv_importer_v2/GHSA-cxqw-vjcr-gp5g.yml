advisory_id: GHSA-cxqw-vjcr-gp5g
datasource_id: github_osv_importer_v2/GHSA-cxqw-vjcr-gp5g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-cxqw-vjcr-gp5g/GHSA-cxqw-vjcr-gp5g.json
aliases:
  - CVE-2021-21607
summary: |
  Excessive memory allocation in graph URLs leads to denial of service in Jenkins
  Jenkins renders several different graphs for features like agent and label usage statistics, memory usage, or various plugin-provided statistics.

  Jenkins 2.274 and earlier, LTS 2.263.1 and earlier does not limit the graph size provided as query parameters.

  This allows attackers to request or to have legitimate Jenkins users request crafted URLs that rapidly use all available memory in Jenkins, potentially leading to out of memory errors.

  Jenkins 2.275, LTS 2.263.2 limits the maximum size of graphs to an area of 10 million pixels. If a larger size is requested, the default size for the graph will be rendered instead.

  This threshold can be configured by setting the [Java system property](https://www.jenkins.io/doc/book/managing/system-properties/) `hudson.util.Graph.maxArea` to a different number on startup.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.main/jenkins-core
    affected_versions: vers:maven/<=2.263.1
    fixed_versions: vers:maven/2.263.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.main/jenkins-core
    affected_versions: vers:maven/<=2.274
    fixed_versions: vers:maven/2.275
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-cxqw-vjcr-gp5g/GHSA-cxqw-vjcr-gp5g.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
references:
  - url: https://github.com/jenkinsci/jenkins
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/jenkins/commit/a890d68699ad6ca0c8fbc297a1d4b7ebf23f384b
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2021-01-13/#SECURITY-2025
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21607
    reference_type:
    reference_id: CVE-2021-21607
