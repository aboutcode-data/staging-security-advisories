advisory_id: GHSA-7954-6m9q-gpvf
datasource_id: github_osv_importer_v2/GHSA-7954-6m9q-gpvf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-7954-6m9q-gpvf/GHSA-7954-6m9q-gpvf.json
aliases:
  - CVE-2023-37914
summary: |
  XWiki Platform privilege escalation (PR)/RCE from account through Invitation subject/message
  ### Impact
  Any user who can view `Invitation.WebHome` can execute arbitrary script macros including Groovy and Python macros that allow remote code execution including unrestricted read and write access to all wiki contents. This can be reproduced with the following steps:


  1.    Open the invitation application (Invitation.WebHome).
  1.    Set the subject to `{{cache}}{{groovy}}new File("/tmp/exploit.txt").withWriter { out -> out.println("Attacked from invitation!"); }{{/groovy}}{{/cache}}`
  1.    Click "Preview"


  ### Patches
  The vulnerability has been patched on XWiki 14.4.8, 15.2-rc-1, and 14.10.6.

  ### Workarounds
  The vulnerability can be patched manually by applying the [patch](https://github.com/xwiki/xwiki-platform/commit/ff1d8a1790c6ee534c6a4478360a06efeb2d3591) on `Invitation.InvitationCommon` and `Invitation.InvitationConfig`.

  ### References
  - https://jira.xwiki.org/browse/XWIKI-20421
  - https://github.com/xwiki/xwiki-platform/commit/ff1d8a1790c6ee534c6a4478360a06efeb2d3591

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  * Email us at [Security Mailing List](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-invitation-ui
    affected_versions: vers:maven/>=2.5-m-1|<14.4.8
    fixed_versions: vers:maven/14.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-invitation-ui
    affected_versions: vers:maven/>=14.5|<14.10.6
    fixed_versions: vers:maven/14.10.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-invitation-ui
    affected_versions: vers:maven/>=15.0-rc-1|<15.2-rc-1
    fixed_versions: vers:maven/15.2-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-7954-6m9q-gpvf/GHSA-7954-6m9q-gpvf.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-95
  - CWE-94
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/ff1d8a1790c6ee534c6a4478360a06efeb2d3591
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-7954-6m9q-gpvf
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20421
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-37914
    reference_type:
    reference_id: CVE-2023-37914
