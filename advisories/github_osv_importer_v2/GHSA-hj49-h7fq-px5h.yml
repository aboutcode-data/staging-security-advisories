advisory_id: GHSA-hj49-h7fq-px5h
datasource_id: github_osv_importer_v2/GHSA-hj49-h7fq-px5h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-hj49-h7fq-px5h/GHSA-hj49-h7fq-px5h.json
aliases:
  - CVE-2025-24802
summary: |
  Soundness issue with Plonky2 look up tables
  ### Impact
  Lookup tables, whose length is not divisible by `26 = floor(num_routed_wires / 3)` always include the `0 -> 0` input-output pair. Thus a malicious prover can always prove that `f(0) = 0` for any lookup table f (unless its length happens to be divisible by 26).

  The cause of problem is that the `LookupTableGate`-s are [padded with zeros](https://github.com/0xPolygonZero/plonky2/blob/main/plonky2/src/plonk/prover.rs#L97).

  The fix is done by padding with an existing table pair, similarly to `LookupGate`.

  A workaround from the user side is to extend the table (by repeating some entries) so that its length becomes divisible by 26.

  Fortunately, the seemingly most common use case, namely, hash functions with table-based sbox-es, are not vulnerable:

  * both Monolith's and Tip5/Tip4's s-box tables already map 0 to 0;
  * more generally, forcing several (0,0) pairs inside such a hash function appears to be a too strong restriction to find an otherwise valid trace.

  A malicious prover exploiting this could cheat a circuit which statement is the following:
  - output `x + f(x)` for some private input `x`, where `f(x) := 100 - x` is implemented by a lookup table.

  A malicious prover would be able to convince an honest verifier that they know an `0 <= x < 64` such that `x + (100 - x) = 0`.

  ### Patches
  Yes, upgrade to v1.0.1

  ### Workarounds
  No

  ### References
impacted_packages: []
severities:
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-hj49-h7fq-px5h/GHSA-hj49-h7fq-px5h.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1240
references:
  - url: https://github.com/0xPolygonZero/plonky2
    reference_type:
    reference_id:
  - url: https://github.com/0xPolygonZero/plonky2/blob/main/plonky2/src/plonk/prover.rs#L97
    reference_type:
    reference_id:
  - url: https://github.com/0xPolygonZero/plonky2/commit/091047f7f10cae082716f3738ad59a583835f7b6
    reference_type:
    reference_id:
  - url: https://github.com/0xPolygonZero/plonky2/security/advisories/GHSA-hj49-h7fq-px5h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-24802
    reference_type:
    reference_id: CVE-2025-24802
