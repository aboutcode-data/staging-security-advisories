advisory_id: GHSA-4hjq-422q-4vpx
datasource_id: github_osv_importer_v2/GHSA-4hjq-422q-4vpx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-4hjq-422q-4vpx/GHSA-4hjq-422q-4vpx.json
aliases:
  - CVE-2021-27908
summary: |
  Mautic vulnerable to secret data exfiltration via symfony parameters
  ### Impact
  Symfony parameters (which is what Mautic transforms configuration parameters into) can be used within other Symfony parameters by design. However, this also means that an admin who is normally not privy to certain parameters, such as database credentials, could expose them by leveraging any of the free text fields in Mauticâ€™s configuration that are used in publicly facing parts of the application.

  For example,

  1. Go to Configuration page -> Landing Page Settings -> Analytics script and enter this: <`script> console.log("db password is: %mautic.db_password%"); </script>`
  2. Visit any landing page and open the JS dev console. You will see the following message with real instance db password: `db password is: <real password>`

  Risk rating: ModerateCVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:L

  ### Patches
  Upgrade to 3.3.2

  ### Workarounds
  No

  ### References
  No

  ### For more information
  If you have any questions or comments about this advisory:

  * Email us at [security@mautic.org](mailto:security@mautic.org)
impacted_packages:
  - purl: pkg:composer/mautic/core
    affected_versions: vers:composer/<3.3.2
    fixed_versions: vers:composer/3.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-4hjq-422q-4vpx/GHSA-4hjq-422q-4vpx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-732
  - CWE-74
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/mautic/core/CVE-2021-27908.yaml
    reference_type:
    reference_id:
  - url: https://github.com/mautic/mautic
    reference_type:
    reference_id:
  - url: https://github.com/mautic/mautic/security/advisories/GHSA-4hjq-422q-4vpx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-27908
    reference_type:
    reference_id: CVE-2021-27908
