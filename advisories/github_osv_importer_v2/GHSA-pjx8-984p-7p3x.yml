advisory_id: GHSA-pjx8-984p-7p3x
datasource_id: github_osv_importer_v2/GHSA-pjx8-984p-7p3x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-pjx8-984p-7p3x/GHSA-pjx8-984p-7p3x.json
aliases: []
summary: |
  FOSUserBundle Entropy is lost in the TokenGenerator
  ### Description
  Because of the usage of base_convert which looses precision for large inputs, the entropy of tokens generated by FOSUserBundle for the email confirmation and password resetting is lost. This makes these tokens much less random than they are expected to be, and so not cryptographically safe.

  ### Resolution
  The token generation logic used in the 2.0.x branch based on base64 encoding has been backported. This changes the range of characters used in the token. Any route placeholder expected to match a token generated by FOSUserBundle must be updated to allow dashes, which are not allowed by \w in regexes. A \w+ requirement should so become [\w\-]+.
impacted_packages:
  - purl: pkg:composer/friendsofsymfony/user-bundle
    affected_versions: vers:composer/>=1.0.0|<1.3.5
    fixed_versions: vers:composer/1.3.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-331
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/friendsofsymfony/user-bundle/2014-09-04-1.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfSymfony/FOSUserBundle
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfSymfony/FOSUserBundle/commit/b3ebfea52065e9727508f5f8e6c9f7459a1b06d8
    reference_type:
    reference_id:
  - url: https://symfony.com/blog/fosuserbundle-entropy-of-generated-tokens-is-lost
    reference_type:
    reference_id:
