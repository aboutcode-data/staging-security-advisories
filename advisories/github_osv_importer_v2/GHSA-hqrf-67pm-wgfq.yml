advisory_id: GHSA-hqrf-67pm-wgfq
datasource_id: github_osv_importer_v2/GHSA-hqrf-67pm-wgfq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-hqrf-67pm-wgfq/GHSA-hqrf-67pm-wgfq.json
aliases:
  - CVE-2025-59824
summary: |
  Omni Wireguard SideroLink potential escape
  ## Overview

  Omni and each Talos machine establish a peer-to-peer (P2P) SideroLink connection using WireGuard to mutually authenticate and authorize access.

  In this setup, Omni assigns a random IPv6 address to each Talos machine from a `/64` network block. Omni itself uses the fixed `::1` address within that same block.

  From Omni's perspective, this is a WireGuard interface with multiple peers, where each peer corresponds to a Talos machine. The WireGuard interface on Omni is configured to ensure that the **source IP address** of an incoming packet matches the IPv6 address assigned to the Talos peer. However, it **performs no validation on the packet's destination address**.

  The Talos end of the SideroLink connection cannot be considered a trusted environment. Workloads running on Kubernetes, especially those configured with host networking, could gain direct access to this link. Therefore, a malicious workload could theoretically send arbitrary packets over the SideroLink interface.

  ---

  ## Impact

  This vulnerability creates two distinct attack scenarios based on Omni's `IP forwarding` configuration.

  1.  **IP Forwarding Disabled (Default)**
      If `IP forwarding` is disabled, an attacker on a Talos machine can send packets over SideroLink to any listening service on Omni itself (e.g., an internal API). If Omni is running in host networking mode, any service on the host machine could also be targeted. While this is the default configuration, Omni does not enforce it.

  2.  **IP Forwarding Enabled**
      If `IP forwarding` is enabled, an attacker on a Talos machine can communicate with other machines connected to Omni or route packets deeper into Omni's network. Although this is not the default configuration, Omni does not check for or prevent this state.

  ### Patches

  The problem has been fixed in Omni >= [0.48.0](https://github.com/siderolabs/omni/releases/tag/v0.48.0), the commit is https://github.com/siderolabs/omni/commit/a5efd816a239e6c9e5ea7c0d43c02c04504d7b60

  ### Workarounds

  Disable IP forwarding, implement strict firewall rules.

  ### References

  None
impacted_packages: []
severities:
  - score: '0.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:N/PR:H/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-hqrf-67pm-wgfq/GHSA-hqrf-67pm-wgfq.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/siderolabs/omni
    reference_type:
    reference_id:
  - url: https://github.com/siderolabs/omni/commit/a5efd816a239e6c9e5ea7c0d43c02c04504d7b60
    reference_type:
    reference_id:
  - url: https://github.com/siderolabs/omni/security/advisories/GHSA-hqrf-67pm-wgfq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59824
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3979
    reference_type:
    reference_id:
