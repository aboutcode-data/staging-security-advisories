advisory_id: GHSA-6jgw-rgmm-7cv6
datasource_id: github_osv_importer_v2/GHSA-6jgw-rgmm-7cv6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-6jgw-rgmm-7cv6/GHSA-6jgw-rgmm-7cv6.json
aliases:
  - CVE-2024-9979
summary: |
  PyO3 has a risk of use-after-free in `borrowed` reads from Python weak references
  The family of functions to read "borrowed" values from Python weak references were fundamentally unsound, because the weak reference does itself not have ownership of the value. At any point the last strong reference could be cleared and the borrowed value would become dangling.

  In PyO3 0.22.4 these functions have all been deprecated and patched to leak a strong reference as a mitigation. PyO3 0.23 will remove these functions entirely.
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-6jgw-rgmm-7cv6/GHSA-6jgw-rgmm-7cv6.json
  - score: '4.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-6jgw-rgmm-7cv6/GHSA-6jgw-rgmm-7cv6.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-9979
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2318646
    reference_type:
    reference_id:
  - url: https://crates.io/crates/pyo3
    reference_type:
    reference_id:
  - url: https://github.com/PyO3/pyo3
    reference_type:
    reference_id:
  - url: https://github.com/PyO3/pyo3/pull/4590
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2024-0378.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-9979
    reference_type:
    reference_id: CVE-2024-9979
