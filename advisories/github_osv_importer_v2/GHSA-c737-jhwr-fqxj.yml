advisory_id: GHSA-c737-jhwr-fqxj
datasource_id: github_osv_importer_v2/GHSA-c737-jhwr-fqxj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-c737-jhwr-fqxj/GHSA-c737-jhwr-fqxj.json
aliases: []
summary: |
  Duplicate Advisory: Cross Site Scripting in eZ Platform Ibexa Kernel
  ## Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-mrvj-7q4f-5p42. This link is maintained to preserve external references.

  ## Original Description
  ## Impact

  In file upload it is possible by certain means to upload files like .html and .js. These may contain XSS exploits which will be run when links to them are accessed by victims.
  Patches

  ## Patches

  The fix consists simply of adding common types of scriptable file types to the configuration of the already existing filetype blacklist feature. See "Patched versions". As such, this can also be done manually, without installing the patched versions. This may be relevant if you are currently running a considerably older version of the kernel package and don't want to upgrade it at this time. Please see the settting "ezsettings.default.io.file_storage.file_type_blacklist" at:
  https://github.com/ezsystems/ezplatform-kernel/blob/master/eZ/Bundle/EzPublishCoreBundle/Resources/config/default_settings.yml#L109
  Important note

  ## Important note

  You should adapt this setting to your needs. Do not add file types to the blacklist that you actually need to be able to upload. For instance, if you need your editors to be able to upload SVG files, then don't blacklist that. Instead, you could e.g. use an approval workflow for such content.
impacted_packages:
  - purl: pkg:composer/ezsystems/ezpublish-kernel
    affected_versions: vers:composer/>=6.13.0|<6.13.8+2
    fixed_versions: vers:composer/6.13.8+2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/ezsystems/ezpublish-kernel
    affected_versions: vers:composer/>=7.5.0|<7.5.15+2
    fixed_versions: vers:composer/7.5.15+2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/ezsystems/ezplatform-kernel
    affected_versions: vers:composer/>=1.2.0|<1.2.5+1
    fixed_versions: vers:composer/1.2.5+1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/ezsystems/ezplatform-kernel
    affected_versions: vers:composer/>=1.3.0|<1.3.1+1
    fixed_versions: vers:composer/1.3.1+1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-c737-jhwr-fqxj/GHSA-c737-jhwr-fqxj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/ezsystems/ezpublish-kernel
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezpublish-kernel/commit/29fecd2afe86f763510f10c02f14962d028f311b
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezpublish-kernel/security/advisories/GHSA-mrvj-7q4f-5p42
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-46875
    reference_type:
    reference_id: CVE-2021-46875
