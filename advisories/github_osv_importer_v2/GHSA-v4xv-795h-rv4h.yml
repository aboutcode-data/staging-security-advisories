advisory_id: GHSA-v4xv-795h-rv4h
datasource_id: github_osv_importer_v2/GHSA-v4xv-795h-rv4h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-v4xv-795h-rv4h/GHSA-v4xv-795h-rv4h.json
aliases:
  - CVE-2024-23345
summary: |
  XSS potential in rendered Markdown fields (comments, description, notes, etc.)
  ### Impact

  All users of Nautobot versions earlier than 1.6.10 or 2.1.2 are potentially impacted.

  Due to inadequate input sanitization, any user-editable fields that support Markdown rendering, including:

  - `Circuit.comments`
  - `Cluster.comments`
  - `CustomField.description`
  - `Device.comments`
  - `DeviceRedundancyGroup.comments`
  - `DeviceType.comments`
  - `Job.description`
  - `JobLogEntry.message`
  - `Location.comments`
  - `Note.note`
  - `PowerFeed.comments`
  - `Provider.noc_contact`
  - `Provider.admin_contact`
  - `Provider.comments`
  - `ProviderNetwork.comments`
  - `Rack.comments`
  - `Tenant.comments`
  - `VirtualMachine.comments`
  - Contents of any custom fields of type `markdown`
  - Job class `description` attributes
  - The `SUPPORT_MESSAGE` system configuration setting

  are potentially susceptible to cross-site scripting (XSS) attacks via maliciously crafted data.

  ### Patches

  Fixed in Nautobot versions 1.6.10 and 2.1.2.

  ### References

  https://github.com/nautobot/nautobot/pull/5133
  https://github.com/nautobot/nautobot/pull/5134
impacted_packages:
  - purl: pkg:pypi/nautobot
    affected_versions: vers:pypi/>=2.0.0|<2.1.2
    fixed_versions: vers:pypi/2.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/nautobot
    affected_versions: vers:pypi/<1.6.10
    fixed_versions: vers:pypi/1.6.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-v4xv-795h-rv4h/GHSA-v4xv-795h-rv4h.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/nautobot/nautobot
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/commit/17effcbe84a72150c82b138565c311bbee357e80
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/commit/64312a4297b5ca49b6cdedf477e41e8e4fd61cce
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/pull/5133
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/pull/5134
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/security/advisories/GHSA-v4xv-795h-rv4h
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/nautobot/PYSEC-2024-16.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23345
    reference_type:
    reference_id: CVE-2024-23345
