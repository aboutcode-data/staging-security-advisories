advisory_id: GHSA-6qjp-wm6g-m32r
datasource_id: github_osv_importer_v2/GHSA-6qjp-wm6g-m32r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/02/GHSA-6qjp-wm6g-m32r/GHSA-6qjp-wm6g-m32r.json
aliases:
  - CVE-2024-2321
summary: |
  WSO2 incorrect authorization vulnerability
  An incorrect authorization vulnerability exists in multiple WSO2 products, allowing protected APIs to be accessed directly using a refresh token instead of the expected access token. Due to improper authorization checks and token mapping, session cookies are not required for API access, potentially enabling unauthorized operations.

  Exploitation requires an attacker to obtain a valid refresh token of an admin user. Since refresh tokens generally have a longer expiration time, this could lead to prolonged unauthorized access to API resources, impacting data confidentiality and integrity.
impacted_packages:
  - purl: pkg:maven/org.wso2.am/am-parent
    affected_versions: vers:maven/>=4.2.0-beta|<=4.2.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.wso2.am/am-parent
    affected_versions: vers:maven/>=4.1.0-alpha|<=4.1.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.wso2.am/am-parent
    affected_versions: vers:maven/>=4.0.0-beta|<=4.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.wso2.is/identity-server-parent
    affected_versions: vers:maven/>=6.1.0-beta|<=6.1.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.wso2.is/identity-server-parent
    affected_versions: vers:maven/>=6.0.0-alpha3|<=6.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.wso2.is/identity-server-parent
    affected_versions: vers:maven/>=5.11.0-alpha|<=5.11.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/02/GHSA-6qjp-wm6g-m32r/GHSA-6qjp-wm6g-m32r.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/wso2/docs-security/blob/76bad9a2f38dc3377af476d0be52c6e775e3d864/en/docs/security-announcements/security-advisories/2024/WSO2-2024-3213.md
    reference_type:
    reference_id:
  - url: https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2024/WSO2-2024-3213
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-2321
    reference_type:
    reference_id: CVE-2024-2321
