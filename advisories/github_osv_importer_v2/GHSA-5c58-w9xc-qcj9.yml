advisory_id: GHSA-5c58-w9xc-qcj9
datasource_id: github_osv_importer_v2/GHSA-5c58-w9xc-qcj9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-5c58-w9xc-qcj9/GHSA-5c58-w9xc-qcj9.json
aliases:
  - CVE-2015-2308
summary: |
  Symfony Vulnerable to PHP Eval Injection
  Applications with ESI support (and SSI support as of Symfony 2.6) enabled and using the Symfony built-in reverse proxy (the `Symfony\Component\HttpKernel\HttpCache class) are vulnerable to PHP code injection; a malicious user can inject PHP code that will be executed by the server.

  HttpCache uses eval() to execute files in its cache when they contain ESI tags (and only when ESI is enabled). The vulnerability comes from the fact that PHP allows contents of <script language="php"> tags to be executed (and this kind of PHP tags is always available regardless of the configuration), but there were not escaped before the evaluation.

  A possible exploit comes from websites also vulnerable to Cross-Site Scripting as an attacker can successfully conduct a PHP code injection attack by passing such a tag in a user submitted variable (for which proper output escaping was not applied).
impacted_packages:
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=2.0.0|<2.3.27
    fixed_versions: vers:composer/2.3.27
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=2.4.0|<2.5.11
    fixed_versions: vers:composer/2.5.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=2.6.0|<2.6.6
    fixed_versions: vers:composer/2.6.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/http-kernel
    affected_versions: vers:composer/>=2.0.0|<2.3.27
    fixed_versions: vers:composer/2.3.27
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/http-kernel
    affected_versions: vers:composer/>=2.4.0|<2.5.11
    fixed_versions: vers:composer/2.5.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/http-kernel
    affected_versions: vers:composer/>=2.6.0|<2.6.6
    fixed_versions: vers:composer/2.6.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: http://jvndb.jvn.jp/jvndb/JVNDB-2015-000089
    reference_type:
    reference_id:
  - url: http://jvn.jp/en/jp/JVN19578958/index.html
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/http-kernel/CVE-2015-2308.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2015-2308.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/pull/14167/commits/195c57e1f50765aff33137689b16e126a689056a
    reference_type:
    reference_id:
  - url: https://symfony.com/blog/cve-2015-2308-esi-code-injection
    reference_type:
    reference_id:
  - url: https://symfony.com/cve-2015-2308
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20200228084751/http://www.securityfocus.com/bid/75357
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2015-2308
    reference_type:
    reference_id: CVE-2015-2308
