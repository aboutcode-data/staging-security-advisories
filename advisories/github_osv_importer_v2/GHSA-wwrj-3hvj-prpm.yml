advisory_id: GHSA-wwrj-3hvj-prpm
datasource_id: github_osv_importer_v2/GHSA-wwrj-3hvj-prpm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-wwrj-3hvj-prpm/GHSA-wwrj-3hvj-prpm.json
aliases:
  - CVE-2025-66482
summary: "Misskey has a login rate limit bypass via spoofed X-Forwarded-For header\n### Summary\n\
  When using an untrusted reverse proxy or not using a reverse proxy at all, attackers can bypass\
  \ IP rate limiting by adding a forged X-Forwarded-For header. Starting with version 2025.9.1,\
  \ an option (`trustProxy`) has been added in config file to prevent this from happening. However,\
  \ it is initialized with an insecure default value before version 2025.12.0, making it still\
  \ vulnerable if the configuration is not set correctly.\n\n### Workaround\n\nIf you are running\
  \ Misskey with a trusted reverse proxy, you should *not* be affected by this vulnerability.\n\
  \n- There is no workaround for the Misskey itself. Please update Misskey to the latest version\
  \ or set up a trusted reverse proxy.\n- From v2025.9.1 to v2025.11.1, workaround is available.\
  \ Set `trustProxy: false` in config file.\n- This is patched in v2025.12.0 by flipping default\
  \ value of `trustProxy` to `false`. If you are using trusted reverse proxy and not remember\
  \ you manually overrided this value, please take time to check your config for optimal behavior.\n\
  \n### Details\n[Fastify recommend not trusting X-Forwarded-For IPs](https://fastify.dev/docs/latest/Reference/Server/#trustproxy)\n\
  Due to misconfiguration in https://github.com/misskey-dev/misskey/blob/develop/packages/backend/src/server/api/SigninApiService.ts#L94\
  \ attacks can spoof their IPs.\n\n### PoC\n\n```\nPOST /api/signin-flow HTTP/1.1\nHost: misskey.localhost:3123\n\
  Content-Length: 45\nContent-Type: application/json\nConnection: keep-alive\nX-Forwarded-For:\
  \ 127.1.1.31, 1.1.1.12\n\n{\"username\":\"admin\",\n\t\"password\":\"password\"}\n```\n![image](https://github.com/user-attachments/assets/ce9f77e2-b339-4081-86a6-d44ed42e9ca5)\n\
  \n\n### Impact\nAn attacker can brute force accounts bypassing rate limiting protection."
impacted_packages:
  - purl: pkg:npm/misskey-js
    affected_versions: vers:npm/>=2025.9.1|<2025.12.0-alpha.2
    fixed_versions: vers:npm/2025.12.0-alpha.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-wwrj-3hvj-prpm/GHSA-wwrj-3hvj-prpm.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-wwrj-3hvj-prpm/GHSA-wwrj-3hvj-prpm.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1188
  - CWE-307
references:
  - url: https://github.com/misskey-dev/misskey
    reference_type:
    reference_id:
  - url: https://github.com/misskey-dev/misskey/commit/5512898463fa8487b9e6488912f35102b91f25f7
    reference_type:
    reference_id:
  - url: https://github.com/misskey-dev/misskey/security/advisories/GHSA-wwrj-3hvj-prpm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66482
    reference_type:
    reference_id:
