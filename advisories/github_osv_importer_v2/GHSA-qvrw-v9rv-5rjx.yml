advisory_id: GHSA-qvrw-v9rv-5rjx
datasource_id: github_osv_importer_v2/GHSA-qvrw-v9rv-5rjx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-qvrw-v9rv-5rjx/GHSA-qvrw-v9rv-5rjx.json
aliases:
  - CVE-2023-49082
summary: |
  aiohttp's ClientSession is vulnerable to CRLF injection via method
  ### Summary
  Improper validation makes it possible for an attacker to modify the HTTP request (e.g. insert a new header) or even create a new HTTP request if the attacker controls the HTTP method.

  ### Details
  The vulnerability occurs only if the attacker can control the HTTP method (GET, POST etc.) of the request.

  Previous releases performed no validation on the provided value. If an attacker controls the HTTP method it will be used as is and can lead to HTTP request smuggling.

  ### PoC
  A minimal example can be found here:
  https://gist.github.com/jnovikov/7f411ae9fe6a9a7804cf162a3bdbb44b

  ### Impact
  If the attacker can control the HTTP version of the request it will be able to modify the request (request smuggling).

  ### Workaround
  If unable to upgrade and using user-provided values for the request method, perform manual validation of the user value (e.g. by restricting it to a few known values like GET, POST etc.).

  Patch: https://github.com/aio-libs/aiohttp/pull/7806/files
impacted_packages:
  - purl: pkg:pypi/aiohttp
    affected_versions: vers:pypi/<3.9.0
    fixed_versions: vers:pypi/3.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-qvrw-v9rv-5rjx/GHSA-qvrw-v9rv-5rjx.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/11/GHSA-qvrw-v9rv-5rjx/GHSA-qvrw-v9rv-5rjx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://gist.github.com/jnovikov/7f411ae9fe6a9a7804cf162a3bdbb44b
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/commit/e4ae01c2077d2cfa116aa82e4ff6866857f7c466
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/pull/7806/files
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/security/advisories/GHSA-qvrw-v9rv-5rjx
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/aiohttp/PYSEC-2023-251.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/02/msg00002.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TY5SI6NK5243DEEDQUFKQKW5GQNKQUMA
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WSYWMP64ZFCTC3VO6RY6EC6VSSMV6I3A
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-49082
    reference_type:
    reference_id: CVE-2023-49082
