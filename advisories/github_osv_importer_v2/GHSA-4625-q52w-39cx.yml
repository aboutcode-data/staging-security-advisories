advisory_id: GHSA-4625-q52w-39cx
datasource_id: github_osv_importer_v2/GHSA-4625-q52w-39cx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-4625-q52w-39cx/GHSA-4625-q52w-39cx.json
aliases:
  - CVE-2021-21609
summary: |
  Missing permission check for paths with specific prefix in Jenkins
  Jenkins includes a static list of URLs that are always accessible even without Overall/Read permission, such as the login form. These URLs are excluded from an otherwise universal permission check.

  Jenkins 2.274 and earlier, LTS 2.263.1 and earlier does not correctly compare requested URLs with that list.

  This allows attackers without Overall/Read permission to access plugin-provided URLs with any of the following prefixes if no other permissions are required:
  - `accessDenied`
  - `error`
  - `instance-identity`
  - `login`
  - `logout`
  - `oops`
  - `securityRealm`
  - `signup`
  - `tcpSlaveAgentListener`

  For example, a plugin contributing the path `loginFoo/` would have URLs in that space accessible without the default Overall/Read permission check.

  The Jenkins security team is not aware of any affected plugins as of the publication of this advisory.

  The comparison of requested URLs with the list of always accessible URLs has been fixed to only allow access to the specific listed URLs in Jenkins 2.275, LTS 2.263.2.

  In case this change causes problems, additional paths can be made accessible without Overall/Read permissions: The [Java system property](https://www.jenkins.io/doc/book/managing/system-properties/) `jenkins.model.Jenkins.additionalReadablePaths` is a comma-separated list of additional path prefixes to allow access to.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.main/jenkins-core
    affected_versions: vers:maven/<=2.263.1
    fixed_versions: vers:maven/2.263.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.main/jenkins-core
    affected_versions: vers:maven/<=2.274
    fixed_versions: vers:maven/2.275
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-4625-q52w-39cx/GHSA-4625-q52w-39cx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/jenkinsci/jenkins
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/jenkins/commit/fe9091fc74d55a56fd36544f3038d47c8cb331a4
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2021-01-13/#SECURITY-2047
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21609
    reference_type:
    reference_id: CVE-2021-21609
