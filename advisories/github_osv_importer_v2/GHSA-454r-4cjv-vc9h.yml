advisory_id: GHSA-454r-4cjv-vc9h
datasource_id: github_osv_importer_v2/GHSA-454r-4cjv-vc9h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-454r-4cjv-vc9h/GHSA-454r-4cjv-vc9h.json
aliases:
  - CVE-2015-5266
summary: |
  Moodle allows attackers to obtain manager privileges
  The enrol_meta_sync function in enrol/meta/locallib.php in Moodle through 2.6.11, 2.7.x before 2.7.10, 2.8.x before 2.8.8, and 2.9.x before 2.9.2 allows remote authenticated users to obtain manager privileges in opportunistic circumstances by leveraging incorrect role processing during a long-running sync script.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=2.7.0|<2.7.10
    fixed_versions: vers:composer/2.7.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=2.8.0|<2.8.8
    fixed_versions: vers:composer/2.8.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=2.9.0|<2.9.2
    fixed_versions: vers:composer/2.9.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-454r-4cjv-vc9h/GHSA-454r-4cjv-vc9h.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-50744
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/936facab28d8d8bd03f38da42cb80fafba1a06db
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/ab006d43e48add8e5495141d4d750c1531772ca2
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/dff6cdc88355f22ebaaf8f00c44a1ad51d272344
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/f7fbc80766b72ed1c9915698edd443ee8f6eafbd
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=320290
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20160323063809/http://www.securitytracker.com/id/1033619
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2015/09/21/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2015-5266
    reference_type:
    reference_id: CVE-2015-5266
