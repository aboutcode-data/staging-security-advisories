advisory_id: GHSA-r5cr-xm48-97xp
datasource_id: github_osv_importer_v2/GHSA-r5cr-xm48-97xp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-r5cr-xm48-97xp/GHSA-r5cr-xm48-97xp.json
aliases:
  - CVE-2025-46554
summary: |
  XWiki missing authorization when accessing the wiki level attachments list and metadata via REST API
  ### Impact

  Anyone can access the metadata of any attachment in the wiki using the wiki attachment REST endpoint. It's not filtering the result depending on current user rights, a not authenticated user could exploit this even in a totally private wiki.

  To reproduce:

  * remove view from guest on the whole wiki
  * logout
  * access http://127.0.0.1:8080/xwiki/rest/wikis/xwiki/spaces/Sandbox/pages/WebHome/attachments

  You get a list of attachments, while the expected result should be an empty list.

  ### Patches

  This vulnerability has been fixed in XWiki 14.10.22, 15.10.12, 16.7.0-rc-1 and 16.4.3.

  ### Workarounds

  We're not aware of any workaround except upgrading.

  ### References
  * https://jira.xwiki.org/browse/XWIKI-22424
  * https://jira.xwiki.org/browse/XWIKI-22427
  * https://github.com/xwiki/xwiki-platform/commit/a43e933ddeda17dad1772396e1757998260e9342#diff-0

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  * Email us at [Security Mailing List](mailto:security@xwiki.org)

  ### Attribution

  Issue reported by [Lukas Monert](https://github.com/LMonert).
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rest-server
    affected_versions: vers:maven/>=1.8.1|<14.10.22
    fixed_versions: vers:maven/14.10.22
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rest-server
    affected_versions: vers:maven/>=15.0-rc-1|<15.10.12
    fixed_versions: vers:maven/15.10.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rest-server
    affected_versions: vers:maven/>=16.0.0-rc-1|<16.4.3
    fixed_versions: vers:maven/16.4.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rest-server
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.7.0
    fixed_versions: vers:maven/16.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-r5cr-xm48-97xp/GHSA-r5cr-xm48-97xp.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/37ecea84fdd053c33733c2ae9a0778bf98eae608
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/a43e933ddeda17dad1772396e1757998260e9342
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/c02ce7843a39851865b9d7b6132e32fdd21e3856
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-r5cr-xm48-97xp
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22424
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22427
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-46554
    reference_type:
    reference_id: CVE-2025-46554
