advisory_id: GHSA-rrxm-2pvv-m66x
datasource_id: github_osv_importer_v2/GHSA-rrxm-2pvv-m66x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-rrxm-2pvv-m66x/GHSA-rrxm-2pvv-m66x.json
aliases: []
summary: |
  Picklescan is vulnerable to RCE via missing detection when calling numpy.f2py.crackfortran.getlincoef
  ### Summary

  Picklescan uses the `numpy.f2py.crackfortran.getlincoef` function (a NumPy F2PY helper) to execute arbitrary Python code during unpickling.

  ### Details

  Picklescan fails to detect a malicious pickle that uses the gadget `numpy.f2py.crackfortran.getlincoef` in `__reduce__`, allowing arbitrary command execution when the pickle is loaded. A crafted object returns this function plus attacker‑controlled arguments; the scan reports the file as safe, but pickle.load() triggers execution.

  ### PoC
  ```python
  class PoC:
      def __reduce__(self):
          from numpy.f2py.crackfortran import getlincoef
          return getlincoef, ("__import__('os').system('whoami')", None)
  ```

  ### Impact

  - Arbitrary code execution on the victim machine once they load the “scanned as safe” pickle / model file.
  - Affects any workflow relying on Picklescan to vet untrusted pickle / PyTorch artifacts.
  - Enables supply‑chain poisoning of shared model files.

  ### Credits
  - [ac0d3r](https://github.com/ac0d3r)
  - [Tong Liu](https://lyutoon.github.io), Institute of information engineering, CAS
impacted_packages:
  - purl: pkg:pypi/picklescan
    affected_versions: vers:pypi/<0.0.33
    fixed_versions: vers:pypi/0.0.33
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-rrxm-2pvv-m66x/GHSA-rrxm-2pvv-m66x.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
  - CWE-94
references:
  - url: https://github.com/mmaitre314/picklescan
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/commit/70c1c6c31beb6baaf52c8db1b6c3c0e84a6f9dab
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/pull/53
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/releases/tag/v0.0.33
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/security/advisories/GHSA-rrxm-2pvv-m66x
    reference_type:
    reference_id:
