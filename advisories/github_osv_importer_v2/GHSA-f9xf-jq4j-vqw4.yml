advisory_id: GHSA-f9xf-jq4j-vqw4
datasource_id: github_osv_importer_v2/GHSA-f9xf-jq4j-vqw4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-f9xf-jq4j-vqw4/GHSA-f9xf-jq4j-vqw4.json
aliases:
  - CVE-2021-25318
summary: "Rancher does not properly specify ApiGroup when creating Kubernetes RBAC resources\n\
  A vulnerability was discovered in Rancher versions 2.0 through the aforementioned fixed versions,\
  \ where users were granted access to resources regardless of the resource's API group. For\
  \ example Rancher should have allowed users access to `apps.catalog.cattle.io`, but instead\
  \ incorrectly gave access to `apps.*`. Resource affected include: \n\n**Downstream clusters:**\n\
  apiservices\nclusters\nclusterrepos\npersistentvolumes\nstorageclasses\n\n**Rancher management\
  \ cluster**\napprevisions\napps\ncatalogtemplates\ncatalogtemplateversions\nclusteralertgroups\n\
  clusteralertrules\nclustercatalogs\nclusterloggings\nclustermonitorgraphs\nclusterregistrationtokens\n\
  clusterroletemplatebindings\nclusterscans\netcdbackups\nnodepools\nnodes\nnotifiers\npipelineexecutions\n\
  pipelines\npipelinesettings\npodsecuritypolicytemplateprojectbindings\nprojectalertgroups\n\
  projectalertrules\nprojectcatalogs\nprojectloggings\nprojectmonitorgraphs\nprojectroletemplatebindings\n\
  projects\nsecrets\nsourcecodeproviderconfigs\n\nThere is not a direct mitigation besides upgrading\
  \ to the patched Rancher versions."
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-f9xf-jq4j-vqw4/GHSA-f9xf-jq4j-vqw4.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-f9xf-jq4j-vqw4/GHSA-f9xf-jq4j-vqw4.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-732
references:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=1184913
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/issues/33590
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-2768
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-25318
    reference_type:
    reference_id: CVE-2021-25318
