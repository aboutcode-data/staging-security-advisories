advisory_id: GHSA-q6r9-r9pw-4cf7
datasource_id: github_osv_importer_v2/GHSA-q6r9-r9pw-4cf7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-q6r9-r9pw-4cf7/GHSA-q6r9-r9pw-4cf7.json
aliases:
  - CVE-2025-2887
summary: |
  tough failure to detect delegated target rollback
  ## Summary

  When updating the snapshot role, TUF clients should ensure that any previously encountered targets or delegated targets metadata files continue to be present in new snapshot metadata files. Likewise, the new targets and delegated targets metadata versions must be greater than or equal to the previously encountered versions. While tough will perform this check for targets metadata files, it did not perform this check for delegated targets files.

  ## Impact

  tough could fail to detect cases where delegated targets metadata was removed or rolled back to a previous version. As a result, tough could trust and download outdated targets that it should reject.

  Impacted versions: < v0.20.0

  ## Patches

  A fix for this issue is available in tough version 0.20.0 and later. Customers are advised to upgrade to version 0.20.0 or later and ensure any forked or derivative code is patched to incorporate the new fixes.

  ## Workarounds

  There is no recommended work around. Customers are advised to upgrade to version 0.20.0 or the latest version.

  ## References

  If you have any questions or comments about this advisory we ask that you contact AWS/Amazon Security via our vulnerability reporting page [1] or directly via email to [aws-security@amazon.com](mailto:aws-security@amazon.com). Please do not create a public GitHub issue.


  [1] Vulnerability reporting page: [https://aws.amazon.com/security/vulnerability-reporting](https://aws.amazon.com/security/vulnerability-reporting%EF%BF%BC)

  ## Acknowledgement

  These issues were identified by the [TUF-Conformance project](https://github.com/theupdateframework/tuf-conformance). We would like to thank Google for collaborating on this issue through the coordinated vulnerability disclosure process.
impacted_packages: []
severities:
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-q6r9-r9pw-4cf7/GHSA-q6r9-r9pw-4cf7.json
  - score: '5.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:N/PR:H/UI:P/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-q6r9-r9pw-4cf7/GHSA-q6r9-r9pw-4cf7.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1025
references:
  - url: https://aws.amazon.com/security/security-bulletins/AWS-2025-007
    reference_type:
    reference_id:
  - url: https://github.com/awslabs/tough
    reference_type:
    reference_id:
  - url: https://github.com/awslabs/tough/commit/3345151a87c358d1ce43aeb7e8b3ebea5ebdbab4
    reference_type:
    reference_id:
  - url: https://github.com/awslabs/tough/releases/tag/tough-v0.20.0
    reference_type:
    reference_id:
  - url: https://github.com/awslabs/tough/security/advisories/GHSA-q6r9-r9pw-4cf7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-2887
    reference_type:
    reference_id: CVE-2025-2887
