advisory_id: GHSA-q6xv-jm4v-349h
datasource_id: github_osv_importer_v2/GHSA-q6xv-jm4v-349h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-q6xv-jm4v-349h/GHSA-q6xv-jm4v-349h.json
aliases:
  - CVE-2024-38527
summary: |
  Cross-site Scripting in ZenUML
  ### Summary

  Markdown-based comments in the ZenUML diagram syntax are susceptible to Cross-site Scripting (XSS).

  ### Details

  The comment feature allows the user to attach small notes for reference. This feature allows the user to enter in their comment in markdown comment, allowing them to use common markdown features, such as `**` for bolded text. However, the markdown text is currently not sanitized before rendering, allowing an attacker to enter a malicious payload for the comment which leads to XSS.

  https://github.com/mermaid-js/zenuml-core/blob/dcfee8cde42673c09e19401f43ad8506658c8442/src/components/DiagramFrame/SeqDiagram/MessageLayer/Block/Statement/Comment/Comment.vue#L65

  ### PoC

  ```
  // p<img onerror=alert(1) src=""/>
  A->B:hi
  ```

  Above is a POC diagram payload that results in an XSS.

  Here is a similar POC in mermaid.live: https://mermaid.live/edit#pako:eNpNjrFuwyAQhl8F3dRK1DaQGhs1kVq1Y6duFQsylwTVgEWw1MTyuxc5S7df39399y0wRIug4IZh9qMOdU2mF-dPJAZMKaa9GTHlB_ZILmnYa9BQH3R4fTq8qbMDCh6TN86WhkUHQjTkM3rUoEq0Jv2Ui7CWPTPn-HUNA6icZqQwT9ZkfHfmlIwHdTTjpVC0Lsf0eVfazChMJoBa4BdUL6uGC8n7TrCGd5zCFRRnXbVjvBVNK3gJXbtSuMVYSlnFC-Kyf961UshWbmXf2-y_xcf29c7WP2yrVC0

  ### Impact

  This puts existing applications that use ZenUML **unsandboxed** at risk of arbitrary JavaScript execution when rendering user-controlled diagrams.
impacted_packages:
  - purl: pkg:npm/%40zenuml/core
    affected_versions: vers:npm/<3.23.25
    fixed_versions: vers:npm/3.23.25
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-q6xv-jm4v-349h/GHSA-q6xv-jm4v-349h.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-80
  - CWE-79
references:
  - url: https://github.com/mermaid-js/zenuml-core
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/zenuml-core/commit/ad7545b33f5f27466cbf357beb65969ca1953e3c
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/zenuml-core/security/advisories/GHSA-q6xv-jm4v-349h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-38527
    reference_type:
    reference_id: CVE-2024-38527
