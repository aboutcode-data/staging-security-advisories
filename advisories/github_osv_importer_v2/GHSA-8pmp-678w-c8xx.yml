advisory_id: GHSA-8pmp-678w-c8xx
datasource_id: github_osv_importer_v2/GHSA-8pmp-678w-c8xx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-8pmp-678w-c8xx/GHSA-8pmp-678w-c8xx.json
aliases:
  - CVE-2024-51746
summary: |
  gitsign may use incorrect Rekor entries during verification
  ### Summary

  gitsign may select the wrong Rekor entry to use during online verification when multiple entries are returned by the log.

  ### Details

  gitsign uses Rekor's search API to fetch entries that apply to a signature being verified. The parameters used for the search are the public key and the payload. The search API returns entries that match _either_ condition rather than _both_. When gitsign's credential cache is used, there can be multiple entries that use the same ephemeral keypair / signing certificate. As gitsign assumes both conditions are matched by Rekor, there is no additional validation that the entry's hash matches the payload being verified, meaning that the wrong entry can be used to successfully pass verification.

  ### PoC

  Enable the credential cache and create commit signatures using the cached signing certificate. `gitsign verify` or `git log --show-signature` will demonstrate the use of the wrong entry index for the corresponding commit. Note that this depends on the order of matching entries in the response from the Rekor search API, so it may take a few attempts to trigger this.

  ### Impact

  Minimal. While gitsign does not match the payload against the entry, it does ensure that the certificate matches. This would need to be exploited during the certificate validity window (10 minutes) by the key holder.
impacted_packages: []
severities:
  - score: '1.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:H/AT:P/PR:N/UI:A/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-8pmp-678w-c8xx/GHSA-8pmp-678w-c8xx.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-706
  - CWE-287
references:
  - url: https://github.com/sigstore/gitsign
    reference_type:
    reference_id:
  - url: https://github.com/sigstore/gitsign/security/advisories/GHSA-8pmp-678w-c8xx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-51746
    reference_type:
    reference_id: CVE-2024-51746
