advisory_id: GHSA-vx24-x4mv-vwr5
datasource_id: github_osv_importer_v2/GHSA-vx24-x4mv-vwr5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-vx24-x4mv-vwr5/GHSA-vx24-x4mv-vwr5.json
aliases:
  - CVE-2024-41815
summary: "Starship vulnerable to shell injection via undocumented, unpredictable shell expansion\
  \ in custom commands\n## Description \nStarship is a cross-shell prompt. Starting in version\
  \ 1.0.0 and prior to version 1.20.0, undocumented and unpredictable shell expansion and/or\
  \ quoting rules make it easily to accidentally cause shell injection when using custom commands\
  \ with starship in bash. Version 1.20.0 fixes the vulnerability.\n\n### PoC\nHave some custom\
  \ command which prints out information from a potentially untrusted/unverified source.\n```\n\
  [custom.git_commit_name]\ncommand = 'git show -s --format=\"%<(25,mtrunc)%s\"'\nstyle = \"\
  italic\"\nwhen = true\n```\n\n### Impact\nThis issue only affects users with custom commands,\
  \ so the scope is limited, and without knowledge of others' commands, it could be hard to\
  \ successfully target someone."
impacted_packages: []
severities:
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-vx24-x4mv-vwr5/GHSA-vx24-x4mv-vwr5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
  - CWE-78
references:
  - url: https://github.com/starship/starship
    reference_type:
    reference_id:
  - url: https://github.com/starship/starship/commit/cfc58161e0ec595db90af686ad77a73df6d44d74
    reference_type:
    reference_id:
  - url: https://github.com/starship/starship/releases/tag/v1.20.0
    reference_type:
    reference_id:
  - url: https://github.com/starship/starship/security/advisories/GHSA-vx24-x4mv-vwr5
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2024-0446.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41815
    reference_type:
    reference_id: CVE-2024-41815
