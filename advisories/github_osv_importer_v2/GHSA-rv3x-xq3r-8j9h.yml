advisory_id: GHSA-rv3x-xq3r-8j9h
datasource_id: github_osv_importer_v2/GHSA-rv3x-xq3r-8j9h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-rv3x-xq3r-8j9h/GHSA-rv3x-xq3r-8j9h.json
aliases:
  - CVE-2021-37634
summary: |
  LeafKit allows XSS with untrusted user input
  ### Impact
  This affects anyone passing unsanitised data to Leaf's variable tags. Before this fix, Leaf would not escape any strings passed to tags as variables. If an attacker managed to find a variable that was rendered with their unsanitised data, they could inject scripts into a generated Leaf page, which could enable XSS attacks if other mitigations such as a Content Security Policy were not enabled.

  ### Patches
  This has been patched in 1.3.0

  ### Workarounds
  Sanitise any untrusted input before passing it to Leaf and enable a CSP to block inline script and CSS data.

  ### References
  https://github.com/vapor/leaf-kit-ghsa-rv3x-xq3r-8j9h/pull/1

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [Leaf Kit](https://github.com/vapor/leaf-kit)
  * Email us at [security@vapor.codes](mailto:security@vapor.codes)
impacted_packages: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-80
  - CWE-79
references:
  - url: https://github.com/vapor/leaf-kit
    reference_type:
    reference_id:
  - url: https://github.com/vapor/leaf-kit/releases/tag/1.3.0
    reference_type:
    reference_id:
  - url: https://github.com/vapor/leaf-kit/security/advisories/GHSA-rv3x-xq3r-8j9h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37634
    reference_type:
    reference_id: CVE-2021-37634
