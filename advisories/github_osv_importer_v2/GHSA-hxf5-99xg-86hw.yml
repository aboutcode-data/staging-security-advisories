advisory_id: GHSA-hxf5-99xg-86hw
datasource_id: github_osv_importer_v2/GHSA-hxf5-99xg-86hw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-hxf5-99xg-86hw/GHSA-hxf5-99xg-86hw.json
aliases:
  - CVE-2024-51756
summary: |
  cap-std doesn't fully sandbox all the Windows device filenames
  ### Impact

  cap-std's filesystem sandbox implementation on Windows blocks access to special device filenames such as "COM1", "COM2", "LPT0", "LPT1", and so on, however it did not block access to the special device filenames which use superscript digits, such as "COM¹", "COM²", "LPT⁰", "LPT¹", and so on. Untrusted filesystem paths could bypass the sandbox and access devices through those special device filenames with superscript digits, and through them provide access peripheral devices connected to the computer, or network resources mapped to those devices. This can include modems, printers, network printers, and any other device connected to a serial or parallel port, including emulated USB serial ports.

  ### Patches

  The bug is fixed in https://github.com/bytecodealliance/cap-std/pull/371, which is published in cap-primitives 3.4.1, cap-std 3.4.1, and cap-async-std 3.4.1.

  ### Workarounds

  There are no known workarounds for this issue. Affected Windows users are recommended to upgrade.

  ### References

   - [Microsoft's documentation](https://learn.microsoft.com/en-us/windows/win32/fileio/naming-a-file#naming-conventions) of the special device filenames
   - [ISO-8859-1](https://en.wikipedia.org/wiki/ISO/IEC_8859-1)
   - https://github.com/bytecodealliance/cap-std/pull/371
impacted_packages: []
severities:
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-hxf5-99xg-86hw/GHSA-hxf5-99xg-86hw.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://en.wikipedia.org/wiki/ISO/IEC_8859-1
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/cap-std
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/cap-std/commit/dcc3818039761331fbeacbb3a40c542b65b5ebf7
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/cap-std/pull/371
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/cap-std/security/advisories/GHSA-hxf5-99xg-86hw
    reference_type:
    reference_id:
  - url: https://learn.microsoft.com/en-us/windows/win32/fileio/naming-a-file#naming-conventions
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2024-0445.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-51756
    reference_type:
    reference_id: CVE-2024-51756
