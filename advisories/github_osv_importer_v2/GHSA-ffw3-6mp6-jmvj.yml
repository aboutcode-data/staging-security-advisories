advisory_id: GHSA-ffw3-6mp6-jmvj
datasource_id: github_osv_importer_v2/GHSA-ffw3-6mp6-jmvj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-ffw3-6mp6-jmvj/GHSA-ffw3-6mp6-jmvj.json
aliases:
  - CVE-2021-26559
summary: |
  Improper Access Control in Apache Airflow
  Improper Access Control on Configurations Endpoint for the Stable API of Apache Airflow allows users with Viewer or User role to get Airflow Configurations including sensitive information even when `[webserver] expose_config` is set to `False` in `airflow.cfg`. This allowed a privilege escalation attack. This issue affects Apache Airflow 2.0.0.
impacted_packages:
  - purl: pkg:pypi/apache-airflow
    affected_versions: vers:pypi/2.0.0
    fixed_versions: vers:pypi/2.0.1rc1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-ffw3-6mp6-jmvj/GHSA-ffw3-6mp6-jmvj.json
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-ffw3-6mp6-jmvj/GHSA-ffw3-6mp6-jmvj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
  - CWE-284
references:
  - url: https://github.com/advisories/GHSA-ffw3-6mp6-jmvj
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/blob/486b76438c0679682cf98cb88ed39c4b161cbcc8/CHANGELOG.txt
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/3909232fafd09ac72b49010ecdfd6ea48f06d5cf
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/5e35926c7eda0dfa11a9623e4bf5f60c2bd6b3f6
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/apache-airflow/PYSEC-2021-2.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r3b3787700279ec361308cbefb7c2cce2acb26891a12ce864e4a13c8d%40%3Cusers.airflow.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/rd142565996d7ee847b9c14b8a9921dcf80bc6bc160e3d9dca6dfc2f8@%3Cannounce.apache.org%3E
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/02/17/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-26559
    reference_type:
    reference_id: CVE-2021-26559
