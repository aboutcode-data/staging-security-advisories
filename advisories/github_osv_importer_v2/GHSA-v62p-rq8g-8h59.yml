advisory_id: GHSA-v62p-rq8g-8h59
datasource_id: github_osv_importer_v2/GHSA-v62p-rq8g-8h59
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v62p-rq8g-8h59/GHSA-v62p-rq8g-8h59.json
aliases:
  - CVE-2025-6547
summary: |
  pbkdf2 silently disregards Uint8Array input, returning static keys
  ### Summary

  On historic but declared as supported Node.js versions (0.12-2.x), pbkdf2 silently disregards Uint8Array input

  This only affects Node.js <3.0.0, but `pbkdf2` claims to:
   * Support Node.js [>= 0.12](https://github.com/browserify/pbkdf2/blob/v3.1.2/package.json#L62) (and there seems to be ongoing effort in this repo to maintain that)
   * Support `Uint8Array` input (input is typechecked against Uint8Array, and the error message includes e.g. "Password must be a string, a Buffer, a typed array or a DataView"

  ### Details

  The error is in `toBuffer` method

  This vulnerability somehow even made it to tests: https://github.com/browserify/pbkdf2/commit/eb9f97a66ed83836bebc4ff563a1588248708501
  There, `resultsOld` (where mismatch `results`) are just invalid output generated from empty password/salt instead of the supplied one

  ### PoC

  On Node.js/io.js < 3.0.0

  ```console
  > require('pbkdf2').pbkdf2Sync(new Uint8Array([1,2,3]), new Uint8Array([1,3,4]), 1024, 32, 'sha256')
  <Buffer 21 53 cd 5b a5 f0 15 39 2f 68 e2 40 8b 21 ba ca 0e dc 7b 20 d5 45 a4 8a ea b5 95 9f f0 be bf 66>

  // But that's just a hash of empty data with empty password:
  > require('pbkdf2').pbkdf2Sync('', '', 1024, 32, 'sha256')
  <Buffer 21 53 cd 5b a5 f0 15 39 2f 68 e2 40 8b 21 ba ca 0e dc 7b 20 d5 45 a4 8a ea b5 95 9f f0 be bf 66>

  // Node.js crypto is fine even on that version:
  > require('crypto').pbkdf2Sync(new Uint8Array([1,2,3]), new Uint8Array([1,3,4]), 1024, 32, 'sha256')
  <Buffer 78 10 cc 84 b7 bb 85 cd c8 37 ca 68 da a9 4c 33 db ae c2 3d 5b d4 95 76 da 33 f9 95 ac 51 f4 45>

  // Empty hash from Node.js, for comparison
  > require('crypto').pbkdf2Sync('', '', 1024, 32, 'sha256')
  <Buffer 21 53 cd 5b a5 f0 15 39 2f 68 e2 40 8b 21 ba ca 0e dc 7b 20 d5 45 a4 8a ea b5 95 9f f0 be bf 66>
  ```

  ### Impact

  Static hashes being outputted and used as keys/passwords can completely undermine security
  That said, no one should be using those Node.js versions anywhere now, so I would recommend to just drop them
  This lib should not pretend to work on those versions while outputting static data though

  Just updating to a fixed version is not enough: if anyone was using `pbkdf2` lib (do not confuse with Node.js `crypto.pbkdf2`) or anything depending on it with Node.js/io.js < 3.0.0, recheck where those keys went / how they were used,  and take action accordingly
impacted_packages:
  - purl: pkg:npm/pbkdf2
    affected_versions: vers:npm/<=3.1.2
    fixed_versions: vers:npm/3.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:P/PR:N/UI:N/VC:N/VI:H/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v62p-rq8g-8h59/GHSA-v62p-rq8g-8h59.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/browserify/pbkdf2
    reference_type:
    reference_id:
  - url: https://github.com/browserify/pbkdf2/commit/e3102a8cd4830a3ac85cd0dd011cc002fdde33bb
    reference_type:
    reference_id:
  - url: https://github.com/browserify/pbkdf2/security/advisories/GHSA-v62p-rq8g-8h59
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-6547
    reference_type:
    reference_id: CVE-2025-6547
