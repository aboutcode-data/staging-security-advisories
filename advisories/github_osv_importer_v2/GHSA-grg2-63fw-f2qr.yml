advisory_id: GHSA-grg2-63fw-f2qr
datasource_id: github_osv_importer_v2/GHSA-grg2-63fw-f2qr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-grg2-63fw-f2qr/GHSA-grg2-63fw-f2qr.json
aliases:
  - CVE-2026-22773
summary: "vLLM is vulnerable to DoS in Idefics3 vision models via image payload with ambiguous\
  \ dimensions\n### Summary\nUsers can crash the vLLM engine serving multimodal models that\
  \ use the _Idefics3_ vision model implementation by sending a specially crafted 1x1 pixel\
  \ image. This causes a tensor dimension mismatch that results in an unhandled runtime error,\
  \ leading to complete server termination.\n\n### Details\nThe vulnerability is triggered when\
  \ the image processor encounters a 1x1 pixel image with shape (1, 1, 3) in HWC (Height, Width,\
  \ Channel) format. Due to the ambiguous dimensions, the processor incorrectly assumes the\
  \ image is in CHW (Channel, Height, Width) format with shape (3, H, W). This misinterpretation\
  \ causes an incorrect calculation of the number of image patches, resulting in a fatal tensor\
  \ split operation failure.\n\n**Crash location**: `vllm/model_executor/models/idefics3.py`\
  \ line 672:\n```python\ndef _process_image_input(self, image_input: ImageInputs) -> torch.Tensor\
  \ | list[torch.Tensor]:\n    # ...\n    num_patches = image_input[\"num_patches\"]\n    return\
  \ [e.flatten(0, 1) for e in image_features.split(num_patches.tolist())]\n```\n\nThe `split()`\
  \ call fails because the computed `num_patches` value (17) does not match the actual tensor\
  \ dimension (9):\n```\nRuntimeError: split_with_sizes expects split_sizes to sum exactly to\
  \ 9 \n(input tensor's size at dimension 0), but got split_sizes=[17]\n```\n\nThis unhandled\
  \ exception terminates the EngineCore process, crashing the server.\n\n#### Affected Models\n\
  Any model using the Idefics3 architecture. The vulnerability was tested with `HuggingFaceTB/SmolVLM-Instruct`.\n\
  \n### Impact\nDenial of service by crashing the engine\n\n### Mitigation\nValidating the input:\n\
  ```python\ndef _validate_image_dimensions(self, image_shape):\n    h, w = image_shape[:2]\
  \ if len(image_shape) == 3 else image_shape\n    if h < MIN_IMAGE_SIZE or w < MIN_IMAGE_SIZE:\n\
  \        raise ValueError(f\"Image dimensions too small: {h}x{w}\")\n```\n\nManaging the exception:\n\
  ```python\ntry:\n    return [e.flatten(0, 1) for e in image_features.split(num_patches.tolist())]\n\
  except RuntimeError as e:\n    logger.error(f\"Image processing failed: {e}\")\n    raise\
  \ InvalidImageError(\"Failed to process image features\") from e\n```\n\n### Fixes\n\n* https://github.com/vllm-project/vllm/pull/29881"
impacted_packages:
  - purl: pkg:pypi/vllm
    affected_versions: vers:pypi/>=0.6.4|<0.12.0
    fixed_versions: vers:pypi/0.12.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-grg2-63fw-f2qr/GHSA-grg2-63fw-f2qr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
references:
  - url: https://github.com/vllm-project/vllm
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/commit/0ec84221718d920c3f46da879cc354f94b8fb59e
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/pull/29881
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/security/advisories/GHSA-grg2-63fw-f2qr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22773
    reference_type:
    reference_id:
