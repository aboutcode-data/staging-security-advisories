advisory_id: GHSA-pmqf-x6x8-p7qw
datasource_id: github_osv_importer_v2/GHSA-pmqf-x6x8-p7qw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-pmqf-x6x8-p7qw/GHSA-pmqf-x6x8-p7qw.json
aliases:
  - CVE-2025-62372
summary: |
  vLLM vulnerable to DoS with incorrect shape of multimodal embedding inputs
  ### Summary

  Users can crash the vLLM engine serving multimodal models by passing multimodal embedding inputs with correct `ndim` but incorrect `shape` (e.g. hidden dimension is wrong), regardless of whether the model is intended to support such inputs (as defined in the Supported Models page).

  The issue has existed ever since we added support for image embedding inputs, i.e. #6613 (released in v0.5.5)

  ### Details

  Using image embeddings as an example:

  - For models that support image embedding inputs, the engine crashes when scattering the embeddings to `inputs_embeds` (mismatched shape)
  - For models that don't support image embedding inputs, the engine crashes when validating the inputs inside `get_input_embeddings` (validation fails).

  This happens because we only validate `ndim` of the tensor, but not the full shape, in input processor (via `MultiModalDataParser`).

  ### Impact

  - Denial of service by crashing the engine

  ### Mitigation

  - Use API key to limit access to trusted users.
  - Set `--limit-mm-per-prompt` to 0 for all non-text modalities to ban multimodal inputs, which includes multimodal embedding inputs. However, the model would then only accept text, defeating the purpose of using a multi-modal model.

  ### Resolution

  - https://github.com/vllm-project/vllm/pull/27204
impacted_packages:
  - purl: pkg:pypi/vllm
    affected_versions: vers:pypi/>=0.5.5|<0.11.1
    fixed_versions: vers:pypi/0.11.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-pmqf-x6x8-p7qw/GHSA-pmqf-x6x8-p7qw.json
  - score: '8.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-pmqf-x6x8-p7qw/GHSA-pmqf-x6x8-p7qw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-129
references:
  - url: https://github.com/vllm-project/vllm
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/commit/58fab50d82838d5014f4a14d991fdb9352c9c84b
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/pull/27204
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/pull/6613
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/security/advisories/GHSA-pmqf-x6x8-p7qw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-62372
    reference_type:
    reference_id:
