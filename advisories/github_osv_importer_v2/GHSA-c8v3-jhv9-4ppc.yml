advisory_id: GHSA-c8v3-jhv9-4ppc
datasource_id: github_osv_importer_v2/GHSA-c8v3-jhv9-4ppc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-c8v3-jhv9-4ppc/GHSA-c8v3-jhv9-4ppc.json
aliases: []
summary: |
  Use-after-free when setting the locale
  Version 3.0.0 introduced an `AtomicStr` type, that is used to store the current locale. It stores the locale as a raw pointer to an `Arc<String>`. The locale can be read with `AtomicStr::as_str()`. `AtomicStr::as_str()` does not increment the usage counter of the `Arc`.

  If the locale is changed in one thread, another thread can have a stale -- possibly already freed -- reference to the stored string.
impacted_packages: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-416
references:
  - url: https://github.com/longbridgeapp/rust-i18n
    reference_type:
    reference_id:
  - url: https://github.com/longbridgeapp/rust-i18n/commit/22e0609591a2c08930f52a0e6bc860f02a0e88c0
    reference_type:
    reference_id:
  - url: https://github.com/longbridgeapp/rust-i18n/issues/71
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2024-0007.html
    reference_type:
    reference_id:
