advisory_id: GHSA-g776-759r-pf6x
datasource_id: github_osv_importer_v2/GHSA-g776-759r-pf6x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-g776-759r-pf6x/GHSA-g776-759r-pf6x.json
aliases: []
summary: |
  TYPO3 Broken Access Control in Import Module
  It has been discovered that the Import/Export module is susceptible to broken access control. Regular backend users have access to import functionality which usually only is available to admin users or users having User TSconfig setting options.impexp.enableImportForNonAdminUser explicitly enabled.

  Database content to be imported however was correctly checked against usersâ€™ permissions and not affected. However it was possible to upload files by-passing restrictions of the file abstraction layer (FAL) - however this did not affect executable files which have been correctly secured by fileDenyPattern.

  Currently the only known vulnerability is to directly inject *.form.yaml files which could be used to trigger the vulnerability of TYPO3-CORE-SA-2018-003 (privilege escalation & SQL injection) - which requires the Form Framework (ext:form) being available on an according website. CVSSv3 scoring is based on this scenario.

  A valid backend user account is needed in order to exploit this vulnerability.
impacted_packages:
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/>=9.3.0|<9.5.8
    fixed_versions: vers:composer/9.5.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-g776-759r-pf6x/GHSA-g776-759r-pf6x.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms-core/2019-06-25-7.yaml
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3-CMS/core
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2019-017
    reference_type:
    reference_id:
