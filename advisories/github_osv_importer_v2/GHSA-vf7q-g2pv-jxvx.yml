advisory_id: GHSA-vf7q-g2pv-jxvx
datasource_id: github_osv_importer_v2/GHSA-vf7q-g2pv-jxvx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-vf7q-g2pv-jxvx/GHSA-vf7q-g2pv-jxvx.json
aliases:
  - CVE-2023-28438
summary: |
  Pimcore vulnerable to improper quoting of filters in Custom Reports
  ### Impact
  Since a user with 'report' permission can already write arbitrary SQL queries and given the fact that this endpoint is using the GET method (no CSRF protection), an attacker can inject an arbitrary query by manipulating a user to click on a link.

  The impact of this path traversal and arbitrary extension is limited (creation of arbitrary files and
  appending data to existing files) but when combined with the SQL Injection, the exported data can be controlled and a webshell can be uploaded. Attackers can use that to execute arbitrary PHP code on the server with the permissions of the webserver.

  ### Patches
  Update to version 10.5.19 or apply these patch manually https://github.com/pimcore/pimcore/commit/d1abadb181c88ebaa4bce1916f9077469d4ea2bc.patch
  https://github.com/pimcore/pimcore/commit/7f788fa44bc18bc1c9182c25e26b770a1d30b62f.patch

  ### Workarounds
  Apply patches manually:
  https://github.com/pimcore/pimcore/commit/d1abadb181c88ebaa4bce1916f9077469d4ea2bc.patch
  https://github.com/pimcore/pimcore/commit/7f788fa44bc18bc1c9182c25e26b770a1d30b62f.patch

  ### References
  #14526
  #14498
impacted_packages:
  - purl: pkg:composer/pimcore/pimcore
    affected_versions: vers:composer/<10.5.19
    fixed_versions: vers:composer/10.5.19
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-vf7q-g2pv-jxvx/GHSA-vf7q-g2pv-jxvx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/pimcore/pimcore
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/commit/d1abadb181c88ebaa4bce1916f9077469d4ea2bc.patch
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/pull/14526
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/security/advisories/GHSA-vf7q-g2pv-jxvx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-28438
    reference_type:
    reference_id: CVE-2023-28438
