advisory_id: GHSA-rrmm-wq7q-h4v5
datasource_id: github_osv_importer_v2/GHSA-rrmm-wq7q-h4v5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-rrmm-wq7q-h4v5/GHSA-rrmm-wq7q-h4v5.json
aliases: []
summary: |
  OpenSearch unauthorized data access on fields protected by field masking for fields of type ip, geo_point, geo_shape, xy_point, xy_shape
  ### Impact

  OpenSearch versions 2.19.2 and earlier improperly apply field masking rules on fields of the types `ip`, `geo_point`, `geo_shape`, `xy_point`, `xy_shape`. While the content of these fields is properly redacted in the `_source` document returned by search operations, the original unredacted values remain available to search queries. This allows to reconstruct the original field contents using range queries.

  Additionally, the content of fields of type `geo_point`, `geo_shape`, `xy_point`, `xy_shape` is returned in an unredacted form if requested via the `fields` option of the search API.

  ### Patches

  The issue has been resolved in OpenSearch 3.0.0 and OpenSearch 2.19.3.

  ### Workarounds

  If you cannot upgrade immediately, you can avoid the problem by using field level security (FLS) protection on fields of the affected types instead of field masking.
impacted_packages:
  - purl: pkg:maven/org.opensearch.plugin/opensearch-security
    affected_versions: vers:maven/<2.19.3.0
    fixed_versions: vers:maven/2.19.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-rrmm-wq7q-h4v5/GHSA-rrmm-wq7q-h4v5.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/opensearch-project/security
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/security/security/advisories/GHSA-rrmm-wq7q-h4v5
    reference_type:
    reference_id:
