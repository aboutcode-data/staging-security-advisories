advisory_id: GHSA-8xv7-89vj-q48c
datasource_id: github_osv_importer_v2/GHSA-8xv7-89vj-q48c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-8xv7-89vj-q48c/GHSA-8xv7-89vj-q48c.json
aliases:
  - CVE-2023-41050
summary: |
  Information disclosure in AccessControl
  ### Impact
  Python's "format" functionality allows someone controlling the format string to "read" objects accessible (recursively) via attribute access and subscription from accessible objects. Those attribute accesses and subscriptions use Python's full blown `getattr` and `getitem`, not the policy restricted `AccessControl` variants `_getattr_` and `_getitem_`. This can lead to critical information disclosure.

  `AccessControl` already provides a safe variant for `str.format` and denies access to `string.Formatter`. However, `str.format_map` is still unsafe.

  Affected are all users who allow untrusted users to create `AccessControl` controlled Python code and execute it.

  ### Patches
  A fix will be introduced in the versions 4.4, 5.8 and 6.2.

  ### Workarounds
  There are no workarounds.

  ### References
  https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-xjw2-6jm9-rf67 describes the corresponding problem for `RestrictedPython`.
impacted_packages:
  - purl: pkg:pypi/accesscontrol
    affected_versions: vers:pypi/<4.4
    fixed_versions: vers:pypi/4.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/zope
    affected_versions: vers:pypi/<4.8.9
    fixed_versions: vers:pypi/4.8.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/accesscontrol
    affected_versions: vers:pypi/>=5.0|<5.8
    fixed_versions: vers:pypi/5.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/accesscontrol
    affected_versions: vers:pypi/>=6.0|<6.2
    fixed_versions: vers:pypi/6.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/zope
    affected_versions: vers:pypi/>=5.0.0|<5.8.4
    fixed_versions: vers:pypi/5.8.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-8xv7-89vj-q48c/GHSA-8xv7-89vj-q48c.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/zopefoundation/AccessControl
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/AccessControl/commit/6bc32692e0d4b8d5cf64eae3d19de987c7375bc9
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/AccessControl/security/advisories/GHSA-8xv7-89vj-q48c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41050
    reference_type:
    reference_id: CVE-2023-41050
