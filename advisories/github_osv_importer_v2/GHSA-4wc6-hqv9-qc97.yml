advisory_id: GHSA-4wc6-hqv9-qc97
datasource_id: github_osv_importer_v2/GHSA-4wc6-hqv9-qc97
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-4wc6-hqv9-qc97/GHSA-4wc6-hqv9-qc97.json
aliases:
  - CVE-2023-35153
summary: |
  XWiki Platform vulnerable to stored cross-site scripting in ClassEditSheet page via name parameters
  ### Impact
  A stored XSS can be exploited by users with edit rights by adding a `AppWithinMinutes.FormFieldCategoryClass` class on a page and setting the payload on the page title.
  Then, any user visiting `/xwiki/bin/view/AppWithinMinutes/ClassEditSheet` executes the payload.

  See https://jira.xwiki.org/browse/XWIKI-20365 for me details.

  ### Patches
  The issue has been patched on XWiki 14.4.8, 14.10.4, and 15.0 ?

  ### Workarounds
  The issue can be fixed by updating `AppWithinMinutes.ClassEditSheet` with this [patch](https://github.com/xwiki/xwiki-platform/commit/1b87fec1e5b5ec00b7a8c3c3f94f6c5e22547392#diff-79e725ec7125cced7d302e1a1f955a76745af26ef28a148981b810e85335d302).

  ### References
  - https://github.com/xwiki/xwiki-platform/commit/1b87fec1e5b5ec00b7a8c3c3f94f6c5e22547392#diff-79e725ec7125cced7d302e1a1f955a76745af26ef28a148981b810e85335d302
  - https://jira.xwiki.org/browse/XWIKI-20365

  ### For more information

  If you have any questions or comments about this advisory:

  *    Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  *    Email us at [Security Mailing List](mailto:security@xwiki.org)

  ### Attribution

  This vulnerability has been reported on Intigriti by RenÃ© de Sain @renniepak.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-appwithinminutes-ui
    affected_versions: vers:maven/>=5.4.4|<14.4.8
    fixed_versions: vers:maven/14.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-appwithinminutes-ui
    affected_versions: vers:maven/>=14.5|<14.10.4
    fixed_versions: vers:maven/14.10.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-appwithinminutes-ui
    affected_versions: vers:maven/>=15.0-rc-1|<15.0
    fixed_versions: vers:maven/15.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-4wc6-hqv9-qc97/GHSA-4wc6-hqv9-qc97.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-80
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/1b87fec1e5b5ec00b7a8c3c3f94f6c5e22547392#diff-79e725ec7125cced7d302e1a1f955a76745af26ef28a148981b810e85335d302
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-4wc6-hqv9-qc97
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20365
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-35153
    reference_type:
    reference_id: CVE-2023-35153
