advisory_id: GHSA-vwj8-4grf-3r8v
datasource_id: github_osv_importer_v2/GHSA-vwj8-4grf-3r8v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-vwj8-4grf-3r8v/GHSA-vwj8-4grf-3r8v.json
aliases:
  - CVE-2021-33322
summary: |
  Liferay Portal and Liferay DXP fails to invalidate password reset tokens after use
  In implementation for the portal services before 5.7.3 in Liferay Portal 7.3.0 and earlier, and Liferay DXP 7.0 before fix pack 96, 7.1 before fix pack 18, and 7.2 before fix pack 5, password reset tokens are not invalidated after a user changes their password, which allows remote attackers to change the userâ€™s password via the old password reset token.
impacted_packages:
  - purl: pkg:maven/com.liferay.portal/com.liferay.portal.impl
    affected_versions: vers:maven/<5.7.3
    fixed_versions: vers:maven/5.7.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.liferay.portal/release.dxp.bom
    affected_versions: vers:maven/>=7.0.0|<7.0.10.fp96
    fixed_versions: vers:maven/7.0.10.fp96
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.liferay.portal/release.dxp.bom
    affected_versions: vers:maven/>=7.1.0|<7.1.10.fp18
    fixed_versions: vers:maven/7.1.10.fp18
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.liferay.portal/release.dxp.bom
    affected_versions: vers:maven/>=7.2.0|<7.2.10.fp5
    fixed_versions: vers:maven/7.2.10.fp5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-vwj8-4grf-3r8v/GHSA-vwj8-4grf-3r8v.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-613
references:
  - url: https://github.com/liferay/liferay-portal
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal/commit/8f072ee8527a1dd5c0ffa91c4a78641d0e666b95
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal/commit/9fe453b34f58286a504d995be8ba50499adcf1b7
    reference_type:
    reference_id:
  - url: https://liferay.atlassian.net/browse/LPE-16981
    reference_type:
    reference_id:
  - url: https://liferay.dev/portal/security/known-vulnerabilities/-/asset_publisher/jekt/content/cve-2021-33322-password-change-does-not-invalidate-password-reset-tokens?p_r_p_assetEntryId=121610648&_com_liferay_asset_publisher_web_portlet_AssetPublisherPortlet_INSTANCE_jekt_redirect=https%3A%2F%2Fliferay.dev%3A443%2Fportal%2Fsecurity%2Fknown-vulnerabilities%3Fp_p_id%3Dcom_liferay_asset_publisher_web_portlet_AssetPublisherPortlet_INSTANCE_jekt%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_r_p_assetEntryId%3D121610648%26_com_liferay_asset_publisher_web_portlet_AssetPublisherPortlet_INSTANCE_jekt_cur%3D0%26p_r_p_resetCur%3Dfalse
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-33322
    reference_type:
    reference_id: CVE-2021-33322
