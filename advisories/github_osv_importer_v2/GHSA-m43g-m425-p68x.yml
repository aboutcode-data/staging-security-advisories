advisory_id: GHSA-m43g-m425-p68x
datasource_id: github_osv_importer_v2/GHSA-m43g-m425-p68x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-m43g-m425-p68x/GHSA-m43g-m425-p68x.json
aliases:
  - CVE-2025-53103
summary: |
  junit-platform-reporting can leak Git credentials through its OpenTestReportGeneratingListener
  ### Summary

  This vulnerability affects JUnit's support for writing Open Test Reporting XML files which is an opt-in feature of `junit-platform-reporting`.

  If a repository is cloned using a GitHub token or other credentials in its URL, for example:

  ```bash
  git clone https://${GH_APP}:${GH_TOKEN}@github.com/example/example.git
  ```

  The credentials are captured by `OpenTestReportGeneratingListener` which produces (trimmed for brevity):

  ```xml
  <infrastructure>
      <git:repository originUrl="https://username:token@github.com/example/example.git" />
  </infrastructure>
  ```

  ### Details

  https://github.com/junit-team/junit5/blob/6b7764dac92fd35cb348152d1b37f8726875a4e0/junit-platform-reporting/src/main/java/org/junit/platform/reporting/open/xml/OpenTestReportGeneratingListener.java#L183

  I think this should be configurable in some way to exclude select git information or exclude it entirely.

  ### PoC

  1. Clone a repo using a GitHub token as shown above.
  2. Enable the listener `junit.platform.reporting.open.xml.enabled=true`
  3. Observe report captures credentials

  ### Impact

  Depending on the level of access of the token, it can be nothing, limited, or everything.

  If these test reports are published or stored anywhere public, then there is the possibility that a rouge attacker can steal the token and perform elevated actions by impersonating the user or app.

  ### Resolution

  JUnit 5.13.2 and later replace credentials in the URL with `***`. Moreover, including any Git metadata in the XML output is now an opt-in feature that can be enabled via the new `junit.platform.reporting.open.xml.git.enabled=true` configuration parameter but is not included by default.
impacted_packages:
  - purl: pkg:maven/org.junit.platform/junit-platform-reporting
    affected_versions: vers:maven/<=5.13.1
    fixed_versions: vers:maven/5.13.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-m43g-m425-p68x/GHSA-m43g-m425-p68x.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-312
references:
  - url: https://github.com/junit-team/junit-framework
    reference_type:
    reference_id:
  - url: https://github.com/junit-team/junit-framework/blob/6b7764dac92fd35cb348152d1b37f8726875a4e0/junit-platform-reporting/src/main/java/org/junit/platform/reporting/open/xml/OpenTestReportGeneratingListener.java#L183
    reference_type:
    reference_id:
  - url: https://github.com/junit-team/junit-framework/commit/d4fc834c8c1c0b3168cd030c13551d1d041f51bc
    reference_type:
    reference_id:
  - url: https://github.com/junit-team/junit-framework/security/advisories/GHSA-m43g-m425-p68x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-53103
    reference_type:
    reference_id: CVE-2025-53103
