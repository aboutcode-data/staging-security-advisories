advisory_id: GHSA-rpcg-f9q6-2mq6
datasource_id: github_osv_importer_v2/GHSA-rpcg-f9q6-2mq6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-rpcg-f9q6-2mq6/GHSA-rpcg-f9q6-2mq6.json
aliases:
  - CVE-2021-32674
summary: |
  Remote Code Execution via traversal in TAL expressions
  This advisory extends the previous advisory at https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36 with additional cases of TAL expression traversal vulnerabilities.

  ### Impact
  Most Python modules are not available for using in TAL expressions that you can add through-the-web, for example in Zope Page Templates. This restriction avoids file system access, for example via the 'os' module. But some of the untrusted modules are available indirectly through Python modules that are available for direct use.

  By default, you need to have the Manager role to add or edit Zope Page Templates through the web. Only sites that allow untrusted users to add/edit Zope Page Templates through the web are at risk.

  ### Patches
  The problem has been fixed in Zope 5.21 and 4.6.1.

  ### Workarounds
  The workaround is the same as for https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36: A site administrator can restrict adding/editing Zope Page Templates through the web using the standard Zope user/role permission mechanisms. Untrusted users should not be assigned the Zope Manager role and adding/editing Zope Page Templates through the web should be restricted to trusted users only.

  ### References
  * [The previous advisory (GHSA-5pr9-v234-jw36)](https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36)

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in the [Zope issue tracker](https://github.com/zopefoundation/Zope/issues)
  * Email us at [security@plone.org](mailto:security@plone.org)
impacted_packages:
  - purl: pkg:pypi/zope
    affected_versions: vers:pypi/>=5.0|<5.2.1
    fixed_versions: vers:pypi/5.2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/zope
    affected_versions: vers:pypi/<4.6.1
    fixed_versions: vers:pypi/4.6.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-rpcg-f9q6-2mq6/GHSA-rpcg-f9q6-2mq6.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-rpcg-f9q6-2mq6/GHSA-rpcg-f9q6-2mq6.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/zope/PYSEC-2021-104.yaml
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope/commit/1d897910139e2c0b11984fc9b78c1da1365bec21
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope/security/advisories/GHSA-rpcg-f9q6-2mq6
    reference_type:
    reference_id:
  - url: https://pypi.org/project/Zope
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32674
    reference_type:
    reference_id: CVE-2021-32674
