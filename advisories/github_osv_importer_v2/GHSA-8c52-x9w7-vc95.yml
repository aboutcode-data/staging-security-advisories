advisory_id: GHSA-8c52-x9w7-vc95
datasource_id: github_osv_importer_v2/GHSA-8c52-x9w7-vc95
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-8c52-x9w7-vc95/GHSA-8c52-x9w7-vc95.json
aliases:
  - CVE-2025-65089
summary: |
  XWiki view file macro: User can view content of office file without view rights on the attachment
  ### Summary
  A user with no view rights on a page may see the content of an office attachment displayed with the view file macro.

  ### Details
  If on a public page is displayed an office attachment from a restricted page, a user with no view rights on the restricted page can view the attachment content, no matter the display type used.

  ### PoC
  1. Install and activate the Pro Macros application
  2. Create a page and limit the view rights for a test user
  3. Add an attachment to the restricted page
  4. Create a new public page
  5. Add the view file macro and select the attachment from the restricted page using any display type
  6. Login as the test user with restricted view rights
  7. The user will see the content despite having no view rights

  ### Workarounds
  None

  ### Impact
  Private data can be leaked if a user knows the reference to an attachment and has edit rights on a page.
impacted_packages:
  - purl: pkg:maven/com.xwiki.pro/xwiki-pro-macros-ui
    affected_versions: vers:maven/<=1.26.20
    fixed_versions: vers:maven/1.27.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-8c52-x9w7-vc95/GHSA-8c52-x9w7-vc95.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/xwikisas/xwiki-pro-macros
    reference_type:
    reference_id:
  - url: https://github.com/xwikisas/xwiki-pro-macros/security/advisories/GHSA-8c52-x9w7-vc95
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-65089
    reference_type:
    reference_id:
