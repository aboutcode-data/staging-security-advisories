advisory_id: GHSA-gv2p-4mvg-g32h
datasource_id: github_osv_importer_v2/GHSA-gv2p-4mvg-g32h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-gv2p-4mvg-g32h/GHSA-gv2p-4mvg-g32h.json
aliases:
  - CVE-2024-41658
summary: |
  Casdoor has reflected XSS in QrCodePage.js (GHSL-2024-036)
  Casdoor is a UI-first Identity and Access Management (IAM) / Single-Sign-On (SSO) platform.  In Casdoor 1.577.0 and earlier, he purchase URL that is created to generate a WechatPay QR code is vulnerable to reflected XSS. When purchasing an item through casdoor, the product page allows you to pay via wechat pay. When using wechat pay, a QR code with the wechat pay link is displayed on the payment page, hosted on the domain of casdoor. This page takes a query parameter from the url successUrl, and redirects the user to that url after a successful purchase. Because the user has no reason to think that the payment page contains sensitive information, they may share it with other or can be social engineered into sending it to others. An attacker can then craft the casdoor link with a special url and send it back to the user, and once payment has gone though an XSS attack occurs.
impacted_packages: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-gv2p-4mvg-g32h/GHSA-gv2p-4mvg-g32h.json
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-gv2p-4mvg-g32h/GHSA-gv2p-4mvg-g32h.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/casdoor/casdoor
    reference_type:
    reference_id:
  - url: https://github.com/casdoor/casdoor/blob/v1.577.0/web/src/QrCodePage.js
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2024-035_GHSL-2024-036_casdoor
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41658
    reference_type:
    reference_id: CVE-2024-41658
