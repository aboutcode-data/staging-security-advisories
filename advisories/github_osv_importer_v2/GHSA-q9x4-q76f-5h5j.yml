advisory_id: GHSA-q9x4-q76f-5h5j
datasource_id: github_osv_importer_v2/GHSA-q9x4-q76f-5h5j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-q9x4-q76f-5h5j/GHSA-q9x4-q76f-5h5j.json
aliases:
  - CVE-2019-19030
summary: "Unauthenticated users can exploit an enumeration vulnerability in Harbor (CVE-2019-19030)\n\
  # Impact\nSean Wright from Secureworks has discovered an enumeration vulnerability. An attacker\
  \ can make use of the Harbor API to make unauthenticated calls to the Harbor instance. Based\
  \ on the HTTP status code in the response, an attacker is then able to work out which resources\
  \ exist, and which do not. This would likely be accomplished by either providing a wordlist\
  \ or enumerating through a sequence an\nunauthenticated attacker is able to enumerate resources\
  \ on the system. This provides them with information such as existing projects, repositories,\
  \ etc.\n\nThe vulnerability was immediately fixed by the Harbor team.  \n\n# Issue \nThe following\
  \ API resources where found to be vulnerable to enumeration attacks:\n/api/chartrepo/{repo}/prov\
  \ (POST)\n/api/chartrepo/{repo}/charts (GET, POST)\n/api/chartrepo/{repo}/charts/{name} (GET,\
  \ DELETE)\n/api/chartrepo/{repo}/charts/{name}/{version} (GET, DELETE)\n/api/labels?name={name}&scope=p\
  \ (GET)\n/api/repositories?project_id={id} (GET)\n/api/repositories/{repo_name}/ (GET, PUT,\
  \ DELETE)\n/api/repositories/{repo_name}/tags (GET)\n/api/repositories/{repo_name}/tags/{tag}/manifest?version={version}\
  \ (GET)\n/api/repositories/{repo_name/{tag}/labels (GET)\n/api/projects?project_name={name}\
  \ (HEAD)\n/api/projects/{project_id}/summary (GET)\n/api/projects/{project_id}/logs (GET)\n\
  /api/projects/{project_id} (GET, PUT, DELETE)\n/api/projects/{project_id}/metadatas (GET,\
  \ POST)\n/api/projects/{project_id}/metadatas/{metadata_name} (GET, PUT)\n\n# Known Attack\
  \ Vectors\nSuccessful exploitation of this issue will lead to bad actors identifying which\
  \ resources exist in Harbor without requiring authentication for the Harbor API.\n\n# Patches\n\
  If your product uses the affected releases of Harbor, update to version 1.10.3 or 2.0.1 to\
  \ patch this issue immediately.\n\nhttps://github.com/goharbor/harbor/releases/tag/v1.10.3\n\
  https://github.com/goharbor/harbor/releases/tag/v2.0.1\n\n# Workarounds\nThere is no known\
  \ workaround\n\n# For more information\nIf you have any questions or comments about this advisory,\
  \ contact cncf-harbor-security@lists.cncf.io\nView our security policy at https://github.com/goharbor/harbor/security/policy"
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-q9x4-q76f-5h5j/GHSA-q9x4-q76f-5h5j.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-204
references:
  - url: https://github.com/goharbor/harbor
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/security/advisories/GHSA-q9x4-q76f-5h5j
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-19030
    reference_type:
    reference_id: CVE-2019-19030
