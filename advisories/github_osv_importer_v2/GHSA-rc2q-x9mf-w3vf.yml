advisory_id: GHSA-rc2q-x9mf-w3vf
datasource_id: github_osv_importer_v2/GHSA-rc2q-x9mf-w3vf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-rc2q-x9mf-w3vf/GHSA-rc2q-x9mf-w3vf.json
aliases:
  - CVE-2022-4065
summary: |
  TestNG is vulnerable to Path Traversal
  ### Impact

  Affected by this vulnerability is the function `testngXmlExistsInJar` of the file `testng-core/src/main/java/org/testng/JarFileUtils.java` of the component `XML File Parser`.

  The manipulation leads to path traversal only for `.xml`, `.yaml` and `.yml` files by default. The attack implies running an unsafe test JAR. However since that JAR can also contain executable code itself, the path traversal is unlikely to be the main attack.

  ### Patches

  A patch is available in [version 7.7.0](https://github.com/cbeust/testng/releases/tag/7.7.0) at commit 9150736cd2c123a6a3b60e6193630859f9f0422b. It is recommended to apply a patch to fix this issue. The patch was pushed into the master branch but no releases have yet been made with the patch included.

  A backport of the fix is available in [version 7.5.1]((https://github.com/cbeust/testng/releases/tag/7.5.1) for Java 8 projects.

  ### Workaround

  * Specify which tests to run when invoking TestNG by configuring them on the CLI or in the build tool controlling the run.
  * Do not run tests with untrusted JARs on the classpath, this includes pull requests on open source projects.
impacted_packages:
  - purl: pkg:maven/org.testng/testng
    affected_versions: vers:maven/>=6.13|<7.5.1
    fixed_versions: vers:maven/7.5.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.testng/testng
    affected_versions: vers:maven/>=7.6.0|<7.7.0
    fixed_versions: vers:maven/7.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-rc2q-x9mf-w3vf/GHSA-rc2q-x9mf-w3vf.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/cbeust/testng
    reference_type:
    reference_id:
  - url: https://github.com/cbeust/testng/commit/9150736cd2c123a6a3b60e6193630859f9f0422b
    reference_type:
    reference_id:
  - url: https://github.com/cbeust/testng/pull/1596
    reference_type:
    reference_id:
  - url: https://github.com/cbeust/testng/pull/2806
    reference_type:
    reference_id:
  - url: https://github.com/cbeust/testng/releases/tag/7.7.0
    reference_type:
    reference_id:
  - url: https://github.com/cbeust/testng/releases/tag/7.7.1
    reference_type:
    reference_id:
  - url: https://github.com/testng-team/testng/pull/2899
    reference_type:
    reference_id:
  - url: https://github.com/testng-team/testng/releases/tag/7.5.1
    reference_type:
    reference_id:
  - url: https://vuldb.com/?ctiid.214027
    reference_type:
    reference_id:
  - url: https://vuldb.com/?id.214027
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-4065
    reference_type:
    reference_id: CVE-2022-4065
