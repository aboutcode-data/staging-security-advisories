advisory_id: GHSA-27hp-xhwr-wr2m
datasource_id: github_osv_importer_v2/GHSA-27hp-xhwr-wr2m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/12/GHSA-27hp-xhwr-wr2m/GHSA-27hp-xhwr-wr2m.json
aliases:
  - CVE-2024-56337
summary: "Apache Tomcat Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability\nTime-of-check\
  \ Time-of-use (TOCTOU) Race Condition vulnerability in Apache Tomcat.\n\nThis issue affects\
  \ Apache Tomcat: from 11.0.0-M1 through 11.0.1, from 10.1.0-M1 through 10.1.33, from 9.0.0.M1\
  \ through 9.0.97.\n\nThe mitigation for CVE-2024-50379 was incomplete.\n\nUsers running Tomcat\
  \ on a case insensitive file system with the default servlet write enabled (readonly initialisation\
  \ \nparameter set to the non-default value of false) may need additional configuration to\
  \ fully mitigate CVE-2024-50379 depending on which version of Java they are using with Tomcat:\n\
  - running on Java 8 or Java 11: the system property sun.io.useCanonCaches must be explicitly\
  \ set to false (it defaults to true)\n- running on Java 17: the system property sun.io.useCanonCaches,\
  \ if set, must be set to false (it defaults to false)\n- running on Java 21 onwards: no further\
  \ configuration is required (the system property and the problematic cache have been removed)\n\
  \nTomcat 11.0.3, 10.1.35 and 9.0.99 onwards will include checks that sun.io.useCanonCaches\
  \ is set appropriately before allowing the default servlet to be write enabled on a case insensitive\
  \ file system. Tomcat will also set sun.io.useCanonCaches to false by default where it can."
impacted_packages:
  - purl: pkg:maven/org.apache.tomcat/tomcat-catalina
    affected_versions: vers:maven/>=11.0.0-M1|<11.0.2
    fixed_versions: vers:maven/11.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.tomcat/tomcat-catalina
    affected_versions: vers:maven/>=10.1.0-M1|<10.1.34
    fixed_versions: vers:maven/10.1.34
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.tomcat/tomcat-embed-core
    affected_versions: vers:maven/>=9.0.0.M1|<9.0.98
    fixed_versions: vers:maven/9.0.98
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.tomcat.embed/tomcat-embed-core
    affected_versions: vers:maven/>=11.0.0-M1|<11.0.2
    fixed_versions: vers:maven/11.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.tomcat.embed/tomcat-embed-core
    affected_versions: vers:maven/>=10.1.0-M1|<10.1.34
    fixed_versions: vers:maven/10.1.34
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.tomcat.embed/tomcat-embed-core
    affected_versions: vers:maven/>=9.0.0.M1|<9.0.98
    fixed_versions: vers:maven/9.0.98
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/12/GHSA-27hp-xhwr-wr2m/GHSA-27hp-xhwr-wr2m.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-367
references:
  - url: https://github.com/apache/tomcat
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/b2b9qrgjrz1kvo4ym8y2wkfdvwoq6qbp
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00009.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56337
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20250103-0002
    reference_type:
    reference_id:
  - url: https://tomcat.apache.org/security-10.html#Fixed_in_Apache_Tomcat_10.1.34
    reference_type:
    reference_id:
  - url: https://tomcat.apache.org/security-11.html#Fixed_in_Apache_Tomcat_11.0.2
    reference_type:
    reference_id:
  - url: https://tomcat.apache.org/security-9.html#Fixed_in_Apache_Tomcat_9.0.98
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-50379
    reference_type:
    reference_id:
