advisory_id: GHSA-h362-m8f2-5x7c
datasource_id: github_osv_importer_v2/GHSA-h362-m8f2-5x7c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-h362-m8f2-5x7c/GHSA-h362-m8f2-5x7c.json
aliases:
  - CVE-2020-5229
summary: |
  Password Hashing: Do not use MD5
  ### Impact

  User passwords are stored in the database using the rather outdated and cryptographically insecure MD5 hash algorithm. Furthermore, the hashes are salted using the username instead of a random salt, causing hashes for users with the same username and password to collide which is problematic especially for popular users like the default `admin` user.

  This essentially means that for an attacker, it might be feasible to reconstruct a user's password given access to these hashes.

  Note that attackers needing access to the hashes means that they must gain access to the database in which these are stored first to be able to start cracking the passwords.


  ### Patches

  The problem is addressed in Opencast 8.1 which now uses the modern and much stronger bcrypt password hashing algorithm for storing passwords. Note, that old hashes remain MD5 until the password is updated.

  For a list of users whose password hashes are stored using MD5, take a look at the `/user-utils/users/md5.json` REST endpoint.


  ### Workarounds

  There is no workaround.

  ### References

  - [MD5 (Wikipedia)](https://en.wikipedia.org/wiki/MD5)
  - [bcrypt (Wikipedia)](https://en.wikipedia.org/wiki/Bcrypt)
  - [How weak is MD5 as a password hashing function?](https://security.stackexchange.com/q/52461)


  ### For more information

  If you have any questions or comments about this advisory:

  - Open an issue in [opencast/opencast](https://github.com/opencast/opencast/issues)
  - For security-relevant information, email us at security@opencast.org
impacted_packages:
  - purl: pkg:maven/org.opencastproject/opencast-common-jpa-impl
    affected_versions: vers:maven/<7.6
    fixed_versions: vers:maven/7.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.opencastproject/opencast-common-jpa-impl
    affected_versions: vers:maven/>=8.0|<8.1
    fixed_versions: vers:maven/8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-h362-m8f2-5x7c/GHSA-h362-m8f2-5x7c.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-327
references:
  - url: https://github.com/opencast/opencast/commit/32bfbe5f78e214e2d589f92050228b91d704758e
    reference_type:
    reference_id:
  - url: https://github.com/opencast/opencast/security/advisories/GHSA-h362-m8f2-5x7c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5229
    reference_type:
    reference_id: CVE-2020-5229
