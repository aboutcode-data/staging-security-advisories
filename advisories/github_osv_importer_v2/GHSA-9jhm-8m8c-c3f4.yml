advisory_id: GHSA-9jhm-8m8c-c3f4
datasource_id: github_osv_importer_v2/GHSA-9jhm-8m8c-c3f4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-9jhm-8m8c-c3f4/GHSA-9jhm-8m8c-c3f4.json
aliases:
  - CVE-2021-29431
summary: |
  SSRF in Sydent due to missing validation of hostnames
  ### Impact

  Sydent can be induced to send HTTP GET requests to internal systems, due to lack of parameter validation or IP address blacklisting.

  It is not possible to exfiltrate data or control request headers, but it might be possible to use the attack to perform an internal port enumeration.

  ### Patches

  Fixed in 9e57334, 8936925, 3d531ed, 0f00412

  ### Workarounds

  A potential workaround would be to use a firewall to ensure that Sydent cannot reach internal HTTP resources.

  ### For more information

  If you have any questions or comments about this advisory, email us at security@matrix.org.
impacted_packages:
  - purl: pkg:pypi/matrix-sydent
    affected_versions: vers:pypi/<2.3.0
    fixed_versions: vers:pypi/2.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-9jhm-8m8c-c3f4/GHSA-9jhm-8m8c-c3f4.json
  - score: '6.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-9jhm-8m8c-c3f4/GHSA-9jhm-8m8c-c3f4.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-918
references:
  - url: https://github.com/matrix-org/sydent
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/0f00412017f25619bc36c264b29ea96808bf310a
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/3d531ed50d2fd41ac387f36d44d3fb2c62dd22d3
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/8936925f561b0c352c2fa922d5097d7245aad00a
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/9e573348d81df8191bbe8c266c01999c9d57cd5f
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/releases/tag/v2.3.0
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/security/advisories/GHSA-9jhm-8m8c-c3f4
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-sydent/PYSEC-2021-22.yaml
    reference_type:
    reference_id:
  - url: https://pypi.org/project/matrix-sydent
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29431
    reference_type:
    reference_id: CVE-2021-29431
