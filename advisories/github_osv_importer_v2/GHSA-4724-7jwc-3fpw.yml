advisory_id: GHSA-4724-7jwc-3fpw
datasource_id: github_osv_importer_v2/GHSA-4724-7jwc-3fpw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-4724-7jwc-3fpw/GHSA-4724-7jwc-3fpw.json
aliases:
  - CVE-2022-39324
summary: |
  Grafana Spoofing originalUrl of snapshots
  To create a snapshot (and insert an arbitrary URL) the built-in role Viewer is sufficient.
  When a dashboard is shared as a local snapshot, the following three fields are offered in the web UI for a user to fill out:
  • Snapshotname
  • Expire
  • Timeout(seconds)
  After the user confirms creation of the snapshot (i.e. clicks the ”Local Snapshot” button) an HTTP POST request is sent to the Grafana server. The HTTP request contains additional parameters that are not visible in the web UI. The parameter originalUrl is not visible in the web UI, but sent in the HTTP POST request.

  The value of the originalUrl parameter is automatically generated. The purpose of the presented originalUrl parameter is to provide a user that views the snapshot the possibility to click on the button in the Grafana web UI and be presented with the dashboard that the snapshot was made out of.

  The value of the originalUrl parameter can be arbitrarily chosen by a malicious user that creates the snapshot (Note: by editing the query thanks to a web proxy like Burp)
  When another user opens the URL of the snapshot, they will be presented with the regular web interface delivered by the trusted Grafana server. The issue here is that the ”Open original dashboard” button no longer points to the to the real original dashboard but to the attacker’s (injected) URL.
impacted_packages: []
severities:
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-4724-7jwc-3fpw/GHSA-4724-7jwc-3fpw.json
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:P/VC:N/VI:N/VA:N/SC:H/SI:H/SA:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-4724-7jwc-3fpw/GHSA-4724-7jwc-3fpw.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/grafana/grafana
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/commit/239888f22983010576bb3a9135a7294e88c0c74a
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/commit/d7dcea71ea763780dc286792a0afd560bff2985c
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/pull/60232
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/pull/60256
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/security/advisories/GHSA-4724-7jwc-3fpw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39324
    reference_type:
    reference_id: CVE-2022-39324
