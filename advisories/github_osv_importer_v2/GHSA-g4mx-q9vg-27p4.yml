advisory_id: GHSA-g4mx-q9vg-27p4
datasource_id: github_osv_importer_v2/GHSA-g4mx-q9vg-27p4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-g4mx-q9vg-27p4/GHSA-g4mx-q9vg-27p4.json
aliases:
  - CVE-2023-45803
summary: |
  urllib3's request body not stripped after redirect from 303 status changes request method to GET
  urllib3 previously wouldn't remove the HTTP request body when an HTTP redirect response using status 303 "See Other" after the request had its method changed from one that could accept a request body (like `POST`) to `GET` as is required by HTTP RFCs. Although the behavior of removing the request body is not specified in the section for redirects, it can be inferred by piecing together information from different sections and we have observed the behavior in other major HTTP client implementations like curl and web browsers.

  From [RFC 9110 Section 9.3.1](https://www.rfc-editor.org/rfc/rfc9110.html#name-get):

  > A client SHOULD NOT generate content in a GET request unless it is made directly to an origin server that has previously indicated, in or out of band, that such a request has a purpose and will be adequately supported.

  ## Affected usages

  Because the vulnerability requires a previously trusted service to become compromised in order to have an impact on confidentiality we believe the exploitability of this vulnerability is low. Additionally, many users aren't putting sensitive data in HTTP request bodies, if this is the case then this vulnerability isn't exploitable.

  Both of the following conditions must be true to be affected by this vulnerability:

  * If you're using urllib3 and submitting sensitive information in the HTTP request body (such as form data or JSON)
  * The origin service is compromised and starts redirecting using 303 to a malicious peer or the redirected-to service becomes compromised.

  ## Remediation

  You can remediate this vulnerability with any of the following steps:

  * Upgrade to a patched version of urllib3 (v1.26.18 or v2.0.7)
  * Disable redirects for services that you aren't expecting to respond with redirects with `redirects=False`.
  * Disable automatic redirects with `redirects=False` and handle 303 redirects manually by stripping the HTTP request body.
impacted_packages:
  - purl: pkg:pypi/urllib3
    affected_versions: vers:pypi/>=2.0.0|<2.0.7
    fixed_versions: vers:pypi/2.0.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/urllib3
    affected_versions: vers:pypi/<1.26.18
    fixed_versions: vers:pypi/1.26.18
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-g4mx-q9vg-27p4/GHSA-g4mx-q9vg-27p4.json
  - score: '5.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:A/AC:L/AT:P/PR:H/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-g4mx-q9vg-27p4/GHSA-g4mx-q9vg-27p4.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/urllib3/PYSEC-2023-212.yaml
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/commit/4e50fbc5db74e32cabd5ccc1ab81fc103adfe0b3
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/commit/4e98d57809dacab1cbe625fddeec1a290c478ea9
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/commit/b594c5ceaca38e1ac215f916538fb128e3526a36
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/releases/tag/1.26.18
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/releases/tag/2.0.7
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/security/advisories/GHSA-g4mx-q9vg-27p4
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/12/msg00020.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4R2Y5XK3WALSR3FNAGN7JBYV2B343ZKB
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/5F5CUBAN5XMEBVBZPHFITBLMJV5FIJJ5
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PPDPLM6UUMN55ESPQWJFLLIZY4ZKCNRX
    reference_type:
    reference_id:
  - url: https://www.rfc-editor.org/rfc/rfc9110.html#name-get
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-45803
    reference_type:
    reference_id: CVE-2023-45803
