advisory_id: GHSA-76w9-p8mg-j927
datasource_id: github_osv_importer_v2/GHSA-76w9-p8mg-j927
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-76w9-p8mg-j927/GHSA-76w9-p8mg-j927.json
aliases:
  - CVE-2021-45707
summary: |
  Out-of-bounds Write in nix
  On certain platforms, if a user has more than 16 groups, the nix::unistd::getgrouplist function will call the libc getgrouplist function with a length parameter greater than the size of the buffer it provides, resulting in an out-of-bounds write and memory corruption.

  The libc getgrouplist function takes an in/out parameter ngroups specifying the size of the group buffer. When the buffer is too small to hold all of the requested user's group memberships, some libc implementations, including glibc and Solaris libc, will modify ngroups to indicate the actual number of groups for the user, in addition to returning an error. The version of nix::unistd::getgrouplist in nix 0.16.0 and up will resize the buffer to twice its size, but will not read or modify the ngroups variable. Thus, if the user has more than twice as many groups as the initial buffer size of 8, the next call to getgrouplist will then write past the end of the buffer.

  The issue would require editing /etc/groups to exploit, which is usually only editable by the root user.
impacted_packages: []
severities:
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-76w9-p8mg-j927/GHSA-76w9-p8mg-j927.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-787
references:
  - url: https://github.com/advisories/GHSA-wgrg-5h56-jg27
    reference_type:
    reference_id:
  - url: https://github.com/nix-rust/nix
    reference_type:
    reference_id:
  - url: https://github.com/nix-rust/nix/issues/1541
    reference_type:
    reference_id:
  - url: https://raw.githubusercontent.com/rustsec/advisory-db/main/crates/nix/RUSTSEC-2021-0119.md
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0119.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-45707
    reference_type:
    reference_id: CVE-2021-45707
