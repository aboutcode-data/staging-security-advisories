advisory_id: GHSA-v829-x6hh-cqfq
datasource_id: github_osv_importer_v2/GHSA-v829-x6hh-cqfq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-v829-x6hh-cqfq/GHSA-v829-x6hh-cqfq.json
aliases:
  - CVE-2023-27484
summary: |
  Crossplane-runtime contains Improper Input Validation via Compositions
  ### Summary

  Fuzz testing, by Ada Logics and sponsored by the CNCF, identified a [vulnerability](https://github.com/crossplane/crossplane-runtime/security/advisories/GHSA-vfvj-3m3g-m532) in the `fieldpath` package from `crossplane/crossplane-runtime` that an already highly privileged Crossplane user able to create or update Compositions could leverage to cause an out of memory panic in Crossplane.

  ### Details

  Compositions allow users to specify patches inserting elements into arrays at an arbitrary index. When a Composition is selected for a Composite Resource, patches are evaluated and if a specified index is greater than the current size of the target slice, that slice's size will be increased to the specified index, which could lead to an excessive amount of memory usage and therefore the Pod being OOM-Killed. The index is already capped to the maximum value for a uint32 (4294967295) when parsed, but that is still an unnecessarily large value.

  ### Workaround

  Users can restrict write privileges on Compositions to only admin users as a workaround.
impacted_packages: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-v829-x6hh-cqfq/GHSA-v829-x6hh-cqfq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-400
references:
  - url: https://github.com/crossplane/crossplane
    reference_type:
    reference_id:
  - url: https://github.com/crossplane/crossplane/security/advisories/GHSA-v829-x6hh-cqfq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-27484
    reference_type:
    reference_id: CVE-2023-27484
