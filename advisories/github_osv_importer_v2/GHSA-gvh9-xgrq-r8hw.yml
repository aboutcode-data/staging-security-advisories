advisory_id: GHSA-gvh9-xgrq-r8hw
datasource_id: github_osv_importer_v2/GHSA-gvh9-xgrq-r8hw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-gvh9-xgrq-r8hw/GHSA-gvh9-xgrq-r8hw.json
aliases:
  - CVE-2021-36776
summary: |
  Rancher's Steve API Component Improper authorization check allows privilege escalation
  ### Impact

  A flaw discovered in Rancher versions from 2.5.0 up to and including 2.5.9 allows an authenticated user to impersonate any user on a cluster through the Steve API proxy, without requiring knowledge of the impersonated user's credentials. This is due to the Steve API proxy not dropping the impersonation header before sending the request to the Kubernetes API. A malicious user with authenticated access to Rancher could use this to impersonate another user with administrator access in Rancher, receiving, then, administrator level access in the cluster.

  ### Patches
  Patched versions include releases 2.5.10, 2.6.0 and later versions.

  ### Workarounds
  Limit access in Rancher to trusted users. There is not a direct mitigation besides upgrading to the patched Rancher versions.

  ### For more information
  If you have any questions or comments about this advisory:
  * Reach out to [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy) for security related inquiries.
  * Open an issue in [Rancher](https://github.com/rancher/rancher/issues/new/choose) repository.
  * Verify our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/) and [product support lifecycle](https://www.suse.com/lifecycle/).
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-gvh9-xgrq-r8hw/GHSA-gvh9-xgrq-r8hw.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-gvh9-xgrq-r8hw/GHSA-gvh9-xgrq-r8hw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
references:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=1189413
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-36776
    reference_type:
    reference_id: CVE-2021-36776
