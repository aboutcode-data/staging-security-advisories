advisory_id: GHSA-9qrh-qjmc-5w2p
datasource_id: github_osv_importer_v2/GHSA-9qrh-qjmc-5w2p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-9qrh-qjmc-5w2p/GHSA-9qrh-qjmc-5w2p.json
aliases:
  - CVE-2022-21227
summary: |
  Denial-of-Service when binding invalid parameters in sqlite3
  Affected versions of sqlite3 will experience a fatal error when supplying a specific object in the parameter array. This error causes the application to crash and could not be caught. Users of `sqlite3` v5.0.0, v5.0.1 and v5.0.2 are affected by this. This issue is fixed in v5.0.3. All users are recommended to upgrade to v5.0.3 or later. Ensure there is sufficient sanitization in the parent application to protect against invalid values being supplied to binding parameters as a workaround.
impacted_packages:
  - purl: pkg:npm/sqlite3
    affected_versions: vers:npm/>=5.0.0|<5.0.3
    fixed_versions: vers:npm/5.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-9qrh-qjmc-5w2p/GHSA-9qrh-qjmc-5w2p.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-248
references:
  - url: https://github.com/TryGhost/node-sqlite3
    reference_type:
    reference_id:
  - url: https://github.com/TryGhost/node-sqlite3/commit/593c9d498be2510d286349134537e3bf89401c4a
    reference_type:
    reference_id:
  - url: https://github.com/TryGhost/node-sqlite3/issues/1440
    reference_type:
    reference_id:
  - url: https://github.com/TryGhost/node-sqlite3/issues/1449
    reference_type:
    reference_id:
  - url: https://github.com/TryGhost/node-sqlite3/security/advisories/GHSA-9qrh-qjmc-5w2p
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-JS-SQLITE3-2388645
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-2805470
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-SQLITE3-2388645
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21227
    reference_type:
    reference_id: CVE-2022-21227
