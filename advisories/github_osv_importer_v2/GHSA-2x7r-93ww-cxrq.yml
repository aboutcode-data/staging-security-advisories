advisory_id: GHSA-2x7r-93ww-cxrq
datasource_id: github_osv_importer_v2/GHSA-2x7r-93ww-cxrq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-2x7r-93ww-cxrq/GHSA-2x7r-93ww-cxrq.json
aliases:
  - CVE-2023-52085
summary: |
  Winter CMS Local File Inclusion through Server Side Template Injection
  ### Impact
  Users with access to backend forms that include a [ColorPicker FormWidget](https://wintercms.com/docs/v1.2/docs/backend/forms#color-picker) can provide a value that would then be included without further processing in the compilation of custom stylesheets via LESS. This had the potential to lead to a Local File Inclusion vulnerability.

  By default, only the Brand Settings (backend.manage_branding) and Mail Brand Settings (system.manage_mail_templates) forms both include the colorpicker formwidget and pass the provided value to be compiled in LESS, however it is also common for themes to include it on their Theme Customization (cms.manage_theme_options) form and it is technically possible for the values on that form to also be used in LESS compilation: https://wintercms.com/docs/v1.2/docs/themes/development#asset-compiler-variables.

  ### Patches
  This issue has been patched in v1.2.4.

  ### Workarounds
  Apply https://github.com/wintercms/winter/commit/5bc9257fe2bc47d8b786a1b1bf96bafad23d8ddd manually if unable to upgrade to v1.2.4.
impacted_packages:
  - purl: pkg:composer/winter/wn-backend-module
    affected_versions: vers:composer/<1.2.4
    fixed_versions: vers:composer/1.2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-2x7r-93ww-cxrq/GHSA-2x7r-93ww-cxrq.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/wintercms/winter
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/winter/commit/5bc9257fe2bc47d8b786a1b1bf96bafad23d8ddd
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/winter/security/advisories/GHSA-2x7r-93ww-cxrq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52085
    reference_type:
    reference_id: CVE-2023-52085
