advisory_id: GHSA-hhr9-rh25-hvf9
datasource_id: github_osv_importer_v2/GHSA-hhr9-rh25-hvf9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-hhr9-rh25-hvf9/GHSA-hhr9-rh25-hvf9.json
aliases:
  - CVE-2023-37899
summary: |
  Feathers socket handler allows abusing implicit toString
  ### Impact

  Feathers socket handler did not catch invalid string conversion errors like:

  ```ts
  const message = `${{ toString: '' }}`
  ```

  Causing the NodeJS process to crash when sending an unexpected Socket.io message like

  ```ts
  socket.emit('find', { toString: '' })
  ```

  ### Patches

  A fix has been released in

  - `v5.0.8` via #3241
  - `v4.5.18` via #3242

  ### Workarounds

  Since it is in the core Socket handling code upgrading to the latest version is necessary.
  ### References

  - [v5.0.8 Changelog](https://github.com/feathersjs/feathers/blob/dove/CHANGELOG.md#508-2023-07-19)
  - [v4.5.18 Changelog](https://github.com/feathersjs/feathers/blob/crow/CHANGELOG.md#4518-2023-07-19)
impacted_packages:
  - purl: pkg:npm/%40feathersjs/socketio
    affected_versions: vers:npm/<=4.5.17
    fixed_versions: vers:npm/4.5.18
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40feathersjs/socketio
    affected_versions: vers:npm/<=5.0.7
    fixed_versions: vers:npm/5.0.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40feathersjs/transport-commons
    affected_versions: vers:npm/<=4.5.17
    fixed_versions: vers:npm/4.5.18
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40feathersjs/transport-commons
    affected_versions: vers:npm/<=5.0.7
    fixed_versions: vers:npm/5.0.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-hhr9-rh25-hvf9/GHSA-hhr9-rh25-hvf9.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-754
references:
  - url: https://github.com/feathersjs/feathers
    reference_type:
    reference_id:
  - url: https://github.com/feathersjs/feathers/blob/crow/CHANGELOG.md#4518-2023-07-19
    reference_type:
    reference_id:
  - url: https://github.com/feathersjs/feathers/blob/dove/CHANGELOG.md#508-2023-07-19
    reference_type:
    reference_id:
  - url: https://github.com/feathersjs/feathers/commit/0b9a6b19b12ad05934e4c8bd9917448ed39d1ed8
    reference_type:
    reference_id:
  - url: https://github.com/feathersjs/feathers/commit/c397ab3a0cd184044ae4f73540549b30a396821c
    reference_type:
    reference_id:
  - url: https://github.com/feathersjs/feathers/pull/3241
    reference_type:
    reference_id:
  - url: https://github.com/feathersjs/feathers/pull/3242
    reference_type:
    reference_id:
  - url: https://github.com/feathersjs/feathers/security/advisories/GHSA-hhr9-rh25-hvf9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-37899
    reference_type:
    reference_id: CVE-2023-37899
