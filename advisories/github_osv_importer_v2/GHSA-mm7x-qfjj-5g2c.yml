advisory_id: GHSA-mm7x-qfjj-5g2c
datasource_id: github_osv_importer_v2/GHSA-mm7x-qfjj-5g2c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-mm7x-qfjj-5g2c/GHSA-mm7x-qfjj-5g2c.json
aliases: []
summary: |
  Ammonia incorrectly handles embedded SVG and MathML leading to mutation XSS after removal
  Affected versions of this crate did not correctly strip namespace-incompatible tags
  in certain situations, causing it to incorrectly account for differences between HTML,
  SVG, and MathML.

  This vulnerability only has an effect when the `svg` or `math` tag is allowed,
  because it relies on a tag being parsed as html during the cleaning process, but
  serialized in a way that causes in to be parsed as xml by the browser.

  Additionally, the application using this library must allow a tag that is parsed as raw text in HTML.
  These [elements] are:

  * title
  * textarea
  * xmp
  * iframe
  * noembed
  * noframes
  * plaintext
  * noscript
  * style
  * script

  Applications that do not explicitly allow any of these tags should not be affected, since none are allowed by default.

  [elements]: https://github.com/servo/html5ever/blob/57eb334c0ffccc6f88d563419f0fbeef6ff5741c/html5ever/src/tree_builder/rules.rs
impacted_packages: []
severities:
  - score: '1.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-mm7x-qfjj-5g2c/GHSA-mm7x-qfjj-5g2c.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/rust-ammonia/ammonia
    reference_type:
    reference_id:
  - url: https://github.com/rust-ammonia/ammonia/commit/de0297111a3a1273275b670960bcd47a0481718e
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2025-0071.html
    reference_type:
    reference_id:
