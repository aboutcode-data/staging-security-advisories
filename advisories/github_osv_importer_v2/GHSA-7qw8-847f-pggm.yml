advisory_id: GHSA-7qw8-847f-pggm
datasource_id: github_osv_importer_v2/GHSA-7qw8-847f-pggm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-7qw8-847f-pggm/GHSA-7qw8-847f-pggm.json
aliases:
  - CVE-2021-20291
summary: |
  Improper Locking in github.com/containers/storage
  A deadlock vulnerability was found in `github.com/containers/storage` in versions before 1.28.1. When a container image is processed, each layer is unpacked using `tar`. If one of those layers is not a valid `tar` archive this causes an error leading to an unexpected situation where the code indefinitely waits for the tar unpacked stream, which never finishes. An attacker could use this vulnerability to craft a malicious image, which when downloaded and stored by an application using containers/storage, would then cause a deadlock leading to a Denial of Service (DoS).
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-7qw8-847f-pggm/GHSA-7qw8-847f-pggm.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-667
  - CWE-400
references:
  - url: https://github.com/containers/storage
    reference_type:
    reference_id:
  - url: https://github.com/containers/storage/commit/306fcabc964470e4b3b87a43a8f6b7d698209ee1
    reference_type:
    reference_id:
  - url: https://github.com/containers/storage/pull/860
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/R5D7XL7FL24TWFMGQ3K2S72EOUSLZMKL
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SPYOHNG2Q7DCAQZMGYLMENLKALGDLG3X
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WX24EITRXVHDM5M223BVTJA2ODF2FSHI
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZNMB7O2UIXE34PGSCSOULGHPX5LIJBMM
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2021-0100
    reference_type:
    reference_id:
  - url: https://unit42.paloaltonetworks.com/cve-2021-20291
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1939485
    reference_type: bug
    reference_id: '1939485'
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-20291
    reference_type:
    reference_id: CVE-2021-20291
