advisory_id: GHSA-g9fw-9x87-rmrj
datasource_id: github_osv_importer_v2/GHSA-g9fw-9x87-rmrj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-g9fw-9x87-rmrj/GHSA-g9fw-9x87-rmrj.json
aliases:
  - CVE-2020-7020
summary: |
  Privilege Context Switching Error in Elasticsearch
  Elasticsearch versions before 6.8.13 and 7.9.2 contain a document disclosure flaw when Document or Field Level Security is used. Search queries do not properly preserve security permissions when executing certain complex queries. This could result in the search disclosing the existence of documents the attacker should not be able to view. This could result in an attacker gaining additional insight into potentially sensitive indices.
impacted_packages:
  - purl: pkg:maven/org.elasticsearch/elasticsearch
    affected_versions: vers:maven/<6.8.13
    fixed_versions: vers:maven/6.8.13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.elasticsearch/elasticsearch
    affected_versions: vers:maven/>=7.0.0|<7.9.2
    fixed_versions: vers:maven/7.9.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-g9fw-9x87-rmrj/GHSA-g9fw-9x87-rmrj.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
  - CWE-270
references:
  - url: https://discuss.elastic.co/t/elastic-stack-7-9-3-and-6-8-13-security-update/253033
    reference_type:
    reference_id:
  - url: https://github.com/elastic/elasticsearch
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20201123-0001
    reference_type:
    reference_id:
  - url: https://staging-website.elastic.co/community/security
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-7020
    reference_type:
    reference_id: CVE-2020-7020
