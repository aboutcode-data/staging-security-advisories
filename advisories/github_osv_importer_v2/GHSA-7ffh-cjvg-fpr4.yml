advisory_id: GHSA-7ffh-cjvg-fpr4
datasource_id: github_osv_importer_v2/GHSA-7ffh-cjvg-fpr4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7ffh-cjvg-fpr4/GHSA-7ffh-cjvg-fpr4.json
aliases:
  - CVE-2017-6931
summary: |
  Drupal Settings Tray access bypass
  In Drupal versions 8.4.x versions before 8.4.5 the Settings Tray module has a vulnerability that allows users to update certain data that they do not have the permissions for. If you have implemented a Settings Tray form in contrib or a custom module, the correct access checks should be added. This release fixes the only two implementations in core, but does not harden against other such bypasses. This vulnerability can be mitigated by disabling the Settings Tray module.
impacted_packages:
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/>=8.4.0|<8.4.5
    fixed_versions: vers:composer/8.4.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/drupal/drupal
    affected_versions: vers:composer/>=8.4.0|<8.4.5
    fixed_versions: vers:composer/8.4.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-7ffh-cjvg-fpr4/GHSA-7ffh-cjvg-fpr4.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://github.com/drupal/core
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/core/CVE-2017-6931.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/drupal/CVE-2017-6931.yaml
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2018-001
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-6931
    reference_type:
    reference_id: CVE-2017-6931
