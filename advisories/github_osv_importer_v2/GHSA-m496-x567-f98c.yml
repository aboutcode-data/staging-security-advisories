advisory_id: GHSA-m496-x567-f98c
datasource_id: github_osv_importer_v2/GHSA-m496-x567-f98c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-m496-x567-f98c/GHSA-m496-x567-f98c.json
aliases:
  - CVE-2021-21426
summary: |
  Fixes a bug in Zend Framework's Stream HTTP Wrapper
  ### Impact
  CVE-2021-3007: Backport of Zend_Http_Response_Stream, added certain type checking as a way to prevent exploitation. https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3007

  This vulnerability is caused by the unsecured deserialization of an object. In versions higher than Zend Framework 3.0.0, the attacker abuses the Zend3 feature that loads classes from objects in order to upload and execute malicious code in the server. The code can be uploaded using the “callback” parameter, which in this case inserts a malicious code instead of the “callbackOptions” array.


  ### Patches
  _Has the problem been patched? What versions should users upgrade to?_
  v20.0.9 v19.4.13
impacted_packages:
  - purl: pkg:composer/openmage/magento-lts
    affected_versions: vers:composer/<=19.4.12
    fixed_versions: vers:composer/19.4.13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/openmage/magento-lts
    affected_versions: vers:composer/<=20.0.8
    fixed_versions: vers:composer/20.0.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-m496-x567-f98c/GHSA-m496-x567-f98c.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://github.com/OpenMage/magento-lts/security/advisories/GHSA-m496-x567-f98c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21426
    reference_type:
    reference_id: CVE-2021-21426
