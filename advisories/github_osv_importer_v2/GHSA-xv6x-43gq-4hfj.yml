advisory_id: GHSA-xv6x-43gq-4hfj
datasource_id: github_osv_importer_v2/GHSA-xv6x-43gq-4hfj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-xv6x-43gq-4hfj/GHSA-xv6x-43gq-4hfj.json
aliases:
  - CVE-2009-2940
summary: |
  PyGreSQL Might Be Vulnerable to Encoding-Based SQL Injection
  PyGreSQL 3.8 did not use PostgreSQL’s safe `string` and `bytea` functions in its own escaping functions. As a result, applications written to use PyGreSQL’s escaping functions are vulnerable to SQL injections when processing certain multi-byte character sequences. Because the safe functions require a database connection, to maintain backwards compatibility, `pg.escape_string()` and `pg.escape_bytea()` are still available, but applications will have to be adjusted to use the new `pyobj.escape_string()` and `pyobj.escape_bytea()` functions. For example, code containing:

  ```python
  import pg
  connection = pg.connect(...)
  escaped = pg.escape_string(untrusted_input)
  ```
  should be adjusted to use:

  ```python
  import pg
  connection = pg.connect(...)
  escaped = connection.escape_string(untrusted_input)
  ```
impacted_packages:
  - purl: pkg:pypi/pygresql
    affected_versions: vers:pypi/<=3.8.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/pygresql
    affected_versions: vers:pypi/4.0
    fixed_versions: vers:pypi/4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/PyGreSQL/PyGreSQL
    reference_type:
    reference_id:
  - url: https://github.com/PyGreSQL/PyGreSQL/commit/8e19320b130946eed6f043297e3e4e005a523612
    reference_type:
    reference_id:
  - url: https://github.com/PyGreSQL/PyGreSQL/commit/f7237d773e6f4d5a7da3d99bb6bc5062bd07935e
    reference_type:
    reference_id:
  - url: http://ubuntu.com/usn/usn-870-1
    reference_type:
    reference_id:
  - url: http://www.debian.org/security/2009/dsa-1911
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2009-2940
    reference_type:
    reference_id: CVE-2009-2940
