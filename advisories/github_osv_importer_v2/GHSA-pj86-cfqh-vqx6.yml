advisory_id: GHSA-pj86-cfqh-vqx6
datasource_id: github_osv_importer_v2/GHSA-pj86-cfqh-vqx6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-pj86-cfqh-vqx6/GHSA-pj86-cfqh-vqx6.json
aliases:
  - CVE-2024-51999
summary: "Withdrawn Advisory: express improperly controls modification of query properties\n\
  ## Withdrawn Advisory\nThis advisory has been withdrawn because it describes a correctness\
  \ bug, not a vulnerability with real security impact. This link is maintained to preserve\
  \ external references.\n\n## Original Description\n### Impact\n\nwhen using the extended query\
  \ parser in express (`'query parser': 'extended'`), the `request.query` object inherits all\
  \ object prototype properties, but these properties can be overwritten by query string parameter\
  \ keys that match the property names\n\n> [!IMPORTANT]  \n> the extended query parser is the\
  \ default in express 4; this was changed in express 5 which by default uses the simple query\
  \ parser\n\n### Patches\n\nthe issue has been patched to ensure `request.query` is a plain\
  \ object so `request.query` no longer has object prototype properties. this brings the default\
  \ behavior of extended query parsing in line with express's default simple query parser\n\n\
  ### Workaround\n\nthis only impacts users using extended query parsing (`'query parser': 'extended'`),\
  \ which is the default in express 4, but not express 5.  all users are encouraged to upgrade\
  \ to the patched versions, but can otherwise work around this issue:\n\n#### provide `qs`\
  \ directly and specify `plainObjects: true`\n\n```js\napp.set('query parser',\n  function\
  \ (str) {\n    return qs.parse(str, {\n      plainObjects: true\n  });\n});\n```"
impacted_packages:
  - purl: pkg:npm/express
    affected_versions: vers:npm/<4.22.0
    fixed_versions: vers:npm/4.22.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/express
    affected_versions: vers:npm/>=5.0.0|<5.2.0
    fixed_versions: vers:npm/5.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-pj86-cfqh-vqx6/GHSA-pj86-cfqh-vqx6.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-915
references:
  - url: https://github.com/expressjs/express
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/express/commit/2f64f68c37c64ae333e41ff38032d21860f22255
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/express/releases/tag/4.22.0
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/express/releases/tag/v5.2.0
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/express/security/advisories/GHSA-pj86-cfqh-vqx6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-51999
    reference_type:
    reference_id: CVE-2024-51999
