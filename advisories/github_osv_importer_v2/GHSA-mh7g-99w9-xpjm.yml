advisory_id: GHSA-mh7g-99w9-xpjm
datasource_id: github_osv_importer_v2/GHSA-mh7g-99w9-xpjm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/10/GHSA-mh7g-99w9-xpjm/GHSA-mh7g-99w9-xpjm.json
aliases:
  - CVE-2017-12629
summary: Remote code execution occurs in Apache Solr before versions 5.5.5, 6.6.2 and 7.1.0
  by exploiting XXE in conjunction with use of a Config API add-listener command to reach the
  RunExecutableListener class. Elasticsearch, although it uses Lucene, is NOT vulnerable to
  this. Note that the XML external entity expansion vulnerability occurs in the XML Query Parser
  which is available, by default, for any query request with parameters deftype=xmlparser and
  can be exploited to upload malicious data to the /upload request handler or as Blind XXE using
  ftp wrapper in order to read arbitrary local files from the Solr server. Note also that the
  second vulnerability relates to remote code execution using the RunExecutableListener available
  on all affected versions of Solr
impacted_packages:
  - purl: pkg:maven/org.apache.solr/solr-core
    affected_versions: vers:maven/>=7.0.0|<7.1.0
    fixed_versions: vers:maven/7.1.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.solr/solr-core
    affected_versions: vers:maven/>=6.0.0|<6.6.2
    fixed_versions: vers:maven/6.6.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.solr/solr-core
    affected_versions: vers:maven/>=5.5.0|<5.5.5
    fixed_versions: vers:maven/5.5.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/10/GHSA-mh7g-99w9-xpjm/GHSA-mh7g-99w9-xpjm.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: http://mail-archives.us.apache.org/mod_mbox/www-announce/201710.mbox/%3CCAOOKt51UO_6Vy%3Dj8W%3Dx1pMbLW9VJfZyFWz7pAnXJC_OAdSZubA%40mail.gmail.com%3E
    reference_type:
    reference_id:
  - url: http://openwall.com/lists/oss-security/2017/10/13/1
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:0002
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:0003
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:0004
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:0005
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-mh7g-99w9-xpjm
    reference_type:
    reference_id:
  - url: https://github.com/apache/lucene
    reference_type:
    reference_id:
  - url: https://github.com/apache/lucene-solr/commit/3bba91131b5257e64b9d0a2193e1e32a145b2a2
    reference_type:
    reference_id:
  - url: https://github.com/apache/lucene-solr/commit/d8000beebfb13ba0b6e754f84c760e11592d8d1
    reference_type:
    reference_id:
  - url: https://github.com/apache/lucene-solr/commit/f9fd6e9e26224f26f1542224ce187e04c27b268
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/SOLR-11477
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r140128dc6bb4f4e0b6a39e962c7ca25a8cbc8e48ed766176c931fccc@%3Cusers.solr.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r26c996b068ef6c5e89aa59acb769025cfd343a08e63fbe9e7f3f720f@%3Coak-issues.jackrabbit.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r3da74965aba2b5f5744b7289ad447306eeb2940c872801819faa9314@%3Cusers.solr.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r95df34bb158375948da82b4dfe9a1b5d528572d586584162f8f5aeef@%3Cusers.solr.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2018/01/msg00028.html
    reference_type:
    reference_id:
  - url: https://s.apache.org/FJDl
    reference_type:
    reference_id:
  - url: https://twitter.com/ApacheSolr/status/918731485611401216
    reference_type:
    reference_id:
  - url: https://twitter.com/joshbressers/status/919258716297420802
    reference_type:
    reference_id:
  - url: https://twitter.com/searchtools_avi/status/918904813613543424
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4259-1
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2018/dsa-4124
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/43009
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/101261
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-12629
    reference_type:
    reference_id: CVE-2017-12629
  - url: https://access.redhat.com/errata/RHSA-2017:3123
    reference_type:
    reference_id: RHSA-2017:3123
  - url: https://access.redhat.com/errata/RHSA-2017:3124
    reference_type:
    reference_id: RHSA-2017:3124
  - url: https://access.redhat.com/errata/RHSA-2017:3244
    reference_type:
    reference_id: RHSA-2017:3244
  - url: https://access.redhat.com/errata/RHSA-2017:3451
    reference_type:
    reference_id: RHSA-2017:3451
  - url: https://access.redhat.com/errata/RHSA-2017:3452
    reference_type:
    reference_id: RHSA-2017:3452
