advisory_id: GHSA-9m7c-m33f-3429
datasource_id: github_osv_importer_v2/GHSA-9m7c-m33f-3429
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-9m7c-m33f-3429/GHSA-9m7c-m33f-3429.json
aliases:
  - CVE-2025-58049
summary: |
  XWiki PDF export jobs store sensitive cookies unencrypted in job statuses
  ### Impact

  The PDF export uses a background job that runs on the server-side. Jobs like this have a status that is serialized in the permanent directory when the job is finished. The job status includes the job request. The PDF export job request is initialized, before the job starts, with some context information that is needed to replicate the HTTP request (used to trigger the export) in the background thread used to run the export job. This context information includes the cookies from the HTTP request that triggered the export. As a result, the user cookies (including the encrypted username and password) are stored in the permanent directory after the PDF export is finished. As the encryption key is stored in the same data directory (by default it is generated in ``data/configuration.properties``), this means that this job status contains the equivalent of the plain text password of the user who requested the PDF export.

  XWiki shouldn't store passwords in plain text, and it shouldn't be possible to gain access to plain text passwords by gaining access to, e.g., a backup of the data directory.

  ### Patches

  This vulnerability has been patched in XWiki 16.4.8, 16.10.7 and 17.4.0RC1.

  ### Workarounds

  We're not aware of any workarounds except for upgrading.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-export-pdf-api
    affected_versions: vers:maven/>=14.4.2|<16.4.8
    fixed_versions: vers:maven/16.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-export-pdf-api
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.10.7
    fixed_versions: vers:maven/16.10.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-export-pdf-api
    affected_versions: vers:maven/>=17.0.0-rc-1|<17.4.0-rc-1
    fixed_versions: vers:maven/17.4.0-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-9m7c-m33f-3429/GHSA-9m7c-m33f-3429.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-212
  - CWE-257
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/60982ad0057b1701ed8297f28cad35d170686539
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9m7c-m33f-3429
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-23151
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-58049
    reference_type:
    reference_id:
