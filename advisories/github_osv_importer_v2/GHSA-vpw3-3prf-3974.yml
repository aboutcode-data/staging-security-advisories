advisory_id: GHSA-vpw3-3prf-3974
datasource_id: github_osv_importer_v2/GHSA-vpw3-3prf-3974
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-vpw3-3prf-3974/GHSA-vpw3-3prf-3974.json
aliases:
  - CVE-2023-35701
summary: |
  Apache Hive Code Injection vulnerability
  Improper Control of Generation of Code ('Code Injection') vulnerability in Apache Hive.

  The vulnerability affects the Hive JDBC driver component and it can potentially lead to arbitrary code execution on the machine/endpoint that the JDBC driver (client) is running. The malicious user must have sufficient permissions to specify/edit JDBC URL(s) in an endpoint relying on the Hive JDBC driver and the JDBC client process must run under a privileged user to fully exploit the vulnerability.Â 

  The attacker can setup a malicious HTTP server and specify a JDBC URL pointing towards this server. When a JDBC connection is attempted, the malicious HTTP server can provide a special response with customized payload that can trigger the execution of certain commands in the JDBC client.This issue affects Apache Hive: from 4.0.0-alpha-1 before 4.0.0.

  Users are recommended to upgrade to version 4.0.0, which fixes the issue.
impacted_packages:
  - purl: pkg:maven/org.apache.hive/hive-jdbc
    affected_versions: vers:maven/>=4.0.0-alpha-1|<4.0.0
    fixed_versions: vers:maven/4.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-vpw3-3prf-3974/GHSA-vpw3-3prf-3974.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/apache/hive
    reference_type:
    reference_id:
  - url: https://github.com/apache/hive/commit/7abeb1df463cc389f668172e7cf3bb772799858a
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/HIVE-27554
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/7zcv6l63spl4r66xwz5jv9rtrg2opx81
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/05/03/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-35701
    reference_type:
    reference_id: CVE-2023-35701
