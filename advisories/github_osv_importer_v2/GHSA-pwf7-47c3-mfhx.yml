advisory_id: GHSA-pwf7-47c3-mfhx
datasource_id: github_osv_importer_v2/GHSA-pwf7-47c3-mfhx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-pwf7-47c3-mfhx/GHSA-pwf7-47c3-mfhx.json
aliases: []
summary: |
  j178/prek-action vulnerable to arbitrary code injection in composite action
  ### Summary
  There are three potential attacks of arbitrary code injection vulnerability in the composite action at _action.yml_.

  ### Details
  The GitHub Action variables `inputs.prek-version`, `inputs.extra_args`, and `inputs.extra-args` can be used to execute arbitrary code in the context of the action.

  ### PoC
  ```yaml
  - uses: j178/prek-action@v1.0.5
    with:
      prek-version: $(printenv >> $GITHUB_STEP_SUMMARY && echo "0.2.2")
      extra_args: '&& echo "MY_SECRET with a character is: ${MY_SECRET:0:1}a${MY_SECRET:1}" >> $GITHUB_STEP_SUMMARY && echo ""'
    env:
      MY_SECRET: ${{ secrets.MY_SECRET }}
  ```

  The previous example will print all the environment variables, and it will expose `MY_SECRET` environment variable value to the summary of the workflow. An attacker could potentially use this vector to compromise the security of the target repository, even passing unnotice because the action will run normally.

  ### Impact
  Critical, CWE-94
impacted_packages: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-pwf7-47c3-mfhx/GHSA-pwf7-47c3-mfhx.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/j178/prek-action
    reference_type:
    reference_id:
  - url: https://github.com/j178/prek-action/commit/6b7c6ef5c3875c766893b881b40773cd5605bde3
    reference_type:
    reference_id:
  - url: https://github.com/j178/prek-action/security/advisories/GHSA-pwf7-47c3-mfhx
    reference_type:
    reference_id:
