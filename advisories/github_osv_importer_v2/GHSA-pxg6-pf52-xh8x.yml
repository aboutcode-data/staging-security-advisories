advisory_id: GHSA-pxg6-pf52-xh8x
datasource_id: github_osv_importer_v2/GHSA-pxg6-pf52-xh8x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-pxg6-pf52-xh8x/GHSA-pxg6-pf52-xh8x.json
aliases:
  - CVE-2024-47764
summary: |
  cookie accepts cookie name, path, and domain with out of bounds characters
  ### Impact

  The cookie name could be used to set other fields of the cookie, resulting in an unexpected cookie value. For example, `serialize("userName=<script>alert('XSS3')</script>; Max-Age=2592000; a", value)` would result in `"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a=test"`, setting `userName` cookie to `<script>` and ignoring `value`.

  A similar escape can be used for `path` and `domain`, which could be abused to alter other fields of the cookie.

  ### Patches

  Upgrade to 0.7.0, which updates the validation for `name`, `path`, and `domain`.

  ### Workarounds

  Avoid passing untrusted or arbitrary values for these fields, ensure they are set by the application instead of user input.

  ### References

  * https://github.com/jshttp/cookie/pull/167
impacted_packages:
  - purl: pkg:npm/cookie
    affected_versions: vers:npm/<0.7.0
    fixed_versions: vers:npm/0.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-74
references:
  - url: https://github.com/jshttp/cookie
    reference_type:
    reference_id:
  - url: https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c
    reference_type:
    reference_id:
  - url: https://github.com/jshttp/cookie/pull/167
    reference_type:
    reference_id:
  - url: https://github.com/jshttp/cookie/security/advisories/GHSA-pxg6-pf52-xh8x
    reference_type:
    reference_id:
