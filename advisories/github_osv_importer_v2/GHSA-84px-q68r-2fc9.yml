advisory_id: GHSA-84px-q68r-2fc9
datasource_id: github_osv_importer_v2/GHSA-84px-q68r-2fc9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-84px-q68r-2fc9/GHSA-84px-q68r-2fc9.json
aliases:
  - CVE-2021-43835
summary: |
  Privilege escalation in the Sulu Admin panel
  ### Impact

  Impacted are only users which already have access to the admin UI. Over the API it was possible for them to give themselves permissions to areas which they did not already had. This issue was introduced in 2.0.0-RC1 with the new ProfileController putAction.

  ### Patches

  The versions have been patched in 2.2.18, 2.3.8 and 2.4.0.

  ### Workarounds

  Patching the ProfileController of affected sulu versions yourself by overwriting it.

  ### References

  _Are there any links users can visit to find out more?_

  Currently not.

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [sulu/sulu repo](https://github.com/sulu/sulu/issues)
  * Email us at [security@sulu.io](mailto:security@sulu.io)
impacted_packages:
  - purl: pkg:composer/sulu/sulu
    affected_versions: vers:composer/<=2.2.17
    fixed_versions: vers:composer/2.2.18
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sulu/sulu
    affected_versions: vers:composer/<=2.3.7
    fixed_versions: vers:composer/2.3.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sulu/sulu
    affected_versions: vers:composer/2.4.0-RC1
    fixed_versions: vers:composer/2.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-84px-q68r-2fc9/GHSA-84px-q68r-2fc9.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/sulu/sulu
    reference_type:
    reference_id:
  - url: https://github.com/sulu/sulu/commit/30bf8b5a4f83b6f2171a696011757d095edaa28a
    reference_type:
    reference_id:
  - url: https://github.com/sulu/sulu/security/advisories/GHSA-84px-q68r-2fc9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43835
    reference_type:
    reference_id: CVE-2021-43835
