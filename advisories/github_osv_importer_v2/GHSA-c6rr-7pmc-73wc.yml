advisory_id: GHSA-c6rr-7pmc-73wc
datasource_id: github_osv_importer_v2/GHSA-c6rr-7pmc-73wc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-c6rr-7pmc-73wc/GHSA-c6rr-7pmc-73wc.json
aliases:
  - CVE-2026-22866
summary: |
  ENS DNSSEC Oracle Vulnerable to RSA Signature Forgery via Missing PKCS#1 v1.5 Padding Validation
  ### Impact

  The `RSASHA256Algorithm` and `RSASHA1Algorithm` contracts fail to validate PKCS#1 v1.5 padding structure when verifying RSA signatures. The contracts only check if the last 32 (or 20) bytes of the decrypted signature match the expected hash. This enables Bleichenbacher's 2006 signature forgery attack against DNS zones using RSA keys with low public exponents (e=3). Two ENS-supported TLDs (.cc and .name) use e=3 for their Key Signing Keys, allowing any domain under these TLDs to be fraudulently claimed on ENS without DNS ownership.

  Affected contracts

  Contract | Address | Status
  -- | -- | --
  RSASHA256Algorithm | 0x9D1B5a639597f558bC37Cf81813724076c5C1e96 | Vulnerable
  RSASHA1Algorithm | 0x6ca8624Bc207F043D140125486De0f7E624e37A1 | Vulnerable
  DNSSECImpl | 0x0fc3152971714E5ed7723FAFa650F86A4BaF30C5 | Uses vulnerable algorithms
  DNSRegistrar | 0xB32cB5677a7C971689228EC835800432B339bA2B | Attack entry point




  ### Patches

  The bug was reported via Immunefi with possible solutions. The patch was merged at https://github.com/ensdomains/ens-contracts/commit/c76c5ad0dc9de1c966443bd946fafc6351f87587


  ### Workarounds

  - Deploy the patched contracts
  - Point DNSSECImpl.setAlgorithm to the deployed contract

  ### Resources

  https://github.com/ensdomains/ens-contracts-bug-62248-pr-509
impacted_packages:
  - purl: pkg:npm/%40ensdomains/ens-contracts
    affected_versions: vers:npm/<=1.6.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-c6rr-7pmc-73wc/GHSA-c6rr-7pmc-73wc.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-347
references:
  - url: https://github.com/ensdomains/ens-contracts
    reference_type:
    reference_id:
  - url: https://github.com/ensdomains/ens-contracts-bug-62248-pr-509
    reference_type:
    reference_id:
  - url: https://github.com/ensdomains/ens-contracts/commit/c76c5ad0dc9de1c966443bd946fafc6351f87587
    reference_type:
    reference_id:
  - url: https://github.com/ensdomains/ens-contracts/security/advisories/GHSA-c6rr-7pmc-73wc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22866
    reference_type:
    reference_id: CVE-2026-22866
