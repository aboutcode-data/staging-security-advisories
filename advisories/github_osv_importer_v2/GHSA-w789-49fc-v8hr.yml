advisory_id: GHSA-w789-49fc-v8hr
datasource_id: github_osv_importer_v2/GHSA-w789-49fc-v8hr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-w789-49fc-v8hr/GHSA-w789-49fc-v8hr.json
aliases:
  - CVE-2026-27818
summary: |
  TerriaJS-Server has a domain validation bypass vulnerability in its proxy allowlist
  ### Impact
  A validation bug allows an attacker to proxy domains not explicitly allowed in the `proxyableDomains` configuration.

  The validation only checks if a hostname _ended_ with an allowed domain. This meant:

  If `example.com` is allowed in `proxyableDomains`:

  - ✅ example.com is allowed (correct)
  - ✅ api.example.com is allowed (correct)
  - ⚠️ maliciousexample.com is allowed (incorrect)

  An attacker could register maliciousexample.com and proxy content through `terriajs-server`, bypassing proxy restrictions.

  ### Patches
  All versions up to 4.0.2 are affected. Upgrade to 4.0.3 to address the vulnerability.
impacted_packages:
  - purl: pkg:npm/terriajs-server
    affected_versions: vers:npm/<4.0.3
    fixed_versions: vers:npm/4.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-w789-49fc-v8hr/GHSA-w789-49fc-v8hr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-918
references:
  - url: https://github.com/TerriaJS/terriajs-server
    reference_type:
    reference_id:
  - url: https://github.com/TerriaJS/terriajs-server/commit/3aaa5d9717162b245ae4569232bbe7d8673c913f
    reference_type:
    reference_id:
  - url: https://github.com/TerriaJS/terriajs-server/releases/tag/4.0.3
    reference_type:
    reference_id:
  - url: https://github.com/TerriaJS/terriajs-server/security/advisories/GHSA-w789-49fc-v8hr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-27818
    reference_type:
    reference_id: CVE-2026-27818
