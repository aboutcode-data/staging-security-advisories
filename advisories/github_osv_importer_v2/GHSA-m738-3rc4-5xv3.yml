advisory_id: GHSA-m738-3rc4-5xv3
datasource_id: github_osv_importer_v2/GHSA-m738-3rc4-5xv3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/07/GHSA-m738-3rc4-5xv3/GHSA-m738-3rc4-5xv3.json
aliases:
  - CVE-2021-32729
summary: |
  A user without PR can reset user authentication failures information
  ### Impact
  The script service method used to reset the authentication failures record can be executed by any user with Script rights and does not require Programming rights as it should have.
  Note that being able to reset the authentication failure record mean that an attacker with script right might use it to try performing a bruteforce attack since she'd been able to virtually deactivate the mechanism introduced to mitigate those attacks.

  ### Patches
  The problem has been patched in version 12.6.8, 12.10.4 and 13.0.

  ### Workarounds
  There's no workaround besides upgrading and being careful on which user should have Script right access. Note that any bruteforce attack on the authentication should be visible in the logs since the authentication failures are logged.

  ### References
  https://jira.xwiki.org/browse/XWIKI-18276

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [Jira](http://jira.xwiki.org)
  * Email us at [the security mailing-list](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security-authentication-script
    affected_versions: vers:maven/>=11.6|<12.6.8
    fixed_versions: vers:maven/12.6.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security-authentication-script
    affected_versions: vers:maven/>=12.7|<12.10.4
    fixed_versions: vers:maven/12.10.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/07/GHSA-m738-3rc4-5xv3/GHSA-m738-3rc4-5xv3.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-693
  - CWE-732
  - CWE-287
references:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-m738-3rc4-5xv3
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-18276
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32729
    reference_type:
    reference_id: CVE-2021-32729
