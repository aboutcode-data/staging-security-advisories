advisory_id: GHSA-x6jx-cxg3-mggh
datasource_id: github_osv_importer_v2/GHSA-x6jx-cxg3-mggh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-x6jx-cxg3-mggh/GHSA-x6jx-cxg3-mggh.json
aliases:
  - CVE-2019-1003002
summary: |
  Jenkins Pipeline Declarative Plugin sandbox bypass vulnerability
  Jenkins Script Security sandbox protection could be circumvented during the script compilation phase by applying AST transforming annotations such as `@Grab` to source code elements.

  Both the pipeline validation REST APIs and actual script/pipeline execution are affected.

  This allowed users with Overall/Read permission, or able to control Jenkinsfile or sandboxed Pipeline shared library contents in SCM, to bypass the sandbox protection and execute arbitrary code on the Jenkins controller.

  All known unsafe AST transformations in Groovy are now prohibited in sandboxed scripts.
impacted_packages:
  - purl: pkg:maven/org.jenkinsci.plugins/pipeline-model-definition
    affected_versions: vers:maven/<=1.3.3
    fixed_versions: vers:maven/1.3.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-x6jx-cxg3-mggh/GHSA-x6jx-cxg3-mggh.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: http://packetstormsecurity.com/files/152132/Jenkins-ACL-Bypass-Metaprogramming-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHBA-2019:0326
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHBA-2019:0327
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/pipeline-model-definition-plugin/commit/083abd96e68fd89f556a0cd53db5f878dbf09b92
    reference_type:
    reference_id:
  - url: https://jenkins.io/security/advisory/2019-01-08/#SECURITY-1266
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/46572
    reference_type:
    reference_id:
  - url: http://www.rapid7.com/db/modules/exploit/multi/http/jenkins_metaprogramming
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-1003002
    reference_type:
    reference_id: CVE-2019-1003002
