advisory_id: GHSA-qj77-c3c8-9c3q
datasource_id: github_osv_importer_v2/GHSA-qj77-c3c8-9c3q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-qj77-c3c8-9c3q/GHSA-qj77-c3c8-9c3q.json
aliases: []
summary: |
  OpenClaw's Windows cmd.exe parsing may bypass exec allowlist/approval gating
  ### Summary

  On Windows nodes, exec requests were executed via `cmd.exe /d /s /c <rawCommand>`. In allowlist/approval-gated mode, the allowlist analysis did not model Windows `cmd.exe` parsing and metacharacter behavior. A crafted command string could cause `cmd.exe` to interpret additional operations (for example command chaining via `&`, or expansion via `%...%` / `!...!`) beyond what was allowlisted/approved.

  ### Affected Packages / Versions

  - Package: `openclaw` (npm)
  - Affected: `<= 2026.2.1`
  - Patched: `>= 2026.2.2`
  - Latest (npm) as of 2026-02-14: `2026.2.13`

  ### Details

  - Default installs: Not affected unless you opt into exec allowlist/approval gating on Windows nodes.
  - Windows execution uses `cmd.exe` via `src/infra/node-shell.ts`.
  - The fix hardens Windows allowlist enforcement by:
    - Passing the platform into allowlist analysis and rejecting Windows shell metacharacters.
    - Treating `cmd.exe` invocation as not allowlist-safe on Windows.
    - Avoiding `cmd.exe` entirely in allowlist mode by executing the parsed argv directly when possible.

  ### Fix Commit(s)

  - `a7f4a53ce80c98ba1452eb90802d447fca9bf3d6`

  Thanks @simecek for reporting.
impacted_packages:
  - purl: pkg:npm/openclaw
    affected_versions: vers:npm/<2026.2.2
    fixed_versions: vers:npm/2026.2.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-qj77-c3c8-9c3q/GHSA-qj77-c3c8-9c3q.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/openclaw/openclaw
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/commit/a7f4a53ce80c98ba1452eb90802d447fca9bf3d6
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/releases/tag/v2026.2.2
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/security/advisories/GHSA-qj77-c3c8-9c3q
    reference_type:
    reference_id:
