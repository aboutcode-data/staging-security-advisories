advisory_id: GHSA-5fg8-2547-mr8q
datasource_id: github_osv_importer_v2/GHSA-5fg8-2547-mr8q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-5fg8-2547-mr8q/GHSA-5fg8-2547-mr8q.json
aliases:
  - CVE-2021-32796
summary: |
  Misinterpretation of malicious XML input
  ### Impact
  xmldom versions 0.6.0 and older do not correctly escape special characters when serializing elements removed from their ancestor. This may lead to unexpected syntactic changes during XML processing in some downstream applications.

  ### Patches
  Update to one of the fixed versions of `@xmldom/xmldom` (`>=0.7.0`)

  See issue #271 for the status of publishing `xmldom` to npm or join #270 for Q&A/discussion until it's resolved.

  ### Workarounds

  Downstream applications can validate the input and reject the maliciously crafted documents.

  ### References

  Similar to this one reported on the Go standard library:

  - https://mattermost.com/blog/coordinated-disclosure-go-xml-vulnerabilities/
  - https://mattermost.com/blog/securing-xml-implementations-across-the-web/

  ### For more information

  If you have any questions or comments about this advisory:

  * Open an issue in [`xmldom/xmldom`](https://github.com/xmldom/xmldom)
  * Email us: send an email to **all** addresses that are shown by `npm owner ls @xmldom/xmldom`
impacted_packages:
  - purl: pkg:npm/xmldom
    affected_versions: vers:npm/<=0.6.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40xmldom/xmldom
    affected_versions: vers:npm/<0.7.0
    fixed_versions: vers:npm/0.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-5fg8-2547-mr8q/GHSA-5fg8-2547-mr8q.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-116
references:
  - url: https://github.com/xmldom/xmldom
    reference_type:
    reference_id:
  - url: https://github.com/xmldom/xmldom/commit/7b4b743917a892d407356e055b296dcd6d107e8b
    reference_type:
    reference_id:
  - url: https://github.com/xmldom/xmldom/security/advisories/GHSA-5fg8-2547-mr8q
    reference_type:
    reference_id:
  - url: https://mattermost.com/blog/coordinated-disclosure-go-xml-vulnerabilities
    reference_type:
    reference_id:
  - url: https://mattermost.com/blog/securing-xml-implementations-across-the-web
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/@xmldom/xmldom
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32796
    reference_type:
    reference_id: CVE-2021-32796
