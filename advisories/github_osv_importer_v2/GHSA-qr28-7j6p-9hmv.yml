advisory_id: GHSA-qr28-7j6p-9hmv
datasource_id: github_osv_importer_v2/GHSA-qr28-7j6p-9hmv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/11/GHSA-qr28-7j6p-9hmv/GHSA-qr28-7j6p-9hmv.json
aliases:
  - CVE-2017-1000042
summary: |
  Content Injection via TileJSON attribute in mapbox.js
  Versions 1.x prior to 1.6.5 and 2.x prior to 2.1.7 of `mapbox.js` are vulnerable to a cross-site-scripting attack in certain uncommon usage scenarios.

  If `L.mapbox.map` or `L.mapbox.tileLayer` are used to load untrusted TileJSON content from a non-Mapbox URL, it is possible for a malicious user with control over the TileJSON content to inject script content into the "attribution" value of the TileJSON which will be executed in the context of the page using Mapbox.js.



  ## Recommendation

  Version 2.x: Update to version 2.1.7 or later.
  Version 1.x: Update to version 1.6.5 or later.
impacted_packages:
  - purl: pkg:npm/mapbox.js
    affected_versions: vers:npm/<1.6.5
    fixed_versions: vers:npm/1.6.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/mapbox.js
    affected_versions: vers:npm/>=2.0.0|<2.1.7
    fixed_versions: vers:npm/2.1.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/mapbox-rails
    affected_versions: vers:gem/>=1.0.0|<1.6.5
    fixed_versions: vers:gem/1.6.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/mapbox-rails
    affected_versions: vers:gem/>=2.0.0|<2.1.7
    fixed_versions: vers:gem/2.1.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/11/GHSA-qr28-7j6p-9hmv/GHSA-qr28-7j6p-9hmv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/advisories/GHSA-qr28-7j6p-9hmv
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/mapbox-rails/CVE-2017-1000042.yml
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/54327
    reference_type:
    reference_id:
  - url: https://nodesecurity.io/advisories/49
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/49
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-1000042
    reference_type:
    reference_id: CVE-2017-1000042
