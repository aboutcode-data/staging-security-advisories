advisory_id: GHSA-ccr8-4xr7-cgj3
datasource_id: github_osv_importer_v2/GHSA-ccr8-4xr7-cgj3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-ccr8-4xr7-cgj3/GHSA-ccr8-4xr7-cgj3.json
aliases:
  - CVE-2020-2279
summary: |
  Sandbox bypass vulnerability in Jenkins Script Security Plugin
  Jenkins Script Security Plugin provides a sandbox feature that allows low privileged users to define scripts, including Pipelines, that are generally safe to execute. Calls to code defined inside a sandboxed script are intercepted, and various allowlists are checked to determine whether the call is to be allowed.

  In Script Security Plugin 1.75 and 1.66.5, any calls from outside a sandboxed script to code defined inside a sandboxed script were always allowed. As sandboxed scripts can communicate their results through script return values and similar mechanisms, this could result in code defined inside of a sandboxed script to be called without sandbox protection.

  This vulnerability allows attackers with permission to define and run sandboxed scripts, including Pipelines, to bypass the sandbox protection and execute arbitrary code in the context of the Jenkins controller JVM.

  Script Security Plugin 1.75 and 1.66.5 will prevent code defined inside a sandbox from being invoked outside a sandboxed script.

  In rare cases, invocations of sandboxed scripts may begin failing if the script return value or script binding include code defined in the sandbox and is further processed by the calling code. To resolve this issue, the affected values need to be converted inside the sandboxed script to a known safe type, such as `String`.

  For compatibility with this change, the following plugins should be upgraded to the versions specified:
  - [Email Extension Plugin](https://plugins.jenkins.io/email-ext) should be updated to version 2.77 or newer.
  - [Warnings Next Generation Plugin](https://plugins.jenkins.io/warnings-ng) should be updated to version 8.4.3 or newer.
  - [Warnings Plugin](https://plugins.jenkins.io/warnings) should be updated to version 5.0.2 or newer.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/script-security
    affected_versions: vers:maven/>=1.67|<1.75
    fixed_versions: vers:maven/1.75
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.plugins/script-security
    affected_versions: vers:maven/<1.66.5
    fixed_versions: vers:maven/1.66.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-ccr8-4xr7-cgj3/GHSA-ccr8-4xr7-cgj3.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-693
references:
  - url: https://github.com/CVEProject/cvelist/blob/16860a328d970faa6e4350b0fa446f64a52e52ca/2020/2xxx/CVE-2020-2279.json
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/script-security-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/script-security-plugin/commit/79d1e9207c5c359ca779b92f0a290e18c5e2387b
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2020-09-23/#SECURITY-2020
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2020/09/23/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-2279
    reference_type:
    reference_id: CVE-2020-2279
