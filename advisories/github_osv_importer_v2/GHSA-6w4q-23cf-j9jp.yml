advisory_id: GHSA-6w4q-23cf-j9jp
datasource_id: github_osv_importer_v2/GHSA-6w4q-23cf-j9jp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-6w4q-23cf-j9jp/GHSA-6w4q-23cf-j9jp.json
aliases:
  - CVE-2022-39225
summary: |
  parse-server's session object properties can be updated by foreign user if object ID is known
  ### Impact

  A foreign user can write to the session object of another user if the session object ID is known. For example, a foreign user can assign the session object to their own user by writing to the `user` field and then read any custom fields of that session object.

  Note that assigning a session to a foreign user does not usually change the privileges of neither of the two users, according to how Parse Server uses session objects internally. However, if custom logic is used to relate specific session objects to privileges this vulnerability may have a higher level of severity.

  The vulnerability does not allow a foreign user to assign a session object to themselves, read the session token, and then reassign the session object to the original user to then authenticate as that user with the known session token. The vulnerability only exists for foreign session objects, a user cannot assign their own session to another user.

  While it is unlikely that the session object ID of another user is known, it is possible to brute-force guess an object ID, even though the attacker would not know to which user a successfully guessed session object ID belongs.

  ### Patches

  The fix prevents writing to foreign session objects, even if the session object ID is known.

  ### Workarounds

  Add a `beforeSave` trigger to the `_Session` class and prevent writing if the requesting user is different from the user in the session object.

  ### References

  - GitHub advisory [GHSA-6w4q-23cf-j9jp](https://github.com/parse-community/parse-server/security/advisories/GHSA-6w4q-23cf-j9jp)
impacted_packages:
  - purl: pkg:npm/parse-server
    affected_versions: vers:npm/<4.10.15
    fixed_versions: vers:npm/4.10.15
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/parse-server
    affected_versions: vers:npm/>=5.0.0|<5.2.6
    fixed_versions: vers:npm/5.2.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-6w4q-23cf-j9jp/GHSA-6w4q-23cf-j9jp.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-276
  - CWE-669
references:
  - url: https://github.com/parse-community/parse-server
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/commit/37fed3062ccc3ef1dfd49a9fc53318e72b3e4aff
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/releases/tag/4.10.15
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/releases/tag/5.2.6
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/security/advisories/GHSA-6w4q-23cf-j9jp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39225
    reference_type:
    reference_id: CVE-2022-39225
