advisory_id: GHSA-77hf-23pq-2g7c
datasource_id: github_osv_importer_v2/GHSA-77hf-23pq-2g7c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-77hf-23pq-2g7c/GHSA-77hf-23pq-2g7c.json
aliases:
  - CVE-2022-33140
summary: |
  Code injection in Apache NiFi and NiFi Registry
  The optional ShellUserGroupProvider in Apache NiFi 1.10.0 to 1.16.2 and Apache NiFi Registry 0.6.0 to 1.16.2 does not neutralize arguments for group resolution commands, allowing injection of operating system commands on Linux and macOS platforms. The ShellUserGroupProvider is not included in the default configuration. Command injection requires ShellUserGroupProvider to be one of the enabled User Group Providers in the Authorizers configuration. Command injection also requires an authenticated user with elevated privileges. Apache NiFi requires an authenticated user with authorization to modify access policies in order to execute the command. Apache NiFi Registry requires an authenticated user with authorization to read user groups in order to execute the command. The resolution removes command formatting based on user-provided arguments.
impacted_packages:
  - purl: pkg:maven/org.apache.nifi.registry/nifi-registry-core
    affected_versions: vers:maven/>=0.6.0|<1.16.3
    fixed_versions: vers:maven/1.16.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.nifi/nifi
    affected_versions: vers:maven/>=1.10.0|<1.16.3
    fixed_versions: vers:maven/1.16.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-77hf-23pq-2g7c/GHSA-77hf-23pq-2g7c.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
  - CWE-74
references:
  - url: https://github.com/apache/nifi
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/bzs2pcdjsdrh5039oslmfr9mbs9qqdhr
    reference_type:
    reference_id:
  - url: https://nifi.apache.org/security.html#CVE-2022-33140
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-33140
    reference_type:
    reference_id: CVE-2022-33140
