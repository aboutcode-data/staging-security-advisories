advisory_id: GHSA-g4m9-5hpf-hx72
datasource_id: github_osv_importer_v2/GHSA-g4m9-5hpf-hx72
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/03/GHSA-g4m9-5hpf-hx72/GHSA-g4m9-5hpf-hx72.json
aliases:
  - CVE-2020-5275
summary: "Firewall configured with unanimous strategy was not actually unanimous in Symfony\n\
  Description\n-----------\n\nOn Symfony before 4.4.0, when a `Firewall` checks an access control\
  \ rule (using the unanimous strategy), it iterates over all rule attributes and grant access\
  \ only if *all* calls to the `accessDecisionManager` decide to grant access.\n\nAs of Symfony\
  \ 4.4.0, a bug was introduced that prevents the check of attributes as soon as `accessDecisionManager`\
  \ decide to grant access on one attribute.\n\nResolution\n----------\n\nThe `accessDecisionManager`\
  \ is now called with all attributes at once, allowing the unanimous strategy being applied\
  \ on each attribute. \n\nThe patch for this issue is available [here](https://github.com/symfony/symfony/commit/c935e4a3fba6cc2ab463a6ca382858068d63cebf)\
  \ for the 4.4 branch.\n\nCredits\n-------\n\nI would like to thank Antonio J. GarcÃ­a Lagar\
  \ for reporting & Robin Chalas for fixing the issue."
impacted_packages:
  - purl: pkg:composer/symfony/security
    affected_versions: vers:composer/>=4.4.0|<4.4.7
    fixed_versions: vers:composer/4.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/security
    affected_versions: vers:composer/>=5.0.0|<5.0.7
    fixed_versions: vers:composer/5.0.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/security-http
    affected_versions: vers:composer/>=4.4.0|<4.4.7
    fixed_versions: vers:composer/4.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/security-http
    affected_versions: vers:composer/>=5.0.0|<5.0.7
    fixed_versions: vers:composer/5.0.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=4.4.0|<4.4.7
    fixed_versions: vers:composer/4.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=5.0.0|<5.0.7
    fixed_versions: vers:composer/5.0.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/03/GHSA-g4m9-5hpf-hx72/GHSA-g4m9-5hpf-hx72.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/security/CVE-2020-5275.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/security-http/CVE-2020-5275.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2020-5275.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/c935e4a3fba6cc2ab463a6ca382858068d63cebf
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/security/advisories/GHSA-g4m9-5hpf-hx72
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/C36JLPHUPKDFAX6D5WYFC4ALO2K7RDUQ
    reference_type:
    reference_id:
  - url: https://symfony.com/cve-2020-5275
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5275
    reference_type:
    reference_id: CVE-2020-5275
