advisory_id: GHSA-6xxr-648m-gch6
datasource_id: github_osv_importer_v2/GHSA-6xxr-648m-gch6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-6xxr-648m-gch6/GHSA-6xxr-648m-gch6.json
aliases:
  - CVE-2023-37277
summary: |
  XWiki Platform vulnerable to cross-site request forgery (CSRF) via the REST API
  ### Impact

  The REST API allows executing all actions via POST requests and accepts `text/plain`, `multipart/form-data` or `application/www-form-urlencoded` as content types which can be sent via regular HTML forms, thus allowing cross-site request forgery. With the interaction of a user with programming rights, this allows remote code execution through script macros and thus impacts the integrity, availability and confidentiality of the whole XWiki installation.

  For regular cookie-based authentication, the vulnerability is mitigated by SameSite cookie restrictions but as of March 2023, these are not enabled by default in Firefox and Safari.

  ### Patches
  The vulnerability has been patched in XWiki 14.10.8 and 15.2 by requiring a CSRF token header for certain request types that are susceptible to CSRF attacks.

  ### Workarounds

  It is possible to check for the `Origin` header in a reverse proxy to protect the REST endpoint from CSRF attacks, see [the Jira issue](https://jira.xwiki.org/browse/XWIKI-20135) for an example configuration.

  ### References

  * https://jira.xwiki.org/browse/XWIKI-20135
  * https://github.com/xwiki/xwiki-platform/commit/4c175405faa0e62437df397811c7526dfc0fbae7
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rest-server
    affected_versions: vers:maven/>=1.8|<14.10.8
    fixed_versions: vers:maven/14.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.xpn.xwiki.platform/xwiki-core-rest-server
    affected_versions: vers:maven/>=1.8|<14.10.8
    fixed_versions: vers:maven/14.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.xpn.xwiki.platform/xwiki-rest
    affected_versions: vers:maven/>=1.8|<14.10.8
    fixed_versions: vers:maven/14.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rest-server
    affected_versions: vers:maven/>=15.0-rc-1|<15.2
    fixed_versions: vers:maven/15.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-6xxr-648m-gch6/GHSA-6xxr-648m-gch6.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/4c175405faa0e62437df397811c7526dfc0fbae7
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-6xxr-648m-gch6
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20135
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-37277
    reference_type:
    reference_id: CVE-2023-37277
