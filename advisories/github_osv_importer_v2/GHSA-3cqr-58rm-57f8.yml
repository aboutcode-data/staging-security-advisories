advisory_id: GHSA-3cqr-58rm-57f8
datasource_id: github_osv_importer_v2/GHSA-3cqr-58rm-57f8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-3cqr-58rm-57f8/GHSA-3cqr-58rm-57f8.json
aliases:
  - CVE-2019-20920
summary: |
  Arbitrary Code Execution in Handlebars
  Handlebars before 3.0.8 and 4.x before 4.5.3 is vulnerable to Arbitrary Code Execution. The lookup helper fails to properly validate templates, allowing attackers to submit templates that execute arbitrary JavaScript. This can be used to run arbitrary code on a server processing Handlebars templates or in a victim's browser (effectively serving as XSS).
impacted_packages:
  - purl: pkg:npm/handlebars
    affected_versions: vers:npm/<3.0.8
    fixed_versions: vers:npm/3.0.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/handlebars
    affected_versions: vers:npm/>=4.0.0|<4.5.3
    fixed_versions: vers:npm/4.5.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-3cqr-58rm-57f8/GHSA-3cqr-58rm-57f8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/handlebars-lang/handlebars.js/commit/156061eb7707575293613d7fdf90e2bdaac029ee
    reference_type:
    reference_id:
  - url: https://github.com/handlebars-lang/handlebars.js/commit/d54137810a49939fd2ad01a91a34e182ece4528e
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-HANDLEBARS-534478
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1316
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1324
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/handlebars
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-20920
    reference_type:
    reference_id: CVE-2019-20920
