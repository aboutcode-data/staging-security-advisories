advisory_id: GHSA-376v-xgjx-7mfr
datasource_id: github_osv_importer_v2/GHSA-376v-xgjx-7mfr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-376v-xgjx-7mfr/GHSA-376v-xgjx-7mfr.json
aliases:
  - CVE-2022-31142
summary: |
  fastify-bearer-auth vulnerable to Timing Attack Vector
  ### Impact

  fastify-bearer-auth does not securely use crypto.timingSafeEqual. A malicious attacker could estimate the length of one valid bearer token. According to the corresponding RFC 6750, the bearer token has only base64 valid characters, reducing the range of characters for a brute force attack.

  All versions of fastify-bearer-auth are also affected.

  ### Patches

  We released:

  * v8.0.1 with a fix for the Fastify v4 line
  * v7.0.2 with a fix for the Fastify v3 line

  ### Workarounds

  There are no workarounds. Update your dependencies.

  ### References

  https://hackerone.com/reports/1633287

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [https://github.com/fastify/fastify-bearer-auth](https://github.com/fastify/fastify-bearer-auth)
  * Email us at [hello@matteocollina.com](mailto:hello@matteocollina.com)
impacted_packages:
  - purl: pkg:npm/fastify-bearer-auth
    affected_versions: vers:npm/>=5.0.1|<=6.0.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40fastify/bearer-auth
    affected_versions: vers:npm/<7.0.2
    fixed_versions: vers:npm/7.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40fastify/bearer-auth
    affected_versions: vers:npm/8.0.0
    fixed_versions: vers:npm/8.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-376v-xgjx-7mfr/GHSA-376v-xgjx-7mfr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-208
  - CWE-203
references:
  - url: https://github.com/fastify/fastify-bearer-auth
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth/commit/0c468a616d7e56126dc468150f6a5a92e530b8e4
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth/commit/39353b15409ee99474545f615ffb16180cf3b716
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth/commit/f921a0582dc83112039004a9b5041141b50c5b3f
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth/security/advisories/GHSA-376v-xgjx-7mfr
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1633287
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31142
    reference_type:
    reference_id: CVE-2022-31142
