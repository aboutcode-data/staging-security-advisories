advisory_id: GHSA-8q6v-474h-whgg
datasource_id: github_osv_importer_v2/GHSA-8q6v-474h-whgg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-8q6v-474h-whgg/GHSA-8q6v-474h-whgg.json
aliases:
  - CVE-2025-54885
summary: "The Thinbus Javascript Secure Remote Password (SRP) Client Generates Fewer Bits of\
  \ Entropy Than Intended\n### Impact\nA protocol compliance bug in thinbus-srp-npm versions\
  \ prior to 2.0.1 causes the client to generate a fixed 252 bits of entropy instead of the\
  \ intended bit length of the safe prime (defaulted to 2048 bits). RFC 5054 states in section\
  \ [2.5.4 Client Key Exchange ](https://datatracker.ietf.org/doc/html/rfc5054#section-2.5.4)\n\
  \n> The client key exchange message carries the client's public value\n   (A).  The client\
  \ calculates this value as A = g^a % N, where a is a\n   random number that SHOULD be at least\
  \ 256 bits in length.\n\nThe client public value is being generated from a private value that\
  \ is 4 bits below the specification. This reduces the protocol's designed security margin\
  \ it is now practically exploitable. The servers full sized 2048 bit random number is used\
  \ to create the shared session key and password proof. \n\n### Patches\n\nThe issue is fixed\
  \ in versions >= 2.0.1\n\n### Workarounds\n\nIt is possible to patch a legacy version: \n\n\
  ```javascript\n// WRONG\nvar hexLength = this.toHex(N).length;\n\n// CORRECT  \nvar hexLength\
  \ = this.toHex(this.N()).length;\n```"
impacted_packages:
  - purl: pkg:npm/thinbus-srp
    affected_versions: vers:npm/<2.0.1
    fixed_versions: vers:npm/2.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-8q6v-474h-whgg/GHSA-8q6v-474h-whgg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-331
references:
  - url: https://github.com/simbo1905/thinbus-srp-npm
    reference_type:
    reference_id:
  - url: https://github.com/simbo1905/thinbus-srp-npm/commit/aa7064c1db7294ce867e9bc92f26fa6c71a5a2cb
    reference_type:
    reference_id:
  - url: https://github.com/simbo1905/thinbus-srp-npm/issues/28
    reference_type:
    reference_id:
  - url: https://github.com/simbo1905/thinbus-srp-npm/pull/30/commits/4aeaea2366e090765a8204059c7bcf3616438d31
    reference_type:
    reference_id:
  - url: https://github.com/simbo1905/thinbus-srp-npm/security/advisories/GHSA-8q6v-474h-whgg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54885
    reference_type:
    reference_id: CVE-2025-54885
