advisory_id: GHSA-vr7m-r9vm-m4wf
datasource_id: github_osv_importer_v2/GHSA-vr7m-r9vm-m4wf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-vr7m-r9vm-m4wf/GHSA-vr7m-r9vm-m4wf.json
aliases:
  - CVE-2024-21628
summary: |
  PrestaShop XSS can be stored in DB from "add a message form" in order detail page (FO)
  ### Impact
  The isCleanHtml method is not used on this this form, which makes it possible to store an xss in DB.
  The impact is low because the html is not interpreted in BO, thanks to twig's escape mechanism.
  In FO, the xss is effective, but only impacts the customer sending it, or the customer session from which it was sent.

  Be careful if you have a module fetching these messages from the DB and displaying it without escaping html.

  ### Patches
  8.1.x

  ### Reporter
  Reported by Rona Febriana (linkedin: https://www.linkedin.com/in/rona-febriana/)
impacted_packages:
  - purl: pkg:composer/prestashop/prestashop
    affected_versions: vers:composer/<8.1.3
    fixed_versions: vers:composer/8.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-vr7m-r9vm-m4wf/GHSA-vr7m-r9vm-m4wf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/PrestaShop/PrestaShop
    reference_type:
    reference_id:
  - url: https://github.com/PrestaShop/PrestaShop/commit/afc45b93b3cc33be0e571559d2838c6960d98856
    reference_type:
    reference_id:
  - url: https://github.com/PrestaShop/PrestaShop/commit/c3d78b7e49f5fe49a9d07725c3174d005deaa597
    reference_type:
    reference_id:
  - url: https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-vr7m-r9vm-m4wf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-21628
    reference_type:
    reference_id: CVE-2024-21628
