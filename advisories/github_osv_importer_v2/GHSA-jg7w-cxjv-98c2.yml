advisory_id: GHSA-jg7w-cxjv-98c2
datasource_id: github_osv_importer_v2/GHSA-jg7w-cxjv-98c2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-jg7w-cxjv-98c2/GHSA-jg7w-cxjv-98c2.json
aliases:
  - CVE-2023-46255
summary: |
  SpiceDB leaks information in log files when URI cannot be parsed
  SpiceDB is an open source, Google Zanzibar-inspired database for creating and managing security-critical application permissions. When the provided datastore URI is malformed (e.g. by having a password which contains `:`) the full URI (including the provided password) is printed, so that the password is shown in the logs. Version 1.27.0-rc1 patches this issue.

  Example output:
  ```
  terminated with errors error="unable to create migration driver for postgres: parse \"postgres://spicedb:<PASSWORD IN PLAINTEXT>": invalid port \"<PASSWORD IN PLAINTEXT>\" after host"
  ```
impacted_packages: []
severities:
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-jg7w-cxjv-98c2/GHSA-jg7w-cxjv-98c2.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: https://github.com/authzed/spicedb
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/commit/ae50421b80f895e4c98d999b18e06b6f1e6f1cf8
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/security/advisories/GHSA-jg7w-cxjv-98c2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-46255
    reference_type:
    reference_id: CVE-2023-46255
