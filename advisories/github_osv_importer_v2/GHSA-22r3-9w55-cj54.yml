advisory_id: GHSA-22r3-9w55-cj54
datasource_id: github_osv_importer_v2/GHSA-22r3-9w55-cj54
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-22r3-9w55-cj54/GHSA-22r3-9w55-cj54.json
aliases:
  - CVE-2024-24828
summary: |
  Pkg Local Privilege Escalation
  ### Impact
  Any native code packages built by `pkg` are written to a hardcoded directory. On unix systems, this is `/tmp/pkg/*` which is a shared directory for all users on the same local system. There is no uniqueness to the package names within this directory, they are predictable.

  An attacker who has access to the same local system has the ability to replace the genuine executables in the shared directory with malicious executables of the same name. A user may then run the malicious executable without realising it has been modified.

  ### Patches
  This package is deprecated. Therefore, there will not be a patch provided for this vulnerability.

  ### Recommended Action:
  To check if your executable build by pkg depends on native code and is vulnerable, run the executable and check if `/tmp/pkg/` was created.

  Users should transition to actively maintained alternatives. We would recommend investigating Node.js 21â€™s support for [single executable applications](https://nodejs.org/api/single-executable-applications.html).

  ### Workarounds
  Given the decision to deprecate the pkg package, there are no official workarounds or remediations provided by our team. Users should prioritize migrating to other packages that offer similar functionality with enhanced security.
impacted_packages:
  - purl: pkg:npm/pkg
    affected_versions: vers:npm/<=5.8.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-22r3-9w55-cj54/GHSA-22r3-9w55-cj54.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-276
references:
  - url: https://github.com/vercel/pkg
    reference_type:
    reference_id:
  - url: https://github.com/vercel/pkg/security/advisories/GHSA-22r3-9w55-cj54
    reference_type:
    reference_id:
  - url: https://nodejs.org/api/single-executable-applications.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-24828
    reference_type:
    reference_id: CVE-2024-24828
