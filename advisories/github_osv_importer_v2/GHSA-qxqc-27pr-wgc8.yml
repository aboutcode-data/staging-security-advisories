advisory_id: GHSA-qxqc-27pr-wgc8
datasource_id: github_osv_importer_v2/GHSA-qxqc-27pr-wgc8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-qxqc-27pr-wgc8/GHSA-qxqc-27pr-wgc8.json
aliases:
  - CVE-2024-42490
summary: |
  GoAuthentik vulnerable to Insufficient Authorization for several API endpoints
  ### Summary

  Several API endpoints can be accessed by users without correct authentication/authorization.

  The main API endpoints affected by this:

  -   `/api/v3/crypto/certificatekeypairs/<uuid>/view_certificate/`
  -   `/api/v3/crypto/certificatekeypairs/<uuid>/view_private_key/`
  -   `/api/v3/.../used_by/`

  Note that all of the affected API endpoints require the knowledge of the ID of an object, which especially for certificates is not accessible to an unprivileged user. Additionally the IDs for most objects are UUIDv4, meaning they are not easily guessable/enumerable.

  ### Patches

  authentik 2024.4.4, 2024.6.4 and 2024.8.0 fix this issue.

  ### Workarounds

  Access to the API endpoints can be blocked at a Reverse-proxy/Load balancer level to prevent this issue from being exploited.

  ### For more information

  If you have any questions or comments about this advisory:

  -   Email us at [security@goauthentik.io](mailto:security@goauthentik.io)
impacted_packages: []
severities:
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-qxqc-27pr-wgc8/GHSA-qxqc-27pr-wgc8.json
  - score: '9.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:H/SC:H/SI:N/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-qxqc-27pr-wgc8/GHSA-qxqc-27pr-wgc8.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
  - CWE-863
references:
  - url: https://github.com/goauthentik/authentik
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/commit/19318d4c00bb02c4ec3c4f8f15ac2e1dbe8d846c
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/commit/359b343f51524342a5ca03828e7c975a1d654b11
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/security/advisories/GHSA-qxqc-27pr-wgc8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42490
    reference_type:
    reference_id: CVE-2024-42490
