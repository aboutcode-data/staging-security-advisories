advisory_id: GHSA-3vjh-xrhf-v9xh
datasource_id: github_osv_importer_v2/GHSA-3vjh-xrhf-v9xh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-3vjh-xrhf-v9xh/GHSA-3vjh-xrhf-v9xh.json
aliases:
  - CVE-2021-3902
summary: |
  Improper Restriction of XML External Entity Reference in dompdf/dompdf
  An improper restriction of external entities (XXE) vulnerability in dompdf/dompdf's SVG parser allows for Server-Side Request Forgery (SSRF) and deserialization attacks. This issue affects all versions prior to 2.0.0. The vulnerability can be exploited even if the isRemoteEnabled option is set to false. It allows attackers to perform SSRF, disclose internal image files, and cause PHAR deserialization attacks.
impacted_packages:
  - purl: pkg:composer/dompdf/dompdf
    affected_versions: vers:composer/<2.0.0
    fixed_versions: vers:composer/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-3vjh-xrhf-v9xh/GHSA-3vjh-xrhf-v9xh.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://github.com/dompdf/dompdf
    reference_type:
    reference_id:
  - url: https://github.com/dompdf/dompdf/commit/f56bc8e40be6c0ae0825e6c7396f4db80620b799
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/a6071c07-806f-429a-8656-a4742e4191b1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3902
    reference_type:
    reference_id: CVE-2021-3902
