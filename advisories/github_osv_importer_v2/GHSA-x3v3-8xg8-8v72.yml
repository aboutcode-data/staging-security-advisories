advisory_id: GHSA-x3v3-8xg8-8v72
datasource_id: github_osv_importer_v2/GHSA-x3v3-8xg8-8v72
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-x3v3-8xg8-8v72/GHSA-x3v3-8xg8-8v72.json
aliases:
  - CVE-2023-50249
summary: "Sentry's Astro SDK vulnerable to ReDoS\n### Impact\nA ReDoS (Regular expression Denial\
  \ of Service) vulnerability has been identified in Sentry's Astro SDK 7.78.0-7.86.0. Under\
  \ certain conditions, this vulnerability allows an attacker to cause excessive computation\
  \ times on the server, leading to denial of service (DoS).\n\nApplications that are using\
  \ Sentry's Astro SDK are affected if:\n\n1. They're using Sentry instrumentation:\n   - they\
  \ have [manually registered](https://docs.sentry.io/platforms/javascript/guides/astro/manual-setup/#manually-add-server-instrumentation)\
  \ Sentry Middleware (affected versions 7.78.0-7.86.0);\n   - or [configured](https://docs.sentry.io/platforms/javascript/guides/astro/manual-setup/#configure-server-instrumentation)\
  \ Astro in SSR (server) or hybrid mode, use Astro 3.5.0 and newer and didnâ€™t [disable the\
  \ automatic server instrumentation](https://docs.sentry.io/platforms/javascript/guides/astro/manual-setup/#disable-auto-server-instrumentation)\
  \ (affected versions 7.82.0-7.86.0).\n2. They have configured routes with at least two path\
  \ params (e.g. `/foo/[p1]/bar/[p2]`).\n\n### Patches\nThe problem has been patched in [@sentry/astro@7.87.0](https://www.npmjs.com/package/@sentry/astro/v/7.87.0).\n\
  The corresponding PR: https://github.com/getsentry/sentry-javascript/pull/9815\n\n### Workarounds\n\
  We strongly recommend upgrading to the latest SDK version. However, if it's not possible,\
  \ the steps to mitigate the vulnerability without upgrade are:\n* [disable auto instrumentation](https://docs.sentry.io/platforms/javascript/guides/astro/manual-setup/#disable-auto-server-instrumentation)\
  \ if you're using Astro 3.5.0 or newer\n* and remove the manually added Sentry middleware\
  \ (if it was [added](https://docs.sentry.io/platforms/javascript/guides/astro/manual-setup/#manually-add-server-instrumentation)\
  \ before).\n\nAfter these changes, Sentry error reporting will still be functional, but some\
  \ details such as server-side transactions (and consequently, distributed traces between client\
  \ and server) will be omitted. We therefore still recommend to update to 7.87.0 as soon as\
  \ you can. \n\n### References\n* [Sentry docs: Manual Setup for Astro](https://docs.sentry.io/platforms/javascript/guides/astro/manual-setup/)\n\
  * [Release notes: sentry-javascript 7.87.0](https://github.com/getsentry/sentry-javascript/releases/tag/7.87.0)\n\
  * [npm: @sentry/astro@7.87.0](https://www.npmjs.com/package/@sentry/astro/v/7.87.0)"
impacted_packages:
  - purl: pkg:npm/%40sentry/astro
    affected_versions: vers:npm/>=7.78.0|<7.87.0
    fixed_versions: vers:npm/7.87.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-x3v3-8xg8-8v72/GHSA-x3v3-8xg8-8v72.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
  - CWE-400
references:
  - url: https://docs.sentry.io/platforms/javascript/guides/astro/manual-setup/#disable-auto-server-instrumentation
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript/commit/fe24eb5eefa9d27b14b2b6f9ebd1debca1c208fb
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript/pull/9815
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript/security/advisories/GHSA-x3v3-8xg8-8v72
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/@sentry/astro/v/7.87.0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-50249
    reference_type:
    reference_id: CVE-2023-50249
