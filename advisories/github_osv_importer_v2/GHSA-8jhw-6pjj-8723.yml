advisory_id: GHSA-8jhw-6pjj-8723
datasource_id: github_osv_importer_v2/GHSA-8jhw-6pjj-8723
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/12/GHSA-8jhw-6pjj-8723/GHSA-8jhw-6pjj-8723.json
aliases:
  - CVE-2024-56734
summary: |
  Better Auth has an Open Redirect Vulnerability in Verify Email Endpoint
  ## Summary
  An **open redirect vulnerability** has been identified in the **verify email endpoint** of Better Auth, potentially allowing attackers to redirect users to malicious websites. This issue affects users relying on email verification links generated by the library.

  ## Affected Versions
  - All versions prior to **v1.1.6**.

  ## Impact
  Attackers could craft malicious email verification links that exploit the redirect functionality to send users to untrusted domains. This can result in:

  - **Phishing attacks** – Users may unknowingly enter sensitive information on fake login pages.
  - **Reputation damage** – Trust issues for applications using Better Auth.

  ## Vulnerability Details
  The verify email callback endpoint accepts a `callbackURL` parameter. Unlike other verification methods, email verification only uses JWT to verify and redirect without proper validation of the target domain. The origin checker is bypassed in this scenario because it only checks for `POST` requests. An attacker can manipulate this parameter to redirect users to arbitrary URLs controlled by the attacker.

  **Example Exploit:**
  ```
  https://example.com/auth/verify-email?token=abcd1234&callbackURL=https://malicious-site.com
  ```

  ## Patches
  Upgrade to Better Auth **v1.1.6** or later. This version enforces domain validation for `callbackURL` for `/verify-email` path and for all other `GET` endpoints.

  ## Workarounds
  You can also use hooks to pre-check URLs in your auth instance to prevent this without upgrading:

  ```ts
  const auth = betterAuth({
      hooks: {
           before: (ctx) => {
              if (ctx.path === "/verify-email") {
                 const callbackURL = ctx.query.callbackURL; // Check if this is a trusted callback URL or not
              }
           }
      }
  })
  ```
impacted_packages:
  - purl: pkg:npm/better-auth
    affected_versions: vers:npm/<1.1.6
    fixed_versions: vers:npm/1.1.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/12/GHSA-8jhw-6pjj-8723/GHSA-8jhw-6pjj-8723.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/better-auth/better-auth
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/commit/deb3d73aea90d0468d92723f4511542b593e522f
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56734
    reference_type:
    reference_id: CVE-2024-56734
