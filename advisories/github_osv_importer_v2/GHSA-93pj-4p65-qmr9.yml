advisory_id: GHSA-93pj-4p65-qmr9
datasource_id: github_osv_importer_v2/GHSA-93pj-4p65-qmr9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-93pj-4p65-qmr9/GHSA-93pj-4p65-qmr9.json
aliases:
  - CVE-2022-0334
summary: |
  Insufficient user authorization in Moodle
  A flaw was found in Moodle in versions 3.11 to 3.11.4, 3.10 to 3.10.8, 3.9 to 3.9.11 and earlier unsupported versions. Insufficient capability checks could lead to users accessing their grade report for courses where they did not have the required gradereport/user:view capability.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.11.0|<3.11.5
    fixed_versions: vers:composer/3.11.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.10.0|<3.10.8
    fixed_versions: vers:composer/3.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<3.9.11
    fixed_versions: vers:composer/3.9.11
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-93pj-4p65-qmr9/GHSA-93pj-4p65-qmr9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
  - CWE-668
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2043664
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/1964d68f8500ea3c7b776fa8a2af6266ed109f84
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/6d18f136ae88ec97e351a723df570816a959ec68
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=431102
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-0334
    reference_type:
    reference_id: CVE-2022-0334
