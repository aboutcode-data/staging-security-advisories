advisory_id: GHSA-364w-9g92-3grq
datasource_id: github_osv_importer_v2/GHSA-364w-9g92-3grq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-364w-9g92-3grq/GHSA-364w-9g92-3grq.json
aliases:
  - CVE-2021-43617
summary: |
  Withdrawn: Laravel Framework does not sufficiently block the upload of executable PHP content.
  # Withdrawn

  This advisory has been withdrawn after the maintainers of Laravel noted this issue is not a security vulnerability with Laravel itself, but rather a userland issue.

  ## Original CVE based description

  Laravel Framework through 8.70.2 does not sufficiently block the upload of executable PHP content because Illuminate/Validation/Concerns/ValidatesAttributes.php lacks a check for .phar files, which are handled as application/x-httpd-php on systems based on Debian. In some use cases, this may be related to file-type validation for image upload (e.g., differences between getClientOriginalExtension and other approaches).
impacted_packages:
  - purl: pkg:composer/laravel/framework
    affected_versions: vers:composer/<=8.70.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://github.com/laravel/framework
    reference_type:
    reference_id:
  - url: https://github.com/laravel/framework/blob/2049de73aa099a113a287587df4cc522c90961f5/src/Illuminate/Validation/Concerns/ValidatesAttributes.php#L1130-L1132
    reference_type:
    reference_id:
  - url: https://github.com/laravel/framework/blob/2049de73aa099a113a287587df4cc522c90961f5/src/Illuminate/Validation/Concerns/ValidatesAttributes.php#L1331-L1333
    reference_type:
    reference_id:
  - url: https://hosein-vita.medium.com/laravel-8-x-image-upload-bypass-zero-day-852bd806019b
    reference_type:
    reference_id:
  - url: https://salsa.debian.org/php-team/php/-/blob/dc253886b5b2e9bc8d9e36db787abb083a667fd8/debian/php-cgi.conf#L5-6
    reference_type:
    reference_id:
  - url: https://salsa.debian.org/php-team/php/-/commit/dc253886b5b2e9bc8d9e36db787abb083a667fd8
    reference_type:
    reference_id:
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/php/webapps/50525.txt
    reference_type: exploit
    reference_id: CVE-2021-43617
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43617
    reference_type:
    reference_id: CVE-2021-43617
