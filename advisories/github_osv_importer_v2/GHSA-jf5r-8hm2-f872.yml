advisory_id: GHSA-jf5r-8hm2-f872
datasource_id: github_osv_importer_v2/GHSA-jf5r-8hm2-f872
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-jf5r-8hm2-f872/GHSA-jf5r-8hm2-f872.json
aliases:
  - CVE-2022-0691
summary: |
  url-parse incorrectly parses hostname / protocol due to unstripped leading control characters.
  Leading control characters in a URL are not stripped when passed into url-parse. This can cause input URLs to be mistakenly be interpreted as a relative URL without a hostname and protocol, while the WHATWG URL parser will trim control characters and treat it as an absolute URL.

  If url-parse is used in security decisions involving the hostname / protocol, and the input URL is used in a client which uses the WHATWG URL parser, the decision may be incorrect.

  This can also lead to a cross-site scripting (XSS) vulnerability if url-parse is used to check for the javascript: protocol in URLs. See following example:
  ```js
  const parse = require('url-parse')
  const express = require('express')
  const app = express()
  const port = 3000

  url = parse(\"\\bjavascript:alert(1)\")

  console.log(url)

  app.get('/', (req, res) => {
   if (url.protocol !== \"javascript:\") {res.send(\"<a href=\\'\" + url.href + \"\\'>CLICK ME!</a>\")}
   })

  app.listen(port, () => {
   console.log(`Example app listening on port ${port}`)
   })
  ```
impacted_packages:
  - purl: pkg:npm/url-parse
    affected_versions: vers:npm/>=0.1.0|<1.5.9
    fixed_versions: vers:npm/1.5.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-jf5r-8hm2-f872/GHSA-jf5r-8hm2-f872.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-639
references:
  - url: https://github.com/github/advisory-database/pull/6765
    reference_type:
    reference_id:
  - url: https://github.com/unshiftio/url-parse
    reference_type:
    reference_id:
  - url: https://github.com/unshiftio/url-parse/commit/0e3fb542d60ddbf6933f22eb9b1e06e25eaa5b63
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/57124ed5-4b68-4934-8325-2c546257f2e4
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/02/msg00030.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220325-0006
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-0691
    reference_type:
    reference_id: CVE-2022-0691
