advisory_id: GHSA-r562-m862-63w3
datasource_id: github_osv_importer_v2/GHSA-r562-m862-63w3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-r562-m862-63w3/GHSA-r562-m862-63w3.json
aliases:
  - CVE-2021-37941
summary: |
  APM Java Agent Local Privilege Escalation
  A local privilege escalation issue was found with the APM Java agent, where a user on the system could attach a malicious file to an application running with the APM Java agent. Using this vector, a malicious or compromised user account could use the agent to run commands at a higher level of permissions than they possess. This vulnerability affects users that have set up the agent via the attacher cli 3, the attach API 2, as well as users that have enabled the profiling_inferred_spans_enabled option
impacted_packages:
  - purl: pkg:pypi/elastic-apm
    affected_versions: vers:pypi/>=1.10.0|<1.27.0
    fixed_versions: vers:pypi/1.27.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-r562-m862-63w3/GHSA-r562-m862-63w3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://discuss.elastic.co/t/apm-java-agent-security-update/289627
    reference_type:
    reference_id:
  - url: https://github.com/elastic/apm-agent-python
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37941
    reference_type:
    reference_id: CVE-2021-37941
