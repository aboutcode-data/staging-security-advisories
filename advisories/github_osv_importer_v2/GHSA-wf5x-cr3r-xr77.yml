advisory_id: GHSA-wf5x-cr3r-xr77
datasource_id: github_osv_importer_v2/GHSA-wf5x-cr3r-xr77
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-wf5x-cr3r-xr77/GHSA-wf5x-cr3r-xr77.json
aliases:
  - CVE-2019-10761
summary: |
  vm2 before 3.6.11 vulnerable to sandbox escape
  This affects the package vm2 before 3.6.11. It is possible to trigger a RangeError exception from the host rather than the "sandboxed" context by reaching the stack call limit with an infinite recursion. The returned object is then used to reference the mainModule property of the host code running the script allowing it to spawn a child_process and execute arbitrary code.
impacted_packages:
  - purl: pkg:npm/vm2
    affected_versions: vers:npm/<3.6.11
    fixed_versions: vers:npm/3.6.11
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-wf5x-cr3r-xr77/GHSA-wf5x-cr3r-xr77.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-674
references:
  - url: https://gist.github.com/JLLeitschuh/609bb2efaff22ed84fe182cf574c023a
    reference_type:
    reference_id:
  - url: https://github.com/patriksimek/vm2
    reference_type:
    reference_id:
  - url: https://github.com/patriksimek/vm2/commit/4b22d704e4794af63a5a2d633385fd20948f6f90
    reference_type:
    reference_id:
  - url: https://github.com/patriksimek/vm2/issues/197
    reference_type:
    reference_id:
  - url: https://github.com/patriksimek/vm2/issues/197#issuecomment-480643832
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-VM2-473188
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-10761
    reference_type:
    reference_id: CVE-2019-10761
