advisory_id: GHSA-6xw4-3v39-52mm
datasource_id: github_osv_importer_v2/GHSA-6xw4-3v39-52mm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-6xw4-3v39-52mm/GHSA-6xw4-3v39-52mm.json
aliases:
  - CVE-2025-61919
summary: |
  Rack is vulnerable to a memory-exhaustion DoS through unbounded URL-encoded body parsing
  ## Summary

  `Rack::Request#POST` reads the entire request body into memory for `Content-Type: application/x-www-form-urlencoded`, calling `rack.input.read(nil)` without enforcing a length or cap. Large request bodies can therefore be buffered completely into process memory before parsing, leading to denial of service (DoS) through memory exhaustion.

  ## Details

  When handling non-multipart form submissions, Rackâ€™s request parser performs:

  ```ruby
  form_vars = get_header(RACK_INPUT).read
  ```

  Since `read` is called with no argument, the entire request body is loaded into a Ruby `String`. This occurs before query parameter parsing or enforcement of any `params_limit`. As a result, Rack applications without an upstream body-size limit can experience unbounded memory allocation proportional to request size.

  ## Impact

  Attackers can send large `application/x-www-form-urlencoded` bodies to consume process memory, causing slowdowns or termination by the operating system (OOM). The effect scales linearly with request size and concurrency. Even with parsing limits configured, the issue occurs *before* those limits are enforced.

  ## Mitigation

  * Update to a patched version of Rack that enforces form parameter limits using `query_parser.bytesize_limit`, preventing unbounded reads of `application/x-www-form-urlencoded` bodies.
  * Enforce strict maximum body size at the proxy or web server layer (e.g., Nginx `client_max_body_size`, Apache `LimitRequestBody`).
impacted_packages:
  - purl: pkg:gem/rack
    affected_versions: vers:gem/<2.2.20
    fixed_versions: vers:gem/2.2.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions: vers:gem/>=3.0|<3.1.18
    fixed_versions: vers:gem/3.1.18
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions: vers:gem/>=3.2|<3.2.3
    fixed_versions: vers:gem/3.2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-6xw4-3v39-52mm/GHSA-6xw4-3v39-52mm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/rack/rack
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/4e2c903991a790ee211a3021808ff4fd6fe82881
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/cbd541e8a3d0c5830a3c9a30d3718ce2e124f9db
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/e179614c4a653283286f5f046428cbb85f21146f
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/security/advisories/GHSA-6xw4-3v39-52mm
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61919.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-61919
    reference_type:
    reference_id:
