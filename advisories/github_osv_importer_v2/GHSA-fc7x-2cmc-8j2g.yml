advisory_id: GHSA-fc7x-2cmc-8j2g
datasource_id: github_osv_importer_v2/GHSA-fc7x-2cmc-8j2g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-fc7x-2cmc-8j2g/GHSA-fc7x-2cmc-8j2g.json
aliases:
  - CVE-2021-45696
summary: |
  Incorrect hash in sha2
  The v0.9.7 release of the sha2 crate introduced a new AVX2-accelerated backend which was automatically enabled for all x86/x86_64 CPUs where AVX2 support was autodetected at runtime.

  This backend was buggy and would miscompute results for long messages (i.e. messages spanning multiple SHA blocks).

  The crate has since been yanked, but any users who upgraded to v0.9.7 should immediately upgrade to v0.9.8 and recompute any hashes which were previously computed by v0.9.7.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-fc7x-2cmc-8j2g/GHSA-fc7x-2cmc-8j2g.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-327
references:
  - url: https://github.com/RustCrypto/hashes
    reference_type:
    reference_id:
  - url: https://github.com/RustCrypto/hashes/pull/314
    reference_type:
    reference_id:
  - url: https://raw.githubusercontent.com/rustsec/advisory-db/main/crates/sha2/RUSTSEC-2021-0100.md
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0100.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-45696
    reference_type:
    reference_id: CVE-2021-45696
