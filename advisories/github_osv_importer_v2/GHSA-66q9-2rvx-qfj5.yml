advisory_id: GHSA-66q9-2rvx-qfj5
datasource_id: github_osv_importer_v2/GHSA-66q9-2rvx-qfj5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/12/GHSA-66q9-2rvx-qfj5/GHSA-66q9-2rvx-qfj5.json
aliases:
  - CVE-2024-54131
summary: "Kolide Agent Privilege Escalation (Windows, Versions >= 1.5.3, < 1.12.3)\nAn implementation\
  \ bug in the Kolide Agent (known as `launcher`) allows for local privilege escalation to the\
  \ SYSTEM user on Windows 10 and 11. Impacted versions include versions >= 1.5.3 and the fix\
  \ has been released in 1.12.3. \n\nThe bug was introduced in version 1.5.3 when launcher started\
  \ storing upgraded binaries in the ProgramData directory (#1510). This move to the new directory\
  \ meant the launcher root directory inherited default permissions that are not as strict as\
  \ the previous location. These incorrect default permissions in conjunction with an omitted\
  \ SystemDrive environmental variable (when launcher starts osqueryd), allows a malicious actor\
  \ with access to the local Windows device to successfully place an arbitrary DLL into the\
  \ osqueryd process's search path. Under some circumstances, this DLL will be executed when\
  \ osqueryd performs a WMI query. This combination of events could then allow the attacker\
  \ to escalate their privileges to SYSTEM.\n\nThis issue was found by Bryan Alexander of Atredis\
  \ Partners and responsibly reported through the Kolide bug bounty program. Kolide made the\
  \ appropriate changes and released a fix in version 1.12.3 of the `launcher` package."
impacted_packages: []
severities:
  - score: '7.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/12/GHSA-66q9-2rvx-qfj5/GHSA-66q9-2rvx-qfj5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-276
  - CWE-456
references:
  - url: https://github.com/kolide/launcher
    reference_type:
    reference_id:
  - url: https://github.com/kolide/launcher/pull/1510
    reference_type:
    reference_id:
  - url: https://github.com/kolide/launcher/security/advisories/GHSA-66q9-2rvx-qfj5
    reference_type:
    reference_id:
