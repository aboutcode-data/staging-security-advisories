advisory_id: GHSA-8frv-q972-9rq5
datasource_id: github_osv_importer_v2/GHSA-8frv-q972-9rq5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-8frv-q972-9rq5/GHSA-8frv-q972-9rq5.json
aliases:
  - CVE-2025-66017
summary: |
  cggmp24 and cggmp21 are vulnerable to signature forgery through altered presignatures
  ### Impact
  This attack is against presignatures used in very specific context:
  * Presignatures + HD wallets derivation: security level reduces to 85 bits \
    Previously users could generate a presignature, and then choose a HD derivation path while issuing a partial signature via [`Presignature::set_derivation_path`](https://docs.rs/cggmp21/0.6.3/cggmp21/signing/struct.Presignature.html#method.set_derivation_path), which is malleable to attack that reduces target security level. To mitigate, this method has been removed from API.
  * Presignatures + "raw signing" (when signer signs a hash without knowing an original message): results into signature forgery attack \
    Previously, users were able to configure [`Presignature::issue_partial_signature`](https://docs.rs/cggmp21/0.6.3/cggmp21/signing/struct.Presignature.html#method.issue_partial_signature) with hashed message without ever providing original mesage. In new API, this method only accepts digests for which original message has been observed.

  ### Patches
  `cggmp24 v0.7.0-alpha.2` release contains API changes that make it impossible to use presignatures in contexts in which it reduces security. Follow [migration guidelines](https://github.com/LFDT-Lockness/cggmp21/blob/v0.7.0-alpha.2/CGGMP21_MIGRATION.md) to upgrade.

  ### Workarounds
  Users can continue using un-patched versions of library as long as they don't use presignatures in said scenarios where it weakens system security. To be sure, migrate to patched version that excludes presignatures from being used in such scenarios.

  ### References
  Read this [blog post](https://www.dfns.co/article/cggmp21-vulnerabilities-patched-and-explained) to learn more.
impacted_packages: []
severities:
  - score: '8.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-8frv-q972-9rq5/GHSA-8frv-q972-9rq5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-327
references:
  - url: https://github.com/LFDT-Lockness/cggmp21
    reference_type:
    reference_id:
  - url: https://github.com/LFDT-Lockness/cggmp21/commit/9d98157e151596573cb071da59d27a4e0ac9b8dc
    reference_type:
    reference_id:
  - url: https://github.com/LFDT-Lockness/cggmp21/security/advisories/GHSA-8frv-q972-9rq5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66017
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2025-0127.html
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2025-0128.html
    reference_type:
    reference_id:
  - url: https://www.dfns.co/article/cggmp21-vulnerabilities-patched-and-explained
    reference_type:
    reference_id:
