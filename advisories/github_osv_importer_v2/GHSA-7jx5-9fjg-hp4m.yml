advisory_id: GHSA-7jx5-9fjg-hp4m
datasource_id: github_osv_importer_v2/GHSA-7jx5-9fjg-hp4m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-7jx5-9fjg-hp4m/GHSA-7jx5-9fjg-hp4m.json
aliases: []
summary: |
  OpenClaw ACP client has permission auto-approval bypass via untrusted tool metadata
  ## Vulnerability Summary

  The OpenClaw ACP client could auto-approve tool calls based on untrusted metadata and permissive name heuristics. A malicious or compromised ACP tool invocation could bypass expected interactive approval prompts for read-class operations.

  ## Affected Packages / Versions

  - Package: npm `openclaw`
  - Affected published versions: `<= 2026.2.22-2` (latest published as of February 24, 2026 is `2026.2.22-2`)
  - Patched in code on `main`: `2026.2.23` (released)

  ## Technical Details

  - Permission classification trusted incoming `toolCall.kind` and heuristic name matching.
  - Non-core read-like names and spoofed kind metadata could reach auto-approve paths.
  - `read` operations were not scoped strongly enough to cwd in all metadata/title forms.

  ## Fix

  - Require trusted core tool IDs for auto-approval and ignore untrusted `toolCall.kind` as an authorization source.
  - Scope `read` auto-approval to cwd-resolved paths.
  - Add stricter tool-name validation and regression coverage for spoofed kind and non-core read-like names.

  ## Affected Functions

  - `resolvePermissionRequest`
  - `resolveToolNameForPermission`
  - `shouldAutoApproveToolCall`

  ## Fix Commit(s)

  - `12cc754332f9a7c92e158ce7644aa22df79c0904`
  - `63dcd28ae0be2de1c75af09cc81841cebeec068f`

  Found using [MCPwner](https://github.com/Pigyon/MCPwner)


  Thanks @nedlir for reporting.
impacted_packages:
  - purl: pkg:npm/openclaw
    affected_versions: vers:npm/<=2026.2.22-2
    fixed_versions: vers:npm/2026.2.23
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:H/VI:L/VA:N/SC:L/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-7jx5-9fjg-hp4m/GHSA-7jx5-9fjg-hp4m.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
  - CWE-639
references:
  - url: https://github.com/openclaw/openclaw
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/commit/12cc754332f9a7c92e158ce7644aa22df79c0904
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/commit/63dcd28ae0be2de1c75af09cc81841cebeec068f
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/releases/tag/v2026.2.23
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/security/advisories/GHSA-7jx5-9fjg-hp4m
    reference_type:
    reference_id:
