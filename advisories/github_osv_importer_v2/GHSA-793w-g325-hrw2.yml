advisory_id: GHSA-793w-g325-hrw2
datasource_id: github_osv_importer_v2/GHSA-793w-g325-hrw2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-793w-g325-hrw2/GHSA-793w-g325-hrw2.json
aliases:
  - CVE-2023-36477
summary: |
  XWiki Platform vulnerable to persistent Cross-site Scripting through CKEditor Configuration pages
  ### Effect
  Any user with edit rights can edit all pages in the `CKEditor' space. This makes it possible to perform a variety of harmful actions, such as
  - removing technical documents, leading to loss of service
  - Editing the javascript configuration of CKEditor, leading to persistent XSS

  ### Patches
  This issue has been patched in XWiki 14.10.6 and XWiki 15.1.
  This issue has been patched on the CKEditor Integration extension 1.64.9 for XWiki version older than 14.6RC1.

  ### Workarounds
  The issue can be fixed manually by restricting the `edit` and `delete` rights to a trusted user or group (e.g. the `XWiki.XWikiAdminGroup` group), implicitly disabling those rights for all other users.
  See https://github.com/xwiki/xwiki-platform/commit/9d9d86179457cb8dc48b4491510537878800be4f

  ### References
  - https://jira.xwiki.org/browse/XWIKI-20590
  - https://jira.xwiki.org/browse/CKEDITOR-508
  - https://github.com/xwiki/xwiki-platform/commit/9d9d86179457cb8dc48b4491510537878800be4f


  ### For more information

  If you have any questions or comments about this advisory:

  *    Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  *    Email us at [Security Mailing List](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-ckeditor-ui
    affected_versions: vers:maven/>=14.6-rc-1|<14.10.6
    fixed_versions: vers:maven/14.10.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.contrib/application-ckeditor-ui
    affected_versions: vers:maven/>=1.9|<1.64.9
    fixed_versions: vers:maven/1.64.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-ckeditor-ui
    affected_versions: vers:maven/>=15.0-rc-1|<15.1
    fixed_versions: vers:maven/15.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-793w-g325-hrw2/GHSA-793w-g325-hrw2.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/9d9d86179457cb8dc48b4491510537878800be4f
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-793w-g325-hrw2
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/CKEDITOR-508
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20590
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-36477
    reference_type:
    reference_id: CVE-2023-36477
