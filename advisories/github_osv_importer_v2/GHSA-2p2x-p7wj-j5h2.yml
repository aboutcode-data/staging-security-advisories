advisory_id: GHSA-2p2x-p7wj-j5h2
datasource_id: github_osv_importer_v2/GHSA-2p2x-p7wj-j5h2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-2p2x-p7wj-j5h2/GHSA-2p2x-p7wj-j5h2.json
aliases:
  - CVE-2024-31454
summary: |
  PsiTransfer: File integrity violation
  ### Summary
  The absence of restrictions on the endpoint, which is designed for uploading files, allows an attacker who received the id of a file distribution to change the files that are in this distribution.

  ### Details
  Vulnerable endpoint: PATCH /files/{{id}}

  ### PoC
  1. Create a file distribution.

  2. Go to the link address for downloading files and download the file (in this case, the attacker receives the file id from the download request).

  3. Send a PATCH /files/{{id}} request with arbitrary content in the request body.

  Thus, the file with the specified id will be changed. What the attacker specifies in the body of the request will be added to the end of the original content. In the future, users will download the modified file.

  ### Impact
  The vulnerability allows an attacker to influence those users who come to the file distribution after him and slip the victim files with a malicious or phishing signature.
impacted_packages:
  - purl: pkg:npm/psitransfer
    affected_versions: vers:npm/<2.2.0
    fixed_versions: vers:npm/2.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-2p2x-p7wj-j5h2/GHSA-2p2x-p7wj-j5h2.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://github.com/psi-4ward/psitransfer
    reference_type:
    reference_id:
  - url: https://github.com/psi-4ward/psitransfer/commit/0014d81141e0f1664ccb6841970ef1ea0237cca3
    reference_type:
    reference_id:
  - url: https://github.com/psi-4ward/psitransfer/security/advisories/GHSA-2p2x-p7wj-j5h2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-31454
    reference_type:
    reference_id: CVE-2024-31454
