advisory_id: GHSA-5p8v-58qm-c7fp
datasource_id: github_osv_importer_v2/GHSA-5p8v-58qm-c7fp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-5p8v-58qm-c7fp/GHSA-5p8v-58qm-c7fp.json
aliases:
  - CVE-2022-39227
summary: |
  python-jwt vulnerable to token forgery with new claims
  ### Impact
  An attacker who obtains a JWT can arbitrarily forge its contents without knowing the secret key. Depending on the application, this may for example enable the attacker to spoof other user's identities, hijack their sessions, or bypass authentication.

  ### Patches
  Users should upgrade to version 3.3.4
  Fixed by: https://github.com/davedoesdev/python-jwt/commit/88ad9e67c53aa5f7c43ec4aa52ed34b7930068c9

  ### Workarounds
  None

  ### References
  Found by [Tom Tervoort](Tom.Tervoort@secura.com)
  https://github.com/pypa/advisory-database/blob/main/vulns/python-jwt/PYSEC-2022-259.yaml

  ### More information

  The vulnerability allows an attacker, who possesses a single valid JWT, to create a new token with forged claims that the verify_jwt function will accept as valid.

  The issue is caused by an inconsistency between the JWT parsers used by python-jwt and its dependency jwcrypto. By mixing compact and JSON representations, an attacker can trick jwcrypto of parsing different claims than those over which a signature is validated by jwcrypto.

  Testing the fix has been added as an [automated unit test](https://github.com/davedoesdev/python-jwt/blob/master/test/vulnerability_vows.py) to python-jwt.

  If you have any questions or comments about this advisory, please open an issue in [python-jwt](https://github.com/davedoesdev/python-jwt)
impacted_packages:
  - purl: pkg:pypi/python-jwt
    affected_versions: vers:pypi/<3.3.4
    fixed_versions: vers:pypi/3.3.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-5p8v-58qm-c7fp/GHSA-5p8v-58qm-c7fp.json
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-5p8v-58qm-c7fp/GHSA-5p8v-58qm-c7fp.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-290
references:
  - url: https://github.com/davedoesdev/python-jwt
    reference_type:
    reference_id:
  - url: https://github.com/davedoesdev/python-jwt/commit/6c5075469847b9e8b6e5336077d989d77a4d2bf1
    reference_type:
    reference_id:
  - url: https://github.com/davedoesdev/python-jwt/commit/88ad9e67c53aa5f7c43ec4aa52ed34b7930068c9
    reference_type:
    reference_id:
  - url: https://github.com/davedoesdev/python-jwt/security/advisories/GHSA-5p8v-58qm-c7fp
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/blob/main/vulns/python-jwt/PYSEC-2022-259.yaml
    reference_type:
    reference_id:
  - url: https://www.vicarius.io/vsociety/posts/authentication-bypass-in-python-jwt
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39227
    reference_type:
    reference_id: CVE-2022-39227
