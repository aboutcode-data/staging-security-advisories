advisory_id: GHSA-g5m6-hxpp-fc49
datasource_id: github_osv_importer_v2/GHSA-g5m6-hxpp-fc49
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-g5m6-hxpp-fc49/GHSA-g5m6-hxpp-fc49.json
aliases:
  - CVE-2024-23641
summary: |
  Sending a GET or HEAD request with a body crashes SvelteKit
  ### Summary
  In SvelteKit 2 sending a GET request with a body eg `{}` to a SvelteKit app in preview or with `adapter-node` throws `Request with GET/HEAD method cannot have body.` and crashes the app.

  ```
  node:internal/deps/undici/undici:6066
            throw new TypeError("Request with GET/HEAD method cannot have body.");
                  ^

  TypeError: Request with GET/HEAD method cannot have body.
      at new Request (node:internal/deps/undici/undici:6066:17)
      at getRequest (file:///C:/Users/admin/Desktop/reproduction/node_modules/@sveltejs/kit/src/exports/node/index.js:107:9)
      at file:///C:/Users/admin/Desktop/reproduction/node_modules/@sveltejs/kit/src/exports/vite/preview/index.js:181:26
      at call (file:///C:/Users/admin/Desktop/reproduction/node_modules/vite/dist/node/chunks/dep-9A4-l-43.js:44795:7)
      at next (file:///C:/Users/admin/Desktop/reproduction/node_modules/vite/dist/node/chunks/dep-9A4-l-43.js:44739:5)
      at file:///C:/Users/admin/Desktop/reproduction/node_modules/@sveltejs/kit/src/exports/vite/preview/index.js:172:6
      at call (file:///C:/Users/admin/Desktop/reproduction/node_modules/vite/dist/node/chunks/dep-9A4-l-43.js:44795:7)
      at next (file:///C:/Users/admin/Desktop/reproduction/node_modules/vite/dist/node/chunks/dep-9A4-l-43.js:44739:5)
      at file:///C:/Users/admin/Desktop/reproduction/node_modules/@sveltejs/kit/src/exports/vite/preview/index.js:211:27
      at call (file:///C:/Users/admin/Desktop/reproduction/node_modules/vite/dist/node/chunks/dep-9A4-l-43.js:44795:7)

  Node.js v20.11.0
  ```

  `TRACE` requests will also cause the app to crash. Prerendered pages and SvelteKit 1 apps are not affected.

  <!--
  ### Details
  _Give all details on the vulnerability. Pointing to the incriminated source code is very helpful for the maintainer._
  -->
  ### PoC
  <!-- _Complete instructions, including specific configuration details, to reproduce the vulnerability._ -->
  First do a fresh install of SvelteKit 2 with the example app. Typescript.

  1. `npm run build`
  2. `npm run preview`
  3. Go to http://localhost:4173 (works)
  4. curl -X GET -d "{}" http://localhost:4173/bye
  5. Application crashes and http://localhost:4173 is down

  ### Impact
  <!-- _What kind of vulnerability is it? Who is impacted?_ -->
  Denial of Service for apps using `adapter-node`
impacted_packages:
  - purl: pkg:npm/%40sveltejs/kit
    affected_versions: vers:npm/>=2.0.0|<2.4.3
    fixed_versions: vers:npm/2.4.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40sveltejs/adapter-node
    affected_versions: vers:npm/>=2.0.0|<2.1.2
    fixed_versions: vers:npm/2.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40sveltejs/adapter-node
    affected_versions: vers:npm/>=3.0.0|<3.0.3
    fixed_versions: vers:npm/3.0.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40sveltejs/adapter-node
    affected_versions: vers:npm/4.0.0
    fixed_versions: vers:npm/4.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-g5m6-hxpp-fc49/GHSA-g5m6-hxpp-fc49.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/sveltejs/kit
    reference_type:
    reference_id:
  - url: https://github.com/sveltejs/kit/commit/af34142631c876a7eb62ff81f71e8a3f90dafee9
    reference_type:
    reference_id:
  - url: https://github.com/sveltejs/kit/security/advisories/GHSA-g5m6-hxpp-fc49
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23641
    reference_type:
    reference_id: CVE-2024-23641
