advisory_id: GHSA-hqxw-f8mx-cpmw
datasource_id: github_osv_importer_v2/GHSA-hqxw-f8mx-cpmw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-hqxw-f8mx-cpmw/GHSA-hqxw-f8mx-cpmw.json
aliases:
  - CVE-2023-2253
summary: "distribution catalog API endpoint can lead to OOM via malicious user input\n### Impact\n\
  \nSystems that run `distribution` built after a specific commit running on memory-restricted\
  \ environments can suffer from denial of service by a crafted malicious `/v2/_catalog` API\
  \ endpoint request. \n\n### Patches\n\nUpgrade to at least 2.8.2-beta.1 if you are running\
  \ `v2.8.x` release. If you use the code from the main branch, update at least to the commit\
  \ after [f55a6552b006a381d9167e328808565dd2bf77dc](https://github.com/distribution/distribution/commit/f55a6552b006a381d9167e328808565dd2bf77dc).\n\
  \n### Workarounds\n\nThere is no way to work around this issue without patching. Restrict\
  \ access to the affected API endpoint: see the recommendations section.\n\n### References\n\
  \n`/v2/_catalog` endpoint accepts a parameter to control the maximum amount of records returned\
  \ (query string: `n`).\n\nWhen not given the default `n=100` is used.  The server trusts that\
  \ `n` has an acceptable value, however when using a \nmaliciously large value, it allocates\
  \ an array/slice of `n` of strings before filling the slice with data.\n\nThis behaviour was\
  \ introduced ~7yrs ago [1].\n\n### Recommendation\n\nThe `/v2/_catalog` endpoint was designed\
  \ specifically to do registry syncs with search or other API systems. Such an endpoint would\
  \ create a lot of load on the backend system, due to overfetch required to serve a request\
  \ in certain implementations.\n\nBecause of this, we strongly recommend keeping this API endpoint\
  \ behind heightened privilege and avoiding leaving it exposed to the internet.\n\n###  For\
  \ more information\n\nIf you have any questions or comments about this advisory:\n* Open an\
  \ issue in [distribution repository](https://github.com/distribution/distribution)\n* Email\
  \ us at [cncf-distribution-security@lists.cncf.io](mailto:cncf-distribution-security@lists.cncf.io)\n\
  \n[1] [faulty commit](https://github.com/distribution/distribution/blob/b7e26bac741c76cb792f8e14c41a2163b5dae8df/registry/handlers/catalog.go#L45)"
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-hqxw-f8mx-cpmw/GHSA-hqxw-f8mx-cpmw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
  - CWE-475
references:
  - url: https://github.com/distribution/distribution
    reference_type:
    reference_id:
  - url: https://github.com/distribution/distribution/commit/f55a6552b006a381d9167e328808565dd2bf77dc
    reference_type:
    reference_id:
  - url: https://github.com/distribution/distribution/security/advisories/GHSA-hqxw-f8mx-cpmw
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/06/msg00035.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2189886
    reference_type: bug
    reference_id: 2189886
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-2253
    reference_type:
    reference_id: CVE-2023-2253
