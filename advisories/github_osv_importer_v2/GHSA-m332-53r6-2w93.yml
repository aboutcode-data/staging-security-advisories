advisory_id: GHSA-m332-53r6-2w93
datasource_id: github_osv_importer_v2/GHSA-m332-53r6-2w93
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-m332-53r6-2w93/GHSA-m332-53r6-2w93.json
aliases:
  - CVE-2020-15112
summary: |
  etcd's WAL `ReadAll`  method vulnerable to an entry with large index causing panic
  ### Vulnerability type
  Data Validation

  ### Detail
  In the ReadAll method in wal/wal.go, it is possible to have an entry index greater then the number of entries. This could cause issues when WAL entries are being read during consensus as an arbitrary etcd consensus participant could go down from a runtime panic when reading the entry.

  ### References
  Find out more on this vulnerability in the [security audit report](https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf)

  ### For more information
  If you have any questions or comments about this advisory:
  * Contact the [etcd security committee](https://github.com/etcd-io/etcd/blob/master/security/security-release-process.md)
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-m332-53r6-2w93/GHSA-m332-53r6-2w93.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-129
references:
  - url: https://github.com/etcd-io/etcd
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/commit/7d1cf640497cbcdfb932e619b13624112c7e3865
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/commit/f4b650b51dc4a53a8700700dc12e1242ac56ba07
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/pull/11793
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/security/advisories/GHSA-m332-53r6-2w93
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2020-0005
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15112
    reference_type:
    reference_id: CVE-2020-15112
