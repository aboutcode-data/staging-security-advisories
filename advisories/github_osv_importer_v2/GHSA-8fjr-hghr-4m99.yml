advisory_id: GHSA-8fjr-hghr-4m99
datasource_id: github_osv_importer_v2/GHSA-8fjr-hghr-4m99
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-8fjr-hghr-4m99/GHSA-8fjr-hghr-4m99.json
aliases:
  - CVE-2023-36811
summary: |
  Archive spoofing vulnerability in borgbackup
  ### Impact
  A flaw in the cryptographic authentication scheme in borgbackup allowed an attacker to fake archives and potentially indirectly cause backup data loss in the repository.

  The attack requires an attacker to be able to

  1. insert files (with no additional headers) into backups
  2. gain write access to the repository

  This vulnerability does not disclose plaintext to the attacker, nor does it affect the authenticity of existing archives.

  Creating plausible fake archives may be feasible for empty or small archives, but is unlikely for large archives.

  Affected are all borgbackup releases prior to 1.2.5.

  Note: CVSS scoring model seemed to badly fit for this case, thus I manually set score to "moderate".

  ### Patches
  The issue has been fixed in borgbackup 1.2.5.
  But there was a bug in 1.2.5 upgrade instructions, thus 1.2.6 with an important fix in docs and code was released a day afterwards.

  Additionally to installing the fixed code, users must follow the upgrade procedure as documented in the latest version of the change log.

  ### Workarounds
  Data loss after being attacked can be avoided by reviewing the archives (timestamp and contents valid and as expected) after any "borg check --repair" and before "borg prune".

  ### References

  https://github.com/borgbackup/borg/blob/1.2.6/docs/changes.rst#pre-125-archives-spoofing-vulnerability-cve-2023-36811
impacted_packages:
  - purl: pkg:pypi/borgbackup
    affected_versions: vers:pypi/<1.2.5
    fixed_versions: vers:pypi/1.2.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-8fjr-hghr-4m99/GHSA-8fjr-hghr-4m99.json
  - score: '6.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-8fjr-hghr-4m99/GHSA-8fjr-hghr-4m99.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-347
references:
  - url: https://github.com/borgbackup/borg
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/blob/1.2.5-cvedocs/docs/changes.rst#pre-125-archives-spoofing-vulnerability-cve-2023-36811
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/blob/1.2.6/docs/changes.rst#pre-125-archives-spoofing-vulnerability-cve-2023-36811
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/3eb070191da10c2d3f7bc6484cf3d51c3045f884
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/security/advisories/GHSA-8fjr-hghr-4m99
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/borgbackup/PYSEC-2023-164.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/5Q3OHXERTU547SEQ3YREZXHOCYNLVD63
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XOZDFIYEBIOKSIEAXUJJJFUJTAJ7TF3C
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZUCQSMAWOJBCRGF6XPKEZ2TPGAPNKIWV
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-36811
    reference_type:
    reference_id: CVE-2023-36811
