advisory_id: GHSA-wcvp-r8j8-47pc
datasource_id: github_osv_importer_v2/GHSA-wcvp-r8j8-47pc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-wcvp-r8j8-47pc/GHSA-wcvp-r8j8-47pc.json
aliases:
  - CVE-2021-28028
summary: |
  Double free in toodee
  When inserting rows from an iterator at a particular index, toodee would shift items over, duplicating their ownership. The space reserved for the new elements was based on the len() returned by the ExactSizeIterator.

  This could result in elements in the array being freed twice if the iterator panics. Uninitialized or previously freed elements could also be exposed if the len() didn't match the number of elements.

  These issues were fixed in commit `ced70c17` by temporarily setting the length of the array smaller while processing it and adding assertions on the number of elements returned by the iterator.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-wcvp-r8j8-47pc/GHSA-wcvp-r8j8-47pc.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-415
references:
  - url: https://github.com/antonmarsden/toodee
    reference_type:
    reference_id:
  - url: https://github.com/antonmarsden/toodee/commit/ced70c172486fb4827c172cd8238053df3d1dcdb
    reference_type:
    reference_id:
  - url: https://github.com/antonmarsden/toodee/issues/13
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0028.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28028
    reference_type:
    reference_id: CVE-2021-28028
