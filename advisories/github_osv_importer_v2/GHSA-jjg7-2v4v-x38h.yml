advisory_id: GHSA-jjg7-2v4v-x38h
datasource_id: github_osv_importer_v2/GHSA-jjg7-2v4v-x38h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-jjg7-2v4v-x38h/GHSA-jjg7-2v4v-x38h.json
aliases:
  - CVE-2024-3651
summary: |
  Internationalized Domain Names in Applications (IDNA) vulnerable to denial of service from specially crafted inputs to idna.encode
  ### Impact
  A specially crafted argument to the `idna.encode()` function could consume significant resources. This may lead to a denial-of-service.

  ### Patches
  The function has been refined to reject such strings without the associated resource consumption in version 3.7.

  ### Workarounds
  Domain names cannot exceed 253 characters in length, if this length limit is enforced prior to passing the domain to the `idna.encode()` function it should no longer consume significant resources. This is triggered by arbitrarily large inputs that would not occur in normal usage, but may be passed to the library assuming there is no preliminary input validation by the higher-level application.

  ### References
  * https://huntr.com/bounties/93d78d07-d791-4b39-a845-cbfabc44aadb
impacted_packages:
  - purl: pkg:pypi/idna
    affected_versions: vers:pypi/<3.7
    fixed_versions: vers:pypi/3.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-jjg7-2v4v-x38h/GHSA-jjg7-2v4v-x38h.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-jjg7-2v4v-x38h/GHSA-jjg7-2v4v-x38h.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
  - CWE-400
references:
  - url: https://github.com/kjd/idna
    reference_type:
    reference_id:
  - url: https://github.com/kjd/idna/commit/1d365e17e10d72d0b7876316fc7b9ca0eebdd38d
    reference_type:
    reference_id:
  - url: https://github.com/kjd/idna/security/advisories/GHSA-jjg7-2v4v-x38h
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/idna/PYSEC-2024-60.yaml
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/93d78d07-d791-4b39-a845-cbfabc44aadb
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/05/msg00006.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4YQUPYH3SVZ5GFF2CDQ55FCM575AZTF2
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/F2S5E23N6E52S46KGNYTDFB75LOC4N4D
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/S5IDLLD2IKSIVRBSLB34WTSYGLMWUFWF
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ULSC7HBJKXB3BZV367WM5BR6DFEC4Z43
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-3651
    reference_type:
    reference_id: CVE-2024-3651
