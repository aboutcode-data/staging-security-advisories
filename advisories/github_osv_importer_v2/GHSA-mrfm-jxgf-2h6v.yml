advisory_id: GHSA-mrfm-jxgf-2h6v
datasource_id: github_osv_importer_v2/GHSA-mrfm-jxgf-2h6v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-mrfm-jxgf-2h6v/GHSA-mrfm-jxgf-2h6v.json
aliases:
  - CVE-2014-3120
summary: |
  Elasticsearch Improper Access Control vulnerability
  The default configuration in Elasticsearch before 1.4.0.Beta1 enables dynamic scripting, which allows remote attackers to execute arbitrary MVEL expressions and Java code via the source parameter to _search.  NOTE: this only violates the vendor's intended security policy if the user does not run Elasticsearch in its own independent virtual machine.
impacted_packages:
  - purl: pkg:maven/org.elasticsearch/elasticsearch
    affected_versions: vers:maven/<1.4.0.Beta1
    fixed_versions: vers:maven/1.4.0.Beta1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N/E:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-mrfm-jxgf-2h6v/GHSA-mrfm-jxgf-2h6v.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
references:
  - url: http://bouk.co/blog/elasticsearch-rce
    reference_type:
    reference_id:
  - url: https://github.com/elastic/elasticsearch
    reference_type:
    reference_id:
  - url: https://github.com/elastic/elasticsearch/commit/bd0eb32d9c3c3f5b6e5f8630c859cd04bdcd4e06
    reference_type:
    reference_id:
  - url: https://github.com/elastic/elasticsearch/commit/f9de8b65898509e038e33215db0720b508477a12
    reference_type:
    reference_id:
  - url: https://github.com/elastic/elasticsearch/issues/7151
    reference_type:
    reference_id:
  - url: https://github.com/elastic/elasticsearch/pull/7642
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20140813071419/http://www.securityfocus.com/bid/67731
    reference_type:
    reference_id:
  - url: https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2014-3120
    reference_type:
    reference_id:
  - url: https://www.elastic.co/blog/logstash-1-4-3-released
    reference_type:
    reference_id:
  - url: https://www.elastic.co/community/security
    reference_type:
    reference_id:
  - url: https://www.found.no/foundation/elasticsearch-security/#staying-safe-while-developing-with-elasticsearch
    reference_type:
    reference_id:
  - url: http://www.exploit-db.com/exploits/33370
    reference_type:
    reference_id:
  - url: http://www.rapid7.com/db/modules/exploit/multi/elasticsearch/script_mvel_rce
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2014-3120
    reference_type:
    reference_id: CVE-2014-3120
