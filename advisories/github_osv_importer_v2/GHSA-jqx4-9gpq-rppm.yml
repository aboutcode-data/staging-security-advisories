advisory_id: GHSA-jqx4-9gpq-rppm
datasource_id: github_osv_importer_v2/GHSA-jqx4-9gpq-rppm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-jqx4-9gpq-rppm/GHSA-jqx4-9gpq-rppm.json
aliases: []
summary: |
  @misskey-dev/summaly allows IP Filter Bypass via Redirect
  ### Summary
  Due to a validation error in `got.scpaping`, it is possible to use an HTTP redirect to avoid IP filtering.

  ### Details
  In `got.scpaping`, Summaly first makes a HTTP `HEAD` request to the page being summarized. It then preforms private IP address checks on the `HEAD` response, then makes an additional HTTP `GET` request to the page being summarized. Unfortunately, since private IP address checks aren't performed on the `GET` response, the `GET` response can issue a HTTP redirect to a private IP address, which will succeed, regardless of if private IP addresses are allowed by Summaly.

  ### PoC
  With a simple Caddy webserver, you can get Summaly to summarize a page hosted via a local IP address:
  ```caddy
  @summaly-bypass-head {
      method HEAD
      path /summaly-bypass
  }
  @summaly-bypass-get {
      method GET
      path /summaly-bypass
  }
  header @summaly-bypass-head Content-Type "text/html"
  respond @summaly-bypass-head 200
  redir @summaly-bypass-get http://127.0.0.1:3080/
  ```

  ### Impact
  Using this bypass, an attacker can probe a victims internal network for HTTP services that aren't supposed to be exposed to the outside world. While they might only have read-only access through this, it may still be possible to extract sensitive information or be used to probe a network prior to attacking via other exploits without leaving a trace.
impacted_packages:
  - purl: pkg:npm/%40misskey-dev/summaly
    affected_versions: vers:npm/>=5.1.0|<5.2.1
    fixed_versions: vers:npm/5.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-jqx4-9gpq-rppm/GHSA-jqx4-9gpq-rppm.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-346
references:
  - url: https://github.com/misskey-dev/summaly
    reference_type:
    reference_id:
  - url: https://github.com/misskey-dev/summaly/commit/dfe6451012aac42eabe71d4ed721d8058c4066b4
    reference_type:
    reference_id:
  - url: https://github.com/misskey-dev/summaly/security/advisories/GHSA-jqx4-9gpq-rppm
    reference_type:
    reference_id:
