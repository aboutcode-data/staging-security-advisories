advisory_id: GHSA-65mj-f7p4-wggq
datasource_id: github_osv_importer_v2/GHSA-65mj-f7p4-wggq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-65mj-f7p4-wggq/GHSA-65mj-f7p4-wggq.json
aliases:
  - CVE-2025-66309
summary: "Grav is vulnerable to Cross-Site Scripting (XSS) Reflected endpoint /admin/pages/[page],\
  \ parameter data[header][content][items], located in the \"Blog Config\" tab\n## Summary\n\
  \nA Reflected Cross-Site Scripting (XSS) vulnerability was identified in the `/admin/pages/[page]`\
  \ endpoint of the _Grav_ application. This vulnerability allows attackers to inject malicious\
  \ scripts into the `data[header][content][items]` parameter.\n\n---\n\n## Details\n\n**Vulnerable\
  \ Endpoint:** `GET /admin/pages/[page]`  \n**Parameter:** `data[header][content][items]`\n\
  \nThe application fails to properly validate and sanitize user input in the `data[header][content][items]`\
  \ parameter. As a result, attackers can craft a malicious URL with an XSS payload. When this\
  \ URL is accessed, the injected script is reflected back in the HTTP response and executed\
  \ within the context of the victim's browser session.\n\n---\n\n## PoC\n\n**Payload:**\n\n\
  `\"><ImG sRc=x OnErRoR=alert('XSS-PoC3')>`\n\n1. Log in to the _Grav_ Admin Panel and navigate\
  \ to **Pages**.\n    \n2. Create a new page or edit an existing one.\n    \n3. In the **Advanced\
  \ > Blog Config > Items** field (which maps to `data[header][content][items]`), insert the\
  \ payload above.\n\n![image](https://github.com/user-attachments/assets/ae77d92a-2e09-4b67-b3ae-5e317b9d518f)\n\
  \n4. Save the page.\n     \n5. The malicious payload is reflected and rendered by the application\
  \ without proper sanitization. The JavaScript code is immediately executed in the browser.\n\
  \n![image](https://github.com/user-attachments/assets/328b0714-750a-421d-ad5e-ea7f148dca8f)\n\
  \n---\n\n## Impact\n\nReflected cross-site scripting (XSS) attacks can have serious consequences,\
  \ including:\n\n- **User actions:** Attackers can perform actions on behalf of the user\n\
  \    \n- **Data theft:** Sensitive information such as session cookies can be stolen\n   \
  \ \n- **Account compromise:** Attackers may impersonate legitimate users\n    \n- **Malicious\
  \ code execution:** Arbitrary JavaScript code can run in the user’s browser\n    \n- **Website\
  \ defacement or misinformation:** Malicious output may be injected visually\n    \n- **User\
  \ redirection:** Victims may be redirected to phishing or malicious websites\n\nby [CVE-Hunters](https://github.com/Sec-Dojo-Cyber-House/cve-hunters)"
impacted_packages:
  - purl: pkg:composer/getgrav/grav
    affected_versions: vers:composer/<1.8.0-beta.27
    fixed_versions: vers:composer/1.8.0-beta.27
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:A/VC:L/VI:L/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-65mj-f7p4-wggq/GHSA-65mj-f7p4-wggq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/getgrav/grav
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-65mj-f7p4-wggq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66309
    reference_type:
    reference_id:
