advisory_id: GHSA-3mwq-h3g6-ffhm
datasource_id: github_osv_importer_v2/GHSA-3mwq-h3g6-ffhm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-3mwq-h3g6-ffhm/GHSA-3mwq-h3g6-ffhm.json
aliases:
  - CVE-2023-44386
summary: |
  Vapor's incorrect request error handling triggers server crash
  Vapor incorrectly handles errors encountered during parsing of HTTP 1.x requests, triggering a precondition failure in swift-nio due to API misuse and causing immediate termination of the server process.

  ### Impact
  This is a denial of service vulnerability, impacting all users of affected versions of Vapor. Because the crash is an explicit assertion failure, there is no corruption of process state and no risk of data leakage or unauthorized code execution. Total impact is limited to an immediately recoverable service interruption.

  ### Patches
  The issue is fixed as of Vapor release 4.84.2.

  ### Workarounds
  None known at this time.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [the Vapor repo](https://github.com/vapor/vapor)
  * Ask in [Vapor Discord](http://vapor.team)

  ### Acknowledgements

  Full credit for reporting this issue goes to @t0rchwo0d, with additional thanks for responsibly disclosing.
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-3mwq-h3g6-ffhm/GHSA-3mwq-h3g6-ffhm.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-231
references:
  - url: https://github.com/vapor/vapor
    reference_type:
    reference_id:
  - url: https://github.com/vapor/vapor/commit/090464a654b03148b139a81f8f5ac63b0856f6f3
    reference_type:
    reference_id:
  - url: https://github.com/vapor/vapor/releases/tag/4.84.2
    reference_type:
    reference_id:
  - url: https://github.com/vapor/vapor/security/advisories/GHSA-3mwq-h3g6-ffhm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-44386
    reference_type:
    reference_id: CVE-2023-44386
