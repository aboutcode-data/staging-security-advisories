advisory_id: GHSA-h4h5-3hr4-j3g2
datasource_id: github_osv_importer_v2/GHSA-h4h5-3hr4-j3g2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-h4h5-3hr4-j3g2/GHSA-h4h5-3hr4-j3g2.json
aliases:
  - CVE-2022-3171
summary: "protobuf-java has a potential Denial of Service issue\n## Summary\nA potential Denial\
  \ of Service issue in `protobuf-java` core and lite was discovered in the parsing procedure\
  \ for binary and text format data. Input streams containing multiple instances of non-repeated\
  \ [embedded messages](http://developers.google.com/protocol-buffers/docs/encoding#embedded)\
  \ with repeated or unknown fields causes objects to be converted back-n-forth between mutable\
  \ and immutable forms, resulting in potentially long garbage collection pauses. \n\nReporter:\
  \ [OSS Fuzz](https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=48771)\n\nAffected versions:\
  \ This issue affects both the Java full and lite Protobuf runtimes, as well as Protobuf for\
  \ Kotlin and JRuby, which themselves use the Java Protobuf runtime.\n\n## Severity\n\n[CVE-2022-3171](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3171)\
  \ Medium - CVSS Score: 5.7 (NOTE: there may be a delay in publication)\n\n## Remediation and\
  \ Mitigation\n\nPlease update to the latest available versions of the following packages:\n\
  \nprotobuf-java (3.21.7, 3.20.3, 3.19.6, 3.16.3)\nprotobuf-javalite (3.21.7, 3.20.3, 3.19.6,\
  \ 3.16.3)\nprotobuf-kotlin (3.21.7, 3.20.3, 3.19.6, 3.16.3)\nprotobuf-kotlin-lite (3.21.7,\
  \ 3.20.3, 3.19.6, 3.16.3)\ngoogle-protobuf [JRuby gem only] (3.21.7, 3.20.3, 3.19.6)"
impacted_packages:
  - purl: pkg:maven/com.google.protobuf/protobuf-java
    affected_versions: vers:maven/>=3.21.0-rc-1|<3.21.7
    fixed_versions: vers:maven/3.21.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-kotlin
    affected_versions: vers:maven/>=3.21.0-rc-1|<3.21.7
    fixed_versions: vers:maven/3.21.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/google-protobuf
    affected_versions: vers:gem/>=3.21.0.rc.1|<3.21.7
    fixed_versions: vers:gem/3.21.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-javalite
    affected_versions: vers:maven/>=3.21.0-rc-1|<3.21.7
    fixed_versions: vers:maven/3.21.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-kotlin-lite
    affected_versions: vers:maven/>=3.21.0-rc-1|<3.21.7
    fixed_versions: vers:maven/3.21.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-java
    affected_versions: vers:maven/>=3.20.0-rc-1|<3.20.3
    fixed_versions: vers:maven/3.20.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-java
    affected_versions: vers:maven/>=3.17.0-rc-1|<3.19.6
    fixed_versions: vers:maven/3.19.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-java
    affected_versions: vers:maven/<3.16.3
    fixed_versions: vers:maven/3.16.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-kotlin
    affected_versions: vers:maven/>=3.20.0-rc-1|<3.20.3
    fixed_versions: vers:maven/3.20.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-kotlin
    affected_versions: vers:maven/>=3.17.0-rc-1|<3.19.6
    fixed_versions: vers:maven/3.19.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-kotlin
    affected_versions: vers:maven/<3.16.3
    fixed_versions: vers:maven/3.16.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/google-protobuf
    affected_versions: vers:gem/>=3.20.0.rc.1|<3.20.3
    fixed_versions: vers:gem/3.20.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/google-protobuf
    affected_versions: vers:gem/>=3.17.0.rc.1|<3.19.6
    fixed_versions: vers:gem/3.19.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/google-protobuf
    affected_versions: vers:gem/<3.16.3
    fixed_versions: vers:gem/3.16.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-javalite
    affected_versions: vers:maven/>=3.20.0-rc-1|<3.20.3
    fixed_versions: vers:maven/3.20.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-javalite
    affected_versions: vers:maven/>=3.17.0-rc-1|<3.19.6
    fixed_versions: vers:maven/3.19.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-javalite
    affected_versions: vers:maven/<3.16.3
    fixed_versions: vers:maven/3.16.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-kotlin-lite
    affected_versions: vers:maven/>=3.20.0-rc-1|<3.20.3
    fixed_versions: vers:maven/3.20.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-kotlin-lite
    affected_versions: vers:maven/>=3.17.0-rc-1|<3.19.6
    fixed_versions: vers:maven/3.19.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.google.protobuf/protobuf-kotlin-lite
    affected_versions: vers:maven/<3.16.3
    fixed_versions: vers:maven/3.16.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-h4h5-3hr4-j3g2/GHSA-h4h5-3hr4-j3g2.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=48771
    reference_type:
    reference_id:
  - url: https://github.com/protocolbuffers/protobuf
    reference_type:
    reference_id:
  - url: https://github.com/protocolbuffers/protobuf/releases/tag/v21.7
    reference_type:
    reference_id:
  - url: https://github.com/protocolbuffers/protobuf/releases/tag/v3.16.3
    reference_type:
    reference_id:
  - url: https://github.com/protocolbuffers/protobuf/releases/tag/v3.19.6
    reference_type:
    reference_id:
  - url: https://github.com/protocolbuffers/protobuf/releases/tag/v3.20.3
    reference_type:
    reference_id:
  - url: https://github.com/protocolbuffers/protobuf/security/advisories/GHSA-h4h5-3hr4-j3g2
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/google-protobuf/CVE-2022-3171.yml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/CBAUKJQL6O4TIWYBENORSY5P43TVB4M3
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MPCGUT3T5L6C3IDWUPSUO22QDCGQKTOP
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202301-09
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-3171
    reference_type:
    reference_id: CVE-2022-3171
