advisory_id: GHSA-446w-rrm4-r47f
datasource_id: github_osv_importer_v2/GHSA-446w-rrm4-r47f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-446w-rrm4-r47f/GHSA-446w-rrm4-r47f.json
aliases:
  - CVE-2022-24725
summary: |
  Exposure of home directory through shescape on Unix with Bash
  ### Impact

  The issue allows for exposure of the home directory on Unix systems when using Bash with the `escape` or `escapeAll` functions from the _shescape_ API with the `interpolation` option set to `true`. Other tested shells, Dash and Zsh, are not affected.

  ```javascript
  const cp = require("child_process");
  const shescape = require("shescape");

  const payload = "home_directory=~";
  const options = { interpolation: true };
  console.log(cp.execSync(`echo ${shescape.escape(payload, options)}`));
  // home_directory=/home/user
  ```

  Depending on how the output of _shescape_ is used, directory traversal may be possible in the application using _shescape_.

  ### Patches

  The issue was patched in `v1.5.1`.

  ### Workarounds

  Manually escape all instances of the tilde character (`~`) using `arg.replace(/~/g, "\\~")`.

  ### References

  See GitHub issue https://github.com/ericcornelissen/shescape/issues/169.
impacted_packages:
  - purl: pkg:npm/shescape
    affected_versions: vers:npm/>=1.4.0|<1.5.1
    fixed_versions: vers:npm/1.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-446w-rrm4-r47f/GHSA-446w-rrm4-r47f.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-78
references:
  - url: https://github.com/ericcornelissen/shescape
    reference_type:
    reference_id:
  - url: https://github.com/ericcornelissen/shescape/issues/169
    reference_type:
    reference_id:
  - url: https://github.com/ericcornelissen/shescape/pull/170
    reference_type:
    reference_id:
  - url: https://github.com/ericcornelissen/shescape/security/advisories/GHSA-446w-rrm4-r47f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24725
    reference_type:
    reference_id: CVE-2022-24725
