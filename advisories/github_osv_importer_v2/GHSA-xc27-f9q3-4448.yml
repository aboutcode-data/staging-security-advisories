advisory_id: GHSA-xc27-f9q3-4448
datasource_id: github_osv_importer_v2/GHSA-xc27-f9q3-4448
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-xc27-f9q3-4448/GHSA-xc27-f9q3-4448.json
aliases:
  - CVE-2023-41057
summary: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') in\
  \ hyper-bump-it\n### Summary\n`hyper-bump-it` reads a file glob pattern from the configuration\
  \ file. That is combined with the project root directory to construct a full glob pattern\
  \ that is used to find files that should be edited. These matched files should be contained\
  \ within the project root directory, but that is not checked. This could result in changes\
  \ being written to files outside of the project.\n\nThe default behaviour of `hyper-bump-it`\
  \ is to display the planned changes and prompt the user for confirmation before editing any\
  \ files. However, the configuration file provides a field that can be used cause files to\
  \ be edited without displaying the prompt.\n\n### Details\n\nThe vulnerability is present\
  \ in \n\nhttps://github.com/plannigan/hyper-bump-it/blob/49c726201bbdc02c052302e03fd907d2170e1f47/hyper_bump_it/_hyper_bump_it/files.py#L35\n\
  \nThat code joins the project root directory with a string read from the configuration file\
  \ without checking if the final path is located outside the project root directory.\n\nThe\
  \ following configuration file contents would cause `hyper-bump-it` to replace every instance\
  \ of \"hello\" in every file adjacent to the project root directory with \"world\". The line\
  \ setting  `show_confirm_prompt` to `false` is not required, but will result in the user file\
  \ edits to occur without the user having a chance to reject the changes (The fact that changes\
  \ happened would still be displayed). \n\n```toml\n[hyper-bump-it]\ncurrent_version = \"1.2.3\"\
  \nshow_confirm_prompt=false\n\n[[hyper-bump-it.files]]\nfile_glob = \"../*\"\nsearch_format_pattern\
  \ = \"hello\"\nreplace_format_pattern = \"world\"\n```\n\n### Patches\nA fix that been released\
  \ as part of v0.5.1. The changes can be view as part of  PR #307.\n\n### Workarounds\nUsers\
  \ that are unable to update from vulnerable versions, executing `hyper-bump-it` with the `--interactive`\
  \ command line argument will ensure that all planned changes are displayed and prompt the\
  \ user for confirmation before editing any files, even if the configuration file contains\
  \ `show_confirm_prompt=true`."
impacted_packages:
  - purl: pkg:pypi/hyper-bump-it
    affected_versions: vers:pypi/<0.5.1
    fixed_versions: vers:pypi/0.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-xc27-f9q3-4448/GHSA-xc27-f9q3-4448.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/plannigan/hyper-bump-it
    reference_type:
    reference_id:
  - url: https://github.com/plannigan/hyper-bump-it/pull/307
    reference_type:
    reference_id:
  - url: https://github.com/plannigan/hyper-bump-it/security/advisories/GHSA-xc27-f9q3-4448
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41057
    reference_type:
    reference_id: CVE-2023-41057
