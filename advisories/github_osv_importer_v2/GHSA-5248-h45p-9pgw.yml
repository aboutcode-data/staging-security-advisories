advisory_id: GHSA-5248-h45p-9pgw
datasource_id: github_osv_importer_v2/GHSA-5248-h45p-9pgw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-5248-h45p-9pgw/GHSA-5248-h45p-9pgw.json
aliases:
  - CVE-2024-39909
summary: |
  SQL Injection in the KubeClarity REST API
  ### Summary
  A time/boolean SQL Injection is present in the following resource `/api/applicationResources` via the following parameter `packageID`

  ### Details
  As it can be seen [here](https://github.com/openclarity/kubeclarity/blob/main/backend/pkg/database/id_view.go#L79), while building the SQL Query the `fmt.Sprintf` function is used to build the query string without the input having first been subjected to any validation.

  ### PoC
  The following command should be able to trigger a basic version of the behavior:
  `curl -i -s -k -X $'GET' \
      -H $'Host: kubeclarity.test' \
      $'https://kubeclarity.test/api/applicationResources?page=1&pageSize=50&sortKey=vulnerabilities&sortDir=DESC&packageID=c89973a6-4e7f-50b5-afe2-6bf6f4d3da0a\'HTTP/2'`

  ### Impact
  While using the Helm chart, the impact of this vulnerability is limited since it allows read access only to the kuberclarity database, to which access is already given as far as I understand to regular users anyway.
  On the other hand, if Kuberclarity is deployed in a less secure way, this might allow access to more data then allowed or expected (beyond the limits of the KuberClarity database). The vulnerable line was introduced as part of the initial commit of Kubeclarity, so all versions up until the latest (2.23.1) are assumed vulnerable.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-5248-h45p-9pgw/GHSA-5248-h45p-9pgw.json
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-5248-h45p-9pgw/GHSA-5248-h45p-9pgw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/openclarity/kubeclarity
    reference_type:
    reference_id:
  - url: https://github.com/openclarity/kubeclarity/blob/main/backend/pkg/database/id_view.go#L79
    reference_type:
    reference_id:
  - url: https://github.com/openclarity/kubeclarity/commit/1d1178840703a72d9082b7fc4aea0a3326c5d294
    reference_type:
    reference_id:
  - url: https://github.com/openclarity/kubeclarity/security/advisories/GHSA-5248-h45p-9pgw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-39909
    reference_type:
    reference_id: CVE-2024-39909
