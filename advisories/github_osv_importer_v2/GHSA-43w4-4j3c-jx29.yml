advisory_id: GHSA-43w4-4j3c-jx29
datasource_id: github_osv_importer_v2/GHSA-43w4-4j3c-jx29
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-43w4-4j3c-jx29/GHSA-43w4-4j3c-jx29.json
aliases:
  - CVE-2023-52084
summary: |
  Winter CMS Stored XSS through Backend ColorPicker FormWidget
  ### Impact
  Users with access to backend forms that include a [ColorPicker FormWidget](https://wintercms.com/docs/v1.2/docs/backend/forms#color-picker) can provide a value that would then be rendered unescaped in the backend form, potentially allowing for a stored XSS attack.

  By default, only the Brand Settings (`backend.manage_branding`) and Mail Brand Settings (`system.manage_mail_templates`) forms include the `colorpicker` formwidget, however it is also common for theme's to include it on their Theme Customization (`cms.manage_theme_options`) form.

  Although this was a security issue, it's important to note that its severity is relatively low. To exploit the vulnerability, an attacker would already need to have trusted access to the Winter CMS backend and they would then need to convince a user with higher privileges than them to visit an affected Form in the backend.

  These two factors limit the potential harm of this vulnerability. That being said, all users are advised to update to the latest version (1.2.4) to ensure their systems remain secure.

  ### Patches
  This issue has been patched in v1.2.4.

  ### Workarounds
  Apply https://github.com/wintercms/winter/commit/517f65dfae679b57575b047de13c5af48915a5ba manually if unable to upgrade to v1.2.4.
impacted_packages:
  - purl: pkg:composer/winter/wn-backend-module
    affected_versions: vers:composer/<1.2.4
    fixed_versions: vers:composer/1.2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-43w4-4j3c-jx29/GHSA-43w4-4j3c-jx29.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/wintercms/winter
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/winter/commit/517f65dfae679b57575b047de13c5af48915a5ba
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/winter/security/advisories/GHSA-43w4-4j3c-jx29
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52084
    reference_type:
    reference_id: CVE-2023-52084
