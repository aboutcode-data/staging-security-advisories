advisory_id: GHSA-5phf-pp7p-vc2r
datasource_id: github_osv_importer_v2/GHSA-5phf-pp7p-vc2r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-5phf-pp7p-vc2r/GHSA-5phf-pp7p-vc2r.json
aliases:
  - CVE-2021-28363
summary: |
  Using default SSLContext for HTTPS requests in an HTTPS proxy doesn't verify certificate hostname for proxy connection
  ### Impact

  Users who are using an HTTPS proxy to issue HTTPS requests and haven't configured their own SSLContext via `proxy_config`.
  Only the default SSLContext is impacted.

  ### Patches

  [urllib3 >=1.26.4 has the issue resolved](https://github.com/urllib3/urllib3/releases/tag/1.26.4). urllib3<1.26 is not impacted due to not supporting HTTPS requests via HTTPS proxies.

  ### Workarounds

  Upgrading is recommended as this is a minor release and not likely to break current usage.

  Configuring an `SSLContext` with `check_hostname=True` and passing via `proxy_config` instead of relying on the default `SSLContext`

  ### For more information
  If you have any questions or comments about this advisory:
  * Email us at [sethmichaellarson@gmail.com](mailto:sethmichaellarson@gmail.com)
impacted_packages:
  - purl: pkg:pypi/urllib3
    affected_versions: vers:pypi/>=1.26.0|<1.26.4
    fixed_versions: vers:pypi/1.26.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-5phf-pp7p-vc2r/GHSA-5phf-pp7p-vc2r.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-5phf-pp7p-vc2r/GHSA-5phf-pp7p-vc2r.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-295
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/urllib3/PYSEC-2021-59.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-db/tree/main/vulns/urllib3/PYSEC-2021-59.yaml
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/blob/main/CHANGES.rst#1264-2021-03-15
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/commit/8d65ea1ecf6e2cdc27d42124e587c1b83a3118b0
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/commits/main
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/releases/tag/1.26.4
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/security/advisories/GHSA-5phf-pp7p-vc2r
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4S65ZQVZ2ODGB52IC7VJDBUK4M5INCXL
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4S65ZQVZ2ODGB52IC7VJDBUK4M5INCXL
    reference_type:
    reference_id:
  - url: https://pypi.org/project/urllib3/1.26.4
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202107-36
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202305-02
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240621-0007
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuoct2021.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28363
    reference_type:
    reference_id: CVE-2021-28363
