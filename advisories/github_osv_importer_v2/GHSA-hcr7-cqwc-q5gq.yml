advisory_id: GHSA-hcr7-cqwc-q5gq
datasource_id: github_osv_importer_v2/GHSA-hcr7-cqwc-q5gq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-hcr7-cqwc-q5gq/GHSA-hcr7-cqwc-q5gq.json
aliases:
  - CVE-2024-34693
summary: |
  Apache Superset server arbitrary file read
  Improper Input Validation vulnerability in Apache Superset, allows for an authenticated attacker to create a MariaDB connection with local_infile enabled. If both the MariaDB server (off by default) and the local mysql client on the web server are set to allow for local infile, it's possible for the attacker to execute a specific MySQL/MariaDB SQL command that is able to read files from the server and insert their content on a MariaDB database table. This issue affects Apache Superset before version 3.1.3 and in version 4.0.0.

  Users are recommended to upgrade to version 4.0.1 or 3.1.3, both of which fix the issue.
impacted_packages:
  - purl: pkg:pypi/apache-superset
    affected_versions: vers:pypi/<3.1.3
    fixed_versions: vers:pypi/3.1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/apache-superset
    affected_versions: vers:pypi/>=4.0.0|<4.0.1
    fixed_versions: vers:pypi/4.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-hcr7-cqwc-q5gq/GHSA-hcr7-cqwc-q5gq.json
  - score: '4.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:N/VI:N/VA:N/SC:H/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-hcr7-cqwc-q5gq/GHSA-hcr7-cqwc-q5gq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/apache/superset
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/1803x1s34m7r71h1k0q1njol8k6fmyon
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/06/20/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-34693
    reference_type:
    reference_id: CVE-2024-34693
