advisory_id: GHSA-59hf-mpf8-pqjh
datasource_id: github_osv_importer_v2/GHSA-59hf-mpf8-pqjh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-59hf-mpf8-pqjh/GHSA-59hf-mpf8-pqjh.json
aliases:
  - CVE-2024-47003
summary: |
  Mattermost fails to strip `embeds` from `metadata` when broadcasting `posted` events
  Mattermost does not strip `embeds` from `metadata` when broadcasting `posted` events.

  This allows users to include arbitrary embeds in posts, which are then broadcasted via websockets. This can be exploited in many ways, for example to create permalinks with fully customizable content or to trigger a client Side Denial of Service (DoS) by sending a permalink with a non-string message.

  The advisory metadata references the appropriate go pseudo version available from pkg.go.dev
impacted_packages: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-59hf-mpf8-pqjh/GHSA-59hf-mpf8-pqjh.json
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-59hf-mpf8-pqjh/GHSA-59hf-mpf8-pqjh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/c0rydoras/cves/tree/main/CVE-2024-47003
    reference_type:
    reference_id:
  - url: https://github.com/mattermost/mattermost
    reference_type:
    reference_id:
  - url: https://github.com/mattermost/mattermost/commit/69a8b3df0f9fd3a7a5b792ec678b6191618d039b
    reference_type:
    reference_id:
  - url: https://github.com/mattermost/mattermost/pull/27763
    reference_type:
    reference_id:
  - url: https://mattermost.com/security-updates
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47003
    reference_type:
    reference_id: CVE-2024-47003
