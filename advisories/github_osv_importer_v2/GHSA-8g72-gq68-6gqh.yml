advisory_id: GHSA-8g72-gq68-6gqh
datasource_id: github_osv_importer_v2/GHSA-8g72-gq68-6gqh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-8g72-gq68-6gqh/GHSA-8g72-gq68-6gqh.json
aliases:
  - CVE-2017-1000481
summary: |
  Products.CMFPlone Open Redirect Vulnerability
  When you visit a page where you need to login, Plone 2.5-5.1rc1 sends you to the login form with a 'came_from' parameter set to the previous url. After you login, you get redirected to the page you tried to view before. An attacker might try to abuse this by letting you click on a specially crafted link. You would login, and get redirected to the site of the attacker, letting you think that you are still on the original Plone site. Or some javascript of the attacker could be executed. Most of these types of attacks are already blocked by Plone, using the `isURLInPortal` check to make sure we only redirect to a page on the same Plone site. But a few more ways of tricking Plone into accepting a malicious link were discovered, and fixed with this hotfix.
impacted_packages:
  - purl: pkg:pypi/products.cmfplone
    affected_versions: vers:pypi/<4.3.17
    fixed_versions: vers:pypi/4.3.17
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/products.cmfplone
    affected_versions: vers:pypi/>=5.0.0|<5.0.10
    fixed_versions: vers:pypi/5.0.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/products.cmfplone
    affected_versions: vers:pypi/>=5.1a1|<5.1.0
    fixed_versions: vers:pypi/5.1.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/plone
    affected_versions: vers:pypi/>=2.5|<4.3.16
    fixed_versions: vers:pypi/4.3.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/plone
    affected_versions: vers:pypi/>=5|<5.1.0
    fixed_versions: vers:pypi/5.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-8g72-gq68-6gqh/GHSA-8g72-gq68-6gqh.json
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-8g72-gq68-6gqh/GHSA-8g72-gq68-6gqh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/plone/Products.CMFPlone
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.CMFPlone/commit/05a943ecbcdda56bacc93b55c9e2e908d8a7dfab
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.CMFPlone/commit/0e50e1e67ea3b6d3187f78cb1a1628081f654d3b
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.CMFPlone/commit/236b62b756ff46a92783b3897e717dfb15eb07d8
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.CMFPlone/commit/7db5b2c8fb684055987b8c4fdedc29289bd26373
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.CMFPlone/issues/2232
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.CMFPlone/pull/2233
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.CMFPlone/pull/2234
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.CMFPlone/pull/2235
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.CMFPlone/pull/2236
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/plone/PYSEC-2018-70.yaml
    reference_type:
    reference_id:
  - url: https://plone.org/security/hotfix/20171128/open-redirection-on-login-form
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-1000481
    reference_type:
    reference_id: CVE-2017-1000481
