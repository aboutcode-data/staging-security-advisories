advisory_id: GHSA-pgw7-wx7w-2w33
datasource_id: github_osv_importer_v2/GHSA-pgw7-wx7w-2w33
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-pgw7-wx7w-2w33/GHSA-pgw7-wx7w-2w33.json
aliases:
  - CVE-2022-32210
summary: "ProxyAgent vulnerable to MITM\n### Description\n\n`Undici.ProxyAgent` never verifies\
  \ the remote server's certificate, and always exposes all request & response data to the proxy.\
  \ This unexpectedly means that proxies can MitM all HTTPS traffic, and if the proxy's URL\
  \ is HTTP then it also means that nominally HTTPS requests are actually sent via plain-text\
  \ HTTP between Undici and the proxy server.\n\n### Impact\n\nThis affects all use of HTTPS\
  \ via HTTP proxy using **`Undici.ProxyAgent`**  with Undici or Node's global `fetch`. In this\
  \ case, it removes all HTTPS security from all requests sent using Undici's `ProxyAgent`,\
  \ allowing trivial MitM attacks by anybody on the network path between the client and the\
  \ target server (local network users, your ISP, the proxy, the target server's ISP, etc).\n\
  This less seriously affects HTTPS via HTTPS proxies. When you send HTTPS via a proxy to a\
  \ remote server, the proxy can freely view or modify all HTTPS traffic unexpectedly (but only\
  \ the proxy). \n\n### Patches\n\nThis issue was patched in Undici v5.5.1.\n\n### Workarounds\n\
  \nAt the time of writing, the only workaround is to not use `ProxyAgent` as a dispatcher for\
  \ TLS Connections."
impacted_packages:
  - purl: pkg:npm/undici
    affected_versions: vers:npm/<=5.5.0
    fixed_versions: vers:npm/5.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-pgw7-wx7w-2w33/GHSA-pgw7-wx7w-2w33.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-295
references:
  - url: https://github.com/nodejs/undici
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/undici/security/advisories/GHSA-pgw7-wx7w-2w33
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1583680
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-32210
    reference_type:
    reference_id: CVE-2022-32210
