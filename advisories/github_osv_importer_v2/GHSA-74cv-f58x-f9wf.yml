advisory_id: GHSA-74cv-f58x-f9wf
datasource_id: github_osv_importer_v2/GHSA-74cv-f58x-f9wf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-74cv-f58x-f9wf/GHSA-74cv-f58x-f9wf.json
aliases:
  - CVE-2021-21343
summary: |
  XStream is vulnerable to an Arbitrary File Deletion on the local host when unmarshalling as long as the executing process has sufficient rights
  ### Impact
  The processed stream at unmarshalling time contains type information to recreate the formerly written objects.  XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed input stream and replace or inject objects, that result in the deletion of a file on the local host. No user is affected, who followed the recommendation to setup XStream's security framework with a whitelist limited to the minimal required types.

  ### Patches
  If you rely on XStream's default blacklist of the [Security Framework](https://x-stream.github.io/security.html#framework), you will have to use at least version 1.4.16.

  ### Workarounds
  See [workarounds](https://x-stream.github.io/security.html#workaround) for the different versions covering all CVEs.

  ### References
  See full information about the nature of the vulnerability and the steps to reproduce it in XStream's documentation for [CVE-2021-21343](https://x-stream.github.io/CVE-2021-21343.html).

  ### Credits
  钟潦贵 (Liaogui Zhong) found and reported the issue to XStream and provided the required information to reproduce it.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [XStream](https://github.com/x-stream/xstream/issues)
  * Contact us at [XStream Google Group](https://groups.google.com/group/xstream-user)
impacted_packages:
  - purl: pkg:maven/com.thoughtworks.xstream/xstream
    affected_versions: vers:maven/<1.4.16
    fixed_versions: vers:maven/1.4.16
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-74cv-f58x-f9wf/GHSA-74cv-f58x-f9wf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
  - CWE-73
references:
  - url: https://github.com/x-stream/xstream
    reference_type:
    reference_id:
  - url: https://github.com/x-stream/xstream/security/advisories/GHSA-74cv-f58x-f9wf
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r8244fd0831db894d5e89911ded9c72196d395a90ae655414d23ed0dd@%3Cusers.activemq.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r9ac71b047767205aa22e3a08cb33f3e0586de6b2fac48b425c6e16b0@%3Cdev.jmeter.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2021/04/msg00002.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/22KVR6B5IZP3BGQ3HPWIO2FWWCKT3DHP
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PVPHZA7VW2RRSDCOIPP2W6O5ND254TU7
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QGXIU3YDPG6OGTDHMBLAFN7BPBERXREB
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20210430-0002
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2021/dsa-5004
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpujan2022.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com//security-alerts/cpujul2021.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuoct2021.html
    reference_type:
    reference_id:
  - url: https://x-stream.github.io/CVE-2021-21343.html
    reference_type:
    reference_id:
  - url: https://x-stream.github.io/security.html#workaround
    reference_type:
    reference_id:
  - url: http://x-stream.github.io/changes.html#1.4.16
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21343
    reference_type:
    reference_id: CVE-2021-21343
