advisory_id: GHSA-f5x9-8jwc-25rw
datasource_id: github_osv_importer_v2/GHSA-f5x9-8jwc-25rw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-f5x9-8jwc-25rw/GHSA-f5x9-8jwc-25rw.json
aliases:
  - CVE-2022-31015
summary: |
  Uncaught Exception (due to a data race) leads to process termination in Waitress
  ### Impact

  Waitress may terminate early due to a thread closing a socket while the main thread is about to call select(). This will lead to the main thread raising an exception that is not handled and then causing the entire application to be killed.

  ### Patches

  This issue has been fixed in Waitress 2.1.2 by no longer allowing the WSGI thread to close the socket, instead it is always delegated to the main thread.

  ### Workarounds

  There is no work-around, however users using waitress behind a reverse proxy server are less likely to have issues if the reverse proxy always reads the full response.

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in https://github.com/Pylons/waitress/issues (if not sensitive or security related)
  * email the Pylons Security mailing list: [pylons-project-security@googlegroups.com](mailto:pylons-project-security@googlegroups.com) (if security related)
impacted_packages:
  - purl: pkg:pypi/waitress
    affected_versions: vers:pypi/>=2.1.0|<2.1.2
    fixed_versions: vers:pypi/2.1.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-f5x9-8jwc-25rw/GHSA-f5x9-8jwc-25rw.json
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-f5x9-8jwc-25rw/GHSA-f5x9-8jwc-25rw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-362
  - CWE-248
references:
  - url: https://github.com/Pylons/waitress
    reference_type:
    reference_id:
  - url: https://github.com/Pylons/waitress/commit/4f6789b035610e0552738cdc4b35ca809a592d48
    reference_type:
    reference_id:
  - url: https://github.com/Pylons/waitress/issues/374
    reference_type:
    reference_id:
  - url: https://github.com/Pylons/waitress/pull/377
    reference_type:
    reference_id:
  - url: https://github.com/Pylons/waitress/security/advisories/GHSA-f5x9-8jwc-25rw
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/waitress/PYSEC-2022-205.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31015
    reference_type:
    reference_id: CVE-2022-31015
