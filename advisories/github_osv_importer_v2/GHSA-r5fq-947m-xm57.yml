advisory_id: GHSA-r5fq-947m-xm57
datasource_id: github_osv_importer_v2/GHSA-r5fq-947m-xm57
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-r5fq-947m-xm57/GHSA-r5fq-947m-xm57.json
aliases: []
summary: |
  OpenClaw has a path traversal in apply_patch could write/delete files outside the workspace
  ## Summary

  In affected versions, when `apply_patch` was enabled and the agent ran without filesystem sandbox containment, crafted paths could cause file writes/deletes outside the configured workspace directory.

  ## Affected Packages / Versions

  - Package: `openclaw` (npm)
  - Affected: `<= 2026.2.13`
  - Fixed: `>= 2026.2.14`

  ## Details

  The non-sandbox path resolution in `apply_patch` did not enforce workspace containment. Inputs like `../../...` or absolute paths could escape the working directory in non-sandboxed mode.

  ## Impact

  Practical impact depends on deployment and who can trigger tool execution. This is most relevant when tool invocation is exposed to less-trusted callers or when operators expected workspace-only containment.

  ## Workarounds

  - Keep `tools.exec.applyPatch.enabled` disabled if you do not need `apply_patch`.
  - Keep `tools.exec.applyPatch.workspaceOnly` at its secure default of `true`.
  - Restrict who can trigger tool execution (and which tools are allowlisted).

  ## Configuration Note

  `tools.exec.applyPatch.workspaceOnly: false` intentionally opts out of workspace containment and can re-enable outside-workspace writes/deletes.

  ## Fix

  - PR: https://github.com/openclaw/openclaw/pull/16405
  - Merge commit: `5544646a09c0121fca7d7093812dc2de8437c7f1`

  ## Credits

  Thanks to @p80n-sec for reporting this issue.
impacted_packages:
  - purl: pkg:npm/openclaw
    affected_versions: vers:npm/<2026.2.14
    fixed_versions: vers:npm/2026.2.14
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-r5fq-947m-xm57/GHSA-r5fq-947m-xm57.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/openclaw/openclaw
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/commit/5544646a09c0121fca7d7093812dc2de8437c7f1
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/pull/16405
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/releases/tag/v2026.2.14
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/security/advisories/GHSA-r5fq-947m-xm57
    reference_type:
    reference_id:
