advisory_id: GHSA-m732-wvh2-7cq4
datasource_id: github_osv_importer_v2/GHSA-m732-wvh2-7cq4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-m732-wvh2-7cq4/GHSA-m732-wvh2-7cq4.json
aliases:
  - CVE-2024-29199
summary: "Unauthenticated views may expose information to anonymous users\n### Impact\n\nA number\
  \ of Nautobot URL endpoints were found to be improperly accessible to unauthenticated (anonymous)\
  \ users, including the following:\n\n- `/api/graphql/` (1)\n- `/api/users/users/session/`\
  \ (Nautobot 2.x only; the only information exposed to an anonymous user is which authentication\
  \ backend classes are enabled on this Nautobot instance)\n- `/dcim/racks/<uuid:pk>/dynamic-groups/`\
  \ (1)\n- `/dcim/devices/<uuid:pk>/dynamic-groups/` (1)\n- `/extras/job-results/<uuid:pk>/log-table/`\n\
  - `/extras/secrets/provider/<str:provider_slug>/form/` (the only information exposed to an\
  \ anonymous user is the fact that a secrets provider with the given slug (e.g. `environment-variable`\
  \ or `text-file`) is supported by this Nautobot instance)\n- `/ipam/prefixes/<uuid:pk>/dynamic-groups/`\
  \ (1)\n- `/ipam/ip-addresses/<uuid:pk>/dynamic-groups/` (1)\n- `/virtualization/clusters/<uuid:pk>/dynamic-groups/`\
  \ (1)\n- `/virtualization/virtual-machines/<uuid:pk>/dynamic-groups/` (1)\n\n(1) These endpoints\
  \ will not disclose any Nautobot data to an unauthenticated user unless the Nautobot configuration\
  \ variable `EXEMPT_VIEW_PERMISSIONS` is changed from its default value (an empty list) to\
  \ permit access to specific data by unauthenticated users.\n\nOf these endpoints, the only\
  \ one that poses any significant risk of sensitive information disclosure under normal Nautobot\
  \ operation with a default configuration is `/extras/job-results/<uuid:pk>/log-table/`. This\
  \ endpoint returns an HTML table containing all of the logs associated with the specified\
  \ JobResult; while these logs may contain sensitive information depending on the Jobs executed\
  \ in Nautobot, this exposure is mitigated somewhat by the fact that any attacker would have\
  \ to have prior knowledge of the existence of a JobResult with a particular UUID.\n\nIn the\
  \ interest of full disclosure, the following additional endpoints were also accessible to\
  \ anonymous users, but do not disclose any sensitive data when accessed (only a listing of\
  \ other API endpoints). \n\n- `/api/`\n- `/api/circuits/`\n- `/api/dcim/`\n- `/api/extras/`\n\
  - `/api/ipam/`\n- `/api/plugins/`\n- `/api/tenancy/`\n- `/api/users/`\n- `/api/virtualization/`\n\
  \nAll of the above endpoints have been corrected to require user authentication, with the\
  \ exception of `/api/users/users/session/` which is unused at this time and therefore has\
  \ been simply removed from Nautobot 2.1.9. Additionally, we have added test automation which\
  \ enumerates available Nautobot URL endpoints and verifies that appropriate authentication\
  \ requirements are in place; this test was instrumental in identifying the above comprehensive\
  \ list.\n\n### Patches\n\nFixes will be included in Nautobot 1.6.16 and 2.1.9.\n\n### Workarounds\n\
  \nPartial workaround: If your configuration includes a non-default value for `EXEMPT_VIEW_PERMISSIONS`\
  \ (the Nautobot default is an empty list), reverting it to default will prevent exposure of\
  \ Nautobot information to unauthenticated users via the endpoints marked with (1) above.\n\
  \n### References\n_Are there any links users can visit to find out more?_"
impacted_packages:
  - purl: pkg:pypi/nautobot
    affected_versions: vers:pypi/<1.6.16
    fixed_versions: vers:pypi/1.6.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/nautobot
    affected_versions: vers:pypi/>=2.0.0|<2.1.9
    fixed_versions: vers:pypi/2.1.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-m732-wvh2-7cq4/GHSA-m732-wvh2-7cq4.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/nautobot/nautobot
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/commit/2fd95c365f8477b26e06d60b999ddd36882d5750
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/commit/dd623e6c3307f48b6357fcc91925bcad5192abfb
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/pull/5464
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/pull/5465
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/releases/tag/v1.6.16
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/releases/tag/v2.1.9
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/security/advisories/GHSA-m732-wvh2-7cq4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-29199
    reference_type:
    reference_id: CVE-2024-29199
