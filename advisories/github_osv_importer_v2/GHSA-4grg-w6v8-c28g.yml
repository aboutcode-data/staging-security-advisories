advisory_id: GHSA-4grg-w6v8-c28g
datasource_id: github_osv_importer_v2/GHSA-4grg-w6v8-c28g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-4grg-w6v8-c28g/GHSA-4grg-w6v8-c28g.json
aliases:
  - CVE-2025-47278
summary: |
  Flask uses fallback key instead of current signing key
  In Flask 3.1.0, the way fallback key configuration was handled resulted in the last fallback key being used for signing, rather than the current signing key.

  Signing is provided by the `itsdangerous` library. A list of keys can be passed, and it expects the last (top) key in the list to be the most recent key, and uses that for signing. Flask was incorrectly constructing that list in reverse, passing the signing key first.

  Sites that have opted-in to use key rotation by setting `SECRET_KEY_FALLBACKS` are likely to unexpectedly be signing their sessions with stale keys, and their transition to fresher keys will be impeded. Sessions are still signed, so this would not cause any sort of data integrity loss.
impacted_packages:
  - purl: pkg:pypi/flask
    affected_versions: vers:pypi/3.1.0
    fixed_versions: vers:pypi/3.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '1.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:H/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-4grg-w6v8-c28g/GHSA-4grg-w6v8-c28g.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-683
references:
  - url: https://github.com/pallets/flask
    reference_type:
    reference_id:
  - url: https://github.com/pallets/flask/commit/73d6504063bfa00666a92b07a28aaf906c532f09
    reference_type:
    reference_id:
  - url: https://github.com/pallets/flask/releases/tag/3.1.1
    reference_type:
    reference_id:
  - url: https://github.com/pallets/flask/security/advisories/GHSA-4grg-w6v8-c28g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-47278
    reference_type:
    reference_id: CVE-2025-47278
