advisory_id: GHSA-jjqf-j4w7-92w8
datasource_id: github_osv_importer_v2/GHSA-jjqf-j4w7-92w8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-jjqf-j4w7-92w8/GHSA-jjqf-j4w7-92w8.json
aliases:
  - CVE-2023-22894
summary: |
  Strapi leaking sensitive user information by filtering on private fields
  ### Summary

  Strapi through 4.7.1 allows unauthenticated attackers to discover sensitive user details for Strapi administrators and API users.

  ### Details

  Strapi through 4.7.1 allows unauthenticated attackers to discover sensitive user details for Strapi administrators and API users. The unauthenticated attacker can filter users by columns that contain sensitive information and infer the values by the changes in the API responses. An unauthenticated attacker can exploit this vulnerability to hijack Strapi administrator accounts and gain unauthorized Strapi Super Administrator access by leaking the password reset token and changing the admin password. This can be exploited on all Strapi versions <=4.7.1.

  ### IoC

  The exploitation of CVE-2023-22894 is easily detectable, since the payload is within the GET parameters and are normally included in request logs. The following regex pattern will extract requests that are exploiting this vulnerability to leak user's email, password and password reset token columns.

  `/(\[|%5B)\s*(email|password|reset_password_token|resetPasswordToken)\s*(\]|%5D)/`

  You can search log files for this IoC by using the following grep command.

  `grep -iE '(\[|%5B)\s*(email|password|reset_password_token|resetPasswordToken)\s*(\]|%5D)' $PATH_TO_LOG_FILE`

  If the above regex pattern matches any lines in your log files, take extra precaution to look out for multiple requests that include password, reset_password_token or resetPasswordToken. This would indicate that an attacker has leaked the password hashes and reset tokens on your Strapi server and you need to immediately start an incident response!

  ### Impact

  All Strapi users below 4.8.0
impacted_packages:
  - purl: pkg:npm/%40strapi/strapi
    affected_versions: vers:npm/>=3.2.1|<4.8.0
    fixed_versions: vers:npm/4.8.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-jjqf-j4w7-92w8/GHSA-jjqf-j4w7-92w8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-312
references:
  - url: https://github.com/strapi/strapi
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/releases
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/releases/tag/v4.8.0
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/security/advisories/GHSA-jjqf-j4w7-92w8
    reference_type:
    reference_id:
  - url: https://strapi.io/blog/security-disclosure-of-vulnerabilities-cve
    reference_type:
    reference_id:
  - url: https://www.ghostccamm.com/blog/multi_strapi_vulns
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-22894
    reference_type:
    reference_id: CVE-2023-22894
