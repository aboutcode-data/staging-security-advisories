advisory_id: GHSA-g8ww-46x2-2p65
datasource_id: github_osv_importer_v2/GHSA-g8ww-46x2-2p65
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-g8ww-46x2-2p65/GHSA-g8ww-46x2-2p65.json
aliases:
  - CVE-2021-22902
summary: |
  Denial of Service in Action Dispatch
  Impact
  ------
  There is a possible Denial of Service vulnerability in Action Dispatch. Carefully crafted Accept headers can cause the mime type parser in Action Dispatch to do catastrophic backtracking in the regular expression engine.

  Releases
  --------
  The fixed releases are available at the normal locations.

  Workarounds
  -----------
  The following monkey patch placed in an initializer can be used to work around the issue.

  ```ruby
  module Mime
    class Type
      MIME_REGEXP = /\A(?:\*\/\*|#{MIME_NAME}\/(?:\*|#{MIME_NAME})(?>\s*#{MIME_PARAMETER}\s*)*)\z/
    end
  end
  ```

  Patches
  -------
  To aid users who aren't able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.

  * 6-0-Prevent-catastrophic-backtracking-during-mime-parsin.patch - Patch for 6.0 series
  * 6-1-Prevent-catastrophic-backtracking-during-mime-parsin.patch - Patch for 6.1 series

  Please note that only the 6.1.Z, 6.0.Z, and 5.2.Z series are supported at present. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.

  Credits
  -------

  Thanks to Security Curious <security...@pm.me> for reporting this!
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/<=6.0.3.6
    fixed_versions: vers:gem/6.0.3.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/<=6.1.3.1
    fixed_versions: vers:gem/6.1.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-g8ww-46x2-2p65/GHSA-g8ww-46x2-2p65.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://discuss.rubyonrails.org/t/cve-2021-22902-possible-denial-of-service-vulnerability-in-action-dispatch/77866
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/releases/tag/v6.0.3.7
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/releases/tag/v6.1.3.2
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2021-22902.yml
    reference_type:
    reference_id:
  - url: https://groups.google.com/g/rubyonrails-security/c/_5ID_ld9u1c
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1138654
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-22902
    reference_type:
    reference_id: CVE-2021-22902
