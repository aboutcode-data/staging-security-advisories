advisory_id: GHSA-8449-7gc2-pwrp
datasource_id: github_osv_importer_v2/GHSA-8449-7gc2-pwrp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-8449-7gc2-pwrp/GHSA-8449-7gc2-pwrp.json
aliases:
  - CVE-2022-38149
summary: |
  HashiCorp Consul Template could reveal Vault secret contents in error messages
  In HashiCorp Consul Template through version 0.29.1, invalid templates could inadvertently reveal the contents of Vault secret in errors returned by the `*template.Template.Execute 5` method, when given a template using Vault secret contents incorrectly. This method has been updated to redact Vault secrets when creating an error string, making it safe to log the error.. This issue was fixed in version 0.29.2.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-8449-7gc2-pwrp/GHSA-8449-7gc2-pwrp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: https://discuss.hashicorp.com/t/hsec-2022-16-consul-template-may-expose-vault-secrets-when-processing-invalid-input/43215
    reference_type:
    reference_id:
  - url: https://github.com/hashicorp/consul
    reference_type:
    reference_id:
  - url: https://github.com/hashicorp/consul-template/commit/d6a6f4af219c28e67d847ba0e0b2bea8f5bb9076
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-0980
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-38149
    reference_type:
    reference_id: CVE-2022-38149
