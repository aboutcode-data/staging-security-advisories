advisory_id: GHSA-437m-7hj5-9mpw
datasource_id: github_osv_importer_v2/GHSA-437m-7hj5-9mpw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-437m-7hj5-9mpw/GHSA-437m-7hj5-9mpw.json
aliases:
  - CVE-2023-30617
summary: "Kruise allows leveraging the kruise-daemon pod to list all secrets in the entire cluster\n\
  ### Impact\nAttacker that has gain root privilege of the node that kruise-daemon run , can\
  \ leverage the kruise-daemon pod to list all secrets in the entire cluster. After that, attackers\
  \ can leverage the \"captured\" secrets (e.g. the kruise-manager service account token) to\
  \ gain extra privilege such as pod modification. \n\n### Workarounds\nFor users that do not\
  \ require imagepulljob functions, they can modify kruise-daemon-role to drop the cluster level\
  \ secret get/list privilege \n\n### Patches\n\nFor users who're using v0.8.x ~ v1.2.x, please\
  \ update the v1.3.1\nFor users who're using v1.3, please update the v1.3.1\nFor users who're\
  \ using v1.4, please update the v1.4.1\nFor users who're using v1.5, please update the v1.5.2\n\
  ### References\nNone"
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-437m-7hj5-9mpw/GHSA-437m-7hj5-9mpw.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
  - CWE-250
references:
  - url: https://github.com/openkruise/kruise
    reference_type:
    reference_id:
  - url: https://github.com/openkruise/kruise/security/advisories/GHSA-437m-7hj5-9mpw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-30617
    reference_type:
    reference_id: CVE-2023-30617
