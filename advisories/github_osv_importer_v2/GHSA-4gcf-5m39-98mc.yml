advisory_id: GHSA-4gcf-5m39-98mc
datasource_id: github_osv_importer_v2/GHSA-4gcf-5m39-98mc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-4gcf-5m39-98mc/GHSA-4gcf-5m39-98mc.json
aliases:
  - CVE-2023-40034
summary: |
  Woodpecker does not validate webhook before changing any data
  ### Impact
  An attacker can post malformed webhook data which leads to an update of the repository data that can e.g. allow the takeover of a repository.
  This is only critical if the CI is configured for public usage and connected to a forge witch is also in public usage.

  ### Patches
  Please use either next or the latest v1.0 e.g. v1.0.2

  ### Workarounds
  Secure the CI system by making it inaccessible to untrusted entities, for example, by placing it behind a firewall.

  ### References
  Fix: https://github.com/woodpecker-ci/woodpecker/pull/2221
  Backport: https://github.com/woodpecker-ci/woodpecker/pull/2222
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-4gcf-5m39-98mc/GHSA-4gcf-5m39-98mc.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/woodpecker-ci/woodpecker
    reference_type:
    reference_id:
  - url: https://github.com/woodpecker-ci/woodpecker/commit/6e4c2f84cc84661d58cf1c0e5c421a46070bb105
    reference_type:
    reference_id:
  - url: https://github.com/woodpecker-ci/woodpecker/pull/2221
    reference_type:
    reference_id:
  - url: https://github.com/woodpecker-ci/woodpecker/pull/2222
    reference_type:
    reference_id:
  - url: https://github.com/woodpecker-ci/woodpecker/releases/tag/v1.0.2
    reference_type:
    reference_id:
  - url: https://github.com/woodpecker-ci/woodpecker/security/advisories/GHSA-4gcf-5m39-98mc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-40034
    reference_type:
    reference_id: CVE-2023-40034
