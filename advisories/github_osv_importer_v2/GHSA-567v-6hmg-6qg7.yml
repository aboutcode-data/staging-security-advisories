advisory_id: GHSA-567v-6hmg-6qg7
datasource_id: github_osv_importer_v2/GHSA-567v-6hmg-6qg7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-567v-6hmg-6qg7/GHSA-567v-6hmg-6qg7.json
aliases:
  - CVE-2024-41952
summary: |
  ZITADEL "ignoring unknown usernames" vulnerability
  ### Impact

  ZITADEL administrators can enable a setting called "Ignoring unknown usernames" which helps mitigate attacks that try to guess/enumerate usernames. If enabled, ZITADEL will show the password prompt even if the user doesn't exist and report "Username or Password invalid".
  Due to a implementation change to prevent deadlocks calling the database, the flag would not be correctly respected in all cases and an attacker would gain information if an account exist within ZITADEL, since the error message shows "object not found" instead of the generic error message.

  ### Patches

  2.x versions are fixed on >= [2.58.1](https://github.com/zitadel/zitadel/releases/tag/v2.58.1)
  2.57.x versions are fixed on >= [2.57.1](https://github.com/zitadel/zitadel/releases/tag/v2.57.1)
  2.56.x versions are fixed on >= [2.56.2](https://github.com/zitadel/zitadel/releases/tag/v2.56.2)
  2.55.x versions are fixed on >= [2.55.5](https://github.com/zitadel/zitadel/releases/tag/v2.55.5)
  2.54.x versions are fixed on >= [2.54.8](https://github.com/zitadel/zitadel/releases/tag/v2.54.8)
  2.53.x versions are fixed on >= [2.53.9](https://github.com/zitadel/zitadel/releases/tag/v2.53.9)

  ZITADEL recommends upgrading to the latest versions available in due course.

  ### Workarounds

  There is no workaround since a patch is already available.

  ### Questions

  If you have any questions or comments about this advisory, please email us at [security@zitadel.com](mailto:security@zitadel.com)
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-567v-6hmg-6qg7/GHSA-567v-6hmg-6qg7.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-567v-6hmg-6qg7/GHSA-567v-6hmg-6qg7.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-203
references:
  - url: https://github.com/zitadel/zitadel
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/0ab0c645ef914298c343fa39cccb1290aba48bf6
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/3c7d12834e32426416235b9e3374be0f4b9380b8
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/5c2526c98aafd1ba206be2fa4291b1d24c384f6d
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/8565d24fd8df5bd35294313cfbfcc2e15aea20e9
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/b0e71a81ef39667ce2a149ce037c1ca0edbe059d
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/fc1d415b8db5b8d481bb65206ce3fc944c0eecea
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.53.9
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.54.8
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.55.5
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.56.2
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.57.1
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.58.1
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/security/advisories/GHSA-567v-6hmg-6qg7
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3014
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41952
    reference_type:
    reference_id: CVE-2024-41952
