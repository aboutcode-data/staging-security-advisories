advisory_id: GHSA-r8xc-xxh3-q5x3
datasource_id: github_osv_importer_v2/GHSA-r8xc-xxh3-q5x3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-r8xc-xxh3-q5x3/GHSA-r8xc-xxh3-q5x3.json
aliases:
  - CVE-2023-35160
summary: |
  XWiki Platform vulnerable to reflected cross-site scripting via back and xcontinue parameters in resubmit template
  ### Impact
  Users are able to forge an URL with a payload allowing to inject Javascript in the page (XSS).
  It's possible to exploit the resubmit template to perform a XSS, e.g. by using URL such as:

   > xwiki/bin/view/XWiki/Main?xpage=resubmit&resubmit=javascript:alert(document.domain)&xback=javascript:alert(document.domain)

  This vulnerability exists since XWiki 2.5-milestone-2.

  ### Patches

  The vulnerability has been patched in XWiki 14.10.5 and 15.1-rc-1.

  ### Workarounds

  It's possible to workaround the vulnerability by editing the template resubmit.vm to perform checks on it, but note that the appropriate fix involves new APIs that have been recently introduced in XWiki. See the referenced jira tickets.

  ### References

    * Jira ticket about the vulnerability: https://jira.xwiki.org/browse/XWIKI-20343
    * Introduction of the macro used for fixing all those vulnerabilities: https://jira.xwiki.org/browse/XWIKI-20583
    * Commit containing the actual fix in the page: https://github.com/xwiki/xwiki-platform/commit/dbc92dcdace33823ffd1e1591617006cb5fc6a7f

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  * Email us at [Security Mailing List](mailto:security@xwiki.org)

  ### Attribution

  This vulnerability has been reported by RenÃ© de Sain @renniepak.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=2.5-milestone-2|<14.10.5
    fixed_versions: vers:maven/14.10.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=15.0-rc-1|<15.1-rc-1
    fixed_versions: vers:maven/15.1-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-r8xc-xxh3-q5x3/GHSA-r8xc-xxh3-q5x3.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-87
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/dbc92dcdace33823ffd1e1591617006cb5fc6a7f
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-r8xc-xxh3-q5x3
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20343
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20583
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-35160
    reference_type:
    reference_id: CVE-2023-35160
