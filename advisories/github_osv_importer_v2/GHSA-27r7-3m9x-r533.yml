advisory_id: GHSA-27r7-3m9x-r533
datasource_id: github_osv_importer_v2/GHSA-27r7-3m9x-r533
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-27r7-3m9x-r533/GHSA-27r7-3m9x-r533.json
aliases:
  - CVE-2025-57813
summary: "traQ Allows Insertion of Sensitive Information into Log File\n### Impact\nA vulnerability\
  \ exists where sensitive information, such as OAuth tokens, is recorded in log files when\
  \ an error occurs during the execution of an SQL query.\nAn attacker could intentionally trigger\
  \ an SQL error by methods such as placing a high load on the database. This could allow an\
  \ attacker who has the authority to view the log files to illicitly acquire the recorded sensitive\
  \ information.\n\n### Patch\nThis vulnerability was temporarily fixed by #2787 and will be\
  \ completely resolved by #2788. \n\nThis issue may have caused OAuth tokens to be leaked to\
  \ users who can view logs on traQ instances using versions prior to v3.25.0.\n\nWhile it is\
  \ possible that OAuth tokens for both human users and Bots were leaked, revoking Bot access\
  \ tokens is not recommended as it may cause errors. This issue will be resolved in a future\
  \ update.\n\nCurrently, the recommended mitigation is to invalidate the OAuth tokens of human\
  \ users only. To apply this measure, please execute the following SQL statement directly:\n\
  ```sql\nUPDATE oauth2_tokens SET deleted_at = NOW() WHERE deleted_at IS NULL AND scopes !=\
  \ \"bot\"\n```\n\n### Workaround\nIf you cannot apply the update immediately, as a temporary\
  \ workaround, please review access permissions for SQL error logs and strictly limit access\
  \ to prevent unauthorized users from viewing them."
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-27r7-3m9x-r533/GHSA-27r7-3m9x-r533.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: https://github.com/traPtitech/traQ
    reference_type:
    reference_id:
  - url: https://github.com/traPtitech/traQ/commit/ce5da94f5d5a8348f9ecdc82140b6f53b3721698
    reference_type:
    reference_id:
  - url: https://github.com/traPtitech/traQ/pull/2787
    reference_type:
    reference_id:
  - url: https://github.com/traPtitech/traQ/pull/2788
    reference_type:
    reference_id:
  - url: https://github.com/traPtitech/traQ/security/advisories/GHSA-27r7-3m9x-r533
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-57813
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3913
    reference_type:
    reference_id:
