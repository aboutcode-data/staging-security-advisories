advisory_id: GHSA-pm44-x5x7-24c4
datasource_id: github_osv_importer_v2/GHSA-pm44-x5x7-24c4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-pm44-x5x7-24c4/GHSA-pm44-x5x7-24c4.json
aliases:
  - CVE-2026-22922
summary: |
  Apache Airflow Has an Authorization Bypass That Allows Unauthorized Task Log Access
  ## Vulnerability Overview

  An authorization bypass vulnerability exists in Apache Airflow that allows authenticated users to access task execution logs without the required permissions.

  ## The Flaw

  The vulnerability affects environments using custom roles or granular permission settings. Normally, Airflow allows administrators to separate "Task" access (viewing the task state) from "Task Log" access (viewing the console output/logs).

  In affected versions, the permission check for retrieving logs is insufficient. An authenticated user who has been granted access to view Tasks can successfully request and view Task Logs, even if they do not have the specific `can_read` permission for Logs.

  ## Impact

  - **Confidentiality Loss:** Task logs often contain sensitive operational data, debugging information, or potentially leaked secrets (environment variables, connection strings) that should not be visible to all users with basic task access.
  - **Broken Access Control:** This bypasses the intended security model for restricted user roles.

  ## Affected Versions

  - Apache Airflow 3.1.0 through 3.1.6

  ## Patches

  Users should upgrade to Apache Airflow **3.1.7** or later, which enforces the correct permission checks for log access.
impacted_packages:
  - purl: pkg:pypi/apache-airflow
    affected_versions: vers:pypi/>=3.1.0|<3.1.7
    fixed_versions: vers:pypi/3.1.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-pm44-x5x7-24c4/GHSA-pm44-x5x7-24c4.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-648
references:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/pull/60412
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/gdb7vffhpmrj5hp1j0oj1j13o4vmsq40
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22922
    reference_type:
    reference_id:
