advisory_id: GHSA-5r3f-3m3j-wcj2
datasource_id: github_osv_importer_v2/GHSA-5r3f-3m3j-wcj2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-5r3f-3m3j-wcj2/GHSA-5r3f-3m3j-wcj2.json
aliases:
  - CVE-2022-22936
summary: |
  SaltStack Salt Authentication Bypass by Capture-replay
  An issue was discovered in SaltStack Salt in versions before 3002.8, 3003.4, 3004.1. Job publishes and file server replies are susceptible to replay attacks, which can result in an attacker replaying job publishes causing minions to run old jobs. File server replies can also be re-played. A sufficient craft attacker could gain root access on minion under certain scenarios.
impacted_packages:
  - purl: pkg:pypi/salt
    affected_versions: vers:pypi/<3002.8
    fixed_versions: vers:pypi/3002.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/salt
    affected_versions: vers:pypi/>=3003|<3003.4
    fixed_versions: vers:pypi/3003.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/salt
    affected_versions: vers:pypi/>=3004|<3004.1
    fixed_versions: vers:pypi/3004.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-5r3f-3m3j-wcj2/GHSA-5r3f-3m3j-wcj2.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-294
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/salt/PYSEC-2022-173.yaml
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3002.8.rst#L31
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3003.4.rst#L32
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3004.1.rst#L30
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt/releases
    reference_type:
    reference_id:
  - url: https://repo.saltproject.io
    reference_type:
    reference_id:
  - url: https://saltproject.io/security_announcements/salt-security-advisory-release
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202310-22
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-22936
    reference_type:
    reference_id: CVE-2022-22936
