advisory_id: GHSA-p84v-45xj-wwqj
datasource_id: github_osv_importer_v2/GHSA-p84v-45xj-wwqj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-p84v-45xj-wwqj/GHSA-p84v-45xj-wwqj.json
aliases:
  - CVE-2023-22792
summary: |
  ReDoS based DoS vulnerability in Action Dispatch
  There is a possible regular expression based DoS vulnerability in Action Dispatch. This vulnerability has been assigned the CVE identifier CVE-2023-22792.

  Versions Affected: >= 3.0.0 Not affected: < 3.0.0 Fixed Versions: 5.2.8.15 (Rails LTS), 6.1.7.1, 7.0.4.1
  Impact

  Specially crafted cookies, in combination with a specially crafted X_FORWARDED_HOST header can cause the regular expression engine to enter a state of catastrophic backtracking. This can cause the process to use large amounts of CPU and memory, leading to a possible DoS vulnerability All users running an affected release should either upgrade or use one of the workarounds immediately.
  Releases

  The FIXED releases are available at the normal locations.
  Workarounds

  We recommend that all users upgrade to one of the FIXED versions. In the meantime, users can mitigate this vulnerability by using a load balancer or other device to filter out malicious X_FORWARDED_HOST headers before they reach the application.
  Patches

  To aid users who arenâ€™t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.

      6-1-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 6.1 series
      7-0-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 7.0 series

  Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.

  https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=3.0.0|<5.2.8.15
    fixed_versions: vers:gem/5.2.8.15
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=6.0.0|<6.1.7.1
    fixed_versions: vers:gem/6.1.7.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=7.0.0|<7.0.4.1
    fixed_versions: vers:gem/7.0.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
  - CWE-400
references:
  - url: https://discuss.rubyonrails.org/t/cve-2023-22792-possible-redos-based-dos-vulnerability-in-action-dispatch/82115
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/releases/tag/v7.0.4.1
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2023-22792.yml
    reference_type:
    reference_id:
  - url: https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240202-0007
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2023/dsa-5372
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-22792
    reference_type:
    reference_id: CVE-2023-22792
