advisory_id: GHSA-77h3-w9rx-hj3q
datasource_id: github_osv_importer_v2/GHSA-77h3-w9rx-hj3q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-77h3-w9rx-hj3q/GHSA-77h3-w9rx-hj3q.json
aliases: []
summary: |
  User-defined implementations of the safe trait scratchpad::Tracking can cause heap buffer overflows
  The `get` and `set` methods of the public trait `scratchpad::Tracking` interact with unsafe code regions in the crate, and they influence the computation of addresses returned as raw pointers. However, the trait itself is not marked as unsafe, meaning users may provide custom implementations under the assumption that the crate upholds all safety guarantees.

  This becomes problematic because even safe implementations of `get` and `set`-written without using any unsafe code-can still result in ill-formed raw pointers. These pointers may later be dereferenced within safe APIs of the crate (e.g., `marker::MarkerBack::allocate_slice_copy`), potentially leading to arbitrary memory access or heap buffer overflows.

  According to the [penultimate commit](https://github.com/okready/scratchpad/commit/957dee1a3902f48600b06910e8e0b1d5ee7dab83), the crate is in maintenance mode awaiting a cleanup that will reduce the area of unsafe code. Note that the last commits to the repository are from 4 years ago.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-77h3-w9rx-hj3q/GHSA-77h3-w9rx-hj3q.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-122
references:
  - url: https://github.com/okready/scratchpad
    reference_type:
    reference_id:
  - url: https://github.com/okready/scratchpad/issues/2
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2025-0049.html
    reference_type:
    reference_id:
