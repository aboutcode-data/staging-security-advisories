advisory_id: GHSA-cmr8-5w4c-44v8
datasource_id: github_osv_importer_v2/GHSA-cmr8-5w4c-44v8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-cmr8-5w4c-44v8/GHSA-cmr8-5w4c-44v8.json
aliases:
  - CVE-2022-39218
summary: |
  Fastly Compute@Edge JS Runtime has fixed random number seed during compilation
  ### Impact

  `Math.random` and `crypto.getRandomValues` methods failed to use sufficiently random values. The initial value to seed the CSPRNG (cryptographically secure pseudorandom number generator) was baked-in to the final WebAssembly module meaning the sequence of numbers generated was predictable for that specific WebAssembly module. An attacker with access to that same WebAssembly module that calls the affected methods could use the fixed seed to predict random numbers generated by these functions. This information could be used to bypass cryptographic security controls, for example to disclose sensitive data encrypted by functions that use these generators.

  ### Patches

  The problem has been fixed in version 0.5.3.

  Corrected `Math.random` and `crypto.getRandomValues` methods to always use sufficiently random values. The previous versions would use a CSPRNG (cryptographically secure pseudorandom number generator) which we would seed with a random value. However, due to our use of Wizer, the initial value to seed the CSPRNG was baked-in to the final WebAssembly module meaning the sequence of numbers generated was predictable for that specific WebAssembly module. The new implementations of both Math.random and `crypto.getRandomValues` do not use a CSPRNG and instead pull random values from WASI (WebAssembly System Interface) libcâ€™s random_get function, which is always a sufficiently random value.

  ### Workarounds

  There are no workarounds, you must upgrade to version 0.5.3 or later.
impacted_packages:
  - purl: pkg:npm/%40fastly/js-compute
    affected_versions: vers:npm/>=0.4.0|<0.5.3
    fixed_versions: vers:npm/0.5.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-cmr8-5w4c-44v8/GHSA-cmr8-5w4c-44v8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-330
  - CWE-335
references:
  - url: https://github.com/fastly/js-compute-runtime
    reference_type:
    reference_id:
  - url: https://github.com/fastly/js-compute-runtime/commit/65524ffc962644e9fc39f4b368a326b6253912a9
    reference_type:
    reference_id:
  - url: https://github.com/fastly/js-compute-runtime/security/advisories/GHSA-cmr8-5w4c-44v8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39218
    reference_type:
    reference_id: CVE-2022-39218
