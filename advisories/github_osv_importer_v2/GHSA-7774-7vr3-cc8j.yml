advisory_id: GHSA-7774-7vr3-cc8j
datasource_id: github_osv_importer_v2/GHSA-7774-7vr3-cc8j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-7774-7vr3-cc8j/GHSA-7774-7vr3-cc8j.json
aliases:
  - CVE-2021-39155
summary: "Authorization Policy Bypass Due to Case Insensitive Host Comparison\n### Impact\n\
  According to [RFC 4343](https://datatracker.ietf.org/doc/html/rfc4343), Istio authorization\
  \ policy should compare the hostname in the HTTP Host header in a case insensitive way, but\
  \ currently the comparison is case sensitive.  The Envoy proxy will route the request hostname\
  \ in a case-insensitive way which means the authorization policy could be bypassed.\n \nAs\
  \ an example, the user may have an authorization policy that rejects request with hostname\
  \ \"httpbin.foo\" for some source IPs, but the attacker can bypass this by sending the request\
  \ with hostname \"Httpbin.Foo\".\n\n### Patches\n* Istio 1.11.1 and above\n* Istio 1.10.4\
  \ and above\n* Istio 1.9.8 and above\n\n### Workarounds\nA Lua filter may be written to normalize\
  \ Host header before the authorization check.  This is similar to the Path normalization presented\
  \ in the [Security Best Practices](https://istio.io/latest/docs/ops/best-practices/security/#case-normalization)\
  \ guide.\n\n### References\nMore details can be found in the [Istio Security Bulletin](https://istio.io/latest/news/security/istio-security-2021-008).\n\
  \n### For more information\nIf you have any questions or comments about this advisory, please\
  \ email us at istio-security-vulnerability-reports@googlegroups.com"
impacted_packages: []
severities:
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-7774-7vr3-cc8j/GHSA-7774-7vr3-cc8j.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-178
references:
  - url: https://datatracker.ietf.org/doc/html/rfc4343
    reference_type:
    reference_id:
  - url: https://github.com/istio/istio
    reference_type:
    reference_id:
  - url: https://github.com/istio/istio/commit/084b417a486dbe9b9024d4812877016a484572b1
    reference_type:
    reference_id:
  - url: https://github.com/istio/istio/commit/76ed51413ddd2a7fa253a368ab20a9cec5fb1cbe
    reference_type:
    reference_id:
  - url: https://github.com/istio/istio/commit/90b00bdf891e6c770cb3235c14a9b1fda96cc7c5
    reference_type:
    reference_id:
  - url: https://github.com/istio/istio/security/advisories/GHSA-7774-7vr3-cc8j
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39155
    reference_type:
    reference_id: CVE-2021-39155
