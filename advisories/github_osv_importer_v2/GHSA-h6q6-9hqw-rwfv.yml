advisory_id: GHSA-h6q6-9hqw-rwfv
datasource_id: github_osv_importer_v2/GHSA-h6q6-9hqw-rwfv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-h6q6-9hqw-rwfv/GHSA-h6q6-9hqw-rwfv.json
aliases:
  - CVE-2021-21366
summary: |
  Misinterpretation of malicious XML input
  ### Impact

  xmldom versions 0.4.0 and older do not correctly preserve [system identifiers](https://www.w3.org/TR/2008/REC-xml-20081126/#d0e4313), [FPIs](https://en.wikipedia.org/wiki/Formal_Public_Identifier) or [namespaces](https://www.w3.org/TR/xml-names11/) when repeatedly parsing and serializing maliciously crafted documents.

  This may lead to unexpected syntactic changes during XML processing in some downstream applications.

  ### Patches

  Update to 0.5.0 (once it is released)

  ### Workarounds

  Downstream applications can validate the input and reject the maliciously crafted documents.

  ### References

  Similar to this one reported on the Go standard library:

  - https://mattermost.com/blog/coordinated-disclosure-go-xml-vulnerabilities/

  ### For more information

  If you have any questions or comments about this advisory:

  * Open an issue in [`xmldom/xmldom`](https://github.com/xmldom/xmldom)
  * Email us: send an email to **all** addresses that are shown by `npm owner ls xmldom`
impacted_packages:
  - purl: pkg:npm/xmldom
    affected_versions: vers:npm/<0.5.0
    fixed_versions: vers:npm/0.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-h6q6-9hqw-rwfv/GHSA-h6q6-9hqw-rwfv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-436
  - CWE-115
references:
  - url: https://github.com/xmldom/xmldom
    reference_type:
    reference_id:
  - url: https://github.com/xmldom/xmldom/commit/d4201b9dfbf760049f457f9f08a3888d48835135
    reference_type:
    reference_id:
  - url: https://github.com/xmldom/xmldom/releases/tag/0.5.0
    reference_type:
    reference_id:
  - url: https://github.com/xmldom/xmldom/security/advisories/GHSA-h6q6-9hqw-rwfv
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/01/msg00000.html
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/xmldom
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21366
    reference_type:
    reference_id: CVE-2021-21366
