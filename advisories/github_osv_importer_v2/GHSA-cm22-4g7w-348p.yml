advisory_id: GHSA-cm22-4g7w-348p
datasource_id: github_osv_importer_v2/GHSA-cm22-4g7w-348p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-cm22-4g7w-348p/GHSA-cm22-4g7w-348p.json
aliases:
  - CVE-2024-43800
summary: |
  serve-static vulnerable to template injection that can lead to XSS
  ### Impact

  passing untrusted user input - even after sanitizing it - to `redirect()` may execute untrusted code

  ### Patches

  this issue is patched in serve-static 1.16.0

  ### Workarounds

  users are encouraged to upgrade to the patched version of express, but otherwise can workaround this issue by making sure any untrusted inputs are safe, ideally by validating them against an explicit allowlist

  ### Details

  successful exploitation of this vector requires the following:

  1. The attacker MUST control the input to response.redirect()
  1. express MUST NOT redirect before the template appears
  1. the browser MUST NOT complete redirection before:
  1. the user MUST click on the link in the template
impacted_packages:
  - purl: pkg:npm/serve-static
    affected_versions: vers:npm/<1.16.0
    fixed_versions: vers:npm/1.16.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/serve-static
    affected_versions: vers:npm/>=2.0.0|<2.1.0
    fixed_versions: vers:npm/2.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-cm22-4g7w-348p/GHSA-cm22-4g7w-348p.json
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-cm22-4g7w-348p/GHSA-cm22-4g7w-348p.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/expressjs/serve-static
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/serve-static/commit/0c11fad159898cdc69fd9ab63269b72468ecaf6b
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/serve-static/commit/ce730896fddce1588111d9ef6fdf20896de5c6fa
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/serve-static/security/advisories/GHSA-cm22-4g7w-348p
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43800
    reference_type:
    reference_id: CVE-2024-43800
