advisory_id: GHSA-7mqr-2v3q-v2wm
datasource_id: github_osv_importer_v2/GHSA-7mqr-2v3q-v2wm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-7mqr-2v3q-v2wm/GHSA-7mqr-2v3q-v2wm.json
aliases:
  - CVE-2020-15223
summary: |
  Ory fosite contains Improper Handling of Exceptional Conditions
  ### Impact
  The `TokenRevocationHandler` ignores errors coming from the storage. This can lead to unexpected 200 status codes indicating successful revocation while the token is still valid. Whether an attacker can use this for her advantage depends on the ability to trigger errors in the store.

  ### References
  [RFC 7009](https://tools.ietf.org/html/rfc7009#section-2.2.1) states that a 503 HTTP code must be returned when the server has a problem.
impacted_packages: []
severities:
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-7mqr-2v3q-v2wm/GHSA-7mqr-2v3q-v2wm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-755
  - CWE-754
references:
  - url: https://github.com/ory/fosite/commit/03dd55813f5521985f7dd64277b7ba0cf1441319
    reference_type:
    reference_id:
  - url: https://github.com/ory/fosite/security/advisories/GHSA-7mqr-2v3q-v2wm
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2021-0109
    reference_type:
    reference_id:
  - url: https://tools.ietf.org/html/rfc7009#section-2.2.1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15223
    reference_type:
    reference_id: CVE-2020-15223
