advisory_id: GHSA-m5h6-hr3q-22h5
datasource_id: github_osv_importer_v2/GHSA-m5h6-hr3q-22h5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/07/GHSA-m5h6-hr3q-22h5/GHSA-m5h6-hr3q-22h5.json
aliases:
  - CVE-2016-3956
summary: "npm Token Leak in npm\nAffected versions of the `npm` package include the bearer token\
  \ of the logged in user in every request made by the CLI, even if the request is not directed\
  \ towards the user's active registry. \n\nAn attacker could create an HTTP server to collect\
  \ tokens, and by various means including but not limited to install scripts, cause the npm\
  \ CLI to make a request to that server, which would compromise the user's token.\n\nThis compromised\
  \ token could be used to do anything that the user could do, including publishing new packages.\n\
  \n\n\n\n## Recommendation\n\n1. Update npm with `npm install npm@latest -g`\n2. [Revoke your\
  \ Tokens](https://www.npmjs.com/settings/tokens)\n3. Enable [Two-Factor Authentication](https://docs.npmjs.com/getting-started/using-two-factor-authentication)"
impacted_packages:
  - purl: pkg:npm/npm
    affected_versions: vers:npm/<=2.15.0
    fixed_versions: vers:npm/2.15.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/npm
    affected_versions: vers:npm/<=3.8.2
    fixed_versions: vers:npm/3.8.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: http://blog.npmjs.org/post/142036323955/fixing-a-bearer-token-vulnerability
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-m5h6-hr3q-22h5
    reference_type:
    reference_id:
  - url: https://github.com/npm/npm/commit/f67ecad59e99a03e5aad8e93cd1a086ae087cb29
    reference_type:
    reference_id:
  - url: https://github.com/npm/npm/commit/fea8cc92cee02c720b58f95f14d315507ccad401
    reference_type:
    reference_id:
  - url: https://github.com/npm/npm/issues/8380
    reference_type:
    reference_id:
  - url: https://nodejs.org/en/blog/vulnerability/npm-tokens-leak-march-2016
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/98
    reference_type:
    reference_id:
  - url: http://www-01.ibm.com/support/docview.wss?uid=swg21980827
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2016-3956
    reference_type:
    reference_id: CVE-2016-3956
