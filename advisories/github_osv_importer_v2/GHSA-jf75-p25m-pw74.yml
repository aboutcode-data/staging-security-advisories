advisory_id: GHSA-jf75-p25m-pw74
datasource_id: github_osv_importer_v2/GHSA-jf75-p25m-pw74
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-jf75-p25m-pw74/GHSA-jf75-p25m-pw74.json
aliases:
  - CVE-2025-66411
summary: "Coder logs sensitive objects unsanitized\n## Summary\nWorkspace Agent manifests containing\
  \ sensitive values were logged in plaintext unsanitized\n\n## Details\nBy default Workspace\
  \ Agent logs are redirected to [stderr](https://linux.die.net/man/3/stderr)\nhttps://github.com/coder/coder/blob/a8862be546f347c59201e2219d917e28121c0edb/cli/agent.go#L432-L439\n\
  \n[Workspace Agent Manifests](https://coder.com/docs/reference/agent-api/schemas#agentsdkmanifest)\
  \ containing sensitive environment variables were logged insecurely\nhttps://github.com/coder/coder/blob/7beb95fd56d2f790502e236b64906f8eefb969bd/agent/agent.go#L1090\n\
  \nAn attacker with limited local access to the Coder Workspace (VM, K8s Pod etc.) or a third-party\
  \ system ([SIEM](https://csrc.nist.gov/glossary/term/security_information_and_event_management_tool),\
  \ logging stack) could access those logs\n\nThis behavior opened room for unauthorized access\
  \ and privilege escalation\n\n## Impact\nImpact varies depending on the environment variables\
  \ set in a given workspace\n\n## Patches\n[Fix](https://github.com/coder/coder/commit/e2a46393fce40bc630df3293c1ee66a596277289)\
  \ was released & backported:\n- https://github.com/coder/coder/releases/tag/v2.28.4\n- https://github.com/coder/coder/releases/tag/v2.27.7\n\
  - https://github.com/coder/coder/releases/tag/v2.26.5\n\n## Workarounds\nOne potential workaround\
  \ is to disable Workspace Agent Logs by setting following configuration option\n`CODER_AGENT_LOGGING_HUMAN=/dev/null`\
  \ \n> platform operators are advised to upgrade their deployments"
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-jf75-p25m-pw74/GHSA-jf75-p25m-pw74.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: https://github.com/coder/coder
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/commit/06c6abbe0935f9213c1588add60a396da5762e1c
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/commit/a75205a559211c8aa494b1a16750d114b263f24a
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/commit/e2a46393fce40bc630df3293c1ee66a596277289
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/pull/20968
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/releases/tag/v2.26.5
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/releases/tag/v2.27.7
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/releases/tag/v2.28.4
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/security/advisories/GHSA-jf75-p25m-pw74
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66411
    reference_type:
    reference_id:
