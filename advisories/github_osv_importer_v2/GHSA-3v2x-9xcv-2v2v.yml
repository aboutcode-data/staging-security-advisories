advisory_id: GHSA-3v2x-9xcv-2v2v
datasource_id: github_osv_importer_v2/GHSA-3v2x-9xcv-2v2v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-3v2x-9xcv-2v2v/GHSA-3v2x-9xcv-2v2v.json
aliases: []
summary: "SurrealDB Affected by Confused Deputy Privilege Escalation through Future Fields and\
  \ Functions\nUnprivileged users (for example, those with the database editor role) can create\
  \ or modify fields in records that contain functions or `futures`. `Futures` are values which\
  \ are only computed when the value is queried. The query executes in the context of the querying\
  \ user, rather than the user who originally defined the future. Likewise, fields containing\
  \ functions or custom-defined logic (`closures`) are executed under the privileges of the\
  \ invoking user, not the creator.\n\nThis results in a confused deputy vulnerability: an attacker\
  \ with limited privileges can define a malicious function or future field that performs privileged\
  \ actions. When a higher-privileged user (such as a root owner or namespace administrator)\
  \ executes the function or queries or modifies that record, the function executes with their\
  \ elevated permissions. \n\n### Impact\nAn attacker who can create or update function/future\
  \ fields can plant logic that executes with a privileged userâ€™s context. If a privileged user\
  \ performs a write that touches the malicious field, the attacker can achieve full privilege\
  \ escalation (e.g., create a root owner and take over the server). \n\nIf a privileged user\
  \ performs a read action on the malicious field, this attack vector could still be potentially\
  \ be used to perform limited denial of service or, in the specific case where the network\
  \ capability was explicitly enabled and unrestricted, exfiltrate database information over\
  \ the network.\n\n### Patches\n\nVersions prior to 2.5.0 and 3.0.0-beta.3 are vulnerable.\n\
  \nFor SurrealDB 3.0, `futures` are no longer supported, replaced by `computed`  fields, only\
  \ available within schemaful tables. \n\nFurther to this patches for 2.5.0 and 3.0.0-beta.3:\
  \ \n- Implements an `auth_limit` on defined apis, functions, fields and events, that limits\
  \ execution to the permissions of the creating user or the invoking user, whichever is lower.\n\
  - Prevents `closures` from being stored, that eliminates a potential attack surface. For 2.5.0\
  \ this can still be allowed by using the `insecure_storable_closures` capability\n- Ensures\
  \ the proper auth level is used to compute expressions in signin & signup\n\n**_For existing\
  \ apis, events, fields and functions defined prior to upgrading to 2.5.0 or 3.0.0-beta.3 `auth_limit`\
  \ will not apply, to avoid breaking changes. These will need to subsequently be redefined\
  \ so that `auth_limit` can take effect._**\n\n### Workarounds\nUsers unable to patch are advised\
  \ to evaluate their use of the database to identify where low privileged users are able to\
  \ define logic subsequently executed by privileged users, such as apis, functions, futures\
  \ fields and events, and recommended to minimise these instances.\n\n### References\n[Futures](https://surrealdb.com/docs/surrealql/datamodel/futures)\n\
  [Closures](https://surrealdb.com/docs/surrealql/datamodel/closures)\n[SurrealDB Environment\
  \ Variables](https://surrealdb.com/docs/surrealdb/cli/env)"
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-3v2x-9xcv-2v2v/GHSA-3v2x-9xcv-2v2v.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-441
references:
  - url: https://github.com/surrealdb/surrealdb
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/commit/f515c91363ee735aa1bc08580d9e7fa0de6e736f
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/releases/tag/v2.5.0
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/releases/tag/v3.0.0-beta.2
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-3v2x-9xcv-2v2v
    reference_type:
    reference_id:
