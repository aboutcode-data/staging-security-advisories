advisory_id: GHSA-v3p8-j597-3xg8
datasource_id: github_osv_importer_v2/GHSA-v3p8-j597-3xg8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-v3p8-j597-3xg8/GHSA-v3p8-j597-3xg8.json
aliases:
  - CVE-2021-34538
summary: |
  Apache Hive before 3.1.3 `CREATE` and `DROP` function operations do not check for necessary authorization.
  Apache Hive before 3.1.3 `CREATE` and `DROP` function operations do not check for necessary authorization of involved entities in the query. It was found that an unauthorized user can manipulate an existing UDF without having the privileges to do so. This allowed unauthorized or underprivileged users to drop and recreate UDFs pointing them to new jars that could be potentially malicious.
impacted_packages:
  - purl: pkg:maven/org.apache.hive/hive
    affected_versions: vers:maven/<3.1.3
    fixed_versions: vers:maven/3.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-v3p8-j597-3xg8/GHSA-v3p8-j597-3xg8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-306
references:
  - url: https://github.com/apache/hive
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/oqqgnhz4c6nxsfd0xstosnk0g15f7354
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-34538
    reference_type:
    reference_id: CVE-2021-34538
