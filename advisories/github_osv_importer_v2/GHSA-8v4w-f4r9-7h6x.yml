advisory_id: GHSA-8v4w-f4r9-7h6x
datasource_id: github_osv_importer_v2/GHSA-8v4w-f4r9-7h6x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-8v4w-f4r9-7h6x/GHSA-8v4w-f4r9-7h6x.json
aliases:
  - CVE-2024-8037
summary: |
  Vulnerable juju hook tool abstract UNIX domain socket
  ### Impact
  When combined with an attack of `JUJU_CONTEXT_ID`, any user on the local system with access to the default network namespace may connect to the `@/var/lib/juju/agents/unit-xxxx-yyyy/agent.socket` and perform actions that are normally reserved to a juju charm.

  ### Patches
  Patch: https://github.com/juju/juju/commit/2f2ec128ef5a8ca81fc86ae79cfcdbab0007c206
  Patched in:
  - 3.5.4
  - 3.4.6
  - 3.3.7
  - 3.1.10
  - 2.9.51

  ### Workarounds
  No workarounds available.

  ### References
  [GHSA-mh98-763h-m9v4](https://github.com/juju/juju/security/advisories/GHSA-mh98-763h-m9v4)
  https://github.com/juju/juju/blob/725800953aaa29dbeda4f806097bf838e61644dd/worker/uniter/paths.go#L222
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-8v4w-f4r9-7h6x/GHSA-8v4w-f4r9-7h6x.json
  - score: '6.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:L/VI:N/VA:N/SC:N/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-8v4w-f4r9-7h6x/GHSA-8v4w-f4r9-7h6x.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
references:
  - url: https://github.com/juju/juju
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/blob/725800953aaa29dbeda4f806097bf838e61644dd/worker/uniter/paths.go#L222
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/commit/2f2ec128ef5a8ca81fc86ae79cfcdbab0007c206
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/security/advisories/GHSA-8v4w-f4r9-7h6x
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/security/advisories/GHSA-mh98-763h-m9v4
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3174
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-8037
    reference_type:
    reference_id: CVE-2024-8037
