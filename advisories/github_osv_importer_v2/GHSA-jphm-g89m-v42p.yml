advisory_id: GHSA-jphm-g89m-v42p
datasource_id: github_osv_importer_v2/GHSA-jphm-g89m-v42p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-jphm-g89m-v42p/GHSA-jphm-g89m-v42p.json
aliases:
  - CVE-2021-36157
summary: |
  Path traversal in Grafana Cortex
  An issue was discovered in Grafana Cortex through 1.9.0. The header value X-Scope-OrgID is used to construct file paths for rules files, and if crafted to conduct directory traversal such as ae ../../sensitive/path/in/deployment pathname, then Cortex will attempt to parse a rules file at that location and include some of the contents in the error message. (Other Cortex API requests can also be sent a malicious OrgID header, e.g., tricking the ingester into writing metrics to a different location, but the effect is nuisance rather than information disclosure.)
impacted_packages: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/cortexproject/cortex
    reference_type:
    reference_id:
  - url: https://github.com/cortexproject/cortex/commit/d9e1f81f40c607b9e97c2fc6db70ae54679917c4
    reference_type:
    reference_id:
  - url: https://github.com/cortexproject/cortex/pull/4375
    reference_type:
    reference_id:
  - url: https://grafana.com/docs/grafana/latest/release-notes
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-36157
    reference_type:
    reference_id: CVE-2021-36157
