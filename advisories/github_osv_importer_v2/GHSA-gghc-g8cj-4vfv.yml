advisory_id: GHSA-gghc-g8cj-4vfv
datasource_id: github_osv_importer_v2/GHSA-gghc-g8cj-4vfv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-gghc-g8cj-4vfv/GHSA-gghc-g8cj-4vfv.json
aliases:
  - CVE-2021-21684
summary: |
  Stored XSS vulnerability in Jenkins Git Plugin
  Jenkins Git Plugin 4.8.2 and earlier does not escape the Git SHA-1 checksum parameters provided to commit notifications when displaying them in a build cause.

  This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to submit crafted commit notifications to the `/git/notifyCommit` endpoint.

  Jenkins Git Plugin 4.8.3 rejects Git SHA-1 checksum parameters that do not match the expected format. Existing values are sanitized when displayed on the UI.

  This vulnerability is only exploitable in Jenkins 2.314 and earlier, LTS 2.303.1 and earlier. See the [LTS upgrade guide](https://www.jenkins.io/doc/upgrade-guide/2.303/#SECURITY-2452).
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/git
    affected_versions: vers:maven/<=4.8.2
    fixed_versions: vers:maven/4.8.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-gghc-g8cj-4vfv/GHSA-gghc-g8cj-4vfv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-116
  - CWE-79
references:
  - url: https://github.com/jenkinsci/git-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/git-plugin/commit/5474cc942bfba60927be629ff47fb41c38c66741
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2021-10-06/#SECURITY-2499
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/10/06/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21684
    reference_type:
    reference_id: CVE-2021-21684
