advisory_id: GHSA-6gc6-m364-85ww
datasource_id: github_osv_importer_v2/GHSA-6gc6-m364-85ww
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-6gc6-m364-85ww/GHSA-6gc6-m364-85ww.json
aliases:
  - CVE-2020-5225
summary: |
  Log injection in SimpleSAMLphp
  ### Background

  SimpleSAMLphp has a logging functionality that allows system administrators to keep track of the activity, errors, and statistics. Additionally, it allows users to report errors, shall they happen. An error report contains a report identifier, which is logged once submitted.

  ### Description

  The `www/erroreport.php` script, which receives error reports and sends them via email to the system administrator, didn't properly sanitize the report identifier obtained from the request. This allows an attacker, under specific circumstances, to inject new log lines by manually crafting this report ID.

  When configured to use the `file` logging handler, SimpleSAMLphp will output all its logs by appending each log line to a given file. Since the `reportID` parameter received in a request sent to `www/errorreport.php` was not properly sanitized, it was possible to inject newline characters into it, effectively allowing a malicious user to inject new log lines with arbitrary content.

  ### Affected versions

  SimpleSAMLphp versions up to **1.18.3**.

  ### Impact

  An attacker may use this issue to inject logs messages into a SimpleSAMLphp log file, trying to trick or confuse system administrators. However, the attack surface is considered small, as the attack will only work with the `file` logging handler, which opens the log file in _append-only_ mode. This means an attacker cannot edit or remove existing log messages, and even if non-ascii characters are written to the log, the file will always be readable with a simple text editor.

  ### Resolution

  Upgrade the SimpleSAMLphp installation to version **1.18.4**.

  ### Credit

  This vulnerability was discovered and reported by Frederic Vleminckx on January 23, 2020.
impacted_packages:
  - purl: pkg:composer/simplesamlphp/simplesamlphp
    affected_versions: vers:composer/<1.18.4
    fixed_versions: vers:composer/1.18.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-6gc6-m364-85ww/GHSA-6gc6-m364-85ww.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: https://github.com/simplesamlphp/simplesamlphp/security/advisories/GHSA-6gc6-m364-85ww
    reference_type:
    reference_id:
  - url: https://simplesamlphp.org/security/202001-02
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5225
    reference_type:
    reference_id: CVE-2020-5225
