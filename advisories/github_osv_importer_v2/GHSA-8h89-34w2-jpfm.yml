advisory_id: GHSA-8h89-34w2-jpfm
datasource_id: github_osv_importer_v2/GHSA-8h89-34w2-jpfm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-8h89-34w2-jpfm/GHSA-8h89-34w2-jpfm.json
aliases:
  - CVE-2022-36092
summary: |
  XWiki Platform Old Core vulnerable to Authentication Bypass Using the Login Action
  ### Impact
  All rights checks that would normally prevent a user from viewing a document on a wiki can be bypassed using the login action and directly specified templates. This exposes title, content and comments of any document and properties of objects (class and property name must be known, though). This is also exploitable on [private wikis](https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Access%20Rights/#HPrivateWiki).

  ### Patches
  This has been patched in versions 14.2 and 13.10.4 by properly checking view rights before loading documents and disallowing non-default templates in the login, registration and skin action.

  ### Workarounds
  It would be possible to protect all templates individually by adding code to check access rights first, but due to the number of templates and the fact that some of them need to be used without view rights, this seems impractical.

  ### References
  * https://jira.xwiki.org/browse/XWIKI-19549
  * https://jira.xwiki.org/browse/XWIKI-18602

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  * Email us at [security mailing-list](mailto:security@xwiki.com)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-oldcore
    affected_versions: vers:maven/<13.10.4
    fixed_versions: vers:maven/13.10.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-oldcore
    affected_versions: vers:maven/>=14.0|<14.2
    fixed_versions: vers:maven/14.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-8h89-34w2-jpfm/GHSA-8h89-34w2-jpfm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/9b7057d57a941592d763992d4299456300918208
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-8h89-34w2-jpfm
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-18602
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19549
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-36092
    reference_type:
    reference_id: CVE-2022-36092
