advisory_id: GHSA-223g-8w3x-98wr
datasource_id: github_osv_importer_v2/GHSA-223g-8w3x-98wr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-223g-8w3x-98wr/GHSA-223g-8w3x-98wr.json
aliases:
  - CVE-2023-34230
summary: "Snowflake Connector .Net Command Injection\n### Issue\nSnowflake was informed via\
  \ our bug bounty program of a command injection vulnerability in the Snowflake .NET driver\
  \ via SSO URL authentication.\n\n### Impacted driver package: \nsnowflake-connector-net\n\n\
  ### Impacted version range: \nbefore [Version 2.0.18](https://community.snowflake.com/s/article/Dot-NET-Driver-Release-Notes)\n\
  \n### Attack Scenario\nIn order to exploit the potential for command injection, an attacker\
  \ would need to be successful in (1) establishing a malicious resource and (2) redirecting\
  \ users to utilize the resource. The attacker could set up a malicious, publicly accessible\
  \ server which responds to the SSO URL with an attack payload. If the attacker then tricked\
  \ a user into visiting the maliciously crafted connection URL, the userâ€™s local machine would\
  \ render the malicious payload, leading to a remote code execution. \n\nThis attack scenario\
  \ can be mitigated through URL whitelisting as well as common anti-phishing resources.  \n\
  \n### Solution\nOn December 2nd, 2022, Snowflake merged a patch that fixed a command injection\
  \ vulnerability in the Snowflake .NET driver via SSO URL authentication. The vulnerability\
  \ affected the Snowflake .NET driver before Version 2.0.18. We strongly recommend upgrading\
  \ to the latest driver version as soon as possible via the following resources: [Snowflake\
  \ .NET Driver](https://docs.snowflake.com/en/developer-guide/dotnet/dotnet-driver).\n\n###\
  \ Additional Information\nIf you discover a security vulnerability in one of our products\
  \ or websites, please report the issue to HackerOne. For more information, please see our\
  \ [Vulnerability Disclosure Policy](https://hackerone.com/snowflake?type=team)."
impacted_packages:
  - purl: pkg:nuget/Snowflake.Data
    affected_versions: vers:nuget/<2.0.18
    fixed_versions: vers:nuget/2.0.18
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-223g-8w3x-98wr/GHSA-223g-8w3x-98wr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
references:
  - url: https://github.com/snowflakedb/snowflake-connector-net
    reference_type:
    reference_id:
  - url: https://github.com/snowflakedb/snowflake-connector-net/security/advisories/GHSA-223g-8w3x-98wr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34230
    reference_type:
    reference_id: CVE-2023-34230
