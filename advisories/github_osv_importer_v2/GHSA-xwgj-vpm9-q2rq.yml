advisory_id: GHSA-xwgj-vpm9-q2rq
datasource_id: github_osv_importer_v2/GHSA-xwgj-vpm9-q2rq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-xwgj-vpm9-q2rq/GHSA-xwgj-vpm9-q2rq.json
aliases:
  - CVE-2024-8038
summary: |
  Vulnerable juju introspection abstract UNIX domain socket
  ### Impact
  An abstract UNIX domain socket responsible for introspection is available without authentication locally to any user with access to the network namespace where the local juju agent is running.

  On a juju controller agent, denial of service can be performed by using the `/leases/revoke` endpoint. Revoking leases in juju can cause availability issues.

  On a juju machine agent that is hosting units, disabling the unit component can be performed using the `/units` endpoint with a "stop" action.

  ### Patches
  Patch: https://github.com/juju/juju/commit/43f0fc59790d220a457d4d305f484f62be556d3b
  Patched in:
  - 3.5.4
  - 3.4.6
  - 3.3.7
  - 3.1.10
  - 2.9.51

  ### Workarounds
  No workaround.

  ### References
  https://github.com/juju/juju/blob/725800953aaa29dbeda4f806097bf838e61644dd/worker/introspection/worker.go#L125
impacted_packages: []
severities:
  - score: '7.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-xwgj-vpm9-q2rq/GHSA-xwgj-vpm9-q2rq.json
  - score: '6.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:L/VI:N/VA:N/SC:N/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-xwgj-vpm9-q2rq/GHSA-xwgj-vpm9-q2rq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/juju/juju
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/blob/725800953aaa29dbeda4f806097bf838e61644dd/worker/introspection/worker.go#L125
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/commit/43f0fc59790d220a457d4d305f484f62be556d3b
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/security/advisories/GHSA-xwgj-vpm9-q2rq
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3175
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-8038
    reference_type:
    reference_id: CVE-2024-8038
