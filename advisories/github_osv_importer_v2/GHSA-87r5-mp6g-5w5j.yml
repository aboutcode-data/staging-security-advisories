advisory_id: GHSA-87r5-mp6g-5w5j
datasource_id: github_osv_importer_v2/GHSA-87r5-mp6g-5w5j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-87r5-mp6g-5w5j/GHSA-87r5-mp6g-5w5j.json
aliases:
  - CVE-2026-1615
summary: |
  jsonpath has Arbitrary Code Injection via Unsafe Evaluation of JSON Path Expressions
  ### Impact

  **Arbitrary Code Injection (Remote Code Execution & XSS):**

  A critical security vulnerability affects **all versions** of the `jsonpath` package. The library relies on the `static-eval` module to evaluate JSON Path expressions but fails to properly sanitize or sandbox the input.

  This allows an attacker to inject arbitrary JavaScript code into the JSON Path expression. When the library evaluates this expression, the malicious code is executed.

  * **Node.js Environments:** This leads to **Remote Code Execution (RCE)**, allowing an attacker to compromise the server.
  * **Browser Environments:** This leads to **Cross-Site Scripting (XSS)**, allowing an attacker to hijack user sessions or exfiltrate data.

  **Affected Methods:**

  The vulnerability triggers when untrusted data is passed to any method that evaluates a path, including:

  * `jsonpath.query`
  * `jsonpath.nodes`
  * `jsonpath.paths`
  * `jsonpath.value`
  * `jsonpath.parent`
  * `jsonpath.apply`

  ### Patches

  **No Patch Available:**

  Currently, **all versions** of `jsonpath` are vulnerable. There is no known patched version of this package that resolves the issue while retaining the current architecture.

  **Recommendation:**

  Developers are strongly advised to **migrate to a secure alternative** (such as `jsonpath-plus` or similar libraries that do not use `eval`/`static-eval`) or strictly validate all JSON Path inputs against a known allowlist.

  ### Workarounds

  * **Strict Input Validation:** Ensure that no user-supplied data is ever passed directly to `jsonpath` functions.
  * **Sanitization:** If user input is unavoidable, implement a strict parser to reject any JSON Path expressions containing executable JavaScript syntax (e.g., parentheses `()`, script expressions `script:`, or function calls).

  ### Resources

  * [CVE-2026-1615](https://nvd.nist.gov/vuln/detail/CVE-2026-1615)
  * [Vulnerable Code in handlers.js](https://github.com/dchester/jsonpath/blob/c1dd8ec74034fb0375233abb5fdbec51ac317b4b/lib/handlers.js#L243)
  * [Snyk Advisory (Java/WebJars)](https://security.snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-15141219)
  * [Snyk Advisory (JS)](https://security.snyk.io/vuln/SNYK-JS-JSONPATH-13645034)
impacted_packages:
  - purl: pkg:npm/jsonpath
    affected_versions: vers:npm/<=1.2.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-87r5-mp6g-5w5j/GHSA-87r5-mp6g-5w5j.json
  - score: '8.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-87r5-mp6g-5w5j/GHSA-87r5-mp6g-5w5j.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/dchester/jsonpath
    reference_type:
    reference_id:
  - url: https://github.com/dchester/jsonpath/blob/c1dd8ec74034fb0375233abb5fdbec51ac317b4b/lib/handlers.js#L243
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-1615
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-15141219
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-JS-JSONPATH-13645034
    reference_type:
    reference_id:
