advisory_id: GHSA-vw22-465p-8j5w
datasource_id: github_osv_importer_v2/GHSA-vw22-465p-8j5w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-vw22-465p-8j5w/GHSA-vw22-465p-8j5w.json
aliases:
  - CVE-2017-10689
summary: |
  Tarball permission preservation in puppet
  When installing a module using the system tar, the PMT will filter filesystem permissions to a sane value. This may just be based on the user's umask.

  When using minitar, files are unpacked with whatever permissions are in the tarball. This is potentially unsafe, as tarballs can be easily created with weird permissions.
impacted_packages:
  - purl: pkg:gem/puppet
    affected_versions: vers:gem/<4.10.10
    fixed_versions: vers:gem/4.10.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/puppet
    affected_versions: vers:gem/>=5.0.0|<5.3.4
    fixed_versions: vers:gem/5.3.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-vw22-465p-8j5w/GHSA-vw22-465p-8j5w.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://access.redhat.com/errata/RHSA-2018:2927
    reference_type:
    reference_id:
  - url: https://github.com/puppetlabs/puppet
    reference_type:
    reference_id:
  - url: https://github.com/puppetlabs/puppet/commit/17d9e02da3882e44c1876e2805cf9708481715ee
    reference_type:
    reference_id:
  - url: https://github.com/puppetlabs/puppet/commit/2f1047f85e22cde139a421bc25d371f2ffc92cb1
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/puppet/CVE-2017-10689.yml
    reference_type:
    reference_id:
  - url: https://puppet.com/security/cve/CVE-2017-10689
    reference_type:
    reference_id:
  - url: https://tickets.puppetlabs.com/browse/PUP-7866
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/3567-1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-10689
    reference_type:
    reference_id: CVE-2017-10689
