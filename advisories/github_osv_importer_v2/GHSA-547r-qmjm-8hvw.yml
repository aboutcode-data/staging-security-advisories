advisory_id: GHSA-547r-qmjm-8hvw
datasource_id: github_osv_importer_v2/GHSA-547r-qmjm-8hvw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-547r-qmjm-8hvw/GHSA-547r-qmjm-8hvw.json
aliases:
  - CVE-2025-65108
summary: "md-to-pdf vulnerable to arbitrary JavaScript code execution when parsing front matter\n\
  ### Summary\nA Markdown front-matter block that contains JavaScript delimiter causes the JS\
  \ engine in gray-matter library to execute arbitrary code in the Markdown to PDF converter\
  \ process of **md-to-pdf** library, resulting in remote code execution.\n\n### Details\n**md-to-pdf**\
  \ uses the gray-matter library to parse front-matter. Gray-matter exposes a JavaScript engine\
  \ that, when enabled or triggered by certain front-matter delimiters (e.g. ---js or ---javascript),\
  \ will evaluate the front-matter contents as JavaScript. If user-supplied Markdown is fed\
  \ to md-to-pdf and the front-matter contains malicious JS, the converter process will execute\
  \ that code.\n\n\n### PoC\n```\nconst { mdToPdf } = require('md-to-pdf');\n\nvar payload =\
  \ '---javascript\\n((require(\"child_process\")).execSync(\"calc.exe\"))\\n---RCE';\n\n(async\
  \ () => {\n\tawait mdToPdf({ content: payload }, { dest: './output.pdf'});\n})();\n```\nRunning\
  \ the PoC on Windows launches the calculator application, demonstrating arbitrary code execution.\n\
  \n### Impact\n\n- Remote code execution in the process that performs Markdown->PDF conversion.\n\
  - If the converter is run in a web app or cloud service, an attacker uploading malicious Markdown\
  \ can execute arbitrary commands on the"
impacted_packages:
  - purl: pkg:npm/md-to-pdf
    affected_versions: vers:npm/<5.2.5
    fixed_versions: vers:npm/5.2.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-547r-qmjm-8hvw/GHSA-547r-qmjm-8hvw.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/simonhaenisch/md-to-pdf
    reference_type:
    reference_id:
  - url: https://github.com/simonhaenisch/md-to-pdf/commit/46bdcf2051c8d1758b391c1353185a179a47a4d9
    reference_type:
    reference_id:
  - url: https://github.com/simonhaenisch/md-to-pdf/security/advisories/GHSA-547r-qmjm-8hvw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-65108
    reference_type:
    reference_id:
