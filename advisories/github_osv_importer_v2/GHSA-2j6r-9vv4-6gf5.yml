advisory_id: GHSA-2j6r-9vv4-6gf5
datasource_id: github_osv_importer_v2/GHSA-2j6r-9vv4-6gf5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-2j6r-9vv4-6gf5/GHSA-2j6r-9vv4-6gf5.json
aliases: []
summary: |
  github.com/bincyber/go-sqlcrypter vulnerable to IV collision
  There is a risk of an IV collision using the awskms or aesgcm provider. NIST SP 800-38D section 8.3 states that it is unsafe to encrypt more than 2^32 plaintexts under the same key when using a random IV. The limit could easily be reached given the use case of database column encryption. Ciphertexts are likely to be persisted and stored together. IV collision could enable an attacker with access to the ciphertexts to decrypt all messages encrypted with the affected key.

  The aesgcm provider cannot be fixed without a breaking change, so users should not encrypt more than 2^32 values with any key. The awskms package can be fixed without a breaking change by switching to a counter-based IV.
impacted_packages: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-2j6r-9vv4-6gf5/GHSA-2j6r-9vv4-6gf5.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-327
references:
  - url: https://github.com/bincyber/go-sqlcrypter
    reference_type:
    reference_id:
  - url: https://github.com/bincyber/go-sqlcrypter/commit/96c73cd2b8fd15c9da9b3eafe62c9a040f6537e8
    reference_type:
    reference_id:
  - url: https://github.com/bincyber/go-sqlcrypter/issues/127
    reference_type:
    reference_id:
  - url: https://github.com/bincyber/go-sqlcrypter/pull/128
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-2451
    reference_type:
    reference_id:
