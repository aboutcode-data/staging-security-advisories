advisory_id: GHSA-v4mq-x674-ff73
datasource_id: github_osv_importer_v2/GHSA-v4mq-x674-ff73
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-v4mq-x674-ff73/GHSA-v4mq-x674-ff73.json
aliases:
  - CVE-2025-23206
summary: "AWS Cloud Development Kit (AWS CDK) IAM OIDC custom resource allows connection to\
  \ unauthorized OIDC provider\n### Impact\nUsers who use IAM OIDC custom resource provider\
  \ package will download CA Thumbprints as part of the custom resource workflow, https://github.com/aws/aws-cdk/blob/d16482fc8a4a3e1f62751f481b770c09034df7d2/packages/%40aws-cdk/custom-resource-handlers/lib/aws-iam/oidc-handler/external.ts#L34.\
  \ \n\nHowever, the current `tls.connect` method will always set `rejectUnauthorized: false`\
  \ which is a potential security concern. CDK should follow the best practice and set `rejectUnauthorized:\
  \ true`. However, this could be a breaking change for existing CDK applications and we should\
  \ fix this with a feature flag. \n\nNote that this is marked as low severity Security advisory\
  \ because the issuer url is provided by CDK users who define the CDK application. If they\
  \ insist on connecting to a unauthorized OIDC provider, CDK should not disallow this. Additionally,\
  \ the code block is run in a Lambda environment which mitigate the MITM attack.\n\nAs a best\
  \ practice, CDK should still fix this issue under a feature flag to avoid regression.\n\n\
  ```\npackages/@aws-cdk/custom-resource-handlers/lib/aws-iam/oidc-handler/external.ts\n❯❱ problem-based-packs.insecure-transport.js-node.bypass-tls-verification.bypass-tls-verification\n\
  Checks for setting the environment variable NODE_TLS_REJECT_UNAUTHORIZED to 0, which disables\
  \ TLS\nverification. This should only be used for debugging purposes. Setting the option rejectUnauthorized\n\
  to false bypasses verification against the list of trusted CAs, which also leads to insecure\n\
  transport.\n```\n\n### Patches\nThe patch is in progress. To mitigate, upgrade to CDK v2.177.0\
  \ (Expected release date 2025-02-22). \nOnce upgraded, please make sure the feature flag '@aws-cdk/aws-iam:oidcRejectUnauthorizedConnections'\
  \ is set to true in `cdk.context.json` or `cdk.json`. More details on feature flag setting\
  \ is [here](https://docs.aws.amazon.com/cdk/v2/guide/featureflags.html).\n\n### Workarounds\n\
  N/A\n\n### References\nhttps://github.com/aws/aws-cdk/issues/32920"
impacted_packages:
  - purl: pkg:npm/aws-cdk-lib
    affected_versions: vers:npm/<2.177.0
    fixed_versions: vers:npm/2.177.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '1.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:P/PR:H/UI:A/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-v4mq-x674-ff73/GHSA-v4mq-x674-ff73.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-347
references:
  - url: https://docs.aws.amazon.com/cdk/v2/guide/featureflags.html
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/blob/d16482fc8a4a3e1f62751f481b770c09034df7d2/packages/%40aws-cdk/custom-resource-handlers/lib/aws-iam/oidc-handler/external.ts#L34
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/commit/3e4f3773bfa48b75bf0adc7d53d46bbec7714a9e#diff-38a03353f201fd2e520df67fb43f9f000257bffd6e9acaa5569cce7005a77560
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/issues/32920
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/pull/32921
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/releases/tag/v2.177.0
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/security/advisories/GHSA-v4mq-x674-ff73
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23206
    reference_type:
    reference_id: CVE-2025-23206
