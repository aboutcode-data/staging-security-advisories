advisory_id: GHSA-q2qj-628g-vhfw
datasource_id: github_osv_importer_v2/GHSA-q2qj-628g-vhfw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-q2qj-628g-vhfw/GHSA-q2qj-628g-vhfw.json
aliases:
  - CVE-2023-30536
summary: |
  Insecure header validation in slim/psr7
  ### Impact

  An attacker could sneak in a newline (`\n`) into both the header names and values. While the specification states that `\r\n\r\n` is used to terminate the header list, many servers in the wild will also accept `\n\n`. An attacker that is able to control the header names that are passed to Slilm-Psr7 would be able to intentionally craft invalid messages, possibly causing application errors or invalid HTTP requests being sent out with an PSR-18 HTTP client. The latter might present a denial of service vector if a remote serviceâ€™s web application firewall bans the application due to the receipt of malformed requests.

  ### Patches

  The issue is patched in 1.6.1, 1.5.1, and 1.4.1.

  ### Workarounds

  In Slim-Psr7 prior to 1.6.1, 1.5.1, and 1.4.1, validate HTTP header keys and/or values, and if using user-supplied values, filter them to strip off leading or trailing newline characters before calling withHeader().

  ### Acknowledgments

  We are very grateful to and thank <a href="https://gjcampbell.co.uk/">Graham Campbell</a> for reporting and working with us on this issue.

  ### References

  * Guzzle: CVE-2023-29197, with advisory GHSA-wxmh-65f7-jcvw
  * Laminas Diactoros: CVE-2023-29530, with advisory GHSA-xv3h-4844-9h36
  * https://www.rfc-editor.org/rfc/rfc7230#section-3.2.4
impacted_packages:
  - purl: pkg:composer/slim/psr7
    affected_versions: vers:composer/>=1.6.0|<1.6.1
    fixed_versions: vers:composer/1.6.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/slim/psr7
    affected_versions: vers:composer/>=1.5.0|<1.5.1
    fixed_versions: vers:composer/1.5.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/slim/psr7
    affected_versions: vers:composer/<1.4.1
    fixed_versions: vers:composer/1.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-q2qj-628g-vhfw/GHSA-q2qj-628g-vhfw.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-436
references:
  - url: https://github.com/slimphp/Slim-Psr7
    reference_type:
    reference_id:
  - url: https://github.com/slimphp/Slim-Psr7/commit/ed1d553225dd190875d8814c47460daed4b550bb
    reference_type:
    reference_id:
  - url: https://github.com/slimphp/Slim-Psr7/issues/284#issuecomment-1541328898
    reference_type:
    reference_id:
  - url: https://github.com/slimphp/Slim-Psr7/releases/tag/1.4.1
    reference_type:
    reference_id:
  - url: https://github.com/slimphp/Slim-Psr7/releases/tag/1.5.1
    reference_type:
    reference_id:
  - url: https://github.com/slimphp/Slim-Psr7/releases/tag/1.6.1
    reference_type:
    reference_id:
  - url: https://github.com/slimphp/Slim-Psr7/security/advisories/GHSA-q2qj-628g-vhfw
    reference_type:
    reference_id:
  - url: https://www.rfc-editor.org/rfc/rfc7230#section-3.2.4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-30536
    reference_type:
    reference_id: CVE-2023-30536
