advisory_id: GHSA-hc82-w9v8-83pr
datasource_id: github_osv_importer_v2/GHSA-hc82-w9v8-83pr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-hc82-w9v8-83pr/GHSA-hc82-w9v8-83pr.json
aliases:
  - CVE-2022-39389
summary: "Witness Block Parsing DoS Vulnerability\n### Impact\n\nAll lnd nodes before version\
  \ `v0.15.4` are vulnerable to a block parsing bug that can cause a node to enter a degraded\
  \ state once encountered. In this degraded state, nodes can continue to make payments and\
  \ forward HTLCs, and close out channels. Opening channels is prohibited, and also on chain\
  \ transaction events will be undetected. \n\nThis can cause loss of funds if a CSV expiry\
  \ is researched during a breach attempt or a CLTV delta expires forgetting the funds in the\
  \ HTLC. \n\n### Patches\n\nA patch is available starting with lnd `v0.15.4`. \n\n### Workarounds\n\
  \nNodes can use the `lncli updatechanpolicy` RPC call to increase their CLTV value to a very\
  \ high amount or increase their fee policies. This will prevent nodes from routing through\
  \ your node, meaning that no pending HTLCs can be present. \n\n### References\n\nhttps://github.com/lightningnetwork/lnd/issues/7096\n\
  \nhttps://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta"
impacted_packages: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-hc82-w9v8-83pr/GHSA-hc82-w9v8-83pr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/lightningnetwork/lnd
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/issues/7096
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/pull/7098
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39389
    reference_type:
    reference_id: CVE-2022-39389
