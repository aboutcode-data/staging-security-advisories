advisory_id: GHSA-w749-p3v6-hccq
datasource_id: github_osv_importer_v2/GHSA-w749-p3v6-hccq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-w749-p3v6-hccq/GHSA-w749-p3v6-hccq.json
aliases:
  - CVE-2022-21831
summary: |
  Possible code injection vulnerability in Rails / Active Storage
  The Active Storage module of Rails starting with version 5.2.0 is possibly vulnerable to code injection. This issue was patched in versions 5.2.6.3, 6.0.4.7, 6.1.4.7, and 7.0.2.3. To work around this issue, applications should implement a strict allow-list on accepted transformation methods or arguments.  Additionally, a strict ImageMagick security policy will help mitigate this issue.
impacted_packages:
  - purl: pkg:gem/activestorage
    affected_versions: vers:gem/<=5.2.6.2
    fixed_versions: vers:gem/5.2.6.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activestorage
    affected_versions: vers:gem/<=6.0.4.6
    fixed_versions: vers:gem/6.0.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activestorage
    affected_versions: vers:gem/<=6.1.4.6
    fixed_versions: vers:gem/6.1.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activestorage
    affected_versions: vers:gem/<=7.0.2.2
    fixed_versions: vers:gem/7.0.2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-w749-p3v6-hccq/GHSA-w749-p3v6-hccq.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/advisories/GHSA-w749-p3v6-hccq
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/0a72f7d670e9aa77a0bb8584cb1411ddabb7546e
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activestorage/CVE-2022-21831.yml
    reference_type:
    reference_id:
  - url: https://groups.google.com/g/rubyonrails-security/c/n-p-W1yxatI
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/09/msg00002.html
    reference_type:
    reference_id:
  - url: https://rubysec.com/advisories/CVE-2022-21831
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20221118-0001
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2023/dsa-5372
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21831
    reference_type:
    reference_id: CVE-2022-21831
