advisory_id: GHSA-j68f-8h6p-9h5q
datasource_id: github_osv_importer_v2/GHSA-j68f-8h6p-9h5q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-j68f-8h6p-9h5q/GHSA-j68f-8h6p-9h5q.json
aliases:
  - CVE-2011-3923
summary: |
  Struts ParameterInterceptor vulnerability allows remote command execution
  Regular expression in ParametersInterceptor matches `top['foo'](0)` as a valid expression, which OGNL treats as `(top['foo'])(0)` and evaluates the value of 'foo' action parameter as an OGNL expression. This lets malicious users put arbitrary OGNL statements into any String variable exposed by an action and have it evaluated as an OGNL expression and since OGNL statement is in HTTP parameter value attacker can use blacklisted characters (e.g. #) to disable method execution and execute arbitrary methods, bypassing the ParametersInterceptor and OGNL library protections.
impacted_packages:
  - purl: pkg:maven/org.apache.struts/struts2-core
    affected_versions: vers:maven/>=2.0.0|<2.3.1.2
    fixed_versions: vers:maven/2.3.1.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-j68f-8h6p-9h5q/GHSA-j68f-8h6p-9h5q.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
  - CWE-732
references:
  - url: http://blog.o0o.nu/2012/01/cve-2011-3923-yet-another-struts2.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2011-3923
    reference_type:
    reference_id:
  - url: https://exchange.xforce.ibmcloud.com/vulnerabilities/72585
    reference_type:
    reference_id:
  - url: https://security-tracker.debian.org/tracker/CVE-2011-3923
    reference_type:
    reference_id:
  - url: http://struts.apache.org/development/2.x/docs/s2-009.html
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20140725074137/http://seclists.org/fulldisclosure/2014/Jul/38
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2011-3923
    reference_type:
    reference_id: CVE-2011-3923
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/multiple/remote/24874.rb
    reference_type: exploit
    reference_id: CVE-2011-3923;OSVDB-78501
