advisory_id: GHSA-xmmm-jw76-q7vg
datasource_id: github_osv_importer_v2/GHSA-xmmm-jw76-q7vg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-xmmm-jw76-q7vg/GHSA-xmmm-jw76-q7vg.json
aliases:
  - CVE-2024-7318
summary: |
  Keycloaks's One Time Passcode (OTP) is valid longer than expiration timeSeverity
  A vulnerability was found in Keycloak. Expired OTP codes are still usable when using FreeOTP when the OTP token period is set to 30 seconds (default). Instead of expiring and deemed unusable around 30 seconds in, the tokens are valid for an additional 30 seconds totaling 1 minute. A one time passcode that is valid longer than its expiration time increases the attack window for malicious actors to abuse the system and compromise accounts. Additionally, it increases the attack surface because at any given time, two OTPs are valid.
impacted_packages:
  - purl: pkg:maven/org.keycloak/keycloak-core
    affected_versions: vers:maven/<24.0.7
    fixed_versions: vers:maven/24.0.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.keycloak/keycloak-core
    affected_versions: vers:maven/>=25.0.0|<25.0.4
    fixed_versions: vers:maven/25.0.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-xmmm-jw76-q7vg/GHSA-xmmm-jw76-q7vg.json
  - score: '6.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-xmmm-jw76-q7vg/GHSA-xmmm-jw76-q7vg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-324
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-7318
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak/security/advisories/GHSA-xmmm-jw76-q7vg
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2301876
    reference_type: bug
    reference_id: 2301876
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-7318
    reference_type:
    reference_id: CVE-2024-7318
  - url: https://access.redhat.com/errata/RHSA-2024:6502
    reference_type:
    reference_id: RHSA-2024:6502
  - url: https://access.redhat.com/errata/RHSA-2024:6503
    reference_type:
    reference_id: RHSA-2024:6503
