advisory_id: GHSA-xqh8-5j36-4556
datasource_id: github_osv_importer_v2/GHSA-xqh8-5j36-4556
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/08/GHSA-xqh8-5j36-4556/GHSA-xqh8-5j36-4556.json
aliases:
  - CVE-2019-15658
summary: |
  SQL Injection in connect-pg-simple
  ### Impact
  An unlikely SQL injection if the case of an unsanitized table name input.

  ### Patches
  The user should upgrade to `6.0.1`. Due to its low impact a backport has not been made to the `5.x` branch.

  ### Workarounds
  If there is no likelihood that the `tableName` or `schemaName` options sent to the constructor could be of an unsanitized nature, then no workaround is needed. Else the input could be sanitized and escaped before sending it in. Take note though that such an escaping would need to be removed when upgrading to `6.0.1` or later, to avoid double escaping.

  ### References
  * [Security issue disclosure](https://github.com/voxpelli/node-connect-pg-simple/issues/151)

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [voxpelli/node-connect-pg-simple](https://github.com/voxpelli/node-connect-pg-simple)
  * Email maintainer at [pelle@kodfabrik.se](mailto:pelle@kodfabrik.se)
impacted_packages:
  - purl: pkg:npm/connect-pg-simple
    affected_versions: vers:npm/<6.0.1
    fixed_versions: vers:npm/6.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/08/GHSA-xqh8-5j36-4556/GHSA-xqh8-5j36-4556.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/advisories/GHSA-xqh8-5j36-4556
    reference_type:
    reference_id:
  - url: https://github.com/voxpelli/node-connect-pg-simple
    reference_type:
    reference_id:
  - url: https://github.com/voxpelli/node-connect-pg-simple/security/advisories/GHSA-xqh8-5j36-4556
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-CONNECTPGSIMPLE-460154
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1153
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-15658
    reference_type:
    reference_id: CVE-2019-15658
