advisory_id: GHSA-558p-m34m-vpmq
datasource_id: github_osv_importer_v2/GHSA-558p-m34m-vpmq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-558p-m34m-vpmq/GHSA-558p-m34m-vpmq.json
aliases:
  - CVE-2023-30846
summary: "Potential leak of authentication data to 3rd parties\n### Impact\nUsers of typed-rest-client\
  \ library version 1.7.3 or lower are vulnerable to leak authentication data to 3rd parties.\
  \ \n\nThe flow of the vulnerability is as follows:\n\n1. Send any request with `BasicCredentialHandler`,\
  \ `BearerCredentialHandler` or `PersonalAccessTokenCredentialHandler` \n2. The target host\
  \ may return a redirection (3xx), with a link to a second host.\n3. The next request will\
  \ use the credentials to authenticate with the second host, by setting the `Authorization`\
  \ header.\n\nThe expected behavior is that the next request will *NOT* set the `Authorization`\
  \ header.\n\n\n### Patches\nThe problem was fixed on April 1st 2020.\n\n\n### Workarounds\n\
  There is no workaround.\n\n### References\nThis is similar to the following issues in nature:\n\
  1. [HTTP authentication leak in redirects](https://curl.haxx.se/docs/CVE-2018-1000007.html)\
  \ - I used the same solution as CURL did.\n2. [CVE-2018-1000007](https://nvd.nist.gov/vuln/detail/CVE-2018-1000007)."
impacted_packages:
  - purl: pkg:npm/typed-rest-client
    affected_versions: vers:npm/<1.8.0
    fixed_versions: vers:npm/1.8.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-558p-m34m-vpmq/GHSA-558p-m34m-vpmq.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-522
references:
  - url: https://github.com/microsoft/typed-rest-client
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/typed-rest-client/commit/f9ff755631b982ee1303dfc3e3c823d0d31233e8
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/typed-rest-client/pull/207
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/typed-rest-client/security/advisories/GHSA-558p-m34m-vpmq
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230601-0008
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-30846
    reference_type:
    reference_id: CVE-2023-30846
