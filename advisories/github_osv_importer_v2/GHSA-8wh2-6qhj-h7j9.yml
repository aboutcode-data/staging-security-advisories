advisory_id: GHSA-8wh2-6qhj-h7j9
datasource_id: github_osv_importer_v2/GHSA-8wh2-6qhj-h7j9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-8wh2-6qhj-h7j9/GHSA-8wh2-6qhj-h7j9.json
aliases:
  - CVE-2024-36124
summary: |
  iq80 Snappy out-of-bounds read when uncompressing data, leading to JVM crash
  ### Summary
  iq80 Snappy performs out-of-bounds read access when uncompressing certain data, which can lead to a JVM crash.

  ### Details
  When uncompressing certain data, Snappy tries to read outside the bounds of the given byte arrays. Because Snappy uses the JDK class `sun.misc.Unsafe` to speed up memory access, no additional bounds checks are performed and this has similar security consequences as out-of-bounds access in C or C++, namely it can lead to non-deterministic behavior or crash the JVM.

  iq80 Snappy is not actively maintained anymore. As quick fix users can upgrade to version 0.5, but in the long term users should prefer migrating to the Snappy implementation in https://github.com/airlift/aircompressor (version 0.27 or newer).

  ### Impact
  When uncompressing data from untrusted users, this can be exploited for a denial-of-service attack by crashing the JVM.
impacted_packages:
  - purl: pkg:maven/org.iq80.snappy/snappy
    affected_versions: vers:maven/<0.5
    fixed_versions: vers:maven/0.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-8wh2-6qhj-h7j9/GHSA-8wh2-6qhj-h7j9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-125
references:
  - url: https://github.com/dain/snappy
    reference_type:
    reference_id:
  - url: https://github.com/dain/snappy/security/advisories/GHSA-8wh2-6qhj-h7j9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-36124
    reference_type:
    reference_id: CVE-2024-36124
