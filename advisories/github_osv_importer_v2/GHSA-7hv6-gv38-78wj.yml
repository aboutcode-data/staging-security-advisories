advisory_id: GHSA-7hv6-gv38-78wj
datasource_id: github_osv_importer_v2/GHSA-7hv6-gv38-78wj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-7hv6-gv38-78wj/GHSA-7hv6-gv38-78wj.json
aliases:
  - CVE-2023-32310
summary: |
  DataEase API interface has IDOR vulnerability
  ### Impact
  The api interface for DataEase delete dashboard and delete system messages is vulnerable to IDOR.

  The interface to delete the dashboard:
  1. Create two users: user1 and user2
  2. User1 creates a dashboard named pan1
  3. User2 creates a dashboard named pan2
  4. Both user1 and user2 share their dashboards with the demo user
  5. User1 wants to delete his dashboard. We hijack the request with burpsuite. The request will probably look like this: POST /api/share/removePanelShares/440efa7f-efd8-11ed-bec7-1144724bc08c HTTP/1.1. 440efa7f-efd8-11ed-bec7-1144724bc08c is the ID of pan1
  6. We replace this ID with the ID of pan2 and continue the execution (i.e. we delete the shares of others)
  7. Successfully remove the shared link
  ![image](https://user-images.githubusercontent.com/985347/238271028-d23a9ca3-cd77-42a2-9199-a28ef03f5bf0.png)

  The interface to delete system messages:
  1. Our request to delete a message is shown below
  ![image](https://user-images.githubusercontent.com/985347/238271474-1bf6be85-7a39-436d-b209-ac88bf52b591.png)
  2. We can delete all messages by simply enumerating the message ID, regardless of whether the message belongs to the requester or not.
  3. The interface for marking read messages is also affected

  Affected versions: <= 1.18.6

  ### Patches
  The vulnerability has been fixed in v1.18.7.

  ### Workarounds
  It is recommended to upgrade the version to v1.18.7.

  ### References
  If you have any questions or comments about this advisory:

  Open an issue in https://github.com/dataease/dataease
  Email us at [wei@fit2cloud.com](mailto:wei@fit2cloud.com)
impacted_packages:
  - purl: pkg:maven/io.dataease/dataease-plugin-common
    affected_versions: vers:maven/<=1.18.6
    fixed_versions: vers:maven/1.18.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-7hv6-gv38-78wj/GHSA-7hv6-gv38-78wj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-639
references:
  - url: https://github.com/dataease/dataease
    reference_type:
    reference_id:
  - url: https://github.com/dataease/dataease/commit/72f428e87b5395c03d2f94ef6185fc247ddbc8dc
    reference_type:
    reference_id:
  - url: https://github.com/dataease/dataease/pull/5342
    reference_type:
    reference_id:
  - url: https://github.com/dataease/dataease/releases/tag/v1.18.7
    reference_type:
    reference_id:
  - url: https://github.com/dataease/dataease/security/advisories/GHSA-7hv6-gv38-78wj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-32310
    reference_type:
    reference_id: CVE-2023-32310
