advisory_id: GHSA-4hc4-pgfx-3mrx
datasource_id: github_osv_importer_v2/GHSA-4hc4-pgfx-3mrx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-4hc4-pgfx-3mrx/GHSA-4hc4-pgfx-3mrx.json
aliases:
  - CVE-2023-27593
summary: "cilium-agent container can access the host via `hostPath` mount\n### Impact\n\nAn\
  \ attacker with access to a Cilium agent pod can write to `/opt/cni/bin` due to a `hostPath`\
  \ mount of that directory in the agent pod. By replacing the CNI binary with their own malicious\
  \ binary and waiting for the creation of a new pod on the node, the attacker can gain access\
  \ to the underlying node. \n\n### Patches\n\nThe issue has been fixed and is available on\
  \ versions >=1.11.15, >=1.12.8, >=1.13.1.\n\n### Workarounds\n\n[Kubernetes RBAC](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)\
  \ should be used to deny users and service accounts `exec` access to Cilium agent pods.\n\n\
  In cases where a user requires `exec` access to Cilium agent pods, but should not have access\
  \ to the underlying node, no workaround is possible.\n\n### References\n\n* [PR containing\
  \ resolution](https://github.com/cilium/cilium/pull/24075)\n\n### Acknowledgements\n\nThe\
  \ Cilium community has worked together with members of Isovalent and Form3 to prepare these\
  \ mitigations. Special thanks to Anastasios Koutlis, Daniel Teixeira, and Magdalena Oczadly\
  \ for their cooperation. \n\n### For more information\n\nIf you have any questions or comments\
  \ about this advisory, please reach out on [Slack](https://docs.cilium.io/en/latest/community/community/#slack).\n\
  \nAs usual, if you think you found a related vulnerability, we strongly encourage you to report\
  \ security vulnerabilities to our private security mailing list: security@cilium.io - first,\
  \ before disclosing them in any public forums. This is a private mailing list where only members\
  \ of the Cilium internal security team are subscribed to, and is treated as top priority."
impacted_packages: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-4hc4-pgfx-3mrx/GHSA-4hc4-pgfx-3mrx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-276
references:
  - url: https://github.com/cilium/cilium
    reference_type:
    reference_id:
  - url: https://github.com/cilium/cilium/pull/24075
    reference_type:
    reference_id:
  - url: https://github.com/cilium/cilium/releases/tag/v1.11.15
    reference_type:
    reference_id:
  - url: https://github.com/cilium/cilium/releases/tag/v1.12.8
    reference_type:
    reference_id:
  - url: https://github.com/cilium/cilium/releases/tag/v1.13.1
    reference_type:
    reference_id:
  - url: https://github.com/cilium/cilium/security/advisories/GHSA-4hc4-pgfx-3mrx
    reference_type:
    reference_id:
  - url: https://kubernetes.io/docs/reference/access-authn-authz/rbac
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-27593
    reference_type:
    reference_id: CVE-2023-27593
