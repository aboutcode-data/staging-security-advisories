advisory_id: GHSA-w5xm-mx47-v7c8
datasource_id: github_osv_importer_v2/GHSA-w5xm-mx47-v7c8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-w5xm-mx47-v7c8/GHSA-w5xm-mx47-v7c8.json
aliases:
  - CVE-2024-4146
summary: |
  lunary-ai/lunary allows users unauthorized access to projects
  Withdrawn: This advisory was incorrectly linked the the npm package `lunary`. The advisory is valid, but not for that packlage.

  In lunary-ai/lunary version v1.2.13, an incorrect authorization vulnerability exists that allows unauthorized users to access and manipulate projects within an organization they should not have access to. Specifically, the vulnerability is located in the `checkProjectAccess` method within the authorization middleware, which fails to adequately verify if a user has the correct permissions to access a specific project. Instead, it only checks if the user is part of the organization owning the project, overlooking the necessary check against the `account_project` table for explicit project access rights. This flaw enables attackers to gain complete control over all resources within a project, including the ability to create, update, read, and delete any resource, compromising the privacy and security of sensitive information.
impacted_packages:
  - purl: pkg:npm/lunary
    affected_versions: vers:npm/<1.2.26
    fixed_versions: vers:npm/1.2.26
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-w5xm-mx47-v7c8/GHSA-w5xm-mx47-v7c8.json
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-w5xm-mx47-v7c8/GHSA-w5xm-mx47-v7c8.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
  - CWE-863
references:
  - url: https://github.com/lunary-ai/lunary
    reference_type:
    reference_id:
  - url: https://github.com/lunary-ai/lunary/commit/c43b6c62035f32ca455f66d5fd22ba661648cde7
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/a749e696-b398-4260-b2d0-b0054b9fffa7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-4146
    reference_type:
    reference_id: CVE-2024-4146
