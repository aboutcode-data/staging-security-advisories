advisory_id: GHSA-wp34-mqw5-jj85
datasource_id: github_osv_importer_v2/GHSA-wp34-mqw5-jj85
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-wp34-mqw5-jj85/GHSA-wp34-mqw5-jj85.json
aliases:
  - CVE-2021-28032
summary: |
  Use after free in nano_arena
  Affected versions of this crate assumed that Borrow<Idx> was guaranteed to return the same value on .borrow(). The borrowed index value was used to retrieve a mutable reference to a value.

  If the Borrow<Idx> implementation returned a different index, the split arena would allow retrieving the index as a mutable reference creating two mutable references to the same element. This violates Rust's aliasing rules and allows for memory safety issues such as writing out of bounds and use-after-frees.

  The flaw was corrected in commit `6b83f9d` by storing the .borrow() value in a temporary variable.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-wp34-mqw5-jj85/GHSA-wp34-mqw5-jj85.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-416
references:
  - url: https://github.com/bennetthardwick/nano-arena
    reference_type:
    reference_id:
  - url: https://github.com/bennetthardwick/nano-arena/commit/6b83f9d0708337a9f8b709c1624a8587021ceba2
    reference_type:
    reference_id:
  - url: https://github.com/bennetthardwick/nano-arena/issues/1
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0031.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28032
    reference_type:
    reference_id: CVE-2021-28032
