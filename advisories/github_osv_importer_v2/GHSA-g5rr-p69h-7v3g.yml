advisory_id: GHSA-g5rr-p69h-7v3g
datasource_id: github_osv_importer_v2/GHSA-g5rr-p69h-7v3g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-g5rr-p69h-7v3g/GHSA-g5rr-p69h-7v3g.json
aliases: []
summary: |
  Insufficient type validation in pocketmine/pocketmine-mp
  ### Impact
  When an inventory interaction is performed (e.g. moving an item around an inventory), the client sends a serialized version of the itemstack to the server, which the server then deserializes and compares against its own copy. If the copies don't match, the transaction is invalid.

  This involves deserializing item NBT from the client, which allows for bogus data to be provided. Usually, this is harmless, but in this particular case, it could result in crashes on certain types of bad data (e.g. incorrect ListTag type provided for the `CanDestroy` tag).

  ### Patches
  This is fixed in 4.2.9 by commit 5a98b08ee8dc8ff14862cd83d2e4af9d212fefc2.

  ### Workarounds
  It's non-trivial to workaround this, but can be done by handling `InventoryTransactionPacket` and `PlayerAuthInputPacket` to scrub inbound transaction data of bogus NBT that would cause these crashes.

  ### For more information
  * Email us at [team@pmmp.io](mailto:team@pmmp.io)
impacted_packages:
  - purl: pkg:composer/pocketmine/pocketmine-mp
    affected_versions: vers:composer/<4.2.9
    fixed_versions: vers:composer/4.2.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-g5rr-p69h-7v3g/GHSA-g5rr-p69h-7v3g.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1287
  - CWE-20
references:
  - url: https://github.com/pmmp/PocketMine-MP
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/blob/4.2.9/changelogs/4.2.md#429
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/commit/5a98b08ee8dc8ff14862cd83d2e4af9d212fefc2
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/releases/tag/4.2.9
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-g5rr-p69h-7v3g
    reference_type:
    reference_id:
