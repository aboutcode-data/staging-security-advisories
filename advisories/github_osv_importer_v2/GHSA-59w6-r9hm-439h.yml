advisory_id: GHSA-59w6-r9hm-439h
datasource_id: github_osv_importer_v2/GHSA-59w6-r9hm-439h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-59w6-r9hm-439h/GHSA-59w6-r9hm-439h.json
aliases:
  - CVE-2025-49585
summary: |
  XWiki does not require right warnings for XClass definitions
  ### Impact
  When an attacker without script or programming right creates an XClass definition in XWiki (requires edit right), and that same document is later edited by a user with script, admin, or programming right, malicious code could be executed with the rights of the editing user without prior warning. In particular, this concerns custom display code, the script of computed properties and queries in database list properties. Note that warnings before editing documents with dangerous properties have only been introduced in XWiki 15.9, before that version, this was a known issue and the advice was simply to be careful.

  ### Patches
  This has been patched in XWiki 16.10.2, 16.4.7 and 15.10.16 by adding an analysis for the respective XClass properties.

  ### Workarounds
  We're not aware of any real workarounds apart from just being careful with editing documents previously edited by untrusted users as a user with script, admin or programming right.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default
    affected_versions: vers:maven/<15.10.16
    fixed_versions: vers:maven/15.10.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default
    affected_versions: vers:maven/>=16.0.0-rc-1|<16.4.7
    fixed_versions: vers:maven/16.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.10.2
    fixed_versions: vers:maven/16.10.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:H/VI:H/VA:H/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-59w6-r9hm-439h/GHSA-59w6-r9hm-439h.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-357
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/385bde985cdb61ebf315d30c0b144b6d2e2c2d45
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-59w6-r9hm-439h
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22476
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49585
    reference_type:
    reference_id: CVE-2025-49585
