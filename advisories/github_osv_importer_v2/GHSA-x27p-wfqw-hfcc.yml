advisory_id: GHSA-x27p-wfqw-hfcc
datasource_id: github_osv_importer_v2/GHSA-x27p-wfqw-hfcc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-x27p-wfqw-hfcc/GHSA-x27p-wfqw-hfcc.json
aliases:
  - CVE-2025-68437
summary: "Craft CMS vulnerable to Server-Side Request Forgery (SSRF) via GraphQL Asset Upload\
  \ Mutation\nThe Craft CMS GraphQL `save_<VolumeName>_Asset` mutation is vulnerable to Server-Side\
  \ Request Forgery (SSRF). This vulnerability arises because the `_file` input, specifically\
  \ its `url` parameter, allows the server to fetch content from arbitrary remote locations\
  \ without proper validation. Attackers can exploit this by providing internal IP addresses\
  \ or cloud metadata endpoints as the `url`, forcing the server to make requests to these restricted\
  \ services. The fetched content is then saved as an asset, which can subsequently be accessed\
  \ and exfiltrated, leading to potential data exposure and infrastructure compromise. This\
  \ exploitation requires specific GraphQL permissions for asset management within the targeted\
  \ volume.\n\nUsers should update to the patched 5.8.21 and 4.16.17 releases to mitigate the\
  \ issue.\n\nReferences:\n\nhttps://github.com/craftcms/cms/commit/013db636fdb38f3ce5657fd196b6d952f98ebc52\n\
  \nhttps://github.com/craftcms/cms/blob/5.x/CHANGELOG.md#5821---2025-12-04\n\n---\n\n### Required\
  \ Permissions\n\nThe exploitation requires a few permissions to be enabled in the used GraphQL\
  \ schema:\n- \"Edit assets in the `<VolumeName>` volume\"\n- \"Create assets in the `<VolumeName>`\
  \ volume\"\n\n### Steps to Reproduce\n\n1. Log in to the Craft CMS control panel as an admin.\n\
  \n2. Create a new volume if you havenâ€™t yet.\n\n3. Create a new schema (or use the full/public\
  \ schema) and enable the permissions mentioned above in the **Required Permissions** section.\n\
  \n4. Go to **GraphiQL**: `http://craft.local/admin/graphiql` & set the created schema.\n\n\
  5. Run the following GraphQL mutation to upload an Asset *(Replace the `<VolumeName>` with\
  \ your volume name)*:\n\n```graphql\nmutation {\n    save_<VolumeName>_Asset(_file: { \n \
  \       url: \"http://127.0.0.1:80/index.php\"\n        filename: \"poc.txt\"\n    }) {\n\
  \        id\n    }\n}\n```\n\n6. Note that the `index.php` response will be saved as `poc.txt`\
  \ & its content will be accessible via the asset preview/download functionality.\n\n8. For\
  \ the PoC, `http://127.0.0.1:80/index.php` was used as an example. However, the `url` parameter\
  \ can be leveraged to target internal services, cloud metadata endpoints, or any arbitrary\
  \ external URL.\n\n## Impact\n\nSuccessful exploitation of this SSRF vulnerability allows\
  \ attackers to access internal network resources, bypass firewall rules, and conduct network\
  \ reconnaissance.\n\nIn cloud environments (AWS, GCP, Azure), this can lead to the theft of\
  \ sensitive credentials (e.g., IAM roles, service account tokens) from metadata endpoints,\
  \ potentially resulting in the full compromise of the underlying infrastructure and the exfiltration\
  \ of sensitive data.\n\n---\n\nUsers should update to the patched versions (5.8.21 and 4.16.17)\
  \ to mitigate the issue.\n\nUsers running Craft 3.5.0+ should update to the latest Craft 4.16.17\
  \ or 5.8.21 releases."
impacted_packages:
  - purl: pkg:composer/craftcms/cms
    affected_versions: vers:composer/<=5.8.20
    fixed_versions: vers:composer/5.8.21
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/craftcms/cms
    affected_versions: vers:composer/<=4.16.16
    fixed_versions: vers:composer/4.16.17
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-x27p-wfqw-hfcc/GHSA-x27p-wfqw-hfcc.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/craftcms/cms
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/blob/5.x/CHANGELOG.md#5821---2025-12-04
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/commit/013db636fdb38f3ce5657fd196b6d952f98ebc52
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/security/advisories/GHSA-x27p-wfqw-hfcc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68437
    reference_type:
    reference_id:
