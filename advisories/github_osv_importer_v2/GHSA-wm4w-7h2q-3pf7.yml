advisory_id: GHSA-wm4w-7h2q-3pf7
datasource_id: github_osv_importer_v2/GHSA-wm4w-7h2q-3pf7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-wm4w-7h2q-3pf7/GHSA-wm4w-7h2q-3pf7.json
aliases:
  - CVE-2024-32000
summary: |
  Matrix IRC Bridge truncated content of messages can be leaked
  ### Impact

  The matrix-appservice-irc before version 2.0.0 can be exploited to leak the truncated body of a message if a malicious user sends a Matrix reply to an event ID they don't have access to. As a precondition to the attack, the malicious user needs to know the event ID of the message they want to leak, as well as to be joined to both the Matrix room and the IRC channel it is bridged to.

  The message reply containing the leaked message content is visible to IRC channel members when this happens.

  ### Patches

  matrix-appservice-irc 2.0.0 checks whether the user has permission to view an event before constructing a reply. Administrators should upgrade to this version.

  ### Workarounds

  It's possible to limit the amount of information leaked by setting a reply template that doesn't contain the original message. See [these lines](https://github.com/matrix-org/matrix-appservice-irc/blob/d5d67d1d3ea3f0f6962a0af2cc57b56af3ad2129/config.sample.yaml#L601-L604) in the configuration file.

  ### References
  https://github.com/matrix-org/matrix-appservice-irc/pull/1799

  ### For more information

  If you have any questions or comments about this advisory, please email us at [security at matrix.org](mailto:security@matrix.org).
impacted_packages:
  - purl: pkg:npm/matrix-appservice-irc
    affected_versions: vers:npm/<2.0.0
    fixed_versions: vers:npm/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/04/GHSA-wm4w-7h2q-3pf7/GHSA-wm4w-7h2q-3pf7.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-280
references:
  - url: https://github.com/matrix-org/matrix-appservice-irc
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/blob/d5d67d1d3ea3f0f6962a0af2cc57b56af3ad2129/config.sample.yaml#L601-L604
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/commit/4af7d3009f10b1f2fb810784c1e491d9d3bee82b
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/pull/1799
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-wm4w-7h2q-3pf7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32000
    reference_type:
    reference_id: CVE-2024-32000
