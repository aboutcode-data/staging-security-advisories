advisory_id: GHSA-5q86-62xr-3r57
datasource_id: github_osv_importer_v2/GHSA-5q86-62xr-3r57
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-5q86-62xr-3r57/GHSA-5q86-62xr-3r57.json
aliases:
  - CVE-2022-31054
summary: |
  Uses of deprecated API can be used to cause DoS in user-facing endpoints
  ### Impact
  Several `HandleRoute` endpoints make use of the deprecated `ioutil.ReadAll()`. `ioutil.ReadAll()` reads all the data into memory. As such, an attacker who sends a large request to the Argo Events server will be able to crash it and cause denial of service.

  Eventsources susceptible to an out-of-memory denial-of-service attack:

  - AWS SNS
  - Bitbucket
  - Bitbucket
  - Gitlab
  - Slack
  - Storagegrid
  - Webhook

  ### Patches
  A patch for this vulnerability has been released in the following Argo Events version:

  v1.7.1

  ### Credits
  Disclosed by [Ada Logics](https://adalogics.com/) in a security audit sponsored by CNCF and facilitated by OSTIF.

  ### For more information
  Open an issue in the [Argo Events issue tracker](https://github.com/argoproj/argo-events/issues) or [discussions](https://github.com/argoproj/argo-events/discussions)
  Join us on [Slack](https://argoproj.github.io/community/join-slack) in channel #argo-events
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-5q86-62xr-3r57/GHSA-5q86-62xr-3r57.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-787
  - CWE-400
references:
  - url: https://github.com/argoproj/argo-events
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-events/commit/eaabcb6d65022fc34a0cc9ea7f00681abd326b35
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-events/issues/1946
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-events/pull/1966
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-events/security/advisories/GHSA-5q86-62xr-3r57
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31054
    reference_type:
    reference_id: CVE-2022-31054
