advisory_id: GHSA-mq6f-5xh5-hgcf
datasource_id: github_osv_importer_v2/GHSA-mq6f-5xh5-hgcf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-mq6f-5xh5-hgcf/GHSA-mq6f-5xh5-hgcf.json
aliases:
  - CVE-2023-20902
summary: "Harbor timing attack risk\nIn the Harbor jobservice container, the comparison of secrets\
  \ in the authenticator type is prone to timing attacks. The vulnerability occurs due to the\
  \ following code: https://github.com/goharbor/harbor/blob/aaea068cceb4063ab89313d9785f2b40f35b0d63/src/jobservice/api/authenticator.go#L69-L69\n\
  To avoid this issue, constant time comparison should be used.\n```\nsubtle.ConstantTimeCompare([]byte(expectedSecret),\
  \ []byte(secret)) == 0\n```\n\n### Impact\nThis attack might be possible theoretically, but\
  \ no workable proof of concept is available, and access complexity is set at High.\nThe jobservice\
  \ exposes these APIs\n```\nCreate a job task --- POST /api/v1/jobs    \nGet job task information\
  \ --- GET /api/v1/jobs/{job_id}\nStop job task ---  POST /api/v1/jobs/{job_id}\nGet job log\
  \ task ---  GET /api/v1/jobs/{job_id}/log\nGet job execution --- GET /api/v1/jobs/{job_id}/executions\n\
  Get job stats ---  GET /api/v1/stats\nGet job service configuration ---  GET /api/v1/config\n\
  ```\nIt is used to create jobs/stop job tasks and retrieve job task information.  If an attacker\
  \ obtains the secrets, it is possible to retrieve the job information, create a job, or stop\
  \ a job task. \n\nThe following versions of Harbor are involved:\n<=Harbor 2.8.2, <=Harbor\
  \ 2.7.2, <= Harbor 2.6.x, <=Harbor 1.10.17\n\n\n### Patches\nHarbor 2.8.3, Harbor 2.7.3, Harbor\
  \ 1.10.18\n\n### Workarounds\nBecause the jobservice only exposes HTTP service to harbor-core\
  \ containers, blocking any inbound traffic from the external network to the jobservice container\
  \ can reduce the risk.\n\n### Credits\nThanks to Porcupiney Hairs for reporting this issue."
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-mq6f-5xh5-hgcf/GHSA-mq6f-5xh5-hgcf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-362
  - CWE-208
references:
  - url: https://github.com/goharbor/harbor
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/blob/aaea068cceb4063ab89313d9785f2b40f35b0d63/src/jobservice/api/authenticator.go#L69-L69
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/releases/tag/v1.10.18
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/releases/tag/v2.7.3
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/releases/tag/v2.8.3
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/security/advisories/GHSA-mq6f-5xh5-hgcf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-20902
    reference_type:
    reference_id: CVE-2023-20902
