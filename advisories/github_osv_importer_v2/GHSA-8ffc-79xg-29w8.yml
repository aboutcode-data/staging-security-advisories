advisory_id: GHSA-8ffc-79xg-29w8
datasource_id: github_osv_importer_v2/GHSA-8ffc-79xg-29w8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-8ffc-79xg-29w8/GHSA-8ffc-79xg-29w8.json
aliases:
  - CVE-2021-44521
summary: |
  Apache Cassandra vulnerable to Code Injection due to unsafe configuration
  When running Apache Cassandra with the following configuration: enable_user_defined_functions: true enable_scripted_user_defined_functions: true enable_user_defined_functions_threads: false it is possible for an attacker to execute arbitrary code on the host. The attacker would need to have enough permissions to create user defined functions in the cluster to be able to exploit this. Note that this configuration is documented as unsafe, and will continue to be considered unsafe after this CVE.
impacted_packages:
  - purl: pkg:maven/org.apache.cassandra/cassandra-all
    affected_versions: vers:maven/<3.0.26
    fixed_versions: vers:maven/3.0.26
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.cassandra/cassandra-all
    affected_versions: vers:maven/>=3.11.0|<3.11.12
    fixed_versions: vers:maven/3.11.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.cassandra/cassandra-all
    affected_versions: vers:maven/>=4.0.0|<4.0.2
    fixed_versions: vers:maven/4.0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-8ffc-79xg-29w8/GHSA-8ffc-79xg-29w8.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
  - CWE-732
references:
  - url: https://github.com/apache/cassandra
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/CASSANDRA-17352
    reference_type:
    reference_id:
  - url: https://jfrog.com/blog/cve-2021-44521-exploiting-apache-cassandra-user-defined-functions-for-remote-code-execution
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/y4nb9s4co34j8hdfmrshyl09lokm7356
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220225-0001
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2022/02/11/4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-44521
    reference_type:
    reference_id: CVE-2021-44521
