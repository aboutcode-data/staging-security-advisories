advisory_id: GHSA-g6pq-x539-7w4j
datasource_id: github_osv_importer_v2/GHSA-g6pq-x539-7w4j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-g6pq-x539-7w4j/GHSA-g6pq-x539-7w4j.json
aliases:
  - CVE-2023-45821
summary: |
  Artifact Hub has Incorrect Docker Hub registry check
  ### Impact

  During a security audit of Artifact Hub's code base, a security researcher at [OffSec](https://www.offsec.com/) identified a bug in which the `registryIsDockerHub` function was only checking that the registry domain had the `docker.io` suffix.

  Artifact Hub allows providing some Docker credentials that are used to increase the rate limit applied when interacting with the Docker Hub registry API to read publicly available content. Due to the incorrect check described above, it'd be possible to hijack those credentials by purchasing a domain which ends with `docker.io` and deploying a fake OCI registry on it.

  <https://artifacthub.io/> uses some credentials that only have permissions to read public content available in the Docker Hub. However, even though credentials for private repositories (disabled on `artifacthub.io`) are handled in a different way, other Artifact Hub deployments could have been using them for a different purpose.

  ### Patches

  This issue has been resolved in version [1.16.0](https://artifacthub.io/packages/helm/artifact-hub/artifact-hub?modal=changelog&version=1.16.0).
impacted_packages: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-g6pq-x539-7w4j/GHSA-g6pq-x539-7w4j.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-494
references:
  - url: https://artifacthub.io/packages/helm/artifact-hub/artifact-hub?modal=changelog&version=1.16.0
    reference_type:
    reference_id:
  - url: https://github.com/artifacthub/hub
    reference_type:
    reference_id:
  - url: https://github.com/artifacthub/hub/security/advisories/GHSA-g6pq-x539-7w4j
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-45821
    reference_type:
    reference_id: CVE-2023-45821
