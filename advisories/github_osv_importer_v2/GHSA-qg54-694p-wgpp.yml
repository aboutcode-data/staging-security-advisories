advisory_id: GHSA-qg54-694p-wgpp
datasource_id: github_osv_importer_v2/GHSA-qg54-694p-wgpp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-qg54-694p-wgpp/GHSA-qg54-694p-wgpp.json
aliases:
  - CVE-2021-41817
summary: |
  Regular expression denial of service vulnerability (ReDoS) in date
  Dateâ€™s parsing methods including Date.parse are using Regexps internally, some of which are vulnerable against regular expression denial of service. Applications and libraries that apply such methods to untrusted input may be affected.

  The fix limits the input length up to 128 bytes by default instead of changing the regexps. This is because Date gem uses many Regexps and it is possible that there are still undiscovered vulnerable Regexps. For compatibility, it is allowed to remove the limitation by explicitly passing limit keywords as nil like Date.parse(str, limit: nil), but note that it may take a long time to parse.

  Please update the date gem to version 3.2.1, 3.1.2, 3.0.2, and 2.0.1, or later. You can use gem update date to update it. If you are using bundler, please add gem "date", ">= 3.2.1" to your Gemfile. If you import `date` from the standard library rather than as a gem you should update your Ruby install to `3.0.3`, `2.7.5`, `2.6.9` or later.

  Users unable to upgrade may consider using `Date.strptime` instead with a predefined date format
  ```ruby
  Date.strptime('2001-02-20', '%Y-%m-%d')
  ```
impacted_packages:
  - purl: pkg:gem/date
    affected_versions: vers:gem/>=3.2.0|<3.2.1
    fixed_versions: vers:gem/3.2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/date
    affected_versions: vers:gem/>=3.1.0|<3.1.2
    fixed_versions: vers:gem/3.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/date
    affected_versions: vers:gem/>=3.0.0|<3.0.2
    fixed_versions: vers:gem/3.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/date
    affected_versions: vers:gem/<2.0.1
    fixed_versions: vers:gem/2.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-qg54-694p-wgpp/GHSA-qg54-694p-wgpp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
references:
  - url: https://github.com/ruby/date
    reference_type:
    reference_id:
  - url: https://github.com/ruby/date/commit/3959accef8da5c128f8a8e2fd54e932a4fb253b0
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/date/CVE-2021-41817.yml
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1254844
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/IUXQCH6FRKANCVZO2Q7D2SQX33FP3KWN
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UTOJGS5IEFDK3UOO7IY4OTTFGHGLSWZF
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/IUXQCH6FRKANCVZO2Q7D2SQX33FP3KWN
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UTOJGS5IEFDK3UOO7IY4OTTFGHGLSWZF
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202401-27
    reference_type:
    reference_id:
  - url: https://www.ruby-lang.org/en/news/2021/11/15/date-parsing-method-regexp-dos-cve-2021-41817
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41817
    reference_type:
    reference_id: CVE-2021-41817
