advisory_id: GHSA-vh6j-wv25-8qxr
datasource_id: github_osv_importer_v2/GHSA-vh6j-wv25-8qxr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-vh6j-wv25-8qxr/GHSA-vh6j-wv25-8qxr.json
aliases: []
summary: |
  Flow Bugfix Releases for Entity Security
  If you had used entity security and wanted to secure entities not just based on the user's role, but on some property of the user (like the company he belongs to), entity security did not work properly together with the doctrine query cache. This could lead to other users re-using SQL queries from the cache which were built for other users; and thus users could see entities which were not destined for them.
impacted_packages:
  - purl: pkg:composer/typo3/flow
    affected_versions: vers:composer/>=3.0.0|<3.0.12
    fixed_versions: vers:composer/3.0.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/flow
    affected_versions: vers:composer/>=3.1.0|<3.1.10
    fixed_versions: vers:composer/3.1.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/flow
    affected_versions: vers:composer/>=3.2.0|<3.2.13
    fixed_versions: vers:composer/3.2.13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/flow
    affected_versions: vers:composer/>=3.3.0|<3.3.13
    fixed_versions: vers:composer/3.3.13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/flow
    affected_versions: vers:composer/>=4.0.0|<4.0.6
    fixed_versions: vers:composer/4.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/flow/2017-04-12.yaml
    reference_type:
    reference_id:
  - url: https://github.com/neos/flow
    reference_type:
    reference_id:
  - url: https://www.neos.io/blog/flow-bugfix-releases-for-entity-security.html
    reference_type:
    reference_id:
