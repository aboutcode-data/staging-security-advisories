advisory_id: GHSA-g49q-jw42-6x85
datasource_id: github_osv_importer_v2/GHSA-g49q-jw42-6x85
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-g49q-jw42-6x85/GHSA-g49q-jw42-6x85.json
aliases: []
summary: |
  thelounge may publicly disclose of all usernames/idents via port 113
  Per RFC 1413, The unique identifying tuple includes not only the ports, but also the both addresses. Without the addresses, the information becomes both non-unique and public:
  - If multiple connections happen to use the same local port number (which is possible if the addresses differ), the username of the first is returned for all, resulting in the wrong ident for all but the first.
  - By not checking the connection address, the information becomes public. Because there is only a relatively small number of local ports, and the remote ports are likely to be either 6667 or 6697, it becomes trivial to scan the entire range to get a list of idents.

  To prevent this from happening, disable identd or upgrade to a non vulnerable version.
impacted_packages:
  - purl: pkg:npm/thelounge
    affected_versions: vers:npm/<=4.4.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/thelounge/thelounge
    reference_type:
    reference_id:
  - url: https://github.com/thelounge/thelounge/pull/4872
    reference_type:
    reference_id:
  - url: https://github.com/thelounge/thelounge/security/advisories/GHSA-g49q-jw42-6x85
    reference_type:
    reference_id:
