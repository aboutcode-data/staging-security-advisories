advisory_id: GHSA-w9hf-35q4-vcjw
datasource_id: github_osv_importer_v2/GHSA-w9hf-35q4-vcjw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-w9hf-35q4-vcjw/GHSA-w9hf-35q4-vcjw.json
aliases:
  - CVE-2025-46721
summary: "nosurf vulnerable to CSRF due to non-functional same-origin request checks\n### Impact\n\
  \nThis vulnerability allows an attacker who controls content on the target site, or on a subdomain\
  \ of the target site (either via XSS, or otherwise) to bypass Cross-Site Request Forgery checks\
  \ and issue requests on user's behalf.\n\n### Details\n\nDue to misuse of the Go `net/http`\
  \ library, nosurf categorizes all incoming requests as plain-text HTTP requests, in which\
  \ case the `Referer` header is not checked to have the same origin as the target webpage.\n\
  \nIf the attacker has control over HTML contents on either the target website (e.g. `example.com`),\
  \ or on a website hosted on a subdomain of the target (e.g. `attacker.example.com`), they\
  \ will also be able to manipulate cookies set for the target website. By acquiring the secret\
  \ CSRF token from the cookie, or overriding the cookie with a new token known to the attacker,\
  \ `attacker.example.com` is able to craft cross-site requests to `example.com`. \n\n### Patches\n\
  \nA patch for the issue was released in nosurf 1.2.0.\n\n### Workarounds\n\nIn lieu of upgrading\
  \ to a patched version of nosurf, users may additionally use another HTTP middleware to ensure\
  \ that a non-safe HTTP request is coming from the same origin (e.g. by requiring a `Sec-Fetch-Site:\
  \ same-origin` header in the request).\n\n### References\n\nhttps://github.com/advisories/GHSA-rq77-p4h8-4crw\n\
  https://github.com/justinas/nosurf-cve-2025-46721\nhttps://www.cve.org/CVERecord?id=CVE-2025-46721\n\
  https://github.com/justinas/nosurf/releases/tag/v1.2.0"
impacted_packages: []
severities:
  - score: '6.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-w9hf-35q4-vcjw/GHSA-w9hf-35q4-vcjw.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://github.com/advisories/GHSA-rq77-p4h8-4crw
    reference_type:
    reference_id:
  - url: https://github.com/justinas/nosurf
    reference_type:
    reference_id:
  - url: https://github.com/justinas/nosurf/commit/ec9bb776d8e5ba9e906b6eb70428f4e7b009feee
    reference_type:
    reference_id:
  - url: https://github.com/justinas/nosurf-cve-2025-46721
    reference_type:
    reference_id:
  - url: https://github.com/justinas/nosurf/releases/tag/v1.2.0
    reference_type:
    reference_id:
  - url: https://github.com/justinas/nosurf/security/advisories/GHSA-w9hf-35q4-vcjw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-46721
    reference_type:
    reference_id: CVE-2025-46721
