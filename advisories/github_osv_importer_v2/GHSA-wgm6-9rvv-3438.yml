advisory_id: GHSA-wgm6-9rvv-3438
datasource_id: github_osv_importer_v2/GHSA-wgm6-9rvv-3438
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-wgm6-9rvv-3438/GHSA-wgm6-9rvv-3438.json
aliases:
  - CVE-2026-26957
summary: "Libredesk has a SSRF Vulnerability in Webhooks\n**Date:** 2025-12-07\n**Vulnerability:**\
  \ Server-Side Request Forgery (SSRF)\n**Component:** Webhooks Module\n\n## Executive Summary\n\
  A critical security vulnerability exists in the LibreDesk Webhooks module that allows an authenticated\
  \ \"Application Admin\" to compromise the underlying cloud infrastructure or internal corporate\
  \ network where this service is being hosted.\n\nThe application fails to validate destination\
  \ URLs for webhooks. This allows an attacker to force the server to make HTTP requests to\
  \ arbitrary internal destinations.\n\n## Confirmed Attack Vectors\n\n### 1. Internal Port\
  \ Scanning (Network Mapping)\nAttackers can map the internal network by observing the difference\
  \ between successful connections and connection errors. This works even if the response body\
  \ is not returned.\n\n**Proof of Exploitation (from Server Logs):**\n*   **Open Port (8890)**:\
  \ The server connects successfully.\n    ```text\n    timestamp=... level=info message=\"\
  webhook delivered successfully\" ... status_code=200\n    ```\n*   **Closed Port (8891)**:\
  \ The server fails to connect.\n    ```text\n    timestamp=... level=error message=\"webhook\
  \ delivery failed\" ... error=\"... connect: connection refused\"\n    ```\n\n**Impact**:\
  \ An attacker can identify running services (databases, caches, internal apps) on the local\
  \ network (e.g., `localhost`, `192.168.x.x`).\n\n### 2. Information Leakage (Error-Based)\n\
  If the internal service returns a non-2xx response (e.g., 403 Forbidden, 404 Not Found, 500\
  \ Error), the application **logs the full response body**.\n\n**Proof of Exploitation (from\
  \ Server Logs):**\n```text\ntimestamp=... level=error message=\"webhook delivery failed\"\
  \ ... \nresponse=\"{\\\"secret_key\\\": \\\"xxx123\\\", \\\"role\\\": \\\"admin\\\"}\"\n```\n\
  \n**Impact**: An attacker can extract sensitive data by targeting endpoints that return errors\
  \ or by forcing errors on internal services.\n\n## Technical Root Cause\n1.  **Missing Input\
  \ Validation**: `cmd/webhooks.go` only checks if the URL is empty, not if it resolves to a\
  \ private IP.\n2.  **Unrestricted HTTP Client**: `internal/webhook/webhook.go` uses a default\
  \ `http.Client` that follows redirects and connects to any IP.\n3.  **Verbose Error Logging**:\
  \ The application logs the full response body on failure, creating a side-channel for data\
  \ exfiltration.\n\n## Remediation Required\nTo prevent this, the application must implement\
  \ **Defense in Depth**:\n\n1.  **Input Validation**: Block URLs resolving to private IP ranges\
  \ (RFC 1918) and Link-Local addresses.\n2.  **Safe HTTP Client**: Use a custom `http.Transport`\
  \ that verifies the destination IP address *after* DNS resolution to prevent DNS rebinding\
  \ attacks."
impacted_packages: []
severities:
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-wgm6-9rvv-3438/GHSA-wgm6-9rvv-3438.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-209
  - CWE-918
references:
  - url: https://github.com/abhinavxd/libredesk
    reference_type:
    reference_id:
  - url: https://github.com/abhinavxd/libredesk/commit/727213631ce6a36bcb06f50ce542155e78f51316
    reference_type:
    reference_id:
  - url: https://github.com/abhinavxd/libredesk/security/advisories/GHSA-wgm6-9rvv-3438
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-26957
    reference_type:
    reference_id:
