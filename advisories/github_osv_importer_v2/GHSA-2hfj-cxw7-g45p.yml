advisory_id: GHSA-2hfj-cxw7-g45p
datasource_id: github_osv_importer_v2/GHSA-2hfj-cxw7-g45p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-2hfj-cxw7-g45p/GHSA-2hfj-cxw7-g45p.json
aliases:
  - CVE-2021-39183
summary: |
  Unsafe inline XSS in pasting DOM element into chat
  ### Impact

  Inline scripts are executed when Javascript is parsed via a paste action.

  1. Open https://watch.owncast.online/
  2. Copy and then paste `<img src=null onerror=alert('hello')>` into the
  chat field.
  3. An alert should pop up.

  ### Patches
  ```
      ⋮ 13 │    // Content security policy
      ⋮ 14 │    csp := []string{
      ⋮ 15 │        "script-src 'self' 'sha256-2HPCfJIJHnY0NrRDPTOdC7AOSJIcQyNxzUuut3TsYRY='",
      ⋮ 16 │        "worker-src 'self' blob:", // No single quotes around blob:
      ⋮ 17 │    }
  ```

  Will be patched in 0.0.9 by blocking `unsafe-inline` Content Security Policy and specifying the `script-src`.  The `worker-src` is required to be set to `blob` for the video player.

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [owncast/owncast](https://github.com/owncast/owncast/issues)
  * Email us at [gabek@real-ity.com](mailto:gabek@real-ity.com)
impacted_packages: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-2hfj-cxw7-g45p/GHSA-2hfj-cxw7-g45p.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/owncast/owncast
    reference_type:
    reference_id:
  - url: https://github.com/owncast/owncast/security/advisories/GHSA-2hfj-cxw7-g45p
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39183
    reference_type:
    reference_id: CVE-2021-39183
