advisory_id: GHSA-q6hg-6m9x-5g9c
datasource_id: github_osv_importer_v2/GHSA-q6hg-6m9x-5g9c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-q6hg-6m9x-5g9c/GHSA-q6hg-6m9x-5g9c.json
aliases:
  - CVE-2024-39696
summary: |
  Evmos vulnerable to exploit of smart contract account and vesting
  ### Summary

  This advisory board aims to describe two vulnerabilities found in the Evmos codebase:

  - _Authorization check on the fundVestingAccount_: unauthorized spend of funds.

  ### Details

  #### Authorization check on the fundVestingAccount

  With the current implementation, a user can create a vesting account with a 3rd party account (EOA or contract) as funder. Then, this user can create an authorization for the contract.CallerAddress, this is the authorization checked in the code. But the funds are taken from the funder address provided in the message. Consequently, the user can fund a vesting account with a 3rd party account without its permission. The funder address can be any address, so this vulnerability can be used to drain all the accounts in the chain.

  ### Severity
  Based on [ImmuneFi Severity Classification System](https://immunefisupport.zendesk.com/hc/en-us/articles/13332717597585-Severity-Classification-System) the severity was evaluated to Critical since the attack could have lead to direct loss of funds.

  ### Patches
  The issue has been patched in versions >=V19.0.0
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-q6hg-6m9x-5g9c/GHSA-q6hg-6m9x-5g9c.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-q6hg-6m9x-5g9c/GHSA-q6hg-6m9x-5g9c.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/evmos/evmos
    reference_type:
    reference_id:
  - url: https://github.com/evmos/evmos/commit/0a620e176617a835ac697eea494afea09185dfaf
    reference_type:
    reference_id:
  - url: https://github.com/evmos/evmos/security/advisories/GHSA-q6hg-6m9x-5g9c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-39696
    reference_type:
    reference_id: CVE-2024-39696
