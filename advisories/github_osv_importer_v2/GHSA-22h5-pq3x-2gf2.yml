advisory_id: GHSA-22h5-pq3x-2gf2
datasource_id: github_osv_importer_v2/GHSA-22h5-pq3x-2gf2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-22h5-pq3x-2gf2/GHSA-22h5-pq3x-2gf2.json
aliases:
  - CVE-2025-27221
summary: |
  URI allows for userinfo Leakage in URI#join, URI#merge, and URI#+
  There is a possibility for userinfo leakage by in the uri gem.
  This vulnerability has been assigned the CVE identifier CVE-2025-27221. We recommend upgrading the uri gem.

  ## Details

  The methods `URI#join`, `URI#merge`, and `URI#+` retained userinfo, such as `user:password`, even after the host is replaced. When generating a URL to a malicious host from a URL containing secret userinfo using these methods, and having someone access that URL, an unintended userinfo leak could occur.

  Please update URI gem to version 0.11.3, 0.12.4, 0.13.2, 1.0.3 or later.

  ## Affected versions

  uri gem versions < 0.11.3, 0.12.0 to 0.12.3, 0.13.0, 0.13.1 and 1.0.0 to 1.0.2.

  ## Credits

  Thanks to Tsubasa Irisawa (lambdasawa) for discovering this issue.
  Also thanks to nobu for additional fixes of this vulnerability.
impacted_packages:
  - purl: pkg:gem/uri
    affected_versions: vers:gem/<0.11.3
    fixed_versions: vers:gem/0.11.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/uri
    affected_versions: vers:gem/>=0.12.0|<0.12.4
    fixed_versions: vers:gem/0.12.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/uri
    affected_versions: vers:gem/>=0.13.0|<0.13.2
    fixed_versions: vers:gem/0.13.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/uri
    affected_versions: vers:gem/>=1.0.0|<1.0.3
    fixed_versions: vers:gem/1.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-22h5-pq3x-2gf2/GHSA-22h5-pq3x-2gf2.json
  - score: '2.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-22h5-pq3x-2gf2/GHSA-22h5-pq3x-2gf2.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-212
  - CWE-200
references:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/uri/CVE-2025-27221.yml
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/pull/154
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/pull/155
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/pull/156
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/pull/157
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/2957667
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00008.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00015.html
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-27221
    reference_type:
    reference_id:
  - url: https://www.ruby-lang.org/en/news/2025/02/26/security-advisories
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-27221
    reference_type:
    reference_id: CVE-2025-27221
