advisory_id: GHSA-275g-g844-73jh
datasource_id: github_osv_importer_v2/GHSA-275g-g844-73jh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-275g-g844-73jh/GHSA-275g-g844-73jh.json
aliases:
  - CVE-2025-53549
summary: |
  Matrix Rust SDK vulnerable to SQL Injection through its EventCache implementation
  An SQL injection vulnerability in the `EventCache::find_event_with_relations` method of matrix-sdk 0.11 and 0.12 allows malicious room members to execute arbitrary SQL commands in Matrix clients that directly pass relation types provided by those room members into this method, when used with the default sqlite-based store backend. Exploitation is unlikely, as no known clients currently use the API in this manner.

  ### Workarounds

  Passing only trusted (or sanitised) relation types to the `filter` argument of `EventCache::find_event_with_relations()` avoids the issue.

  ### Patches

  The issue is fixed in matrix-sdk 0.13.

  ### References

  The issue was introduced in https://github.com/matrix-org/matrix-rust-sdk/pull/4849.
impacted_packages: []
severities:
  - score: '5.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-275g-g844-73jh/GHSA-275g-g844-73jh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/matrix-org/matrix-rust-sdk
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk/commit/d0c01006e4808db5eb96ad5c496416f284d8bd3c
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk/pull/4849
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-275g-g844-73jh
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2025-0043.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-53549
    reference_type:
    reference_id: CVE-2025-53549
