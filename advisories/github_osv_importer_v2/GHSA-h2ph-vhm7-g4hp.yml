advisory_id: GHSA-h2ph-vhm7-g4hp
datasource_id: github_osv_importer_v2/GHSA-h2ph-vhm7-g4hp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-h2ph-vhm7-g4hp/GHSA-h2ph-vhm7-g4hp.json
aliases:
  - CVE-2022-23469
summary: |
  Traefik may display authorization header in the debug logs
  ### Impact

  There is a potential vulnerability in Traefik displaying the Authorization header in its debug logs.

  Traefik uses [oxy](https://github.com/vulcand/oxy) to provide the following features:

  - Round Robin: https://doc.traefik.io/traefik/routing/services/#weighted-round-robin-service
  - Buffering: https://doc.traefik.io/traefik/middlewares/http/buffering/
  - Circuit Breaker: https://doc.traefik.io/traefik/middlewares/http/circuitbreaker/
  - In-Flight Requests: https://doc.traefik.io/traefik/middlewares/http/inflightreq/

  In such cases, if the log level is set to DEBUG, the credentials provided using the Authorization header are displayed in the debug logs:

  ```
  level=debug msg="vulcand/oxy/roundrobin/rr: completed ServeHttp on request" Request="{\\"Method\\":\\"POST\\",\\"URL\\":{\\"Scheme\\":\\"\\",\\"Opaque\\":\\"\\",\\"User\\":null,\\"Host\\":\\"\\",\\"Path\\":\\"/<redacted>/<redacted>\\",\\"RawPath\\":\\"\\",\\"ForceQuery\\":false,\\"RawQuery\\":\\"\\",\\"Fragment\\":\\"\\",\\"RawFragment\\":\\"\\"},\\"Proto\\":\\"HTTP/2.0\\",\\"ProtoMajor\\":2,\\"ProtoMinor\\":0,\\"Header\\":{\\"Authorization\\":[\\"Bearer <token value was here>\\"],\\"Content-Type\\":[\\"application/grpc\\"],\\"Grpc-Accept-Encoding\\":[\\"gzip\\"],\\"Grpc-Timeout\\":[\\"29999886u\\"],\\"Te\\":[\\"trailers\\"],\\"User-Agent\\":[\\"<redacted>\\"],<remainder of log message removed>
  ```

  ### Patches

  https://github.com/traefik/traefik/pull/9574
  https://github.com/traefik/traefik/releases/tag/v2.9.6

  ### Workarounds

  Set the log level to `INFO`, `WARN`, or `ERROR`.

  ### For more information

  If you have any questions or comments about this advisory, please [open an issue](https://github.com/traefik/traefik/issues).
impacted_packages: []
severities:
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-h2ph-vhm7-g4hp/GHSA-h2ph-vhm7-g4hp.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-532
references:
  - url: https://github.com/traefik/traefik
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/pull/9574
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/releases/tag/v2.9.6
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/security/advisories/GHSA-h2ph-vhm7-g4hp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23469
    reference_type:
    reference_id: CVE-2022-23469
