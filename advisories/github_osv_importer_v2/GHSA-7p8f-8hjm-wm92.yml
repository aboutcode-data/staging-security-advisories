advisory_id: GHSA-7p8f-8hjm-wm92
datasource_id: github_osv_importer_v2/GHSA-7p8f-8hjm-wm92
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-7p8f-8hjm-wm92/GHSA-7p8f-8hjm-wm92.json
aliases:
  - CVE-2022-21646
summary: "Lookup operations do not take into account wildcards in SpiceDB\n### Impact\nAny user\
  \ making use of a wildcard relationship under the right hand branch of an `exclusion` or within\
  \ an `intersection` operation will see `Lookup`/`LookupResources` return a resource as \"\
  accessible\" if it is *not* accessible by virtue of the inclusion of the wildcard in the intersection\
  \ or the right side of the exclusion.\n\nFor example, given schema:\n\n```zed\ndefinition\
  \ user {}\n\ndefinition resource {\n   relation viewer: user\n   relation banned: user | user:*\n\
  \   permission view = viewer - banned\n}\n```\n\nIf `user:*` is placed into the `banned` relation\
  \ for a particular resource, `view` should return false for *all* resources. in `v1.3.0`,\
  \ the wildcard is ignored entirely in lookup's dispatch, resulting in the `banned` wildcard\
  \ being ignored in the exclusion.\n\n### Workarounds\nDon't make use of wildcards on the right\
  \ side of intersections or within exclusions. \n\n### References\nhttps://github.com/authzed/spicedb/issues/358\n\
  \n### For more information\nIf you have any questions or comments about this advisory:\n*\
  \ Open an issue in [SpiceDB](https://github.com/authzed/spicedb)\n* Ask a question in the\
  \ [SpiceDB Discord](https://authzed.com/discord)"
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-7p8f-8hjm-wm92/GHSA-7p8f-8hjm-wm92.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-155
  - CWE-20
references:
  - url: https://github.com/authzed/spicedb
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/commit/15bba2e2d2a4bda336a37a7fe8ef8a35028cd970
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/issues/358
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/releases/tag/v1.4.0
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/security/advisories/GHSA-7p8f-8hjm-wm92
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21646
    reference_type:
    reference_id: CVE-2022-21646
