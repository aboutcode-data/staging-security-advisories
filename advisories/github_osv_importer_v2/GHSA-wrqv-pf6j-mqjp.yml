advisory_id: GHSA-wrqv-pf6j-mqjp
datasource_id: github_osv_importer_v2/GHSA-wrqv-pf6j-mqjp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-wrqv-pf6j-mqjp/GHSA-wrqv-pf6j-mqjp.json
aliases:
  - CVE-2024-27935
summary: "Deno's Node.js Compatibility Runtime has Cross-Session Data Contamination\n### Summary\n\
  \nA vulnerability in Deno's Node.js compatibility runtime allows for cross-session data contamination\
  \ during simultaneous asynchronous reads from Node.js streams sourced from sockets or files.\
  \ The issue arises from the re-use of a global buffer (BUF) in stream_wrap.ts used as a performance\
  \ optimization to limit allocations during these asynchronous read operations. This can lead\
  \ to data intended for one session being received by another session, potentially resulting\
  \ in data corruption and unexpected behavior.\n\n### Details\n\nA bug in Deno's Node.js compatibility\
  \ runtime results in data cross-reception during simultaneous asynchronous reads from Node.js\
  \ network streams. When multiple independent network socket connections are involved, this\
  \ vulnerability can be triggered. For instance, two separate server sockets that receive data\
  \ from their respective client sockets and then echo the received data back to the client\
  \ using Node.js streams may experience an issue where data from one socket may appear on another\
  \ socket. Due to the improper isolation of the global buffer (`BUF`), data sent by one socket\
  \ can end up being incorrectly received by another socket. Consequently, data intended for\
  \ one session may be exposed to another session, potentially leading to data corruption and\
  \ unexpected behavior.\n\nThis buffer was introduced as a performance optimization to avoid\
  \ excessive allocations during network read operations.\n\nIn cases where the [net.Stream](https://nodejs.org/api/net.html)\
  \ is connected to a remote server such as a database or key/value store such as Redis, this\
  \ may result in a packet received on one connection being presented to another, causing data\
  \ cross-contamination between multiple users and potentially leaking sensitive information.\n\
  \nIt is important to note that this vulnerability does not affect Deno network streams created\
  \ with the `Deno.listen` and `Deno.connect` APIs. \n\nThe impact of this issue may extend\
  \ beyond node.js network streams, however, and may also affect asynchronous reads from non-network\
  \ node.js Stream such as those created from files.\n\n### PoC\n\nhttps://github.com/denoland/deno/issues/20188\n\
  \n### Impact\n\nThis affects all users of Deno that use the node.js compatibility layer for\
  \ network communication or other streams, including packages that may require node.js libraries\
  \ indirectly."
impacted_packages: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-wrqv-pf6j-mqjp/GHSA-wrqv-pf6j-mqjp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-488
references:
  - url: https://github.com/denoland/deno
    reference_type:
    reference_id:
  - url: https://github.com/denoland/deno/commit/3e9fb8aafd9834ebacd27734cea4310caaf794c6
    reference_type:
    reference_id:
  - url: https://github.com/denoland/deno/issues/20188
    reference_type:
    reference_id:
  - url: https://github.com/denoland/deno/security/advisories/GHSA-wrqv-pf6j-mqjp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-27935
    reference_type:
    reference_id: CVE-2024-27935
