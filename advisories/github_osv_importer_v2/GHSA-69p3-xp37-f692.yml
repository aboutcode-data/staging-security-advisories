advisory_id: GHSA-69p3-xp37-f692
datasource_id: github_osv_importer_v2/GHSA-69p3-xp37-f692
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-69p3-xp37-f692/GHSA-69p3-xp37-f692.json
aliases:
  - CVE-2022-0759
summary: |
  Improper Certificate Validation in kubeclient
  A flaw was found in all versions of kubeclient up to (but not including) v4.9.3, the Ruby client for Kubernetes REST API, in the way it parsed kubeconfig files. When the kubeconfig file does not configure custom CA to verify certs, kubeclient ends up accepting any certificate (it wrongly returns VERIFY_NONE). Ruby applications that leverage kubeclient to parse kubeconfig files are susceptible to Man-in-the-middle attacks (MITM).
impacted_packages:
  - purl: pkg:gem/kubeclient
    affected_versions: vers:gem/<4.9.3
    fixed_versions: vers:gem/4.9.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-69p3-xp37-f692/GHSA-69p3-xp37-f692.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-295
references:
  - url: https://github.com/ManageIQ/kubeclient
    reference_type:
    reference_id:
  - url: https://github.com/ManageIQ/kubeclient/commit/109ea71de5a8881748f03ebbe103b49f0f1c7887
    reference_type:
    reference_id:
  - url: https://github.com/ManageIQ/kubeclient/issues/554
    reference_type:
    reference_id:
  - url: https://github.com/ManageIQ/kubeclient/issues/555
    reference_type:
    reference_id:
  - url: https://github.com/ManageIQ/kubeclient/pull/556
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/kubeclient/CVE-2022-0759.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-0759
    reference_type:
    reference_id: CVE-2022-0759
