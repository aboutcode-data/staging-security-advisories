advisory_id: GHSA-9623-mqmm-5rcf
datasource_id: github_osv_importer_v2/GHSA-9623-mqmm-5rcf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-9623-mqmm-5rcf/GHSA-9623-mqmm-5rcf.json
aliases:
  - CVE-2024-7885
summary: |
  Undertow vulnerable to Race Condition
  A vulnerability was found in Undertow where the ProxyProtocolReadListener reuses the same StringBuilder instance across multiple requests. This issue occurs when the parseProxyProtocolV1 method processes multiple requests on the same HTTP connection. As a result, different requests may share the same StringBuilder instance, potentially leading to information leakage between requests or responses. In some cases, a value from a previous request or response may be erroneously reused, which could lead to unintended data exposure. This issue primarily results in errors and connection termination but creates a risk of data leakage in multi-request environments.
impacted_packages:
  - purl: pkg:maven/io.undertow/undertow-core
    affected_versions: vers:maven/<2.2.36.Final
    fixed_versions: vers:maven/2.2.36.Final
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/io.undertow/undertow-core
    affected_versions: vers:maven/>=2.3.0.Alpha1|<2.3.17.Final
    fixed_versions: vers:maven/2.3.17.Final
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-9623-mqmm-5rcf/GHSA-9623-mqmm-5rcf.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-9623-mqmm-5rcf/GHSA-9623-mqmm-5rcf.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-362
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-7885
    reference_type:
    reference_id:
  - url: https://github.com/undertow-io/undertow
    reference_type:
    reference_id:
  - url: https://github.com/undertow-io/undertow/blob/182e4ca1543c52f438b0244c930dca3d8b6e68e3/core/src/main/java/io/undertow/server/protocol/proxy/ProxyProtocolReadListener.java
    reference_type:
    reference_id:
  - url: https://github.com/undertow-io/undertow/commit/80c125e09068ac52ed0a9acde266ef12f8ed7ae1
    reference_type:
    reference_id:
  - url: https://github.com/undertow-io/undertow/commit/ce5182c37376982ef0abee34fce0d8c0aab0fab8
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20241011-0004
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2305290
    reference_type: bug
    reference_id: 2305290
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-7885
    reference_type:
    reference_id: CVE-2024-7885
  - url: https://access.redhat.com/errata/RHSA-2024:11023
    reference_type:
    reference_id: RHSA-2024:11023
  - url: https://access.redhat.com/errata/RHSA-2024:6508
    reference_type:
    reference_id: RHSA-2024:6508
  - url: https://access.redhat.com/errata/RHSA-2024:6883
    reference_type:
    reference_id: RHSA-2024:6883
  - url: https://access.redhat.com/errata/RHSA-2024:7441
    reference_type:
    reference_id: RHSA-2024:7441
  - url: https://access.redhat.com/errata/RHSA-2024:7442
    reference_type:
    reference_id: RHSA-2024:7442
  - url: https://access.redhat.com/errata/RHSA-2024:7735
    reference_type:
    reference_id: RHSA-2024:7735
  - url: https://access.redhat.com/errata/RHSA-2024:7736
    reference_type:
    reference_id: RHSA-2024:7736
  - url: https://access.redhat.com/errata/RHSA-2024:8080
    reference_type:
    reference_id: RHSA-2024:8080
  - url: https://access.redhat.com/errata/RHSA-2025:16667
    reference_type:
    reference_id: RHSA-2025:16667
  - url: https://access.redhat.com/errata/RHSA-2026:0743
    reference_type:
    reference_id: RHSA-2026:0743
