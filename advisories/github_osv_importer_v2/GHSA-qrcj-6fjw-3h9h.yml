advisory_id: GHSA-qrcj-6fjw-3h9h
datasource_id: github_osv_importer_v2/GHSA-qrcj-6fjw-3h9h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-qrcj-6fjw-3h9h/GHSA-qrcj-6fjw-3h9h.json
aliases:
  - CVE-2019-3847
summary: |
  Moodle XSS Vulnerability
  A vulnerability was found in moodle before versions 3.6.3, 3.5.5, 3.4.8 and 3.1.17. Users with the "login as other users" capability (such as administrators/managers) can access other users' Dashboards, but the JavaScript those other users may have added to their Dashboard was not being escaped when being viewed by the user logging in on their behalf.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.6.0|<3.6.3
    fixed_versions: vers:composer/3.6.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.5.0|<3.5.5
    fixed_versions: vers:composer/3.5.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.2.0|<3.4.8
    fixed_versions: vers:composer/3.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<3.1.17
    fixed_versions: vers:composer/3.1.17
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-qrcj-6fjw-3h9h/GHSA-qrcj-6fjw-3h9h.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3847
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/070f24d006eab6b958eb083530de159b43c538ed
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/93dda3bfd3caaaa8d23fe8ede543f27ef774958d
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/a37e26d2efe1ca0e4d8d69c611a748af35b33674
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/e836242e1c04cd62d0afa4a790074fd245628e7a
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/ec3b63c772d6448765c68268234cf36c1a91bcac
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=384010#p1547742
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20200227082922/http://www.securityfocus.com/bid/107489
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-3847
    reference_type:
    reference_id: CVE-2019-3847
