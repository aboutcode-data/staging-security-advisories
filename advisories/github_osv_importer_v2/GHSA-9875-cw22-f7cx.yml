advisory_id: GHSA-9875-cw22-f7cx
datasource_id: github_osv_importer_v2/GHSA-9875-cw22-f7cx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-9875-cw22-f7cx/GHSA-9875-cw22-f7cx.json
aliases:
  - CVE-2025-49581
summary: |
  XWiki allows remote code execution through default value of wiki macro wiki-type parameters
  ### Impact
  Any user with edit right on a page (could be the user's profile) can execute code (Groovy, Python, Velocity) with programming right by defining a wiki macro. This allows full access to the whole XWiki installation and thus impacts its confidentiality, integrity and availability. The main problem is that if a wiki macro parameter allows wiki syntax, its default value is executed with the rights of the author of the document where it is used. This can be exploited by overriding a macro like the `children` macro that is used in a page that has programming right like the page `XWiki.ChildrenMacro` and thus allows arbitrary script macros. The full reproduction steps can be found in the [original issue](https://jira.xwiki.org/browse/XWIKI-22760).

  ### Patches
  This vulnerability has been patched in XWiki 16.4.7, 16.10.3 and 17.0.0 by executing wiki parameters with the rights of the wiki macro's author when the parameter's value is the default value.

  ### Workarounds
  We're not aware of any workarounds except for upgrading.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store
    affected_versions: vers:maven/<12.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store
    affected_versions: vers:maven/<12.7
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store
    affected_versions: vers:maven/>=12.8-rc-1|<16.4.7
    fixed_versions: vers:maven/16.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.10.3
    fixed_versions: vers:maven/16.10.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store
    affected_versions: vers:maven/>=17.0.0-rc-1|<17.0.0
    fixed_versions: vers:maven/17.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-9875-cw22-f7cx/GHSA-9875-cw22-f7cx.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/c99d501ed41cbee6a3c02ff927714531570789de
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9875-cw22-f7cx
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22760
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49581
    reference_type:
    reference_id: CVE-2025-49581
