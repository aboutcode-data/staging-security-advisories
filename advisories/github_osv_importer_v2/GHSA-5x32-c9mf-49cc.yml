advisory_id: GHSA-5x32-c9mf-49cc
datasource_id: github_osv_importer_v2/GHSA-5x32-c9mf-49cc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/06/GHSA-5x32-c9mf-49cc/GHSA-5x32-c9mf-49cc.json
aliases:
  - CVE-2019-8320
summary: |
  RubyGems Delete directory using symlink when decompressing tar
  A Directory Traversal issue was discovered in RubyGems 2.7.6 and later through 3.0.2. Before making new directories or touching files (which now include path-checking code for symlinks), it would delete the target destination. If that destination was hidden behind a symlink, a malicious gem could delete arbitrary files on the user's machine, presuming the attacker could guess at paths. Given how frequently gem is run as sudo, and how predictable paths are on modern systems (/tmp, /usr, etc.), this could likely lead to data loss or an unusable system.
impacted_packages:
  - purl: pkg:gem/rubygems-update
    affected_versions: vers:gem/>=2.7.6|<2.7.9
    fixed_versions: vers:gem/2.7.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rubygems-update
    affected_versions: vers:gem/>=3.0.0|<3.0.3
    fixed_versions: vers:gem/3.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/06/GHSA-5x32-c9mf-49cc/GHSA-5x32-c9mf-49cc.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2019-07/msg00036.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2019:1429
    reference_type:
    reference_id:
  - url: https://blog.rubygems.org/2019/03/05/security-advisories-2019-03.html
    reference_type:
    reference_id:
  - url: https://github.com/rubygems/rubygems
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rubygems-update/CVE-2019-8320.yml
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/317321
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2020/08/msg00027.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-8320
    reference_type:
    reference_id: CVE-2019-8320
