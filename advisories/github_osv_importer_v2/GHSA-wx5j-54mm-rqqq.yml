advisory_id: GHSA-wx5j-54mm-rqqq
datasource_id: github_osv_importer_v2/GHSA-wx5j-54mm-rqqq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-wx5j-54mm-rqqq/GHSA-wx5j-54mm-rqqq.json
aliases:
  - CVE-2021-43797
summary: |
  HTTP request smuggling in netty
  ### Impact

  Netty currently just skips control chars when these are present at the beginning / end of the header name. We should better fail fast as these are not allowed by the spec and could lead to HTTP request smuggling.

  Failing to do the validation might cause netty to "sanitize" header names before it forward these to another remote system when used as proxy. This remote system can't see the invalid usage anymore and so not do the validation itself.
impacted_packages:
  - purl: pkg:maven/io.netty/netty-codec-http
    affected_versions: vers:maven/>=4.0.0|<4.1.71.Final
    fixed_versions: vers:maven/4.1.71.Final
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jboss.netty/netty
    affected_versions: vers:maven/<4.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/io.netty/netty
    affected_versions: vers:maven/<4.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-wx5j-54mm-rqqq/GHSA-wx5j-54mm-rqqq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-444
references:
  - url: https://github.com/netty/netty
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty/commit/07aa6b5938a8b6ed7a6586e066400e2643897323
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty/pull/11891
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty/security/advisories/GHSA-wx5j-54mm-rqqq
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/01/msg00008.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220107-0003
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2023/dsa-5316
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuapr2022.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpujul2022.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43797
    reference_type:
    reference_id: CVE-2021-43797
