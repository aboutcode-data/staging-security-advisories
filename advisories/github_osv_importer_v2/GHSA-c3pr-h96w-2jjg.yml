advisory_id: GHSA-c3pr-h96w-2jjg
datasource_id: github_osv_importer_v2/GHSA-c3pr-h96w-2jjg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-c3pr-h96w-2jjg/GHSA-c3pr-h96w-2jjg.json
aliases:
  - CVE-2018-14630
summary: |
  Moodle XML import of ddwtos could lead to intentional remote code execution
  moodle before versions 3.5.2, 3.4.5, 3.3.8, 3.1.14 is vulnerable to an XML import of ddwtos could lead to intentional remote code execution. When importing legacy 'drag and drop into text' (ddwtos) type quiz questions, it was possible to inject and execute PHP code from within the imported questions, either intentionally or by importing questions from an untrusted source.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.5.0|<3.5.2
    fixed_versions: vers:composer/3.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.4.0|<3.4.5
    fixed_versions: vers:composer/3.4.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.2.0|<3.3.8
    fixed_versions: vers:composer/3.3.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<3.1.14
    fixed_versions: vers:composer/3.1.14
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-c3pr-h96w-2jjg/GHSA-c3pr-h96w-2jjg.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-62880
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-14630
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/09cbca8566a388e8f0a1a0cfd86cd0667088ed2c
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/be092b730910ad97fff0511e177a097ec1cc4b1c
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/cb8aefa658cf7ad8f002a480343afb2dea94cc08
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/cfc4393aa689c277a27b9a040ff7dcbdac4e41dd
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/da1eeea0ff3d292b7669e478abc114872dd9cc8f
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=376023
    reference_type:
    reference_id:
  - url: https://seclists.org/fulldisclosure/2018/Sep/28
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20200227111301/https://www.securityfocus.com/bid/105354
    reference_type:
    reference_id:
  - url: https://www.sec-consult.com/en/blog/advisories/remote-code-execution-php-unserialize-moodle-open-source-learning-platform-cve-2018-14630
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-14630
    reference_type:
    reference_id: CVE-2018-14630
