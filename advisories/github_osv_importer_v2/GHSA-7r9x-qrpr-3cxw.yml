advisory_id: GHSA-7r9x-qrpr-3cxw
datasource_id: github_osv_importer_v2/GHSA-7r9x-qrpr-3cxw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-7r9x-qrpr-3cxw/GHSA-7r9x-qrpr-3cxw.json
aliases: []
summary: "mofh Vulnerable to Improper Restriction of XML External Entity Reference\nThe `xml.etree.ElementTree`\
  \ module that mofh used up until version `1.0.1` implements a simple and efficient API for\
  \ parsing and creating XML data. But it makes the application vulnerable to:\n\n- [Billion\
  \ Laughs attack](https://en.wikipedia.org/wiki/Billion_laughs_attack): It is a type of denial-of-service\
  \ attack aimed at XML parsers. It uses multiple levels of nested entities. If one large entity\
  \ is repeated with a couple of thousand chars repeatedly, the parser gets overwhelmed.  \n\
  - [Quadratic blowup attack](https://www.acunetix.com/vulnerabilities/web/xml-quadratic-blowup-denial-of-service-attack/):\
  \ It is similar to a Billion Laughs attack. It abuses entity expansion, too. Instead of nested\
  \ entities, it repeats one large entity with a couple of thousand chars repeatedly.\n\nThe\
  \ Problem has been patched starting from version `1.0.1` by utilising the `defusedxml` package\
  \ instead of `xml.etree.ElementTree`.\n\n### Workarounds\nFor this vulnerability to be exploited\
  \ the user must be using a custom API URL, which has to be manually given using the `api_url`\
  \ argument, or MyOwnFreeHost's API must be hacked. So, if the user did not use a custom API\
  \ URL they _should_ be fine, however, upgrading is still advised.\n\nAnother workaround could\
  \ be to call `defusedxml.defuse_stdlib()` before making any requests using the client."
impacted_packages:
  - purl: pkg:pypi/mofh
    affected_versions: vers:pypi/<1.0.1
    fixed_versions: vers:pypi/1.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://github.com/Wallvon/mofh
    reference_type:
    reference_id:
  - url: https://github.com/Wallvon/mofh/commit/da0d33cfd368e2f237ab28bf7a7f00e3d281005a
    reference_type:
    reference_id:
  - url: https://github.com/Wallvon/mofh/security/advisories/GHSA-7r9x-qrpr-3cxw
    reference_type:
    reference_id:
  - url: https://www.acunetix.com/vulnerabilities/web/xml-quadratic-blowup-denial-of-service-attack
    reference_type:
    reference_id:
