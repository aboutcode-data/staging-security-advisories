advisory_id: GHSA-7q44-r25x-wm4q
datasource_id: github_osv_importer_v2/GHSA-7q44-r25x-wm4q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-7q44-r25x-wm4q/GHSA-7q44-r25x-wm4q.json
aliases:
  - CVE-2021-34551
summary: "Remote Code Execution vulnerability in PHPMailer 6.4.1 running on Windows\nPHPMailer\
  \ 6.4.1 contains a possible remote code execution vulnerability through the `$lang_path` parameter\
  \ of the `setLanguage()` method. If the `$lang_path` parameter is passed unfiltered from user\
  \ input, it can be set to [a UNC path](https://docs.microsoft.com/en-us/dotnet/standard/io/file-path-formats#unc-paths),\
  \ and if an attacker is also able to create a remote mount on the server that the UNC path\
  \ points to, a script file under their control may be executed. \n\n### Impact\nArbitrary\
  \ code may be run by a remote attacker under the web server or PHP process running on Window\
  \ hosts.\n\n### Patches\nMitigated in PHPMailer 6.5.0 by no longer treating translation files\
  \ as PHP code, but by parsing their text content directly.\nThis approach avoids the possibility\
  \ of executing unknown code while retaining backward compatibility. This isn't ideal, so the\
  \ current translation format is deprecated and will be replaced in the next major release.\n\
  \n### Workarounds\nAny of:\n* Ensure that calling code does not pass unfiltered user-supplied\
  \ data to the `$lang_path` parameter of the `setLanguage()` method.\n* Block or filter the\
  \ use of unknown UNC paths in this parameter (or altogether).\n* Ensure that unauthorised\
  \ users do not have the ability to read from unknown remote servers via UNC paths.\n* Run\
  \ on an OS that does not support UNC paths\n\n### References\n[CVE-2021-34551](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-34551).\n\
  \nReported by [listensec.com](https://listensec.com) via Tidelift.\n\n### For more information\n\
  If you have any questions or comments about this advisory:\n* Open an issue in [PHPMailer](https://github.com/PHPMailer/PHPMailer)\n\
  * [Email the maintainers](mailto:phpmailer@synchromedia.co.uk)"
impacted_packages:
  - purl: pkg:composer/phpmailer/phpmailer
    affected_versions: vers:composer/<6.5.0
    fixed_versions: vers:composer/6.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-7q44-r25x-wm4q/GHSA-7q44-r25x-wm4q.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
  - CWE-94
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/phpmailer/phpmailer/CVE-2021-34551.yaml
    reference_type:
    reference_id:
  - url: https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md
    reference_type:
    reference_id:
  - url: https://github.com/PHPMailer/PHPMailer/commit/acd264bf17ff4ac5c915f0d4226dce8a9ea70bc3
    reference_type:
    reference_id:
  - url: https://github.com/PHPMailer/PHPMailer/releases/tag/v6.5.0
    reference_type:
    reference_id:
  - url: https://github.com/PHPMailer/PHPMailer/security/advisories/GHSA-7q44-r25x-wm4q
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3YRMWGA4VTMXFB22KICMB7YMFZNFV3EJ
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FJYSOFCUBS67J3TKR74SD3C454N7VTYM
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-34551
    reference_type:
    reference_id: CVE-2021-34551
