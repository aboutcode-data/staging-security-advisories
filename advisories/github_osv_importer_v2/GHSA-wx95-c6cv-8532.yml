advisory_id: GHSA-wx95-c6cv-8532
datasource_id: github_osv_importer_v2/GHSA-wx95-c6cv-8532
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-wx95-c6cv-8532/GHSA-wx95-c6cv-8532.json
aliases: []
summary: |
  Nokogiri does not check the return value from xmlC14NExecute
  ## Summary

  Nokogiri's CRuby extension fails to check the return value from `xmlC14NExecute` in the method `Nokogiri::XML::Document#canonicalize` and `Nokogiri::XML::Node#canonicalize`. When canonicalization fails, an empty string is returned instead of raising an exception. This incorrect return value may allow downstream libraries to accept invalid or incomplete canonicalized XML, which has been demonstrated to enable signature validation bypass in SAML libraries.

  JRuby is not affected, as the Java implementation correctly raises `RuntimeError` on canonicalization failure.

  ## Mitigation

  Upgrade to Nokogiri `>= 1.19.1`.

  ## Severity

  The maintainers have assessed this as **Medium** severity. Nokogiri itself is a parsing library without a clear security boundary related to canonicalization, so the direct impact is that a method returns incorrect data on invalid input. However, this behavior was exploited in practice to bypass SAML signature validation in downstream libraries (see References).

  ## Credit

  This vulnerability was responsibly reported by HackerOne researcher `d4d`.
impacted_packages:
  - purl: pkg:gem/nokogiri
    affected_versions: vers:gem/>=1.5.1|<1.19.1
    fixed_versions: vers:gem/1.19.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-wx95-c6cv-8532/GHSA-wx95-c6cv-8532.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-252
references:
  - url: https://github.com/sparklemotion/nokogiri
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-wx95-c6cv-8532
    reference_type:
    reference_id:
