advisory_id: GHSA-q97g-c29h-x2p7
datasource_id: github_osv_importer_v2/GHSA-q97g-c29h-x2p7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-q97g-c29h-x2p7/GHSA-q97g-c29h-x2p7.json
aliases:
  - CVE-2024-22203
summary: |
  Whoogle Search Path Traversal vulnerability
  Whoogle Search is a self-hosted metasearch engine. In versions prior to 0.8.4, the `element` method in `app/routes.py` does not validate the user-controlled `src_type` and `element_url` variables and passes them to the `send` method which sends a GET request on lines 339-343 in `request.py`, which leads to a server-side request forgery. This issue allows for crafting GET requests to internal and external resources on behalf of the server. For example, this issue would allow for accessing resources on the internal network that the server has access to, even though these resources may not be accessible on the internet. This issue is fixed in version 0.8.4.
impacted_packages:
  - purl: pkg:pypi/whoogle-search
    affected_versions: vers:pypi/<0.8.4
    fixed_versions: vers:pypi/0.8.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-q97g-c29h-x2p7/GHSA-q97g-c29h-x2p7.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/benbusby/whoogle-search
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/request.py#L339-L343
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L465-L490
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L466
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L476
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L479
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/commit/3a2e0b262e4a076a20416b45e6b6f23fd265aeda
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/whoogle-search/PYSEC-2024-20.yaml
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2023-186_GHSL-2023-189_benbusby_whoogle-search
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22203
    reference_type:
    reference_id: CVE-2024-22203
