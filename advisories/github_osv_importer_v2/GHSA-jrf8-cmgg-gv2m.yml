advisory_id: GHSA-jrf8-cmgg-gv2m
datasource_id: github_osv_importer_v2/GHSA-jrf8-cmgg-gv2m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-jrf8-cmgg-gv2m/GHSA-jrf8-cmgg-gv2m.json
aliases:
  - CVE-2021-26307
summary: |
  Error on unsupported architectures in raw-cpuid
  native_cpuid::cpuid_count() exposes the unsafe __cpuid_count() intrinsic from core::arch::x86 or core::arch::x86_64 as a safe function, and uses it internally, without checking the safety requirement:

  * The CPU the program is currently running on supports the function being called.

  CPUID is available in most, but not all, x86/x86_64 environments. The crate compiles only on these architectures, so others are unaffected. This issue is mitigated by the fact that affected programs are expected to crash deterministically every time.

  The flaw has been fixed in v9.0.0, by intentionally breaking compilation when targeting SGX or 32-bit x86 without SSE. This covers all affected CPUs.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-jrf8-cmgg-gv2m/GHSA-jrf8-cmgg-gv2m.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-657
  - CWE-400
references:
  - url: https://github.com/gz/rust-cpuid
    reference_type:
    reference_id:
  - url: https://github.com/gz/rust-cpuid/commit/91b676eecd01f2163e2984215e2c0ac89e30ce75
    reference_type:
    reference_id:
  - url: https://github.com/gz/rust-cpuid/issues/40
    reference_type:
    reference_id:
  - url: https://github.com/gz/rust-cpuid/issues/41
    reference_type:
    reference_id:
  - url: https://github.com/RustSec/advisory-db/pull/614
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0013.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-26307
    reference_type:
    reference_id: CVE-2021-26307
