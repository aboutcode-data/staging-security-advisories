advisory_id: GHSA-xqxm-2rpm-3889
datasource_id: github_osv_importer_v2/GHSA-xqxm-2rpm-3889
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-xqxm-2rpm-3889/GHSA-xqxm-2rpm-3889.json
aliases:
  - CVE-2022-21683
summary: |
  Comment reply notifications sent to incorrect users
  ### Impact
  When notifications for new replies in comment threads are sent, they are sent to all users who have replied or commented anywhere on the site, rather than only in the relevant threads. This means that a user could listen in to new comment replies on pages they have not had editing access to, as long as they have left a comment or reply somewhere on the site.

  ### Patches
  A patched version has been released as Wagtail 2.15.2 (for the current LTS), which restores the intended behaviour - to send notifications for new replies to the participants in the active thread only (editing permissions are not considered).

  ### Workarounds
  New comments can be disabled by setting `WAGTAILADMIN_COMMENTS_ENABLED = False` in the Django settings file.

  ### Acknowledgements

  Many thanks to Ihor Marhitych for identifying this issue.

  ### For more information
  If you have any questions or comments about this advisory:

  * Visit Wagtail's [support channels](https://docs.wagtail.io/en/stable/support.html)
  * Email us at security@wagtail.io (if you wish to send encrypted email, the public key ID is `0x6ba1e1a86e0f8ce8`)
impacted_packages:
  - purl: pkg:pypi/wagtail
    affected_versions: vers:pypi/>=2.13|<2.15.2
    fixed_versions: vers:pypi/2.15.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-xqxm-2rpm-3889/GHSA-xqxm-2rpm-3889.json
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-xqxm-2rpm-3889/GHSA-xqxm-2rpm-3889.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/wagtail/PYSEC-2022-13.yaml
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/5fe901e5d86ed02dbbb63039a897582951266afd
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/releases/tag/v2.15.2
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/security/advisories/GHSA-xqxm-2rpm-3889
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21683
    reference_type:
    reference_id: CVE-2022-21683
