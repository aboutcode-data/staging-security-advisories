advisory_id: GHSA-p75c-5x3h-cxcg
datasource_id: github_osv_importer_v2/GHSA-p75c-5x3h-cxcg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-p75c-5x3h-cxcg/GHSA-p75c-5x3h-cxcg.json
aliases:
  - CVE-2022-39281
summary: |
  Fat Free CRM vulnerable to Remote Denial of Service via Tasks endpoint
  ### Impact
  An authenticated user can perform a remote Denial of Service attack against Fat Free CRM.

  This vulnerability has been assigned the CVE identifier: CVE-2022-39281

  Affected versions: All
  Not affected: None
  Fixed versions: 0.20.1

  All users running an affected release should either upgrade or apply the patch immediately.

  ### Releases
  Fixed versions: 0.20.1 and above

  ### Patches

  If you are unable to upgrade immediately, you should apply the following patch.

  ```
  diff --git a/app/models/polymorphic/task.rb b/app/models/polymorphic/task.rb
  index d3d5c32c..7cdb24d6 100644
  --- a/app/models/polymorphic/task.rb
  +++ b/app/models/polymorphic/task.rb
  @@ -189,6 +189,7 @@ class Task < ActiveRecord::Base
     #----------------------------------------------------------------------------
     def self.bucket_empty?(bucket, user, view = "pending")
       return false if bucket.blank? || !ALLOWED_VIEWS.include?(view)
  +    return false unless Setting.task_bucket.map(&:to_s).include?(bucket.to_s)

       if view == "assigned"
         assigned_by(user).send(bucket).pending.count
  ```

  ### Credits

  Thanks to @p- for reporting this and working with us to responsibly disclose this vulnerability.

  ### Further information
  If you have any questions or comments about this advisory, please Open an issue in [GitHub Issue Tracker](https://github.com/fatfreecrm/fat_free_crm/issues)
impacted_packages:
  - purl: pkg:gem/fat_free_crm
    affected_versions: vers:gem/<0.20.1
    fixed_versions: vers:gem/0.20.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-p75c-5x3h-cxcg/GHSA-p75c-5x3h-cxcg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/fatfreecrm/fat_free_crm
    reference_type:
    reference_id:
  - url: https://github.com/fatfreecrm/fat_free_crm/commit/c85a2546348c2692d32f952c753f7f0b43d1ca71
    reference_type:
    reference_id:
  - url: https://github.com/fatfreecrm/fat_free_crm/releases/tag/v0.20.1
    reference_type:
    reference_id:
  - url: https://github.com/fatfreecrm/fat_free_crm/security/advisories/GHSA-p75c-5x3h-cxcg
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/fat_free_crm/CVE-2022-39281.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39281
    reference_type:
    reference_id: CVE-2022-39281
