advisory_id: GHSA-cwmx-hcrq-mhc3
datasource_id: github_osv_importer_v2/GHSA-cwmx-hcrq-mhc3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-cwmx-hcrq-mhc3/GHSA-cwmx-hcrq-mhc3.json
aliases:
  - CVE-2022-29248
summary: |
  Cross-domain cookie leakage in Guzzle
  ### Impact

  Previous version of Guzzle contain a vulnerability with the cookie middleware. The vulnerability is that it is not checked if the cookie domain equals the domain of the server which sets the cookie via the `Set-Cookie` header, allowing a malicious server to set cookies for unrelated domains. For example an attacker at `www.example.com` might set a session cookie for `api.example.net`, logging the Guzzle client into their account and retrieving private API requests from the security log of their account.

  Note that our cookie middleware is disabled by default, so most library consumers will not be affected by this issue. Only those who manually add the cookie middleware to the handler stack or construct the client with `['cookies' => true]` are affected. Moreover, those who do not use the same Guzzle client to call multiple domains and have disabled redirect forwarding are not affected by this vulnerability.

  ### Patches

  Affected Guzzle 7 users should upgrade to Guzzle 7.4.3 as soon as possible. Affected users using any earlier series of Guzzle should upgrade to Guzzle 6.5.6 or 7.4.3.

  ### Workarounds

  If you do not need support for cookies, turn off the cookie middleware. It is already off by default, but if you have turned it on and no longer need it, turn it off.

  ### References

  * [RFC6265 Section 5.3](https://datatracker.ietf.org/doc/html/rfc6265#section-5.3)
  * [RFC9110 Section 15.4](https://www.rfc-editor.org/rfc/rfc9110.html#name-redirection-3xx)

  ### For more information

  If you have any questions or comments about this advisory, please get in touch with us in `#guzzle` on the [PHP HTTP Slack](https://php-http.slack.com/). Do not report additional security advisories in that public channel, however - please follow our [vulnerability reporting process](https://github.com/guzzle/guzzle/security/policy).
impacted_packages:
  - purl: pkg:composer/guzzlehttp/guzzle
    affected_versions: vers:composer/<6.5.6
    fixed_versions: vers:composer/6.5.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/guzzlehttp/guzzle
    affected_versions: vers:composer/>=7.0.0|<7.4.3
    fixed_versions: vers:composer/7.4.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-cwmx-hcrq-mhc3/GHSA-cwmx-hcrq-mhc3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-565
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/guzzlehttp/guzzle/CVE-2022-29248.yaml
    reference_type:
    reference_id:
  - url: https://github.com/guzzle/guzzle
    reference_type:
    reference_id:
  - url: https://github.com/guzzle/guzzle/commit/74a8602c6faec9ef74b7a9391ac82c5e65b1cdab
    reference_type:
    reference_id:
  - url: https://github.com/guzzle/guzzle/pull/3018
    reference_type:
    reference_id:
  - url: https://github.com/guzzle/guzzle/security/advisories/GHSA-cwmx-hcrq-mhc3
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2022/dsa-5246
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2022-010
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29248
    reference_type:
    reference_id: CVE-2022-29248
