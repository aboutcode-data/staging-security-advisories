advisory_id: GHSA-2rx4-9f5h-9gjf
datasource_id: github_osv_importer_v2/GHSA-2rx4-9f5h-9gjf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-2rx4-9f5h-9gjf/GHSA-2rx4-9f5h-9gjf.json
aliases:
  - CVE-2023-33234
summary: |
  Apache Airflow CNCF Kubernetes Provider: KubernetesPodOperator RCE via connection configuration
  Arbitrary code execution in Apache Airflow CNCF Kubernetes provider version 5.0.0 allows user to change xcom sidecar image and resources via Airflow connection.

  In order to exploit this weakness, a user would already need elevated permissions (Op or Admin) to change the connection object in this manner.Â Operators should upgrade to provider version 7.0.0 which has removed the vulnerability.
impacted_packages:
  - purl: pkg:pypi/apache-airflow-providers-cncf-kubernetes
    affected_versions: vers:pypi/>=5.0.0|<7.0.0
    fixed_versions: vers:pypi/7.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-2rx4-9f5h-9gjf/GHSA-2rx4-9f5h-9gjf.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-74
references:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/n1vpgl6h2qsdm52o9m2tx1oo86tl4gnq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-33234
    reference_type:
    reference_id: CVE-2023-33234
