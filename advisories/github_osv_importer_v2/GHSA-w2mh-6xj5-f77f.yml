advisory_id: GHSA-w2mh-6xj5-f77f
datasource_id: github_osv_importer_v2/GHSA-w2mh-6xj5-f77f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-w2mh-6xj5-f77f/GHSA-w2mh-6xj5-f77f.json
aliases:
  - CVE-2022-20618
summary: |
  Incorrect Permission Assignment for Critical Resource in Jenkins Bitbucket Branch Source Plugin
  Jenkins Bitbucket Branch Source Plugin prior to 746.v350d2781c184, 725.vd9f8be0fa250, 2.9.11.2, and 2.9.7.2 does not perform permission checks in several HTTP endpoints.

  This allows attackers with Overall/Read access to enumerate credentials IDs of credentials stored in Jenkins. Those can be used as part of an attack to capture the credentials using another vulnerability.

  An enumeration of credentials IDs in Bitbucket Branch Source Plugin 746.v350d2781c184, 725.vd9f8be0fa250, 2.9.11.2, and 2.9.7.2 requires the appropriate permissions.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/cloudbees-bitbucket-branch-source
    affected_versions: vers:maven/>=726.v7e6f53de133c|<746.v350d2781c184
    fixed_versions: vers:maven/746.v350d2781c184
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.plugins/cloudbees-bitbucket-branch-source
    affected_versions: vers:maven/>=720.vbe985dd73d66|<725.vd9f8be0fa250
    fixed_versions: vers:maven/725.vd9f8be0fa250
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.plugins/cloudbees-bitbucket-branch-source
    affected_versions: vers:maven/>=2.9.8|<2.9.11.2
    fixed_versions: vers:maven/2.9.11.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.plugins/cloudbees-bitbucket-branch-source
    affected_versions: vers:maven/<2.9.7.2
    fixed_versions: vers:maven/2.9.7.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-w2mh-6xj5-f77f/GHSA-w2mh-6xj5-f77f.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
  - CWE-732
references:
  - url: https://github.com/CVEProject/cvelist/blob/2d78eb36f4d084db7fb35f1535d8d84fdcb7d859/2022/20xxx/CVE-2022-20618.json
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/bitbucket-branch-source-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/bitbucket-branch-source-plugin/commit/467ed6c94af8735c4755d53145a54325ae82d073
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2022-01-12/#SECURITY-2033
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2022/01/12/6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-20618
    reference_type:
    reference_id: CVE-2022-20618
