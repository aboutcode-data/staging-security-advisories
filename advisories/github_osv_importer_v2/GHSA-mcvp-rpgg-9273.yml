advisory_id: GHSA-mcvp-rpgg-9273
datasource_id: github_osv_importer_v2/GHSA-mcvp-rpgg-9273
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-mcvp-rpgg-9273/GHSA-mcvp-rpgg-9273.json
aliases:
  - CVE-2025-59410
summary: |
  DragonFly's tiny file download uses hard coded HTTP protocol
  ### Impact
  The code in the scheduler for downloading a tiny file is hard coded to use the HTTP protocol, rather than HTTPS. This means that an attacker could perform a Man-in-the-Middle attack, changing the network request so that a different piece of data gets downloaded. Due to the use of weak integrity checks (TOB-DF2-15), this modification of the data may go unnoticed.

  ```golang
  // DownloadTinyFile downloads tiny file from peer without range.
  func (p *Peer) DownloadTinyFile() ([]byte, error) {
         ctx, cancel := context.WithTimeout(context.Background(),
  downloadTinyFileContextTimeout)
         defer cancel()
         // Download url:
  http://${host}:${port}/download/${taskIndex}/${taskID}?peerId=${peerID}
         targetURL := url.URL{
  Scheme:
  }
  "http",
  fmt.Sprintf("%s:%d", p.Host.IP, p.Host.DownloadPort),
  fmt.Sprintf("download/%s/%s", p.Task.ID[:3], p.Task.ID),
  Host:
  Path:
  RawQuery: fmt.Sprintf("peerId=%s", p.ID),
  ```

  A network-level attacker who cannot join a peer-to-peer network performs a Man-in-the-Middle attack on peers. The adversary can do this because peers (partially) communicate over plaintext HTTP protocol. The attack chains this vulnerability with the one described in TOB-DF2-15 to replace correct files with malicious ones. Unconscious peers use the malicious files.

  ### Patches

  - Dragonfy v2.1.0 and above.

  ### Workarounds

  There are no effective workarounds, beyond upgrading.

  ### References

  A third party security audit was performed by Trail of Bits, you can see the [full report](https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf).

  If you have any questions or comments about this advisory, please email us at [dragonfly-maintainers@googlegroups.com](mailto:dragonfly-maintainers@googlegroups.com).
impacted_packages: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-mcvp-rpgg-9273/GHSA-mcvp-rpgg-9273.json
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-mcvp-rpgg-9273/GHSA-mcvp-rpgg-9273.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-311
references:
  - url: https://github.com/dragonflyoss/dragonfly
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-mcvp-rpgg-9273
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59410
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3974
    reference_type:
    reference_id:
