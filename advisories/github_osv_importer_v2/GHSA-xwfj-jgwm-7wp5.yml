advisory_id: GHSA-xwfj-jgwm-7wp5
datasource_id: github_osv_importer_v2/GHSA-xwfj-jgwm-7wp5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-xwfj-jgwm-7wp5/GHSA-xwfj-jgwm-7wp5.json
aliases:
  - CVE-2025-58160
summary: |
  Tracing logging user input may result in poisoning logs with ANSI escape sequences
  ### Impact

  Previous versions of tracing-subscriber were vulnerable to ANSI escape sequence injection attacks. Untrusted user input containing ANSI escape sequences could be injected into terminal output when logged, potentially allowing attackers to:

  - Manipulate terminal title bars
  - Clear screens or modify terminal display
  - Potentially mislead users through terminal manipulation

  In isolation, impact is minimal, however security issues have been found in terminal emulators that enabled an attacker to use ANSI escape sequences via logs to exploit vulnerabilities in the terminal emulator.

  ### Patches

  `tracing-subscriber` version 0.3.20 fixes this vulnerability by escaping ANSI control characters in when writing events to destinations that may be printed to the terminal.

  ### Workarounds

  Avoid printing logs to terminal emulators without escaping ANSI control sequences.

  ### References

  https://www.packetlabs.net/posts/weaponizing-ansi-escape-sequences/


  ### Acknowledgments

  We would like to thank [zefr0x](http://github.com/zefr0x) who responsibly reported the issue at `security@tokio.rs`.

  If you believe you have found a security vulnerability in any tokio-rs project, please email us at `security@tokio.rs`.
impacted_packages: []
severities:
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-xwfj-jgwm-7wp5/GHSA-xwfj-jgwm-7wp5.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-150
references:
  - url: https://github.com/tokio-rs/tracing
    reference_type:
    reference_id:
  - url: https://github.com/tokio-rs/tracing/security/advisories/GHSA-xwfj-jgwm-7wp5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-58160
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2025-0055.html
    reference_type:
    reference_id:
