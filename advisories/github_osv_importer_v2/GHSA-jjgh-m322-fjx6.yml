advisory_id: GHSA-jjgh-m322-fjx6
datasource_id: github_osv_importer_v2/GHSA-jjgh-m322-fjx6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-jjgh-m322-fjx6/GHSA-jjgh-m322-fjx6.json
aliases:
  - CVE-2019-3895
summary: |
  Openstack Octavia Access Control Vulnerability
  ### Description
  An access-control flaw was found in the Octavia service when the cloud platform was deployed using Red Hat OpenStack Platform Director. An attacker could cause new amphorae to run based on any arbitrary image. This meant that a remote attacker could upload a new amphorae image and, if requested to spawn new amphorae, Octavia would then pick up the compromised image.

  ### Mitigation
  To prevent this vulnerability:
  1. Update Octavia's configuration setting (octavia.conf) to `amp_image_owner_id = $UUID_OF_SERVICE_PROJECT` on all Octavia nodes.
  2. Enable the new configuration by restarting both `octavia_worker` and `octavia_health_manager`.
impacted_packages:
  - purl: pkg:pypi/octavia
    affected_versions: vers:pypi/<0.9.0
    fixed_versions: vers:pypi/0.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-jjgh-m322-fjx6/GHSA-jjgh-m322-fjx6.json
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-jjgh-m322-fjx6/GHSA-jjgh-m322-fjx6.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
references:
  - url: https://access.redhat.com/errata/RHSA-2019:1683
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2019:1742
    reference_type:
    reference_id:
  - url: https://bugs.launchpad.net/octavia/+bug/1620629
    reference_type:
    reference_id:
  - url: https://bugs.launchpad.net/tripleo/+bug/1830607
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3895
    reference_type:
    reference_id:
  - url: https://github.com/openstack/octavia
    reference_type:
    reference_id:
  - url: https://github.com/openstack/octavia/blob/08570831754d9671fbd1756d668f55f191e47ca4/octavia/compute/drivers/nova_driver.py#L35
    reference_type:
    reference_id:
  - url: https://github.com/openstack/octavia/commit/d7d062a47ab54a540d81f13a0e5f3085ebfaa0d2
    reference_type:
    reference_id:
  - url: https://github.com/openstack/tripleo-common/commit/e7c5eab712e0f70ecbc6d225d4766e0fe0f3f884
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/octavia/PYSEC-2019-194.yaml
    reference_type:
    reference_id:
  - url: https://opendev.org/openstack/octavia/commit/d7d062a47ab54a540d81f13a0e5f3085ebfaa0d2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-3895
    reference_type:
    reference_id: CVE-2019-3895
