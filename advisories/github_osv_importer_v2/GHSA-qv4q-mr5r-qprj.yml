advisory_id: GHSA-qv4q-mr5r-qprj
datasource_id: github_osv_importer_v2/GHSA-qv4q-mr5r-qprj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-qv4q-mr5r-qprj/GHSA-qv4q-mr5r-qprj.json
aliases:
  - CVE-2022-23476
summary: "Unchecked return value from xmlTextReaderExpand\n## Summary\n\nNokogiri `1.13.8, 1.13.9`\
  \ fails to check the return value from `xmlTextReaderExpand` in the method `Nokogiri::XML::Reader#attribute_hash`.\
  \ This can lead to a null pointer exception when invalid markup is being parsed. \n\nFor applications\
  \ using `XML::Reader` to parse untrusted inputs, this may potentially be a vector for a denial\
  \ of service attack.\n\n\n## Mitigation\n\nUpgrade to Nokogiri `>= 1.13.10`.\n\nUsers may\
  \ be able to search their code for calls to either `XML::Reader#attributes` or `XML::Reader#attribute_hash`\
  \ to determine if they are affected.\n\n\n## Severity\n\nThe Nokogiri maintainers have evaluated\
  \ this as [High Severity 7.5 (CVSS3.1)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n\
  \n\n## References\n\n- [CWE - CWE-252: Unchecked Return Value (4.9)](https://cwe.mitre.org/data/definitions/252.html)\n\
  - [CWE - CWE-476: NULL Pointer Dereference (4.9)](https://cwe.mitre.org/data/definitions/476.html)\n\
  \n\n## Credit\n\nThis vulnerability was responsibly reported by @davidwilemski."
impacted_packages:
  - purl: pkg:gem/nokogiri
    affected_versions: vers:gem/>=1.13.8|<1.13.10
    fixed_versions: vers:gem/1.13.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/12/GHSA-qv4q-mr5r-qprj/GHSA-qv4q-mr5r-qprj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-476
  - CWE-252
references:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/CVE-2022-23476.yml
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/commit/85410e38410f670cbbc8c5b00d07b843caee88ce
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/commit/9fe0761c47c0d4270d1a5220cfd25de080350d50
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-qv4q-mr5r-qprj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23476
    reference_type:
    reference_id: CVE-2022-23476
