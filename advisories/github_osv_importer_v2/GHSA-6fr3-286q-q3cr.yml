advisory_id: GHSA-6fr3-286q-q3cr
datasource_id: github_osv_importer_v2/GHSA-6fr3-286q-q3cr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-6fr3-286q-q3cr/GHSA-6fr3-286q-q3cr.json
aliases:
  - CVE-2020-2252
summary: |
  Improper Validation of Certificate with Host Mismatch in Jenkins Mailer Plugin
  Jenkins Mailer Plugin prior to 1.32.1, 1.31.1, and 1.29.1 does not perform hostname validation when connecting to the configured SMTP server. This lack of validation could be abused using a man-in-the-middle attack to intercept these connections.

  Mailer Plugin 1.32.1, 1.31.1, and 1.29.1 validates the SMTP hostname when connecting via TLS by default. In Mailer Plugin 1.32 and earlier, administrators can set the Java system property mail.smtp.ssl.checkserveridentity to true on startup to enable this protection.

  In case of problems, this protection can be disabled again by setting the Java system property mail.smtp.ssl.checkserveridentity to false on startup.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/mailer
    affected_versions: vers:maven/1.32
    fixed_versions: vers:maven/1.32.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.plugins/mailer
    affected_versions: vers:maven/>=1.30|<1.31.1
    fixed_versions: vers:maven/1.31.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.jenkins-ci.plugins/mailer
    affected_versions: vers:maven/<1.29.1
    fixed_versions: vers:maven/1.29.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-6fr3-286q-q3cr/GHSA-6fr3-286q-q3cr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-295
references:
  - url: https://github.com/CVEProject/cvelist/blob/16860a328d970faa6e4350b0fa446f64a52e52ca/2020/2xxx/CVE-2020-2252.json
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/mailer-plugin/commit/e1893c6d105669f134ee5c5212ef9f3944d7d00d
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2020-09-16/#SECURITY-1813
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2020/09/16/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-2252
    reference_type:
    reference_id: CVE-2020-2252
