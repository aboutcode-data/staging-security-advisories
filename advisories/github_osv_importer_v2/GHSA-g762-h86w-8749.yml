advisory_id: GHSA-g762-h86w-8749
datasource_id: github_osv_importer_v2/GHSA-g762-h86w-8749
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-g762-h86w-8749/GHSA-g762-h86w-8749.json
aliases:
  - CVE-2024-36121
summary: "BoringSSLAEADContext in Netty Repeats Nonces\n### Summary\nBoringSSLAEADContext keeps\
  \ track of how many OHTTP responses have been sent and uses this sequence number to calculate\
  \ the appropriate nonce to use with the encryption algorithm. \nUnfortunately, two separate\
  \ errors combine which would allow an attacker to cause the sequence number to overflow and\
  \ thus the nonce to repeat.\n\n### Details\n1. There is no overflow detection or enforcement\
  \ of the maximum sequence value. (This is a missed requirement from the draft Chunked Oblivious\
  \ OHTTP RFC and so should be inherited from the HPKE RFC 9180, Section 5.2).\n2. The sequence\
  \ number (seq) is stored as 32-bit int which is relatively easy to overflow.\n\nhttps://github.com/netty/netty-incubator-codec-ohttp/blob/1ddadb6473cd3be5491d114431ed4c1a9f316001/codec-ohttp-hpke-classes-boringssl/src/main/java/io/netty/incubator/codec/hpke/boringssl/BoringSSLAEADContext.java#L112-L114\n\
  \n### Impact\nIf the BoringSSLAEADContext is used to encrypt more than 2^32 messages then\
  \ the AES-GCM nonce will repeat.\nRepeating a nonce with AES-GCM results in both confidentiality\
  \ and integrity compromise of data encrypted with the associated key."
impacted_packages:
  - purl: pkg:maven/io.netty.incubator/netty-incubator-codec-ohttp
    affected_versions: vers:maven/>=0.0.3.Final|<0.0.11.Final
    fixed_versions: vers:maven/0.0.11.Final
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-g762-h86w-8749/GHSA-g762-h86w-8749.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-190
  - CWE-200
references:
  - url: https://github.com/netty/netty-incubator-codec-ohttp
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty-incubator-codec-ohttp/blob/1ddadb6473cd3be5491d114431ed4c1a9f316001/codec-ohttp-hpke-classes-boringssl/src/main/java/io/netty/incubator/codec/hpke/boringssl/BoringSSLAEADContext.java#L112-L114
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty-incubator-codec-ohttp/security/advisories/GHSA-g762-h86w-8749
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-36121
    reference_type:
    reference_id: CVE-2024-36121
