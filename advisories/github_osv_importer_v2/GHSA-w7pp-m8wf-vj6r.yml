advisory_id: GHSA-w7pp-m8wf-vj6r
datasource_id: github_osv_importer_v2/GHSA-w7pp-m8wf-vj6r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-w7pp-m8wf-vj6r/GHSA-w7pp-m8wf-vj6r.json
aliases:
  - CVE-2023-23931
summary: |
  Cipher.update_into can corrupt memory if passed an immutable python object as the outbuf
  Previously, `Cipher.update_into` would accept Python objects which implement the buffer protocol, but provide only immutable buffers:

  ```pycon
  >>> outbuf = b"\x00" * 32
  >>> c = ciphers.Cipher(AES(b"\x00" * 32), modes.ECB()).encryptor()
  >>> c.update_into(b"\x00" * 16, outbuf)
  16
  >>> outbuf
  b'\xdc\x95\xc0x\xa2@\x89\x89\xadH\xa2\x14\x92\x84 \x87\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
  ```

  This would allow immutable objects (such as `bytes`) to be mutated, thus violating fundamental rules of Python. This is a soundness bug -- it allows programmers to misuse an API, it cannot be exploited by attacker controlled data alone.

  This now correctly raises an exception.

  This issue has been present since `update_into` was originally introduced in cryptography 1.8.
impacted_packages:
  - purl: pkg:pypi/cryptography
    affected_versions: vers:pypi/>=1.8|<39.0.1
    fixed_versions: vers:pypi/39.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-w7pp-m8wf-vj6r/GHSA-w7pp-m8wf-vj6r.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-w7pp-m8wf-vj6r/GHSA-w7pp-m8wf-vj6r.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-754
references:
  - url: https://github.com/pyca/cryptography
    reference_type:
    reference_id:
  - url: https://github.com/pyca/cryptography/commit/d6951dca25de45abd52da51b608055371fbcde4e
    reference_type:
    reference_id:
  - url: https://github.com/pyca/cryptography/pull/8230
    reference_type:
    reference_id:
  - url: https://github.com/pyca/cryptography/security/advisories/GHSA-w7pp-m8wf-vj6r
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/cryptography/PYSEC-2023-11.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/10/msg00012.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230324-0007
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-23931
    reference_type:
    reference_id: CVE-2023-23931
