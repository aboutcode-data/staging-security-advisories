advisory_id: GHSA-w23q-4hw3-2pp6
datasource_id: github_osv_importer_v2/GHSA-w23q-4hw3-2pp6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-w23q-4hw3-2pp6/GHSA-w23q-4hw3-2pp6.json
aliases:
  - CVE-2023-28433
summary: |
  Minio vulnerable to Privilege Escalation on Windows via Path separator manipulation
  ### Impact
  All users on Windows are impacted. MinIO fails to filter the `\` character, which allows for arbitrary object placement across
  buckets. As a result, a user with low privileges, such as an access key, service account, or STS credential, which only has permission to `PutObject` in a specific bucket, can create an admin user.

  ### Patches
  There are two patches that fix this problem comprehensively

  ```
  commit b3c54ec81e0a06392abfb3a1ffcdc80c6fbf6ebc
  Author: Harshavardhana <harsha@minio.io>
  Date:   Mon Mar 20 13:16:00 2023 -0700

      reject object names with '\' on windows (#16856)
  ```

  ```
  commit 8d6558b23649f613414c8527b58973fbdfa4d1b8
  Author: Harshavardhana <harsha@minio.io>
  Date:   Mon Mar 20 00:35:25 2023 -0700

      fix: convert '\' to '/' on windows (#16852)
  ```

  ### Workarounds
  There are no known workarounds

  ### References
  The vulnerable code:
  ```go
  // minio/cmd/generic-handlers.go
  // Check if the incoming path has bad path components,
  // such as ".." and "."
  // SlashSeparator -> /
  // dotdotComponent -> ..
  // dotComponent -> .
  func hasBadPathComponent(path string) bool {
    path = strings.TrimSpace(path)
    for _, p := range strings.Split(path, SlashSeparator) {
      switch strings.TrimSpace(p) {
      case dotdotComponent:
        return true
      case dotComponent:
        return true
      }
    }
    return false
  }
  ```
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-w23q-4hw3-2pp6/GHSA-w23q-4hw3-2pp6.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-668
references:
  - url: https://github.com/minio/minio
    reference_type:
    reference_id:
  - url: https://github.com/minio/minio/commit/8d6558b23649f613414c8527b58973fbdfa4d1b8
    reference_type:
    reference_id:
  - url: https://github.com/minio/minio/commit/b3c54ec81e0a06392abfb3a1ffcdc80c6fbf6ebc
    reference_type:
    reference_id:
  - url: https://github.com/minio/minio/releases/tag/RELEASE.2023-03-20T20-16-18Z
    reference_type:
    reference_id:
  - url: https://github.com/minio/minio/security/advisories/GHSA-w23q-4hw3-2pp6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-28433
    reference_type:
    reference_id: CVE-2023-28433
