advisory_id: GHSA-rfxf-mf63-cpqv
datasource_id: github_osv_importer_v2/GHSA-rfxf-mf63-cpqv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-rfxf-mf63-cpqv/GHSA-rfxf-mf63-cpqv.json
aliases:
  - CVE-2024-42368
summary: |
  open-telemetry has an Observable Timing Discrepancy
  ### Summary

  The bearertokenauth extension's server authenticator performs a simple, non-constant time string comparison of the received & configured bearer tokens.

  ### Details

  https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/9128a9258fe1fee36f198f97b1e3371fc7b77a93/extension/bearertokenauthextension/bearertokenauth.go#L189-L196

  For background on the type of vulnerability, see https://ropesec.com/articles/timing-attacks/.

  ### Impact

  This impacts anyone using the `bearertokenauth` server authenticator. Malicious clients with network access to the collector may perform a timing attack against a collector with this authenticator to guess the configured token, by iteratively sending tokens and comparing the response time. This would allow an attacker to introduce fabricated or bad data into the collector's telemetry pipeline.

  ### Fix

  The observable timing vulnerability was fixed by @axw in v0.107.0 (PR https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/34516) by using constant-time comparison.

  ### Workarounds

  - upgrade to v0.107.0 or above, or, if you're unable to upgrade at this time,
  - don't expose the receiver using `bearertokenauth` to network segments accessible by potential attackers, or
  - change the receiver to use a different authentication extension instead, or
  - disable the receiver relying on `bearertokenauth`
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-rfxf-mf63-cpqv/GHSA-rfxf-mf63-cpqv.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-rfxf-mf63-cpqv/GHSA-rfxf-mf63-cpqv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-208
references:
  - url: https://github.com/open-telemetry/opentelemetry-collector-contrib
    reference_type:
    reference_id:
  - url: https://github.com/open-telemetry/opentelemetry-collector-contrib/commit/c9bd3eff0bb357d9c812a0d8defd3b09db95699a
    reference_type:
    reference_id:
  - url: https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/34516
    reference_type:
    reference_id:
  - url: https://github.com/open-telemetry/opentelemetry-collector-contrib/security/advisories/GHSA-rfxf-mf63-cpqv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42368
    reference_type:
    reference_id: CVE-2024-42368
