advisory_id: GHSA-c92w-72c5-9x59
datasource_id: github_osv_importer_v2/GHSA-c92w-72c5-9x59
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-c92w-72c5-9x59/GHSA-c92w-72c5-9x59.json
aliases:
  - CVE-2019-10223
summary: |
  kube-state-metrics may expose secret content in metrics
  A security issue was discovered in the kube-state-metrics versions v1.7.0 and v1.7.1. An experimental feature was added to the v1.7.0 release that enabled annotations to be exposed as metrics. By default, the kube-state-metrics metrics only expose metadata about Secrets. However, a combination of the default `kubectl` behavior and this new feature can cause the entire secret content to end up in metric labels thus inadvertently exposing the secret content in metrics. This feature has been reverted and released as the v1.7.2 release. If you are running the v1.7.0 or v1.7.1 release, please upgrade to the v1.7.2 release as soon as possible.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-c92w-72c5-9x59/GHSA-c92w-72c5-9x59.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10223
    reference_type:
    reference_id:
  - url: https://github.com/kubernetes/kube-state-metrics
    reference_type:
    reference_id:
  - url: https://github.com/kubernetes/kube-state-metrics/commit/03122fe3e2df49a9a7298b8af921d3c37c430f7f
    reference_type:
    reference_id:
  - url: https://github.com/kubernetes/kube-state-metrics/releases/tag/v1.7.2
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-0621
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2019/08/09/1
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2019/08/15/8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-10223
    reference_type:
    reference_id: CVE-2019-10223
