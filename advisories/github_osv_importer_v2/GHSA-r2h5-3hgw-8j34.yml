advisory_id: GHSA-r2h5-3hgw-8j34
datasource_id: github_osv_importer_v2/GHSA-r2h5-3hgw-8j34
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-r2h5-3hgw-8j34/GHSA-r2h5-3hgw-8j34.json
aliases: []
summary: |
  User data in TPM attestation vulnerable to MITM
  ### Impact
  Attestation *user data* (such as the digest of the public key in an aTLS connection) was bound to the issuer's TPM, but not to its PCR state. An attacker could intercept a node initialization, initialize the node themselves, and then impersonate an uninitialized node to the validator. In practice, this meant that a CSP insider with sufficient privileges would have been able to join a node under their control to a Constellation cluster.

  ### Patches
  The issue has been patched in [v2.5.2](https://github.com/edgelesssys/constellation/releases/tag/v2.5.2).

  ### Workarounds
  none
impacted_packages: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/edgelesssys/constellation
    reference_type:
    reference_id:
  - url: https://github.com/edgelesssys/constellation/releases/tag/v2.5.2
    reference_type:
    reference_id:
  - url: https://github.com/edgelesssys/constellation/security/advisories/GHSA-r2h5-3hgw-8j34
    reference_type:
    reference_id:
