advisory_id: GHSA-rq5c-hvw6-8pr7
datasource_id: github_osv_importer_v2/GHSA-rq5c-hvw6-8pr7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-rq5c-hvw6-8pr7/GHSA-rq5c-hvw6-8pr7.json
aliases:
  - CVE-2023-39348
summary: |
  Improper log output when using GitHub Status Notifications in spinnaker
  ### Impact
  ONLY IMPACTS those use GitHub Status Notifications

  Log output when updating GitHub status is improperly set to FULL always.  It's recommended to apply the patch and rotate the GitHub token used for github status notifications.  Given that this would output github tokens to a log system, the risk is slightly higher than a "low" since token exposure could grant elevated access to repositories outside of control.  If using READ restricted tokens, the exposure is such that the token itself could be used to access resources otherwise restricted from reads.

  ### Patches
  Patch is in progress.  https://github.com/spinnaker/echo/pull/1316

  ### Workarounds
  Disable GH Status Notifications.  Filter your logs for Echo log data.  Use read-only tokens that are limited in scope.

  ### References
  sig-security in slack: https://spinnakerteam.slack.com/archives/CFN8F5UR2
impacted_packages: []
severities:
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-rq5c-hvw6-8pr7/GHSA-rq5c-hvw6-8pr7.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-532
references:
  - url: https://github.com/spinnaker/echo/pull/1316
    reference_type:
    reference_id:
  - url: https://github.com/spinnaker/spinnaker
    reference_type:
    reference_id:
  - url: https://github.com/spinnaker/spinnaker/security/advisories/GHSA-rq5c-hvw6-8pr7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-39348
    reference_type:
    reference_id: CVE-2023-39348
