advisory_id: GHSA-wmx7-x4jp-9jgg
datasource_id: github_osv_importer_v2/GHSA-wmx7-x4jp-9jgg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-wmx7-x4jp-9jgg/GHSA-wmx7-x4jp-9jgg.json
aliases:
  - CVE-2022-41918
summary: |
  OpenSearch has issue with fine-grained access control of indices backing data streams
  ### Impact
  There is an issue with the implementation of fine-grained access control rules (document-level security, field-level security and field masking) where they are not correctly applied to the indices that back data streams potentially leading to incorrect access authorization. This issue can only be triggered by authenticated users authorized to read those data streams which are backed by the impacted indexes. Additionally, existing privileged users cannot access random indexes within these clusters; they can only access indexes to which they have already been granted permission.

  ### Patches
  OpenSearch 1.3.7 and 2.4.0 contain a fix for this issue.

  ### Workarounds
  There is no recommended work around.

  ### For more information
  If you have any questions or comments about this advisory, please contact AWS/Amazon Security via our issue reporting page (https://aws.amazon.com/security/vulnerability-reporting/) or directly via email to aws-security@amazon.com. Please do not create a public GitHub issue.
impacted_packages:
  - purl: pkg:maven/org.opensearch.plugin/opensearch-security
    affected_versions: vers:maven/<1.3.7
    fixed_versions: vers:maven/1.3.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.opensearch.plugin/opensearch-security
    affected_versions: vers:maven/>=2.0.0|<2.4.0
    fixed_versions: vers:maven/2.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-wmx7-x4jp-9jgg/GHSA-wmx7-x4jp-9jgg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
  - CWE-612
references:
  - url: https://github.com/opensearch-project/security
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/security/commit/f7cc569c9d3fa5d5432c76c854eed280d45ce6f4
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/security/security/advisories/GHSA-wmx7-x4jp-9jgg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-41918
    reference_type:
    reference_id: CVE-2022-41918
