advisory_id: GHSA-wp53-j4wj-2cfg
datasource_id: github_osv_importer_v2/GHSA-wp53-j4wj-2cfg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-wp53-j4wj-2cfg/GHSA-wp53-j4wj-2cfg.json
aliases:
  - CVE-2026-24486
summary: "Python-Multipart has Arbitrary File Write via Non-Default Configuration\n### Summary\n\
  \nA Path Traversal vulnerability exists when using non-default configuration options `UPLOAD_DIR`\
  \ and `UPLOAD_KEEP_FILENAME=True`. An attacker can write uploaded files to arbitrary locations\
  \ on the filesystem by crafting a malicious filename.\n\n### Details\n\nWhen `UPLOAD_DIR`\
  \ is set and `UPLOAD_KEEP_FILENAME` is `True`, the library constructs the file path using\
  \ `os.path.join(file_dir, fname)`. Due to the behavior of `os.path.join()`, if the filename\
  \ begins with a `/`, all preceding path components are discarded:\n\n```py\nos.path.join(\"\
  /upload/dir\", \"/etc/malicious\") == \"/etc/malicious\"\n```\n                        \n\
  This allows an attacker to bypass the intended upload directory and write files to arbitrary\
  \ paths.                                         \n                                      \
  \                                                                                        \
  \                \n#### Affected Configuration                                           \
  \                                                                           \n           \
  \                                                                                        \
  \                                           \nProjects are only affected if all of the following\
  \ are true:                                                                              \
  \       \n- `UPLOAD_DIR` is set\n- `UPLOAD_KEEP_FILENAME` is set to True\n- The uploaded file\
  \ exceeds `MAX_MEMORY_FILE_SIZE` (triggering a flush to disk)\n\nThe default configuration\
  \ is not vulnerable.                                                                     \
  \                           \n                                                           \
  \                                                                                   \n####\
  \ Impact                                                                                 \
  \                                                  \n                                    \
  \                                                                                        \
  \                  \nArbitrary file write to attacker-controlled paths on the filesystem.\
  \                                                                        \n              \
  \                                                                                        \
  \                                        \n#### Mitigation                               \
  \                                                                                        \
  \           \n                                                                           \
  \                                                                   \nUpgrade to version 0.0.22,\
  \ or avoid using `UPLOAD_KEEP_FILENAME=True` in project configurations."
impacted_packages:
  - purl: pkg:pypi/python-multipart
    affected_versions: vers:pypi/<0.0.22
    fixed_versions: vers:pypi/0.0.22
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-wp53-j4wj-2cfg/GHSA-wp53-j4wj-2cfg.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/Kludex/python-multipart
    reference_type:
    reference_id:
  - url: https://github.com/Kludex/python-multipart/commit/9433f4bbc9652bdde82bbe380984e32f8cfc89c4
    reference_type:
    reference_id:
  - url: https://github.com/Kludex/python-multipart/releases/tag/0.0.22
    reference_type:
    reference_id:
  - url: https://github.com/Kludex/python-multipart/security/advisories/GHSA-wp53-j4wj-2cfg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-24486
    reference_type:
    reference_id:
