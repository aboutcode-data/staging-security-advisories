advisory_id: GHSA-m4gq-x24j-jpmf
datasource_id: github_osv_importer_v2/GHSA-m4gq-x24j-jpmf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-m4gq-x24j-jpmf/GHSA-m4gq-x24j-jpmf.json
aliases: []
summary: |
  Prototype pollution vulnerability found in Mermaid's bundled version of DOMPurify
  The following bundled files within the Mermaid NPM package contain a bundled version of DOMPurify that is vulnerable to https://github.com/cure53/DOMPurify/security/advisories/GHSA-mmhx-hmjr-r674, potentially resulting in an XSS attack.

  This affects the built:

  - `dist/mermaid.min.js`
  - `dist/mermaid.js`
  - `dist/mermaid.esm.mjs`
  - `dist/mermaid.esm.min.mjs`

  This will also affect users that use the above files via a CDN link, e.g. `https://cdn.jsdelivr.net/npm/mermaid@10.9.2/dist/mermaid.min.js`

  **Users that use the default NPM export of `mermaid`, e.g. `import mermaid from 'mermaid'`, or the `dist/mermaid.core.mjs` file, do not use this bundled version of DOMPurify, and can easily update using their package manager with something like `npm audit fix`.**

  ### Patches

  - `develop` branch: 6c785c93166c151d27d328ddf68a13d9d65adc00
  - backport to v10: 92a07ffe40aab2769dd1c3431b4eb5beac282b34
impacted_packages:
  - purl: pkg:npm/mermaid
    affected_versions: vers:npm/<=10.9.2
    fixed_versions: vers:npm/10.9.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-m4gq-x24j-jpmf/GHSA-m4gq-x24j-jpmf.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1395
  - CWE-1321
references:
  - url: https://github.com/cure53/DOMPurify/security/advisories/GHSA-mmhx-hmjr-r674
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/commit/6c785c93166c151d27d328ddf68a13d9d65adc00
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/commit/92a07ffe40aab2769dd1c3431b4eb5beac282b34
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-m4gq-x24j-jpmf
    reference_type:
    reference_id:
