advisory_id: GHSA-qwx8-mxxx-mg96
datasource_id: github_osv_importer_v2/GHSA-qwx8-mxxx-mg96
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-qwx8-mxxx-mg96/GHSA-qwx8-mxxx-mg96.json
aliases:
  - CVE-2023-0609
summary: |
  wallabag contains Improper Authorization via export feature
  # Description

  The export feature lets a user export a single entry or a set of entries in a given format (_e.g. PDF, MOBI, TXT_).

  For example, `https://yourinstance.wallabag.org/export/45.pdf` will export the entry with id 45 in PDF format.

  Since wallabag 2.0.0-alpha.1, this feature is vulnerable to an insecure direct object reference attack. A logged user can export any single entry without ownership validation.

  This is due to a lack of access validation in the `downloadEntryAction` method.

  **You should immediately patch your instance to version 2.5.3 or higher if you have more than one user and/or having open registration.**

  # Resolution

  A user check is now done in the vulnerable method before sending the exported entry.

  The `Entry` retrieval through a `ParamConverter` has also been replaced with a call to the `EntryRepository` in order to prevent any information disclosure through response discrepancy.

  # Workaround

  If you are unable to update to the latest version or if you want to temporarily limit risk of exploitation, you may consider blocking requests to the endpoint `/export/*`.

  E.g. with nginx:

  ``` nginx
      location /export {
          deny all;
      }
  ```

  # Credits

  We would like to thank @bAuh0lz for reporting this issue through huntr.dev.

  Reference: https://www.huntr.dev/bounties/3adef66f-fc86-4e6d-a540-2ffa59342ff0/
impacted_packages:
  - purl: pkg:composer/wallabag/wallabag
    affected_versions: vers:composer/>=2.0.0-alpha.1|<2.5.3
    fixed_versions: vers:composer/2.5.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-qwx8-mxxx-mg96/GHSA-qwx8-mxxx-mg96.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
references:
  - url: https://github.com/wallabag/wallabag
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/0f7460dbab9e29f4f7d2944aca20210f828b6abb
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/security/advisories/GHSA-qwx8-mxxx-mg96
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/3adef66f-fc86-4e6d-a540-2ffa59342ff0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-0609
    reference_type:
    reference_id: CVE-2023-0609
