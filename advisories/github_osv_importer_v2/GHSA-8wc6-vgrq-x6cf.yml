advisory_id: GHSA-8wc6-vgrq-x6cf
datasource_id: github_osv_importer_v2/GHSA-8wc6-vgrq-x6cf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-8wc6-vgrq-x6cf/GHSA-8wc6-vgrq-x6cf.json
aliases: []
summary: "Child processes spawned by Renovate incorrectly have full access to environment variables\n\
  When Renovate spawns child processes, their access to environment variables is filtered to\
  \ an allowlist, to prevent unauthorized access to privileged credentials that the Renovate\
  \ process has access to.\n\nSince [42.68.1](https://github.com/renovatebot/renovate/releases/tag/42.68.1)\
  \ (2025-12-30), this filtering had been **inadvertently removed**, and so any child processes\
  \ spawned from these versions will have had access to any environment variables that Renovate\
  \ has access to.\n\nThis could lead to [insider attackers](https://docs.renovatebot.com/security-and-permissions/#execution-of-code-insider-attack)\
  \ and [outside attackers](https://docs.renovatebot.com/security-and-permissions/#execution-of-code-outsider-attack)\
  \ being able to exflitrate secrets from the Renovate deployment.\n\nIt is recommended to rotate\
  \ (+ revoke) any credentials that Renovate has access to, in case any spawned child processes\
  \ have attempted to exfiltrate any secrets.\n\n## Impact\n\nChild processes spawned by Renovate\
  \ (i.e. `npm install`, anything defined in [`postUpgradeTasks`](https://docs.renovatebot.com/configuration-options/#postupgradetasks)\
  \ or [`postUpdateOptions`](https://docs.renovatebot.com/configuration-options/#postupdateoptions))\
  \ will have full access to the environment variables that the Renovate process has. \n\nThis\
  \ could lead to [insider attackers](https://docs.renovatebot.com/security-and-permissions/#execution-of-code-insider-attack)\
  \ and [outside attackers](https://docs.renovatebot.com/security-and-permissions/#execution-of-code-outsider-attack)\
  \ being able to exflitrate secrets from the Renovate deployment.\n\n## Patches\n\nThis is\
  \ patched in [42.96.3](https://github.com/renovatebot/renovate/releases/tag/42.96.3) and [43.4.4](https://github.com/renovatebot/renovate/releases/tag/43.4.4).\n\
  \n## Workarounds\n\nThere are no workarounds, other than upgrading your Renovate version.\n\
  \n## Why did this happen?\n\nAs part of work towards https://github.com/renovatebot/renovate/security/advisories/GHSA-pfq2-hh62-7m96,\
  \ one of the [preparatory changes](https://github.com/renovatebot/renovate/pull/40212) we\
  \ made was moving to [`execa`](https://www.npmjs.com/package/execa).\n\nOne of the default\
  \ behaviours of `execa` is to [extend the process' environment variables with any new ones](https://github.com/sindresorhus/execa/tree/v8.0.1?tab=readme-ov-file#extendenv),\
  \ rather than override them.\n\nThis was missed in code review, which meant that since this\
  \ version, the full environment variables have been provided to any child processes spawned\
  \ with `execa` by Renovate.\n\nThis was discovered as part of an unrelated change."
impacted_packages:
  - purl: pkg:npm/renovate
    affected_versions: vers:npm/>=42.68.1|<42.96.3
    fixed_versions: vers:npm/42.96.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/renovate
    affected_versions: vers:npm/>=43.0.0|<43.4.4
    fixed_versions: vers:npm/43.4.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-8wc6-vgrq-x6cf/GHSA-8wc6-vgrq-x6cf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/renovatebot/renovate
    reference_type:
    reference_id:
  - url: https://github.com/renovatebot/renovate/releases/tag/42.96.3
    reference_type:
    reference_id:
  - url: https://github.com/renovatebot/renovate/releases/tag/43.4.4
    reference_type:
    reference_id:
  - url: https://github.com/renovatebot/renovate/security/advisories/GHSA-8wc6-vgrq-x6cf
    reference_type:
    reference_id:
