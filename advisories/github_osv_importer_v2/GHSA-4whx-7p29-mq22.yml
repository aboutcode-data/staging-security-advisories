advisory_id: GHSA-4whx-7p29-mq22
datasource_id: github_osv_importer_v2/GHSA-4whx-7p29-mq22
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-4whx-7p29-mq22/GHSA-4whx-7p29-mq22.json
aliases:
  - CVE-2022-31011
summary: |
  TiDB authentication bypass vulnerability
  ### Impact
  Under certain conditions, an attacker can construct malicious authentication requests to bypass the authentication process, resulting in privilege escalation or unauthorized access.
  Only users using TiDB 5.3.0 are affected by this vulnerability.

  ### Patches
  Please upgrade to TiDB 5.3.1 or higher version

  ### Workarounds
  You can also mitigate risks by taking the following measures.
  Option 1: Turn off SEM (Security Enhanced Mode).
  Option 2: Disable local login for non-root accounts and ensure that the same IP cannot be logged in as root or normal user at the same time.

  ### References
  https://en.pingcap.com/download/

  ### For more information
  If you have any questions or comments about this advisory:
  * Email us at security@tidb.io
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-4whx-7p29-mq22/GHSA-4whx-7p29-mq22.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/pingcap/tidb
    reference_type:
    reference_id:
  - url: https://github.com/pingcap/tidb/releases/tag/v5.3.1
    reference_type:
    reference_id:
  - url: https://github.com/pingcap/tidb/security/advisories/GHSA-4whx-7p29-mq22
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31011
    reference_type:
    reference_id: CVE-2022-31011
