advisory_id: GHSA-fg47-3c2x-m2wr
datasource_id: github_osv_importer_v2/GHSA-fg47-3c2x-m2wr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-fg47-3c2x-m2wr/GHSA-fg47-3c2x-m2wr.json
aliases:
  - CVE-2021-39167
summary: |
  TimelockController vulnerability in OpenZeppelin Contracts
  ### Impact

  A vulnerability in `TimelockController` allowed an actor with the executor role to take immediate control of the timelock, by resetting the delay to 0 and escalating privileges, thus gaining unrestricted access to assets held in the contract. Instances with the executor role set to "open" allow anyone to use the executor role, thus leaving the timelock at risk of being taken over by an attacker.

  ### Patches

  A fix is included in the following releases of `@openzeppelin/contracts` and `@openzeppelin/contracts-upgradeable`:
  - 4.3.1
  - 3.4.2
  - 3.4.2-solc-0.7

  Deployed instances of `TimelockController` should be replaced with a fixed version by migrating all assets, ownership, and roles.

  ### Workarounds

  Revoke the executor role from accounts not strictly under the team's control. We recommend revoking all executors that are not also proposers. When applying this mitigation, ensure there is at least one proposer and executor remaining.

  ### References

  [Post-mortem](https://forum.openzeppelin.com/t/timelockcontroller-vulnerability-postmortem/14958).

  ### Credits

  The issue was identified by an anonymous white hat hacker through [Immunefi](https://immunefi.com/).

  ### For more information

  If you have any questions or comments about this advisory, or need assistance executing the mitigation, email us at security@openzeppelin.com.
impacted_packages:
  - purl: pkg:npm/%40openzeppelin/contracts
    affected_versions: vers:npm/>=4.0.0|<4.3.1
    fixed_versions: vers:npm/4.3.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40openzeppelin/contracts
    affected_versions: vers:npm/>=3.3.0|<3.4.2
    fixed_versions: vers:npm/3.4.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-fg47-3c2x-m2wr/GHSA-fg47-3c2x-m2wr.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/CHANGELOG.md#431
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/commit/cec4f2ef57495d8b1742d62846da212515d99dd5
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-fg47-3c2x-m2wr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39167
    reference_type:
    reference_id: CVE-2021-39167
