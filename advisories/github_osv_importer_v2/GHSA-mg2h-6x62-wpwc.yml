advisory_id: GHSA-mg2h-6x62-wpwc
datasource_id: github_osv_importer_v2/GHSA-mg2h-6x62-wpwc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-mg2h-6x62-wpwc/GHSA-mg2h-6x62-wpwc.json
aliases:
  - CVE-2025-32442
summary: |
  Fastify vulnerable to invalid content-type parsing, which could lead to validation bypass
  ### Impact

  In applications that specify different validation strategies for different content types, it's possible to bypass the validation by providing a _slightly altered_ content type such as with different casing or altered whitespacing before `;`.

  Users using the the following pattern are affected:

  ```js
  fastify.post('/', {
    handler(request, reply) {
      reply.code(200).send(request.body)
    },
    schema: {
      body: {
        content: {
          'application/json': {
            schema: {
              type: 'object',
              properties: {
                'foo': {
                  type: 'string',
                }
              },
              required: ['foo']
            }
          },
        }
      }
    }
  })
  ```

  User using the following pattern are **not** affected:

  ```js
  fastify.post('/', {
    handler(request, reply) {
      reply.code(200).send(request.body)
    },
    schema: {
      body: {
        type: 'object',
        properties: {
          'foo': {
            type: 'string',
          }
        },
        required: ['foo']
      }
    }
  })
  ```

  ### Patches

  This was patched in v5.3.1, but unfortunately it did not cover all problems. This has been fully patched in v5.3.2.
  Version v4.9.0 was also affected by this issue. This has been fully patched in v4.9.1.

  ### Workarounds

  Do not specify multiple content types in the schema.

  ### References
  _Are there any links users can visit to find out more?_

  https://hackerone.com/reports/3087928
impacted_packages:
  - purl: pkg:npm/fastify
    affected_versions: vers:npm/<=5.3.1
    fixed_versions: vers:npm/5.3.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/fastify
    affected_versions: vers:npm/4.29.0
    fixed_versions: vers:npm/4.29.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-mg2h-6x62-wpwc/GHSA-mg2h-6x62-wpwc.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1287
references:
  - url: https://github.com/fastify/fastify
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify/commit/436da4c06dfbbb8c24adee3a64de0c51e4f47418
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify/commit/f3d2bcb3963cd570a582e5d39aab01a9ae692fe4
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify/security/advisories/GHSA-mg2h-6x62-wpwc
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/3087928
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32442
    reference_type:
    reference_id: CVE-2025-32442
