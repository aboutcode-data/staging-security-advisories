advisory_id: GHSA-496g-mmpw-j9x3
datasource_id: github_osv_importer_v2/GHSA-496g-mmpw-j9x3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-496g-mmpw-j9x3/GHSA-496g-mmpw-j9x3.json
aliases:
  - CVE-2025-66402
summary: |
  misskey.js's export data contains private post data
  ### Summary

  After adding private posts (followers, direct) that you do not have permission to view to your favorites or clips, you can export them to view the contents of the private posts.

  ### PoC

  1. Create an account (X) for testing and an account (Y) for private posts on the same server.
  2. Send appropriate content from Y using "Follow"
  3. Send appropriate content to any user using "Nominate" from Y
  4. Obtain the URLs for the two posts above using Y's account.
  5. Query the URLs for the two posts using X and add them to your favorites or clips.
  6. Export your favorites or clips using X.
  7. Check the exported data.

  Note: Verified in v2025.11.1

  ### Impact

  This could allow an attacker to view the contents of private posts.
  If you have pinned private posts, this could be a real problem, as the ID of the private post can be obtained by viewing the user page on the original server.
impacted_packages:
  - purl: pkg:npm/misskey-js
    affected_versions: vers:npm/>=13.0.0-beta.16|<2025.12.0
    fixed_versions: vers:npm/2025.12.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-496g-mmpw-j9x3/GHSA-496g-mmpw-j9x3.json
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-496g-mmpw-j9x3/GHSA-496g-mmpw-j9x3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/misskey-dev/misskey
    reference_type:
    reference_id:
  - url: https://github.com/misskey-dev/misskey/commit/dc77d59f8712d3fe0b73cd4af2035133839cd57b
    reference_type:
    reference_id:
  - url: https://github.com/misskey-dev/misskey/security/advisories/GHSA-496g-mmpw-j9x3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66402
    reference_type:
    reference_id:
