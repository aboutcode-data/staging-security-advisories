advisory_id: GHSA-6qqj-rx4w-r3cj
datasource_id: github_osv_importer_v2/GHSA-6qqj-rx4w-r3cj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/08/GHSA-6qqj-rx4w-r3cj/GHSA-6qqj-rx4w-r3cj.json
aliases: []
summary: |
  CSRF Vulnerability in jquery-ujs
  Versions 1.0.3 and earlier of jquery-ujs are vulnerable to an information leakage attack that may enable attackers to launch CSRF attacks, as it allows attackers to send CSRF tokens to external domains.

  When an attacker controls the href attribute of an anchor tag, or
  the action attribute of a form tag triggering a POST action, the attacker can set the
  href or action to " https://attacker.com". By prepending a space to the external domain, it causes jQuery to consider it a same origin request, resulting in the user's CSRF token being sent to the external domain.


  ## Recommendation

  Upgrade jquery-ujs to version 1.0.4 or later.
impacted_packages:
  - purl: pkg:npm/jquery-ujs
    affected_versions: vers:npm/<=1.0.3
    fixed_versions: vers:npm/1.0.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/08/GHSA-6qqj-rx4w-r3cj/GHSA-6qqj-rx4w-r3cj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://groups.google.com/forum/#!msg/rubyonrails-security/XIZPbobuwaY/fqnzzpuOlA4J
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/49935
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/npm:jquery-ujs:20150624
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/15
    reference_type:
    reference_id:
