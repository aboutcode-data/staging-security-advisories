advisory_id: GHSA-vfpf-xmwh-8m65
datasource_id: github_osv_importer_v2/GHSA-vfpf-xmwh-8m65
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-vfpf-xmwh-8m65/GHSA-vfpf-xmwh-8m65.json
aliases: []
summary: |
  Duplicate Advisory: ProsemirrorToHtml has a Cross-Site Scripting (XSS) vulnerability through unescaped HTML attribute values
  ## Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-52c5-vh7f-26fx. This link is maintained to preserve external references.

  ## Original Description

  ### Impact

  The prosemirror_to_html gem is vulnerable to Cross-Site Scripting
  (XSS) attacks through malicious HTML attribute values. While tag
  content is properly escaped, attribute values are not, allowing
  attackers to inject arbitrary JavaScript code.

  **Who is impacted:**

  - Any application using prosemirror_to_html to convert ProseMirror
    documents to HTML
  - Applications that process user-generated ProseMirror content are
    at highest risk
  - End users viewing the rendered HTML output could have malicious
   JavaScript executed in their browsers

  **Attack vectors include:**

  - `href` attributes with `javascript:` protocol:
    `<a href="javascript:alert(document.cookie)">`
  - Event handlers: `<div onclick="maliciousCode()">`
  - `onerror` attributes on images: `<img src=x onerror="alert('XSS')">`
  - Other HTML attributes that can execute JavaScript

  ### Patches

  A fix is currently in development. Users should upgrade to version
  **0.2.1** or later once released.

  The patch escapes all HTML attribute values using `CGI.escapeHTML`
  to prevent injection attacks.

  ### Workarounds

  Until a patched version is available, users can implement one or
  more of these mitigations:

  1. **Sanitize output**: Pass the HTML output through a sanitization
     library like [Sanitize](https://github.com/rgrove/sanitize) or
     [Loofah](https://github.com/flavorjones/loofah):

  ```ruby
     html = ProsemirrorToHtml.render(document)
     safe_html = Sanitize.fragment(html, Sanitize::Config::RELAXED)
  ```

  2. **Implement Content Security Policy (CSP)**: Add strict CSP
     headers to prevent inline JavaScript execution:
  ```
     Content-Security-Policy: default-src 'self'; script-src 'self'
  ```

  3. **Input validation**: If possible, validate and sanitize
     ProseMirror documents before conversion to prevent malicious
     content from entering the system.

  ### References

  - Vulnerable code: https://github.com/etaminstudio/prosemirror_to_html/blob/ea8beb32f6c37f29f042ba4155ccf18504da716e/lib/prosemirror_to_html.rb#L249
  - [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)
impacted_packages:
  - purl: pkg:gem/prosemirror_to_html
    affected_versions: vers:gem/<0.2.1
    fixed_versions: vers:gem/0.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-vfpf-xmwh-8m65/GHSA-vfpf-xmwh-8m65.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/etaminstudio/prosemirror_to_html
    reference_type:
    reference_id:
  - url: https://github.com/etaminstudio/prosemirror_to_html/blob/ea8beb32f6c37f29f042ba4155ccf18504da716e/lib/prosemirror_to_html.rb#L249
    reference_type:
    reference_id:
  - url: https://github.com/etaminstudio/prosemirror_to_html/commit/4d59f94f550bcabeec30d298791bbdd883298ad8
    reference_type:
    reference_id:
  - url: https://github.com/etaminstudio/prosemirror_to_html/security/advisories/GHSA-52c5-vh7f-26fx
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/prosemirror_to_html/GHSA-52c5-vh7f-26fx.yml
    reference_type:
    reference_id:
