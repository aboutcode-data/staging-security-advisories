advisory_id: GHSA-xrc4-737v-9q75
datasource_id: github_osv_importer_v2/GHSA-xrc4-737v-9q75
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-xrc4-737v-9q75/GHSA-xrc4-737v-9q75.json
aliases:
  - CVE-2022-31198
summary: |
  OpenZeppelin Contracts's GovernorVotesQuorumFraction updates to quorum may affect past defeated proposals
  ### Impact

  This issue concerns instances of Governor that use the module `GovernorVotesQuorumFraction`, a mechanism that determines quorum requirements as a percentage of the voting token's total supply. In affected instances, when a proposal is passed to lower the quorum requirement, past proposals may become executable if they had been defeated only due to lack of quorum, and the number of votes it received meets the new quorum requirement.

  Analysis of instances on chain found only one proposal that met this condition, and we are actively monitoring for new occurrences of this particular issue.

  ### Patches

  This issue has been patched in v4.7.2.

  ### Workarounds

  Avoid lowering quorum requirements if a past proposal was defeated for lack of quorum.

  ### References

  https://github.com/OpenZeppelin/openzeppelin-contracts/pull/3561

  ### For more information

  If you have any questions or comments about this advisory, or need assistance deploying the fix, email us at [security@openzeppelin.com](mailto:security@openzeppelin.com).
impacted_packages:
  - purl: pkg:npm/%40openzeppelin/contracts
    affected_versions: vers:npm/>=4.3.0|<4.7.2
    fixed_versions: vers:npm/4.7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40openzeppelin/contracts-upgradeable
    affected_versions: vers:npm/>=4.3.0|<4.7.2
    fixed_versions: vers:npm/4.7.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-xrc4-737v-9q75/GHSA-xrc4-737v-9q75.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-682
references:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/pull/3561
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.7.2
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-xrc4-737v-9q75
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31198
    reference_type:
    reference_id: CVE-2022-31198
