advisory_id: GHSA-64qm-hrgp-pgr9
datasource_id: github_osv_importer_v2/GHSA-64qm-hrgp-pgr9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-64qm-hrgp-pgr9/GHSA-64qm-hrgp-pgr9.json
aliases:
  - CVE-2022-31033
summary: |
  Mechanize before v2.8.5 vulnerable to authorization header leak on port redirect
  **Summary**

  Mechanize (rubygem) `< v2.8.5` leaks the `Authorization` header after a redirect to a different port on the same site.

  **Mitigation**

  Upgrade to Mechanize v2.8.5 or later.

  **Notes**

  See [https://curl.se/docs/CVE-2022-27776.html](CVE-2022-27776) for a similar vulnerability in curl.

  Cookies are shared with a server at a different port on the same site, per https://datatracker.ietf.org/doc/html/rfc6265#section-8.5 which states in part:

  > Cookies do not provide isolation by port.  If a cookie is readable
  > by a service running on one port, the cookie is also readable by a
  > service running on another port of the same server.  If a cookie is
  > writable by a service on one port, the cookie is also writable by a
  > service running on another port of the same server.  For this
  > reason, servers SHOULD NOT both run mutually distrusting services on
  > different ports of the same host and use cookies to store security-
  > sensitive information.
impacted_packages:
  - purl: pkg:gem/mechanize
    affected_versions: vers:gem/<2.8.5
    fixed_versions: vers:gem/2.8.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-64qm-hrgp-pgr9/GHSA-64qm-hrgp-pgr9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-522
  - CWE-200
references:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/mechanize/CVE-2022-31033.yml
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/mechanize
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/mechanize/commit/c7fe6996a5b95f9880653ba3bc548a8d4ef72317
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/mechanize/security/advisories/GHSA-64qm-hrgp-pgr9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31033
    reference_type:
    reference_id: CVE-2022-31033
