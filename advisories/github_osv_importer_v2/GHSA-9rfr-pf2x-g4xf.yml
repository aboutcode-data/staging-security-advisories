advisory_id: GHSA-9rfr-pf2x-g4xf
datasource_id: github_osv_importer_v2/GHSA-9rfr-pf2x-g4xf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-9rfr-pf2x-g4xf/GHSA-9rfr-pf2x-g4xf.json
aliases:
  - CVE-2024-23640
summary: |
  GeoServer's Style Publisher vulnerable to Stored Cross-Site Scripting (XSS)
  ### Summary
  A stored cross-site scripting (XSS) vulnerability exists that enables an authenticated administrator with workspace-level privileges to store a JavaScript payload in uploaded style/legend resources or in a specially crafted datastore file that will execute in the context of another user's browser when viewed in the Style Publisher.  Access to the Style Publisher is available to all users although data security may limit users' ability to trigger the XSS.

  ### Details
  _Give all details on the vulnerability. Pointing to the incriminated source code is very helpful for the maintainer._

  ### PoC
  _Complete instructions, including specific configuration details, to reproduce the vulnerability._

  ### Impact
  If an attacker can control a script that is executed in the victim's browser, then they can typically fully compromise that user. Amongst other things, the attacker can:

  1 .Perform any action within the application that the user can perform.
  2. View any information that the user is able to view.
  3. Modify any information that the user is able to modify.
  4. Initiate interactions with other application users, including malicious attacks, that will appear to originate from the initial victim user.

  ### References
  https://osgeo-org.atlassian.net/browse/GEOS-11149
  https://github.com/geoserver/geoserver/pull/7162
  https://osgeo-org.atlassian.net/browse/GEOS-11155
  https://github.com/geoserver/geoserver/pull/7181
impacted_packages:
  - purl: pkg:maven/org.geoserver/gs-main
    affected_versions: vers:maven/<2.23.3
    fixed_versions: vers:maven/2.23.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.geoserver/gs-ows
    affected_versions: vers:maven/<2.23.3
    fixed_versions: vers:maven/2.23.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-9rfr-pf2x-g4xf/GHSA-9rfr-pf2x-g4xf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/geoserver/geoserver
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/pull/7162
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/pull/7181
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/security/advisories/GHSA-9rfr-pf2x-g4xf
    reference_type:
    reference_id:
  - url: https://osgeo-org.atlassian.net/browse/GEOS-11149
    reference_type:
    reference_id:
  - url: https://osgeo-org.atlassian.net/browse/GEOS-11155
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23640
    reference_type:
    reference_id: CVE-2024-23640
