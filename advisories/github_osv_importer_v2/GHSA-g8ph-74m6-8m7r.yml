advisory_id: GHSA-g8ph-74m6-8m7r
datasource_id: github_osv_importer_v2/GHSA-g8ph-74m6-8m7r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-g8ph-74m6-8m7r/GHSA-g8ph-74m6-8m7r.json
aliases:
  - CVE-2024-23689
summary: |
  ClickHouse vulnerable to client certificate password exposure in client exception
  ### Summary
  As initially reported in issue #1331, when client certificate authentication is enabled with password protection, the password (referred to as the client option `sslkey`) may be exposed in client exceptions (e.g., ClickHouseException or SQLException). This vulnerability can potentially lead to unauthorized access, data breaches, and violations of user privacy.

  ### Details
  During the handling of ClickHouseException, the client certificate password may be inadvertently exposed when sslkey is specified. This issue can arise when an exception is thrown during the execution of a query or a database operation. The client certificate password is then included in the exception message, which could be logged or exposed to unauthorized parties.

  ### Impact
  This vulnerability enables an attacker with access to client exception error messages or logs to obtain client certificate passwords, potentially allowing unauthorized access to sensitive information, data manipulation, and denial of service attacks. The extent of the risk depends on the specific implementation and usage of the affected systems. However, any exposure of client certificate passwords should be treated as a high-priority security concern.
impacted_packages:
  - purl: pkg:maven/com.clickhouse/clickhouse-client
    affected_versions: vers:maven/<0.4.6
    fixed_versions: vers:maven/0.4.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.clickhouse/clickhouse-jdbc
    affected_versions: vers:maven/<0.4.6
    fixed_versions: vers:maven/0.4.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.clickhouse/clickhouse-r2dbc
    affected_versions: vers:maven/<0.4.6
    fixed_versions: vers:maven/0.4.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-g8ph-74m6-8m7r/GHSA-g8ph-74m6-8m7r.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-209
references:
  - url: https://github.com/ClickHouse/clickhouse-java
    reference_type:
    reference_id:
  - url: https://github.com/ClickHouse/clickhouse-java/issues/1331
    reference_type:
    reference_id:
  - url: https://github.com/ClickHouse/clickhouse-java/pull/1334
    reference_type:
    reference_id:
  - url: https://github.com/ClickHouse/clickhouse-java/releases/tag/v0.4.6
    reference_type:
    reference_id:
  - url: https://github.com/ClickHouse/clickhouse-java/security/advisories/GHSA-g8ph-74m6-8m7r
    reference_type:
    reference_id:
  - url: https://vulncheck.com/advisories/vc-advisory-GHSA-g8ph-74m6-8m7r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23689
    reference_type:
    reference_id: CVE-2024-23689
