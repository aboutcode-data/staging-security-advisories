advisory_id: GHSA-4w8r-3xrw-v25g
datasource_id: github_osv_importer_v2/GHSA-4w8r-3xrw-v25g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-4w8r-3xrw-v25g/GHSA-4w8r-3xrw-v25g.json
aliases:
  - CVE-2023-41892
summary: "Craft CMS Remote Code Execution vulnerability\n### Impact\n\nThis is a high-impact,\
  \ low-complexity attack vector. Users running Craft installations before 4.4.15 are encouraged\
  \ to update to at least that version to mitigate the issue. \n\n### Mitigations\n\n* This\
  \ has been fixed in Craft 4.4.15. You should ensure youâ€™re running at least that version.\n\
  * Refresh your security key in case it has already been captured. You can do that by running\
  \ the `php craft setup/security-key` command and copying the updated `CRAFT_SECURITY_KEY`\
  \ environment variable to all production environments.\n* If you have any other private keys\
  \ stored as environment variables (e.g., S3 or Stripe), refresh those as well.\n* Out of an\
  \ abundance of caution, you may want to force all your users to reset their passwords in case\
  \ your database was compromised. You can do that by running `php craft resave/users --set\
  \ passwordResetRequired --to \"fn() => true\"`.\n\n### References\n\nhttps://github.com/craftcms/cms/commit/c0a37e15cc925c473e60e27fe64054993b867ac1#diff-47dd43d86f85161944dfcce2e41d31955c4184672d9bd9d82b948c6b01b86476\n\
  \nhttps://github.com/craftcms/cms/commit/7359d18d46389ffac86c2af1e0cd59e37c298857\n\nhttps://github.com/craftcms/cms/commit/a270b928f3d34ad3bd953b81c304424edd57355e\n\
  \nhttps://github.com/craftcms/cms/blob/develop/CHANGELOG.md#4415---2023-07-03-critical"
impacted_packages:
  - purl: pkg:composer/craftcms/cms
    affected_versions: vers:composer/<=4.4.14
    fixed_versions: vers:composer/4.4.15
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-4w8r-3xrw-v25g/GHSA-4w8r-3xrw-v25g.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: http://packetstormsecurity.com/files/176303/Craft-CMS-4.4.14-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/blob/develop/CHANGELOG.md#4415---2023-07-03-critical
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/commit/7359d18d46389ffac86c2af1e0cd59e37c298857
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/commit/a270b928f3d34ad3bd953b81c304424edd57355e
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/commit/c0a37e15cc925c473e60e27fe64054993b867ac1
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/commit/c0a37e15cc925c473e60e27fe64054993b867ac1#diff-47dd43d86f85161944dfcce2e41d31955c4184672d9bd9d82b948c6b01b86476
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/security/advisories/GHSA-4w8r-3xrw-v25g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41892
    reference_type:
    reference_id: CVE-2023-41892
