advisory_id: GHSA-xwf3-6rgv-939r
datasource_id: github_osv_importer_v2/GHSA-xwf3-6rgv-939r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-xwf3-6rgv-939r/GHSA-xwf3-6rgv-939r.json
aliases:
  - CVE-2022-36035
summary: |
  Flux CLI Workload Injection
  Flux CLI allows users to deploy Flux components into a Kubernetes cluster via command-line. The vulnerability allows other applications to replace the Flux deployment information with arbitrary content which is deployed into the target Kubernetes cluster instead.

  The vulnerability is due to the improper handling of user-supplied input, which results in a path traversal that can be controlled by the attacker.

  ### Impact
  Users sharing the same shell between other applications and the Flux CLI commands could be affected by this vulnerability.

  In some scenarios no errors may be presented, which may cause end users not to realise that something is amiss.

  ### Workarounds

  A safe workaround is to execute Flux CLI in ephemeral and isolated shell environments, which can ensure no persistent values exist from previous processes. However, upgrading to the latest version of the CLI is still the recommended mitigation strategy.

  ### Credits
  The Flux engineering team found and patched this vulnerability.

  ### For more information

  If you have any questions or comments about this advisory:
  - Open an issue in any of the affected repositories.
  - Contact us at the CNCF Flux Channel.
impacted_packages: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-xwf3-6rgv-939r/GHSA-xwf3-6rgv-939r.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/fluxcd/flux2
    reference_type:
    reference_id:
  - url: https://github.com/fluxcd/flux2/releases/tag/v0.32.0
    reference_type:
    reference_id:
  - url: https://github.com/fluxcd/flux2/security/advisories/GHSA-xwf3-6rgv-939r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-36035
    reference_type:
    reference_id: CVE-2022-36035
