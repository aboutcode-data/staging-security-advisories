advisory_id: GHSA-jgm9-xpfj-4fq6
datasource_id: github_osv_importer_v2/GHSA-jgm9-xpfj-4fq6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-jgm9-xpfj-4fq6/GHSA-jgm9-xpfj-4fq6.json
aliases:
  - CVE-2022-21693
summary: |
  Path traversal in Onionshare
  Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.

  - Vulnerability ID: OTF-013
  - Vulnerability type: Improper Hardening
  - Threat level: Low

  ## Description:

  The filesystem restriction could be hardened and should only allow for pre-defined subfolders.

  ## Technical description:

  The Flatpak and Snap configurations allow for read-only access on the whole home folder. The relevant lines in the configuration files are `onionshare/snap/snapcraft.yaml#L20` and `onionshare/flatpak/org.onionshare.OnionShare.yaml#L19` , respectively.

  The encapsulation of filesystem access via these mechanisms should be restricted to pre-defined folders and not allow for access to (configuration) files outside the Onionshare-specific folders.

  Sadly Snap does not allow for further restriction to specific folders and therefore cannot be further hardened. By default both frameworks disallow access to hidden folders and therefore reduce the potential impact.

  ## Impact:

  An adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced.

  ## Recommendation:

  - Reduce read access in Flatpak configuration.
impacted_packages:
  - purl: pkg:pypi/onionshare-cli
    affected_versions: vers:pypi/>=2.3|<2.5
    fixed_versions: vers:pypi/2.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-jgm9-xpfj-4fq6/GHSA-jgm9-xpfj-4fq6.json
  - score: '4.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-jgm9-xpfj-4fq6/GHSA-jgm9-xpfj-4fq6.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/onionshare/onionshare
    reference_type:
    reference_id:
  - url: https://github.com/onionshare/onionshare/releases/tag/v2.5
    reference_type:
    reference_id:
  - url: https://github.com/onionshare/onionshare/security/advisories/GHSA-jgm9-xpfj-4fq6
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/onionshare-cli/PYSEC-2022-44.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21693
    reference_type:
    reference_id: CVE-2022-21693
