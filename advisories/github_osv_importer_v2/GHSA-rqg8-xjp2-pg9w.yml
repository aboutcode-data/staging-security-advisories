advisory_id: GHSA-rqg8-xjp2-pg9w
datasource_id: github_osv_importer_v2/GHSA-rqg8-xjp2-pg9w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-rqg8-xjp2-pg9w/GHSA-rqg8-xjp2-pg9w.json
aliases:
  - CVE-2019-12887
summary: |
  LinOTP replay vulnerability with auto resynchronization enabled for TOTP token
  LinOTP is prone to a replay attack with activated automatic resynchronization. This vulnerability may allow an attacker to successfully log in with OTP values recorded at a previous point in time.

  This attack is only possible if automatic resynchronization is enabled for the TOTP token type. The automatic resynchronization  is deactivated by default. All other tokens are unaffected.
impacted_packages:
  - purl: pkg:pypi/linotp
    affected_versions: vers:pypi/<2.11.1
    fixed_versions: vers:pypi/2.11.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-rqg8-xjp2-pg9w/GHSA-rqg8-xjp2-pg9w.json
  - score: '9.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-rqg8-xjp2-pg9w/GHSA-rqg8-xjp2-pg9w.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-294
references:
  - url: https://github.com/LinOTP/LinOTP
    reference_type:
    reference_id:
  - url: https://github.com/LinOTP/LinOTP/commit/6d28d93af59d2ce0d844a6a3282148064efc6ad8
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/linotp/PYSEC-2019-103.yaml
    reference_type:
    reference_id:
  - url: https://linotp.org/linotp-hotfix-autoresync.html
    reference_type:
    reference_id:
  - url: https://www.linotp.org/CVE-2019-12887.txt
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-12887
    reference_type:
    reference_id: CVE-2019-12887
