advisory_id: GHSA-9f29-v6mm-pw6w
datasource_id: github_osv_importer_v2/GHSA-9f29-v6mm-pw6w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-9f29-v6mm-pw6w/GHSA-9f29-v6mm-pw6w.json
aliases:
  - CVE-2026-26205
summary: "opa-envoy-plugin has an Authorization Bypass via Double-Slash Path Misinterpretation\
  \ in input.parsed_path\nA security vulnerability has been discovered in how the `input.parsed_path`\
  \ field is constructed. HTTP request paths are treated as full URIs when parsed; interpreting\
  \ leading path segments prefixed with double slashes (`//`) as [authority](https://datatracker.ietf.org/doc/html/rfc3986#section-3.2)\
  \ components, and therefore dropping them from the parsed path. This creates a path interpretation\
  \ mismatch between authorization policies and backend servers, enabling attackers to bypass\
  \ access controls by crafting requests where the authorization filter evaluates a different\
  \ path than the one ultimately served.\n\n#### Attack example\n\n**HTTP request:**\n\n```\n\
  GET //admin/users HTTP/1.1\nHost: example.com\n```\n\n**Policy sees:**\n\nThe leading `//admin`\
  \ path segment is interpreted as an authority component, and dropped from `input.parsed_path`\
  \ field:\n\n\n```json\n{\n  \"parsed_path\": [\"users\"]\n}\n```\n\n**Backend receives:**\n\
  \n`//admin/users` path, normalized to `/admin/users`.\n\n#### Affected Request Pattern Examples\n\
  \n| Request path | `input.parsed_path` | `input.attributes.request.http.path` | Discrepancy\
  \ |\n| - | - | - | - |\n| / | [\"\"] | / | ✅ None |\n| //foo  | [\"\"] | //foo| ❌ Mismatch\
  \ |\n| /admin | [\"admin\"] | /admin | ✅ None |\n| /admin/users | [\"admin\", \"users\"] |\
  \  /admin/users | ✅ None |\n| //admin/users  | [\"users\"] | //admin/users | ❌ Mismatch |\n\
  \n### Impact\n\nUsers are impacted if all the following conditions apply:\n\n1. Protected\
  \ resources are path-hierarchical (e.g., `/admin/users` vs `/users`)\n2. Authorization policies\
  \ use `input.parsed_path` for path-based decisions\n3. Backend servers apply lenient path\
  \ normalization\n\n### Patches\n\nGo: `v1.13.2-envoy-2`\nDocker: `1.13.2-envoy-2`, `1.13.2-envoy-2-static`\n\
  \n### Workarounds\n\nUsers who cannot immediately upgrade opa-envoy-plugin are recommended\
  \ to apply one, or more, of the workarrounds described below.\n\n#### 1. Enable the `merge_slashes`\
  \ Envoy configuration option\n\nAs per [Envoy best practices](https://www.envoyproxy.io/docs/envoy/v1.37.0/configuration/best_practices/edge.html),\
  \ enabling the [merge_slashes](https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-merge-slashes)\
  \ configuration option in Envoy will remove redundant slashes from the request path before\
  \ filtering is applied, effectively mitigating the `input.parsed_path` issue described in\
  \ this advisory.\n\n\n#### 2. Use `input.attributes.request.http.path` instead of `input.parsed_path`\
  \ in policies\n\nThe `input.attributes.request.http.path` field contains the unprocessed,\
  \ raw request path. Users are recommended to update any policy using `input.parsed_path` to\
  \ instead use the `input.attributes.request.http.path` field.\n\n##### Example ####\n\n```rego\n\
  package example\n\n# Use instead of input.parsed_path\nparsed_path := split(             \
  \                           # tokenize into array\n\ttrim_left(                          \
  \                     # drop leading slashes\n\t\turlquery.decode(input.attributes.request.http.path),\
  \ # url-decode the path\n\t\t\"/\",\n\t),\n\t\"/\",\n)\n```"
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-9f29-v6mm-pw6w/GHSA-9f29-v6mm-pw6w.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/open-policy-agent/opa-envoy-plugin
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/opa-envoy-plugin/commit/58c44d4ec408d5852d1d0287599e7d5c5e2bc5c3
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/opa-envoy-plugin/releases/tag/v1.13.2-envoy-2
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/opa-envoy-plugin/security/advisories/GHSA-9f29-v6mm-pw6w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-26205
    reference_type:
    reference_id:
