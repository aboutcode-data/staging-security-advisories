advisory_id: GHSA-j494-7x2v-vvvp
datasource_id: github_osv_importer_v2/GHSA-j494-7x2v-vvvp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-j494-7x2v-vvvp/GHSA-j494-7x2v-vvvp.json
aliases:
  - CVE-2023-34458
summary: "mx-chain-go's relayed transactions always increment nonce\n### Impact\nWhen executing\
  \ a relayed transaction, if the inner transaction failed, it would have increased the inner\
  \ transaction's sender account nonce. This could have contributed to a limited DoS attack\
  \ on a targeted account. The fix is a breaking change so a new flag `RelayedNonceFixEnableEpoch`\
  \ was needed. This was a strict processing issue while validating blocks on a chain.\n\n###\
  \ Patches\nv1.4.17 and later versions contain the fix for this issue\n\n### Workarounds\n\
  there were no workarounds for this issue. The affected account could only wait for the DoS\
  \ attack to finish as the attack was not free or to attempt to send transactions in a very\
  \ fast manner so as to compete on the same nonce with the attacker.\n\n### References\nFor\
  \ the future understanding of this issue, on v1.4.17 and onwards versions, we have this integration\
  \ test that addresses the issue and tests the fix. \nhttps://github.com/multiversx/mx-chain-go/blob/babdb144f1316ab6176bf3dbd7d4621120414d43/integrationTests/vm/txsFee/relayedMoveBalance_test.go#LL165C14-L165C14"
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-j494-7x2v-vvvp/GHSA-j494-7x2v-vvvp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/multiversx/mx-chain-go
    reference_type:
    reference_id:
  - url: https://github.com/multiversx/mx-chain-go/blob/babdb144f1316ab6176bf3dbd7d4621120414d43/integrationTests/vm/txsFee/relayedMoveBalance_test.go#LL165C14-L165C14
    reference_type:
    reference_id:
  - url: https://github.com/multiversx/mx-chain-go/commit/babdb144f1316ab6176bf3dbd7d4621120414d43
    reference_type:
    reference_id:
  - url: https://github.com/multiversx/mx-chain-go/releases/tag/v1.4.17
    reference_type:
    reference_id:
  - url: https://github.com/multiversx/mx-chain-go/security/advisories/GHSA-j494-7x2v-vvvp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34458
    reference_type:
    reference_id: CVE-2023-34458
