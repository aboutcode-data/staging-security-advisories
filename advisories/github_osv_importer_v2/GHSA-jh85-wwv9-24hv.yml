advisory_id: GHSA-jh85-wwv9-24hv
datasource_id: github_osv_importer_v2/GHSA-jh85-wwv9-24hv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-jh85-wwv9-24hv/GHSA-jh85-wwv9-24hv.json
aliases:
  - CVE-2023-32309
summary: "Any file can be included with the pymdown-snippets extension\n### Summary\n\nArbitrary\
  \ file read when using include file syntax.\n\n### Details\n\nBy using the syntax `--8<--\"\
  /etc/passwd\"` or `--8<--\"/proc/self/environ\"` the content of these files will be rendered\
  \ in the generated documentation. Additionally, a path relative to a specified, allowed base\
  \ path can also be used to render the content of a file outside the specified base paths:\
  \ `--8<-- \"../../../../etc/passwd\"`.\n\nWithin the Snippets extension, there exists a `base_path`\
  \ option but the implementation is vulnerable to Directory Traversal.\nThe vulnerable section\
  \ exists in `get_snippet_path(self, path)` lines 155 to 174 in snippets.py.\n\n```\nbase =\
  \ \"docs\"\npath = \"/etc/passwd\"\nfilename = os.path.join(base,path) # Filename is now /etc/passwd\n\
  ```\n\n### PoC\n\n```py\nimport markdown\n\npayload = \"--8<-- \\\"/etc/passwd\\\"\"\nhtml\
  \ = markdown.markdown(payload, extensions=['pymdownx.snippets'])\n\nprint(html)\n```\n\n###\
  \ Impact\n\nAny readable file on the host where the plugin is executing may have its content\
  \ exposed. This can impact any use of Snippets that exposes the use of Snippets to external\
  \ users. \n\nIt is never recommended to use Snippets to process user-facing, dynamic content.\
  \ It is designed to process known content on the backend under the control of the host, but\
  \ if someone were to accidentally enable it for user-facing content, undesired information\
  \ could be exposed.\n\n### Suggestion\n\nSpecified snippets should be restricted to the configured,\
  \ specified base paths as a safe default. Allowing relative or absolute paths that escape\
  \ the specified base paths would need to be behind a feature switch that must be opt-in and\
  \ would be at the developer's own risk."
impacted_packages:
  - purl: pkg:pypi/pymdown-extensions
    affected_versions: vers:pypi/>=1.5|<10.0
    fixed_versions: vers:pypi/10.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-jh85-wwv9-24hv/GHSA-jh85-wwv9-24hv.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/facelessuser/pymdown-extensions
    reference_type:
    reference_id:
  - url: https://github.com/facelessuser/pymdown-extensions/commit/b7bb4878d6017c03c8dc97c42d8d3bb6ee81db9d
    reference_type:
    reference_id:
  - url: https://github.com/facelessuser/pymdown-extensions/releases/tag/10.0
    reference_type:
    reference_id:
  - url: https://github.com/facelessuser/pymdown-extensions/security/advisories/GHSA-jh85-wwv9-24hv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-32309
    reference_type:
    reference_id: CVE-2023-32309
