advisory_id: GHSA-cv23-q6gh-xfrf
datasource_id: github_osv_importer_v2/GHSA-cv23-q6gh-xfrf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-cv23-q6gh-xfrf/GHSA-cv23-q6gh-xfrf.json
aliases:
  - CVE-2024-37297
summary: "WooCommerce has a Cross-Site Scripting (XSS) Vulnerability in checkout & registration\
  \ forms\n### Impact\nA vulnerability introduced in WooCommerce 8.8 allows for cross-site scripting.\
  \ A bad actor can manipulate a link to include malicious HTML & JavaScript content. While\
  \ the content is not saved to the database, the links may be sent to victims for malicious\
  \ purposes. The injected JavaScript could hijack content & data stored in the browser, including\
  \ the session.\nThe URL content is read through the Sourcebuster.js library and then inserted\
  \ without proper sanitization to the classic checkout and registration forms.\n\n### Patches\n\
  ```diff\ndiff --git a/plugins/woocommerce/client/legacy/js/frontend/order-attribution.js b/plugins/woocommerce/client/legacy/js/frontend/order-attribution.js\n\
  index 79411e928e1..25eaa721c54 100644\n--- a/plugins/woocommerce/client/legacy/js/frontend/order-attribution.js\n\
  +++ b/plugins/woocommerce/client/legacy/js/frontend/order-attribution.js\n@@ -155,12 +155,16\
  \ @@\n \t\t * but it's not yet supported in Safari.\n \t\t */\n \t\tconnectedCallback() {\n\
  -\t\t\tlet inputs = '';\n+\t\t\tthis.innerHTML = '';\n+\t\t\tconst inputs = new DocumentFragment();\n\
  \ \t\t\tfor( const fieldName of this._fieldNames ) {\n-\t\t\t\tconst value = stringifyFalsyInputValue(\
  \ this.values[ fieldName ] );\n-\t\t\t\tinputs += `<input type=\"hidden\" name=\"${params.prefix}${fieldName}\"\
  \ value=\"${value}\"/>`;\n+\t\t\t\tconst input = document.createElement( 'input' );\n+\t\t\
  \t\tinput.type = 'hidden';\n+\t\t\t\tinput.name = `${params.prefix}${fieldName}`;\n+\t\t\t\
  \tinput.value = stringifyFalsyInputValue( ( this.values && this.values[ fieldName ] ) || ''\
  \ );\n+\t\t\t\tinputs.appendChild( input );\n \t\t\t}\n-\t\t\tthis.innerHTML = inputs;\n+\t\
  \t\tthis.appendChild( inputs );\n \t\t}\n \n \t\t/**\n```\n\n### Workarounds\nDisabling the\
  \ Order Attribution feature \n\n### References\nA8C SIRT: p3btAN-2L2-p2 (internal)\nPublic\
  \ disclosure: https://developer.woocommerce.com/2024/06/10/developer-advisory-xss-vulnerability-8-8-0/"
impacted_packages:
  - purl: pkg:composer/woocommerce/woocommerce
    affected_versions: vers:composer/>=8.8.0|<8.8.5
    fixed_versions: vers:composer/8.8.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/woocommerce/woocommerce
    affected_versions: vers:composer/>=8.9.0|<8.9.3
    fixed_versions: vers:composer/8.9.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-cv23-q6gh-xfrf/GHSA-cv23-q6gh-xfrf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-80
  - CWE-79
references:
  - url: https://developer.woocommerce.com/2024/06/10/developer-advisory-xss-vulnerability-8-8-0
    reference_type:
    reference_id:
  - url: https://github.com/woocommerce/woocommerce
    reference_type:
    reference_id:
  - url: https://github.com/woocommerce/woocommerce/commit/0e9888305d0cb9557e58f558526ab11cb3bcc4b4
    reference_type:
    reference_id:
  - url: https://github.com/woocommerce/woocommerce/commit/915e32a42762916b745a7e663c8b69a698da8b67
    reference_type:
    reference_id:
  - url: https://github.com/woocommerce/woocommerce/security/advisories/GHSA-cv23-q6gh-xfrf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37297
    reference_type:
    reference_id: CVE-2024-37297
