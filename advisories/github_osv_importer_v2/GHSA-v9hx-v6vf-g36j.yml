advisory_id: GHSA-v9hx-v6vf-g36j
datasource_id: github_osv_importer_v2/GHSA-v9hx-v6vf-g36j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-v9hx-v6vf-g36j/GHSA-v9hx-v6vf-g36j.json
aliases:
  - CVE-2023-45669
summary: |
  WebAuthn4J Spring Security Improper signature counter value handling
  Improper signature counter value handling

  ### Impact

  A flaw was found in webauthn4j-spring-security-core. When an authneticator returns an incremented signature counter value during authentication, webauthn4j-spring-security-core does not properly persist the value, which means cloned authenticator detection does not work.
  An attacker who cloned valid authenticator in some way can use the cloned authenticator without being detected.

  ### Patches

  Please upgrade to `com.webauthn4j:webauthn4j-spring-security-core:0.9.1.RELEASE`


  ### References

  For more details about WebAuthn signature counters, see [WebAuthn specification 6.1.1. Signature Counter Considerations](https://www.w3.org/TR/2021/REC-webauthn-2-20210408/#sctn-sign-counter).

  ### Reporter

  This issue was discovered by Michael Budnick (@mbudnick)
impacted_packages:
  - purl: pkg:maven/com.webauthn4j/webauthn4j-spring-security-core
    affected_versions: vers:maven/<0.9.1.RELEASE
    fixed_versions: vers:maven/0.9.1.RELEASE
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-v9hx-v6vf-g36j/GHSA-v9hx-v6vf-g36j.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/webauthn4j/webauthn4j-spring-security
    reference_type:
    reference_id:
  - url: https://github.com/webauthn4j/webauthn4j-spring-security/commit/129700d74d83f9b9a82bf88ebc63707e3cb0a725
    reference_type:
    reference_id:
  - url: https://github.com/webauthn4j/webauthn4j-spring-security/security/advisories/GHSA-v9hx-v6vf-g36j
    reference_type:
    reference_id:
  - url: https://www.w3.org/TR/2021/REC-webauthn-2-20210408/#sctn-sign-counter
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-45669
    reference_type:
    reference_id: CVE-2023-45669
