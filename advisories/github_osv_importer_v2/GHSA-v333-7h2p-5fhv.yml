advisory_id: GHSA-v333-7h2p-5fhv
datasource_id: github_osv_importer_v2/GHSA-v333-7h2p-5fhv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-v333-7h2p-5fhv/GHSA-v333-7h2p-5fhv.json
aliases:
  - CVE-2024-41953
summary: |
  ZITADEL has improper HTML sanitization in emails and Console UI
  ### Impact

  ZITADEL uses HTML for emails and renders certain information such as usernames dynamically. That information can be entered by users or administrators. Due to a missing output sanitization, these emails could include malicious code.
  This may potentially lead to a threat where an attacker, without privileges, could send out altered notifications that are part of the registration processes. An attacker could create a malicious link, where the injected code would be rendered as part of the email.

  During investigation of this issue a related issue was found and mitigated, where on the user's detail page the username was not sanitized and would also render HTML, giving an attacker the same vulnerability.

  While it was possible to inject HTML including javascript, the execution of such scripts would be prevented by most email clients and the Content Security Policy in Console UI.

  ### Patches

  2.x versions are fixed on >= [2.58.1](https://github.com/zitadel/zitadel/releases/tag/v2.58.1)
  2.57.x versions are fixed on >= [2.57.1](https://github.com/zitadel/zitadel/releases/tag/v2.57.1)
  2.56.x versions are fixed on >= [2.56.2](https://github.com/zitadel/zitadel/releases/tag/v2.56.2)
  2.55.x versions are fixed on >= [2.55.5](https://github.com/zitadel/zitadel/releases/tag/v2.55.5)
  2.54.x versions are fixed on >= [2.54.8](https://github.com/zitadel/zitadel/releases/tag/v2.54.8)
  2.53.x versions are fixed on >= [2.53.9](https://github.com/zitadel/zitadel/releases/tag/v2.53.9)
  2.52.x versions are fixed on >= [2.52.9](https://github.com/zitadel/zitadel/releases/tag/v2.52.3)

  ### Workarounds

  There is no workaround since a patch is already available.

  ### Questions

  If you have any questions or comments about this advisory, please email us at [security@zitadel.com](mailto:security@zitadel.com)

  ### Credits

  Thanks to Sushmita Poudel and David Underwood for reporting this.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-v333-7h2p-5fhv/GHSA-v333-7h2p-5fhv.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-v333-7h2p-5fhv/GHSA-v333-7h2p-5fhv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/zitadel/zitadel
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/0e1f99e987b5851caec45a72660fe9f67e425747
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/38da602ee1cfc35c0d7918c298fbfc3f3674133b
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/4b59cac67bb89c1f3f84a2041dd273d11151d29f
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/c1a3fc72dde16e987d8a09aa291e7c2edfc928f7
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/c353f82f89c6982c0888c6763363296cf4263cb2
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/d04ac6df8f2f0243e649b802a8bfa6176cef0923
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/f846616a3f022e88e3ea8cea05d3254ad86f1615
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.52.3
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.53.9
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.54.8
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.55.5
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.56.2
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.57.1
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.58.1
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/security/advisories/GHSA-v333-7h2p-5fhv
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3015
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41953
    reference_type:
    reference_id: CVE-2024-41953
