advisory_id: GHSA-p27m-hp98-6637
datasource_id: github_osv_importer_v2/GHSA-p27m-hp98-6637
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-p27m-hp98-6637/GHSA-p27m-hp98-6637.json
aliases:
  - CVE-2025-68618
summary: "ImageMagick's failure to limit the depth of SVG file reads caused a DoS attack\n###\
  \ Summary\n\nUsing Magick to read a malicious SVG file resulted in a DoS attack.\n\n### Details\n\
  \nbt obtained using gdb:\n\n```\n#4 0x0000555555794c9c in ResizeMagickMemory (memory=0x7fffee203800,\
  \ size=391344) at MagickCore/memory.c:1443\n#5 0x0000555555794e5a in ResizeQuantumMemory (memory=0x7fffee203800,\
  \ count=48918, quantum=8) \nat MagickCore/memory.c:1508\n#6 0x0000555555acc8ed in SVGStartElement\
  \ (context=0x517000000080, name=0x5190000055e3 \"g\", attributes=0x0) \nat coders/svg.c:1254\n\
  #7 0x00007ffff6799b1c in xmlParseStartTag () at /lib/x86_64-linux-gnu/libxml2.so.2\n#8 0x00007ffff68c7bb8\
  \ in () at /lib/x86_64-linux-gnu/libxml2.so.2\n#9 0x00007ffff67a03f1 in xmlParseChunk () at\
  \ /lib/x86_64-linux-gnu/libxml2.so.2\n```\n\nThis is related to the SVGStartElement and ResizeQuantumMemory\
  \ functions.\n\n### PoC\n\n1. Generate an SVG file\n\n2. Read this file using Magick:\n\n\
  ```\n./magick /data/ylwang/Tools/LargeScan/targets/ImageMagick/test++/1.svg null\n```\n\n\
  3. Causes a DoS Attack\n\nMy server has a large amount of memory, causing a stack overflow\
  \ to take a long time. I'll use the Windows release version as an example:\n\n``` \nPS C:\\\
  Program Files\\ImageMagick-7.1.2-Q8> .\\magick.exe -ping 1.svg null:\nPS C:\\Program Files\\\
  ImageMagick-7.1.2-Q8> echo $LASTEXITCODE\n-1073741571\n```\n\nThe error code -1073741571 indicates\
  \ a crash due to a stack overflow.\n\n### Impact\n\nThis is a DoS vulnerability and all applications\
  \ using Magick to parse SVG files are affected."
impacted_packages:
  - purl: pkg:nuget/Magick.NET-Q16-AnyCPU
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-HDRI-AnyCPU
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-HDRI-x86
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-x86
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q8-AnyCPU
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q8-x86
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q8-arm64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q8-OpenMP-x64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q8-OpenMP-arm64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-x64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-arm64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-OpenMP-x64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-OpenMP-arm64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-HDRI-x64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-HDRI-arm64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-HDRI-OpenMP-x64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Magick.NET-Q16-HDRI-OpenMP-arm64
    affected_versions: vers:nuget/<14.10.1
    fixed_versions: vers:nuget/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-p27m-hp98-6637/GHSA-p27m-hp98-6637.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-674
references:
  - url: https://github.com/ImageMagick/ImageMagick
    reference_type:
    reference_id:
  - url: https://github.com/ImageMagick/ImageMagick/commit/6f431d445f3ddd609c004a1dde617b0a73e60beb
    reference_type:
    reference_id:
  - url: https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-p27m-hp98-6637
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68618
    reference_type:
    reference_id: CVE-2025-68618
