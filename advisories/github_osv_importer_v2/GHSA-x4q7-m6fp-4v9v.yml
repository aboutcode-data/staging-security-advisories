advisory_id: GHSA-x4q7-m6fp-4v9v
datasource_id: github_osv_importer_v2/GHSA-x4q7-m6fp-4v9v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-x4q7-m6fp-4v9v/GHSA-x4q7-m6fp-4v9v.json
aliases:
  - CVE-2022-35944
summary: |
  October CMS Safe Mode bypass leads to authenticated Remote Code Execution
  ### Impact

  This vulnerability only affects installations that rely on the safe mode restriction, commonly used when providing public access to the admin panel. Assuming an attacker has access to the admin panel and permission to open the "Editor" section, they can bypass the Safe Mode (`cms.safe_mode`) restriction to introduce new PHP code in a CMS template using a specially crafted request.

  ### Patches

  The issue has been patched in v2.2.34 and v3.0.66

  ### References

  Credits to:

  -  David Miller

  ### For more information

  If you have any questions or comments about this advisory:

  - Email us at [hello@octobercms.com](mailto:hello@octobercms.com)
impacted_packages:
  - purl: pkg:composer/october/system
    affected_versions: vers:composer/>=2.0.0|<2.2.34
    fixed_versions: vers:composer/2.2.34
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/october/system
    affected_versions: vers:composer/>=3.0.0|<3.0.66
    fixed_versions: vers:composer/3.0.66
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-x4q7-m6fp-4v9v/GHSA-x4q7-m6fp-4v9v.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/octobercms/october
    reference_type:
    reference_id:
  - url: https://github.com/octobercms/october/security/advisories/GHSA-x4q7-m6fp-4v9v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-35944
    reference_type:
    reference_id: CVE-2022-35944
