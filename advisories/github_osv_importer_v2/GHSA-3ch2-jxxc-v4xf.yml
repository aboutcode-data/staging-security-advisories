advisory_id: GHSA-3ch2-jxxc-v4xf
datasource_id: github_osv_importer_v2/GHSA-3ch2-jxxc-v4xf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-3ch2-jxxc-v4xf/GHSA-3ch2-jxxc-v4xf.json
aliases:
  - CVE-2025-54994
summary: |
  @akoskm/create-mcp-server-stdio is vulnerable to MCP Server Command Injection through `exec` API
  # Command Injection in MCP Server

  The MCP Server at https://github.com/akoskm/create-mcp-server-stdio is written in a way that is vulnerable to command injection vulnerability attacks as part of some of its MCP Server tool definition and implementation.

  ## Vulnerable tool

  The MCP Server exposes the tool `which-app-on-port` which relies on Node.js child process API `exec` which is an unsafe and vulnerable API if concatenated with untrusted user input.

  Vulnerable line of code: https://github.com/akoskm/create-mcp-server-stdio/blob/main/src/index.ts#L24-L40

  ```js
  server.tool("which-app-on-port", { port: z.number() }, async ({ port }) => {
    const result = await new Promise<ProcessInfo>((resolve, reject) => {
      exec(`lsof -t -i tcp:${port}`, (error, pidStdout) => {
        if (error) {
          reject(error);
          return;
        }
        const pid = pidStdout.trim();
        exec(`ps -p ${pid} -o comm=`, (error, stdout) => {
          if (error) {
            reject(error);
            return;
          }
          resolve({ command: stdout.trim(), pid });
        });
      });
    });
  ```

  ## Exploitation

  When LLMs are tricked through prompt injection (and other techniques and attack vectors) to call the tool with input that uses special shell characters such as `; rm -rf /tmp;#` (be careful actually executing this payload) and other payload variations, the full command-line text will be interepted by the shell and result in other commands except of `ps` executing on the host running the MCP Server.

  Reference example from prior security research on this topic:

  ![Cursor defined MCP Server vulnerable to command injection](https://res.cloudinary.com/snyk/image/upload/f_auto,w_2560,q_auto/v1747081395/Screenshot_2025-05-07_at_9.22.11_AM_d76kvm.png)

  ## Impact

  User initiated and remote command injection on a running MCP Server.

  ## Recommendation

  - Don't use `exec`. Use `execFile` instead, which pins the command and provides the arguments as array elements.
  - If the user input is not a command-line flag, use the `--` notation to terminate command and command-line flag, and indicate that the text after the `--` double dash notation is benign value.

  ## References and Prior work

  1. [Exploiting MCP Servers Vulnerable to Command Injection](https://snyk.io/articles/exploiting-mcp-servers-vulnerable-to-command-injection/)
  2. Liran's [Node.js Secure Coding: Defending Against Command Injection Vulnerabilities](https://www.nodejs-security.com/book/command-injection)

  ##

  Disclosed by [Liran Tal](https://lirantal.com)
impacted_packages:
  - purl: pkg:npm/%40akoskm/create-mcp-server-stdio
    affected_versions: vers:npm/<0.0.13
    fixed_versions: vers:npm/0.0.13
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-3ch2-jxxc-v4xf/GHSA-3ch2-jxxc-v4xf.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
  - CWE-78
references:
  - url: https://github.com/akoskm/create-mcp-server-stdio
    reference_type:
    reference_id:
  - url: https://github.com/akoskm/create-mcp-server-stdio/blob/main/src/index.ts#L24-L40
    reference_type:
    reference_id:
  - url: https://github.com/akoskm/create-mcp-server-stdio/commit/48c26bbe1f8c62764e4592f33c8300d1cadd2eac
    reference_type:
    reference_id:
  - url: https://github.com/akoskm/create-mcp-server-stdio/pull/1
    reference_type:
    reference_id:
  - url: https://github.com/akoskm/create-mcp-server-stdio/security/advisories/GHSA-3ch2-jxxc-v4xf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54994
    reference_type:
    reference_id:
