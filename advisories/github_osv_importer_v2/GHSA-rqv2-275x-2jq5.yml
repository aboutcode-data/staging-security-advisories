advisory_id: GHSA-rqv2-275x-2jq5
datasource_id: github_osv_importer_v2/GHSA-rqv2-275x-2jq5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-rqv2-275x-2jq5/GHSA-rqv2-275x-2jq5.json
aliases:
  - CVE-2022-44572
summary: |
  Denial of service via multipart parsing in Rack
  There is a denial of service vulnerability in the multipart parsing component of Rack. This vulnerability has been assigned the CVE identifier CVE-2022-44572.

  Versions Affected: >= 2.0.0 Not affected: None. Fixed Versions: 2.0.9.2, 2.1.4.2, 2.2.6.1, 3.0.0.1
  Impact

  Carefully crafted input can cause RFC2183 multipart boundary parsing in Rack to take an unexpected amount of time, possibly resulting in a denial of service attack vector. Any applications that parse multipart posts using Rack (virtually all Rails applications) are impacted.
  Releases

  The fixed releases are available at the normal locations.
  Workarounds

  There are no feasible workarounds for this issue.
  Patches

  To aid users who arenâ€™t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.

      2-0-Forbid-control-characters-in-attributes.patch - Patch for 2.0 series
      2-1-Forbid-control-characters-in-attributes.patch - Patch for 2.1 series
      2-2-Forbid-control-characters-in-attributes.patch - Patch for 2.2 series
      3-0-Forbid-control-characters-in-attributes.patch - Patch for 3.0 series
impacted_packages:
  - purl: pkg:gem/rack
    affected_versions: vers:gem/>=2.0.0|<2.0.9.2
    fixed_versions: vers:gem/2.0.9.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions: vers:gem/>=2.1.0.0|<2.1.4.2
    fixed_versions: vers:gem/2.1.4.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions: vers:gem/>=2.2.0.0|<2.2.6.1
    fixed_versions: vers:gem/2.2.6.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions: vers:gem/>=3.0.0.0|<3.0.4.1
    fixed_versions: vers:gem/3.0.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
  - CWE-400
references:
  - url: https://github.com/rack/rack
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/releases/tag/v3.0.4.1
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2022-44572.yml
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1639882
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2023/dsa-5530
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-44572
    reference_type:
    reference_id: CVE-2022-44572
