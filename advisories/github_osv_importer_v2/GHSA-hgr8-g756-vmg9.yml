advisory_id: GHSA-hgr8-g756-vmg9
datasource_id: github_osv_importer_v2/GHSA-hgr8-g756-vmg9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-hgr8-g756-vmg9/GHSA-hgr8-g756-vmg9.json
aliases:
  - CVE-2017-15806
summary: |
  Zeta Components Mail Arbitrary code execution via a crafted email address
  The send function in the ezcMailMtaTransport class in Zeta Components Mail before 1.8.2 does not properly restrict the set of characters used in the ezcMail returnPath property, which might allow remote attackers to execute arbitrary code via a crafted email address, as demonstrated by one containing "-X/path/to/wwwroot/file.php."
impacted_packages:
  - purl: pkg:composer/zetacomponents/mail
    affected_versions: vers:composer/<1.8.2
    fixed_versions: vers:composer/1.8.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-hgr8-g756-vmg9/GHSA-hgr8-g756-vmg9.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/zetacomponents/mail/CVE-2017-15806.yaml
    reference_type:
    reference_id:
  - url: https://github.com/zetacomponents/Mail
    reference_type:
    reference_id:
  - url: https://github.com/zetacomponents/Mail/issues/58
    reference_type:
    reference_id:
  - url: https://github.com/zetacomponents/Mail/releases/tag/1.8.2
    reference_type:
    reference_id:
  - url: https://kay-malwarebenchmark.github.io/blog/cve-2017-15806-critical-rce-vulnerability
    reference_type:
    reference_id:
  - url: https://kay-malwarebenchmark.github.io/blog/cve-2017-15806-yuan-cheng-dai-ma-zhi-xing-lou-dong
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/43155
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/101866
    reference_type:
    reference_id:
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/php/webapps/43155.txt
    reference_type: exploit
    reference_id: CVE-2017-15806
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-15806
    reference_type:
    reference_id: CVE-2017-15806
