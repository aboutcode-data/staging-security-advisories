advisory_id: GHSA-69wx-xc6j-28v3
datasource_id: github_osv_importer_v2/GHSA-69wx-xc6j-28v3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-69wx-xc6j-28v3/GHSA-69wx-xc6j-28v3.json
aliases:
  - CVE-2024-37906
summary: "Admidio has Blind SQL Injection in ecard_send.php\n### Description:\nAn SQL Injection\
  \ has been identified in the `/adm_program/modules/ecards/ecard_send.php` source file of the\
  \ Admidio Application. The SQL Injection results in a compromise of the application's database.\
  \ The value of `ecard_recipients `POST parameter is being directly concatenated with the SQL\
  \ query in the source code causing the SQL Injection.\n\nThe SQL Injection can be exploited\
  \ by a member user, using blind condition-based, time-based, and Out of band interaction SQL\
  \ Injection payloads. I successfully exploited SQL Injections by causing Time Delays. Advancing\
  \ the payload, I was able to exfiltrate data from the database based on trial and error conditions\
  \ and step-wise enumerating the characters of the database name. This was done as a POC of\
  \ SQL Injection. An attacker could simply drop the database by providing a single payload,\
  \ steal data, and potentially update the database according to their will. \n\n### Impact:\n\
  SQL injection (SQLi) vulnerabilities can have serious consequences for the security of a web\
  \ application and its underlying database. Attackers can use SQLi to access sensitive data,\
  \ and modify, delete, or add data to the database. SQLi can also be potentially used to perform\
  \ RCE. \n\n### Remediation:\nUse parameterized queries or prepared statements instead of concatenating\
  \ user input directly into SQL queries. Parameterized queries ensure that user input is treated\
  \ as data and not executable queries. \nOR \nSanitize the input before including it in the\
  \ SQL Query.\n\n### Steps to Reproduce:\n- Intercept the POST request to `/adm_program/modules/ecards/ecard_send.php`,\
  \ which is used to send photo as greeting card.\n- Change the value of `ecard_recipients%5B%5D`\
  \ POST parameter to `2%2bsleep(10)`.\n- Sending the request will cause a time delay.\n\n###\
  \ Proof Of Concept:\n\n![image](https://github.com/Admidio/admidio/assets/59286712/8ea87f4f-dad0-4df1-999d-212b07e02527)\n\
  Figure 1: Code Vulnerable to SQL Injection\n\n![image](https://github.com/Admidio/admidio/assets/59286712/d803a92c-3469-45aa-a844-e8aa311b55f4)\n\
  Figure 2: Code Vulnerable to SQL Injection\n\n![image](https://github.com/Admidio/admidio/assets/59286712/2ccdf865-2867-4dc8-abe1-f25b5e906db3)\n\
  Figure 3: SQLi to trigger time delay\n\n![image](https://github.com/Admidio/admidio/assets/59286712/eed06ce6-6591-427f-b98e-5314233b5996)\n\
  Figure 4: Data Exfiltration via Condition-based Time Delays"
impacted_packages:
  - purl: pkg:composer/admidio/admidio
    affected_versions: vers:composer/<4.3.9
    fixed_versions: vers:composer/4.3.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-69wx-xc6j-28v3/GHSA-69wx-xc6j-28v3.json
  - score: '9.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-69wx-xc6j-28v3/GHSA-69wx-xc6j-28v3.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/Admidio/admidio
    reference_type:
    reference_id:
  - url: https://github.com/Admidio/admidio/commit/3ff02b0c64a6911ab3e81cd61077f392c0b25248
    reference_type:
    reference_id:
  - url: https://github.com/Admidio/admidio/security/advisories/GHSA-69wx-xc6j-28v3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37906
    reference_type:
    reference_id: CVE-2024-37906
