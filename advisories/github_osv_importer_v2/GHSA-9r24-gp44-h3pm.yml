advisory_id: GHSA-9r24-gp44-h3pm
datasource_id: github_osv_importer_v2/GHSA-9r24-gp44-h3pm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/10/GHSA-9r24-gp44-h3pm/GHSA-9r24-gp44-h3pm.json
aliases:
  - CVE-2018-1335
summary: |
  Command injection in org.apache.tika:tika-core
  From Apache Tika versions 1.7 to 1.17, clients could send carefully crafted headers to tika-server that could be used to inject commands into the command line of the server running tika-server. This vulnerability only affects those running tika-server on a server that is open to untrusted clients. The mitigation is to upgrade to Tika 1.18.
impacted_packages:
  - purl: pkg:maven/org.apache.tika/tika-core
    affected_versions: vers:maven/>=1.7|<1.18
    fixed_versions: vers:maven/1.18
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/10/GHSA-9r24-gp44-h3pm/GHSA-9r24-gp44-h3pm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: http://packetstormsecurity.com/files/153864/Apache-Tika-1.17-Header-Command-Injection.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2019:3140
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-9r24-gp44-h3pm
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/b3ed4432380af767effd4c6f27665cc7b2686acccbefeb9f55851dca@%3Cdev.tika.apache.org%3E
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/46540
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/104001
    reference_type:
    reference_id:
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/windows/remote/46540.py
    reference_type: exploit
    reference_id: CVE-2018-1335
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/windows/remote/47208.rb
    reference_type: exploit
    reference_id: CVE-2018-1335
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-1335
    reference_type:
    reference_id: CVE-2018-1335
  - url: https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/windows/http/apache_tika_jp2_jscript.rb
    reference_type: exploit
    reference_id: CVE-2018-1335
  - url: https://rhinosecuritylabs.com/application-security/exploiting-cve-2018-1335-apache-tika/
    reference_type: exploit
    reference_id: CVE-2018-1335
