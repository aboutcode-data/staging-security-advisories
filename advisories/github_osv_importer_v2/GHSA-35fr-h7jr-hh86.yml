advisory_id: GHSA-35fr-h7jr-hh86
datasource_id: github_osv_importer_v2/GHSA-35fr-h7jr-hh86
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/12/GHSA-35fr-h7jr-hh86/GHSA-35fr-h7jr-hh86.json
aliases: []
summary: |
  Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response Splitting') in Armeria
  Versions of Armeria 0.85.0 through and including 0.96.0 are vulnerable to HTTP response splitting, which allows remote attackers to inject arbitrary HTTP headers via CRLF sequences when unsanitized data is used to populate the headers of an HTTP response.

  ### Impact

  1. Cross-User Defacement
  2. Cache Poisoning
  3. Cross-Site Scripting (XSS)
  4. Page Hijacking


  ### Root Cause

  The root cause is due to the usage of Netty without the HTTP header validation.

  https://github.com/line/armeria/blob/f0d870fde1088114070be31b67f7df0a21e835c6/core/src/main/java/com/linecorp/armeria/common/DefaultHttpHeaders.java#L23

  ### Patches

  This vulnerability has been patched in 0.97.0.

  ### References

  [CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response Splitting')](https://cwe.mitre.org/data/definitions/113.html)
  https://github.com/ratpack/ratpack/security/advisories/GHSA-mvqp-q37c-wf9j

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [GitHub](https://github.com/line/armeria/issues)
impacted_packages:
  - purl: pkg:maven/com.linecorp.armeria/armeria
    affected_versions: vers:maven/>=0.85.0|<0.97.0
    fixed_versions: vers:maven/0.97.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/12/GHSA-35fr-h7jr-hh86/GHSA-35fr-h7jr-hh86.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-113
  - CWE-74
references:
  - url: https://github.com/line/armeria/security/advisories/GHSA-35fr-h7jr-hh86
    reference_type:
    reference_id:
