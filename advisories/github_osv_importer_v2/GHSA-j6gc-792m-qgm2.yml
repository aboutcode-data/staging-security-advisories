advisory_id: GHSA-j6gc-792m-qgm2
datasource_id: github_osv_importer_v2/GHSA-j6gc-792m-qgm2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-j6gc-792m-qgm2/GHSA-j6gc-792m-qgm2.json
aliases:
  - CVE-2023-22796
summary: |
  ReDoS based DoS vulnerability in Active Support's underscore
  There is a possible regular expression based DoS vulnerability in Active Support. This vulnerability has been assigned the CVE identifier CVE-2023-22796.

  Versions Affected: All Not affected: None Fixed Versions: 5.2.8.15 (Rails LTS, which is a paid service and not part of the rubygem), 6.1.7.1, 7.0.4.1
  Impact

  A specially crafted string passed to the underscore method can cause the regular expression engine to enter a state of catastrophic backtracking. This can cause the process to use large amounts of CPU and memory, leading to a possible DoS vulnerability.

  This affects String#underscore, ActiveSupport::Inflector.underscore, String#titleize, and any other methods using these.

  All users running an affected release should either upgrade or use one of the workarounds immediately.
  Releases

  The FIXED releases are available at the normal locations.
  Workarounds

  There are no feasible workarounds for this issue.

  Users on Ruby 3.2.0 or greater may be able to reduce the impact by configuring Regexp.timeout.
  Patches

  To aid users who arenâ€™t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.

      6-1-Avoid-regex-backtracking-in-Inflector.underscore.patch - Patch for 6.1 series
      7-0-Avoid-regex-backtracking-in-Inflector.underscore.patch - Patch for 7.0 series

  Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.
impacted_packages:
  - purl: pkg:gem/activesupport
    affected_versions: vers:gem/<6.1.7.1
    fixed_versions: vers:gem/6.1.7.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activesupport
    affected_versions: vers:gem/>=7.0.0|<7.0.4.1
    fixed_versions: vers:gem/7.0.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
references:
  - url: https://discuss.rubyonrails.org/t/cve-2023-22796-possible-redos-based-dos-vulnerability-in-active-supports-underscore/82116
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/2164d4f6a1bde74b911fe9ba3c8df1b5bf345bf8
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/a7cda7e6aa5334ab41b1f4b0f671be931be946ef
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/releases/tag/v6.1.7.1
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/releases/tag/v7.0.4.1
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activesupport/CVE-2023-22796.yml
    reference_type:
    reference_id:
  - url: https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-22796
    reference_type:
    reference_id: CVE-2023-22796
