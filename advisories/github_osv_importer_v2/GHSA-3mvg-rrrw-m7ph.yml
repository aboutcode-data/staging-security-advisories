advisory_id: GHSA-3mvg-rrrw-m7ph
datasource_id: github_osv_importer_v2/GHSA-3mvg-rrrw-m7ph
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/08/GHSA-3mvg-rrrw-m7ph/GHSA-3mvg-rrrw-m7ph.json
aliases:
  - CVE-2020-15109
summary: "Ability to change order address without triggering address validations in solidus\n\
  ### Impact\n\nThis vulnerability allows a malicious customer to craft request data with parameters\
  \ that allow changing the address of the current order without changing the shipment costs\
  \ associated with the new shipment.\n\nAll stores with at least two shipping zones and different\
  \ costs of shipment per zone are impacted. \n\nE.g.\n1. Store admin configured the store so\
  \ that there are two zones in US:\n-  East Cost Zone - Shipping Method cost: $1\n- West Cost\
  \ Zone - Shipping Method cost: $10\n\nThe attacker user can know that shipping to NY is less\
  \ expensive than to LA just by testing different addresses in checkout.\n\n2. The attacker\
  \ user enters any NY shipping address in the address step\n3. The attacker user chooses the\
  \ $1 delivery option\n4. The attacker user crafts a request with their real LA address, similar\
  \ to:\n\n```\n// POST #checkout/update:\n\n{\n  state: 'payment',\n  order: {\n    ship_address_attributes:\
  \ {\n      city: 'Los Angeles',\n      ...\n    }\n  }\n}\n```\n5. The attacker user proceeds\
  \ with checking out with a new address and the $1 shipment costs.\n\nAnother scenario where\
  \ this could be dangerous is:\n\n> You cannot ship products in some zones and you are relying\
  \ on Solidus Shipping Method building only to filter out unwanted zones. Malicious users can\
  \ enter an allowed zone's address and change back to an unwanted one in the payment step by\
  \ crafting a request with some proper ship_address_attributes.\n\nThis problem comes from\
  \ how checkout permitted attributes are structured. We have a single list of attributes that\
  \ are permitted across the whole checkout, no matter the step that is being submitted.\n\n\
  ### Patches\n\nA PR has been attached to fix the security concern for each of all the Solidus\
  \ supported versions following the rules of the [Solidus Security Policy](https://solidus.io/security).\n\
  \n### Workarounds\n\nWhen it's not possible to upgrade to a supported patched version, please\
  \ use this gist to patch the store:\n\nhttps://gist.github.com/kennyadsl/4618cd9797984cb64f7700a81bda889d"
impacted_packages:
  - purl: pkg:gem/solidus_frontend
    affected_versions: vers:gem/<2.8.6
    fixed_versions: vers:gem/2.8.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/solidus_frontend
    affected_versions: vers:gem/>=2.9.0|<2.9.6
    fixed_versions: vers:gem/2.9.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/solidus_frontend
    affected_versions: vers:gem/>=2.10.0|<2.10.2
    fixed_versions: vers:gem/2.10.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/solidus_api
    affected_versions: vers:gem/<2.8.6
    fixed_versions: vers:gem/2.8.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/solidus_api
    affected_versions: vers:gem/>=2.9.0|<2.9.6
    fixed_versions: vers:gem/2.9.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/solidus_api
    affected_versions: vers:gem/>=2.10.0|<2.10.2
    fixed_versions: vers:gem/2.10.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/08/GHSA-3mvg-rrrw-m7ph/GHSA-3mvg-rrrw-m7ph.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-862
references:
  - url: https://gist.github.com/kennyadsl/4618cd9797984cb64f7700a81bda889d
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/solidus_api/CVE-2020-15109.yml
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/solidus_frontend/CVE-2020-15109.yml
    reference_type:
    reference_id:
  - url: https://github.com/solidusio/solidus
    reference_type:
    reference_id:
  - url: https://github.com/solidusio/solidus/security/advisories/GHSA-3mvg-rrrw-m7ph
    reference_type:
    reference_id:
  - url: https://solidus.io/blog/2020/07/16/new-releases.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15109
    reference_type:
    reference_id: CVE-2020-15109
