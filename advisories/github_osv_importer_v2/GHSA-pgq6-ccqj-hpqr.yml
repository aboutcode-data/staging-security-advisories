advisory_id: GHSA-pgq6-ccqj-hpqr
datasource_id: github_osv_importer_v2/GHSA-pgq6-ccqj-hpqr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-pgq6-ccqj-hpqr/GHSA-pgq6-ccqj-hpqr.json
aliases:
  - CVE-2022-23708
summary: |
  Elasticsearch privilege escalation
  A flaw was discovered in Elasticsearch 7.17.0’s upgrade assistant, in which upgrading from version 6.x to 7.x would disable the in-built protections on the security index, allowing authenticated users with “*” index permissions access to this index. Users running a cluster on an affected version that had previously been upgraded from 6.x, should upgrade to 7.17.1. Users that are planning to upgrade from 6.x should not perform an upgrade from 6.x to versions 7.16 through 7.17.0 and should use 7.17.1+ for upgrades from 6.x.
impacted_packages:
  - purl: pkg:maven/org.elasticsearch/elasticsearch
    affected_versions: vers:maven/>=7.16.0|<7.17.1
    fixed_versions: vers:maven/7.17.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-pgq6-ccqj-hpqr/GHSA-pgq6-ccqj-hpqr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://discuss.elastic.co/t/elastic-stack-7-17-1-security-update/298447
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220729-0003
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23708
    reference_type:
    reference_id: CVE-2022-23708
