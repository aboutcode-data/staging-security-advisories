advisory_id: GHSA-34p5-jp77-fcrc
datasource_id: github_osv_importer_v2/GHSA-34p5-jp77-fcrc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-34p5-jp77-fcrc/GHSA-34p5-jp77-fcrc.json
aliases:
  - CVE-2022-43758
summary: |
  Command injection in Rancher Git package
  ### Impact

  An issue was discovered in Rancher from versions 2.5.0 up to and including 2.5.16, 2.6.0 up to and including 2.6.9 and 2.7.0, where a command injection vulnerability is present in the Rancher Git package. This package uses the underlying Git binary available in the Rancher container image to execute Git operations.

  Specially crafted commands, when not properly disambiguated, can cause confusion when executed through Git, resulting in command injection in the underlying Rancher host.

  This issue can potentially be exploited in Rancher in two ways:

  1. Adding an untrusted Helm catalog, in the Catalogs menu, that contains maliciously designed repo URL configuration in Helm charts.
  2. Modifying the URL configuration used to download KDM (Kontainer Driver Metadata) releases.

  By default, only the Rancher admin has permission to manage both configurations for the local cluster (the cluster where Rancher is provisioned).

  Note: More information about this category of issue in version control system (VCS) tools are available in Snyk's [blog post](https://snyk.io/blog/argument-injection-when-using-git-and-mercurial/).

  ### Workarounds

  Except for only adding trusted catalogs and the KDM URL to Rancher, there is no other workaround besides updating Rancher to a patched version.

  ### Patches

  Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions.

  It is also important to update to a patched version in case Rancher or its standalone Git package implementation is used as a Go library instead of the application itself. Otherwise, this vulnerability might affect your dependent code.

  ### For more information

  If you have any questions or comments about this advisory:

  * Reach out to [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy) for security related inquiries.
  * Open an issue in [Rancher](https://github.com/rancher/rancher/issues/new/choose) repository.
  * Verify our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/) and [product support lifecycle](https://www.suse.com/lifecycle/).
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-34p5-jp77-fcrc/GHSA-34p5-jp77-fcrc.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
  - CWE-88
  - CWE-78
references:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=1205294
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/security/advisories/GHSA-34p5-jp77-fcrc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-43758
    reference_type:
    reference_id: CVE-2022-43758
