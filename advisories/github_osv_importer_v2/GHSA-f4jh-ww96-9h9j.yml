advisory_id: GHSA-f4jh-ww96-9h9j
datasource_id: github_osv_importer_v2/GHSA-f4jh-ww96-9h9j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-f4jh-ww96-9h9j/GHSA-f4jh-ww96-9h9j.json
aliases:
  - CVE-2021-28100
summary: |
  Netflix/Priam: Temporary Directory Information Disclosure
  ### Impact

  When `File.createTempFile` creates a file, the permissions on that file are -rw-r--r--. This means that other users can read the contents of these files after they are written, although they can not modify the contents. This allows for local information disclosure if these files contain sensitive information.

  Vulnerable locations:
   - https://github.com/Netflix/Priam/blob/362660bb7ebddb0cfa756a282d94678f65af9f06/priam/src/main/java/com/netflix/priam/backup/MetaData.java#L106-L111
   - https://github.com/Netflix/Priam/blob/362660bb7ebddb0cfa756a282d94678f65af9f06/priam/src/main/java/com/netflix/priam/identity/DoubleRing.java#L109-L118
   - https://github.com/Netflix/Priam/blob/362660bb7ebddb0cfa756a282d94678f65af9f06/priam/src/main/java/com/netflix/priam/restore/PostRestoreHook.java#L80-L86

  ---

  The custom CodeQL queries leveraged to find these this as well as their results can be found here:

  https://lgtm.com/query/1543383251073929777/
  https://lgtm.com/query/3142895023158674709/

  ## Official Disclosure

  https://github.com/Netflix/security-bulletins/blob/master/advisories/nflx-2021-002.md

  ## Fix

  There are no fixed versions.
impacted_packages:
  - purl: pkg:maven/com.netflix.priam/priam
    affected_versions: vers:maven/<=3.1.104
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-f4jh-ww96-9h9j/GHSA-f4jh-ww96-9h9j.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-377
references:
  - url: https://github.com/JLLeitschuh/security-research/security/advisories/GHSA-f4jh-ww96-9h9j
    reference_type:
    reference_id:
