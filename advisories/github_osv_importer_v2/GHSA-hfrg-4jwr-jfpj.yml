advisory_id: GHSA-hfrg-4jwr-jfpj
datasource_id: github_osv_importer_v2/GHSA-hfrg-4jwr-jfpj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hfrg-4jwr-jfpj/GHSA-hfrg-4jwr-jfpj.json
aliases:
  - CVE-2024-28855
summary: |
  Improper HTML sanitization in ZITADEL
  ### Impact

  ZITADEL uses Go templates to render the login UI.

  Due to a improper use of the `text/template` instead of the `html/template` package, the Login UI did not sanitize input parameters. An attacker could create a malicious link, where he injected code which would be rendered as part of the login screen.
  While it was possible to inject HTML including javascript, the execution of such scripts would be prevented by the Content Security Policy.

  ### Patches

  2.x versions are fixed on >= [2.47.3](https://github.com/zitadel/zitadel/releases/tag/v2.47.3)
  2.46.x versions are fixed on >= [2.46.1](https://github.com/zitadel/zitadel/releases/tag/v2.46.1)
  2.45.x versions are fixed on >= [2.45.1](https://github.com/zitadel/zitadel/releases/tag/v2.45.1)
  2.44.x versions are fixed on >= [2.44.3](https://github.com/zitadel/zitadel/releases/tag/v2.44.3)
  2.43.x versions are fixed on >= [2.43.9](https://github.com/zitadel/zitadel/releases/tag/v2.43.9)
  2.42.x versions are fixed on >= [2.42.15](https://github.com/zitadel/zitadel/releases/tag/v2.42.15)
  2.41.x versions are fixed on >= [2.41.15](https://github.com/zitadel/zitadel/releases/tag/v2.41.15)

  ZITADEL recommends upgrading to the latest versions available in due course.

  ### Workarounds

  There is no workaround since a patch is already available.

  ### Questions

  If you have any questions or comments about this advisory, please email us at [security@zitadel.com](mailto:security@zitadel.com)

  ### Credits

  Thanks to Daniel Philipp - owt and Thomas Wickham - synopsis for reporting this.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hfrg-4jwr-jfpj/GHSA-hfrg-4jwr-jfpj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-79
references:
  - url: https://github.com/zitadel/zitadel
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/07ec2efa9dc62f7a6c3a58c112b2879d24bc3e3c
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.41.15
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.42.15
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.43.9
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.44.3
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.45.1
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.46.1
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.47.3
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-28855
    reference_type:
    reference_id: CVE-2024-28855
