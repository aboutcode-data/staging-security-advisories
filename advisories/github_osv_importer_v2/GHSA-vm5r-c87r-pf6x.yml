advisory_id: GHSA-vm5r-c87r-pf6x
datasource_id: github_osv_importer_v2/GHSA-vm5r-c87r-pf6x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-vm5r-c87r-pf6x/GHSA-vm5r-c87r-pf6x.json
aliases:
  - CVE-2023-22474
summary: |
  Parse Server option `masterKeyIps` vulnerability to IP spoofing
  ### Impact

  Parse Server uses the request header `x-forwarded-for` to determine the client IP address. If Parse Server doesn't run behind a proxy server, then a client can set this header and Parse Server will trust the value of the header. The incorrect client IP address will be used by various features in Parse Server. This allows to circumvent the security mechanism of the Parse Server option `masterKeyIps` by setting an allowed IP address as the `x-forwarded-for` header value.

  ### Patches

  The mechanism to determine the client IP address has been rewritten. The correct IP address determination now requires to set the Parse Server option `trustProxy` accordingly, see the express framework's [trust proxy](https://expressjs.com/en/guide/behind-proxies.html) setting.

  ### References
  - https://github.com/parse-community/parse-server/security/advisories/GHSA-vm5r-c87r-pf6x
  - https://expressjs.com/en/guide/behind-proxies.html
impacted_packages:
  - purl: pkg:npm/parse-server
    affected_versions: vers:npm/<5.4.1
    fixed_versions: vers:npm/5.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-vm5r-c87r-pf6x/GHSA-vm5r-c87r-pf6x.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-290
references:
  - url: https://github.com/parse-community/parse-server
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/commit/e016d813e083ce6828f9abce245d15b681a224d8
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/security/advisories/GHSA-vm5r-c87r-pf6x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-22474
    reference_type:
    reference_id: CVE-2023-22474
