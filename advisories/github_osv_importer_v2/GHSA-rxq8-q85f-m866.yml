advisory_id: GHSA-rxq8-q85f-m866
datasource_id: github_osv_importer_v2/GHSA-rxq8-q85f-m866
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-rxq8-q85f-m866/GHSA-rxq8-q85f-m866.json
aliases:
  - CVE-2024-45793
summary: "Prevent XSS from Confidant API call\n### Impact\n_What kind of vulnerability is it?\
  \ Who is impacted?_\nPotential XSS from API calls below:\nGET <app>/v1/credentials\nGET <app>/v1/credentials/<id>\n\
  GET <app>/v1/archive/credentials/<id>\nGET <app>/v1/archive/credentials\nPOST <app>/v1/credentials\n\
  PUT <app>/v1/credentials/<id>\nPUT <app>/v1/credentials/<id>/<to_revision>\n\nGET <app>/v1/services\n\
  GET <app>/v1/services/<id>\nGET <app>/v1/archive/services/<id>\nGET <app>/v1/archive/services\n\
  PUT <app>/v1/services/<id>\nPUT <app>/v1/services/<id>/<to_revision>\n\nStored XSS that can\
  \ only be used as a stored HTML injection. The attacker needs to be authenticated and have\
  \ privileges to create new credentials, but could use this to show information and run scripts\
  \ to other users into the same Confidant instance.\n\n### Patches\n_Has the problem been patched?\
  \ What versions should users upgrade to?_\nyes, version 6.6.2\n\n### Workarounds\n_Is there\
  \ a way for users to fix or remediate the vulnerability without upgrading?_\nNO\n\n### References\n\
  _Are there any links users can visit to find out more?_\nhttps://hackerone.com/reports/2332004\n\
  https://hackerone.com/reports/2456673\nhttps://hackerone.com/reports/2476542\nAcknowledgement:\
  \ \nThank you Rein Daelman ([trein](https://hackerone.com/trein)) for reporting and proposing\
  \ the fix."
impacted_packages:
  - purl: pkg:pypi/confidant
    affected_versions: vers:pypi/<6.6.2
    fixed_versions: vers:pypi/6.6.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-rxq8-q85f-m866/GHSA-rxq8-q85f-m866.json
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:A/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-rxq8-q85f-m866/GHSA-rxq8-q85f-m866.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/lyft/confidant
    reference_type:
    reference_id:
  - url: https://github.com/lyft/confidant/commit/8876b07abde0c8d2a4974f79b60562b6d0193db9
    reference_type:
    reference_id:
  - url: https://github.com/lyft/confidant/security/advisories/GHSA-rxq8-q85f-m866
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/2332004
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/2456673
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/2476542
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45793
    reference_type:
    reference_id: CVE-2024-45793
