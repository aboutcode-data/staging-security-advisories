advisory_id: GHSA-48vq-8jqv-gm6f
datasource_id: github_osv_importer_v2/GHSA-48vq-8jqv-gm6f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-48vq-8jqv-gm6f/GHSA-48vq-8jqv-gm6f.json
aliases: []
summary: |
  Remote memory exhaustion in ckb
  In the ckb sync protocol, SyncState maintains a HashMap called 'misbehavior' that keeps a score of a peer's violations of the protocol. This HashMap is keyed to PeerIndex (an alias for SessionId), and entries are never removed from it. SessionId is an integer that increases monotonically with every new connection.

  A remote attacker can manipulate this HashMap to grow forever, resulting in degraded performance and ultimately a panic on allocation failure or being killed by the OS, depending on the platform.

  This is a critical severity security bug. It could be exploited to create a targeted or network-wide denial of service, to reduce the hash power of the network as part of a 51% attack, and perhaps in other creative ways.

  An attack is trivial:

  1. connect to another node
  2. send an invalid sync protocol request, such as `SendHeaders` for non-consecutive blocks
  3. disconnect
  4. repeat
impacted_packages: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/nervosnetwork/ckb/security/advisories/GHSA-48vq-8jqv-gm6f
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0108.html
    reference_type:
    reference_id:
