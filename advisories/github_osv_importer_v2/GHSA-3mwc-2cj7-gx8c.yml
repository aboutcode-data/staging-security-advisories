advisory_id: GHSA-3mwc-2cj7-gx8c
datasource_id: github_osv_importer_v2/GHSA-3mwc-2cj7-gx8c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-3mwc-2cj7-gx8c/GHSA-3mwc-2cj7-gx8c.json
aliases:
  - CVE-2024-5389
summary: |
  lunary-ai/lunary Access Control Vulnerability in Prompt Variation Management
  Withdrawn: This advisory was incorrectly linked the the npm package `lunary`. The advisory is valid, but not for that package.

  In lunary-ai/lunary version 1.2.13, an insufficient granularity of access control vulnerability allows users to create, update, get, and delete prompt variations for datasets not owned by their organization. This issue arises due to the application not properly validating the ownership of dataset prompts and their variations against the organization or project of the requesting user. As a result, unauthorized modifications to dataset prompts can occur, leading to altered or removed dataset prompts without proper authorization. This vulnerability impacts the integrity and consistency of dataset information, potentially affecting the results of experiments.
impacted_packages:
  - purl: pkg:npm/lunary
    affected_versions: vers:npm/<1.4.9
    fixed_versions: vers:npm/1.4.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-3mwc-2cj7-gx8c/GHSA-3mwc-2cj7-gx8c.json
  - score: '6.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:N/SC:H/SI:H/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-3mwc-2cj7-gx8c/GHSA-3mwc-2cj7-gx8c.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1220
references:
  - url: https://github.com/lunary-ai/lunary
    reference_type:
    reference_id:
  - url: https://github.com/lunary-ai/lunary/commit/35dd4af0001a54ccb14276a1546eb977f82c0c5e
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/3ca5309f-5615-4d5b-8043-968af220d7a2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-5389
    reference_type:
    reference_id: CVE-2024-5389
