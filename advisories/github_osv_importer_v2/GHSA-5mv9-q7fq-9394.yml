advisory_id: GHSA-5mv9-q7fq-9394
datasource_id: github_osv_importer_v2/GHSA-5mv9-q7fq-9394
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-5mv9-q7fq-9394/GHSA-5mv9-q7fq-9394.json
aliases:
  - CVE-2021-32635
summary: |
  Action Commands (run/shell/exec) Against Library URIs Ignore Configured Remote Endpoint
  ### Impact

  Due to incorrect use of a default URL, `singularity` action commands (`run`/`shell`/`exec`) specifying a container using a `library://` URI will always attempt to retrieve the container from the default remote endpoint (`cloud.sylabs.io`) rather than the configured remote endpoint.

  An attacker may be able to push a malicious container to the default remote endpoint with a URI that is identical to the URI used by a victim with a non-default remote endpoint, thus executing the malicious container.

  Only action commands (`run`/`shell`/`exec`) against `library://` URIs are affected. Other commands such as `pull` / `push` respect the configured remote endpoint.

  ### Patches

  All users should upgrade to Singularity 3.7.4 or later.

  A patch was applied at: https://github.com/sylabs/singularity/commit/d52ae9d13979733c5e987a566fae59ed6f1bf796

  ### Workarounds

  Users who only interact with the default remote endpoint are not affected.

  Installations with an execution control list configured to restrict execution to containers signed with specific secure keys are not affected.

  ### For more information

  General questions about the impact of the advisory can be asked in the:

  - [SingularityCE Slack Channel](https://singularityce.slack.com)
  - [SingularityCE Mailing List](https://groups.google.com/g/singularity-ce)

  Any sensitive security concerns should be directed to: security@sylabs.io

  See our Security Policy here: https://sylabs.io/security-policy
impacted_packages: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-5mv9-q7fq-9394/GHSA-5mv9-q7fq-9394.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/hpcng/singularity/security/advisories/GHSA-jq42-hfch-42f3
    reference_type:
    reference_id:
  - url: https://github.com/sylabs/singularity
    reference_type:
    reference_id:
  - url: https://github.com/sylabs/singularity/commit/d52ae9d13979733c5e987a566fae59ed6f1bf796
    reference_type:
    reference_id:
  - url: https://github.com/sylabs/singularity/releases/tag/v3.7.4
    reference_type:
    reference_id:
  - url: https://github.com/sylabs/singularity/security/advisories/GHSA-5mv9-q7fq-9394
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202107-50
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32635
    reference_type:
    reference_id: CVE-2021-32635
