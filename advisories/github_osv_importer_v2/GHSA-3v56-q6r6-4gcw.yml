advisory_id: GHSA-3v56-q6r6-4gcw
datasource_id: github_osv_importer_v2/GHSA-3v56-q6r6-4gcw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-3v56-q6r6-4gcw/GHSA-3v56-q6r6-4gcw.json
aliases:
  - CVE-2021-41170
summary: "Insecure Inherited Permissions in neoan3-apps/template\n### Impact\nVersions prior\
  \ 1.1.1 have allowed for passing in closures directly into the template engine. As a result\
  \ values that are callable are executed by the template engine. The issue arises if a value\
  \ has the same name as a method or function in scope and can therefore be executed either\
  \ by mistake or maliciously. \n\nIn theory all users of the package are affected as long as\
  \ they either deal with direct user input or database values. A multi-step attack on is therefore\
  \ plausible. \n\n\n### Patches\nVersion 1.1.1 has addressed this vulnerability. \n```php\n\
  $params = [\n   'reverse' => fn($input) => strrev($input),    // <-- no longer possible with\
  \ version ~1.1.1\n   'value' => 'My website' \n]\nTemplateFunctions::registerClosure('reverse',\
  \ fn($input) => strrev($input));  // <-- still possible (and nicely isolated)\nTemplate::embrace('<h1>{{reverse(value)}}</h1>',\
  \ $params);\n```\n\n### Workarounds\nUnfortunately only working with hardcoded values is safe\
  \ in prior versions. As this likely defeats the purpose of a template engine, please upgrade.\n\
  \n### References\nAs a possible exploit is relatively easy to achieve, I will not share steps\
  \ to reproduce the issue for now.\n\n### For more information\nIf you have any questions or\
  \ comments about this advisory:\n* Open an issue in [our repo](https://github.com/sroehrl/neoan3-template)"
impacted_packages:
  - purl: pkg:composer/neoan3-apps/template
    affected_versions: vers:composer/<1.1.1
    fixed_versions: vers:composer/1.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-3v56-q6r6-4gcw/GHSA-3v56-q6r6-4gcw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-732
  - CWE-277
  - CWE-74
references:
  - url: https://github.com/sroehrl/neoan3-template
    reference_type:
    reference_id:
  - url: https://github.com/sroehrl/neoan3-template/commit/4a2c9570f071d3c8f4ac790007599cba20e16934
    reference_type:
    reference_id:
  - url: https://github.com/sroehrl/neoan3-template/issues/8
    reference_type:
    reference_id:
  - url: https://github.com/sroehrl/neoan3-template/security/advisories/GHSA-3v56-q6r6-4gcw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41170
    reference_type:
    reference_id: CVE-2021-41170
