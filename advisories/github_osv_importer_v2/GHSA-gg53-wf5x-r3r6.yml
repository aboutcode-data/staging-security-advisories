advisory_id: GHSA-gg53-wf5x-r3r6
datasource_id: github_osv_importer_v2/GHSA-gg53-wf5x-r3r6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-gg53-wf5x-r3r6/GHSA-gg53-wf5x-r3r6.json
aliases:
  - CVE-2022-31167
summary: |
  XWiki Platform Security Parent POM vulnerable to overwriting of security rules of a page with a final page having the same reference
  ### Impact

  A bug in the security cache is storing rules associated to document Page1.Page2 and space Page1.Page2 in the same cache entry.

  That means that it's possible to overwrite the rights of a space or a document by creating the page of the space with the same name and checking the right of the new one first so that they end up in the security cache and are used for the other too.

  ### Patches

  The problem has been patched in XWiki 12.10.11, 13.10.1, 13.4.6.

  ### Workarounds

  No workaround other than patching.

  ### References

  https://jira.xwiki.org/browse/XWIKI-14075
  https://jira.xwiki.org/browse/XWIKI-18983

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki.org](https://jira.xwiki.org)
  * Email us at [Security Mailing List](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security
    affected_versions: vers:maven/>=5.0|<12.10.11
    fixed_versions: vers:maven/12.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security
    affected_versions: vers:maven/>=13.0|<13.4.6
    fixed_versions: vers:maven/13.4.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security
    affected_versions: vers:maven/>=13.10|<13.10.1
    fixed_versions: vers:maven/13.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-gg53-wf5x-r3r6/GHSA-gg53-wf5x-r3r6.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
  - CWE-862
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-gg53-wf5x-r3r6
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-14075
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-18983
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31167
    reference_type:
    reference_id: CVE-2022-31167
