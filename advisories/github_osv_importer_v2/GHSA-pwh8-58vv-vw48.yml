advisory_id: GHSA-pwh8-58vv-vw48
datasource_id: github_osv_importer_v2/GHSA-pwh8-58vv-vw48
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-pwh8-58vv-vw48/GHSA-pwh8-58vv-vw48.json
aliases:
  - CVE-2023-41900
summary: "Jetty's OpenId Revoked authentication allows one request\nIf a Jetty `OpenIdAuthenticator`\
  \ uses the optional nested `LoginService`, and that `LoginService` decides to revoke an already\
  \ authenticated user, then the current request will still treat the user as authenticated.\
  \ The authentication is then cleared from the session and subsequent requests will not be\
  \ treated as authenticated. \n\nSo a request on a previously authenticated session could be\
  \ allowed to bypass authentication after it had been rejected by the `LoginService`.\n\n###\
  \ Impact\nThis impacts usages of the jetty-openid which have configured a nested `LoginService`\
  \ and where that `LoginService` will is capable of rejecting previously authenticated users.\n\
  \n### Original Report\n> working on a custom OpenIdAuthenticator, I discovered the following:\n\
  > \n> https://github.com/eclipse/jetty.project/blob/jetty-10.0.14/jetty-openid/src/main/java/org/eclipse/jetty/security/openid/OpenIdAuthenticator.java#L505\n\
  > \n> In the case where the LoginService does return that the authentication has been revoked\
  \ (from the validate() call on line 463), the OpenIdAuthenticator removes the authentication\
  \ from the session; however the current request still proceeds as if authenticated, since\
  \ it falls through to \"return authentication\" on line 505.\n> \n> This is fixed by moving\
  \ the line 505 (and associated debug log) inside the else block that ends on line 502, instead\
  \ of outside it. Then the revocation case will run through to line 517 and will trigger a\
  \ new OpenId authentication which I think is correct.\n> \n> I think this revocation can only\
  \ occur if you do attach a separate LoginService to the OpenIdLoginService, but in that case\
  \ the revoked authentication will still let the next request through (and possibly more than\
  \ one if they are very close to simultaneous).\n> \n> Technically I think this is a security\
  \ vulnerability, if a very minor one, so I'm sending this off-list.\n\n### Patched Versions\n\
  \nFixed in Jetty Versions:\n* 9.4.52 - fixed in PR https://github.com/eclipse/jetty.project/pull/9660\n\
  * 10.0.16 - fixed in PR https://github.com/eclipse/jetty.project/pull/9528\n* 11.0.16 - fixed\
  \ in PR https://github.com/eclipse/jetty.project/pull/9528\n* 12.0.0 - not impacted (already\
  \ has fix)\n\n### Workaround\nUpgrade your version of Jetty.\n\n### References\n* https://github.com/eclipse/jetty.project/pull/9528\n\
  * https://github.com/eclipse/jetty.project/pull/9660"
impacted_packages:
  - purl: pkg:maven/org.eclipse.jetty/jetty-openid
    affected_versions: vers:maven/<=9.4.51
    fixed_versions: vers:maven/9.4.52.v20230823
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty/jetty-openid
    affected_versions: vers:maven/<=10.0.15
    fixed_versions: vers:maven/10.0.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty/jetty-openid
    affected_versions: vers:maven/<=11.0.15
    fixed_versions: vers:maven/11.0.16
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-pwh8-58vv-vw48/GHSA-pwh8-58vv-vw48.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1390
  - CWE-287
references:
  - url: https://github.com/eclipse/jetty.project
    reference_type:
    reference_id:
  - url: https://github.com/eclipse/jetty.project/pull/9528
    reference_type:
    reference_id:
  - url: https://github.com/eclipse/jetty.project/pull/9660
    reference_type:
    reference_id:
  - url: https://github.com/eclipse/jetty.project/security/advisories/GHSA-pwh8-58vv-vw48
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20231110-0004
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2023/dsa-5507
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41900
    reference_type:
    reference_id: CVE-2023-41900
