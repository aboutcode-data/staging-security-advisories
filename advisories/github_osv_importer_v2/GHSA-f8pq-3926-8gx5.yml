advisory_id: GHSA-f8pq-3926-8gx5
datasource_id: github_osv_importer_v2/GHSA-f8pq-3926-8gx5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-f8pq-3926-8gx5/GHSA-f8pq-3926-8gx5.json
aliases: []
summary: |
  Unsanitized user controlled input in module generation
  ## Impact

  The `import-in-the-middle` loader used by `@opentelemetry/instrumentation` works by generating a wrapper module on the fly. The wrapper uses the module specifier to load the original module and add some wrapping code. It allows for remote code execution in cases where an application passes user-supplied input directly to an `import()` function.

  ## Patches

  This vulnerability has been patched in `@opentelemetry/instrumentation` version `0.41.2`

  ## Workarounds

  - Do not pass any user-supplied input to `import()`. Instead, verify it against a set of allowed values.
  - If using `@opentelemetry/instrumentation` with support for EcmaScript Modules is not needed, ensure that none of the following options are set (either via command-line or the `NODE_OPTIONS` environment variable):
  ```
  --experimental-loader=@opentelemetry/instrumentation/hook.mjs
  --experimental-loader @opentelemetry/instrumentation/hook.mjs
  --loader=import-in-the-middle/hook.mjs
  --loader import-in-the-middle/hook.mjs
  ```

  ## References

  - https://github.com/DataDog/import-in-the-middle/security/advisories/GHSA-5r27-rw8r-7967
impacted_packages:
  - purl: pkg:npm/%40opentelemetry/instrumentation
    affected_versions: vers:npm/>=0.40.0|<0.41.2
    fixed_versions: vers:npm/0.41.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-f8pq-3926-8gx5/GHSA-f8pq-3926-8gx5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/open-telemetry/opentelemetry-js
    reference_type:
    reference_id:
  - url: https://github.com/open-telemetry/opentelemetry-js/commit/ffe641c08c69f41ca8d292221dc1804d511efb28
    reference_type:
    reference_id:
  - url: https://github.com/open-telemetry/opentelemetry-js/security/advisories/GHSA-f8pq-3926-8gx5
    reference_type:
    reference_id:
