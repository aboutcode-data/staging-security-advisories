advisory_id: GHSA-r4m5-47cq-6qg8
datasource_id: github_osv_importer_v2/GHSA-r4m5-47cq-6qg8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/09/GHSA-r4m5-47cq-6qg8/GHSA-r4m5-47cq-6qg8.json
aliases: []
summary: |
  Server-Side Request Forgery in ftp-srv
  All versions of `ftp-srv` from v1.0.0 onward to v4.3.3 are vulnerable to Server-Side Request Forgery (SSRF). The package fails to prevent remote clients to access other resources in the network, for example when connecting to the server through telnet. This allows attackers to access any network resources available to the server, including private resources in the hosting environment.


  ## Recommendation

  Upgrade to patched versions
  `^2.19.6, ^3.1.2, ^4.3.4`

  ## Workarounds
  Blacklisting the FTP Command PORT will prevent the server from exposing this behaviour through active connections until a fix is applied.

  ```
  const ftp = new FtpSrv({
    blacklist: ['PORT']
  });
  ```
impacted_packages:
  - purl: pkg:npm/ftp-srv
    affected_versions: vers:npm/>=1.0.0|<2.19.6
    fixed_versions: vers:npm/2.19.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/ftp-srv
    affected_versions: vers:npm/>=3.0.0|<3.1.2
    fixed_versions: vers:npm/3.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/ftp-srv
    affected_versions: vers:npm/>=4.0.0|<4.3.4
    fixed_versions: vers:npm/4.3.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://github.com/QuorumDMS/ftp-srv
    reference_type:
    reference_id:
  - url: https://github.com/QuorumDMS/ftp-srv/security/advisories/GHSA-jw37-5gqr-cf9j
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1445
    reference_type:
    reference_id:
