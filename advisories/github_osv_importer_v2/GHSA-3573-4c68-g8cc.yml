advisory_id: GHSA-3573-4c68-g8cc
datasource_id: github_osv_importer_v2/GHSA-3573-4c68-g8cc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-3573-4c68-g8cc/GHSA-3573-4c68-g8cc.json
aliases:
  - CVE-2026-22032
summary: |
  Directus has open redirect in SAML
  ## Security Advisory: Open Redirect in Directus SAML Authentication

  ### Summary

  An open redirect vulnerability exists in the Directus SAML authentication callback endpoint. The `RelayState` parameter is used in redirects without proper validation against an allowlist of permitted domains.

  ### Vulnerability Description

  During SAML authentication, the `RelayState` parameter is intended to preserve the user's original destination. However, while the login initiation flow validates redirect targets against allowed domains, this validation is not applied to the callback endpoint. This allows an attacker to craft a malicious authentication request that redirects users to an arbitrary external URL upon completion.

  The vulnerability is present in both the success and error handling paths of the callback.

  ### Impact

  - **Phishing**: Users can be redirected to attacker-controlled sites that mimic legitimate login pages
  - **Credential theft**: Chained attacks may leverage the redirect to capture OAuth tokens or authorization codes
  - **Trust erosion**: Users may lose confidence in the application's security posture

  This vulnerability can be exploited without authentication.
impacted_packages:
  - purl: pkg:npm/directus
    affected_versions: vers:npm/<11.14.0
    fixed_versions: vers:npm/11.14.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40directus/api
    affected_versions: vers:npm/<32.1.1
    fixed_versions: vers:npm/32.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-3573-4c68-g8cc/GHSA-3573-4c68-g8cc.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/commit/dad9576ea9362905cc4de8028d3877caff36dc23
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-3573-4c68-g8cc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22032
    reference_type:
    reference_id:
