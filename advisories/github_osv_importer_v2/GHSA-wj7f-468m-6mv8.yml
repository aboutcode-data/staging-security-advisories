advisory_id: GHSA-wj7f-468m-6mv8
datasource_id: github_osv_importer_v2/GHSA-wj7f-468m-6mv8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-wj7f-468m-6mv8/GHSA-wj7f-468m-6mv8.json
aliases: []
summary: |
  Environment variables still accessible through /proc
  ### Impact

  Environment variables can be read from procfs unless a new process is started.

  ### PoC

  ```
  use birdcage::{Birdcage, Sandbox};
  use std::{env, fs};

  fn main() {
      Birdcage::new().lock().unwrap();

      assert_eq!(env::var_os("SECRET"), None);

      let environ = fs::read_to_string("/proc/self/environ").unwrap();
      assert!(!environ.contains("SECRET"), "ENVIRON CONTAINS SECRET:\n{environ}");
  }
  ```

  ```
  $  SECRET=test cargo run
  thread 'main' panicked at src/main.rs:10:5:
  ENVIRON CONTAINS SECRET:
   [truncated]
   ```

  ### Possible Solutions

  The simplest solution would be relying on the ptrace isolation and **always** spawning a new process by changing birdcage's API to create a new command. With an additional PID namespace the guarantees could be even further reinforced.
impacted_packages: []
severities:
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-wj7f-468m-6mv8/GHSA-wj7f-468m-6mv8.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/phylum-dev/birdcage
    reference_type:
    reference_id:
  - url: https://github.com/phylum-dev/birdcage/security/advisories/GHSA-wj7f-468m-6mv8
    reference_type:
    reference_id:
