advisory_id: GHSA-pf3p-x6qj-6j7q
datasource_id: github_osv_importer_v2/GHSA-pf3p-x6qj-6j7q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-pf3p-x6qj-6j7q/GHSA-pf3p-x6qj-6j7q.json
aliases:
  - CVE-2020-35922
summary: |
  mio invalidly assumes the memory layout of std::net::SocketAddr
  The mio crate has assumed std::net::SocketAddrV4 and std::net::SocketAddrV6 have the same memory layout as the system C representation sockaddr. It has simply casted the pointers to convert the socket addresses to the system representation. The standard library does not say anything about the memory layout, and this will cause invalid memory access if the standard library changes the implementation. No warnings or errors will be emitted once the change happens.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-pf3p-x6qj-6j7q/GHSA-pf3p-x6qj-6j7q.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-188
references:
  - url: https://github.com/tokio-rs/mio
    reference_type:
    reference_id:
  - url: https://github.com/tokio-rs/mio/commit/152e0751f0be1c9b0cbd6778645b76bcb0eba93c
    reference_type:
    reference_id:
  - url: https://github.com/tokio-rs/mio/issues/1386
    reference_type:
    reference_id:
  - url: https://github.com/tokio-rs/mio/pull/1388
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2020-0081.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-35922
    reference_type:
    reference_id: CVE-2020-35922
