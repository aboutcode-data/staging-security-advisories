advisory_id: GHSA-j2pc-v64r-mv4f
datasource_id: github_osv_importer_v2/GHSA-j2pc-v64r-mv4f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-j2pc-v64r-mv4f/GHSA-j2pc-v64r-mv4f.json
aliases: []
summary: |
  Protobuf Maven Plugin protocDigest is ignored when using protoc from PATH
  ### Summary
  The expected `protocDigest` is ignored when protoc is taken from the `PATH`.

  ### Details
  The documentation for the `protocDigest` parameter says:
  > ... Users may wish to specify this if using a `PATH`-based binary ...

  However, when specifying `<protoc>PATH</protoc>` the `protocDigest` is not actually checked because the code returns here already
  https://github.com/ascopes/protobuf-maven-plugin/blob/59097aae8062c461129a13dcda2f4116b90a8765/protobuf-maven-plugin/src/main/java/io/github/ascopes/protobufmavenplugin/protoc/ProtocResolver.java#L91-L93

  before the digest check:
  https://github.com/ascopes/protobuf-maven-plugin/blob/59097aae8062c461129a13dcda2f4116b90a8765/protobuf-maven-plugin/src/main/java/io/github/ascopes/protobufmavenplugin/protoc/ProtocResolver.java#L106

  ### PoC
  Specify:
  ```xml
  <protoc>PATH</protoc>
  <protocDigest>sha256:0000000000000000000000000000000000000000000000000000000000000000</protocDigest>
  ```

  And notice how the `protoc` on the `PATH` is not rejected, despite a digest mismatch.

  ### Impact
  Users who have an untrusted `protoc` executable on their `PATH` and rely `<protocDigest>` as protection are affected.
impacted_packages:
  - purl: pkg:maven/io.github.ascopes/protobuf-maven-plugin
    affected_versions: vers:maven/<=4.0.1
    fixed_versions: vers:maven/4.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/io.github.ascopes/protobuf-maven-plugin
    affected_versions: vers:maven/<3.10.2
    fixed_versions: vers:maven/3.10.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '1.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:H/AT:P/PR:L/UI:A/VC:N/VI:L/VA:N/SC:N/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-j2pc-v64r-mv4f/GHSA-j2pc-v64r-mv4f.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-354
  - CWE-693
references:
  - url: https://github.com/ascopes/protobuf-maven-plugin
    reference_type:
    reference_id:
  - url: https://github.com/ascopes/protobuf-maven-plugin/commit/d3330e7038a296fe595c5470a22019eb70e35b07
    reference_type:
    reference_id:
  - url: https://github.com/ascopes/protobuf-maven-plugin/security/advisories/GHSA-j2pc-v64r-mv4f
    reference_type:
    reference_id:
