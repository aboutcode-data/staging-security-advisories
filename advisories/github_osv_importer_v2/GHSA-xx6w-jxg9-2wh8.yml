advisory_id: GHSA-xx6w-jxg9-2wh8
datasource_id: github_osv_importer_v2/GHSA-xx6w-jxg9-2wh8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-xx6w-jxg9-2wh8/GHSA-xx6w-jxg9-2wh8.json
aliases:
  - CVE-2026-25544
summary: |
  @payloadcms/drizzle has SQL Injection in JSON/RichText Queries on PostgreSQL/SQLite Adapters
  ### Impact

  When querying JSON or richText fields, user input was directly embedded into SQL without escaping, enabling blind SQL Injection attacks. An unauthenticated attacker could extract sensitive data (emails, password reset tokens) and achieve full account takeover without password cracking.

  **Users are affected if ALL of these are true:**

  1. Payload version < v3.73.0
  2. Using a Drizzle-based database adapter (`@payloadcms/drizzle` as dependency):
     - `@payloadcms/db-postgres`
     - `@payloadcms/db-vercel-postgres`
     - `@payloadcms/db-sqlite`
     - `@payloadcms/db-d1-sqlite`
  3. At least one accessible collection that has a `type: 'json'` or `type: 'richText'` field where `access.read` returns anything other than `false` (`true` or `Where` constraint)

  **Users are NOT affected if:**

  - Using `@payloadcms/db-mongodb`
  - No JSON or richText fields exist in any collection
  - All JSON/richText fields have `access: { read: () => false }`

  ### Patches

  Upgrade to Payload **v3.73.0** or later.

  ### Workarounds

  If a project cannot upgrade immediately, add `access: { read: () => false }` to all JSON and richText fields as a temporary mitigation.
impacted_packages:
  - purl: pkg:npm/%40payloadcms/drizzle
    affected_versions: vers:npm/<3.73.0
    fixed_versions: vers:npm/3.73.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-xx6w-jxg9-2wh8/GHSA-xx6w-jxg9-2wh8.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/payloadcms/payload
    reference_type:
    reference_id:
  - url: https://github.com/payloadcms/payload/security/advisories/GHSA-xx6w-jxg9-2wh8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25544
    reference_type:
    reference_id:
