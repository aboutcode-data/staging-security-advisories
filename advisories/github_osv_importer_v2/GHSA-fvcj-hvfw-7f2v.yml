advisory_id: GHSA-fvcj-hvfw-7f2v
datasource_id: github_osv_importer_v2/GHSA-fvcj-hvfw-7f2v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-fvcj-hvfw-7f2v/GHSA-fvcj-hvfw-7f2v.json
aliases:
  - CVE-2021-1725
summary: |
  botframework-connector vulnerable to Improper Authentication
  ### Impact
  A maliciously crafted claim may be incorrectly authenticated by the bot. Impacts bots that are not configured to be used as a Skill. This vulnerability requires an attacker to have internal knowledge of the bot.

  ### Patches
  The problem has been patched in all affected versions. Please see the list of patched versions for the most appropriate one for your individual case.

  ### Workarounds
  Users who do not wish or are not able to upgrade can add an authentication configuration containing ClaimsValidator, which throws an exception if the Claims are Skill Claims.

  For detailed instructions, see the link in the References section.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [Microsoft Bot Builder SDK](https://github.com/microsoft/botbuilder-dotnet)
  * Email us at [bf-reports@microsoft.com](mailto:bf-reports@microsoft.com)
impacted_packages:
  - purl: pkg:npm/botframework-connector
    affected_versions: vers:npm/>=4.7.0|<4.7.3
    fixed_versions: vers:npm/4.7.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/botframework-connector
    affected_versions: vers:npm/4.8.0
    fixed_versions: vers:npm/4.8.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/botframework-connector
    affected_versions: vers:npm/>=4.9.0|<4.9.4
    fixed_versions: vers:npm/4.9.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/botframework-connector
    affected_versions: vers:npm/>=4.10.0|<4.10.3
    fixed_versions: vers:npm/4.10.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-fvcj-hvfw-7f2v/GHSA-fvcj-hvfw-7f2v.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-287
references:
  - url: https://aka.ms/SkillClaimsValidationJavascript
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/botbuilder-js
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/botbuilder-js/security/advisories/GHSA-fvcj-hvfw-7f2v
    reference_type:
    reference_id:
  - url: https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-1725
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/botframework-connector
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-1725
    reference_type:
    reference_id: CVE-2021-1725
