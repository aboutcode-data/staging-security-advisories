advisory_id: GHSA-6hvv-j432-23cv
datasource_id: github_osv_importer_v2/GHSA-6hvv-j432-23cv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-6hvv-j432-23cv/GHSA-6hvv-j432-23cv.json
aliases:
  - CVE-2023-34236
summary: |
  Weave GitOps Terraform Controller Information Disclosure Vulnerability
  ### Impact

  A vulnerability has been identified in Weave GitOps Terraform Controller which could allow an authenticated remote attacker to view sensitive information. This vulnerability stems from Weave GitOps Terraform Runners (`tf-runner`), where sensitive data is inadvertently printed - potentially revealing sensitive user data in their pod logs. In particular, functions `tfexec.ShowPlan`, `tfexec.ShowPlanRaw`, and `tfexec.Output` are implicated when the `tfexec` object set its `Stdout` and `Stderr` to be `os.Stdout` and `os.Stderr`.

  An unauthorized remote attacker could exploit this vulnerability by accessing these prints of sensitive information, which may contain configurations or tokens that could be used to gain unauthorized control or access to resources managed by the Terraform controller.

  A successful exploit could allow the attacker to utilize this sensitive data, potentially leading to unauthorized access or control of the system.

  ### Patches

  This vulnerability has been addressed in Weave GitOps Terraform Controller versions `v0.14.4` and `v0.15.0-rc.5`. Users are urged to upgrade to one of these versions to mitigate the vulnerability.

  The patches for this vulnerability are found in:
  - this commit: 9708fda28ccd0466cb0a8fd409854ab4d92f7dca
  - this commit: 6323b355bd7f5d2ce85d0244fe0883af3881df4e
  - this commit: 28282bc644054e157c3b9a3d38f1f9551ce09074
  - and this commit: 98a0688036e9dbcf43fa84960d9a1ef3e09a69cf

  ### Workarounds

  As a temporary measure until the patch can be applied, users can add the environment variable `DISABLE_TF_LOGS` to the tf-runners via the runner pod template of the Terraform Custom Resource. This will prevent the logging of sensitive information and mitigate the risk of this vulnerability.

  ### References

  - The first issue: https://github.com/weaveworks/tf-controller/issues/637
  - The second issue: https://github.com/weaveworks/tf-controller/issues/649

  ### For More Information

  If you have any further questions or comments about this advisory:

  Open an issue in the Weave GitOps Terraform Controller repository
  Email us at [security@weave.works](mailto:security@weave.works)
impacted_packages: []
severities:
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-6hvv-j432-23cv/GHSA-6hvv-j432-23cv.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-312
  - CWE-532
  - CWE-200
  - CWE-522
references:
  - url: https://github.com/weaveworks/tf-controller
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/commit/28282bc644054e157c3b9a3d38f1f9551ce09074
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/commit/6323b355bd7f5d2ce85d0244fe0883af3881df4e
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/commit/9708fda28ccd0466cb0a8fd409854ab4d92f7dca
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/commit/98a0688036e9dbcf43fa84960d9a1ef3e09a69cf
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/issues/637
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/issues/649
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/security/advisories/GHSA-6hvv-j432-23cv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34236
    reference_type:
    reference_id: CVE-2023-34236
