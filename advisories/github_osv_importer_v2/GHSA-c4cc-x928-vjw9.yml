advisory_id: GHSA-c4cc-x928-vjw9
datasource_id: github_osv_importer_v2/GHSA-c4cc-x928-vjw9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-c4cc-x928-vjw9/GHSA-c4cc-x928-vjw9.json
aliases:
  - CVE-2025-66578
summary: |
  robrichards/xmlseclibs has an Libxml2 Canonicalization error which can bypass Digest/Signature validation
  ### Summary
  An authentication bypass vulnerability exists due to a flaw in the libxml2 canonicalization process, which is used by [xmlseclibs](https://github.com/robrichards/xmlseclibs) during document transformation. This weakness allows an attacker to generate a valid signature once and reuse it indefinitely. In practice, a signature created during a previous interaction - or through a misconfigured authentication flow - can be replayed to bypass authentication checks.

  ### Details
  When libxml2â€™s canonicalization is invoked on an invalid XML input, it may return an empty string rather than a canonicalized node. [xmlseclibs](https://github.com/robrichards/xmlseclibs) then proceeds to compute the DigestValue over this empty string, treating it as if canonicalization succeeded.

  https://github.com/robrichards/xmlseclibs/blob/f4131320c6dcd460f1b0c67f16f8bf24ce4b5c3e/src/XMLSecurityDSig.php#L296

  ### Impact
  Digest bypass: By crafting input that causes canonicalization to yield an empty string, the attacker can manipulate validation to pass incorrectly.

  Signature replay on empty canonical form: If an empty string has been signed once (e.g., in a prior interaction or via a misconfigured flow), that signature can potentially be replayed to bypass authentication.

  ### Suggested remediation
  Treat canonicalization failures (exceptions or nil/empty outputs) as fatal and abort validation.
  Add explicit checks: reject when canonicalize returns nil/empty or raise
impacted_packages:
  - purl: pkg:composer/robrichards/xmlseclibs
    affected_versions: vers:composer/<=3.1.3
    fixed_versions: vers:composer/3.1.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-c4cc-x928-vjw9/GHSA-c4cc-x928-vjw9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-248
references:
  - url: https://github.com/robrichards/xmlseclibs
    reference_type:
    reference_id:
  - url: https://github.com/robrichards/xmlseclibs/blob/f4131320c6dcd460f1b0c67f16f8bf24ce4b5c3e/src/XMLSecurityDSig.php#L296
    reference_type:
    reference_id:
  - url: https://github.com/robrichards/xmlseclibs/commit/69fd63080bc47a8d51bc101c30b7cb756862d1d6
    reference_type:
    reference_id:
  - url: https://github.com/robrichards/xmlseclibs/security/advisories/GHSA-c4cc-x928-vjw9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66578
    reference_type:
    reference_id:
