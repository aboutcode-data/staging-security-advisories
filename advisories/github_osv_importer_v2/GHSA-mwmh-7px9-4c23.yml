advisory_id: GHSA-mwmh-7px9-4c23
datasource_id: github_osv_importer_v2/GHSA-mwmh-7px9-4c23
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-mwmh-7px9-4c23/GHSA-mwmh-7px9-4c23.json
aliases:
  - CVE-2025-64101
summary: |
  ZITADEL Vulnerable to Account Takeover via Malicious Forwarded Header Injection
  ### Impact

  A potential vulnerability exists in ZITADEL's password reset mechanism. ZITADEL utilizes the Forwarded or X-Forwarded-Host header from incoming requests to construct the URL for the password reset confirmation link. This link, containing a secret code, is then emailed to the user.

  If an attacker can manipulate these headers (e.g., via host header injection), they could cause ZITADEL to generate a password reset link pointing to a malicious domain controlled by the attacker. If the user clicks this manipulated link in the email, the secret reset code embedded in the URL can be captured by the attacker. This captured code could then be used to reset the user's password and gain unauthorized access to their account.

  It's important to note that this specific attack vector is mitigated for accounts that have Multi-Factor Authentication (MFA) or Passwordless authentication enabled.

  ### Affected Versions

  Systems running one of the following versions:
  - **4.x**: `4.0.0` to `4.5.0` (including RC versions)
  - **3.x**: `3.0.0` to `3.4.2` (including RC versions)
  - **2.x**: `v2.0.0` to `2.71.17`

  ### Patches

  Patched version ensure proper validation of the headers:

  4.x: Upgrade to >=[4.6.0](https://github.com/zitadel/zitadel/releases/tag/v4.6.0)
  3.x: Update to >=[3.4.3](https://github.com/zitadel/zitadel/releases/tag/v3.4.3)
  2.x: Update to >=[2.71.18](https://github.com/zitadel/zitadel/releases/tag/v2.71.18)

  ### Workarounds

  The recommended solution is to update ZITADEL to a patched version.

  A ZITADEL fronting proxy can be configured to delete all Forwarded and X-Forwarded-Host header values before sending requests to ZITADEL self-hosted environments.

  ### Questions

  If you have any questions or comments about this advisory, please email us at [security@zitadel.com](mailto:security@zitadel.com)

  ### Credits

  Thanks to Amit Laish â€“ GE Vernova for finding and reporting the vulnerability.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-mwmh-7px9-4c23/GHSA-mwmh-7px9-4c23.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
  - CWE-640
references:
  - url: https://github.com/zitadel/zitadel
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/72a5c33e6ac302b978d564bd049f9364f5a989b1
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/security/advisories/GHSA-mwmh-7px9-4c23
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64101
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-4084
    reference_type:
    reference_id:
