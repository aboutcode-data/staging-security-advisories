advisory_id: GHSA-v4hv-rgfq-gp49
datasource_id: github_osv_importer_v2/GHSA-v4hv-rgfq-gp49
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-v4hv-rgfq-gp49/GHSA-v4hv-rgfq-gp49.json
aliases:
  - CVE-2025-66412
summary: "Angular Stored XSS Vulnerability via SVG Animation, SVG URL and MathML Attributes\n\
  A **Stored Cross-Site Scripting ([XSS](https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss))**\
  \ vulnerability has been identified in the **Angular Template Compiler**. It occurs because\
  \ the compiler's internal security schema is incomplete, allowing attackers to bypass Angular's\
  \ built-in security sanitization. Specifically, the schema fails to classify certain URL-holding\
  \ attributes (e.g., those that could contain [`javascript:` URLs](https://developer.mozilla.org/en-US/Web/URI/Reference/Schemes/javascript))\
  \ as requiring strict URL security, enabling the injection of malicious scripts.\n\nAdditionally,\
  \ a related vulnerability exists involving SVG animation elements (`<animate>`, `<set>`, `<animateMotion>`,\
  \ `<animateTransform>`). The `attributeName` attribute on these elements was not properly\
  \ validated, allowing attackers to dynamically target security-sensitive attributes like `href`\
  \ or `xlink:href` on other elements. By binding `attributeName` to \"href\" and providing\
  \ a `javascript:` URL in the `values` or `to` attribute, an attacker could bypass sanitization\
  \ and execute arbitrary code.\n\nAttributes confirmed to be vulnerable include:\n*   SVG-related\
  \ attributes: (e.g., `xlink:href`), and various MathML attributes (e.g., `math|href`, `annotation|href`).\n\
  *   SVG animation `attributeName` attribute when bound to \"href\" or \"xlink:href\".\n\n\
  When template binding is used to assign untrusted, user-controlled data to these attributes\
  \ (e.g., `[attr.xlink:href]=\"maliciousURL\"` or `<animate [attributeName]=\"'href'\" [values]=\"\
  maliciousURL\">`), the compiler incorrectly falls back to a non-sanitizing context or fails\
  \ to block the dangerous attribute assignment. This allows an attacker to inject a `javascript:URL`\
  \ payload. Upon user interaction (like a click) on the element, or automatically in the case\
  \ of animations, the malicious JavaScript executes in the context of the application's origin.\n\
  \n### Impact\n\nWhen exploited, this vulnerability allows an attacker to execute arbitrary\
  \ code within the context of the vulnerable application's domain. This enables:\n\n* **Session\
  \ Hijacking:** Stealing session cookies and authentication tokens.  \n* **Data Exfiltration:**\
  \ Capturing and transmitting sensitive user data.  \n* **Unauthorized Actions:** Performing\
  \ actions on behalf of the user.\n\n### Patches\n\n- 19.2.17\n- 20.3.15\n- 21.0.2\n\n### Attack\
  \ Preconditions\n\n* The victim's Angular application must render data derived from **untrusted\
  \ input** (e.g., from a database or API) and bind it to one of the unsanitized URL attributes\
  \ or the `attributeName` of an SVG animation element.\n* The victim must perform a **user\
  \ interaction** (e.g., clicking) on the compromised element for the stored script to execute,\
  \ or the animation must trigger the execution.\n\n### Workarounds\n\nIf you cannot upgrade,\
  \ you can workaround the issue by ensuring that any data bound to the vulnerable attributes\
  \ is never sourced from untrusted user input (e.g., database, API response, URL parameters).\n\
  \n* **Avoid Affected Template Bindings:** Specifically avoid using template bindings (e.g.,\
  \ `[attr.xlink:href]=\"maliciousURL\"`) to assign untrusted data to the vulnerable SVG/MathML\
  \ attributes.\n* **Avoid Dynamic `attributeName` on SVG Animations:** Do not bind untrusted\
  \ data to the `attributeName` attribute of SVG animation elements (`<animate>`, `<set>`, etc.).\n\
  * **Enable [Content Security Policy (CSP)](https://angular.dev/best-practices/security#content-security-policy):**\
  \ Configure a robust CSP header that disallows `javascript:` URLs."
impacted_packages:
  - purl: pkg:npm/%40angular/compiler
    affected_versions: vers:npm/>=21.0.0-next.0|<21.0.2
    fixed_versions: vers:npm/21.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40angular/compiler
    affected_versions: vers:npm/>=20.0.0-next.0|<20.3.15
    fixed_versions: vers:npm/20.3.15
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40angular/compiler
    affected_versions: vers:npm/>=19.0.0-next.0|<19.2.17
    fixed_versions: vers:npm/19.2.17
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40angular/compiler
    affected_versions: vers:npm/<=18.2.14
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:A/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-v4hv-rgfq-gp49/GHSA-v4hv-rgfq-gp49.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/angular/angular
    reference_type:
    reference_id:
  - url: https://github.com/angular/angular/commit/1c6b0704fb63d051fab8acff84d076abfbc4893a
    reference_type:
    reference_id:
  - url: https://github.com/angular/angular/security/advisories/GHSA-v4hv-rgfq-gp49
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66412
    reference_type:
    reference_id:
