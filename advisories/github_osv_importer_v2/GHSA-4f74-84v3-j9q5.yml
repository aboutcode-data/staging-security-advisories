advisory_id: GHSA-4f74-84v3-j9q5
datasource_id: github_osv_importer_v2/GHSA-4f74-84v3-j9q5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-4f74-84v3-j9q5/GHSA-4f74-84v3-j9q5.json
aliases:
  - CVE-2023-41335
summary: |
  matrix-synapse vulnerable to temporary storage of plaintext passwords during password changes
  ### Impact

  When users update their passwords, the new credentials may be briefly held in the server database. While this doesn't grant the server any added capabilities—it already learns the users' passwords as part of the authentication process—it does disrupt the expectation that passwords won't be stored in the database. As a result, these passwords could inadvertently be captured in database backups for a longer duration.

  These temporarily stored passwords are automatically erased after a 48-hour window.

  ### Patches
  https://github.com/matrix-org/synapse/pull/16272

  ### References

  This bug was due to a regression in https://github.com/matrix-org/synapse/pull/13188.
impacted_packages:
  - purl: pkg:pypi/matrix-synapse
    affected_versions: vers:pypi/>=1.66.0|<1.93.0
    fixed_versions: vers:pypi/1.93.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-4f74-84v3-j9q5/GHSA-4f74-84v3-j9q5.json
  - score: '2.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-4f74-84v3-j9q5/GHSA-4f74-84v3-j9q5.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-312
references:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/69b74d9330e42fc91a9c7423d00a06cd6d3732bf
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/pull/13188
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/pull/16272
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-4f74-84v3-j9q5
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2023-185.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2AFB2Y3S2VCPCN5P2XCZTG24MBMZ7DM4
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/65QPC55I4D27HIZP7H2NQ34EOXHPP4AO
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/N6P4QULVUE254WI7XF2LWWOGHCYVFXFY
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202401-12
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41335
    reference_type:
    reference_id: CVE-2023-41335
