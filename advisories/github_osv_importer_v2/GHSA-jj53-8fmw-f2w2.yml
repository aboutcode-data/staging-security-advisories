advisory_id: GHSA-jj53-8fmw-f2w2
datasource_id: github_osv_importer_v2/GHSA-jj53-8fmw-f2w2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-jj53-8fmw-f2w2/GHSA-jj53-8fmw-f2w2.json
aliases:
  - CVE-2021-39163
summary: |
  Adding a private/unlisted room to a community exposes room metadata in an unauthorised manner.
  ### Impact
  Unauthorised users can access the name, avatar, topic and number of members of a room if they know the ID of the room. This vulnerability is limited to homeservers where:
  - the vulnerable homeserver is in the room; and
  - untrusted users are permitted to create groups (communities).

  By default, only homeserver administrators can create groups. However, homeserver administrators can already access this information in the database or using the admin API. As a result, only homeservers where the configuration setting `enable_group_creation` has been set to `true` are impacted.

  ### Patches
  Server administrators should upgrade to 1.41.1 or higher.

  ### Workarounds
  Server administrators can set `enable_group_creation` to `false` in their homeserver configuration (this is the default value) to prevent creation of groups by non-administrators.

  Administrators that are using a reverse proxy could, with partial loss of group functionality, block the following endpoints:
  * `/_matrix/client/r0/groups/{group_id}/rooms`
  * `/_matrix/client/unstable/groups/{group_id}/rooms`

  ### References
  n/a

  ### For more information
  If you have any questions or comments about this advisory, e-mail us at security@matrix.org.
impacted_packages:
  - purl: pkg:pypi/matrix-synapse
    affected_versions: vers:pypi/<1.41.1
    fixed_versions: vers:pypi/1.41.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-jj53-8fmw-f2w2/GHSA-jj53-8fmw-f2w2.json
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:N/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-jj53-8fmw-f2w2/GHSA-jj53-8fmw-f2w2.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/cb35df940a
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/releases/tag/v1.41.1
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-jj53-8fmw-f2w2
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-424.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39163
    reference_type:
    reference_id: CVE-2021-39163
