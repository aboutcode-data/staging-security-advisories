advisory_id: GHSA-pvmm-55r5-g3mm
datasource_id: github_osv_importer_v2/GHSA-pvmm-55r5-g3mm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-pvmm-55r5-g3mm/GHSA-pvmm-55r5-g3mm.json
aliases:
  - CVE-2024-45591
summary: |
  XWiki Platform document history including authors of any page exposed to unauthorized actors
  ### Impact
  The REST API exposes the history of any page in XWiki of which the attacker knows the name. The exposed information includes for each modification of the page the time of the modification, the version number, the author of the modification (both username and displayed name) and the version comment. This information is exposed regardless of the rights setup, and even when the wiki is configured to be fully private.

  On a private wiki, this can be tested by accessing `/xwiki/rest/wikis/xwiki/spaces/Main/pages/WebHome/history`, if this shows the history of the main page then the installation is vulnerable.

  ### Patches
  This has been patched in XWiki 15.10.9 and XWiki 16.3.0RC1.

  ### Workarounds
  There aren't any known workarounds apart from upgrading to a fixed version.

  ### References
  * https://jira.xwiki.org/browse/XWIKI-22052
  * https://github.com/xwiki/xwiki-platform/commit/9cbca9808300797c67779bb9a665d85cf9e3d4b8
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rest-server
    affected_versions: vers:maven/>=1.8.0|<15.10.9
    fixed_versions: vers:maven/15.10.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rest-server
    affected_versions: vers:maven/>=16.0.0-rc-1|<16.3.0-rc-1
    fixed_versions: vers:maven/16.3.0-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-pvmm-55r5-g3mm/GHSA-pvmm-55r5-g3mm.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-pvmm-55r5-g3mm/GHSA-pvmm-55r5-g3mm.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-359
  - CWE-862
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/26482ee5d29fc21f31134d1ee13db48716e89e0f
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/9cbca9808300797c67779bb9a665d85cf9e3d4b8
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-pvmm-55r5-g3mm
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22052
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45591
    reference_type:
    reference_id: CVE-2024-45591
