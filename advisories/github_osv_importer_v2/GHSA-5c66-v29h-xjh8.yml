advisory_id: GHSA-5c66-v29h-xjh8
datasource_id: github_osv_importer_v2/GHSA-5c66-v29h-xjh8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-5c66-v29h-xjh8/GHSA-5c66-v29h-xjh8.json
aliases:
  - CVE-2021-29459
summary: |
  XSS Cross Site Scripting
  ### Impact
  It is possible to persistently inject scripts in XWiki.

  For unregistred users:
  - By filling simple text fields

  For registered users:
  - By filling their personal information
  - (if they have edit rights) By filling the values of static lists using App Within Minutes

  That can lead to user's session hijacking, and if used in conjunction with a social engineering attack it can also lead to disclosure of sensitive data, CSRF attacks and other security vulnerabilities.
  That can also lead to the attacker taking over an account.
  If the victim has administrative rights it might even lead to code execution on the server, depending on the application and the privileges of the account.
  ### Patches
  It has been patched on XWiki 12.8 and 12.6.3.

  ### Workarounds
  There is no easy workaround except upgrading XWiki.

  ### References
  https://jira.xwiki.org/browse/XWIKI-17374

  ### For more information
  If you have any questions or comments about this advisory:
    * Open an issue in [Jira XWiki](https://jira.xwiki.org)
    * Email us at our [security mailing list](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-oldcore
    affected_versions: vers:maven/<12.6.3
    fixed_versions: vers:maven/12.6.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-oldcore
    affected_versions: vers:maven/>=12.6.4|<12.8
    fixed_versions: vers:maven/12.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web
    affected_versions: vers:maven/<12.6.3
    fixed_versions: vers:maven/12.6.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web
    affected_versions: vers:maven/>=12.6.4|<12.8
    fixed_versions: vers:maven/12.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-5c66-v29h-xjh8/GHSA-5c66-v29h-xjh8.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5c66-v29h-xjh8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29459
    reference_type:
    reference_id: CVE-2021-29459
