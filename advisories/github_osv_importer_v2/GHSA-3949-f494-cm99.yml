advisory_id: GHSA-3949-f494-cm99
datasource_id: github_osv_importer_v2/GHSA-3949-f494-cm99
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-3949-f494-cm99/GHSA-3949-f494-cm99.json
aliases:
  - CVE-2022-23647
summary: |
  Cross-site Scripting in Prism
  ### Impact
  Prism's [Command line plugin](https://prismjs.com/plugins/command-line/) can be used by attackers to achieve an XSS attack. The Command line plugin did not properly escape its output, leading to the input text being inserted into the DOM as HTML code.

  Server-side usage of Prism is not impacted. Websites that do not use the Command Line plugin are also not impacted.

  ### Patches
  This bug has been fixed in v1.27.0.

  ### Workarounds
  Do not use the Command line plugin on untrusted inputs, or sanitized all code blocks (remove all HTML code text) from all code blocks that use the Command line plugin.

  ### References
  - https://github.com/PrismJS/prism/pull/3341
impacted_packages:
  - purl: pkg:npm/prismjs
    affected_versions: vers:npm/>=1.14.0|<1.27.0
    fixed_versions: vers:npm/1.27.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-3949-f494-cm99/GHSA-3949-f494-cm99.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/PrismJS/prism
    reference_type:
    reference_id:
  - url: https://github.com/PrismJS/prism/commit/e002e78c343154e1c0ddf9d6a0bb85689e1a5c7c
    reference_type:
    reference_id:
  - url: https://github.com/PrismJS/prism/pull/3341
    reference_type:
    reference_id:
  - url: https://github.com/PrismJS/prism/security/advisories/GHSA-3949-f494-cm99
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23647
    reference_type:
    reference_id: CVE-2022-23647
