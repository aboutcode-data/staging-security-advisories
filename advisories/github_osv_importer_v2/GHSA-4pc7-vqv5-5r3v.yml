advisory_id: GHSA-4pc7-vqv5-5r3v
datasource_id: github_osv_importer_v2/GHSA-4pc7-vqv5-5r3v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-4pc7-vqv5-5r3v/GHSA-4pc7-vqv5-5r3v.json
aliases:
  - CVE-2021-3827
summary: |
  ECP SAML binding bypasses authentication flows
  ### Description
  A flaw was found in keycloak, where the default ECP binding flow allows other authentication flows to be bypassed. By exploiting this behavior an attacker can bypass the MFA authentication by sending a SOAP request with an AuthnRequest and Authorization header with the user's credentials. The highest threat from this vulnerability is to confidentiality and integrity.
impacted_packages:
  - purl: pkg:maven/org.keycloak/keycloak-saml-core
    affected_versions: vers:maven/<18.0.0
    fixed_versions: vers:maven/18.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/04/GHSA-4pc7-vqv5-5r3v/GHSA-4pc7-vqv5-5r3v.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://access.redhat.com/security/cve/CVE-2021-3827
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2007512
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak/commit/44000caaf5051d7f218d1ad79573bd3d175cad0d
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak/security/advisories/GHSA-4pc7-vqv5-5r3v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3827
    reference_type:
    reference_id: CVE-2021-3827
