advisory_id: GHSA-h2wg-v8wg-jhxh
datasource_id: github_osv_importer_v2/GHSA-h2wg-v8wg-jhxh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-h2wg-v8wg-jhxh/GHSA-h2wg-v8wg-jhxh.json
aliases:
  - CVE-2024-47056
summary: "Mautic does not shield .env files from web traffic\n### Summary \nThis advisory addresses\
  \ a security vulnerability in Mautic where sensitive `.env` configuration files may be directly\
  \ accessible via a web browser. This exposure could lead to the disclosure of sensitive information,\
  \ including database credentials, API keys, and other critical system configurations.\n\n\
  Sensitive Information Disclosure via `.env` File Exposure: The `.env` file, which typically\
  \ contains environment variables and sensitive application configurations, is directly accessible\
  \ via a web browser due to missing web server configurations that restrict access to such\
  \ files. This allows an unauthenticated attacker to view the contents of this file by simply\
  \ navigating to its URL.\n\n### Mitigation\nUpdate Mautic to the latest Mautic version.\n\
  By default, Mautic does not use `.env` files for production data.\n\n**For Apache users:**\
  \ Ensure your web server is configured to respect `.htaccess` files.\n\n**For Nginx users:**\
  \ As Nginx does not inherently support `.htaccess` files, you must manually add a configuration\
  \ block to your Nginx server configuration to deny access to `.env` files. Add the following\
  \ to your Nginx configuration for the Mautic site:\n\n```nginx\nlocation ~ /\\.env {\n   \
  \ deny all;\n}\n```\n\nAfter modifying your Nginx configuration, remember to reload or restart\
  \ your Nginx service for the changes to take effect."
impacted_packages:
  - purl: pkg:composer/mautic/core
    affected_versions: vers:composer/>=4.4.0|<4.4.16
    fixed_versions: vers:composer/4.4.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/mautic/core
    affected_versions: vers:composer/>=5.0.0-alpha|<5.2.6
    fixed_versions: vers:composer/5.2.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/mautic/core
    affected_versions: vers:composer/>=6.0.0-alpha|<6.0.2
    fixed_versions: vers:composer/6.0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-h2wg-v8wg-jhxh/GHSA-h2wg-v8wg-jhxh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-312
  - CWE-526
references:
  - url: https://github.com/mautic/mautic
    reference_type:
    reference_id:
  - url: https://github.com/mautic/mautic/security/advisories/GHSA-h2wg-v8wg-jhxh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47056
    reference_type:
    reference_id: CVE-2024-47056
