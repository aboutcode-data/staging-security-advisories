advisory_id: GHSA-h99w-9q5r-gjq9
datasource_id: github_osv_importer_v2/GHSA-h99w-9q5r-gjq9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-h99w-9q5r-gjq9/GHSA-h99w-9q5r-gjq9.json
aliases:
  - CVE-2022-24790
summary: "Puma vulnerable to HTTP Request Smuggling\nWhen using Puma behind a proxy that does\
  \ not properly validate that the incoming HTTP request matches the RFC7230 standard, Puma\
  \ and the frontend proxy may disagree on where a request starts and ends. This would allow\
  \ requests to be smuggled via the front-end proxy to Puma.\n\nThe following vulnerabilities\
  \ are addressed by this advisory:\n- Lenient parsing of `Transfer-Encoding` headers, when\
  \ unsupported encodings should be rejected and the final encoding must be `chunked`.\n- Lenient\
  \ parsing of malformed `Content-Length` headers and chunk sizes, when only digits and hex\
  \ digits should be allowed.\n- Lenient parsing of duplicate `Content-Length` headers, when\
  \ they should be rejected.\n- Lenient parsing of the ending of chunked segments, when they\
  \ should end with `\\r\\n`.\n\nThe vulnerability has been fixed in 5.6.4 and 4.3.12. When\
  \ deploying a proxy in front of Puma, turning on any and all functionality to make sure that\
  \ the request matches the RFC7230 standard. \n\nThese proxy servers are known to have \"good\"\
  \ behavior re: this standard and upgrading Puma may not be necessary. Users are encouraged\
  \ to validate for themselves.\n\n- Nginx (latest)\n- Apache (latest)\n- Haproxy 2.5+\n- Caddy\
  \ (latest)\n- Traefik (latest)"
impacted_packages:
  - purl: pkg:gem/puma
    affected_versions: vers:gem/>=5.0.0|<5.6.4
    fixed_versions: vers:gem/5.6.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/puma
    affected_versions: vers:gem/<4.3.12
    fixed_versions: vers:gem/4.3.12
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-h99w-9q5r-gjq9/GHSA-h99w-9q5r-gjq9.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-444
references:
  - url: https://github.com/puma/puma
    reference_type:
    reference_id:
  - url: https://github.com/puma/puma/commit/5bb7d202e24dec00a898dca4aa11db391d7787a5
    reference_type:
    reference_id:
  - url: https://github.com/puma/puma/security/advisories/GHSA-h99w-9q5r-gjq9
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/puma/CVE-2022-24790.yml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/08/msg00015.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/F6YWGIIKL7KKTS3ZOAYMYPC7D6WQ5OA5
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L7NESIBFCNSR3XH7LXDPKVMSUBNUB43G
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TUBFJ44NCKJ34LECZRAP4N5VL6USJSIB
    reference_type:
    reference_id:
  - url: https://portswigger.net/web-security/request-smuggling
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202208-28
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2022/dsa-5146
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24790
    reference_type:
    reference_id: CVE-2022-24790
