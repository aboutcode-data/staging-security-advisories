advisory_id: GHSA-7w85-pp86-p4pq
datasource_id: github_osv_importer_v2/GHSA-7w85-pp86-p4pq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-7w85-pp86-p4pq/GHSA-7w85-pp86-p4pq.json
aliases:
  - CVE-2022-31190
summary: "XMLUI's metadata of withdrawn Items is exposed to anonymous users\n### Impact\nMetadata\
  \ on a withdrawn Item is exposed via the XMLUI \"mets.xml\" object, as long as you know the\
  \ handle/URL of the withdrawn Item. This vulnerability only impacts the XMLUI.\n\nHowever,\
  \ this vulnerability is very low severity as Item metadata does not tend to contain highly\
  \ secure or sensitive information.\n\n_This vulnerability does NOT impact the JSPUI or 7.x._\n\
  \n### Patches\n\nBecause of the low severity of this security issue, it requires updating\
  \ to 6.4 to resolve.  _No patch is available for 5.x or below._\n\n_DSpace 6.x:_\n* Fixed\
  \ in 6.4 via #2451 \n* 6.x patch file: https://github.com/DSpace/DSpace/commit/574e25496a40173653ae7d0a49a19ed8e3458606.patch\
  \ (may be applied manually if an immediate upgrade to 6.4 or above is not possible)\n\n####\
  \ Apply the patch to your DSpace\nIf at all possible, we recommend upgrading your DSpace site\
  \ based on the upgrade instructions. However, if you are unable to do so, you can manually\
  \ apply the above patches as follows:\n1. Download the appropriate patch file to the machine\
  \ where DSpace is running\n2. From the `[dspace-src]` folder, apply the patch, e.g. `git apply\
  \ [name-of-file].patch`\n3. Now, update your DSpace site (based loosely on the Upgrade instructions).\
  \ This generally involves three steps:\n    1. Rebuild DSpace, e.g. `mvn -U clean package`\
  \  (This will recompile all DSpace code)\n    2. Redeploy DSpace, e.g. `ant update`  (This\
  \ will copy all updated WARs / configs to your installation directory). Depending on your\
  \ setup you also may need to copy the updated WARs over to your Tomcat webapps folder.\n \
  \   3. Restart Tomcat\n\n### Workaround\n\nIf there are any withdrawn items which are known\
  \ to have highly secure information in their metadata, they can be permanently deleted. This\
  \ will ensure their secure metadata is inaccessible & removed from the system entirely.\n\n\
  ### References\nDiscovered & reported by David Cavrenne of Atmire\n\n### For more information\n\
  If you have any questions or comments about this advisory:\n* Email us at security@dspace.org"
impacted_packages:
  - purl: pkg:maven/org.dspace/dspace-xmlui
    affected_versions: vers:maven/<=6.3
    fixed_versions: vers:maven/6.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-7w85-pp86-p4pq/GHSA-7w85-pp86-p4pq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-863
references:
  - url: https://github.com/DSpace/DSpace
    reference_type:
    reference_id:
  - url: https://github.com/DSpace/DSpace/commit/574e25496a40173653ae7d0a49a19ed8e3458606.patch
    reference_type:
    reference_id:
  - url: https://github.com/DSpace/DSpace/pull/2451
    reference_type:
    reference_id:
  - url: https://github.com/DSpace/DSpace/security/advisories/GHSA-7w85-pp86-p4pq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31190
    reference_type:
    reference_id: CVE-2022-31190
