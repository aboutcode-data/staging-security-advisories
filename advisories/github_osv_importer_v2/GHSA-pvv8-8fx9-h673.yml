advisory_id: GHSA-pvv8-8fx9-h673
datasource_id: github_osv_importer_v2/GHSA-pvv8-8fx9-h673
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-pvv8-8fx9-h673/GHSA-pvv8-8fx9-h673.json
aliases:
  - CVE-2021-41151
summary: |
  Path Traversal in @backstage/plugin-scaffolder-backend
  ### Impact

  A malicious actor could read sensitive files from the environment where Scaffolder tasks are run. The attack is executed by crafting a custom Scaffolder template with a `publish:github:pull-request` action using a particular source path. When the template is executed the sensitive files would be included in the published pull request.

  This vulnerability is mitigated by the fact that an attacker would need access to create and register templates in the Backstage catalog, and that the attack is very visible given that the exfiltration happens via a pull request.

  ### Patches

  The vulnerability is patched in the `0.15.9` release of `@backstage/plugin-scaffolder-backend`.

  ### For more information

  If you have any questions or comments about this advisory:

  * Open an issue in the [Backstage repository](https://github.com/backstage/backstage)
  * Visit our chat, linked to in [Backstage README](https://github.com/backstage/backstage)
impacted_packages:
  - purl: pkg:npm/%40backstage/plugin-scaffolder-backend
    affected_versions: vers:npm/>=0.9.4|<0.15.9
    fixed_versions: vers:npm/0.15.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-pvv8-8fx9-h673/GHSA-pvv8-8fx9-h673.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/backstage/backstage
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/commit/6968962c920508eae19a4c1c200fa2c8980a4006
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/releases/tag/release-2021-10-16
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/security/advisories/GHSA-pvv8-8fx9-h673
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41151
    reference_type:
    reference_id: CVE-2021-41151
