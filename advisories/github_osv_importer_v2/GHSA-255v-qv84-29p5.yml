advisory_id: GHSA-255v-qv84-29p5
datasource_id: github_osv_importer_v2/GHSA-255v-qv84-29p5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-255v-qv84-29p5/GHSA-255v-qv84-29p5.json
aliases:
  - CVE-2025-59353
summary: |
  DragonFly's manager generates mTLS certificates for arbitrary IP addresses
  ### Impact
  A peer can obtain a valid TLS certificate for arbitrary IP addresses, effectively rendering the mTLS authentication useless. The issue is that the Manager’s Certificate gRPC service does not validate if the requested IP addresses “belong to” the peer requesting the certificate—that is, if the peer connects from the same IP address as the one provided in the certificate request.

  ```golang
  if addr, ok := p.Addr.(*net.TCPAddr); ok {
         ip = addr.IP.String()
  } else {
         ip, _, err = net.SplitHostPort(p.Addr.String())
         if err != nil {
               return nil, err
         }
  }
  // Parse csr.
  [skipped]
  // Check csr signature.
  // TODO check csr common name and so on.
  if err = csr.CheckSignature(); err != nil {
         return nil, err
  }
  [skipped]
  // TODO only valid for peer ip
  // BTW we need support both of ipv4 and ipv6.
  ips := csr.IPAddresses
  if len(ips) == 0 {
         // Add default connected ip.
         ips = []net.IP{net.ParseIP(ip)}
  }
  ```
  ### Patches

  - Dragonfy v2.1.0 and above.

  ### Workarounds

  There are no effective workarounds, beyond upgrading.

  ### References

  A third party security audit was performed by Trail of Bits, you can see the [full report](https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf).

  If you have any questions or comments about this advisory, please email us at [dragonfly-maintainers@googlegroups.com](mailto:dragonfly-maintainers@googlegroups.com).
impacted_packages: []
severities:
  - score: '7.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-255v-qv84-29p5/GHSA-255v-qv84-29p5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-295
references:
  - url: https://github.com/dragonflyoss/dragonfly
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-255v-qv84-29p5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59353
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3969
    reference_type:
    reference_id:
