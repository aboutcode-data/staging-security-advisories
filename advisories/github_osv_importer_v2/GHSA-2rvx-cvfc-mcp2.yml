advisory_id: GHSA-2rvx-cvfc-mcp2
datasource_id: github_osv_importer_v2/GHSA-2rvx-cvfc-mcp2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-2rvx-cvfc-mcp2/GHSA-2rvx-cvfc-mcp2.json
aliases:
  - CVE-2017-9246
summary: |
  New Relic .NET Agent contains SQL Injection
  New Relic .NET Agent before 6.3.123.0 adds SQL injection flaws to safe applications via vectors involving failure to escape quotes during use of the Slow Queries feature, as demonstrated by a mishandled quote in a VALUES clause of an INSERT statement, after bypassing a SET SHOWPLAN_ALL ON protection mechanism.
impacted_packages:
  - purl: pkg:nuget/NewRelic.Agent
    affected_versions: vers:nuget/<6.3.123
    fixed_versions: vers:nuget/6.3.123
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-2rvx-cvfc-mcp2/GHSA-2rvx-cvfc-mcp2.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/newrelic/newrelic-dotnet-agent
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20221202191459/https://blog.seanmcelroy.com/2017/05/26/sql-injection-with-new-relic-patched
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-9246
    reference_type:
    reference_id: CVE-2017-9246
