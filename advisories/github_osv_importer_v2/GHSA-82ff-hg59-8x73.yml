advisory_id: GHSA-82ff-hg59-8x73
datasource_id: github_osv_importer_v2/GHSA-82ff-hg59-8x73
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-82ff-hg59-8x73/GHSA-82ff-hg59-8x73.json
aliases:
  - CVE-2025-47909
summary: |
  github.com/gorilla/csrf improperly validates TrustedOrigins allowing CSRF attacks
  Hosts listed in TrustedOrigins implicitly allow requests from the corresponding HTTP origins, allowing network MitMs to perform CSRF attacks.

  After the CVE-2025-24358 fix, a network attacker that places a form at http://example.com can't get it to submit to https://example.com because the Origin header is checked with sameOrigin against a synthetic URL.

  However, if a host is added to TrustedOrigins, both its HTTP and HTTPS origins will be allowed, because the schema of the synthetic URL is ignored and only the host is checked. For example, if an application is hosted on https://example.com and adds example.net to TrustedOrigins, a network attacker can serve a form at http://example.net to perform the attack.

  Applications should migrate to net/http.CrossOriginProtection, introduced in Go 1.25. If that is not an option, a backport is available as a module at filippo.io/csrf, and a drop-in replacement for the github.com/gorilla/csrf API is available at filippo.io/csrf/gorilla.
impacted_packages: []
severities:
  - score: '4.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:A/AC:L/AT:N/PR:N/UI:P/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-82ff-hg59-8x73/GHSA-82ff-hg59-8x73.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
  - CWE-807
references:
  - url: https://github.com/golang/vulndb/issues/3884
    reference_type:
    reference_id:
  - url: https://github.com/gorilla/csrf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-47909
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3884
    reference_type:
    reference_id:
