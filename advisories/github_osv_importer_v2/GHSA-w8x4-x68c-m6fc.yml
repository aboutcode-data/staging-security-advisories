advisory_id: GHSA-w8x4-x68c-m6fc
datasource_id: github_osv_importer_v2/GHSA-w8x4-x68c-m6fc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-w8x4-x68c-m6fc/GHSA-w8x4-x68c-m6fc.json
aliases:
  - CVE-2026-22787
summary: |
  html2pdf.js contains a cross-site scripting vulnerability
  ### Impact
  html2pdf.js contains a cross-site scripting (XSS) vulnerability when given a text source rather than an element. This text is not sufficiently sanitized before being attached to the DOM, allowing malicious scripts to be run on the client browser and risking the confidentiality, integrity, and availability of the page's data.

  Example attack vector:

  ```js
  import html2pdf from 'html2pdf.js/src/index.js';

  const maliciousHTML = '<img src=x onerror="alert(document.cookie)">';
  html2pdf(maliciousHTML);
  // or html2pdf().from(maliciousHTML);
  ```

  ### Patches
  This vulnerability has been fixed in html2pdf.js@0.14.0 to sanitize text sources using DOMPurify. There are no other breaking changes in this version.

  ### Workarounds
  Users of earlier versions of html2pdf.js must safely sanitize any text before using it as a source in html2pdf.js.

  ### References
  - Initial report: https://github.com/eKoopmans/html2pdf.js/issues/865
  - Fix: https://github.com/eKoopmans/html2pdf.js/pull/877, [v0.14.0](https://github.com/eKoopmans/html2pdf.js/releases/tag/v0.14.0)
  - CVE-2026-22787: https://nvd.nist.gov/vuln/detail/CVE-2026-22787
impacted_packages:
  - purl: pkg:npm/html2pdf.js
    affected_versions: vers:npm/<0.14.0
    fixed_versions: vers:npm/0.14.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:H/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-w8x4-x68c-m6fc/GHSA-w8x4-x68c-m6fc.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://aydinnyunus.github.io/2026/01/17/cve-2026-22787-html2pdf-xss-vulnerability
    reference_type:
    reference_id:
  - url: https://github.com/eKoopmans/html2pdf.js
    reference_type:
    reference_id:
  - url: https://github.com/eKoopmans/html2pdf.js/commit/988826e336035b39a8608182d7b73c0e3cd78c7b
    reference_type:
    reference_id:
  - url: https://github.com/eKoopmans/html2pdf.js/issues/865
    reference_type:
    reference_id:
  - url: https://github.com/eKoopmans/html2pdf.js/pull/877
    reference_type:
    reference_id:
  - url: https://github.com/eKoopmans/html2pdf.js/releases/tag/v0.14.0
    reference_type:
    reference_id:
  - url: https://github.com/eKoopmans/html2pdf.js/security/advisories/GHSA-w8x4-x68c-m6fc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22787
    reference_type:
    reference_id:
