advisory_id: GHSA-6fgx-x7m2-74qm
datasource_id: github_osv_importer_v2/GHSA-6fgx-x7m2-74qm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-6fgx-x7m2-74qm/GHSA-6fgx-x7m2-74qm.json
aliases: []
summary: |
  tracexec has `env` command argument injection via environment variables starting with dash in traced exec events
  ### Impact

  For tracexec's command line reconstruction feature, when a traced process executes another process with a environment variable where the key starts with a dash, tracexec incorrectly shows its commandline where such environment variables could cause argument injection for the `env` command.
  Such an injection is completely at the UI level unless the user tries to copy the command line with the injection and paste it into a terminal to execute it.

  A minimal POC is executing `env -- -a=b bash --norc` in tracexec's TUI mode. The resulting command line of `env` executing bash would be `env -a bash -a=b  _=/usr/bin/env /usr/bin/bash --norc` in tracexec's TUI, which injects `-a=b` into `env`'s arguments.

  This has very limited effect for security.  A local adversarial could leverage this to make tracexec show an inaccurate reconstructed commandline for their executed command. If the user of tracexec decides to copy and run the reconstructed commandline,
  there could be injection for `env`'s `--block-signal`, `--default-signal`, `--ignore-signal`, `--split-string`, `--unset`, `--chdir`, `--argv0` arguments.

  ### Patches
  The fix is https://github.com/kxxt/tracexec/pull/118. Users are advised to upgrade to 0.14.0.

  ### Workarounds

  Don't blindly paste and execute commands copied from tracexec that contains environment variable where the key starts with a dash.
impacted_packages: []
severities:
  - score: '1.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:A/VC:L/VI:L/VA:L/SC:L/SI:L/SA:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-6fgx-x7m2-74qm/GHSA-6fgx-x7m2-74qm.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
  - CWE-88
references:
  - url: https://github.com/kxxt/tracexec
    reference_type:
    reference_id:
  - url: https://github.com/kxxt/tracexec/commit/0dbe63214c8686df5bb62dbe6142cce27868ecff
    reference_type:
    reference_id:
  - url: https://github.com/kxxt/tracexec/pull/118
    reference_type:
    reference_id:
  - url: https://github.com/kxxt/tracexec/security/advisories/GHSA-6fgx-x7m2-74qm
    reference_type:
    reference_id:
