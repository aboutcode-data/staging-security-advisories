advisory_id: GHSA-xvc9-xwgj-4cq9
datasource_id: github_osv_importer_v2/GHSA-xvc9-xwgj-4cq9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-xvc9-xwgj-4cq9/GHSA-xvc9-xwgj-4cq9.json
aliases:
  - CVE-2019-25008
summary: |
  Duplicate Advisory: Integer Overflow in HeaderMap::reserve() can cause Denial of Service
  ### Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-x7vr-c387-8w57. This link is maintained to preserve external references.

  ### Original Description

  HeaderMap::reserve() used usize::next_power_of_two() to calculate the increased capacity. However, next_power_of_two() silently overflows to 0 if given a sufficiently large number in release mode.

  If the map was not empty when the overflow happens, the library will invoke self.grow(0) and start infinite probing. This allows an attacker who controls the argument to reserve() to cause a potential denial of service (DoS).

  The flaw was corrected in 0.1.20 release of http crate.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-xvc9-xwgj-4cq9/GHSA-xvc9-xwgj-4cq9.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-190
references:
  - url: https://github.com/hyperium/http
    reference_type:
    reference_id:
  - url: https://github.com/hyperium/http/issues/352
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2019-0033.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-25008
    reference_type:
    reference_id: CVE-2019-25008
