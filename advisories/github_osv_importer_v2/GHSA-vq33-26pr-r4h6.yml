advisory_id: GHSA-vq33-26pr-r4h6
datasource_id: github_osv_importer_v2/GHSA-vq33-26pr-r4h6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-vq33-26pr-r4h6/GHSA-vq33-26pr-r4h6.json
aliases:
  - CVE-2020-28279
summary: |
  flattenizer vulnerable to prototype pollution
  ### Overview
  Prototype pollution vulnerability in ‘flattenizer’ versions 0.0.5 through 1.0.5 allows an attacker to cause a denial of service and may lead to remote code execution.

  ### Details
  The NPM module 'flattenizer' can be abused by Prototype Pollution vulnerability since the function 'unflatten()' did not check for the type of object before assigning value to the property. Due to this flaw an attacker could create a non-existent property or able to manipulate the property which leads to Denial of Service or potentially Remote code execution.

  ### PoC Details
  There is no validation before assigning the property to check whether the assigned argument is the Object's own property or not, the property `polluted` will be directly be assigned thereby polluting the Object prototype. Later in the code, if there is a check to validate `polluted` the valued would be substituted as "true" as it had been polluted.

  ```js
  var flattenizer = require("flattenizer")
  flattenizer.unflatten({'__proto__.polluted': true});
  console.log(polluted);
  ```
impacted_packages:
  - purl: pkg:npm/flattenizer
    affected_versions: vers:npm/<=1.0.5
    fixed_versions: vers:npm/1.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-vq33-26pr-r4h6/GHSA-vq33-26pr-r4h6.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1321
references:
  - url: https://github.com/sahellebusch/flattenizer/commit/3c6a6353df7c8879e931973b81a49a47f6c2b399
    reference_type:
    reference_id:
  - url: https://github.com/sahellebusch/flattenizer/pull/13
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20210104205035/https://www.whitesourcesoftware.com/vulnerability-database/CVE-2020-28279
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-28279
    reference_type:
    reference_id: CVE-2020-28279
