advisory_id: GHSA-xvxq-g8hw-fx4g
datasource_id: github_osv_importer_v2/GHSA-xvxq-g8hw-fx4g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-xvxq-g8hw-fx4g/GHSA-xvxq-g8hw-fx4g.json
aliases:
  - CVE-2024-49377
summary: "OctoPrint Vulnerable to Reflected XSS in Jinja2 Templates\n### Impact\n\nOctoPrint\
  \ versions up until and including 1.10.2 are vulnerable to reflected XSS vulnerabilities through\
  \ its Jinja2 template system, as this is not configured to enforce automatic escaping. This\
  \ affects, among other places, the login dialog and the standalone application key confirmation\
  \ dialog. \n\nAn attacker who successfully talked a victim into clicking on or through a malicious\
  \ third party app successfully redirected a victim to a specially crafted link could use this\
  \ to retrieve or modify sensitive configuration settings, interrupt prints or otherwise interact\
  \ with the OctoPrint instance in a malicious way.\n\n### Patches\n\nThe above mentioned specific\
  \ vulnerabilities of the login dialog and the standalone application key confirmation dialog\
  \ will be patched in the bugfix release 1.10.3 by individual escaping of the detected locations.\
  \ A global change throughout all of OctoPrint's templating system with the upcoming 1.11.0\
  \ release will handle this further, switching to globally enforced automatic escaping and\
  \ thus reducing the attack surface in general.\n\nThe latter will also improve the security\
  \ of third party plugins. During a transition period, third party plugins will be able to\
  \ opt into the automatic escaping. With OctoPrint 1.13.0, automatic escaping will be switched\
  \ over to be enforced even for third party plugins, unless they explicitly opt-out.\n\n###\
  \ Credits\n\nThis vulnerability was discovered and responsibly disclosed to OctoPrint by Jacopo\
  \ Tediosi."
impacted_packages:
  - purl: pkg:pypi/octoprint
    affected_versions: vers:pypi/<=1.10.2
    fixed_versions: vers:pypi/1.10.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-xvxq-g8hw-fx4g/GHSA-xvxq-g8hw-fx4g.json
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:A/AC:L/AT:N/PR:N/UI:P/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/11/GHSA-xvxq-g8hw-fx4g/GHSA-xvxq-g8hw-fx4g.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/OctoPrint/OctoPrint
    reference_type:
    reference_id:
  - url: https://github.com/OctoPrint/OctoPrint/commit/b8a6b0a75202edac3bb142a8e4f9041a0b6825bf
    reference_type:
    reference_id:
  - url: https://github.com/OctoPrint/OctoPrint/security/advisories/GHSA-xvxq-g8hw-fx4g
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/octoprint/PYSEC-2024-201.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49377
    reference_type:
    reference_id: CVE-2024-49377
