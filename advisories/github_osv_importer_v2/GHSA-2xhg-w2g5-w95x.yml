advisory_id: GHSA-2xhg-w2g5-w95x
datasource_id: github_osv_importer_v2/GHSA-2xhg-w2g5-w95x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-2xhg-w2g5-w95x/GHSA-2xhg-w2g5-w95x.json
aliases:
  - CVE-2021-41270
summary: "CSV Injection in symfony/serializer\nDescription\n-----------\n\nCSV Injection, also\
  \ known as Formula Injection, occurs when websites embed untrusted input inside CSV files.\
  \ When a spreadsheet program opens a CSV, any cell starting with `=` is interpreted by the\
  \ software as a formula and could be abused by an attacker.\n\nIn Symfony 4.1, we've added\
  \ the opt-in `csv_escape_formulas` option in `CsvEncoder`, to prefix all cells starting by\
  \  `=`, `+`, `-` or `@` by a tab `\\t`. \n\nSince then, OWASP added 2 chars in that list:\
  \ \n- Tab (0x09)\n- Carriage return (0x0D)\n\nThis makes our previous prefix char (Tab `\\\
  t`) part of the vulnerable characters, and [OWASP suggests](https://owasp.org/www-community/attacks/CSV_Injection)\
  \ using the single quote `'` for prefixing the value.\n\nResolution\n----------\n\nSymfony\
  \ now follows the OWASP recommendations and use the single quote `'` to prefix formulas and\
  \ adds the prefix to cells starting by `\\t`, `\\r` as well as `=`, `+`, `-` and `@`.\n\n\
  The patch for this issue is available [here](https://github.com/symfony/symfony/commit/3da6f2d45e7536ccb2a26f52fbaf340917e208a8)\
  \ for branch 4.4.\n\nCredits\n-------\n\nWe would like to thank Jake Barwell for reporting\
  \ the issue and Jérémy Derussé for fixing the issue."
impacted_packages:
  - purl: pkg:composer/symfony/serializer
    affected_versions: vers:composer/>=5.0.0|<5.3.12
    fixed_versions: vers:composer/5.3.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/serializer
    affected_versions: vers:composer/>=4.1.0|<4.4.35
    fixed_versions: vers:composer/4.4.35
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=4.1.0|<4.4.35
    fixed_versions: vers:composer/4.4.35
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=5.0.0|<5.3.12
    fixed_versions: vers:composer/5.3.12
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-2xhg-w2g5-w95x/GHSA-2xhg-w2g5-w95x.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1236
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/serializer/CVE-2021-41270.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2021-41270.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/3da6f2d45e7536ccb2a26f52fbaf340917e208a8
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/pull/44243
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/releases/tag/v5.3.12
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/security/advisories/GHSA-2xhg-w2g5-w95x
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/3BPT4SF6SIXFMZARDWED5T32J7JEH3EP
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QSREFD2TJT5LWKM6S4MD3W26NQQ5WJUP
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3BPT4SF6SIXFMZARDWED5T32J7JEH3EP
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QSREFD2TJT5LWKM6S4MD3W26NQQ5WJUP
    reference_type:
    reference_id:
  - url: https://symfony.com/cve-2021-41270
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41270
    reference_type:
    reference_id: CVE-2021-41270
