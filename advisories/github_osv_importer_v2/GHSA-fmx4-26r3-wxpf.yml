advisory_id: GHSA-fmx4-26r3-wxpf
datasource_id: github_osv_importer_v2/GHSA-fmx4-26r3-wxpf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-fmx4-26r3-wxpf/GHSA-fmx4-26r3-wxpf.json
aliases:
  - CVE-2024-22051
summary: |
  Integer overflow in cmark-gfm table parsing extension leads to heap memory corruption
  ### Impact

  CommonMarker uses `cmark-gfm` for rendering [Github Flavored Markdown](https://github.github.com/gfm/). An [integer overflow in `cmark-gfm`'s table row parsing](https://github.com/github/cmark-gfm/security/advisories/GHSA-mc3g-88wq-6f4x) may lead to heap memory corruption when parsing tables who's marker rows contain more than UINT16_MAX columns. The impact of this heap corruption ranges from Information Leak to Arbitrary Code Execution.

  If affected versions of CommonMarker are used for rendering remote user controlled markdown, this vulnerability may lead to Remote Code Execution (RCE).

  ### Patches

  This vulnerability has been patched in the following CommonMarker release:

  - v0.23.4

  ### Workarounds

  The vulnerability exists in the table markdown extensions of `cmark-gfm`. Disabling any use of the table extension will prevent this vulnerability from being triggered.

  ### References

  - https://github.com/github/cmark-gfm/security/advisories/GHSA-mc3g-88wq-6f4x

  ### Acknowledgements

  We would like to thank Felix Wilhelm of Google's Project Zero for reporting this vulnerability

  ### For more information

  If you have any questions or comments about this advisory:

  * Open an issue in [CommonMarker](http://github.com/gjtorikian/commonmarker)
impacted_packages:
  - purl: pkg:gem/commonmarker
    affected_versions: vers:gem/<0.23.4
    fixed_versions: vers:gem/0.23.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-fmx4-26r3-wxpf/GHSA-fmx4-26r3-wxpf.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-190
references:
  - url: https://github.com/github/cmark-gfm/security/advisories/GHSA-mc3g-88wq-6f4x
    reference_type:
    reference_id:
  - url: https://github.com/gjtorikian/commonmarker
    reference_type:
    reference_id:
  - url: https://github.com/gjtorikian/commonmarker/commit/ab4504fd17460627a6ab255bc3c63e8e5fc6aed3
    reference_type:
    reference_id:
  - url: https://github.com/gjtorikian/commonmarker/security/advisories/GHSA-fmx4-26r3-wxpf
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/commonmarker/CVE-2024-22051.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22051
    reference_type:
    reference_id: CVE-2024-22051
