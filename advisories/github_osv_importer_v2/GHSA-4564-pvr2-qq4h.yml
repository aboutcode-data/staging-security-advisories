advisory_id: GHSA-4564-pvr2-qq4h
datasource_id: github_osv_importer_v2/GHSA-4564-pvr2-qq4h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-4564-pvr2-qq4h/GHSA-4564-pvr2-qq4h.json
aliases:
  - CVE-2026-27487
summary: |
  OpenClaw: Prevent shell injection in macOS keychain credential write
  ## Summary
  On macOS, the Claude CLI keychain credential refresh path constructed a shell command to write the updated JSON blob into Keychain via `security add-generic-password -w ...`. Because OAuth tokens are user-controlled data, this created an OS command injection risk.

  The fix avoids invoking a shell by using `execFileSync("security", argv)` and passing the updated keychain payload as a literal argument.

  ## Affected Packages / Versions
  - Package: `openclaw` (npm)
  - Platform: macOS only
  - Affected versions: `<= 2026.2.13`

  ## Fix
  - Patched version: `>= 2026.2.14` (next release)
  - Fix PR: #15924
  - Fix commits (merged to `main`):
    - `9dce3d8bf83f13c067bc3c32291643d2f1f10a06`
    - `66d7178f2d6f9d60abad35797f97f3e61389b70c`
    - `b908388245764fb3586859f44d1dff5372b19caf`

  Thanks @aether-ai-agent for reporting.
impacted_packages:
  - purl: pkg:npm/openclaw
    affected_versions: vers:npm/<2026.2.14
    fixed_versions: vers:npm/2026.2.14
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-4564-pvr2-qq4h/GHSA-4564-pvr2-qq4h.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/openclaw/openclaw
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/commit/66d7178f2d6f9d60abad35797f97f3e61389b70c
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/commit/9dce3d8bf83f13c067bc3c32291643d2f1f10a06
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/commit/b908388245764fb3586859f44d1dff5372b19caf
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/pull/15924
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/releases/tag/v2026.2.14
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/security/advisories/GHSA-4564-pvr2-qq4h
    reference_type:
    reference_id:
