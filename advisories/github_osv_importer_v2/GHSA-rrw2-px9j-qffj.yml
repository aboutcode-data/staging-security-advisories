advisory_id: GHSA-rrw2-px9j-qffj
datasource_id: github_osv_importer_v2/GHSA-rrw2-px9j-qffj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-rrw2-px9j-qffj/GHSA-rrw2-px9j-qffj.json
aliases:
  - CVE-2025-58369
summary: |
  FS2 half-shutdown of socket during TLS handshake may result in spin loop on opposite side
  ### Impact
  When establishing a TLS session using `fs2-io` on the JVM using the `fs2.io.net.tls` package, if one side of the connection shuts down write while the peer side is awaiting more data to progress the TLS handshake, the peer side will spin loop on the socket read, fully utilizing a CPU. This CPU is consumed until the overall connection is closed.

  This could be used as a denial of service attack on an fs2-io powered server -- for example, by opening many connections and putting them in a half-shutdown state.

  Note: this issue impacts ember backed http4s servers with HTTPS as a result of ember using fs2's TLS support.

  ### Patches
  Fixed in fs2 3.12.2 and 3.13.0-M7.

  ### Workarounds
  No workarounds.

  ### For more information

  If you have any questions or comments about this advisory:

  [Open an issue.](https://github.com/typelevel/fs2/issues/new/choose)
  Contact the [Typelevel Security Team](https://github.com/typelevel/.github/blob/main/SECURITY.md).
impacted_packages:
  - purl: pkg:maven/co.fs2/fs2-io_2.12
    affected_versions: vers:maven/>=3.0.0-M1|<3.12.2
    fixed_versions: vers:maven/3.12.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.12
    affected_versions: vers:maven/>=3.13.0-M1|<3.13.0-M7
    fixed_versions: vers:maven/3.13.0-M7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.13
    affected_versions: vers:maven/>=3.0.0-M1|<3.12.2
    fixed_versions: vers:maven/3.12.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.13
    affected_versions: vers:maven/>=3.13.0-M1|<3.13.0-M7
    fixed_versions: vers:maven/3.13.0-M7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_3
    affected_versions: vers:maven/>=3.0.0-M1|<3.12.2
    fixed_versions: vers:maven/3.12.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_3
    affected_versions: vers:maven/>=3.13.0-M1|<3.13.0-M7
    fixed_versions: vers:maven/3.13.0-M7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_0.26
    affected_versions: vers:maven/<2.5.13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_0.27
    affected_versions: vers:maven/<2.5.13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.11
    affected_versions: vers:maven/<2.5.13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.12.0-M4
    affected_versions: vers:maven/<2.5.13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.12.0-RC1
    affected_versions: vers:maven/<2.5.13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.12.0-M5
    affected_versions: vers:maven/<2.5.13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.12.0-RC2
    affected_versions: vers:maven/<2.5.13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.13.0-M5
    affected_versions: vers:maven/<2.5.13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.12
    affected_versions: vers:maven/<2.5.13
    fixed_versions: vers:maven/2.5.13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_2.13
    affected_versions: vers:maven/<2.5.13
    fixed_versions: vers:maven/2.5.13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/co.fs2/fs2-io_3
    affected_versions: vers:maven/<2.5.13
    fixed_versions: vers:maven/2.5.13
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-rrw2-px9j-qffj/GHSA-rrw2-px9j-qffj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/typelevel/fs2
    reference_type:
    reference_id:
  - url: https://github.com/typelevel/fs2/commit/46e2dc3abf994dcf3d0b804b2ddb3c10c04d4976
    reference_type:
    reference_id:
  - url: https://github.com/typelevel/fs2/commit/5c6c4c6c1ef330f7e6b53661ecc63d5f5ba8885c
    reference_type:
    reference_id:
  - url: https://github.com/typelevel/fs2/commit/edf0c4f2e660360d1c1a8c5377ce32294de89238
    reference_type:
    reference_id:
  - url: https://github.com/typelevel/fs2/issues/3590
    reference_type:
    reference_id:
  - url: https://github.com/typelevel/fs2/pull/3624
    reference_type:
    reference_id:
  - url: https://github.com/typelevel/fs2/releases/tag/v3.12.2
    reference_type:
    reference_id:
  - url: https://github.com/typelevel/fs2/releases/tag/v3.13.0-M7
    reference_type:
    reference_id:
  - url: https://github.com/typelevel/fs2/security/advisories/GHSA-rrw2-px9j-qffj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-58369
    reference_type:
    reference_id:
