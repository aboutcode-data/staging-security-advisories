advisory_id: GHSA-6955-67hm-vjjq
datasource_id: github_osv_importer_v2/GHSA-6955-67hm-vjjq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-6955-67hm-vjjq/GHSA-6955-67hm-vjjq.json
aliases:
  - CVE-2022-25277
summary: |
  Drupal core arbitrary PHP code execution
  Drupal core sanitizes filenames with dangerous extensions upon upload and strips leading and trailing dots from filenames to prevent uploading server configuration files.

  However, the protections for these two vulnerabilities previously did not work correctly together. As a result, if the site were configured to allow the upload of files with an htaccess extension, these files' filenames would not be properly sanitized. This could allow bypassing the protections provided by Drupal core's default .htaccess files and possible remote code execution on Apache web servers.

  This issue is mitigated by the fact that it requires a field administrator to explicitly configure a file field to allow htaccess as an extension (a restricted permission), or a contributed module or custom code that overrides allowed file uploads.
impacted_packages:
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/>=8.0.0|<9.3.19
    fixed_versions: vers:composer/9.3.19
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/>=9.4.0|<9.4.3
    fixed_versions: vers:composer/9.4.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-6955-67hm-vjjq/GHSA-6955-67hm-vjjq.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://github.com/drupal/core
    reference_type:
    reference_id:
  - url: https://github.com/drupal/core/commit/1cd1830d79f221cc8490f53c2bb487dd07094f17
    reference_type:
    reference_id:
  - url: https://github.com/drupal/core/commit/5d464ea4407c50e40dcf6cb5ee376e7b8dd36f3a
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/core/CVE-2022-25277.yaml
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2022-014
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-25277
    reference_type:
    reference_id: CVE-2022-25277
