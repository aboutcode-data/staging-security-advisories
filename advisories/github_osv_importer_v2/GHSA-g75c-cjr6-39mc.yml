advisory_id: GHSA-g75c-cjr6-39mc
datasource_id: github_osv_importer_v2/GHSA-g75c-cjr6-39mc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-g75c-cjr6-39mc/GHSA-g75c-cjr6-39mc.json
aliases:
  - CVE-2023-34465
summary: |
  XWiki Platform's Mail.MailConfig can be edited by any user with edit rights
  ### Impact

  `Mail.MailConfig` can be edited by any logged-in user by default. Consequently, they can:
  - change the mail obfuscation configuration
  - view and edit the mail sending configuration, including the smtp domain name and credentials.

  ### Patches
  The problem has been patched on XWiki 14.4.8, 15.1, and 14.10.6.

  ### Workarounds
  The rights of the `Mail.MailConfig` page can be manually updated so that only a set of trusted users can view, edit and delete it (e.g., the `XWiki.XWikiAdminGroup` group).
  On 14.4.8+, 15.1-rc-1+, or 14.10.5+, if at startup `Mail.MailConfig` does not have any rights defined, `view`, `edit ` and `delete` rights are automatically granted to the `XWiki.XWikiAdminGroup` group.
  See the corresponding [patch](https://github.com/xwiki/xwiki-platform/commit/d28d7739089e1ae8961257d9da7135d1a01cb7d4).

  ### References
  - https://jira.xwiki.org/browse/XWIKI-20519 + https://jira.xwiki.org/browse/XWIKI-20671
  - https://github.com/xwiki/xwiki-platform/commit/d28d7739089e1ae8961257d9da7135d1a01cb7d4
  - https://github.com/xwiki/xwiki-platform/commit/8910b8857d3442d2e8142f655fdc0512930354d1


  ### For more information

  If you have any questions or comments about this advisory:

  *    Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  *    Email us at [Security Mailing List](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-mail-send-default
    affected_versions: vers:maven/>=11.8-rc-1|<14.4.8
    fixed_versions: vers:maven/14.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-mail-send-default
    affected_versions: vers:maven/>=14.5|<14.10.6
    fixed_versions: vers:maven/14.10.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-mail-send-default
    affected_versions: vers:maven/>=15.0-rc-1|<15.1
    fixed_versions: vers:maven/15.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/06/GHSA-g75c-cjr6-39mc/GHSA-g75c-cjr6-39mc.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/8910b8857d3442d2e8142f655fdc0512930354d1
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/d28d7739089e1ae8961257d9da7135d1a01cb7d4
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g75c-cjr6-39mc
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20519
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20671
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34465
    reference_type:
    reference_id: CVE-2023-34465
