advisory_id: GHSA-ggmr-44cv-24pm
datasource_id: github_osv_importer_v2/GHSA-ggmr-44cv-24pm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-ggmr-44cv-24pm/GHSA-ggmr-44cv-24pm.json
aliases:
  - CVE-2021-43811
summary: |
  Code injection via unsafe YAML loading
  ### Impact
  Sockeye uses YAML to store model and data configurations on disk.  Versions below 2.3.24 use unsafe YAML loading, which can be made to execute arbitrary code embedded in config files.

  An attacker can add malicious code to the config file of a trained model and attempt to convince users to download and run it.  If users run the model, the embedded code will run locally.

  ### Patches
  The issue is fixed in version 2.3.24 and above by #964.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [awslabs/sockeye](https://github.com/awslabs/sockeye)
  * Email us at [sockeye-dev](mailto:sockeye-dev@amazon.com)

  ### Attribution
  This vulnerability was reported by Masatoshi Yoshizawa of yamory Security Team.
impacted_packages:
  - purl: pkg:pypi/sockeye
    affected_versions: vers:pypi/<2.3.24
    fixed_versions: vers:pypi/2.3.24
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-ggmr-44cv-24pm/GHSA-ggmr-44cv-24pm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/awslabs/sockeye
    reference_type:
    reference_id:
  - url: https://github.com/awslabs/sockeye/pull/964
    reference_type:
    reference_id:
  - url: https://github.com/awslabs/sockeye/releases/tag/2.3.24
    reference_type:
    reference_id:
  - url: https://github.com/awslabs/sockeye/security/advisories/GHSA-ggmr-44cv-24pm
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/sockeye/PYSEC-2021-848.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43811
    reference_type:
    reference_id: CVE-2021-43811
