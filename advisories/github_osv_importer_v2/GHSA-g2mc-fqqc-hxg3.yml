advisory_id: GHSA-g2mc-fqqc-hxg3
datasource_id: github_osv_importer_v2/GHSA-g2mc-fqqc-hxg3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-g2mc-fqqc-hxg3/GHSA-g2mc-fqqc-hxg3.json
aliases:
  - CVE-2023-30855
summary: |
  Pimcore Path Traversal Vulnerability in AdminBundle/Controller/Reports/CustomReportController.php
  ### Impact
  The impact of this path traversal and arbitrary extension is limited (creation of arbitrary files and appending data to existing files) but when combined with the SQL Injection, the exported data `RESTRICTED DIFFUSION 9 / 9` can be controlled and a webshell can be uploaded. Attackers can use that to execute arbitrary PHP code on the server with the permissions of the webserver.

  ### Patches
  Update to version 10.5.18 or apply this patch manually https://github.com/pimcore/pimcore/commit/7f788fa44bc18bc1c9182c25e26b770a1d30b62f.patch

  ### Workarounds
  Apply patch https://github.com/pimcore/pimcore/commit/7f788fa44bc18bc1c9182c25e26b770a1d30b62f.patch manually.


  ### References
  https://github.com/pimcore/pimcore/pull/14498
impacted_packages:
  - purl: pkg:composer/pimcore/pimcore
    affected_versions: vers:composer/<10.5.18
    fixed_versions: vers:composer/10.5.18
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-g2mc-fqqc-hxg3/GHSA-g2mc-fqqc-hxg3.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/pimcore/pimcore
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/commit/7f788fa44bc18bc1c9182c25e26b770a1d30b62f.patch
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/commit/f1d904094700b513c4756904fa2b1e19d08d890e.patch
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/pull/14498
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/security/advisories/GHSA-g2mc-fqqc-hxg3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-30855
    reference_type:
    reference_id: CVE-2023-30855
