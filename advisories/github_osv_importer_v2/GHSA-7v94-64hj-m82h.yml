advisory_id: GHSA-7v94-64hj-m82h
datasource_id: github_osv_importer_v2/GHSA-7v94-64hj-m82h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-7v94-64hj-m82h/GHSA-7v94-64hj-m82h.json
aliases:
  - CVE-2021-41207
summary: |
  FPE in `ParallelConcat`
  ### Impact
  The [implementation of `ParallelConcat`](https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97) misses some input validation and can produce a division by 0:

  ```python
  import tensorflow as tf

  @tf.function
  def test():
    y = tf.raw_ops.ParallelConcat(values=[['tf']],shape=0)
    return y

  test()
  ```

  ### Patches
  We have patched the issue in GitHub commit [f2c3931113eaafe9ef558faaddd48e00a6606235](https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235).

  The fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow 2.6.1, TensorFlow 2.5.2, and TensorFlow 2.4.4, as these are also affected and still in supported range.

  ### For more information
  Please consult [our security guide](https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.

  ### Attribution
  This vulnerability has been reported by members of the Aivul Team from Qihoo 360.
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/>=2.6.0|<2.6.1
    fixed_versions: vers:pypi/2.6.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/>=2.5.0|<2.5.2
    fixed_versions: vers:pypi/2.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/<2.4.4
    fixed_versions: vers:pypi/2.4.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/<2.4.4
    fixed_versions: vers:pypi/2.4.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/>=2.5.0|<2.5.2
    fixed_versions: vers:pypi/2.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/>=2.6.0|<2.6.1
    fixed_versions: vers:pypi/2.6.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/<2.4.4
    fixed_versions: vers:pypi/2.4.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/>=2.5.0|<2.5.2
    fixed_versions: vers:pypi/2.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/>=2.6.0|<2.6.1
    fixed_versions: vers:pypi/2.6.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-7v94-64hj-m82h/GHSA-7v94-64hj-m82h.json
  - score: '6.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-7v94-64hj-m82h/GHSA-7v94-64hj-m82h.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-369
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-616.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-814.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-399.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/9de11bdc2cf1284b2f635419bd3e6bbc7643eb2c
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/d11f21bbdfa54f3576ae860fc927bf23c675ebc0
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/e67caccea81167402c62977b5c521f2a8b261d6a
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-7v94-64hj-m82h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41207
    reference_type:
    reference_id: CVE-2021-41207
