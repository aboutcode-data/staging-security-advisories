advisory_id: GHSA-p5q9-86w4-2xr5
datasource_id: github_osv_importer_v2/GHSA-p5q9-86w4-2xr5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-p5q9-86w4-2xr5/GHSA-p5q9-86w4-2xr5.json
aliases:
  - CVE-2023-51747
summary: |
  SMTP smuggling in Apache James
  Apache James prior to versions 3.8.1 and 3.7.5 is vulnerable to SMTP smuggling.

  A lenient behaviour in line delimiter handling might create a difference of interpretation between the sender and the receiver which can be exploited by an attacker to forge an SMTP envelop, allowing for instance to bypass SPF checks.

  The patch implies enforcement of CRLF as a line delimiter as part of the DATA transaction.

  We recommend James users to upgrade to non vulnerable versions.
impacted_packages:
  - purl: pkg:maven/org.apache.james/james-server
    affected_versions: vers:maven/<3.7.5
    fixed_versions: vers:maven/3.7.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.james/james-server
    affected_versions: vers:maven/3.8.0
    fixed_versions: vers:maven/3.8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-p5q9-86w4-2xr5/GHSA-p5q9-86w4-2xr5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-290
  - CWE-20
references:
  - url: https://github.com/apache/james-project
    reference_type:
    reference_id:
  - url: https://github.com/apache/james-project/commit/d1ef102540e504c067b6c1721a6f1e7eee9c6fc6
    reference_type:
    reference_id:
  - url: https://github.com/apache/james-project/commit/d5cd8bb098aa78d8d62c9645f3c532689ef1cb03
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/rxkwbkh9vgbl9rzx1fkllyk3krhgydko
    reference_type:
    reference_id:
  - url: https://postfix.org/smtp-smuggling.html
    reference_type:
    reference_id:
  - url: https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/02/27/4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-51747
    reference_type:
    reference_id: CVE-2023-51747
