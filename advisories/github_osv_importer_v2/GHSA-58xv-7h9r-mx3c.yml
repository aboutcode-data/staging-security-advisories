advisory_id: GHSA-58xv-7h9r-mx3c
datasource_id: github_osv_importer_v2/GHSA-58xv-7h9r-mx3c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-58xv-7h9r-mx3c/GHSA-58xv-7h9r-mx3c.json
aliases: []
summary: |
  Drupal Malicious file upload with filenames stating with dot
  Drupal 8 core's file_save_upload() function does not strip the leading and trailing dot ('.') from filenames, like Drupal 7 did.

  Users with the ability to upload files with any extension in conjunction with contributed modules may be able to use this to upload system files such as .htaccess in order to bypass protections afforded by Drupal's default .htaccess file.

  After this fix, file_save_upload() now trims leading and trailing dots from filenames.
impacted_packages:
  - purl: pkg:composer/drupal/drupal
    affected_versions: vers:composer/>=8.0.0|<8.7.11
    fixed_versions: vers:composer/8.7.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/drupal/drupal
    affected_versions: vers:composer/>=8.8.0|<8.8.1
    fixed_versions: vers:composer/8.8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://github.com/drupal/drupal
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/drupal/2019-12-18-2.yaml
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2019-010
    reference_type:
    reference_id:
