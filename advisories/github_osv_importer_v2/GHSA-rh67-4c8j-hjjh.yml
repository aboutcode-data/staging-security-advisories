advisory_id: GHSA-rh67-4c8j-hjjh
datasource_id: github_osv_importer_v2/GHSA-rh67-4c8j-hjjh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-rh67-4c8j-hjjh/GHSA-rh67-4c8j-hjjh.json
aliases:
  - CVE-2025-49143
summary: |
  Nautobot may allows uploaded media files to be accessible without authentication
  ### Impact

  Files uploaded by users to Nautobot's `MEDIA_ROOT` directory, including DeviceType image attachments as well as images attached to a Location, Device, or Rack, are served to users via a URL endpoint that was not enforcing user authentication. As a consequence, such files can be retrieved by anonymous users who know or can guess the correct URL for a given file.

  For DeviceType image attachments, a mitigating factor is that no URL endpoint exists for listing the contents of the `devicetype-images/` subdirectory, and the file names are as specified by the uploading user, so any given DeviceType image attachment can only be retrieved by correctly guessing its file name.

  Similarly, for all other image attachments, while the images *can* be listed by accessing the `/api/extras/image-attachments/` endpoint *as an authenticated user only*, absent that authenticated access, accessing the files would again require guessing file names correctly.

  ### Patches

  Nautobot v2.4.10 and v1.6.32 will address this issue by adding enforcement of Nautobot user authentication to this endpoint.

  ### Workarounds

  No workaround other than applying the patch given in https://github.com/nautobot/nautobot/pull/6672 (2.x) or https://github.com/nautobot/nautobot/pull/6703 (1.6)

  ### References
  _Are there any links users can visit to find out more?_

  - https://github.com/nautobot/nautobot/commit/9c892dc300429948a4714f743c9c2879d8987340
  - https://github.com/nautobot/nautobot/commit/d99a53b065129cff3a0fa9abe7355a9ef1ad4c95
impacted_packages:
  - purl: pkg:pypi/nautobot
    affected_versions: vers:pypi/<1.6.32
    fixed_versions: vers:pypi/1.6.32
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/nautobot
    affected_versions: vers:pypi/>=2.0.0|<2.4.10
    fixed_versions: vers:pypi/2.4.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:P/PR:N/UI:N/VC:L/VI:N/VA:N/SC:L/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-rh67-4c8j-hjjh/GHSA-rh67-4c8j-hjjh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/nautobot/nautobot
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/commit/9c892dc300429948a4714f743c9c2879d8987340
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/commit/d99a53b065129cff3a0fa9abe7355a9ef1ad4c95
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/pull/6672
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/pull/6703
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/security/advisories/GHSA-rh67-4c8j-hjjh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49143
    reference_type:
    reference_id: CVE-2025-49143
