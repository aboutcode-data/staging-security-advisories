advisory_id: GHSA-82v2-mx6x-wq7q
datasource_id: github_osv_importer_v2/GHSA-82v2-mx6x-wq7q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-82v2-mx6x-wq7q/GHSA-82v2-mx6x-wq7q.json
aliases:
  - CVE-2022-21704
summary: |
  Incorrect Default Permissions in log4js
  ### Impact
  Default file permissions for log files created by the file, fileSync and dateFile appenders are world-readable (in unix). This could cause problems if log files contain sensitive information. This would affect any users that have not supplied their own permissions for the files via the mode parameter in the config.

  ### Patches
  Fixed by:
  * https://github.com/log4js-node/log4js-node/pull/1141
  * https://github.com/log4js-node/streamroller/pull/87

  Released to NPM in log4js@6.4.0

  ### Workarounds
  Every version of log4js published allows passing the mode parameter to the configuration of file appenders, see the documentation for details.

  ### References

  Thanks to [ranjit-git](https://www.huntr.dev/users/ranjit-git) for raising the issue, and to @lamweili for fixing the problem.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [logj4s-node](https://github.com/log4js-node/log4js-node)
  * Ask a question in the [slack channel](https://join.slack.com/t/log4js-node/shared_invite/enQtODkzMDQ3MzExMDczLWUzZmY0MmI0YWI1ZjFhODY0YjI0YmU1N2U5ZTRkOTYyYzg3MjY5NWI4M2FjZThjYjdiOGM0NjU2NzBmYTJjOGI)
  * Email us at [gareth.nomiddlename@gmail.com](mailto:gareth.nomiddlename@gmail.com)
impacted_packages:
  - purl: pkg:npm/log4js
    affected_versions: vers:npm/<6.4.0
    fixed_versions: vers:npm/6.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-82v2-mx6x-wq7q/GHSA-82v2-mx6x-wq7q.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-276
references:
  - url: https://github.com/log4js-node/log4js-node
    reference_type:
    reference_id:
  - url: https://github.com/log4js-node/log4js-node/blob/v6.4.0/CHANGELOG.md#640
    reference_type:
    reference_id:
  - url: https://github.com/log4js-node/log4js-node/pull/1141/commits/8042252861a1b65adb66931fdf702ead34fa9b76
    reference_type:
    reference_id:
  - url: https://github.com/log4js-node/log4js-node/security/advisories/GHSA-82v2-mx6x-wq7q
    reference_type:
    reference_id:
  - url: https://github.com/log4js-node/streamroller/pull/87
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/12/msg00014.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21704
    reference_type:
    reference_id: CVE-2022-21704
