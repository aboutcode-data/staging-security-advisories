advisory_id: GHSA-f6gv-hh8j-q8vq
datasource_id: github_osv_importer_v2/GHSA-f6gv-hh8j-q8vq
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-f6gv-hh8j-q8vq/GHSA-f6gv-hh8j-q8vq.json
aliases:
  - CVE-2023-50710
summary: |
  Named path parameters can be overridden in TrieRouter
  ### Impact

  The clients may override named path parameter values from previous requests if the application is using TrieRouter. So, there is a risk that a privileged user may use unintended parameters when deleting REST API resources.

  TrieRouter is used either explicitly or when the application matches a pattern that is not supported by the default RegExpRouter.

  The code to reproduce it. The server side application:

  ```ts
  import { Hono } from 'hono'
  import { TrieRouter } from 'hono/router/trie-router'

  const wait = async (ms: number) => {
    return new Promise((resolve) => {
      setTimeout(resolve, ms)
    })
  }

  const app = new Hono({ router: new TrieRouter() })

  app.use('*', async (c, next) => {
    await wait(Math.random() * 200)
    return next()
  })

  app.get('/modules/:id/versions/:version', async (c) => {
    const id = c.req.param('id')
    const version = c.req.param('version')

    console.log('path', c.req.path)
    console.log('version', version)

    return c.json({
      id,
      version,
    })
  })

  export default app
  ```

  The client code which makes requests to the server application:

  ```ts
  const examples = [
    'http://localhost:8787/modules/first/versions/first',
    'http://localhost:8787/modules/second/versions/second',
    'http://localhost:8787/modules/third/versions/third',
  ]

  const test = () => {
    for (const example of examples) {
      fetch(example)
        .then((response) => response.json())
        .then((data) => {
          const splitted = example.split('/')
          const expected = splitted[splitted.length - 1]

          if (expected !== data.version) {
            console.error(`Error: exprected ${expected} but got ${data.version} - url was ${example}`)
          }
        })
    }
  }

  test()
  ```

  The results:

  ```txt
  Error: exprected second but got third - url was http://localhost:8787/modules/second/versions/second
  Error: exprected first but got third - url was http://localhost:8787/modules/first/versions/first
  ```

  ### Patches

  "v3.11.7" includes the change to fix this issue.

  ### Workarounds

  Don't use TrieRouter directly.

  ```ts
  // DON'T USE TrieRouter
  import { TrieRouter } from 'hono/router/trie-router'
  const app = new Hono({ router: new TrieRouter() })
  ```

  ### References

  Router options on the Hono website: https://hono.dev/api/hono#router-option
impacted_packages:
  - purl: pkg:npm/hono
    affected_versions: vers:npm/<3.11.7
    fixed_versions: vers:npm/3.11.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-f6gv-hh8j-q8vq/GHSA-f6gv-hh8j-q8vq.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/honojs/hono
    reference_type:
    reference_id:
  - url: https://github.com/honojs/hono/commit/8e2b6b08518998783f66d31db4f21b1b1eecc4c8
    reference_type:
    reference_id:
  - url: https://github.com/honojs/hono/releases/tag/v3.11.7
    reference_type:
    reference_id:
  - url: https://github.com/honojs/hono/security/advisories/GHSA-f6gv-hh8j-q8vq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-50710
    reference_type:
    reference_id: CVE-2023-50710
