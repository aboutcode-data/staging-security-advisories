advisory_id: GHSA-7qcx-jmrc-h2rr
datasource_id: github_osv_importer_v2/GHSA-7qcx-jmrc-h2rr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2017/11/GHSA-7qcx-jmrc-h2rr/GHSA-7qcx-jmrc-h2rr.json
aliases:
  - CVE-2017-15878
summary: |
  Cross-Site Scripting in keystone
  Versions of `keystone` prior to 4.0.0 are vulnerable to Cross-Site Scripting (XSS). The package fails to sanitize user input on the `Contact Us` page,  allowing attackers to submit contact forms with malicious JavaScript in the message field. The output is not properly encoded leading an admin that opens new inquiry to execute the arbitrary JavaScript supplied in their browser.


  ## Recommendation

  Update to version 4.0.0 or later.
impacted_packages:
  - purl: pkg:npm/keystone
    affected_versions: vers:npm/<4.0.0
    fixed_versions: vers:npm/4.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2017/11/GHSA-7qcx-jmrc-h2rr/GHSA-7qcx-jmrc-h2rr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: http://blog.securelayer7.net/keystonejs-open-source-penetration-testing-report
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-7qcx-jmrc-h2rr
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/pull/4478
    reference_type:
    reference_id:
  - url: https://packetstormsecurity.com/files/144756/KeystoneJS-4.0.0-beta.5-Unauthenticated-Stored-Cross-Site-Scripting.html
    reference_type:
    reference_id:
  - url: https://securelayer7.net/download/pdf/KeystoneJS-Pentest-Report-SecureLayer7.pdf
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/43054
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/980
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/101541
    reference_type:
    reference_id:
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/nodejs/webapps/43054.txt
    reference_type: exploit
    reference_id: CVE-2017-15878
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-15878
    reference_type:
    reference_id: CVE-2017-15878
