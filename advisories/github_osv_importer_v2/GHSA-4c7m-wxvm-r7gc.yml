advisory_id: GHSA-4c7m-wxvm-r7gc
datasource_id: github_osv_importer_v2/GHSA-4c7m-wxvm-r7gc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-4c7m-wxvm-r7gc/GHSA-4c7m-wxvm-r7gc.json
aliases:
  - CVE-2021-28918
summary: |
  Improper parsing of octal bytes in netmask
  Improper input validation of octal strings in netmask npm package v1.0.6 and below allows unauthenticated remote attackers to perform indeterminate SSRF, RFI, and LFI attacks on many of the dependent packages. A remote unauthenticated attacker can bypass packages relying on netmask to filter IPs and reach critical VPN or LAN hosts.

  :exclamation: NOTE: The fix for this issue was incomplete. A subsequent fix was made in version `2.0.1` which was assigned [CVE-2021-29418 / GHSA-pch5-whg9-qr2r](https://github.com/advisories/GHSA-pch5-whg9-qr2r). For complete protection from this vulnerability an upgrade to version 2.0.1 or later is recommended.
impacted_packages:
  - purl: pkg:npm/netmask
    affected_versions: vers:npm/<1.1.0
    fixed_versions: vers:npm/1.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-4c7m-wxvm-r7gc/GHSA-4c7m-wxvm-r7gc.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/advisories/GHSA-pch5-whg9-qr2r
    reference_type:
    reference_id:
  - url: https://github.com/rs/node-netmask
    reference_type:
    reference_id:
  - url: https://github.com/rs/node-netmask/blob/98294cb20695f2c6c36219a4fbcd4744fb8d0682/CHANGELOG.md#v110-mar-18-2021
    reference_type:
    reference_id:
  - url: https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-011.md
    reference_type:
    reference_id:
  - url: https://rootdaemon.com/2021/03/29/vulnerability-in-netmask-npm-package-affects-280000-projects
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20210528-0010
    reference_type:
    reference_id:
  - url: https://www.bleepingcomputer.com/news/security/critical-netmask-networking-bug-impacts-thousands-of-applications
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/netmask
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28918
    reference_type:
    reference_id: CVE-2021-28918
