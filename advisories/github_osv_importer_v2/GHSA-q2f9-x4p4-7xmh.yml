advisory_id: GHSA-q2f9-x4p4-7xmh
datasource_id: github_osv_importer_v2/GHSA-q2f9-x4p4-7xmh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-q2f9-x4p4-7xmh/GHSA-q2f9-x4p4-7xmh.json
aliases:
  - CVE-2025-32030
summary: |
  Apollo Gateway Query Planner Vulnerable to Excessive Resource Consumption via Named Fragment Expansion
  # Impact

  ## Summary

  A vulnerability in Apollo Gateway allowed queries with deeply nested and reused named fragments to be prohibitively expensive to query plan, specifically during named fragment expansion. This could lead to excessive resource consumption and denial of service.

  ## Details

  Named fragments were being expanded once per fragment spread during query planning, leading to exponential resource usage when deeply nested and reused fragments were involved.

  ## Fix/Mitigation

  A new **Query Fragment Expansion Limit** metric has been introduced:
    - This metric computes the number of selections a query would have if its fragment spreads were fully expanded.
    - The metric is checked against a limit to prevent excessive computation.

  # Patches

  This has been remediated in `@apollo/gateway` version 2.10.1.

  # Workarounds

  No known direct workarounds exist.

  # References

  [Query Planning Documentation](https://www.apollographql.com/docs/graphos/reference/federation/query-plans)

  ## Acknowledgements

  We appreciate the efforts of the security community in identifying and improving the performance and security of query planning mechanisms.
impacted_packages:
  - purl: pkg:npm/%40apollo/gateway
    affected_versions: vers:npm/<2.10.1
    fixed_versions: vers:npm/2.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-q2f9-x4p4-7xmh/GHSA-q2f9-x4p4-7xmh.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
references:
  - url: https://github.com/apollographql/federation
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/federation/pull/3236
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/federation/releases/tag/%40apollo%2Fgateway%402.10.1
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/federation/security/advisories/GHSA-q2f9-x4p4-7xmh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32030
    reference_type:
    reference_id: CVE-2025-32030
