advisory_id: GHSA-p2q6-pwh5-m6jr
datasource_id: github_osv_importer_v2/GHSA-p2q6-pwh5-m6jr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-p2q6-pwh5-m6jr/GHSA-p2q6-pwh5-m6jr.json
aliases:
  - CVE-2025-32031
summary: |
  Apollo Gateway Query Planner Vulnerable to Excessive Resource Consumption via Optimization Bypass
  # Impact

  ## Summary

  A vulnerability in Apollo Gateway allowed queries with deeply nested and reused named fragments to be prohibitively expensive to query plan, specifically due to internal optimizations being frequently bypassed. This could lead to excessive resource consumption and denial of service.

  ## Details

  The query planner includes an optimization that significantly speeds up planning for applicable GraphQL selections. However, queries with deeply nested and reused named fragments can generate many selections where this optimization does not apply, leading to significantly longer planning times. Because the query planner does not enforce a timeout, a small number of such queries can render gateway inoperable.

  ## Fix/Mitigation

  - A new **Query Optimization Limit** metric has been added:
    - This metric approximates the number of selections that cannot be skipped by the existing optimization.
    - The metric is checked against a limit to prevent excessive computation.

  Given the complexity of query planning optimizations, we will continue refining these solutions based on real-world performance and accuracy tests.

  # Patches

  This has been remediated in `@apollo/gateway` version 2.10.1.

  # Workarounds

  No known direct workarounds exist.

  # References

  [Query Planning Documentation](https://www.apollographql.com/docs/graphos/reference/federation/query-plans)

  ## Acknowledgements

  We appreciate the efforts of the security community in identifying and improving the performance and security of query planning mechanisms.
impacted_packages:
  - purl: pkg:npm/%40apollo/gateway
    affected_versions: vers:npm/<2.10.1
    fixed_versions: vers:npm/2.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-p2q6-pwh5-m6jr/GHSA-p2q6-pwh5-m6jr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
references:
  - url: https://github.com/apollographql/federation
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/federation/pull/3236
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/federation/releases/tag/%40apollo%2Fgateway%402.10.1
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/federation/security/advisories/GHSA-p2q6-pwh5-m6jr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32031
    reference_type:
    reference_id: CVE-2025-32031
