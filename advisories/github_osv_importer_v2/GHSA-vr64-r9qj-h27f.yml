advisory_id: GHSA-vr64-r9qj-h27f
datasource_id: github_osv_importer_v2/GHSA-vr64-r9qj-h27f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-vr64-r9qj-h27f/GHSA-vr64-r9qj-h27f.json
aliases:
  - CVE-2024-22871
summary: "Reading specially crafted serializable objects from an untrusted source may cause\
  \ an infinite loop and denial of service\nAny program on the JVM may read serialized objects\
  \ via [java.io.ObjectInputStream.readObject()](https://docs.oracle.com/javase/8/docs/api/java/io/ObjectInputStream.html#readObject--).\
  \ Reading serialized objects from an untrusted source is **inherently unsafe** (this affects\
  \ any program running on any version of the JVM) and is a prerequisite for this vulnerability.\n\
  \nClojure classes that represent infinite seqs (Cycle, infinite Repeat, and Iterate) do not\
  \ define hashCode() and use the parent ASeq.hashCode(), which walks the seq to compute the\
  \ hash, yielding an infinite loop. Classes like java.util.HashMap call hashCode() on keys\
  \ during deserialization of a serialized map. \n\nThe exploit requires:\n\n1. Crafting a serialized\
  \ HashMap object with an infinite seq object as a key.\n2. Sending that to a program that\
  \ reads serialized objects via ObjectInputStream.readObject().\n\nThis will cause the program\
  \ to enter an infinite loop on the reading thread and thus a denial of service (DoS). \n\n\
  The affected Clojure classes (Cycle, Repeat, Iterate) exist in Clojure 1.7.0-1.11.1, 1.12.0-alpha1-1.12.0-alpha8."
impacted_packages:
  - purl: pkg:maven/org.clojure/clojure
    affected_versions: vers:maven/>=1.7.0|<1.11.2
    fixed_versions: vers:maven/1.11.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.clojure/clojure
    affected_versions: vers:maven/>=1.12.0-alpha1|<1.12.0-alpha9
    fixed_versions: vers:maven/1.12.0-alpha9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-vr64-r9qj-h27f/GHSA-vr64-r9qj-h27f.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://clojure.atlassian.net/browse/CLJ-2839
    reference_type:
    reference_id:
  - url: https://github.com/clojure/clojure
    reference_type:
    reference_id:
  - url: https://hackmd.io/%40fe1w0/rymmJGida
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/25FKUOYXQZGGJMFUM5HJABWMIX2TILRV
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/SWWK2SO2MH4SXPO6L444MM6LHVLVFULV
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YFPGUDXMW6OXKIDGCOZFEAXO74VQIB2T
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/25FKUOYXQZGGJMFUM5HJABWMIX2TILRV
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SWWK2SO2MH4SXPO6L444MM6LHVLVFULV
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/YFPGUDXMW6OXKIDGCOZFEAXO74VQIB2T
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22871
    reference_type:
    reference_id: CVE-2024-22871
