advisory_id: GHSA-h6m6-jj8v-94jj
datasource_id: github_osv_importer_v2/GHSA-h6m6-jj8v-94jj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-h6m6-jj8v-94jj/GHSA-h6m6-jj8v-94jj.json
aliases:
  - CVE-2024-5225
summary: |
  SQL injection in litellm
  An SQL Injection vulnerability exists in the berriai/litellm repository, specifically within the `/global/spend/logs` endpoint. The vulnerability arises due to improper neutralization of special elements used in an SQL command. The affected code constructs an SQL query by concatenating an unvalidated `api_key` parameter directly into the query, making it susceptible to SQL Injection if the `api_key` contains malicious data. This issue affects the latest version of the repository. Successful exploitation of this vulnerability could lead to unauthorized access, data manipulation, exposure of confidential information, and denial of service (DoS).
impacted_packages:
  - purl: pkg:pypi/litellm
    affected_versions: vers:pypi/<1.40.0
    fixed_versions: vers:pypi/1.40.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-h6m6-jj8v-94jj/GHSA-h6m6-jj8v-94jj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/BerriAI/litellm
    reference_type:
    reference_id:
  - url: https://github.com/BerriAI/litellm/commit/f75c15d6cd535aa78014378ad532de1df6be2f56
    reference_type:
    reference_id:
  - url: https://github.com/BerriAI/litellm/pull/3940
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/491e4884-0306-4cd4-8fe2-9a19de33bf5c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-5225
    reference_type:
    reference_id: CVE-2024-5225
