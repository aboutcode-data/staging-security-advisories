advisory_id: GHSA-ff6v-w58f-v97w
datasource_id: github_osv_importer_v2/GHSA-ff6v-w58f-v97w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-ff6v-w58f-v97w/GHSA-ff6v-w58f-v97w.json
aliases:
  - CVE-2025-49583
summary: |
  XWiki provides no warning when granting XWiki.Notifications.Code.NotificationEmailRendererClass admin right
  ### Impact
  When a user without script right creates a document with an `XWiki.Notifications.Code.NotificationEmailRendererClass` object, and later an admin edits and saves that document, the email templates in this object will be used for notifications. No malicious code can be executed, though, as while these templates allow Velocity code, the existing generic analyzer already warns admins before editing Velocity code. The main impact would thus be to send spam, e.g., with phishing links to other users or to hide notifications about other attacks. Note that warnings before editing documents with dangerous properties have only been introduced in XWiki 15.9, before that version, this was a known issue and the advice was simply to be careful.

  ### Patches
  This has been patched in XWiki 16.10.2, 16.4.7 and 15.10.16 by adding an analysis for the respective XClass properties.

  ### Workarounds
  We're not aware of any real workarounds apart from just being careful with editing documents previously edited by untrusted users as a user with script, admin or programming right.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-notifications-notifiers-default
    affected_versions: vers:maven/<15.10.16
    fixed_versions: vers:maven/15.10.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-notifications-notifiers-default
    affected_versions: vers:maven/>=16.0.0-rc-1|<16.4.7
    fixed_versions: vers:maven/16.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-notifications-notifiers-default
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.10.2
    fixed_versions: vers:maven/16.10.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:N/VI:N/VA:N/SC:N/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-ff6v-w58f-v97w/GHSA-ff6v-w58f-v97w.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-357
  - CWE-270
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/3d96bf3ceb167bf0213d63f0be1f7e1732eb0a92
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-ff6v-w58f-v97w
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22471
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49583
    reference_type:
    reference_id: CVE-2025-49583
