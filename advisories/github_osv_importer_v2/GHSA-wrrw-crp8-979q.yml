advisory_id: GHSA-wrrw-crp8-979q
datasource_id: github_osv_importer_v2/GHSA-wrrw-crp8-979q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-wrrw-crp8-979q/GHSA-wrrw-crp8-979q.json
aliases: []
summary: "Pageflow vulnerable to sensitive user data extraction via Ransack query injection\n\
  ### Impact\n\nThe attack allows extracting sensitive properties of database objects that are\
  \ associated with users or entries belonging to an account that the attacker has access to.\n\
  \nPageflow uses the `ActiveAdmin` Ruby library to provide some management features to its\
  \ users. `ActiveAdmin` relies on the `Ransack` library to implement search functionality.\
  \ In its default configuration, `Ransack` will allow for query conditions based on properties\
  \ of associated database objects [1]. The `*_starts_with`, `*_ends_with` or `*_contains` search\
  \ matchers [2] can then be abused to exfiltrate sensitive string values of associated database\
  \ objects via character-by-character brute-force.\n\n[1] https://activerecord-hackery.github.io/ransack/going-further/associations/\n\
  [2] https://activerecord-hackery.github.io/ransack/getting-started/search-matches/\n\n###\
  \ Mitigation\n\nUpgrade to version 15.7.1 or 14.5.2 of the `pageflow` gem.\n\n### For more\
  \ information\n\nIf you have any questions or comments about this advisory email us at info(at)codevise.de\
  \ \n\n### Credits\n\n[Positive Security](https://positive.security/)"
impacted_packages:
  - purl: pkg:gem/pageflow
    affected_versions: vers:gem/<14.5.2
    fixed_versions: vers:gem/14.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/pageflow
    affected_versions: vers:gem/>=15.0.0|<15.7.1
    fixed_versions: vers:gem/15.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/codevise/pageflow
    reference_type:
    reference_id:
  - url: https://github.com/codevise/pageflow/pull/1862
    reference_type:
    reference_id:
  - url: https://github.com/codevise/pageflow/security/advisories/GHSA-wrrw-crp8-979q
    reference_type:
    reference_id:
