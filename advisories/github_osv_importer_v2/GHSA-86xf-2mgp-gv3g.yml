advisory_id: GHSA-86xf-2mgp-gv3g
datasource_id: github_osv_importer_v2/GHSA-86xf-2mgp-gv3g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-86xf-2mgp-gv3g/GHSA-86xf-2mgp-gv3g.json
aliases:
  - CVE-2025-49576
summary: |
  starcitizentools/citizen-skin allows stored XSS in search no result messages
  ### Summary
  The `citizen-search-noresults-title` and `citizen-search-noresults-desc` system messages are inserted into raw HTML, allowing anybody who can edit those messages to insert arbitrary HTML into the DOM.

  ### Details
  The system messages are inserted as raw HTML by the mustache template:
  https://github.com/StarCitizenTools/mediawiki-skins-Citizen/blob/407052e7069bdeae927d6f1a2a1c9a45b473bf9a/resources/skins.citizen.search/templates/TypeaheadPlaceholder.mustache#L8-L9


  ### PoC
  1. Edit `citizen-search-noresults-title` and `citizen-search-noresults-desc` to `<img src="" onerror="alert('citizen-search-noresults-title')">` and `<img src="" onerror="alert('citizen-search-noresults-desc')">` (script tags don't work here due to the way the HTML is inserted)
  2. Open the search bar and search for a page that doesn't exist to get the "no results" messages to show up

  ![image](https://github.com/user-attachments/assets/cf2963bc-5c86-4a4d-8574-de92d89d6d81)
  ![image](https://github.com/user-attachments/assets/44839a7e-c08c-4df9-bd84-0f5863f64163)


  ### Impact
  This impacts wikis where a group has the `editinterface` but not the `editsitejs` user right.
impacted_packages:
  - purl: pkg:composer/starcitizentools/citizen-skin
    affected_versions: vers:composer/>=2.31.0|<3.3.1
    fixed_versions: vers:composer/3.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-86xf-2mgp-gv3g/GHSA-86xf-2mgp-gv3g.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/StarCitizenTools/mediawiki-skins-Citizen
    reference_type:
    reference_id:
  - url: https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/93c36ac778397e0e7c46cf7adb1e5d848265f1bd
    reference_type:
    reference_id:
  - url: https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/a0296afaedbe1a277337a2d8f1da83cb3a79b9ab
    reference_type:
    reference_id:
  - url: https://github.com/StarCitizenTools/mediawiki-skins-Citizen/security/advisories/GHSA-86xf-2mgp-gv3g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49576
    reference_type:
    reference_id: CVE-2025-49576
