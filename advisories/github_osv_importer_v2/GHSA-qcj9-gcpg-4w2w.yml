advisory_id: GHSA-qcj9-gcpg-4w2w
datasource_id: github_osv_importer_v2/GHSA-qcj9-gcpg-4w2w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-qcj9-gcpg-4w2w/GHSA-qcj9-gcpg-4w2w.json
aliases:
  - CVE-2023-45136
summary: |
  XWiki Platform web templates vulnerable to reflected XSS in the create document form if name validation is enabled
  ### Impact
  When document names are validated according to a name strategy (disabled by default), XWiki is vulnerable to a reflected XSS attack in the page creation form. To reproduce, make sure that "Validate names before saving" is enabled in the administration under "Editing" -> "Name strategies" and then open `<xwiki-host>/xwiki/bin/create/Main/%3Cscript%3Ealert%28%27Test%20Test%20Test%20Test%20Test%27%29%3C%2Fscript%3E` where `<xwiki-host>` is the URL of your XWiki installation. This displays an alert if the installation is vulnerable. This allows an attacker to execute arbitrary actions with the rights of the user opening the malicious link. Depending on the rights of the user, this may allow remote code execution and full read and write access to the whole XWiki installation.

  ### Patches
  This has been patched in XWiki 14.10.12 and 15.5-RC-1 by adding appropriate escaping.

  ### Workarounds
  The vulnerable template file `createinline.vm` is part of XWiki's WAR and can be patched by manually applying the [changes from the fix](https://github.com/xwiki/xwiki-platform/commit/ba56fda175156dd35035f2b8c86cbd8ef1f90c2e#diff-c222148bddebe4ff7629350f4053b618504a4ab172e697938c8fddf7c1fc6bc8).
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=12.0-rc-1|<14.10.12
    fixed_versions: vers:maven/14.10.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=15.0-rc-1|<15.5-rc-1
    fixed_versions: vers:maven/15.5-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-qcj9-gcpg-4w2w/GHSA-qcj9-gcpg-4w2w.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/ba56fda175156dd35035f2b8c86cbd8ef1f90c2e
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-qcj9-gcpg-4w2w
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20854
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-45136
    reference_type:
    reference_id: CVE-2023-45136
