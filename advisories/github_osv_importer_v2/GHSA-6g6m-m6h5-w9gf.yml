advisory_id: GHSA-6g6m-m6h5-w9gf
datasource_id: github_osv_importer_v2/GHSA-6g6m-m6h5-w9gf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/06/GHSA-6g6m-m6h5-w9gf/GHSA-6g6m-m6h5-w9gf.json
aliases:
  - CVE-2020-15084
summary: "Authorization bypass in express-jwt\n### Overview\nVersions before and including 5.3.3,\
  \ we are not enforcing the **algorithms** entry to be specified in the configuration.\nWhen\
  \ **algorithms** is not specified in the configuration, with the combination of jwks-rsa,\
  \ it may lead to authorization bypass. \n\n### Am I affected?\nYou are affected by this vulnerability\
  \ if all of the following conditions apply:\n\nYou are using express-jwt\nAND \nYou do not\
  \ have **algorithms**  configured in your express-jwt configuration.\nAND\nYou are using libraries\
  \ such as jwks-rsa as the **secret**. \n\n### How to fix that?\nSpecify **algorithms** in\
  \ the express-jwt configuration. The following is an example of a proper configuration\n\n\
  ``` \nconst checkJwt = jwt({\n  secret: jwksRsa.expressJwtSecret({\n    rateLimit: true,\n\
  \    jwksRequestsPerMinute: 5,\n    jwksUri: `https://${DOMAIN}/.well-known/jwks.json`\n \
  \ }),\n  // Validate the audience and the issuer.\n  audience: process.env.AUDIENCE,\n  issuer:\
  \ `https://${DOMAIN}/`,\n  // restrict allowed algorithms\n  algorithms: ['RS256']\n}); \n\
  ```\n\n### Will this update impact my users?\nThe fix provided in patch will not affect your\
  \ users if you specified the algorithms allowed. The patch now makes **algorithms** a required\
  \ configuration. \n\n\n### Credit\nIST Group"
impacted_packages:
  - purl: pkg:npm/express-jwt
    affected_versions: vers:npm/<=5.3.3
    fixed_versions: vers:npm/6.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/06/GHSA-6g6m-m6h5-w9gf/GHSA-6g6m-m6h5-w9gf.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
  - CWE-863
references:
  - url: https://github.com/auth0/express-jwt/commit/7ecab5f8f0cab5297c2b863596566eb0c019cdef
    reference_type:
    reference_id:
  - url: https://github.com/auth0/express-jwt/security/advisories/GHSA-6g6m-m6h5-w9gf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15084
    reference_type:
    reference_id: CVE-2020-15084
