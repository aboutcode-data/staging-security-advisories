advisory_id: GHSA-qv78-c8hc-438r
datasource_id: github_osv_importer_v2/GHSA-qv78-c8hc-438r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-qv78-c8hc-438r/GHSA-qv78-c8hc-438r.json
aliases:
  - CVE-2025-64174
summary: "OpenMage vulnerable to XSS in Admin Notifications\n### Summary\nOpenMage versions\
  \ v20.15.0 and earlier are affected by a stored Cross-Site Scripting (XSS) vulnerability that\
  \ could be abused by an admin with direct database access or the admin notification feed source\
  \ to inject malicious scripts into vulnerable fields. Malicious JavaScript may be executed\
  \ in a victim’s browser when they browse to the page containing the vulnerable field.\n\n\
  ### Details\nUnescaped translation strings and URLs are printed into contexts inside `app/code/core/Mage/Adminhtml/Block/Notification/Grid/Renderer/Actions.php`.\
  \ A malicious translation or polluted data can inject script. \n- Link labels use __() without\
  \ escaping.\n- ’deleteConfirm()’ embeds a message without escaping.\n\n### PoC\n1. Add XSS\
  \ to admin locale (e.g. app/locale/en_US/local.csv):\n    ```\n    \"Read Details\",\"<img\
  \ src=x onerror=alert(123)>\"\n    \"Mark as Read\",\"<script>alert(123)</script>\"\n    ```\n\
  2. Flush Cache. Make sure locale is set to en_US.\n3. Add any admin notification (e.g. via\
  \ test.php)\n     ```\n    <?php\n    require 'app/Mage.php';\n    Mage::app('admin');\n \
  \   Mage::getModel('adminnotification/inbox')->setData([\n        'severity'  => Mage_AdminNotification_Model_Inbox::SEVERITY_NOTICE,\n\
  \        'date_added' => now(),\n        'title' => 'XSS renderer test',\n        'description'\
  \ => 'Testing actions renderer',\n        'url' => 'https://example.com', // makes the \"\
  Read Details\" link appear\n        'is_read' => 0, // makes the \"Mark as Read\" link appear\n\
  \        'is_remove' => 0,\n    ])->save();\n    ```\n4. Open Admin → System → Notifications\
  \ → Inbox.\n5. Profit.\n\n### Impact\nThe vulnerability is only exploitable by an attacker\
  \ with administrative or translation privileges. Malicious JavaScript may be executed in a\
  \ victim’s browser when they browse to the admin page containing the vulnerable fields."
impacted_packages:
  - purl: pkg:composer/openmage/magento-lts
    affected_versions: vers:composer/<20.16.0
    fixed_versions: vers:composer/20.16.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:A/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-qv78-c8hc-438r/GHSA-qv78-c8hc-438r.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/OpenMage/magento-lts
    reference_type:
    reference_id:
  - url: https://github.com/OpenMage/magento-lts/commit/9d604f5489851c54a96fca31b0e13c414b0fb20a
    reference_type:
    reference_id:
  - url: https://github.com/OpenMage/magento-lts/security/advisories/GHSA-qv78-c8hc-438r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64174
    reference_type:
    reference_id:
