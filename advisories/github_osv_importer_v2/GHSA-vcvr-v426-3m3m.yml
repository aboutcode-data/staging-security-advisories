advisory_id: GHSA-vcvr-v426-3m3m
datasource_id: github_osv_importer_v2/GHSA-vcvr-v426-3m3m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-vcvr-v426-3m3m/GHSA-vcvr-v426-3m3m.json
aliases:
  - CVE-2023-37913
summary: |
  org.xwiki.platform:xwiki-platform-office-importer vulnerable to arbitrary server side file writing from account through office converter
  ### Impact

  Triggering the office converter with a specially crafted file name allows writing the attachment's content to an attacker-controlled location on the server as long as the Java process has write access to that location. In particular in the combination with attachment moving, a feature introduced in XWiki 14.0, this is easy to reproduce but it also possible to reproduce in versions as old as XWiki 3.5 by uploading the attachment through the REST API which doesn't remove `/` or `\` from the filename. As the mime type of the attachment doesn't matter for the exploitation, this could e.g., be used to replace the `jar`-file of an extension which would allow executing arbitrary Java code and thus impact the confidentiality, integrity and availability of the XWiki installation. To reproduce the issue on versions since XWiki 14.0, execute the following steps:

  1.  Activate the office server
  2.  Upload an arbitrary file with the extension .doc, e.g., to your user profile (you can use a regular plain text file, only the extension matters).
  3.  Use the attachment move feature to rename the file to ../../../../../tmp/Hello from XWiki.txt where the latter part is the location of a file you want to write on the server. The number of ../ depends on the directory depth, the provided example should work on Linux with the demo distribution.
  4.  Click the "preview" link to trigger the office converter

  For information how to reproduce on older versions, see the [Jira issue](https://jira.xwiki.org/browse/XWIKI-20715).

  To the best of our knowledge, this attack is not possible when the office conversion process doesn't run as the code fails before the file is written.

  ### Patches

  This vulnerability has been patched in XWiki 14.10.8 and 15.3RC1.

  ### Workarounds

  There are no known workarounds apart from disabling the office converter.

  ### References

  * https://jira.xwiki.org/browse/XWIKI-20715
  * https://github.com/xwiki/xwiki-platform/commit/45d182a4141ff22f3ff289cf71e4669bdc714544
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-office-importer
    affected_versions: vers:maven/>=3.5-milestone-1|<14.10.8
    fixed_versions: vers:maven/14.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-office-importer
    affected_versions: vers:maven/>=15.0-rc-1|<15.3-rc-1
    fixed_versions: vers:maven/15.3-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-vcvr-v426-3m3m/GHSA-vcvr-v426-3m3m.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/45d182a4141ff22f3ff289cf71e4669bdc714544
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-vcvr-v426-3m3m
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20715
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-37913
    reference_type:
    reference_id: CVE-2023-37913
