advisory_id: GHSA-2h6c-j3gf-xp9r
datasource_id: github_osv_importer_v2/GHSA-2h6c-j3gf-xp9r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-2h6c-j3gf-xp9r/GHSA-2h6c-j3gf-xp9r.json
aliases:
  - CVE-2023-23626
summary: |
  IPFS go-bitfield vulnerable to DoS via malformed size arguments
  ### Impact
  When feeding untrusted user input into the size parameter of `NewBitfield` and `FromBytes` functions, an attacker can trigger `panic`s.

  This happen when the `size` is a not a multiple of `8` or is negative.
  There were already a note in the `NewBitfield` documentation:
  > ```
  > Panics if size is not a multiple of 8.
  > ````

  But it incomplete and missing from `FromBytes`'s documentation.

  This has been replaced by returning an `(Bitfield, error)` and returning a non nil error if the size is wrong.

  ### Patches
  - https://github.com/ipfs/go-bitfield/commit/5e1d256fe043fc4163343ccca83862c69c52e579

  ### Workarounds
  - Ensure `size%8 == 0 && size >= 0` yourself before calling `NewBitfield` or `FromBytes`

  ### References
  - https://github.com/ipfs/go-unixfs/security/advisories/GHSA-q264-w97q-q778
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-2h6c-j3gf-xp9r/GHSA-2h6c-j3gf-xp9r.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1284
  - CWE-754
references:
  - url: https://github.com/ipfs/go-bitfield
    reference_type:
    reference_id:
  - url: https://github.com/ipfs/go-bitfield/commit/5e1d256fe043fc4163343ccca83862c69c52e579
    reference_type:
    reference_id:
  - url: https://github.com/ipfs/go-bitfield/security/advisories/GHSA-2h6c-j3gf-xp9r
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2023-1558
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-23626
    reference_type:
    reference_id: CVE-2023-23626
