advisory_id: GHSA-g955-vw6w-v6pp
datasource_id: github_osv_importer_v2/GHSA-g955-vw6w-v6pp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-g955-vw6w-v6pp/GHSA-g955-vw6w-v6pp.json
aliases:
  - CVE-2025-62508
summary: |
  Citizen vulnerable to stored XSS in sticky header button messages
  ### Summary
  The JS implementation for copying button labels to the sticky header in the Citizen skin unescapes HTML characters, allowing for stored XSS through system messages.

  ### Details
  In the `copyButtonAttributes` function in `stickyHeader.js`, when copying the button labels, the `innerHTML` of the new element is set to the `textContent` of the old element:
  https://github.com/StarCitizenTools/mediawiki-skins-Citizen/blob/f4cbcecf5aca0ae69966b23d4983f9cb5033f319/resources/skins.citizen.scripts/stickyHeader.js#L29-L41
  This unescapes any escaped HTML characters and causes the contents of the system messages to be interpreted as HTML.

  ### PoC
  1. Edit any of the affected messages (`citizen-share`, `citizen-view-history`, `citizen-view-edit`, `nstab-talk`) to the following payload: `<img src="" onerror="alert('Sticky Header Button XSS')">`.
  2. Visit any mainpage article in the wiki using the Citizen skin.

  <img width="495" height="228" alt="image" src="https://github.com/user-attachments/assets/ac75b8e1-b181-4335-9526-17d6b6f8518e" />
  <img width="569" height="157" alt="image" src="https://github.com/user-attachments/assets/c052edb9-ff68-4869-9c66-3ec85e7ff68a" />


  ### Impact
  This impacts wikis where a group has the `editinterface` but not the `editsitejs` user right. By default, this is the case for the `sysop` group.
impacted_packages:
  - purl: pkg:composer/starcitizentools/citizen-skin
    affected_versions: vers:composer/>=3.3.0|<3.9.0
    fixed_versions: vers:composer/3.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-g955-vw6w-v6pp/GHSA-g955-vw6w-v6pp.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/StarCitizenTools/mediawiki-skins-Citizen
    reference_type:
    reference_id:
  - url: https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/e006923c6dbf113c9a025ca186ecc09fe7b93a15
    reference_type:
    reference_id:
  - url: https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/fbb1d4fe9627281567706f3f6fc99a42ce16fdc4
    reference_type:
    reference_id:
  - url: https://github.com/StarCitizenTools/mediawiki-skins-Citizen/security/advisories/GHSA-g955-vw6w-v6pp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-62508
    reference_type:
    reference_id:
