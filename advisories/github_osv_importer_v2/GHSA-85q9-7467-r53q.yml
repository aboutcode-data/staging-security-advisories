advisory_id: GHSA-85q9-7467-r53q
datasource_id: github_osv_importer_v2/GHSA-85q9-7467-r53q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-85q9-7467-r53q/GHSA-85q9-7467-r53q.json
aliases: []
summary: |
  XSS Vulnerability in Markdown Editor
  ### Impact

  InvenTree uses [EasyMDE](https://github.com/Ionaru/easy-markdown-editor) for displaying markdown text in various places (e.g. for the various "notes" fields associated with various models).

  By default, EasyMDE does not sanitize input data, and it is possible for malicious code to be injected into the markdown editor, and executed in the users browser.

  *Note: This malicious data must be first uploaded to the database by an authorized user, so the risk here is limited to trusted users*

  ### Solution

  The solution here is two-fold:

  - Enable data sanitization for the EasyMDE renderer - [#3205](https://github.com/inventree/InvenTree/pull/3205)
  - Enforce cleaning of all data uploaded to the database via the API - [#3204](https://github.com/inventree/InvenTree/pull/3204) *(This will be ready for the 0.8.0 release)*

  ### Patches

  - The issue is addressed in the upcoming 0.8.0 release
  - This fix will also be back-ported to the 0.7.x branch, applied to the 0.7.3 release

  ### Workarounds

  There is no workaround for this issue without upgrading InvenTree to the specified version.

  ### References

  - https://huntr.dev/bounties/ab296cf5-7a3e-4f49-8f63-5b35fc707f03/

  ### For more information

  If you have any questions or comments about this advisory:

  * Open an issue in [github](http://github.com/inventree/inventree)
  * Email us at [security@inventree.org](mailto:security@inventree.org)
impacted_packages:
  - purl: pkg:pypi/inventree
    affected_versions: vers:pypi/<0.7.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/inventree/InvenTree/security/advisories/GHSA-85q9-7467-r53q
    reference_type:
    reference_id:
