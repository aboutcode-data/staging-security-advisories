advisory_id: GHSA-3cx6-j9j4-54mp
datasource_id: github_osv_importer_v2/GHSA-3cx6-j9j4-54mp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-3cx6-j9j4-54mp/GHSA-3cx6-j9j4-54mp.json
aliases:
  - CVE-2025-65017
summary: |
  Decidim's private data exports can lead to data leaks
  ### Impact
  Private data exports can lead to data leaks in cases where the UUID generation causes collisions for the generated UUIDs.

  The bug was introduced by #13571 and affects Decidim versions 0.30.0 or newer (currently 2025-09-23).

  This issue  was discovered by running the following spec several times in a row, as it can randomly fail due to this bug:

  ```bash
  $ cd decidim-core
  $ for i in {1..10}; do bundle exec rspec spec/jobs/decidim/download_your_data_export_job_spec.rb -e "deletes the" || break ; done
  ```

  Run the spec as many times as needed to hit a UUID that converts to `0` through `.to_i`.

  The UUID to zero conversion does not cause a security issue but the security issue is demonstrated with the following example.

  The following code regenerates the issue by assigning a predefined UUID that will generate a collision (example assumes there are already two existing users in the system):

  ```ruby
  # Create the ZIP buffers to be stored
  buffer1 = Zip::OutputStream.write_buffer do |out|
    out.put_next_entry("admin.txt")
    out.write "Hello, admin!"
  end
  buffer1.rewind
  buffer2 = Zip::OutputStream.write_buffer do |out|
    out.put_next_entry("user.txt")
    out.write "Hello, user!"
  end
  buffer2.rewind

  # Create the private exports with a predefined IDs
  user1 = Decidim::User.find(1)
  export = user1.private_exports.build
  export.id = "0210ae70-482b-4671-b758-35e13e0097a9"
  export.export_type = "download_your_data"
  export.file.attach(io: buffer1, filename: "foobar.zip", content_type: "application/zip")
  export.expires_at = Decidim.download_your_data_expiry_time.from_now
  export.metadata = {}
  export.save!


  user2 = Decidim::User.find(2)
  export = user2.private_exports.build
  export.id = "0210d2df-a0c7-40aa-ad97-2dae5083e3b8"
  export.export_type = "download_your_data"
  export.file.attach(io: buffer2, filename: "foobar.zip", content_type: "application/zip")
  export.expires_at = Decidim.download_your_data_expiry_time.from_now
  export.metadata = {}
  export.save!
  ```

  Expect to see an error in the situation.

  Now, login as user with ID 1, go to `/download_your_data`, click "Download file" from the export and expect to see the data that should be attached to user with ID 2. This is an artificially replicated situation with the predefined UUIDs but it can easily happen in real situations.

  The reason for the test case failure can be replicated in case you change the export ID to `export.id = "e9540f96-9e3d-4abe-8c2a-6c338d85a684"`. This would return `0` through `.to_s`

  After attaching that ID, you can test if the file is available for the export:

  ```ruby
  user.private_exports.last.file.attached?
  => false
  user.private_exports.last.file.blob
  => nil
  ```

  Note that this fails with such UUID as shown in the example and could easily lead to collisions in case the UUID starts with a number. E.g. UUID `"0210ae70-482b-4671-b758-35e13e0097a9"` would convert to `210` through `.to_s`. Therefore, if someone else has a "private" export with the prefixes "00000210", "0000210", "000210", "00210", "0210" or "210", that would cause a collision and the file could be attached to the wrong private export.

  Theoretical chance of collision (the reality depends on the UUID generation algorithm):

  - Potential combinations of the UUID first part (8 characters hex): 16^8
  - Potentially colliding character combinations (8 numbers characters in the range of 0-9): 10^8
  - 10^8 / 16^8 â‰ˆ 2.3% (23 / 1000 users)

  The root cause is that the class `Decidim::PrivateExport` defines an ActiveStorage relation to `file` and the table `active_storage_attachments` stores the related `record_id` as `bigint` which causes the conversion to happen.

  ### Workarounds
  Fully disable the private exports feature until a patch is available.
impacted_packages:
  - purl: pkg:gem/decidim-core
    affected_versions: vers:gem/>=0.30.0|<0.30.4
    fixed_versions: vers:gem/0.30.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/decidim
    affected_versions: vers:gem/>=0.30.0|<0.30.4
    fixed_versions: vers:gem/0.30.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:H/VI:N/VA:N/SC:H/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-3cx6-j9j4-54mp/GHSA-3cx6-j9j4-54mp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-703
references:
  - url: https://github.com/decidim/decidim
    reference_type:
    reference_id:
  - url: https://github.com/decidim/decidim/pull/13571
    reference_type:
    reference_id:
  - url: https://github.com/decidim/decidim/releases/tag/v0.30.4
    reference_type:
    reference_id:
  - url: https://github.com/decidim/decidim/releases/tag/v0.31.0
    reference_type:
    reference_id:
  - url: https://github.com/decidim/decidim/security/advisories/GHSA-3cx6-j9j4-54mp
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/decidim-core/CVE-2025-65017.yml
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/decidim/CVE-2025-65017.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-65017
    reference_type:
    reference_id:
