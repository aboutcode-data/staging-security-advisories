advisory_id: GHSA-9x9c-ghc5-jhw9
datasource_id: github_osv_importer_v2/GHSA-9x9c-ghc5-jhw9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-9x9c-ghc5-jhw9/GHSA-9x9c-ghc5-jhw9.json
aliases:
  - CVE-2025-55207
summary: "@astrojs/node's trailing slash handling causes open redirect issue\n### Summary\n\n\
  Following https://github.com/withastro/astro/security/advisories/GHSA-cq8c-xv66-36gw, there's\
  \ still an Open Redirect vulnerability in a subset of Astro deployment scenarios.\n\n### Details\n\
  \nAstro 5.12.8 fixed a case where `https://example.com//astro.build/press` would redirect\
  \ to the external origin `//astro.build/press`. However, with the Node deployment adapter\
  \ in standalone mode and `trailingSlash` set to `\"always\"` in the Astro configuration, `https://example.com//astro.build/press`\
  \ still redirects to `//astro.build/press`.\n\n### Proof of Concept\n\n1. Create a new minimal\
  \ Astro project (`astro@5.12.8`)\n2. Configure it to use the Node adapter (`@astrojs/node@9.4.0`)\
  \ and force trailing slashes:\n   ```js\n   // astro.config.mjs\n   import { defineConfig\
  \ } from 'astro/config';\n   import node from '@astrojs/node';\n   \n   export default defineConfig({\n\
  \     trailingSlash: 'always',\n     adapter: node({ mode: 'standalone' }),\n   });\n   ```\n\
  3. Build the site by running `astro build`.\n4. Run the server, e.g. with `astro preview`.\n\
  5. Append `//astro.build/press` to the preview URL, e.g. <http://localhost:4321//astro.build/press>\n\
  6. The site will redirect to the external Astro Build origin.\n\n#### Example reproduction\n\
  \n1. Open [this StackBlitz reproduction](https://stackblitz.com/edit/github-4fvpfhcz-nyfj2mbf).\n\
  2. Open the preview in a separate window so the StackBlitz embed doesn't cause security errors.\n\
  3. Append `//astro.build/press` to the preview URL, e.g. `https://x.local-corp.webcontainer.io//astro.build/press`.\n\
  4. See it redirect to the external Astro Build origin.\n\n### Impact\n\nThis is classified\
  \ as an Open Redirection vulnerability (CWE-601). It affects any user who clicks on a specially\
  \ crafted link pointing to the affected domain. Since the domain appears legitimate, victims\
  \ may be tricked into trusting the redirected page, leading to possible credential theft,\
  \ malware distribution, or other phishing-related attacks.\n\nNo authentication is required\
  \ to exploit this vulnerability. Any unauthenticated user can trigger the redirect by clicking\
  \ a malicious link."
impacted_packages:
  - purl: pkg:npm/%40astrojs/node
    affected_versions: vers:npm/<=9.4.0
    fixed_versions: vers:npm/9.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-9x9c-ghc5-jhw9/GHSA-9x9c-ghc5-jhw9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/withastro/astro
    reference_type:
    reference_id:
  - url: https://github.com/withastro/astro/commit/5fc3c599cacb0172cc7d8e1202a5f2e8685d7ef2
    reference_type:
    reference_id:
  - url: https://github.com/withastro/astro/security/advisories/GHSA-9x9c-ghc5-jhw9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-55207
    reference_type:
    reference_id: CVE-2025-55207
