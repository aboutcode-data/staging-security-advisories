advisory_id: GHSA-ppgf-8745-8pgx
datasource_id: github_osv_importer_v2/GHSA-ppgf-8745-8pgx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/06/GHSA-ppgf-8745-8pgx/GHSA-ppgf-8745-8pgx.json
aliases: []
summary: |
  Insecure Deserialization & Arbitrary Code Execution in TYPO3 CMS
  Phar files (formerly known as "PHP archives") can act als self extracting archives which leads to the fact that source code is executed when Phar files are invoked. The Phar file format is not limited to be stored with a dedicated file extension - "bundle.phar" would be valid as well as "bundle.txt" would be. This way, Phar files can be obfuscated as image or text file which would not be denied from being uploaded and persisted to a TYPO3 installation. Due to a missing sanitization of user input, those Phar files can be invoked by manipulated URLs in TYPO3 backend forms. A valid backend user account is needed to exploit this vulnerability. In theory the attack vector would be possible in the TYPO3 frontend as well, however no functional exploit has been identified so far.
impacted_packages:
  - purl: pkg:composer/typo3/cms
    affected_versions: vers:composer/>=7.0.0|<7.6.30
    fixed_versions: vers:composer/7.6.30
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms
    affected_versions: vers:composer/>=8.0.0|<8.7.17
    fixed_versions: vers:composer/8.7.17
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms
    affected_versions: vers:composer/>=9.0.0|<9.3.2
    fixed_versions: vers:composer/9.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms/2018-07-12-2.yaml
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2018-002
    reference_type:
    reference_id:
