advisory_id: GHSA-hw28-333w-qxp3
datasource_id: github_osv_importer_v2/GHSA-hw28-333w-qxp3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-hw28-333w-qxp3/GHSA-hw28-333w-qxp3.json
aliases:
  - CVE-2024-22278
summary: |
  Harbor fails to validate the user permissions when updating project configurations
  ### Impact
  Harbor fails to validate the maintainer role permissions when creating/updating/deleting project configurations - API call:

  - PUT /projects/{project_name_or_id}/metadatas/{meta_name}
  - POST /projects/{project_name_or_id}/metadatas/{meta_name}
  - DELETE /projects/{project_name_or_id}/metadatas/{meta_name}

  By sending a request to create/update/delete a metadata with an name that belongs to a project that the currently authenticated and granted to the maintainer role user doesnâ€™t have access to, the attacker could modify configurations in the current project.

  BTW: the maintainer role in Harbor was intended for individuals who closely support the project admin in maintaining the project but lack configuration management permissions. However, the maintainer role can utilize the metadata API to circumvent this limitation. It's important to note that any potential attacker must be authenticated and granted a specific project maintainer role to modify configurations, limiting their scope to only that project.


  ### Patches
  Will be fixed in v2.9.5, v2.10.3 and v2.11.0

  ### Workarounds
  There are no workarounds available.

  ### Credit
  Thanks to Ravid Mazon(rmazon@paloaltonetworks.com), Jay Chen (jaychen@paloaltonetworks.com) Palo Alto Networks for reporting this issue.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-hw28-333w-qxp3/GHSA-hw28-333w-qxp3.json
  - score: '7.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:L/VI:L/VA:H/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-hw28-333w-qxp3/GHSA-hw28-333w-qxp3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/goharbor/harbor
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/security/advisories/GHSA-hw28-333w-qxp3
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3013
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22278
    reference_type:
    reference_id: CVE-2024-22278
