advisory_id: GHSA-796p-j2gh-9m2q
datasource_id: github_osv_importer_v2/GHSA-796p-j2gh-9m2q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-796p-j2gh-9m2q/GHSA-796p-j2gh-9m2q.json
aliases:
  - CVE-2026-22696
summary: |
  dcap-qvl has Missing Verification for QE Identity
  ## Impact
  This vulnerability involves a critical gap in the cryptographic verification process within the dcap-qvl.

  The library fetches QE Identity collateral (including qe_identity, qe_identity_signature, and qe_identity_issuer_chain) from the PCCS. However, it skips to verify the QE Identity signature against its certificate chain and does not enforce policy constraints on the QE Report.

  ## Consequences
  An attacker can forge the QE Identity data to whitelist a malicious or non-Intel Quoting Enclave. This allows the attacker to forge the QE and sign untrusted quotes that the verifier will accept as valid. Effectively, this bypasses the entire remote attestation security model, as the verifier can no longer trust the entity responsible for signing the quotes.

  ## Who is impacted
  All deployments utilizing the dcap-qvl library for SGX or TDX quote verification are affected.

  ## Patches
  The vulnerability has been patched in dcap-qvl version 0.3.9. The fix implements the missing cryptographic verification for the QE Identity signature and enforces the required checks for MRSIGNER, ISVPRODID, and ISVSVN against the QE Report.

  Users of the `@phala/dcap-qvl-node` and `@phala/dcap-qvl-web` packages should switch to the pure JavaScript implementation, `@phala/dcap-qvl`.

  ## Workarounds
  There are no known workarounds for this vulnerability. Users must upgrade to the patched version to ensure that QE Identity collateral is properly verified.

  ## Credit
  This bug was reported by Rahul Saxena <saxenism@bluethroatlabs.com>.
impacted_packages:
  - purl: pkg:npm/%40phala/dcap-qvl
    affected_versions: vers:npm/<=0.3.0
    fixed_versions: vers:npm/0.3.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40phala/dcap-qvl-web
    affected_versions: vers:npm/<=0.3.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40phala/dcap-qvl-node
    affected_versions: vers:npm/<=0.3.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/dcap-qvl
    affected_versions: vers:pypi/<0.3.9
    fixed_versions: vers:pypi/0.3.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-796p-j2gh-9m2q/GHSA-796p-j2gh-9m2q.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-295
  - CWE-347
references:
  - url: https://github.com/Phala-Network/dcap-qvl
    reference_type:
    reference_id:
  - url: https://github.com/Phala-Network/dcap-qvl/security/advisories/GHSA-796p-j2gh-9m2q
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22696
    reference_type:
    reference_id:
