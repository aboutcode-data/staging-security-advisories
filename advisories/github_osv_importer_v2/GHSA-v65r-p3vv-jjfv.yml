advisory_id: GHSA-v65r-p3vv-jjfv
datasource_id: github_osv_importer_v2/GHSA-v65r-p3vv-jjfv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-v65r-p3vv-jjfv/GHSA-v65r-p3vv-jjfv.json
aliases:
  - CVE-2023-45818
summary: |
  TinyMCE mXSS vulnerability in undo/redo, getContent API, resetContent API, and Autosave plugin
  ### Impact
  A [mutation cross-site scripting](https://researchgate.net/publication/266654651_mXSS_attacks_Attacking_well-secured_web-applications_by_using_innerHTML_mutations) (mXSS) vulnerability was discovered in TinyMCE’s core undo and redo functionality. When a carefully-crafted HTML snippet passes the XSS sanitisation layer, it is manipulated as a string by internal trimming functions before being stored in the undo stack. If the HTML snippet is restored from the undo stack, the combination of the string manipulation and reparative parsing by either the browser's native [DOMParser API](https://developer.mozilla.org/en-US/docs/Web/API/DOMParser) (TinyMCE 6) or the [SaxParser API](https://www.tiny.cloud/docs/api/tinymce.html/tinymce.html.saxparser/) (TinyMCE 5) mutates the HTML maliciously, allowing an XSS payload to be executed.
  ​This vulnerability also impacts these related TinyMCE APIs and plugins:​
  * [`tinymce.Editor.getContent({ format: 'raw' })`](https://tiny.cloud/docs/tinymce/6/apis/tinymce.editor/#getContent)
  * [`tinymce.Editor.resetContent()`](https://tiny.cloud/docs/tinymce/6/apis/tinymce.editor/#resetContent)
  * [Autosave Plugin](https://tiny.cloud/docs/tinymce/6/autosave/)

  ### Patches
  This vulnerability has been patched in TinyMCE 5.10.8 and TinyMCE 6.7.1 by ensuring HTML is trimmed using node-level manipulation instead of string manipulation.

  ### Fix
  To avoid this vulnerability:
  * Upgrade to TinyMCE 5.10.8 or higher for TinyMCE 5.x.
  * Upgrade to TinyMCE 6.7.1 or higher for TinyMCE 6.x.

  ### Acknowledgements
  Tiny Technologies would like to thank Masato Kinugawa of [Cure53](https://cure53.de/) for discovering this vulnerability.

  ### References
  * [TinyMCE 5.10.8 Release Notes](https://tiny.cloud/docs/release-notes/release-notes5108/)
  * [TinyMCE 6.7.1 Release Notes](https://tiny.cloud/docs/tinymce/6/6.7.1-release-notes/)

  ### For more information
  If you have any questions or comments about this advisory:
  * Email us at <infosec@tiny.cloud>
  * Open an issue in the [TinyMCE repo](https://github.com/tinymce/tinymce/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc)
impacted_packages:
  - purl: pkg:npm/tinymce
    affected_versions: vers:npm/>=6.0.0|<6.7.1
    fixed_versions: vers:npm/6.7.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/TinyMCE
    affected_versions: vers:nuget/>=6.0.0|<6.7.1
    fixed_versions: vers:nuget/6.7.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/tinymce/tinymce
    affected_versions: vers:composer/>=6.0.0|<6.7.1
    fixed_versions: vers:composer/6.7.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/tinymce
    affected_versions: vers:npm/<5.10.8
    fixed_versions: vers:npm/5.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/TinyMCE
    affected_versions: vers:nuget/<5.10.8
    fixed_versions: vers:nuget/5.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/tinymce/tinymce
    affected_versions: vers:composer/<5.10.8
    fixed_versions: vers:composer/5.10.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-v65r-p3vv-jjfv/GHSA-v65r-p3vv-jjfv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/tinymce/tinymce
    reference_type:
    reference_id:
  - url: https://github.com/tinymce/tinymce/security/advisories/GHSA-v65r-p3vv-jjfv
    reference_type:
    reference_id:
  - url: https://researchgate.net/publication/266654651_mXSS_attacks_Attacking_well-secured_web-applications_by_using_innerHTML_mutations
    reference_type:
    reference_id:
  - url: https://tiny.cloud/docs/release-notes/release-notes5108/#securityfixes
    reference_type:
    reference_id:
  - url: https://tiny.cloud/docs/tinymce/6/6.7.1-release-notes/#security-fixes
    reference_type:
    reference_id:
  - url: https://www.tiny.cloud/docs/api/tinymce.html/tinymce.html.saxparser
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-45818
    reference_type:
    reference_id: CVE-2023-45818
