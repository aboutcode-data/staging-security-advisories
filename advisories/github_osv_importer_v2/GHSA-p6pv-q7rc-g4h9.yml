advisory_id: GHSA-p6pv-q7rc-g4h9
datasource_id: github_osv_importer_v2/GHSA-p6pv-q7rc-g4h9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-p6pv-q7rc-g4h9/GHSA-p6pv-q7rc-g4h9.json
aliases:
  - CVE-2026-25757
summary: |
  Unauthenticated Spree Commerce users can view completed guest orders by Order ID
  ### Unauthenticated users can view completed guest orders by Order ID (`GHSL-2026-029`)

  The `OrdersController#show` action permits viewing completed guest orders by order number alone, without requiring the associated order token.

  Order lookup without enforcing token requirement in [`OrdersController#show`](https://github.com/spree/spree/blob/1341623f2ae92685cdbe232885bf5808fc8f9ca8/storefront/app/controllers/spree/orders_controller.rb#L14):

  ```ruby
  @order = complete_order_finder.new(number: params[:id], token: params[:token], store: current_store).execute.first
  ```

  Authorization bypass for guest orders in [`authorize_access`](https://github.com/spree/spree/blob/1341623f2ae92685cdbe232885bf5808fc8f9ca8/storefront/app/controllers/spree/orders_controller.rb#L51C1-L55C8):
  ```ruby
  def authorize_access
    return true if @order.user_id.nil?

    @order.user == try_spree_current_user
  end
  ```

  If the attacker is in possession of a leaked Order ID, they might look it up directly via this API.
  Alternatively, brute forcing all or parts of the possible Order IDs might be feasible for an attacker. (The Order IDs themselves are [securely generated](https://github.com/spree/spree/blob/a878eb4a782ce0445d218ea86fb12075b0e3d7cc/core/lib/spree/core/number_generator.rb#L45), but with relatively low entropy: by default an order ID has a length of 9 and a base of 10, that would require an attacker to perform 1 billion requests to gather all guest orders. (At an assumed constant rate of 100 requests per second it would take 115 days.)


  #### Proof of Concept

  1. As a guest create a complete order.
  2. Fetch the latest Order ID from the database (Table: `spree_orders`).
  3. In another clean browser access following URL: `<SPREE-HOST>/orders/<ORDER-ID>`. (Sample: `http://localhost:3000/orders/R496592563`)

  => Full guest order details are disclosed including names, addresses and limited payment info.

  #### Impact

  This issue may lead to disclosure of PII of guest users (including names, addresses and phone numbers).

  #### CWEs

  - CWE-639: Authorization Bypass Through User-Controlled Key

  ### Credit

  This issue was discovered with the [GitHub Security Lab Taskflow Agent](https://github.com/GitHubSecurityLab/seclab-taskflow-agent) and manually verified by GHSL team members [@p- (Peter St√∂ckli)](https://github.com/p-) and [@m-y-mo (Man Yue Mo)](https://github.com/m-y-mo).

  ### Disclosure Policy

  This report is subject to a 90-day disclosure deadline, as described in more detail in our [coordinated disclosure policy](https://securitylab.github.com/advisories#policy).
impacted_packages:
  - purl: pkg:gem/spree_storefront
    affected_versions: vers:gem/<5.0.8
    fixed_versions: vers:gem/5.0.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_storefront
    affected_versions: vers:gem/>=5.1.0|<5.1.10
    fixed_versions: vers:gem/5.1.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_storefront
    affected_versions: vers:gem/>=5.2.0|<5.2.7
    fixed_versions: vers:gem/5.2.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_storefront
    affected_versions: vers:gem/>=5.3.0|<5.3.2
    fixed_versions: vers:gem/5.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-p6pv-q7rc-g4h9/GHSA-p6pv-q7rc-g4h9.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-639
references:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/spree_storefront/CVE-2026-25757.yml
    reference_type:
    reference_id:
  - url: https://github.com/spree/spree
    reference_type:
    reference_id:
  - url: https://github.com/spree/spree/blob/1341623f2ae92685cdbe232885bf5808fc8f9ca8/storefront/app/controllers/spree/orders_controller.rb#L14
    reference_type:
    reference_id:
  - url: https://github.com/spree/spree/blob/1341623f2ae92685cdbe232885bf5808fc8f9ca8/storefront/app/controllers/spree/orders_controller.rb#L51C1-L55C8
    reference_type:
    reference_id:
  - url: https://github.com/spree/spree/blob/a878eb4a782ce0445d218ea86fb12075b0e3d7cc/core/lib/spree/core/number_generator.rb#L45
    reference_type:
    reference_id:
  - url: https://github.com/spree/spree/commit/3e00be64c128ef4bd4b99731f0c3ab469509cfab
    reference_type:
    reference_id:
  - url: https://github.com/spree/spree/commit/6b32ed7d474aa55fa441990e6aa39740152aa1be
    reference_type:
    reference_id:
  - url: https://github.com/spree/spree/commit/6f6b8a7a28a8bff24a6e20eab04b4bbbdf39384d
    reference_type:
    reference_id:
  - url: https://github.com/spree/spree/commit/ea4a5db590ca753dbc986f2a4e818d9e0edfb1ad
    reference_type:
    reference_id:
  - url: https://github.com/spree/spree/security/advisories/GHSA-p6pv-q7rc-g4h9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25757
    reference_type:
    reference_id:
