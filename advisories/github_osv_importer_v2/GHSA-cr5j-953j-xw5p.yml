advisory_id: GHSA-cr5j-953j-xw5p
datasource_id: github_osv_importer_v2/GHSA-cr5j-953j-xw5p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/08/GHSA-cr5j-953j-xw5p/GHSA-cr5j-953j-xw5p.json
aliases:
  - CVE-2019-5477
summary: |
  Nokogiri Command Injection Vulnerability
  A command injection vulnerability in Nokogiri v1.10.3 and earlier allows commands to be executed in a subprocess via Ruby's `Kernel.open` method. Processes are vulnerable only if the undocumented method `Nokogiri::CSS::Tokenizer#load_file` is being called with unsafe user input as the filename. This vulnerability appears in code generated by the Rexical gem versions v1.0.6 and earlier. Rexical is used by Nokogiri to generate lexical scanner code for parsing CSS queries. The underlying vulnerability was addressed in Rexical v1.0.7 and Nokogiri upgraded to this version of Rexical in Nokogiri v1.10.4.
impacted_packages:
  - purl: pkg:gem/nokogiri
    affected_versions: vers:gem/<1.10.4
    fixed_versions: vers:gem/1.10.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rexical
    affected_versions: vers:gem/<1.0.7
    fixed_versions: vers:gem/1.0.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/08/GHSA-cr5j-953j-xw5p/GHSA-cr5j-953j-xw5p.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/CVE-2019-5477.yml
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rexical/CVE-2019-5477.yml
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/commit/5d30128343573a9428c86efc758ba2c66e9f12dc
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/issues/1915
    reference_type:
    reference_id:
  - url: https://github.com/tenderlove/rexical/blob/master/CHANGELOG.rdoc
    reference_type:
    reference_id:
  - url: https://github.com/tenderlove/rexical/commit/a652474dbc66be350055db3e8f9b3a7b3fd75926
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/650835
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2019/09/msg00027.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/10/msg00018.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/10/msg00019.html
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202006-05
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4175-1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-5477
    reference_type:
    reference_id: CVE-2019-5477
