advisory_id: GHSA-6q9v-4hq6-5m67
datasource_id: github_osv_importer_v2/GHSA-6q9v-4hq6-5m67
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-6q9v-4hq6-5m67/GHSA-6q9v-4hq6-5m67.json
aliases: []
summary: |
  Doctrine SQL injection vulnerability
  Doctrine is prone to SQL injection vulnerability. Users of Doctrine 1.2 and 2 should update to the newly released versions of both libraries immediately. Both versions only include the security fix and no other changes to their previous versions 1.2.3 and 2.0.2.

  Affected versions are:
  - 1.2.3 and earlier for PostgreSQL and DB2 Dialects
  - 2.0.2 and earlier

  The security issue was found to affect the `Doctrine\DBAL\Platforms\AbstractPlatform::modifyLimitQuery()` function which does not cast input values for limit and offset to integer and allows malicious SQL to be executed if these parameters are passed into Doctrine 2 directly from request variables without previous cast to integer. Functionality building on top using limit queries in the ORM such as `Doctrine\ORM\Query::setFirstResult()` and `Doctrine\ORM\Query::setMaxResults()` are also affected by this security issue.

  The fix for this security issue breaks backwards compatibility for developers that extend the `Doctrine\DBAL\Platforms\AbstractPlatform::modifyLimitQuery()` method, because it is now marked as final. Please overwrite the `Doctrine\DBAL\Platforms\AbstractPlatform::doModifyLimitQuery()` method instead.
impacted_packages:
  - purl: pkg:composer/doctrine/orm
    affected_versions: vers:composer/>=2.0.0|<2.0.3
    fixed_versions: vers:composer/2.0.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/doctrine/orm
    affected_versions: vers:composer/>=1.0.0|<1.2.4
    fixed_versions: vers:composer/1.2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/doctrine/orm
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/doctrine/orm/2011-09-25.yaml
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20120315064147/https://www.doctrine-project.org/blog/doctrine-security-fix.html
    reference_type:
    reference_id:
