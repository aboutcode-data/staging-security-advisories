advisory_id: GHSA-qx9h-c5v6-ghqh
datasource_id: github_osv_importer_v2/GHSA-qx9h-c5v6-ghqh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-qx9h-c5v6-ghqh/GHSA-qx9h-c5v6-ghqh.json
aliases:
  - CVE-2023-29214
summary: "org.xwiki.platform:xwiki-platform-panels-ui Eval Injection vulnerability\n### Impact\n\
  Any user with edit rights can execute arbitrary Groovy, Python or Velocity code in XWiki leading\
  \ to full access to the XWiki installation. The root cause is improper escaping of the included\
  \ pages in the IncludedDocuments panel.\n\n**Precondition**: As an admin, add the `Panels.IncludedDocuments`\
  \ panel on one column.\n\nA proof of concept exploit is to edit a document and add the following\
  \ code before saving.\n\n```\n{{display reference=\"{{cache~}~}{{groovy~}~}println(~\"Hello\
  \ from Groovy~\" + ~\" in included document!~\"){{/groovy~}~}{{/cache~}~}\"/}}\n```\n\n**expected**\n\
  The right had side panels contain:\n```\nOne included page: \n{{cache}}{{groovy}}println(\"\
  Hello from Groovy\" + \" in included document!\"){{/groovy}}{{/cache}}\n```\n\n**actual**\n\
  The right had side panels contain:\n```\nOne included page:\n    XWiki.Hello from Groovy in\
  \ included document!\n```\n\n### Patches\nThe problem has been patched on XWiki 14.4.7, and\
  \ 14.10.\n\n### Workarounds\nThe issue can be fixed manually applying this [patch](https://github.com/xwiki/xwiki-platform/commit/50b4d91418b4150933f0317eb4a94ceaf5b69f67).\n\
  \n### References\n- https://github.com/xwiki/xwiki-platform/commit/50b4d91418b4150933f0317eb4a94ceaf5b69f67\n\
  - https://jira.xwiki.org/browse/XWIKI-20306\n\n### For more information\nIf you have any questions\
  \ or comments about this advisory:\n\n*    Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)\n\
  *    Email us at [Security Mailing List](mailto:security@xwiki.org)"
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-panels-ui
    affected_versions: vers:maven/>=1.1-M2|<13.10.11
    fixed_versions: vers:maven/13.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-panels-ui
    affected_versions: vers:maven/>=14.0-rc-1|<14.4.7
    fixed_versions: vers:maven/14.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-panels-ui
    affected_versions: vers:maven/>=14.5|<14.10
    fixed_versions: vers:maven/14.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-qx9h-c5v6-ghqh/GHSA-qx9h-c5v6-ghqh.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-95
  - CWE-94
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/50b4d91418b4150933f0317eb4a94ceaf5b69f67
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-qx9h-c5v6-ghqh
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20306
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29214
    reference_type:
    reference_id: CVE-2023-29214
