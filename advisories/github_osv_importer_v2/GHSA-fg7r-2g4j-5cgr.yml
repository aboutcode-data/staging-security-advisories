advisory_id: GHSA-fg7r-2g4j-5cgr
datasource_id: github_osv_importer_v2/GHSA-fg7r-2g4j-5cgr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-fg7r-2g4j-5cgr/GHSA-fg7r-2g4j-5cgr.json
aliases:
  - CVE-2021-45710
summary: |
  Race Condition in tokio
  If a tokio::sync::oneshot channel is closed (via the oneshot::Receiver::close method), a data race may occur if the oneshot::Sender::send method is called while the corresponding oneshot::Receiver is awaited or calling try_recv.

  When these methods are called concurrently on a closed channel, the two halves of the channel can concurrently access a shared memory location, resulting in a data race. This has been observed to cause memory corruption.

  Note that the race only occurs when both halves of the channel are used after the Receiver half has called close. Code where close is not used, or where the Receiver is not awaited and try_recv is not called after calling close, is not affected.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-fg7r-2g4j-5cgr/GHSA-fg7r-2g4j-5cgr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-362
references:
  - url: https://github.com/tokio-rs/tokio
    reference_type:
    reference_id:
  - url: https://github.com/tokio-rs/tokio/issues/4225
    reference_type:
    reference_id:
  - url: https://raw.githubusercontent.com/rustsec/advisory-db/main/crates/tokio/RUSTSEC-2021-0124.md
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0124.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-45710
    reference_type:
    reference_id: CVE-2021-45710
