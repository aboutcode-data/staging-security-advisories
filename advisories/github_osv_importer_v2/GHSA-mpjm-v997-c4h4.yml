advisory_id: GHSA-mpjm-v997-c4h4
datasource_id: github_osv_importer_v2/GHSA-mpjm-v997-c4h4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-mpjm-v997-c4h4/GHSA-mpjm-v997-c4h4.json
aliases:
  - CVE-2021-39184
summary: |
  Electron's sandboxed renderers can obtain thumbnails of arbitrary files through the nativeImage API
  ### Impact
  This vulnerability allows a sandboxed renderer to request a "thumbnail" image of an arbitrary file on the user's system. The thumbnail can potentially include significant parts of the original file, including textual data in many cases.

  All current stable versions of Electron are affected.

  ### Patches
  This was fixed with #30728, and the following Electron versions contain the fix:

  - 15.0.0-alpha.10
  - 14.0.0
  - 13.3.0
  - 12.1.0
  - 11.5.0

  ### Workarounds
  If your app enables `contextIsolation`, this vulnerability is significantly more difficult for an attacker to exploit.

  Further, if your app does not depend on the `createThumbnailFromPath` API, then you can simply disable the functionality. In the main process, before the 'ready' event:
  ```js
  delete require('electron').nativeImage.createThumbnailFromPath
  ```

  ### For more information
  If you have any questions or comments about this advisory, email us at [security@electronjs.org](mailto:security@electronjs.org).
impacted_packages:
  - purl: pkg:npm/electron
    affected_versions: vers:npm/<11.5.0
    fixed_versions: vers:npm/11.5.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/electron
    affected_versions: vers:npm/>=12.0.0|<12.1.0
    fixed_versions: vers:npm/12.1.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/electron
    affected_versions: vers:npm/>=13.0.0|<13.3.0
    fixed_versions: vers:npm/13.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-mpjm-v997-c4h4/GHSA-mpjm-v997-c4h4.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-668
  - CWE-862
references:
  - url: https://github.com/electron/electron
    reference_type:
    reference_id:
  - url: https://github.com/electron/electron/pull/30728
    reference_type:
    reference_id:
  - url: https://github.com/electron/electron/pull/30728/commits/8fed645bd671f359ee52d806c075ec4e07eda17f
    reference_type:
    reference_id:
  - url: https://github.com/electron/electron/security/advisories/GHSA-mpjm-v997-c4h4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39184
    reference_type:
    reference_id: CVE-2021-39184
