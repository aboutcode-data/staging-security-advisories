advisory_id: GHSA-fh74-hm69-rqjw
datasource_id: github_osv_importer_v2/GHSA-fh74-hm69-rqjw
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-fh74-hm69-rqjw/GHSA-fh74-hm69-rqjw.json
aliases:
  - CVE-2019-19921
summary: |
  opencontainers runc contains procfs race condition with a shared volume mount
  ### Impact
  By crafting a malicious root filesystem (with `/proc` being a symlink to a directory which was inside a volume shared with another running container), an attacker in control of both containers can trick `runc` into not correctly configuring the container's security labels and not correctly masking paths inside `/proc` which contain potentially-sensitive information about the host (or even allow for direct attacks against the host).

  In order to exploit this bug, an untrusted user must be able to spawn custom containers with custom mount configurations (such that a volume is shared between two containers). It should be noted that we consider this to be a fairly high level of access for an untrusted user -- and we do not recommend allowing completely untrusted users to have such degrees of access without further restrictions.

  ### Specific Go Package Affected
  github.com/opencontainers/runc/libcontainer

  ### Patches
  This vulnerability has been fixed in `1.0.0-rc10`. It should be noted that the current fix is effectively a hot-fix, and there are known ways for it to be worked around (such as making the entire root filesystem a shared volume controlled by another container). We recommend that users review their access policies to ensure that untrusted users do not have such high levels of controls over container mount configuration.

  ### Workarounds
  If you are not providing the ability for untrusted users to configure mountpoints for `runc` (or through a higher-level tool such as `docker run -v`) then you are not vulnerable to this issue. This exploit requires fairly complicated levels of access (which are available for some public clouds but are not necessarily available for all deployments).

  Additionally, it appears as though it is not possible to exploit this vulnerability through Docker (due to the order of mounts Docker generates). However you should not depend on this, as it may be possible to work around this roadblock.

  ### Credits
  This vulnerability was discovered by Cure53, as part of a third-party security audit.

  ### For more information
  If you have any questions or comments about this advisory:
  * [Open an issue](https://github.com/opencontainers/runc/issues/new).
  * Email us at [dev@opencontainers.org](mailto:dev@opencontainers.org), or [security@opencontainers.org](mailto:security@opencontainers.org) if you think you've found a security bug.
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:U/RL:U/RC:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-fh74-hm69-rqjw/GHSA-fh74-hm69-rqjw.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-362
  - CWE-706
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2020-02/msg00018.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2020:0688
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/commit/2fc03cc11c775b7a8b2e48d7ee447cb9bef32ad0
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/issues/2197
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/pull/2190
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/pull/2207
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/releases
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/security/advisories/GHSA-fh74-hm69-rqjw
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/03/msg00023.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ANUGDBJ7NBUMSUFZUSKU3ZMQYZ2Z3STN
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DHGVGGMKGZSJ7YO67TGGPFEHBYMS63VF
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FNB2UEDIIJCRQW4WJLZOPQJZXCVSXMLD
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FYVE3GB4OG3BNT5DLQHYO4M5SXX33AQ5
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/I6BF24VCZRFTYBTT3T7HDZUOTKOTNPLZ
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2021-0087
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202003-21
    reference_type:
    reference_id:
  - url: https://security-tracker.debian.org/tracker/CVE-2019-19921
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4297-1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-19921
    reference_type:
    reference_id: CVE-2019-19921
  - url: https://access.redhat.com/errata/RHSA-2020:0695
    reference_type:
    reference_id: RHSA-2020:0695
