advisory_id: GHSA-qccm-wmcq-pwr6
datasource_id: github_osv_importer_v2/GHSA-qccm-wmcq-pwr6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-qccm-wmcq-pwr6/GHSA-qccm-wmcq-pwr6.json
aliases:
  - CVE-2022-41925
summary: |
  Tailscale daemon is vulnerable to information disclosure via CSRF
  A vulnerability identified in the Tailscale client allows a malicious website to access the peer API, which can then be used to access Tailscale environment variables.

  **Affected platforms:** All
  **Patched Tailscale client versions:** v1.32.3 or later, v1.33.257 or later (unstable)

  ### What happened?
  In the Tailscale client, the peer API was vulnerable to DNS rebinding. This allowed an attacker-controlled website visited by the node to rebind DNS for the peer API to an attacker-controlled DNS server, and then making peer API requests in the client, including accessing the node’s Tailscale environment variables.

  ### Who is affected?
  All Tailscale clients prior to version v.1.32.3 are affected.

  ### What should I do?
  Upgrade to v1.32.3 or later to remediate the issue.

  ### What is the impact?
  An attacker with access to the peer API on a node could use that access to read the node’s environment variables, including any credentials or secrets stored in environment variables. This may include Tailscale authentication keys, which could then be used to add new nodes to the user’s tailnet. The peer API access could also be used to learn of other nodes in the tailnet or send files via Taildrop.

  An attacker with access to the peer API who sent a malicious file via Taildrop which was accessed while it was loading could use this to gain access to the local API, and remotely execute code.

  There is no evidence of this vulnerability being purposefully triggered or exploited.

  ### Credits
  We would like to thank [Emily Trau](https://github.com/emilytrau) and [Jamie McClymont (CyberCX)](https://twitter.com/JJJollyjim) for reporting this issue. Further detail is available in [their blog post](https://emily.id.au/tailscale).

  ### References
  * [TS-2022-005](https://tailscale.com/security-bulletins/#ts-2022-005)
  * [Researcher blog post](https://emily.id.au/tailscale)

  ### For more information
  If you have any questions or comments about this advisory, [contact Tailscale support](https://tailscale.com/contact/support/).
impacted_packages: []
severities:
  - score: '3.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:A/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-qccm-wmcq-pwr6/GHSA-qccm-wmcq-pwr6.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
  - CWE-200
references:
  - url: https://emily.id.au/tailscale
    reference_type:
    reference_id:
  - url: https://github.com/tailscale/tailscale
    reference_type:
    reference_id:
  - url: https://github.com/tailscale/tailscale/security/advisories/GHSA-qccm-wmcq-pwr6
    reference_type:
    reference_id:
  - url: https://tailscale.com/security-bulletins/#ts-2022-005
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-41925
    reference_type:
    reference_id: CVE-2022-41925
