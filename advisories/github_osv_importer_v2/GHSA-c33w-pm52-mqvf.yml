advisory_id: GHSA-c33w-pm52-mqvf
datasource_id: github_osv_importer_v2/GHSA-c33w-pm52-mqvf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-c33w-pm52-mqvf/GHSA-c33w-pm52-mqvf.json
aliases:
  - CVE-2022-39350
summary: "@dependencytrack/frontend vulnerable to  Persistent Cross-Site-Scripting via Vulnerability\
  \ Details\n### Description\n\nDue to the common practice of providing vulnerability details\
  \ in markdown format, the Dependency-Track frontend renders them using the JavaScript library\
  \ [Showdown](https://github.com/showdownjs/showdown). Showdown [does not have any XSS countermeasures\
  \ built in](https://github.com/showdownjs/showdown/wiki/Markdown's-XSS-Vulnerability-(and-how-to-mitigate-it)),\
  \ and versions before 4.6.1 of the Dependency-Track frontend did not encode or sanitize Showdown's\
  \ output. This made it possible for arbitrary JavaScript included in vulnerability details\
  \ via HTML attributes to be executed in context of the frontend.\n\n### Impact\n\nActors with\
  \ the `VULNERABILITY_MANAGEMENT` permission can exploit this weakness by creating or editing\
  \ a custom vulnerability and providing XSS payloads in any of the following fields:\n\n* Description\n\
  * Details\n* Recommendation\n* References\n\nThe payload will be executed for users with the\
  \ `VIEW_PORTFOLIO` permission when browsing to the modified vulnerability's page, for example:\
  \ \n\n```\nhttps://dtrack.example.com/vulnerabilities/INTERNAL/INT-jd8u-e8tl-8lwu\n```\n\n\
  Alternatively, malicious JavaScript could be introduced via any of the vulnerability databases\
  \ mirrored by Dependency-Track (NVD, GitHub Advisories, OSV, OSS Index, VulnDB). However,\
  \ this attack vector is highly unlikely, and the team is not aware of any occurrence of this\
  \ happening.\n\n> **Note**\n> The *Vulnerability Details* element of the *Audit Vulnerabilities*\
  \ tab in the project view is **not** affected.\n\n### Patches\n\nThe issue has been fixed\
  \ in frontend version 4.6.1.\n\n### Credit\n\nThanks to GitHub user **Waterstraal** for finding\
  \ and responsibly disclosing the issue."
impacted_packages:
  - purl: pkg:npm/%40dependencytrack/frontend
    affected_versions: vers:npm/<4.6.1
    fixed_versions: vers:npm/4.6.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/10/GHSA-c33w-pm52-mqvf/GHSA-c33w-pm52-mqvf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://docs.dependencytrack.org/changelog
    reference_type:
    reference_id:
  - url: https://github.com/DependencyTrack/frontend
    reference_type:
    reference_id:
  - url: https://github.com/DependencyTrack/frontend/security/advisories/GHSA-c33w-pm52-mqvf
    reference_type:
    reference_id:
  - url: https://github.com/showdownjs/showdown/wiki/Markdown's-XSS-Vulnerability-(and-how-to-mitigate-it)
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39350
    reference_type:
    reference_id: CVE-2022-39350
