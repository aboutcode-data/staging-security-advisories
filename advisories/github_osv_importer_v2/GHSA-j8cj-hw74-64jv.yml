advisory_id: GHSA-j8cj-hw74-64jv
datasource_id: github_osv_importer_v2/GHSA-j8cj-hw74-64jv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-j8cj-hw74-64jv/GHSA-j8cj-hw74-64jv.json
aliases: []
summary: |
  Hive has Double-free and Use After Free Vulnerabilities
  `Drop` implementation for `Hive` did perform free, but so did `Hive::close`, which, at the end of the scope performed `Drop`, therefore triggering double-free.

  Additionally, function `Hive::from_handle` was not marked as unsafe, making it, in combination with `as_handle` easy to clone and trigger double-free in safe code or triggering UB when using invalid pointer.
impacted_packages: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-416
  - CWE-415
references:
  - url: https://codeberg.org/1millibyte/toolsnt/commit/f4c7a0d1fc4a08ce40bb76e447a69a6f383a916e
    reference_type:
    reference_id:
  - url: https://codeberg.org/1millibyte/toolsnt/issues/18
    reference_type:
    reference_id:
  - url: https://docs.rs/crate/hivex
    reference_type:
    reference_id:
  - url: https://docs.rs/crate/hivex/0.2.1/source
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2026-0029.html
    reference_type:
    reference_id:
