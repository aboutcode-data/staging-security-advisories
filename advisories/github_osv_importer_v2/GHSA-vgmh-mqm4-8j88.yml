advisory_id: GHSA-vgmh-mqm4-8j88
datasource_id: github_osv_importer_v2/GHSA-vgmh-mqm4-8j88
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-vgmh-mqm4-8j88/GHSA-vgmh-mqm4-8j88.json
aliases: []
summary: |
  pared Vulnerable to Use After Free in `Parc` and `Prc` Due to Missing Lifetime Constraints
  Affected versions of this crate didn't provide sufficient lifetime constraints to conversion functions from `alloc::sync::Arc` and `alloc::rc::Rc`, which made it possible to create projections of these reference counted pointers. Unlike the original reference counted pointers, these projections could outlive original data's lifetimes.

  This projected pointer could cause the original `Arc`'s or `Rc`'s `Drop::drop` to get called at a point where the original data was no longer valid, leading to a potential use after free.

  The affected functions were
  - `pared::prc::Prc::from_rc`
  - `pared::prc::Prc::project`
  - `pared::prc::Prc::try_from_rc`
  - `pared::sync::Parc::from_arc`
  - `pared::sync::Parc::project`
  - `pared::sync::Parc::try_from_arc`

  This flaw was fixed in [108f540ea8acb6073751a1aa386085c1cdc4fd1e](https://github.com/radekvit/pared/commit/108f540ea8acb6073751a1aa386085c1cdc4fd1e) by requiring that the type stored in the `Arc`s and `Rc`s passed to these functions contain `T: 'static`.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:H/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-vgmh-mqm4-8j88/GHSA-vgmh-mqm4-8j88.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-416
references:
  - url: https://github.com/radekvit/pared
    reference_type:
    reference_id:
  - url: https://github.com/radekvit/pared/commit/108f540ea8acb6073751a1aa386085c1cdc4fd1e
    reference_type:
    reference_id:
  - url: https://github.com/radekvit/pared/issues/2
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2025-0016.html
    reference_type:
    reference_id:
