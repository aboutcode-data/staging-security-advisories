advisory_id: GHSA-chmr-rg2f-9jmf
datasource_id: github_osv_importer_v2/GHSA-chmr-rg2f-9jmf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-chmr-rg2f-9jmf/GHSA-chmr-rg2f-9jmf.json
aliases:
  - CVE-2023-34093
summary: |
  Making all attributes on a content-type public without noticing it
  ### Summary
  Anyone (Strapi developers, users, plugins) can make every attribute of a Content-Type public without knowing it.

  ### Details
  When dealing with content-types inside a Strapi instance, we can extend those using the appropriate container:
  ```javascript
  strapi.container.get('content-types').extend(contentTypeUID, (contentType) => newContentType);
  ```
  The vulnerability only affects the handling of content types by Strapi, not the actual content types themselves. Users can use plugins or modify their own content types without realizing that the `privateAttributes` getter is being removed, which can result in any attribute becoming public. This can lead to sensitive information being exposed or the entire system being taken control of by an attacker(having access to password hashes).

  ### PoC
  Extend any content type on runtime (like in the bootstrap functions) and do a copy of the content-type object.
  ```javascript
  strapi.container.get('content-types').extend(contentTypeUID, (contentType) => {
    const newCT = { ... contentType, attributes: { ...contentType.attributes, newAttr: {} } };
    return newCT;
  });
  ```
  This will have as effect to remove the getter and as we rely on it in sanitization, every attributes will be considered as public.

  ### Impact
  Everyone can be impacted. Depending on how people are using/extending content-types. If the users are mutating the content-type, they will not be affected.
impacted_packages:
  - purl: pkg:npm/%40strapi/strapi
    affected_versions: vers:npm/<4.10.8
    fixed_versions: vers:npm/4.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40strapi/utils
    affected_versions: vers:npm/<4.10.8
    fixed_versions: vers:npm/4.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40strapi/database
    affected_versions: vers:npm/<4.10.8
    fixed_versions: vers:npm/4.10.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-chmr-rg2f-9jmf/GHSA-chmr-rg2f-9jmf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/strapi/strapi
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/commit/2fa8f30371bfd1db44c15e5747860ee5789096de
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/releases/tag/v4.10.8
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/security/advisories/GHSA-chmr-rg2f-9jmf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34093
    reference_type:
    reference_id: CVE-2023-34093
