advisory_id: GHSA-9fvj-xqr2-xwg8
datasource_id: github_osv_importer_v2/GHSA-9fvj-xqr2-xwg8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-9fvj-xqr2-xwg8/GHSA-9fvj-xqr2-xwg8.json
aliases:
  - CVE-2025-58157
summary: |
  gnark affected by denial of service when computing scalar multiplication using fake-GLV algorithm
  ### Impact

  For optimizing the scalar multiplication algorithm in circuit for some curves, gnark uses fake-GLV algorithm in case the curve doesn't support true-GLV. For this to work, we need to compute the scalar decomposition using the Half GCD method in gnark-crypto. However, for some of the inputs the algorithm didn't converge quickly enough.

  In case the prover accepts untrusted witness, it could lead to denial of service as the prover gets stuck in a very slowly converging loop.

  Thanks to @feltroidprime for reporting the issue and proposing a fix.

  ### Patches

  The issue has been patched in gnark-crypto commit https://github.com/Consensys/gnark-crypto/commit/56600883e0e9f9b159e9c7000b94e76185ec3d0d. The dependency update is implemented in gnark commit https://github.com/Consensys/gnark/commit/68be6cede36e387ab760725beabd3c96cc94e6dc.

  ### Workarounds

  This update doesn't require recompiling the circuits as the issue is in the hint function. The users can update the gnark-crypto dependency to the fixed version.

  ### References

  * See bug report https://github.com/Consensys/gnark/issues/1483
  * Fake GLV description https://ethresear.ch/t/fake-glv-you-dont-need-an-efficient-endomorphism-to-implement-glv-like-scalar-multiplication-in-snark-circuits/20394
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-9fvj-xqr2-xwg8/GHSA-9fvj-xqr2-xwg8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/Consensys/gnark
    reference_type:
    reference_id:
  - url: https://github.com/Consensys/gnark/commit/68be6cede36e387ab760725beabd3c96cc94e6dc
    reference_type:
    reference_id:
  - url: https://github.com/Consensys/gnark-crypto/commit/56600883e0e9f9b159e9c7000b94e76185ec3d0d
    reference_type:
    reference_id:
  - url: https://github.com/Consensys/gnark/issues/1483
    reference_type:
    reference_id:
  - url: https://github.com/Consensys/gnark/security/advisories/GHSA-9fvj-xqr2-xwg8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-58157
    reference_type:
    reference_id:
