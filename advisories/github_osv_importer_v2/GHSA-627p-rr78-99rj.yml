advisory_id: GHSA-627p-rr78-99rj
datasource_id: github_osv_importer_v2/GHSA-627p-rr78-99rj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-627p-rr78-99rj/GHSA-627p-rr78-99rj.json
aliases:
  - CVE-2020-5415
summary: |
  GitLab auth uses full name instead of username as user ID, allowing impersonation
  ### Impact

  Installations which use the GitLab auth connector are vulnerable to identity spoofing by way of configuring a GitLab account with the same full name as another GitLab user who is granted access to a Concourse team by having their full name listed under `users` in the team configuration or given to the `--gitlab-user` flag.

  See the [GitLab auth docs](https://concourse-ci.org/gitlab-auth.html) for details.

  Concourse installations which do not configure the GitLab auth connector are not affected.

  ### Patches

  Concourse [v6.3.1](https://github.com/concourse/concourse/releases/tag/v6.3.1) and [v6.4.1](https://github.com/concourse/concourse/releases/tag/v6.4.1) were both released with a fix on August 4th, 2020.

  Both versions change the GitLab connector to use the username, rather than the full name. This was always the intent, and the previous behavior was originally reported as a bug (concourse/dex#7) prior to being reported as a security issue.

  Any Concourse teams which configure GitLab users will have to switch each user from their full name to their username upon upgrading to these versions.

  ### Workarounds

  GitLab groups do not have this vulnerability, so GitLab users may be moved into groups which are then configured in the Concourse team.

  ### References

  * concourse/dex#12: PR with the fix

  ### For more information

  If you have any questions or comments about this advisory, you may reach us privately at [concourseteam+security@gmail.com](mailto:concourseteam+security@gmail.com).
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-627p-rr78-99rj/GHSA-627p-rr78-99rj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-290
references:
  - url: https://github.com/concourse/concourse/security/advisories/GHSA-627p-rr78-99rj
    reference_type:
    reference_id:
  - url: https://tanzu.vmware.com/security/cve-2020-5415
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5415
    reference_type:
    reference_id: CVE-2020-5415
