advisory_id: GHSA-jf8p-3vjh-pq94
datasource_id: github_osv_importer_v2/GHSA-jf8p-3vjh-pq94
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-jf8p-3vjh-pq94/GHSA-jf8p-3vjh-pq94.json
aliases:
  - CVE-2022-31666
summary: |
  Harbor fails to validate the user permissions when viewing Webhook policies
  ### Impact
  Harbor fails to validate the user permissions to view Webhook policies including relevant credentials configured in different projects the user doesn’t have access to, resulting in malicious users being able to read Webhook policies of other users/projects. API call is

    GET /projects/{project_name_or_id}/webhook/policies/{webhook_policy_id}

  By sending the below request and specifying different Webhook policy ids in the last part of the URL, the malicious user may disclose Webhook policies related to other repositories/projects.: none;">

  ### Patches
  This and similar issues are fixed in Harbor v2.5.2 and later. Please upgrade as soon as possible.

  ### Workarounds
  There are no workarounds available.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [the Harbor GitHub repository](https://github.com/goharbor/harbor)

  ### Credits
  Thanks to [Gal Goldstein](https://www.linkedin.com/in/gal-goldshtein/) and [Daniel Abeles](https://www.linkedin.com/in/daniel-abeles/) from [Oxeye Security](https://www.oxeye.io/) for reporting this issue.
impacted_packages: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-jf8p-3vjh-pq94/GHSA-jf8p-3vjh-pq94.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
references:
  - url: https://github.com/goharbor/harbor
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/security/advisories/GHSA-8hwq-5f22-jfr3
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/security/advisories/GHSA-jf8p-3vjh-pq94
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31666
    reference_type:
    reference_id: CVE-2022-31666
