advisory_id: GHSA-wm8q-9975-xh5v
datasource_id: github_osv_importer_v2/GHSA-wm8q-9975-xh5v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-wm8q-9975-xh5v/GHSA-wm8q-9975-xh5v.json
aliases:
  - CVE-2023-42458
summary: |
  Zope vulnerable to Stored Cross Site Scripting with SVG images
  ### Impact
  There is a stored cross site scripting vulnerability for SVG images.

  Note that an image tag with an SVG image as source is never vulnerable, even when the SVG image contains malicious code. To exploit the vulnerability, an attacker would first need to upload an image, and then trick a user into following a specially crafted link.

  All versions of Zope are impacted on sites that allow untrusted users to upload images.


  ### Patches
  Patches will be released in Zope 4.8.10 and 5.8.5.

  ### Workarounds
  Make sure the "Add Documents, Images, and Files" permission is only assigned to trusted roles. By default only the Manager has this permission.
impacted_packages:
  - purl: pkg:pypi/zope
    affected_versions: vers:pypi/<=4.8.9
    fixed_versions: vers:pypi/4.8.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/zope
    affected_versions: vers:pypi/<=5.8.4
    fixed_versions: vers:pypi/5.8.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-wm8q-9975-xh5v/GHSA-wm8q-9975-xh5v.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/zopefoundation/Zope
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope/commit/26a55dbc301db417f47cafda6fe0f983b5690088
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope/commit/603b0a12881c90a072a7a65e32d47ed898ce37cb
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope/security/advisories/GHSA-wm8q-9975-xh5v
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/09/22/2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-42458
    reference_type:
    reference_id: CVE-2023-42458
