advisory_id: GHSA-6q49-35h6-rq2p
datasource_id: github_osv_importer_v2/GHSA-6q49-35h6-rq2p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-6q49-35h6-rq2p/GHSA-6q49-35h6-rq2p.json
aliases:
  - CVE-2022-43984
summary: |
  Browsershot version 3.57.3 vulnerable to improper input validation
  Browsershot version 3.57.3 allows an external attacker to remotely obtain arbitrary local files. This is possible because the application does not validate that the JS content imported from an external source passed to the Browsershot::html method does not contain URLs that use the file:// protocol.
impacted_packages:
  - purl: pkg:composer/spatie/browsershot
    affected_versions: vers:composer/<3.57.4
    fixed_versions: vers:composer/3.57.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-6q49-35h6-rq2p/GHSA-6q49-35h6-rq2p.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-79
references:
  - url: https://fluidattacks.com/advisories/malone
    reference_type:
    reference_id:
  - url: https://github.com/spatie/browsershot
    reference_type:
    reference_id:
  - url: https://github.com/spatie/browsershot/commit/554c3e566fde8c47ad1ac9be47eaeb9a84c4dfe2
    reference_type:
    reference_id:
  - url: https://github.com/spatie/browsershot/commit/92cf16fc098211731f80d21687abeafbe2c457ad
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-43984
    reference_type:
    reference_id: CVE-2022-43984
