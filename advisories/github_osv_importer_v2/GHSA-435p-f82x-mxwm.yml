advisory_id: GHSA-435p-f82x-mxwm
datasource_id: github_osv_importer_v2/GHSA-435p-f82x-mxwm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-435p-f82x-mxwm/GHSA-435p-f82x-mxwm.json
aliases:
  - CVE-2021-38305
summary: |
  Command injection in Yamale
  23andMe Yamale before 3.0.8 allows remote attackers to execute arbitrary code via a crafted schema file. The schema parser uses eval as part of its processing, and tries to protect from malicious expressions by limiting the builtins that are passed to the eval. When processing the schema, each line is run through Python's eval function to make the validator available. A well-constructed string within the schema rules can execute system commands; thus, by exploiting the vulnerability, an attacker can run arbitrary code on the image that invokes Yamale.
impacted_packages:
  - purl: pkg:pypi/yamale
    affected_versions: vers:pypi/<3.0.8
    fixed_versions: vers:pypi/3.0.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-435p-f82x-mxwm/GHSA-435p-f82x-mxwm.json
  - score: '8.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-435p-f82x-mxwm/GHSA-435p-f82x-mxwm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
  - CWE-78
references:
  - url: https://github.com/23andMe/Yamale
    reference_type:
    reference_id:
  - url: https://github.com/23andMe/Yamale/pull/165
    reference_type:
    reference_id:
  - url: https://github.com/23andMe/Yamale/releases/tag/3.0.8
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/yamale/PYSEC-2021-119.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-38305
    reference_type:
    reference_id: CVE-2021-38305
