advisory_id: GHSA-97jm-g33h-f46g
datasource_id: github_osv_importer_v2/GHSA-97jm-g33h-f46g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-97jm-g33h-f46g/GHSA-97jm-g33h-f46g.json
aliases: []
summary: |
  silverstripe/framework ReadOnly transformation for formfields exploitable
  Form fields returning isReadonly() as true are vulnerable to reflected XSS injections. This includes ReadonlyField, LookupField, HTMLReadonlyField, as well as special purpose fields like TimeField_Readonly. Values submitted to through these form fields are not filtered out from the form session data, and might be shown to the user depending on the form behaviour. For example, form validation errors cause the form to re-render with previously submitted values by default.

  SilverStripe forms automatically load values from request data (GET and POST), which enables malicious use of URLs if your form uses these fields and doesn't overwrite data on form construction.

  Readonly and disabled form fields are already filtered out in Form->saveInto(), so maliciously submitted data on these fields doesn't make it into the database unless you are accessing form values directly in your saving logic.
impacted_packages:
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/<3.1.21
    fixed_versions: vers:composer/3.1.21
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/>=3.2.0|<3.2.6
    fixed_versions: vers:composer/3.2.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/>=3.3.0|<3.3.4
    fixed_versions: vers:composer/3.3.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/>=3.4.0|<3.4.2
    fixed_versions: vers:composer/3.4.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-97jm-g33h-f46g/GHSA-97jm-g33h-f46g.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2016-010-1.yaml
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework/commit/8336cb96b9600dacafa8a525c92662345b52cfae
    reference_type:
    reference_id:
  - url: https://www.silverstripe.org/download/security-releases/ss-2016-010
    reference_type:
    reference_id:
