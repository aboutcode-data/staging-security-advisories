advisory_id: GHSA-pjch-4g28-fxx7
datasource_id: github_osv_importer_v2/GHSA-pjch-4g28-fxx7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-pjch-4g28-fxx7/GHSA-pjch-4g28-fxx7.json
aliases:
  - CVE-2021-23792
summary: |
  External Entity Reference in TwelveMonkeys ImageIO
  The package com.twelvemonkeys.imageio:imageio-metadata before version 3.7.1 is vulnerable to XML External Entity (XXE) Injection due to an insecurely initialized XML parser for reading XMP Metadata. An attacker can exploit this vulnerability if they are able to supply a file (e.g. when an online profile picture is processed) with a malicious XMP segment. If the XMP metadata of the uploaded image is parsed, then the XXE vulnerability is triggered.
impacted_packages:
  - purl: pkg:maven/com.twelvemonkeys.imageio/imageio-metadata
    affected_versions: vers:maven/<3.7.1
    fixed_versions: vers:maven/3.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-pjch-4g28-fxx7/GHSA-pjch-4g28-fxx7.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://github.com/haraldk/TwelveMonkeys
    reference_type:
    reference_id:
  - url: https://github.com/haraldk/TwelveMonkeys/commit/da4efe98bf09e1cce91b7633cb251958a200fc80
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JAVA-COMTWELVEMONKEYSIMAGEIO-2316763
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-23792
    reference_type:
    reference_id: CVE-2021-23792
