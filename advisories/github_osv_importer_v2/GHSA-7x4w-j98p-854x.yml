advisory_id: GHSA-7x4w-j98p-854x
datasource_id: github_osv_importer_v2/GHSA-7x4w-j98p-854x
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-7x4w-j98p-854x/GHSA-7x4w-j98p-854x.json
aliases:
  - CVE-2022-41938
summary: |
  Cross site scripting vulnerability with discussion titles
  Flarum's page title system allowed for page titles to be converted into HTML DOM nodes when pages were rendered. The change was made after `v1.5` and was not noticed.

  This allowed an attacker to inject malicious HTML markup using a discussion title input, either by creating a new discussion or renaming one. The XSS attack occurs after a visitor opens the relevant discussion page.

  ### Impact
  All communities running Flarum from `v1.5.0` to `v1.6.1` are impacted.

  ### Patches
  The vulnerability has been fixed and published as flarum/core `v1.6.2`. All communities running Flarum from `v1.5.0` to `v1.6.1` have to upgrade as soon as possible to v1.6.2 using:

  ```
  composer update --prefer-dist --no-dev -a -W
  ```

  You can then confirm you run the latest version using:

  ```
  composer show flarum/core
  ```

  ### Workarounds
  **None**

  ### For more information
  For any questions or comments on this vulnerability please visit https://discuss.flarum.org/d/27558.

  For support questions create a discussion at https://discuss.flarum.org/t/support.

  A reminder that if you ever become aware of a security issue in Flarum, please report it to us privately by emailing [security@flarum.org](mailto:security@flarum.org), and we will address it promptly.
impacted_packages:
  - purl: pkg:composer/flarum/core
    affected_versions: vers:composer/>=1.5.0|<1.6.2
    fixed_versions: vers:composer/1.6.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-7x4w-j98p-854x/GHSA-7x4w-j98p-854x.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://discuss.flarum.org/d/27558
    reference_type:
    reference_id:
  - url: https://github.com/flarum/framework
    reference_type:
    reference_id:
  - url: https://github.com/flarum/framework/commit/690de9ce0ffe7ac4d45b73e303f44340c3433138
    reference_type:
    reference_id:
  - url: https://github.com/flarum/framework/security/advisories/GHSA-7x4w-j98p-854x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-41938
    reference_type:
    reference_id: CVE-2022-41938
