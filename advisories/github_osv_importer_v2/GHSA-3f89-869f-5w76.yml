advisory_id: GHSA-3f89-869f-5w76
datasource_id: github_osv_importer_v2/GHSA-3f89-869f-5w76
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-3f89-869f-5w76/GHSA-3f89-869f-5w76.json
aliases:
  - CVE-2022-36037
summary: |
  Cross-site scripting from dynamic options in the multiselect field
  ### Introduction

  Cross-site scripting (XSS) is a type of vulnerability that allows to execute any kind of JavaScript code inside the Panel session of the same or other users. In the Panel, a harmful script can for example trigger requests to Kirby's API with the permissions of the victim.

  Such vulnerabilities are critical if you might have potential attackers in your group of authenticated Panel users. They can escalate their privileges if they get access to the Panel session of an admin user. Depending on your site, other JavaScript-powered attacks are possible.

  ### Impact

  The multiselect field allows to select tags from an autocompleted list. Unfortunately, the Panel in Kirby 3.5 used HTML rendering for the raw option value.

  This allowed **attackers with influence on the options source** (e.g. content of sibling pages or an API endpoint) to inject HTML code. If a page in the Panel that uses the manipulated multiselect options was visited by a victim and the victim opened the autocomplete dropdown, the victim's browser will then have rendered this malicious HTML code.

  You are *not* affected by this vulnerability if you don't use the multiselect field or only use it with options that cannot be manipulated by attackers.

  ### Patches

  The problem has been patched in [Kirby 3.5.8.1](https://github.com/getkirby/kirby/releases/tag/3.5.8.1). Please update to this or a [later version](https://github.com/getkirby/kirby/releases) to fix the vulnerability.

  ### Workarounds

  We recommend to update to the patch release. If you cannot update immediately, you can work around the issue by disabling the multiselect field. This can be done by uncommenting this field from all your blueprints.
impacted_packages:
  - purl: pkg:composer/getkirby/cms
    affected_versions: vers:composer/<3.5.8+1
    fixed_versions: vers:composer/3.5.8+1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-3f89-869f-5w76/GHSA-3f89-869f-5w76.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/getkirby/kirby
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/commit/b5b8863885e17556abc070dde1e20aec15fbfdf5
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.5.8.1
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/security/advisories/GHSA-3f89-869f-5w76
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-36037
    reference_type:
    reference_id: CVE-2022-36037
