advisory_id: GHSA-9vx6-7xxf-x967
datasource_id: github_osv_importer_v2/GHSA-9vx6-7xxf-x967
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-9vx6-7xxf-x967/GHSA-9vx6-7xxf-x967.json
aliases:
  - CVE-2024-27094
summary: |
  OpenZeppelin Contracts base64 encoding may read from potentially dirty memory
  ### Impact

  The `Base64.encode` function encodes a `bytes` input by iterating over it in chunks of 3 bytes. When this input is not a multiple of 3, the last iteration may read parts of the memory that are beyond the input buffer.

  Although the `encode` function pads the output for these cases, up to 4 bits of data are kept between the encoding and padding, corrupting the output if these bits were dirty (i.e. memory after the input is not 0). These conditions are more frequent in the following scenarios:

  - A `bytes memory` struct is allocated just after the input and the first bytes of it are non-zero.
  - The memory pointer is set to a non-empty memory location before allocating the input.

  Developers should evaluate whether the extra bits can be maliciously manipulated by an attacker.

  ### Patches

  Upgrade to 5.0.2 or 4.9.6.

  ### References

  This issue was reported by the Independent Security Researcher Riley Holterhus through Immunefi (@rileyholterhus on X)
impacted_packages:
  - purl: pkg:npm/%40openzeppelin/contracts
    affected_versions: vers:npm/>=4.5.0|<4.9.6
    fixed_versions: vers:npm/4.9.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40openzeppelin/contracts-upgradeable
    affected_versions: vers:npm/>=5.0.0-rc.0|<5.0.2
    fixed_versions: vers:npm/5.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40openzeppelin/contracts
    affected_versions: vers:npm/>=5.0.0-rc.0|<5.0.2
    fixed_versions: vers:npm/5.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/%40openzeppelin/contracts-upgradeable
    affected_versions: vers:npm/>=4.5.0|<4.9.6
    fixed_versions: vers:npm/4.9.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-9vx6-7xxf-x967/GHSA-9vx6-7xxf-x967.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-125
references:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/commit/92224533b1263772b0774eec3134e132a3d7b2a6
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/commit/a6286d0fded8771b3a645e5813e51993c490399c
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-9vx6-7xxf-x967
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/2d081f24cac1a867f6f73d512f2022e1fa987854
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/723f8cab09cdae1aca9ec9cc1cfa040c2d4b06c1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-27094
    reference_type:
    reference_id: CVE-2024-27094
