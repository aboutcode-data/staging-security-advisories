advisory_id: GHSA-q9p8-33wc-h432
datasource_id: github_osv_importer_v2/GHSA-q9p8-33wc-h432
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-q9p8-33wc-h432/GHSA-q9p8-33wc-h432.json
aliases:
  - CVE-2020-13794
summary: |
  Authenticated users can exploit an enumeration vulnerability in Harbor
  ### **Impact**

  Hidde Smit from Cyber Eagle has discovered an User Enumeration flaw in Harbor. The issue is present in the "/users" api endpoint. This endpoint is supposed to be restricted to administrators. This restriction is able to be bypassed and information can be obtained via the "search" functionality.

  Non-administrator users (such as those created via self-registration) can list all usernames and user IDs by sending a GET request to /api/users/search with parameter "username" and value "_", as follows:

  `curl -X GET "https://<host>/api/users/search?username=_" -H "accept: application/json" --user <user>:<password>`

  The vulnerability was immediately fixed by the Harbor team and all supported versions were patched. With the patched versions of Harbor, the username is required for search and we have removed the support for querying by email.

  ### **Patches**
  If your product uses the affected releases of Harbor, update to either version 2.1.0 or 2.0.3 to fix this issue immediately

  https://github.com/goharbor/harbor/releases/tag/v2.1.0
  https://github.com/goharbor/harbor/releases/tag/v2.0.3

  ### **Workarounds**
  There is no workaround for this issue

  ### **For more information**
  If you have any questions or comments about this advisory, contact cncf-harbor-security@lists.cncf.io
  View our security policy at https://github.com/goharbor/harbor/security/policy
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13794
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-q9p8-33wc-h432/GHSA-q9p8-33wc-h432.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/goharbor/harbor
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/releases
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/releases/tag/v2.0.3
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/releases/tag/v2.1.0
    reference_type:
    reference_id:
  - url: https://github.com/goharbor/harbor/security/advisories/GHSA-q9p8-33wc-h432
    reference_type:
    reference_id:
  - url: https://www.cybereagle.io/blog/cve-2020-13794
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-13794
    reference_type:
    reference_id: CVE-2020-13794
