advisory_id: GHSA-6xch-2vxx-5pvr
datasource_id: github_osv_importer_v2/GHSA-6xch-2vxx-5pvr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-6xch-2vxx-5pvr/GHSA-6xch-2vxx-5pvr.json
aliases: []
summary: "eZ Platform Rules to disable executable access are ignored on Platform.sh (eZ Cloud)\n\
  The recommended Apache/Nginx virtual host configuration for eZ Platform includes a rewrite\
  \ rule for blocking access to executable files in the var directory. This rule does not work\
  \ when using eZ Platform Cloud (i.e. running eZ Platform on the Platform.sh cloud service).\n\
  \ \nThe consequence of this is that in such a setup, those executable files may be downloadable.\
  \ They will not be executable, unless you have specifically configured platform.sh to allow\
  \ that (which you really should not do). The severity of the download access is limited, but\
  \ it's better if the platform.sh cloud setup works the same way as regular eZ Platform does.\
  \ All platform.sh setups are affected.\n \nThe fix adds a rule to the .platform.app.yaml configuration\
  \ file, with the same effect as the rewrite rule already mentioned. After applying the fix,\
  \ any attempt to access such files will fail with Access Denied. This security update is distributed\
  \ via Composer as ezsystems/ezplatform 1.7.9.1, and 1.13.5.1, and 2.5.4. This is the commit:\
  \ https://github.com/ezsystems/ezplatform/commit/773dddc0d8fe4fda34d2153a401eeaa6cc30b1ff"
impacted_packages:
  - purl: pkg:composer/ezsystems/ezplatform
    affected_versions: vers:composer/>=2.5.0|<2.5.4
    fixed_versions: vers:composer/2.5.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/ezsystems/ezplatform
    affected_versions: vers:composer/>=1.13.0|<1.13.5+1
    fixed_versions: vers:composer/1.13.5+1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/ezsystems/ezplatform
    affected_versions: vers:composer/>=1.7.0|<1.7.9+1
    fixed_versions: vers:composer/1.7.9+1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-670
references:
  - url: https://github.com/ezsystems/ezplatform
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform/commit/773dddc0d8fe4fda34d2153a401eeaa6cc30b1ff
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/ezsystems/ezplatform/2019-09-03-1.yaml
    reference_type:
    reference_id:
  - url: https://share.ez.no/community-project/security-advisories/ezsa-2019-006-rules-to-disable-executable-access-are-ignored-on-platform.sh-ez-cloud
    reference_type:
    reference_id:
