advisory_id: GHSA-79gp-q4wv-33fr
datasource_id: github_osv_importer_v2/GHSA-79gp-q4wv-33fr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-79gp-q4wv-33fr/GHSA-79gp-q4wv-33fr.json
aliases:
  - CVE-2024-47082
summary: |
  Cross-Site Request Forgery (CSRF) in strawberry-graphql
  ### Impact

  Multipart file upload support as defined in the [GraphQL multipart request specification](https://github.com/jaydenseric/graphql-multipart-request-spec) was enabled by default in all Strawberry HTTP view integrations. This made all Strawberry HTTP view integrations vulnerable to CSRF attacks if users did not explicitly enable CSRF preventing security mechanism for their servers.
  Additionally, the Django HTTP view integration, in particular, had an exemption for Django's built-in CSRF protection (i.e., the `CsrfViewMiddleware` middleware) by default.

  In affect, all Strawberry integrations were vulnerable to CSRF attacks by default.

  ### Patches

  Version `v0.243.0` is the first `strawberry-graphql` including a patch. Check out our [documentation](https://strawberry.rocks/docs/breaking-changes/0.243.0) for additional details and upgrade instructions.

  ### References

  - [Strawberry upgrade guide](https://strawberry.rocks/docs/breaking-changes/0.243.0)
  - [Multipart Upload Security Implications](https://github.com/jaydenseric/graphql-multipart-request-spec/blob/master/readme.md#security)

  ### Credits

  - [Thomas Grainger](https://github.com/graingert)
  - [Arthur Bayr](https://github.com/speedy1991)
  - [Jonathan Ehwald](https://github.com/DoctorJohn)
impacted_packages:
  - purl: pkg:pypi/strawberry-graphql
    affected_versions: vers:pypi/<0.243.0
    fixed_versions: vers:pypi/0.243.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-79gp-q4wv-33fr/GHSA-79gp-q4wv-33fr.json
  - score: '4.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:A/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-79gp-q4wv-33fr/GHSA-79gp-q4wv-33fr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/strawberry-graphql/PYSEC-2024-171.yaml
    reference_type:
    reference_id:
  - url: https://github.com/strawberry-graphql/strawberry
    reference_type:
    reference_id:
  - url: https://github.com/strawberry-graphql/strawberry/commit/37265b230e511480a9ceace492f9f6a484be1387
    reference_type:
    reference_id:
  - url: https://github.com/strawberry-graphql/strawberry/security/advisories/GHSA-79gp-q4wv-33fr
    reference_type:
    reference_id:
  - url: https://strawberry.rocks/docs/breaking-changes/0.243.0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47082
    reference_type:
    reference_id: CVE-2024-47082
