advisory_id: GHSA-844w-j86r-4x2j
datasource_id: github_osv_importer_v2/GHSA-844w-j86r-4x2j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/12/GHSA-844w-j86r-4x2j/GHSA-844w-j86r-4x2j.json
aliases:
  - CVE-2019-16778
summary: |
  Heap buffer overflow in `UnsortedSegmentSum` in TensorFlow
  ### Impact

  A heap buffer overflow in `UnsortedSegmentSum` can be produced when the `Index` template argument is `int32`. In this case `data_size` and `num_segments` fields are truncated from `int64` to `int32` and can produce negative numbers, resulting in accessing out of bounds heap memory.

  This is unlikely to be exploitable and was detected and fixed internally. We are making the security advisory only to notify users that it is better to update to TensorFlow 1.15 or 2.0 or later as these versions already have this fixed.

  ### Patches

  Patched by db4f9717c41bccc3ce10099ab61996b246099892 and released in all official releases after 1.15 and 2.0.

  ### For more information
  Please consult [`SECURITY.md`](https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/<1.15.0
    fixed_versions: vers:pypi/1.15.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/<1.15.0
    fixed_versions: vers:pypi/1.15.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/<1.15.0
    fixed_versions: vers:pypi/1.15.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/12/GHSA-844w-j86r-4x2j/GHSA-844w-j86r-4x2j.json
  - score: '2.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:P/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/12/GHSA-844w-j86r-4x2j/GHSA-844w-j86r-4x2j.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-681
  - CWE-122
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2019-227.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2019-234.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2019-209.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/security/advisory/tfsa-2019-002.md
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/db4f9717c41bccc3ce10099ab61996b246099892
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-844w-j86r-4x2j
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-16778
    reference_type:
    reference_id: CVE-2019-16778
