advisory_id: GHSA-fwcf-753v-fgcj
datasource_id: github_osv_importer_v2/GHSA-fwcf-753v-fgcj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-fwcf-753v-fgcj/GHSA-fwcf-753v-fgcj.json
aliases:
  - CVE-2023-30613
summary: |
  Unrestricted file upload in kiwi TCMS
  ### Impact
  Kiwi TCMS allows users to upload attachments to test plans, test cases, etc. In earlier versions there is no control over what kinds of files can be uploaded. Thus a malicious actor may upload an `.exe` file or a file containing embedded JavaScript and trick others into clicking on these files causing vulnerable browsers to execute malicious code on another computer or attempting XSS attacks.

  Stored XSS attacks via file uploads have been fixed in earlier versions of Kiwi TCMS, see [GHSA-2wcr-87wf-cf9j](https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-2wcr-87wf-cf9j). This advisory deals with prohibiting users to upload potentially compromised files in the first place.


  ### Patches
  Kiwi TCMS v12.2 comes with functionality that allows administrators to configure additional upload validator functions which give them more control over what file types are accepted for upload. By default `.exe` are denied. Other files containing the `<script>` tag, regardless of their type are also denied b/c they are a path to XSS attacks.



  ### Workarounds
  Upgrade to version 12.2 or later.

  ### References
  Originally reported by [Ahmed Rabeaa Mosaa](https://huntr.dev/bounties/c30d3503-600d-4d00-9571-98826a51f12c).
impacted_packages:
  - purl: pkg:pypi/kiwitcms
    affected_versions: vers:pypi/<12.2
    fixed_versions: vers:pypi/12.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-fwcf-753v-fgcj/GHSA-fwcf-753v-fgcj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-434
references:
  - url: https://github.com/kiwitcms/Kiwi
    reference_type:
    reference_id:
  - url: https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-fwcf-753v-fgcj
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/c30d3503-600d-4d00-9571-98826a51f12c
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/c30d3503-600d-4d00-9571-98826a51f12c
    reference_type:
    reference_id:
  - url: https://kiwitcms.org/blog/kiwi-tcms-team/2023/04/23/kiwi-tcms-122
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-30613
    reference_type:
    reference_id: CVE-2023-30613
