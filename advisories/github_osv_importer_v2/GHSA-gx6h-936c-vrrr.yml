advisory_id: GHSA-gx6h-936c-vrrr
datasource_id: github_osv_importer_v2/GHSA-gx6h-936c-vrrr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-gx6h-936c-vrrr/GHSA-gx6h-936c-vrrr.json
aliases:
  - CVE-2022-23622
summary: "Cross site scripting in registration template in xwiki-platform\n### Impact\n\nWe\
  \ found a possible XSS vector in the `registerinline.vm` template related to the `xredirect`\
  \ hidden field. \nThis template is only used in the following conditions:\n  - the wiki must\
  \ be open to registration for anyone\n  - the wiki must be closed to view for Guest users\
  \ (more specifically the XWiki.Registration page must be forbidden in View for guest user)\n\
  \nA way to obtain the second condition is when administrators checked the \"Prevent unregistered\
  \ users from viewing pages, regardless of the page rights\" box in the administration rights.\n\
  \n### Patches\n\nThe issue is patched in versions 12.10.11, 14.0-rc-1, 13.4.7, 13.10.3.\n\n\
  ### Workarounds\n\nThere are two main ways for protecting against this vulnerability, the\
  \ easiest and the best one is by applying a patch in the `registerinline.vm` template, the\
  \ patch consists in checking the value of the xredirect field to ensure it matches the following:\n\
  ```\n<input type=\"hidden\" name=\"xredirect\" value=\"$escapetool.xml($!request.xredirect)\"\
  \ />\n```\n\nIf for some reason it's not possible to patch this file, another workaround is\
  \ to ensure \"Prevent unregistered users from viewing pages, regardless of the page rights\"\
  \ is not checked in the rights and apply a better right scheme using groups and rights on\
  \ spaces. \n\n### References\n\nhttps://jira.xwiki.org/browse/XWIKI-19291\n\n### For more\
  \ information\nIf you have any questions or comments about this advisory:\n* Open an issue\
  \ in [Jira XWiki](https://jira.xwiki.org)\n* Email us at [security mailing list](mailto:security@xwiki.org)"
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=2.6.1|<12.10.11
    fixed_versions: vers:maven/12.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=13.0.0|<13.4.7
    fixed_versions: vers:maven/13.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=13.10.0|<13.10.3
    fixed_versions: vers:maven/13.10.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-gx6h-936c-vrrr/GHSA-gx6h-936c-vrrr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/053d957d53f2a543d158f3ab651e390d2728e0b9
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-gx6h-936c-vrrr
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19291
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23622
    reference_type:
    reference_id: CVE-2022-23622
