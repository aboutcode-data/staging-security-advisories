advisory_id: GHSA-7735-w2jp-gvg6
datasource_id: github_osv_importer_v2/GHSA-7735-w2jp-gvg6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-7735-w2jp-gvg6/GHSA-7735-w2jp-gvg6.json
aliases:
  - CVE-2024-5565
summary: |
  Vanna prompt injection code execution
  The Vanna library uses a prompt function to present the user with visualized results, it is possible to alter the prompt using prompt injection and run arbitrary Python code instead of the intended visualization code. Specifically - allowing external input to the library’s “ask” method with "visualize" set to True (default behavior) leads to remote code execution.
impacted_packages:
  - purl: pkg:pypi/vanna
    affected_versions: vers:pypi/<=0.5.5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-7735-w2jp-gvg6/GHSA-7735-w2jp-gvg6.json
  - score: '9.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-7735-w2jp-gvg6/GHSA-7735-w2jp-gvg6.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
  - CWE-94
references:
  - url: https://github.com/vanna-ai/vanna
    reference_type:
    reference_id:
  - url: https://research.jfrog.com/vulnerabilities/vanna-prompt-injection-rce-jfsa-2024-001034449
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-5565
    reference_type:
    reference_id: CVE-2024-5565
