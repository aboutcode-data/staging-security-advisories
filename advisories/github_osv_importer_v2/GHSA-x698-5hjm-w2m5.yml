advisory_id: GHSA-x698-5hjm-w2m5
datasource_id: github_osv_importer_v2/GHSA-x698-5hjm-w2m5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-x698-5hjm-w2m5/GHSA-x698-5hjm-w2m5.json
aliases:
  - CVE-2025-7346
summary: |
  pyLoad is vulnerable to attacks that bypass localhost restrictions, enabling the creation of arbitrary packages
  ### Summary
  Any unauthenticated attacker can bypass the localhost restrictions posed by the application and utilize this to create arbitrary packages.

  ### Details
  Any unauthenticated attacker can bypass the localhost restrictions posed by the application and utilize this to create arbitrary packages. This is done by changing the `Host` header to the value of `127.0.0.1:9666`.

  ### PoC
  The application has middleware that prevents access to several routes by checking whether the `Host` header has a specific value. We bypassed this restriction.

  https://github.com/pyload/pyload/blob/4159a1191ec4fe6d927e57a9c4bb8f54e16c381d/src/pyload/webui/app/blueprints/cnl_blueprint.py#L21-L36
  ```python
  #: decorator
  def local_check(func):
      @wraps(func)
      def wrapper(*args, **kwargs):
          remote_addr = flask.request.environ.get("REMOTE_ADDR", "0")
          http_host = flask.request.environ.get("HTTP_HOST", "0")

          if remote_addr in ("127.0.0.1", "::ffff:127.0.0.1", "::1", "localhost") or http_host in (
              "127.0.0.1:9666",
              "[::1]:9666",
          ):
              return func(*args, **kwargs)
          else:
              return "Forbidden", 403

      return wrapper
  ```

  Below we see that the '/flash/add' endpoint uses the middleware above.

  https://github.com/pyload/pyload/blob/4159a1191ec4fe6d927e57a9c4bb8f54e16c381d/src/pyload/webui/app/blueprints/cnl_blueprint.py#L56-L58C11
  ```python
  @bp.route("/flash/add", methods=["POST"], endpoint="add")
  @local_check
  def add():
  ```

  Notice how we are not authorized to access this endpoint when sending a request.
  ![image](https://user-images.githubusercontent.com/44903767/294935526-64217d91-c0d1-4d8f-963f-cedfa8dc9034.png)

  However, if we set the `Host` header to be `127.0.0.1:9666`, we notice the request returns `success`.
  ![image](https://user-images.githubusercontent.com/44903767/294933755-43ad3826-0e94-4ba5-acf0-48f11670cbc6.png)

  Checking the front end as an admin, we now see that this did indeed succeed.
  ![image](https://user-images.githubusercontent.com/44903767/294934431-5d024c75-59dc-47b6-8887-b14ae91e320f.png)

  ### Impact
  An unauthenticated user can perform actions that should only be available to authenticated users.
impacted_packages:
  - purl: pkg:pypi/pyload-ng
    affected_versions: vers:pypi/<=0.5.0b3.dev88
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-x698-5hjm-w2m5/GHSA-x698-5hjm-w2m5.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-290
  - CWE-284
references:
  - url: https://github.com/pyload/pyload
    reference_type:
    reference_id:
  - url: https://github.com/pyload/pyload/blob/4159a1191ec4fe6d927e57a9c4bb8f54e16c381d/src/pyload/webui/app/blueprints/cnl_blueprint.py#L21-L36
    reference_type:
    reference_id:
  - url: https://github.com/pyload/pyload/blob/4159a1191ec4fe6d927e57a9c4bb8f54e16c381d/src/pyload/webui/app/blueprints/cnl_blueprint.py#L56-L58C11
    reference_type:
    reference_id:
  - url: https://github.com/pyload/pyload/commit/f4e2d12416ba2dfac7b036d5c8d6dab5461b9840
    reference_type:
    reference_id:
  - url: https://github.com/pyload/pyload/security/advisories/GHSA-x698-5hjm-w2m5
    reference_type:
    reference_id:
