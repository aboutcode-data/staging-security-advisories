advisory_id: GHSA-hx74-4wmc-fwvf
datasource_id: github_osv_importer_v2/GHSA-hx74-4wmc-fwvf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-hx74-4wmc-fwvf/GHSA-hx74-4wmc-fwvf.json
aliases: []
summary: |
  Duplicate Advisory: EVE Has Partially Predetermined Vault Key
  ### Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-wc42-fcjp-v8vq. This link is maintained to preserve external references.

  ### Original Description
  Due to the implementation of "deriveVaultKey", prior to version 7.10, the generated vault key
  would always have the last 16 bytes predetermined to be "arfoobarfoobarfo".

  This issue happens because "deriveVaultKey" calls "retrieveCloudKey" (which will always
  return "foobarfoobarfoobarfoobarfoobarfo" as the key), and then merges the 32byte
  randomly generated key with this key (by takeing 16bytes from each, see "mergeKeys").

  This makes the key a lot weaker.

  This issue does not persist in devices that were initialized on/after version 7.10, but devices
  that were initialized before that and updated to a newer version still have this issue.



  Roll an update that enforces the full 32bytes key usage.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-hx74-4wmc-fwvf/GHSA-hx74-4wmc-fwvf.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-321
  - CWE-798
references:
  - url: https://asrg.io/security-advisories/cve-2023-43637
    reference_type:
    reference_id:
  - url: https://asrg.io/security-advisories/vault-key-partially-predetermined
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-43637
    reference_type:
    reference_id: CVE-2023-43637
