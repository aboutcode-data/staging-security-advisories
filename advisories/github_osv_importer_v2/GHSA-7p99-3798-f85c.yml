advisory_id: GHSA-7p99-3798-f85c
datasource_id: github_osv_importer_v2/GHSA-7p99-3798-f85c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-7p99-3798-f85c/GHSA-7p99-3798-f85c.json
aliases:
  - CVE-2022-24794
summary: |
  URL Redirection to Untrusted Site ('Open Redirect') in express-openid-connect
  ### Impact
  Users of the `requiresAuth` middleware, either directly or through the default `authRequired` option, are vulnerable to an Open Redirect when the middleware is applied to a catch all route.

  If all routes under `example.com` are protected with the `requiresAuth` middleware, a visit to `http://example.com//google.com` will be redirected to `google.com` after login because the original url reported by the Express framework is not properly sanitised.

  ### Am I affected?
  You are affected by this vulnerability if you are using the `requiresAuth` middleware on a catch all route or the default `authRequired` option and `express-openid-connect` version `<=2.7.1`.

  ### How to fix that?
  Upgrade to version `>=2.7.2`

  ### Will this update impact my users?
  The fix provided in the patch will not affect your users.
impacted_packages:
  - purl: pkg:npm/express-openid-connect
    affected_versions: vers:npm/<2.7.2
    fixed_versions: vers:npm/2.7.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-7p99-3798-f85c/GHSA-7p99-3798-f85c.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/auth0/express-openid-connect
    reference_type:
    reference_id:
  - url: https://github.com/auth0/express-openid-connect/commit/0947b92164a2c5f661ebcc183d37e7f21de719ad
    reference_type:
    reference_id:
  - url: https://github.com/auth0/express-openid-connect/security/advisories/GHSA-7p99-3798-f85c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24794
    reference_type:
    reference_id: CVE-2022-24794
