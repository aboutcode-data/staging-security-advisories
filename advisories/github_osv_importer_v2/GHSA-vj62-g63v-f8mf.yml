advisory_id: GHSA-vj62-g63v-f8mf
datasource_id: github_osv_importer_v2/GHSA-vj62-g63v-f8mf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-vj62-g63v-f8mf/GHSA-vj62-g63v-f8mf.json
aliases:
  - CVE-2021-41138
summary: |
  Validity check missing in Frontier
  ### Impact

  In the newly introduced signed Frontier-specific extrinsic for `pallet-ethereum`, a large part of transaction validation logic was only called in transaction pool validation, but not in block execution. Malicious validators can take advantage of this to put invalid transactions into a block.

  The attack is limited in that the signature is always validated, and the majority of the validation is done again in the subsequent `pallet-evm` execution logic. However, do note that a chain ID replay attack was possible. In addition, spamming attacks are of main concerns, while they are limited by Substrate block size limits and other factors.

  ### Patches

  The issue is patched in commit 146bb48849e5393004be5c88beefe76fdf009aba.

  ### References

  Patch PR: https://github.com/paritytech/frontier/pull/495

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [Frontier repo](https://github.com/paritytech/frontier/issues)

  ### Special thanks

  Special thanks to @librelois, @nanocryk and the Moonbeam team for reporting and fixing this security vulnerability.
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/10/GHSA-vj62-g63v-f8mf/GHSA-vj62-g63v-f8mf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/paritytech/frontier/commit/146bb48849e5393004be5c88beefe76fdf009aba
    reference_type:
    reference_id:
  - url: https://github.com/paritytech/frontier/pull/495
    reference_type:
    reference_id:
  - url: https://github.com/paritytech/frontier/pull/497
    reference_type:
    reference_id:
  - url: https://github.com/paritytech/frontier/security/advisories/GHSA-vj62-g63v-f8mf
    reference_type:
    reference_id:
  - url: https://github.com/polkadot-evm/frontier
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41138
    reference_type:
    reference_id: CVE-2021-41138
