advisory_id: GHSA-ffj4-jq7m-9g6v
datasource_id: github_osv_importer_v2/GHSA-ffj4-jq7m-9g6v
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-ffj4-jq7m-9g6v/GHSA-ffj4-jq7m-9g6v.json
aliases:
  - CVE-2026-22870
summary: "GuardDog Zip Bomb Vulnerability in safe_extract() Allows DoS\n## Summary\n\nGuardDog's\
  \ `safe_extract()` function does not validate decompressed file sizes when extracting ZIP\
  \ archives (wheels, eggs), allowing attackers to cause denial of service through zip bombs.\
  \ A malicious package can consume gigabytes of disk space from a few megabytes of compressed\
  \ data.\n\n## Vulnerability Details\n\n**Affected Component:** `guarddog/utils/archives.py`\
  \ - `safe_extract()` function  \n**Vulnerability Type:** CWE-409 - Improper Handling of Highly\
  \ Compressed Data (Zip Bomb)  \n**Severity:** HIGH (CVSS ~8)  \n**Attack Vector:** Network\
  \ (malicious package uploaded to PyPI/npm) or local\n\n### Root Cause\n\nThe `safe_extract()`\
  \ function handles TAR files securely using the `tarsafe` library, but ZIP file extraction\
  \ has no size validation:\n```python\nelif zipfile.is_zipfile(source_archive):\n    with zipfile.ZipFile(source_archive,\
  \ \"r\") as zip:\n        for file in zip.namelist():\n            zip.extract(file, path=os.path.join(target_directory,\
  \ file))\n```\n\n**Missing protections:**\n- ❌ No decompressed size limit\n- ❌ No compression\
  \ ratio validation  \n- ❌ No file count limits\n- ❌ No total extracted size validation\n\n\
  ## Impact\n\n### Denial of Service Scenarios\n\n**1. CI/CD Pipeline Disruption**\n- Attacker\
  \ publishes malicious package to PyPI\n- Developer adds package to requirements.txt\n- CI/CD\
  \ runs GuardDog scan\n- Disk fills (GitHub Actions: standard 14GB limit)\n- All deployments\
  \ blocked\n\n**2. Resource Exhaustion**\n- Local development environments\n- Security scanning\
  \ infrastructure  \n- Automated scanning systems\n- Docker containers with limited disk\n\n\
  **3. Supply Chain Attack Amplification**\n- Single malicious package blocks security scanning\n\
  - Prevents detection of other malicious packages\n- Forces manual intervention\n- Increases\
  \ security team workload\n\n## Recommended Fix\n\nAdd size validation for ZIP files similar\
  \ to what `tarsafe` provides for TAR files\n\n### Configuration Options\n\nMake limits configurable\
  \ via environment variables or config file\n\n## Additional Improvements\n\n1. **Add warning\
  \ logs** when archives approach limits\n2. **Provide clear error messages** for users\n3.\
  \ **Document limits** in user-facing documentation\n4. **Add tests** for zip bomb detection\n\
  5. **Consider using a safe ZIP library** (similar to tarsafe)\n\n## Credit\n\nReported by:\
  \ Charbel (dwbruijn)"
impacted_packages:
  - purl: pkg:pypi/guarddog
    affected_versions: vers:pypi/<2.7.1
    fixed_versions: vers:pypi/2.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-ffj4-jq7m-9g6v/GHSA-ffj4-jq7m-9g6v.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-409
references:
  - url: https://github.com/DataDog/guarddog
    reference_type:
    reference_id:
  - url: https://github.com/DataDog/guarddog/commit/c3fb07b4838945f42497e78b7a02bcfb1e63969b
    reference_type:
    reference_id:
  - url: https://github.com/DataDog/guarddog/security/advisories/GHSA-ffj4-jq7m-9g6v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22870
    reference_type:
    reference_id:
