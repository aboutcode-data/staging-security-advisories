advisory_id: GHSA-3p7g-wrgg-wq45
datasource_id: github_osv_importer_v2/GHSA-3p7g-wrgg-wq45
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-3p7g-wrgg-wq45/GHSA-3p7g-wrgg-wq45.json
aliases: []
summary: "GraphQL queries can expose password hashes\n### Impact\nUnauthenticated GraphQL queries\
  \ for user accounts can expose password hashes of users that have created or modified content,\
  \ typically but not necessarily limited to administrators and editors.\n\n### Patches\nAffected\
  \ versions: Ibexa DXP v3.3.\\*, v4.2.\\*, eZ Platform v2.5.\\*\nResolving versions: Ibexa\
  \ DXP v3.3.28, v4.2.3, eZ Platform v2.5.31\n\n### Workarounds\nRemove the \"passwordHash\"\
  \ entry from \"src/bundle/Resources/config/graphql/User.types.yaml\" in the GraphQL package,\
  \ and other properties like hash type, email, login if you prefer.\n\n### References\n\nThis\
  \ issue was reported to us by Philippe Tranca (\"trancap\") of the company Lexfo. We are very\
  \ grateful for their research, and responsible disclosure to us of this critical vulnerability.\
  \ \n\n### For more information\nIf you have any questions or comments about this advisory,\
  \ please contact Support via your service portal."
impacted_packages:
  - purl: pkg:composer/ibexa/graphql
    affected_versions: vers:composer/>=2.5.0|<2.5.31
    fixed_versions: vers:composer/2.5.31
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/ibexa/graphql
    affected_versions: vers:composer/>=4.2.0|<4.2.3
    fixed_versions: vers:composer/4.2.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/ibexa/graphql
    affected_versions: vers:composer/>=3.3.0|<3.3.28
    fixed_versions: vers:composer/3.3.28
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-916
references:
  - url: https://developers.ibexa.co/security-advisories/ibexa-sa-2022-009-critical-vulnerabilities-in-graphql-role-assignment-ct-editing-and-drafts-tooltips
    reference_type:
    reference_id:
  - url: https://github.com/ibexa/graphql
    reference_type:
    reference_id:
  - url: https://github.com/ibexa/graphql/commit/5ae5fb4d1d292ddde8528e040ef8a7c8dd7f9c6d
    reference_type:
    reference_id:
  - url: https://github.com/ibexa/graphql/security/advisories/GHSA-3p7g-wrgg-wq45
    reference_type:
    reference_id:
