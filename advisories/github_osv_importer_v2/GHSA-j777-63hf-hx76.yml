advisory_id: GHSA-j777-63hf-hx76
datasource_id: github_osv_importer_v2/GHSA-j777-63hf-hx76
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-j777-63hf-hx76/GHSA-j777-63hf-hx76.json
aliases:
  - CVE-2025-24030
summary: "Envoy Admin Interface Exposed through prometheus metrics endpoint\n### Impact\nA user\
  \ with access to a Kubernetes cluster where Envoy Gateway is installed can use a path traversal\
  \ attack to execute Envoy Admin interface commands on proxies managed by Envoy Gateway. The\
  \ admin interface can be used to terminate the Envoy process and extract the Envoy configuration\
  \ (possibly containing confidential data). \n\nFor example, the following command, if run\
  \ from within the Kubernetes cluster, can be used to get the configuration dump of the proxy:\n\
  ```\ncurl --path-as-is http://<Proxy-Service-ClusterIP>:19001/stats/prometheus/../../config_dump\n\
  ```\n### Patches\n1.2.6\n\n### Workarounds\nThe `EnvoyProxy` API can be used to apply a bootstrap\
  \ config patch that restricts access strictly to the prometheus stats endpoint. Find below\
  \ an example of such a bootstrap patch. \n\n```\napiVersion: gateway.envoyproxy.io/v1alpha1\n\
  kind: EnvoyProxy\nmetadata:\n  name: custom-proxy-config\n  namespace: default\nspec:\n  bootstrap:\n\
  \    type: JSONPatch\n    jsonPatches:\n    - op: \"add\"\n      path: \"/static_resources/listeners/0/filter_chains/0/filters/0/typed_config/normalize_path\"\
  \n      value: true\n    - op: \"replace\"\n      path: \"/static_resources/listeners/0/filter_chains/0/filters/0/typed_config/route_config/virtual_hosts/0/routes/0/match\"\
  \n      value:\n        path: \"/stats/prometheus\"\n        headers:\n          - name: \"\
  :method\"\n            exact_match: GET\n```\n\n### References\n- Envoy Admin Interface: https://www.envoyproxy.io/docs/envoy/latest/operations/admin\n\
  - Envoy Configuration Best Practices: https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge"
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-j777-63hf-hx76/GHSA-j777-63hf-hx76.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-419
references:
  - url: https://github.com/envoyproxy/gateway
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/gateway/commit/3eb3301ab3dbf12b201b47bdb6074d1233be07bd
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/gateway/security/advisories/GHSA-j777-63hf-hx76
    reference_type:
    reference_id:
  - url: https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge
    reference_type:
    reference_id:
  - url: https://www.envoyproxy.io/docs/envoy/latest/operations/admin
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-24030
    reference_type:
    reference_id: CVE-2025-24030
