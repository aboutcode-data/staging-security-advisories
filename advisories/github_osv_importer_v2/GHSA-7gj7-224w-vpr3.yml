advisory_id: GHSA-7gj7-224w-vpr3
datasource_id: github_osv_importer_v2/GHSA-7gj7-224w-vpr3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-7gj7-224w-vpr3/GHSA-7gj7-224w-vpr3.json
aliases:
  - CVE-2023-38286
summary: |
  Spring-boot-admin sandbox bypass via crafted HTML
  Thymeleaf through 3.1.1.RELEASE as used in spring-boot-admin (aka Spring Boot Admin) through 3.1.1 allows for a sandbox bypass via crafted HTML. This may be relevant for SSTI (Server Side Template Injection) and code execution in spring-boot-admin if MailNotifier is enabled and there is write access to environment variables via the UI.

  Spring Boot Admin 3.1.2 and 2.7.16 contain mitigations for the issue. This bypass is achived via a library called Thymeleaf which has added counter measures for this sort of bypass in version `3.1.2.RELEASE` which has explicity forbidden static access to `org.springframework.util` in expressions. Thymeleaf itself should not be considered vulnerable.
impacted_packages:
  - purl: pkg:maven/de.codecentric/spring-boot-admin-server
    affected_versions: vers:maven/>=3.0.0|<3.1.2
    fixed_versions: vers:maven/3.1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/de.codecentric/spring-boot-admin-server
    affected_versions: vers:maven/<2.7.16
    fixed_versions: vers:maven/2.7.16
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/07/GHSA-7gj7-224w-vpr3/GHSA-7gj7-224w-vpr3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-77
references:
  - url: https://github.com/codecentric/spring-boot-admin
    reference_type:
    reference_id:
  - url: https://github.com/codecentric/spring-boot-admin/blob/master/spring-boot-admin-server/pom.xml
    reference_type:
    reference_id:
  - url: https://github.com/codecentric/spring-boot-admin/commit/f1f6ac6f613e1c0afc121c8989f28b4155a6797a
    reference_type:
    reference_id:
  - url: https://github.com/codecentric/spring-boot-admin/commit/f1f6ac6f613e1c0afc121c8989f28b4155a6797a#diff-1ea8b144c29588e08221597d56d8be10b4b4a210f248a83f2e837152a3d2e0d7
    reference_type:
    reference_id:
  - url: https://github.com/codecentric/spring-boot-admin/issues/2613
    reference_type:
    reference_id:
  - url: https://github.com/codecentric/spring-boot-admin/pull/2615
    reference_type:
    reference_id:
  - url: https://github.com/p1n93r/SpringBootAdmin-thymeleaf-SSTI
    reference_type:
    reference_id:
  - url: https://github.com/thymeleaf/thymeleaf/issues/966
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38286
    reference_type:
    reference_id: CVE-2023-38286
