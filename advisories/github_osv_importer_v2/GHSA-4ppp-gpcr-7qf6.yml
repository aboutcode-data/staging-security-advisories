advisory_id: GHSA-4ppp-gpcr-7qf6
datasource_id: github_osv_importer_v2/GHSA-4ppp-gpcr-7qf6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/12/GHSA-4ppp-gpcr-7qf6/GHSA-4ppp-gpcr-7qf6.json
aliases:
  - CVE-2019-16792
summary: "HTTP Request Smuggling: Content-Length Sent Twice in Waitress\n### Impact\n\nWaitress\
  \ would header fold a double `Content-Length` header and due to being unable to cast the now\
  \ comma separated value to an integer would set the `Content-Length` to 0 internally.\n\n\
  So a request with:\n\n```\nContent-Length: 10\nContent-Length: 10\n```\n\nwould get transformed\
  \ to:\n\n```\nContent-Length: 10, 10\n```\n\nWhich would Waitress would then internally set\
  \ to `Content-Lenght: 0`.\n\nWaitress would then treat the request as having no body, thereby\
  \ treating the body of the request as a new request in HTTP pipelining.\n\n### Patches\n\n\
  This issue is fixed in Waitress 1.4.0. This brings a range of changes to harden Waitress against\
  \ potential HTTP request confusions, and may change the behaviour of Waitress behind non-conformist\
  \ proxies. \n\nThe Pylons Project recommends upgrading as soon as possible, while validating\
  \ that the changes in Waitress don't cause any changes in behavior.\n\n### Workarounds\n\n\
  Various reverse proxies may have protections against sending potentially bad HTTP requests\
  \ to the backend, and or hardening against potential issues like this. If the reverse proxy\
  \ doesn't use HTTP/1.1 for connecting to the backend issues are also somewhat mitigated, as\
  \ HTTP pipelining does not exist in HTTP/1.0 and Waitress will close the connection after\
  \ every single request (unless the Keep Alive header is explicitly sent... so this is not\
  \ a fool proof security method).\n\n### Issues/more security issues:\n\n* open an issue at\
  \ https://github.com/Pylons/waitress/issues (if not sensitive or security related)\n* email\
  \ the Pylons Security mailing list: pylons-project-security@googlegroups.com (if security\
  \ related)"
impacted_packages:
  - purl: pkg:pypi/waitress
    affected_versions: vers:pypi/<1.4.0
    fixed_versions: vers:pypi/1.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-444
references:
  - url: https://docs.pylonsproject.org/projects/waitress/en/latest/#security-fixes
    reference_type:
    reference_id:
  - url: https://github.com/Pylons/waitress
    reference_type:
    reference_id:
  - url: https://github.com/Pylons/waitress/commit/575994cd42e83fd772a5f7ec98b2c56751bd3f65
    reference_type:
    reference_id:
  - url: https://github.com/Pylons/waitress/security/advisories/GHSA-4ppp-gpcr-7qf6
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/waitress/PYSEC-2020-178.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/05/msg00011.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuapr2022.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-16792
    reference_type:
    reference_id: CVE-2019-16792
