advisory_id: GHSA-f7c3-mhj2-9pvg
datasource_id: github_osv_importer_v2/GHSA-f7c3-mhj2-9pvg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-f7c3-mhj2-9pvg/GHSA-f7c3-mhj2-9pvg.json
aliases:
  - CVE-2025-55000
summary: |
  OpenBao TOTP Secrets Engine Code Reuse
  ### Impact

  OpenBao's TOTP secrets engine could accept valid codes multiple times rather than strictly-once. This was caused by unexpected normalization in the underlying TOTP library.

  ### Patches

  OpenBao v2.3.2 will patch this issue.

  In patching, codes which were not normalized (strictly N numeric digits) will now be rejected. This is a potentially breaking change.

  ### Workarounds

  TOTP code verification is a privileged action; only trusted systems should be verifying codes. Ensure that all codes are first normalized before submitting to the OpenBao endpoint.

  ### References

  This issue was disclosed to HashiCorp and is the OpenBao equivalent of the following tickets:

  - https://discuss.hashicorp.com/t/hcsec-2025-17-vault-totp-secrets-engine-code-reuse/76036
  - https://nvd.nist.gov/vuln/detail/CVE-2025-6014
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-f7c3-mhj2-9pvg/GHSA-f7c3-mhj2-9pvg.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-156
references:
  - url: https://discuss.hashicorp.com/t/hcsec-2025-17-vault-totp-secrets-engine-code-reuse/76036
    reference_type:
    reference_id:
  - url: https://github.com/openbao/openbao
    reference_type:
    reference_id:
  - url: https://github.com/openbao/openbao/commit/183891f8d535d5b6eb3d79fda8200cade6de99e1
    reference_type:
    reference_id:
  - url: https://github.com/openbao/openbao/security/advisories/GHSA-f7c3-mhj2-9pvg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-55000
    reference_type:
    reference_id: CVE-2025-55000
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-6014
    reference_type:
    reference_id: CVE-2025-6014
