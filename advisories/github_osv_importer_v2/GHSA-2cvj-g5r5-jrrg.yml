advisory_id: GHSA-2cvj-g5r5-jrrg
datasource_id: github_osv_importer_v2/GHSA-2cvj-g5r5-jrrg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-2cvj-g5r5-jrrg/GHSA-2cvj-g5r5-jrrg.json
aliases: []
summary: |
  SurrealDB has local file read of 2-column TSV files via analyzers
  An authenticated system user at the root, namespace, or database levels can use the `DEFINE ANALYZER` statement to point to arbitrary file locations on the file system, and should the file be tab separated with two columns, the analyzer can be leveraged to exfiltrate the content.

  This issue was discovered and patched during an code audit and penetration test of SurrealDB by cure53, the severity defined within cure53's preliminary finding is Low, matched by our CVSS v4 assessment.

  ### Impact
  Limited to unauthorised access to 2 column TSV files on the file system

  ### Patches
  A patch has been created that introduces a new environment variable, `SURREAL_FILE_ALLOWLIST` , which contains a list of allowed file paths. When a mapping file is processed, the mapper checks if the fileâ€™s path is within one of the allowed paths.

  - Versions 2.1.5, 2.2.2 and later are not affected by this issue.

  ### Workarounds
  Users unable to update may want to limit those with root, namespace, or database level users to trusted parties only.

  ### References
  [SurrealQL Documentation - DEFINE ANALYZER](https://surrealdb.com/docs/surrealql/statements/define/analyzer#define-analyzer-statement)
  [#5600](https://github.com/surrealdb/surrealdb/pull/5600)
impacted_packages: []
severities:
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-2cvj-g5r5-jrrg/GHSA-2cvj-g5r5-jrrg.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/surrealdb/surrealdb
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/pull/5600
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-2cvj-g5r5-jrrg
    reference_type:
    reference_id:
