advisory_id: GHSA-9cqm-5wf7-wcj7
datasource_id: github_osv_importer_v2/GHSA-9cqm-5wf7-wcj7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-9cqm-5wf7-wcj7/GHSA-9cqm-5wf7-wcj7.json
aliases:
  - CVE-2023-26471
summary: |
  XWiki Platform users may execute anything with superadmin right through comments and async macro
  ### Impact

  Comments are supposed to be executed with the right of superadmin but in restricted mode (anything dangerous is disabled) but the async macro is not taking into account the restricted mode.

  This means that any user with comment right can use the async macro to make it execute any wiki content with the right of superadmin as in:

  {{async}}
  {{groovy}}println "it works !"{{/groovy}}
  {{/async}}

  ### Patches

  This has been patched in XWiki 14.9, 14.4.6, and 13.10.10.

  ### Workarounds

  The only known workaround consists in applying [the following patch](https://github.com/xwiki/xwiki-platform/commit/00532d9f1404287cf3ec3a05056640d809516006) and rebuilding and redeploying `org.xwiki.platform:xwiki-platform-rendering-async-macro`.

  ### References

  * https://jira.xwiki.org/browse/XWIKI-20234

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [Jira](http://jira.xwiki.org)
  * Email us at [Security ML](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-async-macro
    affected_versions: vers:maven/>=11.6-rc-1|<13.10.10
    fixed_versions: vers:maven/13.10.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-async-macro
    affected_versions: vers:maven/>=14.0|<14.4.6
    fixed_versions: vers:maven/14.4.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-async-macro
    affected_versions: vers:maven/>=14.5|<14.9
    fixed_versions: vers:maven/14.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-9cqm-5wf7-wcj7/GHSA-9cqm-5wf7-wcj7.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/00532d9f1404287cf3ec3a05056640d809516006
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9cqm-5wf7-wcj7
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20234
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-26471
    reference_type:
    reference_id: CVE-2023-26471
