advisory_id: GHSA-3989-4c6x-725f
datasource_id: github_osv_importer_v2/GHSA-3989-4c6x-725f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-3989-4c6x-725f/GHSA-3989-4c6x-725f.json
aliases:
  - CVE-2023-29516
summary: |
  XWiki Platform vulnerable to privilege escalation from view right on XWiki.AttachmentSelector
  ### Impact
  Any user with view rights on `XWiki.AttachmentSelector` can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation. The root cause is improper escaping in the "Cancel and return to page" button. This page is installed by default.

  See https://jira.xwiki.org/browse/XWIKI-20275 for the reproduction steps.

  ### Patches
  The vulnerability has been patched in XWiki 15.0-rc-1, 14.10.1, 14.4.8, and 13.10.11.

  ### Workarounds
  The issue can be fixed by applying this [patch](https://github.com/xwiki/xwiki-platform/commit/aca1d677c58563bbe6e35c9e1c29fd8b12ebb996) on `XWiki.AttachmentSelector`.

  ### References
  - https://github.com/xwiki/xwiki-platform/commit/aca1d677c58563bbe6e35c9e1c29fd8b12ebb996
  - https://jira.xwiki.org/browse/XWIKI-20275

  ### For more information

  If you have any questions or comments about this advisory:

  *    Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  *    Email us at [Security Mailing List](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-attachment-ui
    affected_versions: vers:maven/>=2.0-rc-2|<13.10.11
    fixed_versions: vers:maven/13.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-attachment-ui
    affected_versions: vers:maven/>=14.0-rc-1|<14.4.8
    fixed_versions: vers:maven/14.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-attachment-ui
    affected_versions: vers:maven/>=14.5|<14.10.1
    fixed_versions: vers:maven/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-3989-4c6x-725f/GHSA-3989-4c6x-725f.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-95
  - CWE-74
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/aca1d677c58563bbe6e35c9e1c29fd8b12ebb996
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-3989-4c6x-725f
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20275
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29516
    reference_type:
    reference_id: CVE-2023-29516
