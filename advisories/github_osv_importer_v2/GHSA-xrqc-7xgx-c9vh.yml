advisory_id: GHSA-xrqc-7xgx-c9vh
datasource_id: github_osv_importer_v2/GHSA-xrqc-7xgx-c9vh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-xrqc-7xgx-c9vh/GHSA-xrqc-7xgx-c9vh.json
aliases:
  - CVE-2025-66626
summary: "RCE via ZipSlip and symbolic links in argoproj/argo-workflows\n### Summary\nThe patch\
  \ deployed against CVE-2025-62156 is ineffective against malicious archives containing symbolic\
  \ links.\n\n### Details\nThe untar code that handles symbolic links in archives is unsafe.\
  \ Concretely, the computation of the link's target and the subsequent check are flawed: \n\
  https://github.com/argoproj/argo-workflows/blob/5291e0b01f94ba864f96f795bb500f2cfc5ad799/workflow/executor/executor.go#L1034-L1037\n\
  \n### PoC\n1. Create a malicious archive containing two files: a symbolik link with path \"\
  ./work/foo\" and target \"/etc\", and a normal text file with path \"./work/foo/hostname\"\
  .\n2. Deploy a workflow like the one in https://github.com/argoproj/argo-workflows/security/advisories/GHSA-p84v-gxvw-73pf\
  \ with the malicious archive mounted at /work/tmp.\n3. Submit the workflow and wait for its\
  \ execution. \n4. Connect to the corresponding pod and observe that the file \"/etc/hostname\"\
  \ was altered by the untar operation performed on the malicious archive. The attacker can\
  \ hence alter arbitrary files in this way. \n\n### Impact\nThe attacker can overwrite the\
  \ file /var/run/argo/argoexec with a script of their choice, which will be executed at the\
  \ pod's start."
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-xrqc-7xgx-c9vh/GHSA-xrqc-7xgx-c9vh.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-23
  - CWE-59
  - CWE-78
references:
  - url: https://github.com/advisories/GHSA-p84v-gxvw-73pf
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-workflows
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-workflows/blob/5291e0b01f94ba864f96f795bb500f2cfc5ad799/workflow/executor/executor.go#L1034-L1037
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-workflows/commit/6b92af23f35aed4d4de8b04adcaf19d68f006de1
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-workflows/security/advisories/GHSA-xrqc-7xgx-c9vh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66626
    reference_type:
    reference_id:
