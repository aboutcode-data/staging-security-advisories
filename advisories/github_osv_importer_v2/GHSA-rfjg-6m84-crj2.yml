advisory_id: GHSA-rfjg-6m84-crj2
datasource_id: github_osv_importer_v2/GHSA-rfjg-6m84-crj2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-rfjg-6m84-crj2/GHSA-rfjg-6m84-crj2.json
aliases:
  - CVE-2026-28268
summary: "Vikunja Vulnerable to Account Takeover via Password Reset Token Reuse\n**Summary**\n\
  A critical business logic vulnerability exists in the password reset mechanism of vikunja/api\
  \ that allows password reset tokens to be reused indefinitely. Due to a failure to invalidate\
  \ tokens upon use and a critical logic bug in the token cleanup cron job, reset tokens remain\
  \ valid forever.\n\nThis allows an attacker who intercepts a single reset token (via logs,\
  \ browser history, or phishing) to perform a complete, persistent account takeover at any\
  \ point in the future, bypassing standard authentication controls.\n\n**Technical Analysis**\n\
  The vulnerability stems from two distinct logic errors in the pkg/user/ package that confirm\
  \ the tokens are never removed.\n\n1. Logic Error in Password Reset (No Invalidation)\nIn\
  \ pkg/user/user_password_reset.go, the ResetPassword function successfully updates the user's\
  \ password but fails to delete the reset token used to authorize the request. Instead, it\
  \ attempts to delete a TokenEmailConfirm token, leaving the TokenPasswordReset active.\n\n\
  Vulnerable Code: pkg/user/user_password_reset.go (Lines 36-94)\n```\nfunc ResetPassword(s\
  \ *xorm.Session, reset *PasswordReset) (userID int64, err error) {\n    // ... [Validation\
  \ and User Lookup] ...\n\n    // Hash the password\n    user.Password, err = HashPassword(reset.NewPassword)\n\
  \    if err != nil {\n        return\n    }\n\n    // FLAW: Deletes 'TokenEmailConfirm' instead\
  \ of the current 'TokenPasswordReset'\n    err = removeTokens(s, user, TokenEmailConfirm)\n\
  \    if err != nil {\n        return\n    }\n\n    // ... [Update User Status and Return]\
  \ ...\n    // The reset token is never removed and remains valid in the DB.\n}\n```\n2. Logic\
  \ Error in Token Cleanup (Inverted Expiry)\nThe background cron job intended to expire old\
  \ tokens contains an inverted comparison operator. It deletes tokens newer than 24 hours instead\
  \ of older ones.\n\nVulnerable Code: pkg/user/token.go (Lines 125-151)\n```\nfunc RegisterTokenCleanupCron()\
  \ {\n    // ...\n    err := cron.Schedule(\"0 * * * *\", func() {\n        // ...\n      \
  \  // FLAW: \"created > ?\" selects tokens created AFTER 24 hours ago.\n        // This deletes\
  \ NEW valid tokens and keeps OLD expired tokens forever.\n        deleted, err := s.\n   \
  \         Where(\"created > ? AND (kind = ? OR kind = ?)\", \n            time.Now().Add(time.Hour*24*-1),\
  \ \n            TokenPasswordReset, TokenAccountDeletion).\n            Delete(&Token{})\n\
  \        // ...\n    })\n}\n\n```\n\n**Impact**\nPersistent Account Takeover: An attacker\
  \ with a single valid token can reset the victim's password an unlimited number of times.\n\
  \nBypass of Remediation: Even if the victim notices suspicious activity and changes their\
  \ password, the attacker can use the same old token to reset it again immediately.\n\nInfinite\
  \ Attack Window: Because the cleanup cron is broken, the token effectively has a generic TTL\
  \ of \"forever,\" allowing exploitation months or years after the token was issued.\n\n**Remediation**\n\
  1. Invalidate Token on Use\nUpdate ResetPassword to delete the specific reset token upon successful\
  \ completion.\n`// Recommended Fix\nerr = removeTokens(s, user, TokenPasswordReset) // Correct\
  \ TokenKind`\n2. Fix Cleanup Logic\nUpdate the SQL query in RegisterTokenCleanupCron to target\
  \ tokens created before the cutoff time.\n`// Recommended Fix\nWhere(\"created < ? ...\",\
  \ time.Now().Add(time.Hour*24*-1), ...) // Use Less Than (<)`\n\nA fix is available at https://github.com/go-vikunja/vikunja/releases/tag/v2.1.0"
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-rfjg-6m84-crj2/GHSA-rfjg-6m84-crj2.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-459
  - CWE-640
references:
  - url: https://github.com/go-vikunja/vikunja
    reference_type:
    reference_id:
  - url: https://github.com/go-vikunja/vikunja/commit/5c2195f9fca9ad208477e865e6009c37889f87b2
    reference_type:
    reference_id:
  - url: https://github.com/go-vikunja/vikunja/security/advisories/GHSA-rfjg-6m84-crj2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-28268
    reference_type:
    reference_id:
  - url: https://vikunja.io/changelog/vikunja-v2.1.0-was-released
    reference_type:
    reference_id:
