advisory_id: GHSA-8vp7-j5cj-vvm2
datasource_id: github_osv_importer_v2/GHSA-8vp7-j5cj-vvm2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-8vp7-j5cj-vvm2/GHSA-8vp7-j5cj-vvm2.json
aliases:
  - CVE-2020-5220
summary: |
  Ability to expose data in Sylius by using an unintended serialisation group
  ### Impact

  ResourceBundle accepts and uses any serialisation groups to be passed via a HTTP header. This might lead to data exposure by using an unintended serialisation group - for example it could make Shop API use a more permissive group from Admin API.

  Anyone exposing an API with ResourceBundle's controller is affected. The vulnerable versions are: `<1.3 || >=1.3.0 <=1.3.12 || >=1.4.0 <=1.4.5 || >=1.5.0 <=1.5.0 || >=1.6.0 <=1.6.2`.

  ### Patches

  The patch is provided for ResourceBundle 1.3.13, 1.4.6, 1.5.1 and 1.6.3, but not for any versions below 1.3.

  After it is applied, It allows to choose only the groups that are defined in `serialization_groups` or `allowed_serialization_groups` route definition. Any group not defined in those will not be used.

  This behaviour might be a BC break for those using custom groups via the HTTP header, please adjust `allowed_serialization_groups` accordingly.

  ### Workarounds

  Service `sylius.resource_controller.request_configuration_factory` can be overridden with an implementation copied from `\Sylius\Bundle\ResourceBundle\Controller\RequestConfigurationFactory` where the part that handles custom serialisation groups is deleted.
impacted_packages:
  - purl: pkg:composer/sylius/resource-bundle
    affected_versions: vers:composer/>=1.4.0|<1.4.6
    fixed_versions: vers:composer/1.4.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/resource-bundle
    affected_versions: vers:composer/>=1.5.0|<1.5.1
    fixed_versions: vers:composer/1.5.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/resource-bundle
    affected_versions: vers:composer/>=1.6.0|<1.6.3
    fixed_versions: vers:composer/1.6.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/sylius
    affected_versions: vers:composer/<1.3.12
    fixed_versions: vers:composer/1.3.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/sylius
    affected_versions: vers:composer/>=1.4.0|<1.4.4
    fixed_versions: vers:composer/1.4.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sylius/resource-bundle
    affected_versions: vers:composer/>=1.0.0|<1.3.13
    fixed_versions: vers:composer/1.3.13
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-8vp7-j5cj-vvm2/GHSA-8vp7-j5cj-vvm2.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-444
  - CWE-200
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/sylius/resource-bundle/CVE-2020-5220.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/sylius/sylius/CVE-2020-5220.yaml
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/SyliusResourceBundle/security/advisories/GHSA-8vp7-j5cj-vvm2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5220
    reference_type:
    reference_id: CVE-2020-5220
