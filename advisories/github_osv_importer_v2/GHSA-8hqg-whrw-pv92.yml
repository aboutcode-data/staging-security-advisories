advisory_id: GHSA-8hqg-whrw-pv92
datasource_id: github_osv_importer_v2/GHSA-8hqg-whrw-pv92
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-8hqg-whrw-pv92/GHSA-8hqg-whrw-pv92.json
aliases:
  - CVE-2024-37032
summary: |
  Ollama does not validate the format of the digest (sha256 with 64 hex digits)
  Ollama before 0.1.34 does not validate the format of the digest (sha256 with 64 hex digits) when getting the model path, and thus mishandles the TestGetBlobsPath test cases such as fewer than 64 hex digits, more than 64 hex digits, or an initial `../` substring.
impacted_packages: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/advisories/GHSA-8hqg-whrw-pv92
    reference_type:
    reference_id:
  - url: https://github.com/ollama/ollama
    reference_type:
    reference_id:
  - url: https://github.com/ollama/ollama/blob/adeb40eaf29039b8964425f69a9315f9f1694ba8/server/modelpath_test.go#L41-L58
    reference_type:
    reference_id:
  - url: https://github.com/ollama/ollama/commit/2a21363bb756a7341d3d577f098583865bd7603f
    reference_type:
    reference_id:
  - url: https://github.com/ollama/ollama/compare/v0.1.33...v0.1.34
    reference_type:
    reference_id:
  - url: https://github.com/ollama/ollama/pull/4175
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-2901
    reference_type:
    reference_id:
  - url: https://www.vicarius.io/vsociety/posts/probllama-in-ollama-a-tale-of-a-yet-another-rce-vulnerability-cve-2024-37032
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37032
    reference_type:
    reference_id: CVE-2024-37032
