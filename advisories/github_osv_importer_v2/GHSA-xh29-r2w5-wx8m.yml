advisory_id: GHSA-xh29-r2w5-wx8m
datasource_id: github_osv_importer_v2/GHSA-xh29-r2w5-wx8m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-xh29-r2w5-wx8m/GHSA-xh29-r2w5-wx8m.json
aliases:
  - CVE-2022-29181
summary: |
  Nokogiri Improperly Handles Unexpected Data Type
  ### Summary

  Nokogiri `< v1.13.6` does not type-check all inputs into the XML and HTML4 SAX parsers. For CRuby users, this may allow specially crafted untrusted inputs to cause illegal memory access errors (segfault) or reads from unrelated memory.

  ### Severity

  The Nokogiri maintainers have evaluated this as **High 8.2** (CVSS3.1).


  ### Mitigation

  CRuby users should upgrade to Nokogiri `>= 1.13.6`.

  JRuby users are not affected.


  ### Workarounds

  To avoid this vulnerability in affected applications, ensure the untrusted input is a `String` by calling `#to_s` or equivalent.


  ### Credit

  This vulnerability was responsibly reported by @agustingianni and the Github Security Lab.
impacted_packages:
  - purl: pkg:gem/nokogiri
    affected_versions: vers:gem/<1.13.6
    fixed_versions: vers:gem/1.13.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-xh29-r2w5-wx8m/GHSA-xh29-r2w5-wx8m.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-241
  - CWE-843
references:
  - url: http://seclists.org/fulldisclosure/2022/Dec/23
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/CVE-2022-29181.yml
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/commit/83cc451c3f29df397caa890afc3b714eae6ab8f7
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/commit/db05ba9a1bd4b90aa6c76742cf6102a7c7297267
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/releases/tag/v1.13.6
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-xh29-r2w5-wx8m
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202208-29
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2022-031_GHSL-2022-032_Nokogiri
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT213532
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29181
    reference_type:
    reference_id: CVE-2022-29181
