advisory_id: GHSA-r33w-fg8j-9c94
datasource_id: github_osv_importer_v2/GHSA-r33w-fg8j-9c94
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-r33w-fg8j-9c94/GHSA-r33w-fg8j-9c94.json
aliases: []
summary: |
  MagicLink: Insecure Deserialization of MagicLink Actions Leads to Remote Code Execution
  ## Description

  MagicLink stores serialized action objects in the `magic_links.action` database column and deserializes them without integrity validation or class allowlisting in [src/MagicLink.php](src/MagicLink.php#L59-L77) and [src/Actions/ResponseAction.php](src/Actions/ResponseAction.php#L64-L77). An attacker with the ability to manipulate database records (e.g., via SQL injection or compromised admin access) could inject malicious serialized objects containing arbitrary closures, leading to Remote Code Execution (RCE) when the magic link is visited.

  ## Resolution

  The vulnerability has been mitigated through HMAC-signed serialization using the application key, class allowlisting restricted to `ActionAbstract` subclasses and framework classes, strict type validation preventing arbitrary object storage, and backward compatibility support for legacy data via `allowed_classes` in `unserialize()`. Implementation includes a new [Serializable](src/Security/Serializable/Serializable.php) security class with signing/verification, refactored getter/setter methods in MagicLink.
impacted_packages:
  - purl: pkg:composer/cesargb/laravel-magiclink
    affected_versions: vers:composer/>=2.0.0|<2.25.1
    fixed_versions: vers:composer/2.25.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-r33w-fg8j-9c94/GHSA-r33w-fg8j-9c94.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://github.com/cesargb/laravel-magiclink
    reference_type:
    reference_id:
  - url: https://github.com/cesargb/laravel-magiclink/releases/tag/v2.25.1
    reference_type:
    reference_id:
  - url: https://github.com/cesargb/laravel-magiclink/security/advisories/GHSA-r33w-fg8j-9c94
    reference_type:
    reference_id:
