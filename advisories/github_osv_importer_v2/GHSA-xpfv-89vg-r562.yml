advisory_id: GHSA-xpfv-89vg-r562
datasource_id: github_osv_importer_v2/GHSA-xpfv-89vg-r562
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-xpfv-89vg-r562/GHSA-xpfv-89vg-r562.json
aliases:
  - CVE-2022-0335
summary: |
  Cross Site Request Forgery in Moodle
  A flaw was found in Moodle in versions 3.11 to 3.11.4, 3.10 to 3.10.8, 3.9 to 3.9.11 and earlier unsupported versions. The "delete badge alignment" functionality did not include the necessary token check to prevent a CSRF risk.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.11.0|<3.11.5
    fixed_versions: vers:composer/3.11.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.10.0|<3.10.8
    fixed_versions: vers:composer/3.10.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=3.9.0|<3.9.11
    fixed_versions: vers:composer/3.9.11
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-xpfv-89vg-r562/GHSA-xpfv-89vg-r562.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2043666
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/d40cc61eba229c6d1f47b9a525022fbc9136b9f6
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=431103
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-0335
    reference_type:
    reference_id: CVE-2022-0335
