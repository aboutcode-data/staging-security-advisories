advisory_id: GHSA-x3px-2p95-f6jr
datasource_id: github_osv_importer_v2/GHSA-x3px-2p95-f6jr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-x3px-2p95-f6jr/GHSA-x3px-2p95-f6jr.json
aliases:
  - CVE-2022-31075
summary: |
  KubeEdge DoS when signing the CSR from EdgeCore
  ### Impact
  EdgeCore may be susceptible to a DoS attack on CloudHub if an attacker was to send a well-crafted HTTP request to `/edge.crt`.
  If an attacker can send a well-crafted HTTP request to CloudHub, and that request has a very large body, that request could crash the HTTP service through a memory exhaustion vector. The request body is being read into memory, and a body that was larger than the available memory could lead to a successful attack.
  Because the request would have to make it through authorization, only authorized users could perform this attack. The consequence of the exhaustion is that CloudHub will be in denial of service. It will be affected only when users enable the CloudHub module in the file `cloudcore.yaml` as below:
  ```
  modules:
    ...
    cloudHub:
      enable: true
  ```

  ### Patches
  This bug has been fixed in Kubeedge 1.11.1, 1.10.2, 1.9.4. Users should update to these versions to resolve the issue.

  ### Workarounds
  Disable the CloudHub module in the config file `cloudcore.yaml`.

  ### References
  NA

  ### Credits
  Thanks David Korczynski and Adam Korczynski of ADA Logics for responsibly disclosing this issue in accordance with the [kubeedge security policy](https://github.com/kubeedge/kubeedge/security/policy) during a security audit sponsored by CNCF and facilitated by OSTIF.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [KubeEdge repo](https://github.com/kubeedge/kubeedge/issues/new/choose)
  * To make a vulnerability report, email your vulnerability to the private [cncf-kubeedge-security@lists.cncf.io](mailto:cncf-kubeedge-security@lists.cncf.io) list with the security details and the details expected for [KubeEdge bug reports](https://github.com/kubeedge/kubeedge/blob/master/.github/ISSUE_TEMPLATE/bug-report.md).
impacted_packages: []
severities:
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-x3px-2p95-f6jr/GHSA-x3px-2p95-f6jr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
  - CWE-400
references:
  - url: github.com/kubeedge/kubeedge
    reference_type:
    reference_id:
  - url: https://github.com/kubeedge/kubeedge/security/advisories/GHSA-x3px-2p95-f6jr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31075
    reference_type:
    reference_id: CVE-2022-31075
