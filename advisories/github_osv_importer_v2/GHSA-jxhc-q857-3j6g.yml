advisory_id: GHSA-jxhc-q857-3j6g
datasource_id: github_osv_importer_v2/GHSA-jxhc-q857-3j6g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/07/GHSA-jxhc-q857-3j6g/GHSA-jxhc-q857-3j6g.json
aliases:
  - CVE-2021-32740
summary: |
  Regular Expression Denial of Service in Addressable templates
  ### Impact

  Within the URI template implementation in Addressable, a maliciously crafted template may result in uncontrolled resource consumption, leading to denial of service when matched against a URI. In typical usage, templates would not normally be read from untrusted user input, but nonetheless, no previous security advisory for Addressable has cautioned against doing this. Users of the parsing capabilities in Addressable but not the URI template capabilities are unaffected.

  ### Patches

  The vulnerability was introduced in version 2.3.0 (previously yanked) and has been present in all subsequent versions up to, and including, 2.7.0. It is fixed in version 2.8.0.

  ### Workarounds

  The vulnerability can be avoided by only creating Template objects from trusted sources that have been validated not to produce catastrophic backtracking.

  ### References

  - https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS
  - https://cwe.mitre.org/data/definitions/1333.html
  - https://www.regular-expressions.info/catastrophic.html

  ### For more information
  If you have any questions or comments about this advisory:
  * [Open an issue](https://github.com/sporkmonger/addressable/issues)
impacted_packages:
  - purl: pkg:gem/addressable
    affected_versions: vers:gem/<=2.7.0
    fixed_versions: vers:gem/2.8.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/07/GHSA-jxhc-q857-3j6g/GHSA-jxhc-q857-3j6g.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/advisories/GHSA-jxhc-q857-3j6g
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/addressable/CVE-2021-32740.yml
    reference_type:
    reference_id:
  - url: https://github.com/sporkmonger/addressable
    reference_type:
    reference_id:
  - url: https://github.com/sporkmonger/addressable/commit/0d8a3127e35886ce9284810a7f2438bff6b43cbc
    reference_type:
    reference_id:
  - url: https://github.com/sporkmonger/addressable/commit/89c76130ce255c601f642a018cb5fb5a80e679a7
    reference_type:
    reference_id:
  - url: https://github.com/sporkmonger/addressable/commit/92685096b1f7235ed8986c03ce30a24972eed848#diff-fb36d3dc67e6565ffde17e666a98697f48e76dac38fabf1bb9e97cdf3b583d76
    reference_type:
    reference_id:
  - url: https://github.com/sporkmonger/addressable/security/advisories/GHSA-jxhc-q857-3j6g
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SDFQM2NHNAZ3NNUQZEJTYECYZYXV4UDS
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WYPVOOQU7UB277UUERJMCNQLRCXRCIQ5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32740
    reference_type:
    reference_id: CVE-2021-32740
