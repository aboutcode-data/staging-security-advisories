advisory_id: GHSA-wvjv-p5rr-mmqm
datasource_id: github_osv_importer_v2/GHSA-wvjv-p5rr-mmqm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-wvjv-p5rr-mmqm/GHSA-wvjv-p5rr-mmqm.json
aliases:
  - CVE-2014-5245
summary: |
  Symfony allows direct access of ESI URLs behind a trusted proxy
  All 2.2.X, 2.3.X, 2.4.X, and 2.5.X versions of the Symfony HttpKernel component are affected by this security issue. Your application is vulnerable only if the ESI feature is enabled and there is a proxy in front of the web application.

  This issue has been fixed in Symfony 2.3.19, 2.4.9, and 2.5.4. Note that no fixes are provided for Symfony 2.2 as it is not maintained anymore.

  Description
  When you enable the ESI feature and when you are using a proxy like Varnish that you configured as a trusted proxy, the `FragmentHandler` considered requests to render fragments as coming from a trusted source, even if the client was requesting them directly. Symfony can not distinguish between ESI requests done on behalf of the client by Varnish and faked fragment requests coming directly from the client.

  To mitigate this issue, and for not-supported Symfony versions, you can use the following workaround in your Varnish configuration (`/_fragment` being the URL path prefix configured under the `fragment` setting of the framework bundle configuration):

   Copy
  sub vcl_recv {
      if (req.restarts == 0 && req.url ~ "^/_fragment") {
          error 400;
      }
  }
  Resolution
  We do not rely on trusted IPs anymore when validating a fragment request as all fragment URLs are now signed.

  The patch for this issue is available here: https://github.com/symfony/symfony/pull/11831
impacted_packages:
  - purl: pkg:composer/symfony/http-kernel
    affected_versions: vers:composer/>=2.0.0|<2.3.19
    fixed_versions: vers:composer/2.3.19
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/http-kernel
    affected_versions: vers:composer/>=2.4.0|<2.4.9
    fixed_versions: vers:composer/2.4.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/http-kernel
    affected_versions: vers:composer/>=2.5.0|<2.5.4
    fixed_versions: vers:composer/2.5.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=2.0.0|<2.3.19
    fixed_versions: vers:composer/2.3.19
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=2.4.0|<2.4.9
    fixed_versions: vers:composer/2.4.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/symfony/symfony
    affected_versions: vers:composer/>=2.5.0|<2.5.4
    fixed_versions: vers:composer/2.5.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-wvjv-p5rr-mmqm/GHSA-wvjv-p5rr-mmqm.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/http-kernel/CVE-2014-5245.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2014-5245.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/654b1f281e09dd96ffbbd3da815411700423ecf5
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/pull/11831
    reference_type:
    reference_id:
  - url: https://symfony.com/cve-2014-5245
    reference_type:
    reference_id:
