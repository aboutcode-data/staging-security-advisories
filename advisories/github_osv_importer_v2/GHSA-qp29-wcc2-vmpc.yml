advisory_id: GHSA-qp29-wcc2-vmpc
datasource_id: github_osv_importer_v2/GHSA-qp29-wcc2-vmpc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-qp29-wcc2-vmpc/GHSA-qp29-wcc2-vmpc.json
aliases: []
summary: |
  Silverstripe HtmlEditor embed url sanitisation
  "Add from URL" doesn't clearly sanitise URL server side

  HtmlEditorField_Toolbar has an action HtmlEditorField_Toolbar#viewfile, which gets called by the CMS when adding a media "from a URL" (i.e. via oembed).

  This action gets the URL to add in the GET parameter FileURL. However it doesn't do any URL sanitising server side. The current logic will pass this through to Oembed, which will probably reject most dangerous URLs, but it's possible future changes would break this.
impacted_packages:
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/>=3.0.0|<3.2.1
    fixed_versions: vers:composer/3.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-qp29-wcc2-vmpc/GHSA-qp29-wcc2-vmpc.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2015-027-1.yaml
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework
    reference_type:
    reference_id:
  - url: https://www.silverstripe.org/download/security-releases/ss-2015-027
    reference_type:
    reference_id:
