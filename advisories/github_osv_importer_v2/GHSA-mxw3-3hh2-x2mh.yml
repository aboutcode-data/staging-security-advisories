advisory_id: GHSA-mxw3-3hh2-x2mh
datasource_id: github_osv_importer_v2/GHSA-mxw3-3hh2-x2mh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-mxw3-3hh2-x2mh/GHSA-mxw3-3hh2-x2mh.json
aliases:
  - CVE-2026-22860
summary: "Rack has a Directory Traversal via Rack:Directory\n## Summary\n\n`Rack::Directory`â€™s\
  \ path check used a string prefix match on the expanded path. A request like `/../root_example/`\
  \ can escape the configured root if the target path starts with the root string, allowing\
  \ directory listing outside the intended root.\n\n## Details\n\nIn `directory.rb`, `File.expand_path(File.join(root,\
  \ path_info)).start_with?(root)` does not enforce a path boundary. If the server root is `/var/www/root`,\
  \ a path like `/var/www/root_backup` passes the check because it shares the same prefix, so\
  \ `Rack::Directory` will list that directory also. \n\n## Impact\n\nInformation disclosure\
  \ via directory listing outside the configured root when `Rack::Directory` is exposed to untrusted\
  \ clients and a directory shares the root prefix (e.g., `public2`, `www_backup`).\n\n## Mitigation\n\
  \n* Update to a patched version of Rack that correctly checks the root prefix.\n* Don't name\
  \ directories with the same prefix as one which is exposed via `Rack::Directory`."
impacted_packages:
  - purl: pkg:gem/rack
    affected_versions: vers:gem/<2.2.22
    fixed_versions: vers:gem/2.2.22
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions: vers:gem/>=3.0.0.beta1|<3.1.20
    fixed_versions: vers:gem/3.1.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions: vers:gem/>=3.2.0|<3.2.5
    fixed_versions: vers:gem/3.2.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-mxw3-3hh2-x2mh/GHSA-mxw3-3hh2-x2mh.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-548
  - CWE-22
references:
  - url: https://github.com/rack/rack
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/75c5745c286637a8f049a33790c71237762069e7
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/security/advisories/GHSA-mxw3-3hh2-x2mh
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2026-22860.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22860
    reference_type:
    reference_id:
