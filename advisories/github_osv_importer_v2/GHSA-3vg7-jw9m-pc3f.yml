advisory_id: GHSA-3vg7-jw9m-pc3f
datasource_id: github_osv_importer_v2/GHSA-3vg7-jw9m-pc3f
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-3vg7-jw9m-pc3f/GHSA-3vg7-jw9m-pc3f.json
aliases:
  - CVE-2021-21357
summary: |
  Broken Access Control in Form Framework
  ### Problem
  Due to improper input validation, attackers can by-pass restrictions of predefined options and submit arbitrary data in the Form Designer backend module of the Form Framework.

  In the default configuration of the Form Framework this allows attackers to explicitly allow arbitrary mime-types for file uploads - however, default _fileDenyPattern_ successfully blocked files like _.htaccess_ or _malicious.php_. Besides that, attackers can persist those files in any writable directory of the corresponding TYPO3 installation.

  A valid backend user account with access to the form module is needed to exploit this vulnerability.

  ### Solution
  Update to TYPO3 versions 8.7.40, 9.5.25, 10.4.14, 11.1.1 that fix the problem described.

  ### Credits
  Thanks to Richie Lee who reported this issue and to TYPO3 contributor Ralf Zimmermann who fixed the issue.

  ### References
  * [TYPO3-CORE-SA-2021-003](https://typo3.org/security/advisory/typo3-core-sa-2021-003)
impacted_packages:
  - purl: pkg:composer/typo3/cms-form
    affected_versions: vers:composer/<=8.7.39
    fixed_versions: vers:composer/8.7.40
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms-form
    affected_versions: vers:composer/<=9.5.24
    fixed_versions: vers:composer/9.5.25
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms-form
    affected_versions: vers:composer/<=10.4.13
    fixed_versions: vers:composer/10.4.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms-form
    affected_versions: vers:composer/<=11.1.0
    fixed_versions: vers:composer/11.1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/>=10.0.0|<10.4.14
    fixed_versions: vers:composer/10.4.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/>=11.0.0|<11.1.1
    fixed_versions: vers:composer/11.1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/>=9.0.0|<9.5.25
    fixed_versions: vers:composer/9.5.25
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms
    affected_versions: vers:composer/>=10.0.0|<10.4.14
    fixed_versions: vers:composer/10.4.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms
    affected_versions: vers:composer/>=11.0.0|<11.1.1
    fixed_versions: vers:composer/11.1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/typo3/cms
    affected_versions: vers:composer/>=9.0.0|<9.5.25
    fixed_versions: vers:composer/9.5.25
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:H/E:H/RL:O/RC:C
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/03/GHSA-3vg7-jw9m-pc3f/GHSA-3vg7-jw9m-pc3f.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-434
  - CWE-22
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms-core/CVE-2021-21357.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms/CVE-2021-21357.yaml
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/TYPO3.CMS/security/advisories/GHSA-3vg7-jw9m-pc3f
    reference_type:
    reference_id:
  - url: https://packagist.org/packages/typo3/cms-form
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2021-003
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21357
    reference_type:
    reference_id: CVE-2021-21357
