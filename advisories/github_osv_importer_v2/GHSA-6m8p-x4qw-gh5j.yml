advisory_id: GHSA-6m8p-x4qw-gh5j
datasource_id: github_osv_importer_v2/GHSA-6m8p-x4qw-gh5j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-6m8p-x4qw-gh5j/GHSA-6m8p-x4qw-gh5j.json
aliases:
  - CVE-2020-12690
summary: |
  Insufficient Session Expiration in OpenStack Keystone
  An issue was discovered in OpenStack Keystone before 15.0.1, and 16.0.0. The list of roles provided for an OAuth1 access token is silently ignored. Thus, when an access token is used to request a keystone token, the keystone token contains every role assignment the creator had for the project. This results in the provided keystone token having more role assignments than the creator intended, possibly giving unintended escalated access.
impacted_packages:
  - purl: pkg:pypi/keystone
    affected_versions: vers:pypi/<15.0.1
    fixed_versions: vers:pypi/15.0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/keystone
    affected_versions: vers:pypi/>=16.0.0.0rc1|<16.0.0
    fixed_versions: vers:pypi/16.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-6m8p-x4qw-gh5j/GHSA-6m8p-x4qw-gh5j.json
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-6m8p-x4qw-gh5j/GHSA-6m8p-x4qw-gh5j.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-613
references:
  - url: https://bugs.launchpad.net/keystone/+bug/1873290
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-6m8p-x4qw-gh5j
    reference_type:
    reference_id:
  - url: https://github.com/openstack/keystone
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/keystone/PYSEC-2020-54.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/re4ffc55cd2f1b55a26e07c83b3c22c3fe4bae6054d000a57fb48d8c2@%3Ccommits.druid.apache.org%3E
    reference_type:
    reference_id:
  - url: https://security.openstack.org/ossa/OSSA-2020-005.html
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4480-1
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2020/05/06/6
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2020/05/07/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-12690
    reference_type:
    reference_id: CVE-2020-12690
