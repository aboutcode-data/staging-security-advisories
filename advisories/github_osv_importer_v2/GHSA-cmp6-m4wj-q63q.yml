advisory_id: GHSA-cmp6-m4wj-q63q
datasource_id: github_osv_importer_v2/GHSA-cmp6-m4wj-q63q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-cmp6-m4wj-q63q/GHSA-cmp6-m4wj-q63q.json
aliases:
  - CVE-2025-66566
summary: |
  yawkat LZ4 Java has a possible information leak in Java safe decompressor
  ### Summary

  Insufficient clearing of the output buffer in Java-based decompressor implementations in lz4-java 1.10.0 and earlier allows remote attackers to read previous buffer contents via crafted compressed input. In applications where the output buffer is reused without being cleared, this may lead to disclosure of sensitive data.

  JNI-based implementations are *not* affected.

  ### Details

  During the decompression process, the lz4 algorithm may have to repeat data that was previously decompressed in the same input frame. In the Java implementation, this is implemented by copy operations within the output buffer.

  With a crafted input, an attacker may induce the Java implementation to copy from a region in the output buffer that does not contain decompressed data yet. If that region contains sensitive information because the output buffer was not cleared prior to decompression, that data will then be copied to the decompressed output.

  - `LZ4Factory.nativeInstance().safeDecompressor()` *is not* affected.
  - `LZ4Factory.nativeInstance().fastDecompressor()` *is* affected because it actually uses `safeInstance()` since 1.8.1. In 1.8.0 and earlier versions, this implementation is instead vulnerable to the more severe [CVE‐2025‐12183](https://sites.google.com/sonatype.com/vulnerabilities/cve-2025-12183), so downgrading is not a solution.
  - Both decompressors of `LZ4Factory.safeInstance()`, `LZ4Factory.unsafeInstance()` and `LZ4Factory.fastestJavaInstance()` are affected.
  - `LZ4Factory.fastestInstance()` uses the `nativeInstance` or `fastestJavaInstance` depending on platform. `LZ4Factory.fastestInstance().fastDecompressor()` is always affected, while `LZ4Factory.fastestInstance().safeDecompressor()` is affected only when JNI cannot be used (e.g. on unsupported platforms).

  Independent of this vulnerability, it is recommended that users migrate from `fastDecompressor` to `safeDecompressor`, as the latter is more performant (despite the name).

  The impact of this vulnerability depends on how user code interacts with the decompression API. Users that allocate a new destination buffer each time, or use only zeroed buffers, are not impacted. When the buffer is reused, however, the confidentiality impact can be severe. This vulnerability is marked as VC:H out of caution.

  ### Mitigation

  lz4-java 1.10.1 fixes this issue without requiring changes in user code.

  If you cannot upgrade to 1.10.1, you can mitigate this vulnerability by zeroing the output buffer before passing it to the decompression function.

  ### Relation to CVE‐2025‐12183

  This CVE is a different attack than [CVE‐2025‐12183](https://sites.google.com/sonatype.com/vulnerabilities/cve-2025-12183), affecting different implementations with different impact. This new vulnerability was discovered by [CodeIntelligence](https://www.code-intelligence.com/) during research that followed up on CVE‐2025‐12183. Users are recommended to upgrade to 1.10.1 to fix both vulnerabilities.
impacted_packages:
  - purl: pkg:maven/at.yawk.lz4/lz4-java
    affected_versions: vers:maven/<=1.10.0
    fixed_versions: vers:maven/1.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.lz4/lz4-java
    affected_versions: vers:maven/<=1.8.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.lz4/lz4-pure-java
    affected_versions: vers:maven/<=1.8.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/net.jpountz.lz4/lz4
    affected_versions: vers:maven/<=1.8.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-cmp6-m4wj-q63q/GHSA-cmp6-m4wj-q63q.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-201
references:
  - url: https://github.com/yawkat/lz4-java
    reference_type:
    reference_id:
  - url: https://github.com/yawkat/lz4-java/commit/33d180cb70c4d93c80fb0dc3ab3002f457e93840
    reference_type:
    reference_id:
  - url: https://github.com/yawkat/lz4-java/security/advisories/GHSA-cmp6-m4wj-q63q
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66566
    reference_type:
    reference_id:
