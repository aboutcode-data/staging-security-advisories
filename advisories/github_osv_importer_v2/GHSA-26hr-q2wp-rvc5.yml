advisory_id: GHSA-26hr-q2wp-rvc5
datasource_id: github_osv_importer_v2/GHSA-26hr-q2wp-rvc5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-26hr-q2wp-rvc5/GHSA-26hr-q2wp-rvc5.json
aliases: []
summary: |
  User with permission to write actions can impersonate another user when auth token is configured in environment variable
  ### Impact

  When lakeFS is configured with **ALL** of the following:

  - Configuration option `auth.encrypt.secret_key` passed through environment variable
  - Actions enabled via configuration option `actions.enabled` (default enabled)

  then a user who can configure an action can impersonate any other user.

  ### Patches
  _Has the problem been patched? What versions should users upgrade to?_

  ### Workarounds

  **ANY ONE** of these is sufficient to prevent the issue:

  * Do not pass `auth.encrypt.secret_key` through an environment variable.

     For instance, Kubernetes users can generate the entire configuration as a secret and mount that.  This is described [here](https://kubernetes.io/docs/concepts/configuration/secret/#using-a-secret).
  * Disable actions.
  * Limit users allowed to configure actions.
impacted_packages: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/12/GHSA-26hr-q2wp-rvc5/GHSA-26hr-q2wp-rvc5.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/treeverse/lakeFS
    reference_type:
    reference_id:
  - url: https://github.com/treeverse/lakeFS/security/advisories/GHSA-26hr-q2wp-rvc5
    reference_type:
    reference_id:
