advisory_id: GHSA-79hx-3fp8-hj66
datasource_id: github_osv_importer_v2/GHSA-79hx-3fp8-hj66
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-79hx-3fp8-hj66/GHSA-79hx-3fp8-hj66.json
aliases:
  - CVE-2025-59352
summary: |
  DragonFly vulnerable to arbitrary file read and write on a peer machine
  ### Impact
  A peer exposes the gRPC API and HTTP API for consumption by other peers. These APIs allow peers to send requests that force the recipient peer to create files in arbitrary file system locations, and to read arbitrary files. This allows peers to steal other peers’ secret data and to gain remote code execution (RCE) capabilities on the peer’s machine.

  ```golang
  file, err := os.OpenFile(t.DataFilePath, os.O_RDWR, defaultFileMode)
  if err != nil {
         return 0, err
  }
  defer file.Close()
  if _, err = file.Seek(req.Range.Start, io.SeekStart); err != nil {
         return 0, err
  }
  n, err := io.Copy(file, io.LimitReader(req.Reader, req.Range.Length))
  ```

  ### Patches

  - Dragonfy v2.1.0 and above.

  ### Workarounds

  There are no effective workarounds, beyond upgrading.

  ### References

  A third party security audit was performed by Trail of Bits, you can see the [full report](https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf).

  If you have any questions or comments about this advisory, please email us at [dragonfly-maintainers@googlegroups.com](mailto:dragonfly-maintainers@googlegroups.com).
impacted_packages: []
severities:
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-79hx-3fp8-hj66/GHSA-79hx-3fp8-hj66.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-202
  - CWE-22
references:
  - url: https://github.com/dragonflyoss/dragonfly
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-79hx-3fp8-hj66
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59352
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3961
    reference_type:
    reference_id:
