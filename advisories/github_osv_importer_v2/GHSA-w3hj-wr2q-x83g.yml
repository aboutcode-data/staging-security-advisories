advisory_id: GHSA-w3hj-wr2q-x83g
datasource_id: github_osv_importer_v2/GHSA-w3hj-wr2q-x83g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/04/GHSA-w3hj-wr2q-x83g/GHSA-w3hj-wr2q-x83g.json
aliases:
  - CVE-2024-23688
summary: |
  Discovery uses the same AES/GCM Nonce throughout the session though it should be generated on per message basis which can lead to the leaking of the session key.  As the actual ENR record is signed with a different key it is not possible for an attacker to alter the ENR record. Note that the node private key is not compromised, only the session key generated to communicate with an individual peer.

  From [discovery spec](https://github.com/ethereum/devp2p/blob/f97b8a5b8e9589d3355ebbd9d4a58d5d1644bdf7/discv5/discv5-theory.md#session-cache):
  > The number of messages which can be encrypted with a certain session key is limited because encryption of each message requires a unique nonce for AES-GCM. In addition to the keys, the session cache must also keep track of the count of outgoing messages to ensure the uniqueness of nonce values. Since the wire protocol uses 96 bit AES-GCM nonces, it is strongly recommended to generate them by encoding the current outgoing message count into the first 32 bits of the nonce and filling the remaining 64 bits with random data generated by a cryptographically secure random number generator.
impacted_packages:
  - purl: pkg:maven/tech.pegasys.discovery/discovery
    affected_versions: vers:maven/<0.4.5
    fixed_versions: vers:maven/0.4.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-330
  - CWE-323
references:
  - url: https://github.com/ConsenSys/discovery
    reference_type:
    reference_id:
  - url: https://github.com/ConsenSys/discovery/security/advisories/GHSA-w3hj-wr2q-x83g
    reference_type:
    reference_id:
  - url: https://vulncheck.com/advisories/vc-advisory-GHSA-w3hj-wr2q-x83g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23688
    reference_type:
    reference_id: CVE-2024-23688
