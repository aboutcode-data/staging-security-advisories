advisory_id: GHSA-r8p8-qw9w-j9qv
datasource_id: github_osv_importer_v2/GHSA-r8p8-qw9w-j9qv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-r8p8-qw9w-j9qv/GHSA-r8p8-qw9w-j9qv.json
aliases:
  - CVE-2026-2415
summary: |
  pretix unsafely evaluates variables in emails
  Emails sent by pretix can utilize placeholders that will be filled with customer data. For example, when `{name}` is used in an email template, it will  be replaced with the buyer's name for the final email. This mechanism contained two security-relevant bugs:

   -  It was possible to exfiltrate information about the pretix system through specially crafted placeholder names such as `{event.__init__.__code__.co_filename}}`. This way, an attacker with the ability to control email templates (usually every user of the pretix backend) could retrieve sensitive information from the system configuration, including even database passwords or API keys. pretix does include mechanisms to prevent the usage of such malicious placeholders, however due to a mistake in the code, they were not fully effective for the email subject.

   -  Placeholders in subjects and plain text bodies of emails were wrongfully evaluated twice. Therefore, if the first evaluation of a placeholder again contains a placeholder, this second placeholder was rendered. This allows the rendering of placeholders controlled by the ticket buyer, and therefore the exploitation of the first issue as a ticket buyer. Luckily, the only buyer-controlled placeholder available in pretix by default (that is not validated in a way that prevents the issue) is `{invoice_company}`, which is very unusual (but not impossible) to be contained in an email subject template. In addition to broadening the attack surface of the first issue, this could theoretically also leak information about an order to one of the attendees within that order. However, we also consider this scenario very unlikely under typical conditions.

  Out of caution, pretix recommend that you rotate all passwords and API keys contained in your pretix.cfg https://docs.pretix.eu/self-hosting/config/ Â file.
impacted_packages:
  - purl: pkg:pypi/pretix
    affected_versions: vers:pypi/>=2026.1.0|<2026.1.1
    fixed_versions: vers:pypi/2026.1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/pretix
    affected_versions: vers:pypi/>=2025.10.0|<2025.10.2
    fixed_versions: vers:pypi/2025.10.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/pretix
    affected_versions: vers:pypi/<2025.9.4
    fixed_versions: vers:pypi/2025.9.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/E:P/RE:L/U:Red
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-r8p8-qw9w-j9qv/GHSA-r8p8-qw9w-j9qv.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-627
references:
  - url: https://github.com/pretix/pretix
    reference_type:
    reference_id:
  - url: https://github.com/pretix/pretix/commit/ba11d24f8dfa4e9d8f03493e56fd8b43983fe297
    reference_type:
    reference_id:
  - url: https://github.com/pretix/pretix/commit/c85afbc621b5f0b1afa618627c45f89323eb0154
    reference_type:
    reference_id:
  - url: https://github.com/pretix/pretix/commit/edac35ed4c5466eb63a202575c337d117ddf1c8e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-2415
    reference_type:
    reference_id:
  - url: https://pretix.eu/about/en/blog/20260216-release-2026-1-1
    reference_type:
    reference_id:
