advisory_id: GHSA-xg9w-vg3g-6m68
datasource_id: github_osv_importer_v2/GHSA-xg9w-vg3g-6m68
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-xg9w-vg3g-6m68/GHSA-xg9w-vg3g-6m68.json
aliases:
  - CVE-2026-22871
summary: "GuardDog Path Traversal Vulnerability Leads to Arbitrary File Overwrite and RCE\n\
  ## Summary\n\nA **path traversal vulnerability** exists in GuardDog's `safe_extract()` function\
  \ that allows malicious PyPI packages to write arbitrary files outside the intended extraction\
  \ directory, leading to **Arbitrary File Overwrite** and **Remote Code Execution** on systems\
  \ running GuardDog.\n\n**CWE:** CWE-22 (Improper Limitation of a Pathname to a Restricted\
  \ Directory)\n\n## Details\n\n### Vulnerable Code\n\n**File:** `guarddog/utils/archives.py`\n\
  \n```python\nelif zipfile.is_zipfile(source_archive):\n    with zipfile.ZipFile(source_archive,\
  \ \"r\") as zip:\n        for file in zip.namelist():\n            # Note: zip.extract cleans\
  \ up any malicious file name\n            # such as directory traversal attempts This is not\
  \ the\n            # case of zipfile.extractall\n            zip.extract(file, path=os.path.join(target_directory,\
  \ file))  # ❌ VULNERABLE\n```\n\n### Root Cause\n\nThe comment about `zip.extract()` fooled\
  \ me at first :) then I noticed the `os.path.join()` call. \nThe vulnerability stems from\
  \ **incorrect usage of Python's `zipfile.ZipFile.extract()` API**:\n\n- The `path` parameter\
  \ should be the **target directory**, not a full file path\n- `extract()` automatically appends\
  \ the member name to the path\n- By passing `os.path.join(target_directory, file)`, GuardDog\
  \ causes the filename to be appended **twice**\n- This breaks zipfile's built-in path traversal\
  \ sanitization\n\n### Attack Vector\n\n1. Attacker creates malicious wheel with path traversal\
  \ filenames\n2. Uploads to PyPI or distributes directly\n3. Package scan: `guarddog pypi scan\
  \ malicious-pkg`\n4. GuardDog downloads and extracts the package\n5. Malicious files written\
  \ to arbitrary locations\n6. Code execution could be achieved\n\n## Impact\n\nImpact depends\
  \ on how GuardDog is running and under which environment.\n\n### Critical Scenarios\n\n1.\
  \ **Immediate Code Execution**\n   - Write to `~/.bashrc` → executes on next shell\n   - Write\
  \ to `~/.profile` → executes on login\n\n2. **Persistent Backdoors**\n   - Write to `~/.ssh/authorized_keys`\
  \ → SSH access\n   - Write to `/etc/cron.d/malicious` → scheduled execution (if root)\n  \
  \ - Write to systemd user services → persistent execution\n\nand more...\n\n## Credits\n\n\
  **Reported by:** Charbel (dwbruijn)"
impacted_packages:
  - purl: pkg:pypi/guarddog
    affected_versions: vers:pypi/<2.7.1
    fixed_versions: vers:pypi/2.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-xg9w-vg3g-6m68/GHSA-xg9w-vg3g-6m68.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/DataDog/guarddog
    reference_type:
    reference_id:
  - url: https://github.com/DataDog/guarddog/commit/9aa6a725b2c71d537d3c18d1c15621395ebb879c
    reference_type:
    reference_id:
  - url: https://github.com/DataDog/guarddog/security/advisories/GHSA-xg9w-vg3g-6m68
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22871
    reference_type:
    reference_id:
