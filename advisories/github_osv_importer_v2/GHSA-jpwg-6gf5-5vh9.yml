advisory_id: GHSA-jpwg-6gf5-5vh9
datasource_id: github_osv_importer_v2/GHSA-jpwg-6gf5-5vh9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-jpwg-6gf5-5vh9/GHSA-jpwg-6gf5-5vh9.json
aliases:
  - CVE-2021-29942
summary: |
  Out of bounds write in reorder
  swap_index takes an iterator and swaps the items with their corresponding indexes. It reserves capacity and sets the length of the vector based on the .len() method of the iterator.

  If the len() returned by the iterator is larger than the actual number of elements yielded, then swap_index creates a vector containing uninitialized members. If the len() returned by the iterator is smaller than the actual number of members yielded, then swap_index can write out of bounds past its allocated vector.

  As noted by the Rust documentation, len() and size_hint() are primarily meant for optimization and incorrect values from their implementations should not lead to memory safety violations.
impacted_packages: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-jpwg-6gf5-5vh9/GHSA-jpwg-6gf5-5vh9.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-787
references:
  - url: https://github.com/tiby312/reorder
    reference_type:
    reference_id:
  - url: https://github.com/tiby312/reorder/issues/1
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0050.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29942
    reference_type:
    reference_id: CVE-2021-29942
