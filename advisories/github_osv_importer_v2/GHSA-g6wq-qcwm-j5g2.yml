advisory_id: GHSA-g6wq-qcwm-j5g2
datasource_id: github_osv_importer_v2/GHSA-g6wq-qcwm-j5g2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/06/GHSA-g6wq-qcwm-j5g2/GHSA-g6wq-qcwm-j5g2.json
aliases:
  - CVE-2020-7663
summary: |
  Regular Expression Denial of Service in websocket-extensions (RubyGem)
  ### Impact

  The ReDoS flaw allows an attacker to exhaust the server's capacity to process incoming requests by sending a WebSocket handshake request containing a header of the following form:

      Sec-WebSocket-Extensions: a; b="\c\c\c\c\c\c\c\c\c\c ...

  That is, a header containing an unclosed string parameter value whose content is a repeating two-byte sequence of a backslash and some other character. The parser takes exponential time to reject this header as invalid, and this will block the processing of any other work on the same thread. Thus if you are running a single-threaded server, such a request can render your service completely unavailable.

  ### Patches

  Users should upgrade to version 0.1.5.

  ### Workarounds

  There are no known work-arounds other than disabling any public-facing WebSocket functionality you are operating.

  ### References

  - https://blog.jcoglan.com/2020/06/02/redos-vulnerability-in-websocket-extensions/
impacted_packages:
  - purl: pkg:gem/websocket-extensions
    affected_versions: vers:gem/<0.1.5
    fixed_versions: vers:gem/0.1.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/06/GHSA-g6wq-qcwm-j5g2/GHSA-g6wq-qcwm-j5g2.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://blog.jcoglan.com/2020/06/02/redos-vulnerability-in-websocket-extensions
    reference_type:
    reference_id:
  - url: https://github.com/faye/websocket-extensions-ruby
    reference_type:
    reference_id:
  - url: https://github.com/faye/websocket-extensions-ruby/commit/aa156a439da681361ed6f53f1a8131892418838b
    reference_type:
    reference_id:
  - url: https://github.com/faye/websocket-extensions-ruby/security/advisories/GHSA-g6wq-qcwm-j5g2
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/websocket-extensions/CVE-2020-7663.yml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2020/08/msg00031.html
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-RUBY-WEBSOCKETEXTENSIONS-570830
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4502-1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-7663
    reference_type:
    reference_id: CVE-2020-7663
