advisory_id: GHSA-8hv7-4vfc-w8pg
datasource_id: github_osv_importer_v2/GHSA-8hv7-4vfc-w8pg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-8hv7-4vfc-w8pg/GHSA-8hv7-4vfc-w8pg.json
aliases:
  - CVE-2022-34778
summary: |
  Cross-site Scripting in Jenkins TestNG Results Plugin
  TestNG Results Plugin has options in its post-build step configuration to not escape test descriptions and exception messages. If those options are unchecked, TestNG Results Plugin 554.va4a552116332 and earlier renders the unescaped text provided in test results. This results in a cross-site scripting (XSS) vulnerability exploitable by attackers able to configure jobs or control test results. TestNG Results Plugin 555.va0d5f66521e3 by default ignores the user-level options to not escape content. Administrators who want to restore this functionality must set the [Java system property](https://www.jenkins.io/doc/book/managing/system-properties/) `hudson.plugins.testng.Publisher.allowUnescapedHTML` to true.
impacted_packages:
  - purl: pkg:maven/org.jenkins-ci.plugins/testng-plugin
    affected_versions: vers:maven/<=554.va4a552116332
    fixed_versions: vers:maven/555.va0d5f66521e3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/07/GHSA-8hv7-4vfc-w8pg/GHSA-8hv7-4vfc-w8pg.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/jenkinsci/testng-plugin-plugin
    reference_type:
    reference_id:
  - url: https://github.com/jenkinsci/testng-plugin-plugin/commit/a0d5f66521e3bc470047a0b683004ce8889d3369
    reference_type:
    reference_id:
  - url: https://www.jenkins.io/security/advisory/2022-06-30/#SECURITY-2788
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-34778
    reference_type:
    reference_id: CVE-2022-34778
