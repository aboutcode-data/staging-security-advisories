advisory_id: GHSA-jg74-mwgw-v6x3
datasource_id: github_osv_importer_v2/GHSA-jg74-mwgw-v6x3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-jg74-mwgw-v6x3/GHSA-jg74-mwgw-v6x3.json
aliases:
  - CVE-2024-7594
summary: |
  Vault SSH Secrets Engine Configuration Did Not Restrict Valid Principals By Default
  Vault’s SSH secrets engine did not require the valid_principals list to contain a value by default. If the valid_principals and default_user fields of the SSH secrets engine configuration are not set, an SSH certificate requested by an authorized user to Vault’s SSH secrets engine could be used to authenticate as any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise 1.17.6, 1.16.10, and 1.15.15.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-jg74-mwgw-v6x3/GHSA-jg74-mwgw-v6x3.json
  - score: '7.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-jg74-mwgw-v6x3/GHSA-jg74-mwgw-v6x3.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-732
references:
  - url: https://discuss.hashicorp.com/t/hcsec-2024-20-vault-ssh-secrets-engine-configuration-did-not-restrict-valid-principals-by-default/70251
    reference_type:
    reference_id:
  - url: https://github.com/hashicorp/vault
    reference_type:
    reference_id:
  - url: https://github.com/openbao/openbao/commit/d5b4e922469830ac335b21dc0e8f9878c501a884
    reference_type:
    reference_id:
  - url: https://github.com/openbao/openbao/pull/561
    reference_type:
    reference_id:
  - url: https://openbao.org/docs/release-notes/2-0-0/#202
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3162
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20250110-0007
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-7594
    reference_type:
    reference_id: CVE-2024-7594
