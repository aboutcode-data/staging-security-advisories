advisory_id: GHSA-gv3v-92v6-m48j
datasource_id: github_osv_importer_v2/GHSA-gv3v-92v6-m48j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/04/GHSA-gv3v-92v6-m48j/GHSA-gv3v-92v6-m48j.json
aliases:
  - CVE-2020-7622
summary: |
  Improper Neutralization of CRLF Sequences in HTTP Headers in Jooby ('HTTP Response Splitting)
  ### Impact

   - Cross Site Scripting
   - Cache Poisoning
   - Page Hijacking

  ### Patches

  This was fixed in version `2.2.1`.

  ### Workarounds

  If you are unable to update, ensure that user supplied data isn't able to flow to HTTP headers. If it does, pre-sanitize for CRLF characters.

  ### References

  ##### [CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response Splitting')](https://cwe.mitre.org/data/definitions/113.html)

  I've been poking at libraries to see if they are vulnerable to HTTP Response Splitting and Jooby is my third case of finding this vulnerability.

  ### Root Cause

  This roots cause back to this line in the Jooby codebase:

  https://github.com/jooby-project/jooby/blob/93cfc80aa20c188f71a442ea7a1827da380e1c27/modules/jooby-netty/src/main/java/io/jooby/internal/netty/NettyContext.java#L102

  The `DefaultHttpHeaders` takes a parameter `validate` which, when `true` (as it is for the no-arg constructor) validates that the header isn't being abused to do HTTP Response Splitting.

  ### Reported By

  This vulnerability was reported by @JLLeitschuh ([Twitter](https://twitter.com/JLLeitschuh))

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [jooby-project/jooby](https://github.com/jooby-project/jooby/issues)
impacted_packages:
  - purl: pkg:maven/io.jooby/jooby-netty
    affected_versions: vers:maven/<2.2.1
    fixed_versions: vers:maven/2.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/04/GHSA-gv3v-92v6-m48j/GHSA-gv3v-92v6-m48j.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-444
references:
  - url: https://github.com/jooby-project/jooby/commit/b66e3342cf95205324023cfdf2cb5811e8a6dcf4
    reference_type:
    reference_id:
  - url: https://github.com/jooby-project/jooby/security/advisories/GHSA-gv3v-92v6-m48j
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JAVA-IOJOOBY-564249
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-7622
    reference_type:
    reference_id: CVE-2020-7622
