advisory_id: GHSA-qr93-8wwf-22g4
datasource_id: github_osv_importer_v2/GHSA-qr93-8wwf-22g4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-qr93-8wwf-22g4/GHSA-qr93-8wwf-22g4.json
aliases:
  - CVE-2025-54583
summary: |
  GitProxy Approval Bypass When Pushing Multiple Branches
  ### Summary
  This vulnerability allows a user to push to the remote repository while bypassing policies and explicit approval. Since checks and plugins are skipped, code containing secrets or unwanted changes could be pushed into a repository.

  Because it can allow policy violations to go undetected, we classify this as a High impact vulnerability.

  ### Details
  The source of the vulnerability is the push parser action `parsePush.ts`. It reads the first branch and parses it, while ignoring subsequent branches (silently letting them go through).

  Although the fix involves multiple improvements to the commit and push parsing logic, the core solution is to prevent multiple branch pushes from going through in the first place:

  ```ts
  if (refUpdates.length !== 1) {
    step.log('Invalid number of branch updates.');
    step.log(`Expected 1, but got ${refUpdates.length}`);
    step.setError('Your push has been blocked. Please make sure you are pushing to a single branch.');
    action.addStep(step);
    return action;
  }
  ```

  ### PoC

  1. Make a commit on a branch:

  ```bash
  git checkout -b safe-branch
  echo "Approved code" > file.txt
  git add .
  git commit -m "Approved code"
  git push proxy safe-branch
  ```

  2. Wait for approval of `safe-branch`.

  3. Make a commit on a separate branch with a secret, for example:

  ```bash
  git checkout -b bad-branch
  echo "SECRET=abc123" > .env
  git add .
  git commit -m "Bad code"
  ```

  4. Push both at the same time:

  `git push proxy safe-branch bad-branch`

  #### Expected Result
  Ideally, this would force checks to run for the second branch while sending it out for approval. Meanwhile, the first branch would be pushed to the remote. A simpler solution is to simply prevent multiple branch pushes.

  #### Actual Result
  Both branches get pushed to the remote, and second branch bypasses the proxy.

  ### Impact
  Attackers with push access can bypass review policies, potentially inserting unwanted/malicious code into a GitProxy-protected repository.

  The vulnerability impacts all users or organizations relying on GitProxy to enforce policies and prevent unapproved changes. It requires no elevated privileges beyond regular push access, and no extra user interaction. It does however, require a GitProxy administrator or designated user (`canUserApproveRejectPush`) to approve the first push. It is much more likely that a well-meaning user would trigger this accidentally.
impacted_packages:
  - purl: pkg:npm/%40finos/git-proxy
    affected_versions: vers:npm/<=1.19.1
    fixed_versions: vers:npm/1.19.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:H/VA:N/SC:N/SI:H/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-qr93-8wwf-22g4/GHSA-qr93-8wwf-22g4.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/finos/git-proxy
    reference_type:
    reference_id:
  - url: https://github.com/finos/git-proxy/commit/a620a2f33c39c78e01783a274580bf822af3cc3a
    reference_type:
    reference_id:
  - url: https://github.com/finos/git-proxy/commit/bd2ecb2099cba21bca3941ee4d655d2eb887b3a9
    reference_type:
    reference_id:
  - url: https://github.com/finos/git-proxy/releases/tag/v1.19.2
    reference_type:
    reference_id:
  - url: https://github.com/finos/git-proxy/security/advisories/GHSA-qr93-8wwf-22g4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54583
    reference_type:
    reference_id: CVE-2025-54583
