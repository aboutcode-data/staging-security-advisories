advisory_id: GHSA-w397-9p2j-6x23
datasource_id: github_osv_importer_v2/GHSA-w397-9p2j-6x23
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-w397-9p2j-6x23/GHSA-w397-9p2j-6x23.json
aliases:
  - CVE-2022-28977
summary: |
  Liferay Portal and Liferay DXP HtmlUtil.escapeRedirect Can Be Circumvented
  HtmlUtil.escapeRedirect in Liferay Portal 7.3.1 through 7.4.2, and Liferay DXP 7.0 fix pack 91 through 101, 7.1 fix pack 17 through 25, 7.2 fix pack 5 through 14, and 7.3 before service pack 3 can be circumvented by using multiple forward slashes, which allows remote attackers to redirect users to arbitrary external URLs via the (1) 'redirect` parameter (2) `FORWARD_URL` parameter, and (3) others parameters that rely on HtmlUtil.escapeRedirect.
impacted_packages:
  - purl: pkg:maven/com.liferay.portal/release.portal.bom
    affected_versions: vers:maven/>=7.3.1-ga2|<7.4.3.4-ga4
    fixed_versions: vers:maven/7.4.3.4-ga4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.liferay.portal/release.dxp.bom
    affected_versions: vers:maven/>=7.0.10.fp91|<7.0.10.fp101
    fixed_versions: vers:maven/7.0.10.fp101
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.liferay.portal/release.dxp.bom
    affected_versions: vers:maven/>=7.1.10.fp17|<7.1.10.fp25
    fixed_versions: vers:maven/7.1.10.fp25
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.liferay.portal/release.dxp.bom
    affected_versions: vers:maven/>=7.2.10.fp5|<7.2.10.fp14
    fixed_versions: vers:maven/7.2.10.fp14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.liferay.portal/com.liferay.util.java
    affected_versions: vers:maven/<7.9.0
    fixed_versions: vers:maven/7.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-w397-9p2j-6x23/GHSA-w397-9p2j-6x23.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: http://liferay.com
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal/commit/242e8bcabe3e8767799d3d1e6c021a75b4ada11b
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal/commit/6389885476414d3cd9e3092b4708906a5bdc8a48
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal/commit/8aa3fd76f34d1a4562bd5b4f82931a0a124e31a8
    reference_type:
    reference_id:
  - url: https://liferay.atlassian.net/browse/LPE-17327
    reference_type:
    reference_id:
  - url: https://liferay.dev/portal/security/known-vulnerabilities/-/asset_publisher/jekt/content/cve-2022-28977?p_r_p_assetEntryId=121612261&_com_liferay_asset_publisher_web_portlet_AssetPublisherPortlet_INSTANCE_jekt_redirect=https%3A%2F%2Fliferay.dev%3A443%2Fportal%2Fsecurity%2Fknown-vulnerabilities%3Fp_p_id%3Dcom_liferay_asset_publisher_web_portlet_AssetPublisherPortlet_INSTANCE_jekt%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_r_p_assetEntryId%3D121612261%26_com_liferay_asset_publisher_web_portlet_AssetPublisherPortlet_INSTANCE_jekt_cur%3D0%26p_r_p_resetCur%3Dfalse
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20220922060039/https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/cve-2022-28977-htmlutil.escaperedirect-circumvention-with-multiple-forward-slash
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-28977
    reference_type:
    reference_id: CVE-2022-28977
