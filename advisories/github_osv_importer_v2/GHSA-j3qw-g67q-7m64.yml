advisory_id: GHSA-j3qw-g67q-7m64
datasource_id: github_osv_importer_v2/GHSA-j3qw-g67q-7m64
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-j3qw-g67q-7m64/GHSA-j3qw-g67q-7m64.json
aliases:
  - CVE-2022-33683
summary: |
  Apache Pulsar Brokers and Proxies vulnerable to Improper Certificate Validation
  Apache Pulsar Brokers and Proxies create an internal Pulsar Admin Client that does not verify peer TLS certificates, even when tlsAllowInsecureConnection is disabled via configuration. The Pulsar Admin Client's intra-cluster and geo-replication HTTPS connections are vulnerable to man in the middle attacks, which could leak authentication data, configuration data, and any other data sent by these clients. An attacker can only take advantage of this vulnerability by taking control of a machine 'between' the client and the server. The attacker must then actively manipulate traffic to perform the attack. This issue affects Apache Pulsar Broker and Proxy versions 2.7.0 to 2.7.4; 2.8.0 to 2.8.3; 2.9.0 to 2.9.2; 2.10.0; 2.6.4 and earlier.
impacted_packages:
  - purl: pkg:maven/org.apache.pulsar/pulsar-broker
    affected_versions: vers:maven/<2.7.5
    fixed_versions: vers:maven/2.7.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.pulsar/pulsar-proxy
    affected_versions: vers:maven/<2.7.5
    fixed_versions: vers:maven/2.7.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.pulsar/pulsar-broker
    affected_versions: vers:maven/>=2.8.0|<2.8.4
    fixed_versions: vers:maven/2.8.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.pulsar/pulsar-proxy
    affected_versions: vers:maven/>=2.8.0|<2.8.4
    fixed_versions: vers:maven/2.8.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.pulsar/pulsar-broker
    affected_versions: vers:maven/>=2.9.0|<2.9.3
    fixed_versions: vers:maven/2.9.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.pulsar/pulsar-proxy
    affected_versions: vers:maven/>=2.9.0|<2.9.3
    fixed_versions: vers:maven/2.9.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.pulsar/pulsar-broker
    affected_versions: vers:maven/2.10.0
    fixed_versions: vers:maven/2.10.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.pulsar/pulsar-proxy
    affected_versions: vers:maven/2.10.0
    fixed_versions: vers:maven/2.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-j3qw-g67q-7m64/GHSA-j3qw-g67q-7m64.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-295
references:
  - url: https://lists.apache.org/thread/42v5rsxj36r3nhfxhmhb2x12r5jmvx3x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-33683
    reference_type:
    reference_id: CVE-2022-33683
