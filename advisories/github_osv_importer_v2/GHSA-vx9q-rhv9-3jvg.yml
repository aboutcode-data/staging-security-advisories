advisory_id: GHSA-vx9q-rhv9-3jvg
datasource_id: github_osv_importer_v2/GHSA-vx9q-rhv9-3jvg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-vx9q-rhv9-3jvg/GHSA-vx9q-rhv9-3jvg.json
aliases:
  - CVE-2025-67721
summary: |
  aircompressor Snappy and LZ4 Java-based decompressor implementation can leak information from reused output buffer
  ### Summary
  Incorrect handling of malformed data in Java-based decompressor implementations for Snappy and LZ4 allows remote attackers to read previous buffer contents via crafted compressed input. In applications where the output buffer is reused without being cleared, this may lead to disclosure of sensitive data.

  ### Details
  With certain crafted compressed inputs, elements from the output buffer can end up in the uncompressed output. This is relevant for applications that reuse the same output buffer to uncompress multiple inputs. This can be the case of a web server that allocates a fix-sized buffer for performance purposes. This is similar to [GHSA-cmp6-m4wj-q63q](https://github.com/yawkat/lz4-java/security/advisories/GHSA-cmp6-m4wj-q63q).

  ### Impact
  Applications using aircompressor as described above may leak sensitive information to external unauthorized attackers.

  ### Mitigation

  The vulnerability is fixed in release 3.4. However, it can be mitigated by either:
  * Avoiding reuse of the decompression buffer across calls
  * Clearing the decompression buffer before a call to decompress data
impacted_packages:
  - purl: pkg:maven/io.airlift/aircompressor-v3
    affected_versions: vers:maven/<3.4
    fixed_versions: vers:maven/3.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/io.airlift/aircompressor
    affected_versions: vers:maven/<=2.0.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-vx9q-rhv9-3jvg/GHSA-vx9q-rhv9-3jvg.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-201
  - CWE-125
references:
  - url: https://github.com/airlift/aircompressor
    reference_type:
    reference_id:
  - url: https://github.com/airlift/aircompressor/commit/f2b489b398779b40c1ee29ddb11d7edef54ddc15
    reference_type:
    reference_id:
  - url: https://github.com/airlift/aircompressor/commit/ff12c4d5757c9d6d1de3d39a10402f1f84f9b765
    reference_type:
    reference_id:
  - url: https://github.com/airlift/aircompressor/pull/309
    reference_type:
    reference_id:
  - url: https://github.com/airlift/aircompressor/security/advisories/GHSA-vx9q-rhv9-3jvg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-67721
    reference_type:
    reference_id:
