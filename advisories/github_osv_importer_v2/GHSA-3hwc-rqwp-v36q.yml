advisory_id: GHSA-3hwc-rqwp-v36q
datasource_id: github_osv_importer_v2/GHSA-3hwc-rqwp-v36q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-3hwc-rqwp-v36q/GHSA-3hwc-rqwp-v36q.json
aliases:
  - CVE-2023-50291
summary: |
  Apache Solr can leak certain passwords due to System Property redaction logic inconsistencies
  Insufficiently Protected Credentials vulnerability in Apache Solr.

  This issue affects Apache Solr from 6.0.0 through 8.11.2, from 9.0.0 before 9.3.0.
  One of the two endpoints that publishes the Solr process' Java system properties, /admin/info/properties, was only setup to hide system properties that had "password" contained in the name.
  There are a number of sensitive system properties, such as "basicauth" and "aws.secretKey" do not contain "password", thus their values were published via the "/admin/info/properties" endpoint.
  This endpoint populates the list of System Properties on the home screen of the Solr Admin page, making the exposed credentials visible in the UI.

  This /admin/info/properties endpoint is protected under the "config-read" permission.
  Therefore, Solr Clouds with Authorization enabled will only be vulnerable through logged-in users that have the "config-read" permission.
  Users are recommended to upgrade to version 9.3.0 or 8.11.3, both of which fix the issue.
  A single option now controls hiding Java system property for all endpoints, "-Dsolr.hiddenSysProps".
  By default all known sensitive properties are hidden (including "-Dbasicauth"), as well as any property with a name containing "secret" or "password".

  Users who cannot upgrade can also use the following Java system property to fix the issue:
  Â  `-Dsolr.redaction.system.pattern=.*(password|secret|basicauth).*`
impacted_packages:
  - purl: pkg:maven/org.apache.solr/solr-core
    affected_versions: vers:maven/>=6.0.0|<8.11.3
    fixed_versions: vers:maven/8.11.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.solr/solr-core
    affected_versions: vers:maven/>=9.0.0|<9.3.0
    fixed_versions: vers:maven/9.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-3hwc-rqwp-v36q/GHSA-3hwc-rqwp-v36q.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-522
references:
  - url: https://github.com/apache/solr
    reference_type:
    reference_id:
  - url: https://github.com/apache/solr/commit/659021c7d50164a3166887f24875228431b02102
    reference_type:
    reference_id:
  - url: https://github.com/apache/solr/commit/98c198810f2cd934d23d0d80aadb570a2bbb3b8e
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/SOLR-16809
    reference_type:
    reference_id:
  - url: https://solr.apache.org/security.html#cve-2023-50291-apache-solr-can-leak-certain-passwords-due-to-system-property-redaction-logic-inconsistencies
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/02/09/4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-50291
    reference_type:
    reference_id: CVE-2023-50291
