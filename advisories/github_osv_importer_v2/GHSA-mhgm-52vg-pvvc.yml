advisory_id: GHSA-mhgm-52vg-pvvc
datasource_id: github_osv_importer_v2/GHSA-mhgm-52vg-pvvc
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/02/GHSA-mhgm-52vg-pvvc/GHSA-mhgm-52vg-pvvc.json
aliases: []
summary: |
  Privilege escalation in Strongbox
  ### Impact
  An attacker with read-only access to a Strongbox secret could craft a valid encrypted secret (same id/version). It also makes the audit logs from KMS less useful. The issue is caused by a bug in the underlying AWS Encryption SDK.

  By default, the encrypted secrets are stored in DynamoDB and an attacker with read-only access would not be able to write the encrypted secret to DynamoDB. So in practice the impact should be limited for most users.

  Strongbox supports storing data in files as an alternative to DynamoDB. If the attacker had write access to where the files are stored they could make the attack work end-to-end. Similarly, any custom storage backend could also be affected.

  In order to be backwards compatible Strongbox will not make use of key commitments (another improvement to the AWS Encryption SDK). Strongbox enforces that only one KMS key can be used, and it must match the expected one. This means that an attacker needs write access to both KMS and DynamoDB (or other storage backend) to stage an attack, which is not a scenario Strongbox is designed to protect against.

  ### Patches
  Fixed in version 0.5.0.

  ### Workarounds
  None

  ### References
  - https://github.com/aws/aws-encryption-sdk-java/security/advisories/GHSA-55xh-53m6-936r
  - https://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/concepts.html#key-commitment
impacted_packages:
  - purl: pkg:maven/com.schibsted.security/strongbox-sdk
    affected_versions: vers:maven/<0.5.0
    fixed_versions: vers:maven/0.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/schibsted/strongbox
    reference_type:
    reference_id:
  - url: https://github.com/schibsted/strongbox/commit/e61f7c36efa898e8b44de6222cd66d2bcdd073e6
    reference_type:
    reference_id:
  - url: https://github.com/schibsted/strongbox/security/advisories/GHSA-mhgm-52vg-pvvc
    reference_type:
    reference_id:
