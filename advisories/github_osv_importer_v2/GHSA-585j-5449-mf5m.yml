advisory_id: GHSA-585j-5449-mf5m
datasource_id: github_osv_importer_v2/GHSA-585j-5449-mf5m
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-585j-5449-mf5m/GHSA-585j-5449-mf5m.json
aliases:
  - CVE-2017-6927
summary: |
  Drupal cross-site scripting vulnerability
  Drupal 8.4.x versions before 8.4.5 and Drupal 7.x versions before 7.57 has a Drupal.checkPlain() JavaScript function which is used to escape potentially dangerous text before outputting it to HTML (as JavaScript output does not typically go through Twig autoescaping). This function does not correctly handle all methods of injecting malicious HTML, leading to a cross-site scripting vulnerability under certain circumstances. The PHP functions which Drupal provides for HTML escaping are not affected.
impacted_packages:
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/>=8.4.0|<8.4.5
    fixed_versions: vers:composer/8.4.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/>=7.0.0|<7.57.0
    fixed_versions: vers:composer/7.57.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/drupal/drupal
    affected_versions: vers:composer/>=8.4.0|<8.4.5
    fixed_versions: vers:composer/8.4.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/drupal/drupal
    affected_versions: vers:composer/>=7.0.0|<7.57.0
    fixed_versions: vers:composer/7.57.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-585j-5449-mf5m/GHSA-585j-5449-mf5m.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/drupal/core
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/core/CVE-2017-6927.yaml
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/drupal/drupal/CVE-2017-6927.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2018/02/msg00030.html
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2018/dsa-4123
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2018-001
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/103138
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-6927
    reference_type:
    reference_id: CVE-2017-6927
