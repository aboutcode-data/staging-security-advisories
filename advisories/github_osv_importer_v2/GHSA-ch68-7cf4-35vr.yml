advisory_id: GHSA-ch68-7cf4-35vr
datasource_id: github_osv_importer_v2/GHSA-ch68-7cf4-35vr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-ch68-7cf4-35vr/GHSA-ch68-7cf4-35vr.json
aliases:
  - CVE-2022-23600
summary: |
  Limited ability to spoof SAML authentication with missing audience verification in Fleet
  ### Impact

  This impacts deployments using SAML SSO in two specific cases:

  1. A malicious or compromised Service Provider (SP) could reuse the SAML response to log into Fleet as a user -- only if the user has an account with the same email in Fleet, _and_ the user signs into the malicious SP via SAML SSO from the same Identity Provider (IdP) configured with Fleet.
  2. A user with an account in Fleet could reuse a SAML response intended for another SP to log into Fleet. This is only a concern if the user is blocked from Fleet in the IdP, but continues to have an account in Fleet. If the user is blocked from the IdP entirely, this cannot be exploited.

  ### Patches
  Fleet 4.9.1 resolves this issue.

  ### Workarounds and good practices
  * Reduce the length of sessions on your IdP to reduce the window for malicious re-use.
  * Limit the amount of SAML Service Providers/Applications used by user accounts with access to Fleet.
  * When removing access to Fleet in the IdP, delete the Fleet user from Fleet as well.

  ### For more information
  If you have any questions or comments about this advisory:
  * Join us in the #fleet channel of [osquery Slack](https://join.slack.com/t/osquery/shared_invite/zt-h29zm0gk-s2DBtGUTW4CFel0f0IjTEw).
  * Email us at [security@fleetdm.com](mailto:security@fleetdm.com).
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-ch68-7cf4-35vr/GHSA-ch68-7cf4-35vr.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-284
  - CWE-287
references:
  - url: https://github.com/fleetdm/fleet
    reference_type:
    reference_id:
  - url: https://github.com/fleetdm/fleet/commit/35d5a7b285f15ddd47486fa656e8b1acf3d48374
    reference_type:
    reference_id:
  - url: https://github.com/fleetdm/fleet/security/advisories/GHSA-ch68-7cf4-35vr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23600
    reference_type:
    reference_id: CVE-2022-23600
