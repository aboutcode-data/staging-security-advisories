advisory_id: GHSA-7fcj-pq9j-wh2r
datasource_id: github_osv_importer_v2/GHSA-7fcj-pq9j-wh2r
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-7fcj-pq9j-wh2r/GHSA-7fcj-pq9j-wh2r.json
aliases:
  - CVE-2019-16784
summary: |
  Local Privilege Escalation in PyInstaller
  ### Impact

  Local Privilege Escalation in all Windows software frozen by PyInstaller in "onefile" mode.

  The vulnerability is present only on Windows and in this particular case: If a **software frozen by PyInstaller in "onefile" mode** is launched by a (privileged) user who has **his/her "TempPath" resolving to a world writable directory**. This is the case e.g. if the software is launched as a service or as a scheduled task using a system account (in which case TempPath will default to C:\Windows\Temp).

  In order to be exploitable the software has to be (re)started after the attacker has launched the exploit program. So for a service launched at startup, a service restart is needed (e.g. after a crash or an upgrade).

  While PyInstaller itself was not vulnerable, all Windows software frozen by PyInstaller in "onefile" mode is vulnerable.

  CVSSv3 score 7.0 (High)
  CVSSv3 vector CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H

  Affected
  - all Windows software frozen by PyInstaller in "onefile" mode

  No affected
  - PyInstaller itself (except if frozen by PyInstaller in "onefile" mode on Windows)
  - software frozen in "one*dir*" mode
  - other platforms (GNU/Linux, OS X, BSD, etc.)

  ### Patches
  The problem is patched in commits 42a67148b3bdf9211fda8499fdc5b63acdd7e6cc (fixed code) and be948cf0954707671aa499da17b10c86b6fa5e5c (recompiled bootloaders). Users should upgrade to PyInstaller version 3.6 and rebuild their software.

  ### Workarounds
  There is no known workaround. Users using PyInstaller to freeze their Windows software using "onefile" mode should upgrade PyInstaller and rebuild their software.

  ### Credits
  This vulnerability was discovered and reported by Farid AYOUJIL (@faridtsl), David HA, Florent LE NIGER and Yann GASCUEL (@lnv42) from Alter Solutions (@AlterSolutions) and fixed in collaboration with
  Hartmut Goebel (@htgoebel, maintainer of PyInstaller).

  ### Funding Development

  PyInstaller is in urgent need of funding to make future security fixes happen, see <https://github.com/pyinstaller/pyinstaller/issues/4404> for details.
impacted_packages:
  - purl: pkg:pypi/pyinstaller
    affected_versions: vers:pypi/<3.6
    fixed_versions: vers:pypi/3.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-7fcj-pq9j-wh2r/GHSA-7fcj-pq9j-wh2r.json
  - score: '7.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-7fcj-pq9j-wh2r/GHSA-7fcj-pq9j-wh2r.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-250
references:
  - url: https://github.com/pyinstaller/pyinstaller
    reference_type:
    reference_id:
  - url: https://github.com/pyinstaller/pyinstaller/commit/42a67148b3bdf9211fda8499fdc5b63acdd7e6cc
    reference_type:
    reference_id:
  - url: https://github.com/pyinstaller/pyinstaller/commit/be948cf0954707671aa499da17b10c86b6fa5e5c
    reference_type:
    reference_id:
  - url: https://github.com/pyinstaller/pyinstaller/security/advisories/GHSA-7fcj-pq9j-wh2r
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pyinstaller/PYSEC-2020-175.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-16784
    reference_type:
    reference_id: CVE-2019-16784
