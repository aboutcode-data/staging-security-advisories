advisory_id: GHSA-7638-r9r3-rmjj
datasource_id: github_osv_importer_v2/GHSA-7638-r9r3-rmjj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/07/GHSA-7638-r9r3-rmjj/GHSA-7638-r9r3-rmjj.json
aliases:
  - CVE-2021-3602
summary: |
  Buildah processes using chroot isolation may leak environment values to intermediate processes
  ### Impact
  When running processes using "chroot" isolation, the process being run can examine the environment variables of its immediate parent and grandparent processes (CVE-2021-3602).  This isolation type is often used when running `buildah` in unprivileged containers, and it is often used to do so in CI/CD environments.  If sensitive information is exposed to the original `buildah` process through its environment, that information will unintentionally be shared with child processes which it starts as part of handling RUN instructions or during `buildah run`.  The commands that `buildah` is instructed to run can read that information if they choose to.

  ### Patches
  Users should upgrade packages, or images which contain packages, to include version 1.21.3 or later.

  ### Workarounds
  As a workaround, invoking `buildah` in a container under `env -i` to have it started with a reinitialized environment should prevent the leakage.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [buildah](https://github.com/containers/buildah/issues)
  * Email us at [the buildah general mailing list](mailto:buildah@lists.buildah.io), or [the podman security mailing list](mailto:security@lists.podman.io) if it's sensitive.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/07/GHSA-7638-r9r3-rmjj/GHSA-7638-r9r3-rmjj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-212
  - CWE-200
references:
  - url: https://github.com/containers/buildah
    reference_type:
    reference_id:
  - url: https://github.com/containers/buildah/commit/a468ce0ffd347035d53ee0e26c205ef604097fb0
    reference_type:
    reference_id:
  - url: https://github.com/containers/buildah/security/advisories/GHSA-7638-r9r3-rmjj
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-0345
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-3602
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1969264
    reference_type: bug
    reference_id: '1969264'
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3602
    reference_type:
    reference_id: CVE-2021-3602
