advisory_id: GHSA-9g4j-v8w5-7x42
datasource_id: github_osv_importer_v2/GHSA-9g4j-v8w5-7x42
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-9g4j-v8w5-7x42/GHSA-9g4j-v8w5-7x42.json
aliases:
  - CVE-2025-53942
summary: |
  Authentik has insufficient check for account active status when authenticating with OAuth/SAML Sources
  ### Summary

  Deactivated users that had either enrolled via OAuth/SAML or had their account connected to an OAuth/SAML account can still partially access authentik even if their account is deactivated. They end up in a half-authenticated state where they cannot access the API but crucially they can authorize applications if they know the URL of the application.

  ### Patches

  authentik 2025.4.4 and 2025.6.4 fix this issue.

  ### Workarounds

  Adding an expression policy to the user login stage on the respective authentication flow with the expression of

  ```py
  return request.context["pending_user"].is_active
  ```

  This expression will only activate the user login stage when the user is active.

  ### For more information

  If you have any questions or comments about this advisory:

  - Email us at [security@goauthentik.io](mailto:security@goauthentik.io).
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-9g4j-v8w5-7x42/GHSA-9g4j-v8w5-7x42.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/goauthentik/authentik
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/commit/7a4c6b9b50f8b837133a7a1fd2cb9b7f18a145cd
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/commit/c3629d12bfe3d32d3dc8f85c0ee1f087a55dde8f
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/commit/ce3f9e3763c1778bf3a16b98c95d10f4091436ab
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/security/advisories/GHSA-9g4j-v8w5-7x42
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-53942
    reference_type:
    reference_id: CVE-2025-53942
