advisory_id: GHSA-m2pf-hprp-3vqm
datasource_id: github_osv_importer_v2/GHSA-m2pf-hprp-3vqm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-m2pf-hprp-3vqm/GHSA-m2pf-hprp-3vqm.json
aliases:
  - CVE-2019-16138
summary: |
  Use after free in image
  Affected versions of this crate would call Vec::set_len on an uninitialized vector with user-provided type parameter, in an interface of the HDR image format decoder. They would then also call other code that could panic before initializing all instances.

  This could run Drop implementations on uninitialized types, equivalent to use-after-free, and allow an attacker arbitrary code execution.

  Two different fixes were applied. It is possible to conserve the interface by ensuring proper initialization before calling Vec::set_len. Drop is no longer called in case of panic, though.

  Starting from version 0.22, a breaking change to the interface requires callers to pre-allocate the output buffer and pass a mutable slice instead, avoiding all unsafe code.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-m2pf-hprp-3vqm/GHSA-m2pf-hprp-3vqm.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-416
references:
  - url: https://github.com/image-rs/image
    reference_type:
    reference_id:
  - url: https://github.com/image-rs/image/pull/985
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2019-0014.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-16138
    reference_type:
    reference_id: CVE-2019-16138
