advisory_id: GHSA-vx6j-pjrh-vgjh
datasource_id: github_osv_importer_v2/GHSA-vx6j-pjrh-vgjh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-vx6j-pjrh-vgjh/GHSA-vx6j-pjrh-vgjh.json
aliases:
  - CVE-2021-43836
summary: "PHP file inclusion in the Sulu admin panel\n### Impact\n_What kind of vulnerability\
  \ is it? Who is impacted?_\n\nAn attacker can read arbitrary local files via a PHP file include.\
  \ In a default configuration this also leads to remote code execution.\n\n* Compromised components:\
  \ Arbitrary file read on the server, (Potential) Remote code execution\n* Exploitation pre-requisite:\
  \ User account on the backend\n\n### Patches\n\n_Has the problem been patched? What versions\
  \ should users upgrade to?_\n\nThe problem is patched with the Versions 1.6.44, 2.2.18, 2.3.8,\
  \ 2.4.0\n\n### Workarounds\n\n_Is there a way for users to fix or remediate the vulnerability\
  \ without upgrading?_\n\nOverwrite the service `sulu_route.generator.expression_token_provider`\
  \ and wrap the translator before passing it to the expression language. \n\n### References\n\
  \n_Are there any links users can visit to find out more?_\n\nCurrently not.\n\n### For more\
  \ information\nIf you have any questions or comments about this advisory:\n* Open an issue\
  \ in [example link to repo](http://example.com)\n* Email us at [example email address](mailto:example@example.com)"
impacted_packages:
  - purl: pkg:composer/sulu/sulu
    affected_versions: vers:composer/<1.6.44
    fixed_versions: vers:composer/1.6.44
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sulu/sulu
    affected_versions: vers:composer/>=2.0.0|<2.2.18
    fixed_versions: vers:composer/2.2.18
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sulu/sulu
    affected_versions: vers:composer/>=2.3.0|<2.3.8
    fixed_versions: vers:composer/2.3.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/sulu/sulu
    affected_versions: vers:composer/2.4.0-RC1
    fixed_versions: vers:composer/2.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-vx6j-pjrh-vgjh/GHSA-vx6j-pjrh-vgjh.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/sulu/sulu
    reference_type:
    reference_id:
  - url: https://github.com/sulu/sulu/commit/9c948f9ce350c68b53af8c3910e2cefc7f722b54
    reference_type:
    reference_id:
  - url: https://github.com/sulu/sulu/security/advisories/GHSA-vx6j-pjrh-vgjh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43836
    reference_type:
    reference_id: CVE-2021-43836
