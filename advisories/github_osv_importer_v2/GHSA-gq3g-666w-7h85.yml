advisory_id: GHSA-gq3g-666w-7h85
datasource_id: github_osv_importer_v2/GHSA-gq3g-666w-7h85
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-gq3g-666w-7h85/GHSA-gq3g-666w-7h85.json
aliases:
  - CVE-2025-66304
summary: "Grav Exposes Password Hashes Leading to privilege escalation\n# Exposure of Password\
  \ Hashes Leading to privilege escalation\n**Severity Rating:** Medium \n\n**Vector:** Privilege\
  \ Escalation\n\n**CVE:** XXX\n\n**CWE:** 200 - Exposure of Sensitive Information\n\n**CVSS\
  \ Score:** 6.2\n\n**CVSS Vector:** CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:L\n\n## Analysis\n\
  \nIt was observed that if a users is given read access on the user account management section\
  \ of the admin panel can view the password hashes of all users, including the admin user.\
  \ This exposure can potentially lead to privilege escalation if an attacker can crack these\
  \ password hashes.\n\nAn attacker with read access can: \n* View and potentially crack the\
  \ password hashes.\n* Gain administrative access by cracking the admin password hash.\n* Escalate\
  \ privileges and compromise the entire admin panel.\n\n\n## Proof of Concept\n\n1) Give read\
  \ access to user accounts to a random user as shown in the following figures:\n  ![grav0](https://github.com/user-attachments/assets/020a4b47-e577-49cb-8392-bfb61491199d)\n\
  \  ![grav2](https://github.com/user-attachments/assets/97fbfc46-c541-4559-9541-2b9b5de86c0e)\n\
  \  \n\n2) Log in to the admin panel with an account that has read access to user accounts\
  \ and navigate to the user account management section.\n\n3) Go to the admin profile `http://127.0.0.1/admin/accounts/users/admin`;\
  \ The password is not display. Try inspecting the page source code as shown in the following\
  \ figures:\n  ![grav2-1](https://github.com/user-attachments/assets/057c9c14-f928-4584-99ae-4939f63dda57)\n\
  \  \n   You can see that it match the hash that is in the admin.yaml file :\n  ![Compare to\
  \ the hash in database of the admin](grav2-2.png)\n  \n\n4) Crack the hash as shown in the\
  \ following figure, the algorithm use here is bcrypt:\n  \n![grav3](https://github.com/user-attachments/assets/ec334f80-4b87-4010-a834-cb92704a596e)\n\
  \  \n\n## Workarounds\nNo workaround is currently known\n\n# Timeline\n**2024-07-24** Issue\
  \ identified\n\n**2024-09-27** Vendor contacted\n\n\n# About X41 D-Sec GmbH\nX41 is an expert\
  \ provider for application security services.\nHaving extensive industry experience and expertise\
  \ in the area of information\nsecurity, a strong core security team of world class security\
  \ experts enables\nX41 to perform premium security services.\n\nFields of expertise in the\
  \ area of application security are security centered\ncode reviews, binary reverse engineering\
  \ and vulnerability discovery.\nCustom research and IT security consulting and support services\
  \ are core\ncompetencies of X41."
impacted_packages:
  - purl: pkg:composer/getgrav/grav
    affected_versions: vers:composer/<1.8.0-beta.27
    fixed_versions: vers:composer/1.8.0-beta.27
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-gq3g-666w-7h85/GHSA-gq3g-666w-7h85.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-201
references:
  - url: https://github.com/getgrav/grav
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/9d11094e4133f059688fad1e00dbe96fb6e3ead7
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-gq3g-666w-7h85
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66304
    reference_type:
    reference_id:
