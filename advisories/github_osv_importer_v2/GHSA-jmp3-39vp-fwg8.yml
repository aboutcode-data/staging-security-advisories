advisory_id: GHSA-jmp3-39vp-fwg8
datasource_id: github_osv_importer_v2/GHSA-jmp3-39vp-fwg8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-jmp3-39vp-fwg8/GHSA-jmp3-39vp-fwg8.json
aliases:
  - CVE-2024-39317
summary: |
  Wagtail regular expression denial-of-service via search query parsing
  ### Impact

  A bug in Wagtail's [`parse_query_string`](https://docs.wagtail.org/en/stable/topics/search/searching.html#wagtailsearch-query-string-parsing) would result in it taking a long time to process suitably crafted inputs. When used to parse sufficiently long strings of characters without a space, `parse_query_string` would take an unexpectedly large amount of time to process, resulting in a denial of service.

  In an initial Wagtail installation, the vulnerability can be exploited by any Wagtail admin user. It cannot be exploited by end users. If your Wagtail site has a custom search implementation which uses `parse_query_string`, it may be exploitable by other users (e.g. unauthenticated users).

  ### Patches

  Patched versions have been released as Wagtail 5.2.6, 6.0.6 and 6.1.3.

  This vulnerability affects all unpatched versions from Wagtail 2.0 onwards.

  ### Workarounds

  Site owners who are unable to upgrade to a patched version can limit the length of search terms passed to `parse_query_string`. Whilst the performance characteristics will depend on your hosting environment, 1000 characters has been shown to still be fairly fast, without triggering this vulnerability.

  No workaround is available for the Wagtail admin usage.

  ### Acknowledgements

  Many thanks to [Jake Howard](https://github.com/RealOrangeOne) for reporting this issue.

  ### For more information
  If you have any questions or comments about this advisory:

  * Visit Wagtail's [support channels](https://docs.wagtail.io/en/stable/support.html)
  * Email us at [security@wagtail.org](mailto:security@wagtail.org) (view our [security policy](https://github.com/wagtail/wagtail/security/policy) for more information).
impacted_packages:
  - purl: pkg:pypi/wagtail
    affected_versions: vers:pypi/>=6.0|<6.0.6
    fixed_versions: vers:pypi/6.0.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/wagtail
    affected_versions: vers:pypi/>=6.1|<6.1.3
    fixed_versions: vers:pypi/6.1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/wagtail
    affected_versions: vers:pypi/>=2.0|<5.2.6
    fixed_versions: vers:pypi/5.2.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-jmp3-39vp-fwg8/GHSA-jmp3-39vp-fwg8.json
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-jmp3-39vp-fwg8/GHSA-jmp3-39vp-fwg8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/wagtail/PYSEC-2024-86.yaml
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/31b1e8532dfb1b70d8d37d22aff9cbde9109cdf2
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/3c941136f79c48446e3858df46e5b668d7f83797
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/b783c096b6d4fd2cfc05f9137a0be288850e99a2
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/security/advisories/GHSA-jmp3-39vp-fwg8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-39317
    reference_type:
    reference_id: CVE-2024-39317
