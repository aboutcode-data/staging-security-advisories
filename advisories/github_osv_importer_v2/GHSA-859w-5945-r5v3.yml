advisory_id: GHSA-859w-5945-r5v3
datasource_id: github_osv_importer_v2/GHSA-859w-5945-r5v3
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-859w-5945-r5v3/GHSA-859w-5945-r5v3.json
aliases:
  - CVE-2025-46565
summary: |
  Vite's server.fs.deny bypassed with /. for files under project root
  ### Summary
  The contents of files in [the project `root`](https://vite.dev/config/shared-options.html#root) that are denied by a file matching pattern can be returned to the browser.

  ### Impact

  Only apps explicitly exposing the Vite dev server to the network (using --host or [server.host config option](https://vitejs.dev/config/server-options.html#server-host)) are affected.
  Only files that are under [project `root`](https://vite.dev/config/shared-options.html#root) and are denied by a file matching pattern can be bypassed.

  - Examples of file matching patterns: `.env`, `.env.*`, `*.{crt,pem}`, `**/.env`
  - Examples of other patterns: `**/.git/**`, `.git/**`, `.git/**/*`

  ### Details
  [`server.fs.deny`](https://vite.dev/config/server-options.html#server-fs-deny) can contain patterns matching against files (by default it includes `.env`, `.env.*`, `*.{crt,pem}` as such patterns).
  These patterns were able to bypass for files under `root` by using a combination of slash and dot (`/.`).

  ### PoC
  ```
  npm create vite@latest
  cd vite-project/
  cat "secret" > .env
  npm install
  npm run dev
  curl --request-target /.env/. http://localhost:5173
  ```

  ![image](https://github.com/user-attachments/assets/822f4416-aa42-461f-8c95-a88d155e674b)
  ![image](https://github.com/user-attachments/assets/42902144-863a-4afb-ac5b-fc16effa37cc)
impacted_packages:
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<=6.3.3
    fixed_versions: vers:npm/6.3.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<=6.2.6
    fixed_versions: vers:npm/6.2.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<=6.1.5
    fixed_versions: vers:npm/6.1.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<=5.4.18
    fixed_versions: vers:npm/5.4.19
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/vite
    affected_versions: vers:npm/<=4.5.13
    fixed_versions: vers:npm/4.5.14
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-859w-5945-r5v3/GHSA-859w-5945-r5v3.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/vitejs/vite
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/commit/c22c43de612eebb6c182dd67850c24e4fab8cacb
    reference_type:
    reference_id:
  - url: https://github.com/vitejs/vite/security/advisories/GHSA-859w-5945-r5v3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-46565
    reference_type:
    reference_id: CVE-2025-46565
