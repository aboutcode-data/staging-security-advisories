advisory_id: GHSA-rvgf-69j7-xh78
datasource_id: github_osv_importer_v2/GHSA-rvgf-69j7-xh78
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-rvgf-69j7-xh78/GHSA-rvgf-69j7-xh78.json
aliases:
  - CVE-2022-25345
summary: |
  Uncontrolled Resource Consumption in @discordjs/opus
  Improperly handled errors in @discordjs/opus cause hard crashes instead of returning the error to user land. All versions of package @discordjs/opus (<= 0.7.0) are vulnerable to Denial of Service (DoS) when trying to encode using an encoder with zero channels, or a non-initialized buffer. This leads to a hard crash due to improperly returning the errors from the invalid inputs.

  As of version 0.8.0, the errors are correctly returned to the user and are no longer throwing hard crashes that cannot be recovered.
impacted_packages:
  - purl: pkg:npm/%40discordjs/opus
    affected_versions: vers:npm/<0.8.0
    fixed_versions: vers:npm/0.8.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-rvgf-69j7-xh78/GHSA-rvgf-69j7-xh78.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-908
references:
  - url: https://github.com/discordjs/opus
    reference_type:
    reference_id:
  - url: https://github.com/discordjs/opus/blob/3ca4341ffdd81cf83cec57045e59e228e6017590/src/node-opus.cc#L28
    reference_type:
    reference_id:
  - url: https://github.com/discordjs/opus/commit/406249f3fca484a2af97a34ceb989019efa09bc7
    reference_type:
    reference_id:
  - url: https://github.com/discordjs/opus/releases/tag/v0.8.0
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-DISCORDJSOPUS-2403100
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-25345
    reference_type:
    reference_id: CVE-2022-25345
