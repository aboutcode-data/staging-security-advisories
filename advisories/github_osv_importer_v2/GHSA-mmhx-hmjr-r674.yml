advisory_id: GHSA-mmhx-hmjr-r674
datasource_id: github_osv_importer_v2/GHSA-mmhx-hmjr-r674
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-mmhx-hmjr-r674/GHSA-mmhx-hmjr-r674.json
aliases:
  - CVE-2024-45801
summary: |
  DOMPurify allows tampering by prototype pollution
  It has been discovered that malicious HTML using special nesting techniques can bypass the depth checking added to DOMPurify in recent releases. It was also possible to use Prototype Pollution to weaken the depth check.

  This renders dompurify unable to avoid XSS attack.

  Fixed by https://github.com/cure53/DOMPurify/commit/1e520262bf4c66b5efda49e2316d6d1246ca7b21 (3.x branch) and https://github.com/cure53/DOMPurify/commit/26e1d69ca7f769f5c558619d644d90dd8bf26ebc (2.x branch).
impacted_packages:
  - purl: pkg:npm/dompurify
    affected_versions: vers:npm/<2.5.4
    fixed_versions: vers:npm/2.5.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/dompurify
    affected_versions: vers:npm/>=3.0.0|<3.1.3
    fixed_versions: vers:npm/3.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-mmhx-hmjr-r674/GHSA-mmhx-hmjr-r674.json
  - score: '8.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:L/VI:H/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/09/GHSA-mmhx-hmjr-r674/GHSA-mmhx-hmjr-r674.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
  - CWE-1321
references:
  - url: https://github.com/cure53/DOMPurify
    reference_type:
    reference_id:
  - url: https://github.com/cure53/DOMPurify/commit/1e520262bf4c66b5efda49e2316d6d1246ca7b21
    reference_type:
    reference_id:
  - url: https://github.com/cure53/DOMPurify/commit/26e1d69ca7f769f5c558619d644d90dd8bf26ebc
    reference_type:
    reference_id:
  - url: https://github.com/cure53/DOMPurify/security/advisories/GHSA-mmhx-hmjr-r674
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45801
    reference_type:
    reference_id: CVE-2024-45801
