advisory_id: GHSA-rr2m-gffv-mgrj
datasource_id: github_osv_importer_v2/GHSA-rr2m-gffv-mgrj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-rr2m-gffv-mgrj/GHSA-rr2m-gffv-mgrj.json
aliases:
  - CVE-2021-25642
summary: |
  Deserialization of Untrusted Data in Apache Hadoop YARN
  ZKConfigurationStore which is optionally used by CapacityScheduler of Apache Hadoop YARN deserializes data obtained from ZooKeeper without validation. An attacker having access to ZooKeeper can run arbitrary commands as YARN user by exploiting this. Users should upgrade to Apache Hadoop 2.10.2, 3.2.4, 3.3.4 or later (containing YARN-11126) if ZKConfigurationStore is used.
impacted_packages:
  - purl: pkg:maven/org.apache.hadoop/hadoop-yarn-server
    affected_versions: vers:maven/<2.10.2
    fixed_versions: vers:maven/2.10.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.hadoop/hadoop-yarn-server
    affected_versions: vers:maven/>=3.0.0|<3.2.4
    fixed_versions: vers:maven/3.2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.hadoop/hadoop-yarn-server
    affected_versions: vers:maven/>=3.3.0|<3.3.4
    fixed_versions: vers:maven/3.3.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/08/GHSA-rr2m-gffv-mgrj/GHSA-rr2m-gffv-mgrj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://github.com/apache/hadoop
    reference_type:
    reference_id:
  - url: https://github.com/apache/hadoop/commit/5e2f4339fadc88f20543915fc9b0aaeaf4f9e7bf
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/g6vf2h4wdgzzdgk91mqozhs58wotq150
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20221201-0003
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-25642
    reference_type:
    reference_id: CVE-2021-25642
