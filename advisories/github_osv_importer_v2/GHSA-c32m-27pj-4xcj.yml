advisory_id: GHSA-c32m-27pj-4xcj
datasource_id: github_osv_importer_v2/GHSA-c32m-27pj-4xcj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-c32m-27pj-4xcj/GHSA-c32m-27pj-4xcj.json
aliases:
  - CVE-2025-49582
summary: |
  XWiki's required right warnings for macros are incomplete
  ### Impact
  When editing content that contains "dangerous" macros like malicious script macros that were authored by a user with fewer rights, XWiki warns about the execution of these macros since XWiki 15.9RC1. These required rights analyzers that trigger these warnings are incomplete, allowing an attacker to hide malicious content. For most macros, the existing analyzers don't consider non-lowercase parameters. Further, most macro parameters that can contain XWiki syntax like titles of information boxes weren't analyzed at all. Similarly, the "source" parameters of the content and context macro weren't anylzed even though they could contain arbitrary XWiki syntax. In the worst case, this could allow a malicious to add malicious script macros including Groovy or Python macros to a page that are then executed after another user with programming righs edits the page, thus allowing remote code execution.

  ### Patches
  The required rights analyzers have been made more robust and extended to cover those cases in XWiki 16.4.7, 16.10.3 and 17.0.0.

  ### Workarounds
  We're not aware of any workarounds except for being careful when editing content authored by untrusted users.

  ### References
  * https://jira.xwiki.org/browse/XWIKI-22763
  * https://jira.xwiki.org/browse/XWIKI-22759
  * https://jira.xwiki.org/browse/XWIKI-22758
  * https://jira.xwiki.org/browse/XWIKI-22799
  * https://github.com/xwiki/xwiki-platform/commit/abdcefc0db27035b67329add836fd683e0cf92b8
  * https://github.com/xwiki/xwiki-platform/commit/cc74dc802efe0e2d3fa2ba3355dbadc51c5fd8c7
  * https://github.com/xwiki/xwiki-platform/commit/0a705e8e253cb871b804e25c53b2bde879c886bd
  * https://github.com/xwiki/xwiki-platform/commit/3d451e957fe2b14459e9ac64172b4a0e4c46971c
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-xwiki
    affected_versions: vers:maven/>=15.9-rc-1|<16.4.7
    fixed_versions: vers:maven/16.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-xwiki
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.10.3
    fixed_versions: vers:maven/16.10.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-xwiki
    affected_versions: vers:maven/>=17.0.0-rc-1|<17.0.0
    fixed_versions: vers:maven/17.0.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-macro-cache
    affected_versions: vers:maven/>=15.9-rc-1|<16.4.7
    fixed_versions: vers:maven/16.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-macro-cache
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.10.3
    fixed_versions: vers:maven/16.10.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-macro-cache
    affected_versions: vers:maven/>=17.0.0-rc-1|<17.0.0
    fixed_versions: vers:maven/17.0.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default
    affected_versions: vers:maven/>=15.9-rc-1|<16.4.7
    fixed_versions: vers:maven/16.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.10.3
    fixed_versions: vers:maven/16.10.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default
    affected_versions: vers:maven/>=17.0.0-rc-1|<17.0.0
    fixed_versions: vers:maven/17.0.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-macro-context
    affected_versions: vers:maven/>=15.9-rc-1|<16.4.7
    fixed_versions: vers:maven/16.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-macro-context
    affected_versions: vers:maven/>=16.5.0-rc-1|<16.10.3
    fixed_versions: vers:maven/16.10.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-macro-context
    affected_versions: vers:maven/>=17.0.0-rc-1|<17.0.0
    fixed_versions: vers:maven/17.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-c32m-27pj-4xcj/GHSA-c32m-27pj-4xcj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-357
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/0a705e8e253cb871b804e25c53b2bde879c886bd
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/3d451e957fe2b14459e9ac64172b4a0e4c46971c
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/abdcefc0db27035b67329add836fd683e0cf92b8
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/cc74dc802efe0e2d3fa2ba3355dbadc51c5fd8c7
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-c32m-27pj-4xcj
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22758
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22759
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22763
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22799
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49582
    reference_type:
    reference_id: CVE-2025-49582
