advisory_id: GHSA-675f-rq2r-jw82
datasource_id: github_osv_importer_v2/GHSA-675f-rq2r-jw82
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-675f-rq2r-jw82/GHSA-675f-rq2r-jw82.json
aliases:
  - CVE-2025-22149
summary: |
  JWK Set's HTTP client only overwrites and appends JWK to local cache during refresh
  ### Impact
  The project's provided HTTP client's local JWK Set cache should do a full replacement when the goroutine refreshes the remote JWK Set. The current behavior is to overwrite or append. This is a security issue for use cases that utilize the provided auto-caching HTTP client and where key removal from a JWK Set is equivalent to revocation.

  Example attack scenario:
  1. An attacker has stolen the private key for a key published in JWK Set.
  2. The publishers of that JWK Set remove that key from the JWK Set.
  3. Enough time has passed that the program using the auto-caching HTTP client found in `github.com/MicahParks/jwkset` v0.5.0-v0.5.21 has elapsed its `HTTPClientStorageOptions.RefreshInterval` duration, causing a refresh of the remote JWK Set.
  4. The attacker is signing content (such as JWTs) with the stolen private key and the system has no other forms of revocation.

  ### Patches
  The affected auto-caching HTTP client was added in version `v0.5.0` and fixed in `v0.6.0`. Upgrade to `v0.6.0` or later.

  ### Workarounds
  The only workaround would be to remove the provided auto-caching HTTP client and replace it with a custom implementation. This involves setting the `HTTPClientStorageOptions.RefreshInterval` to zero (or not specifying the value). Upgrade to `v0.6.0` is advised.

  ### References
  Please see the tracking issue on GitHub for additional details: https://github.com/MicahParks/jwkset/issues/40
impacted_packages: []
severities:
  - score: '2.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:P/PR:H/UI:N/VC:N/VI:N/VA:N/SC:N/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-675f-rq2r-jw82/GHSA-675f-rq2r-jw82.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-672
references:
  - url: https://github.com/MicahParks/jwkset
    reference_type:
    reference_id:
  - url: https://github.com/MicahParks/jwkset/commit/01db49a90f7f20c7fb39a699a2f19a7a5f379ed3
    reference_type:
    reference_id:
  - url: https://github.com/MicahParks/jwkset/issues/40
    reference_type:
    reference_id:
  - url: https://github.com/MicahParks/jwkset/pull/41
    reference_type:
    reference_id:
  - url: https://github.com/MicahParks/jwkset/security/advisories/GHSA-675f-rq2r-jw82
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22149
    reference_type:
    reference_id: CVE-2025-22149
