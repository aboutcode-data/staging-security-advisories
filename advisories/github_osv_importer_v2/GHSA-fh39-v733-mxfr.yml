advisory_id: GHSA-fh39-v733-mxfr
datasource_id: github_osv_importer_v2/GHSA-fh39-v733-mxfr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2017/10/GHSA-fh39-v733-mxfr/GHSA-fh39-v733-mxfr.json
aliases:
  - CVE-2012-2661
summary: |
  Active Record vulnerable to SQL Injection via nested query parameters
  The Active Record component in Ruby on Rails 3.0.x before 3.0.13, 3.1.x before 3.1.5, and 3.2.x before 3.2.4 does not properly implement the passing of request data to a where method in an ActiveRecord class, which allows remote attackers to conduct certain SQL injection attacks via nested query parameters that leverage unintended recursion, a related issue to CVE-2012-2695.
impacted_packages:
  - purl: pkg:gem/activerecord
    affected_versions: vers:gem/>=3.0.0|<3.0.13
    fixed_versions: vers:gem/3.0.13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activerecord
    affected_versions: vers:gem/>=3.1.0|<3.1.5
    fixed_versions: vers:gem/3.1.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activerecord
    affected_versions: vers:gem/>=3.2.0|<3.2.4
    fixed_versions: vers:gem/3.2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2012-08/msg00014.html
    reference_type:
    reference_id:
  - url: http://lists.opensuse.org/opensuse-security-announce/2012-08/msg00016.html
    reference_type:
    reference_id:
  - url: http://lists.opensuse.org/opensuse-updates/2012-08/msg00046.html
    reference_type:
    reference_id:
  - url: http://rhn.redhat.com/errata/RHSA-2013-0154.html
    reference_type:
    reference_id:
  - url: https://groups.google.com/group/rubyonrails-security/msg/fc2da6c627fc92df?dmode=source&output=gplain
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2012-2661
    reference_type:
    reference_id: CVE-2012-2661
