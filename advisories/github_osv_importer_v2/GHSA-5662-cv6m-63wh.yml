advisory_id: GHSA-5662-cv6m-63wh
datasource_id: github_osv_importer_v2/GHSA-5662-cv6m-63wh
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-5662-cv6m-63wh/GHSA-5662-cv6m-63wh.json
aliases:
  - CVE-2025-54059
summary: |
  melange's world-writable permissions expose SBOM files to potential image tampering
  It was discovered that the SBOM files generated by melange in apks had file system permissions mode 666:
  ```
  $ apkrane ls https://packages.wolfi.dev/os/x86_64/APKINDEX.tar.gz -P hello-wolfi --full --latest  | xargs wget -q -O  - | tar tzv 2>/dev/null var/lib/db/sbom
  drwxr-xr-x root/root         0 2025-06-23 14:17 var/lib/db/sbom
  -rw-rw-rw- root/root      3383 2025-06-23 14:17 var/lib/db/sbom/hello-wolfi-2.12.2-r1.spdx.json
  ```

  This issue was introduced in commit 1b272db ("Persist workspace filesystem throughout package builds (#1836)") ([v0.23.0](https://github.com/chainguard-dev/melange/releases/tag/v0.23.0)).

  ### Impact
  This potentially allows an unprivileged user to tamper with apk SBOMs on a running image, potentially confusing security scanners. An attacker could also perform a DoS under special circumstances.

  ### Patches
  This issue was addressed in melange in e29494b ("fix: tighten up permissions for written SBOM files and signature tarballs (#2086)") ([v0.29.5](https://github.com/chainguard-dev/melange/releases/tag/v0.29.5)).

  ## Acknowledgements

  Thanks to Cody Harris [H2O.ai](https://h2o.ai/) and Markus Boehme for independently reporting this issue.
impacted_packages: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/07/GHSA-5662-cv6m-63wh/GHSA-5662-cv6m-63wh.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-276
references:
  - url: https://github.com/chainguard-dev/melange
    reference_type:
    reference_id:
  - url: https://github.com/chainguard-dev/melange/commit/1b272db2a0bb3441553284cc56d87236b4b64c04
    reference_type:
    reference_id:
  - url: https://github.com/chainguard-dev/melange/commit/e29494b4a40a91619ec1c87a09003c6d5164cea1
    reference_type:
    reference_id:
  - url: https://github.com/chainguard-dev/melange/pull/1836
    reference_type:
    reference_id:
  - url: https://github.com/chainguard-dev/melange/pull/2086
    reference_type:
    reference_id:
  - url: https://github.com/chainguard-dev/melange/releases/tag/v0.29.5
    reference_type:
    reference_id:
  - url: https://github.com/chainguard-dev/melange/security/advisories/GHSA-5662-cv6m-63wh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54059
    reference_type:
    reference_id: CVE-2025-54059
