advisory_id: GHSA-77jf-fjjf-xcww
datasource_id: github_osv_importer_v2/GHSA-77jf-fjjf-xcww
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/08/GHSA-77jf-fjjf-xcww/GHSA-77jf-fjjf-xcww.json
aliases:
  - CVE-2019-9155
summary: |
  Invalid Curve Attack in openpgp
  Versions of `openpgp` prior to 4.3.0 are vulnerable to an Invalid Curve Attack. The package's implementation of ECDH fails to verify the validity of the communication partner's public key. The package calculates the resulting key secret based on an altered curve instead of the specified elliptic curve. Attackers may exfiltrate the victim's private key by choosing the altered curve. An attack requires the attacker being able to initiate message decryption and record the result. Furthermore the victim's key must offer an ECDH public key.


  ## Recommendation

  Upgrade to version 4.3.0 or later.
  If you are upgrading from a version <4.0.0 it is highly recommended to read the `High-Level API Changes` section of the `openpgp` 4.0.0 release: https://github.com/openpgpjs/openpgpjs/releases/tag/v4.0.0
impacted_packages:
  - purl: pkg:npm/openpgp
    affected_versions: vers:npm/<4.3.0
    fixed_versions: vers:npm/4.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/08/GHSA-77jf-fjjf-xcww/GHSA-77jf-fjjf-xcww.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-327
references:
  - url: http://packetstormsecurity.com/files/154191/OpenPGP.js-4.2.0-Signature-Bypass-Invalid-Curve-Attack.html
    reference_type:
    reference_id:
  - url: https://github.com/openpgpjs/openpgpjs/pull/853
    reference_type:
    reference_id:
  - url: https://github.com/openpgpjs/openpgpjs/pull/853/commits/7ba4f8c655e7fd7706e8d7334e44b40fdf56c43e
    reference_type:
    reference_id:
  - url: https://github.com/openpgpjs/openpgpjs/releases/tag/v4.3.0
    reference_type:
    reference_id:
  - url: https://sec-consult.com/en/blog/advisories/multiple-vulnerabilities-in-openpgp-js
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-OPENPGP-460225
    reference_type:
    reference_id:
  - url: https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/Mailvelope_Extensions/Mailvelope_Extensions_pdf.html#download=1
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1159
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-9155
    reference_type:
    reference_id: CVE-2019-9155
