advisory_id: GHSA-2m96-52r3-2f3g
datasource_id: github_osv_importer_v2/GHSA-2m96-52r3-2f3g
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-2m96-52r3-2f3g/GHSA-2m96-52r3-2f3g.json
aliases:
  - CVE-2024-43380
summary: |
  fugit parse and parse_nat stall on lengthy input
  ### Impact

  The fugit "natural" parser, that turns "every wednesday at 5pm" into "0 17 * * 3", accepted any length of input and went on attempting to parse it, not returning promptly, as expected. The parse call could hold the thread with no end in sight.

  Fugit dependents that do not check (user) input length for plausability are impacted.

  ### Patches

  Problem was reported in #104 and the fix was released in [fugit 1.11.1](https://rubygems.org/gems/fugit/versions/1.11.1)

  ### Workarounds

  By making sure that `Fugit.parse(s)`, `Fugit.do_parse(s)`, `Fugit.parse_nat(s)`, `Fugit.do_parse_nat(s)`, `Fugit::Nat.parse(s)`, and `Fugit::Nat.do_parse(s)` are not fed strings too long. 1000 chars feels ok, while 10_000 chars makes it stall.

  In fewer words, making sure those fugit methods are not fed unvetted input strings.

  ### References

  gh-104
impacted_packages:
  - purl: pkg:gem/fugit
    affected_versions: vers:gem/<1.11.1
    fixed_versions: vers:gem/1.11.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-2m96-52r3-2f3g/GHSA-2m96-52r3-2f3g.json
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/08/GHSA-2m96-52r3-2f3g/GHSA-2m96-52r3-2f3g.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/floraison/fugit
    reference_type:
    reference_id:
  - url: https://github.com/floraison/fugit/commit/ad2c1c9c737213d585fff0b51c927d178b2c05a5
    reference_type:
    reference_id:
  - url: https://github.com/floraison/fugit/issues/104
    reference_type:
    reference_id:
  - url: https://github.com/floraison/fugit/security/advisories/GHSA-2m96-52r3-2f3g
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/fugit/CVE-2024-43380.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43380
    reference_type:
    reference_id: CVE-2024-43380
