advisory_id: GHSA-x76w-6vjr-8xgj
datasource_id: github_osv_importer_v2/GHSA-x76w-6vjr-8xgj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-x76w-6vjr-8xgj/GHSA-x76w-6vjr-8xgj.json
aliases:
  - CVE-2024-41128
summary: |
  Possible ReDoS vulnerability in query parameter filtering in Action Dispatch
  There is a possible ReDoS vulnerability in the query parameter filtering routines of Action Dispatch. This vulnerability has been assigned the CVE identifier CVE-2024-41128.

  Impact
  ------

  Carefully crafted query parameters can cause query parameter filtering to take an unexpected amount of time, possibly resulting in a DoS vulnerability. All users running an affected release should either upgrade or apply the relevant patch immediately.

  Ruby 3.2 has mitigations for this problem, so Rails applications using Ruby 3.2 or newer are unaffected. Rails 8.0.0.beta1 depends on Ruby 3.2 or greater so is unaffected.


  Releases
  --------
  The fixed releases are available at the normal locations.

  Workarounds
  -----------
  Users on Ruby 3.2 are unaffected by this issue.


  Credits
  -------

  Thanks to [scyoon](https://hackerone.com/scyoon) for the report and patches!
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=3.1.0|<6.1.7.9
    fixed_versions: vers:gem/6.1.7.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=7.0.0|<7.0.8.5
    fixed_versions: vers:gem/7.0.8.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=7.1.0|<7.1.4.1
    fixed_versions: vers:gem/7.1.4.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=7.2.0|<7.2.1.1
    fixed_versions: vers:gem/7.2.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N/E:U/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-x76w-6vjr-8xgj/GHSA-x76w-6vjr-8xgj.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
references:
  - url: https://access.redhat.com/security/cve/cve-2024-41128
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2319036
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/27121e80f6dbb260f5a9f0452cd8411cb681f075
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/b0fe99fa854ec8ff4498e75779b458392d1560ef
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/b1241f468d1b32235f438c2e2203386e6efd3891
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/fb493bebae1a9b83e494fe7edbf01f6167d606fd
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/security/advisories/GHSA-x76w-6vjr-8xgj
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-41128.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41128
    reference_type:
    reference_id: CVE-2024-41128
