advisory_id: GHSA-89qm-wcmw-3mgg
datasource_id: github_osv_importer_v2/GHSA-89qm-wcmw-3mgg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-89qm-wcmw-3mgg/GHSA-89qm-wcmw-3mgg.json
aliases:
  - CVE-2022-23509
summary: "Gitops Run insecure communication\n### Impact\nGitOps run has a local S3 bucket which\
  \ it uses for synchronising files that are later applied against a Kubernetes cluster. The\
  \ communication between GitOps Run and the local s3 bucket is not encrypted. \n\nThis allows\
  \ privileged users or process to tap the local traffic to gain information permitting access\
  \ to the s3 bucket. From that point, it would be possible to alter the bucket content, resulting\
  \ in changes in the Kubernetes cluster's resources(e.g. CVE-2022-23508).\n\n### Patches\n\
  This vulnerability has been fixed by commits [ce2bbff](https://github.com/weaveworks/weave-gitops/pull/3106/commits/ce2bbff0a3609c33396050ed544a5a21f8d0797f)\
  \ and [babd915](https://github.com/weaveworks/weave-gitops/pull/3098/commits/babd91574b99b310b84aeec9f8f895bd18acb967).\
  \ Users should upgrade to Weave GitOps version >= v0.12.0 released on 08/12/2022.\n\n### Workarounds\n\
  There is no workaround for this vulnerability.\n\n### References\nDisclosed by Paulo Gomes,\
  \ Senior Software Engineer, Weaveworks.\n\n### For more information\nIf you have any questions\
  \ or comments about this advisory:\n- Open an issue in [Weave GitOps repository](https://github.com/weaveworks/weave-gitops)\n\
  - Email us at [support@weave.works](mailto:support@weave.works)"
impacted_packages: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-89qm-wcmw-3mgg/GHSA-89qm-wcmw-3mgg.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-319
references:
  - url: https://github.com/weaveworks/weave-gitops
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/weave-gitops/pull/3098/commits/babd91574b99b310b84aeec9f8f895bd18acb967
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/weave-gitops/pull/3106/commits/ce2bbff0a3609c33396050ed544a5a21f8d0797f
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/weave-gitops/security/advisories/GHSA-89qm-wcmw-3mgg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23509
    reference_type:
    reference_id: CVE-2022-23509
