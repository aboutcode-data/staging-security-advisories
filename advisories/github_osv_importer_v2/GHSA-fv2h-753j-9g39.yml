advisory_id: GHSA-fv2h-753j-9g39
datasource_id: github_osv_importer_v2/GHSA-fv2h-753j-9g39
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-fv2h-753j-9g39/GHSA-fv2h-753j-9g39.json
aliases:
  - CVE-2023-41890
summary: |
  Sustainsys.Saml2 Insufficient Identity Provider Issuer Validation
  ### Impact
  When a response is processed, the issuer of the Identity Provider is not sufficiently validated. This could allow a malicious identity provider to craft a Saml2 response that is processed as if issued by another identity provider. It is also possible for a malicious end user to cause stored state intended for one identity provider to be used when processing the response from another provider.

  An application is impacted if they rely on any of these features in their authentication/authorization logic:
  * the issuer of the generated identity and claims
  * items in the stored request state (AuthenticationProperties)

  ### Patches
  Patched in version 2.9.2 and 1.0.3. All previous versions are vulnerable.

  ### Workarounds
  The `AcsCommandResultCreated` notification can be used to add the validation required if an upgrade to patched packages is not possible.

  ### References
  The patch is linked to https://github.com/Sustainsys/Saml2/issues/712 and https://github.com/Sustainsys/Saml2/issues/713
impacted_packages:
  - purl: pkg:nuget/Sustainsys.Saml2
    affected_versions: vers:nuget/<1.0.3
    fixed_versions: vers:nuget/1.0.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Sustainsys.Saml2
    affected_versions: vers:nuget/>=2.0.0|<2.9.2
    fixed_versions: vers:nuget/2.9.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:nuget/Kentor.AuthServices
    affected_versions: vers:nuget/<=0.23.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-fv2h-753j-9g39/GHSA-fv2h-753j-9g39.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-294
  - CWE-289
references:
  - url: https://github.com/Sustainsys/Saml2
    reference_type:
    reference_id:
  - url: https://github.com/Sustainsys/Saml2/issues/712
    reference_type:
    reference_id:
  - url: https://github.com/Sustainsys/Saml2/issues/713
    reference_type:
    reference_id:
  - url: https://github.com/Sustainsys/Saml2/security/advisories/GHSA-fv2h-753j-9g39
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41890
    reference_type:
    reference_id: CVE-2023-41890
