advisory_id: GHSA-jmvv-524f-hj5j
datasource_id: github_osv_importer_v2/GHSA-jmvv-524f-hj5j
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-jmvv-524f-hj5j/GHSA-jmvv-524f-hj5j.json
aliases:
  - CVE-2017-5664
summary: |
  Improper Handling of Exceptional Conditions in Apache Tomcat
  The error page mechanism of the Java Servlet Specification requires that, when an error occurs and an error page is configured for the error that occurred, the original request and response are forwarded to the error page. This means that the request is presented to the error page with the original HTTP method. If the error page is a static file, expected behaviour is to serve content of the file as if processing a GET request, regardless of the actual HTTP method. The Default Servlet in Apache Tomcat 9.0.0.M1 to 9.0.0.M20, 8.5.0 to 8.5.14, 8.0.0.RC1 to 8.0.43 and 7.0.0 to 7.0.77 did not do this. Depending on the original request this could lead to unexpected and undesirable results for static error pages including, if the DefaultServlet is configured to permit writes, the replacement or removal of the custom error page. Notes for other user provided error pages: (1) Unless explicitly coded otherwise, JSPs ignore the HTTP method. JSPs used as error pages must must ensure that they handle any error dispatch as a GET request, regardless of the actual method. (2) By default, the response generated by a Servlet does depend on the HTTP method. Custom Servlets used as error pages must ensure that they handle any error dispatch as a GET request, regardless of the actual method.
impacted_packages:
  - purl: pkg:maven/org.apache.tomcat/tomcat
    affected_versions: vers:maven/<=9.0.0.M20
    fixed_versions: vers:maven/9.0.0.M21
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.tomcat/tomcat
    affected_versions: vers:maven/<=8.5.14
    fixed_versions: vers:maven/8.5.15
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.tomcat/tomcat
    affected_versions: vers:maven/<=8.0.43
    fixed_versions: vers:maven/8.0.44
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.tomcat/tomcat
    affected_versions: vers:maven/<=7.0.77
    fixed_versions: vers:maven/7.0.78
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-jmvv-524f-hj5j/GHSA-jmvv-524f-hj5j.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-755
references:
  - url: https://github.com/apache/tomcat
    reference_type:
    reference_id:
  - url: https://github.com/apache/tomcat80/commit/25d3c0d93190ef165ecd6c744bc15b5059abfa8f
    reference_type:
    reference_id:
  - url: https://github.com/apache/tomcat80/commit/e070a31ec81b56377822e44883c64abb41f36a3b
    reference_type:
    reference_id:
  - url: https://github.com/apache/tomcat/commit/29893e66111d33cfe99dd01cb146317c0c262ef4
    reference_type:
    reference_id:
  - url: https://github.com/apache/tomcat/commit/3242efea525df01d15da6e90ea69a9a21b10b454
    reference_type:
    reference_id:
  - url: https://github.com/apache/tomcat/commit/3bfe9fb886598c4d8ecbe674216152006bbce456
    reference_type:
    reference_id:
  - url: https://github.com/apache/tomcat/commit/4545dcce444aa619374a659cb450dbbd0be3c921
    reference_type:
    reference_id:
  - url: https://github.com/apache/tomcat/commit/58b32048ce25cb812ae394dafb0cd57254c68155
    reference_type:
    reference_id:
  - url: https://github.com/apache/tomcat/commit/7d93527254d9e9371b342800617f20d13c8b85ad
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/1dd0a59c1295cc08ce4c9e7edae5ad2268acc9ba55adcefa0532e5ba@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/1dd0a59c1295cc08ce4c9e7edae5ad2268acc9ba55adcefa0532e5ba%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/343558d982879bf88ec20dbf707f8c11255f8e219e81d45c4f8d0551@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/343558d982879bf88ec20dbf707f8c11255f8e219e81d45c4f8d0551%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/388a323769f1dff84c9ec905455aa73fbcb20338e3c7eb131457f708@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/388a323769f1dff84c9ec905455aa73fbcb20338e3c7eb131457f708%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/3d19773b4cf0377db62d1e9328bf9160bf1819f04f988315086931d7@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/3d19773b4cf0377db62d1e9328bf9160bf1819f04f988315086931d7%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/5c0e00fd31efc11e147bf99d0f03c00a734447d3b131ab0818644cdb@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/5c0e00fd31efc11e147bf99d0f03c00a734447d3b131ab0818644cdb%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/6af47120905aa7d8fe12f42e8ff2284fb338ba141d3b77b8c7cb61b3@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/6af47120905aa7d8fe12f42e8ff2284fb338ba141d3b77b8c7cb61b3%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/845312a10aabbe2c499fca94003881d2c79fc993d85f34c1f5c77424@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/845312a10aabbe2c499fca94003881d2c79fc993d85f34c1f5c77424%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/88855876c33f2f9c532ffb75bfee570ccf0b17ffa77493745af9a17a@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/88855876c33f2f9c532ffb75bfee570ccf0b17ffa77493745af9a17a%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/a42c48e37398d76334e17089e43ccab945238b8b7896538478d76066@%3Cannounce.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/a42c48e37398d76334e17089e43ccab945238b8b7896538478d76066%40%3Cannounce.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/b5e3f51d28cd5d9b1809f56594f2cf63dcd6a90429e16ea9f83bbedc@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/b5e3f51d28cd5d9b1809f56594f2cf63dcd6a90429e16ea9f83bbedc%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/e85e83e9954f169bbb77b44baae5a33d8de878df557bb32b7f793661@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/e85e83e9954f169bbb77b44baae5a33d8de878df557bb32b7f793661%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/eb6efa8d59c45a7a9eff94c4b925467d3b3fec8ba7697f3daa314b04@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/eb6efa8d59c45a7a9eff94c4b925467d3b3fec8ba7697f3daa314b04%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r3bbb800a816d0a51eccc5a228c58736960a9fffafa581a225834d97d@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r3bbb800a816d0a51eccc5a228c58736960a9fffafa581a225834d97d%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r48c1444845fe15a823e1374674bfc297d5008a5453788099ea14caf0@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r48c1444845fe15a823e1374674bfc297d5008a5453788099ea14caf0%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r9136ff5b13e4f1941360b5a309efee2c114a14855578c3a2cbe5d19c@%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r9136ff5b13e4f1941360b5a309efee2c114a14855578c3a2cbe5d19c%40%3Cdev.tomcat.apache.org%3E
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20171019-0002
    reference_type:
    reference_id:
  - url: https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03828en_us
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20170801120345/http://www.securitytracker.com/id/1038641
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20170805032345/http://www.securityfocus.com/bid/98888
    reference_type:
    reference_id:
  - url: https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com/technetwork/security-advisory/cpujul2019-5072835.html
    reference_type:
    reference_id:
  - url: http://www.debian.org/security/2017/dsa-3891
    reference_type:
    reference_id:
  - url: http://www.debian.org/security/2017/dsa-3892
    reference_type:
    reference_id:
  - url: http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html
    reference_type:
    reference_id:
  - url: http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html
    reference_type:
    reference_id:
  - url: http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html
    reference_type:
    reference_id:
  - url: http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-5664
    reference_type:
    reference_id: CVE-2017-5664
  - url: https://access.redhat.com/errata/RHSA-2017:1801
    reference_type:
    reference_id: RHSA-2017:1801
  - url: https://access.redhat.com/errata/RHSA-2017:1802
    reference_type:
    reference_id: RHSA-2017:1802
  - url: https://access.redhat.com/errata/RHSA-2017:1809
    reference_type:
    reference_id: RHSA-2017:1809
  - url: https://access.redhat.com/errata/RHSA-2017:2493
    reference_type:
    reference_id: RHSA-2017:2493
  - url: https://access.redhat.com/errata/RHSA-2017:2494
    reference_type:
    reference_id: RHSA-2017:2494
  - url: https://access.redhat.com/errata/RHSA-2017:2633
    reference_type:
    reference_id: RHSA-2017:2633
  - url: https://access.redhat.com/errata/RHSA-2017:2635
    reference_type:
    reference_id: RHSA-2017:2635
  - url: https://access.redhat.com/errata/RHSA-2017:2636
    reference_type:
    reference_id: RHSA-2017:2636
  - url: https://access.redhat.com/errata/RHSA-2017:2637
    reference_type:
    reference_id: RHSA-2017:2637
  - url: https://access.redhat.com/errata/RHSA-2017:2638
    reference_type:
    reference_id: RHSA-2017:2638
  - url: https://access.redhat.com/errata/RHSA-2017:3080
    reference_type:
    reference_id: RHSA-2017:3080
