advisory_id: GHSA-r5fj-j449-vqw2
datasource_id: github_osv_importer_v2/GHSA-r5fj-j449-vqw2
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-r5fj-j449-vqw2/GHSA-r5fj-j449-vqw2.json
aliases:
  - CVE-2022-42120
summary: |
  Liferay Portal and Liferay DXP Vulnerable to SQL Injection via the Fragment Module
  A SQL injection vulnerability in the Fragment module before 4.0.33 from Liferay Portal (7.3.3 through 7.4.3.16), and Liferay DXP 7.3 before update 4, and 7.4 before update 17 allows attackers to execute arbitrary SQL commands via a PortletPreferences' `namespace` attribute.
impacted_packages:
  - purl: pkg:maven/com.liferay/com.liferay.fragment.service
    affected_versions: vers:maven/<4.0.33
    fixed_versions: vers:maven/4.0.33
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.liferay.portal/release.dxp.bom
    affected_versions: vers:maven/>=7.3.0|<7.3.10.u4
    fixed_versions: vers:maven/7.3.10.u4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.liferay.portal/release.dxp.bom
    affected_versions: vers:maven/>=7.4.0|<7.4.13.u17
    fixed_versions: vers:maven/7.4.13.u17
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/11/GHSA-r5fj-j449-vqw2/GHSA-r5fj-j449-vqw2.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: http://liferay.com
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal/commit/6f94d203f5a194a64055e1e0ba0224d26ec54e47
    reference_type:
    reference_id:
  - url: https://issues.liferay.com/browse/LPE-17513
    reference_type:
    reference_id:
  - url: https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/cve-2022-42120
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20220801000000*/https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/cve-2022-42120
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-42120
    reference_type:
    reference_id: CVE-2022-42120
