advisory_id: GHSA-q4v7-4rhw-9hqm
datasource_id: github_osv_importer_v2/GHSA-q4v7-4rhw-9hqm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/07/GHSA-q4v7-4rhw-9hqm/GHSA-q4v7-4rhw-9hqm.json
aliases:
  - CVE-2017-5941
summary: |
  Code Execution through IIFE in node-serialize
  Affected versions of `node-serialize` can be abused to execute arbitrary code via an [immediately invoked function expression](https://en.wikipedia.org/wiki/Immediately-invoked_function_expression) (IIFE) if untrusted user input is passed into `unserialize()`.


  ## Recommendation

  There is no direct patch for this issue. The package author has reviewed this advisory, and provided the following recommendation:

  ```
  To avoid the security issues, at least one of the following methods should be taken:

  1. Make sure to send serialized strings internally, isolating them from potential hackers. For example, only sending the strings from backend to fronend and always using HTTPS instead of HTTP.

  2. Introduce public-key cryptosystems (e.g. RSA) to ensure the strings not being tampered with.
  ```
impacted_packages:
  - purl: pkg:npm/node-serialize
    affected_versions: vers:npm/<=0.0.4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2018/07/GHSA-q4v7-4rhw-9hqm/GHSA-q4v7-4rhw-9hqm.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: http://packetstormsecurity.com/files/161356/Node.JS-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: http://packetstormsecurity.com/files/163222/Node.JS-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-q4v7-4rhw-9hqm
    reference_type:
    reference_id:
  - url: https://github.com/luin/serialize/issues/4
    reference_type:
    reference_id:
  - url: https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/311
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/96225
    reference_type:
    reference_id:
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/linux/remote/45265.js
    reference_type: exploit
    reference_id: CVE-2017-5941
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/nodejs/webapps/49552.py
    reference_type: exploit
    reference_id: CVE-2017-5941
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/nodejs/webapps/50036.js
    reference_type: exploit
    reference_id: CVE-2017-5941
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-5941
    reference_type:
    reference_id: CVE-2017-5941
