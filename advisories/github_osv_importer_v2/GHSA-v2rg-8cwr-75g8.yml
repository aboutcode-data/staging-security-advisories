advisory_id: GHSA-v2rg-8cwr-75g8
datasource_id: github_osv_importer_v2/GHSA-v2rg-8cwr-75g8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-v2rg-8cwr-75g8/GHSA-v2rg-8cwr-75g8.json
aliases:
  - CVE-2021-25641
summary: |
  Deserializer tampering in Apache Dubbo
  Each Apache Dubbo server will set a serialization id to tell the clients which serialization protocol it is working on. But for Dubbo versions before 2.7.8 or 2.6.9, an attacker can choose which serialization id the Provider will use by tampering with the byte preamble flags, aka, not following the server's instruction. This means that if a weak deserializer such as the Kryo and FST are somehow in code scope (e.g. if Kryo is somehow a part of a dependency), a remote unauthenticated attacker can tell the Provider to use the weak deserializer, and then proceed to exploit it.
impacted_packages:
  - purl: pkg:maven/org.apache.dubbo/dubbo
    affected_versions: vers:maven/>=2.5.0|<2.7.8
    fixed_versions: vers:maven/2.7.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/com.alibaba/dubbo
    affected_versions: vers:maven/>=2.5.0|<2.6.9
    fixed_versions: vers:maven/2.6.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/03/GHSA-v2rg-8cwr-75g8/GHSA-v2rg-8cwr-75g8.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: https://lists.apache.org/thread.html/r99ef7fa35585d3a68762de07e8d2b2bc48b8fa669a03e8d84b9673f3%40%3Cdev.dubbo.apache.org%3E
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-25641
    reference_type:
    reference_id: CVE-2021-25641
