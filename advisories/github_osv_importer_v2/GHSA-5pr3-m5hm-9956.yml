advisory_id: GHSA-5pr3-m5hm-9956
datasource_id: github_osv_importer_v2/GHSA-5pr3-m5hm-9956
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-5pr3-m5hm-9956/GHSA-5pr3-m5hm-9956.json
aliases:
  - CVE-2023-43795
summary: |
  WPS Server Side Request Forgery vulnerability
  ### Summary

  The OGC Web Processing Service (WPS) specification is designed to process information from any server using GET and POST requests.

  This presents the opportunity for Server Side Request Forgery.

  ## Details

  This vulnerability requires:

  * The WPS extension to be installed
  * The WPS security setting "Disable complex inputs" to be unselected
  * Security URL checks to be disabled

  ### Impact

  This vulnerability presents the opportunity for Server Side Request Forgery.

  ### Mitigation

  The ability to reference an external URL location is defined by the WPS standard Execute operation. This operations is defined by an Industry and International standard and cannot be redefined by the GeoServer application in isolation.

  To disable complex remote inputs on GeoServer 2.20.5 and GeoServer 2.21.0:

  1.  Navigate to **Security > WPS Security** page
  2. Locate **Complex Inputs** heading
  3. Select the check box for **Disable loading complex inputs from remote references**

  ### Resolution

  To allow processing of complex inputs safely in GeoServer 2.22.5 and GeoServer 2.23.2:

  1. Navigate to **Security > URL Checks**
  2. Enable **URL Checks** are enabled setting
  3. Check the user manual for [examples](https://docs.geoserver.org/latest/en/user/security/urlchecks.html#example-regex-patterns) of how to trust specific locations for your external services.

  Processing of complex inputs safely is on by default in GeoServer 2.24.0.

  ### References

  * [Complex Inputs](https://docs.geoserver.org/stable/en/user/services/wps/security.html#complex-inputs)
  * [URL Checks](https://docs.geoserver.org/latest/en/user/security/urlchecks.html)
impacted_packages:
  - purl: pkg:maven/org.geoserver.extension/gs-wps-core
    affected_versions: vers:maven/<2.22.5
    fixed_versions: vers:maven/2.22.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.geoserver.extension/gs-wps-core
    affected_versions: vers:maven/>=2.23.0|<2.23.2
    fixed_versions: vers:maven/2.23.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-5pr3-m5hm-9956/GHSA-5pr3-m5hm-9956.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-918
references:
  - url: https://docs.geoserver.org/latest/en/user/security/urlchecks.html
    reference_type:
    reference_id:
  - url: https://docs.geoserver.org/stable/en/user/services/wps/security.html#complex-inputs
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/security/advisories/GHSA-5pr3-m5hm-9956
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-43795
    reference_type:
    reference_id: CVE-2023-43795
