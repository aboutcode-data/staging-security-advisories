advisory_id: GHSA-gjcg-vrxg-xmgv
datasource_id: github_osv_importer_v2/GHSA-gjcg-vrxg-xmgv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-gjcg-vrxg-xmgv/GHSA-gjcg-vrxg-xmgv.json
aliases:
  - CVE-2021-39162
summary: "Incorrect handling of H2 GOAWAY + SETTINGS frames\nEnvoy, which Pomerium is based\
  \ on, can abnormally terminate if an H/2 GOAWAY and SETTINGS frame are received in the same\
  \ IO event.  \n\n### Impact\nThis can lead to a DoS in the presence of untrusted *upstream*\
  \ servers.\n\n### Patches\n0.15.1 contains an upgraded envoy binary with this vulnerability\
  \ patched.\n\n### Workarounds\nIf only trusted upstreams are configured, there is not substantial\
  \ risk of this condition being triggered.\n\n### References\n[envoy GSA](https://github.com/envoyproxy/envoy/security/advisories/GHSA-j374-mjrw-vvp8)\n\
  [envoy CVE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-32780)\n[envoy announcement](https://groups.google.com/g/envoy-announce/c/5xBpsEZZDfE/m/wD05NZBbAgAJ)\n\
  \n### For more information\nIf you have any questions or comments about this advisory:\n*\
  \ Open an issue in [pomerium/pomerium](https://github.com/pomerium/pomerium/issues)\n* Email\
  \ us at [security@pomerium.com](mailto:security@pomerium.com)"
impacted_packages: []
severities:
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/09/GHSA-gjcg-vrxg-xmgv/GHSA-gjcg-vrxg-xmgv.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-754
references:
  - url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-j374-mjrw-vvp8
    reference_type:
    reference_id:
  - url: https://github.com/pomerium/pomerium
    reference_type:
    reference_id:
  - url: https://github.com/pomerium/pomerium/security/advisories/GHSA-gjcg-vrxg-xmgv
    reference_type:
    reference_id:
  - url: https://groups.google.com/g/envoy-announce/c/5xBpsEZZDfE/m/wD05NZBbAgAJ
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39162
    reference_type:
    reference_id: CVE-2021-39162
