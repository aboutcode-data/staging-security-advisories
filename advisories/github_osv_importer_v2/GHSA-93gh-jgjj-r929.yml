advisory_id: GHSA-93gh-jgjj-r929
datasource_id: github_osv_importer_v2/GHSA-93gh-jgjj-r929
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-93gh-jgjj-r929/GHSA-93gh-jgjj-r929.json
aliases:
  - CVE-2023-45137
summary: "XWiki Platform vulnerable to XSS with edit right in the create document form for existing\
  \ pages\n### Impact\nWhen trying to create a document that already exists, XWiki displays\
  \ an error message in the form for creating it. Due to missing escaping, this error message\
  \ is vulnerable to raw HTML injection and thus XSS. The injected code is the document reference\
  \ of the existing document so this requires that the attacker first creates a non-empty document\
  \ whose name contains the attack code. \n\nTo reproduce, the following steps can be used:\n\
  \n1. Go to `<xwiki-host>/xwiki/bin/create/Main/WebHome?parent=&templateprovider=&spaceReference=&name=%3Cimg%20onerror=%22alert(1)%22%20src=%22test%22`\
  \ where `<xwiki-host>` is the URL of your XWiki installation.\n2. Create the page and add\
  \ some content.\n3. Go again to `<xwiki-host>/xwiki/bin/create/Main/WebHome?parent=&templateprovider=&spaceReference=&name=%3Cimg%20onerror=%22alert(1)%22%20src=%22test%22`\
  \ where `<xwiki-host>` is the URL of your XWiki installation.\n\nIf an alert with content\
  \ \"1\" is displayed, the installation is vulnerable. This allows an attacker to execute arbitrary\
  \ actions with the rights of the user opening the malicious link. Depending on the rights\
  \ of the user, this may allow remote code execution and full read and write access to the\
  \ whole XWiki installation.\n\n### Patches\nThis has been patched in XWiki 14.10.12 and 15.5RC1\
  \ by adding the appropriate escaping.\n\n### Workarounds\nThe vulnerable template file createinline.vm\
  \ is part of XWiki's WAR and can be patched by manually applying the [changes from the fix](https://github.com/xwiki/xwiki-platform/commit/ed8ec747967f8a16434806e727a57214a8843581#diff-c222148bddebe4ff7629350f4053b618504a4ab172e697938c8fddf7c1fc6bc8)."
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/<14.10.12
    fixed_versions: vers:maven/14.10.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-templates
    affected_versions: vers:maven/>=15.0-rc-1|<15.5-rc-1
    fixed_versions: vers:maven/15.5-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web
    affected_versions: vers:maven/>=3.1-milestone-2|<13.4-rc-1
    fixed_versions: vers:maven/13.4-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-93gh-jgjj-r929/GHSA-93gh-jgjj-r929.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/ed8ec747967f8a16434806e727a57214a8843581
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-93gh-jgjj-r929
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20961
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-45137
    reference_type:
    reference_id: CVE-2023-45137
