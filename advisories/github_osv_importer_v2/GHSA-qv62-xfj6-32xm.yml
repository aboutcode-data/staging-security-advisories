advisory_id: GHSA-qv62-xfj6-32xm
datasource_id: github_osv_importer_v2/GHSA-qv62-xfj6-32xm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-qv62-xfj6-32xm/GHSA-qv62-xfj6-32xm.json
aliases:
  - CVE-2015-4020
summary: |
  RubyGems Improper Input Validation vulnerability
  RubyGems 2.0.x before 2.0.17, 2.2.x before 2.2.5, and 2.3.x before 2.4.8 does not validate the hostname when fetching gems or making API requests, which allows remote attackers to redirect requests to arbitrary domains via a crafted DNS SRV record with a domain that is suffixed with the original domain name, aka a "DNS hijack attack."

  NOTE: this vulnerability exists because of an incomplete fix for CVE-2015-3900.
impacted_packages:
  - purl: pkg:gem/rubygems-update
    affected_versions: vers:gem/<2.0.17
    fixed_versions: vers:gem/2.0.17
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rubygems-update
    affected_versions: vers:gem/>=2.1.0.rc.1|<2.2.5
    fixed_versions: vers:gem/2.2.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rubygems-update
    affected_versions: vers:gem/>=2.3.0|<2.4.8
    fixed_versions: vers:gem/2.4.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: http://blog.rubygems.org/2015/06/08/2.2.5-released.html
    reference_type:
    reference_id:
  - url: http://blog.rubygems.org/2015/06/08/2.4.8-released.html
    reference_type:
    reference_id:
  - url: https://github.com/rubygems/rubygems
    reference_type:
    reference_id:
  - url: https://github.com/rubygems/rubygems/commit/5c7bfb5
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rubygems-update/CVE-2015-4020.yml
    reference_type:
    reference_id:
  - url: https://puppet.com/security/cve/CVE-2015-3900
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20200228084212/http://www.securityfocus.com/bid/75431
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20200228085830/https://puppet.com/security/cve/CVE-2015-3900
    reference_type:
    reference_id:
  - url: https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2015-009/?fid=6478
    reference_type:
    reference_id:
  - url: https://www.trustwave.com/Resources/SpiderLabs-Blog/Attacking-Ruby-Gem-Security-with-CVE-2015-3900
    reference_type:
    reference_id:
  - url: http://www.oracle.com/technetwork/topics/security/bulletinoct2015-2511968.html
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/75431
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2015-4020
    reference_type:
    reference_id: CVE-2015-4020
