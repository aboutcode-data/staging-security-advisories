advisory_id: GHSA-xx7m-69ff-9crp
datasource_id: github_osv_importer_v2/GHSA-xx7m-69ff-9crp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-xx7m-69ff-9crp/GHSA-xx7m-69ff-9crp.json
aliases: []
summary: "SurrealDB vulnerable to Denial of Service through scripting function memory edge case\n\
  In SurrealDB instances with the scripting capability enabled (`--allow-scripting`),  users\
  \ with the ability to run arbitrary queries can trigger a server crash due to a memory-safety\
  \ bug in the underlying JS engine. The SurrealDB instance terminates instantly, requiring\
  \ a manual restart.\n\nThe query consists of using built-in string functions to construct\
  \ a large string and passing it to the JavaScript runtime for compilation. The exact string\
  \ size required to trigger the crash varies between SurrealDB versions.\n\nWhilst exploiting\
  \ the vulnerability requires users to be able to run arbitrary queries, if guest access (`--allow-guests`),\
  \ is enabled, then guests can perform this attack.\n\n### Impact\n\nAny user able to execute\
  \ queries on a SurrealDB instance with scripting enabled (`--allow-scripting`) can cause complete\
  \ denial of service. The server process terminates immediately without graceful shutdown.\n\
  \nThe underlying cause of the vulnerability is a null pointer dereference in the `QuickJS-NG`\
  \ v0.8 JavaScript engine, this vulnerability cannot be exploited to execute arbitrary code,\
  \ or compromise the integrity or confidentiality of data. \n\n### Patches\n\nVersions prior\
  \ to SurrealDB `v2.6.1` and `v3.0.0-beta.3` are vulnerable.\n\nThe patches for SurrealDB `v2.6.1`\
  \ and `v3.0.0-beta.3` update the `rquickjs` dependency from `v0.9.0` to `v0.11.0`, which in\
  \ turn uses an updated version of `QuickJS-NG`.\n\n### Workarounds\nDeny execution of embedded\
  \ scripting functions through the configuration of [capabilities](https://surrealdb.com/docs/surrealdb/security/capabilities#capabilities)\
  \ by starting SurrealDB with the `--deny-scripting` flag or the equivalent environment variable\
  \ `SURREAL_CAPS_DENY_SCRIPT=true`. This has a usability implication, although scripting functions\
  \ are disabled by default.\n\nAdministrators can also use `--deny-arbitrary-query`  to deny\
  \ arbitrary querying by either `guest`, `record` or `system` users, or a combination of those,\
  \ with impacts to functionality for those users. \n\n### Links ###\n[SurrealDB Documentation\
  \ - Capabilities](https://surrealdb.com/docs/surrealdb/security/capabilities)\n[SurrealDB\
  \ Documentation - Guest Access](https://surrealdb.com/docs/surrealdb/security/capabilities#guest-access)\n\
  [SurrealQL Documentation - Scripting Functions](https://surrealdb.com/docs/surrealql/functions/script)\n\
  [quickjs-ng v0.9 Release Notes](https://github.com/quickjs-ng/quickjs/releases/tag/v0.9.0)\n\
  https://github.com/surrealdb/surrealdb/pull/6833\nhttps://github.com/surrealdb/surrealdb/pull/6774"
impacted_packages: []
severities:
  - score: '6.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-xx7m-69ff-9crp/GHSA-xx7m-69ff-9crp.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-476
references:
  - url: https://github.com/surrealdb/surrealdb
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/commit/2b0389b92398d9ecff4632cd51bbf8303832a988
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/commit/bcd2ece9ef0d721215f06a47280698669f332285
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/pull/6774
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/pull/6833
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-xx7m-69ff-9crp
    reference_type:
    reference_id:
