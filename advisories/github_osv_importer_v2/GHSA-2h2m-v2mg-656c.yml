advisory_id: GHSA-2h2m-v2mg-656c
datasource_id: github_osv_importer_v2/GHSA-2h2m-v2mg-656c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-2h2m-v2mg-656c/GHSA-2h2m-v2mg-656c.json
aliases:
  - CVE-2026-25484
summary: |
  Craft Commerce has Stored XSS in Product Type Name
  ## Summary

  Stored XSS via Product Type names. The name is not sanitized when displayed in user permissions settings.

  The vulnerable input (source) is in Commerce (Product Type settings), but the sink is in CMS user permissions settings. Reporting to Commerce GHSA since the input originates here.

  Users are recommended to update to the patched 5.5.2 release to mitigate the issue.

  ---
  ## Proof of Concept

  ### Required Permissions (Attacker)

  - Admin access (to edit Commerce settings)

  ### Steps to Reproduce

  1. Log in as attacker with admin permissions.
  2. Go to **Commerce** -> **Settings** -> **Product Types** (`/admin/commerce/settings/producttypes`).
  3. Create a new Product Type.
  4. Set **Name** to:
  ```html
  <img src=x onerror="alert('XSS-ProductType')" hidden>
  ```
  5. Save the Product Type.
  6. Go to **Users** -> Edit any user -> Click on **Permissions** tab (`/admin/users/{UserID}/permissions`).
  7. Alert fires instantly (when the Product Type checkbox renders).

  ## Resources

  https://github.com/craftcms/commerce/commit/7e1dedf06038c8e70dce0187b7048d4ab8ffb75c
impacted_packages:
  - purl: pkg:composer/craftcms/commerce
    affected_versions: vers:composer/<=5.5.1
    fixed_versions: vers:composer/5.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/craftcms/commerce
    affected_versions: vers:composer/<=4.10.0
    fixed_versions: vers:composer/4.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-2h2m-v2mg-656c/GHSA-2h2m-v2mg-656c.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/craftcms/commerce
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/commerce/commit/7e1dedf06038c8e70dce0187b7048d4ab8ffb75c
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/commerce/releases/tag/4.10.1
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/commerce/releases/tag/5.5.2
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/commerce/security/advisories/GHSA-2h2m-v2mg-656c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-25484
    reference_type:
    reference_id:
