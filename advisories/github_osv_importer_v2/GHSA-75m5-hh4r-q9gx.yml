advisory_id: GHSA-75m5-hh4r-q9gx
datasource_id: github_osv_importer_v2/GHSA-75m5-hh4r-q9gx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-75m5-hh4r-q9gx/GHSA-75m5-hh4r-q9gx.json
aliases:
  - CVE-2024-23634
summary: |
  GeoServer Arbitrary file renaming vulnerability in REST Coverage/Data Store API
  ### Summary
  An arbitrary file renaming vulnerability exists that enables an authenticated administrator with permissions to modify stores through the REST Coverage Store or Data Store API to rename arbitrary files and directories with a name that does not end in ".zip".

  ### Details
  Store file uploads rename zip files to have a ".zip" extension if it doesn't already have one before unzipping the file.  This is fine for file and url upload methods where the files will be in a specific subdirectory of the data directory but, when using the external upload method, this allows arbitrary files and directories to be renamed.

  ### PoC
  Coverage Store Example (workspace and store name are irrelevant and any valid coverage format can be used):
  curl -XPUT -H"Content-Type:application/zip" -u"admin:geoserver" -d"/file/to/move" "http://localhost:8080/geoserver/rest/workspaces/a/coveragestores/b/external.geotiff"
  Data Store Example (workspace and store name and data store format are irrelevant):
  curl -XPUT -H"Content-Type:application/zip" -u"admin:geoserver" -d"/file/to/move" "http://localhost:8080/geoserver/rest/workspaces/a/datastores/b/external.c"

  ### Impact
  Renaming GeoServer files will most likely result in a denial of service, either completely preventing GeoServer from running or effectively deleting specific resources (such as a workspace, layer or style).  In some cases, renaming GeoServer files could revert to the default settings for that file which could be relatively harmless like removing contact information or have more serious consequences like allowing users to make OGC requests that the customized settings would have prevented them from making.  The impact of renaming non-GeoServer files depends on the specific environment although some sort of denial of service is a likely outcome.

  ### References
  https://osgeo-org.atlassian.net/browse/GEOS-11213
  https://github.com/geoserver/geoserver/pull/7289
impacted_packages:
  - purl: pkg:maven/org.geoserver/gs-restconfig
    affected_versions: vers:maven/<2.23.5
    fixed_versions: vers:maven/2.23.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.geoserver/gs-restconfig
    affected_versions: vers:maven/>=2.24.0|<2.24.2
    fixed_versions: vers:maven/2.24.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-75m5-hh4r-q9gx/GHSA-75m5-hh4r-q9gx.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-73
references:
  - url: https://github.com/geoserver/geoserver
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/commit/5d6af2f8ba9ad7dffae59575504a867159698772
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/commit/c37f58fbacdfa0d581a6f99195585f70b1201f0a
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/pull/7289
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/security/advisories/GHSA-75m5-hh4r-q9gx
    reference_type:
    reference_id:
  - url: https://osgeo-org.atlassian.net/browse/GEOS-11213
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23634
    reference_type:
    reference_id: CVE-2024-23634
