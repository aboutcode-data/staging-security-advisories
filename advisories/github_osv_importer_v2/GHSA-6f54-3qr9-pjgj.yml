advisory_id: GHSA-6f54-3qr9-pjgj
datasource_id: github_osv_importer_v2/GHSA-6f54-3qr9-pjgj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-6f54-3qr9-pjgj/GHSA-6f54-3qr9-pjgj.json
aliases:
  - CVE-2020-5228
summary: |
  Unauthenticated Access Via OAI-PMH
  ### Impact

  Media publication via OAI-PMH allows unauthenticated public access to all media and metadata by default. OAI-PMH is part of the default workflow and is activated by default, requiring active user intervention of users to protect media. This leads to users unknowingly handing out public access to events without their knowledge.


  ### Patches

  The problem has been addressed in Opencast 7.6 and 8.1 where the OAI-PMH endpoint is configured to require users with `ROLE_ADMIN` by default. In addition to this, Opencast 9 removes the OAI-PMH publication from the default workflow, making the publication a conscious decision users have to make by updating their workflows.

  ### Workarounds

  In the organization security configuration (`etc/security/mh_default_org.xml`), change the roles required for accessing `/oaipmh` from `ROLE_ANONYMOUS` to `ROLE_ADMIN`.

  ### References

  - [Public access configuration in the organization's security configuration](https://github.com/opencast/opencast/blob/1fb812c7810c78f09f29a7f455ff920417924307/etc/security/mh_default_org.xml#L271-L276)

  ### For more information

  If you have any questions or comments about this advisory:

  - Open an issue in [opencast/opencast](https://github.com/opencast/opencast/issues)
  - For security-relevant information, email us at security@opencast.org
impacted_packages:
  - purl: pkg:maven/org.opencastproject/opencast-oaipmh-api
    affected_versions: vers:maven/<7.6
    fixed_versions: vers:maven/7.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.opencastproject/opencast-oaipmh-api
    affected_versions: vers:maven/>=8.0|<8.1
    fixed_versions: vers:maven/8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/01/GHSA-6f54-3qr9-pjgj/GHSA-6f54-3qr9-pjgj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/opencast/opencast/blob/1fb812c7810c78f09f29a7f455ff920417924307/etc/security/mh_default_org.xml#L271-L276
    reference_type:
    reference_id:
  - url: https://github.com/opencast/opencast/security/advisories/GHSA-6f54-3qr9-pjgj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5228
    reference_type:
    reference_id: CVE-2020-5228
