advisory_id: GHSA-4w5x-x539-ppf5
datasource_id: github_osv_importer_v2/GHSA-4w5x-x539-ppf5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-4w5x-x539-ppf5/GHSA-4w5x-x539-ppf5.json
aliases:
  - CVE-2020-26892
summary: |
  Incorrect handling of credential expiry by /nats-io/nats-server
  ## Problem Description

  NATS nats-server through 2020-10-07 has Incorrect Access Control because of how expired credentials are handled.

  The NATS accounts system has expiration timestamps on credentials; the <https://github.com/nats-io/jwt> library had an API which encouraged misuse and an `IsRevoked()` method which misused its own API.

  A new `IsClaimRevoked()` method has correct handling and the nats-server has been updated to use this.  The old `IsRevoked()` method now always returns true and other client code will have to be updated to avoid calling it.

  The CVE identifier should cover any application using the old JWT API, where the nats-server is one of those applications.


  ## Affected versions

  #### JWT library

   * all versions prior to 1.1.0
   * fixed after nats-io/jwt PR 103 landed (2020-10-06)

  #### NATS Server

   * Version 2 prior to 2.1.9
     + 2.0.0 through and including 2.1.8 are vulnerable.
   * fixed with nats-io/nats-server PRs 1632, 1635, 1645


  ## Impact

  Time-based credential expiry did not work.


  ## Workaround

  Have credentials which only expire after fixes can be deployed.


  ## Solution

  Upgrade the JWT dependency in any application using it.

  Upgrade the NATS server if using NATS Accounts.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-4w5x-x539-ppf5/GHSA-4w5x-x539-ppf5.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-798
references:
  - url: https://advisories.nats.io/CVE/CVE-2020-26892.txt
    reference_type:
    reference_id:
  - url: https://github.com/nats-io/jwt
    reference_type:
    reference_id:
  - url: https://github.com/nats-io/jwt/commit/e11ce317263cef69619fc1ca743b195d02aa1d8a
    reference_type:
    reference_id:
  - url: https://github.com/nats-io/jwt/security/advisories/GHSA-4w5x-x539-ppf5
    reference_type:
    reference_id:
  - url: https://github.com/nats-io/nats-server/commit/1e08b67f08e18cd844dce833a265aaa72500a12f
    reference_type:
    reference_id:
  - url: https://github.com/nats-io/nats-server/commits/master
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VT67XCLIIBYRT762SVFBYFFTQFVSM3SI
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-0380
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2020/11/02/2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-26892
    reference_type:
    reference_id: CVE-2020-26892
