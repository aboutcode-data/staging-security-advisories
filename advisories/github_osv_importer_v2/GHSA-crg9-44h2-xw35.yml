advisory_id: GHSA-crg9-44h2-xw35
datasource_id: github_osv_importer_v2/GHSA-crg9-44h2-xw35
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-crg9-44h2-xw35/GHSA-crg9-44h2-xw35.json
aliases:
  - CVE-2023-46604
summary: |
  Apache ActiveMQ is vulnerable to Remote Code Execution.The vulnerability may allow a remote attacker with network access to a broker to run arbitrary shell commands by manipulating serialized class types in the OpenWire protocol to cause the broker to instantiate any class on the classpath. 

  Users are recommended to upgrade to version 5.15.16, 5.16.7, 5.17.6, or 5.18.3, which fixes this issue.
impacted_packages:
  - purl: pkg:maven/org.apache.activemq/activemq-client
    affected_versions: vers:maven/<5.15.16
    fixed_versions: vers:maven/5.15.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.activemq/activemq-client
    affected_versions: vers:maven/>=5.16.0|<5.16.7
    fixed_versions: vers:maven/5.16.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.activemq/activemq-client
    affected_versions: vers:maven/>=5.17.0|<5.17.6
    fixed_versions: vers:maven/5.17.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.activemq/activemq-client
    affected_versions: vers:maven/>=5.18.0|<5.18.3
    fixed_versions: vers:maven/5.18.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.activemq/activemq-openwire-legacy
    affected_versions: vers:maven/>=5.8.0|<5.15.16
    fixed_versions: vers:maven/5.15.16
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.activemq/activemq-openwire-legacy
    affected_versions: vers:maven/>=5.16.0|<5.16.7
    fixed_versions: vers:maven/5.16.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.activemq/activemq-openwire-legacy
    affected_versions: vers:maven/>=5.17.0|<5.17.6
    fixed_versions: vers:maven/5.17.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.activemq/activemq-openwire-legacy
    affected_versions: vers:maven/>=5.18.0|<5.18.3
    fixed_versions: vers:maven/5.18.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:H/A:H/E:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-crg9-44h2-xw35/GHSA-crg9-44h2-xw35.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-502
references:
  - url: http://packetstormsecurity.com/files/175676/Apache-ActiveMQ-Unauthenticated-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: https://activemq.apache.org/security-advisories.data/CVE-2023-46604
    reference_type:
    reference_id:
  - url: https://activemq.apache.org/security-advisories.data/CVE-2023-46604-announcement.txt
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2024/Apr/18
    reference_type:
    reference_id:
  - url: https://github.com/apache/activemq
    reference_type:
    reference_id:
  - url: https://github.com/apache/activemq/commit/22442b2385b1000312aec3d19e510131d595a5fc
    reference_type:
    reference_id:
  - url: https://github.com/apache/activemq/commit/80089f9f476afab7d976f5fc37c5ab4aa0c2139d
    reference_type:
    reference_id:
  - url: https://github.com/apache/activemq/commit/958330df26cf3d5cdb63905dc2c6882e98781d8f
    reference_type:
    reference_id:
  - url: https://github.com/apache/activemq/commit/9905e2a5bf9862a049f94ce0a2465b0c7ad52436
    reference_type:
    reference_id:
  - url: https://github.com/apache/activemq/commit/d0ccdd31544ada83185554c87c7aa141064020f0
    reference_type:
    reference_id:
  - url: https://github.com/apache/activemq/pull/1098
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/AMQ-9370
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/11/msg00013.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/10/msg00027.html
    reference_type:
    reference_id:
  - url: https://packetstormsecurity.com/files/175676/Apache-ActiveMQ-Unauthenticated-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20231110-0010
    reference_type:
    reference_id:
  - url: https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2023-46604
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2023/10/27/5
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/10/27/5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-46604
    reference_type:
    reference_id: CVE-2023-46604
