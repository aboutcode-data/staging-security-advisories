advisory_id: GHSA-rggv-cv7r-mw98
datasource_id: github_osv_importer_v2/GHSA-rggv-cv7r-mw98
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-rggv-cv7r-mw98/GHSA-rggv-cv7r-mw98.json
aliases:
  - CVE-2024-22201
summary: |
  Connection leaking on idle timeout when TCP congested
  ### Impact
  If an HTTP/2 connection gets TCP congested, when an idle timeout occurs the HTTP/2 session is marked as closed, and then a GOAWAY frame is queued to be written.
  However it is not written because the connection is TCP congested.
  When another idle timeout period elapses, it is then supposed to hard close the connection, but it delegates to the HTTP/2 session which reports that it has already been closed so it does not attempt to hard close the connection.

  This leaves the connection in ESTABLISHED state (i.e. not closed), TCP congested, and idle.

  An attacker can cause many connections to end up in this state, and the server may run out of file descriptors, eventually causing the server to stop accepting new connections from valid clients.

  The client may also be impacted (if the server does not read causing a TCP congestion), but the issue is more severe for servers.

  ### Patches
  Patched versions:
  * 9.4.54
  * 10.0.20
  * 11.0.20
  * 12.0.6

  ### Workarounds
  Disable HTTP/2 and HTTP/3 support until you can upgrade to a patched version of Jetty.
  HTTP/1.x is not affected.

  ### References
  * https://github.com/jetty/jetty.project/issues/11256.
impacted_packages:
  - purl: pkg:maven/org.eclipse.jetty.http2/http2-common
    affected_versions: vers:maven/<=9.4.53
    fixed_versions: vers:maven/9.4.54
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty.http2/http2-common
    affected_versions: vers:maven/<=10.0.19
    fixed_versions: vers:maven/10.0.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty.http3/http3-common
    affected_versions: vers:maven/<=10.0.19
    fixed_versions: vers:maven/10.0.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty.http2/http2-common
    affected_versions: vers:maven/<=11.0.19
    fixed_versions: vers:maven/11.0.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty.http3/http3-common
    affected_versions: vers:maven/<=11.0.19
    fixed_versions: vers:maven/11.0.20
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty.http2/jetty-http2-common
    affected_versions: vers:maven/<=12.0.5
    fixed_versions: vers:maven/12.0.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty.http3/jetty-http3-common
    affected_versions: vers:maven/<=12.0.5
    fixed_versions: vers:maven/12.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/02/GHSA-rggv-cv7r-mw98/GHSA-rggv-cv7r-mw98.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
  - CWE-400
references:
  - url: https://github.com/jetty/jetty.project
    reference_type:
    reference_id:
  - url: https://github.com/jetty/jetty.project/commit/0839a208cdc3fcfe25206a77af59ba9fda260188
    reference_type:
    reference_id:
  - url: https://github.com/jetty/jetty.project/commit/b953871c9a5ff4fbca4a2499848f75182dbd9810
    reference_type:
    reference_id:
  - url: https://github.com/jetty/jetty.project/issues/11256
    reference_type:
    reference_id:
  - url: https://github.com/jetty/jetty.project/issues/11259
    reference_type:
    reference_id:
  - url: https://github.com/jetty/jetty.project/security/advisories/GHSA-rggv-cv7r-mw98
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/04/msg00002.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240329-0001
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/03/20/2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22201
    reference_type:
    reference_id: CVE-2024-22201
