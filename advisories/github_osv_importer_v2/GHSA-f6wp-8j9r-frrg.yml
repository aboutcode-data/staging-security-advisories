advisory_id: GHSA-f6wp-8j9r-frrg
datasource_id: github_osv_importer_v2/GHSA-f6wp-8j9r-frrg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-f6wp-8j9r-frrg/GHSA-f6wp-8j9r-frrg.json
aliases: []
summary: |
  Duplicate Advisory: EVE: SSH as Root Unlockable Without Triggering Measured Boot
  ### Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-phcg-h58r-gmcq. This link is maintained to preserve external references.

  ### Original Description
  On boot, the Pillar eve container checks for the existence and content of
  “/config/authorized_keys”.

  If the file is present, and contains a supported public key, the container will go on to open
  port 22 and enable sshd with the given keys as the authorized keys for root login.

  An attacker could easily add their own keys and gain full control over the system without
  triggering the “measured boot” mechanism implemented by EVE OS, and without marking
  the device as “UUD” (“Unknown Update Detected”).

  This is because the “/config” partition is not protected by “measured boot”, it is mutable, and
  it is not encrypted in any way.




  An attacker can gain full control over the device without changing the PCR values, thus not
  triggering the “measured boot” mechanism, and having full access to the vault.



  Note:

  This issue was partially fixed in these commits (after disclosure to Zededa), where the config
  partition measurement was added to PCR13:

  • aa3501d6c57206ced222c33aea15a9169d629141

  • 5fef4d92e75838cc78010edaed5247dfbdae1889.

  This issue was made viable in version 9.0.0 when the calculation was moved to PCR14 but it was not included in the measured boot.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-f6wp-8j9r-frrg/GHSA-f6wp-8j9r-frrg.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-522
references:
  - url: https://asrg.io/security-advisories/cve-2023-43631
    reference_type:
    reference_id:
  - url: https://asrg.io/security-advisories/ssh-as-root-unlockable-without-triggering-measured-boot
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-43631
    reference_type:
    reference_id: CVE-2023-43631
