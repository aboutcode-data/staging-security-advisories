advisory_id: GHSA-mc43-4fqr-c965
datasource_id: github_osv_importer_v2/GHSA-mc43-4fqr-c965
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-mc43-4fqr-c965/GHSA-mc43-4fqr-c965.json
aliases:
  - CVE-2024-34711
summary: "GeoServer has improper ENTITY_RESOLUTION_ALLOWLIST URI validation in XML Processing\
  \ (SSRF)\n### Summary\nAn improper URI validation vulnerability exists that enables an unauthorized\
  \ attacker to perform XML External Entities (XEE) attack, then send GET request to any HTTP\
  \ server. Attacker can abuse this to scan internal networks and gain information about them\
  \ then exploit further. Moreover, attacker can read limited `.xsd` file on system.\n\n###\
  \ Details\nBy default, GeoServer use `PreventLocalEntityResolver` class from GeoTools to filter\
  \ out malicious URIs in XML entities before resolving them. The URI must match the regex `(?i)(jar:file|http|vfs)[^?#;]*\\\
  \\.xsd`. But the regex leaves a chance for attackers to request to any HTTP server or limited\
  \ file.\n\n### Impact\n\nAn unauthenticated attacker can:\n1. Scan internal network to gain\
  \ insight about it and exploit further.\n2. SSRF to endpoint ends with `.xsd`.\n3. Read limited\
  \ `.xsd` file on system.\n\n### Mitigation\n\n1. Define the system property ``ENTITY_RESOLUTION_ALLOWLIST``\
  \ to limit the supported external schema locaitons.\n2. The built-in allow list covers the\
  \ locations required for the operation of OGC web services: ``www.w3.org``,``schemas.opengis.net``,``www.opengis.net``,``inspire.ec.europa.eu/schemas``.\n\
  3. The [user guide](https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities)\
  \ provides details on how to add additional locations (this is required for app-schema plugin\
  \ where a schema is supplied to define an output format).\n\n### Resolution \n\n1. GeoServer\
  \ 2.25.0 and greater default to the use of ``ENTITY_RESOLUTION_ALLOWLIST`` and does not require\
  \ you to provide a system property.\n2. The use of ``ENTITY_RESOLUTION_ALLOWLIST`` is still\
  \ supported if you require additional schema locations to be supported beyond the built-in\
  \ allow list.\n3. GeoServer 2.25.1 change ``ENTITY_RESOLUTION_ALLOWLIST `` no longer supports\
  \ regular expressions\n\n### References\n\n* [External Entities Resolution](https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities)\
  \ (GeoServer User Guide)\n\n### Credits\n* Le Mau Anh Phong from VNG Security Response Center\
  \ & VNUHCM - University of Information Technology"
impacted_packages:
  - purl: pkg:maven/org.geoserver.web/gs-web-app
    affected_versions: vers:maven/<2.25.0
    fixed_versions: vers:maven/2.25.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.geoserver.main/gs-main
    affected_versions: vers:maven/<2.25.0
    fixed_versions: vers:maven/2.25.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-mc43-4fqr-c965/GHSA-mc43-4fqr-c965.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
  - CWE-200
  - CWE-918
  - CWE-611
references:
  - url: https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/security/advisories/GHSA-mc43-4fqr-c965
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-34711
    reference_type:
    reference_id: CVE-2024-34711
