advisory_id: GHSA-p26g-97m4-6q7c
datasource_id: github_osv_importer_v2/GHSA-p26g-97m4-6q7c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-p26g-97m4-6q7c/GHSA-p26g-97m4-6q7c.json
aliases:
  - CVE-2023-26049
summary: |
  Eclipse Jetty's cookie parsing of quoted values can exfiltrate values from other cookies
  Nonstandard cookie parsing in Jetty may allow an attacker to smuggle cookies within other cookies, or otherwise perform unintended behavior by tampering with the cookie parsing mechanism.

  If Jetty sees a cookie VALUE that starts with `"` (double quote), it will continue to read the cookie string until it sees a closing quote -- even if a semicolon is encountered.

  So, a cookie header such as:

  `DISPLAY_LANGUAGE="b; JSESSIONID=1337; c=d"` will be parsed as one cookie, with the name `DISPLAY_LANGUAGE` and a value of `b; JSESSIONID=1337; c=d`

  instead of 3 separate cookies.

  ### Impact
  This has security implications because if, say, `JSESSIONID` is an `HttpOnly` cookie, and the `DISPLAY_LANGUAGE` cookie value is rendered on the page, an attacker can smuggle the `JSESSIONID` cookie into the `DISPLAY_LANGUAGE` cookie and thereby exfiltrate it. This is significant when an intermediary is enacting some policy based on cookies, so a smuggled cookie can bypass that policy yet still be seen by the Jetty server.

  ### Patches
  * 9.4.51.v20230217 - via PR #9352
  * 10.0.15 - via PR #9339
  * 11.0.15 - via PR #9339

  ### Workarounds
  No workarounds

  ### References
  * https://www.rfc-editor.org/rfc/rfc2965
  * https://www.rfc-editor.org/rfc/rfc6265
impacted_packages:
  - purl: pkg:maven/org.eclipse.jetty/jetty-server
    affected_versions: vers:maven/<9.4.51.v20230217
    fixed_versions: vers:maven/9.4.51.v20230217
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty/jetty-server
    affected_versions: vers:maven/>=10.0.0|<10.0.14
    fixed_versions: vers:maven/10.0.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty/jetty-server
    affected_versions: vers:maven/>=11.0.0|<11.0.14
    fixed_versions: vers:maven/11.0.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.eclipse.jetty/jetty-server
    affected_versions: vers:maven/>=12.0.0alpha0|<12.0.0.beta0
    fixed_versions: vers:maven/12.0.0.beta0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-p26g-97m4-6q7c/GHSA-p26g-97m4-6q7c.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/eclipse/jetty.project
    reference_type:
    reference_id:
  - url: https://github.com/eclipse/jetty.project/pull/9339
    reference_type:
    reference_id:
  - url: https://github.com/eclipse/jetty.project/pull/9352
    reference_type:
    reference_id:
  - url: https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.51.v20230217
    reference_type:
    reference_id:
  - url: https://github.com/eclipse/jetty.project/security/advisories/GHSA-p26g-97m4-6q7c
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/09/msg00039.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230526-0001
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2023/dsa-5507
    reference_type:
    reference_id:
  - url: https://www.rfc-editor.org/rfc/rfc2965
    reference_type:
    reference_id:
  - url: https://www.rfc-editor.org/rfc/rfc6265
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-26049
    reference_type:
    reference_id: CVE-2023-26049
