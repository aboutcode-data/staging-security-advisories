advisory_id: GHSA-vr8x-74pm-6vj7
datasource_id: github_osv_importer_v2/GHSA-vr8x-74pm-6vj7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-vr8x-74pm-6vj7/GHSA-vr8x-74pm-6vj7.json
aliases:
  - CVE-2023-36822
summary: |
  Uptime Kuma's authenticated path traversal via plugin repository name may lead to unavailability or data loss
  ### Summary
  A path traversal vulnerability via the plugin repository name allows an authenticated attacker to delete files on the server leading to unavailability and potentially data loss.

  ### Details
  Uptime Kuma allows authenticated users to install plugins from an official list of plugins. This feature is currently disabled in the web interface, but the corresponding API endpoints are still available after login.
  Before a plugin is downloaded, the plugin installation directory is checked for existence. If it exists, it's removed before the plugin installation.

  Because the plugin is not validated against the official list of plugins or sanitized, the check for existence and the removal of the plugin installation directory are prone to path traversal.

  ### Impact
  This vulnerability allows an authenticated attacker to delete files from the server Uptime Kuma is running on.
  Depending on which files are deleted, Uptime Kuma or the whole system may become unavailable due to data loss.
impacted_packages:
  - purl: pkg:npm/uptime-kuma
    affected_versions: vers:npm/<=1.22.0
    fixed_versions: vers:npm/1.22.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-vr8x-74pm-6vj7/GHSA-vr8x-74pm-6vj7.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/louislam/uptime-kuma
    reference_type:
    reference_id:
  - url: https://github.com/louislam/uptime-kuma/blob/de74efb2e6601dcbcfed32cddefc4078a80fcb0b/server/plugins-manager.js#L75-L80
    reference_type:
    reference_id:
  - url: https://github.com/louislam/uptime-kuma/commit/a0736e04b2838aae198c2110db244eab6f87757b
    reference_type:
    reference_id:
  - url: https://github.com/louislam/uptime-kuma/pull/3346
    reference_type:
    reference_id:
  - url: https://github.com/louislam/uptime-kuma/releases/tag/1.22.1
    reference_type:
    reference_id:
  - url: https://github.com/louislam/uptime-kuma/security/advisories/GHSA-vr8x-74pm-6vj7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-36822
    reference_type:
    reference_id: CVE-2023-36822
