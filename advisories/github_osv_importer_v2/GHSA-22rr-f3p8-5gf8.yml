advisory_id: GHSA-22rr-f3p8-5gf8
datasource_id: github_osv_importer_v2/GHSA-22rr-f3p8-5gf8
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-22rr-f3p8-5gf8/GHSA-22rr-f3p8-5gf8.json
aliases: []
summary: |
  Directus affected by VM2 sandbox escape vulnerability
  ### Impact
  In vm2 for versions up to 3.9.19, Promise handler sanitization can be bypassed, allowing attackers to escape the sandbox and run arbitrary code. Within Directus this applies to the "Run Script" operation in flows being able to escape the sandbox running code in the main nodejs context.

  ### Patches
  Patched in v10.6.0 by replacing `vm2` with `isolated-vm`

  ### Workarounds
  None

  ### References
  https://github.com/patriksimek/vm2/security/advisories/GHSA-cchq-frgv-rjh5
impacted_packages:
  - purl: pkg:npm/directus
    affected_versions: vers:npm/<10.6.0
    fixed_versions: vers:npm/10.6.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/09/GHSA-22rr-f3p8-5gf8/GHSA-22rr-f3p8-5gf8.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/commit/284156426fa94f688e8d65a7a4f34f9e6705f058
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/pull/19332
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-22rr-f3p8-5gf8
    reference_type:
    reference_id:
  - url: https://github.com/patriksimek/vm2/security/advisories/GHSA-cchq-frgv-rjh5
    reference_type:
    reference_id:
