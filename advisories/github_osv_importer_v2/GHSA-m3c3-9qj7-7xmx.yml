advisory_id: GHSA-m3c3-9qj7-7xmx
datasource_id: github_osv_importer_v2/GHSA-m3c3-9qj7-7xmx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-m3c3-9qj7-7xmx/GHSA-m3c3-9qj7-7xmx.json
aliases:
  - CVE-2023-29517
summary: |
  Exposure of Sensitive Information to an Unauthorized Actor in org.xwiki.platform:xwiki-platform-office-viewer
  ### Impact

  The office document viewer macro was allowing anyone to see any file content from the hosting server, provided that the office server was connected and depending on the permissions of the user running the servlet engine (e.g. tomcat) running XWiki. The same vulnerability also allowed to perform internal requests to resources from the hosting server.

  ### Patches

  The problem has been patched in XWiki 13.10.11, 14.10.1, 14.4.8, 15.0-rc-1.

  ### Workarounds

  It might be possible to workaround this vulnerability by running XWiki in a sandbox with a user with very low privileges on the machine, now to run a servlet engine the user will always need access to some files, so in any case this workaround won't protect all files to be accessed.

  ### References

    * Original jira ticket: https://jira.xwiki.org/browse/XWIKI-20447
    * Jira ticket related to another exploit using same root cause: https://jira.xwiki.org/browse/XWIKI-20324
    * Jira ticket related to the possibility to exploit the same vulnerability to perform internal requests: https://jira.xwiki.org/browse/XWIKI-20449

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  * Email us at [Security Mailing List](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-office-viewer
    affected_versions: vers:maven/>=2.5-milestone-2|<13.10.11
    fixed_versions: vers:maven/13.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-office-viewer
    affected_versions: vers:maven/>=14.0-rc-1|<14.4.8
    fixed_versions: vers:maven/14.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-office-viewer
    affected_versions: vers:maven/>=14.5|<14.10.1
    fixed_versions: vers:maven/14.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-m3c3-9qj7-7xmx/GHSA-m3c3-9qj7-7xmx.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-m3c3-9qj7-7xmx
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20324
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20447
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20449
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29517
    reference_type:
    reference_id: CVE-2023-29517
