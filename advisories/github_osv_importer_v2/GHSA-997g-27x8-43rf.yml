advisory_id: GHSA-997g-27x8-43rf
datasource_id: github_osv_importer_v2/GHSA-997g-27x8-43rf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-997g-27x8-43rf/GHSA-997g-27x8-43rf.json
aliases:
  - CVE-2024-24558
summary: |
  react-query-streamed-hydration Cross-site Scripting vulnerability
  ### Impact

  The `@tanstack/react-query-next-experimental` NPM package is vulnerable to a cross-site scripting vulnerability. To exploit this, an attacker would need to either inject malicious input or arrange to have malicious input be returned from an endpoint.

  This vulnerability arises from improper handling of untrusted input when `@tanstack/react-query-next-experimental` performs server-side rendering of HTML pages. To fix this vulnerability, we implemented appropriate escaping to prevent javascript injection into rendered pages.

  ### Patches

  To fix this issue, please update to version 5.18.0 or later.

  ### Workarounds

  There are no known workarounds for this issue. Please update to version 5.18.0 or later.
impacted_packages:
  - purl: pkg:npm/%40tanstack/react-query-next-experimental
    affected_versions: vers:npm/>=5.0.0|<5.18.0
    fixed_versions: vers:npm/5.18.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-997g-27x8-43rf/GHSA-997g-27x8-43rf.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/TanStack/query
    reference_type:
    reference_id:
  - url: https://github.com/TanStack/query/commit/f2ddaf2536e8b71d2da88a9310ac9a48c13512a1
    reference_type:
    reference_id:
  - url: https://github.com/TanStack/query/security/advisories/GHSA-997g-27x8-43rf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-24558
    reference_type:
    reference_id: CVE-2024-24558
