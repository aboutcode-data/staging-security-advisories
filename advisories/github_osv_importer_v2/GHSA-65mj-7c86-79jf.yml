advisory_id: GHSA-65mj-7c86-79jf
datasource_id: github_osv_importer_v2/GHSA-65mj-7c86-79jf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-65mj-7c86-79jf/GHSA-65mj-7c86-79jf.json
aliases:
  - CVE-2021-3850
summary: "Authentication Bypass in ADOdb/ADOdb\n### Impact\n\nAn attacker can inject values\
  \ into a PostgreSQL connection string by providing a parameter surrounded by single quotes.\n\
  \nDepending on how the library is used in the client software, this may allow an attacker\
  \ to bypass the login process, gain access to the server's IP address, etc.\n\n### Patches\n\
  \nThe vulnerability is fixed in ADOdb versions 5.20.21 (952de6c4273d9b1e91c2b838044f8c2111150c29)\
  \ and 5.21.4 or later (b4d5ce70034c5aac3a1d51d317d93c037a0938d2).\n\nThe simplest patch is\
  \ to delete line 29 in `drivers/adodb-postgres64.inc.php`:\n\n```php\ndiff --git a/drivers/adodb-postgres64.inc.php\
  \ b/drivers/adodb-postgres64.inc.php\nindex d04b7f67..729d7141 100644\n--- a/drivers/adodb-postgres64.inc.php\n\
  +++ b/drivers/adodb-postgres64.inc.php\n@@ -26,7 +26,6 @@ function adodb_addslashes($s)\n\
  \ {\n    $len = strlen($s);\n    if ($len == 0) return \"''\";\n-   if (strncmp($s,\"'\",1)\
  \ === 0 && substr($s,$len-1) == \"'\") return $s; // already quoted\n \n    return \"'\".addslashes($s).\"\
  '\";\n }\n```\n\n### Workarounds\n\nEnsure the parameters passed to *ADOConnection::connect()*\
  \ or related functions (_nConnect()_, _pConnect()_) are not surrounded by single quotes.\n\
  \n### Credits\n\nThanks to **Emmet Leahy** (@meme-lord) of Sorcery Ltd for reporting this\
  \ vulnerability, and to the [huntr](https://huntr.dev/) team for their support.\n\n### References\n\
  \n- Original issue report https://huntr.dev/bounties/bdf5f216-4499-4225-a737-b28bc6f5801c/\n\
  - ADOdb reference issue #793 \n\n### For more information\n\nIf you have any questions or\
  \ comments about this advisory:\n* Add a note in issue #793\n* Contact the maintainers on\
  \ [Gitter](https://gitter.im/adodb/adodb)"
impacted_packages:
  - purl: pkg:composer/adodb/adodb-php
    affected_versions: vers:composer/<=5.20.20
    fixed_versions: vers:composer/5.20.21
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/adodb/adodb-php
    affected_versions: vers:composer/<=5.21.3
    fixed_versions: vers:composer/5.21.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/01/GHSA-65mj-7c86-79jf/GHSA-65mj-7c86-79jf.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-305
  - CWE-287
references:
  - url: https://github.com/ADOdb/ADOdb
    reference_type:
    reference_id:
  - url: https://github.com/ADOdb/ADOdb/commit/952de6c4273d9b1e91c2b838044f8c2111150c29
    reference_type:
    reference_id:
  - url: https://github.com/ADOdb/ADOdb/commit/b4d5ce70034c5aac3a1d51d317d93c037a0938d2
    reference_type:
    reference_id:
  - url: https://github.com/ADOdb/ADOdb/issues/793
    reference_type:
    reference_id:
  - url: https://github.com/ADOdb/ADOdb/security/advisories/GHSA-65mj-7c86-79jf
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/bdf5f216-4499-4225-a737-b28bc6f5801c
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/02/msg00006.html
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2022/dsa-5101
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3850
    reference_type:
    reference_id: CVE-2021-3850
