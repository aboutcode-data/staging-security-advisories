advisory_id: GHSA-p67q-h88v-5jgr
datasource_id: github_osv_importer_v2/GHSA-p67q-h88v-5jgr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-p67q-h88v-5jgr/GHSA-p67q-h88v-5jgr.json
aliases:
  - CVE-2023-29521
summary: |
  XWiki Platform vulnerable to code injection from account/view through VFS Tree macro
  ### Impact
  Any user with view rights can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation. The root cause is improper escaping of `Macro.VFSTreeMacro`. This page is not installed by default.

  See https://jira.xwiki.org/browse/XWIKI-20260 for the reproduction steps.

  ### Patches
  The vulnerability has been patched in XWiki 15.0-rc-1, 14.10.2, 14.4.8, 13.10.11.

  ### Workarounds
  The issue can be fixed by applying this [patch](https://github.com/xwiki/xwiki-platform/commit/fad02328f5ec7ab7fe5b932ffb5bc5c1ba7a5b12) on `Macro.VFSTreeMacro`.

  ### References
  - https://jira.xwiki.org/browse/XWIKI-20260
  - https://github.com/xwiki/xwiki-platform/commit/fad02328f5ec7ab7fe5b932ffb5bc5c1ba7a5b12

  ### For more information

  If you have any questions or comments about this advisory:

  *    Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
  *    Email us at [Security Mailing List](mailto:security@xwiki.org)
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-vfs-ui
    affected_versions: vers:maven/>=7.4-milestone-2|<13.10.11
    fixed_versions: vers:maven/13.10.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-vfs-ui
    affected_versions: vers:maven/>=14.0-rc-1|<14.4.8
    fixed_versions: vers:maven/14.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-vfs-ui
    affected_versions: vers:maven/>=14.5|<14.10.2
    fixed_versions: vers:maven/14.10.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/04/GHSA-p67q-h88v-5jgr/GHSA-p67q-h88v-5jgr.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-74
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/fad02328f5ec7ab7fe5b932ffb5bc5c1ba7a5b12
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p67q-h88v-5jgr
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20260
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29521
    reference_type:
    reference_id: CVE-2023-29521
