advisory_id: GHSA-7rpj-hg47-cx62
datasource_id: github_osv_importer_v2/GHSA-7rpj-hg47-cx62
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-7rpj-hg47-cx62/GHSA-7rpj-hg47-cx62.json
aliases:
  - CVE-2021-23463
summary: |
  Improper Restriction of XML External Entity Reference in com.h2database:h2.
  H2 is an embeddable RDBMS written in Java. The package com.h2database:h2 from 1.4.198 and before 2.0.202 are vulnerable to XML External Entity (XXE) Injection via the org.h2.jdbc.JdbcSQLXML class object, when it receives parsed string data from org.h2.jdbc.JdbcResultSet.getSQLXML() method. If it executes the getSource() method when the parameter is DOMSource.class it will trigger the vulnerability.
impacted_packages:
  - purl: pkg:maven/com.h2database/h2
    affected_versions: vers:maven/>=1.4.198|<2.0.202
    fixed_versions: vers:maven/2.0.202
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/12/GHSA-7rpj-hg47-cx62/GHSA-7rpj-hg47-cx62.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://github.com/boris-unckel/h2database/commit/f9ad6aef2bfa59eba2b4d3e7c4c32d2cce8e8b05
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database/commit/d83285fd2e48fb075780ee95badee6f5a15ea7f8%23diff-008c2e4462609982199cd83e7cf6f1d6b41296b516783f6752c44b9f15dc7bc3
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database/issues/3195
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database/pull/3199
    reference_type:
    reference_id:
  - url: https://github.com/h2database/h2database/pull/3199#issuecomment-1002830390
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230818-0010
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JAVA-COMH2DATABASE-1769238
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuapr2022.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-23463
    reference_type:
    reference_id: CVE-2021-23463
