advisory_id: GHSA-73rr-hh4g-fpgx
datasource_id: github_osv_importer_v2/GHSA-73rr-hh4g-fpgx
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-73rr-hh4g-fpgx/GHSA-73rr-hh4g-fpgx.json
aliases:
  - CVE-2026-24001
summary: |
  jsdiff has a Denial of Service vulnerability in parsePatch and applyPatch
  ### Impact

  Attempting to parse a patch whose filename headers contain the line break characters `\r`, `\u2028`, or `\u2029` can cause the `parsePatch` method to enter an infinite loop. It then consumes memory without limit until the process crashes due to running out of memory.

  Applications are therefore likely to be vulnerable to a denial-of-service attack if they call `parsePatch` with a user-provided patch as input. A large payload is not needed to trigger the vulnerability, so size limits on user input do not provide any protection. Furthermore, some applications may be vulnerable even when calling `parsePatch` on a patch generated by the application itself if the user is nonetheless able to control the filename headers (e.g. by directly providing the filenames of the files to be diffed).

  The `applyPatch` method is similarly affected if (and only if) called with a string representation of a patch as an argument, since under the hood it parses that string using `parsePatch`. Other methods of the library are unaffected.

  Finally, a second and lesser bug - a ReDOS - also exhibits when those same line break characters are present in a patch's *patch* header (also known as its "leading garbage"). A maliciously-crafted patch header of length *n* can take `parsePatch` O(*n*Â³) time to parse.

  ### Patches

  All vulnerabilities described are fixed in v8.0.3.

  ### Workarounds

  If using a version of jsdiff earlier than v8.0.3, do not attempt to parse patches that contain any of these characters: `\r`, `\u2028`, or `\u2029`.

  ### References

  PR that fixed the bug: https://github.com/kpdecker/jsdiff/pull/649


  ### CVE Notes

  Note that although the advisory describes two bugs, they each enable exactly the same attack vector (that an attacker who controls input to `parsePatch` can cause a DOS). Fixing one bug without fixing the other therefore does not fix the vulnerability and does not provide any security benefit. Therefore we assume that the bugs cannot possibly constitute Independently Fixable Vulnerabilities in the sense of CVE CNA rule 4.2.11, but rather that this advisory is properly construed under the rules as describing a single Vulnerability.
impacted_packages:
  - purl: pkg:npm/diff
    affected_versions: vers:npm/>=6.0.0|<8.0.3
    fixed_versions: vers:npm/8.0.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/diff
    affected_versions: vers:npm/>=5.0.0|<5.2.2
    fixed_versions: vers:npm/5.2.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/diff
    affected_versions: vers:npm/>=4.0.0|<4.0.4
    fixed_versions: vers:npm/4.0.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/diff
    affected_versions: vers:npm/<3.5.1
    fixed_versions: vers:npm/3.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-73rr-hh4g-fpgx/GHSA-73rr-hh4g-fpgx.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-1333
  - CWE-400
references:
  - url: https://github.com/kpdecker/jsdiff
    reference_type:
    reference_id:
  - url: https://github.com/kpdecker/jsdiff/commit/15a1585230748c8ae6f8274c202e0c87309142f5
    reference_type:
    reference_id:
  - url: https://github.com/kpdecker/jsdiff/issues/653
    reference_type:
    reference_id:
  - url: https://github.com/kpdecker/jsdiff/pull/649
    reference_type:
    reference_id:
  - url: https://github.com/kpdecker/jsdiff/security/advisories/GHSA-73rr-hh4g-fpgx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-24001
    reference_type:
    reference_id:
