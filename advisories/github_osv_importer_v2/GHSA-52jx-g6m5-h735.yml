advisory_id: GHSA-52jx-g6m5-h735
datasource_id: github_osv_importer_v2/GHSA-52jx-g6m5-h735
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-52jx-g6m5-h735/GHSA-52jx-g6m5-h735.json
aliases:
  - CVE-2025-27509
summary: "Fleet has SAML authentication vulnerability due to improper SAML response validation\n\
  ### Summary\n\nA vulnerability in Fleetâ€™s SAML authentication handling could allow an attacker\
  \ to forge authentication assertions and gain unauthorized access to Fleet. In certain configurations,\
  \ this could result in the creation of new user accounts, including administrative accounts.\
  \ This issue affects Fleet deployments using single sign-on (SSO).\n\n### Impact\n\nIn vulnerable\
  \ versions of Fleet, an attacker could craft a specially-formed SAML response to:\n\n- Forge\
  \ authentication assertions, potentially impersonating legitimate users.\n- If Just-In-Time\
  \ (JIT) provisioning is enabled, the attacker could provision a new administrative user account.\n\
  - If MDM enrollment is enabled, certain endpoints could be used to create new accounts tied\
  \ to forged assertions.\n\nThis could allow unauthorized access to Fleet, including administrative\
  \ access, visibility into device data, and modification of configuration. \n\n### Patches\n\
  \nThis issue is addressed in commit [fc96cc4](https://github.com/fleetdm/fleet/commit/fc96cc4e91047250afb12f65ad70e90b30a7fb1c)\
  \ and is available in Fleet version 4.64.2.\n\nThe following backport versions also address\
  \ this issue: \n\n- 4.63.2\n- 4.62.4\n- 4.58.1\n- 4.53.2\n\n### Workarounds\n\nIf an immediate\
  \ upgrade is not possible, Fleet users should temporarily disable [single-sign-on (SSO)](https://fleetdm.com/docs/deploy/single-sign-on-sso)\
  \ and use password authentication.\n\n### Credit\n\nThank you @hakivvi, as well as Jeffrey\
  \ Hofmann and Colby Morgan from the Robinhood Red Team for finding and reporting this vulnerability\
  \ using our [responsible disclosure process](https://github.com/fleetdm/fleet/blob/main/SECURITY.md).\n\
  \n### For more information\n\nIf you have any questions or comments about this advisory:\n\
  \n- Email us at security@fleetdm.com\n- Join #fleet in [osquery Slack](https://join.slack.com/t/osquery/shared_invite/zt-h29zm0gk-s2DBtGUTW4CFel0f0IjTEw)"
impacted_packages: []
severities:
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/03/GHSA-52jx-g6m5-h735/GHSA-52jx-g6m5-h735.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
  - CWE-74
references:
  - url: https://github.com/fleetdm/fleet
    reference_type:
    reference_id:
  - url: https://github.com/fleetdm/fleet/commit/718c95e47ad010ad6b8ceb3f3460e921fbfc53bb
    reference_type:
    reference_id:
  - url: https://github.com/fleetdm/fleet/releases/tag/fleet-v4.64.2
    reference_type:
    reference_id:
  - url: https://github.com/fleetdm/fleet/security/advisories/GHSA-52jx-g6m5-h735
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3505
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-27509
    reference_type:
    reference_id: CVE-2025-27509
