advisory_id: GHSA-5882-5rx9-xgxp
datasource_id: github_osv_importer_v2/GHSA-5882-5rx9-xgxp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-5882-5rx9-xgxp/GHSA-5882-5rx9-xgxp.json
aliases:
  - CVE-2026-26216
summary: |
  Crawl4AI is Vulnerable to Remote Code Execution in Docker API via Hooks Parameter
  A critical remote code execution vulnerability exists in the Crawl4AI Docker API deployment. The `/crawl` endpoint accepts a `hooks` parameter containing Python code that is executed using `exec()`. The `__import__` builtin was included in the allowed builtins, allowing attackers to import arbitrary modules and execute system commands.

  **Attack Vector:**
  ```json
  POST /crawl
  {
    "urls": ["https://example.com"],
    "hooks": {
      "code": {
        "on_page_context_created": "async def hook(page, context, **kwargs):\n    __import__('os').system('malicious_command')\n    return page"
      }
    }
  }
  ```

  ### Impact

  An unauthenticated attacker can:
  - Execute arbitrary system commands
  - Read/write files on the server
  - Exfiltrate sensitive data (environment variables, API keys)
  - Pivot to internal network services
  - Completely compromise the server

  ### Mitigation

  1. **Upgrade to v0.8.0** (recommended)
  2. If unable to upgrade immediately:
     - Disable the Docker API
     - Block `/crawl` endpoint at network level
     - Add authentication to the API

  ### Fix Details

  1. Removed `__import__` from `allowed_builtins` in `hook_manager.py`
  2. Hooks disabled by default (`CRAWL4AI_HOOKS_ENABLED=false`)
  3. Users must explicitly opt-in to enable hooks

  ### Credits

  Discovered by Neo by ProjectDiscovery (https://projectdiscovery.io)
impacted_packages:
  - purl: pkg:pypi/crawl4ai
    affected_versions: vers:pypi/<0.8.0
    fixed_versions: vers:pypi/0.8.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-5882-5rx9-xgxp/GHSA-5882-5rx9-xgxp.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/unclecode/crawl4ai
    reference_type:
    reference_id:
  - url: https://github.com/unclecode/crawl4ai/blob/main/docs/blog/release-v0.8.0.md
    reference_type:
    reference_id:
  - url: https://github.com/unclecode/crawl4ai/blob/release/v0.8.0/docs/blog/release-v0.8.0.md
    reference_type:
    reference_id:
  - url: https://github.com/unclecode/crawl4ai/blob/release/v0.8.0/docs/migration/v0.8.0-upgrade-guide.md
    reference_type:
    reference_id:
  - url: https://github.com/unclecode/crawl4ai/security/advisories/GHSA-5882-5rx9-xgxp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-26216
    reference_type:
    reference_id:
  - url: https://www.vulncheck.com/advisories/crawl4ai-docker-api-unauthenticated-remote-code-execution-via-hooks-parameter
    reference_type:
    reference_id:
