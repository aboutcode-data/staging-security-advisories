advisory_id: GHSA-h352-g5vw-3926
datasource_id: github_osv_importer_v2/GHSA-h352-g5vw-3926
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-h352-g5vw-3926/GHSA-h352-g5vw-3926.json
aliases:
  - CVE-2021-43620
summary: |
  Improper Input Validation in fruity
  Methods of NSString for conversion to a string may return a partial result. Since they call CStr::from_ptr on a pointer to the string buffer, the string is terminated at the first null byte, which might not be the end of the string.

  In addition to the vulnerable functions listed for this issue, the implementations of Display, PartialEq, PartialOrd, and ToString for NSString are also affected, since they call those functions.

  Since NSString is commonly used as the type for paths by the Foundation framework, null byte truncation might allow for easily bypassing file extension checks. For example, if a file name is provided by a user and validated to have one of a specific set of extensions, with validation taking place before truncation, an attacker can add an accepted extension after a null byte (e.g., file.exe\0.txt). After truncation, the file name used by the application would be file.exe.

  It would be better to generate unique names for files, instead of using user-provided names, but not all applications take this approach.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/11/GHSA-h352-g5vw-3926/GHSA-h352-g5vw-3926.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/nvzqz/fruity
    reference_type:
    reference_id:
  - url: https://github.com/nvzqz/fruity/issues/14
    reference_type:
    reference_id:
  - url: https://github.com/rustsec/advisory-db/pull/1102
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0123.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43620
    reference_type:
    reference_id: CVE-2021-43620
