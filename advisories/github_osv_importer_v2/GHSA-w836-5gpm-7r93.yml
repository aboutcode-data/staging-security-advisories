advisory_id: GHSA-w836-5gpm-7r93
datasource_id: github_osv_importer_v2/GHSA-w836-5gpm-7r93
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-w836-5gpm-7r93/GHSA-w836-5gpm-7r93.json
aliases:
  - CVE-2026-23847
summary: "SiYuan has a Reflected Cross-Site Scripting (XSS) via /api/icon/getDynamicIcon\n###\
  \ Summary\nReflected XSS in /api/icon/getDynamicIcon due to unsanitized SVG input.\n### Details\n\
  The endpoint generates SVG images for text icons (type=8). The content query parameter is\
  \ inserted directly into the SVG <text> tag without XML escaping. Since the response Content-Type\
  \ is image/svg+xml, injecting unescaped tags allows breaking the XML structure and executing\
  \ JavaScript.\n\n### PoC\nPayload: `test</text><script>alert(window.origin)</script><text>`\n\
  \n1. Open any note and click Change Icon -> Dynamic (Text).\n<img width=\"713\" height=\"\
  373\" alt=\"image\" src=\"https://github.com/user-attachments/assets/8a4f5ec4-81d6-46cb-8872-841cb2188ed8\"\
  \ />\n\n2.  Change color  and paste the payload into the Custom field and click on this icon.\n\
  <img width=\"935\" height=\"682\" alt=\"image\" src=\"https://github.com/user-attachments/assets/24d28fbd-a3ce-44f1-a5bb-2cc3f711faf5\"\
  \ />\n\n3. Intercept and send the request or get path from devtools \n<img width=\"1229\"\
  \ height=\"627\" alt=\"image\" src=\"https://github.com/user-attachments/assets/3cfb1d9a-5a23-476c-86cc-f9a7de6bbe32\"\
  \ />\n<img width=\"1140\" height=\"764\" alt=\"image\" src=\"https://github.com/user-attachments/assets/2657e44f-3724-4136-a53f-75068945aef0\"\
  \ />\n\n4. The JavaScript payload executes afted open URL.\n<img width=\"701\" height=\"809\"\
  \ alt=\"image\" src=\"https://github.com/user-attachments/assets/343ad67a-e236-466b-9ec9-e4f1dea4fd5e\"\
  \ />\n<img width=\"1382\" height=\"847\" alt=\"image\" src=\"https://github.com/user-attachments/assets/01820d3c-c374-402a-8d72-6ea75dbd92c2\"\
  \ />\n\n### Impact\nArbitrary JavaScript execution in the user's session context if the SVG\
  \ is loaded directly. It also prevents using legitimate characters like < or > in icon text.\n\
  \n### Note\nTested version:\n<img width=\"1368\" height=\"699\" alt=\"image\" src=\"https://github.com/user-attachments/assets/a7466b8f-a88b-461d-8d9e-7178af7ab076\"\
  \ />"
impacted_packages: []
severities:
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-w836-5gpm-7r93/GHSA-w836-5gpm-7r93.json
  - score: '2.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-w836-5gpm-7r93/GHSA-w836-5gpm-7r93.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/siyuan-note/siyuan
    reference_type:
    reference_id:
  - url: https://github.com/siyuan-note/siyuan/commit/5c0cc375b47567e15edd2119066b09bb0aa18777
    reference_type:
    reference_id:
  - url: https://github.com/siyuan-note/siyuan/issues/16844
    reference_type:
    reference_id:
  - url: https://github.com/siyuan-note/siyuan/security/advisories/GHSA-w836-5gpm-7r93
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23847
    reference_type:
    reference_id:
