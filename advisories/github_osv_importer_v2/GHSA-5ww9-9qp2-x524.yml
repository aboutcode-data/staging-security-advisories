advisory_id: GHSA-5ww9-9qp2-x524
datasource_id: github_osv_importer_v2/GHSA-5ww9-9qp2-x524
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-5ww9-9qp2-x524/GHSA-5ww9-9qp2-x524.json
aliases:
  - CVE-2022-33127
summary: |
  Improper handling of double quotes in file name in Diffy in Windows environment
  The function that calls the diff tool in versions of Diffy prior to 3.4.1 does not properly handle double quotes in a filename when run in a Windows environment. This allows attackers to execute arbitrary commands via a crafted string.
impacted_packages:
  - purl: pkg:gem/diffy
    affected_versions: vers:gem/<3.4.1
    fixed_versions: vers:gem/3.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/06/GHSA-5ww9-9qp2-x524/GHSA-5ww9-9qp2-x524.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/diffy/CVE-2022-33127.yml
    reference_type:
    reference_id:
  - url: https://github.com/samg/diffy
    reference_type:
    reference_id:
  - url: https://github.com/samg/diffy/blob/56fd935aea256742f7352b050592542d3d153bf6/CHANGELOG#L1
    reference_type:
    reference_id:
  - url: https://github.com/samg/diffy/commit/478f392082b66d38f54a02b4bb9c41be32fd6593
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-33127
    reference_type:
    reference_id: CVE-2022-33127
