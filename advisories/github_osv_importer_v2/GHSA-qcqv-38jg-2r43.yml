advisory_id: GHSA-qcqv-38jg-2r43
datasource_id: github_osv_importer_v2/GHSA-qcqv-38jg-2r43
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/09/GHSA-qcqv-38jg-2r43/GHSA-qcqv-38jg-2r43.json
aliases: []
summary: "Pageflow vulnerable to insecure direct object reference in membership update endpoint\n\
  ### Impact\n\nPageflow has a membership edit feature which allows users to edit the roles\
  \ of user memberships associated with an account that they have the `manager` role to (including\
  \ their own). While the `Entity` dropdown select field is greyed out in the UI, an attacker\
  \ can use tools which allow sending arbitrary HTTP request to craft a request to the `/admin/users/{user_id}/memberships/{membership_id}`\
  \ endpoint containing an additional `membership[entity_id]` parameter. This parameter is honored\
  \ when the membership is updated, allowing an attacker to update the membership object associated\
  \ with their own account (with `manager` role) to be associated with a different attacker-chosen\
  \ account instead. Since `account_id`s are enumerable, an attacker can compromise all accounts\
  \ present on the platform.\n\n### Mitigation\n\nUpgrade to version 15.7.1 or 14.5.2 of the\
  \ `pageflow` gem.\n\n### For more information\n\nIf you have any questions or comments about\
  \ this advisory email us at info(at)codevise.de \n\n### Credits\n\n[Positive Security](https://positive.security/)"
impacted_packages:
  - purl: pkg:gem/pageflow
    affected_versions: vers:gem/<14.5.2
    fixed_versions: vers:gem/14.5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/pageflow
    affected_versions: vers:gem/>=15.0.0|<15.7.1
    fixed_versions: vers:gem/15.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/codevise/pageflow
    reference_type:
    reference_id:
  - url: https://github.com/codevise/pageflow/pull/1862
    reference_type:
    reference_id:
  - url: https://github.com/codevise/pageflow/security/advisories/GHSA-qcqv-38jg-2r43
    reference_type:
    reference_id:
