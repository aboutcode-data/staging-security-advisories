advisory_id: GHSA-2qp9-wg27-9pcv
datasource_id: github_osv_importer_v2/GHSA-2qp9-wg27-9pcv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-2qp9-wg27-9pcv/GHSA-2qp9-wg27-9pcv.json
aliases:
  - CVE-2017-12972
summary: |
  Nimbus JOSE+JWT missing overflow check
  In Nimbus JOSE+JWT before 4.39, there is no integer-overflow check when converting length values from bytes to bits, which allows attackers to conduct HMAC bypass attacks by shifting Additional Authenticated Data (AAD) and ciphertext so that different plaintext is obtained for the same HMAC.
impacted_packages:
  - purl: pkg:maven/com.nimbusds/nimbus-jose-jwt
    affected_versions: vers:maven/<4.39
    fixed_versions: vers:maven/4.39
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-2qp9-wg27-9pcv/GHSA-2qp9-wg27-9pcv.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-345
references:
  - url: https://bitbucket.org/connect2id/nimbus-jose-jwt/commits/0d2bd649ea386539220d4facfe1f65eb1dadb86c
    reference_type:
    reference_id:
  - url: https://bitbucket.org/connect2id/nimbus-jose-jwt/issues/224/byte-to-bit-overflow-in-cbc
    reference_type:
    reference_id:
  - url: https://bitbucket.org/connect2id/nimbus-jose-jwt/src/master/CHANGELOG.txt
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/9317fd092b257a0815434b116a8af8daea6e920b6673f4fd5583d5fe@%3Ccommits.druid.apache.org%3E
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-12972
    reference_type:
    reference_id: CVE-2017-12972
