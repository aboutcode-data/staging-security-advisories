advisory_id: GHSA-2497-gp99-2m74
datasource_id: github_osv_importer_v2/GHSA-2497-gp99-2m74
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-2497-gp99-2m74/GHSA-2497-gp99-2m74.json
aliases:
  - CVE-2026-21696
summary: "Pterodactyl endlessly reprocesses/reuploads activity log data due to SQLite max parameters\
  \ limit not being considered\n### Summary \nWings does not consider SQLite max parameter limit\
  \ when processing activity log entries allowing for low privileged user to trigger a condition\
  \ that floods the panel with activity records \n\n### Details \nAfter wings sends activity\
  \ logs to the panel it deletes the processed activity entries from the wings SQLite database.\
  \ However, it does not consider the max parameter limit of SQLite, 32766 as of SQLite 3.32.0.\
  \ \n\nIf wings attempts to delete more than 32766 entries from the SQLite database in one\
  \ query, it triggers an error (SQL logic error: too many SQL variables (1)) and does not remove\
  \ any entries from the database. These entries are then indefinitely re-processed and resent\
  \ to the panel each time the cron runs. \n\nhttps://github.com/pterodactyl/wings/blob/9ffbcdcdb1163da823cf9959b9602df9f7dcb54a/internal/cron/activity_cron.go#L81\n\
  https://github.com/pterodactyl/wings/blob/9ffbcdcdb1163da823cf9959b9602df9f7dcb54a/internal/cron/sftp_cron.go#L86\n\
  \n### PoC \nAny method that can create the required 32767+ activity entries can trigger this\
  \ vulnerability. It can (and has) been triggered by normal (non-malicious) use. I attached\
  \ a simple PoC I used while verifying this that uses sftp to quickly create many small files,\
  \ thus creating activity entries in the SQLite database. \nhttps://ptero.co/mococesoca.go\n\
  \n\n  \n\n### Impact \nBy successfully exploiting this vulnerability you can trigger a situation\
  \ where wings will keep uploading the same activity data to the panel repeatedly (growing\
  \ each time to include new activity) until the panelsâ€™ database server runs out of disk space."
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-2497-gp99-2m74/GHSA-2497-gp99-2m74.json
  - score: '8.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-2497-gp99-2m74/GHSA-2497-gp99-2m74.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-770
  - CWE-400
references:
  - url: https://github.com/pterodactyl/panel/commit/09caa0d4995bd924b53b9a9e9b4883ac27bd5607
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/panel/releases/tag/v1.12.0
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/wings
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/wings/blob/9ffbcdcdb1163da823cf9959b9602df9f7dcb54a/internal/cron/activity_cron.go#L81
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/wings/blob/9ffbcdcdb1163da823cf9959b9602df9f7dcb54a/internal/cron/sftp_cron.go#L86
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/wings/security/advisories/GHSA-2497-gp99-2m74
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-21696
    reference_type:
    reference_id:
