advisory_id: GHSA-4r2p-wpv5-683w
datasource_id: github_osv_importer_v2/GHSA-4r2p-wpv5-683w
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-4r2p-wpv5-683w/GHSA-4r2p-wpv5-683w.json
aliases:
  - CVE-2019-3808
summary: |
  Moodle XSS Vulnerability
  A flaw was found in Moodle versions 3.6 to 3.6.1, 3.5 to 3.5.3, 3.4 to 3.4.6, 3.1 to 3.1.15 and earlier unsupported versions. The 'manage groups' capability did not have the 'XSS risk' flag assigned to it, but does have that access in certain places. Note that the capability is intended for use by trusted users, and is only assigned to teachers and managers by default.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<=3.6.1
    fixed_versions: vers:composer/3.6.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<=3.5.3
    fixed_versions: vers:composer/3.5.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<=3.4.6
    fixed_versions: vers:composer/3.4.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<=3.1.15
    fixed_versions: vers:composer/3.1.16
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-4r2p-wpv5-683w/GHSA-4r2p-wpv5-683w.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-64395
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3808
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/6360f87cdca744a6a71c315853f6d811a3e54e26
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=381228#p1536765
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-3808
    reference_type:
    reference_id: CVE-2019-3808
