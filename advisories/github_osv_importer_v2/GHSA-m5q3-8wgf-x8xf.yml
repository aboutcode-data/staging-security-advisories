advisory_id: GHSA-m5q3-8wgf-x8xf
datasource_id: github_osv_importer_v2/GHSA-m5q3-8wgf-x8xf
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-m5q3-8wgf-x8xf/GHSA-m5q3-8wgf-x8xf.json
aliases:
  - CVE-2023-27481
summary: "Directus vulnerable to extraction of password hashes through export querying\n###\
  \ Impact\n\nUsers with read access to the `password` field in `directus_users` can extract\
  \ the argon2 password hashes by brute forcing the export functionality combined with a `_starts_with`\
  \ filter. This allows the user to enumerate the password hashes.\n\n### Patches\n\nThe problem\
  \ has been patched by preventing any hashed/concealed field to be filtered against with the\
  \ `_starts_with` or other string operator.\n\n### Workarounds\n\nEnsuring that no user has\
  \ `read` access to the `password` field in `directus_users` is sufficient to prevent this\
  \ vulnerability. \n\n\n### For more information\nIf you have any questions or comments about\
  \ this advisory:\n* Open a Discussion in [directus/directus](https://github.com/directus/directus/discussions/new)\n\
  * Email us at [security@directus.io](mailto:security@directus.io)"
impacted_packages:
  - purl: pkg:npm/directus
    affected_versions: vers:npm/<9.16.0
    fixed_versions: vers:npm/9.16.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/03/GHSA-m5q3-8wgf-x8xf/GHSA-m5q3-8wgf-x8xf.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/pull/14829
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/pull/15010
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-m5q3-8wgf-x8xf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-27481
    reference_type:
    reference_id: CVE-2023-27481
