advisory_id: GHSA-hcvp-2cc7-jrwr
datasource_id: github_osv_importer_v2/GHSA-hcvp-2cc7-jrwr
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-hcvp-2cc7-jrwr/GHSA-hcvp-2cc7-jrwr.json
aliases:
  - CVE-2024-23329
summary: |
  changedetection.io API endpoint is not secured with API token
  ### Summary

  API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.

  ### Details

  WatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.

  https://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156

  ### PoC

  1. Get list of watch with `x-api-key`:
  ```sh
  $ curl -H "x-api-key: apikeyhere" http://localhost:5000/api/v1/watch
  {"uuid": ...}
  ```
  2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.
  ```sh
  $ curl http://localhost:5000/api/v1/watch/uuid/history
  {"timestamp": "/path/to/snapshot.txt"}
  ```

  ### Impact

  Anybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.
impacted_packages:
  - purl: pkg:pypi/changedetection.io
    affected_versions: vers:pypi/<=0.45.12
    fixed_versions: vers:pypi/0.45.13
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-hcvp-2cc7-jrwr/GHSA-hcvp-2cc7-jrwr.json
  - score: '1.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/01/GHSA-hcvp-2cc7-jrwr/GHSA-hcvp-2cc7-jrwr.json
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/dgtlmoon/changedetection.io
    reference_type:
    reference_id:
  - url: https://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156
    reference_type:
    reference_id:
  - url: https://github.com/dgtlmoon/changedetection.io/commit/402f1e47e78ecd155b1e90f30cce424ff7763e0f
    reference_type:
    reference_id:
  - url: https://github.com/dgtlmoon/changedetection.io/security/advisories/GHSA-hcvp-2cc7-jrwr
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/changedetection-io/PYSEC-2024-15.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23329
    reference_type:
    reference_id: CVE-2024-23329
