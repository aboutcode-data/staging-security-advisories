advisory_id: GHSA-5f35-pq34-c87q
datasource_id: github_osv_importer_v2/GHSA-5f35-pq34-c87q
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-5f35-pq34-c87q/GHSA-5f35-pq34-c87q.json
aliases:
  - CVE-2023-39441
summary: |
  Apache Airflow missing Certificate Validation
  Apache Airflow SMTP Provider before 1.3.0, Apache Airflow IMAP Provider before 3.3.0, and Apache Airflow before 2.7.0 are affected by the Validation of OpenSSL Certificate vulnerability.

  The default SSL context with SSL library did not check a server's X.509 certificate.  Instead, the code accepted any certificate, which could result in the disclosure of mail server credentials or mail contents when the client connects to an attacker in a MITM position.

  Users are strongly advised to upgrade to Apache Airflow version 2.7.0 or newer, Apache Airflow IMAP Provider version 3.3.0 or newer, and Apache Airflow SMTP Provider version 1.3.0 or newer to mitigate the risk associated with this vulnerability
impacted_packages:
  - purl: pkg:pypi/apache-airflow-providers-smtp
    affected_versions: vers:pypi/<1.3.0
    fixed_versions: vers:pypi/1.3.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/apache-airflow-providers-imap
    affected_versions: vers:pypi/<3.3.0
    fixed_versions: vers:pypi/3.3.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/apache-airflow
    affected_versions: vers:pypi/<2.7.0
    fixed_versions: vers:pypi/2.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-5f35-pq34-c87q/GHSA-5f35-pq34-c87q.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-295
references:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/38fc9cd823feafd8ec61d5d5c7eddb9e9162f755
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/3bd8f020e8b7bdeb7f618bdbdfb3557f117b29d3
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/dbacacbd4d476da757de148a4e747924c34fd7fe
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/pull/33070
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/pull/33075
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/pull/33108
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/xzp4wgjg2b1o6ylk2595df8bstlbo1lb
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/08/23/2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-39441
    reference_type:
    reference_id: CVE-2023-39441
