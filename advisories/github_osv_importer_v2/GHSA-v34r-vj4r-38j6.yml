advisory_id: GHSA-v34r-vj4r-38j6
datasource_id: github_osv_importer_v2/GHSA-v34r-vj4r-38j6
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-v34r-vj4r-38j6/GHSA-v34r-vj4r-38j6.json
aliases:
  - CVE-2025-24355
summary: |
  Updatecli exposes Maven credentials in console output
  ### Summary

  Private maven repository credentials leaked in application logs in case of unsuccessful retrieval operation.

  ### Details

  During the execution of an updatecli pipeline which contains a `maven` source configured with basic auth credentials, the credentials are being leaked in the application execution logs in case of failure.

  Credentials are properly sanitized when the operation is successful but not when for whatever reason there is a failure in the maven repository .e.g. wrong coordinates provided, not existing artifact or version.

  ### PoC

  The [documentation](https://www.updatecli.io/docs/plugins/resource/maven/) currently state to provide user credentials as basic auth inside the `repository` field. e.g.

  ```
  sources:
    default:
      kind: maven
      spec:
        repository: "{{ requiredEnv "MAVEN_USERNAME" }}:{{ requiredEnv "MAVEN_PASS" }}@repo.example.org/releases"
        groupid: "org.example.company"
        artifactid: "my-artifact"
        versionFilter:
          kind: regex
          pattern: "^23(\.[0-9]+){1,2}$"
  ```

  Logs are sanitized properly in case of a successful operation:

  ```
  source: source#default
  -----------------------------------------------------------
  Searching for version matching pattern "^23(\\.[0-9]+){1,2}$"
  ✔ Latest version is 23.4.0 on the Maven repository at https://repo.example.org/releases/org/example/company/my-artifact/maven-metadata.xml
  ```

  but leaks credentials in case the GAV coordinates are wrong (misspelled package name or missing):

  ```
  source: source#default
  -----------------------------------------------------------
  ERROR: ✗ getting latest version: URL "https://REDACTED:REDACTED@repo.example.org/releases/org/example/company/wrong-artifact/maven-metadata.xml" not found or in error
  ```

  ### Impact

  User credentials/token used to authenticate against a private maven repository can be leaked in clear-text in console or CI logs.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/01/GHSA-v34r-vj4r-38j6/GHSA-v34r-vj4r-38j6.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-359
references:
  - url: https://github.com/updatecli/updatecli
    reference_type:
    reference_id:
  - url: https://github.com/updatecli/updatecli/commit/344b28091ffeca5ed32e8d0f9eda542842fcd3fa
    reference_type:
    reference_id:
  - url: https://github.com/updatecli/updatecli/security/advisories/GHSA-v34r-vj4r-38j6
    reference_type:
    reference_id:
  - url: https://www.updatecli.io/docs/plugins/resource/maven
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-24355
    reference_type:
    reference_id: CVE-2025-24355
