advisory_id: GHSA-r344-xw3p-2frj
datasource_id: github_osv_importer_v2/GHSA-r344-xw3p-2frj
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-r344-xw3p-2frj/GHSA-r344-xw3p-2frj.json
aliases:
  - CVE-2023-45812
summary: "Apollo Router vulnerable to Improper Check or Handling of Exceptional Conditions\n\
  ### Impact\nThe Apollo Router is a configurable, high-performance graph router written in\
  \ Rust to run a federated supergraph that uses Apollo Federation. Affected versions are subject\
  \ to a Denial-of-Service (DoS) type vulnerability which causes the Router to panic and terminate\
  \ when a multi-part response is sent. When users send queries to the router that uses the\
  \ `@defer` or Subscriptions, the Router will panic.\n \nTo be vulnerable, users of Router\
  \ must have a coprocessor with `coprocessor.supergraph.response` configured in their `router.yaml`\
  \ and also to support either `@defer` or Subscriptions.  \n\n### Patches\nRouter version 1.33.0\
  \ has a fix for this vulnerability. https://github.com/apollographql/router/pull/4014 fixes\
  \ the issue.  \n\n### Workarounds\nFor affected versions, avoid using the coprocessor supergraph\
  \ response:\n```yml\n# do not use this stage in your coprocessor configuration\ncoprocessor:\n\
  \  supergraph:\n    response:\n``` \n\nOr you can disable defer and subscriptions support:\n\
  ```yml\n# disable defer and subscriptions:\nsupergraph:\n  defer_support: false # enabled\
  \ by default\nsubscription:\n  enabled: false # disabled by default\n```\nand continue to\
  \ use the coprocessor supergraph response.\n### References\nhttps://github.com/apollographql/router/issues/4013"
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-r344-xw3p-2frj/GHSA-r344-xw3p-2frj.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-754
  - CWE-703
references:
  - url: https://github.com/apollographql/router
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/commit/b917b8c117b46a2d508428c0856f4927dfcfc341
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/issues/4013
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/pull/4014
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/security/advisories/GHSA-r344-xw3p-2frj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-45812
    reference_type:
    reference_id: CVE-2023-45812
