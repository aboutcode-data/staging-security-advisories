advisory_id: GHSA-x3wm-hffr-chwm
datasource_id: github_osv_importer_v2/GHSA-x3wm-hffr-chwm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-x3wm-hffr-chwm/GHSA-x3wm-hffr-chwm.json
aliases:
  - CVE-2024-32888
summary: |
  Amazon JDBC Driver for Redshift SQL Injection via line comment generation
  ### Impact

  SQL injection is possible when using the non-default connection property `preferQueryMode=simple` in combination with application code which has a vulnerable SQL that negates a parameter value.

  There is no vulnerability in the driver when using the default, extended query mode. Note that `preferQueryMode` is not a supported parameter in Redshift JDBC driver, and is inherited code from Postgres JDBC driver. Users who do not override default settings to utilize this unsupported query mode are not affected.

  ### Patch

  This issue is patched in driver version 2.1.0.28.

  ### Workarounds

  Do not use the connection property `preferQueryMode=simple`. (NOTE: If you do not explicitly specify a query mode, then you are using the default of extended query mode and are not affected by this issue.)

  ### References

  Similar to finding in Postgres JDBC: https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-24rp-q3w6-vc56

  If you have any questions or comments about this advisory, we ask that you contact AWS Security via our [vulnerability reporting page](https://aws.amazon.com/security/vulnerability-reporting) or directly via email to [aws-security@amazon.com](mailto:aws-security@amazon.com). Please do not create a public GitHub issue.
impacted_packages:
  - purl: pkg:maven/com.amazon.redshift/redshift-jdbc42
    affected_versions: vers:maven/<2.1.0.28
    fixed_versions: vers:maven/2.1.0.28
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-x3wm-hffr-chwm/GHSA-x3wm-hffr-chwm.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/aws/amazon-redshift-jdbc-driver
    reference_type:
    reference_id:
  - url: https://github.com/aws/amazon-redshift-jdbc-driver/commit/0d354a5f26ca23f7cac4e800e3b8734220230319
    reference_type:
    reference_id:
  - url: https://github.com/aws/amazon-redshift-jdbc-driver/commit/12a5e8ecfbb44c8154fc66041cca2e20ecd7b339
    reference_type:
    reference_id:
  - url: https://github.com/aws/amazon-redshift-jdbc-driver/commit/bc93694201a291493778ce5369a72befeca5ba7d
    reference_type:
    reference_id:
  - url: https://github.com/aws/amazon-redshift-jdbc-driver/security/advisories/GHSA-x3wm-hffr-chwm
    reference_type:
    reference_id:
  - url: https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-24rp-q3w6-vc56
    reference_type:
    reference_id:
  - url: https://www.sonarsource.com/blog/double-dash-double-trouble-a-subtle-sql-injection-flaw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32888
    reference_type:
    reference_id: CVE-2024-32888
