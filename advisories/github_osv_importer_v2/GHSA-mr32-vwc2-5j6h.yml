advisory_id: GHSA-mr32-vwc2-5j6h
datasource_id: github_osv_importer_v2/GHSA-mr32-vwc2-5j6h
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-mr32-vwc2-5j6h/GHSA-mr32-vwc2-5j6h.json
aliases: []
summary: |
  OpenClaw's Browser Relay /cdp websocket is missing auth which could allow cross-tab cookie access
  ### Summary
  In affected versions, the Browser Relay `/cdp` WebSocket endpoint did not require an authentication token. As a result, a website running in the browser could potentially connect to the local relay (via loopback WebSocket) and use CDP to access cookies from other open tabs and run JavaScript in the context of other tabs.

  ### Affected Packages / Versions
  - npm: `openclaw` `>= 2026.1.20, < 2026.2.1`
  - npm: `moltbot` `<= 0.1.0`

  ### Details
  The Chrome extension Browser Relay service exposes a local WebSocket endpoint at `ws://127.0.0.1:18792/cdp` (default port) for forwarding Chrome DevTools Protocol (CDP) messages.

  In affected versions, the `/cdp` upgrade path verified the TCP peer was loopback but did not require a shared secret and did not block browser-initiated cross-origin requests.

  ### Impact
  - Potential disclosure of sensitive information (for example, session cookies from other open tabs)
  - Potential JavaScript execution in the context of other open tabs

  Users must have the Browser Relay extension installed and active, and must visit an untrusted site.

  ### Fix
  `openclaw` now requires a per-instance shared secret header for Browser Relay access:
  - HTTP header: `x-openclaw-relay-token`

  It also rejects `/cdp` WebSocket upgrades when the Origin header is present but is not `chrome-extension://...`, and refuses `/cdp` connections unless the extension is connected.

  ### Fix Commit(s)
  - `a1e89afcc19efd641c02b24d66d689f181ae2b5c`

  ### Releases
  - `openclaw@2026.2.1` includes the fix.
  - Latest published `openclaw` at time of writing: `2026.2.13`.

  ### Mitigation
  - Update to `openclaw@>= 2026.2.1`.
  - If you cannot update immediately, disable the Browser Relay extension / relay server and avoid visiting untrusted sites.

  Thanks @johnatzeropath, @LeftenantZero, and @yueyueL for reporting.
impacted_packages:
  - purl: pkg:npm/openclaw
    affected_versions: vers:npm/>=2026.1.20|<2026.2.1
    fixed_versions: vers:npm/2026.2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:npm/moltbot
    affected_versions: vers:npm/<=0.1.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-mr32-vwc2-5j6h/GHSA-mr32-vwc2-5j6h.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-306
references:
  - url: https://github.com/openclaw/openclaw
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/commit/a1e89afcc19efd641c02b24d66d689f181ae2b5c
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/releases/tag/v2026.2.1
    reference_type:
    reference_id:
  - url: https://github.com/openclaw/openclaw/security/advisories/GHSA-mr32-vwc2-5j6h
    reference_type:
    reference_id:
