advisory_id: GHSA-7vcx-v65q-9wpg
datasource_id: github_osv_importer_v2/GHSA-7vcx-v65q-9wpg
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/01/GHSA-7vcx-v65q-9wpg/GHSA-7vcx-v65q-9wpg.json
aliases: []
summary: |
  XML-RPC for PHP's `Wrapper::buildClientWrapperCode` method allows code injection via malicious `$client` argument
  In order for this weakness to be exploited, the following conditions have to apply, at the same time:

  - method `Wrapper::buildClientWrapperCode`, or any methods which depend on it, such as `Wrapper::wrapXmlrpcServer`, `Wrapper::wrapXmlrpcMethod` or `Wrapper::buildWrapMethodSource` must be in use. Note that they are _not_ used by default in either the Client or Server classes provided by the library; the developer has to specifically make use of them in his/her own code
  - the `$client` argument to either of those methods should have been built with malicious data, ie. data controlled by a 3rd party, passed to its constructor call

  This is most likely an uncommon usage scenario, and as such the chances of exploitation may be low.

  *NB* the graphical debugger which is shipped as part of the library is vulnerable to this, when used with the option "Generate stub for method call" selected. In that case, the debugger will _display_ but not _execute_ the malicious code, which would have to be provided via carefully crafted values for the "Address" and "Path" inputs.

  The attack scenario in this case is that a developer copies into his/her own source code the php snippet generated by the debugger, in a situation where the debugger is used with "Address"/"Path" input values supplied by a 3rd party.
  The malicious payload in the "Address"/"Path" input values should be easily recognized as suspicious by any barely proficient developer, as it resembles a bog-standard injection attack.
  It goes without saying that a responsible developer should not blindly copy and paste into his/her own code anything generated by a 3rd party tool, such as the phpxmlrpc debugger, without giving it at least a cursory scan.

  Originally reported as issue #80
impacted_packages:
  - purl: pkg:composer/phpxmlrpc/phpxmlrpc
    affected_versions: vers:composer/<4.9.0
    fixed_versions: vers:composer/4.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/gggeek/phpxmlrpc
    reference_type:
    reference_id:
  - url: https://github.com/gggeek/phpxmlrpc/commit/cf6e605e09d001ce520bfa8e7b168cfa514e663b
    reference_type:
    reference_id:
  - url: https://github.com/gggeek/phpxmlrpc/issues/80
    reference_type:
    reference_id:
  - url: https://github.com/gggeek/phpxmlrpc/security/advisories/GHSA-7vcx-v65q-9wpg
    reference_type:
    reference_id:
