advisory_id: GHSA-w5cr-2qhr-jqc5
datasource_id: github_osv_importer_v2/GHSA-w5cr-2qhr-jqc5
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-w5cr-2qhr-jqc5/GHSA-w5cr-2qhr-jqc5.json
aliases: []
summary: "Cloudflare Agents has a Reflected Cross-Site Scripting (XSS) vulnerability in AI Playground\
  \ site\n## Summary\n\nA Reflected Cross-Site Scripting (XSS) vulnerability was discovered\
  \ in the AI Playground's OAuth callback handler. The error_description query parameter was\
  \ directly interpolated into an HTML script tag without proper escaping, allowing attackers\
  \ to execute arbitrary JavaScript in the context of the victim's session.\n\n### Root cause\n\
  \nThe OAuth callback handler in `site/ai-playground/src/server.ts` directly interpolated the\
  \ `authError` value, sourced from the `error_description` query parameter,  into an inline\
  \ `<script>` tag.\n\n### Impact\n\nAn attacker could craft a malicious link that, when clicked\
  \ by a victim, would:\n- Steal user chat message history \n- Access all LLM interactions stored\
  \ in the user's session.\n- Access connected MCP Servers \n- Interact with any MCP servers\
  \ connected to the victim's session (public or authenticated/private), potentially allowing\
  \ the attacker to perform actions on the victim's behalf\n\n### Mitigation:\n\n- PR: https://github.com/cloudflare/agents/pull/841\n\
  - Agents-sdk users should upgrade to `agents@0.3.10`\n- Developers using `configureOAuthCallback`\
  \ with custom error handling in their own applications should ensure all user-controlled input\
  \ is escaped before interpolation.\n\n### Credits\n\nDisclosed responsibly by Nishant Kumawat"
impacted_packages:
  - purl: pkg:npm/agents
    affected_versions: vers:npm/<0.3.10
    fixed_versions: vers:npm/0.3.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:N/VA:N/SC:H/SI:L/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-w5cr-2qhr-jqc5/GHSA-w5cr-2qhr-jqc5.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/cloudflare/agents
    reference_type:
    reference_id:
  - url: https://github.com/cloudflare/agents/commit/3f490d045844e4884db741afbb66ca1fe65d4093
    reference_type:
    reference_id:
  - url: https://github.com/cloudflare/agents/pull/841
    reference_type:
    reference_id:
  - url: https://github.com/cloudflare/agents/security/advisories/GHSA-w5cr-2qhr-jqc5
    reference_type:
    reference_id:
