advisory_id: GHSA-j9h5-vcgv-2jfm
datasource_id: github_osv_importer_v2/GHSA-j9h5-vcgv-2jfm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-j9h5-vcgv-2jfm/GHSA-j9h5-vcgv-2jfm.json
aliases:
  - CVE-2023-32071
summary: |
  XWiki Platform vulnerable to RXSS via editor parameter - importinline template
  ### Impact

  It's possible to execute javascript with the right of any user by leading him to a special URL on the wiki targeting a page which contains an attachment.

  To reproduce:
  * add an attachment to a page (for example, your user profile)
  * add `?xpage=importinline&editor=%22%3E%3Cimg%20src%20onerror=alert(document.domain)%3E` to the page view URL as in `https://myhost/xwiki/bin/view/XWiki/MyUser?xpage=importinline&editor=%22%3E%3Cimg%20src%20onerror=alert(document.domain)%3E`

  ### Patches

  This has been patched in XWiki 15.0-rc-1, 14.10.4 and 14.4.8.

  ### Workarounds

  The easiest is to edit file `<xwiki app>/templates/importinline.vm` and apply the modification described on https://github.com/xwiki/xwiki-platform/commit/28905f7f518cc6f21ea61fe37e9e1ed97ef36f01

  ### References

  https://jira.xwiki.org/browse/XWIKI-20340
  https://app.intigriti.com/company/submissions/e95a7ad5-7029-4627-abf0-3e3e3ea0b4ce/XWIKI-E93DFEYK

  ### Attribution

  This vulnerability has been reported on Intigriti by RenÃ© de Sain @renniepak.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-distribution-war
    affected_versions: vers:maven/>=2.2-milestone-1|<14.4.8
    fixed_versions: vers:maven/14.4.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-distribution-war
    affected_versions: vers:maven/>=14.5|<14.10.4
    fixed_versions: vers:maven/14.10.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/05/GHSA-j9h5-vcgv-2jfm/GHSA-j9h5-vcgv-2jfm.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-116
  - CWE-79
references:
  - url: https://app.intigriti.com/company/submissions/e95a7ad5-7029-4627-abf0-3e3e3ea0b4ce/XWIKI-E93DFEYK
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/28905f7f518cc6f21ea61fe37e9e1ed97ef36f01
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-j9h5-vcgv-2jfm
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20340
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-32071
    reference_type:
    reference_id: CVE-2023-32071
