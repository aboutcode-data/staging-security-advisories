advisory_id: GHSA-9cvc-v7wm-992c
datasource_id: github_osv_importer_v2/GHSA-9cvc-v7wm-992c
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-9cvc-v7wm-992c/GHSA-9cvc-v7wm-992c.json
aliases:
  - CVE-2023-40027
summary: "### Summary\nWhen `ui.isAccessAllowed` is `undefined`, the `adminMeta` GraphQL query\
  \ is publicly accessible, that is to say, no session is required for the query.\n\nThis is\
  \ different to the behaviour of the default AdminUI middleware, which by default will only\
  \ be publicly accessible if a `session` strategy is not defined. \n\n### Impact\nThis vulnerability\
  \ does not affect developers using the `@keystone-6/auth` package, or any users that have\
  \ written their own `ui.isAccessAllowed` (that is to say, you are unaffected if `ui.isAccessAllowed`\
  \ is defined).\n\nThis vulnerability does affect developers who thought that their `session`\
  \ strategy will, by default, enforce that `adminMeta` is inaccessible by the public in accordance\
  \ with that strategy; akin to the behaviour of the AdminUI middleware.\n\n### Patches\nThis\
  \ vulnerability has been patched in `@keystone-6/core` version `5.5.1`.\n\n### Workarounds\n\
  You can opt to write your own `isAccessAllowed` to work-around this vulnerability.\n\n###\
  \ References\nPull request https://github.com/keystonejs/keystone/pull/8771"
impacted_packages:
  - purl: pkg:npm/%40keystone-6/core
    affected_versions: vers:npm/<5.5.1
    fixed_versions: vers:npm/5.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-9cvc-v7wm-992c/GHSA-9cvc-v7wm-992c.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-862
references:
  - url: https://github.com/keystonejs/keystone
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/commit/650e27e6e9b42abfb94c340c8470faf61f0ff284
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/pull/8771
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/releases/tag/2023-08-15
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/security/advisories/GHSA-9cvc-v7wm-992c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-40027
    reference_type:
    reference_id: CVE-2023-40027
