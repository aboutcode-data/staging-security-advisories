advisory_id: GHSA-m5vx-8chx-qvmm
datasource_id: github_osv_importer_v2/GHSA-m5vx-8chx-qvmm
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-m5vx-8chx-qvmm/GHSA-m5vx-8chx-qvmm.json
aliases:
  - CVE-2021-32697
summary: |
  Form validation can be skipped
  ### Impact
  By crafting a special `GET` request containing a valid form state, a form can be submitted without invoking any validators.
  We consider the severity _low_ because it is not possible to _change_ any form values since the form state is secured with an HMAC that is still verified.
  That means that this issue can only be exploited if Form Finishers cause side effects even if no form values have been sent.

  ### Patches
  https://github.com/neos/form/commit/69de4219b1f58157e2be6b05811463875d75c246

  ### Workarounds
  Form Finishers can be adjusted in a way that they only execute an action if the submitted form contains some expected data.
  Alternatively a custom Finisher can be added as first finisher.

  ### References
  This regression was introduced with https://github.com/neos/form/commit/049d415295be8d4a0478ccba97dba1bb81649567
  Original report: https://tickets.neos.io/#ticket/zoom/411 (internal)
impacted_packages:
  - purl: pkg:composer/neos/form
    affected_versions: vers:composer/>=1.2.0|<4.3.3
    fixed_versions: vers:composer/4.3.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/neos/form
    affected_versions: vers:composer/>=5.0.0|<5.0.9
    fixed_versions: vers:composer/5.0.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/neos/form
    affected_versions: vers:composer/>=5.1.0|<5.1.3
    fixed_versions: vers:composer/5.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/06/GHSA-m5vx-8chx-qvmm/GHSA-m5vx-8chx-qvmm.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/neos/form/CVE-2021-32697.yaml
    reference_type:
    reference_id:
  - url: https://github.com/neos/form/commit/049d415295be8d4a0478ccba97dba1bb81649567
    reference_type:
    reference_id:
  - url: https://github.com/neos/form/commit/69de4219b1f58157e2be6b05811463875d75c246
    reference_type:
    reference_id:
  - url: https://github.com/neos/form-ghsa-m5vx-8chx-qvmm/pull/1
    reference_type:
    reference_id:
  - url: https://github.com/neos/form/releases/tag/5.1.3
    reference_type:
    reference_id:
  - url: https://github.com/neos/form/security/advisories/GHSA-m5vx-8chx-qvmm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32697
    reference_type:
    reference_id: CVE-2021-32697
