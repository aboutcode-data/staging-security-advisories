advisory_id: GHSA-6c7v-2f49-8h26
datasource_id: github_osv_importer_v2/GHSA-6c7v-2f49-8h26
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/07/GHSA-6c7v-2f49-8h26/GHSA-6c7v-2f49-8h26.json
aliases:
  - CVE-2019-12781
summary: |
  Django Incorrect HTTP detection with reverse-proxy connecting via HTTPS
  An issue was discovered in Django 1.11 before 1.11.22, 2.1 before 2.1.10, and 2.2 before 2.2.3. An HTTP request is not redirected to HTTPS when the SECURE_PROXY_SSL_HEADER and SECURE_SSL_REDIRECT settings are used, and the proxy connects to Django via HTTPS. In other words, django.http.HttpRequest.scheme has incorrect behavior when a client uses HTTP.
impacted_packages:
  - purl: pkg:pypi/django
    affected_versions: vers:pypi/>=2.1|<2.1.10
    fixed_versions: vers:pypi/2.1.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/django
    affected_versions: vers:pypi/>=2.2|<2.2.3
    fixed_versions: vers:pypi/2.2.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/django
    affected_versions: vers:pypi/>=1.11|<1.11.22
    fixed_versions: vers:pypi/1.11.22
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/07/GHSA-6c7v-2f49-8h26/GHSA-6c7v-2f49-8h26.json
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2019/07/GHSA-6c7v-2f49-8h26/GHSA-6c7v-2f49-8h26.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-319
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2019-08/msg00006.html
    reference_type:
    reference_id:
  - url: http://lists.opensuse.org/opensuse-security-announce/2019-08/msg00025.html
    reference_type:
    reference_id:
  - url: https://docs.djangoproject.com/en/dev/releases/security
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-6c7v-2f49-8h26
    reference_type:
    reference_id:
  - url: https://github.com/django/django
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/django/PYSEC-2019-10.yaml
    reference_type:
    reference_id:
  - url: https://groups.google.com/forum/#!topic/django-announce/Is4kLY9ZcZQ
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/5VXXWIOQGXOB7JCGJ3CVUW673LDHKEYL
    reference_type:
    reference_id:
  - url: https://seclists.org/bugtraq/2019/Jul/10
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20190705-0002
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4043-1
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2019/dsa-4476
    reference_type:
    reference_id:
  - url: https://www.djangoproject.com/weblog/2019/jul/01/security-releases
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2019/07/01/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-12781
    reference_type:
    reference_id: CVE-2019-12781
