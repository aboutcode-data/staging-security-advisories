advisory_id: GHSA-cr78-rphw-w73p
datasource_id: github_osv_importer_v2/GHSA-cr78-rphw-w73p
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-cr78-rphw-w73p/GHSA-cr78-rphw-w73p.json
aliases:
  - CVE-2012-6099
summary: |
  Moodle Arbitrary File Read via Backup Functionality
  The moodle1 backup converter in `backup/converter/moodle1/lib.php` in Moodle 2.1.x before 2.1.10, 2.2.x before 2.2.7, 2.3.x before 2.3.4, and 2.4.x before 2.4.1 does not properly validate pathnames, which allows remote authenticated users to read arbitrary files by leveraging the backup-restoration feature.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/2.4.0
    fixed_versions: vers:composer/2.4.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<=2.3.3
    fixed_versions: vers:composer/2.3.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<=2.2.6
    fixed_versions: vers:composer/2.2.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<=2.1.9
    fixed_versions: vers:composer/2.1.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-36977
    reference_type:
    reference_id:
  - url: http://openwall.com/lists/oss-security/2013/01/21/1
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/0ab681d3e7bed2a37430387f9da8504c0b077d10
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/7b66137f7bcc84fb5eb07f58fb658b21bf37cc44
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=220160
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2012-6099
    reference_type:
    reference_id: CVE-2012-6099
