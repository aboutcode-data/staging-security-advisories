advisory_id: GHSA-fc38-2254-48g7
datasource_id: github_osv_importer_v2/GHSA-fc38-2254-48g7
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-fc38-2254-48g7/GHSA-fc38-2254-48g7.json
aliases:
  - CVE-2024-47524
summary: |
  LibreNMS has Stored Cross-site Scripting vulnerability in "Device Group" Name
  ### Summary
  The application fail to sanitising inputs properly and rendering the code from user input to browser which allow an attacker to execute malicious javascript code.

  ### Details
  User with Admin role can create a Device Groups, the application did not properly sanitize the user input in the Device Groups name, when user see the detail of the Device Group, if java script code is inside the name of the Device Groups, its will be trigger.

  ### PoC
  1. Login as an Admin role user. Then go over to "$URL/device-groups"

  2. Create a new Device Group with this payload in their name
  ```js
  <img src="x" onerror="alert(document.cookie)">
  ```
  ![image](https://github.com/user-attachments/assets/2764b313-ee65-47e9-ab57-559d75f4575c)

  3. Go over to the detail page of that Device Groups, in this case "$URL/devices/group=2". Will see a pop-up.
  ![image](https://github.com/user-attachments/assets/f743ca74-5dcb-4e72-ac56-dda2b42e2986)

  ### Impact
  Attacker can use this to perform malicious java script code for malicious intent.
  This would impact all users as anyone can have access to the detail page of the device group.
impacted_packages:
  - purl: pkg:composer/librenms/librenms
    affected_versions: vers:composer/<24.9.0
    fixed_versions: vers:composer/24.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-fc38-2254-48g7/GHSA-fc38-2254-48g7.json
  - score: '7.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/10/GHSA-fc38-2254-48g7/GHSA-fc38-2254-48g7.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/d3b51560a8e2343e520d16e9adc72c6951aa91ee
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-fc38-2254-48g7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47524
    reference_type:
    reference_id: CVE-2024-47524
