advisory_id: GHSA-xjw2-6jm9-rf67
datasource_id: github_osv_importer_v2/GHSA-xjw2-6jm9-rf67
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-xjw2-6jm9-rf67/GHSA-xjw2-6jm9-rf67.json
aliases:
  - CVE-2023-41039
summary: "Sandbox escape via various forms of \"format\".\n### Impact\nPython's \"format\" functionality\
  \ allows someone controlling the format string to \"read\" all objects accessible through\
  \ recursive attribute lookup and subscription from objects he can access. This can lead to\
  \ critical information disclosure.\nWith `RestrictedPython`, the format functionality is available\
  \ via the `format` and `format_map` methods of `str` (and `unicode`) (accessed either via\
  \ the class or its instances) and via `string.Formatter`.\nAll known versions of `RestrictedPython`\
  \ are vulnerable. \n\n### Patches\nThe issue will be fixed in 5.4 and 6.2.\n\n### Workarounds\n\
  There are no workarounds to fix the issue without upgrading.\n\n### References\n* https://docs.python.org/3/library/stdtypes.html#str.format_map\n\
  * http://lucumr.pocoo.org/2016/12/29/careful-with-str-format/\n* https://www.exploit-db.com/exploits/51580\n\
  \n### For more information\n\nIf you have any questions or comments about this advisory:\n\
  \n* Open an issue in the [RestrictedPython issue tracker](https://github.com/zopefoundation/RestrictedPython/issues)\n\
  * Email us at [security@plone.org](mailto:security@plone.org)\n\n### Credits\n\nThanks for\
  \ analysing and reporting the go to:\n\n* Abhishek Govindarasu\n* Ankush Menat\n* Ward Theunisse"
impacted_packages:
  - purl: pkg:pypi/restrictedpython
    affected_versions: vers:pypi/<=5.3
    fixed_versions: vers:pypi/5.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:pypi/restrictedpython
    affected_versions: vers:pypi/<=6.1
    fixed_versions: vers:pypi/6.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/08/GHSA-xjw2-6jm9-rf67/GHSA-xjw2-6jm9-rf67.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-74
references:
  - url: https://github.com/zopefoundation/RestrictedPython
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/RestrictedPython/commit/4134aedcff17c977da7717693ed89ce56d54c120
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-xjw2-6jm9-rf67
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41039
    reference_type:
    reference_id: CVE-2023-41039
