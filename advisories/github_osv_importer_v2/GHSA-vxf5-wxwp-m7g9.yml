advisory_id: GHSA-vxf5-wxwp-m7g9
datasource_id: github_osv_importer_v2/GHSA-vxf5-wxwp-m7g9
datasource_url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-vxf5-wxwp-m7g9/GHSA-vxf5-wxwp-m7g9.json
aliases:
  - CVE-2021-37699
summary: |
  Open Redirect in Next.js
  Next.js is an open source website development framework to be used with the React library. In affected versions specially encoded paths could be used when `pages/_error.js` was statically generated, allowing an open redirect to occur to an external site. In general, this redirect does not directly harm users although it can allow for phishing attacks by redirecting to an attacker's domain from a trusted domain.

  ### Impact

  - **Affected:** Users of Next.js between `10.0.5` and `10.2.0`
  - **Affected:** Users of Next.js between `11.0.0` and `11.0.1` using `pages/_error.js` without `getInitialProps`
  - **Affected:** Users of Next.js between `11.0.0` and `11.0.1` using `pages/_error.js` and `next export`
  - **Not affected**: Deployments on Vercel ([vercel.com](https://vercel.com)) are not affected
  - **Not affected:** Deployments **with** `pages/404.js`
  - Note that versions prior to 0.9.9 package `next` npm package hosted a different utility (0.4.1 being the latest version of that codebase), and this advisory does not apply to those versions.

  We recommend upgrading to the latest version of Next.js to improve the overall security of your application.

  ### Patches

  https://github.com/vercel/next.js/releases/tag/v11.1.0
impacted_packages:
  - purl: pkg:npm/next
    affected_versions: vers:npm/>=0.9.9|<11.1.0
    fixed_versions: vers:npm/11.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/08/GHSA-vxf5-wxwp-m7g9/GHSA-vxf5-wxwp-m7g9.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/vercel/next.js
    reference_type:
    reference_id:
  - url: https://github.com/vercel/next.js/releases/tag/v11.1.0
    reference_type:
    reference_id:
  - url: https://github.com/vercel/next.js/security/advisories/GHSA-vxf5-wxwp-m7g9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37699
    reference_type:
    reference_id: CVE-2021-37699
