advisory_id: npm-117
datasource_id: nodejs_security_wg/npm-117
datasource_url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/117.json
aliases: []
summary: "Potential Command Injection\nThe npm module \"shell-quote\" cannot correctly escape\
  \ \">\" and \"<\" operator used for redirection in shell. I'm wondering if this might be possible\
  \ vulnerability for many application which depends on shell-quote.\n\nFor example:\n\n   const\
  \ quote = require('shell-quote').quote;\n   console.log(quote(['foo>bar']));\n\nwill print\
  \ \"foo>bar\", where \"foo\\>bar\" is desirable.\n\nThis module is downloaded more than 1M\
  \ times per month and many other modules are depending on this. If an application is escaping\
  \ command-line args with this module, they might be vulnerable from malicious user input.\n\
  \nFor example:\n```\nvar sq = require('../tests/get/shell-quote-1.6.0');\nvar exec = require('child_process').exec;\n\
  \nvar pattern = process.argv[2];\n\ncommand = sq.quote(['grep', pattern]));\nexec('cat file\
  \ | ' + command, function ( err, stdout, stderr) {\n    console.log(command, stdout);   \n\
  });\n```\nwill be vulnerable when user input something like pattern = ':</etc/passwd', which\
  \ causes the content of /etc/passwd to be leaked.\n\nInternally, (Jon Lamendola, Nick Starke,\
  \ Jacob Waddell) found that the `;`, `{`, and `}` characters weren't escaped properly either.\
  \ This allows for full command injection. A malicious user could input `'a;{echo,test,123,234}'`\
  \ to execute echo fully."
impacted_packages:
  - purl: pkg:npm/shell-quote
    affected_versions: vers:npm/<=1.6.0
    fixed_versions: vers:npm/>=1.6.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/117.json
weaknesses: []
references:
  - url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/117.json
    reference_type:
    reference_id: 117
