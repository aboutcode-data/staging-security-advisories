advisory_id: npm-324
datasource_id: nodejs_security_wg/npm-324
datasource_url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/324.json
aliases: []
summary: |
  Invalid Curve Attack
  node-jose is a JavaScript implementation of the JSON Object Signing and Encryption (JOSE) for current web browsers and node.js-based servers.

  As outlined in [this post](http://blog.intothesymmetry.com/2017/03/critical-vulnerability-in-json-web.html) node-jose earlier than version 0.9.3 is vulnerable to an invalid curve attack. This allows an attacker to recover the private secret key when JWE with Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES) is used.

  [Proof of Concept](https://gist.github.com/asanso/fa25685348051ef6a28d49aa0f27a4ae)
impacted_packages:
  - purl: pkg:npm/node-jose
    affected_versions: vers:npm/<0.9.3
    fixed_versions: vers:npm/>=0.9.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/324.json
weaknesses: []
references:
  - url: http://blog.intothesymmetry.com/2017/03/critical-vulnerability-in-json-web.html
    reference_type:
    reference_id:
  - url: https://github.com/cisco/node-jose
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/324.json
    reference_type:
    reference_id: 324
