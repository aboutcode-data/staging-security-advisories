advisory_id: npm-318
datasource_id: nodejs_security_wg/npm-318
datasource_url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/318.json
aliases: []
summary: "Header Forgery\nHttp-signature is a \"Reference implementation of Joyent's HTTP Signature\
  \ Scheme\". \n\nIn versions <=0.9.11, http-signature signs only the header values, but not\
  \ the header names. This makes http-signature vulnerable to header forgery. \n\nThus, if an\
  \ attacker can intercept a request, he can swap header names and change the meaning of the\
  \ request without changing the signature. \n\n\nFor this example request: \n```\nPOST /pay\
  \ HTTP/1.1\nHost: example.com\nDate: Thu, 05 Jan 2012 21:31:40 GMT\nX-Payment-Source: src@money.com\n\
  X-Payment-Destination: dst@money.com\nAuthorization: Signature keyId=\"Test\",algorithm=\"\
  rsa-sha256\",headers=\"x-payment-source x-payment-destination\" MDyO5tSvin5...\n```\nThe request\
  \ can be changed to have the following:\n```\nX-Payment-Source: dst@money.com // Emails switched\n\
  X-Payment-Destination: src@money.com\nAuthorization: Signature keyId=\"Test\",algorithm=\"\
  rsa-sha256\",headers=\"x-payment-destination x-payment-source\" MDyO5tSvin5...\n```\nand both\
  \ would be signed:\n```\nsrc@money.com\\n\ndst@money.com\\n\n```\n(Fuller explanation of this\
  \ example on the [GitHub Issue](https://github.com/joyent/node-http-signature/issues/10))"
impacted_packages:
  - purl: pkg:npm/http-signature
    affected_versions: vers:npm/<=0.9.11
    fixed_versions: vers:npm/>=0.10.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/318.json
weaknesses: []
references:
  - url: https://github.com/joyent/node-http-signature/issues/10)
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/318.json
    reference_type:
    reference_id: 318
