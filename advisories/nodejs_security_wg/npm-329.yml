advisory_id: npm-329
datasource_id: nodejs_security_wg/npm-329
datasource_url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/329.json
aliases: []
summary: "XSS via improper selector detection\njQuery is a javascript library for DOM manipulation.\
  \ \n\njQuery's main method in affected versions contains an unreliable way of detecting whether\
  \ the input to the `jQuery(strInput)` function is intended to be a selector or HTML.\n\nFor\
  \ example, this code would be parsed as a selector, executing the code in the `onerror` attribute:\n\
  ```\n$(\"#log\").html(\n    $(\"element[attribute='<img src=\\\"x\\\" onerror=\\\"alert(1)\\\
  \" />']\").html()\n);\n```\n\nThe fix in v1.9.0 updates a regular expression for detecting\
  \ whether the input is HTML or a selector. HTML input must now explicitly start with `<`,\
  \ rather than previously assuming that the input was HTML if the string contained `<` anywhere."
impacted_packages:
  - purl: pkg:npm/jquery
    affected_versions: vers:npm/>=1.7.1|<=1.8.3
    fixed_versions: vers:npm/>=1.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/329.json
weaknesses: []
references:
  - url: https://bugs.jquery.com/ticket/11290)
    reference_type:
    reference_id:
  - url: https://bugs.jquery.com/ticket/12531)
    reference_type:
    reference_id:
  - url: https://bugs.jquery.com/ticket/6429)
    reference_type:
    reference_id:
  - url: https://bugs.jquery.com/ticket/9521)
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/329.json
    reference_type:
    reference_id: 329
