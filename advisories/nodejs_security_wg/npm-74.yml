advisory_id: npm-74
datasource_id: nodejs_security_wg/npm-74
datasource_url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/74.json
aliases: []
summary: |
  Content Injection via TileJSON Name
  Mapbox.js versions 1.x prior to 1.6.6 and 2.x prior to 2.2.4 are vulnerable to a cross-site-scripting attack in certain uncommon usage scenarios.

  If you use L.mapbox.map and L.mapbox.shareControl it is possible for a malicious user with control over the TileJSON content to inject script content into the name value of the TileJSON. After clicking on the share control, the malicious code will execute in the context of the page using Mapbox.js.

  Such usage is uncommon. L.mapbox.shareControl is not automatically added to mapbox.js maps and must be explicitly added. The following usage scenarios are not vulnerable:

  - the map does not use a share control (L.mapbox.sharecontrol)
  - only trusted TileJSON content is loaded

  Timeline:
  January 12, 2016 - CVE Requested
impacted_packages:
  - purl: pkg:npm/mapbox.js
    affected_versions: vers:npm/<1.6.6|>2.0.0|<2.2.4
    fixed_versions: vers:npm/>=1.6.6|<2.0.0|>=2.2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/74.json
weaknesses: []
references:
  - url: https://hackerone.com/reports/99245
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/74.json
    reference_type:
    reference_id: 74
