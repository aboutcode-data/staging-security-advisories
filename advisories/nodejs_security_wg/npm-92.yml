advisory_id: npm-92
datasource_id: nodejs_security_wg/npm-92
datasource_url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/92.json
aliases: []
summary: "Private Data Disclosure\nexpress-restify-mongoose is a module to easily create a flexible\
  \ REST interface for mongoose models.\n\nIf you have a user model that you want to protect,\
  \ such as the following User model:\n```\nconst User = mongoose.model('User', new mongoose.Schema({\n\
  \    name: String,\n    password: String,\n}));\n```\n\nYou would normally do something such\
  \ as:\n```\nrestify.serve(router, User, {\n    private: ['password'], // Set the password\
  \ part of User as private, so outside people can't read it\n})\n```\n\nThis would hide the\
  \ password field from people that send your application a `GET /User` and `GET /User/some-user-id`\
  \ request. \n\nA malicious user can go to your application and send a request for `GET /User?distinct=password`\
  \ and get all the passwords for all the users in the database, despite the field being set\
  \ to private. This can be used for other private data if the malicious user knew what was\
  \ set as private for specific routes."
impacted_packages:
  - purl: pkg:npm/express-restify-mongoose
    affected_versions: vers:npm/<=2.4.2|>=3.0.0|<=3.0.1
    fixed_versions: vers:npm/>=2.5.0|<=3.0.0|>=3.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/92.json
weaknesses: []
references:
  - url: https://github.com/florianholzapfel/express-restify-mongoose/issues/252
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/security-wg/blob/main/vuln/npm/92.json
    reference_type:
    reference_id: 92
