advisory_id: RHSA-2015:2417
datasource_id: redhat_importer_v2/RHSA-2015:2417
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_2417.json
aliases:
  - CVE-2014-8169
summary: |
  Updated autofs packages that fix one security issue, several bugs, and add
  one enhancement are now available for Red Hat Enterprise Linux 7.

  Red Hat Product Security has rated this update as having Moderate security
  impact. A Common Vulnerability Scoring System (CVSS) base score, which
  gives a detailed severity rating, is available from the CVE link in the
  References section.

  The autofs utility controls the operation of the automount daemon. The
  daemon automatically mounts file systems when in use and unmounts them when
  they are not busy.

  It was found that program-based automounter maps that used interpreted
  languages such as Python used standard environment variables to locate
  and load modules of those languages. A local attacker could potentially use
  this flaw to escalate their privileges on the system. (CVE-2014-8169)

  Note: This issue has been fixed by adding the "AUTOFS_" prefix to the
  affected environment variables so that they are not used to subvert the
  system. A configuration option ("force_standard_program_map_env") to
  override this prefix and to use the environment variables without the
  prefix has been added. In addition, warnings have been added to the manual
  page and to the installed configuration file. Now, by default the standard
  variables of the program map are provided only with the prefix added to
  its name.

  Red Hat would like to thank the Georgia Institute of Technology for
  reporting this issue.

  Notably, this update fixes the following bugs:

  * When the "ls *" command was run in the root of an indirect mount, autofs
  attempted to literally mount the wildcard character (*) causing it to be
  added to the negative cache. If done before a valid mount, autofs then
  failed on further mount attempts inside the mount point, valid or not. This
  has been fixed, and wildcard map entries now function in the described
  situation. (BZ#1166457)

  * When autofs encountered a syntax error consisting of a duplicate entry in
  a multimap entry, it reported an error and did not mount the map entry.
  With this update, autofs has been amended to report the problem in the log
  to alert the system administrator and use the last seen instance of the
  duplicate entry rather than fail. (BZ#1205600)

  * In the ldap and sss lookup modules, the map reading functions did not
  distinguish between the "no entry found" and "service not available"
  errors. Consequently, when the "service not available" response was
  returned from a master map read, autofs did not update the mounts.
  An "entry not found" return does not prevent the map update, so the ldap
  and sss lookup modules were updated to distinguish between these two
  returns and now work as expected. (BZ#1233065)

  In addition, this update adds the following enhancement:

  * The description of the configuration parameter map_hash_table_size was
  missing from the autofs.conf(5) man page and its description in the
  configuration file comments was insufficient. A description of the
  parameter has been added to autofs.conf(5), and the configuration file
  comments have been updated. (BZ#1238573)

  All autofs users are advised to upgrade to these updated packages, which
  contain backported patches to correct these issues and add this
  enhancement.
impacted_packages:
  - purl: pkg:rpm/redhat/autofs?arch=x86_64&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/autofs-debuginfo?arch=x86_64&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/autofs?arch=src&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/autofs-debuginfo?arch=s390x&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/autofs?arch=s390x&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/autofs-debuginfo?arch=ppc64&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/autofs?arch=ppc64&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/autofs-debuginfo?arch=aarch64&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/autofs?arch=aarch64&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/autofs-debuginfo?arch=ppc64le&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/autofs?arch=ppc64le&epoch=1
    affected_versions: vers:rpm/<5.0.7-54.el7
    fixed_versions: vers:rpm/5.0.7-54.el7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_2417.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1192565
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_2417.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1161474
    reference_type: bug
    reference_id: 1161474
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1166457
    reference_type: bug
    reference_id: 1166457
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1201582
    reference_type: bug
    reference_id: 1201582
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1218045
    reference_type: bug
    reference_id: 1218045
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1233067
    reference_type: bug
    reference_id: 1233067
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1233069
    reference_type: bug
    reference_id: 1233069
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1263508
    reference_type: bug
    reference_id: 1263508
  - url: https://access.redhat.com/errata/RHSA-2015:2417
    reference_type:
    reference_id: RHSA-2015:2417
