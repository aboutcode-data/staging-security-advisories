advisory_id: RHSA-2010:0998
datasource_id: redhat_importer_v2/RHSA-2010:0998
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2010/rhsa-2010_0998.json
aliases:
  - CVE-2010-3881
summary: |
  Updated kvm packages that fix one security issue and three bugs are now
  available for Red Hat Enterprise Linux 5.

  The Red Hat Security Response Team has rated this update as having low
  security impact. A Common Vulnerability Scoring System (CVSS) base score,
  which gives a detailed severity rating, is available from the CVE link in
  the References section.

  KVM (Kernel-based Virtual Machine) is a full virtualization solution for
  Linux on AMD64 and Intel 64 systems. KVM is a Linux kernel module built for
  the standard Red Hat Enterprise Linux kernel.

  It was found that some structure padding and reserved fields in certain
  data structures in QEMU-KVM were not initialized properly before being
  copied to user-space. A privileged host user with access to "/dev/kvm"
  could use this flaw to leak kernel stack memory to user-space.
  (CVE-2010-3881)

  Red Hat would like to thank Vasiliy Kulikov for reporting this issue.

  This update also fixes the following bugs:

  * The 'kvm_amd' kernel module did not initialize the TSC (Time Stamp
  Counter) offset in the VMCB (Virtual Machine Control Block) correctly.
  After a vCPU (virtual CPU) has been created, the TSC offset in the VMCB
  should have a negative value so that the virtual machine will see TSC
  values starting at zero. However, the TSC offset was set to zero and
  therefore the virtual machine saw the same TSC value as the host. With this
  update, the TSC offset has been updated to show the correct values.
  (BZ#656984)

  * Setting the boot settings of a virtual machine to, firstly, boot from PXE
  and, secondly, to boot from the hard drive would result in a PXE boot loop,
  that is, the virtual machine would not continue to boot from the hard drive
  if the PXE boot failed. This was caused by a flaw in the 'bochs-bios' (part
  of KVM) code. With this update, after a virtual machine tries to boot from
  PXE and fails, it continues to boot from a hard drive if there is one
  present. (BZ#659850)

  * If a 64-bit Red Hat Enterprise Linux 5.5 virtual machine was migrated to
  another host with a different CPU clock speed, the clock of that virtual
  machine would consistently lose or gain time (approximately half a second
  for every second the host is running). On machines that do not use the kvm
  clock, the network time protocol daemon (ntpd) could correct the time
  drifts caused by migration. However, using the pvclock caused the time to
  change consistently. This was due to flaws in the save/load functions of
  pvclock. With this update, the issue has been fixed and migrating a virtual
  machine no longer causes time drift. (BZ#660239)

  All KVM users should upgrade to these updated packages, which contain
  backported patches to correct these issues. Note: The procedure in the
  Solution section must be performed before this update will take effect.
impacted_packages:
  - purl: pkg:rpm/redhat/kvm-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<83-164.el5_5.30
    fixed_versions: vers:rpm/83-164.el5_5.30
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kmod-kvm?arch=x86_64
    affected_versions: vers:rpm/<83-164.el5_5.30
    fixed_versions: vers:rpm/83-164.el5_5.30
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm?arch=x86_64
    affected_versions: vers:rpm/<83-164.el5_5.30
    fixed_versions: vers:rpm/83-164.el5_5.30
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm-qemu-img?arch=x86_64
    affected_versions: vers:rpm/<83-164.el5_5.30
    fixed_versions: vers:rpm/83-164.el5_5.30
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm-tools?arch=x86_64
    affected_versions: vers:rpm/<83-164.el5_5.30
    fixed_versions: vers:rpm/83-164.el5_5.30
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm?arch=src
    affected_versions: vers:rpm/<83-164.el5_5.30
    fixed_versions: vers:rpm/83-164.el5_5.30
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Low
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2010/rhsa-2010_0998.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#low
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=649920
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2010/rhsa-2010_0998.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=656984
    reference_type: bug
    reference_id: 656984
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=659850
    reference_type: bug
    reference_id: 659850
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=660239
    reference_type: bug
    reference_id: 660239
  - url: https://access.redhat.com/errata/RHSA-2010:0998
    reference_type:
    reference_id: RHSA-2010:0998
