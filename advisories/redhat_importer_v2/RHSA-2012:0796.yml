advisory_id: RHSA-2012:0796
datasource_id: redhat_importer_v2/RHSA-2012:0796
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0796.json
aliases:
  - CVE-2011-4623
summary: |
  Updated rsyslog packages that fix one security issue, multiple bugs, and
  add two enhancements are now available for Red Hat Enterprise Linux 6.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. A Common Vulnerability Scoring System (CVSS) base score,
  which gives a detailed severity rating, is available from the CVE link in
  the References section.

  The rsyslog packages provide an enhanced, multi-threaded syslog daemon.

  A numeric truncation error, leading to a heap-based buffer overflow, was
  found in the way the rsyslog imfile module processed text files containing
  long lines. An attacker could use this flaw to crash the rsyslogd daemon
  or, possibly, execute arbitrary code with the privileges of rsyslogd, if
  they are able to cause a long line to be written to a log file that
  rsyslogd monitors with imfile. The imfile module is not enabled by default.
  (CVE-2011-4623)

  Bug fixes:

  * Several variables were incorrectly deinitialized with Transport Layer
  Security (TLS) transport and keys in PKCS#8 format. The rsyslogd daemon
  aborted with a segmentation fault when keys in this format were provided.
  Now, the variables are correctly deinitialized. (BZ#727380)

  * Previously, the imgssapi plug-in initialization was incomplete. As a
  result, the rsyslogd daemon aborted when configured to provide a GSSAPI
  listener. Now, the plug-in is correctly initialized. (BZ#756664)

  * The fully qualified domain name (FQDN) for the localhost used in messages
  was the first alias found. This did not always produce the expected result
  on multihomed hosts. With this update, the algorithm uses the alias that
  corresponds to the hostname. (BZ#767527)

  * The gtls module leaked a file descriptor every time it was loaded due to
  an error in the GnuTLS library. No new files or network connections could
  be opened when the limit for the file descriptor count was reached. This
  update modifies the gtls module so that it is not unloaded during the
  process lifetime. (BZ#803550)

  * rsyslog could not override the hostname to set an alternative hostname
  for locally generated messages. Now, the local hostname can be overridden.
  (BZ#805424)

  * The rsyslogd init script did not pass the lock file path to the 'status'
  action. As a result, the lock file was ignored and a wrong exit code was
  returned. This update modifies the init script to pass the lock file to
  the 'status' action. Now, the correct exit code is returned. (BZ#807608)

  * Data could be incorrectly deinitialized when rsyslogd was supplied with
  malformed spool files. The rsyslogd daemon could be aborted with a
  segmentation fault. This update modifies the underlying code to correctly
  deinitialize the data. (BZ#813079)

  * Previously, deinitialization of non-existent data could, in certain error
  cases, occur. As a result, rsyslogd could abort with a segmentation fault
  when rsyslog was configured to use a disk assisted queue without specifying
  a spool file. With this update, the error cases are handled gracefully.
  (BZ#813084)

  * The manual page wrongly stated that the '-d' option to turn on debugging
  caused the daemon to run in the foreground, which was misleading as the
  current behavior is to run in the background. Now, the manual page reflects
  the correct behavior. (BZ#820311)

  * rsyslog attempted to write debugging messages to standard output even
  when run in the background. This resulted in the debugging information
  being written to some other output. This was corrected and the debug
  messages are no longer written to standard output when run in the
  background. (BZ#820996)

  * The string buffer to hold the distinguished name (DN) of a certificate
  was too small. DNs with more than 128 characters were not displayed. This
  update enlarges the buffer to process longer DNs. (BZ#822118)

  Enhancements:

  * Support for rate limiting and multi-line message capability. Now,
  rsyslogd can limit the number of messages it accepts through a UNIX socket.
  (BZ#672182)

  * The addition of the "/etc/rsyslog.d/" configuration directory to supply
  syslog configuration files. (BZ#740420)

  All users of rsyslog are advised to upgrade to these updated packages,
  which upgrade rsyslog to version 5.8.10 and correct these issues and add
  these enhancements. After installing this update, the rsyslog daemon will
  be restarted automatically.
impacted_packages:
  - purl: pkg:rpm/redhat/rsyslog-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-snmp?arch=x86_64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-gssapi?arch=x86_64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-pgsql?arch=x86_64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-mysql?arch=x86_64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-relp?arch=x86_64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-gnutls?arch=x86_64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog?arch=x86_64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-debuginfo?arch=i686
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-snmp?arch=i686
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-gssapi?arch=i686
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-pgsql?arch=i686
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-mysql?arch=i686
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-relp?arch=i686
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-gnutls?arch=i686
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog?arch=i686
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog?arch=src
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-gssapi?arch=ppc64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-pgsql?arch=ppc64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-mysql?arch=ppc64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-relp?arch=ppc64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-gnutls?arch=ppc64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog?arch=ppc64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-snmp?arch=ppc64
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-debuginfo?arch=s390x
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-gssapi?arch=s390x
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-pgsql?arch=s390x
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-mysql?arch=s390x
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-relp?arch=s390x
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-gnutls?arch=s390x
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog?arch=s390x
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rsyslog-snmp?arch=s390x
    affected_versions: vers:rpm/<5.8.10-2.el6
    fixed_versions: vers:rpm/5.8.10-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0796.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=769822
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0796.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=740420
    reference_type: bug
    reference_id: 740420
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=803550
    reference_type: bug
    reference_id: 803550
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=813079
    reference_type: bug
    reference_id: 813079
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=813084
    reference_type: bug
    reference_id: 813084
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=820311
    reference_type: bug
    reference_id: 820311
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=820996
    reference_type: bug
    reference_id: 820996
  - url: https://access.redhat.com/errata/RHSA-2012:0796
    reference_type:
    reference_id: RHSA-2012:0796
