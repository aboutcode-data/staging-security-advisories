advisory_id: RHSA-2024:0774
datasource_id: redhat_importer_v2/RHSA-2024:0774
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2024/rhsa-2024_0774.json
aliases:
  - CVE-2021-4213
summary: "An update is now available for Red Hat Certificate System 10.4 for RHEL 8.\nRed Hat\
  \ Product Security has rated this update as having a security impact of Moderate. A Common\
  \ Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating,\
  \ is available for each vulnerability from the CVE link in the References section.\n\nRed\
  \ Hat Certificate System (RHCS) is a complete implementation of an enterprise software system\
  \ designed to manage enterprise Public Key Infrastructure (PKI) deployments.\n\nSecurity fixes:\n\
  \n* JSS: memory leak in TLS connection leads to OOM (CVE-2021-4213)\n\n* pki-core:10.6/jss:\
  \ memory leak in TLS connection leads to OOM (CVE-2021-4213)\n\nFor more details about the\
  \ security issues, refer to the link in the References section.\n\nBug fixes:\n\n* no ROLE_ASSUME\
  \ audit messages seen in TPS audit log (BZ#1549887)\n\n* Unassign certificate enrollment request\
  \ not working (BZ#1858702)\n\n* Date Format on the TPS Agent Page (BZ#1984455)\n\n* Directory\
  \ authentication plugin requires directory admin password just for user authentication (BZ#2017505)\
  \ \n\n* Add SCEP AES support (BZ#2075363)\n\n* JSS cannot be properly initialized after using\
  \ another NSS-backed security provider (BZ#2087224) \n\n* Empty subject field in CSR causes\
  \ failure to certificate issuance (BZ#2105471)\n\n* RA Separation by KeyType - Set Token Status\
  \ (BZ#2106153)\n\n* Disallowed \"supported_groups\" in TLS1.2 key exchange (BZ#2113782)\n\n\
  * Some unsusable profiles are present in CA's EE page (BZ#2118662)\n\n* ClientIP and ServerIP\
  \ are missing in ACCESS_SESSION_ESTABLISH/ACCESS_SESSION_TERMINATED Audit Event when PKI is\
  \ acting as a Server (BZ#2122502)\n\n* add AES support for TMS server-side keygen on latest\
  \ HSM / FIPS environment (BZ#2123071)\n\n* CA's Key Escrow is Failing Through httpd Reverse\
  \ Proxy (BZ#2130250)\n\n* Provide Enrollment over Secure Transport / EST interface to Dogtag\
  \ / RFC 7030 to support SCEP over EST (BZ#2142893)\n\n* DHE ciphers not working (dropping\
  \ DHE ciphersuites) (BZ#2142903) \n\n* pkiconsole unable to connect pki servers that's in\
  \ fips mode with client cert (BZ#2142904)\n\n* KRA and OCSP display banner prompts during\
  \ pkispawn (BZ#2142905) \n\n* missing audit event CLIENT_ACCESS_SESSION_ESTABLISH when CS\
  \ instance acting as a client and fails to connect (BZ#2142906)\n\n* EST prep work (BZ#2142907)\n\
  \n* add AES support for TMS Shared Secret on latest HSM / FIPS environment (BZ#2142908)\n\n\
  * CS instance when acting as a client does not observe the cipher list set in server.xml (BZ#2142909)\
  \ \n\n* OCSP using AIA extension fails (BZ#2144080)\n\n* Lightweight CA: Add support for multiple\
  \ sub-CAs underneath primary CA (BZ#2149115) \n\n* TPS Not allowing Token Status Change based\
  \ on Revoke True/False and Hold till last True/False (BZ#2166003)\n\n* Unable to use the TPS\
  \ UI \"Token Filter\" to filter a list of tokens (BZ#2179307)\n\n* TPS Not allowing Token\
  \ Status Change based on Revoke True/False and Hold till last True/False (part 2) (BZ#2181142)\n\
  \n* root CA signing cert should not have AIA extension (BZ#2182201)\n\n* PrettyPrintCert does\
  \ not properly translate AIA information into a readable format (BZ#2184930)\n\n* OCSP AddCRLServlet\
  \ \"SEVERE...NOT SUPPORTED\" log messages (BZ#2190283)\n\n* PrettyPrintCert does not properly\
  \ translate Subject Information Access information into a readable format (BZ#2209624)\n\n\
  * OCSP Responder not responding to certs issued by unknown CAs (BZ#2221818)\n\n* pkispawn\
  \ non-CA pki instance result in TLS client-authentication to its internaldb not finding pkidbuser\
  \ by default (BZ#2228209)\n\n* pkispawn externally signed sub CA clone with Thales Luna HSM\
  \ fails: UNKNOWN_ISSUER (BZ#2228922)\n\n* OCSP responder to serve status check for itself\
  \ using latest CRL (BZ#2229930)\n\n* RHCS Fails to Upgrade if Profile Does not exist (BZ#2230102)\n\
  \n* CLIENT_ACCESS_SESSION_* audit events contain wrong ServerPort (BZ#2233740)\n\n* Server-side\
  \ Key Generation Produces Certificates with Identical SKID (BZ#2246422)\n\n* Generating Keys\
  \ with no OpsFlagMask set - ThalesHSM integration (BZ#2251981)\n\n* RootCA's OCSP fails to\
  \ install with the SHA-2 subjectKeyIdentifier extension (BZ#2253044)\n\n* Make key wrapping\
  \ algorithm configurable between AES-KWP and AES-CBC (BZ#2253675)\n\n* pkidestroy log keeps\
  \ HSM token password (BZ#2253683)\n\nUsers of RHCS 10 are advised to upgrade to these updated\
  \ packages."
impacted_packages:
  - purl: pkg:rpm/redhat/idm-console-framework?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<1.3.0-1.module+el8pki+14677+1ef79a68
    fixed_versions: vers:rpm/1.3.0-1.module+el8pki+14677+1ef79a68
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ldapjdk?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<4.23.0-1.module+el8pki+14677+1ef79a68
    fixed_versions: vers:rpm/4.23.0-1.module+el8pki+14677+1ef79a68
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ldapjdk-javadoc?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<4.23.0-1.module+el8pki+14677+1ef79a68
    fixed_versions: vers:rpm/4.23.0-1.module+el8pki+14677+1ef79a68
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python3-redhat-pki?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-acme?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-base?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-base-java?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-ca?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-console?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-console-theme?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-est?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-javadoc?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-kra?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-ocsp?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-server?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-server-theme?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-tks?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcatjss?arch=noarch&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<7.7.3-1.module+el8pki+19895+c800dfbd
    fixed_versions: vers:rpm/7.7.3-1.module+el8pki+19895+c800dfbd
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/idm-console-framework?arch=src&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<1.3.0-1.module+el8pki+14677+1ef79a68
    fixed_versions: vers:rpm/1.3.0-1.module+el8pki+14677+1ef79a68
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/jss?arch=src&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<4.9.8-1.module+el8pki+19895+c800dfbd
    fixed_versions: vers:rpm/4.9.8-1.module+el8pki+19895+c800dfbd
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ldapjdk?arch=src&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<4.23.0-1.module+el8pki+14677+1ef79a68
    fixed_versions: vers:rpm/4.23.0-1.module+el8pki+14677+1ef79a68
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki?arch=src&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcatjss?arch=src&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<7.7.3-1.module+el8pki+19895+c800dfbd
    fixed_versions: vers:rpm/7.7.3-1.module+el8pki+19895+c800dfbd
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/jss?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<4.9.8-1.module+el8pki+19895+c800dfbd
    fixed_versions: vers:rpm/4.9.8-1.module+el8pki+19895+c800dfbd
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/jss-debuginfo?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<4.9.8-1.module+el8pki+19895+c800dfbd
    fixed_versions: vers:rpm/4.9.8-1.module+el8pki+19895+c800dfbd
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/jss-debugsource?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<4.9.8-1.module+el8pki+19895+c800dfbd
    fixed_versions: vers:rpm/4.9.8-1.module+el8pki+19895+c800dfbd
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/jss-javadoc?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<4.9.8-1.module+el8pki+19895+c800dfbd
    fixed_versions: vers:rpm/4.9.8-1.module+el8pki+19895+c800dfbd
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-debuginfo?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-debugsource?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-symkey?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-symkey-debuginfo?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-tools?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-tools-debuginfo?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-tps?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/redhat-pki-tps-debuginfo?arch=x86_64&rpmmod=redhat-pki:10:8060020231220182310:07fb4edf
    affected_versions: vers:rpm/<10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_versions: vers:rpm/10.13.9-5.module+el8pki+21062+4ed906e8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2024/rhsa-2024_0774.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2024/rhsa-2024_0774.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2042900
    reference_type: bug
    reference_id: 2042900
  - url: https://access.redhat.com/errata/RHSA-2024:0774
    reference_type:
    reference_id: RHSA-2024:0774
