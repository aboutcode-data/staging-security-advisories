advisory_id: RHSA-2012:1401
datasource_id: redhat_importer_v2/RHSA-2012:1401
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_1401.json
aliases:
  - CVE-2012-3412
summary: |
  Updated kernel packages that fix one security issue and several bugs are
  now available for Red Hat Enterprise Linux 6.2 Extended Update Support.

  The Red Hat Security Response Team has rated this update as having
  important security impact. A Common Vulnerability Scoring System (CVSS)
  base score, which gives a detailed severity rating, is available from the
  CVE link in the References section.

  The kernel packages contain the Linux kernel, the core of any Linux
  operating system.

  This update fixes the following security issue:

  * A flaw was found in the way socket buffers (skb) requiring TSO (TCP
  segment offloading) were handled by the sfc driver. If the skb did not fit
  within the minimum-size of the transmission queue, the network card could
  repeatedly reset itself. A remote attacker could use this flaw to cause a
  denial of service. (CVE-2012-3412, Important)

  Red Hat would like to thank Ben Hutchings of Solarflare (tm) for reporting
  CVE-2012-3412.

  This update also fixes the following bugs:

  * Previously, when a server attempted to shut down a socket, the
  svc_tcp_sendto() function set the XPT_CLOSE variable if the entire reply
  failed to be transmitted. However, before XPT_CLOSE could be acted upon,
  other threads could send further replies before the socket was really shut
  down. Consequently, data corruption could occur in the RPC record marker.
  With this update, send operations on a closed socket are stopped
  immediately, thus preventing this bug. (BZ#853256)

  * When a PIT (Programmable Interval Timer) MSB (Most Significant Byte)
  transition occurred very close to an SMI (System Management Interrupt)
  execution, the pit_verify_msb() function did not see the MSB transition.
  Consequently, the pit_expect_msb() function returned success incorrectly,
  eventually causing a large clock drift in the quick_pit_calibrate()
  function. As a result, the TSC (Time Stamp Counter) calibration on some
  systems was off by Â± 20 MHz, which led to inaccurate timekeeping or ntp
  synchronization failures. This update fixes pit_expect_msb() and the clock
  drift no longer occurs in the described scenario. (BZ#853952)

  * Sometimes, the crypto allocation code could become unresponsive for 60
  seconds or multiples thereof due to an incorrect notification mechanism.
  This could cause applications, like Openswan, to become unresponsive. The
  notification mechanism has been improved to avoid such hangs. (BZ#854475)

  * Traffic to the NFS server could trigger a kernel oops in the
  svc_tcp_clear_pages() function. The source code has been modified, and the
  kernel oops no longer occurs in this scenario. (BZ#856105)

  * Under certain circumstances, a system crash could result in data loss on
  XFS file systems. If files were created immediately before the file system
  was left to idle for a long period of time and then the system crashed,
  those files could appear as zero-length once the file system was remounted.
  This occurred even if a sync or fsync was run on the files. This was
  because XFS was not correctly idling the journal, and therefore it
  incorrectly replayed the inode allocation transactions upon mounting after
  the system crash, which zeroed the file size. This problem has been fixed
  by re-instating the periodic journal idling logic to ensure that all
  metadata is flushed within 30 seconds of modification, and the journal is
  updated to prevent incorrect recovery operations from occurring.
  (BZ#856685)

  * On architectures with the 64-bit cputime_t type, it was possible to
  trigger the "divide by zero" error, namely, on long-lived processes. A
  patch has been applied to address this problem, and the "divide by zero"
  error no longer occurs under these circumstances. (BZ#856702)

  Users should upgrade to these updated packages, which contain backported
  patches to resolve these issues. The system must be rebooted for this
  update to take effect.
impacted_packages:
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common-s390x?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump-devel?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=s390x
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common-ppc64?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-bootwrapper?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common-x86_64?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common-i686?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=i686
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=src
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-firmware?arch=noarch
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-doc?arch=noarch
    affected_versions: vers:rpm/<2.6.32-220.28.1.el6
    fixed_versions: vers:rpm/2.6.32-220.28.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_1401.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_1401.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=844714
    reference_type: bug
    reference_id: 844714
  - url: https://access.redhat.com/errata/RHSA-2012:1401
    reference_type:
    reference_id: RHSA-2012:1401
