advisory_id: RHSA-2012:1233
datasource_id: redhat_importer_v2/RHSA-2012:1233
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_1233.json
aliases:
  - CVE-2012-3515
summary: |
  Updated qemu-kvm-rhev packages that fix one security issue and two bugs are
  now available for Red Hat Enterprise Linux 6.

  The Red Hat Security Response Team has rated this update as having
  important security impact. A Common Vulnerability Scoring System (CVSS)
  base score, which gives a detailed severity rating, is available from the
  CVE link in the References section.

  KVM (Kernel-based Virtual Machine) is a full virtualization solution for
  Linux on AMD64 and Intel 64 systems. The qemu-kvm-rhev packages form the
  user-space component for running virtual machines using KVM.

  A flaw was found in the way QEMU handled VT100 terminal escape sequences
  when emulating certain character devices. A guest user with privileges to
  write to a character device that is emulated on the host using a virtual
  console back-end could use this flaw to crash the qemu-kvm process on the
  host or, possibly, escalate their privileges on the host. (CVE-2012-3515)

  When using qemu-kvm-rhev on a Red Hat Enterprise Linux 6 host not managed
  by Red Hat Enterprise Virtualization:

  * This flaw did not affect the default use of KVM. Affected configurations
  were:

  - When guests were started from the command line ("/usr/libexec/qemu-kvm")
  without the "-nodefaults" option, and also without specifying a
  serial or parallel device, or a virtio-console device, that specifically
  does not use a virtual console (vc) back-end. (Note that Red Hat does not
  support invoking "qemu-kvm" from the command line without "-nodefaults" on
  Red Hat Enterprise Linux 6.)

  - Guests that were managed via libvirt, such as when using Virtual Machine
  Manager (virt-manager), but that have a serial or parallel device, or a
  virtio-console device, that uses a virtual console back-end. By default,
  guests managed via libvirt will not use a virtual console back-end for such
  devices.

  When using qemu-kvm-rhev on a Red Hat Enterprise Virtualization managed Red
  Hat Enterprise Linux 6 host:

  * This flaw did not affect the default use of a Red Hat Enterprise
  Virtualization host: it is not possible to add a device that uses a virtual
  console back-end via Red Hat Enterprise Virtualization Manager.

  To specify a virtual console back-end for a device and therefore be
  vulnerable to this issue, the device would have to be created another way,
  for example, by using a VDSM hook.

  Red Hat would like to thank the Xen project for reporting this issue.

  This update also fixes the following bugs:

  * Previously, the KVM modules were not loaded by the postinstall scriptlet
  of RPM scripts. This bug caused various issues and required the system to
  be rebooted to resolve them. With this update, the modules are loaded
  properly by the scriptlet and no unnecessary reboots are now required.
  (BZ#839897)

  * Previously, when a guest was started up with two serial devices, qemu-kvm
  returned an error message and terminated the boot because IRQ 4 for the ISA
  bus was being used by both devices. This update fixes the qemu-kvm code,
  which allows IRQ 4 to be used by more than one device on the ISA bus, and
  the boot now succeeds in the described scenario. (BZ#840054)

  All users of qemu-kvm-rhev are advised to upgrade to these updated
  packages, which fix these issues. After installing this update, shut down
  all running virtual machines. Once all virtual machines have shut down,
  start them again for this update to take effect.
impacted_packages:
  - purl: pkg:rpm/redhat/qemu-kvm-rhev?arch=src&epoch=2
    affected_versions: vers:rpm/<0.12.1.2-2.295.el6_3.2
    fixed_versions: vers:rpm/0.12.1.2-2.295.el6_3.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm-rhev?arch=x86_64&epoch=2
    affected_versions: vers:rpm/<0.12.1.2-2.295.el6_3.2
    fixed_versions: vers:rpm/0.12.1.2-2.295.el6_3.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-img-rhev?arch=x86_64&epoch=2
    affected_versions: vers:rpm/<0.12.1.2-2.295.el6_3.2
    fixed_versions: vers:rpm/0.12.1.2-2.295.el6_3.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm-rhev-debuginfo?arch=x86_64&epoch=2
    affected_versions: vers:rpm/<0.12.1.2-2.295.el6_3.2
    fixed_versions: vers:rpm/0.12.1.2-2.295.el6_3.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm-rhev-tools?arch=x86_64&epoch=2
    affected_versions: vers:rpm/<0.12.1.2-2.295.el6_3.2
    fixed_versions: vers:rpm/0.12.1.2-2.295.el6_3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_1233.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_1233.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=851252
    reference_type: bug
    reference_id: 851252
  - url: https://access.redhat.com/errata/RHSA-2012:1233
    reference_type:
    reference_id: RHSA-2012:1233
