advisory_id: RHSA-2015:0425
datasource_id: redhat_importer_v2/RHSA-2015:0425
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_0425.json
aliases:
  - CVE-2014-2653
  - CVE-2014-9278
summary: |
  Updated openssh packages that fix two security issues, several bugs, and
  add various enhancements are now available for Red Hat Enterprise Linux 7.

  Red Hat Product Security has rated this update as having Moderate security
  impact. Common Vulnerability Scoring System (CVSS) base scores, which give
  detailed severity ratings, are available for each vulnerability from the
  CVE links in the References section.

  OpenSSH is OpenBSD's SSH (Secure Shell) protocol implementation. These packages include the core files necessary for both the OpenSSH client and server.

  It was discovered that OpenSSH clients did not correctly verify DNS SSHFP records. A malicious server could use this flaw to force a connecting client to skip the DNS SSHFP record check and require the user to perform manual host verification of the DNS SSHFP record. (CVE-2014-2653)

  It was found that when OpenSSH was used in a Kerberos environment, remote authenticated users were allowed to log in as a different user if they were listed in the ~/.k5users file of that user, potentially bypassing intended authentication restrictions. (CVE-2014-9278)

  The openssh packages have been upgraded to upstream version 6.6.1, which provides a number of bug fixes and enhancements over the previous version. (BZ#1059667)

  Bug fixes:

  * An existing /dev/log socket is needed when logging using the syslog utility, which is not possible for all chroot environments based on the user's home directories. As a consequence, the sftp commands were not logged in the chroot setup without /dev/log in the internal sftp subsystem. With this update, openssh has been enhanced to detect whether /dev/log exists. If /dev/log does not exist, processes in the chroot environment use their master processes for logging. (BZ#1083482)

  * The buffer size for a host name was limited to 64 bytes. As a consequence, when a host name was 64 bytes long or longer, the ssh-keygen utility failed. The buffer size has been increased to fix this bug, and ssh-keygen no longer fails in the described situation. (BZ#1097665)

  * Non-ASCII characters have been replaced by their octal representations in banner messages in order to prevent terminal re-programming attacks. Consequently, banners containing UTF-8 strings were not correctly displayed in a client. With this update, banner messages are processed according to RFC 3454, control characters have been removed, and banners containing UTF-8 strings are now displayed correctly. (BZ#1104662)

  * Red Hat Enterprise Linux uses persistent Kerberos credential caches, which are shared between sessions. Previously, the GSSAPICleanupCredentials option was set to "yes" by default. Consequently, removing a Kerberos cache on logout could remove unrelated credentials of other sessions, which could make the system unusable. To fix this bug, GSSAPICleanupCredentials is set by default to "no". (BZ#1134447)

  * Access permissions for the /etc/ssh/moduli file were set to 0600, which was unnecessarily strict. With this update, the permissions for /etc/ssh/moduli have been changed to 0644 to make the access to the file easier. (BZ#1134448)

  * Due to the KRB5CCNAME variable being truncated, the Kerberos ticket cache was not found after login using a Kerberos-enabled SSH connection. The underlying source code has been modified to fix this bug, and Kerberos authentication works as expected in the described situation. (BZ#1161173)

  Enhancements:

  * When the sshd daemon is configured to force the internal SFTP session, a connection other then SFTP is used, the appropriate message is logged to the /var/log/secure file. (BZ#1130198)

  * The sshd-keygen service was run using the "ExecStartPre=-/usr/sbin/sshd-keygen" option in the sshd.service unit file. With this update, the separate sshd-keygen.service unit file has been added, and sshd.service has been adjusted to require sshd-keygen.service. (BZ#1134997)

  Users of openssh are advised to upgrade to these updated packages, which correct these issues and add these enhancements.
impacted_packages:
  - purl: pkg:rpm/redhat/openssh-keycat?arch=s390x
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-clients?arch=s390x
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-askpass?arch=s390x
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh?arch=s390x
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-server?arch=s390x
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=s390x
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=s390x
    affected_versions: vers:rpm/<0.9.3-9.11.el7
    fixed_versions: vers:rpm/0.9.3-9.11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-ldap?arch=s390x
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-server-sysvinit?arch=s390x
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-keycat?arch=ppc64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-clients?arch=ppc64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-askpass?arch=ppc64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh?arch=ppc64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-server?arch=ppc64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=ppc64
    affected_versions: vers:rpm/<0.9.3-9.11.el7
    fixed_versions: vers:rpm/0.9.3-9.11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-ldap?arch=ppc64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-server-sysvinit?arch=ppc64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-keycat?arch=x86_64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-clients?arch=x86_64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-askpass?arch=x86_64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh?arch=x86_64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-server?arch=x86_64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=x86_64
    affected_versions: vers:rpm/<0.9.3-9.11.el7
    fixed_versions: vers:rpm/0.9.3-9.11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-ldap?arch=x86_64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-server-sysvinit?arch=x86_64
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh?arch=src
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=i686
    affected_versions: vers:rpm/<0.9.3-9.11.el7
    fixed_versions: vers:rpm/0.9.3-9.11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=i686
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=ppc
    affected_versions: vers:rpm/<0.9.3-9.11.el7
    fixed_versions: vers:rpm/0.9.3-9.11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=ppc
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=s390
    affected_versions: vers:rpm/<0.9.3-9.11.el7
    fixed_versions: vers:rpm/0.9.3-9.11.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=s390
    affected_versions: vers:rpm/<6.6.1p1-11.el7
    fixed_versions: vers:rpm/6.6.1p1-11.el7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_0425.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1169843
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_0425.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1071967
    reference_type: bug
    reference_id: 1071967
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1081338
    reference_type: bug
    reference_id: 1081338
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1084079
    reference_type: bug
    reference_id: 1084079
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1097665
    reference_type: bug
    reference_id: 1097665
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1102288
    reference_type: bug
    reference_id: 1102288
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1134997
    reference_type: bug
    reference_id: 1134997
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1143867
    reference_type: bug
    reference_id: 1143867
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1153011
    reference_type: bug
    reference_id: 1153011
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1155626
    reference_type: bug
    reference_id: 1155626
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1161173
    reference_type: bug
    reference_id: 1161173
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1162620
    reference_type: bug
    reference_id: 1162620
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=912792
    reference_type: bug
    reference_id: 912792
  - url: https://access.redhat.com/errata/RHSA-2015:0425
    reference_type:
    reference_id: RHSA-2015:0425
