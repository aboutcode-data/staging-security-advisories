advisory_id: RHSA-2012:0902
datasource_id: redhat_importer_v2/RHSA-2012:0902
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0902.json
aliases:
  - CVE-2012-1586
summary: |
  An updated cifs-utils package that fixes one security issue, multiple bugs,
  and adds various enhancements is now available for Red Hat
  Enterprise Linux 6.

  The Red Hat Security Response Team has rated this update as having low
  security impact. A Common Vulnerability Scoring System (CVSS) base score,
  which gives a detailed severity rating, is available from the CVE link in
  the References section.

  The cifs-utils package contains tools for mounting and managing shares on
  Linux using the SMB/CIFS protocol. The CIFS shares can be used as standard
  Linux file systems.

  A file existence disclosure flaw was found in mount.cifs. If the tool was
  installed with the setuid bit set, a local attacker could use this flaw to
  determine the existence of files or directories in directories not
  accessible to the attacker. (CVE-2012-1586)

  Note: mount.cifs from the cifs-utils package distributed by Red Hat does
  not have the setuid bit set. We recommend that administrators do not
  manually set the setuid bit for mount.cifs.

  This update also fixes the following bugs:

  * The cifs.mount(8) manual page was previously missing documentation for
  several mount options. With this update, the missing entries have been
  added to the manual page. (BZ#769923)

  * Previously, the mount.cifs utility did not properly update the
  "/etc/mtab" system information file when remounting an existing CIFS
  mount. Consequently, mount.cifs created a duplicate entry of the existing
  mount entry. This update adds the del_mtab() function to cifs.mount, which
  ensures that the old mount entry is removed from "/etc/mtab" before adding
  the updated mount entry. (BZ#770004)

  * The mount.cifs utility did not properly convert user and group names to
  numeric UIDs and GIDs. Therefore, when the "uid", "gid" or "cruid" mount
  options were specified with user or group names, CIFS shares were mounted
  with default values. This caused shares to be inaccessible to the intended
  users because UID and GID is set to "0" by default. With this update, user
  and group names are properly converted so that CIFS shares are now mounted
  with specified user and group ownership as expected. (BZ#796463)

  * The cifs.upcall utility did not respect the "domain_realm" section in
  the "krb5.conf" file and worked only with the default domain.
  Consequently, an attempt to mount a CIFS share from a different than the
  default domain failed with the following error message:

      mount error(126): Required key not available

  This update modifies the underlying code so that cifs.upcall handles
  multiple Kerberos domains correctly and CIFS shares can now be mounted as
  expected in a multi-domain environment. (BZ#805490)

  In addition, this update adds the following enhancements:

  * The cifs.upcall utility previously always used the "/etc/krb5.conf" file
  regardless of whether the user had specified a custom Kerberos
  configuration file. This update adds the "--krb5conf" option to
  cifs.upcall allowing the administrator to specify an alternate
  krb5.conf file. For more information on this option, refer to the
  cifs.upcall(8) manual page. (BZ#748756)

  * The cifs.upcall utility did not optimally determine the correct service
  principal name (SPN) used for Kerberos authentication, which occasionally
  caused krb5 authentication to fail when mounting a server's unqualified
  domain name. This update improves cifs.upcall so that the method used to
  determine the SPN is now more versatile. (BZ#748757)

  * This update adds the "backupuid" and "backupgid" mount options to the
  mount.cifs utility. When specified, these options grant a user or a group
  the right to access files with the backup intent. For more information on
  these options, refer to the mount.cifs(8) manual page. (BZ#806337)

  All users of cifs-utils are advised to upgrade to this updated package,
  which contains backported patches to fix these issues and add these
  enhancements.
impacted_packages:
  - purl: pkg:rpm/redhat/cifs-utils-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<4.8.1-10.el6
    fixed_versions: vers:rpm/4.8.1-10.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cifs-utils?arch=x86_64
    affected_versions: vers:rpm/<4.8.1-10.el6
    fixed_versions: vers:rpm/4.8.1-10.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cifs-utils-debuginfo?arch=i686
    affected_versions: vers:rpm/<4.8.1-10.el6
    fixed_versions: vers:rpm/4.8.1-10.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cifs-utils?arch=i686
    affected_versions: vers:rpm/<4.8.1-10.el6
    fixed_versions: vers:rpm/4.8.1-10.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cifs-utils?arch=src
    affected_versions: vers:rpm/<4.8.1-10.el6
    fixed_versions: vers:rpm/4.8.1-10.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cifs-utils-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<4.8.1-10.el6
    fixed_versions: vers:rpm/4.8.1-10.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cifs-utils?arch=ppc64
    affected_versions: vers:rpm/<4.8.1-10.el6
    fixed_versions: vers:rpm/4.8.1-10.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cifs-utils-debuginfo?arch=s390x
    affected_versions: vers:rpm/<4.8.1-10.el6
    fixed_versions: vers:rpm/4.8.1-10.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cifs-utils?arch=s390x
    affected_versions: vers:rpm/<4.8.1-10.el6
    fixed_versions: vers:rpm/4.8.1-10.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Low
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0902.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#low
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0902.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=748756
    reference_type: bug
    reference_id: 748756
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=748757
    reference_type: bug
    reference_id: 748757
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=807252
    reference_type: bug
    reference_id: 807252
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/linux/local/18783.txt
    reference_type: exploit
    reference_id: OSVDB-81490;CVE-2012-1586
  - url: https://access.redhat.com/errata/RHSA-2012:0902
    reference_type:
    reference_id: RHSA-2012:0902
