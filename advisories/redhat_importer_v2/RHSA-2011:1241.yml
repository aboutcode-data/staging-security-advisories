advisory_id: RHSA-2011:1241
datasource_id: redhat_importer_v2/RHSA-2011:1241
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_1241.json
aliases:
  - CVE-2011-1831
  - CVE-2011-1832
  - CVE-2011-1834
  - CVE-2011-1835
  - CVE-2011-1837
  - CVE-2011-3145
summary: |
  Updated ecryptfs-utils packages that fix several security issues are now
  available for Red Hat Enterprise Linux 5 and 6.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. Common Vulnerability Scoring System (CVSS) base scores,
  which give detailed severity ratings, are available for each vulnerability
  from the CVE links in the References section.

  eCryptfs is a stacked, cryptographic file system. It is transparent to the
  underlying file system and provides per-file granularity. eCryptfs is
  released as a Technology Preview for Red Hat Enterprise Linux 5 and 6.

  The setuid mount.ecryptfs_private utility allows users to mount an eCryptfs
  file system. This utility can only be run by users in the "ecryptfs" group.

  A race condition flaw was found in the way mount.ecryptfs_private checked
  the permissions of a requested mount point when mounting an encrypted file
  system. A local attacker could possibly use this flaw to escalate their
  privileges by mounting over an arbitrary directory. (CVE-2011-1831)

  A race condition flaw in umount.ecryptfs_private could allow a local
  attacker to unmount an arbitrary file system. (CVE-2011-1832)

  It was found that mount.ecryptfs_private did not handle certain errors
  correctly when updating the mtab (mounted file systems table) file,
  allowing a local attacker to corrupt the mtab file and possibly unmount an
  arbitrary file system. (CVE-2011-1834)

  An insecure temporary file use flaw was found in the ecryptfs-setup-private
  script. A local attacker could use this script to insert their own key that
  will subsequently be used by a new user, possibly giving the attacker
  access to the user's encrypted data if existing file permissions allow
  access. (CVE-2011-1835)

  A race condition flaw in mount.ecryptfs_private could allow a local
  attacker to overwrite arbitrary files. (CVE-2011-1837)

  A race condition flaw in the way temporary files were accessed in
  mount.ecryptfs_private could allow a malicious, local user to make
  arbitrary modifications to the mtab file. (CVE-2011-3145)

  A race condition flaw was found in the way mount.ecryptfs_private checked
  the permissions of the directory to mount. A local attacker could use this
  flaw to mount (and then access) a directory they would otherwise not have
  access to. Note: The fix for this issue is incomplete until a kernel-space
  change is made. Future Red Hat Enterprise Linux 5 and 6 kernel updates
  will correct this issue. (CVE-2011-1833)

  Red Hat would like to thank the Ubuntu Security Team for reporting these
  issues. The Ubuntu Security Team acknowledges Vasiliy Kulikov of Openwall
  and Dan Rosenberg as the original reporters of CVE-2011-1831,
  CVE-2011-1832, and CVE-2011-1833; Dan Rosenberg and Marc Deslauriers as the
  original reporters of CVE-2011-1834; Marc Deslauriers as the original
  reporter of CVE-2011-1835; and Vasiliy Kulikov of Openwall as the original
  reporter of CVE-2011-1837.

  Users of ecryptfs-utils are advised to upgrade to these updated packages,
  which contain backported patches to correct these issues.
impacted_packages:
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=x86_64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-gui?arch=x86_64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=x86_64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-python?arch=x86_64
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=x86_64
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=x86_64
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=i386
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=i386
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=i386
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-gui?arch=i386
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=src
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=src
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-gui?arch=ia64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=ia64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=ia64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=ia64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-gui?arch=ppc
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=ppc
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=ppc
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=ppc
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=ppc
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=ppc
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=ppc
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=ppc64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=ppc64
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-python?arch=ppc64
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=ppc64
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=ppc64
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-gui?arch=s390x
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=s390x
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=s390x
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=s390x
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-python?arch=s390x
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=s390x
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=s390x
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=s390x
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=s390
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=s390
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=s390
    affected_versions: vers:rpm/<75-5.el5_7.2
    fixed_versions: vers:rpm/75-5.el5_7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=s390
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=s390
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=s390
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-python?arch=i686
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-debuginfo?arch=i686
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils-devel?arch=i686
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ecryptfs-utils?arch=i686
    affected_versions: vers:rpm/<82-6.el6_1.3
    fixed_versions: vers:rpm/82-6.el6_1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_1241.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://access.redhat.com/support/offerings/techpreview/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=729465
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_1241.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=732607
    reference_type: bug
    reference_id: 732607
  - url: https://access.redhat.com/errata/RHSA-2011:1241
    reference_type:
    reference_id: RHSA-2011:1241
