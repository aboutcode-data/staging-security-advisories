advisory_id: RHSA-2009:1341
datasource_id: redhat_importer_v2/RHSA-2009:1341
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2009/rhsa-2009_1341.json
aliases:
  - CVE-2008-4579
  - CVE-2008-6552
summary: |
  Updated cman packages that fix several security issues, various bugs, and
  add enhancements are now available for Red Hat Enterprise Linux 5.

  This update has been rated as having low security impact by the Red Hat
  Security Response Team.

  The Cluster Manager (cman) utility provides services for managing a Linux
  cluster.

  Multiple insecure temporary file use flaws were found in fence_apc_snmp and
  ccs_tool. A local attacker could use these flaws to overwrite an arbitrary
  file writable by a victim running those utilities (typically root) with
  the output of the utilities via a symbolic link attack. (CVE-2008-4579,
  CVE-2008-6552)

  Bug fixes:

  * a buffer could overflow if cluster.conf had more than 52 entries per
  block inside the <cman> block. The limit is now 1024.

  * the output of the group_tool dump subcommands were NULL padded.

  * using device="" instead of label="" no longer causes qdiskd to
  incorrectly exit.

  * the IPMI fencing agent has been modified to time out after 10 seconds. It
  is also now possible to specify a different timeout value with the '-t'
  option.

  * the IPMI fencing agent now allows punctuation in passwords.

  * quickly starting and stopping the cman service no longer causes the
  cluster membership to become inconsistent across the cluster.

  * an issue with lock syncing caused 'receive_own from' errors to be logged
  to '/var/log/messages'.

  * an issue which caused gfs_controld to segfault when mounting hundreds of
  file systems has been fixed.

  * the LPAR fencing agent now properly reports status when an LPAR is in
  Open Firmware mode.

  * the LPAR fencing agent now works properly with systems using the
  Integrated Virtualization Manager (IVM).

  * the APC SNMP fencing agent now properly recognizes outletStatusOn and
  outletStatusOff return codes from the SNMP agent.

  * the WTI fencing agent can now connect to fencing devices with no
  password.

  * the rps-10 fencing agent now properly performs a reboot when run with no
  options.

  * the IPMI fencing agent now supports different cipher types with the '-C'
  option.

  * qdisk now properly scans devices and partitions.

  * cman now checks to see if a new node has state to prevent killing the
  first node during cluster setup.

  * 'service qdiskd start' now works properly.

  * the McData fence agent now works properly with the McData Sphereon 4500
  Fabric Switch.

  * the Egenera fence agent can now specify an SSH login name.

  * the APC fence agent now works with non-admin accounts when using the
  3.5.x firmware.

  * fence_xvmd now tries two methods to reboot a virtual machine.

  * connections to OpenAIS are now allowed from unprivileged CPG clients with
  the user and group of 'ais'.

  * groupd no longer allows the default fence domain to be '0', which
  previously caused rgmanager to hang. Now, rgmanager no longer hangs.

  * the RSA fence agent now supports SSH enabled RSA II devices.

  * the DRAC fence agent now works with the Integrated Dell Remote Access
  Controller (iDRAC) on Dell PowerEdge M600 blade servers.

  * fixed a memory leak in cman.

  * qdisk now displays a warning if more than one label is found with the
  same name.

  * the DRAC5 fencing agent now shows proper usage instructions for the '-D'
  option.

  * cman no longer uses the wrong node name when getnameinfo() fails.

  * the SCSI fence agent now verifies that sg_persist is installed.

  * the DRAC5 fencing agent now properly handles modulename.

  * QDisk now logs warning messages if it appears its I/O to shared storage
  is hung.

  * fence_apc no longer fails with a pexpect exception.

  * removing a node from the cluster using 'cman_tool leave remove' now
  properly reduces the expected_votes and quorum.

  * a semaphore leak in cman has been fixed.

  * 'cman_tool nodes -F name' no longer segfaults when a node is out of
  membership.

  Enhancements:

  * support for: ePowerSwitch 8+ and LPAR/HMC v3 devices, Cisco MDS 9124 and
  MDS 9134 SAN switches, the virsh fencing agent, and broadcast communication
  with cman.

  * fence_scsi limitations added to fence_scsi man page.

  Users of cman are advised to upgrade to these updated packages, which
  resolve these issues and add these enhancements.
impacted_packages:
  - purl: pkg:rpm/redhat/cman?arch=src
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman?arch=x86_64
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-devel?arch=x86_64
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-devel?arch=i386
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-debuginfo?arch=i386
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman?arch=i386
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman?arch=ia64
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-devel?arch=ia64
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-debuginfo?arch=ia64
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman?arch=ppc
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-devel?arch=ppc
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-debuginfo?arch=ppc
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-devel?arch=ppc64
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman?arch=s390x
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-devel?arch=s390x
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-devel?arch=s390
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cman-debuginfo?arch=s390
    affected_versions: vers:rpm/<2.0.115-1.el5
    fixed_versions: vers:rpm/2.0.115-1.el5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Low
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2009/rhsa-2009_1341.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#low
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=467386
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=468966
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2009/rhsa-2009_1341.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=276541
    reference_type: bug
    reference_id: 276541
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=322291
    reference_type: bug
    reference_id: 322291
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=447497
    reference_type: bug
    reference_id: 447497
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=447964
    reference_type: bug
    reference_id: 447964
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=472460
    reference_type: bug
    reference_id: 472460
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=472786
    reference_type: bug
    reference_id: 472786
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=473961
    reference_type: bug
    reference_id: 473961
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=474163
    reference_type: bug
    reference_id: 474163
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=480178
    reference_type: bug
    reference_id: 480178
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=480401
    reference_type: bug
    reference_id: 480401
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=480836
    reference_type: bug
    reference_id: 480836
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=481566
    reference_type: bug
    reference_id: 481566
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=481664
    reference_type: bug
    reference_id: 481664
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=484095
    reference_type: bug
    reference_id: 484095
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=484956
    reference_type: bug
    reference_id: 484956
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=485026
    reference_type: bug
    reference_id: 485026
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=485199
    reference_type: bug
    reference_id: 485199
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=485469
    reference_type: bug
    reference_id: 485469
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=485700
    reference_type: bug
    reference_id: 485700
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=487436
    reference_type: bug
    reference_id: 487436
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=487501
    reference_type: bug
    reference_id: 487501
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=488565
    reference_type: bug
    reference_id: 488565
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=488958
    reference_type: bug
    reference_id: 488958
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=491640
    reference_type: bug
    reference_id: 491640
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=493165
    reference_type: bug
    reference_id: 493165
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=493207
    reference_type: bug
    reference_id: 493207
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=493802
    reference_type: bug
    reference_id: 493802
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=496629
    reference_type: bug
    reference_id: 496629
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=496724
    reference_type: bug
    reference_id: 496724
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=498329
    reference_type: bug
    reference_id: 498329
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=499767
    reference_type: bug
    reference_id: 499767
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=500450
    reference_type: bug
    reference_id: 500450
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=500567
    reference_type: bug
    reference_id: 500567
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=501586
    reference_type: bug
    reference_id: 501586
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=502674
    reference_type: bug
    reference_id: 502674
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=504705
    reference_type: bug
    reference_id: 504705
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=505258
    reference_type: bug
    reference_id: 505258
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=505594
    reference_type: bug
    reference_id: 505594
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=512998
    reference_type: bug
    reference_id: 512998
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=514758
    reference_type: bug
    reference_id: 514758
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=519436
    reference_type: bug
    reference_id: 519436
  - url: https://access.redhat.com/errata/RHSA-2009:1341
    reference_type:
    reference_id: RHSA-2009:1341
