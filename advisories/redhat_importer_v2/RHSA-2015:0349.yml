advisory_id: RHSA-2015:0349
datasource_id: redhat_importer_v2/RHSA-2015:0349
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_0349.json
aliases:
  - CVE-2014-3640
  - CVE-2014-7815
  - CVE-2014-7840
  - CVE-2014-8106
summary: |
  Updated qemu-kvm packages that fix multiple security issues, several bugs,
  and add various enhancements are now available for Red Hat Enterprise
  Linux 7.

  Red Hat Product Security has rated this update as having Important security
  impact. Common Vulnerability Scoring System (CVSS) base scores, which give
  detailed severity ratings, are available for each vulnerability from the
  CVE links in the References section.

  KVM (Kernel-based Virtual Machine) is a full virtualization solution for Linux on AMD64 and Intel 64 systems. The qemu-kvm packages provide the user-space component for running virtual machines using KVM.

  It was found that the Cirrus blit region checks were insufficient. A privileged guest user could use this flaw to write outside of VRAM-allocated buffer boundaries in the host's QEMU process address space with attacker-provided data. (CVE-2014-8106)

  An uninitialized data structure use flaw was found in the way the set_pixel_format() function sanitized the value of bits_per_pixel. An attacker able to access a guest's VNC console could use this flaw to crash the guest. (CVE-2014-7815)

  It was found that certain values that were read when loading RAM during migration were not validated. A user able to alter the savevm data (either on the disk or over the wire during migration) could use either of these flaws to corrupt QEMU process memory on the (destination) host, which could potentially result in arbitrary code execution on the host with the privileges of the QEMU process. (CVE-2014-7840)

  A NULL pointer dereference flaw was found in the way QEMU handled UDP packets with a source port and address of 0 when QEMU's user networking was in use. A local guest user could use this flaw to crash the guest. (CVE-2014-3640)

  Red Hat would like to thank James Spadaro of Cisco for reporting CVE-2014-7815, and Xavier Mehrenberger and Stephane Duverger of Airbus for reporting CVE-2014-3640. The CVE-2014-8106 issue was found by Paolo Bonzini of Red Hat, and the CVE-2014-7840 issue was discovered by Michael S. Tsirkin of Red Hat.

  Bug fixes:

  * The KVM utility executed demanding routing update system calls every time it performed an MSI vector mask/unmask operation. Consequently, guests running legacy systems such as Red Hat Enterprise Linux 5 could, under certain circumstances, experience significant slowdown. Now, the routing system calls during mask/unmask operations are skipped, and the performance of legacy guests is now more consistent. (BZ#1098976)

  * Due to a bug in the Internet Small Computer System Interface (iSCSI) driver, a qemu-kvm process terminated unexpectedly with a segmentation fault when the "write same" command was executed in guest mode under the iSCSI protocol. This update fixes the bug, and the "write same" command now functions in guest mode under iSCSI as intended. (BZ#1083413)

  * The QEMU command interface did not properly handle resizing of cache memory during guest migration, causing QEMU to terminate unexpectedly with a segmentation fault. This update fixes the related code, and QEMU no longer crashes in the described situation. (BZ#1066338)

  Enhancements:

  * The maximum number of supported virtual CPUs (vCPUs) in a KVM guest has been increased to 240. This increases the number of virtual processing units that the user can assign to the guest, and therefore improves its performance potential. (BZ#1134408)

  * Support for the 5th Generation Intel Core processors has been added to the QEMU hypervisor, the KVM kernel code, and the libvirt API. This allows KVM guests to use the following instructions and features: ADCX, ADOX, RDSFEED, PREFETCHW, and supervisor mode access prevention (SMAP). (BZ#1116117)

  * The "dump-guest-memory" command now supports crash dump compression. This makes it possible for users who cannot use the "virsh dump" command to require less hard disk space for guest crash dumps. In addition, saving a compressed guest crash dump frequently takes less time than saving a non-compressed one. (BZ#1157798)

  * This update introduces support for flight recorder tracing, which uses SystemTap to automatically capture qemu-kvm data while the guest machine is running. For detailed instructions on how to configure and use flight recorder tracing, see the Virtualization Deployment and Administration Guide, linked to in the References section below. (BZ#1088112)
impacted_packages:
  - purl: pkg:rpm/redhat/qemu-kvm-debuginfo?arch=x86_64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libcacard?arch=x86_64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm-tools?arch=x86_64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-img?arch=x86_64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm-common?arch=x86_64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm?arch=x86_64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libcacard-devel?arch=x86_64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libcacard-tools?arch=x86_64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libcacard?arch=i686&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm-debuginfo?arch=i686&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libcacard-devel?arch=i686&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-img?arch=ppc64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm-debuginfo?arch=ppc64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libcacard-devel?arch=ppc64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libcacard-tools?arch=ppc64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libcacard?arch=ppc64&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm?arch=src&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libcacard-devel?arch=ppc&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm-debuginfo?arch=ppc&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libcacard?arch=ppc&epoch=10
    affected_versions: vers:rpm/<1.5.3-86.el7
    fixed_versions: vers:rpm/1.5.3-86.el7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_0349.json
weaknesses: []
references:
  - url: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Virtualization_Deployment_and_Administration_Guide/index.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1144818
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1157641
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1163075
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_0349.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1002493
    reference_type: bug
    reference_id: 1002493
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1017685
    reference_type: bug
    reference_id: 1017685
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1021788
    reference_type: bug
    reference_id: 1021788
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1026314
    reference_type: bug
    reference_id: 1026314
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1027565
    reference_type: bug
    reference_id: 1027565
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1029271
    reference_type: bug
    reference_id: 1029271
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1038914
    reference_type: bug
    reference_id: 1038914
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1039791
    reference_type: bug
    reference_id: 1039791
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1046574
    reference_type: bug
    reference_id: 1046574
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1046873
    reference_type: bug
    reference_id: 1046873
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1049734
    reference_type: bug
    reference_id: 1049734
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1052093
    reference_type: bug
    reference_id: 1052093
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1054077
    reference_type: bug
    reference_id: 1054077
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1064156
    reference_type: bug
    reference_id: 1064156
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1064647
    reference_type: bug
    reference_id: 1064647
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1066338
    reference_type: bug
    reference_id: 1066338
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1074219
    reference_type: bug
    reference_id: 1074219
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1074403
    reference_type: bug
    reference_id: 1074403
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1074913
    reference_type: bug
    reference_id: 1074913
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1075846
    reference_type: bug
    reference_id: 1075846
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1076326
    reference_type: bug
    reference_id: 1076326
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1079147
    reference_type: bug
    reference_id: 1079147
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1083413
    reference_type: bug
    reference_id: 1083413
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1085701
    reference_type: bug
    reference_id: 1085701
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1086598
    reference_type: bug
    reference_id: 1086598
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1086987
    reference_type: bug
    reference_id: 1086987
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1088116
    reference_type: bug
    reference_id: 1088116
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1088150
    reference_type: bug
    reference_id: 1088150
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1088176
    reference_type: bug
    reference_id: 1088176
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1088695
    reference_type: bug
    reference_id: 1088695
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1088822
    reference_type: bug
    reference_id: 1088822
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1089606
    reference_type: bug
    reference_id: 1089606
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1093983
    reference_type: bug
    reference_id: 1093983
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1094285
    reference_type: bug
    reference_id: 1094285
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1095645
    reference_type: bug
    reference_id: 1095645
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1096576
    reference_type: bug
    reference_id: 1096576
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1097020
    reference_type: bug
    reference_id: 1097020
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1097363
    reference_type: bug
    reference_id: 1097363
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1098086
    reference_type: bug
    reference_id: 1098086
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1098602
    reference_type: bug
    reference_id: 1098602
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1104748
    reference_type: bug
    reference_id: 1104748
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1107821
    reference_type: bug
    reference_id: 1107821
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1111450
    reference_type: bug
    reference_id: 1111450
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1113009
    reference_type: bug
    reference_id: 1113009
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1116728
    reference_type: bug
    reference_id: 1116728
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1116941
    reference_type: bug
    reference_id: 1116941
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1118707
    reference_type: bug
    reference_id: 1118707
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1122151
    reference_type: bug
    reference_id: 1122151
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1123372
    reference_type: bug
    reference_id: 1123372
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1130428
    reference_type: bug
    reference_id: 1130428
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1131316
    reference_type: bug
    reference_id: 1131316
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1134237
    reference_type: bug
    reference_id: 1134237
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1134241
    reference_type: bug
    reference_id: 1134241
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1134251
    reference_type: bug
    reference_id: 1134251
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1134283
    reference_type: bug
    reference_id: 1134283
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1138639
    reference_type: bug
    reference_id: 1138639
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1138691
    reference_type: bug
    reference_id: 1138691
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1140618
    reference_type: bug
    reference_id: 1140618
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1140742
    reference_type: bug
    reference_id: 1140742
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1141667
    reference_type: bug
    reference_id: 1141667
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1142290
    reference_type: bug
    reference_id: 1142290
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1155518
    reference_type: bug
    reference_id: 1155518
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1160237
    reference_type: bug
    reference_id: 1160237
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1161563
    reference_type: bug
    reference_id: 1161563
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1169454
    reference_type: bug
    reference_id: 1169454
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1175325
    reference_type: bug
    reference_id: 1175325
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1180942
    reference_type: bug
    reference_id: 1180942
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=895436
    reference_type: bug
    reference_id: 895436
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=949385
    reference_type: bug
    reference_id: 949385
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=980747
    reference_type: bug
    reference_id: 980747
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=980833
    reference_type: bug
    reference_id: 980833
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=990724
    reference_type: bug
    reference_id: 990724
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=996011
    reference_type: bug
    reference_id: 996011
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=999789
    reference_type: bug
    reference_id: 999789
  - url: https://access.redhat.com/errata/RHSA-2015:0349
    reference_type:
    reference_id: RHSA-2015:0349
