advisory_id: RHSA-2013:0505
datasource_id: redhat_importer_v2/RHSA-2013:0505
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0505.json
aliases:
  - CVE-2012-5643
summary: |
  Updated squid packages that fix one security issue and several bugs are now
  available for Red Hat Enterprise Linux 6.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. A Common Vulnerability Scoring System (CVSS) base score,
  which gives a detailed severity rating, is available from the CVE link in
  the References section.

  Squid is a high-performance proxy caching server for web clients that
  supports FTP, Gopher, and HTTP data objects.

  A denial of service flaw was found in the way the Squid Cache Manager
  processed certain requests. A remote attacker who is able to access the
  Cache Manager CGI could use this flaw to cause Squid to consume an
  excessive amount of memory. (CVE-2012-5643)

  This update also fixes the following bugs:

  * Due to a bug in the ConnStateData::noteMoreBodySpaceAvailable() function,
  child processes of Squid terminated upon encountering a failed assertion.
  An upstream patch has been provided and Squid child processes no longer
  terminate. (BZ#805879)

  * Due to an upstream patch, which renamed the HTTP header controlling
  persistent connections from "Proxy-Connection" to "Connection", the NTLM
  pass-through authentication does not work, thus preventing login. This
  update adds the new "http10" option to the squid.conf file, which can be
  used to enable the change in the patch. This option is set to "off" by
  default. When set to "on", the NTLM pass-through authentication works
  properly, thus allowing login attempts to succeed. (BZ#844723)

  * When the IPv6 protocol was disabled and Squid tried to handle an HTTP GET
  request containing an IPv6 address, the Squid child process terminated due
  to signal 6. This bug has been fixed and such requests are now handled as
  expected. (BZ#832484)

  * The old "stale if hit" logic did not account for cases where the stored
  stale response became fresh due to a successful re-validation with the
  origin server. Consequently, incorrect warning messages were returned. Now,
  Squid no longer marks elements as stale in the described scenario.
  (BZ#847056)

  * When squid packages were installed before samba-winbind, the wbpriv group
  did not include Squid. Consequently, NTLM authentication calls failed. Now,
  Squid correctly adds itself into the wbpriv group if samba-winbind is
  installed before Squid, thus fixing this bug. (BZ#797571)

  * In FIPS mode, Squid was using private MD5 hash functions for user
  authentication and network access. As MD5 is incompatible with FIPS mode,
  Squid could fail to start. This update limits the use of the private MD5
  functions to local disk file hash identifiers, thus allowing Squid to work
  in FIPS mode. (BZ#833086)

  * Under high system load, the squid process could terminate unexpectedly
  with a segmentation fault during reboot. This update provides better memory
  handling during reboot, thus fixing this bug. (BZ#782732)

  * Squid incorrectly set the timeout limit for client HTTP connections with
  the value for server-side connections, which is much higher, thus creating
  unnecessary delays. With this update, Squid uses a proper value for the
  client timeout limit. (BZ#798090)

  * Squid did not properly release allocated memory when generating error
  page contents, which caused memory leaks. Consequently, the Squid proxy
  server consumed a lot of memory within a short time period. This update
  fixes this memory leak. (BZ#758861)

  * Squid did not pass the ident value to a URL rewriter that was configured
  using the "url_rewrite_program" directive. Consequently, the URL rewriter
  received the dash character ("â€“") as the user value instead of the correct
  user name. Now, the URL rewriter receives the correct user name in the
  described scenario. (BZ#797884)

  * Squid, used as a transparent proxy, can only handle the HTTP protocol.
  Previously, it was possible to define a URL in which the access protocol
  contained the asterisk character (*) or an unknown protocol namespace URI.
  Consequently, an "Invalid URL" error message was logged to access.log
  during reload. This update ensures that "http://" is always used in
  transparent proxy URLs, and the error message is no longer logged in this
  scenario. (BZ#720504)

  All users of squid are advised to upgrade to these updated packages, which
  fix these issues. After installing this update, the squid service will be
  restarted automatically.
impacted_packages:
  - purl: pkg:rpm/redhat/squid?arch=src&epoch=7
    affected_versions: vers:rpm/<3.1.10-16.el6
    fixed_versions: vers:rpm/3.1.10-16.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/squid?arch=x86_64&epoch=7
    affected_versions: vers:rpm/<3.1.10-16.el6
    fixed_versions: vers:rpm/3.1.10-16.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/squid-debuginfo?arch=x86_64&epoch=7
    affected_versions: vers:rpm/<3.1.10-16.el6
    fixed_versions: vers:rpm/3.1.10-16.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/squid?arch=i686&epoch=7
    affected_versions: vers:rpm/<3.1.10-16.el6
    fixed_versions: vers:rpm/3.1.10-16.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/squid-debuginfo?arch=i686&epoch=7
    affected_versions: vers:rpm/<3.1.10-16.el6
    fixed_versions: vers:rpm/3.1.10-16.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/squid?arch=s390x&epoch=7
    affected_versions: vers:rpm/<3.1.10-16.el6
    fixed_versions: vers:rpm/3.1.10-16.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/squid-debuginfo?arch=s390x&epoch=7
    affected_versions: vers:rpm/<3.1.10-16.el6
    fixed_versions: vers:rpm/3.1.10-16.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/squid?arch=ppc64&epoch=7
    affected_versions: vers:rpm/<3.1.10-16.el6
    fixed_versions: vers:rpm/3.1.10-16.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/squid-debuginfo?arch=ppc64&epoch=7
    affected_versions: vers:rpm/<3.1.10-16.el6
    fixed_versions: vers:rpm/3.1.10-16.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0505.json
weaknesses: []
references:
  - url: https://access.redhat.com/knowledge/docs/en-US/Red_Hat_Enterprise_Linux/6/html/6.4_Technical_Notes/squid.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0505.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=797571
    reference_type: bug
    reference_id: 797571
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=798090
    reference_type: bug
    reference_id: 798090
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=832484
    reference_type: bug
    reference_id: 832484
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=833086
    reference_type: bug
    reference_id: 833086
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=844723
    reference_type: bug
    reference_id: 844723
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=847056
    reference_type: bug
    reference_id: 847056
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=887962
    reference_type: bug
    reference_id: 887962
  - url: https://access.redhat.com/errata/RHSA-2013:0505
    reference_type:
    reference_id: RHSA-2013:0505
