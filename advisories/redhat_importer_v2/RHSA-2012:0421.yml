advisory_id: RHSA-2012:0421
datasource_id: redhat_importer_v2/RHSA-2012:0421
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0421.json
aliases:
  - CVE-2011-5245
  - CVE-2012-0818
summary: |
  Updated rhevm packages that fix one security issue and various bugs are now
  available.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. A Common Vulnerability Scoring System (CVSS) base score,
  which gives a detailed severity rating, is available from the CVE link in
  the References section.

  Red Hat Enterprise Virtualization Manager is a visual tool for centrally
  managing collections of virtual machines running Red Hat Enterprise Linux
  and Microsoft Windows. These packages also include the Red Hat Enterprise
  Virtualization Manager REST (Representational State Transfer) API, a set of
  scriptable commands that give administrators the ability to perform queries
  and operations on Red Hat Enterprise Virtualization Manager.

  It was found that RESTEasy was vulnerable to XML External Entity (XXE)
  attacks. If a remote attacker who is able to access the Red Hat Enterprise
  Virtualization Manager REST API submitted a request containing an external
  XML entity to a RESTEasy endpoint, the entity would be resolved, allowing
  the attacker to read files accessible to the user running the application
  server. This flaw affected DOM (Document Object Model) Document and JAXB
  (Java Architecture for XML Binding) input. (CVE-2012-0818)

  This update also fixes the following bugs:

  * Previously the REST API was ignoring the "Accept" header. This made it
  impossible to retrieve detailed information about specific sub-collections,
  including hosts and disks. The REST API has been updated and now processes
  the "Accept" header as originally intended. (BZ#771369)

  * The "start_time" Virtual Machine property was previously always set. This
  meant that even Virtual Machines that were stopped, had a value for
  "start_time". An update has been made to ensure that the "start_time"
  property is only set when the Virtual Machine has been started, and is
  running. (BZ#772975)

  * The 'rhevm-setup' script previously only ran successfully on systems with
  their locale set to 'en_US.UTF-8', 'en_US.utf-8', or 'en_US.utf8'. The
  script has since been updated to also run successfully in additional
  locales, including 'ja_JP.UTF-8'. (BZ#784860)

  * The REST API did not previously validate that all required parameters
  were provided when enabling power management. The response code returned
  would also incorrectly indicate the operation had succeeded where
  mandatory parameters were not supplied. An update has been made to ensure
  that the power management parameters are validated correctly. (BZ#785744)

  * Previously no warning or error was issued when the amount of free disk
  space on a host was low. When no free disk space remained on the host it
  would become non-responsive with no prior warning. An update has been made
  to report a warning in the audit log when a host's free disk space is less
  than 1000 MB, and an error when a host's free disk space is less than 500
  MB. (BZ#786132)

  * When importing Virtual Machines no notification was provided if the MAC
  address of the network interface card clashed with that of an existing
  Virtual Machine. Now when this occurs a message is printed to the audit
  log, highlighting the need for manual intervention. (BZ#795416)

  * Previously it was not possible to set more, or less, than one value for
  SpiceSecureChannels using the rhevm-config tool. This meant it was not
  possible to encrypt all SPICE channels. The rhevm-config tool has been
  updated and it is now possible to encrypt all SPICE channels, by adding
  them to the SpiceSecureChannels configuration key. (BZ#784012)

  All Red Hat Enterprise Virtualization users are advised to upgrade to these
  updated packages, which address this vulnerability and fix these bugs.
  Refer to the Solution section for information about installing this update.
impacted_packages:
  - purl: pkg:rpm/redhat/rhevm-notification-service?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-log-collector?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-iso-uploader?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-genericapi?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-restapi?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-jboss-deps?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-webadmin-portal?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-backend?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-dbscripts?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-setup?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-config?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-userportal?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm-tools-common?arch=x86_64
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhevm?arch=src
    affected_versions: vers:rpm/<3.0.3_0001-3.el6
    fixed_versions: vers:rpm/3.0.3_0001-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0421.json
weaknesses: []
references:
  - url: http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Virtualization/3.0/html/Installation_Guide/chap-Installation_Guide-Installing_the_RHEV_Manager-Upgrades.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0421.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=785631
    reference_type: bug
    reference_id: 785631
  - url: https://access.redhat.com/errata/RHSA-2012:0421
    reference_type:
    reference_id: RHSA-2012:0421
