advisory_id: RHSA-2016:0204
datasource_id: redhat_importer_v2/RHSA-2016:0204
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2016/rhsa-2016_0204.json
aliases:
  - CVE-2016-0741
summary: |
  Updated 389-ds-base packages that fix one security issue and several bugs
  are now available for Red Hat Enterprise Linux 7.

  Red Hat Product Security has rated this update as having Important security
  impact. A Common Vulnerability Scoring System (CVSS) base score, which
  gives a detailed severity rating, is available from the CVE link in the
  References section.

  The 389 Directory Server is an LDAP version 3 (LDAPv3) compliant server.
  The base packages include the Lightweight Directory Access Protocol (LDAP)
  server and command-line utilities for server administration.

  An infinite-loop vulnerability was discovered in the 389 directory server,
  where the server failed to correctly handle unexpectedly closed client
  connections. A remote attacker able to connect to the server could use this
  flaw to make the directory server consume an excessive amount of CPU and
  stop accepting connections (denial of service). (CVE-2016-0741)

  This update fixes the following bugs:

  * Previously, if a simple paged results search failed in the back end, the
  simple paged results slot was not released. Consequently, the simple paged
  results slots in a connection object could be accumulated. With this
  update, the simple paged results slot is released correctly when a search
  fails, and unused simple paged results slots are no longer left in a
  connection object. (BZ#1290725)

  * Previously, when several values of the same attribute were deleted using
  the ldapmodify command, and at least one of them was added again during the
  same operation, the equality index was not updated. As a consequence, an
  exact search for the re-added attribute value did not return the entry. The
  logic of the index code has been modified to update the index if at least
  one of the values in the entry changes, and the exact search for the
  re-added attribute value now returns the correct entry. (BZ#1290726)

  * Prior to this update, when the cleanAllRUV task was running, a bogus
  attrlist_replace error message was logged repeatedly due to a memory
  corruption. With this update, the appropriate memory copy function memmove
  is used, which fixes the memory corruption. As a result, the error messages
  are no longer logged in this scenario. (BZ#1295684)

  * To fix a simple paged results bug, an exclusive lock on a connection was
  previously added. This consequently caused a self deadlock in a particular
  case. With this update, the exclusive lock on a connection has been changed
  to the re-entrant type, and the self deadlock no longer occurs.
  (BZ#1298105)

  * Previously, an unnecessary lock was sometimes acquired on a connection
  object, which could consequently cause a deadlock. A patch has been applied
  to remove the unnecessary locking, and the deadlock no longer occurs.
  (BZ#1299346)

  Users of 389-ds-base are advised to upgrade to these updated packages,
  which correct these issues. After installing this update, the 389 server
  service will be restarted automatically.
impacted_packages:
  - purl: pkg:rpm/redhat/389-ds-base-devel?arch=x86_64
    affected_versions: vers:rpm/<1.3.4.0-26.el7_2
    fixed_versions: vers:rpm/1.3.4.0-26.el7_2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base?arch=x86_64
    affected_versions: vers:rpm/<1.3.4.0-26.el7_2
    fixed_versions: vers:rpm/1.3.4.0-26.el7_2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base-libs?arch=x86_64
    affected_versions: vers:rpm/<1.3.4.0-26.el7_2
    fixed_versions: vers:rpm/1.3.4.0-26.el7_2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<1.3.4.0-26.el7_2
    fixed_versions: vers:rpm/1.3.4.0-26.el7_2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base?arch=src
    affected_versions: vers:rpm/<1.3.4.0-26.el7_2
    fixed_versions: vers:rpm/1.3.4.0-26.el7_2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base-debuginfo?arch=ppc64le
    affected_versions: vers:rpm/<1.3.4.0-26.el7_2
    fixed_versions: vers:rpm/1.3.4.0-26.el7_2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base-devel?arch=ppc64le
    affected_versions: vers:rpm/<1.3.4.0-26.el7_2
    fixed_versions: vers:rpm/1.3.4.0-26.el7_2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base?arch=ppc64le
    affected_versions: vers:rpm/<1.3.4.0-26.el7_2
    fixed_versions: vers:rpm/1.3.4.0-26.el7_2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base-libs?arch=ppc64le
    affected_versions: vers:rpm/<1.3.4.0-26.el7_2
    fixed_versions: vers:rpm/1.3.4.0-26.el7_2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2016/rhsa-2016_0204.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2016/rhsa-2016_0204.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1290725
    reference_type: bug
    reference_id: 1290725
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1290726
    reference_type: bug
    reference_id: 1290726
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1295684
    reference_type: bug
    reference_id: 1295684
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1299346
    reference_type: bug
    reference_id: 1299346
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1299416
    reference_type: bug
    reference_id: 1299416
  - url: https://access.redhat.com/errata/RHSA-2016:0204
    reference_type:
    reference_id: RHSA-2016:0204
