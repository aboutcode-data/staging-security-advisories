advisory_id: RHSA-2015:1459
datasource_id: redhat_importer_v2/RHSA-2015:1459
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_1459.json
aliases:
  - CVE-2014-9297
  - CVE-2014-9298
  - CVE-2014-9750
  - CVE-2014-9751
  - CVE-2015-1798
  - CVE-2015-1799
  - CVE-2015-3405
summary: |
  Updated ntp packages that fix multiple security issues, several bugs, and
  add two enhancements are now available for Red Hat Enterprise Linux 6.

  Red Hat Product Security has rated this update as having Moderate security
  impact. Common Vulnerability Scoring System (CVSS) base scores, which give
  detailed severity ratings, are available for each vulnerability from the
  CVE links in the References section.

  The Network Time Protocol (NTP) is used to synchronize a computer's time
  with another referenced time source.

  It was found that because NTP's access control was based on a source IP
  address, an attacker could bypass source IP restrictions and send malicious
  control and configuration packets by spoofing ::1 addresses.
  (CVE-2014-9298)

  A denial of service flaw was found in the way NTP hosts that were peering
  with each other authenticated themselves before updating their internal
  state variables. An attacker could send packets to one peer host, which
  could cascade to other peers, and stop the synchronization process among
  the reached peers. (CVE-2015-1799)

  A flaw was found in the way the ntp-keygen utility generated MD5 symmetric
  keys on big-endian systems. An attacker could possibly use this flaw to
  guess generated MD5 keys, which could then be used to spoof an NTP client
  or server. (CVE-2015-3405)

  A stack-based buffer overflow was found in the way the NTP autokey protocol
  was implemented. When an NTP client decrypted a secret received from an NTP
  server, it could cause that client to crash. (CVE-2014-9297)

  It was found that ntpd did not check whether a Message Authentication Code
  (MAC) was present in a received packet when ntpd was configured to use
  symmetric cryptographic keys. A man-in-the-middle attacker could use this
  flaw to send crafted packets that would be accepted by a client or a peer
  without the attacker knowing the symmetric key. (CVE-2015-1798)

  The CVE-2015-1798 and CVE-2015-1799 issues were discovered by Miroslav
  Lichv√°r of Red Hat.

  Bug fixes:

  * The ntpd daemon truncated symmetric keys specified in the key file to 20
  bytes. As a consequence, it was impossible to configure NTP authentication
  to work with peers that use longer keys. The maximum length of keys has now
  been changed to 32 bytes. (BZ#1053551)

  * The ntp-keygen utility used the exponent of 3 when generating RSA keys,
  and generating RSA keys failed when FIPS mode was enabled. ntp-keygen has
  been modified to use the exponent of 65537, and generating keys in FIPS
  mode now works as expected. (BZ#1184421)

  * The ntpd daemon included a root delay when calculating its root
  dispersion. Consequently, the NTP server reported larger root dispersion
  than it should have and clients could reject the source when its distance
  reached the maximum synchronization distance (1.5 seconds by default).
  Calculation of root dispersion has been fixed, the root dispersion is now
  reported correctly, and clients no longer reject the server due to a large
  synchronization distance. (BZ#1045376)

  * The ntpd daemon dropped incoming NTP packets if their source port was
  lower than 123 (the NTP port). Clients behind Network Address Translation
  (NAT) were unable to synchronize with the server if their source port was
  translated to ports below 123. With this update, ntpd no longer checks the
  source port number. (BZ#1171630)

  Enhancements:

  * This update introduces configurable access of memory segments used for
  Shared Memory Driver (SHM) reference clocks. Previously, only the first two
  memory segments were created with owner-only access, allowing just two SHM
  reference clocks to be used securely on a system. Now, the owner-only
  access to SHM is configurable with the "mode" option, and it is therefore
  possible to use more SHM reference clocks securely. (BZ#1122015)

  * Support for nanosecond resolution has been added to the SHM reference
  clock. Prior to this update, when a Precision Time Protocol (PTP) hardware
  clock was used as a time source to synchronize the system clock (for
  example, with the timemaster service from the linuxptp package), the
  accuracy of the synchronization was limited due to the microsecond
  resolution of the SHM protocol. The nanosecond extension in the SHM
  protocol now enables sub-microsecond synchronization of the system clock.
  (BZ#1117704)
impacted_packages:
  - purl: pkg:rpm/redhat/ntp-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntpdate?arch=x86_64
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=x86_64
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-perl?arch=x86_64
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-debuginfo?arch=i686
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=i686
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntpdate?arch=i686
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-perl?arch=i686
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=src
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-perl?arch=s390x
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-debuginfo?arch=s390x
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=s390x
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntpdate?arch=s390x
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-doc?arch=noarch
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-perl?arch=ppc64
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntpdate?arch=ppc64
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=ppc64
    affected_versions: vers:rpm/<4.2.6p5-5.el6
    fixed_versions: vers:rpm/4.2.6p5-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_1459.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1184572
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1184573
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1210324
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_1459.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1045376
    reference_type: bug
    reference_id: 1045376
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1117704
    reference_type: bug
    reference_id: 1117704
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1122015
    reference_type: bug
    reference_id: 1122015
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1165141
    reference_type: bug
    reference_id: 1165141
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1166596
    reference_type: bug
    reference_id: 1166596
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1171630
    reference_type: bug
    reference_id: 1171630
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1190619
    reference_type: bug
    reference_id: 1190619
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1193849
    reference_type: bug
    reference_id: 1193849
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1193850
    reference_type: bug
    reference_id: 1193850
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1199430
    reference_type: bug
    reference_id: 1199430
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1199435
    reference_type: bug
    reference_id: 1199435
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=995134
    reference_type: bug
    reference_id: 995134
  - url: https://access.redhat.com/errata/RHSA-2015:1459
    reference_type:
    reference_id: RHSA-2015:1459
