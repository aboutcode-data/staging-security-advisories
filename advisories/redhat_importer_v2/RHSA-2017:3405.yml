advisory_id: RHSA-2017:3405
datasource_id: redhat_importer_v2/RHSA-2017:3405
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2017/rhsa-2017_3405.json
aliases:
  - CVE-2017-12172
  - CVE-2017-15097
summary: |
  An update for rh-postgresql96-postgresql is now available for Red Hat Software Collections.

  Red Hat Product Security has rated this update as having a security impact of Moderate. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

  PostgreSQL is an advanced object-relational database management system (DBMS).

  Security Fix(es):

  * Privilege escalation flaws were found in the initialization scripts of PostgreSQL. An attacker with access to the postgres user account could use these flaws to obtain root access on the server machine. (CVE-2017-12172, CVE-2017-15097)

  Note: This patch drops the script privileges from root to the postgres user. Therefore, we dropped the --new-systemd-unit option for security reasons. Please use the root-only script postgresql-new-systemd-unit.

  Red Hat would like to thank the PostgreSQL project for reporting CVE-2017-12172. The CVE-2017-15097 issue was discovered by Pedro Barbosa (Red Hat) and the PostgreSQL project. Upstream acknowledges Antoine Scemama (Brainloop) as the original reporter of these issues.
impacted_packages:
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-plperl?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-server-syspaths?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-docs?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-pltcl?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-static?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-syspaths?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-contrib?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-plpython?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-devel?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-libs?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-server?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-test?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-contrib-syspaths?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-plperl?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-syspaths?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-server-syspaths?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-docs?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-pltcl?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-static?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-contrib?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-devel?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-test?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-plpython?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-libs?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-server?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-contrib-syspaths?arch=x86_64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql?arch=src
    affected_versions: vers:rpm/<9.6.5-2.el6
    fixed_versions: vers:rpm/9.6.5-2.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql?arch=src
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-debuginfo?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-plperl?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-syspaths?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-server-syspaths?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-docs?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-pltcl?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-static?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-contrib?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-devel?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-test?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-plpython?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-libs?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-server?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-contrib-syspaths?arch=aarch64
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-debuginfo?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-plperl?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-syspaths?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-server-syspaths?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-docs?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-pltcl?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-static?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-contrib?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-devel?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-test?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-plpython?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-libs?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-server?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-contrib-syspaths?arch=s390x
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-debuginfo?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-plperl?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-syspaths?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-server-syspaths?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-docs?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-pltcl?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-static?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-contrib?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-devel?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-test?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-plpython?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-libs?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-server?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-postgresql96-postgresql-contrib-syspaths?arch=ppc64le
    affected_versions: vers:rpm/<9.6.5-2.el7
    fixed_versions: vers:rpm/9.6.5-2.el7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2017/rhsa-2017_3405.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2017/rhsa-2017_3405.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1498394
    reference_type: bug
    reference_id: 1498394
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1508985
    reference_type: bug
    reference_id: 1508985
  - url: https://access.redhat.com/errata/RHSA-2017:3405
    reference_type:
    reference_id: RHSA-2017:3405
