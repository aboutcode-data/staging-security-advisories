advisory_id: RHSA-2016:2006
datasource_id: redhat_importer_v2/RHSA-2016:2006
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2016/rhsa-2016_2006.json
aliases:
  - CVE-2016-4470
  - CVE-2016-5829
summary: |
  An update for kernel is now available for Red Hat Enterprise Linux 6.

  Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

  The kernel packages contain the Linux kernel, the core of any Linux operating system.

  Security Fix(es):

  * A flaw was found in the Linux kernel's keyring handling code, where in key_reject_and_link() an uninitialized variable would eventually lead to arbitrary free address which could allow attacker to use a use-after-free style attack. (CVE-2016-4470, Important)

  * A heap-based buffer overflow vulnerability was found in the Linux kernel's hiddev driver. This flaw could allow a local attacker to corrupt kernel memory, possible privilege escalation or crashing the system. (CVE-2016-5829, Moderate)

  The CVE-2016-4470 issue was discovered by David Howells (Red Hat Inc.).

  Bug Fix(es):

  * Previously, when two NFS shares with different security settings were mounted, the I/O operations to the kerberos-authenticated mount caused the RPC_CRED_KEY_EXPIRE_SOON parameter to be set, but the parameter was not unset when performing the I/O operations on the sec=sys mount. Consequently, writes to both NFS shares had the same parameters, regardless of their security settings. This update fixes this problem by moving the NO_CRKEY_TIMEOUT parameter to the auth->au_flags field. As a result, NFS shares with different security settings are now handled as expected. (BZ#1366962)

  * In some circumstances, resetting a Fibre Channel over Ethernet (FCoE) interface could lead to a kernel panic, due to invalid information extracted from the FCoE header. This update adds santiy checking to the cpu number extracted from the FCoE header. This ensures that subsequent operations address a valid cpu, and eliminates the kernel panic. (BZ#1359036)

  * Prior to this update, the following problems occurred with the way GSF2 transitioned files and directories from the "unlinked" state to the "free" state:

  The numbers reported for the df and the du commands in some cases got out of sync, which caused blocks in the file system to appear missing. The blocks were not actually missing, but they were left in the "unlinked" state.

  In some circumstances, GFS2 referenced a cluster lock that was already deleted, which led to a kernel panic.

  If an object was deleted and its space reused as a different object, GFS2 sometimes deleted the existing one, which caused file system corruption.

  With this update, the transition from "unlinked" to "free" state has been fixed. As a result, none of these three problems occur anymore. (BZ#1359037)

  * Previously, the GFS2 file system in some cases became unresponsive due to lock dependency problems between inodes and the cluster lock. This occurred most frequently on nearly full file systems where files and directories were being deleted and recreated at the same block location at the same time. With this update, a set of patches has been applied to fix these lock dependencies. As a result, GFS2 no longer hangs in the described circumstances. (BZ#1359038)

  * When used with controllers that do not support DCMD- MR_DCMD_PD_LIST_QUERY, the megaraid_sas driver can go into infinite error reporting loop of error reporting messages. This could cause difficulties with finding other important log messages, or even it could cause the disk to overflow. This bug has been fixed by ignoring the DCMD MR_DCMD_PD_LIST_QUERY query for controllers which do not support it and sending the DCMD SUCCESS status to the AEN functions. As a result, the error messages no longer appear when there is a change in the status of one of the arrays. (BZ#1359039)
impacted_packages:
  - purl: pkg:rpm/redhat/kernel-debuginfo-common-x86_64?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common-i686?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=i686
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump-devel?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common-s390x?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf?arch=s390x
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-doc?arch=noarch
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-abi-whitelists?arch=noarch
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-firmware?arch=noarch
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common-ppc64?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-bootwrapper?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/perf?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-perf?arch=ppc64
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=src
    affected_versions: vers:rpm/<2.6.32-642.6.1.el6
    fixed_versions: vers:rpm/2.6.32-642.6.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2016/rhsa-2016_2006.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2016/rhsa-2016_2006.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1341716
    reference_type: bug
    reference_id: 1341716
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1350509
    reference_type: bug
    reference_id: 1350509
  - url: https://access.redhat.com/errata/RHSA-2016:2006
    reference_type:
    reference_id: RHSA-2016:2006
