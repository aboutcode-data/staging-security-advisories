advisory_id: RHSA-2015:1462
datasource_id: redhat_importer_v2/RHSA-2015:1462
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_1462.json
aliases:
  - CVE-2010-5312
  - CVE-2012-6662
summary: |
  Updated ipa packages that fix two security issues and several bugs are now
  available for Red Hat Enterprise Linux 6.

  Red Hat Product Security has rated this update as having Moderate security
  impact. Common Vulnerability Scoring System (CVSS) base scores, which give
  detailed severity ratings, are available for each vulnerability from the
  CVE links in the References section.

  Red Hat Identity Management (IdM) is a centralized authentication, identity
  management, and authorization solution for both traditional and cloud-based
  enterprise environments.

  Two cross-site scripting (XSS) flaws were found in jQuery, which impacted
  the Identity Management web administrative interface, and could allow an
  authenticated user to inject arbitrary HTML or web script into the
  interface. (CVE-2010-5312, CVE-2012-6662)

  Note: The IdM version provided by this update no longer uses jQuery.

  Bug fixes:

  * The ipa-server-install, ipa-replica-install, and ipa-client-install
  utilities are not supported on machines running in FIPS-140 mode.
  Previously, IdM did not warn users about this. Now, IdM does not allow
  running the utilities in FIPS-140 mode, and displays an explanatory
  message. (BZ#1131571)

  * If an Active Directory (AD) server was specified or discovered
  automatically when running the ipa-client-install utility, the utility
  produced a traceback instead of informing the user that an IdM server is
  expected in this situation. Now, ipa-client-install detects the AD server
  and fails with an explanatory message. (BZ#1132261)

  * When IdM servers were configured to require the TLS protocol version 1.1
  (TLSv1.1) or later in the httpd server, the ipa utility failed. With this
  update, running ipa works as expected with TLSv1.1 or later. (BZ#1154687)

  * In certain high-load environments, the Kerberos authentication step of
  the IdM client installer can fail. Previously, the entire client
  installation failed in this situation. This update modifies
  ipa-client-install to prefer the TCP protocol over the UDP protocol and to
  retry the authentication attempt in case of failure. (BZ#1161722)

  * If ipa-client-install updated or created the /etc/nsswitch.conf file, the
  sudo utility could terminate unexpectedly with a segmentation fault. Now,
  ipa-client-install puts a new line character at the end of nsswitch.conf if
  it modifies the last line of the file, fixing this bug. (BZ#1185207)

  * The ipa-client-automount utility failed with the "UNWILLING_TO_PERFORM"
  LDAP error when the nsslapd-minssf Red Hat Directory Server configuration
  parameter was set to "1". This update modifies ipa-client-automount to use
  encrypted connection for LDAP searches by default, and the utility now
  finishes successfully even with nsslapd-minssf specified. (BZ#1191040)

  * If installing an IdM server failed after the Certificate Authority (CA)
  installation, the "ipa-server-install --uninstall" command did not perform
  a proper cleanup. After the user issued "ipa-server-install --uninstall"
  and then attempted to install the server again, the installation failed.
  Now, "ipa-server-install --uninstall" removes the CA-related files in the
  described situation, and ipa-server-install no longer fails with the
  mentioned error message. (BZ#1198160)

  * Running ipa-client-install added the "sss" entry to the sudoers line in
  nsswitch.conf even if "sss" was already configured and the entry was
  present in the file. Duplicate "sss" then caused sudo to become
  unresponsive. Now, ipa-client-install no longer adds "sss" if it is already
  present in nsswitch.conf. (BZ#1198339)

  * After running ipa-client-install, it was not possible to log in using SSH
  under certain circumstances. Now, ipa-client-install no longer corrupts the
  sshd_config file, and the sshd service can start as expected, and logging
  in using SSH works in the described situation. (BZ#1201454)

  * An incorrect definition of the dc attribute in the
  /usr/share/ipa/05rfc2247.ldif file caused bogus error messages to be
  returned during migration. The attribute has been fixed, but the bug
  persists if the copy-schema-to-ca.py script was run on Red Hat Enterprise
  Linux 6.6 prior to running it on Red Hat Enterprise Linux 6.7. To work
  around this problem, manually copy /usr/share/ipa/schema/05rfc2247.ldif to
  /etc/dirsrv/slapd-PKI-IPA/schema/ and restart IdM. (BZ#1220788)

  All ipa users are advised to upgrade to these updated packages, which
  contain backported patches to correct these issues.
impacted_packages:
  - purl: pkg:rpm/redhat/ipa-debuginfo?arch=i686
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-admintools?arch=i686
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-server-trust-ad?arch=i686
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-client?arch=i686
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-python?arch=i686
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-server?arch=i686
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-server-selinux?arch=i686
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-server-trust-ad?arch=x86_64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-admintools?arch=x86_64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-python?arch=x86_64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-server?arch=x86_64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-server-selinux?arch=x86_64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-client?arch=x86_64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa?arch=src
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-python?arch=ppc64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-client?arch=ppc64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-admintools?arch=ppc64
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-client?arch=s390x
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-debuginfo?arch=s390x
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-admintools?arch=s390x
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ipa-python?arch=s390x
    affected_versions: vers:rpm/<3.0.0-47.el6
    fixed_versions: vers:rpm/3.0.0-47.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_1462.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_1462.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1132261
    reference_type: bug
    reference_id: 1132261
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1146870
    reference_type: bug
    reference_id: 1146870
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1154687
    reference_type: bug
    reference_id: 1154687
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1166041
    reference_type: bug
    reference_id: 1166041
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1166064
    reference_type: bug
    reference_id: 1166064
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1185207
    reference_type: bug
    reference_id: 1185207
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1198339
    reference_type: bug
    reference_id: 1198339
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1201454
    reference_type: bug
    reference_id: 1201454
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1205660
    reference_type: bug
    reference_id: 1205660
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1207649
    reference_type: bug
    reference_id: 1207649
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1220788
    reference_type: bug
    reference_id: 1220788
  - url: https://access.redhat.com/errata/RHSA-2015:1462
    reference_type:
    reference_id: RHSA-2015:1462
