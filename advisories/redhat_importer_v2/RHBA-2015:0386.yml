advisory_id: RHBA-2015:0386
datasource_id: redhat_importer_v2/RHBA-2015:0386
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhba-2015_0386.json
aliases:
  - CVE-2014-2856
  - CVE-2014-3537
  - CVE-2014-5029
  - CVE-2014-5030
  - CVE-2014-5031
summary: "Updated cups packages that fix several bugs and add one enhancement are now available\
  \ for Red Hat Enterprise Linux 7.\n\nCUPS provides a portable printing layer for Linux, UNIX,\
  \ and similar operating systems. \n\nThis update fixes the following bugs:\n\n* When using\
  \ the cupsEnumDests() API call, the libcups utility failed to take note of the client callback\
  \ function. As a consequence, applications using this API could terminate unexpectedly. The\
  \ cupsEnumDests() implementation has been fixed and callbacks now function as expected. (BZ#1072954)\
  \ \n\n* Previously, the CUPS scheduler used an incorrect D-Bus interface when trying to add\
  \ a colord profile, which led to colord profiles not working correctly. With this update,\
  \ the correct D-Bus interface is used, and colord profiles now function as expected. (BZ#1087323)\n\
  \n* When handling an incoming Internet Printing Protocol (IPP) request with an associated\
  \ document to follow, the CUPS scheduler did not check whether the client connection had data\
  \ available to read before starting to handle the document data. Consequently, in some instances,\
  \ a 10-second timeout could occur. The scheduler now checks for data availability before reading\
  \ the document data, thus fixing this bug. (BZ#1110259) \n\n* When the CUPS scheduler read\
  \ data from a client, it did not check for data availability in between reading the HTTP headers\
  \ and the Internet Printing Protocol (IPP) request. This led to a race condition causing client\
  \ requests to fail depending on the timing of the data packets. With this update, the scheduler\
  \ checks for data availability, preventing the race condition from occurring. (BZ#1113045)\
  \ \n\n* Previously, the manual page for the cupsd.conf(5) configuration file did not mention\
  \ the ErrorPolicy directive. Text describing this directive has now been added to the manual\
  \ page. (BZ#1120591) \n\n* Prior to this update, the cups utility was started before networking,\
  \ and therefore it was not available in some configurations. A patch has been applied to fix\
  \ this bug, and CUPS is now available throughout the network. (BZ#1144780) \n\n* A prior security\
  \ update changed the /etc/cups/ppd/ directory not to be world-readable. However, the cupsGetPPD()\
  \ function still assumed the files in the directory were world-readable. As a consequence,\
  \ cupsGetPPD() returned a symbolic link to a file in /etc/cups/ppd/ to the caller even though\
  \ the caller was not able to read it, which caused a variety of failures when printing. This\
  \ update fixes cupsGetPPD3() to check for readability, and these failures thus no longer occur.\
  \ (BZ#1153708)\n\n* A prior fix for setting the value of the FINAL_CONTENT_TYPE variable caused\
  \ unintended problems: the back end could not reliably determine the format of the input data\
  \ and forced FINAL_CONTENT_TYPE to always be \"printer/[queue name]\". The incorrect fix has\
  \ been reverted. Nevertheless, users who have files configured on both the local and remote\
  \ ends of their queues will still encounter this problem, and thus need to make the local\
  \ ends of their queues \"raw\". (BZ#1149245)\n\nIn addition, this update adds the following\
  \ enhancement:\n\n* Prior to this update, the commands required by the redhat-lsb-core package\
  \ were provided by the cups packages, which itself has other requirements on other packages.\
  \ To prevent redhat-lsb-core causing a larger dependency chain than needed, the CUPS client\
  \ commands required by redhat-lsb-core have been moved into a new sub-package, cups-clients.\
  \ (BZ#1115057) \n\nUsers of cups are advised to upgrade to these updated packages, which fix\
  \ these bugs and add this enhancement. After installing this update, the cupsd daemon will\
  \ be restarted automatically."
impacted_packages:
  - purl: pkg:rpm/redhat/cups-ipptool?arch=x86_64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-devel?arch=x86_64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-debuginfo?arch=x86_64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-client?arch=x86_64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-lpd?arch=x86_64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-libs?arch=x86_64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups?arch=x86_64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-devel?arch=i686&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-debuginfo?arch=i686&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-libs?arch=i686&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-filesystem?arch=noarch&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups?arch=src&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-ipptool?arch=s390x&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-debuginfo?arch=s390x&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-client?arch=s390x&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-lpd?arch=s390x&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-libs?arch=s390x&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-devel?arch=s390x&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups?arch=s390x&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-ipptool?arch=ppc64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-debuginfo?arch=ppc64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-client?arch=ppc64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-lpd?arch=ppc64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-libs?arch=ppc64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-devel?arch=ppc64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups?arch=ppc64&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-libs?arch=s390&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-devel?arch=s390&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-debuginfo?arch=s390&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-libs?arch=ppc&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-devel?arch=ppc&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/cups-debuginfo?arch=ppc&epoch=1
    affected_versions: vers:rpm/<1.6.3-17.el7
    fixed_versions: vers:rpm/1.6.3-17.el7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhba-2015_0386.json
weaknesses: []
references:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhba-2015_0386.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1087323
    reference_type: bug
    reference_id: 1087323
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1113045
    reference_type: bug
    reference_id: 1113045
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1144780
    reference_type: bug
    reference_id: 1144780
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1149245
    reference_type: bug
    reference_id: 1149245
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1153708
    reference_type: bug
    reference_id: 1153708
  - url: https://access.redhat.com/errata/RHBA-2015:0386
    reference_type:
    reference_id: RHBA-2015:0386
