advisory_id: RHSA-2018:1979
datasource_id: redhat_importer_v2/RHSA-2018:1979
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2018/rhsa-2018_1979.json
aliases:
  - CVE-2018-1080
summary: |
  An update for pki-core is now available for Red Hat Enterprise Linux 7.

  Red Hat Product Security has rated this update as having a security impact of Moderate. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

  The Public Key Infrastructure (PKI) Core contains fundamental packages required by Red Hat Certificate System.

  Security Fix(es):

  * pki-core: Mishandled ACL configuration in AAclAuthz.java reverses rules that allow and deny access (CVE-2018-1080)

  For more details about the security issue(s), including the impact, a CVSS score, and other related information, refer to the CVE page(s) listed in the References section.

  This issue was discovered by Fraser Tweedale (Red Hat).

  Bug Fix(es):

  * Previously, when ECC keys were enrolled, Certificate Management over CMS (CMC) authentication failed with a "TokenException: Unable to insert certificate into temporary database" error. As a consequence, the enrollment failed. This update fixes the problem. As a result, the mentioned bug no longer occurs. (BZ#1550581)

  * Previously, Certificate System used the same enrollment profiles for issuing RSA and ECC certificates. As a consequence, the key usage extension in issued certificates did not meet the Common Criteria standard. This update adds ECC-specific enrollment profiles where the key usage extension for TLS server and client certificates are different as described in RFC 6960. Additionally, the update changes existing profiles to issue only RSA certificates. As a result, the key usage extension in ECC certificates now meets the Common Criteria standard. (BZ#1554726)

  * The Certificate System server rejects saving invalid access control lists (ACL). As a consequence, when saving an ACL with an empty expression, the server rejected the update and the pkiconsole utility displayed an StringIndexOutOfBoundsException error. With this update, the utility rejects empty ACL expressions. As a result, invalid ACLs cannot be saved and the error is no longer displayed. (BZ#1557883)

  * Previously, due to a bug in the Certificate System installation procedure, installing a Key Recovery Authority (KRA) with ECC keys failed. To fix the problem, the installation process has been updated to handle both RSA and ECC subsystems automatically. As a result, installing subsystems with ECC keys no longer fail. (BZ#1581134)

  * Previously, during verification, Certificate System encoded the ECC public key incorrectly in CMC Certificate Request Message Format (CRMF) requests. As a consequence, requesting an ECC certificate with Certificate Management over CMS (CMC) in CRMF failed. The problem has been fixed, and as a result, CMC CRMF requests using ECC keys work as expected. (BZ#1585945)

  Enhancement(s):

  * The pkispawn man page has been updated and now describes the --skip-configuration and --skip-installation parameters. (BZ#1551067)

  * With this update, Certificate System adds the Subject Alternative Name (SAN) extension by default to server certificates and sets it to the Common Name (CN) of the certificate. (BZ#1581135)

  * With this enhancement, users can create Certificate Request Message Format (CRMF) requests without the key archival option when using the CRMFPopClient utility. This feature increases flexibility because a Key Recovery Authority (KRA) certificate is no longer required. Previously, if the user did not pass the "-b transport_certificate_file" option to CRMFPopClient, the utility automatically used the KRA transport certificate stored in the transport.txt file. With this update, if "-b transport_certificate_file" is not specified, Certificate System creates a request without using key archival. (BZ#1588945)
impacted_packages:
  - purl: pkg:rpm/redhat/pki-kra?arch=noarch
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-server?arch=noarch
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-base-java?arch=noarch
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-ca?arch=noarch
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-base?arch=noarch
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-javadoc?arch=noarch
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-symkey?arch=x86_64
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-core-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-tools?arch=x86_64
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-core?arch=src
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-core-debuginfo?arch=ppc64le
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-tools?arch=ppc64le
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-symkey?arch=ppc64le
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-symkey?arch=s390x
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-core-debuginfo?arch=s390x
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-tools?arch=s390x
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-symkey?arch=ppc64
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-core-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-tools?arch=ppc64
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-symkey?arch=aarch64
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-core-debuginfo?arch=aarch64
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-tools?arch=aarch64
    affected_versions: vers:rpm/<10.5.1-13.1.el7_5
    fixed_versions: vers:rpm/10.5.1-13.1.el7_5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2018/rhsa-2018_1979.json
weaknesses: []
references:
  - url: https://access.redhat.com/errata/RHSA-2018:1979
    reference_type:
    reference_id:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2018/rhsa-2018_1979.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1550581
    reference_type: bug
    reference_id: 1550581
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1551067
    reference_type: bug
    reference_id: 1551067
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1552241
    reference_type: bug
    reference_id: 1552241
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1554726
    reference_type: bug
    reference_id: 1554726
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1554727
    reference_type: bug
    reference_id: 1554727
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1556657
    reference_type: bug
    reference_id: 1556657
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1557880
    reference_type: bug
    reference_id: 1557880
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1557883
    reference_type: bug
    reference_id: 1557883
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1558919
    reference_type: bug
    reference_id: 1558919
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1571582
    reference_type: bug
    reference_id: 1571582
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1572548
    reference_type: bug
    reference_id: 1572548
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1581134
    reference_type: bug
    reference_id: 1581134
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1581135
    reference_type: bug
    reference_id: 1581135
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1585945
    reference_type: bug
    reference_id: 1585945
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1587826
    reference_type: bug
    reference_id: 1587826
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1588944
    reference_type: bug
    reference_id: 1588944
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1588945
    reference_type: bug
    reference_id: 1588945
