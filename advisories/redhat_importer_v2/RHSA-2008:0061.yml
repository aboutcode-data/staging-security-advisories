advisory_id: RHSA-2008:0061
datasource_id: redhat_importer_v2/RHSA-2008:0061
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2008/rhsa-2008_0061.json
aliases:
  - CVE-2007-5495
  - CVE-2007-5496
summary: "Updated setroubleshoot packages that fix two security issues and several\nbugs are\
  \ now available for Red Hat Enterprise Linux 5.\n\nThis update has been rated as having moderate\
  \ security impact by the Red\nHat Security Response Team.\n\nThe setroubleshoot packages provide\
  \ tools to help diagnose SELinux\nproblems. When AVC messages occur, an alert is generated\
  \ that gives\ninformation about the problem, and how to create a resolution.\n\nA flaw was\
  \ found in the way sealert wrote diagnostic messages to a\ntemporary file. A local unprivileged\
  \ user could perform a symbolic link\nattack, and cause arbitrary files, writable by other\
  \ users, to be\noverwritten when a victim runs sealert. (CVE-2007-5495)\n\nA flaw was found\
  \ in the way sealert displayed records from the\nsetroubleshoot database as unescaped HTML.\
  \ An local unprivileged attacker\ncould cause AVC denial events with carefully crafted process\
  \ or file names,\ninjecting arbitrary HTML tags into the logs, which could be used as a\n\
  scripting attack, or to confuse the user running sealert. (CVE-2007-5496)\n\nAdditionally,\
  \ the following bugs have been fixed in these update packages:\n\n* in certain situations,\
  \ the sealert process used excessive CPU. These\nalerts are now capped at a maximum of 30,\
  \ D-Bus is used instead of polling,\nthreads causing excessive wake-up have been removed,\
  \ and more robust\nexception-handling has been added.\n\n* different combinations of the sealert\
  \ '-a', '-l', '-H', and '-v' options\ndid not work as documented.\n\n* the SETroubleShoot\
  \ browser did not allow multiple entries to be deleted. \n\n* the SETroubleShoot browser did\
  \ not display statements that displayed\nwhether SELinux was using Enforcing or Permissive\
  \ mode, particularly when\nwarning about SELinux preventions.\n\n* in certain cases, the SETroubleShoot\
  \ browser gave incorrect instructions\nregarding paths, and would not display the full paths\
  \ to files.\n\n* adding an email recipient to the recipients option from the\n/etc/setroubleshoot/setroubleshoot.cfg\
  \ file and then generating an SELinux\ndenial caused a traceback error. The recipients option\
  \ has been removed;\nemail addresses are now managed through the SETroubleShoot browser by\n\
  navigating to File -> Edit Email Alert List, or by editing the\n/var/lib/setroubleshoot/email_alert_recipients\
  \ file.\n\n* the setroubleshoot browser incorrectly displayed a period between the\nhttpd_sys_content_t\
  \ context and the directory path.\n\n* on the PowerPC architecture, The get_credentials()\
  \ function in\naccess_control.py would generate an exception when it called the\nsocket.getsockopt()\
  \ function.\n\n* The code which handles path information has been completely rewritten so\n\
  that assumptions on path information which were misleading are no longer\nmade. If the path\
  \ information is not present, it will be presented as\n\"<Unknown>\".\n\n* setroubleshoot\
  \ had problems with non-English locales under certain\ncircumstances, possibly causing a python\
  \ traceback, an sealert window\npop-up containing an error, a \"RuntimeError: maximum recursion\
  \ depth\nexceeded\" error after a traceback, or a \"UnicodeEncodeError\" after a traceback.\n\
  \n* sealert ran even when SELinux was disabled, causing \"attempt to open\nserver connection\
  \ failed\" errors. Sealert now checks whether SELinux is\nenabled or disabled.\n\n* the database\
  \ setroubleshoot maintains was world-readable. The\nsetroubleshoot database is now mode 600,\
  \ and is owned by the root user and\ngroup.\n\n* setroubleshoot did not validate requests\
  \ to set AVC filtering options for\nusers. In these updated packages, checks ensure that requests\
  \ originate\nfrom the filter owner.\n\n* the previous setroubleshoot packages required a number\
  \ of GNOME packages\nand libraries. setroubleshoot has therefore been split into 2 packages:\n\
  setroubleshoot and setroubleshoot-server.\n\n* a bug in decoding the audit field caused an\
  \ \"Input is not proper UTF-8,\nindicate encoding!\" error message. The decoding code has\
  \ been rewritten.\n\n* a file name mismatch in the setroubleshoot init script would cause\
  \ a\nfailure to shut down.\n\nUsers of setroubleshoot are advised to upgrade to these updated\
  \ packages,\nwhich resolve these issues."
impacted_packages:
  - purl: pkg:rpm/redhat/setroubleshoot-plugins?arch=src
    affected_versions: vers:rpm/<2.0.4-2.el5
    fixed_versions: vers:rpm/2.0.4-2.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/setroubleshoot?arch=src
    affected_versions: vers:rpm/<2.0.5-3.el5
    fixed_versions: vers:rpm/2.0.5-3.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/setroubleshoot-plugins?arch=noarch
    affected_versions: vers:rpm/<2.0.4-2.el5
    fixed_versions: vers:rpm/2.0.4-2.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/setroubleshoot-server?arch=noarch
    affected_versions: vers:rpm/<2.0.5-3.el5
    fixed_versions: vers:rpm/2.0.5-3.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/setroubleshoot?arch=noarch
    affected_versions: vers:rpm/<2.0.5-3.el5
    fixed_versions: vers:rpm/2.0.5-3.el5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2008/rhsa-2008_0061.json
weaknesses: []
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=288221
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=288271
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2008/rhsa-2008_0061.json
    reference_type:
    reference_id:
  - url: http://www.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=227806
    reference_type: bug
    reference_id: 227806
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=240355
    reference_type: bug
    reference_id: 240355
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=241543
    reference_type: bug
    reference_id: 241543
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=243800
    reference_type: bug
    reference_id: 243800
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=244345
    reference_type: bug
    reference_id: 244345
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=250239
    reference_type: bug
    reference_id: 250239
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=288881
    reference_type: bug
    reference_id: 288881
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=312281
    reference_type: bug
    reference_id: 312281
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=431768
    reference_type: bug
    reference_id: 431768
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=436564
    reference_type: bug
    reference_id: 436564
  - url: https://access.redhat.com/errata/RHSA-2008:0061
    reference_type:
    reference_id: RHSA-2008:0061
