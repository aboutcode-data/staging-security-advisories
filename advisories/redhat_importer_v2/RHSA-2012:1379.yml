advisory_id: RHSA-2012:1379
datasource_id: redhat_importer_v2/RHSA-2012:1379
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_1379.json
aliases:
  - CVE-2012-4406
summary: |
  Updated openstack-swift packages that fix one security issue are now
  available for Red Hat OpenStack Essex.

  The Red Hat Security Response Team has rated this update as having
  important security impact. A Common Vulnerability Scoring System (CVSS)
  base score, which gives a detailed severity rating, is available from the
  CVE link in the References section.

  OpenStack Swift (http://swift.openstack.org) is a highly available,
  distributed, eventually consistent object/blob store.

  It was found that OpenStack Swift used the Python pickle module in an
  insecure way to serialize and deserialize data from memcached. As
  memcached does not have authentication, an attacker on the local network,
  or possibly an unprivileged user in a virtual machine hosted on OpenStack,
  could use this flaw to inject specially-crafted data that would lead to
  arbitrary code execution. (CVE-2012-4406)

  Red Hat would like to thank Sebastian Krahmer of the SUSE Security Team for
  reporting this issue.

  Note: The fix for CVE-2012-4406 is not enabled by default, and requires
  manual action on the affected Proxy nodes. This update adds a
  "memcache_serialization_support" option. It is configured in
  "/etc/swift/proxy-server.conf" and is set to "0" by default. This default
  setting is vulnerable to CVE-2012-4406.

  To enable the fix, this option must be changed; however, the required
  changes can have a temporary, large performance impact. The following
  instructions aim to minimize performance issues:

  1) Install the updated openstack-swift packages.

  2) In "/etc/swift/proxy-server.conf", set the
  "memcache_serialization_support" option in the memcache/[filter:cache]
  section to "1". (The default value, "0", leaves you vulnerable to
  CVE-2012-4406.) When set to "1", the JSON (JavaScript Object Notation)
  format is used but pickle is still supported. This configuration is still
  vulnerable, but new data will be stored in JSON format.

  3) After setting the option to "1", run "service openstack-swift-proxy
  restart".

  4) After 24 hours, set the "memcache_serialization_support" option in
  "/etc/swift/proxy-server.conf" to "2". "2" is the secure option: only JSON
  is used.

  5) After setting the option to "2", run "service openstack-swift-proxy
  restart".

  If "memcache_serialization_support" is set directly from "0" to "2", all
  data in memcached will be flushed and re-created. This can lead to a
  temporary, large performance impact.

  All users of openstack-swift are advised to upgrade to these updated
  packages, which correct this issue.
impacted_packages:
  - purl: pkg:rpm/redhat/openstack-swift-account?arch=noarch
    affected_versions: vers:rpm/<1.4.8-5.el6
    fixed_versions: vers:rpm/1.4.8-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openstack-swift-proxy?arch=noarch
    affected_versions: vers:rpm/<1.4.8-5.el6
    fixed_versions: vers:rpm/1.4.8-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openstack-swift?arch=noarch
    affected_versions: vers:rpm/<1.4.8-5.el6
    fixed_versions: vers:rpm/1.4.8-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openstack-swift-object?arch=noarch
    affected_versions: vers:rpm/<1.4.8-5.el6
    fixed_versions: vers:rpm/1.4.8-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openstack-swift-container?arch=noarch
    affected_versions: vers:rpm/<1.4.8-5.el6
    fixed_versions: vers:rpm/1.4.8-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openstack-swift-doc?arch=noarch
    affected_versions: vers:rpm/<1.4.8-5.el6
    fixed_versions: vers:rpm/1.4.8-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openstack-swift?arch=src
    affected_versions: vers:rpm/<1.4.8-5.el6
    fixed_versions: vers:rpm/1.4.8-5.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_1379.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_1379.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=854757
    reference_type: bug
    reference_id: 854757
  - url: https://access.redhat.com/errata/RHSA-2012:1379
    reference_type:
    reference_id: RHSA-2012:1379
