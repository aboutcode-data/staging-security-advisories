advisory_id: RHSA-2010:0838
datasource_id: redhat_importer_v2/RHSA-2010:0838
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2010/rhsa-2010_0838.json
aliases:
  - CVE-2004-2761
  - CVE-2010-3868
  - CVE-2010-3869
summary: |
  Updated pki-ca, pki-util, and pki-common packages that fix three security
  issues and add several enhancements are now available for Red Hat
  Certificate System 8.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. Common Vulnerability Scoring System (CVSS) base scores,
  which give detailed severity ratings, are available for each vulnerability
  from the CVE links in the References section.

  Red Hat Certificate System is an enterprise software system designed to
  manage enterprise public key infrastructure (PKI) deployments. Simple
  Certificate Enrollment Protocol (SCEP) is a PKI communication protocol
  used to automatically enroll certificates for network devices.

  The certificate authority allowed unauthenticated users to request the
  one-time PIN in an SCEP request to be decrypted. An attacker able to sniff
  an SCEP request from a network device could request the certificate
  authority to decrypt the request, allowing them to obtain the one-time
  PIN. With this update, the certificate authority only handles decryption
  requests from authenticated registration authorities. (CVE-2010-3868)

  The certificate authority allowed the one-time PIN used in SCEP requests
  to be re-used. An attacker possessing a valid SCEP enrollment one-time PIN
  could use it to generate an unlimited number of certificates.
  (CVE-2010-3869)

  The certificate authority used the MD5 hash algorithm to sign all SCEP
  protocol responses. As MD5 is not collision resistant, an attacker could
  use this flaw to perform an MD5 chosen-prefix collision attack to generate
  attack-chosen output signed using the certificate authority's key.
  (CVE-2004-2761)

  This update also adds the following enhancements:

  * New configuration options for the SCEP server can define the default and
  allowed encryption and hash algorithms. These options allow disabling uses
  of the weaker algorithms not required by network devices and prevent
  possible downgrade attacks. These can be configured by adding the following
  options to the certificate authority's CS.cfg configuration file:

     ca.scep.encryptionAlgorithm=DES3
     ca.scep.allowedEncryptionAlgorithms=DES3
     ca.scep.hashAlgorithm=SHA1
     ca.scep.allowedHashAlgorithms=SHA1,SHA256,SHA512

  * With this update, the certificate authority's SCEP server is disabled by
  default. The SCEP server can be enabled by adding the 'ca.scep.enable=true'
  option to the certificate authority's CS.cfg configuration file.

  * A separate key pair can now be configured for use in SCEP communication.
  Previously, the main certificate authority's key pair was used for SCEP
  communication too. A designated SCEP key pair can be referenced by adding
  a new option, ca.scep.nickname=[scep certificate nickname], to the
  certificate authority's CS.cfg configuration file.

  * The certificate authority now allows the size of nonces used in SCEP
  requests to be restricted by adding a new option, ca.scep.nonceSizeLimit=
  [number of bytes], to the certificate authority's CS.cfg configuration
  file. The limit is set to 16 bytes in the default CS.cfg configuration
  file.

  All users of Red Hat Certificate System 8 should upgrade to these updated
  packages, which resolve these issues and add these enhancements.
impacted_packages:
  - purl: pkg:rpm/redhat/pki-ca?arch=src
    affected_versions: vers:rpm/<8.0.7-1.el5pki
    fixed_versions: vers:rpm/8.0.7-1.el5pki
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-util?arch=src
    affected_versions: vers:rpm/<8.0.5-1.el5pki
    fixed_versions: vers:rpm/8.0.5-1.el5pki
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-common?arch=src
    affected_versions: vers:rpm/<8.0.6-2.el5pki
    fixed_versions: vers:rpm/8.0.6-2.el5pki
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-ca?arch=noarch
    affected_versions: vers:rpm/<8.0.7-1.el5pki
    fixed_versions: vers:rpm/8.0.7-1.el5pki
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-util?arch=noarch
    affected_versions: vers:rpm/<8.0.5-1.el5pki
    fixed_versions: vers:rpm/8.0.5-1.el5pki
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-util-javadoc?arch=noarch
    affected_versions: vers:rpm/<8.0.5-1.el5pki
    fixed_versions: vers:rpm/8.0.5-1.el5pki
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-common-javadoc?arch=noarch
    affected_versions: vers:rpm/<8.0.6-2.el5pki
    fixed_versions: vers:rpm/8.0.6-2.el5pki
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pki-common?arch=noarch
    affected_versions: vers:rpm/<8.0.6-2.el5pki
    fixed_versions: vers:rpm/8.0.6-2.el5pki
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2010/rhsa-2010_0838.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=648882
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=648883
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=648886
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2010/rhsa-2010_0838.json
    reference_type:
    reference_id:
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/multiple/dos/24807.txt
    reference_type: exploit
    reference_id: CVE-2004-2761;OSVDB-45127
  - url: https://www.securityfocus.com/bid/11849/info
    reference_type: exploit
    reference_id: CVE-2004-2761;OSVDB-45127
  - url: https://access.redhat.com/errata/RHSA-2010:0838
    reference_type:
    reference_id: RHSA-2010:0838
