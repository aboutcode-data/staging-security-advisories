advisory_id: RHSA-2012:0720
datasource_id: redhat_importer_v2/RHSA-2012:0720
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0720.json
aliases:
  - CVE-2012-0217
  - CVE-2012-1583
summary: |
  Updated kernel packages that fix two security issues and multiple bugs are
  now available for Red Hat Enterprise Linux 5.6 Extended Update Support.

  The Red Hat Security Response Team has rated this update as having
  important security impact. Common Vulnerability Scoring System (CVSS) base
  scores, which give detailed severity ratings, are available for each
  vulnerability from the CVE links in the References section.

  [Updated 19th June 2012]
  The original erratum text provided an incorrect description for BZ#807929.
  The text has been updated to provide the correct description. No changes
  have been made to the packages.

  The kernel packages contain the Linux kernel, the core of any Linux
  operating system.

  This update fixes the following security issues:

  * It was found that the Xen hypervisor implementation as shipped with Red
  Hat Enterprise Linux 5 did not properly restrict the syscall return
  addresses in the sysret return path to canonical addresses. An
  unprivileged user in a 64-bit para-virtualized guest, that is running on a
  64-bit host that has an Intel CPU, could use this flaw to crash the host
  or, potentially, escalate their privileges, allowing them to execute
  arbitrary code at the hypervisor level. (CVE-2012-0217, Important)

  Note: For Red Hat Enterprise Linux guests, only privileged guest users can
  exploit CVE-2012-0217.

  * A flaw in the xfrm6_tunnel_rcv() function in the Linux kernel's IPv6
  implementation could lead to a use-after-free or double free flaw in
  tunnel6_rcv(). A remote attacker could use this flaw to send
  specially-crafted packets to a target system that is using IPv6 and also
  has the xfrm6_tunnel kernel module loaded, causing it to crash.
  (CVE-2012-1583, Important)

  If you do not run applications that use xfrm6_tunnel, you can prevent the
  xfrm6_tunnel module from being loaded by creating (as the root user) a
  "/etc/modprobe.d/xfrm6_tunnel.conf" file, and adding the following line to
  it:

  blacklist xfrm6_tunnel

  This way, the xfrm6_tunnel module cannot be loaded accidentally. A reboot
  is not necessary for this change to take effect.

  Red Hat would like to thank the Xen project for reporting CVE-2012-0217.
  Upstream acknowledges Rafal Wojtczuk as the original reporter of
  CVE-2012-0217.

  This update also fixes the following bugs:

  * A bug in the vsyscall interface caused 32-bit multi-threaded programs,
  which received the SIGCANCEL signal right after they returned from a system
  call, to terminate unexpectedly with a segmentation fault when run on the
  AMD64 or Intel 64 architecture. A patch has been provided to address this
  issue and the crashes no longer occur in the described scenario.
  (BZ#807929)

  * Incorrect duplicate MAC addresses were being used on a rack network
  daughter card that contained a quad-port Intel I350 Gigabit Ethernet
  Controller. With this update, the underlying source code has been modified
  to address this issue, and correct MAC addresses are now used under all
  circumstances. (BZ#813195)

  * When the Fibre Channel (FC) layer sets a device to "running", the layer
  also scans for other new devices. Previously, there was a race condition
  between these two operations. Consequently, for certain targets, thousands
  of invalid devices were created by the SCSI layer and the udev service.
  This update ensures that the FC layer always sets a device to "online"
  before scanning for others, thus fixing this bug.

  Additionally, when attempting to transition priority groups on a busy FC
  device, the multipath layer retried immediately. If this was the only
  available path, a large number of retry operations were performed in a
  short period of time. Consequently, the logging of retry messages slowed
  down the system. This bug has been fixed by ensuring that the DM Multipath
  feature delays retry operations in the described scenario. (BZ#816683)

  * Due to incorrect use of the list_for_each_entry_safe() macro, the
  enumeration of remote procedure calls (RPCs) priority wait queue tasks
  stored in the tk_wait.links list failed. As a consequence, the
  rpc_wake_up() and rpc_wake_up_status() functions failed to wake up all
  tasks. This caused the system to become unresponsive and could
  significantly decrease system performance. Now, the
  list_for_each_entry_safe() macro is no longer used in rpc_wake_up(),
  ensuring reasonable system performance. (BZ#817570)

  Users should upgrade to these updated packages, which contain backported
  patches to correct these issues. The system must be rebooted for this
  update to take effect.
impacted_packages:
  - purl: pkg:rpm/redhat/kernel?arch=src
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xen?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xen-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xen-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common?arch=x86_64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xen?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-PAE?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xen-devel?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xen-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-PAE-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-PAE-devel?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common?arch=i686
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=i386
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump-devel?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common?arch=s390x
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump-devel?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-kdump-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common?arch=ppc64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=ppc
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xen?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-devel?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xen-devel?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xen-debuginfo?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debug-debuginfo?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-headers?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo-common?arch=ia64
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-doc?arch=noarch
    affected_versions: vers:rpm/<2.6.18-238.39.1.el5
    fixed_versions: vers:rpm/2.6.18-238.39.1.el5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0720.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0720.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=752304
    reference_type: bug
    reference_id: 752304
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=813428
    reference_type: bug
    reference_id: 813428
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=817570
    reference_type: bug
    reference_id: 817570
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/freebsd_x86-64/local/46508.rb
    reference_type: exploit
    reference_id: CVE-2012-0217
  - url: https://raw.githubusercontent.com/rapid7/metasploit-framework/468679f9074ee4a7de7624d3440ff6e7f65cf9c2/modules/exploits/freebsd/local/intel_sysret_priv_esc.rb
    reference_type: exploit
    reference_id: CVE-2012-0217
  - url: http://packetstormsecurity.org/files/115908/sysret.rar
    reference_type: exploit
    reference_id: CVE-2012-0217;OSVDB-82850;MS12-042
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/windows_x86-64/local/20861.txt
    reference_type: exploit
    reference_id: CVE-2012-0217;OSVDB-82850;MS12-042
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/freebsd/local/28718.c
    reference_type: exploit
    reference_id: CVE-2012-0217;OSVDB-82949
  - url: https://access.redhat.com/errata/RHSA-2012:0720
    reference_type:
    reference_id: RHSA-2012:0720
