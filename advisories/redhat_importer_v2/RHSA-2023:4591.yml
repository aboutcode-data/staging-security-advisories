advisory_id: RHSA-2023:4591
datasource_id: redhat_importer_v2/RHSA-2023:4591
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2023/rhsa-2023_4591.json
aliases:
  - CVE-2023-30608
  - CVE-2023-31047
summary: "An updated version of Red Hat Update Infrastructure (RHUI) is now available. RHUI\
  \ 4.5 fixes several security and operational bugs and also adds several new features.\n\n\
  Red Hat Update Infrastructure (RHUI) offers a highly scalable, highly redundant framework\
  \ that enables you to manage repositories and content. It also enables cloud providers to\
  \ deliver content and updates to Red Hat Enterprise Linux (RHEL) instances.\n\nSecurity Fix(es):\n\
  * Django: Potential bypass of validation when uploading multiple files using a single form\
  \ field (CVE-2023-31047)\n\n* sqlparse: Parser contains a regular expression that is vulnerable\
  \ to ReDOS (Regular Expression Denial of Service) (CVE-2023-30608)\n\nThis RHUI update fixes\
  \ the following bugs:\n\n* Previously, the `rhui-manager` command used the `logname` command\
  \ to obtain the login name. However, when `rhui-manager` is run using the `rhui-repo-sync`\
  \ cron job, a login name is not defined. Consequently, emails sent by the cron job contained\
  \ the error message `logname: no login name`. With this update, `rhui-manager` does not obtain\
  \ the login name using the `logname` command and the error message is no longer generated.\n\
  \n* Previously, when an invalid repository ID was used with the `rhui-manager` command to\
  \ synchronize or delete a repository, the command failed with following error:\n`An unexpected\
  \ error has occurred during the last operation.`\nAdditionally, a traceback was also logged.\
  \ \nWith this update, the error message has been improved and failure to run no longer logs\
  \ a traceback.\n\nThis RHUI update introduces the following enhancements:\n\n* With this update,\
  \ the client configuration RPMs in `rhui-manager` prevent subscription manager from automatically\
  \ enabling `yum` plugins. As a result, RHUI repository users will no longer see irrelevant\
  \ messages from subscription manager. (BZ#1957871)\n\n* With this update, you can generate\
  \ machine-readable files with the status of each RHUI repository. To use this feature, run\
  \ the following command: \n`rhui-manager --non-interactive status --repo_json <output file>`\n\
  \ (BZ#2079391)\n\n* With this update, the `rhui-manager` CLI command uses a variety of unique\
  \ exit codes to indicate different types of errors. For example, if you attempt to add a Red\
  \ Hat repository that has already been added, the command will exit with a status of 245.\
  \ However, if you attempt to add a Red Hat repository that does not exist in the RHUI entitlement,\
  \ the command will exit with a status of 246. For a complete list of codes, see the `/usr/lib/python3.6/site-packages/rhui/common/rhui_exit_codes.py`\
  \ file."
impacted_packages:
  - purl: pkg:rpm/redhat/rhui-installer?arch=src
    affected_versions: vers:rpm/<4.5.0.1-1.el8ui
    fixed_versions: vers:rpm/4.5.0.1-1.el8ui
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhui-tools?arch=src
    affected_versions: vers:rpm/<4.5.0.5-1.el8ui
    fixed_versions: vers:rpm/4.5.0.5-1.el8ui
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-django?arch=src
    affected_versions: vers:rpm/<3.2.19-1.0.1.el8ui
    fixed_versions: vers:rpm/3.2.19-1.0.1.el8ui
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-sqlparse?arch=src
    affected_versions: vers:rpm/<0.4.4-1.0.1.el8ui
    fixed_versions: vers:rpm/0.4.4-1.0.1.el8ui
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhui-installer?arch=noarch
    affected_versions: vers:rpm/<4.5.0.1-1.el8ui
    fixed_versions: vers:rpm/4.5.0.1-1.el8ui
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhui-tools?arch=noarch
    affected_versions: vers:rpm/<4.5.0.5-1.el8ui
    fixed_versions: vers:rpm/4.5.0.5-1.el8ui
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhui-tools-libs?arch=noarch
    affected_versions: vers:rpm/<4.5.0.5-1.el8ui
    fixed_versions: vers:rpm/4.5.0.5-1.el8ui
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python39-django?arch=noarch
    affected_versions: vers:rpm/<3.2.19-1.0.1.el8ui
    fixed_versions: vers:rpm/3.2.19-1.0.1.el8ui
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python39-sqlparse?arch=noarch
    affected_versions: vers:rpm/<0.4.4-1.0.1.el8ui
    fixed_versions: vers:rpm/0.4.4-1.0.1.el8ui
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2023/rhsa-2023_4591.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://issues.redhat.com/browse/RHUI-217
    reference_type:
    reference_id:
  - url: https://issues.redhat.com/browse/RHUI-263
    reference_type:
    reference_id:
  - url: https://issues.redhat.com/browse/RHUI-356
    reference_type:
    reference_id:
  - url: https://issues.redhat.com/browse/RHUI-395
    reference_type:
    reference_id:
  - url: https://issues.redhat.com/browse/RHUI-424
    reference_type:
    reference_id:
  - url: https://issues.redhat.com/browse/RHUI-430
    reference_type:
    reference_id:
  - url: https://issues.redhat.com/browse/RHUI-75
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2023/rhsa-2023_4591.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1957871
    reference_type: bug
    reference_id: '1957871'
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2079391
    reference_type: bug
    reference_id: 2079391
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2187903
    reference_type: bug
    reference_id: 2187903
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2192565
    reference_type: bug
    reference_id: 2192565
  - url: https://access.redhat.com/errata/RHSA-2023:4591
    reference_type:
    reference_id: RHSA-2023:4591
