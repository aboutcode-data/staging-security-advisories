advisory_id: RHSA-2017:2858
datasource_id: redhat_importer_v2/RHSA-2017:2858
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2017/rhsa-2017_2858.json
aliases:
  - CVE-2017-12150
  - CVE-2017-12151
  - CVE-2017-12163
summary: |
  An update for samba is now available for Red Hat Gluster Storage 3.3 for RHEL 6 and Red Hat Gluster Storage 3.3 for RHEL 7.

  Red Hat Product Security has rated this update as having a security impact of Moderate. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

  Samba is an open-source implementation of the Server Message Block (SMB) protocol and the related Common Internet File System (CIFS) protocol, which allow PC-compatible machines to share files, printers, and various information.

  Security Fix(es):

  * It was found that samba did not enforce "SMB signing" when certain configuration options were enabled. A remote attacker could launch a man-in-the-middle attack and retrieve information in plain-text. (CVE-2017-12150)

  * A flaw was found in the way samba client used encryption with the max protocol set as SMB3. The connection could lose the requirement for signing and encrypting to any DFS redirects, allowing an attacker to read or alter the contents of the connection via a man-in-the-middle attack. (CVE-2017-12151)

  * An information leak flaw was found in the way SMB1 protocol was implemented by Samba. A malicious client could use this flaw to dump server memory contents to a file on the samba share or to a shared printer, though the exact area of server memory cannot be controlled by the attacker. (CVE-2017-12163)

  Red Hat would like to thank the Samba project for reporting CVE-2017-12150 and CVE-2017-12151 and Yihan Lian and Zhibin Hu (Qihoo 360 GearTeam), Stefan Metzmacher (SerNet), and Jeremy Allison (Google) for reporting CVE-2017-12163. Upstream acknowledges Stefan Metzmacher (SerNet) as the original reporter of CVE-2017-12150 and CVE-2017-12151.
impacted_packages:
  - purl: pkg:rpm/redhat/samba?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-winbind?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libsmbclient-devel?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-common-tools?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-dc?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ctdb-tests?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-krb5-printing?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libsmbclient?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-test?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ctdb?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-devel?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-python?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-test-libs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-common-libs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-winbind-krb5-locator?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-client-libs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-winbind-modules?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-client?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libwbclient?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-dc-libs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-vfs-glusterfs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libwbclient-devel?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-libs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-winbind-clients?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-winbind-clients?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-winbind?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-common-tools?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-client-libs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-common-libs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-libs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-winbind-modules?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-winbind-krb5-locator?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-python?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libsmbclient-devel?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-dc-libs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libwbclient-devel?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-client?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libwbclient?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-dc?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-test-libs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-krb5-printing?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-devel?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ctdb?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-test?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-vfs-glusterfs?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ctdb-tests?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libsmbclient?arch=x86_64
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-common?arch=noarch
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-pidl?arch=noarch
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-pidl?arch=noarch
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba-common?arch=noarch
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba?arch=src
    affected_versions: vers:rpm/<4.6.3-6.el6rhs
    fixed_versions: vers:rpm/4.6.3-6.el6rhs
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/samba?arch=src
    affected_versions: vers:rpm/<4.6.3-6.el7rhgs
    fixed_versions: vers:rpm/4.6.3-6.el7rhgs
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2017/rhsa-2017_2858.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2017/rhsa-2017_2858.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1488197
    reference_type: bug
    reference_id: 1488197
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1488400
    reference_type: bug
    reference_id: 1488400
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1491206
    reference_type: bug
    reference_id: 1491206
  - url: https://access.redhat.com/errata/RHSA-2017:2858
    reference_type:
    reference_id: RHSA-2017:2858
