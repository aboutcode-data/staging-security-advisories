advisory_id: RHSA-2012:0670
datasource_id: redhat_importer_v2/RHSA-2012:0670
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0670.json
aliases:
  - CVE-2011-4086
  - CVE-2012-2123
summary: "Updated kernel-rt packages that fix two security issues and various bugs\nare now\
  \ available for Red Hat Enterprise MRG 2.1.\n\nThe Red Hat Security Response Team has rated\
  \ this update as having\nimportant security impact. Common Vulnerability Scoring System (CVSS)\
  \ base\nscores, which give detailed severity ratings, are available for each\nvulnerability\
  \ from the CVE links in the References section.\n\nThe kernel-rt packages contain the Linux\
  \ kernel, the core of any Linux\noperating system.\n\nThis update fixes the following security\
  \ issues:\n\n* When a set user ID (setuid) application is executed, certain personality\n\
  flags for controlling the application's behavior are cleared (that is, a\nprivileged application\
  \ will not be affected by those flags). It was found\nthat those flags were not cleared if\
  \ the application was made privileged\nvia file system capabilities. A local, unprivileged\
  \ user could use this\nflaw to change the behavior of such applications, allowing them to\
  \ bypass\nintended restrictions. Note that for default installations, no application\nshipped\
  \ by Red Hat for Red Hat Enterprise MRG is made privileged via file\nsystem capabilities.\
  \ (CVE-2012-2123, Important)\n\n* A flaw was found in the way the Linux kernel's journal_unmap_buffer()\n\
  function handled buffer head states. On systems that have an ext4 file\nsystem with a journal\
  \ mounted, a local, unprivileged user could use this\nflaw to cause a denial of service. (CVE-2011-4086,\
  \ Moderate)\n\nThis update also fixes the following bugs:\n\n* The CAP_SYS_ADMIN check was\
  \ missing from the dmesg_restrict feature.\nConsequently, an unprivileged and jailed root\
  \ user could bypass the\ndmesg_restrict protection. This update adds CAP_SYS_ADMIN to both\n\
  dmesg_restrict and kptr_restrict, which only allows writing to\ndmesg_restrict when root has\
  \ CAP_SYS_ADMIN. (BZ#808271)\n\n* Previously, the _copy_from_pages() function, which is used\
  \ to copy data \nfrom the temporary buffer to the user-passed buffer, was passed the wrong\
  \ \nsize parameter when copying data. Consequently, if the user provided a \nbuffer greater\
  \ than PAGE_SIZE, the getxattr() syscalls were handled \nincorrectly. This update fixes _copy_from_pages()\
  \ to use the ACL length, \nwhich uses a correctly-sized buffer. (BZ#753230)\n\n* Some older\
  \ versions of hardware or their software could not recognize\ncertain commands and would log\
  \ messages for illegal or unsupported errors\nthe driver could not properly handle. This bug\
  \ has been fixed and no bogus\nerror messages are now returned in the described scenario.\
  \ (BZ#813892)\n\n* Previously, the qla2x00_poll() function did the local_irq_save() call\n\
  before calling qla24xx_intr_handler(), which had a spinlock. Since\nspinlocks are sleepable\
  \ in the real-time kernel, it is not allowed to call\nthem with interrupts disabled. This\
  \ scenario produced error messages and\ncould cause a system deadlock. With this update, the\n\
  local_irq_save_nort(flags) function is used to save flags without disabling\ninterrupts, which\
  \ prevents potential deadlocks and removes the error\nmessages. (BZ#818220)\n\nUsers should\
  \ upgrade to these updated packages, which correct these issues.\nThe system must be rebooted\
  \ for this update to take effect."
impacted_packages:
  - purl: pkg:rpm/redhat/kernel-rt-vanilla-devel?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-vanilla?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-debug-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-debug-devel?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-trace-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-trace-devel?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-devel?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-debug?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-vanilla-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-trace?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-debuginfo-common-x86_64?arch=x86_64
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-firmware?arch=noarch
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-doc?arch=noarch
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt?arch=src
    affected_versions: vers:rpm/<3.0.30-rt50.62.el6rt
    fixed_versions: vers:rpm/3.0.30-rt50.62.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0670.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=749143
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0670.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=806722
    reference_type: bug
    reference_id: 806722
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=818220
    reference_type: bug
    reference_id: 818220
  - url: https://access.redhat.com/errata/RHSA-2012:0670
    reference_type:
    reference_id: RHSA-2012:0670
