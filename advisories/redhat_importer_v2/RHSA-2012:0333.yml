advisory_id: RHSA-2012:0333
datasource_id: redhat_importer_v2/RHSA-2012:0333
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0333.json
aliases:
  - CVE-2011-2918
  - CVE-2011-4077
  - CVE-2011-4097
  - CVE-2011-4110
  - CVE-2011-4127
  - CVE-2011-4131
  - CVE-2011-4132
  - CVE-2012-0038
  - CVE-2012-0044
  - CVE-2012-0207
  - CVE-2012-0810
summary: |
  Updated kernel-rt packages that fix multiple security issues and various
  bugs are now available for Red Hat Enterprise MRG 2.1.

  The Red Hat Security Response Team has rated this update as having
  important security impact. Common Vulnerability Scoring System (CVSS) base
  scores, which give detailed severity ratings, are available for each
  vulnerability from the CVE links in the References section.

  These packages contain the Linux kernel.

  Security fixes:

  * SG_IO ioctl SCSI requests on partitions or LVM volumes could be passed to
  the underlying block device, allowing a privileged user to bypass
  restrictions and gain read and write access (and be able to issue other
  SCSI commands) to the entire block device. (CVE-2011-4127, Important)

  * A local, unprivileged user could use an integer overflow flaw in
  drm_mode_dirtyfb_ioctl() to cause a denial of service or escalate their
  privileges. (CVE-2012-0044, Important)

  * A local, unprivileged user could use a flaw in the Performance Events
  implementation to cause a denial of service. (CVE-2011-2918, Moderate)

  * A local, unprivileged user could use flaws in the XFS file system
  implementation to cause a denial of service or escalate their privileges by
  mounting a specially-crafted disk. (CVE-2011-4077, CVE-2012-0038, Moderate)

  * A local, unprivileged user could use a flaw in the Out of Memory (OOM)
  killer to monopolize memory, have their process skipped by the OOM killer,
  or cause other tasks to be terminated. (CVE-2011-4097, Moderate)

  * A local, unprivileged user could use a flaw in the key management
  facility to cause a denial of service. (CVE-2011-4110, Moderate)

  * A malicious Network File System version 4 (NFSv4) server could return a
  crafted reply to a GETACL request, causing a denial of service on the
  client. (CVE-2011-4131, Moderate)

  * A local attacker could use a flaw in the Journaling Block Device (JBD) to
  crash the system by mounting a specially-crafted ext3 or ext4 disk.
  (CVE-2011-4132, Moderate)

  * A flaw in igmp_heard_query() could allow an attacker, who is able to send
  certain IGMP (Internet Group Management Protocol) packets to a target
  system, to cause a denial of service. (CVE-2012-0207, Moderate)

  * If lock contention during signal sending occurred when in a software
  interrupt handler that is using the per-CPU debug stack, the task could be
  scheduled out on the realtime kernel, possibly leading to debug stack
  corruption. A local, unprivileged user could use this flaw to cause a
  denial of service. (CVE-2012-0810, Moderate)

  Red Hat would like to thank Chen Haogang for reporting CVE-2012-0044;
  Wang Xi for reporting CVE-2012-0038; Shubham Goyal for reporting
  CVE-2011-4097; Andy Adamson for reporting CVE-2011-4131; and Simon McVittie
  for reporting CVE-2012-0207.

  Bug fixes:

  * When a sleeping task, waiting on a futex (fast userspace mutex), tried to
  get the spin_lock(hb->lock) RT-mutex, if the owner of the futex released
  the lock, the sleeping task was put on a futex proxy lock. Consequently,
  the sleeping task was blocked on two locks and eventually terminated in the
  BUG_ON() function. With this update, the WAKEUP_INPROGRESS pseudo-lock has
  been added to be used as a proxy lock. This pseudo-lock tells the sleeping
  task that it is being woken up so that the task no longer tries to get the
  second lock. Now, the futex code works as expected and sleeping tasks no
  longer crash in the described scenario. (BZ#784733)

  * When the CONFIG_CRYPTO_FIPS configuration option was disabled, some
  services such as sshd and ipsec, while working properly, returned warning
  messages regarding this missing option during start up. With this update,
  CONFIG_CRYPTO_FIPS has been enabled and no warning messages are now
  returned in the described scenario. (BZ#786145)

  * Previously, when a read operation on a loop device failed, the data
  successfully read from the device was not cleared and could eventually
  leak. This bug has been fixed and all data are now properly cleared in the
  described scenario. (BZ#761420)

  * Due to an assembler-sourced object, the perf utility (from the perf-rt
  package) for AMD64 and Intel 64 architectures contained an executable
  stack. This update adds the ".note.GNU-stack" section definition to the
  bench/mem-memcpy-x86-64-asm.S component of perf, with all flags disabled,
  and perf no longer contains an executable stack, thus fixing this bug.
  (BZ#783570)
impacted_packages:
  - purl: pkg:rpm/redhat/kernel-rt-firmware?arch=noarch
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-doc?arch=noarch
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-trace-devel?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-vanilla-devel?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-vanilla?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-debug?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-vanilla-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-debug-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-devel?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-trace-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-debug-devel?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-debuginfo-common-x86_64?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt-trace?arch=x86_64
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-rt?arch=src
    affected_versions: vers:rpm/<3.0.18-rt34.53.el6rt
    fixed_versions: vers:rpm/3.0.18-rt34.53.el6rt
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0333.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=730706
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=747106
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=749156
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=750399
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=751297
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=752375
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=753341
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=772894
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0333.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=772867
    reference_type: bug
    reference_id: 772867
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=773280
    reference_type: bug
    reference_id: 773280
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=784733
    reference_type: bug
    reference_id: 784733
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=786145
    reference_type: bug
    reference_id: 786145
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=794557
    reference_type: bug
    reference_id: 794557
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/linux/dos/17769.c
    reference_type: exploit
    reference_id: CVE-2011-2918
  - url: https://access.redhat.com/errata/RHSA-2012:0333
    reference_type:
    reference_id: RHSA-2012:0333
