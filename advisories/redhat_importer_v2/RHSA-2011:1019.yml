advisory_id: RHSA-2011:1019
datasource_id: redhat_importer_v2/RHSA-2011:1019
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_1019.json
aliases:
  - CVE-2011-2511
summary: |
  Updated libvirt packages that fix one security issue, several bugs and add
  various enhancements are now available for Red Hat Enterprise Linux 5.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. A Common Vulnerability Scoring System (CVSS) base score,
  which gives a detailed severity rating, is available from the CVE link in
  the References section.

  The libvirt library is a C API for managing and interacting with the
  virtualization capabilities of Linux and other operating systems.

  An integer overflow flaw was found in libvirtd's RPC call handling. An
  attacker able to establish read-only connections to libvirtd could trigger
  this flaw by calling virDomainGetVcpus() with specially-crafted parameters,
  causing libvirtd to crash. (CVE-2011-2511)

  This update fixes the following bugs:

  * libvirt was rebased from version 0.6.3 to version 0.8.2 in Red Hat
  Enterprise Linux 5.6. A code audit found a minor API change that effected
  error messages seen by libvirt 0.8.2 clients talking to libvirt 0.7.1 â€“
  0.7.7 (0.7.x) servers. A libvirt 0.7.x server could send
  VIR_ERR_BUILD_FIREWALL errors where a libvirt 0.8.2 client expected
  VIR_ERR_CONFIG_UNSUPPORTED errors. In other circumstances, a libvirt 0.8.2
  client saw a "Timed out during operation" message where it should see an
  "Invalid network filter" error. This update adds a backported patch that
  allows libvirt 0.8.2 clients to interoperate with the API as used by
  libvirt 0.7.x servers, ensuring correct error messages are sent.
  (BZ#665075)

  * libvirt could crash if the maximum number of open file descriptors
  (_SC_OPEN_MAX) grew larger than the FD_SETSIZE value because it accessed
  file descriptors outside the bounds of the set. With this update the
  maximum number of open file descriptors can no longer grow larger than the
  FD_SETSIZE value. (BZ#665549)

  * A libvirt race condition was found. An array in the libvirt event
  handlers was accessed with a lock temporarily released. In rare cases, if
  one thread attempted to access this array but a second thread reallocated
  the array before the first thread reacquired a lock, it could lead to the
  first thread attempting to access freed memory, potentially causing libvirt
  to crash. With this update libvirt no longer refers to the old array and,
  consequently, behaves as expected. (BZ#671569)

  * Guests connected to a passthrough NIC would kernel panic if a
  system_reset signal was sent through the QEMU monitor. With this update you
  can reset such guests as expected. (BZ#689880)

  * When using the Xen kernel, the rpmbuild command failed on the xencapstest
  test. With this update you can run rpmbuild successfully when using the Xen
  kernel. (BZ#690459)

  * When a disk was hot unplugged, "ret >= 0" was passed to the qemuAuditDisk
  calls in disk hotunplug operations before ret was, in fact, set to 0. As
  well, the error path jumped to the "cleanup" label prematurely. As a
  consequence, hotunplug failures were not audited and hotunplug successes
  were audited as failures. This was corrected and hot unplugging checks now
  behave as expected. (BZ#710151)

  * A conflict existed between filter update locking sequences and virtual
  machine startup locking sequences. When a filter update occurred on one or
  more virtual machines, a deadlock could consequently occur if a virtual
  machine referencing a filter was started. This update changes and makes
  more flexible several qemu locking sequences ensuring this deadlock no
  longer occurs. (BZ#697749)

  * qemudDomainSaveImageStartVM closed some incoming file descriptor (fd)
  arguments without informing the caller. The consequent double-closes could
  cause Domain restoration failure. This update alters the
  qemudDomainSaveImageStartVM signature to prevent the double-closes.
  (BZ#681623)

  This update also adds the following enhancements:

  * The libvirt Xen driver now supports more than one serial port.
  (BZ#670789)

  * Enabling and disabling the High Precision Event Timer (HPET) in Xen
  domains is now possible. (BZ#703193)

  All libvirt users should install this update which addresses this
  vulnerability, fixes these bugs and adds these enhancements. After
  installing the updated packages, libvirtd must be restarted ("service
  libvirtd restart") for this update to take effect.
impacted_packages:
  - purl: pkg:rpm/redhat/libvirt?arch=ia64
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-debuginfo?arch=ia64
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-python?arch=ia64
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-devel?arch=ia64
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt?arch=src
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt?arch=x86_64
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-python?arch=x86_64
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-devel?arch=x86_64
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt?arch=i386
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-debuginfo?arch=i386
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-devel?arch=i386
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-python?arch=i386
    affected_versions: vers:rpm/<0.8.2-22.el5
    fixed_versions: vers:rpm/0.8.2-22.el5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_1019.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_1019.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=665075
    reference_type: bug
    reference_id: 665075
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=665549
    reference_type: bug
    reference_id: 665549
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=671569
    reference_type: bug
    reference_id: 671569
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=681623
    reference_type: bug
    reference_id: 681623
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=689880
    reference_type: bug
    reference_id: 689880
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=690459
    reference_type: bug
    reference_id: 690459
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=697749
    reference_type: bug
    reference_id: 697749
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=703193
    reference_type: bug
    reference_id: 703193
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=710151
    reference_type: bug
    reference_id: 710151
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=717199
    reference_type: bug
    reference_id: 717199
  - url: https://access.redhat.com/errata/RHSA-2011:1019
    reference_type:
    reference_id: RHSA-2011:1019
