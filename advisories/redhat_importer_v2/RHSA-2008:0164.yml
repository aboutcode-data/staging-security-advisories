advisory_id: RHSA-2008:0164
datasource_id: redhat_importer_v2/RHSA-2008:0164
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2008/rhsa-2008_0164.json
aliases:
  - CVE-2007-5901
  - CVE-2007-5971
  - CVE-2008-0062
  - CVE-2008-0063
  - CVE-2008-0947
summary: |
  Updated krb5 packages that resolve several issues and fix multiple bugs are
  now available for Red Hat Enterprise Linux 5.

  This update has been rated as having critical security impact by the Red
  Hat Security Response Team.

  Kerberos is a network authentication system which allows clients and
  servers to authenticate to each other through use of symmetric encryption
  and a trusted third party, the KDC.

  A flaw was found in the way the MIT Kerberos Authentication Service and Key
  Distribution Center server (krb5kdc) handled Kerberos v4 protocol packets.
  An unauthenticated remote attacker could use this flaw to crash the
  krb5kdc daemon, disclose portions of its memory, or possibly execute
  arbitrary code using malformed or truncated Kerberos v4 protocol requests.
  (CVE-2008-0062, CVE-2008-0063)

  This issue only affected krb5kdc with Kerberos v4 protocol compatibility
  enabled, which is the default setting on Red Hat Enterprise Linux 4.
  Kerberos v4 protocol support can be disabled by adding "v4_mode=none"
  (without the quotes) to the "[kdcdefaults]" section of
  /var/kerberos/krb5kdc/kdc.conf.

  Jeff Altman of Secure Endpoints discovered a flaw in the RPC library as
  used by MIT Kerberos kadmind server. An unauthenticated remote attacker
  could use this flaw to crash kadmind or possibly execute arbitrary code.
  This issue only affected systems with certain resource limits configured
  and did not affect systems using default resource limits used by Red Hat
  Enterprise Linux 5. (CVE-2008-0947)

  Red Hat would like to thank MIT for reporting these issues.

  Multiple memory management flaws were discovered in the GSSAPI library used
  by MIT Kerberos. These flaws could possibly result in use of already freed
  memory or an attempt to free already freed memory blocks (double-free
  flaw), possibly causing a crash or arbitrary code execution.
  (CVE-2007-5901, CVE-2007-5971)

  In addition to the security issues resolved above, the following bugs were
  also fixed:

  * delegated krb5 credentials were not properly stored when SPNEGO was the
  underlying mechanism during GSSAPI authentication. Consequently,
  applications attempting to copy delegated Kerberos 5 credentials into a
  credential cache received an "Invalid credential was supplied" message
  rather than a copy of the delegated credentials. With this update, SPNEGO
  credentials can be properly searched, allowing applications to copy
  delegated credentials as expected.

  * applications can initiate context acceptance (via gss_accept_sec_context)
  without passing a ret_flags value that would indicate that credentials were
  delegated. A delegated credential handle should have been returned in such
  instances. This updated package adds a temp_ret_flag that stores the
  credential status in the event no other ret_flags value is passed by an
  application calling gss_accept_sec_context.

  * kpasswd did not fallback to TCP on receipt of certain errors, or when a
  packet was too big for UDP. This update corrects this.

  * when the libkrb5 password-routine generated a set-password or
  change-password request, incorrect sequence numbers were generated for all
  requests subsequent to the first request. This caused password change
  requests to fail if the primary server was unavailable. This updated
  package corrects this by saving the sequence number value after the AP-REQ
  data is built and restoring this value before the request is generated.

  * when a user's password expired, kinit would not prompt that user to
  change the password, instead simply informing the user their password had
  expired. This update corrects this behavior: kinit now prompts for a new
  password to be set when a password has expired.

  All krb5 users are advised to upgrade to these updated packages, which
  contain backported fixes to address these vulnerabilities and fix these
  bugs.
impacted_packages:
  - purl: pkg:rpm/redhat/krb5-devel?arch=ppc
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-workstation?arch=ppc
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-libs?arch=s390x
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-debuginfo?arch=s390x
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-server?arch=s390x
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-devel?arch=s390x
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5?arch=src
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-server?arch=x86_64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-devel?arch=x86_64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-libs?arch=x86_64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-workstation?arch=x86_64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-debuginfo?arch=i386
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-devel?arch=i386
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-server?arch=i386
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-libs?arch=i386
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-workstation?arch=i386
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-libs?arch=ia64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-debuginfo?arch=ia64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-server?arch=ia64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-devel?arch=ia64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-workstation?arch=ia64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-libs?arch=ppc64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-devel?arch=ppc64
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-libs?arch=ppc
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-debuginfo?arch=ppc
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-server?arch=ppc
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-workstation?arch=s390x
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-libs?arch=s390
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-debuginfo?arch=s390
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/krb5-devel?arch=s390
    affected_versions: vers:rpm/<1.6.1-17.el5_1.1
    fixed_versions: vers:rpm/1.6.1-17.el5_1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Critical
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2008/rhsa-2008_0164.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#critical
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2008/rhsa-2008_0164.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=415321
    reference_type: bug
    reference_id: 415321
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=415351
    reference_type: bug
    reference_id: 415351
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=432620
    reference_type: bug
    reference_id: 432620
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=432621
    reference_type: bug
    reference_id: 432621
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=433596
    reference_type: bug
    reference_id: 433596
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=436460
    reference_type: bug
    reference_id: 436460
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=436465
    reference_type: bug
    reference_id: 436465
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=436467
    reference_type: bug
    reference_id: 436467
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=436468
    reference_type: bug
    reference_id: 436468
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=436470
    reference_type: bug
    reference_id: 436470
  - url: https://access.redhat.com/errata/RHSA-2008:0164
    reference_type:
    reference_id: RHSA-2008:0164
