advisory_id: RHBA-2012:0013
datasource_id: redhat_importer_v2/RHBA-2012:0013
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhba-2012_0013.json
aliases:
  - CVE-2011-4600
summary: |
  Updated libvirt packages that fix multiple bugs and add two enhancements are now available for Red Hat Enterprise Linux 6.

  The libvirt library is a C API for managing and interacting with the virtualization capabilities of Linux and other operating systems.

  These updated libvirt packages include multiple bug fixes and enhancements. The most significant changes are as follow:

  * This update forces all libvirt managed KVM guests with virtio drives to run with the "scsi=off" option. This will prevent SCSI requests in guests being passed to underlying block devices on the host; however, a separate bug is preventing "scsi=off" from working correctly. A malicious, privileged guest user could issue a crafted request that would still be passed to the underlying block device.

  A future qemu-kvm update will correct the "scsi=off" functionality, blocking such crafted requests, and allowing CVE-2011-4127 to be mitigated before the kernel update is applied.

  As "scsi=off" may break legitimate pass through of SCSI requests, this update also adds a new value for the device attribute in the disk XML element, "lun". This type is like the default "disk" device, but will allow SCSI requests from guests to be passed to the underlying block device on the host.  (Using the "lun" device attribute causes the guest to run with "scsi=on".)

  Note: After installing the RHSA-2011:1849 kernel update, it will not be possible for guests to issue SCSI requests on virtio drives backed by partitions or LVM volumes, even if "device='lun'" is used. It will only be possible to issue SCSI requests on virtio drives backed by whole disks.

  Refer to Red Hat Knowledgebase for details about CVE-2011-4127 (BZ#768469):

  https://access.redhat.com/kb/docs/DOC-67874

  * This update adds support for VMware vSphere Hypervisor (ESXi) 5 installations. (BZ#759061)

  * The libvirt package was missing a dependency on the avahi package. The dependency is required due to mDNS support which is turned on by default. As a consequence, the libvirtd daemon failed to start if the libvirt package was installed on the system without Avahi. With this update, the dependency on avahi is now defined in the libvirt.spec file, and Avahi is installed along with libvirt. (BZ#770957)

  Space precludes documenting all of these changes in this advisory. Users are directed to the Red Hat Enterprise Linux 6.2 Technical Notes for information on these changes:

  https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/6.2_Technical_Notes/libvirt.html#RHBA-2012-0013

  All users of libvirt are advised to upgrade to these updated packages, which fix these bugs and add these enhancements.
impacted_packages:
  - purl: pkg:rpm/redhat/libvirt-python?arch=s390x
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-devel?arch=s390x
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt?arch=s390x
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-debuginfo?arch=s390x
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-client?arch=s390x
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-devel?arch=s390
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-debuginfo?arch=s390
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-client?arch=s390
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-python?arch=i686
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-devel?arch=i686
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt?arch=i686
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-debuginfo?arch=i686
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-client?arch=i686
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-lock-sanlock?arch=i686
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-python?arch=x86_64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-devel?arch=x86_64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt?arch=x86_64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-client?arch=x86_64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-lock-sanlock?arch=x86_64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-python?arch=ppc64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-devel?arch=ppc64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt?arch=ppc64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-client?arch=ppc64
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-devel?arch=ppc
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-debuginfo?arch=ppc
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt-client?arch=ppc
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/libvirt?arch=src
    affected_versions: vers:rpm/<0.9.4-23.el6_2.4
    fixed_versions: vers:rpm/0.9.4-23.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Low
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhba-2012_0013.json
weaknesses: []
references:
  - url: https://access.redhat.com/kb/docs/DOC-67874
    reference_type:
    reference_id:
  - url: https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/6.2_Technical_Notes/libvirt.html#RHBA-2012-0013
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhba-2012_0013.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=759061
    reference_type: bug
    reference_id: 759061
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=769674
    reference_type: bug
    reference_id: 769674
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=770957
    reference_type: bug
    reference_id: 770957
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=770959
    reference_type: bug
    reference_id: 770959
  - url: https://www.redhat.com/security/data/cve/CVE-2011-4127.html
    reference_type:
    reference_id: CVE-2011-4127.HTML
  - url: https://access.redhat.com/errata/RHBA-2012:0013
    reference_type:
    reference_id: RHBA-2012:0013
  - url: https://rhn.redhat.com/errata/RHSA-2011-1849.html
    reference_type:
    reference_id: RHSA-2011-1849.html
