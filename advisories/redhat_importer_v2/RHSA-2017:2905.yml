advisory_id: RHSA-2017:2905
datasource_id: redhat_importer_v2/RHSA-2017:2905
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2017/rhsa-2017_2905.json
aliases:
  - CVE-2014-9970
  - CVE-2017-12158
  - CVE-2017-12159
  - CVE-2017-12160
  - CVE-2017-12197
summary: |
  An update for rh-sso7-keycloak is now available for Red Hat Single Sign-On 7.1 for RHEL 7.

  Red Hat Product Security has rated this update as having a security impact of Moderate. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

  Red Hat Single Sign-On is a standalone server, based on the Keycloak project, that provides authentication and standards-based single sign-on capabilities for web and mobile applications.

  This release of Red Hat Single Sign-On 7.1.3 serves as a replacement for Red Hat Single Sign-On 7.1.2, and includes several bug fixes and enhancements. For further information, refer to the Release Notes linked to in the References section.

  Security Fix(es):

  * It was found that keycloak would accept a HOST header URL in the admin console and use it to determine web resource locations. An attacker could use this flaw against an authenticated user to attain reflected XSS via a malicious server. (CVE-2017-12158)

  * It was found that the cookie used for CSRF prevention in Keycloak was not unique to each session. An attacker could use this flaw to gain access to an authenticated user session, leading to possible information disclosure or further attacks. (CVE-2017-12159)

  * It was found that libpam4j did not properly validate user accounts when authenticating. A user with a valid password for a disabled account would be able to bypass security restrictions and possibly access sensitive information. (CVE-2017-12197)

  * It was found that Keycloak oauth would permit an authenticated resource to obtain an access/refresh token pair from the authentication server, permitting indefinite usage in the case of permission revocation. An attacker on an already compromised resource could use this flaw to grant himself continued permissions and possibly conduct further attacks. (CVE-2017-12160)

  Red Hat would like to thank Mykhailo Stadnyk (Playtech) for reporting CVE-2017-12158; Prapti Mittal for reporting CVE-2017-12159; and Bart Toersche (Simacan) for reporting CVE-2017-12160. The CVE-2017-12197 issue was discovered by Christian Heimes (Red Hat).
impacted_packages:
  - purl: pkg:rpm/redhat/rh-sso7-keycloak-server?arch=noarch
    affected_versions: vers:rpm/<2.5.14-1.Final_redhat_1.1.jbcs.el7
    fixed_versions: vers:rpm/2.5.14-1.Final_redhat_1.1.jbcs.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-sso7-keycloak?arch=noarch
    affected_versions: vers:rpm/<2.5.14-1.Final_redhat_1.1.jbcs.el7
    fixed_versions: vers:rpm/2.5.14-1.Final_redhat_1.1.jbcs.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rh-sso7-keycloak?arch=src
    affected_versions: vers:rpm/<2.5.14-1.Final_redhat_1.1.jbcs.el7
    fixed_versions: vers:rpm/2.5.14-1.Final_redhat_1.1.jbcs.el7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2017/rhsa-2017_2905.json
weaknesses: []
references:
  - url: https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.1/html/release_notes/
    reference_type:
    reference_id:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://issues.redhat.com/browse/RHSSO-1122
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2017/rhsa-2017_2905.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1484111
    reference_type: bug
    reference_id: 1484111
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1484154
    reference_type: bug
    reference_id: 1484154
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1489161
    reference_type: bug
    reference_id: 1489161
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1503103
    reference_type: bug
    reference_id: 1503103
  - url: https://access.redhat.com/errata/RHSA-2017:2905
    reference_type:
    reference_id: RHSA-2017:2905
