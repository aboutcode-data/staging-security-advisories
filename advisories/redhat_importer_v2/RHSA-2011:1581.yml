advisory_id: RHSA-2011:1581
datasource_id: redhat_importer_v2/RHSA-2011:1581
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_1581.json
aliases:
  - CVE-2011-2705
  - CVE-2011-3009
summary: |
  Updated ruby packages that fix two security issues, various bugs, and add
  one enhancement are now available for Red Hat Enterprise Linux 6.

  The Red Hat Security Response Team has rated this update as having low
  security impact. Common Vulnerability Scoring System (CVSS) base scores,
  which give detailed severity ratings, are available for each vulnerability
  from the CVE links in the References section.

  Ruby is an extensible, interpreted, object-oriented, scripting language. It
  has features to process text files and to do system management tasks.

  It was found that Ruby did not reinitialize the PRNG (pseudorandom number
  generator) after forking a child process. This could eventually lead to the
  PRNG returning the same result twice. An attacker keeping track of the
  values returned by one child process could use this flaw to predict the
  values the PRNG would return in other child processes (as long as the
  parent process persisted). (CVE-2011-3009)

  A flaw was found in the Ruby SecureRandom module. When using the
  SecureRandom.random_bytes class, the PRNG state was not modified after
  forking a child process. This could eventually lead to
  SecureRandom.random_bytes returning the same string more than once. An
  attacker keeping track of the strings returned by one child process could
  use this flaw to predict the strings SecureRandom.random_bytes would return
  in other child processes (as long as the parent process persisted).
  (CVE-2011-2705)

  This update also fixes the following bugs:

  * The ruby package has been upgraded to upstream point release 1.8.7-p352,
  which provides a number of bug fixes over the previous version. (BZ#706332)

  * The MD5 message-digest algorithm is not a FIPS-approved algorithm.
  Consequently, when a Ruby script attempted to calculate an MD5 checksum in
  FIPS mode, the interpreter terminated unexpectedly. This bug has been fixed
  and an exception is now raised in the described scenario. (BZ#717709)

  * Due to inappropriately handled line continuations in the mkconfig.rb
  source file, an attempt to build the ruby package resulted in unexpected
  termination. An upstream patch has been applied to address this issue and
  the ruby package can now be built properly. (BZ#730287)

  * When the 32-bit ruby-libs library was installed on a 64-bit machine, the
  mkmf library failed to load various modules necessary for building
  Ruby-related packages. This bug has been fixed and mkmf now works properly
  in the described scenario. (BZ#674787)

  * Previously, the load paths for scripts and binary modules were duplicated
  on the i386 architecture. Consequently, an ActiveSupport test failed. With
  this update, the load paths are no longer stored in duplicates on the i386
  architecture. (BZ#722887)

  This update also adds the following enhancement:

  * With this update, SystemTap probes have been added to the ruby package.
  (BZ#673162)

  All users of ruby are advised to upgrade to these updated packages, which
  resolve these issues and add this enhancement.
impacted_packages:
  - purl: pkg:rpm/redhat/ruby-static?arch=i686
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-tcltk?arch=i686
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-devel?arch=i686
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-debuginfo?arch=i686
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-rdoc?arch=i686
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-docs?arch=i686
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-ri?arch=i686
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-libs?arch=i686
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby?arch=i686
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-irb?arch=i686
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-static?arch=ppc64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-tcltk?arch=ppc64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-devel?arch=ppc64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-rdoc?arch=ppc64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-docs?arch=ppc64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-ri?arch=ppc64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-libs?arch=ppc64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby?arch=ppc64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-irb?arch=ppc64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-devel?arch=ppc
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-debuginfo?arch=ppc
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-libs?arch=ppc
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-static?arch=s390x
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-tcltk?arch=s390x
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-devel?arch=s390x
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-debuginfo?arch=s390x
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-rdoc?arch=s390x
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-docs?arch=s390x
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-ri?arch=s390x
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-libs?arch=s390x
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby?arch=s390x
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-irb?arch=s390x
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-devel?arch=s390
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-debuginfo?arch=s390
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-libs?arch=s390
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-static?arch=x86_64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-tcltk?arch=x86_64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-devel?arch=x86_64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-rdoc?arch=x86_64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-docs?arch=x86_64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-ri?arch=x86_64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-libs?arch=x86_64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby?arch=x86_64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby-irb?arch=x86_64
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ruby?arch=src
    affected_versions: vers:rpm/<1.8.7.352-3.el6
    fixed_versions: vers:rpm/1.8.7.352-3.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Low
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_1581.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#low
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=722415
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_1581.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=673162
    reference_type: bug
    reference_id: 673162
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=674787
    reference_type: bug
    reference_id: 674787
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=706332
    reference_type: bug
    reference_id: 706332
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=717709
    reference_type: bug
    reference_id: 717709
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=722887
    reference_type: bug
    reference_id: 722887
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=730287
    reference_type: bug
    reference_id: 730287
  - url: https://access.redhat.com/errata/RHSA-2011:1581
    reference_type:
    reference_id: RHSA-2011:1581
