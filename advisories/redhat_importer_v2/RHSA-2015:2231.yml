advisory_id: RHSA-2015:2231
datasource_id: redhat_importer_v2/RHSA-2015:2231
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_2231.json
aliases:
  - CVE-2014-9297
  - CVE-2014-9298
  - CVE-2014-9750
  - CVE-2014-9751
  - CVE-2015-1798
  - CVE-2015-1799
  - CVE-2015-3405
summary: |
  Updated ntp packages that fix multiple security issues, several bugs, and
  add various enhancements are now available for Red Hat Enterprise Linux 7.

  Red Hat Product Security has rated this update as having Moderate security
  impact. Common Vulnerability Scoring System (CVSS) base scores, which give
  detailed severity ratings, are available for each vulnerability from the
  CVE links in the References section.

  The Network Time Protocol (NTP) is used to synchronize a computer's time
  with another referenced time source. These packages include the ntpd
  service which continuously adjusts system time and utilities used to query
  and configure the ntpd service.

  It was found that because NTP's access control was based on a source IP
  address, an attacker could bypass source IP restrictions and send
  malicious control and configuration packets by spoofing ::1 addresses.
  (CVE-2014-9298, CVE-2014-9751)

  A denial of service flaw was found in the way NTP hosts that were peering
  with each other authenticated themselves before updating their internal
  state variables. An attacker could send packets to one peer host, which
  could cascade to other peers, and stop the synchronization process among
  the reached peers. (CVE-2015-1799)

  A flaw was found in the way the ntp-keygen utility generated MD5 symmetric
  keys on big-endian systems. An attacker could possibly use this flaw to
  guess generated MD5 keys, which could then be used to spoof an NTP client
  or server. (CVE-2015-3405)

  A stack-based buffer overflow was found in the way the NTP autokey protocol
  was implemented. When an NTP client decrypted a secret received from an NTP
  server, it could cause that client to crash. (CVE-2014-9297, CVE-2014-9750)

  It was found that ntpd did not check whether a Message Authentication Code
  (MAC) was present in a received packet when ntpd was configured to use
  symmetric cryptographic keys. A man-in-the-middle attacker could use this
  flaw to send crafted packets that would be accepted by a client or a peer
  without the attacker knowing the symmetric key. (CVE-2015-1798)

  The CVE-2015-1798 and CVE-2015-1799 issues were discovered by Miroslav
  Lichv√°r of Red Hat.

  Bug fixes:

  * The ntpd service truncated symmetric keys specified in the key file to 20
  bytes. As a consequence, it was impossible to configure NTP authentication
  to work with peers that use longer keys. With this update, the maximum key
  length has been changed to 32 bytes. (BZ#1191111)

  * The ntpd service could previously join multicast groups only when
  starting, which caused problems if ntpd was started during system boot
  before network was configured. With this update, ntpd attempts to join
  multicast groups every time network configuration is changed. (BZ#1207014)

  * Previously, the ntp-keygen utility used the exponent of 3 when generating
  RSA keys. Consequently, generating RSA keys failed when FIPS mode was
  enabled. With this update, ntp-keygen has been modified to use the exponent
  of 65537, and generating keys in FIPS mode now works as expected.
  (BZ#1191116)

  * The ntpd service dropped incoming NTP packets if their source port was
  lower than 123 (the NTP port). With this update, ntpd no longer checks the
  source port number, and clients behind NAT are now able to correctly
  synchronize with the server. (BZ#1171640)

  Enhancements:

  * This update adds support for configurable Differentiated Services Code
  Points (DSCP) in NTP packets, simplifying configuration in large networks
  where different NTP implementations or versions are using different DSCP
  values. (BZ#1202828)

  * This update adds the ability to configure separate clock stepping
  thresholds for each direction (backward and forward). Use the "stepback"
  and "stepfwd" options to configure each threshold. (BZ#1193154)

  * Support for nanosecond resolution has been added to the Structural
  Health Monitoring (SHM) reference clock. Prior to this update, when a
  Precision Time Protocol (PTP) hardware clock was used as a time source to
  synchronize the system clock, the accuracy of the synchronization was
  limited due to the microsecond resolution of the SHM protocol. The
  nanosecond extension in the SHM protocol now allows sub-microsecond
  synchronization of the system clock. (BZ#1117702)

  All ntp users are advised to upgrade to these updated packages, which
  contain backported patches to correct these issues and add these
  enhancements.
impacted_packages:
  - purl: pkg:rpm/redhat/ntp-perl?arch=noarch
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-doc?arch=noarch
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/sntp?arch=x86_64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntpdate?arch=x86_64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=x86_64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=src
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntpdate?arch=ppc64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=ppc64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/sntp?arch=ppc64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=aarch64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-debuginfo?arch=aarch64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntpdate?arch=aarch64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/sntp?arch=aarch64
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=s390x
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-debuginfo?arch=s390x
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntpdate?arch=s390x
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/sntp?arch=s390x
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntpdate?arch=ppc64le
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp?arch=ppc64le
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/ntp-debuginfo?arch=ppc64le
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/sntp?arch=ppc64le
    affected_versions: vers:rpm/<4.2.6p5-22.el7
    fixed_versions: vers:rpm/4.2.6p5-22.el7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_2231.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1184572
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1184573
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1210324
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_2231.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1117702
    reference_type: bug
    reference_id: 1117702
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1122012
    reference_type: bug
    reference_id: 1122012
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1171640
    reference_type: bug
    reference_id: 1171640
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1180721
    reference_type: bug
    reference_id: 1180721
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1191108
    reference_type: bug
    reference_id: 1191108
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1191122
    reference_type: bug
    reference_id: 1191122
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1193154
    reference_type: bug
    reference_id: 1193154
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1199430
    reference_type: bug
    reference_id: 1199430
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1199435
    reference_type: bug
    reference_id: 1199435
  - url: https://access.redhat.com/errata/RHSA-2015:2231
    reference_type:
    reference_id: RHSA-2015:2231
