advisory_id: RHSA-2004:304
datasource_id: redhat_importer_v2/RHSA-2004:304
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2004/rhsa-2004_304.json
aliases:
  - CVE-2003-0388
summary: |
  Updated pam packages that fix a security vulnerability are now available
  for Red Hat Enterprise Linux 2.1.

  PAM (Pluggable Authentication Modules) is a system security tool that
  allows system administrators to set an authentication policy without
  having to recompile programs that handle authentication.

  These updates fix a potential security problem present in the
  pam_wheel module.  These updates correct a bug in the pam_lastlog
  module which prevented it from properly manipulating the /var/log/lastlog
  entry for users with very high user IDs.

  The pam_wheel module is used to restrict access to a particular service
  based on group membership.  If the pam_wheel module was used with the
  "trust" option enabled, but without the "use_uid" option, any local
  user would be able to spoof the username returned by getlogin(). The user
  could therefore gain access to a superuser account without supplying a
  password.  In Red Hat Enterprise Linux 2.1, pam_wheel is not used by
  default.  The Common Vulnerabilities and Exposures project (cve.mitre.org)
  has assigned the name CAN-2003-0388 to this issue.

  When manipulating the entry in /var/log/lastlog, which corresponds to a
  given user, the pam_lastlog module calculates the location of the entry by
  multiplying the UID and the length of an entry in the file.  On some
  systems, the result of this calculation would mistakenly be truncated to 32
  bits for users with sufficiently high UIDs.

  All users of pam should upgrade to these updated packages, which
  resolve these issues.
impacted_packages: []
severities:
  - score: Low
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2004/rhsa-2004_304.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#low
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2004/rhsa-2004_304.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=98826
    reference_type: bug
    reference_id: 98826
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/linux/local/22781.txt
    reference_type: exploit
    reference_id: CVE-2003-0388;OSVDB-9027
  - url: https://www.securityfocus.com/bid/7929/info
    reference_type: exploit
    reference_id: CVE-2003-0388;OSVDB-9027
  - url: https://access.redhat.com/errata/RHSA-2004:304
    reference_type:
    reference_id: RHSA-2004:304
