advisory_id: RHSA-2013:0277
datasource_id: redhat_importer_v2/RHSA-2013:0277
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0277.json
aliases:
  - CVE-2012-3411
summary: |
  Updated dnsmasq packages that fix one security issue, one bug, and add
  various enhancements are now available for Red Hat Enterprise Linux 6.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. A Common Vulnerability Scoring System (CVSS) base score,
  which gives a detailed severity rating, is available from the CVE link in
  the References section.

  The dnsmasq packages contain Dnsmasq, a lightweight DNS (Domain Name
  Server) forwarder and DHCP (Dynamic Host Configuration Protocol) server.

  It was discovered that dnsmasq, when used in combination with certain
  libvirtd configurations, could incorrectly process network packets from
  network interfaces that were intended to be prohibited. A remote,
  unauthenticated attacker could exploit this flaw to cause a denial of
  service via DNS amplification attacks. (CVE-2012-3411)

  In order to fully address this issue, libvirt package users are advised to
  install updated libvirt packages. Refer to RHSA-2013:0276 for additional
  information.

  This update also fixes the following bug:

  * Due to a regression, the lease change script was disabled. Consequently,
  the "dhcp-script" option in the /etc/dnsmasq.conf configuration file did
  not work. This update corrects the problem and the "dhcp-script" option now
  works as expected. (BZ#815819)

  This update also adds the following enhancements:

  * Prior to this update, dnsmasq did not validate that the tftp directory
  given actually existed and was a directory. Consequently, configuration
  errors were not immediately reported on startup. This update improves the
  code to validate the tftp root directory option. As a result, fault finding
  is simplified especially when dnsmasq is called by external processes such
  as libvirt. (BZ#824214)

  * The dnsmasq init script used an incorrect Process Identifier (PID) in the
  "stop", "restart", and "condrestart" commands. Consequently, if there were
  some dnsmasq instances running besides the system one started by the init
  script, then repeated calling of "service dnsmasq" with "stop" or "restart"
  would kill all running dnsmasq instances, including ones not started with
  the init script. The dnsmasq init script code has been corrected to obtain
  the correct PID when calling the "stop", "restart", and "condrestart"
  commands. As a result, if there are dnsmasq instances running in addition
  to the system one started by the init script, then by calling "service
  dnsmasq" with "stop" or "restart" only the system one is stopped or
  restarted. (BZ#850944)

  * When two or more dnsmasq processes were running with DHCP enabled on one
  interface, DHCP RELEASE packets were sometimes lost. Consequently, when two
  or more dnsmasq processes were running with DHCP enabled on one interface,
  releasing IP addresses sometimes failed. This update sets the
  SO_BINDTODEVICE socket option on DHCP sockets if running dnsmasq with DHCP
  enabled on one interface. As a result, when two or more dnsmasq processes
  are running with DHCP enabled on one interface, they can release IP
  addresses as expected. (BZ#887156)

  All users of dnsmasq are advised to upgrade to these updated packages,
  which fix these issues and add these enhancements.
impacted_packages:
  - purl: pkg:rpm/redhat/dnsmasq?arch=x86_64
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq-utils?arch=x86_64
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq?arch=i686
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq-utils?arch=i686
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq?arch=src
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq?arch=ppc64
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq-utils?arch=ppc64
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq?arch=s390x
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/dnsmasq-utils?arch=s390x
    affected_versions: vers:rpm/<2.48-13.el6
    fixed_versions: vers:rpm/2.48-13.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0277.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0277.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=833033
    reference_type: bug
    reference_id: 833033
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=850944
    reference_type: bug
    reference_id: 850944
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=884957
    reference_type: bug
    reference_id: 884957
  - url: https://rhn.redhat.com/errata/RHSA-2013-0276.html
    reference_type:
    reference_id: RHSA-2013-0276.html
  - url: https://access.redhat.com/errata/RHSA-2013:0277
    reference_type:
    reference_id: RHSA-2013:0277
