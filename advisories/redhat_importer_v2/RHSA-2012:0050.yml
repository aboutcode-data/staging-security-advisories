advisory_id: RHSA-2012:0050
datasource_id: redhat_importer_v2/RHSA-2012:0050
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0050.json
aliases:
  - CVE-2012-0029
summary: |
  Updated qemu-kvm packages that fix one security issue, one bug, and add
  one enhancement are now available for Red Hat Enterprise Linux 6.

  The Red Hat Security Response Team has rated this update as having
  important security impact. A Common Vulnerability Scoring System (CVSS)
  base score, which gives a detailed severity rating, is available from the
  CVE link in the References section.

  KVM (Kernel-based Virtual Machine) is a full virtualization solution for
  Linux on AMD64 and Intel 64 systems. qemu-kvm is the user-space component
  for running virtual machines using KVM.

  A heap overflow flaw was found in the way QEMU-KVM emulated the e1000
  network interface card. A privileged guest user in a virtual machine whose
  network interface is configured to use the e1000 emulated driver could use
  this flaw to crash the host or, possibly, escalate their privileges on the
  host. (CVE-2012-0029)

  Red Hat would like to thank Nicolae Mogoreanu for reporting this issue.

  This update also fixes the following bug:

  * qemu-kvm has a "scsi" option, to be used, for example, with the
  "-device" option: "-device virtio-blk-pci,drive=[drive name],scsi=off".
  Previously, however, it only masked the feature bit, and did not reject
  SCSI commands if a malicious guest ignored the feature bit and issued a
  request. This update corrects this issue. The "scsi=off" option can be
  used to mitigate the virtualization aspect of CVE-2011-4127 before the
  RHSA-2011:1849 kernel update is installed on the host.

  This mitigation is only required if you do not have the RHSA-2011:1849
  kernel update installed on the host and you are using raw format virtio
  disks backed by a partition or LVM volume.

  If you run guests by invoking /usr/libexec/qemu-kvm directly, use the
  "-global virtio-blk-pci.scsi=off" option to apply the mitigation. If you
  are using libvirt, as recommended by Red Hat, and have the RHBA-2012:0013
  libvirt update installed, no manual action is required: guests will
  automatically use "scsi=off". (BZ#767721)

  Note: After installing the RHSA-2011:1849 kernel update, SCSI requests
  issued by guests via the SG_IO IOCTL will not be passed to the underlying
  block device when using raw format virtio disks backed by a partition or
  LVM volume, even if "scsi=on" is used.

  As well, this update adds the following enhancement:

  * Prior to this update, qemu-kvm was not built with RELRO or PIE support.
  qemu-kvm is now built with full RELRO and PIE support as a security
  enhancement. (BZ#767906)

  All users of qemu-kvm should upgrade to these updated packages, which
  correct these issues and add this enhancement. After installing this
  update, shut down all running virtual machines. Once all virtual machines
  have shut down, start them again for this update to take effect.
impacted_packages:
  - purl: pkg:rpm/redhat/qemu-kvm-tools?arch=x86_64&epoch=2
    affected_versions: vers:rpm/<0.12.1.2-2.209.el6_2.4
    fixed_versions: vers:rpm/0.12.1.2-2.209.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-img?arch=x86_64&epoch=2
    affected_versions: vers:rpm/<0.12.1.2-2.209.el6_2.4
    fixed_versions: vers:rpm/0.12.1.2-2.209.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm?arch=x86_64&epoch=2
    affected_versions: vers:rpm/<0.12.1.2-2.209.el6_2.4
    fixed_versions: vers:rpm/0.12.1.2-2.209.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm-debuginfo?arch=x86_64&epoch=2
    affected_versions: vers:rpm/<0.12.1.2-2.209.el6_2.4
    fixed_versions: vers:rpm/0.12.1.2-2.209.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/qemu-kvm?arch=src&epoch=2
    affected_versions: vers:rpm/<0.12.1.2-2.209.el6_2.4
    fixed_versions: vers:rpm/0.12.1.2-2.209.el6_2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0050.json
weaknesses: []
references:
  - url: https://access.redhat.com/kb/docs/DOC-67874
    reference_type:
    reference_id:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0050.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=772075
    reference_type: bug
    reference_id: 772075
  - url: https://rhn.redhat.com/errata/RHBA-2012-0013.html
    reference_type:
    reference_id: RHBA-2012-0013.html
  - url: https://rhn.redhat.com/errata/RHSA-2011-1849.html
    reference_type:
    reference_id: RHSA-2011-1849.html
  - url: https://access.redhat.com/errata/RHSA-2012:0050
    reference_type:
    reference_id: RHSA-2012:0050
