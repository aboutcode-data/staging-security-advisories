advisory_id: RHSA-2011:0791
datasource_id: redhat_importer_v2/RHSA-2011:0791
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_0791.json
aliases:
  - CVE-2010-3718
  - CVE-2010-4172
  - CVE-2011-0013
summary: |
  Updated tomcat6 packages that fix three security issues and several bugs
  are now available for Red Hat Enterprise Linux 6.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. Common Vulnerability Scoring System (CVSS) base scores,
  which give detailed severity ratings, are available for each vulnerability
  from the CVE links in the References section.

  Apache Tomcat is a servlet container for the Java Servlet and JavaServer
  Pages (JSP) technologies.

  It was found that web applications could modify the location of the Tomcat
  host's work directory. As web applications deployed on Tomcat have read and
  write access to this directory, a malicious web application could use this
  flaw to trick Tomcat into giving it read and write access to an arbitrary
  directory on the file system. (CVE-2010-3718)

  A cross-site scripting (XSS) flaw was found in the Manager application,
  used for managing web applications on Tomcat. If a remote attacker could
  trick a user who is logged into the Manager application into visiting a
  specially-crafted URL, the attacker could perform Manager application tasks
  with the privileges of the logged in user. (CVE-2010-4172)

  A second cross-site scripting (XSS) flaw was found in the Manager
  application. A malicious web application could use this flaw to conduct an
  XSS attack, leading to arbitrary web script execution with the privileges
  of victims who are logged into and viewing Manager application web pages.
  (CVE-2011-0013)

  This update also fixes the following bugs:

  * A bug in the "tomcat6" init script prevented additional Tomcat instances
  from starting. As well, running "service tomcat6 start" caused
  configuration options applied from "/etc/sysconfig/tomcat6" to be
  overwritten with those from "/etc/tomcat6/tomcat6.conf". With this update,
  multiple instances of Tomcat run as expected. (BZ#636997)

  * The "/usr/share/java/" directory was missing a symbolic link to the
  "/usr/share/tomcat6/bin/tomcat-juli.jar" library. Because this library was
  mandatory for certain operations (such as running the Jasper JSP
  precompiler), the "build-jar-repository" command was unable to compose a
  valid classpath. With this update, the missing symbolic link has been
  added. (BZ#661244)

  * Previously, the "tomcat6" init script failed to start Tomcat with a "This
  account is currently not available." message when Tomcat was configured to
  run under a user that did not have a valid shell configured as a login
  shell. This update modifies the init script to work correctly regardless of
  the daemon user's login shell. Additionally, these new tomcat6 packages now
  set "/sbin/nologin" as the login shell for the "tomcat" user upon
  installation, as recommended by deployment best practices. (BZ#678671)

  * Some standard Tomcat directories were missing write permissions for the
  "tomcat" group, which could cause certain applications to fail with errors
  such as "No output folder". This update adds write permissions for the
  "tomcat" group to the affected directories. (BZ#643809)

  * The "/usr/sbin/tomcat6" wrapper script used a hard-coded path to the
  "catalina.out" file, which may have caused problems (such as for logging
  init script output) if Tomcat was being run with a user other than "tomcat"
  and with CATALINA_BASE set to a directory other than the default.
  (BZ#695284, BZ#697504)

  * Stopping Tomcat could have resulted in traceback errors being logged to
  "catalina.out" when certain web applications were deployed. (BZ#698624)

  Users of Tomcat should upgrade to these updated packages, which contain
  backported patches to correct these issues. Tomcat must be restarted for
  this update to take effect.
impacted_packages:
  - purl: pkg:rpm/redhat/tomcat6-admin-webapps?arch=noarch
    affected_versions: vers:rpm/<6.0.24-33.el6
    fixed_versions: vers:rpm/6.0.24-33.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcat6-webapps?arch=noarch
    affected_versions: vers:rpm/<6.0.24-33.el6
    fixed_versions: vers:rpm/6.0.24-33.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcat6-javadoc?arch=noarch
    affected_versions: vers:rpm/<6.0.24-33.el6
    fixed_versions: vers:rpm/6.0.24-33.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcat6-docs-webapp?arch=noarch
    affected_versions: vers:rpm/<6.0.24-33.el6
    fixed_versions: vers:rpm/6.0.24-33.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcat6-servlet-2.5-api?arch=noarch
    affected_versions: vers:rpm/<6.0.24-33.el6
    fixed_versions: vers:rpm/6.0.24-33.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcat6-el-2.1-api?arch=noarch
    affected_versions: vers:rpm/<6.0.24-33.el6
    fixed_versions: vers:rpm/6.0.24-33.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcat6-lib?arch=noarch
    affected_versions: vers:rpm/<6.0.24-33.el6
    fixed_versions: vers:rpm/6.0.24-33.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcat6?arch=noarch
    affected_versions: vers:rpm/<6.0.24-33.el6
    fixed_versions: vers:rpm/6.0.24-33.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcat6-jsp-2.1-api?arch=noarch
    affected_versions: vers:rpm/<6.0.24-33.el6
    fixed_versions: vers:rpm/6.0.24-33.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/tomcat6?arch=src
    affected_versions: vers:rpm/<6.0.24-33.el6
    fixed_versions: vers:rpm/6.0.24-33.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_0791.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=656246
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=675786
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2011/rhsa-2011_0791.json
    reference_type:
    reference_id:
  - url: http://tomcat.apache.org/security-6.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=636997
    reference_type: bug
    reference_id: 636997
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=643809
    reference_type: bug
    reference_id: 643809
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=661244
    reference_type: bug
    reference_id: 661244
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=675792
    reference_type: bug
    reference_id: 675792
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=678671
    reference_type: bug
    reference_id: 678671
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=695284
    reference_type: bug
    reference_id: 695284
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=697504
    reference_type: bug
    reference_id: 697504
  - url: https://access.redhat.com/errata/RHSA-2011:0791
    reference_type:
    reference_id: RHSA-2011:0791
