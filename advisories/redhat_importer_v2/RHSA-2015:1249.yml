advisory_id: RHSA-2015:1249
datasource_id: redhat_importer_v2/RHSA-2015:1249
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_1249.json
aliases:
  - CVE-2013-5704
summary: |
  Updated httpd packages that fix one security issue, several bugs, and add
  one enhancement are now available for Red Hat Enterprise Linux 6.

  Red Hat Product Security has rated this update as having Low security
  impact. A Common Vulnerability Scoring System (CVSS) base score, which
  gives a detailed severity rating, is available from the CVE link in the
  References section.

  The httpd packages provide the Apache HTTP Server, a powerful, efficient,
  and extensible web server.

  A flaw was found in the way httpd handled HTTP Trailer headers when
  processing requests using chunked encoding. A malicious client could use
  Trailer headers to set additional HTTP headers after header processing was
  performed by other modules. This could, for example, lead to a bypass of
  header restrictions defined with mod_headers. (CVE-2013-5704)

  This update also fixes the following bugs:

  * The order of mod_proxy workers was not checked when httpd configuration
  was reloaded. When mod_proxy workers were removed, added, or their order
  was changed, their parameters and scores could become mixed. The order of
  mod_proxy workers has been made internally consistent during configuration
  reload. (BZ#1149906)

  * The local host certificate created during firstboot contained CA
  extensions, which caused the httpd service to return warning messages.
  This has been addressed by local host certificates being generated with the
  "-extensions v3_req" option. (BZ#906476)

  * The default mod_ssl configuration no longer enables support for SSL
  cipher suites using the single DES, IDEA, or SEED encryption algorithms.
  (BZ#1086771)

  * The apachectl script did not take into account the HTTPD_LANG variable
  set in the /etc/sysconfig/httpd file during graceful restarts.
  Consequently, httpd did not use a changed value of HTTPD_LANG when the
  daemon was restarted gracefully. The script has been fixed to handle the
  HTTPD_LANG variable correctly. (BZ#963146)

  * The mod_deflate module failed to check the original file size while
  extracting files larger than 4 GB, making it impossible to extract large
  files. Now, mod_deflate checks the original file size properly according to
  RFC1952, and it is able to decompress files larger than 4 GB. (BZ#1057695)

  * The httpd service did not check configuration before restart. When a
  configuration contained an error, an attempt to restart httpd gracefully
  failed. Now, httpd checks configuration before restart and if the
  configuration is in an inconsistent state, an error message is printed,
  httpd is not stopped and a restart is not performed. (BZ#1146194)

  * The SSL_CLIENT_VERIFY environment variable was incorrectly handled when
  the "SSLVerifyClient optional_no_ca" and "SSLSessionCache" options were
  used. When an SSL session was resumed, the SSL_CLIENT_VERIFY value was set
  to "SUCCESS" instead of the previously set "GENEROUS". SSL_CLIENT_VERIFY is
  now correctly set to GENEROUS in this scenario. (BZ#1149703)

  * The ab utility did not correctly handle situations when an SSL connection
  was closed after some data had already been read. As a consequence, ab did
  not work correctly with SSL servers and printed "SSL read failed" error
  messages. With this update, ab works as expected with HTTPS servers.
  (BZ#1045477)

  * When a client presented a revoked certificate, log entries were created
  only at the debug level. The log level of messages regarding a revoked
  certificate has been increased to INFO, and administrators are now properly
  informed of this situation. (BZ#1161328)

  In addition, this update adds the following enhancement:

  * A mod_proxy worker can now be set into drain mode (N) using the
  balancer-manager web interface or using the httpd configuration file.
  A worker in drain mode accepts only existing sticky sessions destined for
  itself and ignores all other requests. The worker waits until all clients
  currently connected to this worker complete their work before the worker is
  stopped. As a result, drain mode enables to perform maintenance on a worker
  without affecting clients. (BZ#767130)

  Users of httpd are advised to upgrade to these updated packages, which
  contain backported patches to correct these issues and add this
  enhancement. After installing the updated packages, the httpd service will
  be restarted automatically.
impacted_packages:
  - purl: pkg:rpm/redhat/httpd-devel?arch=i686
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-tools?arch=i686
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd?arch=i686
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/mod_ssl?arch=i686&epoch=1
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-devel?arch=x86_64
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-tools?arch=x86_64
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd?arch=x86_64
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/mod_ssl?arch=x86_64&epoch=1
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd?arch=src
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-manual?arch=noarch
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-devel?arch=s390x
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-tools?arch=s390x
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd?arch=s390x
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/mod_ssl?arch=s390x&epoch=1
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-devel?arch=s390
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-debuginfo?arch=s390
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-devel?arch=ppc
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-debuginfo?arch=ppc
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-devel?arch=ppc64
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-tools?arch=ppc64
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd?arch=ppc64
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/mod_ssl?arch=ppc64&epoch=1
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/httpd-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.2.15-45.el6
    fixed_versions: vers:rpm/2.2.15-45.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Low
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_1249.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#low
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2015/rhsa-2015_1249.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1045477
    reference_type: bug
    reference_id: 1045477
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1057695
    reference_type: bug
    reference_id: 1057695
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1069625
    reference_type: bug
    reference_id: 1069625
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1082903
    reference_type: bug
    reference_id: 1082903
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1125269
    reference_type: bug
    reference_id: 1125269
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1149703
    reference_type: bug
    reference_id: 1149703
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1149906
    reference_type: bug
    reference_id: 1149906
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1161328
    reference_type: bug
    reference_id: 1161328
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1162268
    reference_type: bug
    reference_id: 1162268
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=922844
    reference_type: bug
    reference_id: 922844
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=963146
    reference_type: bug
    reference_id: 963146
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=987590
    reference_type: bug
    reference_id: 987590
  - url: https://access.redhat.com/errata/RHSA-2015:1249
    reference_type:
    reference_id: RHSA-2015:1249
