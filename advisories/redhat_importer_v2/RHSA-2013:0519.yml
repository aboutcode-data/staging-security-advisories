advisory_id: RHSA-2013:0519
datasource_id: redhat_importer_v2/RHSA-2013:0519
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0519.json
aliases:
  - CVE-2012-5536
summary: |
  Updated openssh packages that fix one security issue, multiple bugs, and
  add various enhancements are now available for Red Hat Enterprise Linux 6.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. A Common Vulnerability Scoring System (CVSS) base score,
  which gives a detailed severity rating, is available from the CVE link in
  the References section.

  OpenSSH is OpenBSD's Secure Shell (SSH) protocol implementation. These
  packages include the core files necessary for the OpenSSH client and
  server.

  Due to the way the pam_ssh_agent_auth PAM module was built in Red Hat
  Enterprise Linux 6, the glibc's error() function was called rather than the
  intended error() function in pam_ssh_agent_auth to report errors. As these
  two functions expect different arguments, it was possible for an attacker
  to cause an application using pam_ssh_agent_auth to crash, disclose
  portions of its memory or, potentially, execute arbitrary code.
  (CVE-2012-5536)

  Note that the pam_ssh_agent_auth module is not used in Red Hat Enterprise
  Linux 6 by default.

  This update also fixes the following bugs:

  * All possible options for the new RequiredAuthentications directive were
  not documented in the sshd_config man page. This update improves the man
  page to document all the possible options. (BZ#821641)

  * When stopping one instance of the SSH daemon (sshd), the sshd init script
  (/etc/rc.d/init.d/sshd) stopped all sshd processes regardless of the PID of
  the processes. This update improves the init script so that it only kills
  processes with the relevant PID. As a result, the init script now works
  more reliably in a multi-instance environment. (BZ#826720)

  * Due to a regression, the ssh-copy-id command returned an exit status code
  of zero even if there was an error in copying the key to a remote host.
  With this update, a patch has been applied and ssh-copy-id now returns a
  non-zero exit code if there is an error in copying the SSH certificate to a
  remote host. (BZ#836650)

  * When SELinux was disabled on the system, no on-disk policy was installed,
  a user account was used for a connection, and no "~/.ssh" configuration was
  present in that user's home directory, the SSH client terminated
  unexpectedly with a segmentation fault when attempting to connect to
  another system. A patch has been provided to address this issue and the
  crashes no longer occur in the described scenario. (BZ#836655)

  * The "HOWTO" document /usr/share/doc/openssh-ldap-5.3p1/HOWTO.ldap-keys
  incorrectly documented the use of the AuthorizedKeysCommand directive.
  This update corrects the document. (BZ#857760)

  This update also adds the following enhancements:

  * When attempting to enable SSH for use with a Common Access Card (CAC),
  the ssh-agent utility read all the certificates in the card even though
  only the ID certificate was needed. Consequently, if a user entered their
  PIN incorrectly, then the CAC was locked, as a match for the PIN was
  attempted against all three certificates. With this update, ssh-add does
  not try the same PIN for every certificate if the PIN fails for the first
  one. As a result, the CAC will not be disabled if a user enters their PIN
  incorrectly. (BZ#782912)

  * This update adds a "netcat mode" to SSH. The "ssh -W host:port ..."
  command connects standard input and output (stdio) on a client to a single
  port on a server. As a result, SSH can be used to route connections via
  intermediate servers. (BZ#860809)

  * Due to a bug, arguments for the RequiredAuthentications2 directive were
  not stored in a Match block. Consequently, parsing of the config file was
  not in accordance with the man sshd_config documentation. This update fixes
  the bug and users can now use the required authentication feature to
  specify a list of authentication methods as expected according to the man
  page. (BZ#869903)

  All users of openssh are advised to upgrade to these updated packages,
  which fix these issues and add these enhancements. After installing this
  update, the OpenSSH server daemon (sshd) will be restarted automatically.
impacted_packages:
  - purl: pkg:rpm/redhat/openssh-askpass?arch=x86_64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-server?arch=x86_64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh?arch=x86_64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-clients?arch=x86_64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=x86_64
    affected_versions: vers:rpm/<0.9.3-84.1.el6
    fixed_versions: vers:rpm/0.9.3-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-ldap?arch=x86_64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-askpass?arch=i686
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-server?arch=i686
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh?arch=i686
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-clients?arch=i686
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=i686
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=i686
    affected_versions: vers:rpm/<0.9.3-84.1.el6
    fixed_versions: vers:rpm/0.9.3-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-ldap?arch=i686
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh?arch=src
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=ppc64
    affected_versions: vers:rpm/<0.9.3-84.1.el6
    fixed_versions: vers:rpm/0.9.3-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-ldap?arch=ppc64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-askpass?arch=ppc64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-server?arch=ppc64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh?arch=ppc64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-clients?arch=ppc64
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=ppc
    affected_versions: vers:rpm/<0.9.3-84.1.el6
    fixed_versions: vers:rpm/0.9.3-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=ppc
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=s390x
    affected_versions: vers:rpm/<0.9.3-84.1.el6
    fixed_versions: vers:rpm/0.9.3-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-ldap?arch=s390x
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=s390x
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-askpass?arch=s390x
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-server?arch=s390x
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh?arch=s390x
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-clients?arch=s390x
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/pam_ssh_agent_auth?arch=s390
    affected_versions: vers:rpm/<0.9.3-84.1.el6
    fixed_versions: vers:rpm/0.9.3-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/openssh-debuginfo?arch=s390
    affected_versions: vers:rpm/<5.3p1-84.1.el6
    fixed_versions: vers:rpm/5.3p1-84.1.el6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0519.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0519.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=821641
    reference_type: bug
    reference_id: 821641
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=826720
    reference_type: bug
    reference_id: 826720
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=834618
    reference_type: bug
    reference_id: 834618
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=836650
    reference_type: bug
    reference_id: 836650
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=857760
    reference_type: bug
    reference_id: 857760
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=869903
    reference_type: bug
    reference_id: 869903
  - url: https://access.redhat.com/errata/RHSA-2013:0519
    reference_type:
    reference_id: RHSA-2013:0519
