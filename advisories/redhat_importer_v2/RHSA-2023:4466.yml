advisory_id: RHSA-2023:4466
datasource_id: redhat_importer_v2/RHSA-2023:4466
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2023/rhsa-2023_4466.json
aliases:
  - CVE-2022-40899
  - CVE-2023-0118
summary: "Updated Satellite 6.13 packages that fixes important security bugs and several\nregular\
  \ bugs are now available for Red Hat Satellite.\n\nRed Hat Satellite is a system management\
  \ solution that allows organizations\nto configure and maintain their systems without the\
  \ necessity to provide\npublic Internet access to their servers or other client systems. It\n\
  performs provisioning and configuration management of predefined standard\noperating environments.\n\
  \nSecurity fix(es):\n\nforeman: Arbitrary code execution through templates. (CVE-2023-0118)\n\
  python-future: remote attackers can cause denial of service via crafted Set-Cookie header\
  \ from malicious web server (CVE-2022-40899)\n\nThis update fixes the following bugs:\n\n\
  2159659 - CVE-2023-0118 foreman: Arbitrary code execution through templates [rhn_satellite_6.13]\n\
  2211954 - nalfassi@redhat.com \tUnable to enable callback plugin per-template\n2218653 - Unable\
  \ to enable any repository in network sync\n2218659 - Can't rerun a failed content-import\
  \ task if it was exported using chunks\n2218660 - \"Host-Registered Content Hosts\" Report\
  \ gives error while generating - undefined method `nvra' for nil:NilClass\n2218661 - Yet another\
  \ deadlock during Capsule sync, now when existing content changed\n2218954 - satellite6-bugs@redhat.com\
  \ \t[Regression] VMware Image-based and full host boot disk based Provisioning fails with\
  \ error-: Could not find virtual machine network interface matching <IP>\n2218955 - CVE-2022-40899\
  \ python-future: remote attackers can cause denial of service via crafted Set-Cookie header\
  \ from malicious web server [rhn_satellite_6-default]\n2218979 - Custom repo sync failed \"\
  \ Cannot open /var/lib/pulp/tmp/89726@satellite.example.com/tmpzmdau7qg/tmpy_kkhu3a: Cannot\
  \ detect compression type\"\n2224023 - \"undefined method `event' for nil:NilClass\" in production.log\
  \ when trying to remediate insights issues from CRC. \n2218656 - satellite-maintain packages\
  \ check-update fails when there are no packages to be updated.\n2218657 - Should not be able\
  \ to assign LE on the client profile which is not synced on the capsule server \n\nUsers of\
  \ Red Hat Satellite are advised to upgrade to these updated\npackages, which fix these bugs."
impacted_packages:
  - purl: pkg:rpm/redhat/foreman?arch=src
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-fog-vsphere?arch=src
    affected_versions: vers:rpm/<3.6.2-1.el8sat
    fixed_versions: vers:rpm/3.6.2-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-foreman_ansible?arch=src
    affected_versions: vers:rpm/<10.4.3-1.el8sat
    fixed_versions: vers:rpm/10.4.3-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-hammer_cli_foreman_ansible?arch=src
    affected_versions: vers:rpm/<0.5.0-1.el8sat
    fixed_versions: vers:rpm/0.5.0-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-katello?arch=src
    affected_versions: vers:rpm/<4.7.0.31-1.el8sat
    fixed_versions: vers:rpm/4.7.0.31-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-safemode?arch=src
    affected_versions: vers:rpm/<1.3.8-1.el8sat
    fixed_versions: vers:rpm/1.3.8-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/satellite?arch=src
    affected_versions: vers:rpm/<6.13.3-1.el8sat
    fixed_versions: vers:rpm/6.13.3-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-foreman_maintain?arch=src&epoch=1
    affected_versions: vers:rpm/<1.2.11-1.el8sat
    fixed_versions: vers:rpm/1.2.11-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-pulp-rpm?arch=src
    affected_versions: vers:rpm/<3.18.17-1.el8pc
    fixed_versions: vers:rpm/3.18.17-1.el8pc
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-pulpcore?arch=src
    affected_versions: vers:rpm/<3.21.9-1.el8pc
    fixed_versions: vers:rpm/3.21.9-1.el8pc
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python-future?arch=src
    affected_versions: vers:rpm/<0.18.3-1.el8pc
    fixed_versions: vers:rpm/0.18.3-1.el8pc
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-debug?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-cli?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-dynflow-sidekiq?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-ec2?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-journald?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-libvirt?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-openstack?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-ovirt?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-postgresql?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-service?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-telemetry?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/foreman-vmware?arch=noarch
    affected_versions: vers:rpm/<3.5.1.19-1.el8sat
    fixed_versions: vers:rpm/3.5.1.19-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-fog-vsphere?arch=noarch
    affected_versions: vers:rpm/<3.6.2-1.el8sat
    fixed_versions: vers:rpm/3.6.2-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-foreman_ansible?arch=noarch
    affected_versions: vers:rpm/<10.4.3-1.el8sat
    fixed_versions: vers:rpm/10.4.3-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-hammer_cli_foreman_ansible?arch=noarch
    affected_versions: vers:rpm/<0.5.0-1.el8sat
    fixed_versions: vers:rpm/0.5.0-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-katello?arch=noarch
    affected_versions: vers:rpm/<4.7.0.31-1.el8sat
    fixed_versions: vers:rpm/4.7.0.31-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-safemode?arch=noarch
    affected_versions: vers:rpm/<1.3.8-1.el8sat
    fixed_versions: vers:rpm/1.3.8-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/satellite-capsule?arch=noarch
    affected_versions: vers:rpm/<6.13.3-1.el8sat
    fixed_versions: vers:rpm/6.13.3-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/satellite-common?arch=noarch
    affected_versions: vers:rpm/<6.13.3-1.el8sat
    fixed_versions: vers:rpm/6.13.3-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/satellite?arch=noarch
    affected_versions: vers:rpm/<6.13.3-1.el8sat
    fixed_versions: vers:rpm/6.13.3-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/satellite-cli?arch=noarch
    affected_versions: vers:rpm/<6.13.3-1.el8sat
    fixed_versions: vers:rpm/6.13.3-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rubygem-foreman_maintain?arch=noarch&epoch=1
    affected_versions: vers:rpm/<1.2.11-1.el8sat
    fixed_versions: vers:rpm/1.2.11-1.el8sat
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python39-pulp-rpm?arch=noarch
    affected_versions: vers:rpm/<3.18.17-1.el8pc
    fixed_versions: vers:rpm/3.18.17-1.el8pc
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python39-pulpcore?arch=noarch
    affected_versions: vers:rpm/<3.21.9-1.el8pc
    fixed_versions: vers:rpm/3.21.9-1.el8pc
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/python39-future?arch=noarch
    affected_versions: vers:rpm/<0.18.3-1.el8pc
    fixed_versions: vers:rpm/0.18.3-1.el8pc
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2023/rhsa-2023_4466.json
weaknesses: []
references:
  - url: https://access.redhat.com/documentation/en-us/red_hat_satellite/6.13/html/upgrading_and_updating_red_hat_satellite/index
    reference_type:
    reference_id:
  - url: https://access.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2023/rhsa-2023_4466.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2159291
    reference_type: bug
    reference_id: 2159291
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2165866
    reference_type: bug
    reference_id: 2165866
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2211954
    reference_type: bug
    reference_id: 2211954
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2218653
    reference_type: bug
    reference_id: 2218653
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2218656
    reference_type: bug
    reference_id: 2218656
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2218657
    reference_type: bug
    reference_id: 2218657
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2218659
    reference_type: bug
    reference_id: 2218659
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2218660
    reference_type: bug
    reference_id: 2218660
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2218661
    reference_type: bug
    reference_id: 2218661
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2218954
    reference_type: bug
    reference_id: 2218954
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2218979
    reference_type: bug
    reference_id: 2218979
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2224023
    reference_type: bug
    reference_id: 2224023
  - url: https://access.redhat.com/errata/RHSA-2023:4466
    reference_type:
    reference_id: RHSA-2023:4466
