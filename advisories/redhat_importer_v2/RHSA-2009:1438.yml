advisory_id: RHSA-2009:1438
datasource_id: redhat_importer_v2/RHSA-2009:1438
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2009/rhsa-2009_1438.json
aliases:
  - CVE-2009-1883
  - CVE-2009-1895
  - CVE-2009-2847
  - CVE-2009-2848
  - CVE-2009-3238
summary: |
  Updated kernel packages that fix several security issues and several bugs
  are now available for Red Hat Enterprise Linux 4.

  This update has been rated as having important security impact by the Red
  Hat Security Response Team.

  [Updated 21st July 2010]
  Added links to KBase articles expanding on three of the fixed bugs.

  The kernel packages contain the Linux kernel, the core of any Linux
  operating system.

  Security issues:

  * the ADDR_COMPAT_LAYOUT and MMAP_PAGE_ZERO flags were not cleared when a
  setuid or setgid program was executed. A local, unprivileged user could use
  this flaw to bypass the mmap_min_addr protection mechanism and perform a
  NULL pointer dereference attack, or bypass the Address Space Layout
  Randomization (ASLR) security feature. (CVE-2009-1895, Important)

  * it was discovered that, when executing a new process, the clear_child_tid
  pointer in the Linux kernel is not cleared. If this pointer points to a
  writable portion of the memory of the new program, the kernel could corrupt
  four bytes of memory, possibly leading to a local denial of service or
  privilege escalation. (CVE-2009-2848, Important)

  * Solar Designer reported a missing capability check in the z90crypt driver
  in the Linux kernel. This missing check could allow a local user with an
  effective user ID (euid) of 0 to bypass intended capability restrictions.
  (CVE-2009-1883, Moderate)

  * a flaw was found in the way the do_sigaltstack() function in the Linux
  kernel copies the stack_t structure to user-space. On 64-bit machines, this
  flaw could lead to a four-byte information leak. (CVE-2009-2847, Moderate)

  Bug fixes:

  * the gcc flag "-fno-delete-null-pointer-checks" was added to the kernel
  build options. This prevents gcc from optimizing out NULL pointer checks
  after the first use of a pointer. NULL pointer bugs are often exploited by
  attackers. Keeping these checks is a safety measure. (BZ#517964)

  * the Emulex LPFC driver has been updated to version 8.0.16.47, which fixes
  a memory leak that caused memory allocation failures and system hangs.
  (BZ#513192)

  * an error in the MPT Fusion driver makefile caused CSMI ioctls to not work
  with Serial Attached SCSI devices. (BZ#516184)

  * this update adds the mmap_min_addr tunable and restriction checks to help
  prevent unprivileged users from creating new memory mappings below the
  minimum address. This can help prevent the exploitation of NULL pointer
  deference bugs. Note that mmap_min_addr is set to zero (disabled) by
  default for backwards compatibility. (BZ#517904)

  * time-outs resulted in I/O errors being logged to "/var/log/messages" when
  running "mt erase" on tape drives using certain LSI MegaRAID SAS adapters,
  preventing the command from completing. The megaraid_sas driver's timeout
  value is now set to the OS layer value. (BZ#517965)

  * a locking issue caused the qla2xxx ioctl module to hang after
  encountering errors. This locking issue has been corrected. This ioctl
  module is used by the QLogic SAN management tools, such as SANsurfer and
  scli. (BZ#519428)

  * when a RAID 1 array that uses the mptscsi driver and the LSI 1030
  controller became degraded, the whole array was detected as being offline,
  which could cause kernel panics at boot or data loss. (BZ#517295)

  * on 32-bit architectures, if a file was held open and frequently written
  for more than 25 days, it was possible that the kernel would stop flushing
  those writes to storage. (BZ#515255)

  * a memory allocation bug in ib_mthca prevented the driver from loading if
  it was loaded with large values for the "num_mpt=" and "num_mtt=" options.
  See Kbase link below for details. (BZ#518707)

  * with this update, get_random_int() is more random and no longer uses a
  common seed value, reducing the possibility of predicting the values
  returned. See Kbase link below for details. (BZ#519692)

  * a bug in __ptrace_unlink() caused it to create deadlocked and unkillable
  processes. See Kbase link below for details. (BZ#519446)

  * previously, multiple threads using the fcntl() F_SETLK command to
  synchronize file access caused a deadlock in posix_locks_deadlock(). This
  could cause a system hang. (BZ#519429)

  Users should upgrade to these updated packages, which contain backported
  patches to correct these issues. Reboot the system for this update to take
  effect.
impacted_packages:
  - purl: pkg:rpm/redhat/kernel-hugemem-devel?arch=i686
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=i686
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=i686
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-hugemem?arch=i686
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xenU-devel?arch=i686
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-smp?arch=i686
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=i686
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xenU?arch=i686
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-smp-devel?arch=i686
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-doc?arch=noarch
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=ia64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-largesmp?arch=ia64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=ia64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-largesmp-devel?arch=ia64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=ia64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=src
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=x86_64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-largesmp?arch=x86_64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-largesmp-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xenU-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-smp?arch=x86_64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-xenU?arch=x86_64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-smp-devel?arch=x86_64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=ppc64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-largesmp?arch=ppc64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=ppc64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-largesmp-devel?arch=ppc64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=ppc64
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=ppc64iseries
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=ppc64iseries
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=ppc64iseries
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=s390x
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=s390x
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=s390x
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel?arch=s390
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-debuginfo?arch=s390
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kernel-devel?arch=s390
    affected_versions: vers:rpm/<2.6.9-89.0.11.EL
    fixed_versions: vers:rpm/2.6.9-89.0.11.EL
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2009/rhsa-2009_1438.json
weaknesses: []
references:
  - url: https://access.redhat.com/kb/docs/DOC-24775
    reference_type:
    reference_id:
  - url: https://access.redhat.com/kb/docs/DOC-24776
    reference_type:
    reference_id:
  - url: https://access.redhat.com/kb/docs/DOC-24777
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=505983
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2009/rhsa-2009_1438.json
    reference_type:
    reference_id:
  - url: http://www.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=511171
    reference_type: bug
    reference_id: 511171
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=513192
    reference_type: bug
    reference_id: 513192
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=515255
    reference_type: bug
    reference_id: 515255
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=515392
    reference_type: bug
    reference_id: 515392
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=515423
    reference_type: bug
    reference_id: 515423
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=516184
    reference_type: bug
    reference_id: 516184
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=517295
    reference_type: bug
    reference_id: 517295
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=517904
    reference_type: bug
    reference_id: 517904
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=517964
    reference_type: bug
    reference_id: 517964
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=517965
    reference_type: bug
    reference_id: 517965
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=518707
    reference_type: bug
    reference_id: 518707
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=519428
    reference_type: bug
    reference_id: 519428
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=519429
    reference_type: bug
    reference_id: 519429
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=519446
    reference_type: bug
    reference_id: 519446
  - url: https://access.redhat.com/errata/RHSA-2009:1438
    reference_type:
    reference_id: RHSA-2009:1438
