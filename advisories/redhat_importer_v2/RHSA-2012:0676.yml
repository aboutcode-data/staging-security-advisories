advisory_id: RHSA-2012:0676
datasource_id: redhat_importer_v2/RHSA-2012:0676
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0676.json
aliases:
  - CVE-2012-1601
  - CVE-2012-2121
summary: |
  Updated kvm packages that fix two security issues and one bug are now
  available for Red Hat Enterprise Linux 5.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. Common Vulnerability Scoring System (CVSS) base scores,
  which give detailed severity ratings, are available for each vulnerability
  from the CVE links in the References section.

  KVM (Kernel-based Virtual Machine) is a full virtualization solution for
  Linux on AMD64 and Intel 64 systems. KVM is a Linux kernel module built for
  the standard Red Hat Enterprise Linux kernel.

  A flaw was found in the way the KVM_CREATE_IRQCHIP ioctl was handled.
  Calling this ioctl when at least one virtual CPU (VCPU) already existed
  could lead to a NULL pointer dereference later when the VCPU is scheduled
  to run. A malicious user in the kvm group on the host could use this flaw
  to crash the host. (CVE-2012-1601)

  A flaw was found in the way device memory was handled during guest device
  removal. Upon successful device removal, memory used by the device was not
  properly unmapped from the corresponding IOMMU or properly released from
  the kernel, leading to a memory leak. A malicious user in the kvm group on
  the host who has the ability to assign a device to a guest could use this
  flaw to crash the host. (CVE-2012-2121)

  This update also fixes the following bug:

  * An off-by-one error in the QEMU guest's memory management could, in rare
  cases, cause QEMU-KVM to crash due to a segmentation fault in
  tb_invalidate_phys_page_range() if a device initiated DMA into a specific
  guest address. In a reported case, this issue presented on a system that
  had a guest using the 8139cp network driver. (BZ#816207)

  All users of kvm are advised to upgrade to these updated packages, which
  contain backported patches to correct these issues. Note that the procedure
  in the Solution section must be performed before this update will take
  effect.
impacted_packages:
  - purl: pkg:rpm/redhat/kvm-tools?arch=x86_64
    affected_versions: vers:rpm/<83-249.el5_8.4
    fixed_versions: vers:rpm/83-249.el5_8.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<83-249.el5_8.4
    fixed_versions: vers:rpm/83-249.el5_8.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm-qemu-img?arch=x86_64
    affected_versions: vers:rpm/<83-249.el5_8.4
    fixed_versions: vers:rpm/83-249.el5_8.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm?arch=x86_64
    affected_versions: vers:rpm/<83-249.el5_8.4
    fixed_versions: vers:rpm/83-249.el5_8.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kmod-kvm?arch=x86_64
    affected_versions: vers:rpm/<83-249.el5_8.4
    fixed_versions: vers:rpm/83-249.el5_8.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kmod-kvm-debug?arch=x86_64
    affected_versions: vers:rpm/<83-249.el5_8.4
    fixed_versions: vers:rpm/83-249.el5_8.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm?arch=src
    affected_versions: vers:rpm/<83-249.el5_8.4
    fixed_versions: vers:rpm/83-249.el5_8.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0676.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2012/rhsa-2012_0676.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=808199
    reference_type: bug
    reference_id: 808199
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=814149
    reference_type: bug
    reference_id: 814149
  - url: https://access.redhat.com/errata/RHSA-2012:0676
    reference_type:
    reference_id: RHSA-2012:0676
