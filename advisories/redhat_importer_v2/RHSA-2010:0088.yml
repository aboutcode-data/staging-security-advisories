advisory_id: RHSA-2010:0088
datasource_id: redhat_importer_v2/RHSA-2010:0088
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2010/rhsa-2010_0088.json
aliases:
  - CVE-2010-0297
  - CVE-2010-0298
  - CVE-2010-0306
  - CVE-2010-0309
summary: "Updated kvm packages that fix multiple security issues and several bugs are\nnow available\
  \ for Red Hat Enterprise Linux 5.\n\nThis update has been rated as having important security\
  \ impact by the Red\nHat Security Response Team.\n\nKVM (Kernel-based Virtual Machine) is\
  \ a full virtualization solution for\nLinux on AMD64 and Intel 64 systems. KVM is a Linux\
  \ kernel module built for\nthe standard Red Hat Enterprise Linux kernel.\n\nThe x86 emulator\
  \ implementation was missing a check for the Current\nPrivilege Level (CPL) and I/O Privilege\
  \ Level (IOPL). A user in a guest\ncould leverage these flaws to cause a denial of service\
  \ (guest crash) or\npossibly escalate their privileges within that guest. (CVE-2010-0298,\n\
  CVE-2010-0306)\n\nA flaw was found in the Programmable Interval Timer (PIT) emulation. Access\n\
  to the internal data structure pit_state, which represents the data state\nof the emulated\
  \ PIT, was not properly validated in the pit_ioport_read()\nfunction. A privileged guest user\
  \ could use this flaw to crash the host.\n(CVE-2010-0309)\n\nA flaw was found in the USB passthrough\
  \ handling code. A specially-crafted\nUSB packet sent from inside a guest could be used to\
  \ trigger a buffer\noverflow in the usb_host_handle_control() function, which runs under the\n\
  QEMU-KVM context on the host. A user in a guest could leverage this flaw to\ncause a denial\
  \ of service (guest hang or crash) or possibly escalate their\nprivileges within the host.\
  \ (CVE-2010-0297)\n\nThis update also fixes the following bugs: \n\n* pvclock MSR values were\
  \ not preserved during remote migration, causing\ntime drift for guests. (BZ#537028)\n\n*\
  \ SMBIOS table 4 data is now generated for Windows guests. (BZ#545874)\n\n* if the qemu-kvm\
  \ \"-net user\" option was used, unattended Windows XP\ninstallations did not receive an IP\
  \ address after reboot. (BZ#546562)\n\n* when being restored from migration, a race condition\
  \ caused Windows\nServer 2008 R2 guests to hang during shutdown. (BZ#546563)\n\n* the kernel\
  \ symbol checking on the kvm-kmod build process has a safety\ncheck for ABI changes. (BZ#547293)\n\
  \n* on hosts without high-res timers, Windows Server 2003 guests experienced\nsignificant\
  \ time drift. (BZ#547625)\n\n* in some situations, installing Windows Server 2008 R2 from\
  \ an ISO image\nresulted in a blue screen \"BAD_POOL_HEADER\" stop error. (BZ#548368)\n\n\
  * a bug in the grow_refcount_table() error handling caused infinite\nrecursion in some cases.\
  \ This caused the qemu-kvm process to hang and\neventually crash. (BZ#552159)\n\n* for Windows\
  \ Server 2003 R2, Service Pack 2, 32-bit guests, an \"unhandled\nvm exit\" error could occur\
  \ during reboot on some systems. (BZ#552518)\n\n* for Windows guests, QEMU could attempt to\
  \ stop a stopped audio device,\nresulting in a \"snd_playback_stop: ASSERT playback_channel->base.active\n\
  failed\" error. (BZ#552519)\n\n* the Hypercall driver did not reset the device on power-down.\
  \ (BZ#552528)\n\n* mechanisms have been added to make older savevm versions to be emitted\
  \ in\nsome cases. (BZ#552529)\n\n* an error in the Makefile prevented users from using the\
  \ source RPM to\ninstall KVM. (BZ#552530)\n\n* guests became unresponsive and could use up\
  \ to 100% CPU when running\ncertain benchmark tests with more than 7 guests running simultaneously.\n\
  (BZ#553249)\n\n* QEMU could terminate randomly with virtio-net and SMP enabled.\n(BZ#561022)\n\
  \nAll KVM users should upgrade to these updated packages, which contain\nbackported patches\
  \ to resolve these issues. Note: The procedure in the\nSolution section must be performed\
  \ before this update will take effect."
impacted_packages:
  - purl: pkg:rpm/redhat/kmod-kvm?arch=x86_64
    affected_versions: vers:rpm/<83-105.el5_4.22
    fixed_versions: vers:rpm/83-105.el5_4.22
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm?arch=x86_64
    affected_versions: vers:rpm/<83-105.el5_4.22
    fixed_versions: vers:rpm/83-105.el5_4.22
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm-qemu-img?arch=x86_64
    affected_versions: vers:rpm/<83-105.el5_4.22
    fixed_versions: vers:rpm/83-105.el5_4.22
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm-tools?arch=x86_64
    affected_versions: vers:rpm/<83-105.el5_4.22
    fixed_versions: vers:rpm/83-105.el5_4.22
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<83-105.el5_4.22
    fixed_versions: vers:rpm/83-105.el5_4.22
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/kvm?arch=src
    affected_versions: vers:rpm/<83-105.el5_4.22
    fixed_versions: vers:rpm/83-105.el5_4.22
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2010/rhsa-2010_0088.json
weaknesses: []
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=557025
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=559091
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=560654
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=560887
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2010/rhsa-2010_0088.json
    reference_type:
    reference_id:
  - url: http://www.redhat.com/security/updates/classification/#important
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=537028
    reference_type: bug
    reference_id: 537028
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=545874
    reference_type: bug
    reference_id: 545874
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=546562
    reference_type: bug
    reference_id: 546562
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=546563
    reference_type: bug
    reference_id: 546563
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=547293
    reference_type: bug
    reference_id: 547293
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=547625
    reference_type: bug
    reference_id: 547625
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=548368
    reference_type: bug
    reference_id: 548368
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=552159
    reference_type: bug
    reference_id: 552159
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=552518
    reference_type: bug
    reference_id: 552518
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=552519
    reference_type: bug
    reference_id: 552519
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=552528
    reference_type: bug
    reference_id: 552528
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=552529
    reference_type: bug
    reference_id: 552529
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=552530
    reference_type: bug
    reference_id: 552530
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=553249
    reference_type: bug
    reference_id: 553249
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=561022
    reference_type: bug
    reference_id: 561022
  - url: https://access.redhat.com/errata/RHSA-2010:0088
    reference_type:
    reference_id: RHSA-2010:0088
