advisory_id: RHSA-2008:0566
datasource_id: redhat_importer_v2/RHSA-2008:0566
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2008/rhsa-2008_0566.json
aliases:
  - CVE-2007-4994
summary: |
  Updated rhpki-util, rhpki-common, and rhpki-ca packages that fix a security
  issue and several bugs are now available for Red Hat Certificate System
  7.3.

  This update has been rated as having moderate security impact by the Red
  Hat Security Response Team.

  Red Hat Certificate System (RHCS) is an enterprise software system designed
  to manage enterprise Public Key Infrastructure (PKI) deployments.

  It was discovered that new revocations, performed while a Certificate
  Revocation List (CRL) was being generated, could potentially cause revoked
  certificates at the upper end of the serial number range to not appear on
  the CRL for a period of time. A user who has a revoked but otherwise valid
  certificate could take advantage of this issue and bypass the revocation
  list; however, in practice, they would have no way of influencing which
  revoked certificate entries were missing or the time period.
  (CVE-2007-4994)

  As well, these updated packages fix the following bugs:

  * due to a regression, signing a CRL with approximately 150,000 records may
  have taken up to five minutes. In these updated packages, signing such CRLs
  takes approximately twenty seconds.

  * a bug, which resulted in a 404 error, due to servers not handling Online
  Certificate Status Protocol (OCSP) requests in the GET method, has been
  resolved. This issue may have caused a system to use 100% CPU. As well,
  OCSP requests are now logged to the debug log file.

  * it was possible for a CRL update to run at the same time as a certificate
  status update. Now, CRL updating locks out the certificate status update
  thread.

  * inefficient LDAP search methods caused LDAP searches for a large number
  of revoked certificates to take up to twenty minutes or more for 100,000
  certificates during CRL generation. The LDAP search method has been
  modified to greatly improve LDAP search times.

  * the default OCSP verification path has changed since RHCS 7.1. These
  updated packages add support for certificates that use the old
  AuthorityInfoAccess (AIA) URL.

  * an OCSP client submitting an OCSP request via the GET method may have
  caused a "NullPointerException".

  * if an agent automatically approved a certificate signing request (CSR),
  using AgentCertAuth, the resultant certificate contained blank Subject Alt
  Name extension fields. A manual enrollment by the same agent produced a
  certificate with the correct number of Subject Alt Names and no blank
  entries. With this update, automated enrollments via AgentCertAuth do not
  have blank fields in issued certificates.

  Users of Red Hat Certificate System should upgrade to these updated
  packages, which resolve these issues.
impacted_packages:
  - purl: pkg:rpm/redhat/rhpki-util?arch=noarch
    affected_versions: vers:rpm/<7.3.0-18.el4
    fixed_versions: vers:rpm/7.3.0-18.el4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhpki-ca?arch=noarch
    affected_versions: vers:rpm/<7.3.0-11.el4
    fixed_versions: vers:rpm/7.3.0-11.el4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/rhpki-common?arch=noarch
    affected_versions: vers:rpm/<7.3.0-34.el4
    fixed_versions: vers:rpm/7.3.0-34.el4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2008/rhsa-2008_0566.json
weaknesses: []
references:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2008/rhsa-2008_0566.json
    reference_type:
    reference_id:
  - url: http://www.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=304571
    reference_type: bug
    reference_id: 304571
  - url: https://access.redhat.com/errata/RHSA-2008:0566
    reference_type:
    reference_id: RHSA-2008:0566
