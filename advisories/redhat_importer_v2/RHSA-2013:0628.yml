advisory_id: RHSA-2013:0628
datasource_id: redhat_importer_v2/RHSA-2013:0628
datasource_url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0628.json
aliases:
  - CVE-2013-0312
summary: |
  Updated 389-ds-base packages that fix one security issue and multiple bugs
  are now available for Red Hat Enterprise Linux 6.

  The Red Hat Security Response Team has rated this update as having moderate
  security impact. A Common Vulnerability Scoring System (CVSS) base score,
  which gives a detailed severity rating, is available from the CVE link in
  the References section.

  The 389 Directory Server is an LDAPv3 compliant server. The base packages
  include the Lightweight Directory Access Protocol (LDAP) server and
  command-line utilities for server administration.

  A flaw was found in the way LDAPv3 control data was handled by 389
  Directory Server. If a malicious user were able to bind to the directory
  (even anonymously) and send an LDAP request containing crafted LDAPv3
  control data, they could cause the server to crash, denying service to the
  directory. (CVE-2013-0312)

  The CVE-2013-0312 issue was discovered by Thierry Bordaz of Red Hat.

  This update also fixes the following bugs:

  * After an upgrade from Red Hat Enterprise Linux 6.3 to version 6.4, the
  upgrade script did not update the schema file for the PamConfig object
  class. Consequently, new features for PAM such as configuration of multiple
  instances and pamFilter attribute could not be used because of the schema
  violation. With this update, the upgrade script updates the schema file for
  the PamConfig object class and new features function properly. (BZ#910994)

  * Previously, the valgrind test suite reported recurring memory leaks in
  the modify_update_last_modified_attr() function. The size of the leaks
  averaged between 60-80 bytes per modify call. In environments where modify
  operations were frequent, this caused significant problems. Now, memory
  leaks no longer occur in the modify_update_last_modified_attr() function.
  (BZ#910995)

  * The Directory Server (DS) failed when multi-valued attributes were
  replaced. The problem occurred when replication was enabled, while the
  server executing the modification was configured as a single master and
  there was at least one replication agreement. Consequently, the
  modification requests were refused by the master server, which returned a
  code 20 "Type or value exists" error message. These requests were
  replacements of multi-valued attributes, and the error only occurred when
  one of the new values matched one of the current values of the attribute,
  but had a different letter case. Now, modification requests function
  properly and no longer return code 20 errors. (BZ#910996)

  * The DNA (distributed numeric assignment) plug-in, under certain
  conditions, could log error messages with the "DB_LOCK_DEADLOCK" error
  code when attempting to create an entry with a uidNumber attribute. Now,
  DNA handles this case properly and errors no longer occur during attempts
  to create entries with uidNumber attributes. (BZ#911467)

  * Posix Winsync plugin was calling an internal modify function which was
  not necessary. The internal modify call failed and logged an error message
  "slapi_modify_internal_set_pb: NULL parameter" which was not clear. This
  patch stops calling the internal modify function if it is not necessary and
  the cryptic error message is not observed. (BZ#911468)

  * Previously, under certain conditions, the dse.ldif file had 0 bytes after
  a server termination or when the machine was powered off. Consequently,
  after the system was brought up, a DS or IdM system could be unable to
  restart, leading to production server outages. Now, the server mechanism by
  which the dse.ldif is written is more robust, and tries all available
  backup dse.ldif files, and outages no longer occur. (BZ#911469)

  * Due to an incorrect interpretation of an error code, a directory server
  considered an invalid chaining configuration setting as the disk full error
  and shut down unexpectedly. Now, a more appropriate error code is in use
  and the server no longer shuts down from invalid chaining configuration
  settings. (BZ#911474)

  * While trying to remove a tombstone entry, the ns-slapd daemon terminated
  unexpectedly with a segmentation fault. With this update, removal of
  tombstone entries no longer causes crashes. (BZ#914305)

  All 389-ds-base users are advised to upgrade to these updated packages,
  which contain backported patches to correct these issues. After installing
  this update, the 389 server service will be restarted automatically.
impacted_packages:
  - purl: pkg:rpm/redhat/389-ds-base-devel?arch=x86_64
    affected_versions: vers:rpm/<1.2.11.15-12.el6_4
    fixed_versions: vers:rpm/1.2.11.15-12.el6_4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base-debuginfo?arch=x86_64
    affected_versions: vers:rpm/<1.2.11.15-12.el6_4
    fixed_versions: vers:rpm/1.2.11.15-12.el6_4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base?arch=x86_64
    affected_versions: vers:rpm/<1.2.11.15-12.el6_4
    fixed_versions: vers:rpm/1.2.11.15-12.el6_4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base-libs?arch=x86_64
    affected_versions: vers:rpm/<1.2.11.15-12.el6_4
    fixed_versions: vers:rpm/1.2.11.15-12.el6_4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base-devel?arch=i686
    affected_versions: vers:rpm/<1.2.11.15-12.el6_4
    fixed_versions: vers:rpm/1.2.11.15-12.el6_4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base-debuginfo?arch=i686
    affected_versions: vers:rpm/<1.2.11.15-12.el6_4
    fixed_versions: vers:rpm/1.2.11.15-12.el6_4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base-libs?arch=i686
    affected_versions: vers:rpm/<1.2.11.15-12.el6_4
    fixed_versions: vers:rpm/1.2.11.15-12.el6_4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base?arch=i686
    affected_versions: vers:rpm/<1.2.11.15-12.el6_4
    fixed_versions: vers:rpm/1.2.11.15-12.el6_4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:rpm/redhat/389-ds-base?arch=src
    affected_versions: vers:rpm/<1.2.11.15-12.el6_4
    fixed_versions: vers:rpm/1.2.11.15-12.el6_4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0628.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/updates/classification/#moderate
    reference_type:
    reference_id:
  - url: https://security.access.redhat.com/data/csaf/v2/advisories/2013/rhsa-2013_0628.json
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=910994
    reference_type: bug
    reference_id: 910994
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=910995
    reference_type: bug
    reference_id: 910995
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=911467
    reference_type: bug
    reference_id: 911467
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=911468
    reference_type: bug
    reference_id: 911468
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=911469
    reference_type: bug
    reference_id: 911469
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=911474
    reference_type: bug
    reference_id: 911474
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=912964
    reference_type: bug
    reference_id: 912964
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=914305
    reference_type: bug
    reference_id: 914305
  - url: https://access.redhat.com/errata/RHSA-2013:0628
    reference_type:
    reference_id: RHSA-2013:0628
