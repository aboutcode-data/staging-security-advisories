advisory_id: packagist/cachethq/cachet/CVE-2021-39174
datasource_id: gitlab_importer_v2/packagist/cachethq/cachet/CVE-2021-39174
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/cachethq/cachet/CVE-2021-39174.yml
aliases:
  - CVE-2021-39174
  - GHSA-88f9-7xxh-c688
summary: |
  Failure to Sanitize Special Elements into a Different Plane (Special Element Injection)
  Cachet is an open source status page system. Prior to version 2.5.1, authenticated users, regardless of their privileges (User or Admin), can leak the value of any configuration entry of the dotenv file, e.g. the application secret (`APP_KEY`) and various passwords (email, database, etc). This issue was addressed in version 2.5.1 by improving `UpdateConfigCommandHandler` and preventing the use of nested variables in the resulting dotenv configuration file. As a workaround, only allow trusted source IP addresses to access to the administration dashboard.
impacted_packages:
  - purl: pkg:composer/cachethq/cachet
    affected_versions: vers:composer/<=2.5.0
    fixed_versions: vers:composer/2.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/cachethq/cachet/CVE-2021-39174.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/cachethq/cachet/CVE-2021-39174.yml
weaknesses:
  - CWE-75
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/fiveai/Cachet/releases/tag/v2.5.1
    reference_type:
    reference_id:
  - url: https://github.com/fiveai/Cachet/security/advisories/GHSA-88f9-7xxh-c688
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39174
    reference_type:
    reference_id: CVE-2021-39174
  - url: https://github.com/advisories/GHSA-88f9-7xxh-c688
    reference_type:
    reference_id: GHSA-88f9-7xxh-c688
