advisory_id: packagist/cachethq/cachet/CVE-2021-39173
datasource_id: gitlab_importer_v2/packagist/cachethq/cachet/CVE-2021-39173
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/cachethq/cachet/CVE-2021-39173.yml
aliases:
  - CVE-2021-39173
  - GHSA-r67m-m8c7-jp83
summary: |
  Incorrect Type Conversion or Cast
  Cachet is an open source status page system. Prior to version 2.5.1 authenticated users, regardless of their privileges (User or Admin), can trick Cachet and install the instance again, leading to arbitrary code execution on the server. This issue was addressed in version 2.5.1 by improving the middleware `ReadyForUse`, which now performs a stricter validation of the instance name. As a workaround, only allow trusted source IP addresses to access to the administration dashboard.
impacted_packages:
  - purl: pkg:composer/cachethq/cachet
    affected_versions: vers:composer/<2.5.1
    fixed_versions: vers:composer/2.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/cachethq/cachet/CVE-2021-39173.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/cachethq/cachet/CVE-2021-39173.yml
weaknesses:
  - CWE-704
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://github.com/fiveai/Cachet/releases/tag/v2.5.1
    reference_type:
    reference_id:
  - url: https://github.com/fiveai/Cachet/security/advisories/GHSA-r67m-m8c7-jp83
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39173
    reference_type:
    reference_id: CVE-2021-39173
  - url: https://github.com/advisories/GHSA-r67m-m8c7-jp83
    reference_type:
    reference_id: GHSA-r67m-m8c7-jp83
