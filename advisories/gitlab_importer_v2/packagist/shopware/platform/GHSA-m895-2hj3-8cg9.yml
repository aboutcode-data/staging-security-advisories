advisory_id: packagist/shopware/platform/GHSA-m895-2hj3-8cg9
datasource_id: gitlab_importer_v2/packagist/shopware/platform/GHSA-m895-2hj3-8cg9
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/shopware/platform/GHSA-m895-2hj3-8cg9.yml
aliases:
  - GHSA-m895-2hj3-8cg9
summary: |
  Shopware vulnerable to MediaVisibilityRestrictionSubscriber bypass when reading media entities by aggregating fields individually
  In Shopware core and platform versions before 6.6.10.7 and 6.7.3.1, media visibility restrictions applied by MediaVisibilityRestrictionSubscriber are not enforced for aggregation API requests. Authorization filters are only injected during standard entity reads; aggregation queries can be constructed to bypass these checks and enumerate private media records such as invoices or other restricted documents. A lowâ€‘privilege backend user (e.g., product editor) can chain normal business flows (creating or viewing orders) with aggregation queries to disclose sensitive customer data including addresses and payment-related information contained within associated private media. The issue is resolved in 6.6.10.7 and 6.7.3.1.
impacted_packages:
  - purl: pkg:composer/shopware/platform
    affected_versions: vers:composer/<6.6.10+7|>=6.7.0+0|<6.7.3+1
    fixed_versions: vers:composer/6.6.10+7|6.7.3+1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/shopware/platform/GHSA-m895-2hj3-8cg9.yml
weaknesses:
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/shopware/shopware
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/commit/0965b35a527756faab2cec5a4ff172d79b0f99be
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/security/advisories/GHSA-m895-2hj3-8cg9
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-m895-2hj3-8cg9
    reference_type:
    reference_id: GHSA-m895-2hj3-8cg9
