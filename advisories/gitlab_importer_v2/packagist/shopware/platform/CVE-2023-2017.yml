advisory_id: packagist/shopware/platform/CVE-2023-2017
datasource_id: gitlab_importer_v2/packagist/shopware/platform/CVE-2023-2017
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/shopware/platform/CVE-2023-2017.yml
aliases:
  - CVE-2023-2017
  - GHSA-7v2v-9rm4-7m8f
summary: |
  Shopware Has Improper Control of Generation of Code in Twig rendered views
  We fixed with [CVE-2023-22731](https://github.com/shopware/platform/security/advisories/GHSA-93cw-f5jj-x85w) Twig filters to only be executed with allowed functions. It is possible to pass PHP Closures as string or an array and array crafted PHP Closures was not checked against allow list
impacted_packages:
  - purl: pkg:composer/shopware/platform
    affected_versions: vers:composer/<6.4.20+1
    fixed_versions: vers:composer/6.4.20+1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/shopware/platform/CVE-2023-2017.yml
weaknesses:
  - CWE-1336
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://docs.shopware.com/en/shopware-6-en/security-updates/security-update-04-2023
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-7v2v-9rm4-7m8f
    reference_type:
    reference_id:
  - url: https://github.com/shopware/platform
    reference_type:
    reference_id:
  - url: https://github.com/shopware/platform/releases/tag/v6.4.20.1
    reference_type:
    reference_id:
  - url: https://github.com/shopware/platform/security/advisories/GHSA-7v2v-9rm4-7m8f
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/security/advisories/GHSA-7v2v-9rm4-7m8f
    reference_type:
    reference_id:
  - url: https://starlabs.sg/advisories/23/23-2017
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-2017
    reference_type:
    reference_id: CVE-2023-2017
