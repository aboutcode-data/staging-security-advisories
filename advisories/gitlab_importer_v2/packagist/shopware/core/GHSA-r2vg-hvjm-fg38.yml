advisory_id: packagist/shopware/core/GHSA-r2vg-hvjm-fg38
datasource_id: gitlab_importer_v2/packagist/shopware/core/GHSA-r2vg-hvjm-fg38
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/shopware/core/GHSA-r2vg-hvjm-fg38.yml
aliases:
  - GHSA-r2vg-hvjm-fg38
summary: "Shopware Customer Orders can be canceled, even if refunds are disabled\nRefunds in\
  \ general can be enabled through the administration setting `core.cart.enableOrderRefunds`\
  \ (in the cart panel).Which visually shows and hides the button. However, using a custom crafted\
  \ request, a customer can still cancel his own orders.As this is not checked inside the route\
  \ (and also not in the controller):\n https://github.com/shopware/shopware/blob/trunk/src/Storefront/Controller/AccountOrderController.php#L98\
  \ \n https://github.com/shopware/shopware/blob/trunk/src/Core/Checkout/Order/SalesChannel/CancelOrderRoute.php\
  \ \n\nTo mitigate this, a check should be added to the `CancelOrderRoute` which verifies that\
  \ the feature is enabled."
impacted_packages:
  - purl: pkg:composer/shopware/core
    affected_versions: vers:composer/<6.6.10+7|>=6.7.0+0|<6.7.3+1
    fixed_versions: vers:composer/6.6.10+7|6.7.3+1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/shopware/core/GHSA-r2vg-hvjm-fg38.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-862
references:
  - url: https://github.com/shopware/shopware
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/commit/b157508aef2c820e7ff89ebd5848d3019f22b592
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/security/advisories/GHSA-r2vg-hvjm-fg38
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-r2vg-hvjm-fg38
    reference_type:
    reference_id: GHSA-r2vg-hvjm-fg38
