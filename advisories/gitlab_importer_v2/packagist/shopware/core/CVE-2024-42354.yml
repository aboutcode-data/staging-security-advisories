advisory_id: packagist/shopware/core/CVE-2024-42354
datasource_id: gitlab_importer_v2/packagist/shopware/core/CVE-2024-42354
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/shopware/core/CVE-2024-42354.yml
aliases:
  - CVE-2024-42354
  - GHSA-hhcq-ph6w-494g
summary: |
  Shopware vulnerable to Improper Access Control with ManyToMany associations in store-api
  The store-API works with regular entities and not expose all fields for the public API; fields need to be marked as ApiAware in the EntityDefinition. So only ApiAware fields of the EntityDefinition will be encoded to the final JSON.

  The processing of the Criteria did not considered ManyToMany associations and so they were not considered properly and the protections didn't get used.

  This issue cannot be reproduced with the default entities by Shopware, but can be triggered with extensions.
impacted_packages:
  - purl: pkg:composer/shopware/core
    affected_versions: vers:composer/<6.5.8+13|>=6.6.0+0|<6.6.5+1
    fixed_versions: vers:composer/6.5.8+13|6.6.5+1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/shopware/core/CVE-2024-42354.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-284
references:
  - url: https://github.com/shopware/core/commit/a784aa1cec0624e36e0ee4d41aeebaed40e0442f
    reference_type:
    reference_id:
  - url: https://github.com/shopware/core/commit/d35ee2eda5c995faeb08b3dad127eab65c64e2a2
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/commit/8504ba7e56e53add6a1d5b9d45015e3d899cd0ac
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/commit/ad83d38809df457efef21c37ce0996430334bf01
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/security/advisories/GHSA-hhcq-ph6w-494g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42354
    reference_type:
    reference_id: CVE-2024-42354
  - url: https://github.com/advisories/GHSA-hhcq-ph6w-494g
    reference_type:
    reference_id: GHSA-hhcq-ph6w-494g
