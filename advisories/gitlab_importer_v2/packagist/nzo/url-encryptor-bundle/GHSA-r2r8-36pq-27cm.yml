advisory_id: packagist/nzo/url-encryptor-bundle/GHSA-r2r8-36pq-27cm
datasource_id: gitlab_importer_v2/packagist/nzo/url-encryptor-bundle/GHSA-r2r8-36pq-27cm
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/nzo/url-encryptor-bundle/GHSA-r2r8-36pq-27cm.yml
aliases:
  - GHSA-r2r8-36pq-27cm
summary: |
  nzo/url-encryptor-bundle Insecure default secret key and IV allowing anyone to decrypt values
  Versions of nzo/url-encryptor-bundle prior to 5.0.1 and 4.3.2 are affected by a security vulnerability related to the lack of mandatory key and IV requirements. By default, the bundle uses the aes-256-ctr algorithm, which is susceptible to malleability attacks, potentially leading to Insecure Direct Object Reference (IDOR) vulnerabilities. Additionally, the reuse of keys enables users to decrypt and modify encrypted data if they can guess the plaintext of one ciphertext.
impacted_packages:
  - purl: pkg:composer/nzo/url-encryptor-bundle
    affected_versions: vers:composer/>=4.0.0|<4.3.2|>=5.0.0|<5.0.1
    fixed_versions: vers:composer/4.3.2|5.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/nzo/url-encryptor-bundle/2020-05-03.yaml
    reference_type:
    reference_id:
  - url: https://github.com/nayzo/NzoUrlEncryptorBundle
    reference_type:
    reference_id:
  - url: https://github.com/nayzo/NzoUrlEncryptorBundle/commit/ba3af1a9bcf3bedcc0ed5948979f482e2134da1a
    reference_type:
    reference_id:
  - url: https://github.com/nayzo/NzoUrlEncryptorBundle/commit/bd8232501c12c9df1bc45b1970870ef665218581
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-r2r8-36pq-27cm
    reference_type:
    reference_id: GHSA-r2r8-36pq-27cm
