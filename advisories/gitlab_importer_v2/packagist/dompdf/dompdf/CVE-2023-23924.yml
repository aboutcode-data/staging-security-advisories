advisory_id: packagist/dompdf/dompdf/CVE-2023-23924
datasource_id: gitlab_importer_v2/packagist/dompdf/dompdf/CVE-2023-23924
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/dompdf/dompdf/CVE-2023-23924.yml
aliases:
  - CVE-2023-23924
  - GHSA-3cw5-7cxw-v5qg
summary: |
  Incorrect Behavior Order: Authorization Before Parsing and Canonicalization
  Dompdf is an HTML to PDF converter. The URI validation on dompdf 2.0.1 can be bypassed on SVG parsing by passing `<image>` tags with uppercase letters. This may lead to arbitrary object unserialize on PHP < 8, through the `phar` URL wrapper. An attacker can exploit the vulnerability to call arbitrary URL with arbitrary protocols, if they can provide a SVG file to dompdf. In PHP versions before 8.0.0, it leads to arbitrary unserialize, that will lead to the very least to an arbitrary file deletion and even remote code execution, depending on classes that are available.
impacted_packages:
  - purl: pkg:composer/dompdf/dompdf
    affected_versions: vers:composer/2.0.1
    fixed_versions: vers:composer/2.0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/dompdf/dompdf/CVE-2023-23924.yml
weaknesses:
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/advisories/GHSA-3cw5-7cxw-v5qg
    reference_type:
    reference_id:
  - url: https://github.com/dompdf/dompdf/commit/7558f07f693b2ac3266089f21051e6b78c6a0c85
    reference_type:
    reference_id:
  - url: https://github.com/dompdf/dompdf/releases/tag/v2.0.2
    reference_type:
    reference_id:
  - url: https://github.com/dompdf/dompdf/security/advisories/GHSA-3cw5-7cxw-v5qg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-23924
    reference_type:
    reference_id: CVE-2023-23924
