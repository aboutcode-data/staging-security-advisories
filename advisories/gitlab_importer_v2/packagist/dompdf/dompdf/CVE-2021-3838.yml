advisory_id: packagist/dompdf/dompdf/CVE-2021-3838
datasource_id: gitlab_importer_v2/packagist/dompdf/dompdf/CVE-2021-3838
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/dompdf/dompdf/CVE-2021-3838.yml
aliases:
  - CVE-2021-3838
  - GHSA-577p-7j7h-2jgf
summary: |
  Deserialization of Untrusted Data in dompdf/dompdf
  DomPDF before version 2.0.0 is vulnerable to PHAR (PHP Archive) deserialization due to a lack of checking on the protocol before passing it into the file_get_contents() function. An attacker who can upload files of any type to the server can pass in the phar:// protocol to unserialize the uploaded file and instantiate arbitrary PHP objects. This can lead to remote code execution, especially when DOMPdf is used with frameworks with documented POP chains like Laravel or vulnerable developer code.
impacted_packages:
  - purl: pkg:composer/dompdf/dompdf
    affected_versions: vers:composer/<2.0.0
    fixed_versions: vers:composer/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/dompdf/dompdf/CVE-2021-3838.yml
weaknesses:
  - CWE-1035
  - CWE-502
  - CWE-937
references:
  - url: https://github.com/dompdf/dompdf
    reference_type:
    reference_id:
  - url: https://github.com/dompdf/dompdf/commit/99aeec1efec9213e87098d42eb09439e7ee0bb6a
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3838
    reference_type:
    reference_id: CVE-2021-3838
  - url: https://github.com/advisories/GHSA-577p-7j7h-2jgf
    reference_type:
    reference_id: GHSA-577p-7j7h-2jgf
