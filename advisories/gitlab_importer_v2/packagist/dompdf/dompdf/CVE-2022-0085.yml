advisory_id: packagist/dompdf/dompdf/CVE-2022-0085
datasource_id: gitlab_importer_v2/packagist/dompdf/dompdf/CVE-2022-0085
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/dompdf/dompdf/CVE-2022-0085.yml
aliases:
  - CVE-2022-0085
  - GHSA-pf6p-25r2-fx45
summary: Server-Side Request Forgery (SSRF) in GitHub repository dompdf/dompdf prior to 2.0.0.
  DomPDF uses `file_get_contents` to obtain HTTP files when `allow_url_fopen` is `On`. In default
  contexts, `file_get_contents` will redirect whenever served with a 302 response. When developers
  use DomPDF with `isRemoteEnabled` set to `true` and `allow_url_fopen` set to `true`, but restrict
  IP addresses via a deny list, it is possible for an attacker to pass in a URL which passes
  this deny list but serves a 302 redirect response to a restricted IP address. When this URL
  enters dompdf, `file_get_contents()` will both follow the redirection and cause an SSRF vulnerability.
impacted_packages:
  - purl: pkg:composer/dompdf/dompdf
    affected_versions: vers:composer/<2.0.0
    fixed_versions: vers:composer/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/dompdf/dompdf/CVE-2022-0085.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/dompdf/dompdf/CVE-2022-0085.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/dompdf/dompdf/commit/bb1ef65011a14730b7cfbe73506b4bb8a03704bd
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/73dbcc78-5ba9-492f-9133-13bbc9f31236
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-0085
    reference_type:
    reference_id: CVE-2022-0085
  - url: https://github.com/advisories/GHSA-pf6p-25r2-fx45
    reference_type:
    reference_id: GHSA-pf6p-25r2-fx45
