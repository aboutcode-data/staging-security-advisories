advisory_id: packagist/dompdf/dompdf/CVE-2021-3902
datasource_id: gitlab_importer_v2/packagist/dompdf/dompdf/CVE-2021-3902
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/dompdf/dompdf/CVE-2021-3902.yml
aliases:
  - CVE-2021-3902
  - GHSA-3vjh-xrhf-v9xh
summary: |
  Improper Restriction of XML External Entity Reference in dompdf/dompdf
  An improper restriction of external entities (XXE) vulnerability in dompdf/dompdf's SVG parser allows for Server-Side Request Forgery (SSRF) and deserialization attacks. This issue affects all versions prior to 2.0.0. The vulnerability can be exploited even if the isRemoteEnabled option is set to false. It allows attackers to perform SSRF, disclose internal image files, and cause PHAR deserialization attacks.
impacted_packages:
  - purl: pkg:composer/dompdf/dompdf
    affected_versions: vers:composer/<2.0.0
    fixed_versions: vers:composer/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/dompdf/dompdf/CVE-2021-3902.yml
weaknesses:
  - CWE-611
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/dompdf/dompdf
    reference_type:
    reference_id:
  - url: https://github.com/dompdf/dompdf/commit/f56bc8e40be6c0ae0825e6c7396f4db80620b799
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/a6071c07-806f-429a-8656-a4742e4191b1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3902
    reference_type:
    reference_id: CVE-2021-3902
  - url: https://github.com/advisories/GHSA-3vjh-xrhf-v9xh
    reference_type:
    reference_id: GHSA-3vjh-xrhf-v9xh
