advisory_id: packagist/timber/timber/CVE-2024-29800
datasource_id: gitlab_importer_v2/packagist/timber/timber/CVE-2024-29800
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/timber/timber/CVE-2024-29800.yml
aliases:
  - CVE-2024-29800
  - GHSA-6363-v5m4-fvq3
summary: |
  timber/timber vulnerable to Deserialization of Untrusted Data
  Timber is vulnerable to [PHAR deserialization](https://portswigger.net/web-security/deserialization/exploiting#phar-deserialization) due to a lack of checking the input before passing it into the` file_exists()` function. If an attacker can upload files of any type to the server, he can pass in the `phar://` protocol to unserialize the uploaded file and instantiate arbitrary PHP objects. This can lead to remote code execution especially when Timber is used with frameworks with documented POP chains like Wordpress/ vulnerable developer code.
impacted_packages:
  - purl: pkg:composer/timber/timber
    affected_versions: vers:composer/<2.1.0
    fixed_versions: vers:composer/2.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/timber/timber/CVE-2024-29800.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-502
  - CWE-73
references:
  - url: https://github.com/timber/timber
    reference_type:
    reference_id:
  - url: https://github.com/timber/timber/commit/13c6b0f60346304f2eed4da1e0bb51566518de4a
    reference_type:
    reference_id:
  - url: https://github.com/timber/timber/security/advisories/GHSA-6363-v5m4-fvq3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-29800
    reference_type:
    reference_id: CVE-2024-29800
  - url: https://github.com/advisories/GHSA-6363-v5m4-fvq3
    reference_type:
    reference_id: GHSA-6363-v5m4-fvq3
