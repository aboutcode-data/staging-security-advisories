advisory_id: packagist/getkirby/kirby/CVE-2025-30159
datasource_id: gitlab_importer_v2/packagist/getkirby/kirby/CVE-2025-30159
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getkirby/kirby/CVE-2025-30159.yml
aliases:
  - CVE-2025-30159
  - GHSA-fw82-87p8-v6hp
summary: |
  Kirby vulnerable to path traversal of snippet names in the `snippet()` helper
  The missing path traversal check allowed attackers to navigate and access all files on the server that were accessible to the PHP process, including files outside of the snippets root or even outside of the Kirby installation. PHP code within such files was executed.

  Such attacks first require an attack vector in the site code that is caused by dynamic snippet names, such as `snippet('tags-' . get('tags'))`. It generally also requires knowledge of the site structure and the server's file system by the attacker, although it can be possible to find vulnerable setups through automated methods such as fuzzing.

  In a vulnerable setup, this could cause damage to the confidentiality and integrity of the server, for example:

  - it could allow the attacker to build a map of the server's file system for subsequent attacks,
  - it could allow access to configuration files that may contain sensitive information like security tokens or
  - it could cause the unintended execution of PHP scripts.
impacted_packages:
  - purl: pkg:composer/getkirby/kirby
    affected_versions: vers:composer/<3.9.8+3|>=3.10.0|<3.10.1+2|>=4.0.0|<4.7.1
    fixed_versions: vers:composer/3.9.8+3|3.10.1+2|4.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getkirby/kirby/CVE-2025-30159.yml
weaknesses:
  - CWE-23
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/getkirby/kirby
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/commit/90acf7ed6d8d9d0697f938edc0940b4a563ddbe7
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.10.1.2
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.9.8.3
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/4.7.1
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/security/advisories/GHSA-fw82-87p8-v6hp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-30159
    reference_type:
    reference_id: CVE-2025-30159
  - url: https://github.com/advisories/GHSA-fw82-87p8-v6hp
    reference_type:
    reference_id: GHSA-fw82-87p8-v6hp
