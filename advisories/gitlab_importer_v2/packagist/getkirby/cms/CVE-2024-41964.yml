advisory_id: packagist/getkirby/cms/CVE-2024-41964
datasource_id: gitlab_importer_v2/packagist/getkirby/cms/CVE-2024-41964
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getkirby/cms/CVE-2024-41964.yml
aliases:
  - CVE-2024-41964
  - GHSA-jm9m-rqr3-wfmh
summary: |
  Kirby has insufficient permission checks in the language settings
  The missing permission checks allowed attackers with Panel access to manipulate the language definitions.

  The language definitions are at the core of multi-language content in Kirby. Unauthorized modifications with malicious intent can cause significant damage, for example:

  - If the `languages` option was enabled but no language exists, creating the first language will switch Kirby to multi-language mode.
  - Deleting an existing language will lead to content loss of all translated content in that language. Deleting the last language will switch Kirby to single-language mode.
  - Updating a language allows to change the metadata including the language slug (used in page URLs) and language variables. It also allows to change the default language, which will cause Kirby to use the new default language's content as a fallback for non-existing translations.

  Depending on the site code, the result of such actions can cause loss of site availability (e.g. error messages in the site frontend) or integrity (due to changed URLs or removed translations).
impacted_packages:
  - purl: pkg:composer/getkirby/cms
    affected_versions: vers:composer/<3.6.6+6|>=3.7.0|<3.7.5+5|>=3.8.0|<3.8.4+4|>=3.9.0|<3.9.8+2|>=3.10.0|<3.10.1+1|>=4.0.0|<4.3.1
    fixed_versions: vers:composer/3.6.6+6|3.7.5+5|3.8.4+4|3.9.8+2|3.10.1+1|4.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getkirby/cms/CVE-2024-41964.yml
weaknesses:
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/getkirby/kirby
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/commit/1dbc9215c97a5c22dc7f34a4e3a64d19e1eac151
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/commit/38636655b054e820f66c3b717c55a9d60fe6400a
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/commit/83fce501759782cf843b6f1d9293a7c7167e69af
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/commit/ab95d172667c3cd529917c2bc94d3c7969706d23
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/commit/af9b0a58dea63effab85525ae217faa1f5ded423
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/commit/e647a177c75636ef4824662b2ce00d8e5c3a8406
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.10.1.1
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.6.6.6
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.7.5.5
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.8.4.4
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.9.8.2
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/4.3.1
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/security/advisories/GHSA-jm9m-rqr3-wfmh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41964
    reference_type:
    reference_id: CVE-2024-41964
  - url: https://github.com/advisories/GHSA-jm9m-rqr3-wfmh
    reference_type:
    reference_id: GHSA-jm9m-rqr3-wfmh
