advisory_id: packagist/getkirby/cms/CVE-2025-31493
datasource_id: gitlab_importer_v2/packagist/getkirby/cms/CVE-2025-31493
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getkirby/cms/CVE-2025-31493.yml
aliases:
  - CVE-2025-31493
  - GHSA-x275-h9j4-7p4h
summary: |
  Kirby vulnerable to path traversal of collection names during file system lookup
  The missing path traversal check allowed attackers to navigate and access all files on the server that were accessible to the PHP process, including files outside of the collections root or even outside of the Kirby installation. PHP code within such files was executed.

  Such attacks first require an attack vector in the site code that is caused by dynamic collection names, such as `collection('tags-' . get('tags'))`. It generally also requires knowledge of the site structure and the server's file system by the attacker, although it can be possible to find vulnerable setups through automated methods such as fuzzing.

  In a vulnerable setup, this could cause damage to the confidentiality and integrity of the server, for example:

  - it could allow the attacker to build a map of the server's file system for subsequent attacks,
  - it could allow access to configuration files that may contain sensitive information like security tokens or
  - it could cause the unintended execution of PHP scripts.
impacted_packages:
  - purl: pkg:composer/getkirby/cms
    affected_versions: vers:composer/<3.9.8+3|>=3.10.0|<3.10.1+2|>=4.0.0|<4.7.1
    fixed_versions: vers:composer/3.9.8+3|3.10.1+2|4.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getkirby/cms/CVE-2025-31493.yml
weaknesses:
  - CWE-23
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/getkirby/kirby
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/commit/95a51480a426a8ed0df799cc017403be9b987ced
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.10.1.2
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.9.8.3
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/4.7.1
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/security/advisories/GHSA-x275-h9j4-7p4h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-31493
    reference_type:
    reference_id: CVE-2025-31493
  - url: https://github.com/advisories/GHSA-x275-h9j4-7p4h
    reference_type:
    reference_id: GHSA-x275-h9j4-7p4h
