advisory_id: packagist/getkirby/cms/GHSA-rv3r-vqjj-8c76
datasource_id: gitlab_importer_v2/packagist/getkirby/cms/GHSA-rv3r-vqjj-8c76
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getkirby/cms/GHSA-rv3r-vqjj-8c76.yml
aliases:
  - GHSA-rv3r-vqjj-8c76
summary: |
  Cross-site scripting from content entered in the tags and multiselect fields
  The tags and multiselect fields allow to select tags from an autocompleted list. The tags field also allows to enter new tags or edit existing tags. Kirby already handled escaping of the autocompleted tags, but unfortunately the Panel used HTML rendering for new or edited tags as well as for custom tags from the content file.

  This allowed **attackers with Panel access** to store malicious HTML code in a tag. The browser of the victim who visited the modified page in the Panel will then have rendered this malicious HTML code.

  It also allowed **self-inflicted XSS attacks** in the tags field (meaning that malicious code is executed in the browser of the user who entered it). This could be used in social engineering attacks where a victim is convinced by an attacker to enter malicious code into a tags field.

  **Visitors without Panel access** could *only* use this attack vector if your site allows changing the content of a tags or multiselect field from a frontend form (for example user self-registration or the creation of pages from a contact or other frontend form). If you validate or sanitize the provided form data, you are already protected against such attacks by external visitors.

  You are also *not* affected by these vulnerabilities if your site doesn't have untrustworthy users with Panel access or a way to modify field values from the frontend or if you don't use the tags or multiselect fields.
impacted_packages:
  - purl: pkg:composer/getkirby/cms
    affected_versions: vers:composer/>=3.5.7|<3.5.8+1|>=3.6.0|<3.6.6+1|>=3.7.0|<3.7.4
    fixed_versions: vers:composer/3.5.8+1|3.6.6+1|3.7.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getkirby/cms/GHSA-rv3r-vqjj-8c76.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/getkirby/kirby
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/security/advisories/GHSA-rv3r-vqjj-8c76
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-rv3r-vqjj-8c76
    reference_type:
    reference_id: GHSA-rv3r-vqjj-8c76
