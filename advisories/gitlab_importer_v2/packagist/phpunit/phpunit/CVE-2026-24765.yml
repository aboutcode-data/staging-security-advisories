advisory_id: packagist/phpunit/phpunit/CVE-2026-24765
datasource_id: gitlab_importer_v2/packagist/phpunit/phpunit/CVE-2026-24765
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/phpunit/phpunit/CVE-2026-24765.yml
aliases:
  - CVE-2026-24765
  - GHSA-vvj3-c3rp-c85p
summary: |
  PHPUnit Vulnerable to Unsafe Deserialization in PHPT Code Coverage Handling
  ### Overview

  A vulnerability has been discovered involving unsafe deserialization of code coverage data in PHPT test execution. The vulnerability exists in the `cleanupForCoverage()` method, which deserializes code coverage files without validation, potentially allowing remote code execution if malicious `.coverage` files are present prior to the execution of the PHPT test.

  ### Technical Details

  **Affected Component:** PHPT test runner, method `cleanupForCoverage()`
  **Affected Versions:** <= 8.5.51, <= 9.6.32, <= 10.5.61, <= 11.5.49, <= 12.5.7

  ### Vulnerable Code Pattern

  ```php
  if ($buffer !== false) {
      // Unsafe call without restrictions
      $coverage = @unserialize($buffer);
  }
  ```

  The vulnerability occurs when a `.coverage` file, which should not exist before test execution, is deserialized without the `allowed_classes` parameter restriction. An attacker with local file write access can place a malicious serialized object with a `__wakeup()` method into the file system, leading to arbitrary code execution during test runs with code coverage instrumentation enabled.

  ### Attack Prerequisites and Constraints

  This vulnerability requires **local file write access** to the location where PHPUnit stores or expects code coverage files for PHPT tests. This can occur through:

  * **CI/CD Pipeline Attacks:** A malicious pull request that places a `.coverage` file alongside test files, executed when the CI system runs tests using PHPUnit and collects code coverage information
  * **Local Development Environment:** An attacker with shell access or ability to write files to the project directory
  * **Compromised Dependencies:** A supply chain attack inserting malicious files into a package or monorepo
impacted_packages:
  - purl: pkg:composer/phpunit/phpunit
    affected_versions: vers:composer/<8.5.52|>=9.0.0|<9.6.33|>=10.0.0|<10.5.62|>=11.0.0|<11.5.50|>=12.0.0|<12.5.8
    fixed_versions: vers:composer/8.5.52|9.6.33|10.5.62|11.5.50|12.5.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/phpunit/phpunit/CVE-2026-24765.yml
weaknesses:
  - CWE-1035
  - CWE-502
  - CWE-937
references:
  - url: https://github.com/sebastianbergmann/phpunit
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/commit/3141742e00620e2968d3d2e732d320de76685fda
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/commit/613d142f5a8471ca71623ce5ca2795f79248329e
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/releases/tag/10.5.63
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/releases/tag/11.5.50
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/releases/tag/12.5.8
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/releases/tag/8.5.52
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/releases/tag/9.6.33
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/security/advisories/GHSA-vvj3-c3rp-c85p
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2026/02/msg00009.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-24765
    reference_type:
    reference_id:
  - url: https://owasp.org/www-project-top-10-ci-cd-security-risks/CICD-SEC-04-Poisoned-Pipeline-Execution
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-vvj3-c3rp-c85p
    reference_type:
    reference_id: GHSA-vvj3-c3rp-c85p
