advisory_id: packagist/simplesamlphp/simplesamlphp/GHSA-v858-922f-fj9v
datasource_id: gitlab_importer_v2/packagist/simplesamlphp/simplesamlphp/GHSA-v858-922f-fj9v
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/simplesamlphp/simplesamlphp/GHSA-v858-922f-fj9v.yml
aliases:
  - GHSA-v858-922f-fj9v
summary: |
  SimpleSAMLphp Link Injection vulnerability
  The following scripts were not checking the URLs obtained via the HTTP request before displaying them as the target of links that the user may click on:

  - www/logout.php
  - modules/core/www/no_cookie.php
  The issue allowed attackers to display links targeting a malicious website inside a trusted site running SimpleSAMLphp, due to the lack of security checks involving the link_href and retryURL HTTP parameters, respectively. The issue was resolved by including a verification of the URLs received in the request against a white list of websites specified in the trusted.url.domains configuration option.
impacted_packages:
  - purl: pkg:composer/simplesamlphp/simplesamlphp
    affected_versions: vers:composer/<1.14.4
    fixed_versions: vers:composer/1.14.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/simplesamlphp/simplesamlphp/GHSA-v858-922f-fj9v.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-74
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/simplesamlphp/simplesamlphp/201606-01.yaml
    reference_type:
    reference_id:
  - url: https://github.com/simplesamlphp/simplesamlphp
    reference_type:
    reference_id:
  - url: https://github.com/simplesamlphp/simplesamlphp/commit/b1af4e47c81bca2bee633b3f84f4fde624f359ba
    reference_type:
    reference_id:
  - url: https://github.com/simplesamlphp/simplesamlphp/commit/d26eb8f17dc9916a5ef2fd0a286b0fc96a561e71
    reference_type:
    reference_id:
  - url: https://simplesamlphp.org/security/201606-01
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-v858-922f-fj9v
    reference_type:
    reference_id: GHSA-v858-922f-fj9v
