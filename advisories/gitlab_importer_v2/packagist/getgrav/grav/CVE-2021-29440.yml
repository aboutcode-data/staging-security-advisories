advisory_id: packagist/getgrav/grav/CVE-2021-29440
datasource_id: gitlab_importer_v2/packagist/getgrav/grav/CVE-2021-29440
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2021-29440.yml
aliases:
  - CVE-2021-29440
  - GHSA-g8r4-p96j-xfxc
summary: |
  Improper Control of Generation of Code ('Code Injection')
  Grav is a file based Web-platform. Twig processing of static pages can be enabled in the front matter by any administrative user allowed to create or edit pages. As the Twig processor runs unsandboxed, this behavior can be used to gain arbitrary code execution and elevate privileges on the instance. The issue was addressed in version 1.7.11.
impacted_packages:
  - purl: pkg:composer/getgrav/grav
    affected_versions: vers:composer/<=1.7.10
    fixed_versions: vers:composer/1.7.11
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2021-29440.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2021-29440.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
  - CWE-94
references:
  - url: http://packetstormsecurity.com/files/162987/Grav-CMS-1.7.10-Server-Side-Template-Injection.html
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-g8r4-p96j-xfxc
    reference_type:
    reference_id:
  - url: https://packagist.org/packages/getgrav/grav
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29440
    reference_type:
    reference_id: CVE-2021-29440
  - url: https://github.com/advisories/GHSA-g8r4-p96j-xfxc
    reference_type:
    reference_id: GHSA-g8r4-p96j-xfxc
