advisory_id: packagist/getgrav/grav/CVE-2024-28119
datasource_id: gitlab_importer_v2/packagist/getgrav/grav/CVE-2024-28119
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2024-28119.yml
aliases:
  - CVE-2024-28119
  - GHSA-2m7x-c7px-hp58
summary: |
  Server Side Template Injection (SSTI) via Twig escape handler
  Due to the unrestricted access to twig extension class from grav context, an attacker can redefine the escape function and execute arbitrary commands.
impacted_packages:
  - purl: pkg:composer/getgrav/grav
    affected_versions: vers:composer/<1.7.45
    fixed_versions: vers:composer/1.7.45
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2024-28119.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://github.com/getgrav/grav
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/de1ccfa12dbcbf526104d68c1a6bc202a98698fe
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-2m7x-c7px-hp58
    reference_type:
    reference_id:
  - url: https://github.com/twigphp/Twig/blob/3.x/src/Extension/EscaperExtension.php#L99
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-28119
    reference_type:
    reference_id: CVE-2024-28119
  - url: https://github.com/advisories/GHSA-2m7x-c7px-hp58
    reference_type:
    reference_id: GHSA-2m7x-c7px-hp58
