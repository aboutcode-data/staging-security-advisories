advisory_id: packagist/getgrav/grav/CVE-2025-66294
datasource_id: gitlab_importer_v2/packagist/getgrav/grav/CVE-2025-66294
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2025-66294.yml
aliases:
  - CVE-2025-66294
  - GHSA-662m-56v4-3r8f
summary: |
  Grav is vulnerable to RCE via SSTI through Twig Sandbox Bypass
  A Server-Side Template Injection (SSTI) vulnerability exists in Grav that allows authenticated attackers with editor permissions to execute arbitrary commands on the server and, under certain conditions, may also be exploited by unauthenticated attackers. This vulnerability stems from weak regex validation in the `cleanDangerousTwig` method.
impacted_packages:
  - purl: pkg:composer/getgrav/grav
    affected_versions: vers:composer/<1.8.0-beta.27
    fixed_versions: vers:composer/1.8.0-beta.27
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2025-66294.yml
weaknesses:
  - CWE-1336
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://github.com/getgrav/grav
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/e37259527d9c1deb6200f8967197a9fa587c6458
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-662m-56v4-3r8f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66294
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-662m-56v4-3r8f
    reference_type:
    reference_id: GHSA-662m-56v4-3r8f
