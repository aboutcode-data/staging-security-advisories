advisory_id: packagist/getgrav/grav/CVE-2023-34253
datasource_id: gitlab_importer_v2/packagist/getgrav/grav/CVE-2023-34253
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2023-34253.yml
aliases:
  - CVE-2023-34253
  - GHSA-j3v8-v77f-fvgm
summary: |
  Improper Control of Generation of Code ('Code Injection')
  Grav is a file-based Web platform. Prior to version 1.7.42, the denylist introduced in commit 9d6a2d to prevent dangerous functions from being executed via injection of malicious templates was insufficient and could be easily subverted in multiple ways -- (1) using unsafe functions that are not banned, (2) using capitalised callable names, and (3) using fully-qualified names for referencing callables. Consequently, a low privileged attacker with login access to Grav Admin panel and page creation/update permissions is able to inject malicious templates to obtain remote code execution. A patch in version 1.7.42 improves the denylist.
impacted_packages:
  - purl: pkg:composer/getgrav/grav
    affected_versions: vers:composer/<1.7.42
    fixed_versions: vers:composer/1.7.42
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2023-34253.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
  - CWE-94
references:
  - url: https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/244758d4383034fe4cd292d41e477177870b65ec
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/8c2c1cb72611a399f13423fc6d0e1d998c03e5c8
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/9d01140a63c77075ef09b26ef57cf186138151a5
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/
    reference_type:
    reference_id:
  - url: https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34253
    reference_type:
    reference_id: CVE-2023-34253
  - url: https://github.com/advisories/GHSA-j3v8-v77f-fvgm
    reference_type:
    reference_id: GHSA-j3v8-v77f-fvgm
