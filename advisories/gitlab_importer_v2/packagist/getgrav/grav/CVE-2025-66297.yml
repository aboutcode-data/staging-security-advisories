advisory_id: packagist/getgrav/grav/CVE-2025-66297
datasource_id: gitlab_importer_v2/packagist/getgrav/grav/CVE-2025-66297
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2025-66297.yml
aliases:
  - CVE-2025-66297
  - GHSA-858q-77wx-hhx6
summary: |
  Grav vulnerable to Privilege Escalation and Authenticated Remote Code Execution via Twig Injection
  A user with admin panel access and permissions to create or edit pages in Grav CMS can enable Twig processing in the page frontmatter. By injecting malicious Twig expressions, the user can escalate their privileges to admin or execute arbitrary system commands via the scheduler API. This results in both Privilege Escalation (PE) and Remote Code Execution (RCE) vulnerabilities.
impacted_packages:
  - purl: pkg:composer/getgrav/grav
    affected_versions: vers:composer/<1.8.0-beta.27
    fixed_versions: vers:composer/1.8.0-beta.27
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/getgrav/grav/CVE-2025-66297.yml
weaknesses:
  - CWE-1336
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/getgrav/grav
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/e37259527d9c1deb6200f8967197a9fa587c6458
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-858q-77wx-hhx6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66297
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-858q-77wx-hhx6
    reference_type:
    reference_id: GHSA-858q-77wx-hhx6
