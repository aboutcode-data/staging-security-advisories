advisory_id: packagist/silverstripe/framework/GHSA-34q6-xqxh-gq39
datasource_id: gitlab_importer_v2/packagist/silverstripe/framework/GHSA-34q6-xqxh-gq39
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/framework/GHSA-34q6-xqxh-gq39.yml
aliases:
  - GHSA-34q6-xqxh-gq39
summary: |
  Silverstripe XSS In rewritten hash links
  A high level XSS vulnerability has been discovered in the SilverStripe framework which causes links containing hash anchors (E.g. href="#anchor") to be rewritten in an unsafe way.

  The rewriteHashlinks option on SSViewer will rewrite these to contain the current url, although without adequate escaping, meaning that HTML could be injected via injecting unsafe values to any page via the querystring.

  Due to the nature of this issue it is likely that a large number of SilverStripe sites are affected.
impacted_packages:
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/<3.0.13|>=3.1.0|<3.1.12
    fixed_versions: vers:composer/3.0.13|3.1.12
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/framework/GHSA-34q6-xqxh-gq39.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2015-009-1.yaml
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework/commit/604c32871202064a4aa12c3b3fd58140231685e5
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework/commit/bdef4fc7a548c7c243ff86f2db7c16f301a6f120
    reference_type:
    reference_id:
  - url: https://www.silverstripe.org/software/download/security-releases/ss-2015-009-xss-in-rewritten-hash-links
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-34q6-xqxh-gq39
    reference_type:
    reference_id: GHSA-34q6-xqxh-gq39
