advisory_id: packagist/silverstripe/framework/GHSA-qp29-wcc2-vmpc
datasource_id: gitlab_importer_v2/packagist/silverstripe/framework/GHSA-qp29-wcc2-vmpc
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/framework/GHSA-qp29-wcc2-vmpc.yml
aliases:
  - GHSA-qp29-wcc2-vmpc
summary: |
  Silverstripe HtmlEditor embed url sanitisation
  "Add from URL" doesn't clearly sanitise URL server side

  HtmlEditorField_Toolbar has an action HtmlEditorField_Toolbar#viewfile, which gets called by the CMS when adding a media "from a URL" (i.e. via oembed).

  This action gets the URL to add in the GET parameter FileURL. However it doesn't do any URL sanitising server side. The current logic will pass this through to Oembed, which will probably reject most dangerous URLs, but it's possible future changes would break this.
impacted_packages:
  - purl: pkg:composer/silverstripe/framework
    affected_versions: vers:composer/>=3.0.0|<3.2.1
    fixed_versions: vers:composer/3.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/framework/GHSA-qp29-wcc2-vmpc.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2015-027-1.yaml
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework
    reference_type:
    reference_id:
  - url: https://www.silverstripe.org/download/security-releases/ss-2015-027
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-qp29-wcc2-vmpc
    reference_type:
    reference_id: GHSA-qp29-wcc2-vmpc
