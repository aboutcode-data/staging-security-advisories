advisory_id: packagist/silverstripe/cms/CVE-2020-9309
datasource_id: gitlab_importer_v2/packagist/silverstripe/cms/CVE-2020-9309
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/cms/CVE-2020-9309.yml
aliases:
  - CVE-2020-9309
  - GHSA-h77w-655f-6j3m
summary: |
  Unrestricted Upload of File with Dangerous Type
  Silverstripe CMS through 4.5 can be susceptible to script execution from malicious upload contents under allowed file extensions (for example HTML code in a TXT file). When these files are stored as protected or draft files, the MIME detection can cause browsers to execute the file contents. Uploads stored as protected or draft files are allowed by default for authorised users only, but can also be enabled through custom logic as well as modules such as silverstripe/userforms. Sites using the previously optional silverstripe/mimevalidator module can configure MIME allow lists rather than extension allow lists, and hence prevent this issue. Sites on the Common Web Platform (CWP) use this module by default, and are not affected.
impacted_packages:
  - purl: pkg:composer/silverstripe/cms
    affected_versions: vers:composer/<=4.5.0
    fixed_versions: vers:composer/
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/cms/CVE-2020-9309.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/cms/CVE-2020-9309.yml
weaknesses:
  - CWE-937
  - CWE-434
  - CWE-1035
  - CWE-78
references:
  - url: https://www.silverstripe.org/download/security-releases/CVE-2020-9309
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-9309
    reference_type:
    reference_id: CVE-2020-9309
  - url: https://github.com/advisories/GHSA-h77w-655f-6j3m
    reference_type:
    reference_id: GHSA-h77w-655f-6j3m
