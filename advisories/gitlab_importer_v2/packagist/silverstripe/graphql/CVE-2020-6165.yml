advisory_id: packagist/silverstripe/graphql/CVE-2020-6165
datasource_id: gitlab_importer_v2/packagist/silverstripe/graphql/CVE-2020-6165
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/graphql/CVE-2020-6165.yml
aliases:
  - CVE-2020-6165
summary: |
  Incorrect Default Permissions
  The automatic permission-checking mechanism in the `silverstripe/graphql` module does not provide complete protection against lists that are limited (e.g., through pagination), resulting in records that should have failed a permission check being added to the final result set. GraphQL endpoints are configured by default (e.g., for assets), but the `admin/graphql` endpoint is access protected by default. This limits the vulnerability to all authenticated users, including those with limited permissions (e.g., where viewing records exposed through `admin/graphql` requires administrator permissions). However, if custom GraphQL endpoints have been configured for a specific implementation (usually under `/graphql`), this vulnerability could also be exploited through unauthenticated requests. This vulnerability only applies to reading records; it does not allow unauthorised changing of records.
impacted_packages:
  - purl: pkg:composer/silverstripe/graphql
    affected_versions: vers:composer/>=3.2.0|<3.3.0|>=4.5.0|<4.5.3
    fixed_versions: vers:composer/3.3.0|4.5.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/graphql/CVE-2020-6165.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/graphql/CVE-2020-6165.yml
weaknesses:
  - CWE-276
  - CWE-1035
  - CWE-937
references:
  - url: https://www.silverstripe.org/download/security-releases/CVE-2020-6165
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-6165
    reference_type:
    reference_id: CVE-2020-6165
