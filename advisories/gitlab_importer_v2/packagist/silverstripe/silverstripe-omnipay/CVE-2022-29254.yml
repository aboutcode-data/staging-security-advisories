advisory_id: packagist/silverstripe/silverstripe-omnipay/CVE-2022-29254
datasource_id: gitlab_importer_v2/packagist/silverstripe/silverstripe-omnipay/CVE-2022-29254
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/silverstripe-omnipay/CVE-2022-29254.yml
aliases:
  - CVE-2022-29254
  - GHSA-48f2-m7jg-866x
  - GMS-2022-1827
summary: |
  Interpretation Conflict
  silverstripe-omnipay is a SilverStripe integration with Omnipay PHP payments library. For a subset of Omnipay gateways (those that use intermediary states like `isNotification()` or `isRedirect()`), if the payment identifier or success URL is exposed it is possible for payments to be prematurely marked as completed without payment being taken. This is mitigated by the fact that most payment gateways hide this information from users, however some issuing banks offer flawed 3DSecure implementations that may inadvertently expose this data. The following versions have been patched to fix this issue: `2.5.2`, `3.0.2`, `3.1.4`, and `3.2.1`. There are no known workarounds for this vulnerability.
impacted_packages:
  - purl: pkg:composer/silverstripe/silverstripe-omnipay
    affected_versions: vers:composer/<2.5.2|>=3.0.0|<3.0.2|>=3.1.0|<3.1.4|>=3.2.0|<3.2.1
    fixed_versions: vers:composer/2.5.2|3.0.2|3.1.4|3.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/silverstripe-omnipay/CVE-2022-29254.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/silverstripe-omnipay/CVE-2022-29254.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-436
references:
  - url: https://github.com/silverstripe/silverstripe-omnipay/commit/7dee9a1e0a5f54c2dc06e018cff3d9a19044e01b
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/releases/tag/2.5.2
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/releases/tag/3.0.2
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/releases/tag/3.1.4
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/releases/tag/3.2.1
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-omnipay/security/advisories/GHSA-48f2-m7jg-866x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29254
    reference_type:
    reference_id: CVE-2022-29254
  - url: https://github.com/advisories/GHSA-48f2-m7jg-866x
    reference_type:
    reference_id: GHSA-48f2-m7jg-866x
