advisory_id: packagist/silverstripe/userforms/GHSA-55pp-293f-3365
datasource_id: gitlab_importer_v2/packagist/silverstripe/userforms/GHSA-55pp-293f-3365
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/userforms/GHSA-55pp-293f-3365.yml
aliases:
  - GHSA-55pp-293f-3365
summary: |
  silverstripe/userforms file upload exposure on UserForms module
  The [userforms module](https://github.com/silverstripe/silverstripe-userforms) allows CMS administrators to create public facing forms with file upload abilities. These files are uploaded into a predictable public path on the website, unless configured otherwise by the CMS administrator setting up the form. While the name of the uploaded file itself is not predictable, certain actions taken by CMS authors could expose it. For example, submission notification emails contain a link to the file without authorisation checks.

  In 3.0.0 this field is disabled by default, but re-enabled upon installation of the [secure assets module](https://github.com/silverstripe-labs/silverstripe-secureassets). When this is installed, the field can once again be used within a form, and will automatically lock this folder to a secure list of users, which can then be configured further by an administrator.

  Existing file upload fields will not be disabled, but will require re-enabling via config or installation of secure assets to become editable again.

  If any upload field points or is pointed to a folder that is not secured, and the secure assets module is present, then that folder will have the secure permissions applied automatically.
impacted_packages:
  - purl: pkg:composer/silverstripe/userforms
    affected_versions: vers:composer/<3.0.0
    fixed_versions: vers:composer/3.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/silverstripe/userforms/GHSA-55pp-293f-3365.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/userforms/SS-2015-018-1.yaml
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-userforms
    reference_type:
    reference_id:
  - url: https://www.silverstripe.org/software/download/security-releases/ss-2015-018
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-55pp-293f-3365
    reference_type:
    reference_id: GHSA-55pp-293f-3365
