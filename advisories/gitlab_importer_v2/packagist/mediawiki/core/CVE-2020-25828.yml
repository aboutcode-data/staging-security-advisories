advisory_id: packagist/mediawiki/core/CVE-2020-25828
datasource_id: gitlab_importer_v2/packagist/mediawiki/core/CVE-2020-25828
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/mediawiki/core/CVE-2020-25828.yml
aliases:
  - CVE-2020-25828
  - GHSA-h8qx-mj6v-2934
summary: |
  MediaWiki Cross-site Scripting (XSS) vulnerability
  An issue was discovered in MediaWiki before 1.31.9 and 1.32.x through 1.34.x before 1.34.3. The non-jqueryMsg version of mw.message().parse() doesn't escape HTML. This affects both message contents (which are generally safe) and the parameters (which can be based on user input). (When jqueryMsg is loaded, it correctly accepts only allowlisted tags in message contents, and escapes all parameters. Situations with an unloaded jqueryMsg are rare in practice, but can for example occur for Special:SpecialPages on a wiki with no extensions installed.)
impacted_packages:
  - purl: pkg:composer/mediawiki/core
    affected_versions: vers:composer/>=1.31.0|<1.31.9|>=1.32.0|<1.34.3|>=1.35.0-rc.0|<1.35.0
    fixed_versions: vers:composer/1.31.9|1.34.3|1.35.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/mediawiki/core/CVE-2020-25828.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/mediawiki/core/CVE-2020-25828.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/mediawiki/core/CVE-2020-25828.yaml
    reference_type:
    reference_id:
  - url: https://github.com/wikimedia/mediawiki
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RTTPZ7XMDS66I442OLLHXBDNP2LCBJU6
    reference_type:
    reference_id:
  - url: https://lists.wikimedia.org/pipermail/mediawiki-announce
    reference_type:
    reference_id:
  - url: https://lists.wikimedia.org/pipermail/mediawiki-l/2020-September/048480.html
    reference_type:
    reference_id:
  - url: https://lists.wikimedia.org/pipermail/mediawiki-l/2020-September/048488.html
    reference_type:
    reference_id:
  - url: https://phabricator.wikimedia.org/T115888
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-25828
    reference_type:
    reference_id: CVE-2020-25828
  - url: https://github.com/advisories/GHSA-h8qx-mj6v-2934
    reference_type:
    reference_id: GHSA-h8qx-mj6v-2934
