advisory_id: packagist/pimcore/customer-management-framework-bundle/CVE-2024-21666
datasource_id: gitlab_importer_v2/packagist/pimcore/customer-management-framework-bundle/CVE-2024-21666
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pimcore/customer-management-framework-bundle/CVE-2024-21666.yml
aliases:
  - CVE-2024-21666
  - GHSA-c38c-c8mh-vq68
summary: |
  Improper Access Control
  The Customer Management Framework (CMF) for Pimcore adds functionality for customer data management, segmentation, personalization and marketing automation. An authenticated and unauthorized user can access the list of potential duplicate users and see their data. Permissions are enforced when reaching the `/admin/customermanagementframework/duplicates/list` endpoint allowing an authenticated user without the permissions to access the endpoint and query the data available there. Unauthorized user(s) can access PII data from customers. This vulnerability has been patched in version 4.0.6.
impacted_packages:
  - purl: pkg:composer/pimcore/customer-management-framework-bundle
    affected_versions: vers:composer/<4.0.6
    fixed_versions: vers:composer/4.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pimcore/customer-management-framework-bundle/CVE-2024-21666.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-284
references:
  - url: https://github.com/pimcore/customer-data-framework/blob/b4af625ef327c58d05ef7cdf145fa749d2d4195e/src/Controller/Admin/DuplicatesController.php#L43
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/customer-data-framework/commit/c33c0048390ef0cf98b801d46a81d0762243baa6
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/customer-data-framework/security/advisories/GHSA-c38c-c8mh-vq68
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-c38c-c8mh-vq68
    reference_type:
    reference_id: GHSA-c38c-c8mh-vq68
