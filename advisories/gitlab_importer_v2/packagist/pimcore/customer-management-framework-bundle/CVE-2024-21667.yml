advisory_id: packagist/pimcore/customer-management-framework-bundle/CVE-2024-21667
datasource_id: gitlab_importer_v2/packagist/pimcore/customer-management-framework-bundle/CVE-2024-21667
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pimcore/customer-management-framework-bundle/CVE-2024-21667.yml
aliases:
  - CVE-2024-21667
  - GHSA-g273-wppx-82w4
summary: |
  Improper Access Control
  pimcore/customer-data-framework is the Customer Management Framework for management of customer data within Pimcore. An authenticated and unauthorized user can access the GDPR data extraction feature and query over the information returned, leading to customer data exposure. Permissions are not enforced when reaching the `/admin/customermanagementframework/gdpr-data/search-data-objects` endpoint allowing an authenticated user without the permissions to access the endpoint and query the data available there. An unauthorized user can access PII data from customers. This vulnerability has been patched in version 4.0.6.
impacted_packages:
  - purl: pkg:composer/pimcore/customer-management-framework-bundle
    affected_versions: vers:composer/<4.0.6
    fixed_versions: vers:composer/4.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pimcore/customer-management-framework-bundle/CVE-2024-21667.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-284
references:
  - url: https://github.com/pimcore/customer-data-framework/blob/b4af625ef327c58d05ef7cdf145fa749d2d4195e/src/Controller/Admin/GDPRDataController.php#L38
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/customer-data-framework/commit/6c34515be2ba39dceee7da07a1abf246309ccd77
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/customer-data-framework/security/advisories/GHSA-g273-wppx-82w4
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-g273-wppx-82w4
    reference_type:
    reference_id: GHSA-g273-wppx-82w4
