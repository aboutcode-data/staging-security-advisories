advisory_id: packagist/pimcore/pimcore/CVE-2014-2921
datasource_id: gitlab_importer_v2/packagist/pimcore/pimcore/CVE-2014-2921
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pimcore/pimcore/CVE-2014-2921.yml
aliases:
  - CVE-2014-2921
  - GHSA-g7pj-3v97-3vxp
summary: |
  Pimcore Vulnerable to PHP Object Injection Attacks
  The `getObjectByToken` function in `Newsletter.php` in the `Pimcore_Tool_Newsletter` module in pimcore 1.4.9 through 2.0.0 does not properly handle an object obtained by unserializing Lucene search data, which allows remote attackers to conduct PHP object injection attacks and execute arbitrary code via vectors involving a `Zend_Pdf_ElementFactory_Proxy` object and a pathname with a trailing `\0` character.
impacted_packages:
  - purl: pkg:composer/pimcore/pimcore
    affected_versions: vers:composer/>=1.4.9|<2.2.0
    fixed_versions: vers:composer/2.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pimcore/pimcore/CVE-2014-2921.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pimcore/pimcore/CVE-2014-2921.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://github.com/pedrib/PoC/blob/caa03645e256a8b50f1101c983d39586ebc467ee/advisories/pimcore-2.1.0.txt
    reference_type:
    reference_id:
  - url: https://github.com/pedrib/PoC/blob/master/pimcore-2.1.0.txt
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore
    reference_type:
    reference_id:
  - url: https://github.com/pimcore/pimcore/commit/3cb2683e669b5644f180d362cfa9614c09bef280
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2014-2921
    reference_type:
    reference_id: CVE-2014-2921
  - url: https://github.com/advisories/GHSA-g7pj-3v97-3vxp
    reference_type:
    reference_id: GHSA-g7pj-3v97-3vxp
