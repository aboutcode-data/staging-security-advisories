advisory_id: packagist/fof/pretty-mail/CVE-2024-58303
datasource_id: gitlab_importer_v2/packagist/fof/pretty-mail/CVE-2024-58303
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/fof/pretty-mail/CVE-2024-58303.yml
aliases:
  - CVE-2024-58303
  - GHSA-947q-2xw3-gx9c
summary: |
  FoF Pretty Mail has a server-side template injection vulnerability
  FoF Pretty Mail 1.1.2 contains a server-side template injection vulnerability that allows administrative users to inject malicious code into email templates. Attackers can execute system commands by inserting crafted template expressions that trigger arbitrary code execution during email generation.
impacted_packages:
  - purl: pkg:composer/fof/pretty-mail
    affected_versions: vers:composer/<=1.1.2
    fixed_versions: vers:composer/
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/fof/pretty-mail/CVE-2024-58303.yml
weaknesses:
  - CWE-1336
  - CWE-1035
  - CWE-937
references:
  - url: https://flarum.org
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfFlarum/pretty-mail
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/51948
    reference_type:
    reference_id:
  - url: https://www.vulncheck.com/advisories/fof-pretty-mail-server-side-template-injection-via-email-template-settings
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-58303
    reference_type:
    reference_id: CVE-2024-58303
  - url: https://github.com/advisories/GHSA-947q-2xw3-gx9c
    reference_type:
    reference_id: GHSA-947q-2xw3-gx9c
