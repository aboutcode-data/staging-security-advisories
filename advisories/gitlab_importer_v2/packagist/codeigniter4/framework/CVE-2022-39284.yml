advisory_id: packagist/codeigniter4/framework/CVE-2022-39284
datasource_id: gitlab_importer_v2/packagist/codeigniter4/framework/CVE-2022-39284
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/codeigniter4/framework/CVE-2022-39284.yml
aliases:
  - CVE-2022-39284
  - GHSA-745p-r637-7vvp
summary: |
  Improper Initialization
  CodeIgniter is a PHP full-stack web framework. In versions prior to 4.2.7 setting `$secure` or `$httponly` value to `true` in `Config\Cookie` is not reflected in `set_cookie()` or `Response::setCookie()`. As a result cookie values are erroneously exposed to scripts. It should be noted that this vulnerability does not affect session cookies. Users are advised to upgrade to v4.2.7 or later. Users unable to upgrade are advised to manually construct their cookies either by setting the options in code or by constructing Cookie objects. Examples of each workaround are available in the linked GHSA.
impacted_packages:
  - purl: pkg:composer/codeigniter4/framework
    affected_versions: vers:composer/<4.2.7
    fixed_versions: vers:composer/4.2.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/codeigniter4/framework/CVE-2022-39284.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-665
references:
  - url: https://codeigniter4.github.io/userguide/helpers/cookie_helper.html#set_cookie
    reference_type:
    reference_id:
  - url: https://codeigniter4.github.io/userguide/outgoing/response.html#CodeIgniter%5CHTTP%5CResponse::setCookie
    reference_type:
    reference_id:
  - url: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#restrict_access_to_cookies
    reference_type:
    reference_id:
  - url: https://github.com/codeigniter4/CodeIgniter4/issues/6540
    reference_type:
    reference_id:
  - url: https://github.com/codeigniter4/CodeIgniter4/pull/6544
    reference_type:
    reference_id:
  - url: https://github.com/codeigniter4/CodeIgniter4/security/advisories/GHSA-745p-r637-7vvp
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/codeigniter4/framework/CVE-2022-39284.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39284
    reference_type:
    reference_id: CVE-2022-39284
  - url: https://github.com/advisories/GHSA-745p-r637-7vvp
    reference_type:
    reference_id: GHSA-745p-r637-7vvp
