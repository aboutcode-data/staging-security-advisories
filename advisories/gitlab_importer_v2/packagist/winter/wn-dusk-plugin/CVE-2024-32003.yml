advisory_id: packagist/winter/wn-dusk-plugin/CVE-2024-32003
datasource_id: gitlab_importer_v2/packagist/winter/wn-dusk-plugin/CVE-2024-32003
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/winter/wn-dusk-plugin/CVE-2024-32003.yml
aliases:
  - CVE-2024-32003
  - GHSA-chcp-g9j5-3xxx
summary: |
  Dusk plugin may allow unfettered user authentication in misconfigured installs
  The Dusk plugin provides some special routes as part of its testing framework to allow a browser environment (such as headless Chrome) to act as a user in the Backend or User plugin without having to go through authentication. This route is `[[URL]]/_dusk/login/[[USER ID]]/[[MANAGER]]` - where `[[URL]]` is the base URL of the site, `[[USER ID]]` is the ID of the user account and `[[MANAGER]]` is the authentication manager (either `backend` for Backend, or `user` for the User plugin).

  If a configuration of a site using the Dusk plugin is set up in such a way that the Dusk plugin is available publicly and the test cases in Dusk are run with live data, this route may potentially be used to gain access to any user account in either the Backend or User plugin without authentication.

  As indicated in the [README](https://github.com/wintercms/wn-dusk-plugin/blob/main/README.md), this plugin should only be used in development and should *NOT* be used in a production instance. It is specifically recommended that the plugin be installed as a development dependency only in Composer.

  In order to remediate this issue, the special routes used above will now no longer be registered unless the `APP_ENV` environment variable is specifically set to `dusk`. Since Winter by default does not use this environment variable and it is not populated by default, it will only exist if Dusk's automatic configuration is used (which won't exhibit this vulnerability) or if a developer manually specifies it in their configuration.

  The automatic configuration performed by the Dusk plugin has also been hardened by default to use sane defaults and not allow external environment variables to leak into this configuration.
impacted_packages:
  - purl: pkg:composer/winter/wn-dusk-plugin
    affected_versions: vers:composer/<2.1.0
    fixed_versions: vers:composer/2.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/winter/wn-dusk-plugin/CVE-2024-32003.yml
weaknesses:
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/wintercms/wn-dusk-plugin
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/wn-dusk-plugin/security/advisories/GHSA-chcp-g9j5-3xxx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32003
    reference_type:
    reference_id: CVE-2024-32003
  - url: https://github.com/advisories/GHSA-chcp-g9j5-3xxx
    reference_type:
    reference_id: GHSA-chcp-g9j5-3xxx
