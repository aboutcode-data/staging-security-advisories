advisory_id: packagist/cardgate/magento2/CVE-2020-8818
datasource_id: gitlab_importer_v2/packagist/cardgate/magento2/CVE-2020-8818
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/cardgate/magento2/CVE-2020-8818.yml
aliases:
  - CVE-2020-8818
  - GHSA-qf6q-qfwp-vp44
summary: |
  Origin Validation Error
  An issue was discovered in the CardGate Payments plugin through 2.0.30 for Magento 2. Lack of origin authentication in the IPN callback processing function in Controller/Payment/Callback.php allows an attacker to remotely replace critical plugin settings (merchant ID, secret key, etc.) and therefore bypass the payment process (e.g., spoof an order status by manually sending an IPN callback request with a valid signature but without real payment) and/or receive all of the subsequent payments.
impacted_packages:
  - purl: pkg:composer/cardgate/magento2
    affected_versions: vers:composer/<2.0.33
    fixed_versions: vers:composer/2.0.33
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/cardgate/magento2/CVE-2020-8818.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/cardgate/magento2/CVE-2020-8818.yml
weaknesses:
  - CWE-1035
  - CWE-346
  - CWE-937
references:
  - url: http://packetstormsecurity.com/files/156505/Magento-WooCommerce-CardGate-Payment-Gateway-2.0.30-Bypass.html
    reference_type:
    reference_id:
  - url: https://github.com/cardgate/magento2/blob/715979e54e1a335d78a8c5586f9e9987c3bf94fd/Controller/Payment/Callback.php#L88-L107
    reference_type:
    reference_id:
  - url: https://github.com/cardgate/magento2/issues/54
    reference_type:
    reference_id:
  - url: https://github.com/cardgate/magento2/releases/tag/v2.0.33
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-8818
    reference_type:
    reference_id: CVE-2020-8818
  - url: https://github.com/advisories/GHSA-qf6q-qfwp-vp44
    reference_type:
    reference_id: GHSA-qf6q-qfwp-vp44
