advisory_id: packagist/laminas/laminas-diactoros/CVE-2023-29530
datasource_id: gitlab_importer_v2/packagist/laminas/laminas-diactoros/CVE-2023-29530
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/laminas/laminas-diactoros/CVE-2023-29530.yml
aliases:
  - CVE-2023-29530
  - GHSA-xv3h-4844-9h36
summary: |
  Improper Input Validation
  Laminas Diactoros provides PSR HTTP Message implementations. In versions 2.18.0 and prior, 2.19.0, 2.20.0, 2.21.0, 2.22.0, 2.23.0, 2.24.0, and 2.25.0, users who create HTTP requests or responses using laminas/laminas-diactoros, when providing a newline at the start or end of a header key or value, can cause an invalid message. This can lead to denial of service vectors or application errors. The problem has been patched in following versions 2.18.1, 2.19.1, 2.20.1, 2.21.1, 2.22.1, 2.23.1, 2.24.1, and 2.25.1. As a workaround, validate HTTP header keys and/or values, and if using user-supplied values, filter them to strip off leading or trailing newline characters before calling `withHeader()`.
impacted_packages:
  - purl: pkg:composer/laminas/laminas-diactoros
    affected_versions: vers:composer/<2.18.1|2.19.0|2.20.0|2.21.0|2.22.0|2.23.0|>=2.24.0|<2.24.2|>=2.25.0|<2.25.2
    fixed_versions: vers:composer/2.18.1|2.19.1|2.20.1|2.21.1|2.22.1|2.23.1|2.24.2|2.25.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/laminas/laminas-diactoros/CVE-2023-29530.yml
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/advisories/GHSA-wxmh-65f7-jcvw
    reference_type:
    reference_id:
  - url: https://github.com/laminas/laminas-diactoros/commit/7e721a60a09c5119c98694c2d23fc031094e1f1c
    reference_type:
    reference_id:
  - url: https://github.com/laminas/laminas-diactoros/security/advisories/GHSA-xv3h-4844-9h36
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29530
    reference_type:
    reference_id: CVE-2023-29530
  - url: https://github.com/advisories/GHSA-xv3h-4844-9h36
    reference_type:
    reference_id: GHSA-xv3h-4844-9h36
