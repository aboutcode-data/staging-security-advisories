advisory_id: packagist/prestashop/prestashop/CVE-2022-21686
datasource_id: gitlab_importer_v2/packagist/prestashop/prestashop/CVE-2022-21686
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/prestashop/prestashop/CVE-2022-21686.yml
aliases:
  - CVE-2022-21686
  - GHSA-mrq4-7ch7-2465
summary: |
  Improper Control of Generation of Code ('Code Injection')
  PrestaShop is an Open Source e-commerce platform. Starting with version 1.7.0.0 and ending with version 1.7.8.3, an attacker is able to inject twig code inside the back office when using the legacy layout. The problem is fixed in version 1.7.8.3. There are no known workarounds.
impacted_packages:
  - purl: pkg:composer/prestashop/prestashop
    affected_versions: vers:composer/>=1.7.0+0|<=1.7.8+2
    fixed_versions: vers:composer/1.7.8+3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/prestashop/prestashop/CVE-2022-21686.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/prestashop/prestashop/CVE-2022-21686.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://github.com/PrestaShop/PrestaShop/commit/d02b469ec365822e6a9f017e57f588966248bf21
    reference_type:
    reference_id:
  - url: https://github.com/PrestaShop/PrestaShop/releases/tag/1.7.8.3
    reference_type:
    reference_id:
  - url: https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-mrq4-7ch7-2465
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21686
    reference_type:
    reference_id: CVE-2022-21686
  - url: https://github.com/advisories/GHSA-mrq4-7ch7-2465
    reference_type:
    reference_id: GHSA-mrq4-7ch7-2465
