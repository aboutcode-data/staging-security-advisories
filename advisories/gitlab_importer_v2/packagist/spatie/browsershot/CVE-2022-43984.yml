advisory_id: packagist/spatie/browsershot/CVE-2022-43984
datasource_id: gitlab_importer_v2/packagist/spatie/browsershot/CVE-2022-43984
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/spatie/browsershot/CVE-2022-43984.yml
aliases:
  - CVE-2022-43984
  - GHSA-6q49-35h6-rq2p
summary: |
  Browsershot version 3.57.3 vulnerable to improper input validation
  Browsershot version 3.57.3 allows an external attacker to remotely obtain arbitrary local files. This is possible because the application does not validate that the JS content imported from an external source passed to the Browsershot::html method does not contain URLs that use the file:// protocol.
impacted_packages:
  - purl: pkg:composer/spatie/browsershot
    affected_versions: vers:composer/<3.57.4
    fixed_versions: vers:composer/3.57.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/spatie/browsershot/CVE-2022-43984.yml
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://fluidattacks.com/advisories/malone
    reference_type:
    reference_id:
  - url: https://github.com/spatie/browsershot
    reference_type:
    reference_id:
  - url: https://github.com/spatie/browsershot/commit/554c3e566fde8c47ad1ac9be47eaeb9a84c4dfe2
    reference_type:
    reference_id:
  - url: https://github.com/spatie/browsershot/commit/92cf16fc098211731f80d21687abeafbe2c457ad
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-43984
    reference_type:
    reference_id: CVE-2022-43984
  - url: https://github.com/advisories/GHSA-6q49-35h6-rq2p
    reference_type:
    reference_id: GHSA-6q49-35h6-rq2p
