advisory_id: packagist/ezsystems/ezplatform-richtext/CVE-2024-43372
datasource_id: gitlab_importer_v2/packagist/ezsystems/ezplatform-richtext/CVE-2024-43372
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/ezsystems/ezplatform-richtext/CVE-2024-43372.yml
aliases:
  - CVE-2024-43372
  - GHSA-rhm7-7469-rcpw
summary: |
  Persistent Cross-site Scripting in eZ Platform Rich Text Field Type
  The validator for the RichText fieldtype blocklists `javascript:` and `vbscript:` in links to prevent XSS. This can leave other options open, and the check can be circumvented using upper case. Content editing permissions for RichText content is required to exploit this vulnerability, which typically means Editor role or higher. The fix implements an allowlist instead, which allows only approved link protocols. The new check is case insensitive.
impacted_packages:
  - purl: pkg:composer/ezsystems/ezplatform-richtext
    affected_versions: vers:composer/>=3.3.0|<3.3.40
    fixed_versions: vers:composer/3.3.40
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://developers.ibexa.co/security-advisories/ibexa-sa-2024-005-persistent-xss-in-richtext
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/commit/2c652915625c47b493a2be06924f4c87d1df7d8e
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/commit/6131975108fa9756e17043e7a06a4e72f786f842
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/commit/7bbc6d024c6146d1e1ba84d27a3ebffe9459613e
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/commit/8b75c603dfd1ad6f6f3db15ae2324876683cbaf9
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/commit/dbe816f3ff4c903cc508dfdcdca8791c8284d292
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform-richtext/security/advisories/GHSA-rhm7-7469-rcpw
    reference_type:
    reference_id:
  - url: https://github.com/ibexa/fieldtype-richtext/security/advisories/GHSA-hvcf-6324-cjh7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43369
    reference_type:
    reference_id: CVE-2024-43369
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43372
    reference_type:
    reference_id: CVE-2024-43372
  - url: https://github.com/advisories/GHSA-rhm7-7469-rcpw
    reference_type:
    reference_id: GHSA-rhm7-7469-rcpw
