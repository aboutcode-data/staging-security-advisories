advisory_id: packagist/ezsystems/ezfind-ls/GHSA-9cq2-pcgr-8h62
datasource_id: gitlab_importer_v2/packagist/ezsystems/ezfind-ls/GHSA-9cq2-pcgr-8h62
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/ezsystems/ezfind-ls/GHSA-9cq2-pcgr-8h62.yml
aliases:
  - GHSA-9cq2-pcgr-8h62
summary: |
  Cross-site Scripting in eZFind spellcheck
  This security advisory fixes a vulnerability in the legacy eZ Find extension, which can be used with the LegacyBridge in eZ Platform. It affects sites using the "Did you mean...?" spell check / search suggestion feature. This feature is vulnerable to Cross-site Scripting (XSS) injection (reflected XSS). The update adds the necessary escaping of injected code. If you're affected, we recommend that you install it as soon as possible.

  If you have custom search templates, please make sure you update these as well. Ensure that "search_extras.spellcheck_collation" is followed by the "wash" operator, like this:
  {$search_extras.spellcheck_collation|wash}

  To install, use Composer to update to one of the "Resolving versions" mentioned above, or apply this patch manually:
  https://github.com/ezsystems/ezfind/commit/51c17ea9b1231c20db8221f34d01c649060f1e91
impacted_packages:
  - purl: pkg:composer/ezsystems/ezfind-ls
    affected_versions: vers:composer/>=5.3.0|<5.3.6+1|>=5.4.0|<5.4.11+1|>=2017.12.0|<2017.12.0+1
    fixed_versions: vers:composer/5.3.6+1|5.4.11+1|2017.12.0+1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/ezsystems/ezfind
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezfind/commit/51c17ea9b1231c20db8221f34d01c649060f1e91
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/ezsystems/ezfind-ls/2019-05-23-1.yaml
    reference_type:
    reference_id:
  - url: https://share.ez.no/community-project/security-advisories/ezsa-2019-003-xss-in-ezfind-spellcheck
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20210614183107/https://share.ez.no/community-project/security-advisories/ezsa-2019-003-xss-in-ezfind-spellcheck
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-9cq2-pcgr-8h62
    reference_type:
    reference_id: GHSA-9cq2-pcgr-8h62
