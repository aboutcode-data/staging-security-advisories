advisory_id: packagist/ezsystems/ezplatform/GHSA-6xch-2vxx-5pvr
datasource_id: gitlab_importer_v2/packagist/ezsystems/ezplatform/GHSA-6xch-2vxx-5pvr
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/ezsystems/ezplatform/GHSA-6xch-2vxx-5pvr.yml
aliases:
  - GHSA-6xch-2vxx-5pvr
summary: |
  eZ Platform Rules to disable executable access are ignored on Platform.sh (eZ Cloud)
  The recommended Apache/Nginx virtual host configuration for eZ Platform includes a rewrite rule for blocking access to executable files in the var directory. This rule does not work when using eZ Platform Cloud (i.e. running eZ Platform on the Platform.sh cloud service).

  The consequence of this is that in such a setup, those executable files may be downloadable. They will not be executable, unless you have specifically configured platform.sh to allow that (which you really should not do). The severity of the download access is limited, but it's better if the platform.sh cloud setup works the same way as regular eZ Platform does. All platform.sh setups are affected.

  The fix adds a rule to the .platform.app.yaml configuration file, with the same effect as the rewrite rule already mentioned. After applying the fix, any attempt to access such files will fail with Access Denied. This security update is distributed via Composer as ezsystems/ezplatform 1.7.9.1, and 1.13.5.1, and 2.5.4. This is the commit: https://github.com/ezsystems/ezplatform/commit/773dddc0d8fe4fda34d2153a401eeaa6cc30b1ff
impacted_packages:
  - purl: pkg:composer/ezsystems/ezplatform
    affected_versions: vers:composer/>=1.7.0|<1.7.9+1|>=1.13.0|<1.13.5+1|>=2.5.0|<2.5.4
    fixed_versions: vers:composer/1.7.9+1|1.13.5+1|2.5.4
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-670
references:
  - url: https://github.com/ezsystems/ezplatform
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezplatform/commit/773dddc0d8fe4fda34d2153a401eeaa6cc30b1ff
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/ezsystems/ezplatform/2019-09-03-1.yaml
    reference_type:
    reference_id:
  - url: https://share.ez.no/community-project/security-advisories/ezsa-2019-006-rules-to-disable-executable-access-are-ignored-on-platform.sh-ez-cloud
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-6xch-2vxx-5pvr
    reference_type:
    reference_id: GHSA-6xch-2vxx-5pvr
