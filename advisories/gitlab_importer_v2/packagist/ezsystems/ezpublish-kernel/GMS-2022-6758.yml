advisory_id: packagist/ezsystems/ezpublish-kernel/GMS-2022-6758
datasource_id: gitlab_importer_v2/packagist/ezsystems/ezpublish-kernel/GMS-2022-6758
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/ezsystems/ezpublish-kernel/GMS-2022-6758.yml
aliases:
  - GHSA-99r3-xmmq-7q7g
  - GMS-2022-6758
summary: |
  eZ Platform users with the Company admin role can assign any role to any user
  Critical severity. Users with the Company admin role (introduced by the company account feature in v4) can assign any role to any user. This also applies to any other user that has the role / assign policy. Any subtree limitation in place does not have any effect.

  The role / assign policy is typically only given to administrators, which limits the scope in most cases, but please verify who has this policy in your installaton. The fix ensures that subtree limitations are working as intended.
impacted_packages:
  - purl: pkg:composer/ezsystems/ezpublish-kernel
    affected_versions: vers:composer/>=7.5.0|<7.5.30
    fixed_versions: vers:composer/7.5.30
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://developers.ibexa.co/security-advisories/ibexa-sa-2022-009-critical-vulnerabilities-in-graphql-role-assignment-ct-editing-and-drafts-tooltips
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezpublish-kernel/commit/957e67a08af2b3265753f9763943e8225ed779ab
    reference_type:
    reference_id:
  - url: https://github.com/ezsystems/ezpublish-kernel/security/advisories/GHSA-99r3-xmmq-7q7g
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-99r3-xmmq-7q7g
    reference_type:
    reference_id: GHSA-99r3-xmmq-7q7g
