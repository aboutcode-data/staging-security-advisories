advisory_id: packagist/typo3/cms-core/CVE-2024-25121
datasource_id: gitlab_importer_v2/packagist/typo3/cms-core/CVE-2024-25121
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/typo3/cms-core/CVE-2024-25121.yml
aliases:
  - CVE-2024-25121
  - GHSA-rj3x-wvc6-5j66
summary: |
  Improper Access Control
  TYPO3 is an open source PHP based web content management system released under the GNU GPL. In affected versions of TYPO3 entities of the File Abstraction Layer (FAL) could be persisted directly via `DataHandler`. This allowed attackers to reference files in the fallback storage directly and retrieve their file names and contents. The fallback storage ("zero-storage") is used as a backward compatibility layer for files located outside properly configured file storages and within the public web root directory. Exploiting this vulnerability requires a valid backend user account. Users are advised to update to TYPO3 version 8.7.57 ELTS, 9.5.46 ELTS, 10.4.43 ELTS, 11.5.35 LTS, 12.4.11 LTS, or 13.0.1 which fix the problem described. When persisting entities of the File Abstraction Layer directly via DataHandler, `sys_file` entities are now denied by default, and `sys_file_reference` & `sys_file_metadata` entities are not permitted to reference files in the fallback storage anymore. When importing data from secure origins, this must be explicitly enabled in the corresponding DataHandler instance by using `$dataHandler->isImporting = true;`.
impacted_packages:
  - purl: pkg:composer/typo3/cms-core
    affected_versions: vers:composer/>=8.0.0|<=8.7.56|>=9.0.0|<=9.5.45|>=10.0.0|<=10.4.42|>=11.0.0|<=11.5.34|>=12.0.0|<=12.4.10|13.0.0
    fixed_versions: vers:composer/8.7.57|9.5.46|10.4.43|11.5.35|12.4.11|13.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/typo3/cms-core/CVE-2024-25121.yml
weaknesses:
  - CWE-937
  - CWE-200
  - CWE-1035
  - CWE-284
references:
  - url: https://github.com/TYPO3/typo3/commit/38f0bf9a61e10365be26eb75bc23a81184dbed07
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3/commit/71e652bf84b16fd3592205f61f36750ab03db74c
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3/commit/b47b6ddf5a5f3f852c6e43f837360780c12e3c47
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3/security/advisories/GHSA-rj3x-wvc6-5j66
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2024-006
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-rj3x-wvc6-5j66
    reference_type:
    reference_id: GHSA-rj3x-wvc6-5j66
