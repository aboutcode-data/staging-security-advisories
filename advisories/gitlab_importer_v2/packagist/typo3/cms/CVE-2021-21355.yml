advisory_id: packagist/typo3/cms/CVE-2021-21355
datasource_id: gitlab_importer_v2/packagist/typo3/cms/CVE-2021-21355
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/typo3/cms/CVE-2021-21355.yml
aliases:
  - CVE-2021-21355
  - GHSA-2r6j-862c-m2v2
summary: |
  Unrestricted Upload of File with Dangerous Type
  Due to the lack of ensuring file extensions belong to configured allowed mime-types, attackers can upload arbitrary data with arbitrary file extensions - however, default `_fileDenyPattern_` successfully blocked files like `_.htaccess_` or `_malicious.php_`. Additionally, `_UploadedFileReferenceConverter_` transforming uploaded files into proper FileReference domain model objects handles possible file uploads for other extensions as well - given those extensions use the Extbase MVC framework, make use of FileReference items in their direct or inherited domain model definitions and did not implement their own type converter. In case this scenario applies, `_UploadedFileReferenceConverter_` accepts any file mime-type and persists files in the default location. In any way, uploaded files are placed in the default location `_/fileadmin/user_upload/_`, in most scenarios keeping the submitted filename - which allows attackers to directly reference files, or even correctly guess filenames used by other individuals, disclosing this information. No authentication is required to exploit this vulnerability.
impacted_packages:
  - purl: pkg:composer/typo3/cms
    affected_versions: vers:composer/>=8.0.0|<8.7.40|>=9.0.0|<9.5.25|>=10.0.0|<10.4.14|>=11.0.0|<11.1.1
    fixed_versions: vers:composer/8.7.40|9.5.25|10.4.14|11.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/typo3/cms/CVE-2021-21355.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/typo3/cms/CVE-2021-21355.yml
weaknesses:
  - CWE-552
  - CWE-434
  - CWE-1035
  - CWE-937
references:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2021-002
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21355
    reference_type:
    reference_id: CVE-2021-21355
