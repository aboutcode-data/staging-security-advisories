advisory_id: packagist/typo3/cms/CVE-2023-24814
datasource_id: gitlab_importer_v2/packagist/typo3/cms/CVE-2023-24814
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/typo3/cms/CVE-2023-24814.yml
aliases:
  - CVE-2023-24814
  - GHSA-r4f8-f93x-5qh3
summary: |
  Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  TYPO3 is a free and open source Content Management Framework released under the GNU General Public License. In affected versions the TYPO3 core component `GeneralUtility::getIndpEnv()` uses the unfiltered server environment variable `PATH_INFO`, which allows attackers to inject malicious content. In combination with the TypoScript setting `config.absRefPrefix=auto`, attackers can inject malicious HTML code to pages that have not been rendered and cached, yet. As a result, injected values would be cached and delivered to other website visitors (persisted cross-site scripting). Individual code which relies on the resolved value of `GeneralUtility::getIndpEnv('SCRIPT_NAME')` and corresponding usages (as shown below) is vulnerable as well. Additional investigations confirmed that at least Apache web server deployments using CGI (FPM, FCGI/FastCGI, and similar) are affected. However, there still might be the risk that other scenarios like nginx, IIS, or Apache/mod_php is vulnerable. The usage of server environment variable `PATH_INFO` has been removed from corresponding processings in `GeneralUtility::getIndpEnv()`. Besides that, the public property `TypoScriptFrontendController::$absRefPrefix` is encoded for both being used as a URI component and for being used as a prefix in an HTML context. This mitigates the cross-site scripting vulnerability. Users are advised to update to TYPO3 versions 8.7.51 ELTS, 9.5.40 ELTS, 10.4.35 LTS, 11.5.23 LTS and 12.2.0 which fix this problem. For users who are unable to patch in a timely manner the TypoScript setting `config.absRefPrefix` should at least be set to a static path value, instead of using auto - e.g. `config.absRefPrefix=/`. This workaround **does not fix all aspects of the vulnerability**, and is just considered to be an intermediate mitigation to the most prominent manifestation.
impacted_packages:
  - purl: pkg:composer/typo3/cms
    affected_versions: vers:composer/>=8.7.0|<9.7.51|>=10.0.0|<10.4.36|>=11.0.0|<11.5.23|>=12.0.0|<12.2.0
    fixed_versions: vers:composer/10.4.36|11.5.23|12.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/typo3/cms/CVE-2023-24814.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://docs.typo3.org/m/typo3/reference-typoscript/main/en-us/Setup/Config/Index.html#absrefprefix
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms/CVE-2023-24814.yaml
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3/blob/v11.5.22/typo3/sysext/core/Classes/Utility/GeneralUtility.php#L2481-L2484
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3/blob/v11.5.22/typo3/sysext/frontend/Classes/Controller/TypoScriptFrontendController.php#L2547-L2549
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3/commit/0005a6fd86ab97eff8bf2e3a5828bf0e7cb6263a
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3/typo3/security/advisories/GHSA-r4f8-f93x-5qh3
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2023-001
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-psa-2023-001
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-24814
    reference_type:
    reference_id: CVE-2023-24814
  - url: https://github.com/advisories/GHSA-r4f8-f93x-5qh3
    reference_type:
    reference_id: GHSA-r4f8-f93x-5qh3
