advisory_id: packagist/librenms/librenms/CVE-2024-51092
datasource_id: gitlab_importer_v2/packagist/librenms/librenms/CVE-2024-51092
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/librenms/librenms/CVE-2024-51092.yml
aliases:
  - CVE-2024-51092
  - GHSA-x645-6pf9-xwxw
summary: |
  LibreNMS has an Authenticated OS Command Injection
  An authenticated attacker can create dangerous directory names on the system and alter sensitive configuration parameters through the web portal. Those two defects combined then allows to inject arbitrary OS commands inside `shell_exec()` calls, thus achieving arbitrary code execution.

  With all this, an authenticated attacker can:
  - Create a malicious Device with shell metacharacters inside its hostname
  - Force the creation of directory containing shell metacharacters through the PollDevice job
  - Modify the `snmpget` configuration variable to point to a valid system binary, while also using the directory created in the previous step via a path traversal (i.e: `/path/to/install/dir/rrd/<DEVICE_HOSTNAME>/../../../../../../../bin/ls`)
  - Trigger a code execution via the `shell_exec()` call contained in the `AboutController.php` script
impacted_packages:
  - purl: pkg:composer/librenms/librenms
    affected_versions: vers:composer/<24.10.0
    fixed_versions: vers:composer/24.10.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/librenms/librenms/CVE-2024-51092.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-x645-6pf9-xwxw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-51092
    reference_type:
    reference_id: CVE-2024-51092
  - url: https://github.com/advisories/GHSA-x645-6pf9-xwxw
    reference_type:
    reference_id: GHSA-x645-6pf9-xwxw
