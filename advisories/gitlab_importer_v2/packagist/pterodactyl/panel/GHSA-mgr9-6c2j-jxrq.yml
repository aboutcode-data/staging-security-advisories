advisory_id: packagist/pterodactyl/panel/GHSA-mgr9-6c2j-jxrq
datasource_id: gitlab_importer_v2/packagist/pterodactyl/panel/GHSA-mgr9-6c2j-jxrq
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pterodactyl/panel/GHSA-mgr9-6c2j-jxrq.yml
aliases:
  - GHSA-mgr9-6c2j-jxrq
summary: |
  Pterodactyl has a Reflected XSS vulnerability in “Create New Database Host”
  When an administrative user creates a new database host they are prompted to provide a `Host` value which is expected to be a domain or IP address. When an invalid value is encountered and passed back to `gethostaddr` and/or directly to the MySQL connection tooling, an error is returned. This error is then passed back along to the front-end, but was not properly sanitized when rendered.

  Therefore it is possible for an admin to _knowingly_ paste a malicious payload such as `<script>prompt(document.domain)</script>` into the `Host` field and XSS themselves.
impacted_packages:
  - purl: pkg:composer/pterodactyl/panel
    affected_versions: vers:composer/<1.12.0
    fixed_versions: vers:composer/1.12.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pterodactyl/panel/GHSA-mgr9-6c2j-jxrq.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/pterodactyl/panel
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/panel/commit/1570ff250939b75b3ba8cd03e5025d8293544ed4
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/panel/security/advisories/GHSA-mgr9-6c2j-jxrq
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-mgr9-6c2j-jxrq
    reference_type:
    reference_id: GHSA-mgr9-6c2j-jxrq
