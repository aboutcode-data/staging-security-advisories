advisory_id: packagist/zendframework/zendframework/GHSA-62f6-h68r-3jpw
datasource_id: gitlab_importer_v2/packagist/zendframework/zendframework/GHSA-62f6-h68r-3jpw
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/zendframework/zendframework/GHSA-62f6-h68r-3jpw.yml
aliases:
  - GHSA-62f6-h68r-3jpw
summary: |
  Zendframework session validation vulnerability
  `Zend\Session` session validators do not work as expected if set prior to the start of a session.

  For instance, the following test case fails (where `$this->manager` is an instance of `Zend\Session\SessionManager`):
  ```
  $this
  ->manager
  ->getValidatorChain()
  ->attach('session.validate', array(new RemoteAddr(), 'isValid'));

  $this->manager->start();

  $this->assertSame(
  array(
  'Zend\Session\Validator\RemoteAddr' =3D> '',
  ),
  $_SESSION['__ZF']['_VALID']
  );
  ```
  The implication is that subsequent calls to `Zend\Session\SessionManager#start()` (in later requests, assuming a session was created) will not have any validator metadata attached, which causes any validator metadata to be re-built from scratch, thus marking the session as valid.

  An attacker is thus able to simply ignore session validators such as RemoteAddr or HttpUserAgent, since the "signature" that these validators check against is not being stored in the session.
impacted_packages:
  - purl: pkg:composer/zendframework/zendframework
    affected_versions: vers:composer/>=2.0.0|<2.2.9|>=2.3.0|<2.3.4
    fixed_versions: vers:composer/2.2.9|2.3.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/zendframework/zendframework/GHSA-62f6-h68r-3jpw.yml
weaknesses:
  - CWE-384
  - CWE-1035
  - CWE-937
references:
  - url: https://framework.zend.com/security/advisory/ZF2015-01
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/zendframework/zendframework/ZF2015-01.yaml
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zendframework
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zendframework/commit/1672aee3531205e5c1a0b96d8c680124ec93db09
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zendframework/commit/282135561cbf98cc93274c57966b021fd6e051b9
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zendframework/commit/5f06a1f80a1aaeac87a46bfa9b63a5a74a14866c
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zendframework/commit/9493d725ef869e6ce7ab78167539223396fda491
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zendframework/commit/ddbf43ac3fe28fe98a4104993d0cb4bffb13a026
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zendframework/commit/f22a83c611732fbc0328f0f887bccc075be1fd56
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-62f6-h68r-3jpw
    reference_type:
    reference_id: GHSA-62f6-h68r-3jpw
