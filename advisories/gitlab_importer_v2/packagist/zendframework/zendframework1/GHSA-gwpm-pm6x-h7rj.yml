advisory_id: packagist/zendframework/zendframework1/GHSA-gwpm-pm6x-h7rj
datasource_id: gitlab_importer_v2/packagist/zendframework/zendframework1/GHSA-gwpm-pm6x-h7rj
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/zendframework/zendframework1/GHSA-gwpm-pm6x-h7rj.yml
aliases:
  - GHSA-gwpm-pm6x-h7rj
summary: |
  ZendFramework Cross-site Scripting vector in `Zend_Filter_StripTags`
  `Zend_Filter_StripTags` is a filtering class analogous to PHP's `strip_tags()` function. In addition to stripping HTML tags and selectively keeping those provided in a allowlist, it also provides the ability to allowlist specific attributes to retain per allowlisted tag.

  The reporter discovered that attributes that contained allowspace, and in paricular, line breaks, surrounding the attribute assignment operator would not be stripped, regardless of whether or not they were allowlisted. As examples of input affected:
  ```
  <!-- newlines before and/or after assignment: -->
  <a href="http://framework.zend.com/issues" onclick
  =
  "alert('Broken'); return false;">Issues</a>
  ```
  When passed to the following code:
  ```
  $filter = new Zend_Filter_StripTags(array('a' => array('href')));
  $value  = $filter->($html);
  ```
  then the "onclick" attribute would remain, even though it was not specified in the tag's allowlist. This could open potential cross-site scripting attack (XSS) vectors.
impacted_packages:
  - purl: pkg:composer/zendframework/zendframework1
    affected_versions: vers:composer/>=1.7.0|<1.7.6
    fixed_versions: vers:composer/1.7.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/zendframework/zendframework1/GHSA-gwpm-pm6x-h7rj.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://framework.zend.com/security/advisory/ZF2009-02
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/zendframework/zendframework1/ZF2009-02.yaml
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zf1
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-gwpm-pm6x-h7rj
    reference_type:
    reference_id: GHSA-gwpm-pm6x-h7rj
