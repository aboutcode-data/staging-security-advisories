advisory_id: packagist/api-platform/core/CVE-2023-25575
datasource_id: gitlab_importer_v2/packagist/api-platform/core/CVE-2023-25575
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/api-platform/core/CVE-2023-25575.yml
aliases:
  - CVE-2023-25575
  - GHSA-vr2x-7687-h6qv
summary: |
  api-platform/core's secured properties may be accessible within collections
  API Platform Core is the server component of API Platform: hypermedia and GraphQL APIs. Resource properties secured with the `security` option of the `ApiPlatform\Metadata\ApiProperty` attribute can be disclosed to unauthorized users. The problem affects most serialization formats, including raw JSON, which is enabled by default when installing API Platform. Custom serialization formats may also be impacted. Only collection endpoints are affected by the issue, item endpoints are not. The JSON-LD format is not affected by the issue. The result of the security rule is only executed for the first item of the collection. The result of the rule is then cached and reused for the next items. This bug can leak data to unauthorized users when the rule depends on the value of a property of the item. This bug can also hide properties that should be displayed to authorized users. This issue impacts the 2.7, 3.0 and 3.1 branches. Please upgrade to versions 2.7.10, 3.0.12 or 3.1.3. As a workaround, replace the `cache_key` of the context array of the Serializer inside a custom normalizer that works on objects if the security option of the `ApiPlatform\Metadata\ApiProperty` attribute is used.
impacted_packages:
  - purl: pkg:composer/api-platform/core
    affected_versions: vers:composer/>=2.6.0|<2.7.10|>=3.0.0|<3.0.12|>=3.1.0|<3.1.3
    fixed_versions: vers:composer/2.7.10|3.0.12|3.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/api-platform/core/CVE-2023-25575.yml
weaknesses:
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/api-platform/core/commit/5723d68369722feefeb11e42528d9580db5dd0fb
    reference_type:
    reference_id:
  - url: https://github.com/api-platform/core/releases/tag/v2.7.10
    reference_type:
    reference_id:
  - url: https://github.com/api-platform/core/releases/tag/v3.0.12
    reference_type:
    reference_id:
  - url: https://github.com/api-platform/core/releases/tag/v3.1.3
    reference_type:
    reference_id:
  - url: https://github.com/api-platform/core/security/advisories/GHSA-vr2x-7687-h6qv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-25575
    reference_type:
    reference_id: CVE-2023-25575
  - url: https://github.com/advisories/GHSA-vr2x-7687-h6qv
    reference_type:
    reference_id: GHSA-vr2x-7687-h6qv
