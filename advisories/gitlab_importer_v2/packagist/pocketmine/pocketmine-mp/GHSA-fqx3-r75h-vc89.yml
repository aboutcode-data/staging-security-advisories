advisory_id: packagist/pocketmine/pocketmine-mp/GHSA-fqx3-r75h-vc89
datasource_id: gitlab_importer_v2/packagist/pocketmine/pocketmine-mp/GHSA-fqx3-r75h-vc89
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pocketmine/pocketmine-mp/GHSA-fqx3-r75h-vc89.yml
aliases:
  - GHSA-fqx3-r75h-vc89
summary: |
  Improperly checked IDs on itemstacks received from the client leading to server crash in PocketMine-MP
  Due to a workaround for unmapped network items implemented in 4.0.0-BETA5 (8ac16345a3bc099b62c1f5cfbf3b736e621c3f76), arbitrary item IDs are able to be written into an item's NBT. The intended purpose of this is to make said unmapped network items able to be moved around the inventory without issues.

  This led to an exploit due to internal limits on the range that item IDs can occupy (-32768 - 32767), while the tag type used to represent the replacement IDs for unknown items is a `TAG_Int`, allowing a range from -(2^31) - 2^31 - 1. This leads to an uncaught exception which crashes the server.
impacted_packages:
  - purl: pkg:composer/pocketmine/pocketmine-mp
    affected_versions: vers:composer/>=4.0.0-BETA5|<4.4.2
    fixed_versions: vers:composer/4.4.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pocketmine/pocketmine-mp/GHSA-fqx3-r75h-vc89.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/pmmp/PocketMine-MP
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/commit/5fd685e07d61ef670584ed11a52fd5f4b99a81a7
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/commit/8ac16345a3bc099b62c1f5cfbf3b736e621c3f76
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-fqx3-r75h-vc89
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-fqx3-r75h-vc89
    reference_type:
    reference_id: GHSA-fqx3-r75h-vc89
