advisory_id: packagist/pocketmine/pocketmine-mp/GHSA-gj94-v4p9-w672
datasource_id: gitlab_importer_v2/packagist/pocketmine/pocketmine-mp/GHSA-gj94-v4p9-w672
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pocketmine/pocketmine-mp/GHSA-gj94-v4p9-w672.yml
aliases:
  - GHSA-gj94-v4p9-w672
summary: |
  Denial-of-service vulnerability processing large chat messages containing many newlines
  PocketMine-MP caps maximum chat message length at 512 Unicode characters, or about 2048 bytes. No more than 2 chat messages may be sent per tick. However, due to legacy reasons, incoming chat message blobs are split by `\n`, and each part is treated as a separate message, the length of each part is individually checked. The length of the whole message is not checked.

  This leads to an exploitable performance issue, in which a malicious client may send a chat packet of several megabytes containing nothing but `\n` newline characters. The server will parse this into a very large array and spend a long time (several milliseconds) iterating over it for no reason.

  Furthermore, due to the lack of sufficient rate limit checks before parsing messages, malicious clients may bombard the server with many thousands of these malicious messages, causing lockups for a significant amount of time (seconds or minutes).
impacted_packages:
  - purl: pkg:composer/pocketmine/pocketmine-mp
    affected_versions: vers:composer/<4.2.10
    fixed_versions: vers:composer/4.2.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pocketmine/pocketmine-mp/GHSA-gj94-v4p9-w672.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/pmmp/PocketMine-MP
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-gj94-v4p9-w672
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-gj94-v4p9-w672
    reference_type:
    reference_id: GHSA-gj94-v4p9-w672
