advisory_id: packagist/pocketmine/pocketmine-mp/GMS-2022-3
datasource_id: gitlab_importer_v2/packagist/pocketmine/pocketmine-mp/GMS-2022-3
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pocketmine/pocketmine-mp/GMS-2022-3.yml
aliases:
  - GHSA-c6fg-99pr-25m9
  - GMS-2022-3
summary: |
  Uncapped length of skin data fields submitted by players
  ### Impact
  Some skin data fields (e.g. skinID, geometryName) are not capped in length. These fields are typically saved in the NBT data of a player when the player quits the server, or during an autosave.

  This is problematic due to the 32767 byte limit on `TAG_String`s. If any of these fields exceeds 32767 bytes, an exception will be thrown during data saving, which will cause the server to crash.

  Other fields (such as skinGeometryData) are also uncapped, but those have a much larger 2 GB length limit, so this is not a concern for those, particularly considering the decompressed packet size limit of 2 MB.

  ### Patches
  PM3: 958a9dbf0fe3131ab60319c5a939f5dfbfe5dfbb
  PM4: 6492cac5c10f9fa8443ceddd2191a7b65b73f601

  ### Workarounds
  A plugin may check player skins during `PlayerLoginEvent` and `PlayerSkinChangeEvent` and ensure that the offending fields are not larger than 32767 bytes.

  ### For more information
  If you have any questions or comments about this advisory:
  * Email us at [team@pmmp.io](mailto:team@pmmp.io)
impacted_packages:
  - purl: pkg:composer/pocketmine/pocketmine-mp
    affected_versions: vers:composer/<3.26.5|>=4.0.0|<4.0.5
    fixed_versions: vers:composer/3.26.5|4.0.5
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/pmmp/PocketMine-MP/commit/6492cac5c10f9fa8443ceddd2191a7b65b73f601
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/commit/958a9dbf0fe3131ab60319c5a939f5dfbfe5dfbb
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-c6fg-99pr-25m9
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-c6fg-99pr-25m9
    reference_type:
    reference_id: GHSA-c6fg-99pr-25m9
