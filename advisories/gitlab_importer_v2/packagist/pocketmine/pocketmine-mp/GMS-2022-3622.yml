advisory_id: packagist/pocketmine/pocketmine-mp/GMS-2022-3622
datasource_id: gitlab_importer_v2/packagist/pocketmine/pocketmine-mp/GMS-2022-3622
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pocketmine/pocketmine-mp/GMS-2022-3622.yml
aliases:
  - GHSA-8cwq-4cmf-px73
  - GMS-2022-3622
summary: |
  PocketMine-MP invalid skin geometry JSON data leading to server crash
  ### Impact
  `pocketmine\entity\Skin` does not correctly handle errors produced by `adhocore/json-comment`, which throws `RuntimeException` rather than returning `false` as PocketMine-MP expects.

  This leads to a server crash if the skin geometry data is invalid for some reason (e.g. a syntax error).

  ### Patches
  c9626c610b8f6810c8c987559c9197b2a291f0bb

  ### Workarounds
  A plugin could handle `LoginPacket` and `PlayerSkinPacket` to verify the skin geometry data can be parsed correctly, so that the error condition in the core code is never reached.

  ### For more information
  If you have any questions or comments about this advisory:
  * Email us at [security@pmmp.io](mailto:security@example.com)
impacted_packages:
  - purl: pkg:composer/pocketmine/pocketmine-mp
    affected_versions: vers:composer/<4.7.2
    fixed_versions: vers:composer/4.7.2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/pmmp/PocketMine-MP/commit/c9626c610b8f6810c8c987559c9197b2a291f0bb
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-8cwq-4cmf-px73
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-8cwq-4cmf-px73
    reference_type:
    reference_id: GHSA-8cwq-4cmf-px73
