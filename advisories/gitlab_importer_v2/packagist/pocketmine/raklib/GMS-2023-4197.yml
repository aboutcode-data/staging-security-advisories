advisory_id: packagist/pocketmine/raklib/GMS-2023-4197
datasource_id: gitlab_importer_v2/packagist/pocketmine/raklib/GMS-2023-4197
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/pocketmine/raklib/GMS-2023-4197.yml
aliases:
  - GHSA-w98g-5fmx-wm4x
  - GMS-2023-4197
summary: |
  pocketmine/raklib reliable-ordered queue size is unlimited, allowing a session to hog server memory
  ### Impact
  A client can send reliable-ordered packets 0, 2, 3, 4, 5 ... etc, and all the packets 2 and up will stay in the reliable-ordered queue until 1 arrives. A malicious client can exploit this to waste all available server memory by simply never sending the missing packet. Since the server does not make any effort to limit the size of the queue or detect this kind of abuse, this problem is easy to abuse.

  ### Patches
  This bug was fixed on the 0.14.x and 0.15.x release lines by 371190f5854372154d1b263cd2a10e658e92bebe.

  ### Workarounds
  No workaround is known.
impacted_packages:
  - purl: pkg:composer/pocketmine/raklib
    affected_versions: vers:composer/>=0.14.0|<0.14.6|>=0.15.0|<0.15.1
    fixed_versions: vers:composer/0.14.6|0.15.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/pmmp/RakLib/commit/371190f5854372154d1b263cd2a10e658e92bebe
    reference_type:
    reference_id:
  - url: https://github.com/pmmp/RakLib/security/advisories/GHSA-w98g-5fmx-wm4x
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-w98g-5fmx-wm4x
    reference_type:
    reference_id: GHSA-w98g-5fmx-wm4x
