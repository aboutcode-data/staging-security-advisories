advisory_id: packagist/passbolt/passbolt_api/GHSA-f5pp-pmq8-gp46
datasource_id: gitlab_importer_v2/packagist/passbolt/passbolt_api/GHSA-f5pp-pmq8-gp46
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/passbolt/passbolt_api/GHSA-f5pp-pmq8-gp46.yml
aliases:
  - GHSA-f5pp-pmq8-gp46
summary: |
  Passbolt Api Retrieval of HTTP-only cookies
  Passbolt uses three cookies: a session cookie, a CSRF protection cookie and a cookie to keep track of the multiple-factor authentication process.

  Both the session cookie and the mfa cookie are properly set HTTP-only to prevent an attacker from retrieving the content of those cookies if they managed to exploit an XSS.

  The /auth/verify.json endpoint returns a JSON that, among other things, contains the cookies sent in the request. (similar to the TRACE HTTP method)

  An attacker who manages to leverage an XSS vulnerability could retrieve the session cookies of a legitimate user, effectively granting them the ability to retrieve information (such as encrypted password list or group list) without requiring user interaction.

  This vulnerability has a low impact, but no immediate risk due to it requiring the exploitation of an XSS vulnerability that has yet to be found.
impacted_packages:
  - purl: pkg:composer/passbolt/passbolt_api
    affected_versions: vers:composer/<2.7.0
    fixed_versions: vers:composer/2.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/passbolt/passbolt_api/GHSA-f5pp-pmq8-gp46.yml
weaknesses:
  - CWE-209
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/passbolt/passbolt_api/2019-02-11-2.yaml
    reference_type:
    reference_id:
  - url: https://github.com/passbolt/passbolt_api
    reference_type:
    reference_id:
  - url: https://github.com/passbolt/passbolt_api/commit/fbf99fed4b60db5fec97b58a2251a04bb42c1b15
    reference_type:
    reference_id:
  - url: https://www.passbolt.com/incidents/20190211_multiple_vulnerabilities
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-f5pp-pmq8-gp46
    reference_type:
    reference_id: GHSA-f5pp-pmq8-gp46
