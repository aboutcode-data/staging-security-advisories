advisory_id: packagist/craftcms/cms/CVE-2023-32679
datasource_id: gitlab_importer_v2/packagist/craftcms/cms/CVE-2023-32679
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/craftcms/cms/CVE-2023-32679.yml
aliases:
  - CVE-2023-32679
  - GHSA-vqxf-r9ph-cc9c
summary: |
  Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')
  Craft CMS is an open source content management system. In affected versions of Craft CMS an unrestricted file extension may lead to Remote Code Execution. If the name parameter value is not empty string('') in the View.php's doesTemplateExist() -> resolveTemplate() -> _resolveTemplateInternal() -> _resolveTemplate() function, it returns directly without extension verification, so that arbitrary extension files are rendered as twig templates. When attacker with admin privileges on a DEV or an improperly configured STG or PROD environment, they can exploit this vulnerability to remote code execution. Code execution may grant the attacker access to the host operating system. This issue has been addressed in version 4.4.6. Users are advised to upgrade. There are no known workarounds for this vulnerability.
impacted_packages:
  - purl: pkg:composer/craftcms/cms
    affected_versions: vers:composer/>=4.0.0|<4.4.6
    fixed_versions: vers:composer/4.4.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/craftcms/cms/CVE-2023-32679.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-74
references:
  - url: https://github.com/craftcms/cms/releases/tag/4.4.6
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/security/advisories/GHSA-vqxf-r9ph-cc9c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-32679
    reference_type:
    reference_id: CVE-2023-32679
  - url: https://github.com/advisories/GHSA-vqxf-r9ph-cc9c
    reference_type:
    reference_id: GHSA-vqxf-r9ph-cc9c
