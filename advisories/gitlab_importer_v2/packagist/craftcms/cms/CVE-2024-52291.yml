advisory_id: packagist/craftcms/cms/CVE-2024-52291
datasource_id: gitlab_importer_v2/packagist/craftcms/cms/CVE-2024-52291
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/craftcms/cms/CVE-2024-52291.yml
aliases:
  - CVE-2024-52291
  - GHSA-jrh5-vhr9-qh7q
summary: |
  Local File System Validation Bypass Leading to File Overwrite, Sensitive File Access, and Potential Code Execution
  A vulnerability in CraftCMS allows an attacker to bypass local file system validation by utilizing a double `file://` scheme (e.g., `file://file:////`). This enables the attacker to specify sensitive folders as the file system, leading to potential file overwriting through malicious uploads, unauthorized access to sensitive files, and, under certain conditions, remote code execution (RCE) via Server-Side Template Injection (SSTI) payloads.

  Note that this will only work if you have an authenticated administrator account with allowAdminChanges enabled
impacted_packages:
  - purl: pkg:composer/craftcms/cms
    affected_versions: vers:composer/>=4.0.0-RC1|<4.12.5|>=5.0.0-RC1|<5.4.6
    fixed_versions: vers:composer/4.12.5|5.4.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/craftcms/cms/CVE-2024-52291.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/craftcms/cms
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/security/advisories/GHSA-jrh5-vhr9-qh7q
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-52291
    reference_type:
    reference_id: CVE-2024-52291
  - url: https://github.com/advisories/GHSA-jrh5-vhr9-qh7q
    reference_type:
    reference_id: GHSA-jrh5-vhr9-qh7q
