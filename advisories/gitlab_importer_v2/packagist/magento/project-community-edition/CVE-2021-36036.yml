advisory_id: packagist/magento/project-community-edition/CVE-2021-36036
datasource_id: gitlab_importer_v2/packagist/magento/project-community-edition/CVE-2021-36036
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/magento/project-community-edition/CVE-2021-36036.yml
aliases:
  - CVE-2021-36036
  - GHSA-wqr6-wv6c-p8fx
summary: |
  Magento improper access control vulnerability within Magento's Media Gallery Upload workflow
  Magento versions 2.4.2 (and earlier), 2.4.2-p1 (and earlier) and 2.3.7 (and earlier) are affected by an improper access control vulnerability within Magento's Media Gallery Upload workflow. By storing a specially crafted file in the website gallery, an authenticated attacker with administrative privilege can gain access to delete the .htaccess file. This could result in the attacker achieving remote code execution.
impacted_packages:
  - purl: pkg:composer/magento/project-community-edition
    affected_versions: vers:composer/<=2.0.2
    fixed_versions: vers:composer/
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/magento/project-community-edition/CVE-2021-36036.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-284
references:
  - url: https://github.com/magento/magento2
    reference_type:
    reference_id:
  - url: https://helpx.adobe.com/security/products/magento/apsb21-64.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-36036
    reference_type:
    reference_id: CVE-2021-36036
  - url: https://github.com/advisories/GHSA-wqr6-wv6c-p8fx
    reference_type:
    reference_id: GHSA-wqr6-wv6c-p8fx
