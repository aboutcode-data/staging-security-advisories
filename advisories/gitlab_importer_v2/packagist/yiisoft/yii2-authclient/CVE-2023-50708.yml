advisory_id: packagist/yiisoft/yii2-authclient/CVE-2023-50708
datasource_id: gitlab_importer_v2/packagist/yiisoft/yii2-authclient/CVE-2023-50708
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/yiisoft/yii2-authclient/CVE-2023-50708.yml
aliases:
  - CVE-2023-50708
  - GHSA-w8vh-p74j-x9xp
summary: "yii2-authclient vulnerable to possible timing attack on string comparison in OAuth1,\
  \ OAuth2 and OpenID Connect implementation\n### Impact\n_What kind of vulnerability is it?\
  \ Who is impacted?_\n\nOriginal Report:\n\n> The Oauth1/2 \"state\" and OpenID Connect \"\
  nonce\" is vulnerable for a \"timing attack\" since it's compared via regular string \n> comparison\
  \ (instead of `Yii::$app->getSecurity()->compareString()`).\n\nAffected Code:\n\n1. OAuth\
  \ 1 \"state\"\n\n  https://github.com/yiisoft/yii2-authclient/blob/0d1c3880f4d79e20aa1d77c012650b54e69695ff/src/OAuth1.php#L158\n\
  \n3. OAuth 2 \"state\"\n  \n  https://github.com/yiisoft/yii2-authclient/blob/0d1c3880f4d79e20aa1d77c012650b54e69695ff/src/OAuth2.php#L121\n\
  \n4. OpenID Connect \"nonce\"\n  \n  https://github.com/yiisoft/yii2-authclient/blob/0d1c3880f4d79e20aa1d77c012650b54e69695ff/src/OpenIdConnect.php#L420\n\
  \n\n### Patches\n_Has the problem been patched? What versions should users upgrade to?_\n\n\
  TBD: Replace strcmp with `Yii::$app->getSecurity()->compareString()`).\n\n### Workarounds\n\
  _Is there a way for users to fix or remediate the vulnerability without upgrading?_\n\nnot\
  \ as far as I see.\n\n### References\n_Are there any links users can visit to find out more?_"
impacted_packages:
  - purl: pkg:composer/yiisoft/yii2-authclient
    affected_versions: vers:composer/<=2.2.14
    fixed_versions: vers:composer/2.2.15
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/yiisoft/yii2-authclient/blob/0d1c3880f4d79e20aa1d77c012650b54e69695ff/src/OAuth1.php#L158
    reference_type:
    reference_id:
  - url: https://github.com/yiisoft/yii2-authclient/blob/0d1c3880f4d79e20aa1d77c012650b54e69695ff/src/OAuth2.php#L121
    reference_type:
    reference_id:
  - url: https://github.com/yiisoft/yii2-authclient/blob/0d1c3880f4d79e20aa1d77c012650b54e69695ff/src/OpenIdConnect.php#L420
    reference_type:
    reference_id:
  - url: https://github.com/yiisoft/yii2-authclient/commit/dabddf2154ab7e7703740205a069202554089248
    reference_type:
    reference_id:
  - url: https://github.com/yiisoft/yii2-authclient/security/advisories/GHSA-w8vh-p74j-x9xp
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-w8vh-p74j-x9xp
    reference_type:
    reference_id: GHSA-w8vh-p74j-x9xp
