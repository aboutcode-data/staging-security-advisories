advisory_id: packagist/phpoffice/phpspreadsheet/CVE-2024-45291
datasource_id: gitlab_importer_v2/packagist/phpoffice/phpspreadsheet/CVE-2024-45291
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/phpoffice/phpspreadsheet/CVE-2024-45291.yml
aliases:
  - CVE-2024-45291
  - GHSA-w9xv-qf98-ccq4
summary: |
  PhpSpreadsheet allows absolute path traversal and Server-Side Request Forgery in HTML writer when embedding images is enabled
  It's possible for an attacker to construct an XLSX file that links images from arbitrary paths. When embedding images has been enabled in HTML writer with `$writer->setEmbedImages(true);` those files will be included in the output as `data:` URLs, regardless of the file's type. Also URLs can be used for embedding, resulting in a Server-Side Request Forgery vulnerability.
impacted_packages:
  - purl: pkg:composer/phpoffice/phpspreadsheet
    affected_versions: vers:composer/<1.29.2|>=2.0.0|<2.1.1|>=2.2.0|<2.3.0
    fixed_versions: vers:composer/1.29.2|2.1.1|2.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/phpoffice/phpspreadsheet/CVE-2024-45291.yml
weaknesses:
  - CWE-918
  - CWE-22
  - CWE-36
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/PHPOffice/PhpSpreadsheet
    reference_type:
    reference_id:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a
    reference_type:
    reference_id:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec
    reference_type:
    reference_id:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465
    reference_type:
    reference_id:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45291
    reference_type:
    reference_id: CVE-2024-45291
  - url: https://github.com/advisories/GHSA-w9xv-qf98-ccq4
    reference_type:
    reference_id: GHSA-w9xv-qf98-ccq4
