advisory_id: packagist/phpoffice/phpexcel/CVE-2024-45290
datasource_id: gitlab_importer_v2/packagist/phpoffice/phpexcel/CVE-2024-45290
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/phpoffice/phpexcel/CVE-2024-45290.yml
aliases:
  - CVE-2024-45290
  - GHSA-5gpr-w2p5-6m37
summary: |
  PhpSpreadsheet allows absolute path traversal and Server-Side Request Forgery when opening XLSX file
  It's possible for an attacker to construct an XLSX file which links media from external URLs. When opening the XLSX file, PhpSpreadsheet retrieves the image size and type by reading the file contents, if the provided path is a URL. By using specially crafted `php://filter` URLs an attacker can leak the contents of any file or URL.
impacted_packages:
  - purl: pkg:composer/phpoffice/phpexcel
    affected_versions: vers:composer/<=1.8.2
    fixed_versions: vers:composer/
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/phpoffice/phpexcel/CVE-2024-45290.yml
weaknesses:
  - CWE-937
  - CWE-36
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/PHPOffice/PhpSpreadsheet
    reference_type:
    reference_id:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a
    reference_type:
    reference_id:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec
    reference_type:
    reference_id:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465
    reference_type:
    reference_id:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-5gpr-w2p5-6m37
    reference_type:
    reference_id:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45290
    reference_type:
    reference_id: CVE-2024-45290
  - url: https://github.com/advisories/GHSA-5gpr-w2p5-6m37
    reference_type:
    reference_id: GHSA-5gpr-w2p5-6m37
