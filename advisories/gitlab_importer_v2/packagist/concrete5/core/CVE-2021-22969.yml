advisory_id: packagist/concrete5/core/CVE-2021-22969
datasource_id: gitlab_importer_v2/packagist/concrete5/core/CVE-2021-22969
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/concrete5/core/CVE-2021-22969.yml
aliases:
  - CVE-2021-22969
  - GHSA-mcxr-fx5f-96qq
summary: |
  Server-Side Request Forgery (SSRF)
  Concrete CMS (formerly concrete5) versions below 8.5.7 has a SSRF mitigation bypass using DNS Rebind attack giving an attacker the ability to fetch cloud IAAS (ex AWS) IAM keys.To fix this Concrete CMS no longer allows downloads from the local network and specifies the validated IP when downloading rather than relying on DNS.Discoverer: Adrian Tiron from FORTBRIDGE ( https://www.fortbridge.co.uk/ )The Concrete CMS team gave this a CVSS 3.1 score of 3.5 AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N . Please note that Cloud IAAS provider mis-configurations are not Concrete CMS vulnerabilities. A mitigation for this vulnerability is to make sure that the IMDS configurations are according to a cloud provider's best practices.This fix is also in Concrete version 9.0.0
impacted_packages:
  - purl: pkg:composer/concrete5/core
    affected_versions: vers:composer/<8.5.7
    fixed_versions: vers:composer/8.5.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/concrete5/core/CVE-2021-22969.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/concrete5/core/CVE-2021-22969.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-918
references:
  - url: https://documentation.concretecms.org/developers/introduction/version-history/857-release-notes
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1369312
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-22969
    reference_type:
    reference_id: CVE-2021-22969
  - url: https://github.com/advisories/GHSA-mcxr-fx5f-96qq
    reference_type:
    reference_id: GHSA-mcxr-fx5f-96qq
