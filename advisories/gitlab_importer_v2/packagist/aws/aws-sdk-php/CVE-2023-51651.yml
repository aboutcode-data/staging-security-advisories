advisory_id: packagist/aws/aws-sdk-php/CVE-2023-51651
datasource_id: gitlab_importer_v2/packagist/aws/aws-sdk-php/CVE-2023-51651
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/aws/aws-sdk-php/CVE-2023-51651.yml
aliases:
  - CVE-2023-51651
  - GHSA-557v-xcg6-rm5m
summary: |
  Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')
  AWS SDK for PHP is the Amazon Web Services software development kit for PHP. Within the scope of requests to S3 object keys and/or prefixes containing a Unix double-dot, a URI path traversal is possible. The issue exists in the `buildEndpoint` method in the RestSerializer component of the AWS SDK for PHP v3 prior to 3.288.1. The `buildEndpoint` method relies on the Guzzle Psr7 UriResolver utility, which strips dot segments from the request path in accordance with RFC 3986. Under certain conditions, this could lead to an arbitrary object being accessed. This issue has been patched in version 3.288.1.
impacted_packages:
  - purl: pkg:composer/aws/aws-sdk-php
    affected_versions: vers:composer/<3.288.1
    fixed_versions: vers:composer/3.288.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/aws/aws-sdk-php/CVE-2023-51651.yml
weaknesses:
  - CWE-352
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/aws/aws-sdk-php/commit/aebc9f801438746ac4ade327551576cb75f635f2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sdk-php/releases/tag/3.288.1
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sdk-php/security/advisories/GHSA-557v-xcg6-rm5m
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-51651
    reference_type:
    reference_id: CVE-2023-51651
  - url: https://github.com/advisories/GHSA-557v-xcg6-rm5m
    reference_type:
    reference_id: GHSA-557v-xcg6-rm5m
