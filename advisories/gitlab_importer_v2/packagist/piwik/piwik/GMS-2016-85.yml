advisory_id: packagist/piwik/piwik/GMS-2016-85
datasource_id: gitlab_importer_v2/packagist/piwik/piwik/GMS-2016-85
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/piwik/piwik/GMS-2016-85.yml
aliases:
  - GMS-2016-85
summary: |
  PHP Object Injection Vulnerability
  There's a PHP Object Injection vulnerability that can be triggered through the `saveLayout()` method defined into the `/plugins/Dashboard/Controller.php` script. Since Piwik is not using "utf8mb4" collations for its database, this can be exploited in combination with a MySQL UTF8 truncation issue in order to corrupt the session array, allowing unauthenticated attackers to inject arbitrary PHP objects into the application scope and carry out Server-Side Request Forgery (SSRF) attacks, delete arbitrary files, execute arbitrary PHP code, and possibly other attacks.
impacted_packages:
  - purl: pkg:composer/piwik/piwik
    affected_versions: vers:composer/<2.16.1-stable
    fixed_versions: vers:composer/2.16.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: http://karmainsecurity.com/KIS-2016-13
    reference_type:
    reference_id:
