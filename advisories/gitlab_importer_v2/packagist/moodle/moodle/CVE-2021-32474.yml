advisory_id: packagist/moodle/moodle/CVE-2021-32474
datasource_id: gitlab_importer_v2/packagist/moodle/moodle/CVE-2021-32474
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/moodle/moodle/CVE-2021-32474.yml
aliases:
  - CVE-2021-32474
summary: |
  Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  An SQL injection risk existed on sites with MNet enabled and configured, via an XML-RPC call from the connected peer host. Note that this required site administrator access or access to the keypair. Moodle 3.10 to 3.10.3, 3.9 to 3.9.6, 3.8 to 3.8.8, 3.5 to 3.5.17 and earlier unsupported versions are affected.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<3.5.18|>=3.8.0|<3.8.9|>=3.9.0|<3.9.7|>=3.10.0|<3.10.4
    fixed_versions: vers:composer/3.5.18|3.8.9|3.9.7|3.10.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/moodle/moodle/CVE-2021-32474.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/moodle/moodle/CVE-2021-32474.yml
weaknesses:
  - CWE-89
  - CWE-1035
  - CWE-937
references:
  - url: https://moodle.org/mod/forum/discuss.php?d=422308
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32474
    reference_type:
    reference_id: CVE-2021-32474
