advisory_id: packagist/moodle/moodle/CVE-2015-3181
datasource_id: gitlab_importer_v2/packagist/moodle/moodle/CVE-2015-3181
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/moodle/moodle/CVE-2015-3181.yml
aliases:
  - CVE-2015-3181
  - GHSA-622h-cjgg-5mx6
summary: |
  Moodle allows attackers to bypass file-management restrictions
  files/externallib.php in Moodle through 2.5.9, 2.6.x before 2.6.11, 2.7.x before 2.7.8, and 2.8.x before 2.8.6 does not consider the moodle/user:manageownfiles capability before approving a private-file upload, which allows remote authenticated users to bypass intended file-management restrictions by using web services to perform uploads after this capability has been revoked.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/<2.6.11|>=2.7.0|<2.7.8|>=2.8.0|<2.8.6
    fixed_versions: vers:composer/2.6.11|2.7.8|2.8.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/moodle/moodle/CVE-2015-3181.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-264
references:
  - url: http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-49994
    reference_type:
    reference_id:
  - url: http://openwall.com/lists/oss-security/2015/05/18/1
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/350397da93c557f577e7d62e7fc3e233792ad171
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/4b6b64685affa66784fd238c1bbc1eb0651492a0
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/57d9a750e3da6708dba13513e9b05e84a895ad9f
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/8e8ee7530427a10e409386657484e9fd5effc438
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=313688
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20200228054133/http://www.securityfocus.com/bid/74728
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20201030042703/http://www.securitytracker.com/id/1032358
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2015-3181
    reference_type:
    reference_id: CVE-2015-3181
  - url: https://github.com/advisories/GHSA-622h-cjgg-5mx6
    reference_type:
    reference_id: GHSA-622h-cjgg-5mx6
