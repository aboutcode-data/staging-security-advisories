advisory_id: packagist/moodle/moodle/CVE-2012-6099
datasource_id: gitlab_importer_v2/packagist/moodle/moodle/CVE-2012-6099
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/moodle/moodle/CVE-2012-6099.yml
aliases:
  - CVE-2012-6099
  - GHSA-cr78-rphw-w73p
summary: |
  Improper Input Validation
  The moodle1 backup converter in backup/converter/moodle1/lib.php in Moodle 2.1.x before 2.1.10, 2.2.x before 2.2.7, 2.3.x before 2.3.4, and 2.4.x before 2.4.1 does not properly validate pathnames, which allows remote authenticated users to read arbitrary files by leveraging the backup-restoration feature.
impacted_packages:
  - purl: pkg:composer/moodle/moodle
    affected_versions: vers:composer/>=2.1.0|<=2.1.9|>=2.2.0|<=2.2.6|>=2.3.0|<=2.3.3|2.4.0
    fixed_versions: vers:composer/2.1.10|2.2.7|2.3.4|2.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/moodle/moodle/CVE-2012-6099.yml
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-937
references:
  - url: http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-36977
    reference_type:
    reference_id:
  - url: http://openwall.com/lists/oss-security/2013/01/21/1
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/0ab681d3e7bed2a37430387f9da8504c0b077d10
    reference_type:
    reference_id:
  - url: https://github.com/moodle/moodle/commit/7b66137f7bcc84fb5eb07f58fb658b21bf37cc44
    reference_type:
    reference_id:
  - url: https://moodle.org/mod/forum/discuss.php?d=220160
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2012-6099
    reference_type:
    reference_id: CVE-2012-6099
  - url: https://github.com/advisories/GHSA-cr78-rphw-w73p
    reference_type:
    reference_id: GHSA-cr78-rphw-w73p
