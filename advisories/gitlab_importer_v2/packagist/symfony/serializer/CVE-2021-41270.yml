advisory_id: packagist/symfony/serializer/CVE-2021-41270
datasource_id: gitlab_importer_v2/packagist/symfony/serializer/CVE-2021-41270
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/symfony/serializer/CVE-2021-41270.yml
aliases:
  - CVE-2021-41270
  - GHSA-2xhg-w2g5-w95x
summary: |
  Improper Neutralization of Formula Elements in a CSV File
  Symfony/Serializer handles serializing and deserializing data structures for Symfony, a PHP framework for web and console applications and a set of reusable PHP components. Symfony  is vulnerable to CSV injection, also known as formula injection. In Symfony, maintainers added the opt-in `csv_escape_formulas` option in the `CsvEncoder`, to prefix all cells starting with `=`, `+`, `-` or `@` with a tab `\t`. Since then, OWASP added 2 chars in that list: Tab (0x09) and Carriage return (0x0D). This makes the previous prefix char (Tab `\t`) part of the vulnerable characters, and OWASP suggests using the single quote `'` for prefixing the value. Starting with, Symfony now follows the OWASP recommendations and uses the single quote `'` to prefix formulas and add the prefix to cells starting by `\t`, `\r` as well as `=`, `+`, `-` and `@`.
impacted_packages:
  - purl: pkg:composer/symfony/serializer
    affected_versions: vers:composer/>=4.1.0|<4.4.35|>=5.0.0|<5.3.12
    fixed_versions: vers:composer/4.4.35|5.3.12
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/symfony/serializer/CVE-2021-41270.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/symfony/serializer/CVE-2021-41270.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-1236
references:
  - url: https://github.com/symfony/symfony/commit/3da6f2d45e7536ccb2a26f52fbaf340917e208a8
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/pull/44243
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/releases/tag/v5.3.12
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/security/advisories/GHSA-2xhg-w2g5-w95x
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3BPT4SF6SIXFMZARDWED5T32J7JEH3EP/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QSREFD2TJT5LWKM6S4MD3W26NQQ5WJUP/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41270
    reference_type:
    reference_id: CVE-2021-41270
