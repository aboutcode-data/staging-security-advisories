advisory_id: packagist/symfony/security-http/GMS-2021-130
datasource_id: gitlab_importer_v2/packagist/symfony/security-http/GMS-2021-130
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/symfony/security-http/GMS-2021-130.yml
aliases:
  - GHSA-g2qj-pmxm-9f8f
  - GMS-2021-130
summary: |
  User enumeration in authentication mechanisms
  Description
  -----------

  The ability to enumerate users was possible without relevant permissions due to different exception messages depending on whether the user existed or not. It was also possible to enumerate users by using a timing attack, by comparing time elapsed when authenticating an existing user and authenticating a non-existing user.

  Resolution
  ----------

  We now ensure that 403s are returned whether the user exists or not if the password is invalid or if the user does not exist.

  The patch for this issue is available [here](https://github.com/symfony/symfony/commit/2a581d22cc621b33d5464ed65c4bc2057f72f011) for branch 3.4.

  Credits
  -------

  I would like to thank James Isaac and Mathias Brodala for reporting the issue and Robin Chalas for fixing the issue.
impacted_packages:
  - purl: pkg:composer/symfony/security-http
    affected_versions: vers:composer/>=5.1.0|<5.2.8
    fixed_versions: vers:composer/5.2.8
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/symfony/symfony/commit/2a581d22cc621b33d5464ed65c4bc2057f72f011
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/security/advisories/GHSA-g2qj-pmxm-9f8f
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-g2qj-pmxm-9f8f
    reference_type:
    reference_id: GHSA-g2qj-pmxm-9f8f
