advisory_id: packagist/symfony/ux-autocomplete/CVE-2023-41336
datasource_id: gitlab_importer_v2/packagist/symfony/ux-autocomplete/CVE-2023-41336
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/symfony/ux-autocomplete/CVE-2023-41336.yml
aliases:
  - CVE-2023-41336
  - GHSA-4cpv-669c-r79x
summary: |
  Prevent injection of invalid entity ids for "autocomplete" fields
  ### Impact
  Under certain circumstances, an attacker could successfully submit an entity id for an `EntityType` that is *not* part of the valid choices.

  Affected applications are any that use:

  * A custom `query_builder` option to limit the valid results;
  AND
  * An `EntityType` with `'autocomplete' => true` or a custom [AsEntityAutocompleteField](https://symfony.com/bundles/ux-autocomplete/current/index.html#usage-in-a-form-with-ajax).

  Under this circumstance, if an id is submitted, it is accepted even if the matching record would not be returned by the custom query built with `query_builder`.

  ### Patches

  The problem has been fixed in `symfony/ux-autocomplete` version 2.11.2.

  ### Workarounds
  Upgrade to version 2.11.2 or greater of `symfony/ux-autocomplete` or perform extra validation after submit to verify the selected option is valid.
impacted_packages:
  - purl: pkg:composer/symfony/ux-autocomplete
    affected_versions: vers:composer/<2.11.2
    fixed_versions: vers:composer/2.11.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/symfony/ux-autocomplete/CVE-2023-41336.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/ux-autocomplete/CVE-2023-41336.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/ux-autocomplete/commit/fabcb2eee14b9e84a45b276711853a560b5d770c
    reference_type:
    reference_id:
  - url: https://github.com/symfony/ux-autocomplete/security/advisories/GHSA-4cpv-669c-r79x
    reference_type:
    reference_id:
  - url: https://symfony.com/bundles/ux-autocomplete/current/index.html#usage-in-a-form-with-ajax
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41336
    reference_type:
    reference_id: CVE-2023-41336
  - url: https://github.com/advisories/GHSA-4cpv-669c-r79x
    reference_type:
    reference_id: GHSA-4cpv-669c-r79x
