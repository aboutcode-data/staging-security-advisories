advisory_id: packagist/symfony/translation/GHSA-f75p-x5vm-83qp
datasource_id: gitlab_importer_v2/packagist/symfony/translation/GHSA-f75p-x5vm-83qp
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/symfony/translation/GHSA-f75p-x5vm-83qp.yml
aliases:
  - GHSA-f75p-x5vm-83qp
summary: |
  symfony/translation XML Entity Expansion vulnerability
  Symfony 2.0.11 carried a [similar] XXE security fix, however, on review of ZF2 I also noted a vulnerability to XML Entity Expansion (XEE) attacks whereby all extensions making use of libxml2 have no defense against XEE Quadratic Blowup Attacks. The vulnerability is a function of there being no current method of disabling custom entities in PHP (i.e. defined internal to the XML document without using external entities). In a QBA, a long entity can be defined and then referred to multiple times in document elements, creating a memory sink with which Denial Of Service attacks against a host's RAM can be mounted. The use of the LIBXML_NOENT or equivalent option in a dependent extension amplified the impact (it doesn't actually mean "No Entities"). In addition, libxml2's innate defense against the related Exponential or Billion Laugh's XEE attacks is active only so long as the LIBXML_PARSEHUGE is NOT set (it disables libxml2's hardcoded entity recursion limit). No instances of these two options were noted, but it's worth referencing for the future.
impacted_packages:
  - purl: pkg:composer/symfony/translation
    affected_versions: vers:composer/>=2.0.0|<2.0.17
    fixed_versions: vers:composer/2.0.17
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/symfony/translation/GHSA-f75p-x5vm-83qp.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-776
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/translation/2012-08-28.yaml
    reference_type:
    reference_id:
  - url: https://github.com/symfony/translation
    reference_type:
    reference_id:
  - url: https://github.com/symfony/translation/commit/178b3eba474a706f25473d38e23e74b048417c8d
    reference_type:
    reference_id:
  - url: https://symfony.com/blog/security-release-symfony-2-0-17-released
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-f75p-x5vm-83qp
    reference_type:
    reference_id: GHSA-f75p-x5vm-83qp
