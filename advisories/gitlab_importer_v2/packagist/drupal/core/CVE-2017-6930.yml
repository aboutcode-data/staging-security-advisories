advisory_id: packagist/drupal/core/CVE-2017-6930
datasource_id: gitlab_importer_v2/packagist/drupal/core/CVE-2017-6930
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/drupal/core/CVE-2017-6930.yml
aliases:
  - CVE-2017-6930
summary: |
  Language fallback can be incorrect on multilingual sites with node access restrictions
  When using node access controls with a multilingual site, Drupal marks the untranslated version of a node as the default fallback for access queries. This fallback is used for languages that do not yet have a translated version of the created node. This can result in an access bypass vulnerability. This issue is mitigated by the fact that it only applies to sites that a) use the Content Translation module; and b) use a node access module such as Domain Access which implement hook_node_access_records(). Note that the update will mark the node access tables as needing a rebuild, which will take a long time on sites with a large number of nodes.
impacted_packages:
  - purl: pkg:composer/drupal/core
    affected_versions: vers:composer/<8.4.5
    fixed_versions: vers:composer/8.4.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/drupal/core/CVE-2017-6930.yml
  - score:
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/drupal/core/CVE-2017-6930.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://www.drupal.org/SA-CORE-2018-001
    reference_type:
    reference_id:
  - url: http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-6930
    reference_type:
    reference_id:
