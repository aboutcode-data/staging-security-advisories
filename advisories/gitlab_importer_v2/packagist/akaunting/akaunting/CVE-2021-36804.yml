advisory_id: packagist/akaunting/akaunting/CVE-2021-36804
datasource_id: gitlab_importer_v2/packagist/akaunting/akaunting/CVE-2021-36804
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/akaunting/akaunting/CVE-2021-36804.yml
aliases:
  - CVE-2021-36804
  - GHSA-246r-r2wf-frhx
summary: |
  Weak Password Recovery Mechanism for Forgotten Password
  Akaunting version 2.1.12 and earlier suffers from a password reset spoofing vulnerability, wherein an attacker can proxy password reset requests through a running Akaunting instance, if that attacker knows the target's e-mail address. This issue was fixed in version 2.1.13 of the product. Please note that this issue is ultimately caused by the defaults provided by the Laravel framework, specifically how proxy headers are handled with respect to multi-tenant implementations. In other words, while this is not technically a vulnerability in Laravel, this default configuration is very likely to lead to practically identical identical vulnerabilities in Laravel projects that implement multi-tenant applications.
impacted_packages:
  - purl: pkg:composer/akaunting/akaunting
    affected_versions: vers:composer/<2.1.13
    fixed_versions: vers:composer/2.1.13
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/akaunting/akaunting/CVE-2021-36804.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/packagist/akaunting/akaunting/CVE-2021-36804.yml
weaknesses:
  - CWE-640
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/laravel/laravel/blob/75a7dba9c44ce3555cc57dd1826467839fd9774f/CHANGELOG.md#v844-2020-12-01
    reference_type:
    reference_id:
  - url: https://github.com/laravel/laravel/pull/5477
    reference_type:
    reference_id:
  - url: https://www.laravel-enlightn.com/docs/security/host-injection-analyzer.html
    reference_type:
    reference_id:
  - url: https://www.rapid7.com/blog/post/2021/07/27/multiple-open-source-web-app-vulnerabilities-fixed/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-36804
    reference_type:
    reference_id: CVE-2021-36804
  - url: https://github.com/advisories/GHSA-246r-r2wf-frhx
    reference_type:
    reference_id: GHSA-246r-r2wf-frhx
