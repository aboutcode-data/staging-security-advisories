advisory_id: gem/mechanize/CVE-2022-31033
datasource_id: gitlab_importer_v2/gem/mechanize/CVE-2022-31033
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/mechanize/CVE-2022-31033.yml
aliases:
  - CVE-2022-31033
  - GHSA-64qm-hrgp-pgr9
summary: |
  Authorization header leak on port redirect in mechanize
  The Mechanize library is used for automating interaction with websites. Mechanize automatically stores and sends cookies, follows redirects, and can follow links and submit forms. In versions prior to 2.8.5 the Authorization header is leaked after a redirect to a different port on the same site. Users are advised to upgrade to Mechanize v2.8.5 or later. There are no known workarounds for this issue.
impacted_packages:
  - purl: pkg:gem/mechanize
    affected_versions: vers:gem/<2.8.5
    fixed_versions: vers:gem/2.8.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/mechanize/CVE-2022-31033.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/mechanize/CVE-2022-31033.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/sparklemotion/mechanize/security/advisories/GHSA-64qm-hrgp-pgr9
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-64qm-hrgp-pgr9
    reference_type:
    reference_id: GHSA-64qm-hrgp-pgr9
