advisory_id: gem/bundler/CVE-2021-43809
datasource_id: gitlab_importer_v2/gem/bundler/CVE-2021-43809
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/bundler/CVE-2021-43809.yml
aliases:
  - CVE-2021-43809
  - GHSA-fj7f-vq84-fh43
summary: |
  Local Code Execution through Argument Injection via dash leading git url parameter in Gemfile.
  In `bundler` versions before 2.2.33, when working with untrusted and apparently harmless `Gemfile`'s, it is not expected that they lead to execution of external code, unless that's explicit in the ruby code inside the `Gemfile` itself. However, if the `Gemfile` includes `gem` entries that use the `git` option with invalid, but seemingly harmless, values with a leading dash, this can be false.

  To handle dependencies that come from a Git repository instead of a registry, Bundler uses various commands, such as `git clone`. These commands are being constructed using user input (e.g. the repository URL). When building the
  commands, Bundler versions before 2.2.33 correctly avoid Command Injection vulnerabilities by passing an array of arguments instead of a command string. However, there is the possibility that a user input starts with a dash (`-`) and is therefore treated as an optional argument instead of a positional one. This can lead to Code Execution because some of the commands have options that can be leveraged to run arbitrary executables.

  Since this value comes from the `Gemfile` file, it can contain any character, including a leading dash.
impacted_packages:
  - purl: pkg:gem/bundler
    affected_versions: vers:gem/<2.2.33
    fixed_versions: vers:gem/2.2.33
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/bundler/CVE-2021-43809.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/bundler/CVE-2021-43809.yml
weaknesses:
  - CWE-1035
  - CWE-88
  - CWE-937
references:
  - url: https://github.com/rubygems/rubygems
    reference_type:
    reference_id:
  - url: https://github.com/rubygems/rubygems/commit/0fad1ccfe9dd7a3c5b82c1496df3c2b4842870d3
    reference_type:
    reference_id:
  - url: https://github.com/rubygems/rubygems/commit/a4f2f8ac17e6ce81c689527a8b6f14381060d95f
    reference_type:
    reference_id:
  - url: https://github.com/rubygems/rubygems/pull/5142
    reference_type:
    reference_id:
  - url: https://github.com/rubygems/rubygems/security/advisories/GHSA-fj7f-vq84-fh43
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/bundler/CVE-2021-43809.yml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00015.html
    reference_type:
    reference_id:
  - url: https://www.sonarsource.com/blog/securing-developer-tools-package-managers
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43809
    reference_type:
    reference_id: CVE-2021-43809
  - url: https://github.com/advisories/GHSA-fj7f-vq84-fh43
    reference_type:
    reference_id: GHSA-fj7f-vq84-fh43
