advisory_id: gem/activerecord/CVE-2022-32224
datasource_id: gitlab_importer_v2/gem/activerecord/CVE-2022-32224
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/activerecord/CVE-2022-32224.yml
aliases:
  - CVE-2022-32224
  - GHSA-3hhc-qp5v-9p2j
  - GMS-2022-3029
summary: |
  Deserialization of Untrusted Data
  A possible escalation to RCE vulnerability exists when using YAML serialized columns in Active Record < 7.0.3.1, <6.1.6.1, <6.0.5.1 and <5.2.8.1 which could allow an attacker, that can manipulate data in the database (via means like SQL injection), the ability to escalate to an RCE.
impacted_packages:
  - purl: pkg:gem/activerecord
    affected_versions: vers:gem/<5.2.8.1|>=6.0.0|<6.0.5.1|>=6.1.0|<6.1.6.1|>=7.0.0|<7.0.3.1
    fixed_versions: vers:gem/5.2.8.1|6.0.5.1|6.1.6.1|7.0.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/activerecord/CVE-2022-32224.yml
weaknesses:
  - CWE-1035
  - CWE-502
  - CWE-937
references:
  - url: https://discuss.rubyonrails.org/t/cve-2022-32224-possible-rce-escalation-bug-with-serialized-columns-in-active-record/81017
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-3hhc-qp5v-9p2j
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/611990f1a6c137c2d56b1ba06b27e5d2434dcd6a
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activerecord/CVE-2022-32224.yml
    reference_type:
    reference_id:
  - url: https://groups.google.com/g/rubyonrails-security/c/MmFO3LYQE8U
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-32224
    reference_type:
    reference_id: CVE-2022-32224
