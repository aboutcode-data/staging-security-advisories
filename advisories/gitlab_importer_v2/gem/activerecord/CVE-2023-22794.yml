advisory_id: gem/activerecord/CVE-2023-22794
datasource_id: gitlab_importer_v2/gem/activerecord/CVE-2023-22794
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/activerecord/CVE-2023-22794.yml
aliases:
  - CVE-2023-22794
  - GHSA-hq7p-j377-6v63
  - GMS-2023-60
summary: |
  Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  A vulnerability in ActiveRecord <6.0.6.1, v6.1.7.1 and v7.0.4.1 related to the sanitization of comments. If malicious user input is passed to either the `annotate` query method, the `optimizer_hints` query method, or through the QueryLogs interface which automatically adds annotations, it may be sent to the database with insufficient sanitization and be able to inject SQL outside of the comment.
impacted_packages:
  - purl: pkg:gem/activerecord
    affected_versions: vers:gem/>=6.0.0|<6.0.6.1|>=6.1.0|<6.1.7.1|>=7.0.0|<7.0.4.1
    fixed_versions: vers:gem/6.0.6.1|6.1.7.1|7.0.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/activerecord/CVE-2023-22794.yml
weaknesses:
  - CWE-89
  - CWE-1035
  - CWE-937
references:
  - url: https://discuss.rubyonrails.org/t/cve-2023-22794-sql-injection-vulnerability-via-activerecord-comments/82117
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/releases/tag/v7.0.4.1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-22794
    reference_type:
    reference_id: CVE-2023-22794
  - url: https://github.com/advisories/GHSA-hq7p-j377-6v63
    reference_type:
    reference_id: GHSA-hq7p-j377-6v63
