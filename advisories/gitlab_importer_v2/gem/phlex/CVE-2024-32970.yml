advisory_id: gem/phlex/CVE-2024-32970
datasource_id: gitlab_importer_v2/gem/phlex/CVE-2024-32970
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/phlex/CVE-2024-32970.yml
aliases:
  - CVE-2024-32970
  - GHSA-9p57-h987-4vgx
summary: |
  Phlex vulnerable to Cross-site Scripting (XSS) via maliciously formed HTML attribute names and values
  There is a potential cross-site scripting (XSS) vulnerability that can be exploited via maliciously crafted user data.

  The reason these issues were not detected before is the escapes were working as designed. However, their design didn't take into account just how recklessly permissive browser are when it comes to executing unsafe JavaScript via HTML attributes.
impacted_packages:
  - purl: pkg:gem/phlex
    affected_versions: vers:gem/<1.9.3|>=1.10.0|<1.10.2
    fixed_versions: vers:gem/1.9.3|1.10.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/phlex/CVE-2024-32970.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy
    reference_type:
    reference_id:
  - url: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline
    reference_type:
    reference_id:
  - url: https://github.com/payloadbox/xss-payload-list
    reference_type:
    reference_id:
  - url: https://github.com/phlex-ruby/phlex
    reference_type:
    reference_id:
  - url: https://github.com/phlex-ruby/phlex/commit/da8f94342a84cff9d78c98bcc3b3604ee2e577d2
    reference_type:
    reference_id:
  - url: https://github.com/phlex-ruby/phlex/security/advisories/GHSA-9p57-h987-4vgx
    reference_type:
    reference_id:
  - url: https://rubygems.org/gems/phlex
    reference_type:
    reference_id:
  - url: https://rubygems.org/gems/phlex/versions/1.10.2
    reference_type:
    reference_id:
  - url: https://rubygems.org/gems/phlex/versions/1.9.3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32970
    reference_type:
    reference_id: CVE-2024-32970
  - url: https://github.com/advisories/GHSA-9p57-h987-4vgx
    reference_type:
    reference_id: GHSA-9p57-h987-4vgx
