advisory_id: gem/activeadmin/CVE-2024-37031
datasource_id: gitlab_importer_v2/gem/activeadmin/CVE-2024-37031
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/activeadmin/CVE-2024-37031.yml
aliases:
  - CVE-2024-37031
  - GHSA-9mg6-x45v-hcfm
summary: |
  activeadmin vulnerable to stored persistent cross-site scripting (XSS) in dynamic form legends
  Users settings their active admin form legends dynamically may be vulnerable to stored XSS, as long as its value can be injected directly by a malicious user.

  For example:

  * A public web application allows users to create entities with arbitrary names.
  * Active Admin is used to administrate these entities through a private backend.
  * The form to edit these entities in the private backend has the following shape (note the dynamic `name` value dependent on an attribute of the `resource`):

  ```ruby
  form do |f|
  f.inputs name: resource.name do
  f.input :name
  f.input :description
  end

  f.actions
  end
  ```

  Then a malicious user could create an entity with a payload that would get executed in the active admin administrator's browser.

  Both `form` blocks with an implicit or explicit name (i.e., both `form resource.name` or `form name: resource.name` would suffer from the problem), where the value of the name can be arbitrarily set by non admin users.
impacted_packages:
  - purl: pkg:gem/activeadmin
    affected_versions: vers:gem/<3.2.2|>=4.0.0.beta1|<4.0.0.beta7
    fixed_versions: vers:gem/3.2.2|4.0.0.beta7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/activeadmin/CVE-2024-37031.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/activeadmin/activeadmin
    reference_type:
    reference_id:
  - url: https://github.com/activeadmin/activeadmin/pull/8349
    reference_type:
    reference_id:
  - url: https://github.com/activeadmin/activeadmin/releases/tag/v3.2.2
    reference_type:
    reference_id:
  - url: https://github.com/activeadmin/activeadmin/security/advisories/GHSA-9mg6-x45v-hcfm
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activeadmin/CVE-2024-37031.yml
    reference_type:
    reference_id:
  - url: https://rubygems.org/gems/activeadmin/versions/3.2.2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37031
    reference_type:
    reference_id: CVE-2024-37031
  - url: https://github.com/advisories/GHSA-9mg6-x45v-hcfm
    reference_type:
    reference_id: GHSA-9mg6-x45v-hcfm
