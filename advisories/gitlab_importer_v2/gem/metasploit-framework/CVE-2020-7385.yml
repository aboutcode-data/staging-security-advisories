advisory_id: gem/metasploit-framework/CVE-2020-7385
datasource_id: gitlab_importer_v2/gem/metasploit-framework/CVE-2020-7385
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/metasploit-framework/CVE-2020-7385.yml
aliases:
  - CVE-2020-7385
  - GHSA-xgww-h98f-24qf
summary: |
  Deserialization of Untrusted Data
  By launching the drb_remote_codeexec exploit, a Metasploit Framework user will inadvertently expose Metasploit to the same deserialization issue that is exploited by that module, due to the reliance on the vulnerable Distributed Ruby class functions. Since Metasploit Framework typically runs with elevated privileges, this can lead to a system compromise on the Metasploit workstation. Note that an attacker would have to lie in wait and entice the Metasploit user to run the affected module against a malicious endpoint in a "hack-back" type of attack. Metasploit is only vulnerable when the drb_remote_codeexec module is running. In most cases, this cannot happen automatically.
impacted_packages:
  - purl: pkg:gem/metasploit-framework
    affected_versions: vers:gem/<4.19.0
    fixed_versions: vers:gem/4.19.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/metasploit-framework/CVE-2020-7385.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/metasploit-framework/CVE-2020-7385.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-502
  - CWE-78
references:
  - url: https://github.com/rapid7/metasploit-framework/pull/14300
    reference_type:
    reference_id:
  - url: https://github.com/rapid7/metasploit-framework/pull/14335
    reference_type:
    reference_id:
  - url: https://help.rapid7.com/metasploit/release-notes/archive/2020/10/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-7385
    reference_type:
    reference_id: CVE-2020-7385
  - url: https://github.com/advisories/GHSA-xgww-h98f-24qf
    reference_type:
    reference_id: GHSA-xgww-h98f-24qf
