advisory_id: gem/nokogiri/CVE-2021-41098
datasource_id: gitlab_importer_v2/gem/nokogiri/CVE-2021-41098
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/nokogiri/CVE-2021-41098.yml
aliases:
  - CVE-2021-41098
  - GHSA-2rr5-8q37-2w7h
summary: |
  Improper Restriction of XML External Entity Reference
  Nokogiri is a Rubygem providing HTML, XML, SAX, and Reader parsers with XPath and CSS selector support. In Nokogiri v1.12.4, on JRuby only, the SAX parser resolves external entities by default. Users of Nokogiri on JRuby who parse untrusted documents using any of these classes are affected: Nokogiri::XML::SAX::Parse, Nokogiri::HTML4::SAX::Parser or its alias Nokogiri::HTML::SAX::Parser, Nokogiri::XML::SAX::PushParser, and Nokogiri::HTML4::SAX::PushParser or its alias Nokogiri::HTML::SAX::PushParser. JRuby users should upgrade to Nokogiri.
impacted_packages:
  - purl: pkg:gem/nokogiri
    affected_versions: vers:gem/<1.12.5
    fixed_versions: vers:gem/1.12.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/nokogiri/CVE-2021-41098.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/nokogiri/CVE-2021-41098.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41098
    reference_type:
    reference_id: CVE-2021-41098
