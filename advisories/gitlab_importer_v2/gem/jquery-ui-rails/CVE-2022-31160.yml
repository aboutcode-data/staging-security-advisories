advisory_id: gem/jquery-ui-rails/CVE-2022-31160
datasource_id: gitlab_importer_v2/gem/jquery-ui-rails/CVE-2022-31160
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/jquery-ui-rails/CVE-2022-31160.yml
aliases:
  - CVE-2022-31160
  - GHSA-h6gj-6jjq-h8g9
summary: |
  jQuery UI vulnerable to XSS when refreshing a checkboxradio with an HTML-like initial text label
  Initializing a checkboxradio widget on an input enclosed within a label makes that parent label contents considered as the input label. If you call `.checkboxradio( "refresh" )` on such a widget and the initial HTML contained encoded HTML entities, they will erroneously get decoded. This can lead to potentially executing JavaScript code.

  For example, starting with the following initial secure HTML:
  ```html
  <label>
  <input id="test-input">
  &lt;img src=x onerror="alert(1)"&gt;
  </label>
  ```
  and calling:
  ```js
  $( "#test-input" ).checkboxradio();
  $( "#test-input" ).checkboxradio( "refresh" );
  ```
  will turn the initial HTML into:
  ```html
  <label>
  <!-- some jQuery UI elements -->
  <input id="test-input">
  <img src=x onerror="alert(1)">
  </label>
  ```
  and the alert will get executed.
impacted_packages:
  - purl: pkg:gem/jquery-ui-rails
    affected_versions: vers:gem/<8.0.0
    fixed_versions: vers:gem/8.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/jquery-ui-rails/CVE-2022-31160.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://blog.jqueryui.com/2022/07/jquery-ui-1-13-2-released
    reference_type:
    reference_id:
  - url: https://github.com/jquery/jquery-ui
    reference_type:
    reference_id:
  - url: https://github.com/jquery/jquery-ui/commit/8cc5bae1caa1fcf96bf5862c5646c787020ba3f9
    reference_type:
    reference_id:
  - url: https://github.com/jquery/jquery-ui/security/advisories/GHSA-h6gj-6jjq-h8g9
    reference_type:
    reference_id:
  - url: https://github.com/jquery-ui-rails/jquery-ui-rails/blob/master/VERSIONS.md
    reference_type:
    reference_id:
  - url: https://github.com/jquery-ui-rails/jquery-ui-rails/releases/tag/v8.0.0-release
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/jquery-ui-rails/CVE-2022-31160.yml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/12/msg00015.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6XBR3G3JR5ZIOJDO4224M3INXDS2VFDD
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/J5LGNTICB5BRFAG3DHVVELS6H3CZSQMO
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QB2FJQXCNHO32VGVOC6DY6IPGVE4VDU6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31160
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220909-0007
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-contrib-2022-052
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-h6gj-6jjq-h8g9
    reference_type:
    reference_id: GHSA-h6gj-6jjq-h8g9
