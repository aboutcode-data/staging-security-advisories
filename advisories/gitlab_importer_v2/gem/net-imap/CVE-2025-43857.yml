advisory_id: gem/net-imap/CVE-2025-43857
datasource_id: gitlab_importer_v2/gem/net-imap/CVE-2025-43857
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/net-imap/CVE-2025-43857.yml
aliases:
  - CVE-2025-43857
  - GHSA-j3g3-5qv5-52mj
summary: |
  net-imap rubygem vulnerable to possible DoS by memory exhaustion
  There is a possibility for denial of service by memory exhaustion when `net-imap` reads server responses.  At any time while the client is connected, a malicious server can send can send a "literal" byte count, which is automatically read by the client's receiver thread.  The response reader immediately allocates memory for the number of bytes indicated by the server response.

  This should not be an issue when securely connecting to trusted IMAP servers that are well-behaved.  It can affect insecure connections and buggy, untrusted, or compromised servers (for example, connecting to a user supplied hostname).
impacted_packages:
  - purl: pkg:gem/net-imap
    affected_versions: vers:gem/<0.2.5|>=0.3.0|<0.3.9|>=0.4.0|<0.4.20|>=0.5.0|<0.5.7
    fixed_versions: vers:gem/0.2.5|0.3.9|0.4.20|0.5.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/net-imap/CVE-2025-43857.yml
weaknesses:
  - CWE-770
  - CWE-789
  - CWE-400
  - CWE-405
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/ruby/net-imap
    reference_type:
    reference_id:
  - url: https://github.com/ruby/net-imap/pull/442
    reference_type:
    reference_id:
  - url: https://github.com/ruby/net-imap/pull/444
    reference_type:
    reference_id:
  - url: https://github.com/ruby/net-imap/pull/444/commits/0ae8576c1a90bcd9573f81bdad4b4b824642d105#diff-53721cb4d9c3fb86b95cc8476ca2df90968ad8c481645220c607034399151462
    reference_type:
    reference_id:
  - url: https://github.com/ruby/net-imap/pull/445
    reference_type:
    reference_id:
  - url: https://github.com/ruby/net-imap/pull/446
    reference_type:
    reference_id:
  - url: https://github.com/ruby/net-imap/pull/447
    reference_type:
    reference_id:
  - url: https://github.com/ruby/net-imap/security/advisories/GHSA-j3g3-5qv5-52mj
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/net-imap/CVE-2025-43857.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-43857
    reference_type:
    reference_id: CVE-2025-43857
  - url: https://github.com/advisories/GHSA-j3g3-5qv5-52mj
    reference_type:
    reference_id: GHSA-j3g3-5qv5-52mj
