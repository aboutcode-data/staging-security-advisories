advisory_id: gem/encoded_id-rails/CVE-2024-0241
datasource_id: gitlab_importer_v2/gem/encoded_id-rails/CVE-2024-0241
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/encoded_id-rails/CVE-2024-0241.yml
aliases:
  - CVE-2024-0241
  - GHSA-3px7-jm2p-6h2c
summary: |
  encoded_id-rails potential DOS vulnerability due to URIs with extremely long encoded IDs
  The length of URIs and the various parts (eg path segments, query parameters) is usually limited by the webserver processing the incoming request. In the case of Puma the defaults are :

  - path segment length: 8192
  - Max URI length: 1024 * 12
  - Max query length: 1024 * 10

  See https://github.com/puma/puma/blob/master/docs/compile_options.md

  If too long Puma raises:
  > Puma caught this error: HTTP element REQUEST_PATH is longer than the (8192) allowed length (was 12503) (Puma::HttpParserError)

  However due to the performance of `hashids` extremely long encoded IDs will consume a large amount of CPU and allocate a huge number of intermediate objects.

  For example:
impacted_packages:
  - purl: pkg:gem/encoded_id-rails
    affected_versions: vers:gem/<1.0.0.beta2
    fixed_versions: vers:gem/1.0.0.beta2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/encoded_id-rails/CVE-2024-0241.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-400
references:
  - url: https://github.com/advisories/GHSA-3px7-jm2p-6h2c
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/encoded_id-rails/CVE-2024-0241.yml
    reference_type:
    reference_id:
  - url: https://github.com/stevegeek/encoded_id-rails
    reference_type:
    reference_id:
  - url: https://github.com/stevegeek/encoded_id-rails/commit/afa495a77b8a21ad582611f9cdc2081dc4018b91
    reference_type:
    reference_id:
  - url: https://github.com/stevegeek/encoded_id-rails/security/advisories/GHSA-3px7-jm2p-6h2c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-0241
    reference_type:
    reference_id: CVE-2024-0241
