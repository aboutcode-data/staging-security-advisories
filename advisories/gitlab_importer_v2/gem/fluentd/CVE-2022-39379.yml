advisory_id: gem/fluentd/CVE-2022-39379
datasource_id: gitlab_importer_v2/gem/fluentd/CVE-2022-39379
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/fluentd/CVE-2022-39379.yml
aliases:
  - CVE-2022-39379
  - GHSA-fppq-mj76-fpj2
summary: |
  Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  Fluentd collects events from various data sources and writes them to files, RDBMS, NoSQL, IaaS, SaaS, Hadoop and so on. A remote code execution (RCE) vulnerability in non-default configurations of Fluentd allows unauthenticated attackers to execute arbitrary code via specially crafted JSON payloads. Fluentd setups are only affected if the environment variable `FLUENT_OJ_OPTION_MODE` is explicitly set to `object`. Please note: The option FLUENT_OJ_OPTION_MODE was introduced in Fluentd version 1.13.2. Earlier versions of Fluentd are not affected by this vulnerability. This issue was patched in version 1.15.3. As a workaround do not use `FLUENT_OJ_OPTION_MODE=object`.
impacted_packages:
  - purl: pkg:gem/fluentd
    affected_versions: vers:gem/>=1.13.2|<1.15.3
    fixed_versions: vers:gem/1.15.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/fluentd/CVE-2022-39379.yml
weaknesses:
  - CWE-1035
  - CWE-502
  - CWE-937
references:
  - url: https://github.com/fluent/fluentd/commit/48e5b85dab1b6d4c273090d538fc11b3f2fd8135
    reference_type:
    reference_id:
  - url: https://github.com/fluent/fluentd/security/advisories/GHSA-fppq-mj76-fpj2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39379
    reference_type:
    reference_id: CVE-2022-39379
  - url: https://github.com/advisories/GHSA-fppq-mj76-fpj2
    reference_type:
    reference_id: GHSA-fppq-mj76-fpj2
