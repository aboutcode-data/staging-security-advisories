advisory_id: gem/govuk_tech_docs/CVE-2024-22048
datasource_id: gitlab_importer_v2/gem/govuk_tech_docs/CVE-2024-22048
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/govuk_tech_docs/CVE-2024-22048.yml
aliases:
  - CVE-2024-22048
  - GHSA-x2xw-hw8g-6773
summary: |
  govuk_tech_docs vulnerable to unescaped HTML on search results page
  Pages that are indexed in search results have their entire contents indexed, including any HTML code snippets. These HTML snippets would appear in the search results unsanitised, so it was possible to render arbitrary HTML or run arbitrary scripts.

  This is a low risk security issue; to exploit it, an attacker would need to find a way of committing malicious code to a page indexed by a site that uses tech-docs-gem (which are typically not editable by untrusted users). Their code would also be limited by the relatively short length that's rendered in the corresponding search result. Nevertheless, the XSS would then be triggerable by visiting a pre-constructed URL (/search/index.html?q=some+search+term), which users could be tricked into clicking on through social engineering.
impacted_packages:
  - purl: pkg:gem/govuk_tech_docs
    affected_versions: vers:gem/>=2.0.2|<3.3.1
    fixed_versions: vers:gem/3.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/govuk_tech_docs/CVE-2024-22048.yml
weaknesses:
  - CWE-80
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/advisories/GHSA-x2xw-hw8g-6773
    reference_type:
    reference_id:
  - url: https://github.com/alphagov/tech-docs-gem
    reference_type:
    reference_id:
  - url: https://github.com/alphagov/tech-docs-gem/commit/a51c7058cec46bf2a4e25a1da62b14ac3fd46b53
    reference_type:
    reference_id:
  - url: https://github.com/alphagov/tech-docs-gem/pull/323
    reference_type:
    reference_id:
  - url: https://github.com/alphagov/tech-docs-gem/releases/tag/v3.3.1
    reference_type:
    reference_id:
  - url: https://github.com/alphagov/tech-docs-gem/security/advisories/GHSA-x2xw-hw8g-6773
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/govuk_tech_docs/CVE-2024-22048.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22048
    reference_type:
    reference_id: CVE-2024-22048
