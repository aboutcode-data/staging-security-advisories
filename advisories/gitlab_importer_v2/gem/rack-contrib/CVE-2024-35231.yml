advisory_id: gem/rack-contrib/CVE-2024-35231
datasource_id: gitlab_importer_v2/gem/rack-contrib/CVE-2024-35231
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/rack-contrib/CVE-2024-35231.yml
aliases:
  - CVE-2024-35231
  - GHSA-8c8q-2xw3-j869
summary: |
  rack-contrib vulnerable to Denial of Service due to the unconstrained value of the incoming "profiler_runs" parameter
  The next ruby code is vulnerable to denial of service due to the fact that the user controlled data `profiler_runs` was not contrained to any limitation. Which would lead to allocating resources on the server side with no limitation (CWE-770).

  ```ruby
  runs = (request.params['profiler_runs'] || @times).to_i
  result = @profile.profile do
  runs.times { @app.call(env) }
  end
  ```

  An exploit as such `curl --fail "http://127.0.0.1:9292/?profiler_runs=9999999999&profile=process_time"` may cause resource exhaution by a remotely controlled value.
impacted_packages:
  - purl: pkg:gem/rack-contrib
    affected_versions: vers:gem/<2.5.0
    fixed_versions: vers:gem/2.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/rack-contrib/CVE-2024-35231.yml
weaknesses:
  - CWE-770
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/rack/rack-contrib
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack-contrib/commit/0eec2a9836329051c6742549e65a94a4c24fe6f7
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack-contrib/security/advisories/GHSA-8c8q-2xw3-j869
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35231
    reference_type:
    reference_id: CVE-2024-35231
  - url: https://github.com/advisories/GHSA-8c8q-2xw3-j869
    reference_type:
    reference_id: GHSA-8c8q-2xw3-j869
