advisory_id: gem/actionpack/CVE-2024-54133
datasource_id: gitlab_importer_v2/gem/actionpack/CVE-2024-54133
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/actionpack/CVE-2024-54133.yml
aliases:
  - CVE-2024-54133
  - GHSA-vfm5-rmrh-j26v
summary: |
  Possible Content Security Policy bypass in Action Dispatch
  There is a possible Cross Site Scripting (XSS) vulnerability  in the `content_security_policy` helper in Action Pack.

  Impact
  ------
  Applications which set Content-Security-Policy (CSP) headers dynamically from untrusted user input may be vulnerable to carefully crafted inputs being able to inject new directives into the CSP. This could lead to a bypass of the CSP and its protection against XSS and other attacks.

  Releases
  --------
  The fixed releases are available at the normal locations.

  Workarounds
  -----------
  Applications can avoid setting CSP headers dynamically from untrusted input, or can validate/sanitize that input.

  Credits
  -------
  Thanks to [ryotak](https://hackerone.com/ryotak) for the report!
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=5.2.0|<7.0.8.7|>=7.1.0|<7.1.5.1|>=7.2.0|<7.2.2.1|>=8.0.0|<8.0.0.1
    fixed_versions: vers:gem/7.0.8.7|7.1.5.1|7.2.2.1|8.0.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/actionpack/CVE-2024-54133.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/rails/rails
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/2e3f41e4538b9ca1044357f6644f037bbb7c6c49
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/3da2479cfe1e00177114b17e496213c40d286b3a
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/5558e72f22fc69c1c407b31ac5fb3b4ce087b542
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/cb16a3bb515b5d769f73926d9757270ace691f1d
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/security/advisories/GHSA-vfm5-rmrh-j26v
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-54133.yml
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20250306-0010
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-54133
    reference_type:
    reference_id: CVE-2024-54133
  - url: https://github.com/advisories/GHSA-vfm5-rmrh-j26v
    reference_type:
    reference_id: GHSA-vfm5-rmrh-j26v
