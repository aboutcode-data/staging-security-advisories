advisory_id: gem/actionpack/CVE-2022-23633
datasource_id: gitlab_importer_v2/gem/actionpack/CVE-2022-23633
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/actionpack/CVE-2022-23633.yml
aliases:
  - CVE-2022-23633
  - GHSA-wh98-p28r-vrc9
summary: |
  Exposure of Sensitive Information to an Unauthorized Actor
  Action Pack is a framework for handling and responding to web requests. Under certain circumstances response bodies will not be closed. In the event a response is *not* notified of a `close`, `ActionDispatch::Executor` will not know to reset thread local state for the next request. This can lead to data being leaked to subsequent requests.This has been fixed in Rails 7.0.2.1, 6.1.4.5, 6.0.4.5, and 5.2.6.1. Upgrading is highly recommended, but to work around this problem a middleware described in GHSA-wh98-p28r-vrc9 can be used.
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=5.0.0.0|<=5.2.6.1|>=6.0.0.0|<=6.0.4.5|>=6.1.0.0|<=6.1.4.5|>=7.0.0.0|<=7.0.2.1
    fixed_versions: vers:gem/5.2.6.2|6.0.4.6|6.1.4.6|7.0.2.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/actionpack/CVE-2022-23633.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/actionpack/CVE-2022-23633.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://discuss.rubyonrails.org/t/cve-2022-23633-possible-exposure-of-information-vulnerability-in-action-pack/80016
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-wh98-p28r-vrc9
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/f9a2ad03943d5c2ba54e1d45f155442b519c75da
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/security/advisories/GHSA-wh98-p28r-vrc9
    reference_type:
    reference_id:
  - url: https://rubyonrails.org/2022/2/11/Rails-7-0-2-2-6-1-4-6-6-0-4-6-and-5-2-6-2-have-been-released
    reference_type:
    reference_id:
