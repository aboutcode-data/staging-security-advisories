advisory_id: gem/apollo_upload_server/CVE-2021-39880
datasource_id: gitlab_importer_v2/gem/apollo_upload_server/CVE-2021-39880
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/apollo_upload_server/CVE-2021-39880.yml
aliases:
  - CVE-2021-39880
  - GHSA-w6pv-c757-6rgr
summary: |
  apollo_upload_server has Denial of Service vulnerability
  A Denial Of Service vulnerability in the apollo_upload_server Ruby gem in GitLab CE/EE all versions starting from 11.9 before 14.0.9, all versions starting from 14.1 before 14.1.4, and all versions starting from 14.2 before 14.2.2 allows an attacker to deny access to all users via specially crafted requests to the apollo_upload_server middleware.
impacted_packages:
  - purl: pkg:gem/apollo_upload_server
    affected_versions: vers:gem/<2.1.0
    fixed_versions: vers:gem/2.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:N/I:N/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/apollo_upload_server/CVE-2021-39880.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/apollo_upload_server/CVE-2021-39880.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/jetruby/apollo_upload_server-ruby/commit/b0582c1a3e458eee3c994fb38278bd0221f20486
    reference_type:
    reference_id:
  - url: https://github.com/jetruby/apollo_upload_server-ruby/pull/44
    reference_type:
    reference_id:
  - url: https://github.com/jetruby/apollo_upload_server-ruby/releases/tag/2.1.0
    reference_type:
    reference_id:
  - url: https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-39880.json
    reference_type:
    reference_id:
  - url: https://gitlab.com/gitlab-org/gitlab/-/issues/330561
    reference_type:
    reference_id:
  - url: https://gitlab.com/gitlab-org/gitlab/-/issues/330561#note_642879964
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1181284
    reference_type:
    reference_id:
  - url: https://vuldb.com/?id.183842
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39880
    reference_type:
    reference_id: CVE-2021-39880
  - url: https://github.com/advisories/GHSA-w6pv-c757-6rgr
    reference_type:
    reference_id: GHSA-w6pv-c757-6rgr
