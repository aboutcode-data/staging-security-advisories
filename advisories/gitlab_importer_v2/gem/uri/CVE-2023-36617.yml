advisory_id: gem/uri/CVE-2023-36617
datasource_id: gitlab_importer_v2/gem/uri/CVE-2023-36617
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/uri/CVE-2023-36617.yml
aliases:
  - CVE-2023-36617
  - GHSA-hww2-5g85-429m
summary: |
  URI gem has ReDoS vulnerability
  A ReDoS issue was discovered in the URI component before 0.12.2 for Ruby. The URI parser mishandles invalid URLs that have specific characters. There is an increase in execution time for parsing strings to URI objects with `rfc2396_parser.rb` and `rfc3986_parser.rb`.

  NOTE: this issue exists becuse of an incomplete fix for CVE-2023-28755. Version 0.10.3 is also a fixed version.

  [The Ruby advisory recommends](https://www.ruby-lang.org/en/news/2023/06/29/redos-in-uri-CVE-2023-36617/) updating the uri gem to 0.12.2. In order to ensure compatibility with the bundled version in older Ruby series, you may update as follows instead:
  - For Ruby 3.0: Update to uri 0.10.3
  - For Ruby 3.1 and 3.2: Update to uri 0.12.2.

  You can use gem update uri to update it. If you are using bundler, please add gem `uri`, `>= 0.12.2` (or other version mentioned above) to your Gemfile.
impacted_packages:
  - purl: pkg:gem/uri
    affected_versions: vers:gem/<0.10.0.3|>=0.10.1|<0.10.3|>=0.11.0|<0.11.2|>=0.12.0|<0.12.2
    fixed_versions: vers:gem/0.10.0.3|0.10.3|0.11.2|0.12.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/gem/uri/CVE-2023-36617.yml
weaknesses:
  - CWE-1333
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/uri/CVE-2023-36617.yml
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/commit/05b1e7d026b886e65a60ee35625229da9ec220bb
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/commit/38bf797c488bcb4a37fb322bfa84977981863ec6
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/commit/3cd938df20db26c9439e9f681aadfb9bbeb6d1c0
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/commit/4d02315181d8a485496f1bb107a6ab51d6f3a35f
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/commit/70794abc162bb15bb934713b5669713d6700d35c
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/commit/7e33934c91b7f8f3ea7b7a4258b468e19f636bc3
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/commit/9a8e0cc03da964054c2a4ea26b59c53c3bae4921
    reference_type:
    reference_id:
  - url: https://github.com/ruby/uri/commit/ba36c8a3ecad8c16dd3e60a6da9abd768206c8fa
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/09/msg00000.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/27LUWREIFTP3MQAW7QE4PJM4DPAQJWXF
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QA6XUKUY7B5OLNQBLHOT43UW7C5NIOQQ
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/27LUWREIFTP3MQAW7QE4PJM4DPAQJWXF
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230725-0002
    reference_type:
    reference_id:
  - url: https://www.ruby-lang.org/en/news/2023/06/29/redos-in-uri-CVE-2023-36617
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-36617
    reference_type:
    reference_id: CVE-2023-36617
  - url: https://github.com/advisories/GHSA-hww2-5g85-429m
    reference_type:
    reference_id: GHSA-hww2-5g85-429m
