advisory_id: pypi/matrix-synapse/CVE-2025-30355
datasource_id: gitlab_importer_v2/pypi/matrix-synapse/CVE-2025-30355
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2025-30355.yml
aliases:
  - CVE-2025-30355
  - GHSA-v56r-hwv5-mxg6
summary: |
  Synapse vulnerable to federation denial of service via malformed events
  A malicious server can craft events with a `depth` outside the integer range allowed by Canonical JSON. When such an event is received by Synapse version up to 1.127.0, it prevents it from federating with other servers. The vulnerability has been exploited in the wild.
impacted_packages:
  - purl: pkg:pypi/matrix-synapse
    affected_versions: vers:pypi/<1.127.1
    fixed_versions: vers:pypi/1.127.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2025-30355.yml
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/element-hq/synapse
    reference_type:
    reference_id:
  - url: https://github.com/element-hq/synapse/commit/2277df2a1eb685f85040ef98fa21d41aa4cdd389
    reference_type:
    reference_id:
  - url: https://github.com/element-hq/synapse/releases/tag/v1.127.1
    reference_type:
    reference_id:
  - url: https://github.com/element-hq/synapse/security/advisories/GHSA-v56r-hwv5-mxg6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-30355
    reference_type:
    reference_id: CVE-2025-30355
  - url: https://github.com/advisories/GHSA-v56r-hwv5-mxg6
    reference_type:
    reference_id: GHSA-v56r-hwv5-mxg6
