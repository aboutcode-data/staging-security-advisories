advisory_id: pypi/matrix-synapse/CVE-2022-39374
datasource_id: gitlab_importer_v2/pypi/matrix-synapse/CVE-2022-39374
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2022-39374.yml
aliases:
  - CVE-2022-39374
  - GHSA-p9qp-c452-f9r7
summary: |
  Synapse Denial of service due to incorrect application of event authorization rules during state resolution
  If Synapse and a malicious homeserver are both joined to the same room, the malicious homeserver can trick Synapse into accepting previously rejected events into its view of the current state of that room. This can be exploited in a way that causes all further messages and state changes sent in that room from the vulnerable homeserver to be rejected.

  Synapse homeservers are affected by this issue if and only if they are joined to rooms which members of untrusted homeservers are joined or invited to.

  - Synapse homeservers in rooms available over public federation **are** affected.
  - Synapse homeservers with federation disabled are not affected.
  - Synapse homeservers in a closed federation containing only trusted servers are not affected.
  - Synapse homeservers which are only joined to rooms with federation disabled[^1] are not affected.
impacted_packages:
  - purl: pkg:pypi/matrix-synapse
    affected_versions: vers:pypi/>=1.62.0|<1.68.0rc1
    fixed_versions: vers:pypi/1.68.0rc1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2022-39374.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-400
references:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/b73cbb82157d9666e8d667733afebc0d09ed858c
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/pull/13723
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-p9qp-c452-f9r7
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2023-66.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UJIJRP5ZH6B3KGFLHCAKR2IX2Y4Z25QD
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39374
    reference_type:
    reference_id: CVE-2022-39374
  - url: https://github.com/advisories/GHSA-p9qp-c452-f9r7
    reference_type:
    reference_id: GHSA-p9qp-c452-f9r7
