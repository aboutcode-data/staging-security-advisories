advisory_id: pypi/matrix-synapse/CVE-2021-39163
datasource_id: gitlab_importer_v2/pypi/matrix-synapse/CVE-2021-39163
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2021-39163.yml
aliases:
  - CVE-2021-39163
  - GHSA-jj53-8fmw-f2w2
summary: |
  Adding a private/unlisted room to a community exposes room metadata in an unauthorised manner.
  Unauthorised users can access the name, avatar, topic and number of members of a room if they know the ID of the room. This vulnerability is limited to homeservers where:
  - the vulnerable homeserver is in the room; and
  - untrusted users are permitted to create groups (communities).

  By default, only homeserver administrators can create groups. However, homeserver administrators can already access this information in the database or using the admin API. As a result, only homeservers where the configuration setting `enable_group_creation` has been set to `true` are impacted.
impacted_packages:
  - purl: pkg:pypi/matrix-synapse
    affected_versions: vers:pypi/<1.41.1
    fixed_versions: vers:pypi/1.41.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2021-39163.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2021-39163.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/cb35df940a
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/releases/tag/v1.41.1
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-jj53-8fmw-f2w2
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-424.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39163
    reference_type:
    reference_id: CVE-2021-39163
  - url: https://github.com/advisories/GHSA-jj53-8fmw-f2w2
    reference_type:
    reference_id: GHSA-jj53-8fmw-f2w2
