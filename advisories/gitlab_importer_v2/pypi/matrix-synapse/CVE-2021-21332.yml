advisory_id: pypi/matrix-synapse/CVE-2021-21332
datasource_id: gitlab_importer_v2/pypi/matrix-synapse/CVE-2021-21332
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2021-21332.yml
aliases:
  - CVE-2021-21332
  - GHSA-246w-56m2-5899
summary: |
  Cross-site scripting (XSS) vulnerability in the password reset endpoint
  The password reset endpoint served via Synapse was vulnerable to cross-site scripting (XSS) attacks. The impact depends on the configuration of the domain that Synapse is deployed on, but may allow access to cookies and other browser data, CSRF vulnerabilities, and access to other resources served on the same domain or parent domains.
impacted_packages:
  - purl: pkg:pypi/matrix-synapse
    affected_versions: vers:pypi/<1.27.0
    fixed_versions: vers:pypi/1.27.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2021-21332.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2021-21332.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/e54746bdf7d5c831eabe4dcea76a7626f1de73df
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/pull/9200
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/releases/tag/v1.27.0
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-246w-56m2-5899
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-133.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21332
    reference_type:
    reference_id: CVE-2021-21332
  - url: https://github.com/advisories/GHSA-246w-56m2-5899
    reference_type:
    reference_id: GHSA-246w-56m2-5899
