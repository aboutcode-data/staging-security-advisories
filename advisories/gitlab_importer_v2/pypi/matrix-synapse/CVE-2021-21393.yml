advisory_id: pypi/matrix-synapse/CVE-2021-21393
datasource_id: gitlab_importer_v2/pypi/matrix-synapse/CVE-2021-21393
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2021-21393.yml
aliases:
  - CVE-2021-21393
  - GHSA-jrh7-mhhx-6h88
summary: |
  Denial of service (via resource exhaustion) due to improper input validation on groups/communities endpoints
  Missing input validation of some parameters on the groups (also known as communities) endpoints could cause excessive use of disk space and memory leading to resource exhaustion. Additionally clients may have issues rendering large fields.
impacted_packages:
  - purl: pkg:pypi/matrix-synapse
    affected_versions: vers:pypi/<1.28.0
    fixed_versions: vers:pypi/1.28.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2021-21393.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-synapse/CVE-2021-21393.yml
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/3f58fc848d0002de4605bed91603a1f9f245d128
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/d2f0ec12d5c8f113095408888e87e191ac546499
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/pull/9321
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/pull/9393
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-jrh7-mhhx-6h88
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-26.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY
    reference_type:
    reference_id:
  - url: https://pypi.org/project/matrix-synapse
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21393
    reference_type:
    reference_id: CVE-2021-21393
  - url: https://github.com/advisories/GHSA-jrh7-mhhx-6h88
    reference_type:
    reference_id: GHSA-jrh7-mhhx-6h88
