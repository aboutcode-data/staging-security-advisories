advisory_id: pypi/ethyca-fides/CVE-2024-35189
datasource_id: gitlab_importer_v2/pypi/ethyca-fides/CVE-2024-35189
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ethyca-fides/CVE-2024-35189.yml
aliases:
  - CVE-2024-35189
  - GHSA-rcvg-jj3g-rj7c
summary: |
  Sensitive Data Disclosure Vulnerability in Connection Configuration Endpoints
  The Fides webserver has a number of endpoints that retrieve `ConnectionConfiguration` records and their associated `secrets` which _can_ contain sensitive data (e.g. passwords, private keys, etc.). These `secrets` are stored encrypted at rest (in the application database), and the associated endpoints are not meant to expose that sensitive data in plaintext to API clients, as it could be compromising.

  Fides's developers have available to them a Pydantic field-attribute (`sensitive`) that they can annotate as `True` to indicate that a given secret field should not be exposed via the API. The application has an internal function that uses `sensitive` annotations to mask the sensitive fields with a `"**********"` placeholder value.

  This vulnerability is due to a bug in that function, which prevented `sensitive` API model fields that were _nested_ below the root-level of a `secrets` object from being masked appropriately. Only the `BigQuery` connection configuration secrets meets these criteria: the secrets schema has a nested sensitive `keyfile_creds.private_key` property that is exposed in plaintext via the APIs.

  Connection types other than `BigQuery` with sensitive fields at the root-level that are not nested are properly masked with the placeholder and are not affected by this vulnerability.
impacted_packages:
  - purl: pkg:pypi/ethyca-fides
    affected_versions: vers:pypi/<2.37.0
    fixed_versions: vers:pypi/2.37.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ethyca-fides/CVE-2024-35189.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://cloud.google.com/iam/docs/key-rotation
    reference_type:
    reference_id:
  - url: https://github.com/ethyca/fides
    reference_type:
    reference_id:
  - url: https://github.com/ethyca/fides/security/advisories/GHSA-rcvg-jj3g-rj7c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35189
    reference_type:
    reference_id: CVE-2024-35189
  - url: https://github.com/advisories/GHSA-rcvg-jj3g-rj7c
    reference_type:
    reference_id: GHSA-rcvg-jj3g-rj7c
