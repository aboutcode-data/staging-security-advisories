advisory_id: pypi/tornado/GMS-2023-1908
datasource_id: gitlab_importer_v2/pypi/tornado/GMS-2023-1908
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tornado/GMS-2023-1908.yml
aliases:
  - GHSA-qppv-j76h-2rpx
  - GMS-2023-1908
summary: |
  Tornado vulnerable to HTTP request smuggling via improper parsing of `Content-Length` fields and chunk lengths
  ## Summary
  Tornado interprets `-`, `+`, and `_` in chunk length and `Content-Length` values, which are not allowed by the HTTP RFCs. This can result in request smuggling when Tornado is deployed behind certain proxies that interpret those non-standard characters differently. This is known to apply to older versions of haproxy, although the current release is not affected.

  ## Details
  Tornado uses the `int` constructor to parse the values of `Content-Length` headers and chunk lengths in the following locations:
  ### `tornado/http1connection.py:445`
  ```python3
        self._expected_content_remaining = int(headers["Content-Length"])
  ```
  ### `tornado/http1connection.py:621`
  ```python3
          content_length = int(headers["Content-Length"]) # type: Optional[int]
  ```
  ### `tornado/http1connection.py:671`
  ```python3
        chunk_len = int(chunk_len_str.strip(), 16)
  ```
  Because `int("0_0") == int("+0") == int("-0") == int("0")`, using the `int` constructor to parse and validate strings that should contain only ASCII digits is not a good strategy.
impacted_packages:
  - purl: pkg:pypi/tornado
    affected_versions: vers:pypi/<6.3.3
    fixed_versions: vers:pypi/6.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/tornadoweb/tornado/commit/b7a5dd29bb02950303ae96055082c12a1ea0a4fe
    reference_type:
    reference_id:
  - url: https://github.com/tornadoweb/tornado/security/advisories/GHSA-qppv-j76h-2rpx
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-qppv-j76h-2rpx
    reference_type:
    reference_id: GHSA-qppv-j76h-2rpx
