advisory_id: pypi/llama-index-core/CVE-2024-3271
datasource_id: gitlab_importer_v2/pypi/llama-index-core/CVE-2024-3271
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/llama-index-core/CVE-2024-3271.yml
aliases:
  - CVE-2024-3271
  - GHSA-r6gp-rff2-p3hf
summary: |
  llama-index-core Command Injection vulnerability
  A command injection vulnerability exists in the run-llama/llama_index repository, specifically within the safe_eval function. Attackers can bypass the intended security mechanism, which checks for the presence of underscores in code generated by LLM, to execute arbitrary code. This is achieved by crafting input that does not contain an underscore but still results in the execution of OS commands. The vulnerability allows for remote code execution (RCE) on the server hosting the application.
impacted_packages:
  - purl: pkg:pypi/llama-index-core
    affected_versions: vers:pypi/<0.10.24
    fixed_versions: vers:pypi/0.10.24
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/llama-index-core/CVE-2024-3271.yml
weaknesses:
  - CWE-77
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/run-llama/llama_index
    reference_type:
    reference_id:
  - url: https://github.com/run-llama/llama_index/commit/2c92e88838a5f481d50840240b1dd3180066c6f5
    reference_type:
    reference_id:
  - url: https://github.com/run-llama/llama_index/commit/5fbcb5a8b9f20f81b791c7fc8849e352613ab475
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/9b32490e-7cf9-470e-8d49-ba083ae7a279
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-3271
    reference_type:
    reference_id: CVE-2024-3271
  - url: https://github.com/advisories/GHSA-r6gp-rff2-p3hf
    reference_type:
    reference_id: GHSA-r6gp-rff2-p3hf
