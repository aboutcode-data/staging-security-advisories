advisory_id: pypi/dynamodb-encryption-sdk/GMS-2021-10
datasource_id: gitlab_importer_v2/pypi/dynamodb-encryption-sdk/GMS-2021-10
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/dynamodb-encryption-sdk/GMS-2021-10.yml
aliases:
  - GHSA-4ph2-8337-hm62
  - GMS-2021-10
summary: |
  Key Caching behavior in the DynamoDB Encryption Client.
  ### Impact
  This advisory concerns users of MostRecentProvider in the DynamoDB Encryption Client with a key provider like AWS Key Management Service that allows for permissions on keys to be modified.

  When key usage permissions were changed at the key provider, time-based key reauthorization logic in MostRecentProvider did not reauthorize the use of the key. This created the potential for keys to be used in the DynamoDB Encryption Client after permissions to do so were revoked at the key provider.

  ### Patches
  Fixed as of We recommend users to modify their code and adopt `CachingMostRecentProvider`.


  ### Workarounds
  Users who cannot upgrade to use the `CachingMostRecentProvider` can call `clear()` on the cache to manually flush all of its contents. Next use of the key will force a re-validation to occur with the key provider.
impacted_packages:
  - purl: pkg:pypi/dynamodb-encryption-sdk
    affected_versions: vers:pypi/<1.3.0
    fixed_versions: vers:pypi/1.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/aws/aws-dynamodb-encryption-python/blob/master/CHANGELOG.rst#130----2021-02-04
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-dynamodb-encryption-python/commit/90606ec9af7c2b5cb338d64639a62ee867d38d6b
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-dynamodb-encryption-python/security/advisories/GHSA-4ph2-8337-hm62
    reference_type:
    reference_id:
  - url: https://pypi.org/project/dynamodb-encryption-sdk
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-4ph2-8337-hm62
    reference_type:
    reference_id: GHSA-4ph2-8337-hm62
