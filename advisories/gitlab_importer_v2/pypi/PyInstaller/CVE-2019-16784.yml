advisory_id: pypi/PyInstaller/CVE-2019-16784
datasource_id: gitlab_importer_v2/pypi/PyInstaller/CVE-2019-16784
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/PyInstaller/CVE-2019-16784.yml
aliases:
  - CVE-2019-16784
  - GHSA-7fcj-pq9j-wh2r
summary: |
  Local Privilege Escalation in PyInstaller
  Local Privilege Escalation in all Windows software frozen by PyInstaller in "onefile" mode.

  The vulnerability is present only on Windows and in this particular case: If a **software frozen by PyInstaller in "onefile" mode** is launched by a (privileged) user who has **his/her "TempPath" resolving to a world writable directory**. This is the case e.g. if the software is launched as a service or as a scheduled task using a system account (in which case TempPath will default to C:\Windows\Temp).

  In order to be exploitable the software has to be (re)started after the attacker has launched the exploit program. So for a service launched at startup, a service restart is needed (e.g. after a crash or an upgrade).

  While PyInstaller itself was not vulnerable, all Windows software frozen by PyInstaller in "onefile" mode is vulnerable.

  CVSSv3 score 7.0 (High)
  CVSSv3 vector CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H

  Affected
  - all Windows software frozen by PyInstaller in "onefile" mode

  No affected
  - PyInstaller itself (except if frozen by PyInstaller in "onefile" mode on Windows)
  - software frozen in "one*dir*" mode
  - other platforms (GNU/Linux, OS X, BSD, etc.)
impacted_packages:
  - purl: pkg:pypi/pyinstaller
    affected_versions: vers:pypi/<3.6
    fixed_versions: vers:pypi/3.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/PyInstaller/CVE-2019-16784.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/PyInstaller/CVE-2019-16784.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-250
references:
  - url: https://github.com/pyinstaller/pyinstaller
    reference_type:
    reference_id:
  - url: https://github.com/pyinstaller/pyinstaller/commit/42a67148b3bdf9211fda8499fdc5b63acdd7e6cc
    reference_type:
    reference_id:
  - url: https://github.com/pyinstaller/pyinstaller/commit/be948cf0954707671aa499da17b10c86b6fa5e5c
    reference_type:
    reference_id:
  - url: https://github.com/pyinstaller/pyinstaller/security/advisories/GHSA-7fcj-pq9j-wh2r
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pyinstaller/PYSEC-2020-175.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-16784
    reference_type:
    reference_id: CVE-2019-16784
  - url: https://github.com/advisories/GHSA-7fcj-pq9j-wh2r
    reference_type:
    reference_id: GHSA-7fcj-pq9j-wh2r
