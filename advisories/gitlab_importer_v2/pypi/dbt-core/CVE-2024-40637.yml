advisory_id: pypi/dbt-core/CVE-2024-40637
datasource_id: gitlab_importer_v2/pypi/dbt-core/CVE-2024-40637
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/dbt-core/CVE-2024-40637.yml
aliases:
  - CVE-2024-40637
  - GHSA-p3f3-5ccg-83xq
summary: |
  dbt has an implicit override for built-in materializations from installed packages
  _What kind of vulnerability is it? Who is impacted?_

  When a user installs a [package](https://docs.getdbt.com/docs/build/packages) in dbt, it has the ability to override macros, materializations, and other core components of dbt. This is by design, as it allows packages to extend and customize dbt's functionality. However, this also means that a malicious package could potentially override these components with harmful code.
impacted_packages:
  - purl: pkg:pypi/dbt-core
    affected_versions: vers:pypi/>=1.6.0|<1.6.14|>=1.7.0|<1.7.14
    fixed_versions: vers:pypi/1.6.14|1.7.14
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/dbt-core/CVE-2024-40637.yml
weaknesses:
  - CWE-74
  - CWE-89
  - CWE-913
  - CWE-1035
  - CWE-937
references:
  - url: https://docs.getdbt.com/docs/build/packages
    reference_type:
    reference_id:
  - url: https://docs.getdbt.com/reference/global-configs/legacy-behaviors#behavior-change-flags
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core/commit/3c82a0296d227cb1be295356df314c11716f4ff6
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core/commit/87ac4deb00cc9fe334706e42a365903a1d581624
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core/security/advisories/GHSA-p3f3-5ccg-83xq
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/dbt-core/PYSEC-2024-66.yaml
    reference_type:
    reference_id:
  - url: https://tempered.works/posts/2024/07/06/preventing-data-theft-with-gcp-service-controls
    reference_type:
    reference_id:
  - url: https://www.elementary-data.com/post/are-dbt-packages-secure-the-answer-lies-in-your-dwh-policies
    reference_type:
    reference_id:
  - url: https://www.equalexperts.com/blog/tech-focus/are-you-at-risk-from-this-critical-dbt-vulnerability
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-40637
    reference_type:
    reference_id: CVE-2024-40637
  - url: https://github.com/advisories/GHSA-p3f3-5ccg-83xq
    reference_type:
    reference_id: GHSA-p3f3-5ccg-83xq
