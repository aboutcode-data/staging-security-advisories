advisory_id: pypi/OpenCanary/CVE-2024-48911
datasource_id: gitlab_importer_v2/pypi/OpenCanary/CVE-2024-48911
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/OpenCanary/CVE-2024-48911.yml
aliases:
  - CVE-2024-48911
  - GHSA-pf5v-pqfv-x8jj
summary: |
  OpenCanary Executes Commands From Potentially Writable Config File
  OpenCanary directly executed commands taken from its config file. Where the config file is stored in an unprivileged user directory but the daemon is executed by root, itâ€™s possible for the unprivileged user to change the config file and escalate permissions when root later runs the daemon.

  Thanks to the folks at [Whirlylabs](https://whirlylabs.com/) for finding and fixing this.
impacted_packages:
  - purl: pkg:pypi/opencanary
    affected_versions: vers:pypi/<0.9.5
    fixed_versions: vers:pypi/0.9.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/OpenCanary/CVE-2024-48911.yml
weaknesses:
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/opencanary/PYSEC-2024-248.yaml
    reference_type:
    reference_id:
  - url: https://github.com/thinkst/opencanary
    reference_type:
    reference_id:
  - url: https://github.com/thinkst/opencanary/commit/2c11575b1a3dd8b0df26a879ba856c0aa350c049
    reference_type:
    reference_id:
  - url: https://github.com/thinkst/opencanary/releases/tag/v0.9.4
    reference_type:
    reference_id:
  - url: https://github.com/thinkst/opencanary/security/advisories/GHSA-pf5v-pqfv-x8jj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-48911
    reference_type:
    reference_id: CVE-2024-48911
  - url: https://github.com/advisories/GHSA-pf5v-pqfv-x8jj
    reference_type:
    reference_id: GHSA-pf5v-pqfv-x8jj
