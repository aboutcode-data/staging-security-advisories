advisory_id: pypi/Products.isurlinportal/CVE-2021-32806
datasource_id: gitlab_importer_v2/pypi/Products.isurlinportal/CVE-2021-32806
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Products.isurlinportal/CVE-2021-32806.yml
aliases:
  - CVE-2021-32806
  - GHSA-q3m9-9fj2-mfwr
summary: |
  URL Redirection to Untrusted Site ('Open Redirect') in Products.isurlinportal
  Various parts of Plone use the 'is url in portal' check for security, mostly to see if it is safe to redirect to a url. A url like `https://example.org` is not in the portal.
  But the url `https:example.org` without slashes tricks our code and it _is_ considered to be in the portal.
  When redirecting, some browsers go to `https://example.org`, others give an error.
  Attackers may use this to redirect you to their site, especially as part of a phishing attack.
impacted_packages:
  - purl: pkg:pypi/products.isurlinportal
    affected_versions: vers:pypi/<1.2.0
    fixed_versions: vers:pypi/1.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Products.isurlinportal/CVE-2021-32806.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Products.isurlinportal/CVE-2021-32806.yml
weaknesses:
  - CWE-601
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/plone/Products.isurlinportal
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.isurlinportal/commit/d4fd34990d18adf05a10dc5e2bb4b066798280ba
    reference_type:
    reference_id:
  - url: https://github.com/plone/Products.isurlinportal/security/advisories/GHSA-q3m9-9fj2-mfwr
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/products-isurlinportal/PYSEC-2021-323.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32806
    reference_type:
    reference_id: CVE-2021-32806
  - url: https://github.com/advisories/GHSA-q3m9-9fj2-mfwr
    reference_type:
    reference_id: GHSA-q3m9-9fj2-mfwr
