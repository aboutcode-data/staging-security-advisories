advisory_id: pypi/zope/CVE-2021-32633
datasource_id: gitlab_importer_v2/pypi/zope/CVE-2021-32633
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/zope/CVE-2021-32633.yml
aliases:
  - CVE-2021-32633
  - GHSA-5pr9-v234-jw36
summary: |
  Remote Code Execution via traversal in TAL expressions
  Most Python modules are not available for using in TAL expressions that you can add through-the-web, for example in Zope Page Templates. This restriction avoids file system access, for example via the 'os' module. But some of the untrusted modules are available indirectly through Python modules that are available for direct use.

  By default, you need to have the Manager role to add or edit Zope Page Templates through the web. Only sites that allow untrusted users to add/edit Zope Page Templates through the web are at risk.
impacted_packages:
  - purl: pkg:pypi/zope
    affected_versions: vers:pypi/<4.6|>=5.0|<5.2
    fixed_versions: vers:pypi/4.6|5.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/zope/CVE-2021-32633.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/zope/CVE-2021-32633.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://cyllective.com/blog/post/plone-authenticated-rce-cve-2021-32633
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/zope/PYSEC-2021-88.yaml
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope/commit/1f8456bf1f908ea46012537d52bd7e752a532c91
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32633
    reference_type:
    reference_id: CVE-2021-32633
  - url: https://github.com/advisories/GHSA-5pr9-v234-jw36
    reference_type:
    reference_id: GHSA-5pr9-v234-jw36
