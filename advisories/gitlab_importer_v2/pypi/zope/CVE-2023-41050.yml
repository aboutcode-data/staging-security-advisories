advisory_id: pypi/zope/CVE-2023-41050
datasource_id: gitlab_importer_v2/pypi/zope/CVE-2023-41050
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/zope/CVE-2023-41050.yml
aliases:
  - CVE-2023-41050
  - GHSA-8xv7-89vj-q48c
summary: |
  Exposure of Sensitive Information to an Unauthorized Actor
  AccessControl provides a general security framework for use in Zope. Python's "format" functionality allows someone controlling the format string to "read" objects accessible (recursively) via attribute access and subscription from accessible objects. Those attribute accesses and subscriptions use Python's full blown `getattr` and `getitem`, not the policy restricted `AccessControl` variants `_getattr_` and `_getitem_`. This can lead to critical information disclosure. `AccessControl` already provides a safe variant for `str.format` and denies access to `string.Formatter`. However, `str.format_map` is still unsafe. Affected are all users who allow untrusted users to create `AccessControl` controlled Python code and execute it. A fix has been introduced in versions 4.4, 5.8 and 6.2. Users are advised to upgrade. There are no known workarounds for this vulnerability.
impacted_packages:
  - purl: pkg:pypi/zope
    affected_versions: vers:pypi/<4.8.9|>=5.0.0|<5.8.4
    fixed_versions: vers:pypi/4.8.9|5.8.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/zope/CVE-2023-41050.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/zopefoundation/AccessControl/commit/6bc32692e0d4b8d5cf64eae3d19de987c7375bc9
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/AccessControl/security/advisories/GHSA-8xv7-89vj-q48c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41050
    reference_type:
    reference_id: CVE-2023-41050
  - url: https://github.com/advisories/GHSA-8xv7-89vj-q48c
    reference_type:
    reference_id: GHSA-8xv7-89vj-q48c
