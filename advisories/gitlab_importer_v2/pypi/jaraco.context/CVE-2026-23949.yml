advisory_id: pypi/jaraco.context/CVE-2026-23949
datasource_id: gitlab_importer_v2/pypi/jaraco.context/CVE-2026-23949
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/jaraco.context/CVE-2026-23949.yml
aliases:
  - CVE-2026-23949
  - GHSA-58pv-8j8x-9vj2
summary: |
  jaraco.context Has a Path Traversal Vulnerability
  There is a Zip Slip path traversal vulnerability in the jaraco.context package affecting setuptools as well, in `jaraco.context.tarball()` function. The vulnerability may allow attackers to extract files outside the intended extraction directory when malicious tar archives are processed.
  The strip_first_component filter splits the path on the first `/` and extracts the second component, while allowing `../` sequences. Paths like `dummy_dir/../../etc/passwd` become `../../etc/passwd`.
  Note that this suffers from a nested tarball attack as well with multi-level tar files such as `dummy_dir/inner.tar.gz`, where the inner.tar.gz includes a traversal `dummy_dir/../../config/.env` that also gets translated to `../../config/.env`.

  The code can be found:
  - https://github.com/jaraco/jaraco.context/blob/main/jaraco/context/__init__.py#L74-L91
  - https://github.com/pypa/setuptools/blob/main/setuptools/_vendor/jaraco/context.py#L55-L76 (inherited)

  This report was also sent to setuptools maintainers and they asked some questions regarding this.

  The lengthy answer is:

  The vulnerability seems to be the `strip_first_component` filter function, not the tarball function itself and has the same behavior on any tested Python version locally (from 11 to 14, as I noticed that there is a backports conditional for the tarball).
  The stock tarball for Python 3.12+ is considered not vulnerable (until proven otherwise ðŸ˜„) but here the custom filter seems to overwrite the native filtering and introduces the issue - while overwriting the updated secure Python 3.12+ behavior and giving a false sense of sanitization.

  The short answer is:

  If we are talking about Python < 3.12 the tarball and jaraco implementations /  behaviors are relatively the same but for Python 3.12+ the jaraco implementation overwrites the native tarball protection.

  Sampled tests:
  <img width="1634" height="245" alt="image" src="https://github.com/user-attachments/assets/ce6c0de6-bb53-4c2b-818a-d77e28d2fbeb" />
impacted_packages:
  - purl: pkg:pypi/jaraco.context
    affected_versions: vers:pypi/>=5.2.0|<6.1.0
    fixed_versions: vers:pypi/6.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/jaraco.context/CVE-2026-23949.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/jaraco/jaraco.context
    reference_type:
    reference_id:
  - url: https://github.com/jaraco/jaraco.context/blob/main/jaraco/context/__init__.py#L74-L91
    reference_type:
    reference_id:
  - url: https://github.com/jaraco/jaraco.context/commit/7b26a42b525735e4085d2e994e13802ea339d5f9
    reference_type:
    reference_id:
  - url: https://github.com/jaraco/jaraco.context/security/advisories/GHSA-58pv-8j8x-9vj2
    reference_type:
    reference_id:
  - url: https://github.com/pypa/setuptools/blob/main/setuptools/_vendor/jaraco/context.py#L55-L76
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23949
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-58pv-8j8x-9vj2
    reference_type:
    reference_id: GHSA-58pv-8j8x-9vj2
