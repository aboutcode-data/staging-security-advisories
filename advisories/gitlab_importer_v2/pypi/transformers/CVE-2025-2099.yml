advisory_id: pypi/transformers/CVE-2025-2099
datasource_id: gitlab_importer_v2/pypi/transformers/CVE-2025-2099
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/transformers/CVE-2025-2099.yml
aliases:
  - CVE-2025-2099
  - GHSA-qq3j-4f4f-9583
summary: |
  Hugging Face Transformers Regular Expression Denial of Service
  A Regular Expression Denial of Service (ReDoS) exists in the `preprocess_string()` function of the `transformers.testing_utils` module. In versions **before 4.50.0**, the regex used to process code blocks in docstrings contains nested quantifiers that can trigger catastrophic backtracking when given inputs with many newline characters. An attacker who can supply such input to `preprocess_string()` (or code paths that call it) can force excessive CPU usage and degrade availability.

  **Fix:** released in **4.50.0**, which rewrites the regex to avoid the inefficient pattern. ([GitHub][1])

  *   **Affected:** `< 4.50.0`
  *   **Patched:** `4.50.0`
impacted_packages:
  - purl: pkg:pypi/transformers
    affected_versions: vers:pypi/<4.50.0
    fixed_versions: vers:pypi/4.50.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/transformers/CVE-2025-2099.yml
weaknesses:
  - CWE-1333
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/huggingface/transformers
    reference_type:
    reference_id:
  - url: https://github.com/huggingface/transformers/commit/8cb522b4190bd556ce51be04942720650b1a3e57
    reference_type:
    reference_id:
  - url: https://github.com/huggingface/transformers/pull/36648
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/transformers/PYSEC-2025-40.yaml
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/97b780f3-ffca-424f-ad5d-0e1c57a5bde4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-2099
    reference_type:
    reference_id: CVE-2025-2099
  - url: https://github.com/advisories/GHSA-qq3j-4f4f-9583
    reference_type:
    reference_id: GHSA-qq3j-4f4f-9583
