advisory_id: pypi/vyper/GMS-2022-1912
datasource_id: gitlab_importer_v2/pypi/vyper/GMS-2022-1912
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/GMS-2022-1912.yml
aliases:
  - CVE-2022-29255
  - GHSA-4v9q-cgpw-cf38
  - GMS-2022-1912
summary: |
  Multiple evaluation of contract address in call in vyper
  ### Impact
  when a calling an external contract with no return value, the contract address could be evaluated twice. this is usually only an efficiency problem, but if evaluation of the contract address has side effects, it could result in double evaluation of the side effects.

  in the following example, `Foo(msg.sender).bar()` is the contract address for the following call (to `.foo()`), and could get evaluated twice

  ```vyper
  interface Foo:
   def foo(): nonpayable
   def bar() -> address: nonpayable

  @external
  def do_stuff():
   Foo(Foo(msg.sender).bar()).foo()
  ```

  ### Patches
  v0.3.4

  ### Workarounds
  assign contract addresses to variables. the above example would change to
  ```vyper
  @external
  def do_stuff():
   t: Foo = Foo(msg.sender).bar()
   t.foo()
  ```

  ### References

  ### For more information
impacted_packages:
  - purl: pkg:pypi/vyper
    affected_versions: vers:pypi/<0.3.4
    fixed_versions: vers:pypi/0.3.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/GMS-2022-1912.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/GMS-2022-1912.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-670
references:
  - url: https://github.com/vyperlang/vyper/commit/6b4d8ff185de071252feaa1c319712b2d6577f8d
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-4v9q-cgpw-cf38
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-4v9q-cgpw-cf38
    reference_type:
    reference_id: GHSA-4v9q-cgpw-cf38
