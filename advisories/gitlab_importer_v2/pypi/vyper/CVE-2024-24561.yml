advisory_id: pypi/vyper/CVE-2024-24561
datasource_id: gitlab_importer_v2/pypi/vyper/CVE-2024-24561
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/CVE-2024-24561.yml
aliases:
  - CVE-2024-24561
  - GHSA-9x7f-gwxq-6f2c
summary: |
  Vyper's bounds check on built-in `slice()` function can be overflowed
  [The bounds check for slices](https://github.com/vyperlang/vyper/blob/b01cd686aa567b32498fefd76bd96b0597c6f099/vyper/builtins/functions.py#L404-L457) does not account for the ability for `start + length` to overflow when the values aren't literals.

  If a `slice()` function uses a non-literal argument for the `start`  or `length` variable, this creates the ability for an attacker to overflow the bounds check.

  This issue can be used to do OOB access to storage, memory or calldata addresses. It can also be used to corrupt the `length` slot of the respective array.

  A contract search was performed and no vulnerable contracts were found in production.

  tracking in issue https://github.com/vyperlang/vyper/issues/3756.
  patched in https://github.com/vyperlang/vyper/pull/3818.
impacted_packages:
  - purl: pkg:pypi/vyper
    affected_versions: vers:pypi/<0.4.0
    fixed_versions: vers:pypi/0.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/CVE-2024-24561.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-119
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2024-149.yaml
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/blob/b01cd686aa567b32498fefd76bd96b0597c6f099/vyper/builtins/functions.py#L404-L457
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/issues/3756
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-9x7f-gwxq-6f2c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-24561
    reference_type:
    reference_id: CVE-2024-24561
  - url: https://github.com/advisories/GHSA-9x7f-gwxq-6f2c
    reference_type:
    reference_id: GHSA-9x7f-gwxq-6f2c
