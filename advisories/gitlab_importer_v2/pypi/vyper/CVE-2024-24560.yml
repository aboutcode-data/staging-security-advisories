advisory_id: pypi/vyper/CVE-2024-24560
datasource_id: gitlab_importer_v2/pypi/vyper/CVE-2024-24560
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/CVE-2024-24560.yml
aliases:
  - CVE-2024-24560
  - GHSA-gp3w-2v2m-p686
summary: |
  Vyper's external calls can overflow return data to return input buffer
  When calls to external contracts are made, we write the input buffer starting at byte 28, and allocate the return buffer to start at byte 0 (overlapping with the input buffer). When checking `RETURNDATASIZE` for dynamic types, the size is compared only to the minimum allowed size for that type, and not to the returned value's `length`. As a result, malformed return data can cause the contract to mistake data from the input buffer for returndata.

  This advisory is given a severity of "Low" because when the called contract returns invalid ABIv2 encoded data, the calling contract can read different invalid data (from the dirty buffer) than the called contract returned.
impacted_packages:
  - purl: pkg:pypi/vyper
    affected_versions: vers:pypi/<0.4.0
    fixed_versions: vers:pypi/0.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/CVE-2024-24560.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-119
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2024-148.yaml
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-gp3w-2v2m-p686
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-24560
    reference_type:
    reference_id: CVE-2024-24560
  - url: https://github.com/advisories/GHSA-gp3w-2v2m-p686
    reference_type:
    reference_id: GHSA-gp3w-2v2m-p686
