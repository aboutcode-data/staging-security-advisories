advisory_id: pypi/vyper/CVE-2025-27105
datasource_id: gitlab_importer_v2/pypi/vyper/CVE-2025-27105
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/CVE-2025-27105.yml
aliases:
  - CVE-2025-27105
  - GHSA-4w26-8p97-f4jp
summary: |
  AugAssign evaluation order causing OOB write within the object in Vyper
  Vyper handles AugAssign statements by first caching the target location to avoid double evaluation. However, in the case when target is an access to a DynArray and the rhs modifies the array, the cached target will evaluate first, and the bounds check will not be re-evaluated during the write portion of the statement. In other words, the following code

  ```vyper
  def poc():
  a: DynArray[uint256, 2] = [1, 2]
  a[1] += a.pop()
  ```

  is equivalent to:
  ```vyper
  def poc():
  a: DynArray[uint256, 2] = [1, 2]
  a[1] += a[len(a) - 1]
  a.pop()
  ```
  rather than:
  ```vyper
  def poc():
  a: DynArray[uint256, 2] = [1, 2]
  s: uint256 = a[1]
  t: uint256 = a.pop()
  a[1] = s + t  # reverts due to oob access
  ```
impacted_packages:
  - purl: pkg:pypi/vyper
    affected_versions: vers:pypi/<0.4.1
    fixed_versions: vers:pypi/0.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/CVE-2025-27105.yml
weaknesses:
  - CWE-787
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2025-31.yaml
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-4w26-8p97-f4jp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-27105
    reference_type:
    reference_id: CVE-2025-27105
  - url: https://github.com/advisories/GHSA-4w26-8p97-f4jp
    reference_type:
    reference_id: GHSA-4w26-8p97-f4jp
