advisory_id: pypi/vyper/CVE-2023-32675
datasource_id: gitlab_importer_v2/pypi/vyper/CVE-2023-32675
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/CVE-2023-32675.yml
aliases:
  - CVE-2023-32675
  - GHSA-vxmm-cwh2-q762
summary: |
  Vyper's nonpayable default functions are sometimes payable
  in contracts with at least one regular nonpayable function, due to the callvalue check being inside of the selector section, it is possible to send funds to the default function by using less than 4 bytes of calldata, even if the default function is marked `nonpayable`. this applies to contracts compiled with vyper<=0.3.7.
  ```vyper
impacted_packages:
  - purl: pkg:pypi/vyper
    affected_versions: vers:pypi/<0.3.8
    fixed_versions: vers:pypi/0.3.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vyper/CVE-2023-32675.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-670
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2023-80.yaml
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/commit/02339dfda0f3caabad142060d511d10bfe93c520
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/commit/02339dfda0f3caabad142060d511d10bfe93c520.
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/commit/903727006c1e5ebef99fa9fd5d51d62bd33d72a9
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-vxmm-cwh2-q762
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-32675
    reference_type:
    reference_id: CVE-2023-32675
  - url: https://github.com/advisories/GHSA-vxmm-cwh2-q762
    reference_type:
    reference_id: GHSA-vxmm-cwh2-q762
