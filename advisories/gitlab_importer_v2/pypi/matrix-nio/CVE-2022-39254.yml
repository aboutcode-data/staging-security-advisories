advisory_id: pypi/matrix-nio/CVE-2022-39254
datasource_id: gitlab_importer_v2/pypi/matrix-nio/CVE-2022-39254
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-nio/CVE-2022-39254.yml
aliases:
  - CVE-2022-39254
  - GHSA-w4pr-4vjg-hffh
summary: |
  Key Exchange without Entity Authentication
  matrix-nio is a Python Matrix client library, designed according to sans I/O principles. Prior to version 0.20, when a users requests a room key from their devices, the software correctly remember the request. Once they receive a forwarded room key, they accept it without checking who the room key came from. This allows homeservers to try to insert room keys of questionable validity, potentially mounting an impersonation attack. Version 0.20 fixes the issue.
impacted_packages:
  - purl: pkg:pypi/matrix-nio
    affected_versions: vers:pypi/<0.20
    fixed_versions: vers:pypi/0.20.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-nio/CVE-2022-39254.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/poljar/matrix-nio/commit/b1cbf234a831daa160673defd596e6450e9c29f0
    reference_type:
    reference_id:
  - url: https://github.com/poljar/matrix-nio/security/advisories/GHSA-w4pr-4vjg-hffh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39254
    reference_type:
    reference_id: CVE-2022-39254
  - url: https://github.com/advisories/GHSA-w4pr-4vjg-hffh
    reference_type:
    reference_id: GHSA-w4pr-4vjg-hffh
