advisory_id: pypi/langchain/CVE-2024-3571
datasource_id: gitlab_importer_v2/pypi/langchain/CVE-2024-3571
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/langchain/CVE-2024-3571.yml
aliases:
  - CVE-2024-3571
  - GHSA-rgp8-pm28-3759
summary: |
  langchain vulnerable to path traversal
  langchain-ai/langchain is vulnerable to path traversal due to improper limitation of a pathname to a restricted directory ('Path Traversal') in its LocalFileStore functionality. An attacker can leverage this vulnerability to read or write files anywhere on the filesystem, potentially leading to information disclosure or remote code execution. The issue lies in the handling of file paths in the mset and mget methods, where user-supplied input is not adequately sanitized, allowing directory traversal sequences to reach unintended directories.
impacted_packages:
  - purl: pkg:pypi/langchain
    affected_versions: vers:pypi/<0.0.353
    fixed_versions: vers:pypi/0.0.353
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/langchain/CVE-2024-3571.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/langchain-ai/langchain
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchain/commit/aad3d8bd47d7f5598156ff2bdcc8f736f24a7412
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/2df3acdc-ee4f-4257-bbf8-a7de3870a9d8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-3571
    reference_type:
    reference_id: CVE-2024-3571
  - url: https://github.com/advisories/GHSA-rgp8-pm28-3759
    reference_type:
    reference_id: GHSA-rgp8-pm28-3759
