advisory_id: pypi/django-two-factor-auth/CVE-2020-15105
datasource_id: gitlab_importer_v2/pypi/django-two-factor-auth/CVE-2020-15105
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/django-two-factor-auth/CVE-2020-15105.yml
aliases:
  - CVE-2020-15105
  - GHSA-vhr6-pvjm-9qwf
summary: |
  User passwords are stored in clear text in the Django session
  django-two-factor-auth versions 1.11 and before store the user's password in clear text in the user session (base64-encoded). The password is stored in the session when the user submits their username and password, and is removed once they complete authentication by entering a two-factor authentication code. This means that the password is stored in clear text in the session for an arbitrary amount of time, and potentially forever if the user begins the login process by entering their username and password, and then leaves before entering their two-factor authentication code.

  The severity of this issue depends on which type of session storage you have configured: in the worst case, if you're using Django's default database session storage, then users' password are stored in clear text in your database. In the best case, if you're using Django's signed cookie session, then users' passwords are only stored in clear text within their browser's cookie store. In the common case of using Django's cache session store, the users' password are stored in clear text in whatever cache storage you have configured (typically Memcached or Redis).
impacted_packages:
  - purl: pkg:pypi/django-two-factor-auth
    affected_versions: vers:pypi/<1.12
    fixed_versions: vers:pypi/1.12
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:H/Au:S/C:P/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/django-two-factor-auth/CVE-2020-15105.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/django-two-factor-auth/CVE-2020-15105.yml
weaknesses:
  - CWE-312
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/Bouke/django-two-factor-auth
    reference_type:
    reference_id:
  - url: https://github.com/Bouke/django-two-factor-auth/blob/master/CHANGELOG.md#112---2020-07-08
    reference_type:
    reference_id:
  - url: https://github.com/Bouke/django-two-factor-auth/commit/454fd9842fa6e8bb772dbf0943976bc8e3335359
    reference_type:
    reference_id:
  - url: https://github.com/Bouke/django-two-factor-auth/security/advisories/GHSA-vhr6-pvjm-9qwf
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/django-two-factor-auth/PYSEC-2020-39.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15105
    reference_type:
    reference_id: CVE-2020-15105
  - url: https://github.com/advisories/GHSA-vhr6-pvjm-9qwf
    reference_type:
    reference_id: GHSA-vhr6-pvjm-9qwf
