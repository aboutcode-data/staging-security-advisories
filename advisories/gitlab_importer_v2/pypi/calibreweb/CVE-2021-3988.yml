advisory_id: pypi/calibreweb/CVE-2021-3988
datasource_id: gitlab_importer_v2/pypi/calibreweb/CVE-2021-3988
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/calibreweb/CVE-2021-3988.yml
aliases:
  - CVE-2021-3988
  - GHSA-r735-9gc6-2hvq
summary: |
  Cross-site Scripting (XSS) - DOM in janeczku/calibre-web
  A Cross-site Scripting (XSS) vulnerability exists in janeczku/calibre-web, specifically in the file `edit_books.js`. The vulnerability occurs when editing book properties, such as uploading a cover or a format. The affected code directly inserts user input into the DOM without proper sanitization, allowing attackers to execute arbitrary JavaScript code. This can lead to various attacks, including stealing cookies. The issue is present in the code handling the `#btn-upload-cover` change event.
impacted_packages:
  - purl: pkg:pypi/calibreweb
    affected_versions: vers:pypi/<0.6.15
    fixed_versions: vers:pypi/0.6.15
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/calibreweb/CVE-2021-3988.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/janeczku/calibre-web
    reference_type:
    reference_id:
  - url: https://github.com/janeczku/calibre-web/commit/7ad419dc8c12180e842a82118f4866ac3d074bc5
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/fa4c8fd1-7846-4dad-9112-2c07461f0609
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3988
    reference_type:
    reference_id: CVE-2021-3988
  - url: https://github.com/advisories/GHSA-r735-9gc6-2hvq
    reference_type:
    reference_id: GHSA-r735-9gc6-2hvq
