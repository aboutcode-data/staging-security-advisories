advisory_id: pypi/copier/CVE-2025-55201
datasource_id: gitlab_importer_v2/pypi/copier/CVE-2025-55201
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/copier/CVE-2025-55201.yml
aliases:
  - CVE-2025-55201
  - GHSA-3xw7-v6cj-5q8h
summary: |
  Copier's safe template has arbitrary filesystem read/write access
  Copier's current security model shall restrict filesystem access through Jinja:

  - Files can only be read using `{% include ... %}`, which is limited by Jinja to reading files from the subtree of the local template clone in our case.
  - Files are written in the destination directory according to their counterparts in the template.

  Copier suggests that it's safe to generate a project from a safe template, i.e. one that doesn't use [unsafe](https://copier.readthedocs.io/en/stable/configuring/#unsafe) features like custom Jinja extensions which would require passing the `--UNSAFE,--trust` flag. As it turns out, a safe template can currently read and write arbitrary files because we expose a few `pathlib.Path` objects in the Jinja context which have unconstrained I/O methods. This effectively renders our security model w.r.t. filesystem access useless.
impacted_packages:
  - purl: pkg:pypi/copier
    affected_versions: vers:pypi/<9.9.1
    fixed_versions: vers:pypi/9.9.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/copier/CVE-2025-55201.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/copier-org/copier
    reference_type:
    reference_id:
  - url: https://github.com/copier-org/copier/commit/3feea3b3ff3c20d80cbb16a2f3b9567ffc5606d1
    reference_type:
    reference_id:
  - url: https://github.com/copier-org/copier/security/advisories/GHSA-3xw7-v6cj-5q8h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-55201
    reference_type:
    reference_id: CVE-2025-55201
  - url: https://github.com/advisories/GHSA-3xw7-v6cj-5q8h
    reference_type:
    reference_id: GHSA-3xw7-v6cj-5q8h
