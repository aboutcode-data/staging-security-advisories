advisory_id: pypi/frigate/CVE-2024-32874
datasource_id: gitlab_importer_v2/pypi/frigate/CVE-2024-32874
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/frigate/CVE-2024-32874.yml
aliases:
  - CVE-2024-32874
  - GHSA-w4h6-9wrp-v5jq
summary: |
  Malicious Long Unicode filenames may cause a Multiple Application-level Denial of Service
  When uploading a file or retrieving the filename, a user may intentionally use a large Unicode filename which would lead to a application-level denial of service. This is due to no limitation set on the length of the filename and the costy use of the Unicode normalization with the form NFKD under the hood of `secure_filename()`.

  I idenfied multiple vulnerable paths on [blakeblackshear/frigate](https://www.github.com/blakeblackshear/frigate/) repository. In all of those paths, it was possible for a malicious user to send a filename equals to the output of : `python3 -c "print('â„€' * 1_000_000)"` which would reach the werkzeug `secure_filename()` call , which in turn under the hood uses a compatibility Unicode normalization with NFKC/NFKD form. In sum, the latter call would be costly in matter of CPU resource and may lead to the application-level denial of service.
impacted_packages:
  - purl: pkg:pypi/frigate
    affected_versions: vers:pypi/<0.13.2
    fixed_versions: vers:pypi/0.13.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/frigate/CVE-2024-32874.yml
weaknesses:
  - CWE-770
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/blakeblackshear/frigate
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L1346C46-L1346C55
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L646C25-L646C47
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C9-L684C59
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C42-L705C88
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C38-L728C80
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/security/advisories/GHSA-w4h6-9wrp-v5jq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32874
    reference_type:
    reference_id: CVE-2024-32874
  - url: https://github.com/advisories/GHSA-w4h6-9wrp-v5jq
    reference_type:
    reference_id: GHSA-w4h6-9wrp-v5jq
