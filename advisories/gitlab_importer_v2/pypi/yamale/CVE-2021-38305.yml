advisory_id: pypi/yamale/CVE-2021-38305
datasource_id: gitlab_importer_v2/pypi/yamale/CVE-2021-38305
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/yamale/CVE-2021-38305.yml
aliases:
  - CVE-2021-38305
  - GHSA-435p-f82x-mxwm
summary: |
  Command injection in Yamale
  23andMe Yamale before 3.0.8 allows remote attackers to execute arbitrary code via a crafted schema file. The schema parser uses eval as part of its processing, and tries to protect from malicious expressions by limiting the builtins that are passed to the eval. When processing the schema, each line is run through Python's eval function to make the validator available. A well-constructed string within the schema rules can execute system commands; thus, by exploiting the vulnerability, an attacker can run arbitrary code on the image that invokes Yamale.
impacted_packages:
  - purl: pkg:pypi/yamale
    affected_versions: vers:pypi/<3.0.8
    fixed_versions: vers:pypi/3.0.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/yamale/CVE-2021-38305.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/yamale/CVE-2021-38305.yml
weaknesses:
  - CWE-937
  - CWE-434
  - CWE-1035
  - CWE-78
references:
  - url: https://github.com/23andMe/Yamale
    reference_type:
    reference_id:
  - url: https://github.com/23andMe/Yamale/pull/165
    reference_type:
    reference_id:
  - url: https://github.com/23andMe/Yamale/releases/tag/3.0.8
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-435p-f82x-mxwm
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/yamale/PYSEC-2021-119.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-38305
    reference_type:
    reference_id: CVE-2021-38305
