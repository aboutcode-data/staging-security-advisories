advisory_id: pypi/templated_dictionary/CVE-2023-6395
datasource_id: gitlab_importer_v2/pypi/templated_dictionary/CVE-2023-6395
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/templated_dictionary/CVE-2023-6395.yml
aliases:
  - CVE-2023-6395
  - GHSA-7j98-74jh-cjxh
summary: |
  Privilege escalation for users that can access mock configuration
  The Mock software contains a vulnerability wherein an attacker could potentially exploit privilege escalation, enabling the execution of arbitrary code with root user privileges. This weakness stems from the absence of proper sandboxing during the expansion and execution of Jinja2 templates, which may be included in certain configuration parameters. While the Mock documentation advises treating users added to the mock group as privileged, certain build systems invoking mock on behalf of users might inadvertently permit less privileged users to define configuration tags. These tags could then be passed as parameters to mock during execution, potentially leading to the utilization of Jinja2 templates for remote privilege escalation and the execution of arbitrary code as the root user on the build server.
impacted_packages:
  - purl: pkg:pypi/templated-dictionary
    affected_versions: vers:pypi/<1.4.1
    fixed_versions: vers:pypi/1.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/templated_dictionary/CVE-2023-6395.yml
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://access.redhat.com/security/cve/CVE-2023-6395
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2252206
    reference_type:
    reference_id:
  - url: https://github.com/xsuchy/templated-dictionary
    reference_type:
    reference_id:
  - url: https://github.com/xsuchy/templated-dictionary/commit/0740bd0ca8d487301881541028977d120f8b8933
    reference_type:
    reference_id:
  - url: https://github.com/xsuchy/templated-dictionary/commit/bcd90f0dafa365575c4b101e6f5d98c4ef4e4b69
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/62SP2BJC2AFLFJJAEHPGZ3ZINTBTI7AN
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NBFYREAJH4T7GXXQZ4GJEREN4Q3AHS3K
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-6395
    reference_type:
    reference_id: CVE-2023-6395
  - url: https://github.com/advisories/GHSA-7j98-74jh-cjxh
    reference_type:
    reference_id: GHSA-7j98-74jh-cjxh
