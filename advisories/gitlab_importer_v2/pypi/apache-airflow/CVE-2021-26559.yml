advisory_id: pypi/apache-airflow/CVE-2021-26559
datasource_id: gitlab_importer_v2/pypi/apache-airflow/CVE-2021-26559
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow/CVE-2021-26559.yml
aliases:
  - CVE-2021-26559
  - GHSA-ffw3-6mp6-jmvj
summary: |
  Improper Access Control in Apache Airflow
  Improper Access Control on Configurations Endpoint for the Stable API of Apache Airflow allows users with Viewer or User role to get Airflow Configurations including sensitive information even when `[webserver] expose_config` is set to `False` in `airflow.cfg`. This allowed a privilege escalation attack. This issue affects Apache Airflow 2.0.0.
impacted_packages:
  - purl: pkg:pypi/apache-airflow
    affected_versions: vers:pypi/2.0.0|>=2.0.0|<2.0.1rc1
    fixed_versions: vers:pypi/2.0.1rc1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow/CVE-2021-26559.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow/CVE-2021-26559.yml
weaknesses:
  - CWE-937
  - CWE-269
  - CWE-1035
  - CWE-284
references:
  - url: https://github.com/advisories/GHSA-ffw3-6mp6-jmvj
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/blob/486b76438c0679682cf98cb88ed39c4b161cbcc8/CHANGELOG.txt
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/3909232fafd09ac72b49010ecdfd6ea48f06d5cf
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/5e35926c7eda0dfa11a9623e4bf5f60c2bd6b3f6
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/apache-airflow/PYSEC-2021-2.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r3b3787700279ec361308cbefb7c2cce2acb26891a12ce864e4a13c8d%40%3Cusers.airflow.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/rd142565996d7ee847b9c14b8a9921dcf80bc6bc160e3d9dca6dfc2f8@%3Cannounce.apache.org%3E
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-26559
    reference_type:
    reference_id: CVE-2021-26559
