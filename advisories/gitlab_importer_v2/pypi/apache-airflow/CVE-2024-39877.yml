advisory_id: pypi/apache-airflow/CVE-2024-39877
datasource_id: gitlab_importer_v2/pypi/apache-airflow/CVE-2024-39877
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow/CVE-2024-39877.yml
aliases:
  - CVE-2024-39877
  - GHSA-g5hv-r743-v8pm
summary: |
  Apache Airflow has DAG Author Code Execution possibility in airflow-scheduler
  Apache Airflow 2.4.0, and versions before 2.9.3, has a vulnerability that allows authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context, which should be forbidden according to the Airflow Security model. Users should upgrade to version 2.9.3 or later which has removed the vulnerability.
impacted_packages:
  - purl: pkg:pypi/apache-airflow
    affected_versions: vers:pypi/>=2.4.0|<2.9.3
    fixed_versions: vers:pypi/2.9.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow/CVE-2024-39877.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-277
  - CWE-94
references:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/8159f6e24704f5e0e3b3217cf79ecf5083dce531
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/pull/40522
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/apache-airflow/PYSEC-2024-190.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/1xhj9dkp37d6pzn24ll2mf94wbqnb2y1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-39877
    reference_type:
    reference_id: CVE-2024-39877
  - url: https://github.com/advisories/GHSA-g5hv-r743-v8pm
    reference_type:
    reference_id: GHSA-g5hv-r743-v8pm
