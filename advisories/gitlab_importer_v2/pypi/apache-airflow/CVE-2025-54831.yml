advisory_id: pypi/apache-airflow/CVE-2025-54831
datasource_id: gitlab_importer_v2/pypi/apache-airflow/CVE-2025-54831
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow/CVE-2025-54831.yml
aliases:
  - CVE-2025-54831
  - GHSA-q475-2pgm-7hvp
summary: |
  Apache Airflow: Connection sensitive details exposed to users with READ permissions
  Apache Airflow 3 introduced a change to the handling of sensitive information in Connections. The intent was to restrict access to sensitive connection fields to Connection Editing Users, effectively applying a "write-only" model for sensitive values.

  In Airflow 3.0.3, this model was unintentionally violated: sensitive connection information could be viewed by users with READ permissions through both the API and the UI. This behavior also bypassed the `AIRFLOW__CORE__HIDE_SENSITIVE_VAR_CONN_FIELDS` configuration option.

  This issue does not affect Airflow 2.x, where exposing sensitive information to connection editors was the intended and documented behavior.

  Users of Airflow 3.0.3 are advised to upgrade Airflow to >=3.0.4.
impacted_packages:
  - purl: pkg:pypi/apache-airflow
    affected_versions: vers:pypi/3.0.3|>=3.0.3|<3.0.4
    fixed_versions: vers:pypi/3.0.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow/CVE-2025-54831.yml
weaknesses:
  - CWE-213
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/vblmfqtydrp5zgn2q8tj3slk5podxspf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54831
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-q475-2pgm-7hvp
    reference_type:
    reference_id: GHSA-q475-2pgm-7hvp
