advisory_id: pypi/apache-airflow/CVE-2020-11981
datasource_id: gitlab_importer_v2/pypi/apache-airflow/CVE-2020-11981
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow/CVE-2020-11981.yml
aliases:
  - CVE-2020-11981
  - GHSA-976r-qfjj-c24w
summary: |
  Command injection via Celery broker in Apache Airflow
  An issue was found in Apache Airflow versions 1.10.10 and below. When using CeleryExecutor, if an attacker can connect to the broker (Redis, RabbitMQ) directly, it is possible to inject commands, resulting in the celery worker running arbitrary commands.
impacted_packages:
  - purl: pkg:pypi/apache-airflow
    affected_versions: vers:pypi/<1.10.11rc1
    fixed_versions: vers:pypi/1.10.11rc1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow/CVE-2020-11981.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow/CVE-2020-11981.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://github.com/advisories/GHSA-976r-qfjj-c24w
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/1dda6fdde7c6bcaf0d6534786beeeba868006dd2
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/afa4b11fddfdbadb048f742cf66d5c21c675a5c8
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/apache-airflow/PYSEC-2020-15.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/r7255cf0be3566f23a768e2a04b40fb09e52fcd1872695428ba9afe91%40%3Cusers.airflow.apache.org%3E
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20220427031325/https://issues.apache.org/jira/browse/AIRFLOW-6351
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-11981
    reference_type:
    reference_id: CVE-2020-11981
