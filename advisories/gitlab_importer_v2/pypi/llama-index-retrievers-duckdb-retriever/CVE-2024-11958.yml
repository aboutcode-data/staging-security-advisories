advisory_id: pypi/llama-index-retrievers-duckdb-retriever/CVE-2024-11958
datasource_id: gitlab_importer_v2/pypi/llama-index-retrievers-duckdb-retriever/CVE-2024-11958
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/llama-index-retrievers-duckdb-retriever/CVE-2024-11958.yml
aliases:
  - CVE-2024-11958
  - GHSA-339r-cjv9-x78g
summary: |
  LlamaIndex Retrievers Integration: DuckDBRetriever SQL Injection
  A SQL injection vulnerability exists in the `duckdb_retriever` component of the run-llama/llama_index repository, specifically in llama-index-retrievers-duckdb-retriever prior to v0.4.0. The vulnerability arises from the construction of SQL queries without using prepared statements, allowing an attacker to inject arbitrary SQL code. This can lead to remote code execution (RCE) by installing the shellfs extension and executing malicious commands.
impacted_packages:
  - purl: pkg:pypi/llama-index-retrievers-duckdb-retriever
    affected_versions: vers:pypi/<0.4.0
    fixed_versions: vers:pypi/0.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/llama-index-retrievers-duckdb-retriever/CVE-2024-11958.yml
weaknesses:
  - CWE-89
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/run-llama/llama_index
    reference_type:
    reference_id:
  - url: https://github.com/run-llama/llama_index/commit/35bd221e948e40458052d30c6ef2779bc965b6d0
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/8ddf66e1-f74c-4d53-992b-76bc45cacac1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-11958
    reference_type:
    reference_id: CVE-2024-11958
  - url: https://github.com/advisories/GHSA-339r-cjv9-x78g
    reference_type:
    reference_id: GHSA-339r-cjv9-x78g
