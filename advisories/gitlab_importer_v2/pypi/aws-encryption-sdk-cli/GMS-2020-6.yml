advisory_id: pypi/aws-encryption-sdk-cli/GMS-2020-6
datasource_id: gitlab_importer_v2/pypi/aws-encryption-sdk-cli/GMS-2020-6
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/aws-encryption-sdk-cli/GMS-2020-6.yml
aliases:
  - GHSA-2xwp-m7mq-7q3r
  - GMS-2020-6
summary: |
  CLI does not correctly implement strict mode
  In the affected versions, the AWS Encryption CLI operated in "discovery mode" even when "strict mode" was specified. Although decryption only succeeded if the user had permission to decrypt with at least one of the CMKs, decryption could be successful using a CMK that was not included in the user-defined set when the CLI was operating in "strict mode."

  Affected users should upgrade to Encryption CLI v1.8.x or v2.1.x as soon as possible.
impacted_packages:
  - purl: pkg:pypi/aws-encryption-sdk-cli
    affected_versions: vers:pypi/<1.8.0|>=2.0.0|<2.1.0
    fixed_versions: vers:pypi/1.8.0|2.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/aws/aws-encryption-sdk-cli/commit/7d21b8051cab9e52e056fe427d2bff19cf146460
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-encryption-sdk-cli/security/advisories/GHSA-2xwp-m7mq-7q3r
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-2xwp-m7mq-7q3r
    reference_type:
    reference_id: GHSA-2xwp-m7mq-7q3r
