advisory_id: pypi/invenio-rdm-records/CVE-2021-43781
datasource_id: gitlab_importer_v2/pypi/invenio-rdm-records/CVE-2021-43781
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/invenio-rdm-records/CVE-2021-43781.yml
aliases:
  - CVE-2021-43781
  - GHSA-xr38-w74q-r8jv
summary: |
  Permissions not properly checked in Invenio-Drafts-Resources
  Invenio-Drafts-Resources does not properly check permissions when a record is published. The vulnerability is exploitable in a default installation of InvenioRDM. An authenticated user is able via REST API calls to publish draft records of other users if they know the record identifier and the draft validates (e.g. all require fields filled out). An attacker is not able to modify the data in the record, and thus e.g. *cannot* change a record from restricted to public.
impacted_packages:
  - purl: pkg:pypi/invenio-rdm-records
    affected_versions: vers:pypi/<0.32.6|>=0.33.0|<0.33.10
    fixed_versions: vers:pypi/0.32.6|0.33.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/invenio-rdm-records/CVE-2021-43781.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/invenio-rdm-records/CVE-2021-43781.yml
weaknesses:
  - CWE-937
  - CWE-863
  - CWE-1035
  - CWE-862
references:
  - url: https://github.com/inveniosoftware/invenio-drafts-resources/commit/039b0cff1ad4b952000f4d8c3a93f347108b6626
    reference_type:
    reference_id:
  - url: https://github.com/inveniosoftware/invenio-drafts-resources/security/advisories/GHSA-xr38-w74q-r8jv
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/invenio-app-rdm/PYSEC-2021-837.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/invenio-drafts-resources/PYSEC-2021-836.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43781
    reference_type:
    reference_id: CVE-2021-43781
  - url: https://github.com/advisories/GHSA-xr38-w74q-r8jv
    reference_type:
    reference_id: GHSA-xr38-w74q-r8jv
