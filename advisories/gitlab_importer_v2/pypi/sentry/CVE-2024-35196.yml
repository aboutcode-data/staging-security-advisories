advisory_id: pypi/sentry/CVE-2024-35196
datasource_id: gitlab_importer_v2/pypi/sentry/CVE-2024-35196
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/sentry/CVE-2024-35196.yml
aliases:
  - CVE-2024-35196
  - GHSA-c2g2-gx4j-rj3j
summary: |
  Slack integration leaks sensitive information in logs
  Sentry's Slack integration incorrectly records the incoming request body in logs. This request data can contain sensitive information, including the [deprecated Slack verification token](https://api.slack.com/authentication/verifying-requests-from-slack#deprecation). With this verification token, it is possible under specific configurations, an attacker can forge requests and act as the Slack integration.

  The request body is leaked in log entries matching `event == "slack.*" && name == "sentry.integrations.slack" && request_data == *`. The deprecated slack verification token, will be found in the `request_data.token` key.

  Example event:

  ```json
  {
  "name": "sentry.integrations.slack",
  "level": "info",
  "event": "slack.event.message",  # This could be any of the `slack.*` events
  "request_data": {
impacted_packages:
  - purl: pkg:pypi/sentry
    affected_versions: vers:pypi/>=24.3.0|<24.5.0
    fixed_versions: vers:pypi/24.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/sentry/CVE-2024-35196.yml
weaknesses:
  - CWE-532
  - CWE-1035
  - CWE-937
references:
  - url: https://api.slack.com/authentication/verifying-requests-from-slack#app-management-updates
    reference_type:
    reference_id:
  - url: https://api.slack.com/authentication/verifying-requests-from-slack#deprecation
    reference_type:
    reference_id:
  - url: https://api.slack.com/authentication/verifying-requests-from-slack#regenerating
    reference_type:
    reference_id:
  - url: https://develop.sentry.dev/integrations/slack
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry/blob/17d2b87e39ccd57e11da4deed62971ff306253d1/src/sentry/conf/server.py#L1307
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry/pull/70508
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry/security/advisories/GHSA-c2g2-gx4j-rj3j
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35196
    reference_type:
    reference_id: CVE-2024-35196
  - url: https://github.com/advisories/GHSA-c2g2-gx4j-rj3j
    reference_type:
    reference_id: GHSA-c2g2-gx4j-rj3j
