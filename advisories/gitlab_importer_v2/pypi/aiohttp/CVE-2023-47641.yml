advisory_id: pypi/aiohttp/CVE-2023-47641
datasource_id: gitlab_importer_v2/pypi/aiohttp/CVE-2023-47641
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/aiohttp/CVE-2023-47641.yml
aliases:
  - CVE-2023-47641
  - GHSA-xx9p-xxvh-7g8j
summary: |
  Aiohttp has inconsistent interpretation of `Content-Length` vs. `Transfer-Encoding` differing in C and Python fallbacks
  Aiohttp has a security vulnerability regarding the inconsistent interpretation of the http protocol. As we know that HTTP/1.1 is persistent, if we have both Content-Length(CL) and Transfer-Encoding(TE) it can lead to incorrect interpretation of two entities that parse the HTTP and we can poison other sockets with this incorrect interpretation.

  A possible Proof-of-Concept (POC) would be a configuration with a reverse proxy(frontend) that accepts both CL and TE headers and aiohttp as backend. As aiohttp parses anything with chunked, we can pass a chunked123 as TE, the frontend entity will ignore this header and will parse Content-Length. I can give a Dockerfile with the configuration if you want.

  The impact of this vulnerability is that it is possible to bypass any proxy rule, poisoning sockets to other users like passing Authentication Headers, also if it is present an Open Redirect (just like CVE-2021-21330) we can combine it to redirect random users to our website and log the request.
impacted_packages:
  - purl: pkg:pypi/aiohttp
    affected_versions: vers:pypi/<3.8.0
    fixed_versions: vers:pypi/3.8.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/aiohttp/CVE-2023-47641.yml
weaknesses:
  - CWE-444
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/aio-libs/aiohttp
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/commit/f016f0680e4ace6742b03a70cb0382ce86abe371
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/releases/tag/v3.8.0
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/security/advisories/GHSA-xx9p-xxvh-7g8j
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/aiohttp/PYSEC-2023-247.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/02/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-47641
    reference_type:
    reference_id: CVE-2023-47641
  - url: https://github.com/advisories/GHSA-xx9p-xxvh-7g8j
    reference_type:
    reference_id: GHSA-xx9p-xxvh-7g8j
