advisory_id: pypi/matrix-sydent/CVE-2023-38686
datasource_id: gitlab_importer_v2/pypi/matrix-sydent/CVE-2023-38686
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-sydent/CVE-2023-38686.yml
aliases:
  - CVE-2023-38686
  - GHSA-p6hw-wm59-3g5g
summary: |
  Improper Certificate Validation
  Sydent is an identity server for the Matrix communications protocol. Prior to version 2.5.6, if configured to send emails using TLS, Sydent does not verify SMTP servers' certificates. This makes Sydent's emails vulnerable to interception via a man-in-the-middle (MITM) attack. Attackers with privileged access to the network can intercept room invitations and address confirmation emails. This is patched in Sydent 2.5.6. When patching, make sure that Sydent trusts the certificate of the server it is connecting to. This should happen automatically when using properly issued certificates. Those who use self-signed certificates should make sure to copy their Certification Authority certificate, or their self signed certificate if using only one, to the trust store of your operating system. As a workaround, one can ensure Sydent's emails fail to send by setting the configured SMTP server to a loopback or non-routable address under one's control which does not have a listening SMTP server.
impacted_packages:
  - purl: pkg:pypi/matrix-sydent
    affected_versions: vers:pypi/<2.5.6
    fixed_versions: vers:pypi/2.5.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-sydent/CVE-2023-38686.yml
weaknesses:
  - CWE-295
  - CWE-1035
  - CWE-937
references:
  - url: https://docs.python.org/3/library/ssl.html?highlight=ssl#security-considerations
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/1cd748307c6b168b66154e6c4db715d4b9551261
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/pull/574
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/releases/tag/v2.5.6
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/security/advisories/GHSA-p6hw-wm59-3g5g
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-sydent/PYSEC-2023-139.yaml
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/issues/91826
    reference_type:
    reference_id:
  - url: https://peps.python.org/pep-0476/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38686
    reference_type:
    reference_id: CVE-2023-38686
  - url: https://github.com/advisories/GHSA-p6hw-wm59-3g5g
    reference_type:
    reference_id: GHSA-p6hw-wm59-3g5g
