advisory_id: pypi/matrix-sydent/CVE-2021-29431
datasource_id: gitlab_importer_v2/pypi/matrix-sydent/CVE-2021-29431
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-sydent/CVE-2021-29431.yml
aliases:
  - CVE-2021-29431
  - GHSA-9jhm-8m8c-c3f4
summary: |
  SSRF in Sydent due to missing validation of hostnames
  Sydent is a reference Matrix identity server. Sydent can be induced to send HTTP GET requests to internal systems, due to lack of parameter validation or IP address block listing. It is not possible to exfiltrate data or control request headers, but it might be possible to use the attack to perform an internal port enumeration. This issue has been addressed in in 9e57334, 3d531ed, 0f00412. A potential workaround would be to use a firewall to ensure that Sydent cannot reach internal HTTP resources.
impacted_packages:
  - purl: pkg:pypi/matrix-sydent
    affected_versions: vers:pypi/<2.3.0
    fixed_versions: vers:pypi/2.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-sydent/CVE-2021-29431.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/matrix-sydent/CVE-2021-29431.yml
weaknesses:
  - CWE-937
  - CWE-20
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/matrix-org/sydent
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/0f00412017f25619bc36c264b29ea96808bf310a
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/3d531ed50d2fd41ac387f36d44d3fb2c62dd22d3
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/8936925f561b0c352c2fa922d5097d7245aad00a
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/9e573348d81df8191bbe8c266c01999c9d57cd5f
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/releases/tag/v2.3.0
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/security/advisories/GHSA-9jhm-8m8c-c3f4
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-sydent/PYSEC-2021-22.yaml
    reference_type:
    reference_id:
  - url: https://pypi.org/project/matrix-sydent
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29431
    reference_type:
    reference_id: CVE-2021-29431
  - url: https://github.com/advisories/GHSA-9jhm-8m8c-c3f4
    reference_type:
    reference_id: GHSA-9jhm-8m8c-c3f4
