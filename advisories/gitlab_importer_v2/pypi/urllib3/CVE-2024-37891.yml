advisory_id: pypi/urllib3/CVE-2024-37891
datasource_id: gitlab_importer_v2/pypi/urllib3/CVE-2024-37891
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/urllib3/CVE-2024-37891.yml
aliases:
  - CVE-2024-37891
  - GHSA-34jh-p97f-mpxf
summary: |
  urllib3's Proxy-Authorization request header isn't stripped during cross-origin redirects
  When using urllib3's proxy support with `ProxyManager`, the `Proxy-Authorization` header is only sent to the configured proxy, as expected.

  However, when sending HTTP requests *without* using urllib3's proxy support, it's possible to accidentally configure the `Proxy-Authorization` header even though it won't have any effect as the request is not using a forwarding proxy or a tunneling proxy. In those cases, urllib3 doesn't treat the `Proxy-Authorization` HTTP header as one carrying authentication material and thus doesn't strip the header on cross-origin redirects.

  Because this is a highly unlikely scenario, we believe the severity of this vulnerability is low for almost all users. Out of an abundance of caution urllib3 will automatically strip the `Proxy-Authorization` header during cross-origin redirects to avoid the small chance that users are doing this on accident.

  Users should use urllib3's proxy support or disable automatic redirects to achieve safe processing of the `Proxy-Authorization` header, but we still decided to strip the header by default in order to further protect users who aren't using the correct approach.
impacted_packages:
  - purl: pkg:pypi/urllib3
    affected_versions: vers:pypi/<1.26.19|>=2.0.0|<2.2.2
    fixed_versions: vers:pypi/1.26.19|2.2.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/urllib3/CVE-2024-37891.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-669
references:
  - url: https://github.com/urllib3/urllib3
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/commit/40b6d1605814dd1db0a46e202d6e56f2e4c9a468
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/commit/accff72ecc2f6cf5a76d9570198a93ac7c90270e
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/security/advisories/GHSA-34jh-p97f-mpxf
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/12/msg00020.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240822-0003
    reference_type:
    reference_id:
  - url: https://www.vicarius.io/vsociety/posts/proxy-authorization-header-handling-vulnerability-in-urllib3-cve-2024-37891
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37891
    reference_type:
    reference_id: CVE-2024-37891
  - url: https://github.com/advisories/GHSA-34jh-p97f-mpxf
    reference_type:
    reference_id: GHSA-34jh-p97f-mpxf
