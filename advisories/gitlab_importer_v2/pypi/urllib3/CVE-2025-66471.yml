advisory_id: pypi/urllib3/CVE-2025-66471
datasource_id: gitlab_importer_v2/pypi/urllib3/CVE-2025-66471
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/urllib3/CVE-2025-66471.yml
aliases:
  - CVE-2025-66471
  - GHSA-2xpw-w6gg-jr37
summary: |
  urllib3 streaming API improperly handles highly compressed data
  urllib3's [streaming API](https://urllib3.readthedocs.io/en/2.5.0/advanced-usage.html#streaming-and-i-o) is designed for the efficient handling of large HTTP responses by reading the content in chunks, rather than loading the entire response body into memory at once.

  When streaming a compressed response, urllib3 can perform decoding or decompression based on the HTTP `Content-Encoding` header (e.g., `gzip`, `deflate`, `br`, or `zstd`). The library must read compressed data from the network and decompress it until the requested chunk size is met. Any resulting decompressed data that exceeds the requested amount is held in an internal buffer for the next read operation.

  The decompression logic could cause urllib3 to fully decode a small amount of highly compressed data in a single operation. This can result in excessive resource consumption (high CPU usage and massive memory allocation for the decompressed data; CWE-409) on the client side, even if the application only requested a small chunk of data.
impacted_packages:
  - purl: pkg:pypi/urllib3
    affected_versions: vers:pypi/>=1.0|<2.6.0
    fixed_versions: vers:pypi/2.6.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/urllib3/CVE-2025-66471.yml
weaknesses:
  - CWE-409
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/urllib3/urllib3
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/commit/c19571de34c47de3a766541b041637ba5f716ed7
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/security/advisories/GHSA-2xpw-w6gg-jr37
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66471
    reference_type:
    reference_id: CVE-2025-66471
  - url: https://github.com/advisories/GHSA-2xpw-w6gg-jr37
    reference_type:
    reference_id: GHSA-2xpw-w6gg-jr37
