advisory_id: pypi/borgbackup/CVE-2023-36811
datasource_id: gitlab_importer_v2/pypi/borgbackup/CVE-2023-36811
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/borgbackup/CVE-2023-36811.yml
aliases:
  - CVE-2023-36811
  - GHSA-8fjr-hghr-4m99
summary: |
  Archive spoofing vulnerability in borgbackup
  A flaw in the cryptographic authentication scheme in borgbackup allowed an attacker to fake archives and potentially indirectly cause backup data loss in the repository.

  The attack requires an attacker to be able to

  1. insert files (with no additional headers) into backups
  2. gain write access to the repository

  This vulnerability does not disclose plaintext to the attacker, nor does it affect the authenticity of existing archives.

  Creating plausible fake archives may be feasible for empty or small archives, but is unlikely for large archives.

  Affected are all borgbackup releases prior to 1.2.5.

  Note: CVSS scoring model seemed to badly fit for this case, thus I manually set score to "moderate".
impacted_packages:
  - purl: pkg:pypi/borgbackup
    affected_versions: vers:pypi/<1.2.5
    fixed_versions: vers:pypi/1.2.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/borgbackup/CVE-2023-36811.yml
weaknesses:
  - CWE-347
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/borgbackup/borg
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/blob/1.2.5-cvedocs/docs/changes.rst#pre-125-archives-spoofing-vulnerability-cve-2023-36811
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/blob/1.2.6/docs/changes.rst#pre-125-archives-spoofing-vulnerability-cve-2023-36811
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/3eb070191da10c2d3f7bc6484cf3d51c3045f884
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/security/advisories/GHSA-8fjr-hghr-4m99
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/borgbackup/PYSEC-2023-164.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/5Q3OHXERTU547SEQ3YREZXHOCYNLVD63
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XOZDFIYEBIOKSIEAXUJJJFUJTAJ7TF3C
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZUCQSMAWOJBCRGF6XPKEZ2TPGAPNKIWV
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-36811
    reference_type:
    reference_id: CVE-2023-36811
  - url: https://github.com/advisories/GHSA-8fjr-hghr-4m99
    reference_type:
    reference_id: GHSA-8fjr-hghr-4m99
