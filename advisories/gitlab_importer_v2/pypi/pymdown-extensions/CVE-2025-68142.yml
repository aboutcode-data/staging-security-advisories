advisory_id: pypi/pymdown-extensions/CVE-2025-68142
datasource_id: gitlab_importer_v2/pypi/pymdown-extensions/CVE-2025-68142
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/pymdown-extensions/CVE-2025-68142.yml
aliases:
  - CVE-2025-68142
  - GHSA-r6h4-mm7h-8pmq
summary: |
  PyMdown Extensions has a ReDOS bug in its Figure Capture extension
  The original issue came through PyMdown Extensions' normal issue tracker instead of the typical security flow: https://github.com/facelessuser/pymdown-extensions/issues/2716. Because this came through the normal issue flow, it was handled as a normal issue. In the future, PyMdown Extensions will ensure such issues, even if prematurely made public through the normal issue flow, are redirected through the typical security process.

  The regular expression pattern in question is as follows:

  ```py
  RE_FIG_NUM = re.compile(r'^(\^)?([1-9][0-9]*(?:.[1-9][0-9]*)*)(?= |$)')
  ```

  The POC was provided by @ShangzhiXu

  ```py
  import re
  import time

  regex_pattern = re.compile(r'^(\^)?([1-9][0-9]*(?:.[1-9][0-9]*)*)(?= |$)')

  for i in range(50, 500, 50):
  long_string = '1' * i + 'a'
  start_time = time.time()
  match = re.match(regex_pattern, long_string)
  end_time = time.time()
  print(f"long_string execution time: {end_time - start_time:.6f} s")
  ```

  The issue with the above pattern is that `.` was used, which accepts any character when we meant to use `\.`. The fix was to update the pattern to:

  ```py
  RE_FIG_NUM = re.compile(r'^(\^)?([1-9][0-9]*(?:\.[1-9][0-9]*)*)(?= |$)')
  ```

  Relevant PR with fix: https://github.com/facelessuser/pymdown-extensions/pull/2717
impacted_packages:
  - purl: pkg:pypi/pymdown-extensions
    affected_versions: vers:pypi/<10.16.1
    fixed_versions: vers:pypi/10.16.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/pymdown-extensions/CVE-2025-68142.yml
weaknesses:
  - CWE-1333
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/facelessuser/pymdown-extensions
    reference_type:
    reference_id:
  - url: https://github.com/facelessuser/pymdown-extensions/commit/b50d15a56850ed1408a284bba81cc019c6bd72e8
    reference_type:
    reference_id:
  - url: https://github.com/facelessuser/pymdown-extensions/security/advisories/GHSA-r6h4-mm7h-8pmq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68142
    reference_type:
    reference_id:
  - url: https://pypi.org/project/pymdown-extensions/10.16.1
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-r6h4-mm7h-8pmq
    reference_type:
    reference_id: GHSA-r6h4-mm7h-8pmq
