advisory_id: pypi/keystone/CVE-2020-12690
datasource_id: gitlab_importer_v2/pypi/keystone/CVE-2020-12690
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/keystone/CVE-2020-12690.yml
aliases:
  - CVE-2020-12690
  - GHSA-6m8p-x4qw-gh5j
summary: |
  Insufficient Session Expiration in OpenStack Keystone
  An issue was discovered in OpenStack Keystone before 15.0.1, and 16.0.0. The list of roles provided for an OAuth1 access token is silently ignored. Thus, when an access token is used to request a keystone token, the keystone token contains every role assignment the creator had for the project. This results in the provided keystone token having more role assignments than the creator intended, possibly giving unintended escalated access.
impacted_packages:
  - purl: pkg:pypi/keystone
    affected_versions: vers:pypi/<15.0.1|>=16.0.0.0rc1|<16.0.0
    fixed_versions: vers:pypi/15.0.1|16.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/keystone/CVE-2020-12690.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/keystone/CVE-2020-12690.yml
weaknesses:
  - CWE-1035
  - CWE-613
  - CWE-937
references:
  - url: https://bugs.launchpad.net/keystone/+bug/1873290
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-6m8p-x4qw-gh5j
    reference_type:
    reference_id:
  - url: https://github.com/openstack/keystone
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/keystone/PYSEC-2020-54.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/re4ffc55cd2f1b55a26e07c83b3c22c3fe4bae6054d000a57fb48d8c2@%3Ccommits.druid.apache.org%3E
    reference_type:
    reference_id:
  - url: https://security.openstack.org/ossa/OSSA-2020-005.html
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4480-1
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2020/05/06/6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-12690
    reference_type:
    reference_id: CVE-2020-12690
