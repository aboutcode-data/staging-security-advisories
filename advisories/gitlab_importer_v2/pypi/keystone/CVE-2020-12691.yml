advisory_id: pypi/keystone/CVE-2020-12691
datasource_id: gitlab_importer_v2/pypi/keystone/CVE-2020-12691
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/keystone/CVE-2020-12691.yml
aliases:
  - CVE-2020-12691
  - GHSA-4427-7f3w-mqv6
summary: |
  OpenStack Keystone V3 /credentials endpoint policy logic allows to change credentials owner or target project ID
  An issue was discovered in OpenStack Keystone before 15.0.1, and 16.0.0. Any authenticated user can create an EC2 credential for themselves for a project that they have a specified role on, and then perform an update to the credential user and project, allowing them to masquerade as another user. This potentially allows a malicious user to act as the admin on a project another user has the admin role on, which can effectively grant that user global admin privileges.
impacted_packages:
  - purl: pkg:pypi/keystone
    affected_versions: vers:pypi/<15.0.1|16.0.0|>=16.0.0|<16.0.1
    fixed_versions: vers:pypi/15.0.1|16.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/keystone/CVE-2020-12691.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/keystone/CVE-2020-12691.yml
weaknesses:
  - CWE-311
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://bugs.launchpad.net/keystone/+bug/1872733
    reference_type:
    reference_id:
  - url: https://github.com/openstack/keystone
    reference_type:
    reference_id:
  - url: https://github.com/openstack/keystone/commit/37e9907a176dad6843819b1bec4946c3aecc4548
    reference_type:
    reference_id:
  - url: https://github.com/openstack/keystone/commit/40cbb7bebd50276412daa1981ff5a7c7b3b899a5
    reference_type:
    reference_id:
  - url: https://github.com/openstack/keystone/commit/95b2bbeab113d9f04d1c81f7f1b48bf692bce979
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/keystone/PYSEC-2020-55.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/re237267da268c690df5e1c6ea6a38a7fc11617725e8049490f58a6fa@%3Ccommits.druid.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/re4ffc55cd2f1b55a26e07c83b3c22c3fe4bae6054d000a57fb48d8c2@%3Ccommits.druid.apache.org%3E
    reference_type:
    reference_id:
  - url: https://security.openstack.org/ossa/OSSA-2020-004.html
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4480-1
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2020/05/06/5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-12691
    reference_type:
    reference_id: CVE-2020-12691
  - url: https://github.com/advisories/GHSA-4427-7f3w-mqv6
    reference_type:
    reference_id: GHSA-4427-7f3w-mqv6
