advisory_id: pypi/yt-dlp/GHSA-3v33-3wmw-3785
datasource_id: gitlab_importer_v2/pypi/yt-dlp/GHSA-3v33-3wmw-3785
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/yt-dlp/GHSA-3v33-3wmw-3785.yml
aliases:
  - GHSA-3v33-3wmw-3785
summary: |
  yt-dlp has dependency on potentially malicious third-party code in Douyu extractors
  yt-dlp's DouyuTV and DouyuShow extractors used a `cdn.bootcdn.net` URL as a fallback for fetching a component of the crypto-js JavaScript library. When the Douyu extractor is used, yt-dlp extracts this JavaScript code and attempts to execute it externally using [PhantomJS](https://github.com/ariya/phantomjs). `bootcdn.net` is owned by the bad actor responsible for the [Polyfill JS supply chain attack](https://sansec.io/research/polyfill-supply-chain-attack) that has been ongoing since at least June 2023. While there is no evidence that PhantomJS has been targeted by or is vulnerable to any attacks carried out by the Polyfill JS actor, there is the possibility that malicious JavaScript code may have been downloaded/cached by yt-dlp or executed by PhantomJS.

  In order for this potential vulnerability to be exploited by any hypothetical attack, all 3 of the following conditions must be met:
  1. The user has PhantomJS installed on their system.
  2. The user passes a `douyu.com` or `douyutv.com` URL to yt-dlp as input, or passes a URL that redirects to one of these domains.
  3. `cdnjs.cloudflare.com` is unavailable or blocked at the time of extraction, necessitating the usage of the `cdn.bootcdn.net` fallback; or it had been unavailable during a previous run of the Douyu extractor and JavaScript code from `cdn.bootcdn.net` had been cached to disk.
impacted_packages:
  - purl: pkg:pypi/yt-dlp
    affected_versions: vers:pypi/>=2023.9.24|<2024.7.7
    fixed_versions: vers:pypi/2024.7.7
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/yt-dlp/yt-dlp
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/commit/6075a029dba70a89675ae1250e7cdfd91f0eba41
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-3v33-3wmw-3785
    reference_type:
    reference_id:
  - url: https://sansec.io/research/polyfill-supply-chain-attack
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-3v33-3wmw-3785
    reference_type:
    reference_id: GHSA-3v33-3wmw-3785
