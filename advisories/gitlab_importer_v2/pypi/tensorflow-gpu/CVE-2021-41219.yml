advisory_id: pypi/tensorflow-gpu/CVE-2021-41219
datasource_id: gitlab_importer_v2/pypi/tensorflow-gpu/CVE-2021-41219
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-gpu/CVE-2021-41219.yml
aliases:
  - CVE-2021-41219
  - GHSA-4f99-p9c2-3j8x
summary: |
  Undefined behavior via `nullptr` reference binding in sparse matrix multiplication
  The [code for sparse matrix multiplication](https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/sparse_matmul_op.cc#L954-L1086) is vulnerable to undefined behavior via binding a reference to `nullptr`:

  ```python
  import tensorflow as tf

  tf.raw_ops.SparseMatMul(
  a=[[1.0,1.0,1.0]],
  b=[[],[],[]],
  transpose_a=False,
  transpose_b=False,
  a_is_sparse=False,
  b_is_sparse=True)
  ```

  This occurs whenever the dimensions of `a` or `b` are 0 or less. In the case on one of these is 0, an empty output tensor should be allocated (to conserve the invariant that output tensors are always allocated when the operation is successful) but nothing should be written to it (that is, we should return early from the kernel implementation). Otherwise, attempts to write to this empty tensor would result in heap OOB access.
impacted_packages:
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/<2.4.4|>=2.5.0|<2.5.2|>=2.6.0|<2.6.1
    fixed_versions: vers:pypi/2.4.4|2.5.2|2.6.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-gpu/CVE-2021-41219.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-gpu/CVE-2021-41219.yml
weaknesses:
  - CWE-824
  - CWE-1035
  - CWE-125
  - CWE-937
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-628.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-826.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-411.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/e6cf28c72ba2eb949ca950d834dd6d66bb01cfae
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-4f99-p9c2-3j8x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41219
    reference_type:
    reference_id: CVE-2021-41219
  - url: https://github.com/advisories/GHSA-4f99-p9c2-3j8x
    reference_type:
    reference_id: GHSA-4f99-p9c2-3j8x
