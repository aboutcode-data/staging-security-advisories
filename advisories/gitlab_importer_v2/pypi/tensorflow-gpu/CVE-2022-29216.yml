advisory_id: pypi/tensorflow-gpu/CVE-2022-29216
datasource_id: gitlab_importer_v2/pypi/tensorflow-gpu/CVE-2022-29216
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-gpu/CVE-2022-29216.yml
aliases:
  - CVE-2022-29216
  - GHSA-75c9-jrh4-79mc
summary: |
  Improper Control of Generation of Code ('Code Injection')
  TensorFlow is an open source platform for machine learning. Prior to versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4, TensorFlow's `saved_model_cli` tool is vulnerable to a code injection. This can be used to open a reverse shell. This code path was maintained for compatibility reasons as the maintainers had several test cases where numpy expressions were used as arguments. However, given that the tool is always run manually, the impact of this is still not severe. The maintainers have now removed the `safe=False` argument, so all parsing is done without calling `eval`. The patch is available in versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4.
impacted_packages:
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/<2.6.4|>=2.7.0|<2.7.2|>=2.8.0|<2.8.1
    fixed_versions: vers:pypi/2.6.4|2.7.2|2.8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-gpu/CVE-2022-29216.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-gpu/CVE-2022-29216.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
  - CWE-94
references:
  - url: https://github.com/tensorflow/tensorflow/blob/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/python/tools/saved_model_cli.py#L566-L574
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/8b202f08d52e8206af2bdb2112a62fafbc546ec7
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/c5da7af048611aa29e9382371f0aed5018516cac
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/releases/tag/v2.6.4
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/releases/tag/v2.7.2
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/releases/tag/v2.8.1
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/releases/tag/v2.9.0
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-75c9-jrh4-79mc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29216
    reference_type:
    reference_id: CVE-2022-29216
  - url: https://github.com/advisories/GHSA-75c9-jrh4-79mc
    reference_type:
    reference_id: GHSA-75c9-jrh4-79mc
