advisory_id: pypi/tensorflow-gpu/CVE-2021-41228
datasource_id: gitlab_importer_v2/pypi/tensorflow-gpu/CVE-2021-41228
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-gpu/CVE-2021-41228.yml
aliases:
  - CVE-2021-41228
  - GHSA-3rcw-9p9x-582v
summary: |
  Code injection in `saved_model_cli`
  TensorFlow's `saved_model_cli` tool is vulnerable to a code injection as it [calls `eval` on user supplied strings](https://github.com/tensorflow/tensorflow/blob/87462bfac761435a46641ff2f10ad0b6e5414a4b/tensorflow/python/tools/saved_model_cli.py#L524-L550)

  ```python
  def preprocess_input_exprs_arg_string(input_exprs_str):
  ...
  for input_raw in filter(bool, input_exprs_str.split(';')):
  ...
  input_key, expr = input_raw.split('=', 1)
  input_dict[input_key] = eval(expr)
  ...
  ```

  This can be used by attackers to run arbitrary code on the plaform where the CLI tool runs.
  However, given that the tool is always run manually, the impact of this is not severe. We have patched this by adding a `safe` flag which defaults to `True` and an explicit warning for users.
impacted_packages:
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/<2.4.4|>=2.5.0|<2.5.2|>=2.6.0|<2.6.1
    fixed_versions: vers:pypi/2.4.4|2.5.2|2.6.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-gpu/CVE-2021-41228.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-gpu/CVE-2021-41228.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
  - CWE-94
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-637.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-835.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-420.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/8b202f08d52e8206af2bdb2112a62fafbc546ec7
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-3rcw-9p9x-582v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41228
    reference_type:
    reference_id: CVE-2021-41228
  - url: https://github.com/advisories/GHSA-3rcw-9p9x-582v
    reference_type:
    reference_id: GHSA-3rcw-9p9x-582v
