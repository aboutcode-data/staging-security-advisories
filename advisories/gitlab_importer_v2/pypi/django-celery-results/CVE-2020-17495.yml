advisory_id: pypi/django-celery-results/CVE-2020-17495
datasource_id: gitlab_importer_v2/pypi/django-celery-results/CVE-2020-17495
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/django-celery-results/CVE-2020-17495.yml
aliases:
  - CVE-2020-17495
  - GHSA-fvx8-v524-8579
summary: |
  django-celery-results Stores Sensitive Information In Cleartext
  django-celery-results prior to 2.4.0 stores task results in the database. Among the data it stores are the variables passed into the tasks. The variables may contain sensitive cleartext information that does not belong unencrypted in the database.

  In version 2.4.0 this is no longer the default behaviour but can be re-enabled with the `result_extended` flag in which case care should be taken to ensure any sensitive variables are scrubbed - see [here](https://github.com/celery/django-celery-results/issues/154#issuecomment-734706270) for an example.
impacted_packages:
  - purl: pkg:pypi/django-celery-results
    affected_versions: vers:pypi/<2.4.0
    fixed_versions: vers:pypi/2.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/django-celery-results/CVE-2020-17495.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/django-celery-results/CVE-2020-17495.yml
weaknesses:
  - CWE-312
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/advisories/GHSA-fvx8-v524-8579
    reference_type:
    reference_id:
  - url: https://github.com/celery/django-celery-results
    reference_type:
    reference_id:
  - url: https://github.com/celery/django-celery-results/commit/ad508fe3433499e5fc94645412d911e174863f28
    reference_type:
    reference_id:
  - url: https://github.com/celery/django-celery-results/issues/142
    reference_type:
    reference_id:
  - url: https://github.com/celery/django-celery-results/issues/154
    reference_type:
    reference_id:
  - url: https://github.com/celery/django-celery-results/pull/316
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/django-celery-results/PYSEC-2020-38.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-17495
    reference_type:
    reference_id: CVE-2020-17495
