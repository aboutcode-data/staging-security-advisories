advisory_id: pypi/authlib/CVE-2025-61920
datasource_id: gitlab_importer_v2/pypi/authlib/CVE-2025-61920
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/authlib/CVE-2025-61920.yml
aliases:
  - CVE-2025-61920
  - GHSA-pq5p-34cr-23v9
summary: |
  Authlib is vulnerable to Denial of Service via Oversized JOSE Segments
  **Summary**
  Authlib’s JOSE implementation accepts unbounded JWS/JWT header and signature segments. A remote attacker can craft a token whose base64url‑encoded header or signature spans hundreds of megabytes. During verification, Authlib decodes and parses the full input before it is rejected, driving CPU and memory consumption to hostile levels and enabling denial of service.

  **Impact**

  - Attack vector: unauthenticated network attacker submits a malicious JWS/JWT.

  - Effect: base64 decode + JSON/crypto processing of huge buffers pegs CPU and allocates large amounts of RAM; a single request can exhaust service capacity.

  - Observed behaviour: on a test host, the legacy code verified a 500 MB header, consuming ~4 GB RSS and ~9 s CPU before failing.

  - Severity: High. CVSS v3.1: AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H (7.5).

  Affected Versions
  Authlib ≤ 1.6.3 (and earlier) when verifying JWS/JWT tokens. Later snapshots with 256 KB header/signature limits are not affected.

  **Proof of concept**
impacted_packages:
  - purl: pkg:pypi/authlib
    affected_versions: vers:pypi/<1.6.5
    fixed_versions: vers:pypi/1.6.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/authlib/CVE-2025-61920.yml
weaknesses:
  - CWE-770
  - CWE-400
  - CWE-20
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/authlib/authlib
    reference_type:
    reference_id:
  - url: https://github.com/authlib/authlib/commit/867e3f87b072347a1ae9cf6983cc8bbf88447e5e
    reference_type:
    reference_id:
  - url: https://github.com/authlib/authlib/security/advisories/GHSA-pq5p-34cr-23v9
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00032.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-61920
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-pq5p-34cr-23v9
    reference_type:
    reference_id: GHSA-pq5p-34cr-23v9
