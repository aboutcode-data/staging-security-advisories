advisory_id: pypi/jupyterlab-git/CVE-2025-30370
datasource_id: gitlab_importer_v2/pypi/jupyterlab-git/CVE-2025-30370
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/jupyterlab-git/CVE-2025-30370.yml
aliases:
  - CVE-2025-30370
  - GHSA-cj5w-8mjf-r5f8
summary: |
  jupyterlab-git has a command injection vulnerability in "Open Git Repository in Terminal"
  ## Overview

  On many platforms, a third party can create a Git repository under a name that includes a shell command substitution [^1] string in the syntax `$(<command>)`. These directory names are allowed in macOS and a majority of Linux distributions [^2]. If a user starts `jupyter-lab` in a parent directory of this inappropriately-named Git repository, opens it, and clicks "Git > Open Git Repository in Terminal" from the menu bar, then the injected command `<command>` is run in the user's shell without the user's permission.

  This issue is occurring because when that menu entry is clicked, `jupyterlab-git` opens the terminal and runs `cd <git-repo-path>` through the shell to set the current directory [^3]. Doing so runs any command substitution strings present in the directory name, which leads to the command injection issue described here. A previous patch provided an incomplete fix [^4].
impacted_packages:
  - purl: pkg:pypi/jupyterlab-git
    affected_versions: vers:pypi/<0.51.1
    fixed_versions: vers:pypi/0.51.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:L/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/jupyterlab-git/CVE-2025-30370.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://github.com/jupyterlab/jupyterlab-git
    reference_type:
    reference_id:
  - url: https://github.com/jupyterlab/jupyterlab-git/blob/7eb3b06f0092223bd5494688ec264527bbeb2195/src/commandsAndMenu.tsx#L175-L184
    reference_type:
    reference_id:
  - url: https://github.com/jupyterlab/jupyterlab-git/commit/b46482993f76d3a546015c6a94ebed8b77fc2376
    reference_type:
    reference_id:
  - url: https://github.com/jupyterlab/jupyterlab-git/pull/1196
    reference_type:
    reference_id:
  - url: https://github.com/jupyterlab/jupyterlab-git/security/advisories/GHSA-cj5w-8mjf-r5f8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-30370
    reference_type:
    reference_id: CVE-2025-30370
  - url: https://github.com/advisories/GHSA-cj5w-8mjf-r5f8
    reference_type:
    reference_id: GHSA-cj5w-8mjf-r5f8
