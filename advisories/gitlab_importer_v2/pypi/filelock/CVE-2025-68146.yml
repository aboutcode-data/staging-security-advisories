advisory_id: pypi/filelock/CVE-2025-68146
datasource_id: gitlab_importer_v2/pypi/filelock/CVE-2025-68146
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/filelock/CVE-2025-68146.yml
aliases:
  - CVE-2025-68146
  - GHSA-w853-jp5j-5j7f
summary: |
  filelock has a TOCTOU race condition which allows symlink attacks during lock file creation
  A Time-of-Check-Time-of-Use (TOCTOU) race condition allows local attackers to corrupt or truncate arbitrary user files through symlink attacks. The vulnerability exists in both Unix and Windows lock file creation where filelock checks if a file exists before opening it with O_TRUNC. An attacker can create a symlink pointing to a victim file in the time gap between the check and open, causing os.open() to follow the symlink and truncate the target file.

  **Who is impacted:**

  All users of filelock on Unix, Linux, macOS, and Windows systems. The vulnerability cascades to dependent libraries:

  - **virtualenv users**: Configuration files can be overwritten with virtualenv metadata, leaking sensitive paths
  - **PyTorch users**: CPU ISA cache or model checkpoints can be corrupted, causing crashes or ML pipeline failures
  - **poetry/tox users**: through using virtualenv or filelock on their own.

  Attack requires local filesystem access and ability to create symlinks (standard user permissions on Unix; Developer Mode on Windows 10+). Exploitation succeeds within 1-3 attempts when lock file paths are predictable.
impacted_packages:
  - purl: pkg:pypi/filelock
    affected_versions: vers:pypi/<3.20.1
    fixed_versions: vers:pypi/3.20.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/filelock/CVE-2025-68146.yml
weaknesses:
  - CWE-937
  - CWE-59
  - CWE-362
  - CWE-1035
  - CWE-367
references:
  - url: https://github.com/tox-dev/filelock
    reference_type:
    reference_id:
  - url: https://github.com/tox-dev/filelock/commit/4724d7f8c3393ec1f048c93933e6e3e6ec321f0e
    reference_type:
    reference_id:
  - url: https://github.com/tox-dev/filelock/releases/tag/3.20.1
    reference_type:
    reference_id:
  - url: https://github.com/tox-dev/filelock/security/advisories/GHSA-w853-jp5j-5j7f
    reference_type:
    reference_id:
  - url: https://learn.microsoft.com/en-us/windows/win32/fileio/file-attribute-constants
    reference_type:
    reference_id:
  - url: https://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68146
    reference_type:
    reference_id: CVE-2025-68146
  - url: https://github.com/advisories/GHSA-w853-jp5j-5j7f
    reference_type:
    reference_id: GHSA-w853-jp5j-5j7f
