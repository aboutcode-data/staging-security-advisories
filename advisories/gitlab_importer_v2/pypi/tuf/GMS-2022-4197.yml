advisory_id: pypi/tuf/GMS-2022-4197
datasource_id: gitlab_importer_v2/pypi/tuf/GMS-2022-4197
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tuf/GMS-2022-4197.yml
aliases:
  - GHSA-r7vq-6425-j94w
  - GMS-2022-4197
summary: |
  Python-TUF vulnerable to incorrect threshold signature computation for new root metadata
  The function _verify_root_self_signed(), introduced in v0.14.0, and which verifies self-signatures in a new root metadata file, counted multiple signatures by any new root key towards the new threshold. That is, any single new root key could theoretically provide enough signatures to meet the threshold for new key self-signatures required during root metadata update.
  A scenario where this attack could be relevant is amazingly unlikely in practice to the point where labeling this issue as a security advisory is potentially overstating the impact of the issue. Given that new root keys only become trusted by the client after a successful root metadata update, which also requires the quorum of signatures from old trusted root keys, this issue has been evaluated as low in severity.
impacted_packages:
  - purl: pkg:pypi/tuf
    affected_versions: vers:pypi/>=0.14.0|<=0.15.0
    fixed_versions: vers:pypi/0.16.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/theupdateframework/python-tuf/pull/1218
    reference_type:
    reference_id:
  - url: https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-r7vq-6425-j94w
    reference_type:
    reference_id:
  - url: https://github.com/theupdateframework/tuf/pull/1101
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-r7vq-6425-j94w
    reference_type:
    reference_id: GHSA-r7vq-6425-j94w
