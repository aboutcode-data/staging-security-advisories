advisory_id: pypi/azure-cli/CVE-2022-39327
datasource_id: gitlab_importer_v2/pypi/azure-cli/CVE-2022-39327
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/azure-cli/CVE-2022-39327.yml
aliases:
  - CVE-2022-39327
  - GHSA-47xc-9rr2-q7p4
summary: |
  Improper Control of Generation of Code ('Code Injection') in Azure CLI
  In versions previous to 2.40.0, Azure CLI contains a vulnerability for potential code injection. Critical scenarios are where a hosting machine runs an Azure CLI command where parameter values have been provided by an external source.

  For example: Application X is a web application with a feature that allows users to create Secrets in an Azure KeyVault. Instead of constructing API calls based on user input, Application X uses Azure CLI commands to create the secrets. Application X has input fields presented to the user and the Azure CLI command parameter values are filled based on the user input fields. This input, when formed correctly, could potentially be run as system commands. Below is an example of the resulting Azure CLI command run on the web app's hosting machine.

  ```bash
  az keyvault secret set --vault-name SomeVault --name foobar --value "abc123|whoami"
  ```

  The above command could potentially run the `whoami` command on the hosting machine.

  Interactive, in-terminal use and automation/pipeline scenarios have not been identified as critical risk scenarios.
impacted_packages:
  - purl: pkg:pypi/azure-cli
    affected_versions: vers:pypi/<2.40.0
    fixed_versions: vers:pypi/2.40.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/azure-cli/CVE-2022-39327.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
  - CWE-94
references:
  - url: https://github.com/Azure/azure-cli
    reference_type:
    reference_id:
  - url: https://github.com/Azure/azure-cli/pull/23514
    reference_type:
    reference_id:
  - url: https://github.com/Azure/azure-cli/pull/24015
    reference_type:
    reference_id:
  - url: https://github.com/Azure/azure-cli/security/advisories/GHSA-47xc-9rr2-q7p4
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/azure-cli/PYSEC-2022-43177.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39327
    reference_type:
    reference_id: CVE-2022-39327
  - url: https://github.com/advisories/GHSA-47xc-9rr2-q7p4
    reference_type:
    reference_id: GHSA-47xc-9rr2-q7p4
