advisory_id: pypi/fastapi-proxy-lib/GMS-2023-5457
datasource_id: gitlab_importer_v2/pypi/fastapi-proxy-lib/GMS-2023-5457
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/fastapi-proxy-lib/GMS-2023-5457.yml
aliases:
  - GHSA-7vwr-g6pm-9hc8
  - GMS-2023-5457
summary: |
  Cookie leakage between different users in fastapi-proxy-lib
  ### Impact

  In the implementation of version `0.0.1`, requests from different user clients are processed using a shared `httpx.AsyncClient`.

  However, one oversight is that the `httpx.AsyncClient` will persistently store cookies based on the `set-cookie` response header sent by the target server and share these cookies across different user requests.

  This results in a cookie leakage issue among all user clients sharing the same `httpx.AsyncClient`.

  ### Patches

  It's fixed in `0.1.0`

  ### Workarounds

  If you insist `0.0.1`:
  - Do not use `ForwardHttpProxy` at all.
  - Do not use `ReverseHttpProxy` or `ReverseWebSocketProxy` for any servers that may potentially send a `set-cookie` response.

  **However, it's best to upgrade to the latest version.**

  ### References

  fixed in [#10](https://github.com/WSH032/fastapi-proxy-lib/pull/10)
impacted_packages:
  - purl: pkg:pypi/fastapi-proxy-lib
    affected_versions: vers:pypi/<0.1.0
    fixed_versions: vers:pypi/0.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/WSH032/fastapi-proxy-lib/pull/10
    reference_type:
    reference_id:
  - url: https://github.com/WSH032/fastapi-proxy-lib/security/advisories/GHSA-7vwr-g6pm-9hc8
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-7vwr-g6pm-9hc8
    reference_type:
    reference_id: GHSA-7vwr-g6pm-9hc8
