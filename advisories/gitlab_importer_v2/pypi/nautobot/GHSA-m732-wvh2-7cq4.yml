advisory_id: pypi/nautobot/GHSA-m732-wvh2-7cq4
datasource_id: gitlab_importer_v2/pypi/nautobot/GHSA-m732-wvh2-7cq4
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/nautobot/GHSA-m732-wvh2-7cq4.yml
aliases:
  - GHSA-m732-wvh2-7cq4
summary: |
  Unauthenticated views may expose information to anonymous users
  A number of Nautobot URL endpoints were found to be improperly accessible to unauthenticated (anonymous) users, including the following:

  - `/api/graphql/` (1)
  - `/api/users/users/session/` (Nautobot 2.x only; the only information exposed to an anonymous user is which authentication backend classes are enabled on this Nautobot instance)
  - `/dcim/racks/<uuid:pk>/dynamic-groups/` (1)
  - `/dcim/devices/<uuid:pk>/dynamic-groups/` (1)
  - `/extras/job-results/<uuid:pk>/log-table/`
  - `/extras/secrets/provider/<str:provider_slug>/form/` (the only information exposed to an anonymous user is the fact that a secrets provider with the given slug (e.g. `environment-variable` or `text-file`) is supported by this Nautobot instance)
  - `/ipam/prefixes/<uuid:pk>/dynamic-groups/` (1)
  - `/ipam/ip-addresses/<uuid:pk>/dynamic-groups/` (1)
  - `/virtualization/clusters/<uuid:pk>/dynamic-groups/` (1)
  - `/virtualization/virtual-machines/<uuid:pk>/dynamic-groups/` (1)

  (1) These endpoints will not disclose any Nautobot data to an unauthenticated user unless the Nautobot configuration variable `EXEMPT_VIEW_PERMISSIONS` is changed from its default value (an empty list) to permit access to specific data by unauthenticated users.

  Of these endpoints, the only one that poses any significant risk of sensitive information disclosure under normal Nautobot operation with a default configuration is `/extras/job-results/<uuid:pk>/log-table/`. This endpoint returns an HTML table containing all of the logs associated with the specified JobResult; while these logs may contain sensitive information depending on the Jobs executed in Nautobot, this exposure is mitigated somewhat by the fact that any attacker would have to have prior knowledge of the existence of a JobResult with a particular UUID.

  In the interest of full disclosure, the following additional endpoints were also accessible to anonymous users, but do not disclose any sensitive data when accessed (only a listing of other API endpoints).

  - `/api/`
  - `/api/circuits/`
  - `/api/dcim/`
  - `/api/extras/`
  - `/api/ipam/`
  - `/api/plugins/`
  - `/api/tenancy/`
  - `/api/users/`
  - `/api/virtualization/`

  All of the above endpoints have been corrected to require user authentication, with the exception of `/api/users/users/session/` which is unused at this time and therefore has been simply removed from Nautobot 2.1.9. Additionally, we have added test automation which enumerates available Nautobot URL endpoints and verifies that appropriate authentication requirements are in place; this test was instrumental in identifying the above comprehensive list.
impacted_packages:
  - purl: pkg:pypi/nautobot
    affected_versions: vers:pypi/<1.6.16|>=2.0.0|<2.1.9
    fixed_versions: vers:pypi/1.6.16|2.1.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/nautobot/GHSA-m732-wvh2-7cq4.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/nautobot/nautobot
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/commit/2fd95c365f8477b26e06d60b999ddd36882d5750
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/commit/dd623e6c3307f48b6357fcc91925bcad5192abfb
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/pull/5464
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/pull/5465
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/releases/tag/v1.6.16
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/releases/tag/v2.1.9
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/security/advisories/GHSA-m732-wvh2-7cq4
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-m732-wvh2-7cq4
    reference_type:
    reference_id: GHSA-m732-wvh2-7cq4
