advisory_id: pypi/nautobot/CVE-2023-25657
datasource_id: gitlab_importer_v2/pypi/nautobot/CVE-2023-25657
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/nautobot/CVE-2023-25657.yml
aliases:
  - CVE-2023-25657
  - GHSA-8mfq-f5wj-vw5m
summary: |
  Nautobot vulnerable to remote code execution via Jinja2 template rendering
  _What kind of vulnerability is it? Who is impacted?_

  All users of Nautobot versions earlier than 1.5.7 are impacted.

  In Nautobot 1.5.7 we have enabled sandboxed environments for the Jinja2 template engine used internally for template rendering for the following objects:

  - `extras.ComputedField`
  - `extras.CustomLink`
  - `extras.ExportTemplate`
  - `extras.Secret`
  - `extras.Webhook`

  While we are not aware of any active exploits, we have made this change as a preventative measure to protect against any potential remote code execution attacks utilizing maliciously crafted template code.

  This change forces the Jinja2 template engine to use a [`SandboxedEnvironment`](https://jinja.palletsprojects.com/en/3.0.x/sandbox/#sandbox) on all new installations of Nautobot.

  This addresses any potential unsafe code execution everywhere the helper function `nautobot.utilities.utils.render_jinja2` is called. Additionally, our documentation that was previously suggesting the direct use of `jinja2.Template` has been revised to utilize `render_jinja2`.
impacted_packages:
  - purl: pkg:pypi/nautobot
    affected_versions: vers:pypi/<1.5.7
    fixed_versions: vers:pypi/1.5.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/nautobot/CVE-2023-25657.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://docs.nautobot.com/projects/core/en/stable/release-notes/version-1.5/#v157-2023-01-04
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/commit/d47f157e83b0c353bb2b697f911882c71cf90ca0
    reference_type:
    reference_id:
  - url: https://github.com/nautobot/nautobot/security/advisories/GHSA-8mfq-f5wj-vw5m
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/nautobot/PYSEC-2023-37.yaml
    reference_type:
    reference_id:
  - url: https://jinja.palletsprojects.com/en/3.0.x/sandbox/#sandbox
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-25657
    reference_type:
    reference_id: CVE-2023-25657
  - url: https://github.com/advisories/GHSA-8mfq-f5wj-vw5m
    reference_type:
    reference_id: GHSA-8mfq-f5wj-vw5m
