advisory_id: pypi/keras/GHSA-77wq-646f-jrm2
datasource_id: gitlab_importer_v2/pypi/keras/GHSA-77wq-646f-jrm2
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/keras/GHSA-77wq-646f-jrm2.yml
aliases:
  - GHSA-77wq-646f-jrm2
summary: |
  Duplicate Advisory: The Keras `Model.load_model` method **silently** ignores `safe_mode=True` and allows arbitrary code execution when a `.h5`/`.hdf5` file is loaded.
  ### Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-36rr-ww3j-vrjv. This link is maintained to preserve external references.

  ### Original Description
  The Keras Model.load_model method can be exploited to achieve arbitrary code execution, even with safe_mode=True.

  One can create a specially crafted .h5/.hdf5 model archive that, when loaded via Model.load_model, will trigger arbitrary code to be executed.

  This is achieved by crafting a special .h5 archive file that uses the Lambda layer feature of keras which allows arbitrary Python code in the form of pickled code. The vulnerability comes from the fact that the safe_mode=True option is not honored when reading .h5 archives.

  Note that the .h5/.hdf5 format is a legacy format supported by Keras 3 for backwards compatibility.
impacted_packages:
  - purl: pkg:pypi/keras
    affected_versions: vers:pypi/>=3.0.0|<3.11.3
    fixed_versions: vers:pypi/3.11.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/keras/GHSA-77wq-646f-jrm2.yml
weaknesses:
  - CWE-913
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/keras-team/keras
    reference_type:
    reference_id:
  - url: https://github.com/keras-team/keras/pull/21602
    reference_type:
    reference_id:
  - url: https://github.com/keras-team/keras/security/advisories/GHSA-36rr-ww3j-vrjv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-9905
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-77wq-646f-jrm2
    reference_type:
    reference_id: GHSA-77wq-646f-jrm2
