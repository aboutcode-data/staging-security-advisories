advisory_id: pypi/elastic-apm/CVE-2021-37941
datasource_id: gitlab_importer_v2/pypi/elastic-apm/CVE-2021-37941
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/elastic-apm/CVE-2021-37941.yml
aliases:
  - CVE-2021-37941
summary: |
  Improper Privilege Management
  A local privilege escalation issue was found with the APM Java agent, where a user on the system could attach a malicious file to an application running with the APM Java agent. Using this vector, a malicious or compromised user account could use the agent to run commands at a higher level of permissions than they possess. This vulnerability affects users that have set up the agent via the attacher cli 3, the attach API 2, as well as users that have enabled the `profiling_inferred_spans_enabled` option
impacted_packages:
  - purl: pkg:pypi/elastic-apm
    affected_versions: vers:pypi/>=1.10.0|<=1.26.0
    fixed_versions: vers:pypi/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/elastic-apm/CVE-2021-37941.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/elastic-apm/CVE-2021-37941.yml
weaknesses:
  - CWE-269
  - CWE-1035
  - CWE-937
references:
  - url: https://discuss.elastic.co/t/apm-java-agent-security-update/289627
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37941
    reference_type:
    reference_id: CVE-2021-37941
