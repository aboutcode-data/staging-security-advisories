advisory_id: pypi/safety/CVE-2020-5252
datasource_id: gitlab_importer_v2/pypi/safety/CVE-2020-5252
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/safety/CVE-2020-5252.yml
aliases:
  - CVE-2020-5252
  - GHSA-7q25-qrjw-6fg2
summary: |
  Malicious package may avoid detection in python auditing
  # Python Auditing Vulnerability

  Demonstrates how a malicious package can insert a load-time poison pill to avoid detection by tools like Safety.

  Tools that are designed to find vulnerable packages can not ever run in the same python environment that they are trying to protect.

  ## Usage

  Install `safety`, `insecure-package`, and this package with pip in the same python environment. Order doesn&amp;#39;t matter.

  1. pip install safety
  2. pip install insecure-package
  3. pip install dist/malicious-0.1-py3-none-any.whl

  Run the check

  4. `safety check`

  You should see both `Running my modified safety.check` and that `insecure-package` is not listed in the results!


  ## How it Works

  Everything in Python is mutable. The trick is getting some code to run at interpreter load time in order to do some patching.

  1. When you install this package, the `setup.py` settings installs a `malicious.pth` file to your `site-packages` directory.
  2. The `malicious.pth` file gets loaded anytime Python starts, which in turn imports our `malicious` package.
  3. The `malicious/__init__.py` patches the safety library with a custom function to avoid detection.
impacted_packages:
  - purl: pkg:pypi/safety
    affected_versions: vers:pypi/<1.9.0
    fixed_versions: vers:pypi/1.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/safety/CVE-2020-5252.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/safety/CVE-2020-5252.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-807
references:
  - url: https://github.com/akoumjian/python-safety-vuln
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/safety/PYSEC-2020-101.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pyupio/safety
    reference_type:
    reference_id:
  - url: https://github.com/pyupio/safety/security/advisories/GHSA-7q25-qrjw-6fg2
    reference_type:
    reference_id:
  - url: https://mulch.dev/blog/CVE-2020-5252-python-safety-vuln
    reference_type:
    reference_id:
  - url: https://pyup.io/posts/patched-vulnerability
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5252
    reference_type:
    reference_id: CVE-2020-5252
  - url: https://github.com/advisories/GHSA-7q25-qrjw-6fg2
    reference_type:
    reference_id: GHSA-7q25-qrjw-6fg2
