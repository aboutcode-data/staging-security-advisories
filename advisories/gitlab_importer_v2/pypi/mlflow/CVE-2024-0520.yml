advisory_id: pypi/mlflow/CVE-2024-0520
datasource_id: gitlab_importer_v2/pypi/mlflow/CVE-2024-0520
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/mlflow/CVE-2024-0520.yml
aliases:
  - CVE-2024-0520
  - GHSA-5q6c-ffvg-xcm9
summary: |
  Remote code execution in mlflow
  A vulnerability in mlflow/mlflow version 8.2.1 allows for remote code execution due to improper neutralization of special elements used in an OS command ('Command Injection') within the `mlflow.data.http_dataset_source.py` module. Specifically, when loading a dataset from a source URL with an HTTP scheme, the filename extracted from the `Content-Disposition` header or the URL path is used to generate the final file path without proper sanitization. This flaw enables an attacker to control the file path fully by utilizing path traversal or absolute path techniques, such as '../../tmp/poc.txt' or '/tmp/poc.txt', leading to arbitrary file write. Exploiting this vulnerability could allow a malicious user to execute commands on the vulnerable machine, potentially gaining access to data and model information. The issue is fixed in version 2.9.0.
impacted_packages:
  - purl: pkg:pypi/mlflow
    affected_versions: vers:pypi/<2.9.0
    fixed_versions: vers:pypi/2.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/mlflow/CVE-2024-0520.yml
weaknesses:
  - CWE-23
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/mlflow/mlflow
    reference_type:
    reference_id:
  - url: https://github.com/mlflow/mlflow/commit/400c226953b4568f4361bc0a0c223511652c2b9d
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/mlflow/PYSEC-2024-239.yaml
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/93e470d7-b6f0-409b-af63-49d3e2a26dbc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-0520
    reference_type:
    reference_id: CVE-2024-0520
  - url: https://github.com/advisories/GHSA-5q6c-ffvg-xcm9
    reference_type:
    reference_id: GHSA-5q6c-ffvg-xcm9
