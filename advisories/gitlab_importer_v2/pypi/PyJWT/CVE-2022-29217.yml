advisory_id: pypi/PyJWT/CVE-2022-29217
datasource_id: gitlab_importer_v2/pypi/PyJWT/CVE-2022-29217
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/PyJWT/CVE-2022-29217.yml
aliases:
  - CVE-2022-29217
  - GHSA-ffqj-6fqr-9h24
summary: |
  Key confusion through non-blocklisted public key formats
  _What kind of vulnerability is it? Who is impacted?_

  Disclosed by Aapo Oksman (Senior Security Specialist, Nixu Corporation).

  > PyJWT supports multiple different JWT signing algorithms. With JWT, an
  > attacker submitting the JWT token can choose the used signing algorithm.
  >
  > The PyJWT library requires that the application chooses what algorithms
  > are supported. The application can specify
  > "jwt.algorithms.get_default_algorithms()" to get support for all
  > algorithms. They can also specify a single one of them (which is the
  > usual use case if calling jwt.decode directly. However, if calling
  > jwt.decode in a helper function, all algorithms might be enabled.)
  >
  > For example, if the user chooses "none" algorithm and the JWT checker
  > supports that, there will be no signature checking. This is a common
  > security issue with some JWT implementations.
  >
  > PyJWT combats this by requiring that the if the "none" algorithm is
  > used, the key has to be empty. As the key is given by the application
  > running the checker, attacker cannot force "none" cipher to be used.
  >
  > Similarly with HMAC (symmetric) algorithm, PyJWT checks that the key is
  > not a public key meant for asymmetric algorithm i.e. HMAC cannot be used
  > if the key begins with "ssh-rsa". If HMAC is used with a public key, the
  > attacker can just use the publicly known public key to sign the token
  > and the checker would use the same key to verify.
  >
  >  From PyJWT 2.0.0 onwards, PyJWT supports ed25519 asymmetric algorithm.
  > With ed25519, PyJWT supports public keys that start with "ssh-", for
  > example "ssh-ed25519".

  ```python
  import jwt
  from cryptography.hazmat.primitives import serialization
  from cryptography.hazmat.primitives.asymmetric import ed25519
impacted_packages:
  - purl: pkg:pypi/pyjwt
    affected_versions: vers:pypi/>=1.5.0|<2.4.0
    fixed_versions: vers:pypi/2.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/PyJWT/CVE-2022-29217.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/PyJWT/CVE-2022-29217.yml
weaknesses:
  - CWE-1035
  - CWE-327
  - CWE-937
references:
  - url: https://github.com/jpadilla/pyjwt
    reference_type:
    reference_id:
  - url: https://github.com/jpadilla/pyjwt/commit/9c528670c455b8d948aff95ed50e22940d1ad3fc
    reference_type:
    reference_id:
  - url: https://github.com/jpadilla/pyjwt/releases/tag/2.4.0
    reference_type:
    reference_id:
  - url: https://github.com/jpadilla/pyjwt/security/advisories/GHSA-ffqj-6fqr-9h24
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pyjwt/PYSEC-2022-202.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/5PK7IQCBVNLYJEFTPHBBPFP72H4WUFNX
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6HIYEYZRQEP6QTHT3EHH3RGFYJIHIMAO
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29217
    reference_type:
    reference_id: CVE-2022-29217
  - url: https://github.com/advisories/GHSA-ffqj-6fqr-9h24
    reference_type:
    reference_id: GHSA-ffqj-6fqr-9h24
