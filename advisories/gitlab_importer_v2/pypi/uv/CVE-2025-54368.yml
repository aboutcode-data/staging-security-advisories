advisory_id: pypi/uv/CVE-2025-54368
datasource_id: gitlab_importer_v2/pypi/uv/CVE-2025-54368
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/uv/CVE-2025-54368.yml
aliases:
  - CVE-2025-54368
  - GHSA-8qf3-x8v5-2pj8
summary: |
  uv allows ZIP payload obfuscation through parsing differentials
  In versions 0.8.5 and earlier of uv, remote ZIP archives were handled in a streamwise fashion, and file entries were not reconciled against the archive's central directory. This enabled two parser differentials against other Python package installers:

  1. An attacker could contrive a ZIP archive that would extract with legitimate contents on some package installers, and malicious contents on others due to multiple local file entries. The attacker could choose which installer to target.
  2. An attacker could contrive a "stacked" ZIP input with multiple internal ZIPs, which would be handled differently by different package installers. The attacker could choose which installer to target.

  In both cases, the outcome is that an attacker can produce a ZIP with a consistent digest that expands differently with different installers.

  The [ZIP standard](https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT) is ambiguous with respect to these behavior differentials. Consequently, these same differentials may be accepted ZIP parsers other than those used in uv. This advisory is for uv in particular, but all consumers of ZIP-based Python package distributions, e.g., pip, are potentially susceptible to similar parser differentials in other ZIP parsers.

  The practical impact of these differentials is limited by a number of factors:

  - To be compromised via this vulnerability, user interaction of some sort is required. In particular, the user must run `uv install $package` with an attacker-controlled `$package`.
  - When using wheel distributions, installation of the malicious package is not sufficient for execution of malicious code, the vicim would need to perform a separate invocation, e.g., `python -c "import $package"`.
  - If a ZIP-based source distribution (which are less common than tarball source distributions), is encountered, malicious code can be executed during package resolution or installation. uv may invoke the malicious code when building the source distribution into a wheel.
  - The practical impact of these differentials is limited by a coordinated fix to [Warehouse](https://github.com/pypi/warehouse), PyPI's backend: Warehouse now rejects ZIPs exhibiting these differentials, limiting the ability of an attacker to distribute malicious ZIP distributions via PyPI. As part of that coordinated fix, a review of Warehouse revealed no evidence of exploitation.
impacted_packages:
  - purl: pkg:pypi/uv
    affected_versions: vers:pypi/<0.8.6
    fixed_versions: vers:pypi/0.8.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/uv/CVE-2025-54368.yml
weaknesses:
  - CWE-937
  - CWE-20
  - CWE-1035
  - CWE-436
references:
  - url: https://astral.sh/blog/uv-security-advisory-cve-2025-54368
    reference_type:
    reference_id:
  - url: https://blog.pypi.org/posts/2025-08-07-wheel-archive-confusion-attacks
    reference_type:
    reference_id:
  - url: https://github.com/astral-sh/uv
    reference_type:
    reference_id:
  - url: https://github.com/astral-sh/uv/commit/7f1eaf48c193e045ca2c62c4581048765c55505f
    reference_type:
    reference_id:
  - url: https://github.com/astral-sh/uv/security/advisories/GHSA-8qf3-x8v5-2pj8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54368
    reference_type:
    reference_id: CVE-2025-54368
  - url: https://github.com/advisories/GHSA-8qf3-x8v5-2pj8
    reference_type:
    reference_id: GHSA-8qf3-x8v5-2pj8
