advisory_id: pypi/scrapy/GHSA-cg34-w3fm-82h3
datasource_id: gitlab_importer_v2/pypi/scrapy/GHSA-cg34-w3fm-82h3
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/scrapy/GHSA-cg34-w3fm-82h3.yml
aliases:
  - GHSA-cg34-w3fm-82h3
summary: |
  Duplicate Advisory: Scrapy leaks the authorization header on same-domain but cross-origin redirects
  ## Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-4qqq-9vqf-3h3f. This link is maintained to preserve external references.

  ## Original Description
  In scrapy/scrapy, an issue was identified where the Authorization header is not removed during redirects that only change the scheme (e.g., HTTPS to HTTP) but remain within the same domain. This behavior contravenes the Fetch standard, which mandates the removal of Authorization headers in cross-origin requests when the scheme, host, or port changes. Consequently, when a redirect downgrades from HTTPS to HTTP, the Authorization header may be inadvertently exposed in plaintext, leading to potential sensitive information disclosure to unauthorized actors. The flaw is located in the _build_redirect_request function of the redirect middleware.
impacted_packages:
  - purl: pkg:pypi/scrapy
    affected_versions: vers:pypi/<2.11.2
    fixed_versions: vers:pypi/2.11.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/scrapy/GHSA-cg34-w3fm-82h3.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/scrapy/scrapy/commit/1d0502f25bbe55a22899af915623fda1aaeb9dd8
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/27f6a021-a891-446a-ada5-0226d619dd1a
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-1968
    reference_type:
    reference_id: CVE-2024-1968
  - url: https://github.com/advisories/GHSA-cg34-w3fm-82h3
    reference_type:
    reference_id: GHSA-cg34-w3fm-82h3
