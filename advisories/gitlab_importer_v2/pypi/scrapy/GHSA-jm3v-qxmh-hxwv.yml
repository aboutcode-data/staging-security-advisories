advisory_id: pypi/scrapy/GHSA-jm3v-qxmh-hxwv
datasource_id: gitlab_importer_v2/pypi/scrapy/GHSA-jm3v-qxmh-hxwv
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/scrapy/GHSA-jm3v-qxmh-hxwv.yml
aliases:
  - GHSA-jm3v-qxmh-hxwv
summary: |
  Scrapy's redirects ignoring scheme-specific proxy settings
  When using system proxy settings, which are scheme-specific (i.e. specific to `http://` or `https://` URLs), Scrapy was not accounting for scheme changes during redirects.

  For example, an HTTP request would use the proxy configured for HTTP and, when redirected to an HTTPS URL, the new HTTPS request would still use the proxy configured for HTTP instead of switching to the proxy configured for HTTPS. Same the other way around.

  If you have different proxy configurations for HTTP and HTTPS in your system for security reasons (e.g., maybe you donâ€™t want one of your proxy providers to be aware of the URLs that you visit with the other one), this would be a security issue.
impacted_packages:
  - purl: pkg:pypi/scrapy
    affected_versions: vers:pypi/<2.11.2
    fixed_versions: vers:pypi/2.11.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/scrapy/GHSA-jm3v-qxmh-hxwv.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/scrapy/scrapy
    reference_type:
    reference_id:
  - url: https://github.com/scrapy/scrapy/commit/1d0502f25bbe55a22899af915623fda1aaeb9dd8
    reference_type:
    reference_id:
  - url: https://github.com/scrapy/scrapy/issues/767
    reference_type:
    reference_id:
  - url: https://github.com/scrapy/scrapy/security/advisories/GHSA-jm3v-qxmh-hxwv
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-jm3v-qxmh-hxwv
    reference_type:
    reference_id: GHSA-jm3v-qxmh-hxwv
