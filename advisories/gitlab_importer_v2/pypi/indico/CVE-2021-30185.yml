advisory_id: pypi/indico/CVE-2021-30185
datasource_id: gitlab_importer_v2/pypi/indico/CVE-2021-30185
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/indico/CVE-2021-30185.yml
aliases:
  - CVE-2021-30185
  - GHSA-wgpj-7c2j-vfjm
summary: |
  Indico Tampering with links (e.g. password reset) in sent emails
  An external audit of the Indico codebase has discovered a vulnerability in Indico's URL generation logic which could have allowed an attacker to make Indico send a password reset link with a valid token pointing to an attacker-controlled domain by sending that domain in the `Host` header. Had a user clicked such a link without realizing it does not point to Indico (and that they never requested it), it would have revealed their password reset token to the attacker, allowing them to reset the password for that user and thus take over their Indico account.

  - If the web server already enforces a canonical host name, this cannot be exploited (this was not part of the default config from the Indico setup guide)
  - If only SSO is used ([`LOCAL_IDENTITIES`](https://docs.getindico.io/en/stable/config/settings/#LOCAL_IDENTITIES) set to `False`), the vulnerability cannot be exploited for password reset links, but other links in emails set by Indico could be tampered with in the same way (with less problematic impact though)
impacted_packages:
  - purl: pkg:pypi/indico
    affected_versions: vers:pypi/<2.3.4
    fixed_versions: vers:pypi/2.3.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/indico/CVE-2021-30185.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/indico/CVE-2021-30185.yml
weaknesses:
  - CWE-640
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/advisories/GHSA-wgpj-7c2j-vfjm
    reference_type:
    reference_id:
  - url: https://github.com/indico/indico/releases/tag/v2.3.4
    reference_type:
    reference_id:
  - url: https://github.com/indico/indico/security/advisories/GHSA-wgpj-7c2j-vfjm
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/indico/PYSEC-2021-18.yaml
    reference_type:
    reference_id:
  - url: https://www.shorebreaksecurity.com/blog
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-30185
    reference_type:
    reference_id: CVE-2021-30185
