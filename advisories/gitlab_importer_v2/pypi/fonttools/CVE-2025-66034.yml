advisory_id: pypi/fonttools/CVE-2025-66034
datasource_id: gitlab_importer_v2/pypi/fonttools/CVE-2025-66034
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/fonttools/CVE-2025-66034.yml
aliases:
  - CVE-2025-66034
  - GHSA-768j-98cg-p3fv
summary: |
  fontTools is Vulnerable to Arbitrary File Write and XML injection in fontTools.varLib
  The `fonttools varLib` (or `python3 -m fontTools.varLib`) script has an arbitrary file write vulnerability that leads to remote code execution when a malicious .designspace file is processed. The vulnerability affects the `main()` code path of `fontTools.varLib`, used by the fonttools varLib CLI and any code that invokes `fontTools.varLib.main()`.

  The vulnerability exists due to unsanitised filename handling combined with content injection. Attackers can write files to arbitrary filesystem locations via path traversal sequences, and inject malicious code (like PHP) into the output files through XML injection in labelname elements. When these files are placed in web-accessible locations and executed, this achieves remote code execution without requiring any elevated privileges. Once RCE is obtained, attackers can further escalate privileges to compromise system files (like overwriting `/etc/passwd`).

  Overall this allows attackers to:
  - Write font files to arbitrary locations on the filesystem
  - Overwrite configuration files
  - Corrupt application files and dependencies
  - Obtain remote code execution

  The attacker controls the file location, extension and contents which could lead to remote code execution as well as enabling a denial of service through file corruption means.
impacted_packages:
  - purl: pkg:pypi/fonttools
    affected_versions: vers:pypi/>=4.33.0|<4.60.2
    fixed_versions: vers:pypi/4.60.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/fonttools/CVE-2025-66034.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-91
references:
  - url: https://github.com/fonttools/fonttools
    reference_type:
    reference_id:
  - url: https://github.com/fonttools/fonttools/commit/a696d5ba93270d5954f98e7cab5ddca8a02c1e32
    reference_type:
    reference_id:
  - url: https://github.com/fonttools/fonttools/security/advisories/GHSA-768j-98cg-p3fv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66034
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-768j-98cg-p3fv
    reference_type:
    reference_id: GHSA-768j-98cg-p3fv
