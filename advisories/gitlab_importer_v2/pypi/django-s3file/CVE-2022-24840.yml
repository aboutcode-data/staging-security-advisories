advisory_id: pypi/django-s3file/CVE-2022-24840
datasource_id: gitlab_importer_v2/pypi/django-s3file/CVE-2022-24840
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/django-s3file/CVE-2022-24840.yml
aliases:
  - CVE-2022-24840
  - GHSA-4w8f-hjm9-xwgf
summary: |
  Path Traversal in django-s3file
  It was possible to traverse the entire AWS S3 bucket and in most cases to access or delete files.
  The issue was discovered by the maintainer. There were no reports of the vulnerability
  being known to or exploited by a third party, before the release of the patch.

  If the `AWS_LOCATION` setting was set, traversal was limited to that location only.
  If all your files handling views (like form views) require authentication or special permission, the thread is limited to privileged users.
impacted_packages:
  - purl: pkg:pypi/django-s3file
    affected_versions: vers:pypi/<5.5.1
    fixed_versions: vers:pypi/5.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/django-s3file/CVE-2022-24840.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/django-s3file/CVE-2022-24840.yml
weaknesses:
  - CWE-96
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/codingjoe/django-s3file
    reference_type:
    reference_id:
  - url: https://github.com/codingjoe/django-s3file/commit/68ccd2c621a40eb66fdd6af2be9d5fcc9c373318
    reference_type:
    reference_id:
  - url: https://github.com/codingjoe/django-s3file/releases/tag/5.5.1
    reference_type:
    reference_id:
  - url: https://github.com/codingjoe/django-s3file/security/advisories/GHSA-4w8f-hjm9-xwgf
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/django-s3file/PYSEC-2022-208.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24840
    reference_type:
    reference_id: CVE-2022-24840
  - url: https://github.com/advisories/GHSA-4w8f-hjm9-xwgf
    reference_type:
    reference_id: GHSA-4w8f-hjm9-xwgf
