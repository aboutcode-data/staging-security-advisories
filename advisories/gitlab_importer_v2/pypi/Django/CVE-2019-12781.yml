advisory_id: pypi/Django/CVE-2019-12781
datasource_id: gitlab_importer_v2/pypi/Django/CVE-2019-12781
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Django/CVE-2019-12781.yml
aliases:
  - CVE-2019-12781
  - GHSA-6c7v-2f49-8h26
summary: |
  Django Incorrect HTTP detection with reverse-proxy connecting via HTTPS
  An issue was discovered in Django 1.11 before 1.11.22, 2.1 before 2.1.10, and 2.2 before 2.2.3. An HTTP request is not redirected to HTTPS when the SECURE_PROXY_SSL_HEADER and SECURE_SSL_REDIRECT settings are used, and the proxy connects to Django via HTTPS. In other words, django.http.HttpRequest.scheme has incorrect behavior when a client uses HTTP.
impacted_packages:
  - purl: pkg:pypi/django
    affected_versions: vers:pypi/>=1.11|<1.11.22|>=2.1|<2.1.10|>=2.2|<2.2.3
    fixed_versions: vers:pypi/1.11.22|2.1.10|2.2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Django/CVE-2019-12781.yml
  - score:
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Django/CVE-2019-12781.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-319
references:
  - url: https://docs.djangoproject.com/en/dev/releases/security
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-6c7v-2f49-8h26
    reference_type:
    reference_id:
  - url: https://github.com/django/django
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/django/PYSEC-2019-10.yaml
    reference_type:
    reference_id:
  - url: https://groups.google.com/forum/#!topic/django-announce/Is4kLY9ZcZQ
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/5VXXWIOQGXOB7JCGJ3CVUW673LDHKEYL
    reference_type:
    reference_id:
  - url: https://seclists.org/bugtraq/2019/Jul/10
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20190705-0002
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4043-1
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2019/dsa-4476
    reference_type:
    reference_id:
  - url: https://www.djangoproject.com/weblog/2019/jul/01/security-releases
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-12781
    reference_type:
    reference_id: CVE-2019-12781
