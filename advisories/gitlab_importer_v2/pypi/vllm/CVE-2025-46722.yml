advisory_id: pypi/vllm/CVE-2025-46722
datasource_id: gitlab_importer_v2/pypi/vllm/CVE-2025-46722
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vllm/CVE-2025-46722.yml
aliases:
  - CVE-2025-46722
  - GHSA-c65p-x677-fgj6
summary: |
  vLLM has a Weakness in MultiModalHasher Image Hashing Implementation
  In the file `vllm/multimodal/hasher.py`, the `MultiModalHasher` class has a security and data integrity issue in its image hashing method. Currently, it serializes `PIL.Image.Image` objects using only `obj.tobytes()`, which returns only the raw pixel data, without including metadata such as the imageâ€™s shape (width, height, mode). As a result, two images of different sizes (e.g., 30x100 and 100x30) with the same pixel byte sequence could generate the same hash value. This may lead to hash collisions, incorrect cache hits, and even data leakage or security risks.
impacted_packages:
  - purl: pkg:pypi/vllm
    affected_versions: vers:pypi/>=0.7.0|<0.9.0
    fixed_versions: vers:pypi/0.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/vllm/CVE-2025-46722.yml
weaknesses:
  - CWE-1288
  - CWE-1035
  - CWE-1023
  - CWE-937
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/vllm/PYSEC-2025-43.yaml
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/commit/99404f53c72965b41558aceb1bc2380875f5d848
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/pull/17378
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/security/advisories/GHSA-c65p-x677-fgj6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-46722
    reference_type:
    reference_id: CVE-2025-46722
  - url: https://github.com/advisories/GHSA-c65p-x677-fgj6
    reference_type:
    reference_id: GHSA-c65p-x677-fgj6
