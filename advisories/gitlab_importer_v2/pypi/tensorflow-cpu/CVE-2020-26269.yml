advisory_id: pypi/tensorflow-cpu/CVE-2020-26269
datasource_id: gitlab_importer_v2/pypi/tensorflow-cpu/CVE-2020-26269
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-cpu/CVE-2020-26269.yml
aliases:
  - CVE-2020-26269
  - GHSA-9jjw-hf72-3mxw
summary: |
  TensorFlow vulnerable to heap out of bounds read in filesystem glob matching
  The general implementation for matching filesystem paths to globbing pattern is vulnerable to an access out of bounds of [the array holding the directories](https://github.com/tensorflow/tensorflow/blob/458c6260265c46ebaf18052d6c61aea4b6b40926/tensorflow/core/platform/file_system_helper.cc#L127):

  ```cc
  if (!fs->Match(child_path, dirs[dir_index])) { ... }
  ```

  Since `dir_index` is [unconditionaly incremented](https://github.com/tensorflow/tensorflow/blob/458c6260265c46ebaf18052d6c61aea4b6b40926/tensorflow/core/platform/file_system_helper.cc#L106) outside of the lambda function where the vulnerable pattern occurs, this results in an access out of bounds issue under certain scenarios. For example, if `/tmp/x` is a directory that only contains a single file `y`, then the following scenario will cause a crash due to the out of bounds read:

  ```python
  >>> tf.io.gfile.glob('/tmp/x/')
  Segmentation fault
  ```

  There are multiple invariants and preconditions that are assumed by the parallel implementation of `GetMatchingPaths` but are not verified by the PRs introducing it ([#40861](https://github.com/tensorflow/tensorflow/pull/40861) and [#44310](https://github.com/tensorflow/tensorflow/pull/44310)). Thus, we are completely rewriting the implementation to fully specify and validate these.
impacted_packages:
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/>=2.4.0rc0|<2.4.0
    fixed_versions: vers:pypi/2.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-cpu/CVE-2020-26269.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-cpu/CVE-2020-26269.yml
weaknesses:
  - CWE-1035
  - CWE-125
  - CWE-937
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2020-300.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2020-335.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2020-141.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/blob/458c6260265c46ebaf18052d6c61aea4b6b40926/tensorflow/core/platform/file_system_helper.cc#L106
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/blob/458c6260265c46ebaf18052d6c61aea4b6b40926/tensorflow/core/platform/file_system_helper.cc#L127
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/8b5b9dc96666a3a5d27fad7179ff215e3b74b67c
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/pull/40861
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/pull/44310
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-9jjw-hf72-3mxw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-26269
    reference_type:
    reference_id: CVE-2020-26269
  - url: https://github.com/advisories/GHSA-9jjw-hf72-3mxw
    reference_type:
    reference_id: GHSA-9jjw-hf72-3mxw
