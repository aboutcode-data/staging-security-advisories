advisory_id: pypi/Pillow/GMS-2022-347
datasource_id: gitlab_importer_v2/pypi/Pillow/GMS-2022-347
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Pillow/GMS-2022-347.yml
aliases:
  - GHSA-4fx9-vc88-q2xc
  - GMS-2022-347
summary: |
  Infinite loop in Pillow
  JpegImagePlugin may append an EOF marker to the end of a truncated file, so that the last segment of the data will still be processed by the decoder.

  If the EOF marker is not detected as such however, this could lead to an infinite loop where JpegImagePlugin keeps trying to end the file.
impacted_packages:
  - purl: pkg:pypi/pillow
    affected_versions: vers:pypi/<9.0.0
    fixed_versions: vers:pypi/9.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/python-pillow/Pillow/commit/baae9ec4b67c68e3adaf1208cf54e8de5e38a6fd
    reference_type:
    reference_id:
  - url: https://pillow.readthedocs.io/en/stable/releasenotes/9.0.0.html#ensure-jpegimageplugin-stops-at-the-end-of-a-truncated-file
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-4fx9-vc88-q2xc
    reference_type:
    reference_id: GHSA-4fx9-vc88-q2xc
