advisory_id: pypi/Pillow/CVE-2021-28678
datasource_id: gitlab_importer_v2/pypi/Pillow/CVE-2021-28678
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Pillow/CVE-2021-28678.yml
aliases:
  - CVE-2021-28678
  - GHSA-hjfx-8p6c-g7gx
summary: |
  Insufficient Verification of Data Authenticity in Pillow
  An issue was discovered in Pillow before 8.2.0. For BLP data, BlpImagePlugin did not properly check that reads (after jumping to file offsets) returned data. This could lead to a DoS where the decoder could be run a large number of times on empty data.
impacted_packages:
  - purl: pkg:pypi/pillow
    affected_versions: vers:pypi/>=5.1.0|<8.2.0
    fixed_versions: vers:pypi/8.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Pillow/CVE-2021-28678.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Pillow/CVE-2021-28678.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-345
references:
  - url: https://github.com/advisories/GHSA-hjfx-8p6c-g7gx
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pillow/PYSEC-2021-94.yaml
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow/pull/5377
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow/pull/5377/commits/496245aa4365d0827390bd0b6fbd11287453b3a1
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MQHA5HAIBOYI3R6HDWCLAGFTIQP767FL
    reference_type:
    reference_id:
  - url: https://pillow.readthedocs.io/en/stable/releasenotes/8.2.0.html#cve-2021-28678-fix-blp-dos
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202107-33
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28678
    reference_type:
    reference_id: CVE-2021-28678
