advisory_id: pypi/confidant/CVE-2024-45793
datasource_id: gitlab_importer_v2/pypi/confidant/CVE-2024-45793
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/confidant/CVE-2024-45793.yml
aliases:
  - CVE-2024-45793
  - GHSA-rxq8-q85f-m866
summary: |
  Prevent XSS from Confidant API call
  _What kind of vulnerability is it? Who is impacted?_
  Potential XSS from API calls below:
  GET <app>/v1/credentials
  GET <app>/v1/credentials/<id>
  GET <app>/v1/archive/credentials/<id>
  GET <app>/v1/archive/credentials
  POST <app>/v1/credentials
  PUT <app>/v1/credentials/<id>
  PUT <app>/v1/credentials/<id>/<to_revision>

  GET <app>/v1/services
  GET <app>/v1/services/<id>
  GET <app>/v1/archive/services/<id>
  GET <app>/v1/archive/services
  PUT <app>/v1/services/<id>
  PUT <app>/v1/services/<id>/<to_revision>

  Stored XSS that can only be used as a stored HTML injection. The attacker needs to be authenticated and have privileges to create new credentials, but could use this to show information and run scripts to other users into the same Confidant instance.
impacted_packages:
  - purl: pkg:pypi/confidant
    affected_versions: vers:pypi/<6.6.2
    fixed_versions: vers:pypi/6.6.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/confidant/CVE-2024-45793.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/lyft/confidant
    reference_type:
    reference_id:
  - url: https://github.com/lyft/confidant/commit/8876b07abde0c8d2a4974f79b60562b6d0193db9
    reference_type:
    reference_id:
  - url: https://github.com/lyft/confidant/security/advisories/GHSA-rxq8-q85f-m866
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/2332004
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/2456673
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/2476542
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45793
    reference_type:
    reference_id: CVE-2024-45793
  - url: https://github.com/advisories/GHSA-rxq8-q85f-m866
    reference_type:
    reference_id: GHSA-rxq8-q85f-m866
