advisory_id: pypi/Werkzeug/CVE-2023-23934
datasource_id: gitlab_importer_v2/pypi/Werkzeug/CVE-2023-23934
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Werkzeug/CVE-2023-23934.yml
aliases:
  - CVE-2023-23934
  - GHSA-px8h-6qxv-m22q
summary: |
  Incorrect parsing of nameless cookies leads to __Host- cookies bypass
  Browsers may allow "nameless" cookies that look like `=value` instead of `key=value`. A vulnerable browser may allow a compromised application on an adjacent subdomain to exploit this to set a cookie like `=__Host-test=bad` for another subdomain.

  Werkzeug <= 2.2.2 will parse the cookie `=__Host-test=bad` as `__Host-test=bad`. If a Werkzeug application is running next to a vulnerable or malicious subdomain which sets such a cookie using a vulnerable browser, the Werkzeug application will see the bad cookie value but the valid cookie key.
impacted_packages:
  - purl: pkg:pypi/werkzeug
    affected_versions: vers:pypi/<2.2.3
    fixed_versions: vers:pypi/2.2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/Werkzeug/CVE-2023-23934.yml
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/pallets/werkzeug
    reference_type:
    reference_id:
  - url: https://github.com/pallets/werkzeug/commit/cf275f42acad1b5950c50ffe8ef58fe62cdce028
    reference_type:
    reference_id:
  - url: https://github.com/pallets/werkzeug/releases/tag/2.2.3
    reference_type:
    reference_id:
  - url: https://github.com/pallets/werkzeug/security/advisories/GHSA-px8h-6qxv-m22q
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/werkzeug/PYSEC-2023-57.yaml
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230818-0003
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2023/dsa-5470
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-23934
    reference_type:
    reference_id: CVE-2023-23934
  - url: https://github.com/advisories/GHSA-px8h-6qxv-m22q
    reference_type:
    reference_id: GHSA-px8h-6qxv-m22q
