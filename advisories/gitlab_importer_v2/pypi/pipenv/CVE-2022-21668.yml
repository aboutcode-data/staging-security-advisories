advisory_id: pypi/pipenv/CVE-2022-21668
datasource_id: gitlab_importer_v2/pypi/pipenv/CVE-2022-21668
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/pipenv/CVE-2022-21668.yml
aliases:
  - CVE-2022-21668
  - GHSA-qc9x-gjcv-465w
summary: |
  Pipenv's requirements.txt parsing allows malicious index url in comments
  Due to a flaw in pipenv's parsing of requirements files, an attacker can insert a specially crafted string inside a comment anywhere within a requirements.txt file, which will cause victims who use pipenv to install the requirements file (e.g. with "`pipenv install -r requirements.txt`") to download dependencies from a package index server controlled by the attacker. By embedding malicious code in packages served from their malicious index server, the attacker can trigger arbitrary remote code execution (RCE) on the victims' systems.
impacted_packages:
  - purl: pkg:pypi/pipenv
    affected_versions: vers:pypi/>=2018.10.9|<2022.1.8
    fixed_versions: vers:pypi/2022.1.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/pipenv/CVE-2022-21668.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/pipenv/CVE-2022-21668.yml
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-77
  - CWE-937
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pipenv/PYSEC-2022-6.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/pipenv
    reference_type:
    reference_id:
  - url: https://github.com/pypa/pipenv/commit/439782a8ae36c4762c88e43d5f0d8e563371b46f
    reference_type:
    reference_id:
  - url: https://github.com/pypa/pipenv/releases/tag/v2022.1.8
    reference_type:
    reference_id:
  - url: https://github.com/pypa/pipenv/security/advisories/GHSA-qc9x-gjcv-465w
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/56HBA3EOSLEDNCCBJVHE6DO34P56EOUM
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KCROBYHUS6DKQPCXBRPCZ5CDBNQTYAWT
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QHQRIWKDP3SVJABAPEXBIQPKDI6UP7G4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21668
    reference_type:
    reference_id: CVE-2022-21668
  - url: https://github.com/advisories/GHSA-qc9x-gjcv-465w
    reference_type:
    reference_id: GHSA-qc9x-gjcv-465w
