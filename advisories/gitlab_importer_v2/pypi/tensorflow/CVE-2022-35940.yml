advisory_id: pypi/tensorflow/CVE-2022-35940
datasource_id: gitlab_importer_v2/pypi/tensorflow/CVE-2022-35940
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow/CVE-2022-35940.yml
aliases:
  - CVE-2022-35940
  - GHSA-x989-q2pq-4q5x
summary: |
  Integer Overflow or Wraparound
  TensorFlow is an open source platform for machine learning. The `RaggedRangOp` function takes an argument `limits` that is eventually used to construct a `TensorShape` as an `int64`. If `limits` is a very large float, it can overflow when converted to an `int64`. This triggers an `InvalidArgument` but also throws an abort signal that crashes the program. We have patched the issue in GitHub commit 37cefa91bee4eace55715eeef43720b958a01192. The fix will be included in TensorFlow 2.10.0. We will also cherrypick this commit on TensorFlow 2.9.1, TensorFlow 2.8.1, and TensorFlow 2.7.2, as these are also affected and still in supported range. There are no known workarounds for this issue.
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/>=2.7.0|<2.7.2|>=2.8.0|<2.8.1|>=2.9.0|<2.9.1|2.10
    fixed_versions: vers:pypi/2.7.2|2.8.1|2.9.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow/CVE-2022-35940.yml
weaknesses:
  - CWE-190
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/tensorflow/tensorflow/blob/0b6b491d21d6a4eb5fbab1cca565bc1e94ca9543/tensorflow/core/kernels/ragged_range_op.cc#L74-L88
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/37cefa91bee4eace55715eeef43720b958a01192
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/releases/tag/v2.10.0
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-x989-q2pq-4q5x
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-x989-q2pq-4q5x
    reference_type:
    reference_id: GHSA-x989-q2pq-4q5x
