advisory_id: pypi/tensorflow/CVE-2020-15211
datasource_id: gitlab_importer_v2/pypi/tensorflow/CVE-2020-15211
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow/CVE-2020-15211.yml
aliases:
  - CVE-2020-15211
  - GHSA-cvpc-8phh-8f45
summary: |
  Out of bounds access in tensorflow-lite
  In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36

  However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative `-1` value as index for these tensors:
  https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82

  This results in special casing during validation at model loading time: https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580

  Unfortunately, this means that the `-1` index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.

  This results in both read and write gadgets, albeit very limited in scope.
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/<1.15.4|>=2.0.0|<2.0.3|>=2.1.0|<2.1.2|2.2.0|>=2.2.0|<2.2.1|2.3.0|>=2.3.0|<2.3.1
    fixed_versions: vers:pypi/1.15.4|2.0.3|2.1.2|2.2.1|2.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow/CVE-2020-15211.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/tensorflow/CVE-2020-15211.yml
weaknesses:
  - CWE-787
  - CWE-1035
  - CWE-125
  - CWE-937
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2020-291.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2020-326.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2020-134.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15211
    reference_type:
    reference_id: CVE-2020-15211
  - url: https://github.com/advisories/GHSA-cvpc-8phh-8f45
    reference_type:
    reference_id: GHSA-cvpc-8phh-8f45
