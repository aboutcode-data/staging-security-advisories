advisory_id: pypi/apache-airflow-providers-common-sql/CVE-2025-30473
datasource_id: gitlab_importer_v2/pypi/apache-airflow-providers-common-sql/CVE-2025-30473
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow-providers-common-sql/CVE-2025-30473.yml
aliases:
  - CVE-2025-30473
  - GHSA-5r62-mjf5-xwhj
summary: |
  Apache Airflow Common SQL Provider Vulnerable to SQL Injection
  Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') vulnerability in Apache Airflow Common SQL Provider.

  When using the partition clause in SQLTableCheckOperator as parameter (which was a recommended pattern), Authenticated UI User could inject arbitrary SQL command when triggering DAG exposing partition_clause to the user.
  This allowed the DAG Triggering user to escalate privileges to execute those arbitrary commands which they normally would not have.


  This issue affects Apache Airflow Common SQL Provider: before 1.24.1.

  Users are recommended to upgrade to version 1.24.1, which fixes the issue.
impacted_packages:
  - purl: pkg:pypi/apache-airflow-providers-common-sql
    affected_versions: vers:pypi/<1.24.1
    fixed_versions: vers:pypi/1.24.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/apache-airflow-providers-common-sql/CVE-2025-30473.yml
weaknesses:
  - CWE-89
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/pull/48098
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/53klkv790cylqcop0350w7nfq1y6h0t2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-30473
    reference_type:
    reference_id: CVE-2025-30473
  - url: https://github.com/advisories/GHSA-5r62-mjf5-xwhj
    reference_type:
    reference_id: GHSA-5r62-mjf5-xwhj
