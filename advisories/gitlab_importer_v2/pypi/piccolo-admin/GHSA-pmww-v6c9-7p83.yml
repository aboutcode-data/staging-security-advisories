advisory_id: pypi/piccolo-admin/GHSA-pmww-v6c9-7p83
datasource_id: gitlab_importer_v2/pypi/piccolo-admin/GHSA-pmww-v6c9-7p83
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/piccolo-admin/GHSA-pmww-v6c9-7p83.yml
aliases:
  - GHSA-pmww-v6c9-7p83
summary: |
  Piccolo Admin's raw SVG loading may lead to complete data compromise from admin page
  Piccolo's admin panel provides the ability to upload media files and view them within the admin panel. If SVG is an allowed file type for upload; the default; an attacker can upload an SVG which when loaded under certain contexts allows for arbitrary access to the admin page.

  This access allows the following actions for example:
  - The ability for an attacker to gain access to all data stored within the admin page
  - The ability for an attacker to make any action within the admin page such as creating, modifying or deleting table records

  As the SVG is executed from the context of an authenticated admin session, any actions they may be able to make can be made by the attacker.

  *N.b. The relevant session cookies are inaccessible from JavaScript due to httponly being set so all exploits must be present within the SVG file*
impacted_packages:
  - purl: pkg:pypi/piccolo-admin
    affected_versions: vers:pypi/>=1.2.0|<1.3.2
    fixed_versions: vers:pypi/1.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/piccolo-admin/GHSA-pmww-v6c9-7p83.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/piccolo-orm/piccolo_admin
    reference_type:
    reference_id:
  - url: https://github.com/piccolo-orm/piccolo_admin/commit/c419575c2467959d906154084d305648eb2b8faf
    reference_type:
    reference_id:
  - url: https://github.com/piccolo-orm/piccolo_admin/security/advisories/GHSA-pmww-v6c9-7p83
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-pmww-v6c9-7p83
    reference_type:
    reference_id: GHSA-pmww-v6c9-7p83
