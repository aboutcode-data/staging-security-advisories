advisory_id: pypi/ckan/CVE-2024-27097
datasource_id: gitlab_importer_v2/pypi/ckan/CVE-2024-27097
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ckan/CVE-2024-27097.yml
aliases:
  - CVE-2024-27097
  - GHSA-8g38-3m6v-232j
summary: |
  Potential log injection in reset user endpoint in CKAN
  A user endpoint didn't perform filtering on an incoming parameter, which was added directly to the application log. This could lead to an attacker injecting false log entries or corrupt the log file format.

  ### Patches
  This has been fixed in the CKAN 2.9.11 and 2.10.4 versions

  ### Workarounds
  Override the `/user/reset` endpoint to filter the `id` parameter in order to exclude newlines
impacted_packages:
  - purl: pkg:pypi/ckan
    affected_versions: vers:pypi/<2.9.11|>=2.10.0|<2.10.4
    fixed_versions: vers:pypi/2.9.11|2.10.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ckan/CVE-2024-27097.yml
weaknesses:
  - CWE-532
  - CWE-1035
  - CWE-937
  - CWE-117
references:
  - url: https://docs.ckan.org/en/2.10/changelog.html#v-2-10-4-2024-03-13
    reference_type:
    reference_id:
  - url: https://github.com/ckan/ckan
    reference_type:
    reference_id:
  - url: https://github.com/ckan/ckan/commit/5fa133e7e9019573066455b5d442e93c62b3fc93
    reference_type:
    reference_id:
  - url: https://github.com/ckan/ckan/commit/81b56c55e5e3651d7fcf9642cd5a489a9b62212c
    reference_type:
    reference_id:
  - url: https://github.com/ckan/ckan/commit/d81f411bff2da7347c343a83e17f5814475b5b64
    reference_type:
    reference_id:
  - url: https://github.com/ckan/ckan/security/advisories/GHSA-8g38-3m6v-232j
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-27097
    reference_type:
    reference_id: CVE-2024-27097
  - url: https://github.com/advisories/GHSA-8g38-3m6v-232j
    reference_type:
    reference_id: GHSA-8g38-3m6v-232j
