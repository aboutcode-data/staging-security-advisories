advisory_id: pypi/litellm/CVE-2024-5225
datasource_id: gitlab_importer_v2/pypi/litellm/CVE-2024-5225
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/litellm/CVE-2024-5225.yml
aliases:
  - CVE-2024-5225
  - GHSA-h6m6-jj8v-94jj
summary: |
  SQL injection in litellm
  An SQL Injection vulnerability exists in the berriai/litellm repository, specifically within the `/global/spend/logs` endpoint. The vulnerability arises due to improper neutralization of special elements used in an SQL command. The affected code constructs an SQL query by concatenating an unvalidated `api_key` parameter directly into the query, making it susceptible to SQL Injection if the `api_key` contains malicious data. This issue affects the latest version of the repository. Successful exploitation of this vulnerability could lead to unauthorized access, data manipulation, exposure of confidential information, and denial of service (DoS).
impacted_packages:
  - purl: pkg:pypi/litellm
    affected_versions: vers:pypi/<1.40.0
    fixed_versions: vers:pypi/1.40.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/litellm/CVE-2024-5225.yml
weaknesses:
  - CWE-89
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/BerriAI/litellm
    reference_type:
    reference_id:
  - url: https://github.com/BerriAI/litellm/commit/f75c15d6cd535aa78014378ad532de1df6be2f56
    reference_type:
    reference_id:
  - url: https://github.com/BerriAI/litellm/pull/3940
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/491e4884-0306-4cd4-8fe2-9a19de33bf5c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-5225
    reference_type:
    reference_id: CVE-2024-5225
  - url: https://github.com/advisories/GHSA-h6m6-jj8v-94jj
    reference_type:
    reference_id: GHSA-h6m6-jj8v-94jj
