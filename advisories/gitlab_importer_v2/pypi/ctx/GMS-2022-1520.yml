advisory_id: pypi/ctx/GMS-2022-1520
datasource_id: gitlab_importer_v2/pypi/ctx/GMS-2022-1520
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ctx/GMS-2022-1520.yml
aliases:
  - GHSA-4g82-3jcr-q52w
  - GMS-2022-1520
summary: |
  Malware in ctx
  The `ctx` hosted project on [PyPI](https://pypi.org/project/ctx/) was taken over via user account compromise and replaced with a malicious project which contained runtime code that collected the content of `os.environ.items()` when instantiating `Ctx` objects. The captured environment variables were sent as a base64 encoded query parameter to a heroku application running at `https://anti-theft-web.herokuapp.com`.

  If you installed the package between May 14, 2022 and May 24, 2022, and your environment variables contain sensitive data like passwords and API keys (like `AWS_ACCESS_KEY_ID` and `AWS_SECRET_ACCESS_KEY`), we advise you to rotate your passwords and keys, then perform an audit to determine if they were exploited.
impacted_packages:
  - purl: pkg:pypi/ctx
    affected_versions: vers:pypi/<=0.1.4
    fixed_versions: vers:pypi/
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/figlief/ctx
    reference_type:
    reference_id:
  - url: https://isc.sans.edu/forums/diary/ctx+Python+Library+Updated+with+Extra+Features/28678/
    reference_type:
    reference_id:
  - url: https://portswigger.net/daily-swig/malicious-python-library-ctx-removed-from-pypi-repo
    reference_type:
    reference_id:
  - url: https://python-security.readthedocs.io/pypi-vuln/index-2022-05-24-ctx-domain-takeover.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-4g82-3jcr-q52w
    reference_type:
    reference_id: GHSA-4g82-3jcr-q52w
