advisory_id: pypi/wagtail/CVE-2024-32882
datasource_id: gitlab_importer_v2/pypi/wagtail/CVE-2024-32882
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/wagtail/CVE-2024-32882.yml
aliases:
  - CVE-2024-32882
  - GHSA-w2v8-php4-p8hc
summary: |
  Wagtail has permission check bypass when editing a model with per-field restrictions through `wagtail.contrib.settings` or `ModelViewSet`
  If a model has been made available for editing through the [`wagtail.contrib.settings`](https://docs.wagtail.org/en/stable/reference/contrib/settings.html) module or [`ModelViewSet`](https://docs.wagtail.org/en/stable/extending/generic_views.html#modelviewset), and the [`permission` argument on `FieldPanel`](https://docs.wagtail.org/en/stable/reference/pages/panels.html#wagtail.admin.panels.FieldPanel.permission) has been used to further restrict access to one or more fields of the model, a user with edit permission over the model but not the specific field can craft an HTTP POST request that bypasses the permission check on the individual field, allowing them to update its value.

  The vulnerability is not exploitable by an ordinary site visitor without access to the Wagtail admin, or by a user who has not been granted edit access to the model in question. The editing interfaces for pages and snippets are also unaffected.
impacted_packages:
  - purl: pkg:pypi/wagtail
    affected_versions: vers:pypi/>=6.0.0|<6.0.3
    fixed_versions: vers:pypi/6.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/wagtail/CVE-2024-32882.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/wagtail/wagtail
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/fa0d4829f9c81eefb37cc058e2fa1b6a918741da
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/releases/tag/v6.0.3
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/security/advisories/GHSA-w2v8-php4-p8hc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32882
    reference_type:
    reference_id: CVE-2024-32882
  - url: https://github.com/advisories/GHSA-w2v8-php4-p8hc
    reference_type:
    reference_id: GHSA-w2v8-php4-p8hc
