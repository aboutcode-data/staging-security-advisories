advisory_id: pypi/wagtail/CVE-2023-28837
datasource_id: gitlab_importer_v2/pypi/wagtail/CVE-2023-28837
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/wagtail/CVE-2023-28837.yml
aliases:
  - CVE-2023-28837
  - GHSA-33pv-vcgh-jfg9
summary: |
  Wagtail vulnerable to denial-of-service via memory exhaustion when uploading large files
  A memory exhaustion bug exists in Wagtail's handling of uploaded images and documents. For both images and documents, files are loaded into memory during upload for additional processing. A user with access to upload images or documents through the Wagtail admin interface could upload a file so large that it results in a crash or denial of service.

  The vulnerability is not exploitable by an ordinary site visitor without access to the Wagtail admin. It can only be exploited by admin users with permission to upload images or documents.

  Image uploads are [restricted to 10MB by default](https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size), however this validation only happens on the frontend and on the backend after the vulnerable code.
impacted_packages:
  - purl: pkg:pypi/wagtail
    affected_versions: vers:pypi/<4.1.4|>=4.2|<4.2.2
    fixed_versions: vers:pypi/4.1.4|4.2.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/wagtail/CVE-2023-28837.yml
weaknesses:
  - CWE-770
  - CWE-1035
  - CWE-937
  - CWE-400
references:
  - url: https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/wagtail/PYSEC-2023-56.yaml
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/3c0c64642b9e5b8d28b111263c7f4bddad6c3880
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/c9d2fcd650a88d76ae122646142245e5927a9165
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/cfa11bbe00dbe7ce8cd4c0bbfe2a898a690df2bf
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/d4022310cbe497993459c3136311467c7ac6329a
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/releases/tag/v4.1.4
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/releases/tag/v4.2.2
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/security/advisories/GHSA-33pv-vcgh-jfg9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-28837
    reference_type:
    reference_id: CVE-2023-28837
  - url: https://github.com/advisories/GHSA-33pv-vcgh-jfg9
    reference_type:
    reference_id: GHSA-33pv-vcgh-jfg9
