advisory_id: pypi/wagtail/CVE-2021-32681
datasource_id: gitlab_importer_v2/pypi/wagtail/CVE-2021-32681
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/wagtail/CVE-2021-32681.yml
aliases:
  - CVE-2021-32681
  - GHSA-xfrw-hxr5-ghqf
summary: |
  Cross-site Scripting in wagtail
  When the `{% include_block %}` template tag is used to output the value of a plain-text StreamField block (`CharBlock`, `TextBlock` or a similar user-defined block derived from `FieldBlock`), and that block does not specify a template for rendering, the tag output is not properly escaped as HTML. This could allow users to insert arbitrary HTML or scripting. This vulnerability is only exploitable by users with the ability to author StreamField content (i.e. users with 'editor' access to the Wagtail admin).
impacted_packages:
  - purl: pkg:pypi/wagtail
    affected_versions: vers:pypi/<2.11.8|>=2.12|<2.12.5|>=2.13|<2.13.2
    fixed_versions: vers:pypi/2.11.8|2.12.5|2.13.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/wagtail/CVE-2021-32681.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/wagtail/CVE-2021-32681.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/wagtail/PYSEC-2021-103.yaml
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/releases/tag/v2.11.8
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/releases/tag/v2.12.5
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/releases/tag/v2.13.2
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/security/advisories/GHSA-xfrw-hxr5-ghqf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32681
    reference_type:
    reference_id: CVE-2021-32681
  - url: https://github.com/advisories/GHSA-xfrw-hxr5-ghqf
    reference_type:
    reference_id: GHSA-xfrw-hxr5-ghqf
