advisory_id: pypi/pydantic/CVE-2021-29510
datasource_id: gitlab_importer_v2/pypi/pydantic/CVE-2021-29510
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/pydantic/CVE-2021-29510.yml
aliases:
  - CVE-2021-29510
  - GHSA-5jqp-qgf6-3pvh
summary: |
  Use of "infinity" as an input to datetime and date fields causes infinite loop in pydantic
  Impact

  Passing either 'infinity', 'inf' or float('inf') (or their negatives) to datetime or date fields causes validation to run forever with 100% CPU usage (on one CPU).
  Patches

  Pydantic is be patched with fixes available in the following versions:

  v1.8.2
  v1.7.4
  v1.6.2

  All these versions are available on pypi, and will be available on conda-forge soon.

  See the changelog for details.
  Workarounds

  If you absolutely can't upgrade, you can work around this risk using a validator to catch these values, brief demo:

  from datetime import date
  from pydantic import BaseModel, validator

  class DemoModel(BaseModel):
  date_of_birth: date

  @validator('date_of_birth', pre=True)
  def skip_infinite_values(cls, v):
  try:
  seconds = float(v)
  except (ValueError, TypeError):
  return v
  else:
  if seconds == float('inf'):
  return date.max
  elif seconds == float('-inf'):
  return date.min
  else:
  return seconds

  Note: this is not an ideal solution (in particular you'll need a slightly different function for datetimes), instead of a hack like this you should upgrade pydantic.

  If you are not using v1.8.x, v1.7.x or v1.6.x and are unable to upgrade to a fixed version of pydantic, please create an issue requesting a back-port, and we will endeavour to release a patch for earlier versions of pydantic.
  References

  This was fixed in commit 7e83fdd.
impacted_packages:
  - purl: pkg:pypi/pydantic
    affected_versions: vers:pypi/<1.6.2|>=1.7|<1.7.4|>=1.8|<1.8.2
    fixed_versions: vers:pypi/1.6.2|1.7.4|1.8.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/pydantic/CVE-2021-29510.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/pydantic/CVE-2021-29510.yml
weaknesses:
  - CWE-1035
  - CWE-835
  - CWE-937
references:
  - url: https://github.com/pydantic/pydantic/commit/1c24f1d74ba95ea985b50bdc001ce96c813229aa
    reference_type:
    reference_id:
  - url: https://github.com/pydantic/pydantic/commit/80e0dd3f752bef145dce12f160d262bb40ec8d47
    reference_type:
    reference_id:
  - url: https://github.com/pydantic/pydantic/commit/bdde15b7b947c94ca00fd6eb92da8db390a13520
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pydantic/PYSEC-2021-47.yaml
    reference_type:
    reference_id:
  - url: https://github.com/samuelcolvin/pydantic/commit/7e83fdd2563ffac081db7ecdf1affa65ef38c468
    reference_type:
    reference_id:
  - url: https://github.com/samuelcolvin/pydantic/security/advisories/GHSA-5jqp-qgf6-3pvh
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/S2HT266L6Q7H6ICP7DFGXOGBJHNNKMKB
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UEFWM7DYKD2ZHE7R5YT5EQWJPV4ZKYRB
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UMKAJX4O6IGBBCE32CO2G7PZQCCQSBLV
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29510
    reference_type:
    reference_id: CVE-2021-29510
  - url: https://github.com/advisories/GHSA-5jqp-qgf6-3pvh
    reference_type:
    reference_id: GHSA-5jqp-qgf6-3pvh
