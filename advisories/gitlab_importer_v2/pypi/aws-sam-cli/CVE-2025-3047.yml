advisory_id: pypi/aws-sam-cli/CVE-2025-3047
datasource_id: gitlab_importer_v2/pypi/aws-sam-cli/CVE-2025-3047
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/aws-sam-cli/CVE-2025-3047.yml
aliases:
  - CVE-2025-3047
  - GHSA-px37-jpqx-97q9
summary: |
  AWS SAM CLI Path Traversal allows file copy to build container
  The [AWS Serverless Application Model Command Line Interface (AWS SAM CLI)](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/using-sam-cli.html) is an open-source CLI tool that helps Lambda developers to build and develop Lambda applications locally on their computers using Docker.

  When running the AWS SAM CLI build process with Docker and symlinks are included in the build files, the container environment allows a user to access privileged files on the host by leveraging the elevated permissions granted to the tool. A user could leverage the elevated permissions to access restricted files via symlinks and copy them to a more permissive location on the container.

  Users should [upgrade to v1.133.0](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/manage-sam-cli-versions.html#manage-sam-cli-versions-upgrade) or newer and ensure any forked or derivative code is patched to incorporate the new fixes.
impacted_packages:
  - purl: pkg:pypi/aws-sam-cli
    affected_versions: vers:pypi/<1.133.0
    fixed_versions: vers:pypi/1.133.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/aws-sam-cli/CVE-2025-3047.yml
weaknesses:
  - CWE-61
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://aws.amazon.com/security/security-bulletins/AWS-2025-008
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sam-cli
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sam-cli/pull/7865
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sam-cli/releases/tag/v1.134.0
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sam-cli/security/advisories/GHSA-px37-jpqx-97q9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-3047
    reference_type:
    reference_id: CVE-2025-3047
  - url: https://github.com/advisories/GHSA-px37-jpqx-97q9
    reference_type:
    reference_id: GHSA-px37-jpqx-97q9
