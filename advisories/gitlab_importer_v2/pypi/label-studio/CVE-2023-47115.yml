advisory_id: pypi/label-studio/CVE-2023-47115
datasource_id: gitlab_importer_v2/pypi/label-studio/CVE-2023-47115
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/label-studio/CVE-2023-47115.yml
aliases:
  - CVE-2023-47115
  - GHSA-q68h-xwq5-mm7x
summary: |
  Cross-site Scripting Vulnerability on Avatar Upload
  The following [code snippet in Label Studio](https://github.com/HumanSignal/label-studio/blob/1.8.2/label_studio/users/functions.py#L18-L49) shows that the only verification check is that the file is an image by extracting the dimensions from the file.

  ```python

  def hash_upload(instance, filename):
  filename = str(uuid.uuid4())[0:8] + '-' + filename
  return settings.AVATAR_PATH + '/' + filename <3>


  def check_avatar(files):
  images = list(files.items())
  if not images:
  return None

  filename, avatar = list(files.items())[0]  # get first file
  w, h = get_image_dimensions(avatar) <1>
  if not w or not h:
  raise forms.ValidationError("Can't read image, try another one")
impacted_packages:
  - purl: pkg:pypi/label-studio
    affected_versions: vers:pypi/<1.9.2
    fixed_versions: vers:pypi/1.9.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/label-studio/CVE-2023-47115.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://docs.djangoproject.com/en/4.2/ref/views/#serving-files-in-development
    reference_type:
    reference_id:
  - url: https://github.com/HumanSignal/label-studio
    reference_type:
    reference_id:
  - url: https://github.com/HumanSignal/label-studio/blob/1.8.2/label_studio/users/functions.py#L18-L49
    reference_type:
    reference_id:
  - url: https://github.com/HumanSignal/label-studio/blob/1.8.2/label_studio/users/urls.py#L25-L26
    reference_type:
    reference_id:
  - url: https://github.com/HumanSignal/label-studio/commit/a7a71e594f32ec4af8f3f800d5ccb8662e275da3
    reference_type:
    reference_id:
  - url: https://github.com/HumanSignal/label-studio/security/advisories/GHSA-q68h-xwq5-mm7x
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/label-studio/PYSEC-2024-126.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-47115
    reference_type:
    reference_id: CVE-2023-47115
  - url: https://github.com/advisories/GHSA-q68h-xwq5-mm7x
    reference_type:
    reference_id: GHSA-q68h-xwq5-mm7x
