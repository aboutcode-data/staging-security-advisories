advisory_id: pypi/InvokeAI/CVE-2024-12029
datasource_id: gitlab_importer_v2/pypi/InvokeAI/CVE-2024-12029
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/InvokeAI/CVE-2024-12029.yml
aliases:
  - CVE-2024-12029
  - GHSA-mcrp-whpw-jp68
summary: |
  InvokeAI Deserialization of Untrusted Data vulnerability
  A remote code execution vulnerability exists in invoke-ai/invokeai versions 5.3.1 through 5.4.2 via the /api/v2/models/install API. The vulnerability arises from unsafe deserialization of model files using torch.load without proper validation. Attackers can exploit this by embedding malicious code in model files, which is executed upon loading. This issue is fixed in version 5.4.3rc2.
impacted_packages:
  - purl: pkg:pypi/invokeai
    affected_versions: vers:pypi/>=5.3.1|<5.4.3rc2
    fixed_versions: vers:pypi/5.4.3rc2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/InvokeAI/CVE-2024-12029.yml
weaknesses:
  - CWE-1035
  - CWE-502
  - CWE-937
references:
  - url: https://github.com/invoke-ai/InvokeAI
    reference_type:
    reference_id:
  - url: https://github.com/invoke-ai/invokeai/commit/756008dc5899081c5aa51e5bd8f24c1b3975a59e
    reference_type:
    reference_id:
  - url: https://github.com/invoke-ai/InvokeAI/commit/ed46acee79460189b38c164321b14bdfbf3073c9
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/invokeai/PYSEC-2025-9.yaml
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/9b790f94-1b1b-4071-bc27-78445d1a87a3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-12029
    reference_type:
    reference_id: CVE-2024-12029
  - url: https://github.com/advisories/GHSA-mcrp-whpw-jp68
    reference_type:
    reference_id: GHSA-mcrp-whpw-jp68
