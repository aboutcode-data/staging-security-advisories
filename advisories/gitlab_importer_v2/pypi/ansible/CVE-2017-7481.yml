advisory_id: pypi/ansible/CVE-2017-7481
datasource_id: gitlab_importer_v2/pypi/ansible/CVE-2017-7481
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ansible/CVE-2017-7481.yml
aliases:
  - CVE-2017-7481
  - GHSA-w578-j992-554x
summary: |
  Ansible fails to properly mark lookup-plugin results as unsafe
  Ansible before versions 2.1.6.0, 2.2.3.0, 2.3.1.0, and 2.4.0.0 fails to properly mark lookup-plugin results as unsafe. If an attacker could control the results of lookup() calls, they could inject Unicode strings to be parsed by the jinja2 templating system, resulting in code execution. By default, the jinja2 templating language is now marked as 'unsafe' and is not evaluated.
impacted_packages:
  - purl: pkg:pypi/ansible
    affected_versions: vers:pypi/<2.1.6.0|>=2.2.0.0|<2.2.3.0|>=2.3.0.0|<2.3.1.0
    fixed_versions: vers:pypi/2.1.6.0|2.2.3.0|2.3.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ansible/CVE-2017-7481.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ansible/CVE-2017-7481.yml
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-937
references:
  - url: https://access.redhat.com/errata/RHSA-2017:1244
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2017:1334
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2017:1476
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2017:1499
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2017:1599
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2017:2524
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-7481
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-w578-j992-554x
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/a1886911fcf4b691130cfc70dfc5daa5e07c46a3
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/ed56f51f185a1ffd7ea57130d260098686fcc7c2
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/f0e348f5eeb70c1fb3127d90891da43b5c0a9d29
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/fd30f5328986f9e1da434474481f32bf918a600c
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2018-41.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2021/01/msg00023.html
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4072-1
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20170801122609/http://www.securityfocus.com/bid/98492
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-7481
    reference_type:
    reference_id: CVE-2017-7481
