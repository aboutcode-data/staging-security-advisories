advisory_id: pypi/ansible/CVE-2020-1733
datasource_id: gitlab_importer_v2/pypi/ansible/CVE-2020-1733
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ansible/CVE-2020-1733.yml
aliases:
  - CVE-2020-1733
  - GHSA-g4mq-6fp5-qwcf
summary: |
  Ansible vulnerable to Exposure of Resource to Wrong Sphere and Insecure Temporary File
  A race condition flaw was found in Ansible Engine 2.7.17 and prior, 2.8.9 and prior, 2.9.6 and prior when running a playbook with an unprivileged become user. When Ansible needs to run a module with become user, the temporary directory is created in /var/tmp. This directory is created with "umask 77 && mkdir -p <dir>"; this operation does not fail if the directory already exists and is owned by another user. An attacker could take advantage to gain control of the become user as the target directory can be retrieved by iterating '/proc/<pid>/cmdline'.
impacted_packages:
  - purl: pkg:pypi/ansible
    affected_versions: vers:pypi/<2.7.17|>=2.8.0a1|<2.8.11|>=2.9.0a1|<2.9.7
    fixed_versions: vers:pypi/2.7.17|2.8.11|2.9.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:H/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ansible/CVE-2020-1733.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/ansible/CVE-2020-1733.yml
weaknesses:
  - CWE-668
  - CWE-362
  - CWE-377
  - CWE-1035
  - CWE-937
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-1733
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-g4mq-6fp5-qwcf
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/80b9a0a25c5f75e84aefc8f2b293fb1933b154f2
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/8251d9f4c2bc82632ab992277fcd30ccbf87aa47
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/ecf99d5e1ff732a7777010facd6c98bb0994605e
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/issues/67791
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2020-5.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2020/05/msg00005.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DKPA4KC3OJSUFASUYMG66HKJE7ADNGFW
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MRRYUU5ZBLPBXCYG6CFP35D64NP2UB2S
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WQVOQD4VAIXXTVQAJKTN7NUGTJFE2PCB
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202006-11
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2021/dsa-4950
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-1733
    reference_type:
    reference_id: CVE-2020-1733
