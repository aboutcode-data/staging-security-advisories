advisory_id: pypi/python-multipart/CVE-2024-24762
datasource_id: gitlab_importer_v2/pypi/python-multipart/CVE-2024-24762
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/python-multipart/CVE-2024-24762.yml
aliases:
  - CVE-2024-24762
  - GHSA-2jv5-9r88-3w3p
summary: |
  python-multipart vulnerable to Content-Type Header ReDoS
  When using form data, `python-multipart` uses a Regular Expression to parse the HTTP `Content-Type` header, including options.

  An attacker could send a custom-made `Content-Type` option that is very difficult for the RegEx to process, consuming CPU resources and stalling indefinitely (minutes or more) while holding the main event loop. This means that process can't handle any more requests.

  This can create a ReDoS (Regular expression Denial of Service): https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS

  This only applies when the app uses form data, parsed with `python-multipart`.
impacted_packages:
  - purl: pkg:pypi/python-multipart
    affected_versions: vers:pypi/<0.0.7
    fixed_versions: vers:pypi/0.0.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/python-multipart/CVE-2024-24762.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-400
references:
  - url: https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74
    reference_type:
    reference_id:
  - url: https://github.com/encode/starlette/commit/13e5c26a27f4903924624736abd6131b2da80cc5
    reference_type:
    reference_id:
  - url: https://github.com/github/advisory-database/pull/4829
    reference_type:
    reference_id:
  - url: https://github.com/Kludex/python-multipart
    reference_type:
    reference_id:
  - url: https://github.com/Kludex/python-multipart/commit/20f0ef6b4e4caf7d69a667c54dff57fe467109a4
    reference_type:
    reference_id:
  - url: https://github.com/Kludex/python-multipart/security/advisories/GHSA-2jv5-9r88-3w3p
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/fastapi/PYSEC-2024-38.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tiangolo/fastapi/commit/9d34ad0ee8a0dfbbcce06f76c2d5d851085024fc
    reference_type:
    reference_id:
  - url: https://github.com/tiangolo/fastapi/releases/tag/0.109.1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-24762
    reference_type:
    reference_id: CVE-2024-24762
  - url: https://github.com/advisories/GHSA-2jv5-9r88-3w3p
    reference_type:
    reference_id: GHSA-2jv5-9r88-3w3p
