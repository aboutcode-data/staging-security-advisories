advisory_id: pypi/bentoml/CVE-2025-54381
datasource_id: gitlab_importer_v2/pypi/bentoml/CVE-2025-54381
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/bentoml/CVE-2025-54381.yml
aliases:
  - CVE-2025-54381
  - GHSA-mrmq-3q62-6cc8
summary: |
  BentoML SSRF Vulnerability in File Upload Processing
  There's an SSRF in the file upload processing system that allows remote attackers to make arbitrary HTTP requests from the server without authentication. The vulnerability exists in the serialization/deserialization handlers for multipart form data and JSON requests, which automatically download files from user-provided URLs without proper validation of internal network addresses.

  The framework automatically registers any service endpoint with file-type parameters (`pathlib.Path`, `PIL.Image.Image`) as vulnerable to this attack, making it a framework-wide security issue that affects most real-world ML services handling file uploads. While BentoML implements basic URL scheme validation in the `JSONSerde` path, the `MultipartSerde` path has no validation whatsoever, and neither path restricts access to internal networks, cloud metadata endpoints, or localhost services.

  The documentation explicitly promotes this URL-based file upload feature, making it an intended but insecure design that exposes all deployed services to SSRF attacks by default.
impacted_packages:
  - purl: pkg:pypi/bentoml
    affected_versions: vers:pypi/>=1.4.0|<1.4.19
    fixed_versions: vers:pypi/1.4.19
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/bentoml/CVE-2025-54381.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/bentoml/BentoML
    reference_type:
    reference_id:
  - url: https://github.com/bentoml/BentoML/commit/534c3584621da4ab954bdc3d814cc66b95ae5fb8
    reference_type:
    reference_id:
  - url: https://github.com/bentoml/BentoML/security/advisories/GHSA-mrmq-3q62-6cc8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54381
    reference_type:
    reference_id: CVE-2025-54381
  - url: https://github.com/advisories/GHSA-mrmq-3q62-6cc8
    reference_type:
    reference_id: GHSA-mrmq-3q62-6cc8
