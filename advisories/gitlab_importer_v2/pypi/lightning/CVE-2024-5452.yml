advisory_id: pypi/lightning/CVE-2024-5452
datasource_id: gitlab_importer_v2/pypi/lightning/CVE-2024-5452
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/lightning/CVE-2024-5452.yml
aliases:
  - CVE-2024-5452
  - GHSA-cgwc-qvrx-rf7f
summary: |
  Remote code execution in pytorch lightning
  A remote code execution (RCE) vulnerability exists in the lightning-ai/pytorch-lightning library version 2.2.1 due to improper handling of deserialized user input and mismanagement of dunder attributes by the `deepdiff` library. The library uses `deepdiff.Delta` objects to modify application state based on frontend actions. However, it is possible to bypass the intended restrictions on modifying dunder attributes, allowing an attacker to construct a serialized delta that passes the deserializer allow list and contains dunder attributes. When processed, this can be exploited to access other modules, classes, and instances, leading to arbitrary attribute write and total RCE on any self-hosted pytorch-lightning application in its default configuration, as the delta endpoint is enabled by default.
impacted_packages:
  - purl: pkg:pypi/lightning
    affected_versions: vers:pypi/<2.3.3
    fixed_versions: vers:pypi/2.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/lightning/CVE-2024-5452.yml
weaknesses:
  - CWE-1035
  - CWE-913
  - CWE-915
  - CWE-937
references:
  - url: https://github.com/lightning-ai/pytorch-lightning
    reference_type:
    reference_id:
  - url: https://github.com/lightning-ai/pytorch-lightning/commit/330af381de88cff17515418a341cbc1f9f127f9a
    reference_type:
    reference_id:
  - url: https://github.com/Lightning-AI/pytorch-lightning/issues/20038
    reference_type:
    reference_id:
  - url: https://github.com/Lightning-AI/pytorch-lightning/releases/tag/2.3.3
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/486add92-275e-4a7b-92f9-42d84bc759da
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-5452
    reference_type:
    reference_id: CVE-2024-5452
  - url: https://github.com/advisories/GHSA-cgwc-qvrx-rf7f
    reference_type:
    reference_id: GHSA-cgwc-qvrx-rf7f
