advisory_id: pypi/lightning/CVE-2024-5980
datasource_id: gitlab_importer_v2/pypi/lightning/CVE-2024-5980
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/lightning/CVE-2024-5980.yml
aliases:
  - CVE-2024-5980
  - GHSA-mr7h-w2qc-ffc2
summary: |
  pytorch-lightning vulnerable to Arbitrary File Write via /v1/runs API endpoint
  A vulnerability in the /v1/runs API endpoint of lightning-ai/pytorch-lightning v2.2.4 allows attackers to exploit path traversal when extracting tar.gz files. When the LightningApp is running with the plugin_server, attackers can deploy malicious tar.gz plugins that embed arbitrary files with path traversal vulnerabilities. This can result in arbitrary files being written to any directory in the victim's local file system, potentially leading to remote code execution.
impacted_packages:
  - purl: pkg:pypi/lightning
    affected_versions: vers:pypi/<2.3.3
    fixed_versions: vers:pypi/2.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/lightning/CVE-2024-5980.yml
weaknesses:
  - CWE-434
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/lightning-ai/pytorch-lightning
    reference_type:
    reference_id:
  - url: https://github.com/lightning-ai/pytorch-lightning/commit/330af381de88cff17515418a341cbc1f9f127f9a
    reference_type:
    reference_id:
  - url: https://github.com/Lightning-AI/pytorch-lightning/pull/20039
    reference_type:
    reference_id:
  - url: https://github.com/Lightning-AI/pytorch-lightning/releases/tag/2.3.3
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/55a6ac6f-89c7-42ea-86f3-c6e93a2679f3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-5980
    reference_type:
    reference_id: CVE-2024-5980
  - url: https://github.com/advisories/GHSA-mr7h-w2qc-ffc2
    reference_type:
    reference_id: GHSA-mr7h-w2qc-ffc2
