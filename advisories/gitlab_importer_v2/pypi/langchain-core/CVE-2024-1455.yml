advisory_id: pypi/langchain-core/CVE-2024-1455
datasource_id: gitlab_importer_v2/pypi/langchain-core/CVE-2024-1455
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/langchain-core/CVE-2024-1455.yml
aliases:
  - CVE-2024-1455
  - GHSA-q84m-rmw3-4382
summary: |
  LangChain's XMLOutputParser vulnerable to XML Entity Expansion
  The XMLOutputParser in LangChain uses the etree module from the XML parser in the standard python library which has some XML vulnerabilities; see: https://docs.python.org/3/library/xml.html

  This primarily affects users that combine an LLM (or agent) with the `XMLOutputParser` and expose the component via an endpoint on a web-service.

  This would allow a malicious party to attempt to manipulate the LLM to produce a malicious payload for the parser that would compromise the availability of the service.

  A successful attack is predicated on:

  1. Usage of XMLOutputParser
  2. Passing of malicious input into the XMLOutputParser either directly or by trying to manipulate an LLM to do so on the users behalf
  3. Exposing the component via a web-service
impacted_packages:
  - purl: pkg:pypi/langchain-core
    affected_versions: vers:pypi/<0.1.34
    fixed_versions: vers:pypi/0.1.34
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/pypi/langchain-core/CVE-2024-1455.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-776
references:
  - url: https://github.com/langchain-ai/langchain
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchain/commit/727d5023ce88e18e3074ef620a98137d26ff92a3
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchain/pull/17250
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/4353571f-c70d-4bfd-ac08-3a89cecb45b6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-1455
    reference_type:
    reference_id: CVE-2024-1455
  - url: https://github.com/advisories/GHSA-q84m-rmw3-4382
    reference_type:
    reference_id: GHSA-q84m-rmw3-4382
