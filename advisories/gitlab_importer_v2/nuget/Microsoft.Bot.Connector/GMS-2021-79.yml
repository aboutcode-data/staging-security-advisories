advisory_id: nuget/Microsoft.Bot.Connector/GMS-2021-79
datasource_id: gitlab_importer_v2/nuget/Microsoft.Bot.Connector/GMS-2021-79
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/nuget/Microsoft.Bot.Connector/GMS-2021-79.yml
aliases:
  - GHSA-qxx8-292g-2w66
  - GMS-2021-79
summary: |
  Improper Authentication
  ### Impact
  A maliciously crafted claim may be incorrectly authenticated by the bot. Impacts bots that are not configured to be used as a Skill. This vulnerability requires an an attacker to have internal knowledge of the bot.

  ### Patches
  The problem has been patched in all affected versions. Please see the list of patched versions for the most appropriate one for your individual case.

  ### Workarounds
  Users who do not wish or are not able to upgrade can add an authentication configuration containing ClaimsValidator which throws an exception if the Claims are Skill Claims.

  For detailed instructions, see the link in the References section.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [Microsoft Bot Builder SDK](https://github.com/microsoft/botbuilder-dotnet)
  * Email us at [bf-reports@microsoft.com](mailto:bf-reports@microsoft.com)
impacted_packages:
  - purl: pkg:nuget/Microsoft.Bot.Connector
    affected_versions: vers:nuget/>=4.6.0|<4.6.4|>=4.7.0|<4.7.3|>=4.8.0|<4.8.2|>=4.9.0|<4.9.5|>=4.10.0|<4.10.3
    fixed_versions: vers:nuget/4.6.4|4.7.3|4.8.2|4.9.5|4.10.3
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/microsoft/botbuilder-dotnet/security/advisories/GHSA-qxx8-292g-2w66
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-qxx8-292g-2w66
    reference_type:
    reference_id: GHSA-qxx8-292g-2w66
