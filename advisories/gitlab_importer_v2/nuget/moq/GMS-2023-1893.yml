advisory_id: nuget/moq/GMS-2023-1893
datasource_id: gitlab_importer_v2/nuget/moq/GMS-2023-1893
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/nuget/moq/GMS-2023-1893.yml
aliases:
  - GHSA-6r78-m64m-qwcf
  - GMS-2023-1893
summary: |
  Moq v4.20.0 and 4.20.1 share hashed user data
  Moq v4.20.0 and 4.20.1 include support for [SponsorLink](https://github.com/devlooped/SponsorLink), which runs an obfuscated DLL at build time that scans local `git config` data and shares the user's hashed email address with SponsorLink's remote servers. There is no option to disable this.

  Moq v4.20.2 has removed this functionality.
impacted_packages:
  - purl: pkg:nuget/moq
    affected_versions: vers:nuget/>=4.20.0|<4.20.2
    fixed_versions: vers:nuget/4.20.2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/moq/moq/issues/1374
    reference_type:
    reference_id:
  - url: https://github.com/moq/moq/pull/1363
    reference_type:
    reference_id:
  - url: https://github.com/moq/moq/pull/1375
    reference_type:
    reference_id:
  - url: https://www.cazzulino.com/sponsorlink.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-6r78-m64m-qwcf
    reference_type:
    reference_id: GHSA-6r78-m64m-qwcf
