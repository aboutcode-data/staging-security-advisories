advisory_id: nuget/Tgstation.Server.Api/CVE-2024-41799
datasource_id: gitlab_importer_v2/nuget/Tgstation.Server.Api/CVE-2024-41799
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/nuget/Tgstation.Server.Api/CVE-2024-41799.yml
aliases:
  - CVE-2024-41799
  - GHSA-c3h4-9gc2-f7h4
summary: |
  tgstation-server's DreamMaker environment files outside the deployment directory can be compiled and ran by insufficiently permissioned users
  _What kind of vulnerability is it? Who is impacted?_

  Low permission users using the "Set .dme Path" privilege could potentially set malicious .dme files existing on the host machine to be compiled and executed.

  These .dme files could be uploaded via tgstation-server (requiring a separate, isolated privilege) or some other means.

  A server configured to execute in BYOND's trusted security level (requiring a third separate, isolated privilege OR being set by another user) could lead to this escalating into remote code execution via BYOND's shell() proc.

  The ability to execute this kind of attack is a known side effect of having privileged TGS users, but normally requires multiple privileges with known weaknesses. This vector is not intentional as it does not require control over the where deployment code is sourced from and _may_ not require remote write access to an instance's `Configuration` directory.
impacted_packages:
  - purl: pkg:nuget/Tgstation.Server.Api
    affected_versions: vers:nuget/>=4.0.0|<6.8.0
    fixed_versions: vers:nuget/6.8.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:L/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/nuget/Tgstation.Server.Api/CVE-2024-41799.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/tgstation/tgstation-server
    reference_type:
    reference_id:
  - url: https://github.com/tgstation/tgstation-server/commit/374852fe5ae306415eb5aafb2d16b06897d7afe4
    reference_type:
    reference_id:
  - url: https://github.com/tgstation/tgstation-server/pull/1835
    reference_type:
    reference_id:
  - url: https://github.com/tgstation/tgstation-server/security/advisories/GHSA-c3h4-9gc2-f7h4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41799
    reference_type:
    reference_id: CVE-2024-41799
  - url: https://github.com/advisories/GHSA-c3h4-9gc2-f7h4
    reference_type:
    reference_id: GHSA-c3h4-9gc2-f7h4
