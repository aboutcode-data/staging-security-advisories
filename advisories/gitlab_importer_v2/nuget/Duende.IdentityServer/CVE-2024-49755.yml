advisory_id: nuget/Duende.IdentityServer/CVE-2024-49755
datasource_id: gitlab_importer_v2/nuget/Duende.IdentityServer/CVE-2024-49755
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/nuget/Duende.IdentityServer/CVE-2024-49755.yml
aliases:
  - CVE-2024-49755
  - GHSA-v9xq-2mvm-x8xc
summary: |
  Duende IdentityServer has insufficient validation of DPoP cnf claim in Local APIs
  IdentityServer's local API authentication handler performs insufficient validation of the `cnf` claim in DPoP access tokens. This allows an attacker to use leaked DPoP access tokens at local api endpoints even without possessing the private key for signing proof tokens.

  Note that this only impacts custom endpoints within an IdentityServer implementation that have explicitly used the `LocalApiAuthenticationHandler` for authentication. It does not impact:
  - OAuth or OIDC protocol endpoints defined by IdentityServer, such as the authorize and token endpoints.
  - Typical UI pages within an IdentityServer implementation, which are not normally authorized with the local API authentication handler.
  - The use of DPoP to create sender-constrained tokens in IdentityServer that are consumed by external API resources.
  - The use of DPoP to sender-constrain refresh tokens issued to public clients.
impacted_packages:
  - purl: pkg:nuget/Duende.IdentityServer
    affected_versions: vers:nuget/>=7.0.0|<7.0.8
    fixed_versions: vers:nuget/7.0.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/nuget/Duende.IdentityServer/CVE-2024-49755.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-287
references:
  - url: https://github.com/DuendeSoftware/IdentityServer
    reference_type:
    reference_id:
  - url: https://github.com/DuendeSoftware/IdentityServer/commit/f28cac921c1f545afe65af71a9327224755b6dac
    reference_type:
    reference_id:
  - url: https://github.com/DuendeSoftware/IdentityServer/security/advisories/GHSA-v9xq-2mvm-x8xc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49755
    reference_type:
    reference_id: CVE-2024-49755
  - url: https://github.com/advisories/GHSA-v9xq-2mvm-x8xc
    reference_type:
    reference_id: GHSA-v9xq-2mvm-x8xc
