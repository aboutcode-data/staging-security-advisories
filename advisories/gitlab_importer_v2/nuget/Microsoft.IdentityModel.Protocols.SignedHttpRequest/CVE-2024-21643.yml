advisory_id: nuget/Microsoft.IdentityModel.Protocols.SignedHttpRequest/CVE-2024-21643
datasource_id: gitlab_importer_v2/nuget/Microsoft.IdentityModel.Protocols.SignedHttpRequest/CVE-2024-21643
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/nuget/Microsoft.IdentityModel.Protocols.SignedHttpRequest/CVE-2024-21643.yml
aliases:
  - CVE-2024-21643
  - GHSA-rv9j-c866-gp5h
summary: |
  Improper Control of Generation of Code ('Code Injection')
  IdentityModel Extensions for .NET provide assemblies for web developers that wish to use federated identity providers for establishing the caller's identity. Anyone leveraging the `SignedHttpRequest`protocol or the `SignedHttpRequestValidator`is vulnerable. Microsoft.IdentityModel trusts the `jku`claim by default for the `SignedHttpRequest`protocol. This raises the possibility to make any remote or local `HTTP GET` request. The vulnerability has been fixed in Microsoft.IdentityModel.Protocols.SignedHttpRequest. Users should update all their Microsoft.IdentityModel versions to 7.1.2 (for 7x) or higher, 6.34.0 (for 6x) or higher.
impacted_packages:
  - purl: pkg:nuget/Microsoft.IdentityModel.Protocols.SignedHttpRequest
    affected_versions: vers:nuget/<6.34.0|>=7.0.0-preview|<7.1.2
    fixed_versions: vers:nuget/6.34.0|7.1.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/nuget/Microsoft.IdentityModel.Protocols.SignedHttpRequest/CVE-2024-21643.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/releases/tag/6.34.0
    reference_type:
    reference_id:
  - url: https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/releases/tag/7.1.2
    reference_type:
    reference_id:
  - url: https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/security/advisories/GHSA-rv9j-c866-gp5h
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-rv9j-c866-gp5h
    reference_type:
    reference_id: GHSA-rv9j-c866-gp5h
