advisory_id: npm/fastify-bearer-auth/CVE-2022-31142
datasource_id: gitlab_importer_v2/npm/fastify-bearer-auth/CVE-2022-31142
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/fastify-bearer-auth/CVE-2022-31142.yml
aliases:
  - CVE-2022-31142
  - GHSA-376v-xgjx-7mfr
summary: |
  Observable Discrepancy
  @fastify/bearer-auth is a Fastify plugin to require bearer Authorization headers. @fastify/bearer-auth prior to versions 7.0.2 and 8.0.1 does not securely use `crypto.timingSafeEqual`. A malicious attacker could estimate the length of one valid bearer token. According to the corresponding RFC 6750, the bearer token has only base64 valid characters, reducing the range of characters for a brute force attack. Version 7.0.2 and 8.0.1 of @fastify/bearer-auth contain a patch. There are currently no known workarounds. The package fastify-bearer-auth, which covers versions 6.0.3 and prior, is also vulnerable starting at version 5.0.1. Users of fastify-bearer-auth should upgrade to a patched version of @fastify/bearer-auth.
impacted_packages:
  - purl: pkg:npm/fastify-bearer-auth
    affected_versions: vers:npm/>=5.0.1|<7.0.2
    fixed_versions: vers:npm/7.0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/fastify-bearer-auth/CVE-2022-31142.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-203
references:
  - url: https://github.com/fastify/fastify-bearer-auth/commit/0c468a616d7e56126dc468150f6a5a92e530b8e4
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth/commit/39353b15409ee99474545f615ffb16180cf3b716
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth/commit/f921a0582dc83112039004a9b5041141b50c5b3f
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth/security/advisories/GHSA-376v-xgjx-7mfr
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1633287
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31142
    reference_type:
    reference_id: CVE-2022-31142
  - url: https://github.com/advisories/GHSA-376v-xgjx-7mfr
    reference_type:
    reference_id: GHSA-376v-xgjx-7mfr
