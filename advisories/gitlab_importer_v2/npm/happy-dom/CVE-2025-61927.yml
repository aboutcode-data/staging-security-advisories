advisory_id: npm/happy-dom/CVE-2025-61927
datasource_id: gitlab_importer_v2/npm/happy-dom/CVE-2025-61927
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/happy-dom/CVE-2025-61927.yml
aliases:
  - CVE-2025-61927
  - GHSA-37j7-fg3j-429f
summary: |
  Happy DOM: VM Context Escape can lead to Remote Code Execution
  Happy DOM v19 and lower contains a security vulnerability that puts the owner system at the risk of RCE (Remote Code Execution) attacks.

  A Node.js VM Context is not an isolated environment, and if the user runs untrusted JavaScript code within the Happy DOM VM Context, it may escape the VM and get access to process level functionality.

  It seems like what the attacker can get control over depends on if the process is using ESM or CommonJS. With CommonJS the attacker can get hold of the `require()` function to import modules.

  Happy DOM has JavaScript evaluation enabled by default. This may not be obvious to the consumer of Happy DOM and can potentially put the user at risk if untrusted code is executed within the environment.
impacted_packages:
  - purl: pkg:npm/happy-dom
    affected_versions: vers:npm/<20.0.0
    fixed_versions: vers:npm/20.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/happy-dom/CVE-2025-61927.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://github.com/capricorn86/happy-dom
    reference_type:
    reference_id:
  - url: https://github.com/capricorn86/happy-dom/commit/819d15ba289495439eda8be360d92a614ce22405
    reference_type:
    reference_id:
  - url: https://github.com/capricorn86/happy-dom/commit/de438ad72921c69793584aa657b48d3655dfac97
    reference_type:
    reference_id:
  - url: https://github.com/capricorn86/happy-dom/releases/tag/v20.0.0
    reference_type:
    reference_id:
  - url: https://github.com/capricorn86/happy-dom/security/advisories/GHSA-37j7-fg3j-429f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-61927
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-37j7-fg3j-429f
    reference_type:
    reference_id: GHSA-37j7-fg3j-429f
