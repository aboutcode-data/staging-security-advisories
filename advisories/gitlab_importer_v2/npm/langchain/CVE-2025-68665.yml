advisory_id: npm/langchain/CVE-2025-68665
datasource_id: gitlab_importer_v2/npm/langchain/CVE-2025-68665
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/langchain/CVE-2025-68665.yml
aliases:
  - CVE-2025-68665
  - GHSA-r399-636x-v7f6
summary: |
  LangChain serialization injection vulnerability enables secret extraction
  Attackers who control serialized data can extract environment variable secrets by injecting `{"lc": 1, "type": "secret", "id": ["ENV_VAR"]}` to load environment variables during deserialization (when `secretsFromEnv: true`). They can also instantiate classes with controlled parameters by injecting constructor structures to instantiate any class within the provided import maps with attacker-controlled parameters, potentially triggering side effects such as network calls or file operations.

  Key severity factors:

  - Affects the serialization pathâ€”applications trusting their own serialization output are vulnerable
  - Enables secret extraction when combined with `secretsFromEnv: true`
  - LLM responses in `additional_kwargs` can be controlled via prompt injection
impacted_packages:
  - purl: pkg:npm/langchain
    affected_versions: vers:npm/<0.3.37|>=1.0.0|<1.2.3
    fixed_versions: vers:npm/0.3.37|1.2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/langchain/CVE-2025-68665.yml
weaknesses:
  - CWE-1035
  - CWE-502
  - CWE-937
references:
  - url: https://github.com/langchain-ai/langchainjs
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchainjs/commit/e5063f9c6e9989ea067dfdff39262b9e7b6aba62
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchainjs/releases/tag/%40langchain%2Fcore%401.1.8
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchainjs/releases/tag/langchain%401.2.3
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchainjs/security/advisories/GHSA-r399-636x-v7f6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68665
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-r399-636x-v7f6
    reference_type:
    reference_id: GHSA-r399-636x-v7f6
