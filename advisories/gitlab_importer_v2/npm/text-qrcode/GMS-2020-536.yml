advisory_id: npm/text-qrcode/GMS-2020-536
datasource_id: gitlab_importer_v2/npm/text-qrcode/GMS-2020-536
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/text-qrcode/GMS-2020-536.yml
aliases:
  - GHSA-h5vj-f7r9-w564
  - GMS-2020-536
summary: |
  Entropy Backdoor in text-qrcode
  All versions of `text-qrcode` contain malicious code that overwrites the `randomBytes` method for the `crypto` module with a function that generates weak entropy. Instead of generating bytes, the infected randomBytes will generate 3 bytes of entropy and hash them, resulting in a byte value being returned, but one that is easily guessable. Uninstall `text-qrcode` immediately. If the module was used to generate entropy that is load bearing, all such instances of generated entropy must be replaced. This includes things like bitcoin wallets, private keys, encrypted messages, etc.
impacted_packages:
  - purl: pkg:npm/text-qrcode
    affected_versions: vers:npm/>=0.0.0
    fixed_versions: vers:npm/
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://www.npmjs.com/advisories/738
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-h5vj-f7r9-w564
    reference_type:
    reference_id: GHSA-h5vj-f7r9-w564
