advisory_id: npm/fastify/CVE-2025-32442
datasource_id: gitlab_importer_v2/npm/fastify/CVE-2025-32442
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/fastify/CVE-2025-32442.yml
aliases:
  - CVE-2025-32442
  - GHSA-mg2h-6x62-wpwc
summary: |
  Fastify vulnerable to invalid content-type parsing, which could lead to validation bypass
  In applications that specify different validation strategies for different content types, it's possible to bypass the validation by providing a _slightly altered_ content type such as with different casing or altered whitespacing before `;`.

  Users using the the following pattern are affected:

  ```js
  fastify.post('/', {
  handler(request, reply) {
  reply.code(200).send(request.body)
  },
  schema: {
  body: {
  content: {
  'application/json': {
  schema: {
  type: 'object',
  properties: {
  'foo': {
  type: 'string',
  }
  },
  required: ['foo']
  }
  },
  }
  }
  }
  })
  ```

  User using the following pattern are **not** affected:

  ```js
  fastify.post('/', {
  handler(request, reply) {
  reply.code(200).send(request.body)
  },
  schema: {
  body: {
  type: 'object',
  properties: {
  'foo': {
  type: 'string',
  }
  },
  required: ['foo']
  }
  }
  })
  ```
impacted_packages:
  - purl: pkg:npm/fastify
    affected_versions: vers:npm/4.29.0|>=4.29.0|<4.29.1|>=5.0.0|<5.3.2
    fixed_versions: vers:npm/4.29.1|5.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/fastify/CVE-2025-32442.yml
weaknesses:
  - CWE-1287
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/fastify/fastify
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify/commit/436da4c06dfbbb8c24adee3a64de0c51e4f47418
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify/commit/f3d2bcb3963cd570a582e5d39aab01a9ae692fe4
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify/security/advisories/GHSA-mg2h-6x62-wpwc
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/3087928
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32442
    reference_type:
    reference_id: CVE-2025-32442
  - url: https://github.com/advisories/GHSA-mg2h-6x62-wpwc
    reference_type:
    reference_id: GHSA-mg2h-6x62-wpwc
