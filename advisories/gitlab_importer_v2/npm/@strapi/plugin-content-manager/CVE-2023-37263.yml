advisory_id: npm/@strapi/plugin-content-manager/CVE-2023-37263
datasource_id: gitlab_importer_v2/npm/@strapi/plugin-content-manager/CVE-2023-37263
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@strapi/plugin-content-manager/CVE-2023-37263.yml
aliases:
  - CVE-2023-37263
  - GHSA-m284-85mf-cgrc
summary: |
  Strapi's field level permissions not being respected in relationship title
  ### Summary
  Field level permissions not being respected in relationship title.
  If I have a relationship title and the relationship shows a field I don't have permission to see I will still be visible.

  ### Details
  No RBAC checks on on the relationship the relation endpoint returns

  ### PoC
  #### Setup
  Create a fresh strapi instance
  Create a new content type
  in the newly created content type add a relation to the users-permissions user.
  Save.
  Create a users-permissions user
  Use your created content type and create an entry in it related to the users-permisisons user

  Go to settings -> Admin panel -> Roles -> Author
  Give the author role full permissions on the content type your created.
  Make sure they don't have any permission to see User
  Save

  Create a new admin account with only the author role
  #### CVE
  login on the newly created author acount.
  go to the content manager to the colection type you created with the relationship to users_permissions_user
  You now see a field you don't have permissions to view.

  ### Impact
  RBAC field level checks leaks data selected by the admin user as relationship title
  What could be sensitive fields that they should not be allowed to see. by the person having this specific role.
impacted_packages:
  - purl: pkg:npm/%40strapi/plugin-content-manager
    affected_versions: vers:npm/<4.12.1
    fixed_versions: vers:npm/4.12.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@strapi/plugin-content-manager/CVE-2023-37263.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/strapi/strapi/releases/tag/v4.12.1
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/security/advisories/GHSA-m284-85mf-cgrc
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-m284-85mf-cgrc
    reference_type:
    reference_id: GHSA-m284-85mf-cgrc
