advisory_id: npm/loopback-connector-postgresql/CVE-2022-35942
datasource_id: gitlab_importer_v2/npm/loopback-connector-postgresql/CVE-2022-35942
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/loopback-connector-postgresql/CVE-2022-35942.yml
aliases:
  - CVE-2022-35942
  - GHSA-j259-6c58-9m58
  - GMS-2022-3552
summary: |
  Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  Improper input validation on the `contains` LoopBack filter may allow for arbitrary SQL injection. When the extended filter property `contains` is permitted to be interpreted by the Postgres connector, it is possible to inject arbitrary SQL which may affect the confidentiality and integrity of data stored on the connected database. A patch was released in version 5.5.1. This affects users who does any of the following: - Connect to the database via the DataSource with `allowExtendedProperties: true` setting OR - Uses the connector's CRUD methods directly OR - Uses the connector's other methods to interpret the LoopBack filter. Users who are unable to upgrade should do the following if applicable: - Remove `allowExtendedProperties: true` DataSource setting - Add `allowExtendedProperties: false` DataSource setting - When passing directly to the connector functions, manually sanitize the user input for the `contains` LoopBack filter beforehand.
impacted_packages:
  - purl: pkg:npm/loopback-connector-postgresql
    affected_versions: vers:npm/<5.5.1
    fixed_versions: vers:npm/5.5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/loopback-connector-postgresql/CVE-2022-35942.yml
weaknesses:
  - CWE-89
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/loopbackio/loopback-connector-postgresql/commit/d57406c6737692a3a106b58a35406290cddb23e5
    reference_type:
    reference_id:
  - url: https://github.com/loopbackio/loopback-connector-postgresql/security/advisories/GHSA-j259-6c58-9m58
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-35942
    reference_type:
    reference_id: CVE-2022-35942
  - url: https://github.com/advisories/GHSA-j259-6c58-9m58
    reference_type:
    reference_id: GHSA-j259-6c58-9m58
