advisory_id: npm/cors-anywhere/CVE-2020-36851
datasource_id: gitlab_importer_v2/npm/cors-anywhere/CVE-2020-36851
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/cors-anywhere/CVE-2020-36851.yml
aliases:
  - CVE-2020-36851
  - GHSA-r3jv-xfgx-gj24
summary: |
  cors-anywhere vulnerable to server-side request forgery
  Rob -- W / cors-anywhere instances configured as an open proxy allow unauthenticated external users to induce the server to make HTTP requests to arbitrary targets (SSRF). Because the proxy forwards requests and headers, an attacker can reach internal-only endpoints and link-local metadata services, retrieve instance role credentials or other sensitive metadata, and interact with internal APIs and services that are not intended to be internet-facing. The vulnerability is exploitable by sending crafted requests to the proxy with the target resource encoded in the URL; many cors-anywhere deployments forward arbitrary methods and headers (including PUT), which can permit exploitation of IMDSv2 workflows as well as access to internal management APIs. Successful exploitation can result in theft of cloud credentials, unauthorized access to internal services, remote code execution or privilege escalation (depending on reachable backends), data exfiltration, and full compromise of cloud resources. Mitigation includes: restricting the proxy to trusted origins or authentication, allowlisting allowed target hosts, preventing access to link-local and internal IP ranges, removing support for unsafe HTTP methods/headers, enabling cloud provider mitigations, and deploying network-level protections.
impacted_packages:
  - purl: pkg:npm/cors-anywhere
    affected_versions: vers:npm/<=0.4.4
    fixed_versions: vers:npm/
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/cors-anywhere/CVE-2020-36851.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/Rob--W/cors-anywhere
    reference_type:
    reference_id:
  - url: https://github.com/Rob--W/cors-anywhere/issues/152
    reference_type:
    reference_id:
  - url: https://github.com/Rob--W/cors-anywhere/issues/521
    reference_type:
    reference_id:
  - url: https://github.com/Rob--W/cors-anywhere/issues/78
    reference_type:
    reference_id:
  - url: https://github.com/SocketDev/security-research/security/advisories/GHSA-9wmg-93pw-fc3g
    reference_type:
    reference_id:
  - url: https://www.certik.com/resources/blog/cors-anywhere-dangers-of-misconfigured-third-party-software
    reference_type:
    reference_id:
  - url: https://www.vulncheck.com/advisories/rob-w-cors-anywhere-misconfigured-cors-proxy-allows-ssrf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-36851
    reference_type:
    reference_id: CVE-2020-36851
  - url: https://github.com/advisories/GHSA-r3jv-xfgx-gj24
    reference_type:
    reference_id: GHSA-r3jv-xfgx-gj24
