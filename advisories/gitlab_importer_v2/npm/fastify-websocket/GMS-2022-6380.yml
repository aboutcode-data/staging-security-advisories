advisory_id: npm/fastify-websocket/GMS-2022-6380
datasource_id: gitlab_importer_v2/npm/fastify-websocket/GMS-2022-6380
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/fastify-websocket/GMS-2022-6380.yml
aliases:
  - CVE-2022-39386
  - GHSA-4pcg-wr6c-h9cq
  - GMS-2022-6380
summary: "fastify/websocket vulnerable to uncaught exception via crash on malformed packet\n\
  ### Impact\n\nAny application using @fastify/websocket could crash if a specific, malformed\
  \ packet is sent. \n\nAll versions of fastify-websocket are also impacted. That module is\
  \ deprecated, so it will not be patched.\n\n### Patches\n\nThis has been patched in v7.1.1\
  \ (fastify v4) and v5.0.1 (fastify v3).\n\n### Workarounds\n\nNo known workaround is available.\
  \ However, it should be possible to attach the error handler manually.\nThe recommended path\
  \ is upgrading to the patched versions.\n\n## Credits\n\n[marcolanaro](https://github.com/marcolanaro)\
  \ for finding and patching this vulnerability\n\n### For more information\n\nIf you have any\
  \ questions or comments about this advisory:\n* Open an issue in [@fastify/websocket](https://github.com/fastify/fastify-websocket)\n\
  * Email us at [hello@matteocollina.com](mailto:hello@matteocollina.com)"
impacted_packages:
  - purl: pkg:npm/fastify-websocket
    affected_versions: vers:npm/<=4.3.0
    fixed_versions: vers:npm/
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/fastify/fastify-websocket/releases/tag/v5.0.1
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-websocket/releases/tag/v7.1.1
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-websocket/security/advisories/GHSA-4pcg-wr6c-h9cq
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-4pcg-wr6c-h9cq
    reference_type:
    reference_id: GHSA-4pcg-wr6c-h9cq
