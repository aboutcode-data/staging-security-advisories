advisory_id: npm/mysql2/CVE-2024-21511
datasource_id: gitlab_importer_v2/npm/mysql2/CVE-2024-21511
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/mysql2/CVE-2024-21511.yml
aliases:
  - CVE-2024-21511
  - GHSA-4rch-2fh8-94vw
summary: |
  MySQL2 for Node Arbitrary Code Injection
  Versions of the package mysql2 before 3.9.7 are vulnerable to Arbitrary Code Injection due to improper sanitization of the timezone parameter in the readCodeFor function by calling a native MySQL Server date/time function.
impacted_packages:
  - purl: pkg:npm/mysql2
    affected_versions: vers:npm/<3.9.7
    fixed_versions: vers:npm/3.9.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/mysql2/CVE-2024-21511.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://github.com/sidorares/node-mysql2
    reference_type:
    reference_id:
  - url: https://github.com/sidorares/node-mysql2/commit/7d4b098c7e29d5a6cb9eac2633bfcc2f0f1db713
    reference_type:
    reference_id:
  - url: https://github.com/sidorares/node-mysql2/pull/2608
    reference_type:
    reference_id:
  - url: https://github.com/sidorares/node-mysql2/releases/tag/v3.9.7
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-JS-MYSQL2-6670046
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-21511
    reference_type:
    reference_id: CVE-2024-21511
  - url: https://github.com/advisories/GHSA-4rch-2fh8-94vw
    reference_type:
    reference_id: GHSA-4rch-2fh8-94vw
