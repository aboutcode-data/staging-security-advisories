advisory_id: npm/@tutao/tutanota-utils/GHSA-24v3-254g-jv85
datasource_id: gitlab_importer_v2/npm/@tutao/tutanota-utils/GHSA-24v3-254g-jv85
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@tutao/tutanota-utils/GHSA-24v3-254g-jv85.yml
aliases:
  - GHSA-24v3-254g-jv85
summary: |
  Tuta Mail has DOM attribute and CSS injection in its Contact Viewer feature
  Users importing contacts from untrusted sources.

  Specifically crafted contact data can lead to some of DOM modifications for the link button next to the field e.g. the link address can be overriden. CSS can be manipulated to give the button arbitrary look and change it's size so that any click on the screen would lead to the specified URL. Modifying event listeners does *not* seem to be possible so no JS can be executed (which would also be prevented by CSP).
impacted_packages:
  - purl: pkg:npm/%40tutao/tutanota-utils
    affected_versions: vers:npm/<314.251111.0
    fixed_versions: vers:npm/314.251111.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@tutao/tutanota-utils/GHSA-24v3-254g-jv85.yml
weaknesses:
  - CWE-1021
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/tutao/tutanota
    reference_type:
    reference_id:
  - url: https://github.com/tutao/tutanota/blob/452700a96d490646550ad2a02229973590291faf/src/mail-app/contacts/view/ContactViewer.ts#L326
    reference_type:
    reference_id:
  - url: https://github.com/tutao/tutanota/blob/452700a96d490646550ad2a02229973590291faf/src/mail-app/contacts/view/ContactViewer.ts#L341
    reference_type:
    reference_id:
  - url: https://github.com/tutao/tutanota/blob/452700a96d490646550ad2a02229973590291faf/src/mail-app/contacts/view/ContactViewer.ts#L356
    reference_type:
    reference_id:
  - url: https://github.com/tutao/tutanota/blob/452700a96d490646550ad2a02229973590291faf/src/mail-app/contacts/view/ContactViewer.ts#L391
    reference_type:
    reference_id:
  - url: https://github.com/tutao/tutanota/blob/452700a96d490646550ad2a02229973590291faf/src/mail-app/contacts/view/ContactViewer.ts#L415
    reference_type:
    reference_id:
  - url: https://github.com/tutao/tutanota/commit/e28345f5f78f628f9d5c04e785f79543f01dca8b
    reference_type:
    reference_id:
  - url: https://github.com/tutao/tutanota/security/advisories/GHSA-24v3-254g-jv85
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-24v3-254g-jv85
    reference_type:
    reference_id: GHSA-24v3-254g-jv85
