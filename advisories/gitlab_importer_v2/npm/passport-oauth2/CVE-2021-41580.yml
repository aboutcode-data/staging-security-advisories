advisory_id: npm/passport-oauth2/CVE-2021-41580
datasource_id: gitlab_importer_v2/npm/passport-oauth2/CVE-2021-41580
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/passport-oauth2/CVE-2021-41580.yml
aliases:
  - CVE-2021-41580
  - GHSA-f794-r6xc-hf3v
summary: |
  Improper Authentication
  ** DISPUTED ** The passport-oauth2 package for Node.js mishandles the error condition of failure to obtain an access token. This is exploitable in certain use cases where an OAuth identity provider uses an HTTP status code for authentication-failure error reports, and an application grants authorization upon simply receiving the access token (i.e., does not try to use the token). NOTE: the passport-oauth2 vendor does not consider this a passport-oauth2 vulnerability.
impacted_packages:
  - purl: pkg:npm/passport-oauth2
    affected_versions: vers:npm/<1.6.1
    fixed_versions: vers:npm/1.6.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/passport-oauth2/CVE-2021-41580.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/passport-oauth2/CVE-2021-41580.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/jaredhanson/passport-oauth2/commit/8e3bcdff145a2219033bd782fc517229fe3e05ea
    reference_type:
    reference_id:
  - url: https://github.com/jaredhanson/passport-oauth2/compare/v1.6.0...v1.6.1
    reference_type:
    reference_id:
  - url: https://github.com/jaredhanson/passport-oauth2/pull/144
    reference_type:
    reference_id:
  - url: https://medium.com/passportjs/no-access-token-no-service-7fb017c9e262
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41580
    reference_type:
    reference_id: CVE-2021-41580
  - url: https://github.com/advisories/GHSA-f794-r6xc-hf3v
    reference_type:
    reference_id: GHSA-f794-r6xc-hf3v
