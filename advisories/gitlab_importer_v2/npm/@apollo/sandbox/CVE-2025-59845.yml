advisory_id: npm/@apollo/sandbox/CVE-2025-59845
datasource_id: gitlab_importer_v2/npm/@apollo/sandbox/CVE-2025-59845
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@apollo/sandbox/CVE-2025-59845.yml
aliases:
  - CVE-2025-59845
  - GHSA-w87v-7w53-wwxv
summary: |
  Apollo Embedded Sandbox and Explorer vulnerable to CSRF via window.postMessage origin-validation bypass
  A **Cross-Site Request Forgery (CSRF)** vulnerability was identified in Apollo’s **Embedded Sandbox** and **Embedded Explorer**.

  The vulnerability arises from missing origin validation in the client-side code that handles `window.postMessage` events. A malicious website can send forged messages to the embedding page, causing the victim’s browser to execute arbitrary GraphQL queries or mutations against their GraphQL server while authenticated with the victim’s cookies.
impacted_packages:
  - purl: pkg:npm/%40apollo/sandbox
    affected_versions: vers:npm/<2.7.2
    fixed_versions: vers:npm/2.7.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@apollo/sandbox/CVE-2025-59845.yml
weaknesses:
  - CWE-352
  - CWE-1035
  - CWE-346
  - CWE-937
references:
  - url: https://github.com/apollographql/embeddable-explorer
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/embeddable-explorer/security/advisories/GHSA-w87v-7w53-wwxv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59845
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-w87v-7w53-wwxv
    reference_type:
    reference_id: GHSA-w87v-7w53-wwxv
