advisory_id: npm/secp256k1/CVE-2024-48930
datasource_id: gitlab_importer_v2/npm/secp256k1/CVE-2024-48930
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/secp256k1/CVE-2024-48930.yml
aliases:
  - CVE-2024-48930
  - GHSA-584q-6j8j-r5pm
summary: |
  secp256k1-node allows private key extraction over ECDH
  In `elliptic`-based version, `loadUncompressedPublicKey` has a check that the public key is on the curve: https://github.com/cryptocoinjs/secp256k1-node/blob/6d3474b81d073cc9c8cc8cfadb580c84f8df5248/lib/elliptic.js#L37-L39

  `loadCompressedPublicKey` is, however, missing that check: https://github.com/cryptocoinjs/secp256k1-node/blob/6d3474b81d073cc9c8cc8cfadb580c84f8df5248/lib/elliptic.js#L17-L19

  That allows the attacker to use public keys on low-cardinality curves to extract enough information to fully restore the private key from as little as 11 ECDH sessions, and very cheaply on compute power

  Other operations on public keys are also affected, including e.g. `publicKeyVerify()` incorrectly returning `true` on those invalid keys, and e.g. `publicKeyTweakMul()` also returning predictable outcomes allowing to restore the tweak
impacted_packages:
  - purl: pkg:npm/secp256k1
    affected_versions: vers:npm/<3.8.1|>=4.0.0|<4.0.4|5.0.0|>=5.0.0|<5.0.1
    fixed_versions: vers:npm/3.8.1|4.0.4|5.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/secp256k1/CVE-2024-48930.yml
weaknesses:
  - CWE-354
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/cryptocoinjs/secp256k1-node
    reference_type:
    reference_id:
  - url: https://github.com/cryptocoinjs/secp256k1-node/blob/6d3474b81d073cc9c8cc8cfadb580c84f8df5248/lib/elliptic.js#L17-L19
    reference_type:
    reference_id:
  - url: https://github.com/cryptocoinjs/secp256k1-node/blob/6d3474b81d073cc9c8cc8cfadb580c84f8df5248/lib/elliptic.js#L37-L39
    reference_type:
    reference_id:
  - url: https://github.com/cryptocoinjs/secp256k1-node/commit/8bd6446e000fa59df3cda0ae3e424300747ea5ed
    reference_type:
    reference_id:
  - url: https://github.com/cryptocoinjs/secp256k1-node/commit/9a15fff274f83a6ec7f675f1121babcc0c42292f
    reference_type:
    reference_id:
  - url: https://github.com/cryptocoinjs/secp256k1-node/commit/e256905ee649a7caacc251f7c964667195a52221
    reference_type:
    reference_id:
  - url: https://github.com/cryptocoinjs/secp256k1-node/security/advisories/GHSA-584q-6j8j-r5pm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-48930
    reference_type:
    reference_id: CVE-2024-48930
  - url: https://github.com/advisories/GHSA-584q-6j8j-r5pm
    reference_type:
    reference_id: GHSA-584q-6j8j-r5pm
