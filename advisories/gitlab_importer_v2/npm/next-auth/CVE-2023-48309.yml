advisory_id: npm/next-auth/CVE-2023-48309
datasource_id: gitlab_importer_v2/npm/next-auth/CVE-2023-48309
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/next-auth/CVE-2023-48309.yml
aliases:
  - CVE-2023-48309
  - GHSA-v64w-49xw-qq89
summary: |
  Possible user mocking that bypasses basic authentication
  NextAuth.js provides authentication for Next.js. `next-auth` applications prior to version 4.24.5 that rely on the default Middleware authorization are affected by a vulnerability. A bad actor could create an empty/mock user, by getting hold of a NextAuth.js-issued JWT from an interrupted OAuth sign-in flow (state, PKCE or nonce). Manually overriding the `next-auth.session-token` cookie value with this non-related JWT would let the user simulate a logged in user, albeit having no user information associated with it. (The only property on this user is an opaque randomly generated string). This vulnerability does not give access to other users' data, neither to resources that require proper authorization via scopes or other means. The created mock user has no information associated with it (ie. no name, email, access_token, etc.) This vulnerability can be exploited by bad actors to peek at logged in user states (e.g. dashboard layout). `next-auth` `v4.24.5` contains a patch for the vulnerability. As a workaround, using a custom authorization callback for Middleware, developers can manually do a basic authentication.
impacted_packages:
  - purl: pkg:npm/next-auth
    affected_versions: vers:npm/<4.24.5
    fixed_versions: vers:npm/4.24.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/next-auth/CVE-2023-48309.yml
weaknesses:
  - CWE-285
  - CWE-1035
  - CWE-937
references:
  - url: https://authjs.dev/guides/basics/role-based-access-control
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/commit/d237059b6d0cb868c041ba18b698e0cee20a2f10
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-v64w-49xw-qq89
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/nextjs#advanced-usage
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/nextjs#middlewar
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-48309
    reference_type:
    reference_id: CVE-2023-48309
  - url: https://github.com/advisories/GHSA-v64w-49xw-qq89
    reference_type:
    reference_id: GHSA-v64w-49xw-qq89
