advisory_id: npm/next-auth/CVE-2022-31093
datasource_id: gitlab_importer_v2/npm/next-auth/CVE-2022-31093
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/next-auth/CVE-2022-31093.yml
aliases:
  - CVE-2022-31093
  - GHSA-g5fm-jp9v-2432
  - GMS-2022-2609
summary: |
  Improper Check for Unusual or Exceptional Conditions
  NextAuth.js is a complete open source authentication solution for Next.js applications. In affected versions an attacker can send a request to an app using NextAuth.js with an invalid `callbackUrl` query parameter, which internally is converted to a `URL` object. The URL instantiation would fail due to a malformed URL being passed into the constructor, causing it to throw an unhandled error which led to the **API route handler timing out and logging in to fail**. This has been remedied in versions 3.29.5 and 4.5.0. If for some reason you cannot upgrade, the workaround requires you to rely on Advanced Initialization. Please see the documentation for more.
impacted_packages:
  - purl: pkg:npm/next-auth
    affected_versions: vers:npm/>=3.0.0|<3.29.5|>=4.0.0|<4.5.0
    fixed_versions: vers:npm/3.29.5|4.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/next-auth/CVE-2022-31093.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/next-auth/CVE-2022-31093.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-754
references:
  - url: https://github.com/nextauthjs/next-auth/commit/25517b73153332d948114bacdff3b5908de91d85
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/commit/e498483b23273d1bfc81be68339607f88d411bd6
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-g5fm-jp9v-2432
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/initialization#advanced-initialization
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31093
    reference_type:
    reference_id: CVE-2022-31093
  - url: https://github.com/advisories/GHSA-g5fm-jp9v-2432
    reference_type:
    reference_id: GHSA-g5fm-jp9v-2432
