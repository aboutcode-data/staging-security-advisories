advisory_id: npm/@pagefind/default-ui/CVE-2024-45389
datasource_id: gitlab_importer_v2/npm/@pagefind/default-ui/CVE-2024-45389
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@pagefind/default-ui/CVE-2024-45389.yml
aliases:
  - CVE-2024-45389
  - GHSA-gprj-6m2f-j9hx
summary: |
  DOM clobbering could escalate to Cross-site Scripting (XSS)
  Pagefind initializes its dynamic JavaScript and WebAssembly files relative to the location of the first script you load. This information is gathered by looking up the value of `document.currentScript.src`.

  It is possible to "clobber" this lookup with otherwise benign HTML on the page, for example:
  ```html
  <img name="currentScript" src="blob:https://xxx.xxx.xxx/ui.js"></img>
  ```

  This will cause `document.currentScript.src` to resolve as an external domain, which will then be used by Pagefind to load dependencies.

  This exploit would only work in the case that an attacker could inject HTML to your live, hosted, website. In these cases, this would act as a way to escalate the privilege available to an attacker. This assumes they have the ability to add some elements to the page (for example, `img` tags with a `name` attribute), but not others, as adding a `script` to the page would itself be the XSS vector.

  Pagefind has tightened this resolution by ensuring the source is loaded from a valid script element. There are no reports of this being exploited in the wild via Pagefind.
impacted_packages:
  - purl: pkg:npm/%40pagefind/default-ui
    affected_versions: vers:npm/<1.1.1
    fixed_versions: vers:npm/1.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@pagefind/default-ui/CVE-2024-45389.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/CloudCannon/pagefind
    reference_type:
    reference_id:
  - url: https://github.com/CloudCannon/pagefind/commit/14ec96864eabaf1d7d809d5da0186a8856261eeb
    reference_type:
    reference_id:
  - url: https://github.com/CloudCannon/pagefind/security/advisories/GHSA-gprj-6m2f-j9hx
    reference_type:
    reference_id:
  - url: https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45389
    reference_type:
    reference_id: CVE-2024-45389
  - url: https://github.com/advisories/GHSA-gprj-6m2f-j9hx
    reference_type:
    reference_id: GHSA-gprj-6m2f-j9hx
