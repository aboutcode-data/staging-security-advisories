advisory_id: npm/@kindspells/astro-shield/CVE-2024-30250
datasource_id: gitlab_importer_v2/npm/@kindspells/astro-shield/CVE-2024-30250
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@kindspells/astro-shield/CVE-2024-30250.yml
aliases:
  - CVE-2024-30250
  - GHSA-c4gr-q97g-ppwc
summary: |
  In Astro-Shield, setting a correct `integrity` attribute to injected code allows to bypass the allow-lists
  Versions from 1.2.0 to 1.3.1 of Astro-Shield allow to bypass the allow-lists for cross-origin resources by introducing valid `integrity` attributes to the injected code. This implies that the injected SRI hash would be added to the generated CSP header, which would lead the browser to believe that the injected resource is legit.

  To exploit this vulnerability, the attacker needs to first inject code into the rendered pages by exploiting other not-related potential vulnerabilities.
impacted_packages:
  - purl: pkg:npm/%40kindspells/astro-shield
    affected_versions: vers:npm/>=1.2.0|<1.3.2
    fixed_versions: vers:npm/1.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@kindspells/astro-shield/CVE-2024-30250.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-345
references:
  - url: https://github.com/kindspells/astro-shield
    reference_type:
    reference_id:
  - url: https://github.com/kindspells/astro-shield/commit/1221019306f501bf5fa9bcfb5a23a2321d34ba0a
    reference_type:
    reference_id:
  - url: https://github.com/kindspells/astro-shield/commit/5ae8b8ef4f681d3a81431ee7e79d5dec545c6e1f
    reference_type:
    reference_id:
  - url: https://github.com/kindspells/astro-shield/releases/tag/1.3.2
    reference_type:
    reference_id:
  - url: https://github.com/kindspells/astro-shield/security/advisories/GHSA-c4gr-q97g-ppwc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-30250
    reference_type:
    reference_id: CVE-2024-30250
  - url: https://github.com/advisories/GHSA-c4gr-q97g-ppwc
    reference_type:
    reference_id: GHSA-c4gr-q97g-ppwc
