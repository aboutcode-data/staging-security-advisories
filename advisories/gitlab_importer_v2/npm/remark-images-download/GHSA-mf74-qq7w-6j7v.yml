advisory_id: npm/remark-images-download/GHSA-mf74-qq7w-6j7v
datasource_id: gitlab_importer_v2/npm/remark-images-download/GHSA-mf74-qq7w-6j7v
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/remark-images-download/GHSA-mf74-qq7w-6j7v.yml
aliases:
  - GHSA-mf74-qq7w-6j7v
summary: |
  Zmarkdown Server-Side Request Forgery (SSRF) in remark-download-images
  A major blind SSRF has been found in `remark-images-download`, which allowed
  for requests to be made to neighboring servers on local IP ranges.
  The issue came from a loose filtering of URLs inside the module.

  Imagine a server running on a private network `192.168.1.0/24`.
  A private service serving images is running on `192.168.1.2`, and
  is not expected to be accessed by users. A machine is running
  `remark-images-download` on the neighboring `192.168.1.3` host.
  An user enters the following Markdown:

  ```markdown
  ![](http://192.168.1.2/private-img.png)
  ```

  The image is downloaded by the server and included inside the resulting
  document. Hence, the user has access to the private image.

  It has been corrected by preventing images downloads from
  local IP ranges, both in IPv4 and IPv6.
  To avoid malicious domain names, resolved local IPs from are also
  forbidden inside the module.
  This vulnerability impact is moderate, as it is can allow access to
  unexposed documents on the local network, and is very easy
  to exploit.
impacted_packages:
  - purl: pkg:npm/remark-images-download
    affected_versions: vers:npm/<3.1.0
    fixed_versions: vers:npm/3.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/zestedesavoir/zmarkdown
    reference_type:
    reference_id:
  - url: https://github.com/zestedesavoir/zmarkdown/security/advisories/GHSA-mf74-qq7w-6j7v
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-mf74-qq7w-6j7v
    reference_type:
    reference_id: GHSA-mf74-qq7w-6j7v
