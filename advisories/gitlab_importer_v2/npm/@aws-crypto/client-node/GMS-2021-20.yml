advisory_id: npm/@aws-crypto/client-node/GMS-2021-20
datasource_id: gitlab_importer_v2/npm/@aws-crypto/client-node/GMS-2021-20
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@aws-crypto/client-node/GMS-2021-20.yml
aliases:
  - GHSA-h45p-w933-jxh3
  - GMS-2021-20
summary: |
  Improper Verification of Cryptographic Signature in aws-encryption-sdk-javascript
  This ESDK supports a streaming mode where callers may stream the plaintext of signed messages before the ECDSA signature is validated. In addition to these signatures, the ESDK uses AES-GCM encryption and all plaintext is verified before being released to a caller. There is no impact on the integrity of the ciphertext or decrypted plaintext, however some callers may rely on the the ECDSA signature for non-repudiation. Without validating the ECDSA signature, an actor with trusted KMS permissions to decrypt a message may also be able to encrypt messages. This update introduces a new API for callers who wish to stream only unsigned messages.
impacted_packages:
  - purl: pkg:npm/%40aws-crypto/client-node
    affected_versions: vers:npm/<1.9.0|>=2.0.0|<2.2.0
    fixed_versions: vers:npm/1.9.0|2.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/aws/aws-encryption-sdk-javascript/security/advisories/GHSA-h45p-w933-jxh3
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-h45p-w933-jxh3
    reference_type:
    reference_id: GHSA-h45p-w933-jxh3
