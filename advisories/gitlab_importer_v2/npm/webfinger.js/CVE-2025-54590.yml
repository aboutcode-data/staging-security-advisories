advisory_id: npm/webfinger.js/CVE-2025-54590
datasource_id: gitlab_importer_v2/npm/webfinger.js/CVE-2025-54590
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/webfinger.js/CVE-2025-54590.yml
aliases:
  - CVE-2025-54590
  - GHSA-8xq3-w9fx-74rv
summary: |
  webfinger.js Blind SSRF Vulnerability
  The lookup function takes a user address for checking accounts as a feature, however, as per
  the ActivityPub spec (https://www.w3.org/TR/activitypub/#security-considerations), on the
  security considerations section at B.3, access to Localhost services should be prevented while
  running in production. The library does not prevent Localhost access (neither does it prevent
  LAN addresses such as 192.168.x.x) , thus is not safe for use in production by ActivityPub
  applications. The only check for localhost is done for selecting between HTTP and HTTPS
  protocols, and it is done by testing for a host that starts with the string “localhost” and ends with
  a port. Anything else (such as “127.0.0.1” or “localhost:1234/abc”) would not be considered
  localhost for this test.

  In addition, the way that the function determines the host, makes it possible to access any path
  in the host, not only “/.well-known/...” paths:

  ```javascript
  if (address.indexOf('://') > -1) {
  // other uri format
  host = address.replace(/ /g,'').split('/')[2];
  } else {
  // useraddress
  host = address.replace(/ /g,'').split('@')[1];
  }

  var uri_index = 0; // track which URIS we've tried already
  var protocol = 'https'; // we use https by default

  if (self.__isLocalhost(host)) {
  protocol = 'http';
  }

  function __buildURL() {
  var uri = '';
  if (! address.split('://')[1]) {
  // the URI has not been defined, default to acct
  uri = 'acct:';
  }
  return protocol + '://' + host + '/.well-known/' +URIS[uri_index] + '?resource=' + uri + address;
  }
  ```

  If the address is in the format of a user address (user@host.com), the host will be anything
  after the first found @ symbol. Since no other test is done, an adversary may pass a specially
  crafted address such as user@localhost:7000/admin/restricted_page? and reach pages that
  would normally be out of reach. In this example, the code would treat
  localhost:7000/admin/restricted_page? as the host, and the created URL would be
  https://localhost:7000/admin/restricted_page?/.well-known/webfinger?resource=acct:use
  r@localhost:7000/admin/restricted_page?. A server listening on localhost:7000 will then
  parse the request as a GET request for the page /admin/restricted_page with the query string
  /.well-known/webfinger?resource=acct:user@localhost:7000/admin/restricted_page?.
impacted_packages:
  - purl: pkg:npm/webfinger.js
    affected_versions: vers:npm/<2.8.1
    fixed_versions: vers:npm/2.8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/webfinger.js/CVE-2025-54590.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/silverbucket/webfinger.js
    reference_type:
    reference_id:
  - url: https://github.com/silverbucket/webfinger.js/commit/b5f2f2c957297d25f4d76072963fccaee2e3095a
    reference_type:
    reference_id:
  - url: https://github.com/silverbucket/webfinger.js/releases/tag/v2.8.1
    reference_type:
    reference_id:
  - url: https://github.com/silverbucket/webfinger.js/security/advisories/GHSA-8xq3-w9fx-74rv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54590
    reference_type:
    reference_id: CVE-2025-54590
  - url: https://github.com/advisories/GHSA-8xq3-w9fx-74rv
    reference_type:
    reference_id: GHSA-8xq3-w9fx-74rv
