advisory_id: npm/cookie/CVE-2024-47764
datasource_id: gitlab_importer_v2/npm/cookie/CVE-2024-47764
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/cookie/CVE-2024-47764.yml
aliases:
  - CVE-2024-47764
  - GHSA-pxg6-pf52-xh8x
summary: |
  cookie accepts cookie name, path, and domain with out of bounds characters
  The cookie name could be used to set other fields of the cookie, resulting in an unexpected cookie value. For example, `serialize("userName=<script>alert('XSS3')</script>; Max-Age=2592000; a", value)` would result in `"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a=test"`, setting `userName` cookie to `<script>` and ignoring `value`.

  A similar escape can be used for `path` and `domain`, which could be abused to alter other fields of the cookie.
impacted_packages:
  - purl: pkg:npm/cookie
    affected_versions: vers:npm/<0.7.0
    fixed_versions: vers:npm/0.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-74
references:
  - url: https://github.com/jshttp/cookie
    reference_type:
    reference_id:
  - url: https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c
    reference_type:
    reference_id:
  - url: https://github.com/jshttp/cookie/pull/167
    reference_type:
    reference_id:
  - url: https://github.com/jshttp/cookie/security/advisories/GHSA-pxg6-pf52-xh8x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47764
    reference_type:
    reference_id: CVE-2024-47764
  - url: https://github.com/advisories/GHSA-pxg6-pf52-xh8x
    reference_type:
    reference_id: GHSA-pxg6-pf52-xh8x
