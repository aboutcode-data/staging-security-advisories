advisory_id: npm/mockjs/CVE-2023-26158
datasource_id: gitlab_importer_v2/npm/mockjs/CVE-2023-26158
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/mockjs/CVE-2023-26158.yml
aliases:
  - CVE-2023-26158
summary: "Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')\n\
  All versions of the package mockjs is vulnerable to Prototype Pollution via the Util.extend\
  \ function due to missing check if the attribute resolves to the object prototype. By adding\
  \ or modifying attributes of an object prototype, it is possible to create attributes that\
  \ exist on every object, or replace critical attributes with malicious ones. This can be problematic\
  \ if the software depends on existence or non-existence of certain attributes, or uses pre-defined\
  \ attributes of object prototype (such as hasOwnProperty, toString or valueOf).\r\rUser controlled\
  \ inputs inside the extend() method of the Mock.Handler, Mock.Random, Mock.RE.Handler or Mock.Util,\
  \ will allow an attacker to exploit this vulnerability.\r\r Workaround\r\rBy using a denylist\
  \ of dangerous attributes, this weakness can be eliminated.\r\rAdd the following line in the\
  \ Util.extend function:\r\rjs\rjs if ([\"__proto__\", \"constructor\", \"prototype\"].includes(name))\
  \ continue\r\r\rjs\r// src/mock/handler.js\rUtil.extend = function extend() {\r    var target\
  \ = arguments[0] || {},\r      i = 1,\r      length = arguments.length,\r      options, name,\
  \ src, copy, clone\r\r    if (length === 1) {\r      target = this\r      i = 0\r    }\r\r\
  \    for (; i < length; i++) {\r      options = arguments[i]\r      if (!options) continue\r\
  \r      for (name in options) {\r      if ([\"__proto__\", \"constructor\", \"prototype\"\
  ].includes(name)) continue\r        src = target[name]\r        copy = options[name]\r\r \
  \       if (target === copy) continue\r        if (copy === undefined) continue\r\r      \
  \  if (Util.isArray(copy) || Util.isObject(copy)) {\r          if (Util.isArray(copy)) clone\
  \ = src && Util.isArray(src) ? src : []\r          if (Util.isObject(copy)) clone = src &&\
  \ Util.isObject(src) ? src : {}\r\r          target[name] = Util.extend(clone, copy)\r   \
  \     } else {\r          target[name] = copy\r        }\r      }\r    }\r\r    return target\r\
  \  }"
impacted_packages:
  - purl: pkg:npm/mockjs
    affected_versions: vers:npm/<=1.1.0
    fixed_versions: vers:npm/
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/mockjs/CVE-2023-26158.yml
weaknesses:
  - CWE-1321
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/nuysoft/Mock/blob/00ce04b92eb464e664a4438430903f2de96efb47/dist/mock.js%23L721-L755
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-JS-MOCKJS-6051365
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-26158
    reference_type:
    reference_id: CVE-2023-26158
