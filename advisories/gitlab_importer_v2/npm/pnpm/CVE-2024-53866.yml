advisory_id: npm/pnpm/CVE-2024-53866
datasource_id: gitlab_importer_v2/npm/pnpm/CVE-2024-53866
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/pnpm/CVE-2024-53866.yml
aliases:
  - CVE-2024-53866
  - GHSA-vm32-9rqf-rh3r
summary: |
  pnpm no-script global cache poisoning via overrides / `ignore-scripts` evasion
  pnpm seems to mishandle overrides and global cache:
  1. Overrides from one workspace leak into npm metadata saved in global cache
  2. npm metadata from global cache affects other workspaces
  3. installs by default don't revalidate the data (including on first lockfile generation)

  This can make workspace A (even running with `ignore-scripts=true`) posion global cache and execute scripts in workspace B

  Users generally expect `ignore-scripts` to be sufficient to prevent immediate code execution on install (e.g. when the tree is just repacked/bundled without executing it).

  Here, that expectation is broken
impacted_packages:
  - purl: pkg:npm/pnpm
    affected_versions: vers:npm/<9.15.0
    fixed_versions: vers:npm/9.15.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/pnpm/CVE-2024-53866.yml
weaknesses:
  - CWE-426
  - CWE-1035
  - CWE-346
  - CWE-937
references:
  - url: https://github.com/pnpm/pnpm
    reference_type:
    reference_id:
  - url: https://github.com/pnpm/pnpm/commit/11afcddea48f25ed5117a87dc1780a55222b9743
    reference_type:
    reference_id:
  - url: https://github.com/pnpm/pnpm/security/advisories/GHSA-vm32-9rqf-rh3r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-53866
    reference_type:
    reference_id: CVE-2024-53866
  - url: https://github.com/advisories/GHSA-vm32-9rqf-rh3r
    reference_type:
    reference_id: GHSA-vm32-9rqf-rh3r
