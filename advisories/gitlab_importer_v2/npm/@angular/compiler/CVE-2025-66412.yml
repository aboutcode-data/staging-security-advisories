advisory_id: npm/@angular/compiler/CVE-2025-66412
datasource_id: gitlab_importer_v2/npm/@angular/compiler/CVE-2025-66412
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@angular/compiler/CVE-2025-66412.yml
aliases:
  - CVE-2025-66412
  - GHSA-v4hv-rgfq-gp49
summary: |
  Angular Stored XSS Vulnerability via SVG Animation, SVG URL and MathML Attributes
  A **Stored Cross-Site Scripting ([XSS](https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss))** vulnerability has been identified in the **Angular Template Compiler**. It occurs because the compiler's internal security schema is incomplete, allowing attackers to bypass Angular's built-in security sanitization. Specifically, the schema fails to classify certain URL-holding attributes (e.g., those that could contain [`javascript:` URLs](https://developer.mozilla.org/en-US/Web/URI/Reference/Schemes/javascript)) as requiring strict URL security, enabling the injection of malicious scripts.

  Additionally, a related vulnerability exists involving SVG animation elements (`<animate>`, `<set>`, `<animateMotion>`, `<animateTransform>`). The `attributeName` attribute on these elements was not properly validated, allowing attackers to dynamically target security-sensitive attributes like `href` or `xlink:href` on other elements. By binding `attributeName` to "href" and providing a `javascript:` URL in the `values` or `to` attribute, an attacker could bypass sanitization and execute arbitrary code.

  Attributes confirmed to be vulnerable include:
  *   SVG-related attributes: (e.g., `xlink:href`), and various MathML attributes (e.g., `math|href`, `annotation|href`).
  *   SVG animation `attributeName` attribute when bound to "href" or "xlink:href".

  When template binding is used to assign untrusted, user-controlled data to these attributes (e.g., `[attr.xlink:href]="maliciousURL"` or `<animate [attributeName]="'href'" [values]="maliciousURL">`), the compiler incorrectly falls back to a non-sanitizing context or fails to block the dangerous attribute assignment. This allows an attacker to inject a `javascript:URL` payload. Upon user interaction (like a click) on the element, or automatically in the case of animations, the malicious JavaScript executes in the context of the application's origin.
impacted_packages:
  - purl: pkg:npm/%40angular/compiler
    affected_versions: vers:npm/<=18.2.14|>=19.0.0-next.0|<19.2.17|>=20.0.0-next.0|<20.3.15|>=21.0.0-next.0|<21.0.2
    fixed_versions: vers:npm/19.2.17|20.3.15|21.0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@angular/compiler/CVE-2025-66412.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/angular/angular
    reference_type:
    reference_id:
  - url: https://github.com/angular/angular/commit/1c6b0704fb63d051fab8acff84d076abfbc4893a
    reference_type:
    reference_id:
  - url: https://github.com/angular/angular/security/advisories/GHSA-v4hv-rgfq-gp49
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66412
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-v4hv-rgfq-gp49
    reference_type:
    reference_id: GHSA-v4hv-rgfq-gp49
