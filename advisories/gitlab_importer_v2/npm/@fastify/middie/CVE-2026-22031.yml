advisory_id: npm/@fastify/middie/CVE-2026-22031
datasource_id: gitlab_importer_v2/npm/@fastify/middie/CVE-2026-22031
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@fastify/middie/CVE-2026-22031.yml
aliases:
  - CVE-2026-22031
  - GHSA-cxrg-g7r8-w69p
summary: |
  Fastify Middie Middleware Path Bypass
  A security vulnerability exists in `@fastify/middie` where middleware registered with a specific path prefix can be bypassed using URL-encoded characters (e.g., `/%61dmin` instead of `/admin`). While the middleware engine fails to match the encoded path and skips execution, the underlying Fastify router correctly decodes the path and matches the route handler, allowing attackers to access protected endpoints without the middleware constraints.
impacted_packages:
  - purl: pkg:npm/%40fastify/middie
    affected_versions: vers:npm/<9.1.0
    fixed_versions: vers:npm/9.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@fastify/middie/CVE-2026-22031.yml
weaknesses:
  - CWE-177
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/fastify/middie
    reference_type:
    reference_id:
  - url: https://github.com/fastify/middie/commit/d44cd56eb724490babf7b452fdbbdd37ea2effba
    reference_type:
    reference_id:
  - url: https://github.com/fastify/middie/pull/245
    reference_type:
    reference_id:
  - url: https://github.com/fastify/middie/releases/tag/v9.1.0
    reference_type:
    reference_id:
  - url: https://github.com/fastify/middie/security/advisories/GHSA-cxrg-g7r8-w69p
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22031
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-cxrg-g7r8-w69p
    reference_type:
    reference_id: GHSA-cxrg-g7r8-w69p
