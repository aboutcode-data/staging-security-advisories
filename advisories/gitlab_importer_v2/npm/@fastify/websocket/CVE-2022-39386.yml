advisory_id: npm/@fastify/websocket/CVE-2022-39386
datasource_id: gitlab_importer_v2/npm/@fastify/websocket/CVE-2022-39386
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@fastify/websocket/CVE-2022-39386.yml
aliases:
  - CVE-2022-39386
  - GHSA-4pcg-wr6c-h9cq
  - GMS-2022-6369
summary: |
  Crash on malformed packet
  @fastify/websocket provides WebSocket support for Fastify. Any application using @fastify/websocket could crash if a specific, malformed packet is sent. All versions of fastify-websocket are also impacted. That module is deprecated, so it will not be patched. This has been patched in version 7.1.1 (fastify v4) and version 5.0.1 (fastify v3). There are currently no known workarounds. However, it should be possible to attach the error handler manually. The recommended path is upgrading to the patched versions.
impacted_packages:
  - purl: pkg:npm/%40fastify/websocket
    affected_versions: vers:npm/<=5.0.0|>=6.0.0|<7.1.1
    fixed_versions: vers:npm/5.0.1|7.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@fastify/websocket/CVE-2022-39386.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/fastify/fastify-websocket/releases/tag/v5.0.1
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-websocket/releases/tag/v7.1.1
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-websocket/security/advisories/GHSA-4pcg-wr6c-h9cq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39386
    reference_type:
    reference_id: CVE-2022-39386
  - url: https://github.com/advisories/GHSA-4pcg-wr6c-h9cq
    reference_type:
    reference_id: GHSA-4pcg-wr6c-h9cq
