advisory_id: npm/@fastify/express/CVE-2026-22037
datasource_id: gitlab_importer_v2/npm/@fastify/express/CVE-2026-22037
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@fastify/express/CVE-2026-22037.yml
aliases:
  - CVE-2026-22037
  - GHSA-g6q3-96cp-5r5m
summary: |
  @fastify/express vulnerable to Improper Handling of URL Encoding (Hex Encoding)
  A security vulnerability exists in `@fastify/express` where middleware registered with a specific path prefix can be bypassed using URL-encoded characters (e.g., `/%61dmin` instead of `/admin`). While the middleware engine fails to match the encoded path and skips execution, the underlying Fastify router correctly decodes the path and matches the route handler, allowing attackers to access protected endpoints without the middleware constraints.
impacted_packages:
  - purl: pkg:npm/%40fastify/express
    affected_versions: vers:npm/<4.0.3
    fixed_versions: vers:npm/4.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@fastify/express/CVE-2026-22037.yml
weaknesses:
  - CWE-177
  - CWE-288
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/fastify/fastify-express
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-express/commit/dc02a3fe1387f945143f22597baa42557d549a40
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-express/releases/tag/v4.0.3
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-express/security/advisories/GHSA-g6q3-96cp-5r5m
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22037
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-g6q3-96cp-5r5m
    reference_type:
    reference_id: GHSA-g6q3-96cp-5r5m
