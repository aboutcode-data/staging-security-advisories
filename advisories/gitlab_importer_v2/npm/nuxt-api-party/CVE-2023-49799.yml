advisory_id: npm/nuxt-api-party/CVE-2023-49799
datasource_id: gitlab_importer_v2/npm/nuxt-api-party/CVE-2023-49799
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/nuxt-api-party/CVE-2023-49799.yml
aliases:
  - CVE-2023-49799
  - GHSA-3wfp-253j-5jxv
summary: '`nuxt-api-party` is an open source module to proxy API requests. nuxt-api-party attempts
  to check if the user has passed an absolute URL to prevent the aforementioned attack. This
  has been recently changed to use the regular expression `^https?://`, however this regular
  expression can be bypassed by an absolute URL with leading whitespace. For example `\nhttps://whatever.com`
  which has a leading newline. According to the fetch specification, before a fetch is made
  the URL is normalized. "To normalize a byte sequence potentialValue, remove any leading and
  trailing HTTP whitespace bytes from potentialValue.". This means the final request will be
  normalized to `https://whatever.com` bypassing the check and nuxt-api-party will send a request
  outside of the allow list. This could allow us to leak credentials or perform Server-Side
  Request Forgery (SSRF). This vulnerability has been addressed in version 0.22.1. Users are
  advised to upgrade. Users unable to upgrade should revert to the previous method of detecting
  absolute URLs.'
impacted_packages:
  - purl: pkg:npm/nuxt-api-party
    affected_versions: vers:npm/<0.22.0
    fixed_versions: vers:npm/0.22.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/nuxt-api-party/CVE-2023-49799.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-918
references:
  - url: https://fetch.spec.whatwg.org/
    reference_type:
    reference_id:
  - url: https://fetch.spec.whatwg.org/#http-whitespace-byte
    reference_type:
    reference_id:
  - url: https://github.com/johannschopplich/nuxt-api-party/blob/777462e1e3af1d9f8938aa33f230cd8cb6e0cc9a/src/runtime/server/handler.ts#L31
    reference_type:
    reference_id:
  - url: https://github.com/johannschopplich/nuxt-api-party/commit/72762a200fc19d997a0f84bce578c28698dc5270
    reference_type:
    reference_id:
  - url: https://github.com/johannschopplich/nuxt-api-party/security/advisories/GHSA-3wfp-253j-5jxv
    reference_type:
    reference_id:
  - url: https://infra.spec.whatwg.org/#byte-sequence
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-49799
    reference_type:
    reference_id: CVE-2023-49799
  - url: https://github.com/advisories/GHSA-3wfp-253j-5jxv
    reference_type:
    reference_id: GHSA-3wfp-253j-5jxv
