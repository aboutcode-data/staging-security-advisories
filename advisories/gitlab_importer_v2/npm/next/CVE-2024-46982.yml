advisory_id: npm/next/CVE-2024-46982
datasource_id: gitlab_importer_v2/npm/next/CVE-2024-46982
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/next/CVE-2024-46982.yml
aliases:
  - CVE-2024-46982
  - GHSA-gp8f-8m3g-qvj9
summary: |
  Next.js Cache Poisoning
  By sending a crafted HTTP request, it is possible to poison the cache of a non-dynamic server-side rendered route in the pages router (this does not affect the app router). When this crafted request is sent it could coerce Next.js to cache a route that is meant to not be cached and send a `Cache-Control: s-maxage=1, stale-while-revalidate` header which some upstream CDNs may cache as well.

  To be potentially affected all of the following must apply:

  - Next.js between 13.5.1 and 14.2.9
  - Using pages router
  - Using non-dynamic server-side rendered routes e.g. `pages/dashboard.tsx` not `pages/blog/[slug].tsx`

  The below configurations are unaffected:

  - Deployments using only app router
  - Deployments on [Vercel](https://vercel.com/) are not affected
impacted_packages:
  - purl: pkg:npm/next
    affected_versions: vers:npm/>=13.5.1|<13.5.7|>=14.0.0|<14.2.10
    fixed_versions: vers:npm/13.5.7|14.2.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/next/CVE-2024-46982.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-349
  - CWE-639
references:
  - url: https://github.com/vercel/next.js
    reference_type:
    reference_id:
  - url: https://github.com/vercel/next.js/commit/7ed7f125e07ef0517a331009ed7e32691ba403d3
    reference_type:
    reference_id:
  - url: https://github.com/vercel/next.js/commit/bd164d53af259c05f1ab434004bcfdd3837d7cda
    reference_type:
    reference_id:
  - url: https://github.com/vercel/next.js/security/advisories/GHSA-gp8f-8m3g-qvj9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-46982
    reference_type:
    reference_id: CVE-2024-46982
  - url: https://github.com/advisories/GHSA-gp8f-8m3g-qvj9
    reference_type:
    reference_id: GHSA-gp8f-8m3g-qvj9
