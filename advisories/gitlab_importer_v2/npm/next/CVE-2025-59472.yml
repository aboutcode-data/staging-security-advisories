advisory_id: npm/next/CVE-2025-59472
datasource_id: gitlab_importer_v2/npm/next/CVE-2025-59472
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/next/CVE-2025-59472.yml
aliases:
  - CVE-2025-59472
  - GHSA-5f7q-jpqc-wp7h
summary: |
  Next.js has Unbounded Memory Consumption via PPR Resume Endpoint
  A denial of service vulnerability exists in Next.js versions with Partial Prerendering (PPR) enabled when running in minimal mode. The PPR resume endpoint accepts unauthenticated POST requests with the `Next-Resume: 1` header and processes attacker-controlled postponed state data. Two closely related vulnerabilities allow an attacker to crash the server process through memory exhaustion:

  1. **Unbounded request body buffering**: The server buffers the entire POST request body into memory using `Buffer.concat()` without enforcing any size limit, allowing arbitrarily large payloads to exhaust available memory.

  2. **Unbounded decompression (zipbomb)**: The resume data cache is decompressed using `inflateSync()` without limiting the decompressed output size. A small compressed payload can expand to hundreds of megabytes or gigabytes, causing memory exhaustion.

  Both attack vectors result in a fatal V8 out-of-memory error (`FATAL ERROR: Reached heap limit Allocation failed - JavaScript heap out of memory`) causing the Node.js process to terminate. The zipbomb variant is particularly dangerous as it can bypass reverse proxy request size limits while still causing large memory allocation on the server.

  To be affected, an application must run with `experimental.ppr: true` or `cacheComponents: true` configured along with the NEXT_PRIVATE_MINIMAL_MODE=1 environment variable.

  Strongly consider upgrading to 15.6.0-canary.61 or 16.1.5 to reduce risk and prevent availability issues in Next applications.
impacted_packages:
  - purl: pkg:npm/next
    affected_versions: vers:npm/>=15.0.0-canary.0|<15.6.0-canary.61|>=16.0.0-beta.0|<16.1.5
    fixed_versions: vers:npm/15.6.0-canary.61|16.1.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/next/CVE-2025-59472.yml
weaknesses:
  - CWE-770
  - CWE-400
  - CWE-409
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/vercel/next.js
    reference_type:
    reference_id:
  - url: https://github.com/vercel/next.js/security/advisories/GHSA-5f7q-jpqc-wp7h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59472
    reference_type:
    reference_id:
  - url: https://vercel.com/changelog/summaries-of-cve-2025-59471-and-cve-2025-59472
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5f7q-jpqc-wp7h
    reference_type:
    reference_id: GHSA-5f7q-jpqc-wp7h
