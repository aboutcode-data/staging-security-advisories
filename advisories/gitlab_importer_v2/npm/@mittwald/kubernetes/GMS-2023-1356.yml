advisory_id: npm/@mittwald/kubernetes/GMS-2023-1356
datasource_id: gitlab_importer_v2/npm/@mittwald/kubernetes/GMS-2023-1356
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@mittwald/kubernetes/GMS-2023-1356.yml
aliases:
  - GHSA-g35x-j6jj-8g7j
  - GMS-2023-1356
summary: |
  @mittwald/kubernetes's secret contents leaked via debug logging
  When debug logging is enabled (via `DEBUG` environment variable), the Kubernetes client may log all response bodies into the debug log -- including sensitive data from `Secret` resources.

  When running in a Kubernetes cluster, this might expose sensitive information to users who are _not_ authorised to access secrets, but have access to Pod logs (either directly using kubectl, or by Pod logs being shipped elsewhere).

  Upgrade to 3.5.0 or newer.

   Workaround
  Disable debug logging entirely, or exclude the `kubernetes:client` debug item (for example, using `DEBUG=*,-kubernetes:client`).

  - https://cwe.mitre.org/data/definitions/532.html
impacted_packages:
  - purl: pkg:npm/%40mittwald/kubernetes
    affected_versions: vers:npm/<3.5.0
    fixed_versions: vers:npm/3.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/mittwald/node-kubernetes/commit/04f6809fd438417c343d541e57f76f0040e069cd
    reference_type:
    reference_id:
  - url: https://github.com/mittwald/node-kubernetes/releases/tag/v3.5.0
    reference_type:
    reference_id:
  - url: https://github.com/mittwald/node-kubernetes/security/advisories/GHSA-g35x-j6jj-8g7j
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-g35x-j6jj-8g7j
    reference_type:
    reference_id: GHSA-g35x-j6jj-8g7j
