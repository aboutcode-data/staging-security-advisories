advisory_id: npm/commandkit/CVE-2025-62378
datasource_id: gitlab_importer_v2/npm/commandkit/CVE-2025-62378
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/commandkit/CVE-2025-62378.yml
aliases:
  - CVE-2025-62378
  - GHSA-fhwm-pc6r-4h2f
summary: |
  CommandKit has incorrect command name exposure in context object for message command aliases
  A logic flaw exists in the message command handler of CommandKit that affects how the `commandName` property is exposed to both middleware functions and command execution contexts when handling command aliases. When a message command is invoked using an alias, the `ctx.commandName` value reflects the alias rather than the canonical command name. This occurs in both middleware functions and within the command’s own run function.

  Although not explicitly documented, CommandKit’s examples and guidance around middleware usage implicitly convey that `ctx.commandName` represents the canonical command identifier. Middleware examples in the documentation consistently use `ctx.commandName` to reference the command being executed, and the documentation describes middleware as suitable for “logging, authentication, permission checks, or any other cross-cutting concerns.” As a result, developers reasonably expect `ctx.commandName` to return the canonical command name and may rely on it for security-sensitive logic.

  Developers who assume `ctx.commandName` is canonical may introduce unintended behavior when relying on it for logic such as permission checks, rate limiting, or audit logging. This could allow unauthorized command execution or inaccurate access control decisions. Slash commands and context menu commands are not affected.
impacted_packages:
  - purl: pkg:npm/commandkit
    affected_versions: vers:npm/>=1.2.0-rc.1|<1.2.0-rc.12
    fixed_versions: vers:npm/1.2.0-rc.12
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/commandkit/CVE-2025-62378.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-706
references:
  - url: https://github.com/underctrl-io/commandkit
    reference_type:
    reference_id:
  - url: https://github.com/underctrl-io/commandkit/commit/440385a3e5de3fa3d2a76d23a807995cb29602fd
    reference_type:
    reference_id:
  - url: https://github.com/underctrl-io/commandkit/security/advisories/GHSA-fhwm-pc6r-4h2f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-62378
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-fhwm-pc6r-4h2f
    reference_type:
    reference_id: GHSA-fhwm-pc6r-4h2f
