advisory_id: npm/@intlify/core/CVE-2024-52809
datasource_id: gitlab_importer_v2/npm/@intlify/core/CVE-2024-52809
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@intlify/core/CVE-2024-52809.yml
aliases:
  - CVE-2024-52809
  - GHSA-9r9m-ffp6-9x4v
summary: |
  vue-i18n has cross-site scripting vulnerability with prototype pollution
  vue-i18n can be passed locale messages to `createI18n` or `useI18n`.
  we can then translate them using `t` and `$t`.
  vue-i18n has its own syntax for local messages, and uses a message compiler to generate AST.
  In order to maximize the performance of the translation function, vue-i18n uses bundler plugins such as `@intlify/unplugin-vue-i18n` and bulder to convert the AST in advance when building the application.
  By using that AST as the locale message, it is no longer necessary to compile, and it is possible to translate using the AST.

  The AST generated by the message compiler has special properties for each node in the AST tree to maximize performance. In the PoC example below, it is a `static` property, but that is just one of the optimizations.
  About details of special properties, see https://github.com/intlify/vue-i18n/blob/master/packages/message-compiler/src/nodes.ts

  In general, the locale messages of vue-i18n are optimized during production builds using `@intlify/unplugin-vue-i18n`,
  so there is always a property that is attached during optimization like this time.
  But if you are using a locale message AST in development mode or your own, there is a possibility of XSS if a third party injects.
impacted_packages:
  - purl: pkg:npm/%40intlify/core
    affected_versions: vers:npm/>=9.3.0|<9.14.2|>=10.0.0|<10.0.5
    fixed_versions: vers:npm/9.14.2|10.0.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@intlify/core/CVE-2024-52809.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/intlify/vue-i18n
    reference_type:
    reference_id:
  - url: https://github.com/intlify/vue-i18n/commit/72f0d323006fc7363b18cab62d4522dadd874411
    reference_type:
    reference_id:
  - url: https://github.com/intlify/vue-i18n/commit/9f20909ef8c9232a1072d7818e12ed6d6451024d
    reference_type:
    reference_id:
  - url: https://github.com/intlify/vue-i18n/security/advisories/GHSA-9r9m-ffp6-9x4v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-52809
    reference_type:
    reference_id: CVE-2024-52809
  - url: https://github.com/advisories/GHSA-9r9m-ffp6-9x4v
    reference_type:
    reference_id: GHSA-9r9m-ffp6-9x4v
