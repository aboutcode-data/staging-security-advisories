advisory_id: npm/diff/CVE-2026-24001
datasource_id: gitlab_importer_v2/npm/diff/CVE-2026-24001
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/diff/CVE-2026-24001.yml
aliases:
  - CVE-2026-24001
  - GHSA-73rr-hh4g-fpgx
summary: |
  jsdiff has a Denial of Service vulnerability in parsePatch and applyPatch
  Attempting to parse a patch whose filename headers contain the line break characters `\r`, `\u2028`, or `\u2029` can cause the `parsePatch` method to enter an infinite loop. It then consumes memory without limit until the process crashes due to running out of memory.

  Applications are therefore likely to be vulnerable to a denial-of-service attack if they call `parsePatch` with a user-provided patch as input. A large payload is not needed to trigger the vulnerability, so size limits on user input do not provide any protection. Furthermore, some applications may be vulnerable even when calling `parsePatch` on a patch generated by the application itself if the user is nonetheless able to control the filename headers (e.g. by directly providing the filenames of the files to be diffed).

  The `applyPatch` method is similarly affected if (and only if) called with a string representation of a patch as an argument, since under the hood it parses that string using `parsePatch`. Other methods of the library are unaffected.

  Finally, a second and lesser bug - a ReDOS - also exhibits when those same line break characters are present in a patch's *patch* header (also known as its "leading garbage"). A maliciously-crafted patch header of length *n* can take `parsePatch` O(*n*Â³) time to parse.
impacted_packages:
  - purl: pkg:npm/diff
    affected_versions: vers:npm/<3.5.1|>=4.0.0|<4.0.4|>=5.0.0|<5.2.2|>=6.0.0|<8.0.3
    fixed_versions: vers:npm/3.5.1|4.0.4|5.2.2|8.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/diff/CVE-2026-24001.yml
weaknesses:
  - CWE-1333
  - CWE-1035
  - CWE-937
  - CWE-400
references:
  - url: https://github.com/kpdecker/jsdiff
    reference_type:
    reference_id:
  - url: https://github.com/kpdecker/jsdiff/commit/15a1585230748c8ae6f8274c202e0c87309142f5
    reference_type:
    reference_id:
  - url: https://github.com/kpdecker/jsdiff/issues/653
    reference_type:
    reference_id:
  - url: https://github.com/kpdecker/jsdiff/pull/649
    reference_type:
    reference_id:
  - url: https://github.com/kpdecker/jsdiff/security/advisories/GHSA-73rr-hh4g-fpgx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-24001
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-73rr-hh4g-fpgx
    reference_type:
    reference_id: GHSA-73rr-hh4g-fpgx
