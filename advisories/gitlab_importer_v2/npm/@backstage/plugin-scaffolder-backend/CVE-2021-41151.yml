advisory_id: npm/@backstage/plugin-scaffolder-backend/CVE-2021-41151
datasource_id: gitlab_importer_v2/npm/@backstage/plugin-scaffolder-backend/CVE-2021-41151
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@backstage/plugin-scaffolder-backend/CVE-2021-41151.yml
aliases:
  - CVE-2021-41151
  - GHSA-pvv8-8fx9-h673
summary: |
  Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')
  Backstage is an open platform for building developer portals. The attack is executed by crafting a custom Scaffolder template with a `github:publish:pull-request` action and a particular source path. When the template is executed the sensitive files would be included in the published pull request. This vulnerability is mitigated by the fact that an attacker would need access to create and register templates in the Backstage catalog, and that the attack is very visible given that the exfiltration happens via a pull request. The vulnerability is patched in the `0.15.9` release of `@backstage/plugin-scaffolder-backend`.
impacted_packages:
  - purl: pkg:npm/%40backstage/plugin-scaffolder-backend
    affected_versions: vers:npm/>=0.9.4|<0.15.9
    fixed_versions: vers:npm/0.15.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@backstage/plugin-scaffolder-backend/CVE-2021-41151.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@backstage/plugin-scaffolder-backend/CVE-2021-41151.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/backstage/backstage/commit/6968962c920508eae19a4c1c200fa2c8980a4006
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/releases/tag/release-2021-10-16
    reference_type:
    reference_id:
  - url: https://github.com/backstage/backstage/security/advisories/GHSA-pvv8-8fx9-h673
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41151
    reference_type:
    reference_id: CVE-2021-41151
  - url: https://github.com/advisories/GHSA-pvv8-8fx9-h673
    reference_type:
    reference_id: GHSA-pvv8-8fx9-h673
