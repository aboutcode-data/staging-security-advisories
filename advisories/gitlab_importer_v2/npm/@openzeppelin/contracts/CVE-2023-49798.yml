advisory_id: npm/@openzeppelin/contracts/CVE-2023-49798
datasource_id: gitlab_importer_v2/npm/@openzeppelin/contracts/CVE-2023-49798
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@openzeppelin/contracts/CVE-2023-49798.yml
aliases:
  - CVE-2023-49798
  - GHSA-699g-q6qh-q4v8
summary: |
  Always-Incorrect Control Flow Implementation
  OpenZeppelin Contracts is a library for smart contract development. A merge issue when porting the 5.0.1 patch to the 4.9 branch caused a line duplication. In the version of `Multicall.sol` released in `@openzeppelin/contracts@4.9.4` and `@openzeppelin/contracts-upgradeable@4.9.4`, all subcalls are executed twice. Concretely, this exposes a user to unintentionally duplicate operations like asset transfers. The duplicated delegatecall was removed in version 4.9.5. The 4.9.4 version is marked as deprecated. Users are advised to upgrade. There are no known workarounds for this issue.
impacted_packages:
  - purl: pkg:npm/%40openzeppelin/contracts
    affected_versions: vers:npm/4.9.4
    fixed_versions: vers:npm/4.9.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@openzeppelin/contracts/CVE-2023-49798.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-670
references:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/commit/88ac712e06832bce73b41e8166cded2729e25205
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-699g-q6qh-q4v8
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/31f9fb9d171f60b2271b2b9c6f62d43302bf9489
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-49798
    reference_type:
    reference_id: CVE-2023-49798
  - url: https://github.com/advisories/GHSA-699g-q6qh-q4v8
    reference_type:
    reference_id: GHSA-699g-q6qh-q4v8
