advisory_id: npm/@openzeppelin/contracts/CVE-2022-46151
datasource_id: gitlab_importer_v2/npm/@openzeppelin/contracts/CVE-2022-46151
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@openzeppelin/contracts/CVE-2022-46151.yml
aliases:
  - CVE-2022-46151
  - GHSA-mrrw-9wf7-xq6w
summary: |
  Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  Querybook is an open source data querying UI. In affected versions user provided data is not escaped in the error field of the auth callback url in `querybook/server/app/auth/oauth_auth.py` and `querybook/server/app/auth/okta_auth.py`. This may allow attackers to perform reflected cross site scripting (XSS) if Content Security Policy (CSP) is not enabled or `unsafe-inline` is allowed. Users are advised to upgrade to the latest, patched version of querybook (version 3.14.2 or greater). Users unable to upgrade may enable CSP and not allow unsafe-inline or manually escape query parameters in a reverse proxy.
impacted_packages:
  - purl: pkg:npm/%40openzeppelin/contracts
    affected_versions: vers:npm/<3.14.2
    fixed_versions: vers:npm/4.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@openzeppelin/contracts/CVE-2022-46151.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/pinterest/querybook/commit/88a7f10495bf5ed1a556ade51a2f2794e403c063
    reference_type:
    reference_id:
  - url: https://github.com/pinterest/querybook/security/advisories/GHSA-mrrw-9wf7-xq6w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-46151
    reference_type:
    reference_id: CVE-2022-46151
