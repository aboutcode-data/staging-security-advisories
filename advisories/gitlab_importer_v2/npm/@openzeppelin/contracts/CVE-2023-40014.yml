advisory_id: npm/@openzeppelin/contracts/CVE-2023-40014
datasource_id: gitlab_importer_v2/npm/@openzeppelin/contracts/CVE-2023-40014
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@openzeppelin/contracts/CVE-2023-40014.yml
aliases:
  - CVE-2023-40014
  - GHSA-g4vp-m682-qqmp
summary: |
  Improper Encoding or Escaping of Output
  OpenZeppelin Contracts is a library for secure smart contract development. Starting in version 4.0.0 and prior to version 4.9.3, contracts using `ERC2771Context` along with a custom trusted forwarder may see `_msgSender` return `address(0)` in calls that originate from the forwarder with calldata shorter than 20 bytes. This combination of circumstances does not appear to be common, in particular it is not the case for `MinimalForwarder` from OpenZeppelin Contracts, or any deployed forwarder the team is aware of, given that the signer address is appended to all calls that originate from these forwarders. The problem has been patched in v4.9.3.
impacted_packages:
  - purl: pkg:npm/%40openzeppelin/contracts
    affected_versions: vers:npm/>=4.0.0|<4.9.3
    fixed_versions: vers:npm/4.9.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@openzeppelin/contracts/CVE-2023-40014.yml
weaknesses:
  - CWE-116
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.9.3/CHANGELOG.md
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/commit/9445f96223041abf2bf08daa56f8da50b674cbcd
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/commit/e4435eed757d4309436b1e06608e97b6d6e2fdb5
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/pull/4481
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/pull/4484
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.9.3
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-g4vp-m682-qqmp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-40014
    reference_type:
    reference_id: CVE-2023-40014
  - url: https://github.com/advisories/GHSA-g4vp-m682-qqmp
    reference_type:
    reference_id: GHSA-g4vp-m682-qqmp
