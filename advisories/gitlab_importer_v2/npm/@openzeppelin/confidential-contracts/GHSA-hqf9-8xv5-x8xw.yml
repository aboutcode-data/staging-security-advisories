advisory_id: npm/@openzeppelin/confidential-contracts/GHSA-hqf9-8xv5-x8xw
datasource_id: gitlab_importer_v2/npm/@openzeppelin/confidential-contracts/GHSA-hqf9-8xv5-x8xw
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@openzeppelin/confidential-contracts/GHSA-hqf9-8xv5-x8xw.yml
aliases:
  - GHSA-hqf9-8xv5-x8xw
summary: |
  ERC7984ERC20Wrapper: once a wrapper is filled, subsequent wrap requests do not revert and result in loss of funds.
  The `ERC7984` contract tracks total supply using a confidential `euint64` value. If a call to the internal `_mint` function would result in the total supply overflowing, the call fails silently. The `wrap` and `onTransferReceived` functions in `ERC7984ERC20Wrapper` assume that `_mint` won't fail silently and do not check the return value. If the mint function fails silently, users do not receive the confidential wrapped token but still send the underlying token, resulting in a loss of funds.

  By default (without overriding `rate()`, the wrapper fills up after wrapping ~18.4 trillion tokens. There are very few tokens of value with sufficient total supply to result in the filling of the wrapper. That said, we recommend upgrading to `0.3.1` to remove this issue.
impacted_packages:
  - purl: pkg:npm/%40openzeppelin/confidential-contracts
    affected_versions: vers:npm/<0.3.1
    fixed_versions: vers:npm/0.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@openzeppelin/confidential-contracts/GHSA-hqf9-8xv5-x8xw.yml
weaknesses:
  - CWE-190
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/OpenZeppelin/openzeppelin-confidential-contracts
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-confidential-contracts/security/advisories/GHSA-hqf9-8xv5-x8xw
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-hqf9-8xv5-x8xw
    reference_type:
    reference_id: GHSA-hqf9-8xv5-x8xw
