advisory_id: npm/signalk-server/CVE-2025-68620
datasource_id: gitlab_importer_v2/npm/signalk-server/CVE-2025-68620
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/signalk-server/CVE-2025-68620.yml
aliases:
  - CVE-2025-68620
  - GHSA-fq56-hvg6-wvm5
summary: |
  Signal K Server vulnerable to JWT Token Theft via WebSocket Enumeration and Unauthenticated Polling
  SignalK Server exposes two features that can be chained together to steal JWT authentication tokens without any prior authentication. The attack combines WebSocket-based request enumeration with unauthenticated polling of access request status.

  **Unauthenticated WebSocket Request Enumeration**: When a WebSocket client connects to the SignalK stream endpoint with the `serverevents=all` query parameter, the server sends all cached server events including `ACCESS_REQUEST` events that contain details about pending access requests. The `startServerEvents` function iterates over `app.lastServerEvents` and writes each cached event to any connected client without verifying authorization level. Since WebSocket connections are allowed for readonly users (which includes unauthenticated users when `allow_readonly` is true), attackers receive these events containing request IDs, client identifiers, descriptions, requested permissions, and IP addresses.

  **Unauthenticated Token Polling**: The access request status endpoint at `/signalk/v1/access/requests/:id` returns the full state of an access request without requiring authentication. When an administrator approves a request, the response includes the issued JWT token in plaintext. The `queryRequest` function returns the complete request object including the token field, and the REST endpoint uses readonly authentication, allowing unauthenticated access.

  An attacker has two paths to exploit these vulnerabilities:

  1. The attacker creates their own access request (using the IP spoofing vulnerability to craft a convincing spoofed request), then polls their own request ID until an administrator approves it, receiving the JWT token.

  2. The attacker passively monitors the WebSocket stream to discover request IDs from legitimate devices, then polls those IDs and steals the JWT tokens when administrators approve them, hijacking legitimate device credentials.

  Both paths require zero authentication and enable complete authentication bypass.
impacted_packages:
  - purl: pkg:npm/signalk-server
    affected_versions: vers:npm/<2.19.0
    fixed_versions: vers:npm/2.19.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/signalk-server/CVE-2025-68620.yml
weaknesses:
  - CWE-288
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/SignalK/signalk-server
    reference_type:
    reference_id:
  - url: https://github.com/SignalK/signalk-server/commit/221aff6cd89c56308084d1781b3abbf938605bd3
    reference_type:
    reference_id:
  - url: https://github.com/SignalK/signalk-server/releases/tag/v2.19.0
    reference_type:
    reference_id:
  - url: https://github.com/SignalK/signalk-server/security/advisories/GHSA-fq56-hvg6-wvm5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68620
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-fq56-hvg6-wvm5
    reference_type:
    reference_id: GHSA-fq56-hvg6-wvm5
