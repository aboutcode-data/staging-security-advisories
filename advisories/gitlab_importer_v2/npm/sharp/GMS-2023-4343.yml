advisory_id: npm/sharp/GMS-2023-4343
datasource_id: gitlab_importer_v2/npm/sharp/GMS-2023-4343
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/sharp/GMS-2023-4343.yml
aliases:
  - GHSA-54xq-cgqr-rpm3
  - GMS-2023-4343
summary: |
  sharp vulnerability in libwebp dependency CVE-2023-4863
  ## Overview

  sharp uses libwebp to decode WebP images and versions prior to the latest 0.32.6 is vulnerable to the high severity https://github.com/advisories/GHSA-j7hp-h8jx-5ppr.

  ## Who does this affect?

  Almost anyone processing untrusted input with versions of sharp prior to 0.32.6.

  ## How to resolve this?

  ### Using prebuilt binaries provided by sharp?

  Most people rely on the prebuilt binaries provided by sharp.

  Please upgrade sharp to the latest 0.32.6, which provides libwebp 1.3.2.

  ### Using a globally-installed libvips?

  Please ensure you are using the latest libwebp 1.3.2.

  ## Possible workaround

  Add the following to your code to prevent sharp from decoding WebP images.
  ```js
  sharp.block({ operation: ["VipsForeignLoadWebp"] });
  ```
impacted_packages:
  - purl: pkg:npm/sharp
    affected_versions: vers:npm/<0.32.6
    fixed_versions: vers:npm/0.32.6
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/lovell/sharp/commit/dbce6fab795ca4250bda9b1ef502c1fdb7d4a30c
    reference_type:
    reference_id:
  - url: https://github.com/lovell/sharp/security/advisories/GHSA-54xq-cgqr-rpm3
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-54xq-cgqr-rpm3
    reference_type:
    reference_id: GHSA-54xq-cgqr-rpm3
