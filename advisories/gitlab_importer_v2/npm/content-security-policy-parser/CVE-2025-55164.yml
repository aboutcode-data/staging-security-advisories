advisory_id: npm/content-security-policy-parser/CVE-2025-55164
datasource_id: gitlab_importer_v2/npm/content-security-policy-parser/CVE-2025-55164
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/content-security-policy-parser/CVE-2025-55164.yml
aliases:
  - CVE-2025-55164
  - GHSA-w2cq-g8g3-gm83
summary: |
  content-security-policy-parser Prototype Pollution Vulnerability May Lead to RCE
  A prototype pollution vulnerability exists in versions 0.5.0 and earlier, wherein if you provide a policy name called `__proto__` you can override the Object prototype.

  For example:

  ```
  const parse = require('content-security-policy-parser');

  const x = parse("default-src 'self'; __proto__ foobar");
  console.log('raw print:', x);
  console.log('toString:', x.toString());
  ```

  Outputs:

  ```
  raw print: Array { 'default-src': [ "'self'" ] }
  toString: foobar
  ```

  Whilst no gadget exists in this library, it is possible via other libraries expose functionality that enable RCE. It is customary to label prototype pollution vulnerabilities in this way. The most common effect of this is denial of service, as you can trivially overwrite properties.

  As the content security policy is provided in HTTP queries, it is incredibly likely that network exploitation is possible.
impacted_packages:
  - purl: pkg:npm/content-security-policy-parser
    affected_versions: vers:npm/<0.6.0
    fixed_versions: vers:npm/0.6.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/content-security-policy-parser/CVE-2025-55164.yml
weaknesses:
  - CWE-1321
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/helmetjs/content-security-policy-parser
    reference_type:
    reference_id:
  - url: https://github.com/helmetjs/content-security-policy-parser/commit/b13a52554f0168af393e3e38ed4a94e9e6aea9dc
    reference_type:
    reference_id:
  - url: https://github.com/helmetjs/content-security-policy-parser/issues/11
    reference_type:
    reference_id:
  - url: https://github.com/helmetjs/content-security-policy-parser/security/advisories/GHSA-w2cq-g8g3-gm83
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-55164
    reference_type:
    reference_id: CVE-2025-55164
  - url: https://github.com/advisories/GHSA-w2cq-g8g3-gm83
    reference_type:
    reference_id: GHSA-w2cq-g8g3-gm83
