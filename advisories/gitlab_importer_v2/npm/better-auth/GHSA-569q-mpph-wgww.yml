advisory_id: npm/better-auth/GHSA-569q-mpph-wgww
datasource_id: gitlab_importer_v2/npm/better-auth/GHSA-569q-mpph-wgww
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/better-auth/GHSA-569q-mpph-wgww.yml
aliases:
  - GHSA-569q-mpph-wgww
summary: |
  Better Auth affected by external request basePath modification DoS
  Affected versions of Better Auth allow an external request to configure `baseURL` when it isn’t defined through any other means. This can be abused to poison the router’s base path, causing all routes to return 404 for all users.

  This issue is only exploitable when `baseURL` is not explicitly configured (e.g., `BETTER_AUTH_URL` is missing) *and* the attacker is able to make the very first request to the server after startup. In properly configured environments or typical managed hosting platforms, this fallback behavior cannot be reached.
impacted_packages:
  - purl: pkg:npm/better-auth
    affected_versions: vers:npm/<1.4.2
    fixed_versions: vers:npm/1.4.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/better-auth/GHSA-569q-mpph-wgww.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-73
references:
  - url: https://github.com/better-auth/better-auth
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/releases/tag/v1.4.2
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/security/advisories/GHSA-569q-mpph-wgww
    reference_type:
    reference_id:
  - url: https://github.com/ray-project/ray/commit/70e7c72780bdec075dba6cad1afe0832772bfe09
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-569q-mpph-wgww
    reference_type:
    reference_id: GHSA-569q-mpph-wgww
