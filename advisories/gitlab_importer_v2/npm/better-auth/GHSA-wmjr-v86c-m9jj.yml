advisory_id: npm/better-auth/GHSA-wmjr-v86c-m9jj
datasource_id: gitlab_importer_v2/npm/better-auth/GHSA-wmjr-v86c-m9jj
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/better-auth/GHSA-wmjr-v86c-m9jj.yml
aliases:
  - GHSA-wmjr-v86c-m9jj
summary: |
  Better Auth's multi-session sign-out hook allows forged cookies to revoke arbitrary sessions
  A vulnerability was identified in the multi-session plugin for Better Auth, specifically in the /sign-out after-hook. The hook trusts raw multi-session cookies and forwards the extracted values directly to internalAdapter.deleteSessions without verifying the cookie signature. Because cookie values are not validated with getSignedCookie (or any equivalent check), an attacker can supply a forged _multi-* cookie to trigger deletion of arbitrary session tokens.
impacted_packages:
  - purl: pkg:npm/better-auth
    affected_versions: vers:npm/>=1.3.34|<1.4.0
    fixed_versions: vers:npm/1.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/better-auth/GHSA-wmjr-v86c-m9jj.yml
weaknesses:
  - CWE-345
  - CWE-1035
  - CWE-937
  - CWE-287
references:
  - url: https://github.com/better-auth/better-auth
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/commit/cfc453a2a6eb02951f9a0a7c944064936e73eee8
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/releases/tag/v1.4.0
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/security/advisories/GHSA-wmjr-v86c-m9jj
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-wmjr-v86c-m9jj
    reference_type:
    reference_id: GHSA-wmjr-v86c-m9jj
