advisory_id: npm/url-parse/CVE-2022-0639
datasource_id: gitlab_importer_v2/npm/url-parse/CVE-2022-0639
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/url-parse/CVE-2022-0639.yml
aliases:
  - CVE-2022-0639
  - GHSA-8v38-pw62-9cw2
summary: |
  url-parse Incorrectly parses URLs that include an '@'
  A specially crafted URL with an '@' sign but empty user info and no hostname, when parsed with url-parse, url-parse will return the incorrect href. In particular,

  ```js
  parse(\"http://@/127.0.0.1\")
  ```
  Will return:
  ```yaml
  {
  slashes: true,
  protocol: 'http:',
  hash: '',
  query: '',
  pathname: '/127.0.0.1',
  auth: '',
  host: '',
  port: '',
  hostname: '',
  password: '',
  username: '',
  origin: 'null',
  href: 'http:///127.0.0.1'
  }
  ```
  If the 'hostname' or 'origin' attributes of the output from url-parse are used in security decisions and the final 'href' attribute of the output is then used to make a request, the decision may be incorrect.
impacted_packages:
  - purl: pkg:npm/url-parse
    affected_versions: vers:npm/>=1.0.0|<1.5.7
    fixed_versions: vers:npm/1.5.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/url-parse/CVE-2022-0639.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/url-parse/CVE-2022-0639.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-639
references:
  - url: https://github.com/unshiftio/url-parse
    reference_type:
    reference_id:
  - url: https://github.com/unshiftio/url-parse/commit/ef45a1355375a8244063793a19059b4f62fc8788
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/83a6bc9a-b542-4a38-82cd-d995a1481155
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/02/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/12/msg00024.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-0639
    reference_type:
    reference_id: CVE-2022-0639
  - url: https://github.com/advisories/GHSA-8v38-pw62-9cw2
    reference_type:
    reference_id: GHSA-8v38-pw62-9cw2
