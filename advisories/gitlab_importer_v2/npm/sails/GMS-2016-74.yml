advisory_id: npm/sails/GMS-2016-74
datasource_id: gitlab_importer_v2/npm/sails/GMS-2016-74
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/sails/GMS-2016-74.yml
aliases:
  - GMS-2016-74
summary: |
  Broken CORS
  Sails has an issue with the CORS configuration where the value of the origin header is reflected as the value for the Access-Control-Allow-Origin header. This would allow an attacker to make AJAX requests to vulnerable hosts through cross site scripting or a malicious HTML Document, effectively bypassing the Same Origin Policy. Note that this is only an issue when `allRoutes` is set to `true` and `origin` is set to `*` or left commented out in the sails CORS config file. The problem can be compounded when the cors `credentials` setting is not provided. At that point authenticated cross domain requests are possible.
impacted_packages:
  - purl: pkg:npm/sails
    affected_versions: vers:npm/<0.12.7
    fixed_versions: vers:npm/0.12.7
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: http://sailsjs.org/documentation/concepts/security/cors
    reference_type:
    reference_id:
  - url: http://sailsjs.org/documentation/reference/configuration/sails-config-cors
    reference_type:
    reference_id:
  - url: https://github.com/balderdashy/sails/commit/ca43e0507af79f15361789a3489013b01c8e1825
    reference_type:
    reference_id:
