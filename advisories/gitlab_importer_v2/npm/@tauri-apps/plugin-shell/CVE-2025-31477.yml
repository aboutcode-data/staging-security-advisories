advisory_id: npm/@tauri-apps/plugin-shell/CVE-2025-31477
datasource_id: gitlab_importer_v2/npm/@tauri-apps/plugin-shell/CVE-2025-31477
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@tauri-apps/plugin-shell/CVE-2025-31477.yml
aliases:
  - CVE-2025-31477
  - GHSA-c9pr-q8gx-3mgp
summary: |
  Improper Scope Validation in the `open` Endpoint of `tauri-plugin-shell`
  The Tauri [`shell`](https://tauri.app/plugin/shell/)  plugin exposes functionality to execute code and open programs on the system. The [`open`](https://tauri.app/reference/javascript/shell/#open) endpoint of this plugin is designed to allow open functionality with the system opener (e.g.
  `xdg-open` on Linux). This was meant to be restricted to a reasonable number of protocols like `https` or `mailto` by default.

  This default restriction was not functional due to improper validation of the allowed protocols, allowing for potentially dangerous protocols like `file://`, `smb://`, or `nfs://` and others  to be opened by the system registered protocol handler.

  By passing untrusted user input to the `open` endpoint these potentially dangerous protocols can be abused to gain remote code execution on the system. This either requires direct exposure of the endpoint to application users or code execution in the frontend of a Tauri application.

  You are not affected if you have explicitly configured a validation regex or manually set the `open` endpoint to `true` in the plugin configuration.

  Technically the scope was never a limitation for the rust side as it is not seen as an enforceable security boundary but we decided to mark the rust crate as affected since the plugin does not need to be a frontend dependency to be exposed.
impacted_packages:
  - purl: pkg:npm/%40tauri-apps/plugin-shell
    affected_versions: vers:npm/<2.2.1
    fixed_versions: vers:npm/2.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@tauri-apps/plugin-shell/CVE-2025-31477.yml
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/tauri-apps/plugins-workspace
    reference_type:
    reference_id:
  - url: https://github.com/tauri-apps/plugins-workspace/commit/9cf0390a52497e273db1a1b613a0e26827aa327c
    reference_type:
    reference_id:
  - url: https://github.com/tauri-apps/plugins-workspace/security/advisories/GHSA-c9pr-q8gx-3mgp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-31477
    reference_type:
    reference_id: CVE-2025-31477
  - url: https://github.com/advisories/GHSA-c9pr-q8gx-3mgp
    reference_type:
    reference_id: GHSA-c9pr-q8gx-3mgp
