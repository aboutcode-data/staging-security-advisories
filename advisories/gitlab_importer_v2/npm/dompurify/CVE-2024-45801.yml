advisory_id: npm/dompurify/CVE-2024-45801
datasource_id: gitlab_importer_v2/npm/dompurify/CVE-2024-45801
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/dompurify/CVE-2024-45801.yml
aliases:
  - CVE-2024-45801
  - GHSA-mmhx-hmjr-r674
summary: |
  DOMPurify allows tampering by prototype pollution
  It has been discovered that malicious HTML using special nesting techniques can bypass the depth checking added to DOMPurify in recent releases. It was also possible to use Prototype Pollution to weaken the depth check.

  This renders dompurify unable to avoid XSS attack.

  Fixed by https://github.com/cure53/DOMPurify/commit/1e520262bf4c66b5efda49e2316d6d1246ca7b21 (3.x branch) and https://github.com/cure53/DOMPurify/commit/26e1d69ca7f769f5c558619d644d90dd8bf26ebc (2.x branch).
impacted_packages:
  - purl: pkg:npm/dompurify
    affected_versions: vers:npm/<2.5.4|>=3.0.0|<3.1.3
    fixed_versions: vers:npm/2.5.4|3.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/dompurify/CVE-2024-45801.yml
weaknesses:
  - CWE-1333
  - CWE-1321
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/cure53/DOMPurify
    reference_type:
    reference_id:
  - url: https://github.com/cure53/DOMPurify/commit/1e520262bf4c66b5efda49e2316d6d1246ca7b21
    reference_type:
    reference_id:
  - url: https://github.com/cure53/DOMPurify/commit/26e1d69ca7f769f5c558619d644d90dd8bf26ebc
    reference_type:
    reference_id:
  - url: https://github.com/cure53/DOMPurify/security/advisories/GHSA-mmhx-hmjr-r674
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45801
    reference_type:
    reference_id: CVE-2024-45801
  - url: https://github.com/advisories/GHSA-mmhx-hmjr-r674
    reference_type:
    reference_id: GHSA-mmhx-hmjr-r674
