advisory_id: npm/taylored/GHSA-vh5j-5fhq-9xwg
datasource_id: gitlab_importer_v2/npm/taylored/GHSA-vh5j-5fhq-9xwg
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/taylored/GHSA-vh5j-5fhq-9xwg.yml
aliases:
  - GHSA-vh5j-5fhq-9xwg
summary: |
  Taylor has race condition in /get-patch that allows purchase token replay
  The /get-patch endpoint processes a purchase in two separate database queries: a SELECT that verifies the token is unused, followed by an UPDATE that marks the token as used. Because SQLite only guards each statement, a malicious actor can issue two requests at the exact same moment and have both SELECT statements succeed before either UPDATE runs.
impacted_packages:
  - purl: pkg:npm/taylored
    affected_versions: vers:npm/<8.1.3
    fixed_versions: vers:npm/8.1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-362
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/tailot/taylored
    reference_type:
    reference_id:
  - url: https://github.com/tailot/taylored/commit/fdf67a6fba0deae30912905a79fb5a9e83751a79
    reference_type:
    reference_id:
  - url: https://github.com/tailot/taylored/security/advisories/GHSA-vh5j-5fhq-9xwg
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-vh5j-5fhq-9xwg
    reference_type:
    reference_id: GHSA-vh5j-5fhq-9xwg
