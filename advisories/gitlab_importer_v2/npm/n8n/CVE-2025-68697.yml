advisory_id: npm/n8n/CVE-2025-68697
datasource_id: gitlab_importer_v2/npm/n8n/CVE-2025-68697
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/n8n/CVE-2025-68697.yml
aliases:
  - CVE-2025-68697
  - GHSA-j4p8-h8mh-rh8q
summary: |
  Self-hosted n8n has Legacy Code node that enables arbitrary file read/write
  In self-hosted n8n instances where the Code node runs in legacy (non-task-runner) JavaScript execution mode, authenticated users with workflow editing access can invoke internal helper functions from within the Code node.

  This allows a workflow editor to perform actions on the n8n host with the same privileges as the n8n process, including:

  - Reading files from the host filesystem (subject to any file-access restrictions configured on the instance and OS/container permissions)
  - Writing files to the host filesystem (subject to the same restrictions)

  Starting with n8n version 1.2.1, access to files in the n8n home directory (`.n8n`) is blocked by default. However, this does not restrict access to other parts of the filesystem unless additional file access limitations are configured.
impacted_packages:
  - purl: pkg:npm/n8n
    affected_versions: vers:npm/>=1.2.1|<2.0.0
    fixed_versions: vers:npm/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/n8n/CVE-2025-68697.yml
weaknesses:
  - CWE-269
  - CWE-1035
  - CWE-937
  - CWE-749
references:
  - url: https://github.com/n8n-io/n8n
    reference_type:
    reference_id:
  - url: https://github.com/n8n-io/n8n/security/advisories/GHSA-j4p8-h8mh-rh8q
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68697
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-j4p8-h8mh-rh8q
    reference_type:
    reference_id: GHSA-j4p8-h8mh-rh8q
