advisory_id: npm/directus/CVE-2023-27474
datasource_id: gitlab_importer_v2/npm/directus/CVE-2023-27474
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/directus/CVE-2023-27474.yml
aliases:
  - CVE-2023-27474
  - GHSA-4hmq-ggrm-qfc6
summary: |
  Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  Directus is a real-time API and App dashboard for managing SQL database content. Instances relying on an allow-listed reset URL is vulnerable to an HTML injection attack through the use of query parameters in the reset URL. An attacker could exploit this to email users urls to the servers domain but which may contain malicious code. The problem has been resolved and released under version 9.23.0. People relying on a custom password reset URL should upgrade to 9.23.0 or later, or remove the custom reset url from the configured allow list. Users are advised to upgrade. Users unable to upgrade may disable the custom reset URL allow list as a workaround.
impacted_packages:
  - purl: pkg:npm/directus
    affected_versions: vers:npm/<9.23.0
    fixed_versions: vers:npm/9.23.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/directus/CVE-2023-27474.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/directus/directus/issues/17119
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/pull/17120
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-4hmq-ggrm-qfc6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-27474
    reference_type:
    reference_id: CVE-2023-27474
  - url: https://github.com/advisories/GHSA-4hmq-ggrm-qfc6
    reference_type:
    reference_id: GHSA-4hmq-ggrm-qfc6
