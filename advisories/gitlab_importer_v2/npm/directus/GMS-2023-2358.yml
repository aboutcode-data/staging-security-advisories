advisory_id: npm/directus/GMS-2023-2358
datasource_id: gitlab_importer_v2/npm/directus/GMS-2023-2358
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/directus/GMS-2023-2358.yml
aliases:
  - GHSA-22rr-f3p8-5gf8
  - GMS-2023-2358
summary: |
  Directus affected by VM2 sandbox escape vulnerability
  ### Impact
  In vm2 for versions up to 3.9.19, Promise handler sanitization can be bypassed, allowing attackers to escape the sandbox and run arbitrary code. Within Directus this applies to the "Run Script" operation in flows being able to escape the sandbox running code in the main nodejs context.

  ### Patches
  Patched in v10.6.0 by replacing `vm2` with `isolated-vm`

  ### Workarounds
  None

  ### References
  https://github.com/patriksimek/vm2/security/advisories/GHSA-cchq-frgv-rjh5
impacted_packages:
  - purl: pkg:npm/directus
    affected_versions: vers:npm/<10.6.0
    fixed_versions: vers:npm/10.6.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/directus/directus/commit/284156426fa94f688e8d65a7a4f34f9e6705f058
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/pull/19332
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-22rr-f3p8-5gf8
    reference_type:
    reference_id:
  - url: https://github.com/patriksimek/vm2/security/advisories/GHSA-cchq-frgv-rjh5
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-22rr-f3p8-5gf8
    reference_type:
    reference_id: GHSA-22rr-f3p8-5gf8
