advisory_id: npm/json-web-token/CVE-2023-48238
datasource_id: gitlab_importer_v2/npm/json-web-token/CVE-2023-48238
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/json-web-token/CVE-2023-48238.yml
aliases:
  - CVE-2023-48238
  - GHSA-4xw9-cx39-r355
summary: joaquimserafim/json-web-token is a javascript library use to interact with JSON Web
  Tokens (JWT) which are a compact URL-safe means of representing claims to be transferred between
  two parties. Affected versions of the json-web-token library is vulnerable to a JWT algorithm
  confusion attack. On line 86 of the 'index.js' file, the algorithm to use for verifying the
  signature of the JWT token is taken from the JWT token, which at that point is still unverified
  and thus shouldn't be trusted. To exploit this vulnerability, an attacker needs to craft a
  malicious JWT token containing the HS256 algorithm, signed with the public RSA key of the
  victim application. This attack will only work against this library is the RS256 algorithm
  is in use, however it is a best practice to use that algorithm.
impacted_packages:
  - purl: pkg:npm/json-web-token
    affected_versions: vers:npm/<3.1.1
    fixed_versions: vers:npm/3.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/json-web-token/CVE-2023-48238.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-345
references:
  - url: https://github.com/joaquimserafim/json-web-token/blob/acf6a462471e1b14187eb77414e9161b8b7bff7e/index.js#L86
    reference_type:
    reference_id:
  - url: https://github.com/joaquimserafim/json-web-token/security/advisories/GHSA-4xw9-cx39-r355
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-4xw9-cx39-r355
    reference_type:
    reference_id: GHSA-4xw9-cx39-r355
