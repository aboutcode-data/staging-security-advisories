advisory_id: npm/trix/CVE-2024-34341
datasource_id: gitlab_importer_v2/npm/trix/CVE-2024-34341
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/trix/CVE-2024-34341.yml
aliases:
  - CVE-2024-34341
  - GHSA-qjqp-xr96-cj99
summary: |
  Trix Editor Arbitrary Code Execution Vulnerability
  The Trix editor, versions prior to 2.1.1, is vulnerable to arbitrary code execution when copying and pasting content from the web or other documents with markup into the editor. The vulnerability stems from improper sanitization of pasted content, allowing an attacker to embed malicious scripts which are executed within the context of the application.

  **Vulnerable Versions**: Up to 2.1.0

  **Fixed Version**: 2.1.1

  **Vector**:

  - **Bug 1**: When copying content manipulated by a script, such as:

  ```js
  document.addEventListener('copy', function(e){
  e.clipboardData.setData('text/html', '<div><noscript><div class="123</noscript>456<img src=1 onerror=alert(1)//"></div></noscript></div>');
  e.preventDefault();
  });
  ```

  and pasting into the Trix editor, the script within the content is executed.

  - **Bug 2**: Similar execution occurs with content structured as:
impacted_packages:
  - purl: pkg:npm/trix
    affected_versions: vers:npm/<2.1.1
    fixed_versions: vers:npm/2.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/trix/CVE-2024-34341.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/advisories/GHSA-qjqp-xr96-cj99
    reference_type:
    reference_id:
  - url: https://github.com/basecamp/trix
    reference_type:
    reference_id:
  - url: https://github.com/basecamp/trix/commit/1a5c68a14d48421fc368e30026f4a7918028b7ad
    reference_type:
    reference_id:
  - url: https://github.com/basecamp/trix/commit/841ff19b53f349915100bca8fcb488214ff93554
    reference_type:
    reference_id:
  - url: https://github.com/basecamp/trix/pull/1147
    reference_type:
    reference_id:
  - url: https://github.com/basecamp/trix/pull/1149
    reference_type:
    reference_id:
  - url: https://github.com/basecamp/trix/releases/tag/v2.1.1
    reference_type:
    reference_id:
  - url: https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-34341
    reference_type:
    reference_id: CVE-2024-34341
