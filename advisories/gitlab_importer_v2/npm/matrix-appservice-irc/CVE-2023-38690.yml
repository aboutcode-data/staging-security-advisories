advisory_id: npm/matrix-appservice-irc/CVE-2023-38690
datasource_id: gitlab_importer_v2/npm/matrix-appservice-irc/CVE-2023-38690
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/matrix-appservice-irc/CVE-2023-38690.yml
aliases:
  - CVE-2023-38690
  - GHSA-3pmj-jqqp-2mj3
summary: |
  Improper Neutralization of Special Elements used in a Command ('Command Injection')
  matrix-appservice-irc is a Node.js IRC bridge for Matrix. Prior to version 1.0.1, it is possible to craft a command with newlines which would not be properly parsed. This would mean you could pass a string of commands as a channel name, which would then be run by the IRC bridge bot. Versions 1.0.1 and above are patched. There are no robust workarounds to the bug. One may disable dynamic channels in the config to disable the most common execution method but others may exist.
impacted_packages:
  - purl: pkg:npm/matrix-appservice-irc
    affected_versions: vers:npm/<=1.0.0
    fixed_versions: vers:npm/1.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/matrix-appservice-irc/CVE-2023-38690.yml
weaknesses:
  - CWE-77
  - CWE-20
  - CWE-78
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/matrix-org/matrix-appservice-irc/commit/0afb064635d37e039067b5b3d6423448b93026d3
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/releases/tag/1.0.1
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-3pmj-jqqp-2mj3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38690
    reference_type:
    reference_id: CVE-2023-38690
  - url: https://github.com/advisories/GHSA-3pmj-jqqp-2mj3
    reference_type:
    reference_id: GHSA-3pmj-jqqp-2mj3
