advisory_id: npm/matrix-appservice-irc/CVE-2024-39691
datasource_id: gitlab_importer_v2/npm/matrix-appservice-irc/CVE-2024-39691
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/matrix-appservice-irc/CVE-2024-39691.yml
aliases:
  - CVE-2024-39691
  - GHSA-w9mh-5x8j-9754
summary: |
  Malicious Matrix homeserver can leak truncated message content of messages it shouldn't have access to
  The fix for GHSA-wm4w-7h2q-3pf7 / [CVE-2024-32000](https://www.cve.org/CVERecord?id=CVE-2024-32000) included in matrix-appservice-irc 2.0.0 relied on the Matrix homeserver-provided timestamp to determine whether a user has access to the event they're replying to when determining whether or not to include a truncated version of the original event in the IRC message. Since this value is controlled by external entities, a malicious Matrix homeserver joined to a room in which a matrix-appservice-irc bridge instance (before version 2.0.1) is present can fabricate the timestamp with the intent of tricking the bridge into leaking room messages the homeserver should not have access to.
impacted_packages:
  - purl: pkg:npm/matrix-appservice-irc
    affected_versions: vers:npm/<2.0.1
    fixed_versions: vers:npm/2.0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/matrix-appservice-irc/CVE-2024-39691.yml
weaknesses:
  - CWE-280
  - CWE-755
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/matrix-org/matrix-appservice-irc
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/commit/1835e047f269001054be4c68867797aa12372a0f
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/pull/1804
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-w9mh-5x8j-9754
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-39691
    reference_type:
    reference_id: CVE-2024-39691
  - url: https://github.com/advisories/GHSA-w9mh-5x8j-9754
    reference_type:
    reference_id: GHSA-w9mh-5x8j-9754
