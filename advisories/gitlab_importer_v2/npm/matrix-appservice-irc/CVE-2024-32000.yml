advisory_id: npm/matrix-appservice-irc/CVE-2024-32000
datasource_id: gitlab_importer_v2/npm/matrix-appservice-irc/CVE-2024-32000
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/matrix-appservice-irc/CVE-2024-32000.yml
aliases:
  - CVE-2024-32000
  - GHSA-wm4w-7h2q-3pf7
summary: |
  Matrix IRC Bridge truncated content of messages can be leaked
  The matrix-appservice-irc before version 2.0.0 can be exploited to leak the truncated body of a message if a malicious user sends a Matrix reply to an event ID they don't have access to. As a precondition to the attack, the malicious user needs to know the event ID of the message they want to leak, as well as to be joined to both the Matrix room and the IRC channel it is bridged to.

  The message reply containing the leaked message content is visible to IRC channel members when this happens.
impacted_packages:
  - purl: pkg:npm/matrix-appservice-irc
    affected_versions: vers:npm/<2.0.0
    fixed_versions: vers:npm/2.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/matrix-appservice-irc/CVE-2024-32000.yml
weaknesses:
  - CWE-280
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/matrix-org/matrix-appservice-irc
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/commit/4af7d3009f10b1f2fb810784c1e491d9d3bee82b
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/pull/1799
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-wm4w-7h2q-3pf7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32000
    reference_type:
    reference_id: CVE-2024-32000
  - url: https://github.com/advisories/GHSA-wm4w-7h2q-3pf7
    reference_type:
    reference_id: GHSA-wm4w-7h2q-3pf7
