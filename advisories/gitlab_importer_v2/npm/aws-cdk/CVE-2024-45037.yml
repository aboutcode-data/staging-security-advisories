advisory_id: npm/aws-cdk/CVE-2024-45037
datasource_id: gitlab_importer_v2/npm/aws-cdk/CVE-2024-45037
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/aws-cdk/CVE-2024-45037.yml
aliases:
  - CVE-2024-45037
  - GHSA-qj85-69xf-2vxq
summary: |
  AWS CDK RestApi not generating authorizationScope correctly in resultant CFN template
  The AWS Cloud Development Kit (CDK) is an open-source framework for defining cloud infrastructure using code. Customers use it to create their own applications which are converted to AWS CloudFormation templates during deployment to a customerâ€™s AWS account. CDK contains pre-built components called "constructs" that are higher-level abstractions providing defaults and best practices. This approach enables developers to use familiar programming languages to define complex cloud infrastructure more efficiently than writing raw CloudFormation templates.

  We identified an issue in AWS Cloud Development Kit (CDK) which, under certain conditions, can result in granting authenticated Amazon Cognito users broader than intended access. Specifically, if a CDK application uses the "RestApi" construct with "CognitoUserPoolAuthorizer" as the authorizer and uses authorization scopes to limit access. This issue does not affect the availability of the specific API resources.
impacted_packages:
  - purl: pkg:npm/aws-cdk
    affected_versions: vers:npm/>=2.142.0|<2.148.1
    fixed_versions: vers:npm/2.148.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/aws-cdk/CVE-2024-45037.yml
weaknesses:
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/aws/aws-cdk
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/commit/4bee768f07e73ab5fe466f9ad3d1845456a0513b
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/releases/tag/v2.148.1
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/security/advisories/GHSA-qj85-69xf-2vxq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45037
    reference_type:
    reference_id: CVE-2024-45037
  - url: https://github.com/advisories/GHSA-qj85-69xf-2vxq
    reference_type:
    reference_id: GHSA-qj85-69xf-2vxq
