advisory_id: npm/agnai/CVE-2024-47169
datasource_id: gitlab_importer_v2/npm/agnai/CVE-2024-47169
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/agnai/CVE-2024-47169.yml
aliases:
  - CVE-2024-47169
  - GHSA-mpch-89gm-hm83
summary: |
  Agnai vulnerable to Remote Code Execution via JS Upload using Directory Traversal
  A vulnerability has been discovered in **Agnai** that permits attackers to upload arbitrary files to attacker-chosen locations on the server, including JavaScript, enabling the execution of commands within those files. This issue could result in unauthorized access, full server compromise, data leakage, and other critical security threats.

  This **does not** affect:
  - `agnai.chat`
  - installations using S3-compatible storage
  - self-hosting that is not publicly exposed

  This **DOES** affect:
  - publicly hosted installs without S3-compatible storage
impacted_packages:
  - purl: pkg:npm/agnai
    affected_versions: vers:npm/<1.0.330
    fixed_versions: vers:npm/1.0.330
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/agnai/CVE-2024-47169.yml
weaknesses:
  - CWE-434
  - CWE-22
  - CWE-35
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/agnaistic/agnai
    reference_type:
    reference_id:
  - url: https://github.com/agnaistic/agnai/security/advisories/GHSA-mpch-89gm-hm83
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47169
    reference_type:
    reference_id: CVE-2024-47169
  - url: https://github.com/advisories/GHSA-mpch-89gm-hm83
    reference_type:
    reference_id: GHSA-mpch-89gm-hm83
