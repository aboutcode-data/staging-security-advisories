advisory_id: npm/agnai/CVE-2024-47171
datasource_id: gitlab_importer_v2/npm/agnai/CVE-2024-47171
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/agnai/CVE-2024-47171.yml
aliases:
  - CVE-2024-47171
  - GHSA-g54f-66mw-hv66
summary: |
  Agnai vulnerable to Relative Path Traversal in Image Upload
  A vulnerability has been discovered in **Agnai** that permits attackers to upload image files at attacker-chosen location on the server. This issue can lead to image file uploads to unauthorized or unintended directories, including overwriting of existing images which may be used for defacement.

  This does not affect:

  - agnai.chat
  - installations using S3-compatible storage
  - self-hosting that is not publicly exposed
impacted_packages:
  - purl: pkg:npm/agnai
    affected_versions: vers:npm/<1.0.330
    fixed_versions: vers:npm/1.0.330
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/agnai/CVE-2024-47171.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
  - CWE-35
references:
  - url: https://github.com/agnaistic/agnai
    reference_type:
    reference_id:
  - url: 'https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/character.ts#L140:'
    reference_type:
    reference_id:
  - url: https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/upload.ts#L55
    reference_type:
    reference_id:
  - url: https://github.com/agnaistic/agnai/security/advisories/GHSA-g54f-66mw-hv66
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47171
    reference_type:
    reference_id: CVE-2024-47171
  - url: https://github.com/advisories/GHSA-g54f-66mw-hv66
    reference_type:
    reference_id: GHSA-g54f-66mw-hv66
