advisory_id: npm/vega-interpreter/CVE-2025-59840
datasource_id: gitlab_importer_v2/npm/vega-interpreter/CVE-2025-59840
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/vega-interpreter/CVE-2025-59840.yml
aliases:
  - CVE-2025-59840
  - GHSA-7f2v-3qq3-vvjf
summary: |
  Vega Cross-Site Scripting (XSS) via expressions abusing toString calls in environments using the VEGA_DEBUG global variable
  Vega offers the evaluation of expressions in a secure context. Arbitrary function call is prohibited. When an event is exposed to an expression, member get of window objects is possible. Because of this exposure, in some applications, a crafted object that overrides its toString method with a function that results in calling `this.foo(this.bar)`, DOM XSS can be achieved.

  In practice, an accessible gadget like this exists in the global VEGA_DEBUG code.

  ```js
  ({
  toString: event.view.VEGA_DEBUG.vega.CanvasHandler.prototype.on,
  eventName: event.view.console.log,
  _handlers: {
  undefined: 'alert(origin + ` XSS on version `+ VEGA_DEBUG.VEGA_VERSION)'
  },
  _handlerIndex: event.view.eval
  })+1
  ```
impacted_packages:
  - purl: pkg:npm/vega-interpreter
    affected_versions: vers:npm/<1.2.1|>=2.0.0|<2.2.1
    fixed_versions: vers:npm/1.2.1|2.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/vega-interpreter/CVE-2025-59840.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/vega/editor/blob/e102355589d23cdd0dbfd607a2cc5f9c5b7a4c55/src/components/renderer/renderer.tsx#L239
    reference_type:
    reference_id:
  - url: https://github.com/vega/editor/blob/e102355589d23cdd0dbfd607a2cc5f9c5b7a4c55/src/index.tsx#L14-L16
    reference_type:
    reference_id:
  - url: https://github.com/vega/vega
    reference_type:
    reference_id:
  - url: https://github.com/vega/vega/security/advisories/GHSA-7f2v-3qq3-vvjf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59840
    reference_type:
    reference_id:
  - url: https://vega.github.io/editor/#/url/vega/N4IgJAzgxgFgpgWwIYgFwhgF0wBwqgegIDc4BzJAOjIEtMYBXAI0poHsDp5kTykSArJQBWENgDsQAGhAB3GgBN6aAMwCADDPg0yWVRplIGmNhBoAvOGhDiJVmQrjQATjRyZ2k9ABU2ZMgA2cAAEAELGJpIyZmTiSAEQaADaoHEIVugm-kHSIMTxDBmYzoUyEsmgcKTimImooJgAnjgZIFABNFAA1rnIzl1prVA0zu1WAL4yDDgKSJitWYEhAPzBAGbxECGowcWFIOMAupOpSOnWSAoKAGI0AfPOueWoKSBVcDV1Dc2tCGwMWz+pFyYgYo1a8nECjYsgOUxmc1aAApgCYAMrFGjiMiod41SjEGhwWSUABqAFEAOIAQQA+gARcmhACqlIJfEoAGEkOJ8hAABI8hRBZyUHDONgmJotSgSKTBPGYAByZzguOqmAJRJJUAkYiClACfiktJgQpF+GADChcDWWLgClQAHJ4nBnJgkWxXLRxMEANTBAAGwQAGmi0cEJMFSM4zFHAwGKTSGUzWWSqXSKQAlNEASQA8kqAJROyam81u3M2gAe6o+msJxMoVXi4yLfoAjAdjscgA
    reference_type:
    reference_id:
  - url: https://vega.github.io/vega/usage/interpreter
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-7f2v-3qq3-vvjf
    reference_type:
    reference_id: GHSA-7f2v-3qq3-vvjf
