advisory_id: npm/tarteaucitronjs/CVE-2025-48939
datasource_id: gitlab_importer_v2/npm/tarteaucitronjs/CVE-2025-48939
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/tarteaucitronjs/CVE-2025-48939.yml
aliases:
  - CVE-2025-48939
  - GHSA-q43x-79jr-cq98
summary: |
  tarteaucitron.js vulnerable to DOM Clobbering via document.currentScript
  A vulnerability was identified in tarteaucitron.js where document.currentScript was accessed without verifying that it referenced an actual `<script>` element. If an attacker injected an HTML element such as:

  ```
  <img name="currentScript" src="https://malicious.example.com">
  ```

  it could clobber the document.currentScript property. This causes the script to resolve incorrectly to an <img> element instead of the <script> tag, leading to unexpected behavior or failure to load the script path correctly.

  This issue arises because in some browser environments, named DOM elements (e.g., name="currentScript") become properties on the global document object.
impacted_packages:
  - purl: pkg:npm/tarteaucitronjs
    affected_versions: vers:npm/<1.22.0
    fixed_versions: vers:npm/1.22.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:C/C:N/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/tarteaucitronjs/CVE-2025-48939.yml
weaknesses:
  - CWE-138
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/AmauriC/tarteaucitron.js
    reference_type:
    reference_id:
  - url: https://github.com/AmauriC/tarteaucitron.js/commit/230a3b69d363837acfa895823d841e0608826ba3
    reference_type:
    reference_id:
  - url: https://github.com/AmauriC/tarteaucitron.js/security/advisories/GHSA-q43x-79jr-cq98
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-48939
    reference_type:
    reference_id: CVE-2025-48939
  - url: https://github.com/advisories/GHSA-q43x-79jr-cq98
    reference_type:
    reference_id: GHSA-q43x-79jr-cq98
