advisory_id: npm/@anthropic-ai/claude-code/CVE-2025-65099
datasource_id: gitlab_importer_v2/npm/@anthropic-ai/claude-code/CVE-2025-65099
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@anthropic-ai/claude-code/CVE-2025-65099.yml
aliases:
  - CVE-2025-65099
  - GHSA-5hhx-v7f6-x7gv
summary: |
  Claude Code vulnerable to command execution prior to startup trust dialog
  When using Claude Code with Yarn installed, Yarn config files can trigger code execution when running yarn --version. This could lead to a bypass of the directory trust dialog in Claude Code, as plugins and yarnPath could be executed prior to the user accepting the risks of working in an untrusted directory. Users on standard Claude Code auto-update will have received this fix automatically. Users performing manual updates are advised to update to the latest version.

  Thank you to Benjamin Faller, Redguard AG and Michael Hess for reporting this issue!
impacted_packages:
  - purl: pkg:npm/%40anthropic-ai/claude-code
    affected_versions: vers:npm/<1.0.39
    fixed_versions: vers:npm/1.0.39
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@anthropic-ai/claude-code/CVE-2025-65099.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://github.com/anthropics/claude-code
    reference_type:
    reference_id:
  - url: https://github.com/anthropics/claude-code/security/advisories/GHSA-5hhx-v7f6-x7gv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-65099
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5hhx-v7f6-x7gv
    reference_type:
    reference_id: GHSA-5hhx-v7f6-x7gv
