advisory_id: npm/@koa/cors/CVE-2023-49803
datasource_id: gitlab_importer_v2/npm/@koa/cors/CVE-2023-49803
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@koa/cors/CVE-2023-49803.yml
aliases:
  - CVE-2023-49803
  - GHSA-qxrj-hx23-xp82
summary: |
  Origin Validation Error
  @koa/cors npm provides Cross-Origin Resource Sharing (CORS) for koa, a web framework for Node.js. Prior to version 5.0.0, the middleware operates in a way that if an allowed origin is not provided, it will return an `Access-Control-Allow-Origin` header with the value of the origin from the request. This behavior completely disables one of the most crucial elements of browsers - the Same Origin Policy (SOP), this could cause a very serious security threat to the users of this middleware. If such behavior is expected, for instance, when middleware is used exclusively for prototypes and not for production applications, it should be heavily emphasized in the documentation along with an indication of the risks associated with such behavior, as many users may not be aware of it. Version 5.0.0 fixes this vulnerability.
impacted_packages:
  - purl: pkg:npm/%40koa/cors
    affected_versions: vers:npm/<5.0.0
    fixed_versions: vers:npm/5.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@koa/cors/CVE-2023-49803.yml
weaknesses:
  - CWE-1035
  - CWE-346
  - CWE-937
references:
  - url: https://github.com/koajs/cors/commit/f31dac99f5355c41e7d4dd3c4a80c5f154941a11
    reference_type:
    reference_id:
  - url: https://github.com/koajs/cors/security/advisories/GHSA-qxrj-hx23-xp82
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-49803
    reference_type:
    reference_id: CVE-2023-49803
  - url: https://github.com/advisories/GHSA-qxrj-hx23-xp82
    reference_type:
    reference_id: GHSA-qxrj-hx23-xp82
