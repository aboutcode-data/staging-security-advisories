advisory_id: npm/aws-cdk-lib/GHSA-5pq3-h73f-66hr
datasource_id: gitlab_importer_v2/npm/aws-cdk-lib/GHSA-5pq3-h73f-66hr
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/aws-cdk-lib/GHSA-5pq3-h73f-66hr.yml
aliases:
  - GHSA-5pq3-h73f-66hr
summary: |
  AWS CDK CodePipeline: trusted entities are too broad
  The [AWS Cloud Development Kit (CDK)](https://aws.amazon.com/cdk/) is an open-source framework for defining cloud infrastructure using code. Users use it to create their own applications, which are converted to AWS CloudFormation templates during deployment to a user's AWS account. AWS CDK contains pre-built components called "constructs," which are higher-level abstractions providing defaults and best practices. This approach enables developers to use familiar programming languages to define complex cloud infrastructure more efficiently than writing raw CloudFormation templates.

  The [AWS CodePipeline](https://aws.amazon.com/codepipeline/) construct deploys CodePipeline, a managed service that orchestrates software release processes through a series of stages, each comprising one or more actions executed by CodePipeline. To perform these actions, CodePipeline assumes IAM roles with permissions necessary for each step, allowing it to interact with AWS services and resources on behalf of the user.

  An issue exists where, when using CDK to create a CodePipeline with the CDK Construct Library, CDK creates an AWS Identity and Access Management (AWS IAM) trust policy with overly broad permissions. Any user with unrestricted sts:AssumeRole permissions could assume that trust policy. This issue does not affect users who supply their own role for CodePipeline.
impacted_packages:
  - purl: pkg:npm/aws-cdk-lib
    affected_versions: vers:npm/<2.189.0
    fixed_versions: vers:npm/2.189.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/aws-cdk-lib/GHSA-5pq3-h73f-66hr.yml
weaknesses:
  - CWE-276
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/aws/aws-cdk
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/commit/a64b01cc2969822bb92d7bd72152ecb2ccf1c1cf
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/issues/33709
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/releases/tag/v2.184.0
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/security/advisories/GHSA-5pq3-h73f-66hr
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5pq3-h73f-66hr
    reference_type:
    reference_id: GHSA-5pq3-h73f-66hr
