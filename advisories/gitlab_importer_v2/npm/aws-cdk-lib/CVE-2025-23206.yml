advisory_id: npm/aws-cdk-lib/CVE-2025-23206
datasource_id: gitlab_importer_v2/npm/aws-cdk-lib/CVE-2025-23206
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/aws-cdk-lib/CVE-2025-23206.yml
aliases:
  - CVE-2025-23206
  - GHSA-v4mq-x674-ff73
summary: |
  AWS Cloud Development Kit (AWS CDK) IAM OIDC custom resource allows connection to unauthorized OIDC provider
  Users who use IAM OIDC custom resource provider package will download CA Thumbprints as part of the custom resource workflow, https://github.com/aws/aws-cdk/blob/d16482fc8a4a3e1f62751f481b770c09034df7d2/packages/%40aws-cdk/custom-resource-handlers/lib/aws-iam/oidc-handler/external.ts#L34.

  However, the current `tls.connect` method will always set `rejectUnauthorized: false` which is a potential security concern. CDK should follow the best practice and set `rejectUnauthorized: true`. However, this could be a breaking change for existing CDK applications and we should fix this with a feature flag.

  Note that this is marked as low severity Security advisory because the issuer url is provided by CDK users who define the CDK application. If they insist on connecting to a unauthorized OIDC provider, CDK should not disallow this. Additionally, the code block is run in a Lambda environment which mitigate the MITM attack.

  As a best practice, CDK should still fix this issue under a feature flag to avoid regression.

  ```
  packages/@aws-cdk/custom-resource-handlers/lib/aws-iam/oidc-handler/external.ts
  ❯❱ problem-based-packs.insecure-transport.js-node.bypass-tls-verification.bypass-tls-verification
  Checks for setting the environment variable NODE_TLS_REJECT_UNAUTHORIZED to 0, which disables TLS
  verification. This should only be used for debugging purposes. Setting the option rejectUnauthorized
  to false bypasses verification against the list of trusted CAs, which also leads to insecure
  transport.
  ```
impacted_packages:
  - purl: pkg:npm/aws-cdk-lib
    affected_versions: vers:npm/<2.177.0
    fixed_versions: vers:npm/2.177.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/aws-cdk-lib/CVE-2025-23206.yml
weaknesses:
  - CWE-347
  - CWE-1035
  - CWE-937
references:
  - url: https://docs.aws.amazon.com/cdk/v2/guide/featureflags.html
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/blob/d16482fc8a4a3e1f62751f481b770c09034df7d2/packages/%40aws-cdk/custom-resource-handlers/lib/aws-iam/oidc-handler/external.ts#L34
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/commit/3e4f3773bfa48b75bf0adc7d53d46bbec7714a9e#diff-38a03353f201fd2e520df67fb43f9f000257bffd6e9acaa5569cce7005a77560
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/issues/32920
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/pull/32921
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/releases/tag/v2.177.0
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-cdk/security/advisories/GHSA-v4mq-x674-ff73
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23206
    reference_type:
    reference_id: CVE-2025-23206
  - url: https://github.com/advisories/GHSA-v4mq-x674-ff73
    reference_type:
    reference_id: GHSA-v4mq-x674-ff73
