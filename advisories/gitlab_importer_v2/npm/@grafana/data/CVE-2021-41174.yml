advisory_id: npm/@grafana/data/CVE-2021-41174
datasource_id: gitlab_importer_v2/npm/@grafana/data/CVE-2021-41174
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@grafana/data/CVE-2021-41174.yml
aliases:
  - CVE-2021-41174
  - GHSA-3j9m-hcv9-rpj8
summary: |
  Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
  Grafana is an open-source platform for monitoring and observability. arbitrary JavaScript content may be executed within the context of the victim's browser. The user visiting the malicious link must be unauthenticated and the link must be for a page that contains the login button in the menu bar. The url has to be crafted to exploit AngularJS rendering and contain the interpolation binding for AngularJS expressions. AngularJS uses double curly braces for interpolation binding: {{ }} ex: {{constructor.constructor(‘alert(1)’)()}}. When the user follows the link and the page renders, the login button will contain the original link with a query parameter to force a redirect to the login page. The URL is not validated and the AngularJS rendering engine will execute the JavaScript expression contained in the URL. Users are advised to upgrade as soon as possible. If for some reason you cannot upgrade, you can use a reverse proxy or similar to block access to block the literal string {{ in the path.
impacted_packages:
  - purl: pkg:npm/%40grafana/data
    affected_versions: vers:npm/>=8.0.0|<8.2.3
    fixed_versions: vers:npm/8.2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@grafana/data/CVE-2021-41174.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@grafana/data/CVE-2021-41174.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/grafana/grafana/commit/31b78d51c693d828720a5b285107a50e6024c912
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/commit/3cb5214fa45eb5a571fd70d6c6edf0d729983f82
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/commit/fb85ed691290d211a5baa44d9a641ab137f0de88
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/security/advisories/GHSA-3j9m-hcv9-rpj8
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20211125-0003/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41174
    reference_type:
    reference_id: CVE-2021-41174
  - url: https://github.com/advisories/GHSA-3j9m-hcv9-rpj8
    reference_type:
    reference_id: GHSA-3j9m-hcv9-rpj8
