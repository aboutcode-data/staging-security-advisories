advisory_id: npm/@directus/api/CVE-2024-45596
datasource_id: gitlab_importer_v2/npm/@directus/api/CVE-2024-45596
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@directus/api/CVE-2024-45596.yml
aliases:
  - CVE-2024-45596
  - GHSA-cff8-x7jv-4fm8
summary: |
  Session is cached for OpenID and OAuth2 if `redirect` is not used
  Unauthenticated user can access credentials of last authenticated user via OpenID or OAuth2 where the authentication URL did not include `redirect` query string.

  For example:
  - Project is configured with OpenID or OAuth2
  - Project is configured with cache enabled
  - User tries to login via SSO link, but without `redirect` query string
  - After successful login, credentials are cached
  - If an unauthenticated user tries to login via SSO link, it will return the credentials of the other last user

  The SSO link is something like `https://directus.example.com/auth/login/openid/callback`, where `openid` is the name of the OpenID provider configured in Directus
impacted_packages:
  - purl: pkg:npm/%40directus/api
    affected_versions: vers:npm/<21.0.1|>=22.0.0|<22.2.0
    fixed_versions: vers:npm/21.0.1|22.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@directus/api/CVE-2024-45596.yml
weaknesses:
  - CWE-524
  - CWE-384
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/blob/main/api/src/auth/drivers/oauth2.ts#L422-L428
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/blob/main/api/src/auth/drivers/openid.ts#L453-L459
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/commit/4aace0bbe57232e38cd6a287ee475293e46dc91b
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/commit/769fa22797bff5a9231599883b391e013f122e52
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-cff8-x7jv-4fm8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45596
    reference_type:
    reference_id: CVE-2024-45596
  - url: https://github.com/advisories/GHSA-cff8-x7jv-4fm8
    reference_type:
    reference_id: GHSA-cff8-x7jv-4fm8
