advisory_id: npm/@directus/api/CVE-2024-39699
datasource_id: gitlab_importer_v2/npm/@directus/api/CVE-2024-39699
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@directus/api/CVE-2024-39699.yml
aliases:
  - CVE-2024-39699
  - GHSA-8p72-rcq4-h6pw
summary: |
  Directus Blind SSRF On File Import
  There was already a reported SSRF vulnerability via file import. [https://github.com/directus/directus/security/advisories/GHSA-j3rg-3rgm-537h](https://github.com/directus/directus/security/advisories/GHSA-j3rg-3rgm-537h)
  It was fixed by resolving all DNS names and checking if the requested IP is an internal IP address.

  However it is possible to bypass this security measure and execute a SSRF using redirects. Directus allows redirects when importing file from the URL and does not check the result URL. Thus, it is possible to execute a request to an internal IP, for example to 127.0.0.1.

  However, it is blind SSRF, because Directus also uses response interception technique to get the information about the connect from the socket directly and it does not show a response if the IP address is internal (nice fix, by the way :) ).

  But the blindness does not fully mitigate the impact of the vulnerability. The blind SSRF is still exploitable in the real life scenarios, because there could be a vulnerable software inside of the network which can be exploited with GET request. I will show the example in the PoC. Also, you can check [HackTricks](https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/ssrf-vulnerable-platforms) page with some known cases.
impacted_packages:
  - purl: pkg:npm/%40directus/api
    affected_versions: vers:npm/<17.1.0
    fixed_versions: vers:npm/17.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@directus/api/CVE-2024-39699.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/commit/d577b44231c0923aca99cac5770fd853801caee1
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-8p72-rcq4-h6pw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-39699
    reference_type:
    reference_id: CVE-2024-39699
  - url: https://github.com/advisories/GHSA-8p72-rcq4-h6pw
    reference_type:
    reference_id: GHSA-8p72-rcq4-h6pw
