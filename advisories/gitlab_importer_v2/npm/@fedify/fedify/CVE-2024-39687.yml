advisory_id: npm/@fedify/fedify/CVE-2024-39687
datasource_id: gitlab_importer_v2/npm/@fedify/fedify/CVE-2024-39687
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@fedify/fedify/CVE-2024-39687.yml
aliases:
  - CVE-2024-39687
  - GHSA-p9cg-vqcc-grcx
summary: |
  Server Side Request Forgery (SSRF) attack in Fedify
  At present, when Fedify needs to retrieve an object or activity from a remote activitypub server, it makes a HTTP request to the `@id` or other resources present within the activity it has received from the web. This activity could reference an `@id` that points to an internal IP address, allowing an attacker to send request to resources internal to the fedify server's network.

  This applies to not just resolution of documents containing activities or objects, but also to media URLs as well.

  Specifically this is a [Server Side Request Forgery attack](https://owasp.org/www-community/attacks/Server_Side_Request_Forgery). You can learn more about SSRF attacks via [CWE-918](https://cwe.mitre.org/data/definitions/918.html)
impacted_packages:
  - purl: pkg:npm/%40fedify/fedify
    affected_versions: vers:npm/<0.9.2|>=0.10.0|<0.10.2|>=0.11.0|<0.11.2
    fixed_versions: vers:npm/0.9.2|0.10.2|0.11.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@fedify/fedify/CVE-2024-39687.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/dahlia/fedify
    reference_type:
    reference_id:
  - url: https://github.com/dahlia/fedify/commit/30f9cf4a175704a04c874f3ea88414c5f1e00b28
    reference_type:
    reference_id:
  - url: https://github.com/dahlia/fedify/commit/c641e976089dd913f649889c1bfb016df04e86ba
    reference_type:
    reference_id:
  - url: https://github.com/dahlia/fedify/releases/tag/0.11.1
    reference_type:
    reference_id:
  - url: https://github.com/dahlia/fedify/security/advisories/GHSA-p9cg-vqcc-grcx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-39687
    reference_type:
    reference_id: CVE-2024-39687
  - url: https://github.com/advisories/GHSA-p9cg-vqcc-grcx
    reference_type:
    reference_id: GHSA-p9cg-vqcc-grcx
