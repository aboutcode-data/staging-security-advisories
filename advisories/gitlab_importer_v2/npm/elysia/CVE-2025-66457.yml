advisory_id: npm/elysia/CVE-2025-66457
datasource_id: gitlab_importer_v2/npm/elysia/CVE-2025-66457
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/elysia/CVE-2025-66457.yml
aliases:
  - CVE-2025-66457
  - GHSA-8vch-m3f4-q8jf
summary: |
  Elysia affected by arbitrary code injection through cookie config
  Arbitrary code execution from cookie config. If dynamic cookies are enabled (ie there exists a schema for cookies), the cookie config is injected into the compiled route without first being sanitised.

  Availability of this exploit is generally low, as it requires write access to either the Elysia app's source code (in which case the vulnerability is meaningless) or write access to the cookie config (perhaps where it is assumed to be provisioned by the environment).

  However when combined with GHSA-hxj9-33pp-j2cc, this vulnerability allows for a full RCE chain.
impacted_packages:
  - purl: pkg:npm/elysia
    affected_versions: vers:npm/<1.4.18
    fixed_versions: vers:npm/1.4.18
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/elysia/CVE-2025-66457.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://github.com/elysiajs/elysia
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/commit/26935bf76ebc43b4a43d48b173fc853de43bb51e
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/commit/3af978663e437dccc6c1a2a3aff4b74e1574849e
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/pull/1564
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/security/advisories/GHSA-8vch-m3f4-q8jf
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/security/advisories/GHSA-hxj9-33pp-j2cc
    reference_type:
    reference_id:
  - url: https://github.com/sportshead/elysia-poc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66457
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-8vch-m3f4-q8jf
    reference_type:
    reference_id: GHSA-8vch-m3f4-q8jf
