advisory_id: npm/@sentry/sveltekit/GHSA-r5w7-f542-q2j4
datasource_id: gitlab_importer_v2/npm/@sentry/sveltekit/GHSA-r5w7-f542-q2j4
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@sentry/sveltekit/GHSA-r5w7-f542-q2j4.yml
aliases:
  - GHSA-r5w7-f542-q2j4
summary: |
  Potential DoS when using ContextLines integration
  The [ContextLines integration](https://docs.sentry.io/platforms/javascript/guides/node/configuration/integrations/contextlines/) uses readable streams to more efficiently use memory when reading files. The ContextLines integration is used to attach source context to outgoing events.

  The stream was not explicitly closed after use. This could lead to excessive amounts of file handles open on the system and potentially lead to a Denial of Service (DoS).

  The ContextLines integration is enabled by default in the Node SDK (`@sentry/node`) and SDKs that run in Node.js environments (`@sentry/astro`, `@sentry/aws-serverless`, `@sentry/bun`, `@sentry/google-cloud-serverless`, `@sentry/nestjs`, `@sentry/nextjs`, `@sentry/nuxt`, `@sentry/remix`, `@sentry/solidstart`, `@sentry/sveltekit`).
impacted_packages:
  - purl: pkg:npm/%40sentry/sveltekit
    affected_versions: vers:npm/>=8.10.0|<8.49.0
    fixed_versions: vers:npm/8.49.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/npm/@sentry/sveltekit/GHSA-r5w7-f542-q2j4.yml
weaknesses:
  - CWE-1035
  - CWE-774
  - CWE-937
references:
  - url: https://github.com/getsentry/sentry-javascript
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript/issues/14892
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript/pull/14997
    reference_type:
    reference_id:
  - url: https://github.com/getsentry/sentry-javascript/security/advisories/GHSA-r5w7-f542-q2j4
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-r5w7-f542-q2j4
    reference_type:
    reference_id: GHSA-r5w7-f542-q2j4
