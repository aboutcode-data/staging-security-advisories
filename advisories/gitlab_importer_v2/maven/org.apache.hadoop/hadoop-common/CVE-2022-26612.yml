advisory_id: maven/org.apache.hadoop/hadoop-common/CVE-2022-26612
datasource_id: gitlab_importer_v2/maven/org.apache.hadoop/hadoop-common/CVE-2022-26612
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.hadoop/hadoop-common/CVE-2022-26612.yml
aliases:
  - CVE-2022-26612
  - GHSA-gx2c-fvhc-ph4j
summary: |
  Path traversal in Hadoop
  In Apache Hadoop, The unTar function uses unTarUsingJava function on Windows and the built-in tar utility on Unix and other OSes. As a result, a TAR entry may create a symlink under the expected extraction directory which points to an external directory. A subsequent TAR entry may extract an arbitrary file into the external directory using the symlink name. This however would be caught by the same targetDirPath check on Unix because of the getCanonicalPath call. However on Windows, getCanonicalPath doesn't resolve symbolic links, which bypasses the check. unpackEntries during TAR extraction follows symbolic links which allows writing outside expected base directory on Windows. This was addressed in Apache Hadoop 2.10.2, 3.2.3, 3.3.3, and 3.4.0.
impacted_packages:
  - purl: pkg:maven/org.apache.hadoop/hadoop-common
    affected_versions:
    fixed_versions: vers:maven/2.10.2|3.2.3|3.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.hadoop/hadoop-common/CVE-2022-26612.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.hadoop/hadoop-common/CVE-2022-26612.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/apache/hadoop
    reference_type:
    reference_id:
  - url: https://github.com/apache/hadoop/commits/rel/release-2.10.2/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java
    reference_type:
    reference_id:
  - url: https://github.com/apache/hadoop/commits/rel/release-3.2.3/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java
    reference_type:
    reference_id:
  - url: https://github.com/apache/hadoop/commits/rel/release-3.3.3/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java
    reference_type:
    reference_id:
  - url: https://github.com/apache/hadoop/commits/rel/release-3.4.0/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/HADOOP-18317
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/hslo7wzw2449gv1jyjk8g6ttd7935fyz
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220519-0004
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-26612
    reference_type:
    reference_id: CVE-2022-26612
  - url: https://github.com/advisories/GHSA-gx2c-fvhc-ph4j
    reference_type:
    reference_id: GHSA-gx2c-fvhc-ph4j
