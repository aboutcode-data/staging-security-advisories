advisory_id: maven/org.apache.hadoop/hadoop-main/CVE-2022-25168
datasource_id: gitlab_importer_v2/maven/org.apache.hadoop/hadoop-main/CVE-2022-25168
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.hadoop/hadoop-main/CVE-2022-25168.yml
aliases:
  - CVE-2022-25168
summary: |
  Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')
  Apache Hadoop's FileUtil.unTar(File, File) API does not escape the input file name before being passed to the shell. An attacker can inject arbitrary commands. This is only used in Hadoop 3.3 InMemoryAliasMap.completeBootstrapTransfer, which is only ever run by a local user. It has been used in Hadoop 2.x for yarn localization, which does enable remote code execution. It is used in Apache Spark, from the SQL command ADD ARCHIVE. As the ADD ARCHIVE command adds new binaries to the classpath, being able to execute shell scripts does not confer new permissions to the caller. SPARK-38305. "Check existence of file before untarring/zipping", which is included in 3.3.0, 3.1.4, 3.2.2, prevents shell commands being executed, regardless of which version of the hadoop libraries are in use. Users should upgrade to Apache Hadoop 2.10.2, 3.2.4, 3.3.3 or upper (including HADOOP-18136).
impacted_packages:
  - purl: pkg:maven/org.apache.hadoop/hadoop-main
    affected_versions: vers:maven/>=2.0.0|<=2.10.1|>=3.0.0|<=3.2.3|>=3.3.0|<=3.3.2
    fixed_versions: vers:maven/2.10.2|3.2.4|3.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.hadoop/hadoop-main/CVE-2022-25168.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://lists.apache.org/thread/mxqnb39jfrwgs3j6phwvlrfq4mlox130
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-25168
    reference_type:
    reference_id: CVE-2022-25168
