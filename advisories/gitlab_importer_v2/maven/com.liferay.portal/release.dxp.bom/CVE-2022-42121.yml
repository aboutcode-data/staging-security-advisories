advisory_id: maven/com.liferay.portal/release.dxp.bom/CVE-2022-42121
datasource_id: gitlab_importer_v2/maven/com.liferay.portal/release.dxp.bom/CVE-2022-42121
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.liferay.portal/release.dxp.bom/CVE-2022-42121.yml
aliases:
  - CVE-2022-42121
  - GHSA-gxxj-fhmr-37j9
summary: |
  Liferay Portal and Liferay DXP Vulnerable to SQL Injection via the Layout Module
  A SQL injection vulnerability in the Layout module before 4.0.17 from Liferay Portal (7.1.3 through 7.4.3.4), and Liferay DXP 7.1 before fix pack 27, 7.2 before fix pack 17, 7.3 before service pack 3, and 7.4 GA allows remote authenticated attackers to execute arbitrary SQL commands via a crafted payload injected into a page template's 'Name' field.
impacted_packages:
  - purl: pkg:maven/com.liferay.portal/release.dxp.bom
    affected_versions: vers:maven/>=7.1.0|<7.1.10.fp27|>=7.2.0|<7.2.10.fp17
    fixed_versions: vers:maven/7.1.10.fp27|7.2.10.fp17
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.liferay.portal/release.dxp.bom/CVE-2022-42121.yml
weaknesses:
  - CWE-89
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/liferay/liferay-portal
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal/commit/14c8fbbac814c0b511b4f3ade19eafb2182923c7
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal/commit/5a17acb714c57e36695b7caff8e6a2789e2cf9d0
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal/commit/82de94e9f3a4425e3ee6c187462d670ae9bfef51
    reference_type:
    reference_id:
  - url: https://github.com/liferay/liferay-portal/commit/f245f4b428186c8e5964a9ffe90ccc7e12cf7f66
    reference_type:
    reference_id:
  - url: https://issues.liferay.com/browse/LPE-17414
    reference_type:
    reference_id:
  - url: https://liferay.dev/portal/security/known-vulnerabilities/-/asset_publisher/jekt/content/cve-2022-42121?p_r_p_assetEntryId=121613426&_com_liferay_asset_publisher_web_portlet_AssetPublisherPortlet_INSTANCE_jekt_redirect=https%3A%2F%2Fliferay.dev%3A443%2Fportal%2Fsecurity%2Fknown-vulnerabilities%3Fp_p_id%3Dcom_liferay_asset_publisher_web_portlet_AssetPublisherPortlet_INSTANCE_jekt%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_r_p_assetEntryId%3D121613426%26_com_liferay_asset_publisher_web_portlet_AssetPublisherPortlet_INSTANCE_jekt_cur%3D0%26p_r_p_resetCur%3Dfalse
    reference_type:
    reference_id:
  - url: https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/cve-2022-42121
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-42121
    reference_type:
    reference_id: CVE-2022-42121
  - url: https://github.com/advisories/GHSA-gxxj-fhmr-37j9
    reference_type:
    reference_id: GHSA-gxxj-fhmr-37j9
