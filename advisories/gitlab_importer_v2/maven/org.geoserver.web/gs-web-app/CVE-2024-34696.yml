advisory_id: maven/org.geoserver.web/gs-web-app/CVE-2024-34696
datasource_id: gitlab_importer_v2/maven/org.geoserver.web/gs-web-app/CVE-2024-34696
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.geoserver.web/gs-web-app/CVE-2024-34696.yml
aliases:
  - CVE-2024-34696
  - GHSA-j59v-vgcr-hxvf
summary: |
  GeoServer's Server Status shows sensitive environmental variables and Java properties
  GeoServer's Server Status page and REST API (at `/geoserver/rest/about/status`) lists *all* environment variables and Java properties to *any* GeoServer user with administrative rights as part of those modules' status message.

  These variables/properties can also contain sensitive information, such as database passwords or API keys/tokens, for example:

  * Data stores defined with [parameterized catalog settings][catalog] (`-DALLOW_ENV_PARAMETRIZATION=true`) which need a password or access key.

  * GeoServer's official Docker image [uses environment variables to configure PostgreSQL JNDI resources, including credentials][docker-jndi] (`POSTGRES_HOST`, `POSTGRES_USERNAME`, `POSTGRES_PASSWORD`)

  Additionally, many community-developed GeoServer container images `export` other credentials from their start-up scripts as environment variables to the GeoServer (`java`) process, such as:

  * GeoServer `admin` and master (`root`) passwords

  * Tomcat management application password

  * HTTPS/TLS certificate key store password

  * AWS S3 bucket access keys

  The precise scope of the issue depends on which container image is used and how it is configured.

  > [!NOTE]
  > Some container images allow passing secrets as files (eg: `POSTGRES_PASSWORD_FILE`), or randomly generating passwords on start-up. While this is promoted as best-practice[^secret-files], if its start-up script [`export`s these as environment variables][bash-export] to GeoServer, they are **also** impacted by this issue.

  [bash-export]: https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html#index-export
  [catalog]: https://docs.geoserver.org/latest/en/user/datadirectory/configtemplate.html
  [docker-jndi]: https://github.com/geoserver/docker/blob/master/README.md#how-to-enable-a-postgresql-jndi-resource
impacted_packages:
  - purl: pkg:maven/org.geoserver.web/gs-web-app
    affected_versions: vers:maven/>=2.10.0|<2.24.4|>=2.25.0|<2.25.1
    fixed_versions: vers:maven/2.24.4|2.25.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.geoserver.web/gs-web-app/CVE-2024-34696.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/geoserver/geoserver
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/security/advisories/GHSA-j59v-vgcr-hxvf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-34696
    reference_type:
    reference_id: CVE-2024-34696
  - url: https://github.com/advisories/GHSA-j59v-vgcr-hxvf
    reference_type:
    reference_id: GHSA-j59v-vgcr-hxvf
