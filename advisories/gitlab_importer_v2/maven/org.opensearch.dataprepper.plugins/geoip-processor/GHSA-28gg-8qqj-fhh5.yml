advisory_id: maven/org.opensearch.dataprepper.plugins/geoip-processor/GHSA-28gg-8qqj-fhh5
datasource_id: gitlab_importer_v2/maven/org.opensearch.dataprepper.plugins/geoip-processor/GHSA-28gg-8qqj-fhh5
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opensearch.dataprepper.plugins/geoip-processor/GHSA-28gg-8qqj-fhh5.yml
aliases:
  - GHSA-28gg-8qqj-fhh5
summary: |
  OpenSearch Data Prepper uses deprecated SSL protocol identifier
  The GeoIP processor and Kafka source and buffer were using the deprecated "SSL" protocol identifier when creating SSL contexts, potentially allowing the use of insecure SSL protocols instead of modern TLS versions.

  Multiple Data Prepper plugins used `SSLContext.getInstance("SSL")` which could potentially allow the use of deprecated SSL protocols (SSLv2, SSLv3) that have known security vulnerabilities. While modern Java implementations typically default to secure TLS versions even with the "SSL" identifier, explicitly using "TLS" ensures that only secure TLS protocols are negotiated.

  The affected components were:

  * GeoIP Processor: The `DBSource.initiateSSL()` method used for downloading GeoIP databases from external sources

  * Kafka Plugin: Both `CustomClientSslEngineFactory` and `InsecureSslEngineFactory` classes used for Kafka client connections

  This could potentially allow connections to negotiate weaker SSL protocols instead of enforcing modern TLS versions, reducing the security of data transmission.
impacted_packages:
  - purl: pkg:maven/org.opensearch.dataprepper.plugins/geoip-processor
    affected_versions: vers:maven/>=2.4.0|<2.12.2
    fixed_versions: vers:maven/2.12.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opensearch.dataprepper.plugins/geoip-processor/GHSA-28gg-8qqj-fhh5.yml
weaknesses:
  - CWE-295
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/opensearch-project/data-prepper
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/data-prepper/commit/fa21a601512b5193c4b5c84a5b30c6301dab0475
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/data-prepper/security/advisories/GHSA-28gg-8qqj-fhh5
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-28gg-8qqj-fhh5
    reference_type:
    reference_id: GHSA-28gg-8qqj-fhh5
