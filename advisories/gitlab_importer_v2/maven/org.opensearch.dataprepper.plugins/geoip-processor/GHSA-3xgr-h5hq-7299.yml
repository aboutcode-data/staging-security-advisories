advisory_id: maven/org.opensearch.dataprepper.plugins/geoip-processor/GHSA-3xgr-h5hq-7299
datasource_id: gitlab_importer_v2/maven/org.opensearch.dataprepper.plugins/geoip-processor/GHSA-3xgr-h5hq-7299
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opensearch.dataprepper.plugins/geoip-processor/GHSA-3xgr-h5hq-7299.yml
aliases:
  - GHSA-3xgr-h5hq-7299
summary: |
  GeoIP processor disables SSL certificate validation when downloading databases
  The GeoIP processor in Data Prepper was configured to trust all SSL certificates and disable hostname verification when downloading GeoIP databases from HTTP URLs, making downloads vulnerable to man-in-the-middle attacks.

  The GeoIP processor included a custom SSL implementation that completely bypassed certificate validation when downloading GeoIP databases from external sources. The `initiateSSL()` method incorrectly implemented an approach for trusting all certificates. Specifically it:

  * Accepted all SSL certificates without validation
  * Disabled server certificate verification
  * Disabled client certificate verification
  * Disabled hostname verification

  This configuration made database downloads vulnerable to man-in-the-middle attacks, potentially allowing attackers to serve malicious GeoIP databases that could compromise the integrity of geolocation data processing.
impacted_packages:
  - purl: pkg:maven/org.opensearch.dataprepper.plugins/geoip-processor
    affected_versions: vers:maven/>=2.7.0|<2.12.2
    fixed_versions: vers:maven/2.12.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opensearch.dataprepper.plugins/geoip-processor/GHSA-3xgr-h5hq-7299.yml
weaknesses:
  - CWE-295
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/opensearch-project/data-prepper
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/data-prepper/commit/b82ea0640d98d9f4c742622325faeeb6248ee135
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/data-prepper/security/advisories/GHSA-3xgr-h5hq-7299
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-3xgr-h5hq-7299
    reference_type:
    reference_id: GHSA-3xgr-h5hq-7299
