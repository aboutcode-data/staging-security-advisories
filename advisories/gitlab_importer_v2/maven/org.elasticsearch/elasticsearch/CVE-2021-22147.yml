advisory_id: maven/org.elasticsearch/elasticsearch/CVE-2021-22147
datasource_id: gitlab_importer_v2/maven/org.elasticsearch/elasticsearch/CVE-2021-22147
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.elasticsearch/elasticsearch/CVE-2021-22147.yml
aliases:
  - CVE-2021-22147
  - GHSA-45h5-r968-5xr7
summary: |
  Incorrect Permission Assignment for Critical Resource
  Elasticsearch before 7.14.0 did not apply document and field level security to searchable snapshots. This could lead to an authenticated user gaining access to information that they are unauthorized to view.
impacted_packages:
  - purl: pkg:maven/org.elasticsearch/elasticsearch
    affected_versions: vers:maven/>=7.11.0|<7.14.0
    fixed_versions: vers:maven/7.14.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.elasticsearch/elasticsearch/CVE-2021-22147.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.elasticsearch/elasticsearch/CVE-2021-22147.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-732
references:
  - url: https://discuss.elastic.co/t/elastic-stack-7-14-0-security-update/280344
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20211008-0002/
    reference_type:
    reference_id:
  - url: https://www.elastic.co/community/security/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-22147
    reference_type:
    reference_id: CVE-2021-22147
  - url: https://github.com/advisories/GHSA-45h5-r968-5xr7
    reference_type:
    reference_id: GHSA-45h5-r968-5xr7
