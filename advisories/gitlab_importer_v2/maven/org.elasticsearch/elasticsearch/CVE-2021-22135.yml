advisory_id: maven/org.elasticsearch/elasticsearch/CVE-2021-22135
datasource_id: gitlab_importer_v2/maven/org.elasticsearch/elasticsearch/CVE-2021-22135
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.elasticsearch/elasticsearch/CVE-2021-22135.yml
aliases:
  - CVE-2021-22135
  - GHSA-62ww-4p3p-7fhj
summary: |
  Exposure of Sensitive Information to an Unauthorized Actor
  Elasticsearch versions before 7.11.2 and 6.8.15 contain a document disclosure flaw was found in the Elasticsearch suggester and profile API when Document and Field Level Security are enabled. The suggester and profile API are normally disabled for an index when document level security is enabled on the index. Certain queries are able to enable the profiler and suggester which could lead to disclosing the existence of documents and fields the attacker should not be able to view.
impacted_packages:
  - purl: pkg:maven/org.elasticsearch/elasticsearch
    affected_versions:
    fixed_versions: vers:maven/6.8.15
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.elasticsearch/elasticsearch/CVE-2021-22135.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.elasticsearch/elasticsearch/CVE-2021-22135.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20210625-0003/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-22135
    reference_type:
    reference_id: CVE-2021-22135
  - url: https://github.com/advisories/GHSA-62ww-4p3p-7fhj
    reference_type:
    reference_id: GHSA-62ww-4p3p-7fhj
