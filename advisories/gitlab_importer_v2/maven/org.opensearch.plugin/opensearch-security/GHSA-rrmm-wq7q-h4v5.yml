advisory_id: maven/org.opensearch.plugin/opensearch-security/GHSA-rrmm-wq7q-h4v5
datasource_id: gitlab_importer_v2/maven/org.opensearch.plugin/opensearch-security/GHSA-rrmm-wq7q-h4v5
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opensearch.plugin/opensearch-security/GHSA-rrmm-wq7q-h4v5.yml
aliases:
  - GHSA-rrmm-wq7q-h4v5
summary: |
  OpenSearch unauthorized data access on fields protected by field masking for fields of type ip, geo_point, geo_shape, xy_point, xy_shape
  OpenSearch versions 2.19.2 and earlier improperly apply field masking rules on fields of the types `ip`, `geo_point`, `geo_shape`, `xy_point`, `xy_shape`. While the content of these fields is properly redacted in the `_source` document returned by search operations, the original unredacted values remain available to search queries. This allows to reconstruct the original field contents using range queries.

  Additionally, the content of fields of type `geo_point`, `geo_shape`, `xy_point`, `xy_shape` is returned in an unredacted form if requested via the `fields` option of the search API.
impacted_packages:
  - purl: pkg:maven/org.opensearch.plugin/opensearch-security
    affected_versions: vers:maven/<2.19.3.0
    fixed_versions: vers:maven/2.19.3.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opensearch.plugin/opensearch-security/GHSA-rrmm-wq7q-h4v5.yml
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/opensearch-project/security
    reference_type:
    reference_id:
  - url: https://github.com/opensearch-project/security/security/advisories/GHSA-rrmm-wq7q-h4v5
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-rrmm-wq7q-h4v5
    reference_type:
    reference_id: GHSA-rrmm-wq7q-h4v5
