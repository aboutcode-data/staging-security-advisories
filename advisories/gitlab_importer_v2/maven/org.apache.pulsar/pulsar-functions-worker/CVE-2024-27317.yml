advisory_id: maven/org.apache.pulsar/pulsar-functions-worker/CVE-2024-27317
datasource_id: gitlab_importer_v2/maven/org.apache.pulsar/pulsar-functions-worker/CVE-2024-27317
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.pulsar/pulsar-functions-worker/CVE-2024-27317.yml
aliases:
  - CVE-2024-27317
  - GHSA-jg2g-4rjg-cmqh
summary: |
  Apache Pulsar: Pulsar Functions Worker's Archive Extraction Vulnerability Allows Unauthorized File Modification
  In Pulsar Functions Worker, authenticated users can upload functions in jar or nar files. These files, essentially zip files, are extracted by the Functions Worker. However, if a malicious file is uploaded, it could exploit a directory traversal vulnerability. This occurs when the filenames in the zip files, which aren't properly validated, contain special elements like "..", altering the directory path. This could allow an attacker to create or modify files outside of the designated extraction directory, potentially influencing system behavior. This vulnerability also applies to the Pulsar Broker when it is configured with "functionsWorkerEnabled=true".

  This issue affects Apache Pulsar versions from 2.4.0 to 2.10.5, from 2.11.0 to 2.11.3, from 3.0.0 to 3.0.2, from 3.1.0 to 3.1.2, and 3.2.0.

  2.10 Pulsar Function Worker users should upgrade to at least 2.10.6.
  2.11 Pulsar Function Worker users should upgrade to at least 2.11.4.
  3.0 Pulsar Function Worker users should upgrade to at least 3.0.3.
  3.1 Pulsar Function Worker users should upgrade to at least 3.1.3.
  3.2 Pulsar Function Worker users should upgrade to at least 3.2.1.

  Users operating versions prior to those listed above should upgrade to the aforementioned patched versions or newer versions.
impacted_packages:
  - purl: pkg:maven/org.apache.pulsar/pulsar-functions-worker
    affected_versions: vers:maven/>=2.4.0|<2.10.6|>=2.11.0|<2.11.4|>=3.0.0|<3.0.3|>=3.1.0|<3.1.3|>=3.2.0|<3.2.1
    fixed_versions: vers:maven/2.10.6|2.11.4|3.0.3|3.1.3|3.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.pulsar/pulsar-functions-worker/CVE-2024-27317.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/apache/pulsar
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/ct9xmvlf7lompc1pxvlsb60qstfsm9po
    reference_type:
    reference_id:
  - url: https://pulsar.apache.org/security/CVE-2024-27317
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-27317
    reference_type:
    reference_id: CVE-2024-27317
  - url: https://github.com/advisories/GHSA-jg2g-4rjg-cmqh
    reference_type:
    reference_id: GHSA-jg2g-4rjg-cmqh
