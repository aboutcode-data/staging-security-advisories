advisory_id: maven/org.xwiki.contrib.oidc/oidc-authenticator/CVE-2022-39387
datasource_id: gitlab_importer_v2/maven/org.xwiki.contrib.oidc/oidc-authenticator/CVE-2022-39387
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.contrib.oidc/oidc-authenticator/CVE-2022-39387.yml
aliases:
  - CVE-2022-39387
  - GHSA-m7gv-v8xx-v47w
summary: |
  XWiki OIDC Authenticator vulnerable to bypassing OpenID login by providing a custom provider
  XWiki OIDC has various tools to manipulate OpenID Connect protocol in XWiki. Prior to version 1.29.1, even if a wiki has an OpenID provider configured through its xwiki.properties, it is possible to provide a third party provider its details through request parameters. One can then bypass the XWiki authentication altogether by specifying its own provider through the oidc.endpoint.* request parameters (or by using an XWiki-based OpenID provider with oidc.xwikiprovider. With the same approach, one could also provide a specific group mapping through oidc.groups.mapping that would make his user automatically part of the XWikiAdminGroup. This issue has been patched, please upgrade to 1.29.1. There is no workaround, an upgrade of the authenticator is required.
impacted_packages:
  - purl: pkg:maven/org.xwiki.contrib.oidc/oidc-authenticator
    affected_versions: vers:maven/<1.29.1
    fixed_versions: vers:maven/1.29.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.contrib.oidc/oidc-authenticator/CVE-2022-39387.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/xwiki-contrib/oidc/commit/0247af1417925b9734ab106ad7cd934ee870ac89
    reference_type:
    reference_id:
  - url: https://github.com/xwiki-contrib/oidc/security/advisories/GHSA-m7gv-v8xx-v47w
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/OIDC-118
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39387
    reference_type:
    reference_id: CVE-2022-39387
  - url: https://github.com/advisories/GHSA-m7gv-v8xx-v47w
    reference_type:
    reference_id: GHSA-m7gv-v8xx-v47w
