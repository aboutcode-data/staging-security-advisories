advisory_id: maven/org.clojure/clojure/CVE-2024-22871
datasource_id: gitlab_importer_v2/maven/org.clojure/clojure/CVE-2024-22871
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.clojure/clojure/CVE-2024-22871.yml
aliases:
  - CVE-2024-22871
  - GHSA-vr64-r9qj-h27f
summary: |
  Reading specially crafted serializable objects from an untrusted source may cause an infinite loop and denial of service
  Any program on the JVM may read serialized objects via [java.io.ObjectInputStream.readObject()](https://docs.oracle.com/javase/8/docs/api/java/io/ObjectInputStream.html#readObject--). Reading serialized objects from an untrusted source is **inherently unsafe** (this affects any program running on any version of the JVM) and is a prerequisite for this vulnerability.

  Clojure classes that represent infinite seqs (Cycle, infinite Repeat, and Iterate) do not define hashCode() and use the parent ASeq.hashCode(), which walks the seq to compute the hash, yielding an infinite loop. Classes like java.util.HashMap call hashCode() on keys during deserialization of a serialized map.

  The exploit requires:

  1. Crafting a serialized HashMap object with an infinite seq object as a key.
  2. Sending that to a program that reads serialized objects via ObjectInputStream.readObject().

  This will cause the program to enter an infinite loop on the reading thread and thus a denial of service (DoS).

  The affected Clojure classes (Cycle, Repeat, Iterate) exist in Clojure 1.7.0-1.11.1, 1.12.0-alpha1-1.12.0-alpha8.
impacted_packages:
  - purl: pkg:maven/org.clojure/clojure
    affected_versions: vers:maven/>=1.7.0|<1.11.2|>=1.12.0-alpha1|<1.12.0-alpha9
    fixed_versions: vers:maven/1.11.2|1.12.0-alpha9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.clojure/clojure/CVE-2024-22871.yml
weaknesses:
  - CWE-1035
  - CWE-502
  - CWE-937
references:
  - url: https://clojure.atlassian.net/browse/CLJ-2839
    reference_type:
    reference_id:
  - url: https://github.com/clojure/clojure
    reference_type:
    reference_id:
  - url: https://hackmd.io/%40fe1w0/rymmJGida
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/25FKUOYXQZGGJMFUM5HJABWMIX2TILRV
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/SWWK2SO2MH4SXPO6L444MM6LHVLVFULV
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YFPGUDXMW6OXKIDGCOZFEAXO74VQIB2T
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/25FKUOYXQZGGJMFUM5HJABWMIX2TILRV
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SWWK2SO2MH4SXPO6L444MM6LHVLVFULV
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/YFPGUDXMW6OXKIDGCOZFEAXO74VQIB2T
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22871
    reference_type:
    reference_id: CVE-2024-22871
  - url: https://github.com/advisories/GHSA-vr64-r9qj-h27f
    reference_type:
    reference_id: GHSA-vr64-r9qj-h27f
