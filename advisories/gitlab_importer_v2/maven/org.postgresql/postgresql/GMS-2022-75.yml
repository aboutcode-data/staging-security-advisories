advisory_id: maven/org.postgresql/postgresql/GMS-2022-75
datasource_id: gitlab_importer_v2/maven/org.postgresql/postgresql/GMS-2022-75
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.postgresql/postgresql/GMS-2022-75.yml
aliases:
  - GHSA-673j-qm5f-xpv8
  - GMS-2022-75
summary: |
  Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
  The connection properties for configuring a pgjdbc connection are not meant to be exposed to an unauthenticated attacker. While allowing an attacker to specify arbitrary connection properties could lead to a compromise of a system, that's a defect of an application that allows unauthenticated attackers that level of control. It's not the job of the pgjdbc driver to decide whether a given log file location is acceptable. End user applications that use the pgjdbc driver must ensure that filenames are valid and restrict unauthenticated attackers from being able to supply arbitrary values. That's not specific to the pgjdbc driver either, it would be true for any library that can write to the application's local file system. While we do not consider this a security issue with the driver, we have decided to remove the `loggerFile` and `loggerLevel` connection properties in the next release of the driver. Removal of those properties does not make exposing the JDBC URL or connection properties to an attacker safe and we continue to suggest that applications do not allow untrusted users to specify arbitrary connection properties. We are removing them to prevent misuse and their functionality can be delegated to `java.util.logging`.
impacted_packages:
  - purl: pkg:maven/org.postgresql/postgresql
    affected_versions: vers:maven/>=42.1.0|<42.3.3
    fixed_versions: vers:maven/42.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://github.com/pgjdbc/pgjdbc/commit/f6d47034a4ce292e1a659fa00963f6f713117064
    reference_type:
    reference_id:
  - url: https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-673j-qm5f-xpv8
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-673j-qm5f-xpv8
    reference_type:
    reference_id: GHSA-673j-qm5f-xpv8
