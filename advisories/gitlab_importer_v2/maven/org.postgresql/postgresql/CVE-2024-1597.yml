advisory_id: maven/org.postgresql/postgresql/CVE-2024-1597
datasource_id: gitlab_importer_v2/maven/org.postgresql/postgresql/CVE-2024-1597
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.postgresql/postgresql/CVE-2024-1597.yml
aliases:
  - CVE-2024-1597
  - GHSA-xfg6-62px-cxc2
summary: |
  Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  pgjdbc, the PostgreSQL JDBC Driver, allows attacker to inject SQL if using PreferQueryMode=SIMPLE. Note this is not the default. In the default mode there is no vulnerability. A placeholder for a numeric value must be immediately preceded by a minus. There must be a second placeholder for a string value after the first placeholder; both must be on the same line. By constructing a matching string payload, the attacker can inject SQL to alter the query,bypassing the protections that parameterized queries bring against SQL Injection attacks. Versions before 42.7.2, 42.6.1, 42.5.5, 42.4.4, 42.3.9, and 42.2.8 are affected.
impacted_packages:
  - purl: pkg:maven/org.postgresql/postgresql
    affected_versions: vers:maven/<42.2.8|>=42.3.0|<42.3.9|>=42.4.0|<42.4.4|>=42.5.0|<42.5.5|>=42.6.0|<42.6.1|>=42.7.0|<42.7.2
    fixed_versions: vers:maven/42.2.8|42.3.9|42.4.4|42.5.5|42.6.1|42.7.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.postgresql/postgresql/CVE-2024-1597.yml
weaknesses:
  - CWE-89
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/pgjdbc/pgjdbc/commit/06abfb78a627277a580d4df825f210e96a4e14ee
    reference_type:
    reference_id:
  - url: https://github.com/pgjdbc/pgjdbc/commit/93b0fcb2711d9c1e3a2a03134369738a02a58b40
    reference_type:
    reference_id:
  - url: https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-24rp-q3w6-vc56
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-1597
    reference_type:
    reference_id: CVE-2024-1597
  - url: https://github.com/advisories/GHSA-xfg6-62px-cxc2
    reference_type:
    reference_id: GHSA-xfg6-62px-cxc2
