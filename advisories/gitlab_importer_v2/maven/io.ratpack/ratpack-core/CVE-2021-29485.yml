advisory_id: maven/io.ratpack/ratpack-core/CVE-2021-29485
datasource_id: gitlab_importer_v2/maven/io.ratpack/ratpack-core/CVE-2021-29485
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.ratpack/ratpack-core/CVE-2021-29485.yml
aliases:
  - CVE-2021-29485
  - GHSA-hc33-32vw-rpp9
summary: |
  Deserialization of Untrusted Data
  Ratpack is a toolkit for creating web applications., a malicious attacker can achieve Remote Code Execution (RCE) via a maliciously crafted Java deserialization gadget chain leveraged against the Ratpack session store. If one's application does not use Ratpack's session mechanism, it is not vulnerable. Ratpack introduces a strict allow-list mechanism that mitigates this vulnerability when used. Two possible workarounds exist. The simplest mitigation for users of earlier versions is to reduce the likelihood of attackers being able to write to the session data store. Alternatively or additionally, the allow-list mechanism could be manually back ported by providing an alternative implementation of `SessionSerializer` that uses an allow-list.
impacted_packages:
  - purl: pkg:maven/io.ratpack/ratpack-core
    affected_versions: vers:maven/<1.9.0
    fixed_versions: vers:maven/1.9.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.ratpack/ratpack-core/CVE-2021-29485.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.ratpack/ratpack-core/CVE-2021-29485.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29485
    reference_type:
    reference_id: CVE-2021-29485
