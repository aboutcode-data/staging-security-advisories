advisory_id: maven/org.keycloak/keycloak-quarkus-server/CVE-2024-9666
datasource_id: gitlab_importer_v2/maven/org.keycloak/keycloak-quarkus-server/CVE-2024-9666
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.keycloak/keycloak-quarkus-server/CVE-2024-9666.yml
aliases:
  - CVE-2024-9666
  - GHSA-jgwc-jh89-rpgq
summary: |
  Keycloak proxy header handling Denial-of-Service (DoS) vulnerability
  Keycloak versions 26 and earlier are vulnerable to a denial-of-service (DoS) attack through improper handling of proxy headers. When Keycloak is configured to accept incoming proxy headers, it may accept non-IP values, such as obfuscated identifiers, without proper validation. This can lead to costly DNS resolution operations, which an attacker could exploit to tie up IO threads and potentially cause a denial of service.

  The attacker must have access to send requests to a Keycloak instance that is configured to accept proxy headers, specifically when reverse proxies do not overwrite incoming headers, and Keycloak is configured to trust these headers.

  For Keycloak version 26, for successful exploitation includes: the realm must have SslRequired=EXTERNAL (the default), HTTP must be enabled, the instance must not be using a full hostname URL, access must come from behind a proxy (assuming the proxy overwrites the X-Forwarded-For header), and trusted proxies must not be set or must incorrectly trust the client from which the request is originating.
impacted_packages:
  - purl: pkg:maven/org.keycloak/keycloak-quarkus-server
    affected_versions: vers:maven/<24.0.9|>=25.0.0|<26.0.6
    fixed_versions: vers:maven/24.0.9|26.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.keycloak/keycloak-quarkus-server/CVE-2024-9666.yml
weaknesses:
  - CWE-444
  - CWE-1035
  - CWE-937
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-9666
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak/issues/35216
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak/security/advisories/GHSA-jgwc-jh89-rpgq
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2317440
    reference_type: bug
    reference_id: 2317440
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-9666
    reference_type:
    reference_id: CVE-2024-9666
  - url: https://github.com/advisories/GHSA-jgwc-jh89-rpgq
    reference_type:
    reference_id: GHSA-jgwc-jh89-rpgq
  - url: https://access.redhat.com/errata/RHSA-2024:10175
    reference_type:
    reference_id: RHSA-2024:10175
  - url: https://access.redhat.com/errata/RHSA-2024:10176
    reference_type:
    reference_id: RHSA-2024:10176
  - url: https://access.redhat.com/errata/RHSA-2024:10177
    reference_type:
    reference_id: RHSA-2024:10177
  - url: https://access.redhat.com/errata/RHSA-2024:10178
    reference_type:
    reference_id: RHSA-2024:10178
