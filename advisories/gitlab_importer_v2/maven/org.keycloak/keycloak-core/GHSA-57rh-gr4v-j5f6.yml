advisory_id: maven/org.keycloak/keycloak-core/GHSA-57rh-gr4v-j5f6
datasource_id: gitlab_importer_v2/maven/org.keycloak/keycloak-core/GHSA-57rh-gr4v-j5f6
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.keycloak/keycloak-core/GHSA-57rh-gr4v-j5f6.yml
aliases:
  - GHSA-57rh-gr4v-j5f6
summary: |
  Duplicate Advisory: Keycloak Uses a Key Past its Expiration Date
  # Duplicate Advisory
  This advisory has been withdrawn because it is a duplicate of GHSA-xmmm-jw76-q7vg. This link is maintained to preserve external references.

  # Original Description
  A vulnerability was found in Keycloak. Expired OTP codes are still usable when using FreeOTP when the OTP token period is set to 30 seconds (default). Instead of expiring and deemed unusable around 30 seconds in, the tokens are valid for an additional 30 seconds totaling 1 minute.
  A one time passcode that is valid longer than its expiration time increases the attack window for malicious actors to abuse the system and compromise accounts. Additionally, it increases the attack surface because at any given time, two OTPs are valid.
impacted_packages:
  - purl: pkg:maven/org.keycloak/keycloak-core
    affected_versions: vers:maven/<24.0.7
    fixed_versions: vers:maven/24.0.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.keycloak/keycloak-core/GHSA-57rh-gr4v-j5f6.yml
weaknesses:
  - CWE-324
  - CWE-1035
  - CWE-937
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-7318
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2301876
    reference_type: bug
    reference_id: 2301876
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-7318
    reference_type:
    reference_id: CVE-2024-7318
  - url: https://github.com/advisories/GHSA-57rh-gr4v-j5f6
    reference_type:
    reference_id: GHSA-57rh-gr4v-j5f6
  - url: https://access.redhat.com/errata/RHSA-2024:6502
    reference_type:
    reference_id: RHSA-2024:6502
  - url: https://access.redhat.com/errata/RHSA-2024:6503
    reference_type:
    reference_id: RHSA-2024:6503
