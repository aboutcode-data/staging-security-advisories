advisory_id: maven/org.keycloak/keycloak-model-storage-services/CVE-2025-9162
datasource_id: gitlab_importer_v2/maven/org.keycloak/keycloak-model-storage-services/CVE-2025-9162
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.keycloak/keycloak-model-storage-services/CVE-2025-9162.yml
aliases:
  - CVE-2025-9162
  - GHSA-8hxp-qmph-w5gq
summary: |
  Keycloak Potential Variable Reference in Model Storage Services
  A flaw was found in org.keycloak/keycloak-model-storage-service. The `KeycloakRealmImport` custom resource substitutes placeholders within imported realm documents, potentially referencing environment variables. This substitution process allows for injection attacks when crafted realm documents are processed. An attacker can leverage this to inject malicious content during the realm import procedure. This can lead to unintended consequences within the Keycloak environment.
impacted_packages:
  - purl: pkg:maven/org.keycloak/keycloak-model-storage-services
    affected_versions: vers:maven/<26.2.9|>=26.3.0|<26.3.4
    fixed_versions: vers:maven/26.3.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.keycloak/keycloak-model-storage-services/CVE-2025-9162.yml
weaknesses:
  - CWE-526
  - CWE-1035
  - CWE-937
references:
  - url: https://access.redhat.com/security/cve/CVE-2025-9162
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2389396
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak/blob/26.3.3/model/storage-services/src/main/java/org/keycloak/exportimport/AbstractFileBasedImportProvider.java#L36
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak/blob/75afda410495a9576e00edc3277ab42ca155f806/model/storage-services/src/main/java/org/keycloak/exportimport/AbstractFileBasedImportProvider.java#L35
    reference_type:
    reference_id:
  - url: https://github.com/keycloak/keycloak/security/advisories/GHSA-8hxp-qmph-w5gq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-9162
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-8hxp-qmph-w5gq
    reference_type:
    reference_id: GHSA-8hxp-qmph-w5gq
  - url: https://access.redhat.com/errata/RHSA-2025:15336
    reference_type:
    reference_id: RHSA-2025:15336
  - url: https://access.redhat.com/errata/RHSA-2025:15337
    reference_type:
    reference_id: RHSA-2025:15337
  - url: https://access.redhat.com/errata/RHSA-2025:15338
    reference_type:
    reference_id: RHSA-2025:15338
  - url: https://access.redhat.com/errata/RHSA-2025:15339
    reference_type:
    reference_id: RHSA-2025:15339
  - url: https://access.redhat.com/errata/RHSA-2025:16399
    reference_type:
    reference_id: RHSA-2025:16399
  - url: https://access.redhat.com/errata/RHSA-2025:16400
    reference_type:
    reference_id: RHSA-2025:16400
