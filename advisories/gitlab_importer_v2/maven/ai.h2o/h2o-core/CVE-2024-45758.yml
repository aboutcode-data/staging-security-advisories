advisory_id: maven/ai.h2o/h2o-core/CVE-2024-45758
datasource_id: gitlab_importer_v2/maven/ai.h2o/h2o-core/CVE-2024-45758
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/ai.h2o/h2o-core/CVE-2024-45758.yml
aliases:
  - CVE-2024-45758
  - GHSA-hrmc-jmp7-mpm2
summary: |
  H2O.ai H2O vulnerable to deserialization attacks via a JDBC Connection URL
  H2O.ai H2O through 3.46.0.4 allows attackers to arbitrarily set the JDBC URL, leading to deserialization attacks, file reads, and command execution. Exploitation can occur when an attacker has access to post to the ImportSQLTable URI with a JSON document containing a connection_url property with any typical JDBC Connection URL attack payload such as one that uses queryInterceptors.
impacted_packages:
  - purl: pkg:maven/ai.h2o/h2o-core
    affected_versions: vers:maven/<=3.46.0.7
    fixed_versions: vers:maven/
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/ai.h2o/h2o-core/CVE-2024-45758.yml
weaknesses:
  - CWE-1035
  - CWE-502
  - CWE-937
references:
  - url: https://gist.github.com/AfterSnows/c24ca3c26dc89ab797e610e92a6a9acb
    reference_type:
    reference_id:
  - url: https://github.com/h2oai/h2o-3
    reference_type:
    reference_id:
  - url: https://github.com/h2oai/h2o-3/commit/f714edd6b8429c7a7211b779b6ec108a95b7382d
    reference_type:
    reference_id:
  - url: https://github.com/h2oai/h2o-3/issues/16425
    reference_type:
    reference_id:
  - url: https://github.com/h2oai/h2o-3/issues/16622
    reference_type:
    reference_id:
  - url: https://github.com/h2oai/h2o-3/pull/16624
    reference_type:
    reference_id:
  - url: https://spear-shield.notion.site/Unauthenticated-Remote-Code-Execution-via-Unrestricted-JDBC-Connection-87a958a4874044199cbb86422d1f6068
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45758
    reference_type:
    reference_id: CVE-2024-45758
  - url: https://github.com/advisories/GHSA-hrmc-jmp7-mpm2
    reference_type:
    reference_id: GHSA-hrmc-jmp7-mpm2
