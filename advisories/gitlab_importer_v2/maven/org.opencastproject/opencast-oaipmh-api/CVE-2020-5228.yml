advisory_id: maven/org.opencastproject/opencast-oaipmh-api/CVE-2020-5228
datasource_id: gitlab_importer_v2/maven/org.opencastproject/opencast-oaipmh-api/CVE-2020-5228
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opencastproject/opencast-oaipmh-api/CVE-2020-5228.yml
aliases:
  - CVE-2020-5228
  - GHSA-6f54-3qr9-pjgj
summary: |
  Missing Authorization
  Opencast before 8.1 and 7.6 allows unauthorized public access to all media and metadata by default via OAI-PMH. OAI-PMH is part of the default workflow and is activated by default, requiring active user intervention of users to protect media. This leads to users unknowingly handing out public access to events without their knowledge. The problem has been addressed in Opencast 7.6 and 8.1 where the OAI-PMH endpoint is configured to require users with `ROLE_ADMIN` by default. In addition to this, Opencast 9 removes the OAI-PMH publication from the default workflow, making the publication a conscious decision users have to make by updating their workflows.
impacted_packages:
  - purl: pkg:maven/org.opencastproject/opencast-oaipmh-api
    affected_versions: vers:maven/<7.6|>=8.0|<8.1
    fixed_versions: vers:maven/7.6|8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opencastproject/opencast-oaipmh-api/CVE-2020-5228.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opencastproject/opencast-oaipmh-api/CVE-2020-5228.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-862
references:
  - url: https://github.com/opencast/opencast/blob/1fb812c7810c78f09f29a7f455ff920417924307/etc/security/mh_default_org.xml#L271-L276
    reference_type:
    reference_id:
  - url: https://github.com/opencast/opencast/security/advisories/GHSA-6f54-3qr9-pjgj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5228
    reference_type:
    reference_id: CVE-2020-5228
  - url: https://github.com/advisories/GHSA-6f54-3qr9-pjgj
    reference_type:
    reference_id: GHSA-6f54-3qr9-pjgj
