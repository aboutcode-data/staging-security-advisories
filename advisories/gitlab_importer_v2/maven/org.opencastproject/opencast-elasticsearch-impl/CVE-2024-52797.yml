advisory_id: maven/org.opencastproject/opencast-elasticsearch-impl/CVE-2024-52797
datasource_id: gitlab_importer_v2/maven/org.opencastproject/opencast-elasticsearch-impl/CVE-2024-52797
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opencastproject/opencast-elasticsearch-impl/CVE-2024-52797.yml
aliases:
  - CVE-2024-52797
  - GHSA-jh6x-7xfg-9cq2
summary: |
  Searching Opencast may cause a denial of service
  First noticed in Opencast 13 and 14, Opencast's Elasticsearch integration may generate syntactically invalid Elasticsearch queries in relation to previously acceptable search queries.  From Opencast version 11.4 and newer, Elasticsearch queries are retried a configurable number of times in the case of error to handle temporary losses of connection to Elasticsearch.  These invalid queries would fail, causing the retry mechanism to begin requerying with the same syntactically invalid query immediately, in an infinite loop.  This causes a massive increase in log size which can in some cases cause a denial of service due to disk exhaustion.
impacted_packages:
  - purl: pkg:maven/org.opencastproject/opencast-elasticsearch-impl
    affected_versions: vers:maven/>=11.4|<13.10|>=14.0|<14.3|>=15.0|<16.7
    fixed_versions: vers:maven/13.10|14.3|16.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opencastproject/opencast-elasticsearch-impl/CVE-2024-52797.yml
weaknesses:
  - CWE-770
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/opencast/opencast
    reference_type:
    reference_id:
  - url: https://github.com/opencast/opencast/blob/7ad05f72814f057130122904015d471cfe5f4c58/docs/guides/admin/docs/changelog/older-versions/opencast-16.md?plain=1#L74
    reference_type:
    reference_id:
  - url: https://github.com/opencast/opencast/commit/3d5ebd163674eb18e070f52b64a18f92188f98c3
    reference_type:
    reference_id:
  - url: https://github.com/opencast/opencast/pull/5033
    reference_type:
    reference_id:
  - url: https://github.com/opencast/opencast/pull/5150
    reference_type:
    reference_id:
  - url: https://github.com/opencast/opencast/security/advisories/GHSA-jh6x-7xfg-9cq2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-52797
    reference_type:
    reference_id: CVE-2024-52797
  - url: https://github.com/advisories/GHSA-jh6x-7xfg-9cq2
    reference_type:
    reference_id: GHSA-jh6x-7xfg-9cq2
