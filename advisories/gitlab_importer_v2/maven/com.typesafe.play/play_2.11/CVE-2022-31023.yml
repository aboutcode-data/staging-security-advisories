advisory_id: maven/com.typesafe.play/play_2.11/CVE-2022-31023
datasource_id: gitlab_importer_v2/maven/com.typesafe.play/play_2.11/CVE-2022-31023
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.typesafe.play/play_2.11/CVE-2022-31023.yml
aliases:
  - CVE-2022-31023
  - GHSA-p9p4-97g9-wcrh
summary: |
  Generation of Error Message Containing Sensitive Information
  Play Framework is a web framework for Java and Scala. Verions prior to 2.8.16 is vulnerable to generation of error messages containing sensitive information. Play Framework, when run in dev mode, shows verbose errors for easy debugging, including an exception stack trace. Play does this by configuring its `DefaultHttpErrorHandler` to do so based on the application mode. In its Scala API Play also provides a static object `DefaultHttpErrorHandler` that is configured to always show verbose errors. This is used as a default value in some Play APIs, so it is possible to inadvertently use this version in production. It is also possible to improperly configure the `DefaultHttpErrorHandler` object instance as the injected error handler. Both of these situations could result in verbose errors displaying to users in a production application, which could expose sensitive information from the application. In particular, the constructor for `CORSFilter` and `apply` method for `CORSActionBuilder` use the static object `DefaultHttpErrorHandler` as a default value. This is patched in Play Framework 2.8.16. The `DefaultHttpErrorHandler` object has been changed to use the prod-mode behavior, and `DevHttpErrorHandler` has been introduced for the dev-mode behavior. A workaround is available. When constructing a `CORSFilter` or `CORSActionBuilder`, ensure that a properly-configured error handler is passed. Generally this should be done by using the `HttpErrorHandler` instance provided through dependency injection or through Play's `BuiltInComponents`. Ensure that the application is not using the `DefaultHttpErrorHandler` static object in any code that may be run in production.
impacted_packages:
  - purl: pkg:maven/com.typesafe.play/play_2.11
    affected_versions: vers:maven/<2.8.16
    fixed_versions: vers:maven/2.8.16
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.typesafe.play/play_2.11/CVE-2022-31023.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.typesafe.play/play_2.11/CVE-2022-31023.yml
weaknesses:
  - CWE-209
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/playframework/playframework/pull/11305
    reference_type:
    reference_id:
  - url: https://github.com/playframework/playframework/releases/tag/2.8.16
    reference_type:
    reference_id:
  - url: https://github.com/playframework/playframework/security/advisories/GHSA-p9p4-97g9-wcrh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31023
    reference_type:
    reference_id: CVE-2022-31023
