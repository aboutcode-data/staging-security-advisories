advisory_id: maven/org.apache.kafka/kafka_2.12/CVE-2025-27818
datasource_id: gitlab_importer_v2/maven/org.apache.kafka/kafka_2.12/CVE-2025-27818
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.kafka/kafka_2.12/CVE-2025-27818.yml
aliases:
  - CVE-2025-27818
  - GHSA-76qp-h5mr-frr4
summary: |
  Apache Kafka Deserialization of Untrusted Data vulnerability
  A possible security vulnerability has been identified in Apache Kafka.
  This requires access to a alterConfig to the cluster resource, or Kafka Connect worker, and the ability to create/modify connectors on it with an arbitrary Kafka client SASL JAAS config
  and a SASL-based security protocol, which has been possible on Kafka clusters since Apache Kafka 2.0.0 (Kafka Connect 2.3.0).
  When configuring the broker via config file or AlterConfig command, or connector via the Kafka Kafka Connect REST API, an authenticated operator can set the `sasl.jaas.config`
  property for any of the connector's Kafka clients to "com.sun.security.auth.module.LdapLoginModule", which can be done via the
  `producer.override.sasl.jaas.config`, `consumer.override.sasl.jaas.config`, or `admin.override.sasl.jaas.config` properties.
  This will allow the server to connect to the attacker's LDAP server
  and deserialize the LDAP response, which the attacker can use to execute java deserialization gadget chains on the Kafka connect server.
  Attacker can cause unrestricted deserialization of untrusted data (or) RCE vulnerability when there are gadgets in the classpath.

  Since Apache Kafka 3.0.0, users are allowed to specify these properties in connector configurations for Kafka Connect clusters running with out-of-the-box
  configurations. Before Apache Kafka 3.0.0, users may not specify these properties unless the Kafka Connect cluster has been reconfigured with a connector
  client override policy that permits them.

  Since Apache Kafka 3.9.1/4.0.0, we have added a system property ("-Dorg.apache.kafka.disallowed.login.modules") to disable the problematic login modules usage
  in SASL JAAS configuration. Also by default "com.sun.security.auth.module.JndiLoginModule,com.sun.security.auth.module.LdapLoginModule" are disabled in Apache Kafka Connect 3.9.1/4.0.0.

  We advise the Kafka users to validate connector configurations and only allow trusted LDAP configurations. Also examine connector dependencies for
  vulnerable versions and either upgrade their connectors, upgrading that specific dependency, or removing the connectors as options for remediation. Finally,
  in addition to leveraging the "org.apache.kafka.disallowed.login.modules" system property, Kafka Connect users can also implement their own connector
  client config override policy, which can be used to control which Kafka client properties can be overridden directly in a connector config and which cannot.
impacted_packages:
  - purl: pkg:maven/org.apache.kafka/kafka_2.12
    affected_versions: vers:maven/>=2.3.0|<3.9.1
    fixed_versions: vers:maven/3.9.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.kafka/kafka_2.12/CVE-2025-27818.yml
weaknesses:
  - CWE-1035
  - CWE-502
  - CWE-937
references:
  - url: https://github.com/apache/kafka
    reference_type:
    reference_id:
  - url: https://kafka.apache.org/cve-list
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-27818
    reference_type:
    reference_id: CVE-2025-27818
  - url: https://github.com/advisories/GHSA-76qp-h5mr-frr4
    reference_type:
    reference_id: GHSA-76qp-h5mr-frr4
