advisory_id: maven/org.apache.kafka/kafka-clients/CVE-2025-27817
datasource_id: gitlab_importer_v2/maven/org.apache.kafka/kafka-clients/CVE-2025-27817
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.kafka/kafka-clients/CVE-2025-27817.yml
aliases:
  - CVE-2025-27817
  - GHSA-vgq5-3255-v292
summary: |
  Apache Kafka Client Arbitrary File Read and Server Side Request Forgery Vulnerability
  A possible arbitrary file read and SSRF vulnerability has been identified in Apache Kafka Client. Apache Kafka Clients accept configuration data for setting the SASL/OAUTHBEARER connection with the brokers, including "sasl.oauthbearer.token.endpoint.url" and "sasl.oauthbearer.jwks.endpoint.url". Apache Kafka allows clients to read an arbitrary file and return the content in the error log, or sending requests to an unintended location. In applications where Apache Kafka Clients configurations can be specified by an untrusted party, attackers may use the "sasl.oauthbearer.token.endpoint.url" and "sasl.oauthbearer.jwks.endpoint.url" configuratin to read arbitrary contents of the disk and environment variables or make requests to an unintended location. In particular, this flaw may be used in Apache Kafka Connect to escalate from REST API access to filesystem/environment/URL access, which may be undesirable in certain environments, including SaaS products.

  Since Apache Kafka 3.9.1/4.0.0, we have added a system property ("-Dorg.apache.kafka.sasl.oauthbearer.allowed.urls") to set the allowed urls in SASL JAAS configuration. In 3.9.1, it accepts all urls by default for backward compatibility. However in 4.0.0 and newer, the default value is empty list and users have to set the allowed urls explicitly.
impacted_packages:
  - purl: pkg:maven/org.apache.kafka/kafka-clients
    affected_versions: vers:maven/>=3.1.0|<3.9.1
    fixed_versions: vers:maven/3.9.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.kafka/kafka-clients/CVE-2025-27817.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/apache/kafka
    reference_type:
    reference_id:
  - url: https://kafka.apache.org/cve-list
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-27817
    reference_type:
    reference_id: CVE-2025-27817
  - url: https://github.com/advisories/GHSA-vgq5-3255-v292
    reference_type:
    reference_id: GHSA-vgq5-3255-v292
