advisory_id: maven/org.openhab.ui.bundles/org.openhab.ui.cometvisu/CVE-2024-42467
datasource_id: gitlab_importer_v2/maven/org.openhab.ui.bundles/org.openhab.ui.cometvisu/CVE-2024-42467
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.openhab.ui.bundles/org.openhab.ui.cometvisu/CVE-2024-42467.yml
aliases:
  - CVE-2024-42467
  - GHSA-v7gr-mqpj-wwh3
summary: |
  CometVisu Backend for openHAB affected by SSRF/XSS
  The [proxy endpoint](https://github.com/openhab/openhab-webui/blob/1c03c60f84388b9d7da0231df2d4ebb1e17d3fcf/bundles/org.openhab.ui.cometvisu/src/main/java/org/openhab/ui/cometvisu/internal/backend/rest/ProxyResource.java#L83) of openHAB's CometVisu add-on can be accessed without authentication. This proxy-feature can be exploited as Server-Side Request Forgery (SSRF) to induce GET HTTP requests to internal-only servers, in case openHAB is exposed in a non-private network.

  Furthermore, this proxy-feature can also be exploited as a Cross-Site Scripting (XSS) vulnerability, as an attacker is able to re-route a request to their server and return a page with malicious JavaScript code. Since the browser receives this data directly from the openHAB CometVisu UI, this JavaScript code will be executed with the origin of the CometVisu UI. This allows an attacker to exploit call endpoints on an openHAB server even if the openHAB server is located in a private network. (e.g. by sending an openHAB admin a link that proxies malicious JavaScript.)

  This vulnerability was discovered with the help of CodeQL's [Server-side request forgery](https://codeql.github.com/codeql-query-help/java/java-ssrf/) query.
impacted_packages:
  - purl: pkg:maven/org.openhab.ui.bundles/org.openhab.ui.cometvisu
    affected_versions: vers:maven/<4.2.1
    fixed_versions: vers:maven/4.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.openhab.ui.bundles/org.openhab.ui.cometvisu/CVE-2024-42467.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/openhab/openhab-webui
    reference_type:
    reference_id:
  - url: https://github.com/openhab/openhab-webui/blob/1c03c60f84388b9d7da0231df2d4ebb1e17d3fcf/bundles/org.openhab.ui.cometvisu/src/main/java/org/openhab/ui/cometvisu/internal/backend/rest/ProxyResource.java#L83
    reference_type:
    reference_id:
  - url: https://github.com/openhab/openhab-webui/commit/630e8525835c698cf58856aa43782d92b18087f2
    reference_type:
    reference_id:
  - url: https://github.com/openhab/openhab-webui/security/advisories/GHSA-v7gr-mqpj-wwh3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42467
    reference_type:
    reference_id: CVE-2024-42467
  - url: https://github.com/advisories/GHSA-v7gr-mqpj-wwh3
    reference_type:
    reference_id: GHSA-v7gr-mqpj-wwh3
