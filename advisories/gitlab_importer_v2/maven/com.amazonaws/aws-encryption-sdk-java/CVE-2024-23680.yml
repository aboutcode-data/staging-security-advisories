advisory_id: maven/com.amazonaws/aws-encryption-sdk-java/CVE-2024-23680
datasource_id: gitlab_importer_v2/maven/com.amazonaws/aws-encryption-sdk-java/CVE-2024-23680
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.amazonaws/aws-encryption-sdk-java/CVE-2024-23680.yml
aliases:
  - CVE-2024-23680
  - GHSA-55xh-53m6-936r
summary: |
  Improper Verification of Cryptographic Signature in aws-encryption-sdk-java
  This advisory addresses several LOW severity issues with streaming signed messages and restricting processing of certain types of invalid messages.

  This update addresses an issue where certain invalid ECDSA signatures incorrectly passed validation. These signatures provide defense in depth and there is no impact on the integrity of decrypted plaintext.

  This ESDK supports a streaming mode where callers may stream the plaintext of signed messages before the ECDSA signature is validated. In addition to these signatures, the ESDK uses AES-GCM encryption and all plaintext is verified before being released to a caller. There is no impact on the integrity of the ciphertext or decrypted plaintext, however some callers may rely on the the ECDSA signature for non-repudiation. Without validating the ECDSA signature, an actor with trusted KMS permissions to decrypt a message may also be able to encrypt messages. This update introduces a new API for callers who wish to stream only unsigned messages.

  For customers who process ESDK messages from untrusted sources, this update also introduces a new configuration to limit the number of Encrypted Data Keys (EDKs) that the ESDK will attempt to process per message. This configuration provides customers with a way to limit the number of AWS KMS Decrypt API calls that the ESDK will make per message. This setting will reject messages with more EDKs than the configured limit.

  Finally, this update adds early rejection of invalid messages with certain invalid combinations of algorithm suite and header data.
impacted_packages:
  - purl: pkg:maven/com.amazonaws/aws-encryption-sdk-java
    affected_versions: vers:maven/<1.9.0|>=2.0.0|<2.2.0
    fixed_versions: vers:maven/1.9.0|2.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.amazonaws/aws-encryption-sdk-java/CVE-2024-23680.yml
weaknesses:
  - CWE-347
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/advisories/GHSA-55xh-53m6-936r
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-encryption-sdk-java
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-encryption-sdk-java/security/advisories/GHSA-55xh-53m6-936r
    reference_type:
    reference_id:
  - url: https://vulncheck.com/advisories/vc-advisory-GHSA-55xh-53m6-936r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23680
    reference_type:
    reference_id: CVE-2024-23680
