advisory_id: maven/com.hubspot.jinjava/jinjava/CVE-2025-59340
datasource_id: gitlab_importer_v2/maven/com.hubspot.jinjava/jinjava/CVE-2025-59340
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.hubspot.jinjava/jinjava/CVE-2025-59340.yml
aliases:
  - CVE-2025-59340
  - GHSA-m49c-g9wr-hv6v
summary: |
  jinjava has Sandbox Bypass via JavaType-Based Deserialization
  jinjavaâ€™s current sandbox restrictions prevent direct access to dangerous methods such as `getClass()`, and block instantiation of Class objects. However, these protections can be bypassed.

  By using mapper.getTypeFactory().constructFromCanonical(), it is possible to instruct the underlying ObjectMapper to deserialize attacker-controlled input into arbitrary classes. This enables the creation of semi-arbitrary class instances without directly invoking restricted methods or class literals.

  As a result, an attacker can escape the sandbox and instantiate classes such as java.net.URL, opening up the ability to access local files and URLs(e.g., file:///etc/passwd). With further chaining, this primitive can potentially lead to remote code execution (RCE).
impacted_packages:
  - purl: pkg:maven/com.hubspot.jinjava/jinjava
    affected_versions:
    fixed_versions: vers:maven/2.7.5|2.8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.hubspot.jinjava/jinjava/CVE-2025-59340.yml
weaknesses:
  - CWE-1336
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/HubSpot/jinjava
    reference_type:
    reference_id:
  - url: https://github.com/HubSpot/jinjava/commit/66df351e7e8ad71ca04dcacb4b65782af820b8b1
    reference_type:
    reference_id:
  - url: https://github.com/HubSpot/jinjava/releases/tag/jinjava-2.7.5
    reference_type:
    reference_id:
  - url: https://github.com/HubSpot/jinjava/releases/tag/jinjava-2.8.1
    reference_type:
    reference_id:
  - url: https://github.com/HubSpot/jinjava/security/advisories/GHSA-m49c-g9wr-hv6v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59340
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-m49c-g9wr-hv6v
    reference_type:
    reference_id: GHSA-m49c-g9wr-hv6v
