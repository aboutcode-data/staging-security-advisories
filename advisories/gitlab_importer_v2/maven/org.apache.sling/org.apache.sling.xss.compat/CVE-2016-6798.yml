advisory_id: maven/org.apache.sling/org.apache.sling.xss.compat/CVE-2016-6798
datasource_id: gitlab_importer_v2/maven/org.apache.sling/org.apache.sling.xss.compat/CVE-2016-6798
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.sling/org.apache.sling.xss.compat/CVE-2016-6798.yml
aliases:
  - CVE-2016-6798
  - GHSA-7g54-vgp6-jj5w
summary: |
  Improper Restriction of XML External Entity Reference
  In the XSS Protection API module before 1.0.12 in Apache Sling, the method XSS.getValidXML() uses an insecure SAX parser to validate the input string, which allows for XXE attacks in all scripts which use this method to validate user input, potentially allowing an attacker to read sensitive data on the filesystem, perform same-site-request-forgery (SSRF), port-scanning behind the firewall or DoS the application.
impacted_packages:
  - purl: pkg:maven/org.apache.sling/org.apache.sling.xss.compat
    affected_versions: vers:maven/<1.1.0
    fixed_versions: vers:maven/1.1.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.sling/org.apache.sling.xss.compat/CVE-2016-6798.yml
  - score:
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.sling/org.apache.sling.xss.compat/CVE-2016-6798.yml
weaknesses:
  - CWE-611
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/apache/sling-org-apache-sling-xss/commit/de32b144ad2be3367559f6184d560db42a220529
    reference_type:
    reference_id:
  - url: https://github.com/jensdietrich/xshady-release/tree/main/CVE-2016-6798
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/b72c3a511592ec70729b3ec2d29302b6ce87bbeab62d4745617a6bd0@%3Cdev.sling.apache.org%3E
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/99873
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2016-6798
    reference_type:
    reference_id: CVE-2016-6798
  - url: https://github.com/advisories/GHSA-7g54-vgp6-jj5w
    reference_type:
    reference_id: GHSA-7g54-vgp6-jj5w
