advisory_id: maven/org.neo4j/neo4j-shell/CVE-2021-34371
datasource_id: gitlab_importer_v2/maven/org.neo4j/neo4j-shell/CVE-2021-34371
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.neo4j/neo4j-shell/CVE-2021-34371.yml
aliases:
  - CVE-2021-34371
  - GHSA-pc4w-8v5j-29w9
summary: |
  Deserialization of Untrusted Data
  Neo4j through 3.4.18 (with the shell server enabled) exposes an RMI service that arbitrarily deserializes Java objects, e.g., through setSessionVariable. An attacker can abuse this for remote code execution because there are dependencies with exploitable gadget chains.
impacted_packages:
  - purl: pkg:maven/org.neo4j/neo4j-shell
    affected_versions: vers:maven/<3.5.0
    fixed_versions: vers:maven/3.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.neo4j/neo4j-shell/CVE-2021-34371.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.neo4j/neo4j-shell/CVE-2021-34371.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-502
  - CWE-78
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-34371
    reference_type:
    reference_id: CVE-2021-34371
  - url: https://github.com/advisories/GHSA-pc4w-8v5j-29w9
    reference_type:
    reference_id: GHSA-pc4w-8v5j-29w9
