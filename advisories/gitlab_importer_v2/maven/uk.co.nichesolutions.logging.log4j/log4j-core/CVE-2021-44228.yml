advisory_id: maven/uk.co.nichesolutions.logging.log4j/log4j-core/CVE-2021-44228
datasource_id: gitlab_importer_v2/maven/uk.co.nichesolutions.logging.log4j/log4j-core/CVE-2021-44228
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/uk.co.nichesolutions.logging.log4j/log4j-core/CVE-2021-44228.yml
aliases:
  - CVE-2021-44228
  - GHSA-jfh8-c2jp-5v3q
summary: |
  Remote code injection in Log4j
  Log4j versions prior to 2.16.0 are subject to a remote code execution vulnerability via the ldap JNDI parser.
  As per [Apache's Log4j security guide](https://logging.apache.org/log4j/2.x/security.html): Apache Log4j2 <=2.14.1 JNDI features used in configuration, log messages, and parameters do not protect against attacker controlled LDAP and other JNDI related endpoints. An attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled. From log4j 2.16.0, this behavior has been disabled by default.

  Log4j version 2.15.0 contained an earlier fix for the vulnerability, but that patch did not disable attacker-controlled JNDI lookups in all situations. For more information, see the `Updated advice for version 2.16.0` section of this advisory.
impacted_packages:
  - purl: pkg:maven/uk.co.nichesolutions.logging.log4j/log4j-core
    affected_versions:
    fixed_versions: vers:maven/
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/uk.co.nichesolutions.logging.log4j/log4j-core/CVE-2021-44228.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/uk.co.nichesolutions.logging.log4j/log4j-core/CVE-2021-44228.yml
weaknesses:
  - CWE-1035
  - CWE-917
  - CWE-400
  - CWE-20
  - CWE-502
  - CWE-937
references:
  - url: https://cert-portal.siemens.com/productcert/pdf/ssa-397453.pdf
    reference_type:
    reference_id:
  - url: https://cert-portal.siemens.com/productcert/pdf/ssa-479842.pdf
    reference_type:
    reference_id:
  - url: https://cert-portal.siemens.com/productcert/pdf/ssa-661247.pdf
    reference_type:
    reference_id:
  - url: https://cert-portal.siemens.com/productcert/pdf/ssa-714170.pdf
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-7rjr-3q55-vv33
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-jfh8-c2jp-5v3q
    reference_type:
    reference_id:
  - url: https://github.com/apache/logging-log4j2
    reference_type:
    reference_id:
  - url: https://github.com/apache/logging-log4j2/pull/608
    reference_type:
    reference_id:
  - url: https://github.com/cisagov/log4j-affected-db
    reference_type:
    reference_id:
  - url: https://github.com/cisagov/log4j-affected-db/blob/develop/SOFTWARE-LIST.md
    reference_type:
    reference_id:
  - url: https://github.com/github/advisory-database/pull/5501
    reference_type:
    reference_id:
  - url: https://github.com/nu11secur1ty/CVE-mitre/tree/main/CVE-2021-44228
    reference_type:
    reference_id:
  - url: https://github.com/tangxiaofeng7/apache-log4j-poc
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/LOG4J2-3198
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/LOG4J2-3201
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/LOG4J2-3214
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/LOG4J2-3221
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2021/12/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/M5CSVUNV4HWZZXGOKNSK6L7RPM7BOKIB
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VU57UJDCFIASIO35GC55JMKSRXJMCDFM
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/M5CSVUNV4HWZZXGOKNSK6L7RPM7BOKIB
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VU57UJDCFIASIO35GC55JMKSRXJMCDFM
    reference_type:
    reference_id:
  - url: https://logging.apache.org/log4j/2.x/changes-report.html#a2.15.0
    reference_type:
    reference_id:
  - url: https://logging.apache.org/log4j/2.x/manual/lookups.html#JndiLookup
    reference_type:
    reference_id:
  - url: https://logging.apache.org/log4j/2.x/manual/migration.html
    reference_type:
    reference_id:
  - url: https://logging.apache.org/log4j/2.x/security.html
    reference_type:
    reference_id:
  - url: https://msrc-blog.microsoft.com/2021/12/11/microsofts-response-to-cve-2021-44228-apache-log4j2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-44228
    reference_type:
    reference_id:
  - url: https://packetstormsecurity.com/files/165673/UniFi-Network-Application-Unauthenticated-Log4Shell-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: https://packetstormsecurity.com/files/167794/Open-Xchange-App-Suite-7.10.x-Cross-Site-Scripting-Command-Injection.html
    reference_type:
    reference_id:
  - url: https://packetstormsecurity.com/files/167917/MobileIron-Log4Shell-Remote-Command-Execution.html
    reference_type:
    reference_id:
  - url: https://packetstormsecurity.com/files/171626/AD-Manager-Plus-7122-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0032
    reference_type:
    reference_id:
  - url: https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-log4j-qRuKNEbd
    reference_type:
    reference_id:
  - url: https://seclists.org/fulldisclosure/2022/Dec/2
    reference_type:
    reference_id:
  - url: https://seclists.org/fulldisclosure/2022/Jul/11
    reference_type:
    reference_id:
  - url: https://seclists.org/fulldisclosure/2022/Mar/23
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20211210-0007
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT213189
    reference_type:
    reference_id:
  - url: https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-log4j-qRuKNEbd
    reference_type:
    reference_id:
  - url: https://twitter.com/kurtseifried/status/1469345530182455296
    reference_type:
    reference_id:
  - url: https://www.bentley.com/en/common-vulnerability-exposure/be-2022-0001
    reference_type:
    reference_id:
  - url: https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2021-44228
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2021/dsa-5020
    reference_type:
    reference_id:
  - url: https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00646.html
    reference_type:
    reference_id:
  - url: https://www.kb.cert.org/vuls/id/930724
    reference_type:
    reference_id:
  - url: https://www.nu11secur1ty.com/2021/12/cve-2021-44228.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/alert-cve-2021-44228.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuapr2022.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpujan2022.html
    reference_type:
    reference_id:
