advisory_id: maven/org.apache.zookeeper/zookeeper/CVE-2025-58457
datasource_id: gitlab_importer_v2/maven/org.apache.zookeeper/zookeeper/CVE-2025-58457
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.zookeeper/zookeeper/CVE-2025-58457.yml
aliases:
  - CVE-2025-58457
  - GHSA-2hmj-97jw-28jh
summary: |
  Apache ZooKeeper: Insufficient Permission Check in AdminServer Snapshot/Restore Commands
  Improper permission checks in the AdminServer allow an authenticated client with insufficient privileges to invoke the `snapshot` and `restore` commands. The intended requirement is authentication and authorization on the root path (`/`) with **ALL** permission for these operations; however, affected versions permit invocation without that level of authorization. The primary risk is disclosure of cluster state via snapshots to a lesser-privileged client.

  *   **Affected:** `org.apache.zookeeper:zookeeper` 3.9.0 through 3.9.3.
  *   **Fixed:** 3.9.4 (ZOOKEEPER-4964 “check permissions individually during admin server auth”).
  *   **Mitigations:**
  *   Disable both commands (`admin.snapshot.enabled`, `admin.restore.enabled`).
  *   Disable AdminServer (`admin.enableServer`).
  *   Ensure the root ACL is not open; note that ZooKeeper ACLs are not recursive.
  *   Upgrade to 3.9.4.
impacted_packages:
  - purl: pkg:maven/org.apache.zookeeper/zookeeper
    affected_versions: vers:maven/>=3.9.0|<3.9.4
    fixed_versions: vers:maven/3.9.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.zookeeper/zookeeper/CVE-2025-58457.yml
weaknesses:
  - CWE-280
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/apache/zookeeper
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/r5yol0kkhx2fzw22pxk1ozwm3oc6yxrx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-58457
    reference_type:
    reference_id:
  - url: https://zookeeper.apache.org/doc/current/zookeeperSnapshotAndRestore.html
    reference_type:
    reference_id:
  - url: https://zookeeper.apache.org/doc/r3.9.4/releasenotes.html
    reference_type:
    reference_id:
  - url: https://zookeeper.apache.org/security.html#CVE-2025-58457
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-2hmj-97jw-28jh
    reference_type:
    reference_id: GHSA-2hmj-97jw-28jh
