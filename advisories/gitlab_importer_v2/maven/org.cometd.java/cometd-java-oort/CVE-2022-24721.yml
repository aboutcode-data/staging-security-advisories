advisory_id: maven/org.cometd.java/cometd-java-oort/CVE-2022-24721
datasource_id: gitlab_importer_v2/maven/org.cometd.java/cometd-java-oort/CVE-2022-24721
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.cometd.java/cometd-java-oort/CVE-2022-24721.yml
aliases:
  - CVE-2022-24721
  - GHSA-rjmq-6v55-4rjv
summary: |
  Incorrect Authorization
  CometD is a scalable comet implementation for web messaging. In any version prior to 5.0.11, 6.0.6, and 7.0.6, internal usage of Oort and Seti channels is improperly authorized, so any remote user could subscribe and publish to those channels. By subscribing to those channels, a remote user may be able to watch cluster-internal traffic that contains other users' (possibly sensitive) data. By publishing to those channels, a remote user may be able to create/modify/delete other user's data and modify the cluster structure. A fix is available in versions 5.0.11, 6.0.6, and 7.0.6. As a workaround, install a custom `SecurityPolicy` that forbids subscription and publishing to remote, non-Oort, sessions on Oort and Seti channels.
impacted_packages:
  - purl: pkg:maven/org.cometd.java/cometd-java-oort
    affected_versions: vers:maven/<5.0.11|>=6.0.0|<6.0.6|>=7.0.0|<7.0.6
    fixed_versions: vers:maven/5.0.11|6.0.6|7.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.cometd.java/cometd-java-oort/CVE-2022-24721.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.cometd.java/cometd-java-oort/CVE-2022-24721.yml
weaknesses:
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/cometd/cometd/commit/bb445a143fbf320f17c62e340455cd74acfb5929
    reference_type:
    reference_id:
  - url: https://github.com/cometd/cometd/issues/1146
    reference_type:
    reference_id:
  - url: https://github.com/cometd/cometd/security/advisories/GHSA-rjmq-6v55-4rjv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24721
    reference_type:
    reference_id: CVE-2022-24721
  - url: https://github.com/advisories/GHSA-rjmq-6v55-4rjv
    reference_type:
    reference_id: GHSA-rjmq-6v55-4rjv
