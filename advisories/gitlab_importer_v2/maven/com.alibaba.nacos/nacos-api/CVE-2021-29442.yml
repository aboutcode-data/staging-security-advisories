advisory_id: maven/com.alibaba.nacos/nacos-api/CVE-2021-29442
datasource_id: gitlab_importer_v2/maven/com.alibaba.nacos/nacos-api/CVE-2021-29442
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.alibaba.nacos/nacos-api/CVE-2021-29442.yml
aliases:
  - CVE-2021-29442
summary: |
  Missing Authentication for Critical Function
  Nacos is a platform designed for dynamic service discovery and configuration and service management. In Nacos, the `ConfigOpsController` lets the user perform management operations like querying the database or even wiping it out. While the `/data/remove` endpoint is properly protected with the `@Secured` annotation, the `/derby` endpoint is not protected and can be openly accessed by unauthenticated users. These endpoints are only valid when using embedded storage (derby DB) so this issue should not affect those installations using external storage (e.g. mysql).
impacted_packages:
  - purl: pkg:maven/com.alibaba.nacos/nacos-api
    affected_versions: vers:maven/<1.4.1
    fixed_versions: vers:maven/1.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.alibaba.nacos/nacos-api/CVE-2021-29442.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.alibaba.nacos/nacos-api/CVE-2021-29442.yml
weaknesses:
  - CWE-306
  - CWE-1035
  - CWE-937
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29442
    reference_type:
    reference_id: CVE-2021-29442
