advisory_id: maven/io.crate/crate/CVE-2024-37309
datasource_id: gitlab_importer_v2/maven/io.crate/crate/CVE-2024-37309
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.crate/crate/CVE-2024-37309.yml
aliases:
  - CVE-2024-37309
  - GHSA-x268-qpg6-w9g2
summary: |
  CrateDB has a Client initialized Session-Renegotiation DoS
  **Summary**
  Client-Initiated TLS Renegotiation Denial of Service (DoS) Vulnerability at Port 4200

  **Details**
  A high-risk vulnerability has been identified where the TLS endpoint (port 4200) permits client-initiated renegotiation. In this scenario, an attacker can exploit this feature to repeatedly request renegotiation of security parameters during an ongoing TLS session. This flaw could lead to excessive consumption of CPU resources, resulting in potential server overload and service disruption. The vulnerability was confirmed using an openssl client where the command 'R' initiates renegotiation, followed by the server confirming with 'RENEGOTIATING'.

  **PoC**
  1. Connect to the TLS server on port 4200 using an openssl client.
  2. Initiate a TLS session.
  3. Send the renegotiation command ('R') multiple times.
  4. Observe the server response to confirm renegotiation.

  **Impact**
  This vulnerability allows an attacker to perform a denial of service attack by exhausting server CPU resources through repeated TLS renegotiations. This impacts the availability of services running on the affected server, posing a significant risk to operational stability and security.


  TLS 1.3 explicitly forbids renegotiation, since it closes a window of opportunity for an attack.
impacted_packages:
  - purl: pkg:maven/io.crate/crate
    affected_versions: vers:maven/<5.7.2
    fixed_versions: vers:maven/5.7.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.crate/crate/CVE-2024-37309.yml
weaknesses:
  - CWE-770
  - CWE-1035
  - CWE-937
references:
  - url: https://cratedb.com/docs/crate/reference/en/latest/appendices/release-notes/5.7.2.html
    reference_type:
    reference_id:
  - url: https://github.com/crate/crate
    reference_type:
    reference_id:
  - url: https://github.com/crate/crate/commit/1dde03bdf031a20886065195527e368e4a3218b3
    reference_type:
    reference_id:
  - url: https://github.com/crate/crate/security/advisories/GHSA-x268-qpg6-w9g2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37309
    reference_type:
    reference_id: CVE-2024-37309
  - url: https://github.com/advisories/GHSA-x268-qpg6-w9g2
    reference_type:
    reference_id: GHSA-x268-qpg6-w9g2
