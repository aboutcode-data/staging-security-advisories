advisory_id: maven/org.xwiki.platform/xwiki-platform-search-solr-api/CVE-2025-32971
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-search-solr-api/CVE-2025-32971
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-search-solr-api/CVE-2025-32971.yml
aliases:
  - CVE-2025-32971
  - GHSA-987p-r3jc-8c8v
summary: |
  Solr script service doesn't take dropped programming right into account
  The Solr script service that is accessible in XWiki's scripting API normally requires programming right to be called. Due to using the wrong API for checking rights, it doesn't take the fact into account that programming rights might have been dropped by calling `$xcontext.dropPermissions()`. If some code relies on this for the safety of executing Velocity code with the wrong author context, this could allow a user with script right to either cause a high load by indexing documents or to temporarily remove documents from the search index. We're not aware that this is exploitable in XWiki itself.

  To reproduce, a user with programming right can add the following XWiki syntax to a page:
  ```
  {{velocity}}
  $xcontext.dropPermissions()
  $services.solr.index('document:xwiki:Main.WebHome')
  {{/velocity}}
  ```

  This should trigger an error in XWiki's log, otherwise the installation is vulnerable.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-search-solr-api
    affected_versions: vers:maven/>=4.5.1|<15.10.13|>=16.0.0-rc-1|<16.4.4|>=16.5.0-rc-1|<16.8.0-rc-1
    fixed_versions: vers:maven/15.10.13|16.4.4|16.8.0-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-search-solr-api/CVE-2025-32971.yml
weaknesses:
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/6570f40f976aec82baf388b5239d1412cab238c9
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-987p-r3jc-8c8v
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22474
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32971
    reference_type:
    reference_id: CVE-2025-32971
  - url: https://github.com/advisories/GHSA-987p-r3jc-8c8v
    reference_type:
    reference_id: GHSA-987p-r3jc-8c8v
