advisory_id: maven/org.xwiki.platform/xwiki-platform-notifications-ui/CVE-2023-36469
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-notifications-ui/CVE-2023-36469
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-notifications-ui/CVE-2023-36469.yml
aliases:
  - CVE-2023-36469
  - GHSA-94pf-92hw-2hjc
summary: |
  Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')
  XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Any user who can edit their own user profile and notification settings can execute arbitrary script macros including Groovy and Python macros that allow remote code execution including unrestricted read and write access to all wiki contents. This has been patched in XWiki 14.10.6 and 15.2RC1. Users are advised to update. As a workaround the main security fix can be manually applied by patching the affected document `XWiki.Notifications.Code.NotificationRSSService`. This will break the link to the differences, though as this requires additional changes to Velocity templates as shown in the patch. While the default template is available in the instance and can be easily patched, the template for mentions is contained in a `.jar`-file and thus cannot be fixed without replacing that jar.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-notifications-ui
    affected_versions: vers:maven/>=9.6-rc-1|<14.10.6|>=15.0-rc-1|<15.2-rc-1
    fixed_versions: vers:maven/14.10.6|15.2-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-notifications-ui/CVE-2023-36469.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
  - CWE-74
references:
  - url: https://github.com/xwiki/xwiki-platform/commit/217e5bb7a657f2991b154a16ef4d5ae9c29ad39c
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/217e5bb7a657f2991b154a16ef4d5ae9c29ad39c#diff-7221a548809fa2ba34348556f4b5bd436463c559ebdf691197932ee7ce4478ca
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/217e5bb7a657f2991b154a16ef4d5ae9c29ad39c#diff-b261c6eac3108c3e6e734054c28a78f59d3439ab72fe8582dadf87670a0d15a4
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-94pf-92hw-2hjc
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20610
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-36469
    reference_type:
    reference_id: CVE-2023-36469
  - url: https://github.com/advisories/GHSA-94pf-92hw-2hjc
    reference_type:
    reference_id: GHSA-94pf-92hw-2hjc
