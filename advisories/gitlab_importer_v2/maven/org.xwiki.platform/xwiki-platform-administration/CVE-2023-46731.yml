advisory_id: maven/org.xwiki.platform/xwiki-platform-administration/CVE-2023-46731
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-administration/CVE-2023-46731
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-administration/CVE-2023-46731.yml
aliases:
  - CVE-2023-46731
  - GHSA-62pr-qqf7-hh89
summary: |
  Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')
  XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. XWiki does not properly escape the section URL parameter that is used in the code for displaying administration sections. This allows any user with read access to the document `XWiki.AdminSheet` (by default, everyone including unauthenticated users) to execute code including Groovy code. This impacts the confidentiality, integrity and availability of the whole XWiki instance. This vulnerability has been patched in XWiki 14.10.14, 15.6 RC1 and 15.5.1. Users are advised to upgrade. Users unablr to upgrade may apply the fix in commit `fec8e0e53f9` manually. Alternatively, to protect against attacks from unauthenticated users, view right for guests can be removed from this document (it is only needed for space and wiki admins).
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-administration
    affected_versions: vers:maven/<14.10.14
    fixed_versions: vers:maven/14.10.14
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-78
  - CWE-94
  - CWE-1035
  - CWE-937
  - CWE-95
references:
  - url: https://github.com/xwiki/xwiki-platform/commit/fec8e0e53f9fa2c3f1e568cc15b0e972727c803a
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/fec8e0e53f9fa2c3f1e568cc15b0e972727c803a#diff-6271f9be501f30b2ba55459eb451aee3413d34171ba8198a77c865306d174e23
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-62pr-qqf7-hh89
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-21110
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-46731
    reference_type:
    reference_id: CVE-2023-46731
  - url: https://github.com/advisories/GHSA-62pr-qqf7-hh89
    reference_type:
    reference_id: GHSA-62pr-qqf7-hh89
