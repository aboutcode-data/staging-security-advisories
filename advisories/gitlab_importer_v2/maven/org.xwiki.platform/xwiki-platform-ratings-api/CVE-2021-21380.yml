advisory_id: maven/org.xwiki.platform/xwiki-platform-ratings-api/CVE-2021-21380
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-ratings-api/CVE-2021-21380
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-ratings-api/CVE-2021-21380.yml
aliases:
  - CVE-2021-21380
  - GHSA-79rg-7mv3-jrr5
summary: |
  Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
  XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions of XWiki Platform (and only those with the Ratings API installed), the Rating Script Service expose an API to perform SQL requests without escaping the from and where search arguments. This might lead to an SQL script injection quite easily for any user having Script rights on XWiki. The problem has been patched in XWiki 12.9RC1. The only workaround besides upgrading XWiki would be to uninstall the Ratings API in XWiki from the Extension Manager.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-ratings-api
    affected_versions: vers:maven/<12.9
    fixed_versions: vers:maven/12.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-ratings-api/CVE-2021-21380.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-ratings-api/CVE-2021-21380.yml
weaknesses:
  - CWE-89
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-79rg-7mv3-jrr5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21380
    reference_type:
    reference_id: CVE-2021-21380
  - url: https://github.com/advisories/GHSA-79rg-7mv3-jrr5
    reference_type:
    reference_id: GHSA-79rg-7mv3-jrr5
