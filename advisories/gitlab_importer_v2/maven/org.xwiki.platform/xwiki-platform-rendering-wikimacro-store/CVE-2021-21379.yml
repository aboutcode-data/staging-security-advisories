advisory_id: maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store/CVE-2021-21379
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store/CVE-2021-21379
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store/CVE-2021-21379.yml
aliases:
  - CVE-2021-21379
  - GHSA-v662-xpcc-9xf6
summary: |
  Improper Preservation of Permissions
  XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions of XWiki Platform, the `{{wikimacrocontent}}` executes the content with the rights of the wiki macro author instead of the caller of that wiki macro. This makes possible to inject scripts through it and they will be executed with the rights of the wiki macro (very often a user which has Programming rights). Fortunately, no such macro exists by default in XWiki Standard but one could have been created or installed with an extension. This vulnerability has been patched in versions XWiki 12.6.3, 11.10.11 and 12.8-rc-1. There is no easy workaround other than disabling the affected macros. Inserting content in a safe way or knowing what is the user who called the wiki macro is not easy.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store
    affected_versions: vers:maven/>=11.4|<11.10.11|>=12.0|<12.6.3|>=12.7|<=12.7.1
    fixed_versions: vers:maven/11.10.11|12.6.3|12.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store/CVE-2021-21379.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-rendering-wikimacro-store/CVE-2021-21379.yml
weaknesses:
  - CWE-281
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-v662-xpcc-9xf6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21379
    reference_type:
    reference_id: CVE-2021-21379
  - url: https://github.com/advisories/GHSA-v662-xpcc-9xf6
    reference_type:
    reference_id: GHSA-v662-xpcc-9xf6
