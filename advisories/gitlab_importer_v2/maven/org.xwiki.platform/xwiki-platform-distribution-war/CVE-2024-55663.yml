advisory_id: maven/org.xwiki.platform/xwiki-platform-distribution-war/CVE-2024-55663
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-distribution-war/CVE-2024-55663
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-distribution-war/CVE-2024-55663.yml
aliases:
  - CVE-2024-55663
  - GHSA-wh34-m772-5398
summary: |
  XWiki Platform has an SQL injection in getdocuments.vm with sort parameter
  In `getdocument.vm` ; the ordering of the returned documents is defined from an unsanitized request parameter (request.sort) and can allow any user to inject HQL.

  Depending on the used database backend, the attacker may be able to not only obtain confidential information such as password hashes from the database, but also execute UPDATE/INSERT/DELETE queries.

  It's possible to employ database backend dependent techniques of breaking out of HQL query context, described, for example, here: https://www.sonarsource.com/blog/exploiting-hibernate-injections.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-distribution-war
    affected_versions: vers:maven/>=6.3-milestone-2|<13.10.5|>=14.0-rc-1|<14.3-rc-1
    fixed_versions: vers:maven/13.10.5|14.3-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-distribution-war/CVE-2024-55663.yml
weaknesses:
  - CWE-116
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/673076e2e8b88a36cdeaf7007843aa9ca1a068a0
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wh34-m772-5398
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-17568
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-55663
    reference_type:
    reference_id: CVE-2024-55663
  - url: https://github.com/advisories/GHSA-wh34-m772-5398
    reference_type:
    reference_id: GHSA-wh34-m772-5398
