advisory_id: maven/org.xwiki.platform/xwiki-platform-oldcore/CVE-2025-32968
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-oldcore/CVE-2025-32968
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-oldcore/CVE-2025-32968.yml
aliases:
  - CVE-2025-32968
  - GHSA-g9jj-75mx-wjcx
summary: |
  org.xwiki.platform:xwiki-platform-oldcore allows SQL injection in short form select requests through the script query API
  It is possible for a user with SCRIPT right to escape from the HQL execution context and perform a blind SQL injection to execute arbitrary SQL statements on the database backend.

  Depending on the used database backend, the attacker may be able to not only obtain confidential information such as password hashes from the database, but also execute UPDATE/INSERT/DELETE queries.

  The vulnerability may be tested in a default installation of XWIki Standard Flavor, including using the official Docker containers.

  For example, with a MySQL or MariaDB database, you can use the following script (which a user having SCRIPT right but not PROGRAMMING right) to get the content of the xwikistrings table (which contain all the short string fields stored in objects, including passwords):

  ```
  {{velocity}}
  $services.query.hql("where 1<>'1\'' union select concat(XWS_NAME, XWS_VALUE) from xwikistrings #'").execute()
  {{/velocity}}
  ```
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-oldcore
    affected_versions: vers:maven/>=1.6-milestone-1|<15.10.16|>=16.0.0-rc-1|<16.4.6|>=16.5.0-rc-1|<16.10.1
    fixed_versions: vers:maven/15.10.16|16.4.6|16.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-oldcore/CVE-2025-32968.yml
weaknesses:
  - CWE-89
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g9jj-75mx-wjcx
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22718
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32968
    reference_type:
    reference_id: CVE-2025-32968
  - url: https://github.com/advisories/GHSA-g9jj-75mx-wjcx
    reference_type:
    reference_id: GHSA-g9jj-75mx-wjcx
