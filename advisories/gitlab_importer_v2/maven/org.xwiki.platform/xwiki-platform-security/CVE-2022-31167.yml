advisory_id: maven/org.xwiki.platform/xwiki-platform-security/CVE-2022-31167
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-security/CVE-2022-31167
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-security/CVE-2022-31167.yml
aliases:
  - CVE-2022-31167
  - GHSA-gg53-wf5x-r3r6
summary: |
  Missing Authorization
  XWiki Platform Security Parent POM contains the security APIs for XWiki Platform, a generic wiki platform. Starting with version 5.0 and prior to 12.10.11, 13.10.1, and 13.4.6, a bug in the security cache stores rules associated to document Page1.Page2 and space Page1.Page2 in the same cache entry. That means that it's possible to overwrite the rights of a space or a document by creating the page of the space with the same name and checking the right of the new one first so that they end up in the security cache and are used for the other too. The problem has been patched in XWiki 12.10.11, 13.10.1, and 13.4.6. There are no known workarounds.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security
    affected_versions: vers:maven/>=5.0|<12.10.11|>=13.0|<13.4.6|>=13.10|<13.10.1
    fixed_versions: vers:maven/12.10.11|13.4.6|13.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-security/CVE-2022-31167.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-862
references:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-gg53-wf5x-r3r6
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-14075
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-18983
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31167
    reference_type:
    reference_id: CVE-2022-31167
  - url: https://github.com/advisories/GHSA-gg53-wf5x-r3r6
    reference_type:
    reference_id: GHSA-gg53-wf5x-r3r6
