advisory_id: maven/org.xwiki.platform/xwiki-platform-localization-source-wiki/CVE-2024-31983
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-localization-source-wiki/CVE-2024-31983
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-localization-source-wiki/CVE-2024-31983.yml
aliases:
  - CVE-2024-31983
  - GHSA-xxp2-9c9g-7wmj
summary: |
  XWiki Platform: Remote code execution from edit in multilingual wikis via translations
  In multilingual wikis, translations can be edited by any user who has edit right, circumventing the rights that are normally required for authoring translations (script right for user-scope translations, wiki admin for translations on the wiki). This can be exploited for remote code execution if the translation value is not properly escaped where it is used. To reproduce, in a multilingual wiki, as a user without script or admin right, edit a translation of `AppWithinMinutes.Translations` and in the line `platform.appwithinminutes.description=`  add `{{async}}{{groovy}}println("Hello from Translation"){{/groovy}}{{/async}}` at the end. Then open the app with in minutes home page (`AppWithinMinutes.WebHome`) in the same locale. If translations are still working and "Hello from Translation" is displayed at the end of the introduction, the installation is vulnerable.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-localization-source-wiki
    affected_versions: vers:maven/>=4.3-milestone-2|<14.10.20|>=15.0-rc-1|<15.5.4|>=15.6-rc-1|<15.10-rc-1
    fixed_versions: vers:maven/14.10.20|15.5.4|15.10-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-localization-source-wiki/CVE-2024-31983.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-862
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/2a9ce88f33663c53c9c63b2ea573f4720ea2efb9
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/73aef9648bbff04b697837f1b906932f0d5caacb
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/c4c8d61c30de72298d805ccc82df2a307f131c54
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-xxp2-9c9g-7wmj
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-21411
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-31983
    reference_type:
    reference_id: CVE-2024-31983
  - url: https://github.com/advisories/GHSA-xxp2-9c9g-7wmj
    reference_type:
    reference_id: GHSA-xxp2-9c9g-7wmj
