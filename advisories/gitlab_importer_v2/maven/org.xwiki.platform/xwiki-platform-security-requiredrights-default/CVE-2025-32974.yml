advisory_id: maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default/CVE-2025-32974
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default/CVE-2025-32974
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default/CVE-2025-32974.yml
aliases:
  - CVE-2025-32974
  - GHSA-mvgm-3rw2-7j4r
summary: |
  org.xwiki.platform:xwiki-platform-security-requiredrights-default required rights analysis doesn't consider TextAreas with default content type
  When editing a page, XWiki warns since version 15.9 when there is content on the page like a script macro that would gain more rights due to the editing. This analysis doesn't consider certain kinds of properties, allowing a user to put malicious scripts in there that will be executed after a user with script, admin, or programming rights edited the page. Such a malicious script could impact the confidentiality, integrity and availability of the whole XWiki installation.

  To reproduce, as a user without script right, create a class with a `TextArea` property, create page with an object of that class and a Velocity macro in its content. Then, as an admin, try editing that page. Normally, there should be a warning but in vulnerable versions of XWiki, there is no warning.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default
    affected_versions: vers:maven/>=15.9-rc-1|<15.10.8|>=16.0.0-rc-1|<16.2.0
    fixed_versions: vers:maven/15.10.8|16.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-security-requiredrights-default/CVE-2025-32974.yml
weaknesses:
  - CWE-116
  - CWE-269
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/153dbfa2ef1a7a0a644fe3f889684c6a8738c5fc
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-mvgm-3rw2-7j4r
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22002
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32974
    reference_type:
    reference_id: CVE-2025-32974
  - url: https://github.com/advisories/GHSA-mvgm-3rw2-7j4r
    reference_type:
    reference_id: GHSA-mvgm-3rw2-7j4r
