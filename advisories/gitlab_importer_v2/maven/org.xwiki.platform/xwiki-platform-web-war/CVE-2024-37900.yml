advisory_id: maven/org.xwiki.platform/xwiki-platform-web-war/CVE-2024-37900
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-web-war/CVE-2024-37900
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-web-war/CVE-2024-37900.yml
aliases:
  - CVE-2024-37900
  - GHSA-wf3x-jccf-5g5g
summary: |
  XWiki Platform vulnerable to Cross-site Scripting through attachment filename in uploader
  When uploading an attachment with a malicious filename, malicious JavaScript code could be executed. This requires a social engineering attack to get the victim into uploading a file with a malicious name. The malicious code is solely executed during the upload and affects only the user uploading the attachment. While this allows performing actions in the name of that user, it seems unlikely that a user wouldn't notice the malicious filename while uploading the attachment.

  In order to reproduce, as any user, create a file named `"><img src=1 onerror=alert(1)>.jpg`. Then go to any page where you have edit rights and upload the file in the attachments tab. If alerts appear and display "1", then the instance is vulnerable.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-web-war
    affected_versions: vers:maven/>=4.2-milestone-3|<14.10.21|>=15.0-rc-1|<15.5.5|>=15.6-rc-1|<15.10.6|>=16.0.0-rc-1|<16.0.0
    fixed_versions: vers:maven/14.10.21|15.5.5|15.10.6|16.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-web-war/CVE-2024-37900.yml
weaknesses:
  - CWE-96
  - CWE-1035
  - CWE-937
  - CWE-94
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/8b8a2d80529b9a9c038014c1eb6c2adc08069dfd
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/9df46f8e5313af46f93bccd1ebc682e28126573f
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wf3x-jccf-5g5g
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19602
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19611
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-21769
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37900
    reference_type:
    reference_id: CVE-2024-37900
  - url: https://github.com/advisories/GHSA-wf3x-jccf-5g5g
    reference_type:
    reference_id: GHSA-wf3x-jccf-5g5g
