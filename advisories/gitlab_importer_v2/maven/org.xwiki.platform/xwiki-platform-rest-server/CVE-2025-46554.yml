advisory_id: maven/org.xwiki.platform/xwiki-platform-rest-server/CVE-2025-46554
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform/xwiki-platform-rest-server/CVE-2025-46554
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-rest-server/CVE-2025-46554.yml
aliases:
  - CVE-2025-46554
  - GHSA-r5cr-xm48-97xp
summary: |
  XWiki missing authorization when accessing the wiki level attachments list and metadata via REST API
  Anyone can access the metadata of any attachment in the wiki using the wiki attachment REST endpoint. It's not filtering the result depending on current user rights, a not authenticated user could exploit this even in a totally private wiki.

  To reproduce:

  * remove view from guest on the whole wiki
  * logout
  * access http://127.0.0.1:8080/xwiki/rest/wikis/xwiki/spaces/Sandbox/pages/WebHome/attachments

  You get a list of attachments, while the expected result should be an empty list.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform/xwiki-platform-rest-server
    affected_versions: vers:maven/>=1.8.1|<14.10.22|>=15.0-rc-1|<15.10.12|>=16.0.0-rc-1|<16.4.3|>=16.5.0-rc-1|<16.7.0
    fixed_versions: vers:maven/14.10.22|15.10.12|16.4.3|16.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform/xwiki-platform-rest-server/CVE-2025-46554.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-862
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/37ecea84fdd053c33733c2ae9a0778bf98eae608
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/a43e933ddeda17dad1772396e1757998260e9342
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/c02ce7843a39851865b9d7b6132e32fdd21e3856
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-r5cr-xm48-97xp
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22424
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22427
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-46554
    reference_type:
    reference_id: CVE-2025-46554
  - url: https://github.com/advisories/GHSA-r5cr-xm48-97xp
    reference_type:
    reference_id: GHSA-r5cr-xm48-97xp
