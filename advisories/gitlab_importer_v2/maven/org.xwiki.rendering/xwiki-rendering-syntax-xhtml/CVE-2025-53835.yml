advisory_id: maven/org.xwiki.rendering/xwiki-rendering-syntax-xhtml/CVE-2025-53835
datasource_id: gitlab_importer_v2/maven/org.xwiki.rendering/xwiki-rendering-syntax-xhtml/CVE-2025-53835
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.rendering/xwiki-rendering-syntax-xhtml/CVE-2025-53835.yml
aliases:
  - CVE-2025-53835
  - GHSA-w3wh-g4m9-783p
summary: |
  XWiki Rendering is vulnerable to XSS attacks through insecure XHTML syntax
  The XHTML syntax depended on the `xdom+xml/current` syntax which allows the creation of raw blocks that permit the insertion of arbitrary HTML content including JavaScript. This allows XSS attacks for users who can edit a document like their user profile (enabled by default). The attack works by setting the document's syntax to `xdom+xml/current` and then inserting content like
  ```
  <document><p><metadata><metadata><entry><string>syntax</string><org.xwiki.rendering.syntax.Syntax><type><name>XHTML</name><id>xhtml</id><variants class="empty-list"></variants></type><version>5</version></org.xwiki.rendering.syntax.Syntax></entry></metadata></metadata></p><rawtext syntax="html/5.0" content="&lt;script&gt;alert(1);&lt;/script&gt;"></rawtext></document>
  ```

  This has been fixed by removing the dependency on the `xdom+xml/current` syntax from the XHTML syntax. Note that the `xdom+xml` syntax is still vulnerable to this attack. As it's main purpose is testing and its use is quite difficult, this syntax shouldn't be installed or used on a regular wiki. We're currently not aware of any further dependencies on it.
impacted_packages:
  - purl: pkg:maven/org.xwiki.rendering/xwiki-rendering-syntax-xhtml
    affected_versions: vers:maven/>=5.4.5|<14.10
    fixed_versions: vers:maven/14.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.rendering/xwiki-rendering-syntax-xhtml/CVE-2025-53835.yml
weaknesses:
  - CWE-80
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-rendering
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-rendering/commit/a4ca31f99f524b9456c64150d6f375984aa81ea7
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-rendering/security/advisories/GHSA-w3wh-g4m9-783p
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XRENDERING-660
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-53835
    reference_type:
    reference_id: CVE-2025-53835
  - url: https://github.com/advisories/GHSA-w3wh-g4m9-783p
    reference_type:
    reference_id: GHSA-w3wh-g4m9-783p
