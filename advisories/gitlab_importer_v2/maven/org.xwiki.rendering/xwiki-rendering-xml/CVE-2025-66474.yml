advisory_id: maven/org.xwiki.rendering/xwiki-rendering-xml/CVE-2025-66474
datasource_id: gitlab_importer_v2/maven/org.xwiki.rendering/xwiki-rendering-xml/CVE-2025-66474
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.rendering/xwiki-rendering-xml/CVE-2025-66474.yml
aliases:
  - CVE-2025-66474
  - GHSA-9xc6-c2rm-f27p
summary: |
  XWiki vulnerable to remote code execution through insufficient protection against {{/html}} injection
  Any user who can edit their own user profile or any other document can execute arbitrary script macros including Groovy and Python macros that allow remote code execution including unrestricted read and write access to all wiki contents. The reason is that rendering output is included as content of HTML macros with insufficient escaping, and it is thus possible to close the HTML macro and inject script macros that are executed with programming rights. To demonstrate, the content `{{html}}{{/html {{/html}}}}` can be inserted into any field of the user profile that supports wiki syntax like the "About" field. If this leads to the display of raw HTML, the instance is vulnerable.
impacted_packages:
  - purl: pkg:maven/org.xwiki.rendering/xwiki-rendering-xml
    affected_versions: vers:maven/<16.10.10|>=17.0.0-rc-1|<17.4.3|>=17.5.0-rc-1|<17.6.0-rc-1
    fixed_versions: vers:maven/16.10.10|17.4.3|17.6.0-rc-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.rendering/xwiki-rendering-xml/CVE-2025-66474.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-95
references:
  - url: https://github.com/xwiki/xwiki-platform/commit/12b780ccd5bca5fc8f74f46648d7e02fa04fbc11
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-rendering
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-rendering/commit/9b71a2ee035815cfc29cebbfe81dbdd98f941d49
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-rendering/security/advisories/GHSA-9xc6-c2rm-f27p
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XRENDERING-693
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XRENDERING-792
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XRENDERING-793
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-23378
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66474
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-9xc6-c2rm-f27p
    reference_type:
    reference_id: GHSA-9xc6-c2rm-f27p
