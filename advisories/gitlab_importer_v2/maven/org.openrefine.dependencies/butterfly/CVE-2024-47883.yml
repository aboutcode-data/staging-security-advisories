advisory_id: maven/org.openrefine.dependencies/butterfly/CVE-2024-47883
datasource_id: gitlab_importer_v2/maven/org.openrefine.dependencies/butterfly/CVE-2024-47883
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.openrefine.dependencies/butterfly/CVE-2024-47883.yml
aliases:
  - CVE-2024-47883
  - GHSA-3p8v-w8mr-m3x8
summary: |
  Butterfly has path/URL confusion in resource handling leading to multiple weaknesses
  The Butterfly framework uses the `java.net.URL` class to refer to (what are expected to be) local resource files, like images or templates. This works: "opening a connection" to these URLs opens the local file. However, if a `file:/` URL is directly given where a relative path (resource name) is expected, this is also accepted in some code paths; the app then fetches the file, from a remote machine if indicated, and uses it as if it was a trusted part of the app's codebase.

  This leads to multiple weaknesses and potential weaknesses:

  * An attacker that has network access to the application could use it to gain access to files, either on the the server's filesystem (path traversal) or shared by nearby machines (server-side request forgery with e.g. SMB).
  * An attacker that can lead or redirect a user to a crafted URL belonging to the app could cause arbitrary attacker-controlled JavaScript to be loaded in the victim's browser (cross-site scripting).
  * If an app is written in such a way that an attacker can influence the resource name used for a template, that attacker could cause the app to fetch and execute an attacker-controlled template (remote code execution).
impacted_packages:
  - purl: pkg:maven/org.openrefine.dependencies/butterfly
    affected_versions: vers:maven/<1.2.6
    fixed_versions: vers:maven/1.2.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.openrefine.dependencies/butterfly/CVE-2024-47883.yml
weaknesses:
  - CWE-937
  - CWE-36
  - CWE-1035
  - CWE-918
references:
  - url: https://github.com/OpenRefine/simile-butterfly
    reference_type:
    reference_id:
  - url: https://github.com/OpenRefine/simile-butterfly/commit/537f64bfa72746f8b21d4bda461fad843435319c
    reference_type:
    reference_id:
  - url: https://github.com/OpenRefine/simile-butterfly/security/advisories/GHSA-3p8v-w8mr-m3x8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47883
    reference_type:
    reference_id: CVE-2024-47883
  - url: https://github.com/advisories/GHSA-3p8v-w8mr-m3x8
    reference_type:
    reference_id: GHSA-3p8v-w8mr-m3x8
