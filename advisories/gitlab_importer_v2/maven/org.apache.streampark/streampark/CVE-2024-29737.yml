advisory_id: maven/org.apache.streampark/streampark/CVE-2024-29737
datasource_id: gitlab_importer_v2/maven/org.apache.streampark/streampark/CVE-2024-29737
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.streampark/streampark/CVE-2024-29737.yml
aliases:
  - CVE-2024-29737
  - GHSA-5v69-92vw-fmjh
summary: |
  Apache StreamPark: maven build params could trigger remote command execution
  In streampark, the project module integrates Maven's compilation capabilities. The input parameter validation is not strict, allowing attackers to insert commands for remote command execution, The prerequisite for a successful attack is that the user needs to log in to the streampark system and have system-level permissions. Generally, only users of that system have the authorization to log in, and users would not manually input a dangerous operation command. Therefore, the risk level of this vulnerability is very low.

  Mitigation:

  all users should upgrade to 2.1.4

  Background info:

  Log in to Streampark using the default username (e.g. test1, test2, test3) and the default password (streampark). Navigate to the Project module, then add a new project. Enter the git repository address of the project and input `touch /tmp/success_2.1.2` as the "Build Argument". Note that there is no verification and interception of the special character "`". As a result, you will find that this injection command will be successfully executed after executing the build.

  In the latest version, the special symbol ` is intercepted.
impacted_packages:
  - purl: pkg:maven/org.apache.streampark/streampark
    affected_versions: vers:maven/<2.1.4
    fixed_versions: vers:maven/2.1.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.streampark/streampark/CVE-2024-29737.yml
weaknesses:
  - CWE-77
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/apache/streampark
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/xhx7jt1t24s6d7o435wxng8t0ojfbfh5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-29737
    reference_type:
    reference_id: CVE-2024-29737
  - url: https://github.com/advisories/GHSA-5v69-92vw-fmjh
    reference_type:
    reference_id: GHSA-5v69-92vw-fmjh
