advisory_id: maven/org.apache.james/james-project/CVE-2023-51747
datasource_id: gitlab_importer_v2/maven/org.apache.james/james-project/CVE-2023-51747
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.james/james-project/CVE-2023-51747.yml
aliases:
  - CVE-2023-51747
  - GHSA-p5q9-86w4-2xr5
summary: |
  Apache James vulnerable to SMTP smuggling
  Apache James prior to versions 3.8.1 and 3.7.5 is vulnerable to SMTP smuggling.

  A lenient behaviour in line delimiter handling might create a difference of interpretation between the sender and the receiver which can be exploited by an attacker to forge an SMTP envelop, allowing for instance to bypass SPF checks.

  The patch implies enforcement of CRLF as a line delimiter as part of the DATA transaction.

  We recommend James users to upgrade to non vulnerable versions.
impacted_packages:
  - purl: pkg:maven/org.apache.james/james-project
    affected_versions:
    fixed_versions: vers:maven/3.7.5|3.8.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-20
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/apache/james-project
    reference_type:
    reference_id:
  - url: https://github.com/apache/james-project/commit/d1ef102540e504c067b6c1721a6f1e7eee9c6fc6
    reference_type:
    reference_id:
  - url: https://github.com/apache/james-project/commit/d5cd8bb098aa78d8d62c9645f3c532689ef1cb03
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/rxkwbkh9vgbl9rzx1fkllyk3krhgydko
    reference_type:
    reference_id:
  - url: https://postfix.org/smtp-smuggling.html
    reference_type:
    reference_id:
  - url: https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-51747
    reference_type:
    reference_id: CVE-2023-51747
  - url: https://github.com/advisories/GHSA-p5q9-86w4-2xr5
    reference_type:
    reference_id: GHSA-p5q9-86w4-2xr5
