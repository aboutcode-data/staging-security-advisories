advisory_id: maven/io.spinnaker.clouddriver/clouddriver-artifacts/CVE-2025-61916
datasource_id: gitlab_importer_v2/maven/io.spinnaker.clouddriver/clouddriver-artifacts/CVE-2025-61916
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.spinnaker.clouddriver/clouddriver-artifacts/CVE-2025-61916.yml
aliases:
  - CVE-2025-61916
  - GHSA-vrjc-q2fh-6x9h
summary: |
  Spinnaker vulnerable to SSRF due to improper restrictions on http from user input
  The primary impact is allowing users to fetch data from a remote URL.  This data can be then injected into Spinnaker pipelines via helm or other methods to extract things LIKE idmsv1 authentication data.  This ALSO includes calling INTERNAL Spinnaker API's via a get and similar endpoints.  Further, depending upon the artifact configuration, auth data may be exposed to arbitrary endpoints (e.g. GitHub auth headers) leading to credentials exposure.

  To trigger this, a Spinnaker installation MUST have:
  * An artifact enabled that allows user input.  This includes GitHub file artifacts, BitBucket, GitLab, HTTP artifacts and similar artifact providers.  JUST enabling the http artifact provider will add a "no-auth" http provider that could be used to extract link local data (e.g. AWS Metadata information).
  * A system that can consume the output of these artifacts.  E.g. Rosco helm can use this to fetch values data.  K8s account manifests if the API returns JSON can be used to inject that data into the pipeline itself though the pipeline would fail.

  To note, due to the way the URLs are viable to be injected, CERTAIN systems can be used to provide DOS attacks on Spinnaker itself.  These would NOT compromise the system per se, given restarts and timeout configuration, but could lead to internal attacks by a Spinnaker user against Spinnaker services.  An example is that an artifact fetch reference could return an infinite response data feed or similar that can act as a DOS attack.  It's recommended to set strong limits on the various http limits AND artifact URLs to known valid URLs.
impacted_packages:
  - purl: pkg:maven/io.spinnaker.clouddriver/clouddriver-artifacts
    affected_versions: vers:maven/<2025.1.6|>=2025.2.0|<2025.2.3
    fixed_versions: vers:maven/2025.1.6|2025.2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.spinnaker.clouddriver/clouddriver-artifacts/CVE-2025-61916.yml
weaknesses:
  - CWE-523
  - CWE-918
  - CWE-20
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/spinnaker/spinnaker
    reference_type:
    reference_id:
  - url: https://github.com/spinnaker/spinnaker/security/advisories/GHSA-vrjc-q2fh-6x9h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-61916
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-vrjc-q2fh-6x9h
    reference_type:
    reference_id: GHSA-vrjc-q2fh-6x9h
