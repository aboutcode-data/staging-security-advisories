advisory_id: maven/org.xwiki.platform.applications/xwiki-application-tag/CVE-2022-36100
datasource_id: gitlab_importer_v2/maven/org.xwiki.platform.applications/xwiki-application-tag/CVE-2022-36100
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform.applications/xwiki-application-tag/CVE-2022-36100.yml
aliases:
  - CVE-2022-36100
  - GHSA-2g5c-228j-p52x
summary: |
  Improper Control of Generation of Code ('Code Injection')
  XWiki Platform Applications Tag and XWiki Platform Tag UI are tag applications for XWiki, a generic wiki platform. Starting with version 1.7 in XWiki Platform Applications Tag and prior to 13.10.6 and 14.4 in XWiki Platform Tag UI, the tags document `Main.Tags` in XWiki didn't sanitize user inputs properly. This allowed users with view rights on the document (default in a public wiki or for authenticated users on private wikis) to execute arbitrary Groovy, Python and Velocity code with programming rights. This also allowed bypassing all rights checks and thus both modification and disclosure of all content stored in the XWiki installation. The vulnerability could be used to impact the availability of the wiki. On XWiki versions before 13.10.4 and 14.2, this can be combined with CVE-2022-36092, meaning that no rights are required to perform the attack. The vulnerability has been patched in versions 13.10.6 and 14.4. As a workaround, the patch that fixes the issue can be manually applied to the document `Main.Tags` or the updated version of that document can be imported from version 14.4 of xwiki-platform-tag-ui using the import feature in the administration UI on XWiki 10.9 and later.
impacted_packages:
  - purl: pkg:maven/org.xwiki.platform.applications/xwiki-application-tag
    affected_versions: vers:maven/>=1.7
    fixed_versions: vers:maven/
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.xwiki.platform.applications/xwiki-application-tag/CVE-2022-36100.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
  - CWE-94
references:
  - url: https://github.com/xwiki/xwiki-platform/commit/604868033ebd191cf2d1e94db336f0c4d9096427
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2g5c-228j-p52x
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19747
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-36100
    reference_type:
    reference_id: CVE-2022-36100
  - url: https://github.com/advisories/GHSA-2g5c-228j-p52x
    reference_type:
    reference_id: GHSA-2g5c-228j-p52x
