advisory_id: maven/software.amazon.cryptography/aws-database-encryption-sdk-dynamodb/GMS-2023-4168
datasource_id: gitlab_importer_v2/maven/software.amazon.cryptography/aws-database-encryption-sdk-dynamodb/GMS-2023-4168
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/software.amazon.cryptography/aws-database-encryption-sdk-dynamodb/GMS-2023-4168.yml
aliases:
  - GHSA-72fp-w44g-625q
  - GMS-2023-4168
summary: "Signing DynamoDB Sets when using the AWS Database Encryption SDK.\n### Impact\nThis\
  \ advisory addresses an issue when a DynamoDB Set attribute is marked as SIGN_ONLY in the\
  \ AWS Database Encryption SDK (DB-ESDK) for DynamoDB. This also includes when a Set is part\
  \ of a List or a Map.\n\nDB-ESDK for DynamoDB supports `SIGN_ONLY` and `ENCRYPT_AND_SIGN`\
  \ attribute actions. In version 3.1.0 and below, when a Set type is assigned a `SIGN_ONLY`\
  \ attribute action, there is a chance that signature validation of the record containing a\
  \ Set will fail on read, even if the Set attributes contain the same values. The probability\
  \ of a failure depends on the order of the elements in the Set combined with how DynamoDB\
  \ returns this data, which is undefined.\n\nThis update addresses the issue by ensuring that\
  \ any Set values are canonicalized in the same order while written to DynamoDB as when read\
  \ back from DynamoDB.\n\n### Patches\nFixed in version 3.1.1 \nWe recommend all users upgrade\
  \ as soon as possible.\n\n### Workarounds\nNone\n\n### References\nFor more information on\
  \ how to address records with Sets marked as `SIGN_ONLY` written by versions 3.1.0 and below\
  \ of DB-ESDK, see [AWS Database Encryption SDK Decrypt with Permute](https://github.com/aws/aws-database-encryption-sdk-dynamodb-java/tree/v3.1.1/DecryptWithPermute)"
impacted_packages:
  - purl: pkg:maven/software.amazon.cryptography/aws-database-encryption-sdk-dynamodb
    affected_versions: vers:maven/>=3.0.0|<3.1.1
    fixed_versions: vers:maven/3.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/aws/aws-database-encryption-sdk-dynamodb-java/commit/e3aa016895a3e2533b9a3c1ec88458d6667b3245
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-database-encryption-sdk-dynamodb-java/releases/tag/v3.1.1
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-database-encryption-sdk-dynamodb-java/security/advisories/GHSA-72fp-w44g-625q
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-72fp-w44g-625q
    reference_type:
    reference_id: GHSA-72fp-w44g-625q
