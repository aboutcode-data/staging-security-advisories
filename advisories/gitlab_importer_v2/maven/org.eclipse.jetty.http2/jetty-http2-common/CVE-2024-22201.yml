advisory_id: maven/org.eclipse.jetty.http2/jetty-http2-common/CVE-2024-22201
datasource_id: gitlab_importer_v2/maven/org.eclipse.jetty.http2/jetty-http2-common/CVE-2024-22201
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.eclipse.jetty.http2/jetty-http2-common/CVE-2024-22201.yml
aliases:
  - CVE-2024-22201
  - GHSA-rggv-cv7r-mw98
summary: |
  Connection leaking on idle timeout when TCP congested
  If an HTTP/2 connection gets TCP congested, when an idle timeout occurs the HTTP/2 session is marked as closed, and then a GOAWAY frame is queued to be written.
  However it is not written because the connection is TCP congested.
  When another idle timeout period elapses, it is then supposed to hard close the connection, but it delegates to the HTTP/2 session which reports that it has already been closed so it does not attempt to hard close the connection.

  This leaves the connection in ESTABLISHED state (i.e. not closed), TCP congested, and idle.

  An attacker can cause many connections to end up in this state, and the server may run out of file descriptors, eventually causing the server to stop accepting new connections from valid clients.

  The client may also be impacted (if the server does not read causing a TCP congestion), but the issue is more severe for servers.
impacted_packages:
  - purl: pkg:maven/org.eclipse.jetty.http2/jetty-http2-common
    affected_versions: vers:maven/>=12.0.0|<12.0.6
    fixed_versions: vers:maven/12.0.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.eclipse.jetty.http2/jetty-http2-common/CVE-2024-22201.yml
weaknesses:
  - CWE-770
  - CWE-1035
  - CWE-937
  - CWE-400
references:
  - url: https://github.com/jetty/jetty.project
    reference_type:
    reference_id:
  - url: https://github.com/jetty/jetty.project/commit/0839a208cdc3fcfe25206a77af59ba9fda260188
    reference_type:
    reference_id:
  - url: https://github.com/jetty/jetty.project/commit/b953871c9a5ff4fbca4a2499848f75182dbd9810
    reference_type:
    reference_id:
  - url: https://github.com/jetty/jetty.project/issues/11256
    reference_type:
    reference_id:
  - url: https://github.com/jetty/jetty.project/issues/11259
    reference_type:
    reference_id:
  - url: https://github.com/jetty/jetty.project/security/advisories/GHSA-rggv-cv7r-mw98
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/04/msg00002.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240329-0001
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22201
    reference_type:
    reference_id: CVE-2024-22201
  - url: https://github.com/advisories/GHSA-rggv-cv7r-mw98
    reference_type:
    reference_id: GHSA-rggv-cv7r-mw98
