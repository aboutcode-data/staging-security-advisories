advisory_id: maven/com.linecorp.armeria/armeria/CVE-2021-43795
datasource_id: gitlab_importer_v2/maven/com.linecorp.armeria/armeria/CVE-2021-43795
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.linecorp.armeria/armeria/CVE-2021-43795.yml
aliases:
  - CVE-2021-43795
  - GHSA-8fp4-rp6c-5gcv
summary: |
  Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')
  Armeria is an open source microservice framework. In affected versions an attacker can access an Armeria server's local file system beyond its restricted directory by sending an HTTP request whose path contains `%2F` (encoded `/`), such as `/files/..%2Fsecrets.txt`, bypassing Armeria's path validation logic. Armeria 1.13.4 or above contains the hardened path validation logic that handles `%2F` properly. This vulnerability can be worked around by inserting a decorator that performs an additional validation on the request path.
impacted_packages:
  - purl: pkg:maven/com.linecorp.armeria/armeria
    affected_versions: vers:maven/>=1.12.0|<1.13.4
    fixed_versions: vers:maven/1.13.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.linecorp.armeria/armeria/CVE-2021-43795.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.linecorp.armeria/armeria/CVE-2021-43795.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-22
references:
  - url: https://github.com/line/armeria/commit/e2697a575e9df6692b423e02d731f293c1313284
    reference_type:
    reference_id:
  - url: https://github.com/line/armeria/pull/3855
    reference_type:
    reference_id:
  - url: https://github.com/line/armeria/security/advisories/GHSA-8fp4-rp6c-5gcv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43795
    reference_type:
    reference_id: CVE-2021-43795
  - url: https://github.com/advisories/GHSA-8fp4-rp6c-5gcv
    reference_type:
    reference_id: GHSA-8fp4-rp6c-5gcv
