advisory_id: maven/org.dspace/dspace-server-webapp/CVE-2024-38364
datasource_id: gitlab_importer_v2/maven/org.dspace/dspace-server-webapp/CVE-2024-38364
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.dspace/dspace-server-webapp/CVE-2024-38364.yml
aliases:
  - CVE-2024-38364
  - GHSA-94cc-xjxr-pwvf
summary: |
  DSpace Cross Site Scripting (XSS) via a deposited HTML/XML document
  In DSpace 7.0 through 7.6.1, when an HTML, XML or JavaScript Bitstream is downloaded, the user's browser _may_ execute any embedded JavaScript.  If that embedded JavaScript is malicious, there is a risk of an XSS attack.

  This attack may only be initialized by a user who already has Submitter privileges in the repository. The submitter must upload the malicious HTML/XML/JavaScript file themselves. The attack itself would not occur until a different authenticated user downloads the malicious file.  CORS and CSRF protection built into DSpace help to limit the impact of the attack (and may block it in some scenarios).

  If the repository is configured to only download HTML / XML / JavaScript Bitstreams using the [`Content-Disposition: attachment`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition) header, then the attack is no longer possible.  See "Workarounds" below.
impacted_packages:
  - purl: pkg:maven/org.dspace/dspace-server-webapp
    affected_versions: vers:maven/>=7.0|<7.6.2
    fixed_versions: vers:maven/7.6.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:N/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.dspace/dspace-server-webapp/CVE-2024-38364.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-79
references:
  - url: https://github.com/DSpace/DSpace
    reference_type:
    reference_id:
  - url: https://github.com/DSpace/DSpace/commit/f1059b4340857cca3dc4c45b1ebbadce6bb61c0b
    reference_type:
    reference_id:
  - url: https://github.com/DSpace/DSpace/pull/8891
    reference_type:
    reference_id:
  - url: https://github.com/DSpace/DSpace/pull/9638
    reference_type:
    reference_id:
  - url: https://github.com/DSpace/DSpace/security/advisories/GHSA-94cc-xjxr-pwvf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-38364
    reference_type:
    reference_id: CVE-2024-38364
  - url: https://github.com/advisories/GHSA-94cc-xjxr-pwvf
    reference_type:
    reference_id: GHSA-94cc-xjxr-pwvf
