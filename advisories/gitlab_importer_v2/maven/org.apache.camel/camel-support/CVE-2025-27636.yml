advisory_id: maven/org.apache.camel/camel-support/CVE-2025-27636
datasource_id: gitlab_importer_v2/maven/org.apache.camel/camel-support/CVE-2025-27636
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.camel/camel-support/CVE-2025-27636.yml
aliases:
  - CVE-2025-27636
  - GHSA-2c2h-2855-mf97
summary: |
  Apache Camel: Camel Message Header Injection via Improper Filtering
  Bypass/Injection vulnerability in Apache Camel components under particular conditions.

  This issue affects Apache Camel: from 4.9.0 through <= 4.10.1, from 4.8.0 through <= 4.8.4, from 3.10.0 through <= 3.22.3.

  Users are recommended to upgrade to version 4.10.2 for 4.10.x LTS, 4.8.5 for 4.8.x LTS and 3.22.4 for 3.x releases.

  This vulnerability is present in Camel's default incoming header filter, that allows an attacker to include Camel specific headers that for some Camel components can alter the behaviours such as the camel-bean component, to call another method on the bean, than was coded in the application. In the `camel-jms` component, then a malicious header can be used to send the message to another queue (on the same broker) than was coded in the application. This could also be seen by using the camel-exec component.

  The attacker would need to inject custom headers, such as HTTP protocols. So if you have Camel applications that are directly connected to the internet via HTTP, then an attacker could include malicious HTTP headers in the HTTP requests that are send to the Camel application.

  All the known Camel HTTP component such as `camel-servlet`, `camel-jetty`, `camel-undertow`, `camel-platform-http`, and `camel-netty-http` would be vulnerable out of the box.

  In these conditions an attacker could be able to forge a Camel header name and make the bean component invoking other methods in the same bean.

  In terms of usage of the default header filter strategy the list of components using that is:

  *  camel-activemq
  *  camel-activemq6
  *  camel-amqp
  *  camel-aws2-sqs
  *  camel-azure-servicebus
  *  camel-cxf-rest
  *  camel-cxf-soap
  *  camel-http
  *  camel-jetty
  *  camel-jms
  *  camel-kafka
  *  camel-knative
  *  camel-mail
  *  camel-nats
  *  camel-netty-http
  *  camel-platform-http
  *  camel-rest
  *  camel-sjms
  *  camel-spring-rabbitmq
  *  camel-stomp
  *  camel-tahu
  *  camel-undertow
  *  camel-xmpp

  The vulnerability arises due to a bug in the default filtering mechanism that only blocks headers starting with "Camel", "camel", or "org.apache.camel.".

  Mitigation: You can easily work around this in your Camel applications by removing the headers in your Camel routes. There are many ways of doing this, also globally or per route. This means you could use the removeHeaders EIP, to filter out anything like "cAmel, cAMEL" etc, or in general everything not starting with "Camel", "camel" or "org.apache.camel.".
impacted_packages:
  - purl: pkg:maven/org.apache.camel/camel-support
    affected_versions: vers:maven/>=3.10.0|<3.22.4|>=4.0.0-M1|<4.8.5|>=4.9.0|<4.10.2
    fixed_versions: vers:maven/3.22.4|4.8.5|4.10.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.apache.camel/camel-support/CVE-2025-27636.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-178
references:
  - url: https://camel.apache.org/security/CVE-2025-27636.html
    reference_type:
    reference_id:
  - url: https://github.com/akamai/CVE-2025-27636-Apache-Camel-PoC/blob/main/src/main/java/com/example/camel/VulnerableCamel.java
    reference_type:
    reference_id:
  - url: https://github.com/apache/camel
    reference_type:
    reference_id:
  - url: https://github.com/apache/camel/blob/camel-4.9.0/core/camel-support/src/main/java/org/apache/camel/support/DefaultHeaderFilterStrategy.java
    reference_type:
    reference_id:
  - url: https://github.com/apache/camel/commit/23a833eec6131a3cdce6e4b1b40b3ac2035b6adf
    reference_type:
    reference_id:
  - url: https://github.com/apache/camel/commit/45a6b74f7f8af8fd58f197566938a9534392a624
    reference_type:
    reference_id:
  - url: https://issues.apache.org/jira/browse/CAMEL-21828
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/l3zcg3vts88bmc7w8172wkgw610y693z
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-27636
    reference_type:
    reference_id: CVE-2025-27636
  - url: https://github.com/advisories/GHSA-2c2h-2855-mf97
    reference_type:
    reference_id: GHSA-2c2h-2855-mf97
