advisory_id: maven/org.opensearch/opensearch/GMS-2023-118
datasource_id: gitlab_importer_v2/maven/org.opensearch/opensearch/GMS-2023-118
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/org.opensearch/opensearch/GMS-2023-118.yml
aliases:
  - CVE-2023-23613
  - GHSA-v3cg-7r9h-r2g6
  - GMS-2023-118
summary: |
  Field-level security issue with .keyword fields in OpenSearch
  ### Advisory title: Field-level security issue with .keyword fields

  ### Affected versions:
  OpenSearch 1.0.0-1.3.7 and 2.0.0-2.4.1

  ### Patched versions:
  OpenSearch 1.3.8 and 2.5.0

  ### Impact:
  There is an issue in the implementation of field-level security (FLS) and field masking where rules written to explicitly exclude fields are not correctly applied for certain queries that rely on their auto-generated .keyword fields.

  This issue is only present for authenticated users with read access to the indexes containing the restricted fields.

  ### Workaround:
  FLS rules that use explicit exclusions can be written to grant explicit access instead. Policies authored in this way are not subject to this issue.

  ### Patches:
  OpenSearch versions 1.3.8 and 2.5.0 contain a fix for this issue.

  ### For more information:
  If you have any questions or comments about this advisory, please contact AWS/Amazon Security via our issue reporting page (https://aws.amazon.com/security/vulnerability-reporting/) or directly via email to [aws-security@amazon.com](mailto:aws-security@amazon.com). Please do not create a public GitHub issue.
impacted_packages:
  - purl: pkg:maven/org.opensearch/opensearch
    affected_versions: vers:maven/<1.3.8|>=2.0.0|<2.5.0
    fixed_versions: vers:maven/1.3.8|2.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/opensearch-project/security/security/advisories/GHSA-v3cg-7r9h-r2g6
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-v3cg-7r9h-r2g6
    reference_type:
    reference_id: GHSA-v3cg-7r9h-r2g6
