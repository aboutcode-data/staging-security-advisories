advisory_id: maven/com.schibsted.security/strongbox-sdk/GMS-2023-388
datasource_id: gitlab_importer_v2/maven/com.schibsted.security/strongbox-sdk/GMS-2023-388
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/com.schibsted.security/strongbox-sdk/GMS-2023-388.yml
aliases:
  - GHSA-mhgm-52vg-pvvc
  - GMS-2023-388
summary: |
  Privilege escalation in Strongbox
  An attacker with read-only access to a Strongbox secret could craft a valid encrypted secret (same id/version). It also makes the audit logs from KMS less useful. The issue is caused by a bug in the underlying AWS Encryption SDK. By default, the encrypted secrets are stored in DynamoDB and an attacker with read-only access would not be able to write the encrypted secret to DynamoDB. So in practice the impact should be limited for most users. Strongbox supports storing data in files as an alternative to DynamoDB. If the attacker had write access to where the files are stored they could make the attack work end-to-end. Similarly, any custom storage backend could also be affected. In order to be backwards compatible Strongbox will not make use of key commitments (another improvement to the AWS Encryption SDK). Strongbox enforces that only one KMS key can be used, and it must match the expected one. This means that an attacker needs write access to both KMS and DynamoDB (or other storage backend) to stage an attack, which is not a scenario Strongbox is designed to protect against.
impacted_packages:
  - purl: pkg:maven/com.schibsted.security/strongbox-sdk
    affected_versions: vers:maven/<0.5.0
    fixed_versions: vers:maven/0.5.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/schibsted/strongbox/security/advisories/GHSA-mhgm-52vg-pvvc
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-mhgm-52vg-pvvc
    reference_type:
    reference_id: GHSA-mhgm-52vg-pvvc
