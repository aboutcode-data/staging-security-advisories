advisory_id: maven/io.netty/netty-codec-http/CVE-2021-21290
datasource_id: gitlab_importer_v2/maven/io.netty/netty-codec-http/CVE-2021-21290
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.netty/netty-codec-http/CVE-2021-21290.yml
aliases:
  - CVE-2021-21290
  - GHSA-5mcr-gq6c-3hq2
summary: |
  Creation of Temporary File With Insecure Permissions
  Netty is an open-source, asynchronous event-driven network application framework for rapid development of maintainable high performance protocol servers. There is a vulnerability on Unix-like systems involving an insecure temp file. When netty's multipart decoders are used local information disclosure can occur via the local system temporary directory if temporary storing uploads on the disk is enabled. On unix-like systems, the temporary directory is shared between all user. As such, writing to this directory using APIs that do not explicitly set the `file/directory` permissions can lead to information disclosure. Of note, this does not impact modern MacOS Operating Systems. The method `File.createTempFile` on unix-like systems creates a random file, but, by default will create this file with the permissions `-rw-r--r--`. Thus, if sensitive information is written to this file, other local users can read this information.
impacted_packages:
  - purl: pkg:maven/io.netty/netty-codec-http
    affected_versions: vers:maven/<4.1.59.Final
    fixed_versions: vers:maven/4.1.59.Final
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.netty/netty-codec-http/CVE-2021-21290.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.netty/netty-codec-http/CVE-2021-21290.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-378
references:
  - url: https://github.com/netty/netty/commit/c735357bf29d07856ad171c6611a2e1a0e0000ec
    reference_type:
    reference_id:
  - url: https://github.com/netty/netty/security/advisories/GHSA-5mcr-gq6c-3hq2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21290
    reference_type:
    reference_id: CVE-2021-21290
