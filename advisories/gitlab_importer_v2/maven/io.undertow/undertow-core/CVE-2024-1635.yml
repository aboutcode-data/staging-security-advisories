advisory_id: maven/io.undertow/undertow-core/CVE-2024-1635
datasource_id: gitlab_importer_v2/maven/io.undertow/undertow-core/CVE-2024-1635
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.undertow/undertow-core/CVE-2024-1635.yml
aliases:
  - CVE-2024-1635
  - GHSA-w6qf-42m7-vh68
summary: |
  Undertow Uncontrolled Resource Consumption Vulnerability
  A vulnerability was found in Undertow. This vulnerability impacts a server that supports the wildfly-http-client protocol. Whenever a malicious user opens and closes a connection with the HTTP port of the server and then closes the connection immediately, the server will end with both memory and open file limits exhausted at some point, depending on the amount of memory available.

  At HTTP upgrade to remoting, the WriteTimeoutStreamSinkConduit leaks connections if RemotingConnection is closed by Remoting ServerConnectionOpenListener. Because the remoting connection originates in Undertow as part of the HTTP upgrade, there is an external layer to the remoting connection. This connection is unaware of the outermost layer when closing the connection during the connection opening procedure. Hence, the Undertow WriteTimeoutStreamSinkConduit is not notified of the closed connection in this scenario. Because WriteTimeoutStreamSinkConduit creates a timeout task, the whole dependency tree leaks via that task, which is added to XNIO WorkerThread. So, the workerThread points to the Undertow conduit, which contains the connections and causes the leak.
impacted_packages:
  - purl: pkg:maven/io.undertow/undertow-core
    affected_versions:
    fixed_versions: vers:maven/2.2.31.Final|2.3.12.Final
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.undertow/undertow-core/CVE-2024-1635.yml
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-400
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-1635
    reference_type:
    reference_id:
  - url: https://github.com/undertow-io/undertow
    reference_type:
    reference_id:
  - url: https://github.com/undertow-io/undertow/commit/3cdb104e225f34547ce9fd6eb8799eb68e040f19
    reference_type:
    reference_id:
  - url: https://github.com/undertow-io/undertow/commit/7d388c5aae9b82afb63f24e3b6a2044838dfb4de
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240322-0007
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2264928
    reference_type: bug
    reference_id: 2264928
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-1635
    reference_type:
    reference_id: CVE-2024-1635
  - url: https://github.com/advisories/GHSA-w6qf-42m7-vh68
    reference_type:
    reference_id: GHSA-w6qf-42m7-vh68
  - url: https://access.redhat.com/errata/RHSA-2024:1674
    reference_type:
    reference_id: RHSA-2024:1674
  - url: https://access.redhat.com/errata/RHSA-2024:1675
    reference_type:
    reference_id: RHSA-2024:1675
  - url: https://access.redhat.com/errata/RHSA-2024:1676
    reference_type:
    reference_id: RHSA-2024:1676
  - url: https://access.redhat.com/errata/RHSA-2024:1677
    reference_type:
    reference_id: RHSA-2024:1677
  - url: https://access.redhat.com/errata/RHSA-2024:1860
    reference_type:
    reference_id: RHSA-2024:1860
  - url: https://access.redhat.com/errata/RHSA-2024:1861
    reference_type:
    reference_id: RHSA-2024:1861
  - url: https://access.redhat.com/errata/RHSA-2024:1862
    reference_type:
    reference_id: RHSA-2024:1862
  - url: https://access.redhat.com/errata/RHSA-2024:1864
    reference_type:
    reference_id: RHSA-2024:1864
  - url: https://access.redhat.com/errata/RHSA-2024:1866
    reference_type:
    reference_id: RHSA-2024:1866
  - url: https://access.redhat.com/errata/RHSA-2024:3354
    reference_type:
    reference_id: RHSA-2024:3354
  - url: https://access.redhat.com/errata/RHSA-2024:4884
    reference_type:
    reference_id: RHSA-2024:4884
  - url: https://access.redhat.com/errata/RHSA-2025:4226
    reference_type:
    reference_id: RHSA-2025:4226
