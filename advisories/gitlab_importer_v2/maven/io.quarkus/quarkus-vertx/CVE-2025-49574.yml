advisory_id: maven/io.quarkus/quarkus-vertx/CVE-2025-49574
datasource_id: gitlab_importer_v2/maven/io.quarkus/quarkus-vertx/CVE-2025-49574
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.quarkus/quarkus-vertx/CVE-2025-49574.yml
aliases:
  - CVE-2025-49574
  - GHSA-9623-mj7j-p9v4
summary: |
  Quarkus potentially leaks data when duplicating a duplicated context
  Vert.x 4.5.12 has changed the semantics of the duplication of duplicated context.

  Duplicated context is an object used to propagate data through a processing (synchronous or asynchronous). Each "transaction" or "processing" runs on its own isolated duplicated context.

  Initially, duplicating a duplicated context was creating a fresh (empty) new context, meaning that the new duplicated context can be used to managed a separated transaction.

  In Vert.x 4.5.12, this semantics has changed, and since the content of the parent duplicated context is copied into the new one, potentially leaking data.

  This CVE is especially for Quarkus as Quarkus extensively uses the Vert.x duplicated context to implement context propagation. With the new semantic data from one transaction can leak to the data from another transaction. From a Vert.x point of view, this new semantic clarifies the behavior.

  A significant amount of data is stored in the duplicated context, including request scope, security details, and metadata. Duplicating a duplicated context is rather rare and is only done in a few places:

  - Quarkus REST Client when using OTel (but it's the same transaction, so no leak)
  - Quarkus Messaging connectors
  - Quarkus SmallRye Health (same transaction, so no leak)
impacted_packages:
  - purl: pkg:maven/io.quarkus/quarkus-vertx
    affected_versions: vers:maven/<3.15.6|>=3.16.0.CR1|<3.20.2|>=3.21.0.CR1|<3.24.1
    fixed_versions: vers:maven/3.15.6|3.20.2|3.24.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/maven/io.quarkus/quarkus-vertx/CVE-2025-49574.yml
weaknesses:
  - CWE-668
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/quarkusio/quarkus
    reference_type:
    reference_id:
  - url: https://github.com/quarkusio/quarkus/commit/2b58f59f4bf0bae7d35b1abb585b65f2a66787d1
    reference_type:
    reference_id:
  - url: https://github.com/quarkusio/quarkus/commit/31e8a3bfcf4e223788615d5ce25eb929ca251275
    reference_type:
    reference_id:
  - url: https://github.com/quarkusio/quarkus/commit/d1ee57e7b826872b6355cfec0ae13465840e232c
    reference_type:
    reference_id:
  - url: https://github.com/quarkusio/quarkus/issues/48227
    reference_type:
    reference_id:
  - url: https://github.com/quarkusio/quarkus/pull/48486
    reference_type:
    reference_id:
  - url: https://github.com/quarkusio/quarkus/releases/tag/3.24.1
    reference_type:
    reference_id:
  - url: https://github.com/quarkusio/quarkus/security/advisories/GHSA-9623-mj7j-p9v4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49574
    reference_type:
    reference_id: CVE-2025-49574
  - url: https://github.com/advisories/GHSA-9623-mj7j-p9v4
    reference_type:
    reference_id: GHSA-9623-mj7j-p9v4
