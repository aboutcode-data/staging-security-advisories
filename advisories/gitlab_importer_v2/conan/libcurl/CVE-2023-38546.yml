advisory_id: conan/libcurl/CVE-2023-38546
datasource_id: gitlab_importer_v2/conan/libcurl/CVE-2023-38546
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/libcurl/CVE-2023-38546.yml
aliases:
  - CVE-2023-38546
summary: |
  Cookie injection with none file
  This flaw allows an attacker to insert cookies at will into a running program
  using libcurl, if the specific series of conditions are met.

  libcurl performs transfers. In its API, an application creates "easy handles"
  that are the individual handles for single transfers.

  libcurl provides a function call that duplicates en easy handle called
  [curl_easy_duphandle](https://curl.se/libcurl/c/curl_easy_duphandle.html).

  If a transfer has cookies enabled when the handle is duplicated, the
  cookie-enable state is also cloned - but without cloning the actual
  cookies. If the source handle does not read any cookies from a specific file on
  disk, the cloned version of the handle would instead store the file name as
  `none` (using the four ASCII letters, no quotes).

  Subsequent use of the cloned handle that does not explicitly set a source to
  load cookies from would then inadvertently load cookies from a file named
  `none` - if such a file exists and is readable in the current directory of the
  program using libcurl. And if using the correct file format of course.
impacted_packages:
  - purl: pkg:conan/libcurl
    affected_versions: vers:conan/>=7.9.1|<8.4.0
    fixed_versions: vers:conan/8.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/libcurl/CVE-2023-38546.yml
weaknesses:
  - CWE-1035
  - CWE-937
references:
  - url: https://curl.se/docs/CVE-2023-38546.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38546
    reference_type:
    reference_id: CVE-2023-38546
