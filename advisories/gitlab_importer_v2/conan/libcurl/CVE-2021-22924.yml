advisory_id: conan/libcurl/CVE-2021-22924
datasource_id: gitlab_importer_v2/conan/libcurl/CVE-2021-22924
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/libcurl/CVE-2021-22924.yml
aliases:
  - CVE-2021-22924
summary: |
  Use of Incorrectly-Resolved Name or Reference
  libcurl keeps previously used connections in a connection pool for subsequent transfers to reuse, if one of them matches the setup. Due to errors in the logic, the config matching function does not take `issuercert` into account and it compared the involved paths *case insensitively*, which could lead to libcurl reusing wrong connections. File paths are, or can be, case sensitive on many systems but not all, and can even vary depending on used file systems. The comparison also didn't include the `issuer cert` which a transfer can set to qualify how to verify the server certificate.
impacted_packages:
  - purl: pkg:conan/libcurl
    affected_versions: vers:conan/>=7.10.4|<7.77.0
    fixed_versions: vers:conan/7.77.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/libcurl/CVE-2021-22924.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/libcurl/CVE-2021-22924.yml
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-706
references:
  - url: https://hackerone.com/reports/1223565
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-22924
    reference_type:
    reference_id: CVE-2021-22924
