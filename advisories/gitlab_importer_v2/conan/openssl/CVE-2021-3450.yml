advisory_id: conan/openssl/CVE-2021-3450
datasource_id: gitlab_importer_v2/conan/openssl/CVE-2021-3450
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/openssl/CVE-2021-3450.yml
aliases:
  - CVE-2021-3450
summary: |
  Improper Certificate Validation
  The `X509_V_FLAG_X509_STRICT` flag enables additional security checks of the certificates present in a certificate chain. An error in the implementation of this check meant that the result of a previous check to confirm that certificates in the chain are valid CA certificates was overwritten. This effectively bypasses the check that non-CA certificates must not be able to issue other certificates. If a `purpose` has been configured then there is a subsequent opportunity for checks that the certificate is a valid CA. All of the named `purpose` values implemented in libcrypto perform this check. Therefore, where a purpose is set the certificate chain will still be rejected even when the strict flag has been used. A `purpose` is set by default in libssl client and server certificate verification routines, but it can be overridden or removed by an application. In order to be affected, an application must explicitly set the `X509_V_FLAG_X509_STRICT` verification flag and either not set a `purpose` for the certificate verification or, in the case of TLS client or server applications, override the default `purpose`.
impacted_packages:
  - purl: pkg:conan/openssl
    affected_versions: vers:conan/>=1.1.1h|<1.1.1k
    fixed_versions: vers:conan/1.1.1q
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/openssl/CVE-2021-3450.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/openssl/CVE-2021-3450.yml
weaknesses:
  - CWE-295
  - CWE-1035
  - CWE-937
references:
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=2a40b7bc7b94dd7de897a74571e7024f0cf0d63b
    reference_type: commit
    reference_id: 1.1.1k git commit
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3450
    reference_type:
    reference_id: CVE-2021-3450
  - url: https://www.openssl.org/news/secadv/20210325.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
