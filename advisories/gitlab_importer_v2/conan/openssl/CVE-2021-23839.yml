advisory_id: conan/openssl/CVE-2021-23839
datasource_id: gitlab_importer_v2/conan/openssl/CVE-2021-23839
datasource_url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/openssl/CVE-2021-23839.yml
aliases:
  - CVE-2021-23839
summary: |
  Inadequate Encryption Strength
  OpenSSL supports SSLv2. If a client attempts to negotiate SSLv2 with a server that is configured to support both SSLv2 and more recent SSL and TLS versions then a check is made for a version rollback attack when unpadding an RSA signature. Clients that support SSL or TLS versions greater than SSLv2 are supposed to use a special form of padding. A server that supports greater than SSLv2 is supposed to reject connection attempts from a client where this special form of padding is present, because this indicates that a version rollback has occurred (i.e. both client and server support greater than SSLv2, and yet this is the version that is being requested). The implementation of this padding check inverted the logic so that the connection attempt is accepted if the padding is present, and rejected if it is absent. This means that such as server will accept a connection if a version rollback attack has occurred. Further the server will erroneously reject a connection if a normal SSLv2 connection attempt is made. In order to be vulnerable a server must: 1) have configured SSLv2 support at compile time (this is off by default), 2) have configured SSLv2 support at runtime (this is off by default), 3) have configured SSLv2 ciphersuites (these are not in the default ciphersuite list) The underlying error is in the implementation of the `RSA_padding_check_SSLv23()` function. This also affects the `RSA_SSLV23_PADDING` padding mode used by various other functions.
impacted_packages:
  - purl: pkg:conan/openssl
    affected_versions: vers:conan/1.0.2s
    fixed_versions: vers:conan/1.0.2u
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score:
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/openssl/CVE-2021-23839.yml
  - score:
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://gitlab.com/gitlab-org/advisories-community/-/blob/main/conan/openssl/CVE-2021-23839.yml
weaknesses:
  - CWE-1035
  - CWE-327
  - CWE-937
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-23839
    reference_type:
    reference_id: CVE-2021-23839
  - url: https://www.openssl.org/news/secadv/20210216.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
