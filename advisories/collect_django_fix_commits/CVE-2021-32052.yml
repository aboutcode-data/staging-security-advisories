advisory_id: CVE-2021-32052
datasource_id: collect_django_fix_commits/CVE-2021-32052
datasource_url: https://github.com/django/django
aliases: []
summary: "88d9b28c0c123157a66a288606c16ec5c3486a28:[2.2.x] Added CVE-2021-32052 to security\
  \ archive.\n\nBackport of efebcc429f048493d6bc710399e65d98081eafd5 from main\n068887450479e035247d410863de662687cee2dc:[3.1.x]\
  \ Added CVE-2021-32052 to security archive.\n\nBackport of efebcc429f048493d6bc710399e65d98081eafd5\
  \ from main\n0262579f2e2ede5f8f273cd789b73729200ca047:[3.2.x] Added CVE-2021-32052 to security\
  \ archive.\n\nBackport of efebcc429f048493d6bc710399e65d98081eafd5 from main\nefebcc429f048493d6bc710399e65d98081eafd5:Added\
  \ CVE-2021-32052 to security archive.\nd9594c4ea57b6309d93879805302cec9ae9f23ff:[2.2.x] Fixed\
  \ #32713, Fixed CVE-2021-32052 -- Prevented newlines and tabs from being accepted in URLValidator\
  \ on Python 3.9.5+.\n\nIn Python 3.9.5+ urllib.parse() automatically removes ASCII newlines\n\
  and tabs from URLs [1, 2]. Unfortunately it created an issue in\nthe URLValidator. URLValidator\
  \ uses urllib.urlsplit() and\nurllib.urlunsplit() for creating a URL variant with Punycode\
  \ which no\nlonger contains newlines and tabs in Python 3.9.5+. As a consequence,\nthe regular\
  \ expression matched the URL (without unsafe characters) and\nthe source value (with unsafe\
  \ characters) was considered valid.\n\n[1] https://bugs.python.org/issue43882 and\n[2] https://github.com/python/cpython/commit/76cd81d60310d65d01f9d7b48a8985d8ab89c8b4\n\
  \nBackport of e1e81aa1c4427411e3c68facdd761229ffea6f6f from main.\nafb23f5929944a407e4990edef1c7806a94c9879:[3.1.x]\
  \ Fixed #32713, Fixed CVE-2021-32052 -- Prevented newlines and tabs from being accepted in\
  \ URLValidator on Python 3.9.5+.\n\nIn Python 3.9.5+ urllib.parse() automatically removes\
  \ ASCII newlines\nand tabs from URLs [1, 2]. Unfortunately it created an issue in\nthe URLValidator.\
  \ URLValidator uses urllib.urlsplit() and\nurllib.urlunsplit() for creating a URL variant\
  \ with Punycode which no\nlonger contains newlines and tabs in Python 3.9.5+. As a consequence,\n\
  the regular expression matched the URL (without unsafe characters) and\nthe source value (with\
  \ unsafe characters) was considered valid.\n\n[1] https://bugs.python.org/issue43882 and\n\
  [2] https://github.com/python/cpython/commit/76cd81d60310d65d01f9d7b48a8985d8ab89c8b4\n\n\
  Backport of e1e81aa1c4427411e3c68facdd761229ffea6f6f from main.\n2d2c1d0c97832860fbd6597977e2aae17dd7e5b2:[3.2.x]\
  \ Fixed #32713, Fixed CVE-2021-32052 -- Prevented newlines and tabs from being accepted in\
  \ URLValidator on Python 3.9.5+.\n\nIn Python 3.9.5+ urllib.parse() automatically removes\
  \ ASCII newlines\nand tabs from URLs [1, 2]. Unfortunately it created an issue in\nthe URLValidator.\
  \ URLValidator uses urllib.urlsplit() and\nurllib.urlunsplit() for creating a URL variant\
  \ with Punycode which no\nlonger contains newlines and tabs in Python 3.9.5+. As a consequence,\n\
  the regular expression matched the URL (without unsafe characters) and\nthe source value (with\
  \ unsafe characters) was considered valid.\n\n[1] https://bugs.python.org/issue43882 and\n\
  [2] https://github.com/python/cpython/commit/76cd81d60310d65d01f9d7b48a8985d8ab89c8b4\n\n\
  Backport of e1e81aa1c4427411e3c68facdd761229ffea6f6f from main.\ne1e81aa1c4427411e3c68facdd761229ffea6f6f:Fixed\
  \ #32713, Fixed CVE-2021-32052 -- Prevented newlines and tabs from being accepted in URLValidator\
  \ on Python 3.9.5+.\n\nIn Python 3.9.5+ urllib.parse() automatically removes ASCII newlines\r\
  \nand tabs from URLs [1, 2]. Unfortunately it created an issue in\r\nthe URLValidator. URLValidator\
  \ uses urllib.urlsplit() and\r\nurllib.urlunsplit() for creating a URL variant with Punycode\
  \ which no\r\nlonger contains newlines and tabs in Python 3.9.5+. As a consequence,\r\nthe\
  \ regular expression matched the URL (without unsafe characters) and\r\nthe source value (with\
  \ unsafe characters) was considered valid.\r\n\r\n[1] https://bugs.python.org/issue43882 and\r\
  \n[2] https://github.com/python/cpython/commit/76cd81d60310d65d01f9d7b48a8985d8ab89c8b4"
impacted_packages:
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: afb23f5929944a407e4990edef1c7806a94c9879
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 88d9b28c0c123157a66a288606c16ec5c3486a28
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 068887450479e035247d410863de662687cee2dc
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: e1e81aa1c4427411e3c68facdd761229ffea6f6f
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 0262579f2e2ede5f8f273cd789b73729200ca047
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: d9594c4ea57b6309d93879805302cec9ae9f23ff
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 2d2c1d0c97832860fbd6597977e2aae17dd7e5b2
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: efebcc429f048493d6bc710399e65d98081eafd5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/django/django/tree/0262579f2e2ede5f8f273cd789b73729200ca047
    reference_type: commit
    reference_id: 0262579f2e2ede5f8f273cd789b73729200ca047
  - url: https://github.com/django/django/tree/068887450479e035247d410863de662687cee2dc
    reference_type: commit
    reference_id: 068887450479e035247d410863de662687cee2dc
  - url: https://github.com/django/django/tree/2d2c1d0c97832860fbd6597977e2aae17dd7e5b2
    reference_type: commit
    reference_id: 2d2c1d0c97832860fbd6597977e2aae17dd7e5b2
  - url: https://github.com/django/django/tree/88d9b28c0c123157a66a288606c16ec5c3486a28
    reference_type: commit
    reference_id: 88d9b28c0c123157a66a288606c16ec5c3486a28
  - url: https://github.com/django/django/tree/afb23f5929944a407e4990edef1c7806a94c9879
    reference_type: commit
    reference_id: afb23f5929944a407e4990edef1c7806a94c9879
  - url: https://github.com/django/django/tree/d9594c4ea57b6309d93879805302cec9ae9f23ff
    reference_type: commit
    reference_id: d9594c4ea57b6309d93879805302cec9ae9f23ff
  - url: https://github.com/django/django/tree/e1e81aa1c4427411e3c68facdd761229ffea6f6f
    reference_type: commit
    reference_id: e1e81aa1c4427411e3c68facdd761229ffea6f6f
  - url: https://github.com/django/django/tree/efebcc429f048493d6bc710399e65d98081eafd5
    reference_type: commit
    reference_id: efebcc429f048493d6bc710399e65d98081eafd5
