advisory_id: CVE-2019-12781
datasource_id: collect_django_fix_commits/CVE-2019-12781
datasource_url: https://github.com/django/django
aliases: []
summary: |
  6d054b5a8f8812169b74e4304291d94874c2b012:[1.11.x] Added CVE-2019-12781 to the security release archive.

  Backport of 868cd56f058ca203419ad0886353173b74c3bcf1 from master
  765dac3d76c5632258176b77a5687c83d464d52d:[2.1.x] Added CVE-2019-12781 to the security release archive.

  Backport of 868cd56f058ca203419ad0886353173b74c3bcf1 from master
  2b533ae60e37f68fc6e9328334cd813cf0b4aa09:[2.2.x] Added CVE-2019-12781 to the security release archive.

  Backport of 868cd56f058ca203419ad0886353173b74c3bcf1 from master
  868cd56f058ca203419ad0886353173b74c3bcf1:Added CVE-2019-12781 to the security release archive.
  32124fc41e75074141b05f10fc55a4f01ff7f050:[1.11.x] Fixed CVE-2019-12781 -- Made HttpRequest always trust SECURE_PROXY_SSL_HEADER if set.

  An HTTP request would not be redirected to HTTPS when the
  SECURE_PROXY_SSL_HEADER and SECURE_SSL_REDIRECT settings were used if
  the proxy connected to Django via HTTPS.

  HttpRequest.scheme will now always trust the SECURE_PROXY_SSL_HEADER if
  set, rather than falling back to the request scheme when the
  SECURE_PROXY_SSL_HEADER did not have the secure value.

  Thanks to Gavin Wahl for the report and initial patch suggestion, and
  Shai Berger for review.

  Backport of 54d0f5e62f54c29a12dd96f44bacd810cbe03ac8 from master.
  1e40f427bb8d0fb37cc9f830096a97c36c97af6f:[2.1.x] Fixed CVE-2019-12781 -- Made HttpRequest always trust SECURE_PROXY_SSL_HEADER if set.

  An HTTP request would not be redirected to HTTPS when the
  SECURE_PROXY_SSL_HEADER and SECURE_SSL_REDIRECT settings were used if
  the proxy connected to Django via HTTPS.

  HttpRequest.scheme will now always trust the SECURE_PROXY_SSL_HEADER if
  set, rather than falling back to the request scheme when the
  SECURE_PROXY_SSL_HEADER did not have the secure value.

  Thanks to Gavin Wahl for the report and initial patch suggestion, and
  Shai Berger for review.

  Backport of 54d0f5e62f54c29a12dd96f44bacd810cbe03ac8 from master
  77706a3e4766da5d5fb75c4db22a0a59a28e6cd6:[2.2.x] Fixed CVE-2019-12781 -- Made HttpRequest always trust SECURE_PROXY_SSL_HEADER if set.

  An HTTP request would not be redirected to HTTPS when the
  SECURE_PROXY_SSL_HEADER and SECURE_SSL_REDIRECT settings were used if
  the proxy connected to Django via HTTPS.

  HttpRequest.scheme will now always trust the SECURE_PROXY_SSL_HEADER if
  set, rather than falling back to the request scheme when the
  SECURE_PROXY_SSL_HEADER did not have the secure value.

  Thanks to Gavin Wahl for the report and initial patch suggestion, and
  Shai Berger for review.

  Backport of 54d0f5e62f54c29a12dd96f44bacd810cbe03ac8 from master
  54d0f5e62f54c29a12dd96f44bacd810cbe03ac8:Fixed CVE-2019-12781 -- Made HttpRequest always trust SECURE_PROXY_SSL_HEADER if set.

  An HTTP request would not be redirected to HTTPS when the
  SECURE_PROXY_SSL_HEADER and SECURE_SSL_REDIRECT settings were used if
  the proxy connected to Django via HTTPS.

  HttpRequest.scheme will now always trust the SECURE_PROXY_SSL_HEADER if
  set, rather than falling back to the request scheme when the
  SECURE_PROXY_SSL_HEADER did not have the secure value.

  Thanks to Gavin Wahl for the report and initial patch suggestion, and
  Shai Berger for review.
impacted_packages:
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 765dac3d76c5632258176b77a5687c83d464d52d
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 868cd56f058ca203419ad0886353173b74c3bcf1
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 54d0f5e62f54c29a12dd96f44bacd810cbe03ac8
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 77706a3e4766da5d5fb75c4db22a0a59a28e6cd6
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 6d054b5a8f8812169b74e4304291d94874c2b012
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 32124fc41e75074141b05f10fc55a4f01ff7f050
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 2b533ae60e37f68fc6e9328334cd813cf0b4aa09
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 1e40f427bb8d0fb37cc9f830096a97c36c97af6f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/django/django/tree/1e40f427bb8d0fb37cc9f830096a97c36c97af6f
    reference_type: commit
    reference_id: 1e40f427bb8d0fb37cc9f830096a97c36c97af6f
  - url: https://github.com/django/django/tree/2b533ae60e37f68fc6e9328334cd813cf0b4aa09
    reference_type: commit
    reference_id: 2b533ae60e37f68fc6e9328334cd813cf0b4aa09
  - url: https://github.com/django/django/tree/32124fc41e75074141b05f10fc55a4f01ff7f050
    reference_type: commit
    reference_id: 32124fc41e75074141b05f10fc55a4f01ff7f050
  - url: https://github.com/django/django/tree/54d0f5e62f54c29a12dd96f44bacd810cbe03ac8
    reference_type: commit
    reference_id: 54d0f5e62f54c29a12dd96f44bacd810cbe03ac8
  - url: https://github.com/django/django/tree/6d054b5a8f8812169b74e4304291d94874c2b012
    reference_type: commit
    reference_id: 6d054b5a8f8812169b74e4304291d94874c2b012
  - url: https://github.com/django/django/tree/765dac3d76c5632258176b77a5687c83d464d52d
    reference_type: commit
    reference_id: 765dac3d76c5632258176b77a5687c83d464d52d
  - url: https://github.com/django/django/tree/77706a3e4766da5d5fb75c4db22a0a59a28e6cd6
    reference_type: commit
    reference_id: 77706a3e4766da5d5fb75c4db22a0a59a28e6cd6
  - url: https://github.com/django/django/tree/868cd56f058ca203419ad0886353173b74c3bcf1
    reference_type: commit
    reference_id: 868cd56f058ca203419ad0886353173b74c3bcf1
