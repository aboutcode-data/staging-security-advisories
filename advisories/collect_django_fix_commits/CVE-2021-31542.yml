advisory_id: CVE-2021-31542
datasource_id: collect_django_fix_commits/CVE-2021-31542
datasource_url: https://github.com/django/django
aliases: []
summary: |
  3ba089ac7e5720a363d01499451bcfa8c74a56d9:[2.2.x] Refs #32718 -- Corrected CVE-2021-31542 release notes.

  Backport of d1f1417caed648db2f81a1ec28c47bf958c01958 from main.
  9fb9944d1cddf84335c2ab6cfa3d7c2672541ab6:[3.1.x] Refs #32718 -- Corrected CVE-2021-31542 release notes.

  Backport of d1f1417caed648db2f81a1ec28c47bf958c01958 from main.
  dc7b495dae31b5c8c059ff95a454f7f6e9b4c71d:[3.2.x] Refs #32718 -- Corrected CVE-2021-31542 release notes.

  Backport of d1f1417caed648db2f81a1ec28c47bf958c01958 from main
  d1f1417caed648db2f81a1ec28c47bf958c01958:Refs #32718 -- Corrected CVE-2021-31542 release notes.
  163700388cda2305c8dbcdb3ac1542a442f3e955:[2.2.x] Refs CVE-2021-31542 -- Skipped mock AWS storage test on Windows.

  The validate_file_name() sanitation introduced in
  0b79eb36915d178aef5c6a7bbce71b1e76d376d3 correctly rejects the example
  file name as containing path elements on Windows. This breaks the test
  introduced in 914c72be2abb1c6dd860cb9279beaa66409ae1b2 to allow path
  components for storages that may allow them.

  Test is skipped pending a discussed storage refactoring to support this
  use-case.

  Backport of a708f39ce67af174df90c5b5e50ad1976cec7cb8 from main
  fdbf4a7c1653f1e9842816ac352a3e43659e09be:[3.1.x] Refs CVE-2021-31542 -- Skipped mock AWS storage test on Windows.

  The validate_file_name() sanitation introduced in
  0b79eb36915d178aef5c6a7bbce71b1e76d376d3 correctly rejects the example
  file name as containing path elements on Windows. This breaks the test
  introduced in 914c72be2abb1c6dd860cb9279beaa66409ae1b2 to allow path
  components for storages that may allow them.

  Test is skipped pending a discussed storage refactoring to support this
  use-case.

  Backport of a708f39ce67af174df90c5b5e50ad1976cec7cb8 from main
  a937d7f2142eb6f987679efc82f2c74f47d17ce1:[3.2.x] Refs CVE-2021-31542 -- Skipped mock AWS storage test on Windows.

  The validate_file_name() sanitation introduced in
  0b79eb36915d178aef5c6a7bbce71b1e76d376d3 correctly rejects the example
  file name as containing path elements on Windows. This breaks the test
  introduced in 914c72be2abb1c6dd860cb9279beaa66409ae1b2 to allow path
  components for storages that may allow them.

  Test is skipped pending a discussed storage refactoring to support this
  use-case.

  Backport of a708f39ce67af174df90c5b5e50ad1976cec7cb8 from main
  a708f39ce67af174df90c5b5e50ad1976cec7cb8:Refs CVE-2021-31542 -- Skipped mock AWS storage test on Windows.

  The validate_file_name() sanitation introduced in
  0b79eb36915d178aef5c6a7bbce71b1e76d376d3 correctly rejects the example
  file name as containing path elements on Windows. This breaks the test
  introduced in 914c72be2abb1c6dd860cb9279beaa66409ae1b2 to allow path
  components for storages that may allow them.

  Test is skipped pending a discussed storage refactoring to support this
  use-case.
  bcafd9ba848d736769870b4fc940b2ebbf87a70a:[2.2.x] Added CVE-2021-31542 to security archive.

  Backport of 607ebbfba915de2d84eb943aa93654f31817a709 and
  62b2e8b37e37a313c63be40e3223ca4e830ebde3 from main
  48b39a8e9996ed1819254dda9d771125a0200adf:[3.1.x] Added CVE-2021-31542 to security archive.

  Backport of 607ebbfba915de2d84eb943aa93654f31817a709 and
  62b2e8b37e37a313c63be40e3223ca4e830ebde3 from main
  df801dde3344549bcd8db2abe6b0e4ac23f278ca:[3.2.x] Added CVE-2021-31542 to security archive.

  Backport of 607ebbfba915de2d84eb943aa93654f31817a709 and
  62b2e8b37e37a313c63be40e3223ca4e830ebde3 from main
  62b2e8b37e37a313c63be40e3223ca4e830ebde3:Added commits for CVE-2021-31542 to security archive.
  607ebbfba915de2d84eb943aa93654f31817a709:Added CVE-2021-31542 to security archive.
  0b79eb36915d178aef5c6a7bbce71b1e76d376d3:Fixed CVE-2021-31542 -- Tightened path & file name sanitation in file uploads.
  c98f446c188596d4ba6de71d1b77b4a6c5c2a007:[3.2.x] Fixed CVE-2021-31542 -- Tightened path & file name sanitation in file uploads.
  25d84d64122c15050a0ee739e859f22ddab5ac48:[3.1.x] Fixed CVE-2021-31542 -- Tightened path & file name sanitation in file uploads.
  04ac1624bdc2fa737188401757cf95ced122d26d:[2.2.x] Fixed CVE-2021-31542 -- Tightened path & file name sanitation in file uploads.
impacted_packages:
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 48b39a8e9996ed1819254dda9d771125a0200adf
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: d1f1417caed648db2f81a1ec28c47bf958c01958
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 607ebbfba915de2d84eb943aa93654f31817a709
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 0b79eb36915d178aef5c6a7bbce71b1e76d376d3
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: a708f39ce67af174df90c5b5e50ad1976cec7cb8
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 62b2e8b37e37a313c63be40e3223ca4e830ebde3
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 04ac1624bdc2fa737188401757cf95ced122d26d
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 163700388cda2305c8dbcdb3ac1542a442f3e955
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: bcafd9ba848d736769870b4fc940b2ebbf87a70a
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: c98f446c188596d4ba6de71d1b77b4a6c5c2a007
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 3ba089ac7e5720a363d01499451bcfa8c74a56d9
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: a937d7f2142eb6f987679efc82f2c74f47d17ce1
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: df801dde3344549bcd8db2abe6b0e4ac23f278ca
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 9fb9944d1cddf84335c2ab6cfa3d7c2672541ab6
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: dc7b495dae31b5c8c059ff95a454f7f6e9b4c71d
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 25d84d64122c15050a0ee739e859f22ddab5ac48
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: fdbf4a7c1653f1e9842816ac352a3e43659e09be
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/django/django/tree/04ac1624bdc2fa737188401757cf95ced122d26d
    reference_type: commit
    reference_id: 04ac1624bdc2fa737188401757cf95ced122d26d
  - url: https://github.com/django/django/tree/0b79eb36915d178aef5c6a7bbce71b1e76d376d3
    reference_type: commit
    reference_id: 0b79eb36915d178aef5c6a7bbce71b1e76d376d3
  - url: https://github.com/django/django/tree/163700388cda2305c8dbcdb3ac1542a442f3e955
    reference_type: commit
    reference_id: 163700388cda2305c8dbcdb3ac1542a442f3e955
  - url: https://github.com/django/django/tree/25d84d64122c15050a0ee739e859f22ddab5ac48
    reference_type: commit
    reference_id: 25d84d64122c15050a0ee739e859f22ddab5ac48
  - url: https://github.com/django/django/tree/3ba089ac7e5720a363d01499451bcfa8c74a56d9
    reference_type: commit
    reference_id: 3ba089ac7e5720a363d01499451bcfa8c74a56d9
  - url: https://github.com/django/django/tree/48b39a8e9996ed1819254dda9d771125a0200adf
    reference_type: commit
    reference_id: 48b39a8e9996ed1819254dda9d771125a0200adf
  - url: https://github.com/django/django/tree/607ebbfba915de2d84eb943aa93654f31817a709
    reference_type: commit
    reference_id: 607ebbfba915de2d84eb943aa93654f31817a709
  - url: https://github.com/django/django/tree/62b2e8b37e37a313c63be40e3223ca4e830ebde3
    reference_type: commit
    reference_id: 62b2e8b37e37a313c63be40e3223ca4e830ebde3
  - url: https://github.com/django/django/tree/9fb9944d1cddf84335c2ab6cfa3d7c2672541ab6
    reference_type: commit
    reference_id: 9fb9944d1cddf84335c2ab6cfa3d7c2672541ab6
  - url: https://github.com/django/django/tree/a708f39ce67af174df90c5b5e50ad1976cec7cb8
    reference_type: commit
    reference_id: a708f39ce67af174df90c5b5e50ad1976cec7cb8
  - url: https://github.com/django/django/tree/a937d7f2142eb6f987679efc82f2c74f47d17ce1
    reference_type: commit
    reference_id: a937d7f2142eb6f987679efc82f2c74f47d17ce1
  - url: https://github.com/django/django/tree/bcafd9ba848d736769870b4fc940b2ebbf87a70a
    reference_type: commit
    reference_id: bcafd9ba848d736769870b4fc940b2ebbf87a70a
  - url: https://github.com/django/django/tree/c98f446c188596d4ba6de71d1b77b4a6c5c2a007
    reference_type: commit
    reference_id: c98f446c188596d4ba6de71d1b77b4a6c5c2a007
  - url: https://github.com/django/django/tree/d1f1417caed648db2f81a1ec28c47bf958c01958
    reference_type: commit
    reference_id: d1f1417caed648db2f81a1ec28c47bf958c01958
  - url: https://github.com/django/django/tree/dc7b495dae31b5c8c059ff95a454f7f6e9b4c71d
    reference_type: commit
    reference_id: dc7b495dae31b5c8c059ff95a454f7f6e9b4c71d
  - url: https://github.com/django/django/tree/df801dde3344549bcd8db2abe6b0e4ac23f278ca
    reference_type: commit
    reference_id: df801dde3344549bcd8db2abe6b0e4ac23f278ca
  - url: https://github.com/django/django/tree/fdbf4a7c1653f1e9842816ac352a3e43659e09be
    reference_type: commit
    reference_id: fdbf4a7c1653f1e9842816ac352a3e43659e09be
