advisory_id: CVE-2026-1312
datasource_id: collect_django_fix_commits/CVE-2026-1312
datasource_url: https://github.com/django/django
aliases: []
summary: |
  e0896dfe83cce33b5cae3fcf0bbbef89e92b4bc6:[4.2.x] Added CVE-2025-13473, CVE-2025-14550, CVE-2026-1207, CVE-2026-1285, CVE-2026-1287, and CVE-2026-1312 to security archive.

  Backport of af361d3be4725b9da1022c078b2db02b9d9b96e7 from main.
  dc32c07a3a2ef4045dd07624829b491fb75f46a6:[5.2.x] Added CVE-2025-13473, CVE-2025-14550, CVE-2026-1207, CVE-2026-1285, CVE-2026-1287, and CVE-2026-1312 to security archive.

  Backport of af361d3be4725b9da1022c078b2db02b9d9b96e7 from main.
  7b6b78f3de90f97259576da44a6120f974526579:[6.0.x] Added CVE-2025-13473, CVE-2025-14550, CVE-2026-1207, CVE-2026-1285, CVE-2026-1287, and CVE-2026-1312 to security archive.

  Backport of af361d3be4725b9da1022c078b2db02b9d9b96e7 from main.
  af361d3be4725b9da1022c078b2db02b9d9b96e7:Added CVE-2025-13473, CVE-2025-14550, CVE-2026-1207, CVE-2026-1285, CVE-2026-1287, and CVE-2026-1312 to security archive.
  881ff2c4830f95fa844d8de5977c06205d45368f:[4.2.x] Refs CVE-2026-1312 -- Raised ValueError when FilteredRelation aliases contain periods.

  This prevents failures at the database layer, given that aliases in the
  ON clause are not quoted.

  Systematically quoting aliases even in FilteredRelation is tracked in
  https://code.djangoproject.com/ticket/36795.

  Backport of 005d60d97c4dfb117503bdb6f2facfcaf9315d84 from main.
  90f5b10784ba5bf369caed87640e2b4394ea3314:[4.2.x] Fixed CVE-2026-1312 -- Protected order_by() from SQL injection via aliases with periods.

  Before, `order_by()` treated a period in a field name as a sign that it
  was requested via `.extra(order_by=...)` and thus should be passed
  through as raw table and column names, even if `extra()` was not used.
  Since periods are permitted in aliases, this meant user-controlled
  aliases could force the `order_by()` clause to resolve to a raw table
  and column pair instead of the actual target field for the alias.

  In practice, only `FilteredRelation` was affected, as the other
  expressions we tested, e.g. `F`, aggressively optimize away the ordering
  expressions into ordinal positions, e.g. ORDER BY 2, instead of ORDER BY
  "table".column.

  Thanks Solomon Kebede for the report, and Simon Charette and Jake Howard
  for reviews.

  Backport of 69065ca869b0970dff8fdd8fafb390bf8b3bf222 from main.
  ab0ad8d39555292b55123adeac57ed64c776f8d9:[5.2.x] Refs CVE-2026-1312 -- Raised ValueError when FilteredRelation aliases contain periods.

  This prevents failures at the database layer, given that aliases in the
  ON clause are not quoted.

  Systematically quoting aliases even in FilteredRelation is tracked in
  https://code.djangoproject.com/ticket/36795.

  Backport of 005d60d97c4dfb117503bdb6f2facfcaf9315d84 from main.
  e863ee273c6553e9b6fa4960a17acb535851857b:[5.2.x] Fixed CVE-2026-1312 -- Protected order_by() from SQL injection via aliases with periods.

  Before, `order_by()` treated a period in a field name as a sign that it
  was requested via `.extra(order_by=...)` and thus should be passed
  through as raw table and column names, even if `extra()` was not used.
  Since periods are permitted in aliases, this meant user-controlled
  aliases could force the `order_by()` clause to resolve to a raw table
  and column pair instead of the actual target field for the alias.

  In practice, only `FilteredRelation` was affected, as the other
  expressions we tested, e.g. `F`, aggressively optimize away the ordering
  expressions into ordinal positions, e.g. ORDER BY 2, instead of ORDER BY
  "table".column.

  Thanks Solomon Kebede for the report, and Simon Charette and Jake Howard
  for reviews.

  Backport of 69065ca869b0970dff8fdd8fafb390bf8b3bf222 from main.
  259dff061a9ea85f061ff71c0adb0e07ead693d3:[6.0.x] Refs CVE-2026-1312 -- Raised ValueError when FilteredRelation aliases contain periods.

  This prevents failures at the database layer, given that aliases in the
  ON clause are not quoted.

  Systematically quoting aliases even in FilteredRelation is tracked in
  https://code.djangoproject.com/ticket/36795.

  Backport of 005d60d97c4dfb117503bdb6f2facfcaf9315d84 from main.
  15e70cb83e6f7a9a2a2f651f30b28b5cb20febeb:[6.0.x] Fixed CVE-2026-1312 -- Protected order_by() from SQL injection via aliases with periods.

  Before, `order_by()` treated a period in a field name as a sign that it
  was requested via `.extra(order_by=...)` and thus should be passed
  through as raw table and column names, even if `extra()` was not used.
  Since periods are permitted in aliases, this meant user-controlled
  aliases could force the `order_by()` clause to resolve to a raw table
  and column pair instead of the actual target field for the alias.

  In practice, only `FilteredRelation` was affected, as the other
  expressions we tested, e.g. `F`, aggressively optimize away the ordering
  expressions into ordinal positions, e.g. ORDER BY 2, instead of ORDER BY
  "table".column.

  Thanks Solomon Kebede for the report, and Simon Charette and Jake Howard
  for reviews.

  Backport of 69065ca869b0970dff8fdd8fafb390bf8b3bf222 from main.
  005d60d97c4dfb117503bdb6f2facfcaf9315d84:Refs CVE-2026-1312 -- Raised ValueError when FilteredRelation aliases contain periods.

  This prevents failures at the database layer, given that aliases in the
  ON clause are not quoted.

  Systematically quoting aliases even in FilteredRelation is tracked in
  https://code.djangoproject.com/ticket/36795.
  69065ca869b0970dff8fdd8fafb390bf8b3bf222:Fixed CVE-2026-1312 -- Protected order_by() from SQL injection via aliases with periods.

  Before, `order_by()` treated a period in a field name as a sign that it
  was requested via `.extra(order_by=...)` and thus should be passed
  through as raw table and column names, even if `extra()` was not used.
  Since periods are permitted in aliases, this meant user-controlled
  aliases could force the `order_by()` clause to resolve to a raw table
  and column pair instead of the actual target field for the alias.

  In practice, only `FilteredRelation` was affected, as the other
  expressions we tested, e.g. `F`, aggressively optimize away the ordering
  expressions into ordinal positions, e.g. ORDER BY 2, instead of ORDER BY
  "table".column.

  Thanks Solomon Kebede for the report, and Simon Charette and Jake Howard
  for reviews.
impacted_packages:
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 881ff2c4830f95fa844d8de5977c06205d45368f
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 7b6b78f3de90f97259576da44a6120f974526579
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 90f5b10784ba5bf369caed87640e2b4394ea3314
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 259dff061a9ea85f061ff71c0adb0e07ead693d3
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 005d60d97c4dfb117503bdb6f2facfcaf9315d84
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 15e70cb83e6f7a9a2a2f651f30b28b5cb20febeb
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: af361d3be4725b9da1022c078b2db02b9d9b96e7
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: e0896dfe83cce33b5cae3fcf0bbbef89e92b4bc6
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: e863ee273c6553e9b6fa4960a17acb535851857b
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: dc32c07a3a2ef4045dd07624829b491fb75f46a6
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: ab0ad8d39555292b55123adeac57ed64c776f8d9
    introduced_in_commits: []
  - purl: pkg:github/django/django
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/django/django
        commit: 69065ca869b0970dff8fdd8fafb390bf8b3bf222
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/django/django/tree/005d60d97c4dfb117503bdb6f2facfcaf9315d84
    reference_type: commit
    reference_id: 005d60d97c4dfb117503bdb6f2facfcaf9315d84
  - url: https://github.com/django/django/tree/15e70cb83e6f7a9a2a2f651f30b28b5cb20febeb
    reference_type: commit
    reference_id: 15e70cb83e6f7a9a2a2f651f30b28b5cb20febeb
  - url: https://github.com/django/django/tree/259dff061a9ea85f061ff71c0adb0e07ead693d3
    reference_type: commit
    reference_id: 259dff061a9ea85f061ff71c0adb0e07ead693d3
  - url: https://github.com/django/django/tree/69065ca869b0970dff8fdd8fafb390bf8b3bf222
    reference_type: commit
    reference_id: 69065ca869b0970dff8fdd8fafb390bf8b3bf222
  - url: https://github.com/django/django/tree/7b6b78f3de90f97259576da44a6120f974526579
    reference_type: commit
    reference_id: 7b6b78f3de90f97259576da44a6120f974526579
  - url: https://github.com/django/django/tree/881ff2c4830f95fa844d8de5977c06205d45368f
    reference_type: commit
    reference_id: 881ff2c4830f95fa844d8de5977c06205d45368f
  - url: https://github.com/django/django/tree/90f5b10784ba5bf369caed87640e2b4394ea3314
    reference_type: commit
    reference_id: 90f5b10784ba5bf369caed87640e2b4394ea3314
  - url: https://github.com/django/django/tree/ab0ad8d39555292b55123adeac57ed64c776f8d9
    reference_type: commit
    reference_id: ab0ad8d39555292b55123adeac57ed64c776f8d9
  - url: https://github.com/django/django/tree/af361d3be4725b9da1022c078b2db02b9d9b96e7
    reference_type: commit
    reference_id: af361d3be4725b9da1022c078b2db02b9d9b96e7
  - url: https://github.com/django/django/tree/dc32c07a3a2ef4045dd07624829b491fb75f46a6
    reference_type: commit
    reference_id: dc32c07a3a2ef4045dd07624829b491fb75f46a6
  - url: https://github.com/django/django/tree/e0896dfe83cce33b5cae3fcf0bbbef89e92b4bc6
    reference_type: commit
    reference_id: e0896dfe83cce33b5cae3fcf0bbbef89e92b4bc6
  - url: https://github.com/django/django/tree/e863ee273c6553e9b6fa4960a17acb535851857b
    reference_type: commit
    reference_id: e863ee273c6553e9b6fa4960a17acb535851857b
