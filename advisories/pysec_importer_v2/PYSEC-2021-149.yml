advisory_id: PYSEC-2021-149
datasource_id: pysec_importer_v2/PYSEC-2021-149
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - BIT-tensorflow-2021-29512
  - CVE-2021-29512
  - GHSA-4278-2v5v-65r4
  - PYSEC-2021-440
  - PYSEC-2021-638
summary: TensorFlow is an end-to-end open source platform for machine learning. If the `splits`
  argument of `RaggedBincount` does not specify a valid `SparseTensor`(https://www.tensorflow.org/api_docs/python/tf/sparse/SparseTensor),
  then an attacker can trigger a heap buffer overflow. This will cause a read from outside the
  bounds of the `splits` tensor buffer in the implementation of the `RaggedBincount` op(https://github.com/tensorflow/tensorflow/blob/8b677d79167799f71c42fd3fa074476e0295413a/tensorflow/core/kernels/bincount_op.cc#L430-L433).
  Before the `for` loop, `batch_idx` is set to 0. The user controls the `splits` array, making
  it contain only one element, 0. Thus, the code in the `while` loop would increment `batch_idx`
  and then try to read `splits(1)`, which is outside of bounds. The fix will be included in
  TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2 and TensorFlow 2.3.3,
  as these are also affected.
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/2.3.0|2.3.1|2.3.2|2.4.0|2.4.1
    fixed_versions: vers:pypi/2.3.3|2.4.2
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: eebb96c2830d48597d055d247c0e9aebaea94cd5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/eebb96c2830d48597d055d247c0e9aebaea94cd5
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-4278-2v5v-65r4
    reference_type:
    reference_id:
