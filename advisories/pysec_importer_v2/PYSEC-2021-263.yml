advisory_id: PYSEC-2021-263
datasource_id: pysec_importer_v2/PYSEC-2021-263
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - BIT-tensorflow-2021-37641
  - CVE-2021-37641
  - GHSA-9c8h-vvrj-w2p8
  - PYSEC-2021-554
  - PYSEC-2021-752
summary: TensorFlow is an end-to-end open source platform for machine learning. In affected
  versions if the arguments to `tf.raw_ops.RaggedGather` don't determine a valid ragged tensor
  code can trigger a read from outside of bounds of heap allocated buffers. The [implementation](https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/ragged_gather_op.cc#L70)
  directly reads the first dimension of a tensor shape before checking that said tensor has
  rank of at least 1 (i.e., it is not a scalar). Furthermore, the implementation does not check
  that the list given by `params_nested_splits` is not an empty list of tensors. We have patched
  the issue in GitHub commit a2b743f6017d7b97af1fe49087ae15f0ac634373. The fix will be included
  in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3,
  and TensorFlow 2.3.4, as these are also affected and still in supported range.
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/2.3.0|2.3.1|2.3.2|2.3.3|2.4.0|2.4.1|2.4.2
    fixed_versions: vers:pypi/2.3.4|2.4.3
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: a2b743f6017d7b97af1fe49087ae15f0ac634373
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/a2b743f6017d7b97af1fe49087ae15f0ac634373
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-9c8h-vvrj-w2p8
    reference_type:
    reference_id:
