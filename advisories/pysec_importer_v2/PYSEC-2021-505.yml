advisory_id: PYSEC-2021-505
datasource_id: pysec_importer_v2/PYSEC-2021-505
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - BIT-tensorflow-2021-29577
  - CVE-2021-29577
  - GHSA-v6r6-84gr-92rm
  - PYSEC-2021-214
  - PYSEC-2021-703
summary: TensorFlow is an end-to-end open source platform for machine learning. The implementation
  of `tf.raw_ops.AvgPool3DGrad` is vulnerable to a heap buffer overflow. The implementation(https://github.com/tensorflow/tensorflow/blob/d80ffba9702dc19d1fac74fc4b766b3fa1ee976b/tensorflow/core/kernels/pooling_ops_3d.cc#L376-L450)
  assumes that the `orig_input_shape` and `grad` tensors have similar first and last dimensions
  but does not check that this assumption is validated. The fix will be included in TensorFlow
  2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow
  2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.
impacted_packages:
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/1.15.0|2.1.0|2.1.1|2.1.2|2.1.3|2.2.0|2.2.1|2.2.2|2.3.0|2.3.1|2.3.2|2.4.0|2.4.1
    fixed_versions: vers:pypi/2.1.4|2.2.3|2.3.3|2.4.2
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: 6fc9141f42f6a72180ecd24021c3e6b36165fe0d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/6fc9141f42f6a72180ecd24021c3e6b36165fe0d
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-v6r6-84gr-92rm
    reference_type:
    reference_id:
