advisory_id: PYSEC-2021-780
datasource_id: pysec_importer_v2/PYSEC-2021-780
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - BIT-tensorflow-2021-37669
  - CVE-2021-37669
  - GHSA-vmjw-c2vp-p33c
  - PYSEC-2021-291
  - PYSEC-2021-582
summary: TensorFlow is an end-to-end open source platform for machine learning. In affected
  versions an attacker can cause denial of service in applications serving models using `tf.raw_ops.NonMaxSuppressionV5`
  by triggering a division by 0. The [implementation](https://github.com/tensorflow/tensorflow/blob/460e000de3a83278fb00b61a16d161b1964f15f4/tensorflow/core/kernels/image/non_max_suppression_op.cc#L170-L271)
  uses a user controlled argument to resize a `std::vector`. However, as `std::vector::resize`
  takes the size argument as a `size_t` and `output_size` is an `int`, there is an implicit
  conversion to unsigned. If the attacker supplies a negative value, this conversion results
  in a crash. A similar issue occurs in `CombinedNonMaxSuppression`. We have patched the issue
  in GitHub commit 3a7362750d5c372420aa8f0caf7bf5b5c3d0f52d and commit [b5cdbf12ffcaaffecf98f22a6be5a64bb96e4f58.
  The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow
  2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported
  range.
impacted_packages:
  - purl: pkg:pypi/tensorflow-gpu
    affected_versions: vers:pypi/2.3.0|2.3.1|2.3.2|2.3.3|2.4.0|2.4.1|2.4.2
    fixed_versions: vers:pypi/2.3.4|2.4.3
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: 3a7362750d5c372420aa8f0caf7bf5b5c3d0f52d
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: b5cdbf12ffcaaffecf98f22a6be5a64bb96e4f58
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/3a7362750d5c372420aa8f0caf7bf5b5c3d0f52d
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/b5cdbf12ffcaaffecf98f22a6be5a64bb96e4f58
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-vmjw-c2vp-p33c
    reference_type:
    reference_id:
