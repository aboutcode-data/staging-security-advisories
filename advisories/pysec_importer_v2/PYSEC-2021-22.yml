advisory_id: PYSEC-2021-22
datasource_id: pysec_importer_v2/PYSEC-2021-22
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - CVE-2021-29431
  - GHSA-9jhm-8m8c-c3f4
summary: Sydent is a reference Matrix identity server. Sydent can be induced to send HTTP GET
  requests to internal systems, due to lack of parameter validation or IP address blacklisting.
  It is not possible to exfiltrate data or control request headers, but it might be possible
  to use the attack to perform an internal port enumeration. This issue has been addressed in
  in 9e57334, 8936925, 3d531ed, 0f00412. A potential workaround would be to use a firewall to
  ensure that Sydent cannot reach internal HTTP resources.
impacted_packages:
  - purl: pkg:pypi/matrix-sydent
    affected_versions: vers:pypi/2.0.0|2.0.1|2.1.0|2.2.0
    fixed_versions: vers:pypi/2.3.0
    fixed_in_commits:
      - vcs_url: https://github.com/matrix-org/sydent
        commit: 3d531ed50d2fd41ac387f36d44d3fb2c62dd22d3
      - vcs_url: https://github.com/matrix-org/sydent
        commit: 0f00412017f25619bc36c264b29ea96808bf310a
      - vcs_url: https://github.com/matrix-org/sydent
        commit: 9e573348d81df8191bbe8c266c01999c9d57cd5f
      - vcs_url: https://github.com/matrix-org/sydent
        commit: 8936925f561b0c352c2fa922d5097d7245aad00a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/matrix-org/sydent/commit/0f00412017f25619bc36c264b29ea96808bf310a
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/3d531ed50d2fd41ac387f36d44d3fb2c62dd22d3
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/8936925f561b0c352c2fa922d5097d7245aad00a
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/9e573348d81df8191bbe8c266c01999c9d57cd5f
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/releases/tag/v2.3.0
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/security/advisories/GHSA-9jhm-8m8c-c3f4
    reference_type:
    reference_id:
  - url: https://pypi.org/project/matrix-sydent/
    reference_type:
    reference_id:
