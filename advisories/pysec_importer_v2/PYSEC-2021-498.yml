advisory_id: PYSEC-2021-498
datasource_id: pysec_importer_v2/PYSEC-2021-498
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - BIT-tensorflow-2021-29570
  - CVE-2021-29570
  - GHSA-545v-42p7-98fq
  - PYSEC-2021-207
  - PYSEC-2021-696
summary: TensorFlow is an end-to-end open source platform for machine learning. The implementation
  of `tf.raw_ops.MaxPoolGradWithArgmax` can cause reads outside of bounds of heap allocated
  data if attacker supplies specially crafted inputs. The implementation(https://github.com/tensorflow/tensorflow/blob/ef0c008ee84bad91ec6725ddc42091e19a30cf0e/tensorflow/core/kernels/maxpooling_op.cc#L1016-L1017)
  uses the same value to index in two different arrays but there is no guarantee that the sizes
  are identical. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this
  commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these
  are also affected and still in supported range.
impacted_packages:
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/1.15.0|2.1.0|2.1.1|2.1.2|2.1.3|2.2.0|2.2.1|2.2.2|2.3.0|2.3.1|2.3.2|2.4.0|2.4.1
    fixed_versions: vers:pypi/2.1.4|2.2.3|2.3.3|2.4.2
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: dcd7867de0fea4b72a2b34bd41eb74548dc23886
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/dcd7867de0fea4b72a2b34bd41eb74548dc23886
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-545v-42p7-98fq
    reference_type:
    reference_id:
