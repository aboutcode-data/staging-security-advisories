advisory_id: PYSEC-2021-119
datasource_id: pysec_importer_v2/PYSEC-2021-119
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - CVE-2021-38305
  - GHSA-435p-f82x-mxwm
summary: 23andMe Yamale before 3.0.8 allows remote attackers to execute arbitrary code via a
  crafted schema file. The schema parser uses eval as part of its processing, and tries to protect
  from malicious expressions by limiting the builtins that are passed to the eval. When processing
  the schema, each line is run through Python's eval function to make the validator available.
  A well-constructed string within the schema rules can execute system commands; thus, by exploiting
  the vulnerability, an attacker can run arbitrary code on the image that invokes Yamale.
impacted_packages:
  - purl: pkg:pypi/yamale
    affected_versions: vers:pypi/1.1.3|1.2.0|1.2.1|1.3.0|1.3.1|1.4.0|1.4.1|1.5.0|1.5.2|1.5.3|1.5.4|1.5.5|1.5.6|1.6.0|1.6.1|1.6.2|1.6.3|1.6.4|1.7.0|1.7.1|1.8.0|1.8.1|1.9.0|1.10.0|1.10.1|2.0|2.0.1|2.1.0|2.2.0|3.0.0|3.0.1|3.0.2|3.0.3|3.0.4|3.0.5|3.0.6|3.0.7
    fixed_versions: vers:pypi/3.0.8
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/23andMe/Yamale/pull/165
    reference_type:
    reference_id:
  - url: https://github.com/23andMe/Yamale/releases/tag/3.0.8
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-435p-f82x-mxwm
    reference_type:
    reference_id:
