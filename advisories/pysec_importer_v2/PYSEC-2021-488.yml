advisory_id: PYSEC-2021-488
datasource_id: pysec_importer_v2/PYSEC-2021-488
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - BIT-tensorflow-2021-29560
  - CVE-2021-29560
  - GHSA-8gv3-57p6-g35r
  - PYSEC-2021-197
  - PYSEC-2021-686
summary: TensorFlow is an end-to-end open source platform for machine learning. An attacker
  can cause a heap buffer overflow in `tf.raw_ops.RaggedTensorToTensor`. This is because the
  implementation(https://github.com/tensorflow/tensorflow/blob/d94227d43aa125ad8b54115c03cece54f6a1977b/tensorflow/core/kernels/ragged_tensor_to_tensor_op.cc#L219-L222)
  uses the same index to access two arrays in parallel. Since the user controls the shape of
  the input arguments, an attacker could trigger a heap OOB access when `parent_output_index`
  is shorter than `row_split`. The fix will be included in TensorFlow 2.5.0. We will also cherrypick
  this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4,
  as these are also affected and still in supported range.
impacted_packages:
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/1.15.0|2.1.0|2.1.1|2.1.2|2.1.3|2.1.4|2.2.0|2.2.1|2.2.2|2.2.3|2.3.0|2.3.1|2.3.2|2.3.3|2.4.0|2.4.1|2.4.2
    fixed_versions: vers:pypi/2.2.0rc0|2.3.0rc0|2.3.4|2.4.3
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: a84358aa12f0b1518e606095ab9cfddbf597c121
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/a84358aa12f0b1518e606095ab9cfddbf597c121
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-8gv3-57p6-g35r
    reference_type:
    reference_id:
