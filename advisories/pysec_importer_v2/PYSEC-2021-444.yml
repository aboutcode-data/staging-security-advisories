advisory_id: PYSEC-2021-444
datasource_id: pysec_importer_v2/PYSEC-2021-444
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - BIT-tensorflow-2021-29516
  - CVE-2021-29516
  - GHSA-84mw-34w6-2q43
  - PYSEC-2021-153
  - PYSEC-2021-642
summary: TensorFlow is an end-to-end open source platform for machine learning. Calling `tf.raw_ops.RaggedTensorToVariant`
  with arguments specifying an invalid ragged tensor results in a null pointer dereference.
  The implementation of `RaggedTensorToVariant` operations(https://github.com/tensorflow/tensorflow/blob/904b3926ed1c6c70380d5313d282d248a776baa1/tensorflow/core/kernels/ragged_tensor_to_variant_op.cc#L39-L40)
  does not validate that the ragged tensor argument is non-empty. Since `batched_ragged` contains
  no elements, `batched_ragged.splits` is a null vector, thus `batched_ragged.splits(0)` will
  result in dereferencing `nullptr`. The fix will be included in TensorFlow 2.5.0. We will also
  cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow
  2.1.4, as these are also affected and still in supported range.
impacted_packages:
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/1.15.0|2.1.0|2.1.1|2.1.2|2.1.3|2.2.0|2.2.1|2.2.2|2.3.0|2.3.1|2.3.2|2.4.0|2.4.1
    fixed_versions: vers:pypi/2.1.4|2.2.3|2.3.3|2.4.2
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: b055b9c474cd376259dde8779908f9eeaf097d93
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/b055b9c474cd376259dde8779908f9eeaf097d93
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-84mw-34w6-2q43
    reference_type:
    reference_id:
