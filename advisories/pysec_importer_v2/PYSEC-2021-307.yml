advisory_id: PYSEC-2021-307
datasource_id: pysec_importer_v2/PYSEC-2021-307
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - BIT-tensorflow-2021-37685
  - CVE-2021-37685
  - GHSA-c545-c4f9-rf6v
  - PYSEC-2021-598
  - PYSEC-2021-796
summary: TensorFlow is an end-to-end open source platform for machine learning. In affected
  versions TFLite's [`expand_dims.cc`](https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/lite/kernels/expand_dims.cc#L36-L50)
  contains a vulnerability which allows reading one element outside of bounds of heap allocated
  data. If `axis` is a large negative value (e.g., `-100000`), then after the first `if` it
  would still be negative. The check following the `if` statement will pass and the `for` loop
  would read one element before the start of `input_dims.data` (when `i = 0`). We have patched
  the issue in GitHub commit d94ffe08a65400f898241c0374e9edc6fa8ed257. The fix will be included
  in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3,
  and TensorFlow 2.3.4, as these are also affected and still in supported range.
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/2.3.0|2.3.1|2.3.2|2.3.3|2.4.0|2.4.1|2.4.2
    fixed_versions: vers:pypi/2.3.4|2.4.3
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: d94ffe08a65400f898241c0374e9edc6fa8ed257
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/d94ffe08a65400f898241c0374e9edc6fa8ed257
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-c545-c4f9-rf6v
    reference_type:
    reference_id:
