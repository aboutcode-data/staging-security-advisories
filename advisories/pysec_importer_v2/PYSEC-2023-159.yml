advisory_id: PYSEC-2023-159
datasource_id: pysec_importer_v2/PYSEC-2023-159
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - CVE-2023-41039
  - GHSA-xjw2-6jm9-rf67
summary: RestrictedPython is a restricted execution environment for Python to run untrusted
  code. Python's "format" functionality allows someone controlling the format string to "read"
  all objects accessible through recursive attribute lookup and subscription from objects he
  can access. This can lead to critical information disclosure. With `RestrictedPython`, the
  format functionality is available via the `format` and `format_map` methods of `str` (and
  `unicode`) (accessed either via the class or its instances) and via `string.Formatter`. All
  known versions of `RestrictedPython` are vulnerable. This issue has been addressed in commit
  `4134aedcff1` which has been included in the 5.4 and 6.2 releases. Users are advised to upgrade.
  There are no known workarounds for this vulnerability.
impacted_packages:
  - purl: pkg:pypi/restrictedpython
    affected_versions: vers:pypi/3.4.2|3.4.3|3.5.0|3.5.1|3.5.2|3.6.0a1|3.6.0|4.0a1|4.0a2|4.0a3|4.0b1|4.0b2|4.0b3|4.0b4|4.0b5|4.0b6|4.0b7|4.0b8|4.0|5.0|5.1|5.2a1.dev0|5.2|5.3a1.dev0|5.3|6.0|6.1
    fixed_versions: vers:pypi/5.4|6.2
    fixed_in_commits:
      - vcs_url: https://github.com/zopefoundation/restrictedpython
        commit: 4134aedcff17c977da7717693ed89ce56d54c120
    introduced_in_commits: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
weaknesses: []
references:
  - url: https://github.com/zopefoundation/RestrictedPython/commit/4134aedcff17c977da7717693ed89ce56d54c120
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-xjw2-6jm9-rf67
    reference_type:
    reference_id:
