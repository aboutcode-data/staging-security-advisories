advisory_id: PYSEC-2021-312
datasource_id: pysec_importer_v2/PYSEC-2021-312
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - BIT-tensorflow-2021-37690
  - CVE-2021-37690
  - GHSA-3hxh-8cp2-g4hg
  - PYSEC-2021-603
  - PYSEC-2021-801
summary: TensorFlow is an end-to-end open source platform for machine learning. In affected
  versions when running shape functions, some functions (such as `MutableHashTableShape`) produce
  extra output information in the form of a `ShapeAndType` struct. The shapes embedded in this
  struct are owned by an inference context that is cleaned up almost immediately; if the upstream
  code attempts to access this shape information, it can trigger a segfault. `ShapeRefiner`
  is mitigating this for normal output shapes by cloning them (and thus putting the newly created
  shape under ownership of an inference context that will not die), but we were not doing the
  same for shapes and types. This commit fixes that by doing similar logic on output shapes
  and types. We have patched the issue in GitHub commit ee119d4a498979525046fba1c3dd3f13a039fbb1.
  The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow
  2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported
  range.
impacted_packages:
  - purl: pkg:pypi/tensorflow
    affected_versions: vers:pypi/2.3.0|2.3.1|2.3.2|2.3.3|2.4.0|2.4.1|2.4.2
    fixed_versions: vers:pypi/2.3.4|2.4.3
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: ee119d4a498979525046fba1c3dd3f13a039fbb1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/ee119d4a498979525046fba1c3dd3f13a039fbb1
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-3hxh-8cp2-g4hg
    reference_type:
    reference_id:
