advisory_id: PYSEC-2022-87
datasource_id: pysec_importer_v2/PYSEC-2022-87
datasource_url: https://osv-vulnerabilities.storage.googleapis.com/PyPI/all.zip
aliases:
  - BIT-tensorflow-2022-23578
  - CVE-2022-23578
  - GHSA-8r7c-3cm2-3h8f
  - PYSEC-2022-142
summary: Tensorflow is an Open Source Machine Learning Framework. If a graph node is invalid,
  TensorFlow can leak memory in the implementation of `ImmutableExecutorState::Initialize`.
  Here, we set `item->kernel` to `nullptr` but it is a simple `OpKernel*` pointer so the memory
  that was previously allocated to it would leak. The fix will be included in TensorFlow 2.8.0.
  We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow
  2.5.3, as these are also affected and still in supported range.
impacted_packages:
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/1.15.0|2.1.0|2.1.1|2.1.2|2.1.3|2.1.4|2.2.0|2.2.1|2.2.2|2.2.3|2.3.0|2.3.1|2.3.2|2.3.3|2.3.4|2.4.0|2.4.1|2.4.2|2.4.3|2.4.4|2.5.0|2.5.1|2.5.2|2.6.0|2.6.1|2.6.2
    fixed_versions: vers:pypi/2.5.3|2.6.3
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: c79ccba517dbb1a0ccb9b01ee3bd2a63748b60dd
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/blob/a1320ec1eac186da1d03f033109191f715b2b130/tensorflow/core/common_runtime/immutable_executor_state.cc#L84-L262
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/c79ccba517dbb1a0ccb9b01ee3bd2a63748b60dd
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-8r7c-3cm2-3h8f
    reference_type:
    reference_id:
