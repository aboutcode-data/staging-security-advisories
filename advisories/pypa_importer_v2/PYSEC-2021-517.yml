advisory_id: PYSEC-2021-517
datasource_id: pypa_importer_v2/PYSEC-2021-517
datasource_url: https://github.com/pypa/advisory-database/blob/main/vulns/tensorflow-cpu/PYSEC-2021-517.yaml
aliases:
  - CVE-2021-29589
  - GHSA-3w67-q784-6w7c
summary: TensorFlow is an end-to-end open source platform for machine learning. The reference
  implementation of the `GatherNd` TFLite operator is vulnerable to a division by zero error(https://github.com/tensorflow/tensorflow/blob/0d45ea1ca641b21b73bcf9c00e0179cda284e7e7/tensorflow/lite/kernels/internal/reference/reference_ops.h#L966).
  An attacker can craft a model such that `params` input would be an empty tensor. In turn,
  `params_shape.Dims(.)` would be zero, in at least one dimension. The fix will be included
  in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3,
  TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.
impacted_packages:
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/1.15.0|2.1.0|2.1.1|2.1.2|2.1.3|2.1.4|2.2.0|2.2.1|2.2.2|2.2.3|2.3.0|2.3.1|2.3.2|2.3.3|2.4.0|2.4.1|2.4.2
    fixed_versions: vers:pypi/2.2.0rc0|2.3.0rc0|2.3.4|2.4.3
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: 8e45822aa0b9f5df4b4c64f221e64dc930a70a9d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/8e45822aa0b9f5df4b4c64f221e64dc930a70a9d
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-3w67-q784-6w7c
    reference_type:
    reference_id:
