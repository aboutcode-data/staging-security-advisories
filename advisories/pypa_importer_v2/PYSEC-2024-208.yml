advisory_id: PYSEC-2024-208
datasource_id: pypa_importer_v2/PYSEC-2024-208
datasource_url: https://github.com/pypa/advisory-database/blob/main/vulns/vyper/PYSEC-2024-208.yaml
aliases:
  - CVE-2024-32647
summary: Vyper is a pythonic Smart Contract Language for the Ethereum virtual machine. In versions
  0.3.10 and prior, using the `create_from_blueprint` builtin can result in a double eval vulnerability
  when `raw_args=True` and the `args` argument has side-effects. It can be seen that the `_build_create_IR`
  function of the `create_from_blueprint` builtin doesn't cache the mentioned `args` argument
  to the stack. As such, it can be evaluated multiple times (instead of retrieving the value
  from the stack). No vulnerable production contracts were found. Additionally, double evaluation
  of side-effects should be easily discoverable in client tests. As such, the impact is low.
  As of time of publication, no fixed versions exist.
impacted_packages:
  - purl: pkg:pypi/vyper
    affected_versions: vers:pypi/0.1.0b1|0.1.0b2|0.1.0b3|0.1.0b4|0.1.0b5|0.1.0b6|0.1.0b7|0.1.0b8|0.1.0b9|0.1.0b10|0.1.0b11|0.1.0b12|0.1.0b13|0.1.0b14|0.1.0b15|0.1.0b16|0.1.0b17|0.2.1|0.2.2|0.2.3|0.2.4|0.2.5|0.2.6|0.2.7|0.2.8|0.2.9|0.2.10|0.2.11|0.2.12|0.2.13|0.2.14|0.2.15|0.2.16|0.3.0|0.3.1|0.3.2|0.3.3|0.3.4|0.3.5|0.3.6|0.3.7|0.3.8|0.3.9|0.3.10rc1|0.3.10rc2|0.3.10rc3|0.3.10rc4|0.3.10rc5|0.3.10|0.4.0b1|0.4.0b2|0.4.0b3|0.4.0b4|0.4.0b5|0.4.0b6|0.4.0rc1|0.4.0rc2|0.4.0rc3|0.4.0rc4|0.4.0rc5|0.4.0rc6
    fixed_versions: vers:pypi/0.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/blob/main/vulns/vyper/PYSEC-2024-208.yaml
weaknesses: []
references:
  - url: https://github.com/vyperlang/vyper/blob/cedf7087e68e67c7bfbd47ae95dcb16b81ad2e02/vyper/builtins/functions.py#L1847
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-3whq-64q2-qfj6
    reference_type:
    reference_id:
