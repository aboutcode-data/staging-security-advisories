advisory_id: PYSEC-2021-612
datasource_id: pypa_importer_v2/PYSEC-2021-612
datasource_url: https://github.com/pypa/advisory-database/blob/main/vulns/tensorflow-cpu/PYSEC-2021-612.yaml
aliases:
  - CVE-2021-41202
  - GHSA-xrqm-fpgr-6hhx
summary: 'TensorFlow is an open source platform for machine learning. In affected versions while
  calculating the size of the output within the `tf.range` kernel, there is a conditional statement
  of type `int64 = condition ? int64 : double`. Due to C++ implicit conversion rules, both branches
  of the condition will be cast to `double` and the result would be truncated before the assignment.
  This result in overflows. The fix will be included in TensorFlow 2.7.0. We will also cherrypick
  this commit on TensorFlow 2.6.1, TensorFlow 2.5.2, and TensorFlow 2.4.4, as these are also
  affected and still in supported range.'
impacted_packages:
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/1.15.0|2.1.0|2.1.1|2.1.2|2.1.3|2.1.4|2.2.0|2.2.1|2.2.2|2.2.3|2.3.0|2.3.1|2.3.2|2.3.3|2.3.4|2.4.0|2.4.1|2.4.2|2.4.3|2.5.0|2.5.1|2.6.0|2.7.0rc0|2.7.0rc1
    fixed_versions: vers:pypi/2.4.4|2.5.2|2.6.1|2.7.0
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: 1b0e0ec27e7895b9985076eab32445026ae5ca94
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: 6d94002a09711d297dbba90390d5482b76113899
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/1b0e0ec27e7895b9985076eab32445026ae5ca94
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/6d94002a09711d297dbba90390d5482b76113899
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/issues/46889
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/issues/46912
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-xrqm-fpgr-6hhx
    reference_type:
    reference_id:
