advisory_id: PYSEC-2021-468
datasource_id: pypa_importer_v2/PYSEC-2021-468
datasource_url: https://github.com/pypa/advisory-database/blob/main/vulns/tensorflow-cpu/PYSEC-2021-468.yaml
aliases:
  - CVE-2021-29540
  - GHSA-xgc3-m89p-vr3x
summary: TensorFlow is an end-to-end open source platform for machine learning. An attacker
  can cause a heap buffer overflow to occur in `Conv2DBackpropFilter`. This is because the implementation(https://github.com/tensorflow/tensorflow/blob/1b0296c3b8dd9bd948f924aa8cd62f87dbb7c3da/tensorflow/core/kernels/conv_grad_filter_ops.cc#L495-L497)
  computes the size of the filter tensor but does not validate that it matches the number of
  elements in `filter_sizes`. Later, when reading/writing to this buffer, code uses the value
  computed here, instead of the number of elements in the tensor. The fix will be included in
  TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3,
  TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.
impacted_packages:
  - purl: pkg:pypi/tensorflow-cpu
    affected_versions: vers:pypi/1.15.0|2.1.0|2.1.1|2.1.2|2.1.3|2.1.4|2.2.0|2.2.1|2.2.2|2.2.3|2.3.0|2.3.1|2.3.2|2.3.3|2.4.0|2.4.1|2.4.2
    fixed_versions: vers:pypi/2.2.0rc0|2.3.0rc0|2.3.4|2.4.3
    fixed_in_commits:
      - vcs_url: https://github.com/tensorflow/tensorflow
        commit: c570e2ecfc822941335ad48f6e10df4e21f11c96
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/tensorflow/tensorflow/commit/c570e2ecfc822941335ad48f6e10df4e21f11c96
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-xgc3-m89p-vr3x
    reference_type:
    reference_id:
