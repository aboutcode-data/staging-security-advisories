advisory_id: PYSEC-2024-103
datasource_id: pypa_importer_v2/PYSEC-2024-103
datasource_url: https://github.com/pypa/advisory-database/blob/main/vulns/vyper/PYSEC-2024-103.yaml
aliases:
  - CVE-2024-22419
  - GHSA-2q8v-3gqq-4f8p
summary: Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine. The `concat`
  built-in can write over the bounds of the memory buffer that was allocated for it and thus
  overwrite existing valid data. The root cause is that the `build_IR` for `concat` doesn't
  properly adhere to the API of copy functions (for `>=0.3.2` the `copy_bytes` function). A
  contract search was performed and no vulnerable contracts were found in production. The buffer
  overflow can result in the change of semantics of the contract. The overflow is length-dependent
  and thus it might go unnoticed during contract testing. However, certainly not all usages
  of concat will result in overwritten valid data as we require it to be in an internal function
  and close to the return statement where other memory allocations don't occur. This issue has
  been addressed in 0.4.0.
impacted_packages:
  - purl: pkg:pypi/vyper
    affected_versions: vers:pypi/0.1.0b1|0.1.0b2|0.1.0b3|0.1.0b4|0.1.0b5|0.1.0b6|0.1.0b7|0.1.0b8|0.1.0b9|0.1.0b10|0.1.0b11|0.1.0b12|0.1.0b13|0.1.0b14|0.1.0b15|0.1.0b16|0.1.0b17|0.2.1|0.2.2|0.2.3|0.2.4|0.2.5|0.2.6|0.2.7|0.2.8|0.2.9|0.2.10|0.2.11|0.2.12|0.2.13|0.2.14|0.2.15|0.2.16|0.3.0|0.3.1|0.3.2|0.3.3|0.3.4|0.3.5|0.3.6|0.3.7|0.3.8|0.3.9|0.3.10rc1|0.3.10rc2|0.3.10rc3|0.3.10rc4|0.3.10rc5|0.3.10
    fixed_versions: vers:pypi/0.4.0b1
    fixed_in_commits:
      - vcs_url: https://github.com/vyperlang/vyper
        commit: 55e18f6d128b2da8986adbbcccf1cd59a4b9ad6f
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/blob/main/vulns/vyper/PYSEC-2024-103.yaml
weaknesses: []
references:
  - url: https://github.com/vyperlang/vyper/commit/55e18f6d128b2da8986adbbcccf1cd59a4b9ad6f
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/issues/3737
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-2q8v-3gqq-4f8p
    reference_type:
    reference_id:
