advisory_id: PYSEC-2021-868
datasource_id: pypa_importer_v2/PYSEC-2021-868
datasource_url: https://github.com/pypa/advisory-database/blob/main/vulns/unicorn/PYSEC-2021-868.yaml
aliases:
  - CVE-2021-44078
summary: An issue was discovered in split_region in uc.c in Unicorn Engine before 2.0.0-rc5.
  It allows local attackers to escape the sandbox. An attacker must first obtain the ability
  to execute crafted code in the target sandbox in order to exploit this vulnerability. The
  specific flaw exists within the virtual memory manager. The issue results from the faulty
  comparison of GVA and GPA while calling uc_mem_map_ptr to free part of a claimed memory block.
  An attacker can leverage this vulnerability to escape the sandbox and execute arbitrary code
  on the host machine.
impacted_packages:
  - purl: pkg:pypi/unicorn
    affected_versions: vers:pypi/1.0.0rc2|1.0.0rc3|1.0.0|1.0.1|1.0.2rc1|1.0.2rc2|1.0.2rc3|1.0.2rc4|1.0.2rc5|1.0.2rc6|1.0.2|1.0.3
    fixed_versions: vers:pypi/2.0.0rc1
    fixed_in_commits:
      - vcs_url: https://github.com/unicorn-engine/unicorn
        commit: c733bbada356b0373fa8aa72c044574bb855fd24
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gist.github.com/jwang-a/cb4b6e9551457aa299066076b836a2cd
    reference_type:
    reference_id:
  - url: https://github.com/jwang-a/CTF/blob/master/MyChallenges/Pwn/Unicorns_Aisle/UnicornsAisle.pdf
    reference_type:
    reference_id:
  - url: https://github.com/unicorn-engine/unicorn/commit/c733bbada356b0373fa8aa72c044574bb855fd24
    reference_type:
    reference_id:
  - url: https://github.com/unicorn-engine/unicorn/compare/2.0.0-rc4...2.0.0-rc5
    reference_type:
    reference_id:
  - url: https://www.unicorn-engine.org/changelog/
    reference_type:
    reference_id:
