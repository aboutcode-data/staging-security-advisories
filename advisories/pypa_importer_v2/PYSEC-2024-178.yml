advisory_id: PYSEC-2024-178
datasource_id: pypa_importer_v2/PYSEC-2024-178
datasource_url: https://github.com/pypa/advisory-database/blob/main/vulns/litestar/PYSEC-2024-178.yaml
aliases:
  - CVE-2024-52581
summary: Litestar is an Asynchronous Server Gateway Interface (ASGI) framework. Prior to version
  2.13.0, the multipart form parser shipped with litestar expects the entire request body as
  a single byte string and there is no default limit for the total size of the request body.
  This allows an attacker to upload arbitrary large files wrapped in a `multipart/form-data`
  request and cause excessive memory consumption on the server. The multipart form parser in
  affected versions is vulnerable to this type of attack by design. The public method signature
  as well as its implementation both expect the entire request body to be available as a single
  byte string. It is not possible to accept large file uploads in a safe way using this parser.
  This may be a regression, as a variation of this issue was already reported in CVE-2023-25578.
  Limiting the part number is not sufficient to prevent out-of-memory errors on the server.
  A patch is available in version 2.13.0.
impacted_packages:
  - purl: pkg:pypi/litestar
    affected_versions: vers:pypi/1.0.0a0|2.0.0a3|2.0.0a4|2.0.0a5|2.0.0a6|2.0.0a7|2.0.0b1|2.0.0b2|2.0.0b3|2.0.0b4|2.0.0rc1|2.0.0|2.0.1|2.1.0|2.1.1|2.2.0|2.2.1|2.3.0|2.3.1|2.3.2|2.4.0|2.4.1|2.4.2|2.4.3|2.4.4|2.4.5|2.5.0|2.5.1|2.5.2|2.5.3|2.5.4|2.5.5|2.6.0|2.6.1|2.6.2|2.6.3|2.6.4|2.7.0|2.7.1|2.7.2|2.8.0|2.8.1|2.8.2|2.8.3|2.9.0|2.9.1|2.10.0|2.11.0|2.12.0|2.12.1
    fixed_versions: vers:pypi/2.13.0
    fixed_in_commits:
      - vcs_url: https://github.com/litestar-org/litestar
        commit: 53c1473b5ff7502816a9a339ffc90731bb0c2138
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/blob/main/vulns/litestar/PYSEC-2024-178.yaml
weaknesses: []
references:
  - url: https://github.com/litestar-org/litestar/blob/main/litestar/_multipart.py#L97
    reference_type:
    reference_id:
  - url: https://github.com/litestar-org/litestar/commit/53c1473b5ff7502816a9a339ffc90731bb0c2138
    reference_type:
    reference_id:
  - url: https://github.com/litestar-org/litestar/security/advisories/GHSA-gjcc-jvgw-wvwj
    reference_type:
    reference_id:
  - url: https://github.com/litestar-org/litestar/security/advisories/GHSA-p24m-863f-fm6q
    reference_type:
    reference_id:
