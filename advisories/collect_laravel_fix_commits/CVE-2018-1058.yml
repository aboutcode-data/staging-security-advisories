advisory_id: CVE-2018-1058
datasource_id: collect_laravel_fix_commits/CVE-2018-1058
datasource_url: https://github.com/laravel/framework
aliases: []
summary: "e615d237173915f6ec555b4f8d7f5d43385e8449:Account for special '$user' variable appearing\
  \ as first schema in search_path (#35567)\n\nGiven that the default search_path value in a\
  \ PostgreSQL installation is '\"$user\", public', or perhaps just '\"$user\"', as may be the\
  \ case if hardened against CVE-2018-1058, it is preferable to account for the possibility\
  \ that an end-user may wish to configure a PostgreSQL database connection in Laravel to mimic\
  \ said default.\r\n\r\nNow, if '$user' is the first schema in the search_path, the PostgresBuilder\
  \ will resolve that schema name to the username defined on the database connection whenever\
  \ appropriate, e.g., in the hasTable() and getColumnListing() methods."
impacted_packages:
  - purl: pkg:github/laravel/framework
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/laravel/framework
        commit: e615d237173915f6ec555b4f8d7f5d43385e8449
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/laravel/framework/tree/e615d237173915f6ec555b4f8d7f5d43385e8449
    reference_type: commit
    reference_id: e615d237173915f6ec555b4f8d7f5d43385e8449
