advisory_id: php-dompdf/CVE-2021-3838
datasource_id: debian_importer_v2/php-dompdf/CVE-2021-3838
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-3838
aliases:
  - CVE-2021-3838
summary: DomPDF before version 2.0.0 is vulnerable to PHAR deserialization due to a lack of
  checking on the protocol before passing it into the file_get_contents() function. An attacker
  who can upload files of any type to the server can pass in the phar:// protocol to unserialize
  the uploaded file and instantiate arbitrary PHP objects. This can lead to remote code execution,
  especially when DOMPdf is used with frameworks with documented POP chains like Laravel or
  vulnerable developer code.
impacted_packages:
  - purl: pkg:deb/debian/php-dompdf?distro=sid
    affected_versions:
    fixed_versions: vers:deb/2.0.3+dfsg-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/php-dompdf?distro=sid
    affected_versions:
    fixed_versions: vers:deb/2.0.2+dfsg-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/php-dompdf?distro=sid
    affected_versions:
    fixed_versions: vers:deb/0.6.2+dfsg-3.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/php-dompdf?distro=sid
    affected_versions:
    fixed_versions: vers:deb/0.6.2+dfsg-3.1+deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/php-dompdf?distro=sid
    affected_versions:
    fixed_versions: vers:deb/3.1.4+dfsg-2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
