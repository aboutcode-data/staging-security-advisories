advisory_id: pdm/CVE-2023-45805
datasource_id: debian_importer_v2/pdm/CVE-2023-45805
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-45805
aliases:
  - CVE-2023-45805
summary: pdm is a Python package and dependency manager supporting the latest PEP standards.
  It's possible to craft a malicious `pdm.lock` file that could allow e.g. an insider or a malicious
  open source project to appear to depend on a trusted PyPI project, but actually install another
  project. A project `foo` can be targeted by creating the project `foo-2` and uploading the
  file `foo-2-2.tar.gz` to pypi.org. PyPI will see this as project `foo-2` version `2`, while
  PDM will see this as project `foo` version `2-2`. The version must only be `parseable as a
  version` and the filename must be a prefix of the project name, but it's not verified to match
  the version being installed. Version `2-2` is also not a valid normalized version per PEP
  440. Matching the project name exactly (not just prefix) would fix the issue. When installing
  dependencies with PDM, what's actually installed could differ from what's listed in `pyproject.toml`
  (including arbitrary code execution on install). It could also be used for downgrade attacks
  by only changing the version. This issue has been addressed in commit `6853e2642df` which
  is included in release version `2.9.4`. Users are advised to upgrade. There are no known workarounds
  for this vulnerability.
impacted_packages:
  - purl: pkg:deb/debian/pdm?distro=trixie
    affected_versions: vers:deb/2.2.1+ds1-1
    fixed_versions: vers:deb/2.26.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/pdm?distro=trixie
    affected_versions: vers:deb/2.2.1+ds1-1
    fixed_versions: vers:deb/2.20.0.post1+ds1-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/pdm?distro=trixie
    affected_versions: vers:deb/2.2.1+ds1-1
    fixed_versions: vers:deb/2.20.1+ds1-2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1054428
    reference_type:
    reference_id: 1054428
