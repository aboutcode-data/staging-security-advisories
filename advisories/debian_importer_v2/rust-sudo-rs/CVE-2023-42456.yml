advisory_id: rust-sudo-rs/CVE-2023-42456
datasource_id: debian_importer_v2/rust-sudo-rs/CVE-2023-42456
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-42456
aliases:
  - CVE-2023-42456
summary: Sudo-rs, a memory safe implementation of sudo and su, allows users to not have to enter
  authentication at every sudo attempt, but instead only requiring authentication every once
  in a while in every terminal or process group. Only once a configurable timeout has passed
  will the user have to re-authenticate themselves. Supporting this functionality is a set of
  session files (timestamps) for each user, stored in `/var/run/sudo-rs/ts`. These files are
  named according to the username from which the sudo attempt is made (the origin user).  An
  issue was discovered in versions prior to 0.2.1 where usernames containing the `.` and `/`
  characters could result in the corruption of specific files on the filesystem. As usernames
  are generally not limited by the characters they can contain, a username appearing to be a
  relative path can be constructed. For example we could add a user to the system containing
  the username `../../../../bin/cp`. When logged in as a user with that name, that user could
  run `sudo -K` to clear their session record file. The session code then constructs the path
  to the session file by concatenating the username to the session file storage directory, resulting
  in a resolved path of `/bin/cp`. The code then clears that file, resulting in the `cp` binary
  effectively being removed from the system.  An attacker needs to be able to login as a user
  with a constructed username. Given that such a username is unlikely to exist on an existing
  system, they will also need to be able to create the users with the constructed usernames.  The
  issue is patched in version 0.2.1 of sudo-rs. Sudo-rs now uses the uid for the user instead
  of their username for determining the filename. Note that an upgrade to this version will
  result in existing session files being ignored and users will be forced to re-authenticate.
  It also fully eliminates any possibility of path traversal, given that uids are always integer
  values.  The `sudo -K` and `sudo -k` commands can run, even if a user has no sudo access.
  As a workaround, make sure that one's system does not contain any users with a specially crafted
  username. While this is the case and while untrusted users do not have the ability to create
  arbitrary users on the system, one should not be able to exploit this issue.
impacted_packages:
  - purl: pkg:deb/debian/rust-sudo-rs?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0.2.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/rust-sudo-rs?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/rust-sudo-rs?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0.2.5-5+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
