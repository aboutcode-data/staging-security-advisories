advisory_id: wayland/CVE-2021-3782
datasource_id: debian_importer_v2/wayland/CVE-2021-3782
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-3782
aliases:
  - CVE-2021-3782
summary: An internal reference count is held on the buffer pool, incremented every time a new
  buffer is created from the pool. The reference count is maintained as an int; on LP64 systems
  this can cause the reference count to overflow if the client creates a large number of wl_shm
  buffer objects, or if it can coerce the server to create a large number of external references
  to the buffer storage. With the reference count overflowing, a use-after-free can be constructed
  on the wl_shm_pool tracking structure, where values may be incremented or decremented; it
  may also be possible to construct a limited oracle to leak 4 bytes of server-side memory to
  the attacking client at a time.
impacted_packages:
  - purl: pkg:deb/debian/wayland?distro=trixie
    affected_versions: vers:deb/1.18.0-2~exp1.1
    fixed_versions: vers:deb/1.21.0-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/wayland?distro=trixie
    affected_versions: vers:deb/1.18.0-2~exp1.1
    fixed_versions: vers:deb/1.24.0-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/wayland?distro=trixie
    affected_versions: vers:deb/1.18.0-2~exp1.1
    fixed_versions: vers:deb/1.23.1-3
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
