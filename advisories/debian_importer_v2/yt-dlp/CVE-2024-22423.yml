advisory_id: yt-dlp/CVE-2024-22423
datasource_id: debian_importer_v2/yt-dlp/CVE-2024-22423
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-22423
aliases:
  - CVE-2024-22423
summary: yt-dlp is a youtube-dl fork with additional features and fixes. The patch that addressed
  CVE-2023-40581 attempted to prevent RCE when using `--exec` with `%q` by replacing double
  quotes with two double quotes. However, this escaping is not sufficient, and still allows
  expansion of environment variables. Support for output template expansion in `--exec`, along
  with this vulnerable behavior, was added to `yt-dlp` in version 2021.04.11. yt-dlp version
  2024.04.09 fixes this issue by properly escaping `%`. It replaces them with `%%cd:~,%`, a
  variable that expands to nothing, leaving only the leading percent. It is recommended to upgrade
  yt-dlp to version 2024.04.09 as soon as possible. Also, always be careful when using `--exec`,
  because while this specific vulnerability has been patched, using unvalidated input in shell
  commands is inherently dangerous. For Windows users who are not able to upgrade, avoid using
  any output template expansion in `--exec` other than `{}` (filepath); if expansion in `--exec`
  is needed, verify the fields you are using do not contain `"`, `|` or `&`; and/or instead
  of using `--exec`, write the info json and load the fields from it instead.
impacted_packages:
  - purl: pkg:deb/debian/yt-dlp?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2023.03.04-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/yt-dlp?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/yt-dlp?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2026.01.31-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/yt-dlp?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2026.02.21-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/yt-dlp?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2025.04.30-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
