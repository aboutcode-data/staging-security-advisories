advisory_id: libreswan/CVE-2023-38710
datasource_id: debian_importer_v2/libreswan/CVE-2023-38710
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-38710
aliases:
  - CVE-2023-38710
summary: 'An issue was discovered in Libreswan before 4.12. When an IKEv2 Child SA REKEY packet
  contains an invalid IPsec protocol ID number of 0 or 1, an error notify INVALID_SPI is sent
  back. The notify payload''s protocol ID is copied from the incoming packet, but the code that
  verifies outgoing packets fails an assertion that the protocol ID must be ESP (2) or AH(3)
  and causes the pluto daemon to crash and restart. NOTE: the earliest affected version is 3.20.'
impacted_packages:
  - purl: pkg:deb/debian/libreswan?distro=trixie
    affected_versions: vers:deb/4.3-1+deb11u4|4.10-2+deb12u1
    fixed_versions: vers:deb/5.2-2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libreswan?distro=trixie
    affected_versions: vers:deb/4.3-1+deb11u4|4.10-2+deb12u1
    fixed_versions: vers:deb/4.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libreswan?distro=trixie
    affected_versions: vers:deb/4.3-1+deb11u4|4.10-2+deb12u1
    fixed_versions: vers:deb/5.2-2.2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
