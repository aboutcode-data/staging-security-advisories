advisory_id: vim/CVE-2024-43374
datasource_id: debian_importer_v2/vim/CVE-2024-43374
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-43374
aliases:
  - CVE-2024-43374
summary: The UNIX editor Vim prior to version 9.1.0678 has a use-after-free error in argument
  list handling. When adding a new file to the argument list, this triggers `Buf*` autocommands.
  If in such an autocommand the buffer that was just opened is closed (including the window
  where it is shown), this causes the window structure to be freed which contains a reference
  to the argument list that we are actually modifying. Once the autocommands are completed,
  the references to the window and argument list are no longer valid and as such cause an use-after-free.
  Impact is low since the user must either intentionally add some unusual autocommands that
  wipe a buffer during creation (either manually or by sourcing a malicious plugin), but it
  will crash Vim. The issue has been fixed as of Vim patch v9.1.0678.
impacted_packages:
  - purl: pkg:deb/debian/vim?distro=trixie
    affected_versions: vers:deb/2:8.2.2434-3+deb11u1|2:9.0.1378-2+deb12u2
    fixed_versions: vers:deb/2:9.1.2141-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/vim?distro=trixie
    affected_versions: vers:deb/2:8.2.2434-3+deb11u1|2:9.0.1378-2+deb12u2
    fixed_versions: vers:deb/2:9.1.0698-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/vim?distro=trixie
    affected_versions: vers:deb/2:8.2.2434-3+deb11u1|2:9.0.1378-2+deb12u2
    fixed_versions: vers:deb/2:9.1.1230-2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
