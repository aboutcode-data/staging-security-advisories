advisory_id: linux/CVE-2022-48790
datasource_id: debian_importer_v2/linux/CVE-2022-48790
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-48790
aliases:
  - CVE-2022-48790
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nvme: fix a possible
  use-after-free in controller reset during load  Unlike .queue_rq, in .submit_async_event drivers
  may not check the ctrl readiness for AER submission. This may lead to a use-after-free condition
  that was observed with nvme-tcp.  The race condition may happen in the following scenario:
  1. driver executes its reset_ctrl_work 2. -> nvme_stop_ctrl - flushes ctrl async_event_work
  3. ctrl sends AEN which is received by the host, which in turn    schedules AEN handling 4.
  teardown admin queue (which releases the queue socket) 5. AEN processed, submits another AER,
  calling the driver to submit 6. driver attempts to send the cmd ==> use-after-free  In order
  to fix that, add ctrl state check to validate the ctrl is actually able to accept the AER
  submission.  This addresses the above race in controller resets because the driver during
  teardown should: 1. change ctrl state to RESETTING 2. flush async_event_work (as well as other
  async work elements)  So after 1,2, any other AER command will find the ctrl state to be RESETTING
  and bail out without submitting the AER.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.16.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.103-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
