advisory_id: linux/CVE-2025-38100
datasource_id: debian_importer_v2/linux/CVE-2025-38100
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38100
aliases:
  - CVE-2025-38100
summary: 'In the Linux kernel, the following vulnerability has been resolved:  x86/iopl: Cure
  TIF_IO_BITMAP inconsistencies  io_bitmap_exit() is invoked from exit_thread() when a task
  exists or when a fork fails. In the latter case the exit_thread() cleans up resources which
  were allocated during fork().  io_bitmap_exit() invokes task_update_io_bitmap(), which in
  turn ends up in tss_update_io_bitmap(). tss_update_io_bitmap() operates on the current task.
  If current has TIF_IO_BITMAP set, but no bitmap installed, tss_update_io_bitmap() crashes
  with a NULL pointer dereference.  There are two issues, which lead to that problem:    1)
  io_bitmap_exit() should not invoke task_update_io_bitmap() when      the task, which is cleaned
  up, is not the current task. That''s a      clear indicator for a cleanup after a failed fork().    2)
  A task should not have TIF_IO_BITMAP set and neither a bitmap      installed nor IOPL emulation
  level 3 activated.       This happens when a kernel thread is created in the context of      a
  user space thread, which has TIF_IO_BITMAP set as the thread      flags are copied and the
  IO bitmap pointer is cleared.       Other than in the failed fork() case this has no impact
  because      kernel threads including IO workers never return to user space and      therefore
  never invoke tss_update_io_bitmap().  Cure this by adding the missing cleanups and checks:    1)
  Prevent io_bitmap_exit() to invoke task_update_io_bitmap() if      the to be cleaned up task
  is not the current task.    2) Clear TIF_IO_BITMAP in copy_thread() unconditionally. For user      space
  forks it is set later, when the IO bitmap is inherited in      io_bitmap_share().  For paranoia
  sake, add a warning into tss_update_io_bitmap() to catch the case, when that code is invoked
  with inconsistent state.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.147-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.35-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
