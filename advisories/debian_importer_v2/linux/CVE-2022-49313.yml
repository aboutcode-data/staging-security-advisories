advisory_id: linux/CVE-2022-49313
datasource_id: debian_importer_v2/linux/CVE-2022-49313
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49313
aliases:
  - CVE-2022-49313
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drivers: usb:
  host: Fix deadlock in oxu_bus_suspend()  There is a deadlock in oxu_bus_suspend(), which is
  shown below:     (Thread 1)              |      (Thread 2)                            | timer_action()
  oxu_bus_suspend()          |  mod_timer()  spin_lock_irq() //(1)     |  (wait a time)  ...                       |
  oxu_watchdog()  del_timer_sync()          |  spin_lock_irq() //(2)  (wait timer to stop)      |  ...  We
  hold oxu->lock in position (1) of thread 1, and use del_timer_sync() to wait timer to stop,
  but timer handler also need oxu->lock in position (2) of thread 2. As a result, oxu_bus_suspend()
  will block forever.  This patch extracts del_timer_sync() from the protection of spin_lock_irq(),
  which could let timer handler to obtain the needed lock.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.127-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
