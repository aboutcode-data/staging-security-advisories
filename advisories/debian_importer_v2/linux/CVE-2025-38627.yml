advisory_id: linux/CVE-2025-38627
datasource_id: debian_importer_v2/linux/CVE-2025-38627
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38627
aliases:
  - CVE-2025-38627
summary: 'In the Linux kernel, the following vulnerability has been resolved:  f2fs: compress:
  fix UAF of f2fs_inode_info in f2fs_free_dic  The decompress_io_ctx may be released asynchronously
  after I/O completion. If this file is deleted immediately after read, and the kworker of processing
  post_read_wq has not been executed yet due to high workloads, It is possible that the inode(f2fs_inode_info)
  is evicted and freed before it is used f2fs_free_dic.      The UAF case as below:     Thread
  A                                      Thread B     - f2fs_decompress_end_io      - f2fs_put_dic       -
  queue_work         add free_dic work to post_read_wq                                                    -
  do_unlink                                                     - iput                                                      -
  evict                                                       - call_rcu     This file is deleted
  after read.      Thread C                                 kworker to process post_read_wq     -
  rcu_do_batch      - f2fs_free_inode       - kmem_cache_free      inode is freed by rcu                                              -
  process_scheduled_works                                               - f2fs_late_free_dic                                                -
  f2fs_free_dic                                                 - f2fs_release_decomp_mem                                       read
  (dic->inode)->i_compress_algorithm  This patch store compress_algorithm and sbi in dic to
  avoid inode UAF.  In addition, the previous solution is deprecated in [1] may cause system
  hang. [1] https://lore.kernel.org/all/c36ab955-c8db-4a8b-a9d0-f07b5f426c3f@kernel.org'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
