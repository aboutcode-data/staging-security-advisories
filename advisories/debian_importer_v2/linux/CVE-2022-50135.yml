advisory_id: linux/CVE-2022-50135
datasource_id: debian_importer_v2/linux/CVE-2022-50135
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50135
aliases:
  - CVE-2022-50135
summary: 'In the Linux kernel, the following vulnerability has been resolved:  RDMA/rxe: Fix
  BUG: KASAN: null-ptr-deref in rxe_qp_do_cleanup  The function rxe_create_qp calls rxe_qp_from_init.
  If some error occurs, the error handler of function rxe_qp_from_init will set both scq and
  rcq to NULL.  Then rxe_create_qp calls rxe_put to handle qp. In the end, rxe_qp_do_cleanup
  is called by rxe_put. rxe_qp_do_cleanup directly accesses scq and rcq before checking them.
  This will cause null-ptr-deref error.  The call graph is as below:  rxe_create_qp {   ...   rxe_qp_from_init
  {     ...   err1:     ...     qp->rcq = NULL;  <---rcq is set to NULL     qp->scq = NULL;  <---scq
  is set to NULL     ...   }  qp_init:   rxe_put{     ...     rxe_qp_do_cleanup {       ...       atomic_dec(&qp->scq->num_wq);
  <--- scq is accessed       ...       atomic_dec(&qp->rcq->num_wq); <--- rcq is accessed     }
  }'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
