advisory_id: linux/CVE-2025-38492
datasource_id: debian_importer_v2/linux/CVE-2025-38492
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38492
aliases:
  - CVE-2025-38492
summary: 'In the Linux kernel, the following vulnerability has been resolved:  netfs: Fix race
  between cache write completion and ALL_QUEUED being set  When netfslib is issuing subrequests,
  the subrequests start processing immediately and may complete before we reach the end of the
  issuing function.  At the end of the issuing function we set NETFS_RREQ_ALL_QUEUED to indicate
  to the collector that we aren''t going to issue any more subreqs and that it can do the final
  notifications and cleanup.  Now, this isn''t a problem if the request is synchronous (NETFS_RREQ_OFFLOAD_COLLECTION
  is unset) as the result collection will be done in-thread and we''re guaranteed an opportunity
  to run the collector.  However, if the request is asynchronous, collection is primarily triggered
  by the termination of subrequests queuing it on a workqueue.  Now, a race can occur here if
  the app thread sets ALL_QUEUED after the last subrequest terminates.  This can happen most
  easily with the copy2cache code (as used by Ceph) where, in the collection routine of a read
  request, an asynchronous write request is spawned to copy data to the cache.  Folios are added
  to the write request as they''re unlocked, but there may be a delay before ALL_QUEUED is set
  as the write subrequests may complete before we get there.  If all the write subreqs have
  finished by the ALL_QUEUED point, no further events happen and the collection never happens,
  leaving the request hanging.  Fix this by queuing the collector after setting ALL_QUEUED.  This
  is a bit heavy-handed and it may be sufficient to do it only if there are no extant subreqs.  Also
  add a tracepoint to cross-reference both requests in a copy-to-request operation and add a
  trace to the netfs_rreq tracepoint to indicate the setting of ALL_QUEUED.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
