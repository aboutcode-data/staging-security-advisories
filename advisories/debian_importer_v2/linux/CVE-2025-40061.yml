advisory_id: linux/CVE-2025-40061
datasource_id: debian_importer_v2/linux/CVE-2025-40061
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40061
aliases:
  - CVE-2025-40061
summary: 'In the Linux kernel, the following vulnerability has been resolved:  RDMA/rxe: Fix
  race in do_task() when draining  When do_task() exhausts its iteration budget (!ret), it sets
  the state to TASK_STATE_IDLE to reschedule, without a secondary check on the current task->state.
  This can overwrite the TASK_STATE_DRAINING state set by a concurrent call to rxe_cleanup_task()
  or rxe_disable_task().  While state changes are protected by a spinlock, both rxe_cleanup_task()
  and rxe_disable_task() release the lock while waiting for the task to finish draining in the
  while(!is_done(task)) loop. The race occurs if do_task() hits its iteration limit and acquires
  the lock in this window. The cleanup logic may then proceed while the task incorrectly reschedules
  itself, leading to a potential use-after-free.  This bug was introduced during the migration
  from tasklets to workqueues, where the special handling for the draining case was lost.  Fix
  this by restoring the original pre-migration behavior. If the state is TASK_STATE_DRAINING
  when iterations are exhausted, set cont to 1 to force a new loop iteration. This allows the
  task to finish its work, so that a subsequent iteration can reach the switch statement and
  correctly transition the state to TASK_STATE_DRAINED, stopping the task as intended.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
