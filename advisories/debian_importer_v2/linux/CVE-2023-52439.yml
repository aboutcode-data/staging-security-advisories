advisory_id: linux/CVE-2023-52439
datasource_id: debian_importer_v2/linux/CVE-2023-52439
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-52439
aliases:
  - CVE-2023-52439
summary: "In the Linux kernel, the following vulnerability has been resolved:  uio: Fix use-after-free\
  \ in uio_open  core-1\t\t\t\tcore-2 -------------------------------------------------------\
  \ uio_unregister_device\t\tuio_open \t\t\t\tidev = idr_find() device_unregister(&idev->dev)\
  \ put_device(&idev->dev) uio_device_release \t\t\t\tget_device(&idev->dev) kfree(idev) uio_free_minor(minor)\
  \ \t\t\t\tuio_release \t\t\t\tput_device(&idev->dev) \t\t\t\tkfree(idev) -------------------------------------------------------\
  \  In the core-1 uio_unregister_device(), the device_unregister will kfree idev when the idev->dev\
  \ kobject ref is 1. But after core-1 device_unregister, put_device and before doing kfree,\
  \ the core-2 may get_device. Then: 1. After core-1 kfree idev, the core-2 will do use-after-free\
  \ for idev. 2. When core-2 do uio_release and put_device, the idev will be double    freed.\
  \  To address this issue, we can get idev atomic & inc idev reference with minor_lock."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.76-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.209-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.6.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
