advisory_id: linux/CVE-2022-48821
datasource_id: debian_importer_v2/linux/CVE-2022-48821
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-48821
aliases:
  - CVE-2022-48821
summary: 'In the Linux kernel, the following vulnerability has been resolved:  misc: fastrpc:
  avoid double fput() on failed usercopy  If the copy back to userland fails for the FASTRPC_IOCTL_ALLOC_DMA_BUFF
  ioctl(), we shouldn''t assume that ''buf->dmabuf'' is still valid. In fact, dma_buf_fd() called
  fd_install() before, i.e. "consumed" one reference, leaving us with none.  Calling dma_buf_put()
  will therefore put a reference we no longer own, leading to a valid file descritor table entry
  for an already released ''file'' object which is a straight use-after-free.  Simply avoid
  calling dma_buf_put() and rely on the process exit code to do the necessary cleanup, if needed,
  i.e. if the file descriptor is still valid.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.16.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.103-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
