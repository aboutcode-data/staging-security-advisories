advisory_id: linux/CVE-2025-38457
datasource_id: debian_importer_v2/linux/CVE-2025-38457
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38457
aliases:
  - CVE-2025-38457
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net/sched: Abort
  __tc_modify_qdisc if parent class does not exist  Lion''s patch [1] revealed an ancient bug
  in the qdisc API. Whenever a user creates/modifies a qdisc specifying as a parent another
  qdisc, the qdisc API will, during grafting, detect that the user is not trying to attach to
  a class and reject. However grafting is performed after qdisc_create (and thus the qdiscs''
  init callback) is executed. In qdiscs that eventually call qdisc_tree_reduce_backlog during
  init or change (such as fq, hhf, choke, etc), an issue arises. For example, executing the
  following commands:  sudo tc qdisc add dev lo root handle a: htb default 2 sudo tc qdisc add
  dev lo parent a: handle beef fq  Qdiscs such as fq, hhf, choke, etc unconditionally invoke
  qdisc_tree_reduce_backlog() in their control path init() or change() which then causes a failure
  to find the child class; however, that does not stop the unconditional invocation of the assumed
  child qdisc''s qlen_notify with a null class. All these qdiscs make the assumption that class
  is non-null.  The solution is ensure that qdisc_leaf() which looks up the parent class, and
  is invoked prior to qdisc_create(), should return failure on not finding the class. In this
  patch, we leverage qdisc_leaf to return ERR_PTRs whenever the parentid doesn''t correspond
  to a class, so that we can detect it earlier on and abort before qdisc_create is called.  [1]
  https://lore.kernel.org/netdev/d912cbd7-193b-4269-9857-525bee8bbb6a@gmail.com/'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.147-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.41-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
