advisory_id: linux/CVE-2022-50630
datasource_id: debian_importer_v2/linux/CVE-2022-50630
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50630
aliases:
  - CVE-2022-50630
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm: hugetlb:
  fix UAF in hugetlb_handle_userfault  The vma_lock and hugetlb_fault_mutex are dropped before
  handling userfault and reacquire them again after handle_userfault(), but reacquire the vma_lock
  could lead to UAF[1,2] due to the following race,  hugetlb_fault   hugetlb_no_page     /*unlock
  vma_lock */     hugetlb_handle_userfault       handle_userfault         /* unlock mm->mmap_lock*/                                            vm_mmap_pgoff                                              do_mmap                                                mmap_region                                                  munmap_vma_range                                                    /*
  clean old vma */         /* lock vma_lock again  <--- UAF */     /* unlock vma_lock */  Since
  the vma_lock will unlock immediately after hugetlb_handle_userfault(), let''s drop the unneeded
  lock and unlock in hugetlb_handle_userfault() to fix the issue.  [1] https://lore.kernel.org/linux-mm/000000000000d5e00a05e834962e@google.com/
  [2] https://lore.kernel.org/linux-mm/20220921014457.1668-1-liuzixian4@huawei.com/'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
