advisory_id: linux/CVE-2022-50179
datasource_id: debian_importer_v2/linux/CVE-2022-50179
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50179
aliases:
  - CVE-2022-50179
summary: "In the Linux kernel, the following vulnerability has been resolved:  ath9k: fix use-after-free\
  \ in ath9k_hif_usb_rx_cb  Syzbot reported use-after-free Read in ath9k_hif_usb_rx_cb() [0].\
  \ The problem was in incorrect htc_handle->drv_priv initialization.  Probable call trace which\
  \ can trigger use-after-free:  ath9k_htc_probe_device()   /* htc_handle->drv_priv = priv;\
  \ */   ath9k_htc_wait_for_target()      <--- Failed   ieee80211_free_hw()\t\t   <--- priv\
  \ pointer is freed  <IRQ> ... ath9k_hif_usb_rx_cb()   ath9k_hif_usb_rx_stream()    RX_STAT_INC()\t\
  \t<--- htc_handle->drv_priv access  In order to not add fancy protection for drv_priv we can\
  \ move htc_handle->drv_priv initialization at the end of the ath9k_htc_probe_device() and\
  \ add helper macro to make all *_STAT_* macros NULL safe, since syzbot has reported related\
  \ NULL deref in that macros [1]"
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.140-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
