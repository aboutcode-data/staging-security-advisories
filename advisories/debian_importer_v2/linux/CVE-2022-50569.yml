advisory_id: linux/CVE-2022-50569
datasource_id: debian_importer_v2/linux/CVE-2022-50569
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50569
aliases:
  - CVE-2022-50569
summary: 'In the Linux kernel, the following vulnerability has been resolved:  xfrm: Update
  ipcomp_scratches with NULL when freed  Currently if ipcomp_alloc_scratches() fails to allocate
  memory ipcomp_scratches holds obsolete address. So when we try to free the percpu scratches
  using ipcomp_free_scratches() it tries to vfree non existent vm area. Described below:  static
  void * __percpu *ipcomp_alloc_scratches(void) {         ...         scratches = alloc_percpu(void
  *);         if (!scratches)                 return NULL; ipcomp_scratches does not know about
  this allocation failure. Therefore holding the old obsolete address.         ... }  So when
  we free,  static void ipcomp_free_scratches(void) {         ...         scratches = ipcomp_scratches;
  Assigning obsolete address from ipcomp_scratches          if (!scratches)                 return;          for_each_possible_cpu(i)                vfree(*per_cpu_ptr(scratches,
  i)); Trying to free non existent page, causing warning: trying to vfree existent vm area.         ...
  }  Fix this breakage by updating ipcomp_scrtches with NULL when scratches is freed'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
