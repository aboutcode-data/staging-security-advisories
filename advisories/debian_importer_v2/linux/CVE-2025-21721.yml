advisory_id: linux/CVE-2025-21721
datasource_id: debian_importer_v2/linux/CVE-2025-21721
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-21721
aliases:
  - CVE-2025-21721
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nilfs2: handle
  errors that nilfs_prepare_chunk() may return  Patch series "nilfs2: fix issues with rename
  operations".  This series fixes BUG_ON check failures reported by syzbot around rename operations,
  and a minor behavioral issue where the mtime of a child directory changes when it is renamed
  instead of moved.   This patch (of 2):  The directory manipulation routines nilfs_set_link()
  and nilfs_delete_entry() rewrite the directory entry in the folio/page previously read by
  nilfs_find_entry(), so error handling is omitted on the assumption that nilfs_prepare_chunk(),
  which prepares the buffer for rewriting, will always succeed for these.  And if an error is
  returned, it triggers the legacy BUG_ON() checks in each routine.  This assumption is wrong,
  as proven by syzbot: the buffer layer called by nilfs_prepare_chunk() may call nilfs_get_block()
  if necessary, which may fail due to metadata corruption or other reasons.  This has been there
  all along, but improved sanity checks and error handling may have made it more reproducible
  in fuzzing tests.  Fix this issue by adding missing error paths in nilfs_set_link(), nilfs_delete_entry(),
  and their caller nilfs_rename().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.133-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.237-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
