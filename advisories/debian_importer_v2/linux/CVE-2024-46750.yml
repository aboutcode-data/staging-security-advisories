advisory_id: linux/CVE-2024-46750
datasource_id: debian_importer_v2/linux/CVE-2024-46750
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-46750
aliases:
  - CVE-2024-46750
summary: 'In the Linux kernel, the following vulnerability has been resolved:  PCI: Add missing
  bridge lock to pci_bus_lock()  One of the true positives that the cfg_access_lock lockdep
  effort identified is this sequence:    WARNING: CPU: 14 PID: 1 at drivers/pci/pci.c:4886 pci_bridge_secondary_bus_reset+0x5d/0x70   RIP:
  0010:pci_bridge_secondary_bus_reset+0x5d/0x70   Call Trace:    <TASK>    ? __warn+0x8c/0x190    ?
  pci_bridge_secondary_bus_reset+0x5d/0x70    ? report_bug+0x1f8/0x200    ? handle_bug+0x3c/0x70    ?
  exc_invalid_op+0x18/0x70    ? asm_exc_invalid_op+0x1a/0x20    ? pci_bridge_secondary_bus_reset+0x5d/0x70    pci_reset_bus+0x1d8/0x270    vmd_probe+0x778/0xa10    pci_device_probe+0x95/0x120  Where
  pci_reset_bus() users are triggering unlocked secondary bus resets. Ironically pci_bus_reset(),
  several calls down from pci_reset_bus(), uses pci_bus_lock() before issuing the reset which
  locks everything *but* the bridge itself.  For the same motivation as adding:    bridge =
  pci_upstream_bridge(dev);   if (bridge)     pci_dev_lock(bridge);  to pci_reset_function()
  for the "bus" and "cxl_bus" reset cases, add pci_dev_lock() for @bus->self to pci_bus_lock().  [bhelgaas:
  squash in recursive locking deadlock fix from Keith Busch: https://lore.kernel.org/r/20240711193650.701834-1-kbusch@meta.com]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.112-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.226-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.10.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
