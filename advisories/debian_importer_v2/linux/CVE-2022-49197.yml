advisory_id: linux/CVE-2022-49197
datasource_id: debian_importer_v2/linux/CVE-2022-49197
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49197
aliases:
  - CVE-2022-49197
summary: "In the Linux kernel, the following vulnerability has been resolved:  af_netlink: Fix\
  \ shift out of bounds in group mask calculation  When a netlink message is received, netlink_recvmsg()\
  \ fills in the address of the sender. One of the fields is the 32-bit bitfield nl_groups,\
  \ which carries the multicast group on which the message was received. The least significant\
  \ bit corresponds to group 1, and therefore the highest group that the field can represent\
  \ is 32. Above that, the UB sanitizer flags the out-of-bounds shift attempts.  Which bits\
  \ end up being set in such case is implementation defined, but it's either going to be a wrong\
  \ non-zero value, or zero, which is at least not misleading. Make the latter choice deterministic\
  \ by always setting to 0 for higher-numbered multicast groups.  To get information about membership\
  \ in groups >= 32, userspace is expected to use nl_pktinfo control messages[0], which are\
  \ enabled by NETLINK_PKTINFO socket option. [0] https://lwn.net/Articles/147608/  The way\
  \ to trigger this issue is e.g. through monitoring the BRVLAN group:  \t# bridge monitor vlan\
  \ & \t# ip link add name br type bridge  Which produces the following citation:  \tUBSAN:\
  \ shift-out-of-bounds in net/netlink/af_netlink.c:162:19 \tshift exponent 32 is too large\
  \ for 32-bit type 'int'"
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.17.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.113-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
