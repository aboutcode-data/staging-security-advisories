advisory_id: linux/CVE-2023-53843
datasource_id: debian_importer_v2/linux/CVE-2023-53843
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53843
aliases:
  - CVE-2023-53843
summary: "In the Linux kernel, the following vulnerability has been resolved:  net: openvswitch:\
  \ reject negative ifindex  Recent changes in net-next (commit 759ab1edb56c (\"net: store netdevs\
  \ in an xarray\")) refactored the handling of pre-assigned ifindexes and let syzbot surface\
  \ a latent problem in ovs. ovs does not validate ifindex, making it possible to create netdev\
  \ ports with negative ifindex values. It's easy to repro with YNL:  $ ./cli.py --spec netlink/specs/ovs_datapath.yaml\
  \ \\          --do new \\ \t --json '{\"upcall-pid\": 1, \"name\":\"my-dp\"}' $ ./cli.py --spec\
  \ netlink/specs/ovs_vport.yaml \\ \t --do new \\ \t --json '{\"upcall-pid\": \"00000001\"\
  , \"name\": \"some-port0\", \"dp-ifindex\":3,\"ifindex\":4294901760,\"type\":2}'  $ ip link\
  \ show -65536: some-port0: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT\
  \ group default qlen 1000     link/ether 7a:48:21:ad:0b:fb brd ff:ff:ff:ff:ff:ff ...  Validate\
  \ the inputs. Now the second command correctly returns:  $ ./cli.py --spec netlink/specs/ovs_vport.yaml\
  \ \\ \t --do new \\ \t --json '{\"upcall-pid\": \"00000001\", \"name\": \"some-port0\", \"\
  dp-ifindex\":3,\"ifindex\":4294901760,\"type\":2}'  lib.ynl.NlError: Netlink error: Numerical\
  \ result out of range nl_len = 108 (92) nl_flags = 0x300 nl_type = 2 \terror: -34\textack:\
  \ {'msg': 'integer out of range', 'unknown': [[type:4 len:36] b'\\x0c\\x00\\x02\\x00\\x00\\\
  x00\\x00\\x00\\x00\\x00\\x00\\x00\\x0c\\x00\\x03\\x00\\xff\\xff\\xff\\x7f\\x00\\x00\\x00\\\
  x00\\x08\\x00\\x01\\x00\\x08\\x00\\x00\\x00'], 'bad-attr': '.ifindex'}  Accept 0 since it\
  \ used to be silently ignored."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.52-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.4.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
