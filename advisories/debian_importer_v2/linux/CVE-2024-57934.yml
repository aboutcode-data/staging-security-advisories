advisory_id: linux/CVE-2024-57934
datasource_id: debian_importer_v2/linux/CVE-2024-57934
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-57934
aliases:
  - CVE-2024-57934
summary: 'In the Linux kernel, the following vulnerability has been resolved:  fgraph: Add READ_ONCE()
  when accessing fgraph_array[]  In __ftrace_return_to_handler(), a loop iterates over the fgraph_array[]
  elements, which are fgraph_ops. The loop checks if an element is a fgraph_stub to prevent
  using a fgraph_stub afterward.  However, if the compiler reloads fgraph_array[] after this
  check, it might race with an update to fgraph_array[] that introduces a fgraph_stub. This
  could result in the stub being processed, but the stub contains a null "func_hash" field,
  leading to a NULL pointer dereference.  To ensure that the gops compared against the fgraph_stub
  matches the gops processed later, add a READ_ONCE(). A similar patch appears in commit 63a8dfb
  ("function_graph: Add READ_ONCE() when accessing fgraph_array[]").'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
