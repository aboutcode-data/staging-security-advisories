advisory_id: linux/CVE-2023-54295
datasource_id: debian_importer_v2/linux/CVE-2023-54295
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54295
aliases:
  - CVE-2023-54295
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mtd: spi-nor:
  Fix shift-out-of-bounds in spi_nor_set_erase_type  spi_nor_set_erase_type() was used either
  to set or to mask out an erase type. When we used it to mask out an erase type a shift-out-of-bounds
  was hit: UBSAN: shift-out-of-bounds in drivers/mtd/spi-nor/core.c:2237:24 shift exponent 4294967295
  is too large for 32-bit type ''int''  The setting of the size_{shift, mask} and of the opcode
  are unnecessary when the erase size is zero, as throughout the code just the erase size is
  considered to determine whether an erase type is supported or not. Setting the opcode to 0xFF
  was wrong too as nobody guarantees that 0xFF is an unused opcode. Thus when masking out an
  erase type, just set the erase size to zero. This will fix the shift-out-of-bounds.  [ta:
  refine changes, new commit message, fix compilation error]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.20-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
