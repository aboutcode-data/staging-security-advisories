advisory_id: linux/CVE-2022-50314
datasource_id: debian_importer_v2/linux/CVE-2022-50314
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50314
aliases:
  - CVE-2022-50314
summary: "In the Linux kernel, the following vulnerability has been resolved:  nbd: Fix hung\
  \ when signal interrupts nbd_start_device_ioctl()  syzbot reported hung task [1].  The following\
  \ program is a simplified version of the reproducer:  int main(void) { \tint sv[2], fd;  \t\
  if (socketpair(AF_UNIX, SOCK_STREAM, 0, sv) < 0) \t\treturn 1; \tif ((fd = open(\"/dev/nbd0\"\
  , 0)) < 0) \t\treturn 1; \tif (ioctl(fd, NBD_SET_SIZE_BLOCKS, 0x81) < 0) \t\treturn 1; \t\
  if (ioctl(fd, NBD_SET_SOCK, sv[0]) < 0) \t\treturn 1; \tif (ioctl(fd, NBD_DO_IT) < 0) \t\t\
  return 1; \treturn 0; }  When signal interrupt nbd_start_device_ioctl() waiting the condition\
  \ atomic_read(&config->recv_threads) == 0, the task can hung because it waits the completion\
  \ of the inflight IOs.  This patch fixes the issue by clearing queue, not just shutdown, when\
  \ signal interrupt nbd_start_device_ioctl()."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
