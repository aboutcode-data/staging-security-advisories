advisory_id: linux/CVE-2024-45004
datasource_id: debian_importer_v2/linux/CVE-2024-45004
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-45004
aliases:
  - CVE-2024-45004
summary: 'In the Linux kernel, the following vulnerability has been resolved:  KEYS: trusted:
  dcp: fix leak of blob encryption key  Trusted keys unseal the key blob on load, but keep the
  sealed payload in the blob field so that every subsequent read (export) will simply convert
  this field to hex and send it to userspace.  With DCP-based trusted keys, we decrypt the blob
  encryption key (BEK) in the Kernel due hardware limitations and then decrypt the blob payload.
  BEK decryption is done in-place which means that the trusted key blob field is modified and
  it consequently holds the BEK in plain text. Every subsequent read of that key thus send the
  plain text BEK instead of the encrypted BEK to userspace.  This issue only occurs when importing
  a trusted DCP-based key and then exporting it again. This should rarely happen as the common
  use cases are to either create a new trusted key and export it, or import a key blob and then
  just use it without exporting it again.  Fix this by performing BEK decryption and encryption
  in a dedicated buffer. Further always wipe the plain text BEK buffer to prevent leaking the
  key via uninitialized memory.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.10.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
