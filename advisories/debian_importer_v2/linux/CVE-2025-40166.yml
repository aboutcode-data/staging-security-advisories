advisory_id: linux/CVE-2025-40166
datasource_id: debian_importer_v2/linux/CVE-2025-40166
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40166
aliases:
  - CVE-2025-40166
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drm/xe/guc: Check
  GuC running state before deregistering exec queue  In normal operation, a registered exec
  queue is disabled and deregistered through the GuC, and freed only after the GuC confirms
  completion. However, if the driver is forced to unbind while the exec queue is still running,
  the user may call exec_destroy() after the GuC has already been stopped and CT communication
  disabled.  In this case, the driver cannot receive a response from the GuC, preventing proper
  cleanup of exec queue resources. Fix this by directly releasing the resources when GuC is
  not running.  Here is the failure dmesg log: " [  468.089581] ---[ end trace 0000000000000000
  ]--- [  468.089608] pci 0000:03:00.0: [drm] *ERROR* GT0: GUC ID manager unclean (1/65535)
  [  468.090558] pci 0000:03:00.0: [drm] GT0:     total 65535 [  468.090562] pci 0000:03:00.0:
  [drm] GT0:     used 1 [  468.090564] pci 0000:03:00.0: [drm] GT0:     range 1..1 (1) [  468.092716]
  ------------[ cut here ]------------ [  468.092719] WARNING: CPU: 14 PID: 4775 at drivers/gpu/drm/xe/xe_ttm_vram_mgr.c:298
  ttm_vram_mgr_fini+0xf8/0x130 [xe] "  v2: use xe_uc_fw_is_running() instead of xe_guc_ct_enabled().     As
  CT may go down and come back during VF migration.  (cherry picked from commit 9b42321a02c50a12b2beb6ae9469606257fbecea)'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
