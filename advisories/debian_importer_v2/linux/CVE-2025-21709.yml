advisory_id: linux/CVE-2025-21709
datasource_id: debian_importer_v2/linux/CVE-2025-21709
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-21709
aliases:
  - CVE-2025-21709
summary: 'In the Linux kernel, the following vulnerability has been resolved:  kernel: be more
  careful about dup_mmap() failures and uprobe registering  If a memory allocation fails during
  dup_mmap(), the maple tree can be left in an unsafe state for other iterators besides the
  exit path.  All the locks are dropped before the exit_mmap() call (in mm/mmap.c), but the
  incomplete mm_struct can be reached through (at least) the rmap finding the vmas which have
  a pointer back to the mm_struct.  Up to this point, there have been no issues with being able
  to find an mm_struct that was only partially initialised.  Syzbot was able to make the incomplete
  mm_struct fail with recent forking changes, so it has been proven unsafe to use the mm_struct
  that hasn''t been initialised, as referenced in the link below.  Although 8ac662f5da19f ("fork:
  avoid inappropriate uprobe access to invalid mm") fixed the uprobe access, it does not completely
  remove the race.  This patch sets the MMF_OOM_SKIP to avoid the iteration of the vmas on the
  oom side (even though this is extremely unlikely to be selected as an oom victim in the race
  window), and sets MMF_UNSTABLE to avoid other potential users from using a partially initialised
  mm_struct.  When registering vmas for uprobe, skip the vmas in an mm that is marked unstable.  Modifying
  a vma in an unstable mm may cause issues if the mm isn''t fully initialised.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
