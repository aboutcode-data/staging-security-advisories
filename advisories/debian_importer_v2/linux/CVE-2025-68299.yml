advisory_id: linux/CVE-2025-68299
datasource_id: debian_importer_v2/linux/CVE-2025-68299
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68299
aliases:
  - CVE-2025-68299
summary: 'In the Linux kernel, the following vulnerability has been resolved:  afs: Fix delayed
  allocation of a cell''s anonymous key  The allocation of a cell''s anonymous key is done in
  a background thread along with other cell setup such as doing a DNS upcall.  In the reported
  bug, this is triggered by afs_parse_source() parsing the device name given to mount() and
  calling afs_lookup_cell() with the name of the cell.  The normal key lookup then tries to
  use the key description on the anonymous authentication key as the reference for request_key()
  - but it may not yet be set and so an oops can happen.  This has been made more likely to
  happen by the fix for dynamic lookup failure.  Fix this by firstly allocating a reference
  name and attaching it to the afs_cell record when the record is created.  It can share the
  memory allocation with the cell name (unfortunately it can''t just overlap the cell name by
  prepending it with "afs@" as the cell name already has a ''.'' prepended for other purposes).  This
  reference name is then passed to request_key().  Secondly, the anon key is now allocated on
  demand at the point a key is requested in afs_request_key() if it is not already allocated.  A
  mutex is used to prevent multiple allocation for a cell.  Thirdly, make afs_request_key_rcu()
  return NULL if the anonymous key isn''t yet allocated (if we need it) and then the caller
  can return -ECHILD to drop out of RCU-mode and afs_request_key() can be called.  Note that
  the anonymous key is kind of necessary to make the key lookup cache work as that doesn''t
  currently cache a negative lookup, but it''s probably worth some investigation to see if NULL
  can be used instead.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
