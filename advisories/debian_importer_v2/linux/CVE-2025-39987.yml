advisory_id: linux/CVE-2025-39987
datasource_id: debian_importer_v2/linux/CVE-2025-39987
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39987
aliases:
  - CVE-2025-39987
summary: "In the Linux kernel, the following vulnerability has been resolved:  can: hi311x:\
  \ populate ndo_change_mtu() to prevent buffer overflow  Sending an PF_PACKET allows to bypass\
  \ the CAN framework logic and to directly reach the xmit() function of a CAN driver. The only\
  \ check which is performed by the PF_PACKET framework is to make sure that skb->len fits the\
  \ interface's MTU.  Unfortunately, because the sun4i_can driver does not populate its net_device_ops->ndo_change_mtu(),\
  \ it is possible for an attacker to configure an invalid MTU by doing, for example:    $ ip\
  \ link set can0 mtu 9999  After doing so, the attacker could open a PF_PACKET socket using\
  \ the ETH_P_CANXL protocol:  \tsocket(PF_PACKET, SOCK_RAW, htons(ETH_P_CANXL))  to inject\
  \ a malicious CAN XL frames. For example:  \tstruct canxl_frame frame = { \t\t.flags = 0xff,\
  \ \t\t.len = 2048, \t};  The CAN drivers' xmit() function are calling can_dev_dropped_skb()\
  \ to check that the skb is valid, unfortunately under above conditions, the malicious packet\
  \ is able to go through can_dev_dropped_skb() checks:    1. the skb->protocol is set to ETH_P_CANXL\
  \ which is valid (the      function does not check the actual device capabilities).    2.\
  \ the length is a valid CAN XL length.  And so, hi3110_hard_start_xmit() receives a CAN XL\
  \ frame which it is not able to correctly handle and will thus misinterpret it as a CAN frame.\
  \ The driver will consume frame->len as-is with no further checks.  This can result in a buffer\
  \ overflow later on in hi3110_hw_tx() on this line:  \tmemcpy(buf + HI3110_FIFO_EXT_DATA_OFF,\
  \ \t       frame->data, frame->len);  Here, frame->len corresponds to the flags field of the\
  \ CAN XL frame. In our previous example, we set canxl_frame->flags to 0xff. Because the maximum\
  \ expected length is 8, a buffer overflow of 247 bytes occurs!  Populate net_device_ops->ndo_change_mtu()\
  \ to ensure that the interface's MTU can not be set to anything bigger than CAN_MTU. By fixing\
  \ the root cause, this prevents the buffer overflow."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.247-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
