advisory_id: linux/CVE-2023-53658
datasource_id: debian_importer_v2/linux/CVE-2023-53658
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53658
aliases:
  - CVE-2023-53658
summary: 'In the Linux kernel, the following vulnerability has been resolved:  spi: bcm-qspi:
  return error if neither hif_mspi nor mspi is available  If neither a "hif_mspi" nor "mspi"
  resource is present, the driver will just early exit in probe but still return success. Apart
  from not doing anything meaningful, this would then also lead to a null pointer access on
  removal, as platform_get_drvdata() would return NULL, which it would then try to dereference
  when trying to unregister the spi master.  Fix this by unconditionally calling devm_ioremap_resource(),
  as it can handle a NULL res and will then return a viable ERR_PTR() if we get one.  The "return
  0;" was previously a "goto qspi_resource_err;" where then ret was returned, but since ret
  was still initialized to 0 at this place this was a valid conversion in 63c5395bb7a9 ("spi:
  bcm-qspi: Fix use-after-free on unbind"). The issue was not introduced by this commit, only
  made more obvious.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.52-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.191-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.4.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
