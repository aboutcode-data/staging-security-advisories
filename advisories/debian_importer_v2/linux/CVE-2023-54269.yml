advisory_id: linux/CVE-2023-54269
datasource_id: debian_importer_v2/linux/CVE-2023-54269
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54269
aliases:
  - CVE-2023-54269
summary: 'In the Linux kernel, the following vulnerability has been resolved:  SUNRPC: double
  free xprt_ctxt while still in use  When an RPC request is deferred, the rq_xprt_ctxt pointer
  is moved out of the svc_rqst into the svc_deferred_req. When the deferred request is revisited,
  the pointer is copied into the new svc_rqst - and also remains in the svc_deferred_req.  In
  the (rare?) case that the request is deferred a second time, the old svc_deferred_req is reused
  - it still has all the correct content. However in that case the rq_xprt_ctxt pointer is NOT
  cleared so that when xpo_release_xprt is called, the ctxt is freed (UDP) or possible added
  to a free list (RDMA). When the deferred request is revisited for a second time, it will reference
  this ctxt which may be invalid, and the free the object a second time which is likely to oops.  So
  change svc_defer() to *always* clear rq_xprt_ctxt, and assert that the value is now stored
  in the svc_deferred_req.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.37-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.3.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
