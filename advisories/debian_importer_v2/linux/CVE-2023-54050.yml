advisory_id: linux/CVE-2023-54050
datasource_id: debian_importer_v2/linux/CVE-2023-54050
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54050
aliases:
  - CVE-2023-54050
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ubifs: Fix memleak
  when insert_old_idx() failed  Following process will cause a memleak for copied up znode:  dirty_cow_znode   zn
  = copy_znode(c, znode);   err = insert_old_idx(c, zbr->lnum, zbr->offs);   if (unlikely(err))      return
  ERR_PTR(err);   // No one refers to zn.  Fetch a reproducer in [Link].  Function copy_znode()
  is split into 2 parts: resource allocation and znode replacement, insert_old_idx() is split
  in similar way, so resource cleanup could be done in error handling path without corrupting
  metadata(mem & disk). It''s okay that old index inserting is put behind of add_idx_dirt(),
  old index is used in layout_leb_in_gaps(), so the two processes do not depend on each other.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.37-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.191-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.3.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
