advisory_id: linux/CVE-2023-53580
datasource_id: debian_importer_v2/linux/CVE-2023-53580
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53580
aliases:
  - CVE-2023-53580
summary: 'In the Linux kernel, the following vulnerability has been resolved:  USB: Gadget:
  core: Help prevent panic during UVC unconfigure  Avichal Rakesh reported a kernel panic that
  occurred when the UVC gadget driver was removed from a gadget''s configuration.  The panic
  involves a somewhat complicated interaction between the kernel driver and a userspace component
  (as described in the Link tag below), but the analysis did make one thing clear: The Gadget
  core should accomodate gadget drivers calling usb_gadget_deactivate() as part of their unbind
  procedure.  Currently this doesn''t work.  gadget_unbind_driver() calls driver->unbind() while
  holding the udc->connect_lock mutex, and usb_gadget_deactivate() attempts to acquire that
  mutex, which will result in a deadlock.  The simple fix is for gadget_unbind_driver() to release
  the mutex when invoking the ->unbind() callback.  There is no particular reason for it to
  be holding the mutex at that time, and the mutex isn''t held while the ->bind() callback is
  invoked.  So we''ll drop the mutex before performing the unbind callback and reacquire it
  afterward.  We''ll also add a couple of comments to usb_gadget_activate() and usb_gadget_deactivate().  Because
  they run in process context they must not be called from a gadget driver''s ->disconnect()
  callback, which (according to the kerneldoc for struct usb_gadget_driver in include/linux/usb/gadget.h)
  may run in interrupt context.  This may help prevent similar bugs from arising in the future.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.52-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.4.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
