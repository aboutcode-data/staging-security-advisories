advisory_id: linux/CVE-2025-38708
datasource_id: debian_importer_v2/linux/CVE-2025-38708
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38708
aliases:
  - CVE-2025-38708
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drbd: add missing
  kref_get in handle_write_conflicts  With `two-primaries` enabled, DRBD tries to detect "concurrent"
  writes and handle write conflicts, so that even if you write to the same sector simultaneously
  on both nodes, they end up with the identical data once the writes are completed.  In handling
  "superseeded" writes, we forgot a kref_get, resulting in a premature drbd_destroy_device and
  use after free, and further to kernel crashes with symptoms.  Relevance: No one should use
  DRBD as a random data generator, and apparently all users of "two-primaries" handle concurrent
  writes correctly on layer up. That is cluster file systems use some distributed lock manager,
  and live migration in virtualization environments stops writes on one node before starting
  writes on the other node.  Which means that other than for "test cases", this code path is
  never taken in real life.  FYI, in DRBD 9, things are handled differently nowadays.  We still
  detect "write conflicts", but no longer try to be smart about them. We decided to disconnect
  hard instead: upper layers must not submit concurrent writes. If they do, that''s their fault.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.153-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.43-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
