advisory_id: linux/CVE-2021-47231
datasource_id: debian_importer_v2/linux/CVE-2021-47231
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47231
aliases:
  - CVE-2021-47231
summary: 'In the Linux kernel, the following vulnerability has been resolved:  can: mcba_usb:
  fix memory leak in mcba_usb  Syzbot reported memory leak in SocketCAN driver for Microchip
  CAN BUS Analyzer Tool. The problem was in unfreed usb_coherent.  In mcba_usb_start() 20 coherent
  buffers are allocated and there is nothing, that frees them:  1) In callback function the
  urb is resubmitted and that''s all 2) In disconnect function urbs are simply killed, but URB_FREE_BUFFER    is
  not set (see mcba_usb_start) and this flag cannot be used with    coherent buffers.  Fail
  log: | [ 1354.053291][ T8413] mcba_usb 1-1:0.0 can0: device disconnected | [ 1367.059384][
  T8420] kmemleak: 20 new suspected memory leaks (see /sys/kernel/debug/kmem)  So, all allocated
  buffers should be freed with usb_free_coherent() explicitly  NOTE: The same pattern for allocating
  and freeing coherent buffers is used in drivers/net/can/usb/kvaser_usb/kvaser_usb_core.c'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.46-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
