advisory_id: linux/CVE-2025-38691
datasource_id: debian_importer_v2/linux/CVE-2025-38691
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38691
aliases:
  - CVE-2025-38691
summary: 'In the Linux kernel, the following vulnerability has been resolved:  pNFS: Fix uninited
  ptr deref in block/scsi layout  The error occurs on the third attempt to encode extents. When
  function ext_tree_prepare_commit() reallocates a larger buffer to retry encoding extents,
  the "layoutupdate_pages" page array is initialized only after the retry loop. But ext_tree_free_commitdata()
  is called on every iteration and tries to put pages in the array, thus dereferencing uninitialized
  pointers.  An additional problem is that there is no limit on the maximum possible buffer_size.
  When there are too many extents, the client may create a layoutcommit that is larger than
  the maximum possible RPC size accepted by the server.  During testing, we observed two typical
  scenarios. First, one memory page for extents is enough when we work with small files, append
  data to the end of the file, or preallocate extents before writing. But when we fill a new
  large file without preallocating, the number of extents can be huge, and counting the number
  of written extents in ext_tree_encode_commit() does not help much. Since this number increases
  even more between unlocking and locking of ext_tree, the reallocated buffer may not be large
  enough again and again.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.153-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.43-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
