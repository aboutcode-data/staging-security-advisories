advisory_id: linux/CVE-2026-23041
datasource_id: debian_importer_v2/linux/CVE-2026-23041
datasource_url: https://security-tracker.debian.org/tracker/CVE-2026-23041
aliases:
  - CVE-2026-23041
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bnxt_en: Fix
  NULL pointer crash in bnxt_ptp_enable during error cleanup  When bnxt_init_one() fails during
  initialization (e.g., bnxt_init_int_mode returns -ENODEV), the error path calls bnxt_free_hwrm_resources()
  which destroys the DMA pool and sets bp->hwrm_dma_pool to NULL. Subsequently, bnxt_ptp_clear()
  is called, which invokes ptp_clock_unregister().  Since commit a60fc3294a37 ("ptp: rework
  ptp_clock_unregister() to disable events"), ptp_clock_unregister() now calls ptp_disable_all_events(),
  which in turn invokes the driver''s .enable() callback (bnxt_ptp_enable()) to disable PTP
  events before completing the unregistration.  bnxt_ptp_enable() attempts to send HWRM commands
  via bnxt_ptp_cfg_pin() and bnxt_ptp_cfg_event(), both of which call hwrm_req_init(). This
  function tries to allocate from bp->hwrm_dma_pool, causing a NULL pointer dereference:    bnxt_en
  0000:01:00.0 (unnamed net_device) (uninitialized): bnxt_init_int_mode err: ffffffed   KASAN:
  null-ptr-deref in range [0x0000000000000028-0x000000000000002f]   Call Trace:    __hwrm_req_init
  (drivers/net/ethernet/broadcom/bnxt/bnxt_hwrm.c:72)    bnxt_ptp_enable (drivers/net/ethernet/broadcom/bnxt/bnxt_ptp.c:323
  drivers/net/ethernet/broadcom/bnxt/bnxt_ptp.c:517)    ptp_disable_all_events (drivers/ptp/ptp_chardev.c:66)    ptp_clock_unregister
  (drivers/ptp/ptp_clock.c:518)    bnxt_ptp_clear (drivers/net/ethernet/broadcom/bnxt/bnxt_ptp.c:1134)    bnxt_init_one
  (drivers/net/ethernet/broadcom/bnxt/bnxt.c:16889)  Lines are against commit f8f9c1f4d0c7 ("Linux
  6.19-rc3")  Fix this by clearing and unregistering ptp (bnxt_ptp_clear()) before freeing HWRM
  resources.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
