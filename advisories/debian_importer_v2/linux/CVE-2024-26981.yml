advisory_id: linux/CVE-2024-26981
datasource_id: debian_importer_v2/linux/CVE-2024-26981
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-26981
aliases:
  - CVE-2024-26981
summary: "In the Linux kernel, the following vulnerability has been resolved:  nilfs2: fix OOB\
  \ in nilfs_set_de_type  The size of the nilfs_type_by_mode array in the fs/nilfs2/dir.c file\
  \ is defined as \"S_IFMT >> S_SHIFT\", but the nilfs_set_de_type() function, which uses this\
  \ array, specifies the index to read from the array in the same way as \"(mode & S_IFMT) >>\
  \ S_SHIFT\".  static void nilfs_set_de_type(struct nilfs_dir_entry *de, struct inode  *inode)\
  \ { \tumode_t mode = inode->i_mode;  \tde->file_type = nilfs_type_by_mode[(mode & S_IFMT)>>S_SHIFT];\
  \ // oob }  However, when the index is determined this way, an out-of-bounds (OOB) error occurs\
  \ by referring to an index that is 1 larger than the array size when the condition \"mode\
  \ & S_IFMT == S_IFMT\" is satisfied.  Therefore, a patch to resize the nilfs_type_by_mode\
  \ array should be applied to prevent OOB errors."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.90-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.8.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
