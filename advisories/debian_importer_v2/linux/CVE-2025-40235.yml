advisory_id: linux/CVE-2025-40235
datasource_id: debian_importer_v2/linux/CVE-2025-40235
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40235
aliases:
  - CVE-2025-40235
summary: 'In the Linux kernel, the following vulnerability has been resolved:  btrfs: directly
  free partially initialized fs_info in btrfs_check_leaked_roots()  If fs_info->super_copy or
  fs_info->super_for_commit allocated failed in btrfs_get_tree_subvol(), then no need to call
  btrfs_free_fs_info(). Otherwise btrfs_check_leaked_roots() would access NULL pointer because
  fs_info->allocated_roots had not been initialised.  syzkaller reported the following information:   ------------[
  cut here ]------------   BUG: unable to handle page fault for address: fffffffffffffbb0   #PF:
  supervisor read access in kernel mode   #PF: error_code(0x0000) - not-present page   PGD 64c9067
  P4D 64c9067 PUD 64cb067 PMD 0   Oops: Oops: 0000 [#1] SMP KASAN PTI   CPU: 0 UID: 0 PID: 1402
  Comm: syz.1.35 Not tainted 6.15.8 #4 PREEMPT(lazy)   Hardware name: QEMU Standard PC (i440FX
  + PIIX, 1996), (...)   RIP: 0010:arch_atomic_read arch/x86/include/asm/atomic.h:23 [inline]   RIP:
  0010:raw_atomic_read include/linux/atomic/atomic-arch-fallback.h:457 [inline]   RIP: 0010:atomic_read
  include/linux/atomic/atomic-instrumented.h:33 [inline]   RIP: 0010:refcount_read include/linux/refcount.h:170
  [inline]   RIP: 0010:btrfs_check_leaked_roots+0x18f/0x2c0 fs/btrfs/disk-io.c:1230   [...]   Call
  Trace:    <TASK>    btrfs_free_fs_info+0x310/0x410 fs/btrfs/disk-io.c:1280    btrfs_get_tree_subvol+0x592/0x6b0
  fs/btrfs/super.c:2029    btrfs_get_tree+0x63/0x80 fs/btrfs/super.c:2097    vfs_get_tree+0x98/0x320
  fs/super.c:1759    do_new_mount+0x357/0x660 fs/namespace.c:3899    path_mount+0x716/0x19c0
  fs/namespace.c:4226    do_mount fs/namespace.c:4239 [inline]    __do_sys_mount fs/namespace.c:4450
  [inline]    __se_sys_mount fs/namespace.c:4427 [inline]    __x64_sys_mount+0x28c/0x310 fs/namespace.c:4427    do_syscall_x64
  arch/x86/entry/syscall_64.c:63 [inline]    do_syscall_64+0x92/0x180 arch/x86/entry/syscall_64.c:94    entry_SYSCALL_64_after_hwframe+0x76/0x7e   RIP:
  0033:0x7f032eaffa8d   [...]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
