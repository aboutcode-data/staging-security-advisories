advisory_id: linux/CVE-2024-49940
datasource_id: debian_importer_v2/linux/CVE-2024-49940
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-49940
aliases:
  - CVE-2024-49940
summary: 'In the Linux kernel, the following vulnerability has been resolved:  l2tp: prevent
  possible tunnel refcount underflow  When a session is created, it sets a backpointer to its
  tunnel. When the session refcount drops to 0, l2tp_session_free drops the tunnel refcount
  if session->tunnel is non-NULL. However, session->tunnel is set in l2tp_session_create, before
  the tunnel refcount is incremented by l2tp_session_register, which leaves a small window where
  session->tunnel is non-NULL when the tunnel refcount hasn''t been bumped.  Moving the assignment
  to l2tp_session_register is trivial but l2tp_session_create calls l2tp_session_set_header_len
  which uses session->tunnel to get the tunnel''s encap. Add an encap arg to l2tp_session_set_header_len
  to avoid using session->tunnel.  If l2tpv3 sessions have colliding IDs, it is possible for
  l2tp_v3_session_get to race with l2tp_session_register and fetch a session which doesn''t
  yet have session->tunnel set. Add a check for this case.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
