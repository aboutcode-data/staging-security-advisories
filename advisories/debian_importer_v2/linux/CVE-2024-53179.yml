advisory_id: linux/CVE-2024-53179
datasource_id: debian_importer_v2/linux/CVE-2024-53179
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-53179
aliases:
  - CVE-2024-53179
summary: 'In the Linux kernel, the following vulnerability has been resolved:  smb: client:
  fix use-after-free of signing key  Customers have reported use-after-free in @ses->auth_key.response
  with SMB2.1 + sign mounts which occurs due to following race:  task A                         task
  B cifs_mount()  dfs_mount_share()   get_session()    cifs_mount_get_session()    cifs_send_recv()     cifs_get_smb_ses()          compound_send_recv()      cifs_setup_session()        smb2_setup_request()       kfree_sensitive()           smb2_calc_signature()                                    crypto_shash_setkey()
  *UAF*  Fix this by ensuring that we have a valid @ses->auth_key.response by checking whether
  @ses->ses_status is SES_GOOD or SES_EXITING with @ses->ses_lock held.  After commit 24a9799aa8ef
  ("smb: client: fix UAF in smb2_reconnect_server()"), we made sure to call ->logoff() only
  when @ses was known to be good (e.g. valid ->auth_key.response), so it''s safe to access signing
  key when @ses->ses_status == SES_EXITING.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
