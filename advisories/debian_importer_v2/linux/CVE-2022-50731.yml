advisory_id: linux/CVE-2022-50731
datasource_id: debian_importer_v2/linux/CVE-2022-50731
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50731
aliases:
  - CVE-2022-50731
summary: 'In the Linux kernel, the following vulnerability has been resolved:  crypto: akcipher
  - default implementation for setting a private key  Changes from v1:   * removed the default
  implementation from set_pub_key: it is assumed that     an implementation must always have
  this callback defined as there are     no use case for an algorithm, which doesn''t need a
  public key  Many akcipher implementations (like ECDSA) support only signature verifications,
  so they don''t have all callbacks defined.  Commit 78a0324f4a53 ("crypto: akcipher - default
  implementations for request callbacks") introduced default callbacks for sign/verify operations,
  which just return an error code.  However, these are not enough, because before calling sign
  the caller would likely call set_priv_key first on the instantiated transform (as the in-kernel
  testmgr does). This function does not have a default stub, so the kernel crashes, when trying
  to set a private key on an akcipher, which doesn''t support signature generation.  I''ve noticed
  this, when trying to add a KAT vector for ECDSA signature to the testmgr.  With this patch
  the testmgr returns an error in dmesg (as it should) instead of crashing the kernel NULL ptr
  dereference.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
