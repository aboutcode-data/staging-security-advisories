advisory_id: linux/CVE-2025-22048
datasource_id: debian_importer_v2/linux/CVE-2025-22048
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-22048
aliases:
  - CVE-2025-22048
summary: 'In the Linux kernel, the following vulnerability has been resolved:  LoongArch: BPF:
  Don''t override subprog''s return value  The verifier test `calls: div by 0 in subprog` triggers
  a panic at the ld.bu instruction. The ld.bu insn is trying to load byte from memory address
  returned by the subprog. The subprog actually set the correct address at the a5 register (dedicated
  register for BPF return values). But at commit 73c359d1d356 ("LoongArch: BPF: Sign-extend
  return values") we also sign extended a5 to the a0 register (return value in LoongArch). For
  function call insn, we later propagate the a0 register back to a5 register. This is right
  for native calls but wrong for bpf2bpf calls which expect zero-extended return value in a5
  register. So only move a0 to a5 for native calls (i.e. non-BPF_PSEUDO_CALL).'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.25-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
