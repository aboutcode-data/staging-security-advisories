advisory_id: linux/CVE-2025-39784
datasource_id: debian_importer_v2/linux/CVE-2025-39784
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39784
aliases:
  - CVE-2025-39784
summary: 'In the Linux kernel, the following vulnerability has been resolved:  PCI: Fix link
  speed calculation on retrain failure  When pcie_failed_link_retrain() fails to retrain, it
  tries to revert to the previous link speed.  However it calculates that speed from the Link
  Control 2 register without masking out non-speed bits first.  PCIE_LNKCTL2_TLS2SPEED() converts
  such incorrect values to PCI_SPEED_UNKNOWN (0xff), which in turn causes a WARN splat in pcie_set_target_speed():    pci
  0000:00:01.1: [1022:14ed] type 01 class 0x060400 PCIe Root Port   pci 0000:00:01.1: broken
  device, retraining non-functional downstream link at 2.5GT/s   pci 0000:00:01.1: retraining
  failed   WARNING: CPU: 1 PID: 1 at drivers/pci/pcie/bwctrl.c:168 pcie_set_target_speed   RDX:
  0000000000000001 RSI: 00000000000000ff RDI: ffff9acd82efa000   pcie_failed_link_retrain   pci_device_add   pci_scan_single_device  Mask
  out the non-speed bits in PCIE_LNKCTL2_TLS2SPEED() and PCIE_LNKCAP_SLS2SPEED() so they don''t
  incorrectly return PCI_SPEED_UNKNOWN.  [bhelgaas: commit log, add details from https://lore.kernel.org/r/1c92ef6bcb314ee6977839b46b393282e4f52e74.1750684771.git.lukas@wunner.de]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
