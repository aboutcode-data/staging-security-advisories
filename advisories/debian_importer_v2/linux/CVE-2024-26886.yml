advisory_id: linux/CVE-2024-26886
datasource_id: debian_importer_v2/linux/CVE-2024-26886
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-26886
aliases:
  - CVE-2024-26886
summary: 'In the Linux kernel, the following vulnerability has been resolved:  Bluetooth: af_bluetooth:
  Fix deadlock  Attemting to do sock_lock on .recvmsg may cause a deadlock as shown bellow,
  so instead of using sock_sock this uses sk_receive_queue.lock on bt_sock_ioctl to avoid the
  UAF:  INFO: task kworker/u9:1:121 blocked for more than 30 seconds.       Not tainted 6.7.6-lemon
  #183 Workqueue: hci0 hci_rx_work Call Trace:  <TASK>  __schedule+0x37d/0xa00  schedule+0x32/0xe0  __lock_sock+0x68/0xa0  ?
  __pfx_autoremove_wake_function+0x10/0x10  lock_sock_nested+0x43/0x50  l2cap_sock_recv_cb+0x21/0xa0  l2cap_recv_frame+0x55b/0x30a0  ?
  psi_task_switch+0xeb/0x270  ? finish_task_switch.isra.0+0x93/0x2a0  hci_rx_work+0x33a/0x3f0  process_one_work+0x13a/0x2f0  worker_thread+0x2f0/0x410  ?
  __pfx_worker_thread+0x10/0x10  kthread+0xe0/0x110  ? __pfx_kthread+0x10/0x10  ret_from_fork+0x2c/0x50  ?
  __pfx_kthread+0x10/0x10  ret_from_fork_asm+0x1b/0x30  </TASK>'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.85-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.7.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
