advisory_id: linux/CVE-2025-21889
datasource_id: debian_importer_v2/linux/CVE-2025-21889
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-21889
aliases:
  - CVE-2025-21889
summary: "In the Linux kernel, the following vulnerability has been resolved:  perf/core: Add\
  \ RCU read lock protection to perf_iterate_ctx()  The perf_iterate_ctx() function performs\
  \ RCU list traversal but currently lacks RCU read lock protection. This causes lockdep warnings\
  \ when running perf probe with unshare(1) under CONFIG_PROVE_RCU_LIST=y:  \tWARNING: suspicious\
  \ RCU usage \tkernel/events/core.c:8168 RCU-list traversed in non-reader section!!  \t Call\
  \ Trace: \t  lockdep_rcu_suspicious \t  ? perf_event_addr_filters_apply \t  perf_iterate_ctx\
  \ \t  perf_event_exec \t  begin_new_exec \t  ? load_elf_phdrs \t  load_elf_binary \t  ? lock_acquire\
  \ \t  ? find_held_lock \t  ? bprm_execve \t  bprm_execve \t  do_execveat_common.isra.0 \t\
  \  __x64_sys_execve \t  do_syscall_64 \t  entry_SYSCALL_64_after_hwframe  This protection\
  \ was previously present but was removed in commit bd2756811766 (\"perf: Rewrite core context\
  \ handling\"). Add back the necessary rcu_read_lock()/rcu_read_unlock() pair around perf_iterate_ctx()\
  \ call in perf_event_exec().  [ mingo: Use scoped_guard() as suggested by Peter ]"
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.19-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
