advisory_id: linux/CVE-2017-1000112
datasource_id: debian_importer_v2/linux/CVE-2017-1000112
datasource_url: https://security-tracker.debian.org/tracker/CVE-2017-1000112
aliases:
  - CVE-2017-1000112
summary: 'Linux kernel: Exploitable memory corruption due to UFO to non-UFO path switch. When
  building a UFO packet with MSG_MORE __ip_append_data() calls ip_ufo_append_data() to append.
  However in between two send() calls, the append path can be switched from UFO to non-UFO one,
  which leads to a memory corruption. In case UFO packet lengths exceeds MTU, copy = maxfraglen
  - skb->len becomes negative on the non-UFO path and the branch to allocate new skb is taken.
  This triggers fragmentation and computation of fraggap = skb_prev->len - maxfraglen. Fraggap
  can exceed MTU, causing copy = datalen - transhdrlen - fraggap to become negative. Subsequently
  skb_copy_and_csum_bits() writes out-of-bounds. A similar issue is present in IPv6 code. The
  bug was introduced in e89e9cf539a2 ("[IPv4/IPv6]: UFO Scatter-gather approach") on Oct 18
  2005.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.12.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
