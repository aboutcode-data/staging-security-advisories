advisory_id: linux/CVE-2022-49884
datasource_id: debian_importer_v2/linux/CVE-2022-49884
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49884
aliases:
  - CVE-2022-49884
summary: 'In the Linux kernel, the following vulnerability has been resolved:  KVM: Initialize
  gfn_to_pfn_cache locks in dedicated helper  Move the gfn_to_pfn_cache lock initialization
  to another helper and call the new helper during VM/vCPU creation.  There are race conditions
  possible due to kvm_gfn_to_pfn_cache_init()''s ability to re-initialize the cache''s locks.  For
  example: a race between ioctl(KVM_XEN_HVM_EVTCHN_SEND) and kvm_gfn_to_pfn_cache_init() leads
  to a corrupted shinfo gpc lock.                  (thread 1)                |           (thread
  2)                                           |  kvm_xen_set_evtchn_fast                  |   read_lock_irqsave(&gpc->lock,
  ...)      |                                           | kvm_gfn_to_pfn_cache_init                                           |  rwlock_init(&gpc->lock)   read_unlock_irqrestore(&gpc->lock,
  ...) |  Rename "cache_init" and "cache_destroy" to activate+deactivate to avoid implying that
  the cache really is destroyed/freed.  Note, there more races in the newly named kvm_gpc_activate()
  that will be addressed separately.  [sean: call out that this is a bug fix]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
