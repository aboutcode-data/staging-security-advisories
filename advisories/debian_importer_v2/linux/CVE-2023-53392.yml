advisory_id: linux/CVE-2023-53392
datasource_id: debian_importer_v2/linux/CVE-2023-53392
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53392
aliases:
  - CVE-2023-53392
summary: 'In the Linux kernel, the following vulnerability has been resolved:  HID: intel-ish-hid:
  Fix kernel panic during warm reset  During warm reset device->fw_client is set to NULL. If
  a bus driver is registered after this NULL setting and before new firmware clients are enumerated
  by ISHTP, kernel panic will result in the function ishtp_cl_bus_match(). This is because of
  reference to device->fw_client->props.protocol_name.  ISH firmware after getting successfully
  loaded, sends a warm reset notification to remove all clients from the bus and sets device->fw_client
  to NULL. Until kernel v5.15, all enabled ISHTP kernel module drivers were loaded right after
  any of the first ISHTP device was registered, regardless of whether it was a matched or an
  unmatched device. This resulted in all drivers getting registered much before the warm reset
  notification from ISH.  Starting kernel v5.16, this issue got exposed after the change was
  introduced to load only bus drivers for the respective matching devices. In this scenario,
  cros_ec_ishtp device and cros_ec_ishtp driver are registered after the warm reset device fw_client
  NULL setting. cros_ec_ishtp driver_register() triggers the callback to ishtp_cl_bus_match()
  to match ISHTP driver to the device and causes kernel panic in guid_equal() when dereferencing
  fw_client NULL pointer to get protocol_name.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.25-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
