advisory_id: linux/CVE-2024-50041
datasource_id: debian_importer_v2/linux/CVE-2024-50041
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-50041
aliases:
  - CVE-2024-50041
summary: "In the Linux kernel, the following vulnerability has been resolved:  i40e: Fix macvlan\
  \ leak by synchronizing access to mac_filter_hash  This patch addresses a macvlan leak issue\
  \ in the i40e driver caused by concurrent access to vsi->mac_filter_hash. The leak occurs\
  \ when multiple threads attempt to modify the mac_filter_hash simultaneously, leading to inconsistent\
  \ state and potential memory leaks.  To fix this, we now wrap the calls to i40e_del_mac_filter()\
  \ and zeroing vf->default_lan_addr.addr with spin_lock/unlock_bh(&vsi->mac_filter_hash_lock),\
  \ ensuring atomic operations and preventing concurrent access.  Additionally, we add lockdep_assert_held(&vsi->mac_filter_hash_lock)\
  \ in i40e_add_mac_filter() to help catch similar issues in the future.  Reproduction steps:\
  \ 1. Spawn VFs and configure port vlan on them. 2. Trigger concurrent macvlan operations (e.g.,\
  \ adding and deleting \tportvlan and/or mac filters). 3. Observe the potential memory leak\
  \ and inconsistent state in the \tmac_filter_hash.  This synchronization ensures the integrity\
  \ of the mac_filter_hash and prevents the described leak."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.115-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
