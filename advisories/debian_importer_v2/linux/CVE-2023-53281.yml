advisory_id: linux/CVE-2023-53281
datasource_id: debian_importer_v2/linux/CVE-2023-53281
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53281
aliases:
  - CVE-2023-53281
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drivers: staging:
  rtl8723bs: Fix locking in _rtw_join_timeout_handler()  Commit 041879b12ddb ("drivers: staging:
  rtl8192bs: Fix deadlock in rtw_joinbss_event_prehandle()") besides fixing the deadlock also
  modified _rtw_join_timeout_handler() to use spin_[un]lock_irq() instead of spin_[un]lock_bh().  _rtw_join_timeout_handler()
  calls rtw_do_join() which takes pmlmepriv->scanned_queue.lock using spin_[un]lock_bh(). This
  spin_unlock_bh() call re-enables softirqs which triggers an oops in kernel/softirq.c: __local_bh_enable_ip()
  when it calls lockdep_assert_irqs_enabled():  [  244.506087] WARNING: CPU: 2 PID: 0 at kernel/softirq.c:376
  __local_bh_enable_ip+0xa6/0x100 ... [  244.509022] Call Trace: [  244.509048]  <IRQ> [  244.509100]  _rtw_join_timeout_handler+0x134/0x170
  [r8723bs] [  244.509468]  ? __pfx__rtw_join_timeout_handler+0x10/0x10 [r8723bs] [  244.509772]  ?
  __pfx__rtw_join_timeout_handler+0x10/0x10 [r8723bs] [  244.510076]  call_timer_fn+0x95/0x2a0
  [  244.510200]  __run_timers.part.0+0x1da/0x2d0  This oops is causd by the switch to spin_[un]lock_irq()
  which disables the IRQs for the entire duration of _rtw_join_timeout_handler().  Disabling
  the IRQs is not necessary since all code taking this lock runs from either user contexts or
  from softirqs, switch back to spin_[un]lock_bh() to fix this.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.37-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.3.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
