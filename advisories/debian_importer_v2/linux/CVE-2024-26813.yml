advisory_id: linux/CVE-2024-26813
datasource_id: debian_importer_v2/linux/CVE-2024-26813
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-26813
aliases:
  - CVE-2024-26813
summary: 'In the Linux kernel, the following vulnerability has been resolved:  vfio/platform:
  Create persistent IRQ handlers  The vfio-platform SET_IRQS ioctl currently allows loopback
  triggering of an interrupt before a signaling eventfd has been configured by the user, which
  thereby allows a NULL pointer dereference.  Rather than register the IRQ relative to a valid
  trigger, register all IRQs in a disabled state in the device open path.  This allows mask
  operations on the IRQ to nest within the overall enable state governed by a valid eventfd
  signal.  This decouples @masked, protected by the @locked spinlock from @trigger, protected
  via the @igate mutex.  In doing so, it''s guaranteed that changes to @trigger cannot race
  the IRQ handlers because the IRQ handler is synchronously disabled before modifying the trigger,
  and loopback triggering of the IRQ via ioctl is safe due to serialization with trigger changes
  via igate.  For compatibility, request_irq() failures are maintained to be local to the SET_IRQS
  ioctl rather than a fatal error in the open device path. This allows, for example, a userspace
  driver with polling mode support to continue to work regardless of moving the request_irq()
  call site. This necessarily blocks all SET_IRQS access to the failed index.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.85-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
