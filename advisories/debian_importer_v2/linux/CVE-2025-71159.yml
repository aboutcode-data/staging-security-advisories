advisory_id: linux/CVE-2025-71159
datasource_id: debian_importer_v2/linux/CVE-2025-71159
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71159
aliases:
  - CVE-2025-71159
summary: 'In the Linux kernel, the following vulnerability has been resolved:  btrfs: fix use-after-free
  warning in btrfs_get_or_create_delayed_node()  Previously, btrfs_get_or_create_delayed_node()
  set the delayed_node''s refcount before acquiring the root->delayed_nodes lock. Commit e8513c012de7
  ("btrfs: implement ref_tracker for delayed_nodes") moved refcount_set inside the critical
  section, which means there is no longer a memory barrier between setting the refcount and
  setting btrfs_inode->delayed_node.  Without that barrier, the stores to node->refs and btrfs_inode->delayed_node
  may become visible out of order. Another thread can then read btrfs_inode->delayed_node and
  attempt to increment a refcount that hasn''t been set yet, leading to a refcounting bug and
  a use-after-free warning.  The fix is to move refcount_set back to where it was to take advantage
  of the implicit memory barrier provided by lock acquisition.  Because the allocations now
  happen outside of the lock''s critical section, they can use GFP_NOFS instead of GFP_ATOMIC.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
