advisory_id: linux/CVE-2024-56740
datasource_id: debian_importer_v2/linux/CVE-2024-56740
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-56740
aliases:
  - CVE-2024-56740
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nfs/localio:
  must clear res.replen in nfs_local_read_done  Otherwise memory corruption can occur due to
  NFSv3 LOCALIO reads leaving garbage in res.replen: - nfs3_read_done() copies that into server->read_hdrsize;
  from there   nfs3_proc_read_setup() copies it to args.replen in new requests. - nfs3_xdr_enc_read3args()
  passes that to rpc_prepare_reply_pages()   which includes it in hdrsize for xdr_init_pages,
  so that rq_rcv_buf   contains a ridiculous len. - This is copied to rq_private_buf and xs_read_stream_request()   eventually
  passes the kvec to sock_recvmsg() which receives incoming   data into entirely the wrong place.  This
  is easily reproduced with NFSv3 LOCALIO that is servicing reads when it is made to pivot back
  to using normal RPC.  This switch back to using normal NFSv3 with RPC can occur for a few
  reasons but this issue was exposed with a test that stops and then restarts the NFSv3 server
  while LOCALIO is performing heavy read IO.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
