advisory_id: linux/CVE-2025-68206
datasource_id: debian_importer_v2/linux/CVE-2025-68206
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68206
aliases:
  - CVE-2025-68206
summary: "In the Linux kernel, the following vulnerability has been resolved:  netfilter: nft_ct:\
  \ add seqadj extension for natted connections  Sequence adjustment may be required for FTP\
  \ traffic with PASV/EPSV modes. due to need to re-write packet payload (IP, port) on the ftp\
  \ control connection. This can require changes to the TCP length and expected seq / ack_seq.\
  \  The easiest way to reproduce this issue is with PASV mode. Example ruleset: table inet\
  \ ftp_nat {         ct helper ftp_helper {                 type \"ftp\" protocol tcp     \
  \            l3proto inet         }          chain prerouting {                 type filter\
  \ hook prerouting priority 0; policy accept;                 tcp dport 21 ct state new ct\
  \ helper set \"ftp_helper\"         } } table ip nat {         chain prerouting {        \
  \         type nat hook prerouting priority -100; policy accept;                 tcp dport\
  \ 21 dnat ip prefix to ip daddr map { \t\t\t192.168.100.1 : 192.168.13.2/32 }         }  \
  \        chain postrouting {                 type nat hook postrouting priority 100 ; policy\
  \ accept;                 tcp sport 21 snat ip prefix to ip saddr map { \t\t\t192.168.13.2\
  \ : 192.168.100.1/32 }         } }  Note that the ftp helper gets assigned *after* the dnat\
  \ setup.  The inverse (nat after helper assign) is handled by an existing check in nf_nat_setup_info()\
  \ and will not show the problem.  Topoloy:   +-------------------+     +----------------------------------+\
  \  | FTP: 192.168.13.2 | <-> | NAT: 192.168.13.3, 192.168.100.1 |  +-------------------+ \
  \    +----------------------------------+                                       |        \
  \                  +-----------------------+                          | Client: 192.168.100.2\
  \ |                          +-----------------------+  ftp nat changes do not work as expected\
  \ in this case: Connected to 192.168.100.1. [..] ftp> epsv EPSV/EPRT on IPv4 off. ftp> ls\
  \ 227 Entering passive mode (192,168,100,1,209,129). 421 Service not available, remote server\
  \ has closed connection.  Kernel logs: Missing nfct_seqadj_ext_add() setup call WARNING: CPU:\
  \ 1 PID: 0 at net/netfilter/nf_conntrack_seqadj.c:41 [..]  __nf_nat_mangle_tcp_packet+0x100/0x160\
  \ [nf_nat]  nf_nat_ftp+0x142/0x280 [nf_nat_ftp]  help+0x4d1/0x880 [nf_conntrack_ftp]  nf_confirm+0x122/0x2e0\
  \ [nf_conntrack]  nf_hook_slow+0x3c/0xb0  ..  Fix this by adding the required extension when\
  \ a conntrack helper is assigned to a connection that has a nat binding."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.17.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
