advisory_id: linux/CVE-2025-39713
datasource_id: debian_importer_v2/linux/CVE-2025-39713
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39713
aliases:
  - CVE-2025-39713
summary: 'In the Linux kernel, the following vulnerability has been resolved:  media: rainshadow-cec:
  fix TOCTOU race condition in rain_interrupt()  In the interrupt handler rain_interrupt(),
  the buffer full check on rain->buf_len is performed before acquiring rain->buf_lock. This
  creates a Time-of-Check to Time-of-Use (TOCTOU) race condition, as rain->buf_len is concurrently
  accessed and modified in the work handler rain_irq_work_handler() under the same lock.  Multiple
  interrupt invocations can race, with each reading buf_len before it becomes full and then
  proceeding. This can lead to both interrupts attempting to write to the buffer, incrementing
  buf_len beyond its capacity (DATA_SIZE) and causing a buffer overflow.  Fix this bug by moving
  the spin_lock() to before the buffer full check. This ensures that the check and the subsequent
  buffer modification are performed atomically, preventing the race condition. An corresponding
  spin_unlock() is added to the overflow path to correctly release the lock.  This possible
  bug was found by an experimental static analysis tool developed by our team.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.153-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.48-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
