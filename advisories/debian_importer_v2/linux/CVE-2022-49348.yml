advisory_id: linux/CVE-2022-49348
datasource_id: debian_importer_v2/linux/CVE-2022-49348
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49348
aliases:
  - CVE-2022-49348
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ext4: filter
  out EXT4_FC_REPLAY from on-disk superblock field s_state  The EXT4_FC_REPLAY bit in sbi->s_mount_state
  is used to indicate that we are in the middle of replay the fast commit journal.  This was
  actually a mistake, since the sbi->s_mount_info is initialized from es->s_state.  Arguably
  s_mount_state is misleadingly named, but the name is historical --- s_mount_state and s_state
  dates back to ext2.  What should have been used is the ext4_{set,clear,test}_mount_flag()
  inline functions, which sets EXT4_MF_* bits in sbi->s_mount_flags.  The problem with using
  EXT4_FC_REPLAY is that a maliciously corrupted superblock could result in EXT4_FC_REPLAY getting
  set in s_mount_state.  This bypasses some sanity checks, and this can trigger a BUG() in ext4_es_cache_extent().  As
  a easy-to-backport-fix, filter out the EXT4_FC_REPLAY bit for now.  We should eventually transition
  away from EXT4_FC_REPLAY to something like EXT4_MF_REPLAY.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.127-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
