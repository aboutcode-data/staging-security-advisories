advisory_id: linux/CVE-2025-39905
datasource_id: debian_importer_v2/linux/CVE-2025-39905
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39905
aliases:
  - CVE-2025-39905
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: phylink:
  add lock for serializing concurrent pl->phydev writes with resolver  Currently phylink_resolve()
  protects itself against concurrent phylink_bringup_phy() or phylink_disconnect_phy() calls
  which modify pl->phydev by relying on pl->state_mutex.  The problem is that in phylink_resolve(),
  pl->state_mutex is in a lock inversion state with pl->phydev->lock. So pl->phydev->lock needs
  to be acquired prior to pl->state_mutex. But that requires dereferencing pl->phydev in the
  first place, and without pl->state_mutex, that is racy.  Hence the reason for the extra lock.
  Currently it is redundant, but it will serve a functional purpose once mutex_lock(&phy->lock)
  will be moved outside of the mutex_lock(&pl->state_mutex) section.  Another alternative considered
  would have been to let phylink_resolve() acquire the rtnl_mutex, which is also held when phylink_bringup_phy()
  and phylink_disconnect_phy() are called. But since phylink_disconnect_phy() runs under rtnl_lock(),
  it would deadlock with phylink_resolve() when calling flush_work(&pl->resolve). Additionally,
  it would have been undesirable because it would have unnecessarily blocked many other call
  paths as well in the entire kernel, so the smaller-scoped lock was preferred.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
