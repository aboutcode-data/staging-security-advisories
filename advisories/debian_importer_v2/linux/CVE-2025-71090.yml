advisory_id: linux/CVE-2025-71090
datasource_id: debian_importer_v2/linux/CVE-2025-71090
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71090
aliases:
  - CVE-2025-71090
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nfsd: fix nfsd_file
  reference leak in nfsd4_add_rdaccess_to_wrdeleg()  nfsd4_add_rdaccess_to_wrdeleg() unconditionally
  overwrites fp->fi_fds[O_RDONLY] with a newly acquired nfsd_file. However, if the client already
  has a SHARE_ACCESS_READ open from a previous OPEN operation, this action overwrites the existing
  pointer without releasing its reference, orphaning the previous reference.  Additionally,
  the function originally stored the same nfsd_file pointer in both fp->fi_fds[O_RDONLY] and
  fp->fi_rdeleg_file with only a single reference. When put_deleg_file() runs, it clears fi_rdeleg_file
  and calls nfs4_file_put_access() to release the file.  However, nfs4_file_put_access() only
  releases fi_fds[O_RDONLY] when the fi_access[O_RDONLY] counter drops to zero. If another READ
  open exists on the file, the counter remains elevated and the nfsd_file reference from the
  delegation is never released. This potentially causes open conflicts on that file.  Then,
  on server shutdown, these leaks cause __nfsd_file_cache_purge() to encounter files with an
  elevated reference count that cannot be cleaned up, ultimately triggering a BUG() in kmem_cache_destroy()
  because there are still nfsd_file objects allocated in that cache.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
