advisory_id: linux/CVE-2025-38580
datasource_id: debian_importer_v2/linux/CVE-2025-38580
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38580
aliases:
  - CVE-2025-38580
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ext4: fix inode
  use after free in ext4_end_io_rsv_work()  In ext4_io_end_defer_completion(), check if io_end->list_vec
  is empty to avoid adding an io_end that requires no conversion to the i_rsv_conversion_list,
  which in turn prevents starting an unnecessary worker. An ext4_emergency_state() check is
  also added to avoid attempting to abort the journal in an emergency state.  Additionally,
  ext4_put_io_end_defer() is refactored to call ext4_io_end_defer_completion() directly instead
  of being open-coded. This also prevents starting an unnecessary worker when EXT4_IO_END_FAILED
  is set but data_err=abort is not enabled.  This ensures that the check in ext4_put_io_end_defer()
  is consistent with the check in ext4_end_bio(). Otherwise, we might add an io_end to the i_rsv_conversion_list
  and then call ext4_finish_bio(), after which the inode could be freed before ext4_end_io_rsv_work()
  is called, triggering a use-after-free issue.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
