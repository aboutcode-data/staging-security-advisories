advisory_id: linux/CVE-2024-27066
datasource_id: debian_importer_v2/linux/CVE-2024-27066
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-27066
aliases:
  - CVE-2024-27066
summary: 'In the Linux kernel, the following vulnerability has been resolved:  virtio: packed:
  fix unmap leak for indirect desc table  When use_dma_api and premapped are true, then the
  do_unmap is false.  Because the do_unmap is false, vring_unmap_extra_packed is not called
  by detach_buf_packed.    if (unlikely(vq->do_unmap)) {                 curr = id;                 for
  (i = 0; i < state->num; i++) {                         vring_unmap_extra_packed(vq,                                                  &vq->packed.desc_extra[curr]);                         curr
  = vq->packed.desc_extra[curr].next;                 }   }  So the indirect desc table is not
  unmapped. This causes the unmap leak.  So here, we check vq->use_dma_api instead. Synchronously,
  dma info is updated based on use_dma_api judgment  This bug does not occur, because no driver
  use the premapped with indirect.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
