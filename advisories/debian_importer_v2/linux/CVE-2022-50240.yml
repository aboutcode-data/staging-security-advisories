advisory_id: linux/CVE-2022-50240
datasource_id: debian_importer_v2/linux/CVE-2022-50240
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50240
aliases:
  - CVE-2022-50240
summary: 'In the Linux kernel, the following vulnerability has been resolved:  android: binder:
  stop saving a pointer to the VMA  Do not record a pointer to a VMA outside of the mmap_lock
  for later use.  This is unsafe and there are a number of failure paths *after* the recorded
  VMA pointer may be freed during setup.  There is no callback to the driver to clear the saved
  pointer from generic mm code.  Furthermore, the VMA pointer may become stale if any number
  of VMA operations end up freeing the VMA so saving it was fragile to being with.  Instead,
  change the binder_alloc struct to record the start address of the VMA and use vma_lookup()
  to get the vma when needed.  Add lockdep mmap_lock checks on updates to the vma pointer to
  ensure the lock is held and depend on that lock for synchronization of readers and writers
  - which was already the case anyways, so the smp_wmb()/smp_rmb() was not necessary.  [akpm@linux-foundation.org:
  fix drivers/android/binder_alloc_selftest.c]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.19.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
