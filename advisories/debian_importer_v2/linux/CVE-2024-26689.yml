advisory_id: linux/CVE-2024-26689
datasource_id: debian_importer_v2/linux/CVE-2024-26689
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-26689
aliases:
  - CVE-2024-26689
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ceph: prevent
  use-after-free in encode_cap_msg()  In fs/ceph/caps.c, in encode_cap_msg(), "use after free"
  error was caught by KASAN at this line - ''ceph_buffer_get(arg->xattr_buf);''. This implies
  before the refcount could be increment here, it was freed.  In same file, in "handle_cap_grant()"
  refcount is decremented by this line - ''ceph_buffer_put(ci->i_xattrs.blob);''. It appears
  that a race occurred and resource was freed by the latter line before the former line could
  increment it.  encode_cap_msg() is called by __send_cap() and __send_cap() is called by ceph_check_caps()
  after calling __prep_cap(). __prep_cap() is where arg->xattr_buf is assigned to ci->i_xattrs.blob.
  This is the spot where the refcount must be increased to prevent "use after free" error.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.82-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
