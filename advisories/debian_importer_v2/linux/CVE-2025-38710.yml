advisory_id: linux/CVE-2025-38710
datasource_id: debian_importer_v2/linux/CVE-2025-38710
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38710
aliases:
  - CVE-2025-38710
summary: 'In the Linux kernel, the following vulnerability has been resolved:  gfs2: Validate
  i_depth for exhash directories  A fuzzer test introduced corruption that ends up with a depth
  of 0 in dir_e_read(), causing an undefined shift by 32 at:    index = hash >> (32 - dip->i_depth);  As
  calculated in an open-coded way in dir_make_exhash(), the minimum depth for an exhash directory
  is ilog2(sdp->sd_hash_ptrs) and 0 is invalid as sdp->sd_hash_ptrs is fixed as sdp->bsize /
  16 at mount time.  So we can avoid the undefined behaviour by checking for depth values lower
  than the minimum in gfs2_dinode_in(). Values greater than the maximum are already being checked
  for there.  Also switch the calculation in dir_make_exhash() to use ilog2() to clarify how
  the depth is calculated.  Tested with the syzkaller repro.c and xfstests ''-g quick''.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.43-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
