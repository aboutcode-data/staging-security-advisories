advisory_id: linux/CVE-2024-43835
datasource_id: debian_importer_v2/linux/CVE-2024-43835
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-43835
aliases:
  - CVE-2024-43835
summary: "In the Linux kernel, the following vulnerability has been resolved:  virtio_net: Fix\
  \ napi_skb_cache_put warning  After the commit bdacf3e34945 (\"net: Use nested-BH locking\
  \ for napi_alloc_cache.\") was merged, the following warning began to appear:  \t WARNING:\
  \ CPU: 5 PID: 1 at net/core/skbuff.c:1451 napi_skb_cache_put+0x82/0x4b0  \t  __warn+0x12f/0x340\
  \ \t  napi_skb_cache_put+0x82/0x4b0 \t  napi_skb_cache_put+0x82/0x4b0 \t  report_bug+0x165/0x370\
  \ \t  handle_bug+0x3d/0x80 \t  exc_invalid_op+0x1a/0x50 \t  asm_exc_invalid_op+0x1a/0x20 \t\
  \  __free_old_xmit+0x1c8/0x510 \t  napi_skb_cache_put+0x82/0x4b0 \t  __free_old_xmit+0x1c8/0x510\
  \ \t  __free_old_xmit+0x1c8/0x510 \t  __pfx___free_old_xmit+0x10/0x10  The issue arises because\
  \ virtio is assuming it's running in NAPI context even when it's not, such as in the netpoll\
  \ case.  To resolve this, modify virtnet_poll_tx() to only set NAPI when budget is available.\
  \ Same for virtnet_poll_cleantx(), which always assumed that it was in a NAPI context."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.112-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.226-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.10.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
