advisory_id: linux/CVE-2025-40215
datasource_id: debian_importer_v2/linux/CVE-2025-40215
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40215
aliases:
  - CVE-2025-40215
summary: 'In the Linux kernel, the following vulnerability has been resolved:  xfrm: delete
  x->tunnel as we delete x  The ipcomp fallback tunnels currently get deleted (from the various
  lists and hashtables) as the last user state that needed that fallback is destroyed (not deleted).
  If a reference to that user state still exists, the fallback state will remain on the hashtables/lists,
  triggering the WARN in xfrm_state_fini. Because of those remaining references, the fix in
  commit f75a2804da39 ("xfrm: destroy xfrm_state synchronously on net exit path") is not complete.  We
  recently fixed one such situation in TCP due to defered freeing of skbs (commit 9b6412e6979f
  ("tcp: drop secpath at the same time as we currently drop dst")). This can also happen due
  to IP reassembly: skbs with a secpath remain on the reassembly queue until netns destruction.
  If we can''t guarantee that the queues are flushed by the time xfrm_state_fini runs, there
  may still be references to a (user) xfrm_state, preventing the timely deletion of the corresponding
  fallback state.  Instead of chasing each instance of skbs holding a secpath one by one, this
  patch fixes the issue directly within xfrm, by deleting the fallback state as soon as the
  last user state depending on it has been deleted. Destruction will still happen when the final
  reference is dropped.  A separate lockdep class for the fallback state is required since we''re
  going to lock x->tunnel while x is locked.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.162-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.249-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
