advisory_id: linux/CVE-2024-53143
datasource_id: debian_importer_v2/linux/CVE-2024-53143
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-53143
aliases:
  - CVE-2024-53143
summary: 'In the Linux kernel, the following vulnerability has been resolved:  fsnotify: Fix
  ordering of iput() and watched_objects decrement  Ensure the superblock is kept alive until
  we''re done with iput(). Holding a reference to an inode is not allowed unless we ensure the
  superblock stays alive, which fsnotify does by keeping the watched_objects count elevated,
  so iput() must happen before the watched_objects decrement. This can lead to a UAF of something
  like sb->s_fs_info in tmpfs, but the UAF is hard to hit because race orderings that oops are
  more likely, thanks to the CHECK_DATA_CORRUPTION() block in generic_shutdown_super().  Also,
  ensure that fsnotify_put_sb_watched_objects() doesn''t call fsnotify_sb_watched_objects()
  on a superblock that may have already been freed, which would cause a UAF read of sb->s_fsnotify_info.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
