advisory_id: linux/CVE-2025-38216
datasource_id: debian_importer_v2/linux/CVE-2025-38216
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38216
aliases:
  - CVE-2025-38216
summary: 'In the Linux kernel, the following vulnerability has been resolved:  iommu/vt-d: Restore
  context entry setup order for aliased devices  Commit 2031c469f816 ("iommu/vt-d: Add support
  for static identity domain") changed the context entry setup during domain attachment from
  a set-and-check policy to a clear-and-reset approach. This inadvertently introduced a regression
  affecting PCI aliased devices behind PCIe-to-PCI bridges.  Specifically, keyboard and touchpad
  stopped working on several Apple Macbooks with below messages:   kernel: platform pxa2xx-spi.3:
  Adding to iommu group 20  kernel: input: Apple SPI Keyboard as  /devices/pci0000:00/0000:00:1e.3/pxa2xx-spi.3/spi_master/spi2/spi-APP000D:00/input/input0  kernel:
  DMAR: DRHD: handling fault status reg 3  kernel: DMAR: [DMA Read NO_PASID] Request device
  [00:1e.3] fault addr  0xffffa000 [fault reason 0x06] PTE Read access is not set  kernel: DMAR:
  DRHD: handling fault status reg 3  kernel: DMAR: [DMA Read NO_PASID] Request device [00:1e.3]
  fault addr  0xffffa000 [fault reason 0x06] PTE Read access is not set  kernel: applespi spi-APP000D:00:
  Error writing to device: 01 0e 00 00  kernel: DMAR: DRHD: handling fault status reg 3  kernel:
  DMAR: [DMA Read NO_PASID] Request device [00:1e.3] fault addr  0xffffa000 [fault reason 0x06]
  PTE Read access is not set  kernel: DMAR: DRHD: handling fault status reg 3  kernel: applespi
  spi-APP000D:00: Error writing to device: 01 0e 00 00  Fix this by restoring the previous context
  setup order.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.35-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
