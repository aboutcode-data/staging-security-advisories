advisory_id: linux/CVE-2024-50020
datasource_id: debian_importer_v2/linux/CVE-2024-50020
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-50020
aliases:
  - CVE-2024-50020
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ice: Fix improper
  handling of refcount in ice_sriov_set_msix_vec_count()  This patch addresses an issue with
  improper reference count handling in the ice_sriov_set_msix_vec_count() function.  First,
  the function calls ice_get_vf_by_id(), which increments the reference count of the vf pointer.
  If the subsequent call to ice_get_vf_vsi() fails, the function currently returns an error
  without decrementing the reference count of the vf pointer, leading to a reference count leak.
  The correct behavior, as implemented in this patch, is to decrement the reference count using
  ice_put_vf(vf) before returning an error when vsi is NULL.  Second, the function calls ice_sriov_get_irqs(),
  which sets vf->first_vector_idx. If this call returns a negative value, indicating an error,
  the function returns an error without decrementing the reference count of the vf pointer,
  resulting in another reference count leak. The patch addresses this by adding a call to ice_put_vf(vf)
  before returning an error when vf->first_vector_idx < 0.  This bug was identified by an experimental
  static analysis tool developed by our team. The tool specializes in analyzing reference count
  operations and identifying potential mismanagement of reference counts. In this case, the
  tool flagged the missing decrement operation as a potential issue, leading to this patch.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
