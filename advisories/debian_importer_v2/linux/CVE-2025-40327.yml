advisory_id: linux/CVE-2025-40327
datasource_id: debian_importer_v2/linux/CVE-2025-40327
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40327
aliases:
  - CVE-2025-40327
summary: 'In the Linux kernel, the following vulnerability has been resolved:  perf/core: Fix
  system hang caused by cpu-clock usage  cpu-clock usage by the async-profiler tool can trigger
  a system hang, which got bisected back to the following commit by Octavia Togami:    18dbcbfabfff
  ("perf: Fix the POLL_HUP delivery breakage") causes this issue  The root cause of the hang
  is that cpu-clock is a special type of SW event which relies on hrtimers. The __perf_event_overflow()
  callback is invoked from the hrtimer handler for cpu-clock events, and __perf_event_overflow()
  tries to call cpu_clock_event_stop() to stop the event, which calls htimer_cancel() to cancel
  the hrtimer.  But that''s a recursion into the hrtimer code from a hrtimer handler, which
  (unsurprisingly) deadlocks.  To fix this bug, use hrtimer_try_to_cancel() instead, and set
  the PERF_HES_STOPPED flag, which causes perf_swevent_hrtimer() to stop the event once it sees
  the PERF_HES_STOPPED flag.  [ mingo: Fixed the comments and improved the changelog. ]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
