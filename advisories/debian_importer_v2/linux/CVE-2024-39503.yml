advisory_id: linux/CVE-2024-39503
datasource_id: debian_importer_v2/linux/CVE-2024-39503
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-39503
aliases:
  - CVE-2024-39503
summary: 'In the Linux kernel, the following vulnerability has been resolved:  netfilter: ipset:
  Fix race between namespace cleanup and gc in the list:set type  Lion Ackermann reported that
  there is a race condition between namespace cleanup in ipset and the garbage collection of
  the list:set type. The namespace cleanup can destroy the list:set type of sets while the gc
  of the set type is waiting to run in rcu cleanup. The latter uses data from the destroyed
  set which thus leads use after free. The patch contains the following parts:  - When destroying
  all sets, first remove the garbage collectors, then wait   if needed and then destroy the
  sets. - Fix the badly ordered "wait then remove gc" for the destroy a single set   case. -
  Fix the missing rcu locking in the list:set type in the userspace test   case. - Use proper
  RCU list handlings in the list:set type.  The patch depends on c1193d9bbbd3 (netfilter: ipset:
  Add list flush to cancel_gc).'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.99-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.221-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
