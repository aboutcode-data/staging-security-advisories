advisory_id: linux/CVE-2022-50554
datasource_id: debian_importer_v2/linux/CVE-2022-50554
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50554
aliases:
  - CVE-2022-50554
summary: 'In the Linux kernel, the following vulnerability has been resolved:  blk-mq: avoid
  double ->queue_rq() because of early timeout  David Jeffery found one double ->queue_rq()
  issue, so far it can be triggered in VM use case because of long vmexit latency or preempt
  latency of vCPU pthread or long page fault in vCPU pthread, then block IO req could be timed
  out before queuing the request to hardware but after calling blk_mq_start_request() during
  ->queue_rq(), then timeout handler may handle it by requeue, then double ->queue_rq() is caused,
  and kernel panic.  So far, it is driver''s responsibility to cover the race between timeout
  and completion, so it seems supposed to be solved in driver in theory, given driver has enough
  knowledge.  But it is really one common problem, lots of driver could have similar issue,
  and could be hard to fix all affected drivers, even it isn''t easy for driver to handle the
  race. So David suggests this patch by draining in-progress ->queue_rq() for solving this issue.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
