advisory_id: linux/CVE-2024-46695
datasource_id: debian_importer_v2/linux/CVE-2024-46695
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-46695
aliases:
  - CVE-2024-46695
summary: 'In the Linux kernel, the following vulnerability has been resolved:  selinux,smack:
  don''t bypass permissions check in inode_setsecctx hook  Marek Gresko reports that the root
  user on an NFS client is able to change the security labels on files on an NFS filesystem
  that is exported with root squashing enabled.  The end of the kerneldoc comment for __vfs_setxattr_noperm()
  states:   *  This function requires the caller to lock the inode''s i_mutex before it  *  is
  executed. It also assumes that the caller will make the appropriate  *  permission checks.  nfsd_setattr()
  does do permissions checking via fh_verify() and nfsd_permission(), but those don''t do all
  the same permissions checks that are done by security_inode_setxattr() and its related LSM
  hooks do.  Since nfsd_setattr() is the only consumer of security_inode_setsecctx(), simplest
  solution appears to be to replace the call to __vfs_setxattr_noperm() with a call to __vfs_setxattr_locked().  This
  fixes the above issue and has the added benefit of causing nfsd to recall conflicting delegations
  on a file when a client tries to change its security label.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.115-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.234-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.10.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
