advisory_id: linux/CVE-2025-39899
datasource_id: debian_importer_v2/linux/CVE-2025-39899
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39899
aliases:
  - CVE-2025-39899
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/userfaultfd:
  fix kmap_local LIFO ordering for CONFIG_HIGHPTE  With CONFIG_HIGHPTE on 32-bit ARM, move_pages_pte()
  maps PTE pages using kmap_local_page(), which requires unmapping in Last-In-First-Out order.  The
  current code maps dst_pte first, then src_pte, but unmaps them in the same order (dst_pte,
  src_pte), violating the LIFO requirement.  This causes the warning in kunmap_local_indexed():    WARNING:
  CPU: 0 PID: 604 at mm/highmem.c:622 kunmap_local_indexed+0x178/0x17c   addr \!= __fix_to_virt(FIX_KMAP_BEGIN
  + idx)  Fix this by reversing the unmap order to respect LIFO ordering.  This issue follows
  the same pattern as similar fixes: - commit eca6828403b8 ("crypto: skcipher - fix mismatch
  between mapping and unmapping order") - commit 8cf57c6df818 ("nilfs2: eliminate staggered
  calls to kunmap in nilfs_rename")  Both of which addressed the same fundamental requirement
  that kmap_local operations must follow LIFO ordering.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.48-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
