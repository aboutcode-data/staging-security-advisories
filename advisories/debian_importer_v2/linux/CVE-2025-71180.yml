advisory_id: linux/CVE-2025-71180
datasource_id: debian_importer_v2/linux/CVE-2025-71180
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71180
aliases:
  - CVE-2025-71180
summary: 'In the Linux kernel, the following vulnerability has been resolved:  counter: interrupt-cnt:
  Drop IRQF_NO_THREAD flag  An IRQ handler can either be IRQF_NO_THREAD or acquire spinlock_t,
  as CONFIG_PROVE_RAW_LOCK_NESTING warns: ============================= [ BUG: Invalid wait
  context ] 6.18.0-rc1+git... #1 ----------------------------- some-user-space-process/1251
  is trying to lock: (&counter->events_list_lock){....}-{3:3}, at: counter_push_event [counter]
  other info that might help us debug this: context-{2:2} no locks held by some-user-space-process/....
  stack backtrace: CPU: 0 UID: 0 PID: 1251 Comm: some-user-space-process 6.18.0-rc1+git... #1
  PREEMPT Call trace:  show_stack (C)  dump_stack_lvl  dump_stack  __lock_acquire  lock_acquire  _raw_spin_lock_irqsave  counter_push_event
  [counter]  interrupt_cnt_isr [interrupt_cnt]  __handle_irq_event_percpu  handle_irq_event  handle_simple_irq  handle_irq_desc  generic_handle_domain_irq  gpio_irq_handler  handle_irq_desc  generic_handle_domain_irq  gic_handle_irq  call_on_irq_stack  do_interrupt_handler  el0_interrupt  __el0_irq_handler_common  el0t_64_irq_handler  el0t_64_irq  ...
  and Sebastian correctly points out. Remove IRQF_NO_THREAD as an alternative to switching to
  raw_spinlock_t, because the latter would limit all potential nested locks to raw_spinlock_t
  only.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.162-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
