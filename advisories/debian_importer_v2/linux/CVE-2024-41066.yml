advisory_id: linux/CVE-2024-41066
datasource_id: debian_importer_v2/linux/CVE-2024-41066
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-41066
aliases:
  - CVE-2024-41066
summary: "In the Linux kernel, the following vulnerability has been resolved:  ibmvnic: Add\
  \ tx check to prevent skb leak  Below is a summary of how the driver stores a reference to\
  \ an skb during transmit:     tx_buff[free_map[consumer_index]]->skb = new_skb;     free_map[consumer_index]\
  \ = IBMVNIC_INVALID_MAP;     consumer_index ++; Where variable data looks like this:     free_map\
  \ == [4, IBMVNIC_INVALID_MAP, IBMVNIC_INVALID_MAP, 0, 3]                                 \
  \               \tconsumer_index^     tx_buff == [skb=null, skb=<ptr>, skb=<ptr>, skb=null,\
  \ skb=null]  The driver has checks to ensure that free_map[consumer_index] pointed to a valid\
  \ index but there was no check to ensure that this index pointed to an unused/null skb address.\
  \ So, if, by some chance, our free_map and tx_buff lists become out of sync then we were previously\
  \ risking an skb memory leak. This could then cause tcp congestion control to stop sending\
  \ packets, eventually leading to ETIMEDOUT.  Therefore, add a conditional to ensure that the\
  \ skb address is null. If not then warn the user (because this is still a bug that should\
  \ be patched) and free the old pointer to prevent memleak/tcp problems."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.106-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
