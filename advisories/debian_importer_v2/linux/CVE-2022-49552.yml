advisory_id: linux/CVE-2022-49552
datasource_id: debian_importer_v2/linux/CVE-2022-49552
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49552
aliases:
  - CVE-2022-49552
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: Fix combination
  of jit blinding and pointers to bpf subprogs.  The combination of jit blinding and pointers
  to bpf subprogs causes: [   36.989548] BUG: unable to handle page fault for address: 0000000100000001
  [   36.990342] #PF: supervisor instruction fetch in kernel mode [   36.990968] #PF: error_code(0x0010)
  - not-present page [   36.994859] RIP: 0010:0x100000001 [   36.995209] Code: Unable to access
  opcode bytes at RIP 0xffffffd7. [   37.004091] Call Trace: [   37.004351]  <TASK> [   37.004576]  ?
  bpf_loop+0x4d/0x70 [   37.004932]  ? bpf_prog_3899083f75e4c5de_F+0xe3/0x13b  The jit blinding
  logic didn''t recognize that ld_imm64 with an address of bpf subprogram is a special instruction
  and proceeded to randomize it. By itself it wouldn''t have been an issue, but jit_subprogs()
  logic relies on two step process to JIT all subprogs and then JIT them again when addresses
  of all subprogs are known. Blinding process in the first JIT phase caused second JIT to miss
  adjustment of special ld_imm64.  Fix this issue by ignoring special ld_imm64 instructions
  that don''t have user controlled constants and shouldn''t be blinded.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
