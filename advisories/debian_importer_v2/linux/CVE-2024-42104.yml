advisory_id: linux/CVE-2024-42104
datasource_id: debian_importer_v2/linux/CVE-2024-42104
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-42104
aliases:
  - CVE-2024-42104
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nilfs2: add missing
  check for inode numbers on directory entries  Syzbot reported that mounting and unmounting
  a specific pattern of corrupted nilfs2 filesystem images causes a use-after-free of metadata
  file inodes, which triggers a kernel bug in lru_add_fn().  As Jan Kara pointed out, this is
  because the link count of a metadata file gets corrupted to 0, and nilfs_evict_inode(), which
  is called from iput(), tries to delete that inode (ifile inode in this case).  The inconsistency
  occurs because directories containing the inode numbers of these metadata files that should
  not be visible in the namespace are read without checking.  Fix this issue by treating the
  inode numbers of these internal files as errors in the sanity check helper when reading directory
  folios/pages.  Also thanks to Hillf Danton and Matthew Wilcox for their initial mm-layer analysis.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.98-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
