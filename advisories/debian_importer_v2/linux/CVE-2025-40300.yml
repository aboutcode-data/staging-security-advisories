advisory_id: linux/CVE-2025-40300
datasource_id: debian_importer_v2/linux/CVE-2025-40300
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40300
aliases:
  - CVE-2025-40300
summary: 'In the Linux kernel, the following vulnerability has been resolved:  x86/vmscape:
  Add conditional IBPB mitigation  VMSCAPE is a vulnerability that exploits insufficient branch
  predictor isolation between a guest and a userspace hypervisor (like QEMU). Existing mitigations
  already protect kernel/KVM from a malicious guest. Userspace can additionally be protected
  by flushing the branch predictors after a VMexit.  Since it is the userspace that consumes
  the poisoned branch predictors, conditionally issue an IBPB after a VMexit and before returning
  to userspace. Workloads that frequently switch between hypervisor and userspace will incur
  the most overhead from the new IBPB.  This new IBPB is not integrated with the existing IBPB
  sites. For instance, a task can use the existing speculation control prctl() to get an IBPB
  at context switch time. With this implementation, the IBPB is doubled up: one at context switch
  and another before running userspace.  The intent is to integrate and optimize these cases
  post-embargo.  [ dhansen: elaborate on suboptimal IBPB solution ]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.153-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.48-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
