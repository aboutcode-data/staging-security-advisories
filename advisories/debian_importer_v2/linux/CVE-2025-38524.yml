advisory_id: linux/CVE-2025-38524
datasource_id: debian_importer_v2/linux/CVE-2025-38524
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38524
aliases:
  - CVE-2025-38524
summary: "In the Linux kernel, the following vulnerability has been resolved:  rxrpc: Fix recv-recv\
  \ race of completed call  If a call receives an event (such as incoming data), the call gets\
  \ placed on the socket's queue and a thread in recvmsg can be awakened to go and process it.\
  \  Once the thread has picked up the call off of the queue, further events will cause it to\
  \ be requeued, and once the socket lock is dropped (recvmsg uses call->user_mutex to allow\
  \ the socket to be used in parallel), a second thread can come in and its recvmsg can pop\
  \ the call off the socket queue again.  In such a case, the first thread will be receiving\
  \ stuff from the call and the second thread will be blocked on call->user_mutex.  The first\
  \ thread can, at this point, process both the event that it picked call for and the event\
  \ that the second thread picked the call for and may see the call terminate - in which case\
  \ the call will be \"released\", decoupling the call from the user call ID assigned to it\
  \ (RXRPC_USER_CALL_ID in the control message).  The first thread will return okay, but then\
  \ the second thread will wake up holding the user_mutex and, if it sees that the call has\
  \ been released by the first thread, it will BUG thusly:  \tkernel BUG at net/rxrpc/recvmsg.c:474!\
  \  Fix this by just dequeuing the call and ignoring it if it is seen to be already released.\
  \  We can't tell userspace about it anyway as the user call ID has become stale."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.41-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
