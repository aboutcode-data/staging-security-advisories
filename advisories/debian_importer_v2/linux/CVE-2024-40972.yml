advisory_id: linux/CVE-2024-40972
datasource_id: debian_importer_v2/linux/CVE-2024-40972
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-40972
aliases:
  - CVE-2024-40972
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ext4: do not
  create EA inode under buffer lock  ext4_xattr_set_entry() creates new EA inodes while holding
  buffer lock on the external xattr block. This is problematic as it nests all the allocation
  locking (which acquires locks on other buffers) under the buffer lock. This can even deadlock
  when the filesystem is corrupted and e.g. quota file is setup to contain xattr block as data
  block. Move the allocation of EA inode out of ext4_xattr_set_entry() into the callers.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.112-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
