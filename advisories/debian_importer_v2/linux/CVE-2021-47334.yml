advisory_id: linux/CVE-2021-47334
datasource_id: debian_importer_v2/linux/CVE-2021-47334
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47334
aliases:
  - CVE-2021-47334
summary: 'In the Linux kernel, the following vulnerability has been resolved:  misc/libmasm/module:
  Fix two use after free in ibmasm_init_one  In ibmasm_init_one, it calls ibmasm_init_remote_input_dev().
  Inside ibmasm_init_remote_input_dev, mouse_dev and keybd_dev are allocated by input_allocate_device(),
  and assigned to sp->remote.mouse_dev and sp->remote.keybd_dev respectively.  In the err_free_devices
  error branch of ibmasm_init_one, mouse_dev and keybd_dev are freed by input_free_device(),
  and return error. Then the execution runs into error_send_message error branch of ibmasm_init_one,
  where ibmasm_free_remote_input_dev(sp) is called to unregister the freed sp->remote.mouse_dev
  and sp->remote.keybd_dev.  My patch add a "error_init_remote" label to handle the error of
  ibmasm_init_remote_input_dev(), to avoid the uaf bugs.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.14.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.70-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
