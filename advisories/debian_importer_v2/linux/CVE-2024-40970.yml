advisory_id: linux/CVE-2024-40970
datasource_id: debian_importer_v2/linux/CVE-2024-40970
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-40970
aliases:
  - CVE-2024-40970
summary: 'In the Linux kernel, the following vulnerability has been resolved:  Avoid hw_desc
  array overrun in dw-axi-dmac  I have a use case where nr_buffers = 3 and in which each descriptor
  is composed by 3 segments, resulting in the DMA channel descs_allocated to be 9. Since axi_desc_put()
  handles the hw_desc considering the descs_allocated, this scenario would result in a kernel
  panic (hw_desc array will be overrun).  To fix this, the proposal is to add a new member to
  the axi_dma_desc structure, where we keep the number of allocated hw_descs (axi_desc_alloc())
  and use it in axi_desc_put() to handle the hw_desc array correctly.  Additionally I propose
  to remove the axi_chan_start_first_queued() call after completing the transfer, since it was
  identified that unbalance can occur (started descriptors can be interrupted and transfer ignored
  due to DMA channel not being enabled).'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.99-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
