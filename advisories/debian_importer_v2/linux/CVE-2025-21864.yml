advisory_id: linux/CVE-2025-21864
datasource_id: debian_importer_v2/linux/CVE-2025-21864
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-21864
aliases:
  - CVE-2025-21864
summary: 'In the Linux kernel, the following vulnerability has been resolved:  tcp: drop secpath
  at the same time as we currently drop dst  Xiumei reported hitting the WARN in xfrm6_tunnel_net_exit
  while running tests that boil down to:  - create a pair of netns  - run a basic TCP test over
  ipcomp6  - delete the pair of netns  The xfrm_state found on spi_byaddr was not deleted at
  the time we delete the netns, because we still have a reference on it. This lingering reference
  comes from a secpath (which holds a ref on the xfrm_state), which is still attached to an
  skb. This skb is not leaked, it ends up on sk_receive_queue and then gets defer-free''d by
  skb_attempt_defer_free.  The problem happens when we defer freeing an skb (push it on one
  CPU''s defer_list), and don''t flush that list before the netns is deleted. In that case,
  we still have a reference on the xfrm_state that we don''t expect at this point.  We already
  drop the skb''s dst in the TCP receive path when it''s no longer needed, so let''s also drop
  the secpath. At this point, tcp_filter has already called into the LSM hooks that may require
  the secpath, so it should not be needed anymore. However, in some of those places, the MPTCP
  extension has just been attached to the skb, so we cannot simply drop all extensions.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.133-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.17-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
