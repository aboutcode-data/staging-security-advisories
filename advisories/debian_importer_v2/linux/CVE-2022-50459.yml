advisory_id: linux/CVE-2022-50459
datasource_id: debian_importer_v2/linux/CVE-2022-50459
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50459
aliases:
  - CVE-2022-50459
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: iscsi:
  iscsi_tcp: Fix null-ptr-deref while calling getpeername()  Fix a NULL pointer crash that occurs
  when we are freeing the socket at the same time we access it via sysfs.  The problem is that:   1.
  iscsi_sw_tcp_conn_get_param() and iscsi_sw_tcp_host_get_param() take     the frwd_lock and
  do sock_hold() then drop the frwd_lock. sock_hold()     does a get on the "struct sock".   2.
  iscsi_sw_tcp_release_conn() does sockfd_put() which does the last put     on the "struct socket"
  and that does __sock_release() which sets the     sock->ops to NULL.   3. iscsi_sw_tcp_conn_get_param()
  and iscsi_sw_tcp_host_get_param() then     call kernel_getpeername() which accesses the NULL
  sock->ops.  Above we do a get on the "struct sock", but we needed a get on the "struct socket".
  Originally, we just held the frwd_lock the entire time but in commit bcf3a2953d36 ("scsi:
  iscsi: iscsi_tcp: Avoid holding spinlock while calling getpeername()") we switched to refcount
  based because the network layer changed and started taking a mutex in that path, so we could
  no longer hold the frwd_lock.  Instead of trying to maintain multiple refcounts, this just
  has us use a mutex for accessing the socket in the interface code paths.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
