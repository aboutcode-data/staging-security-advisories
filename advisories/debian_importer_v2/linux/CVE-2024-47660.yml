advisory_id: linux/CVE-2024-47660
datasource_id: debian_importer_v2/linux/CVE-2024-47660
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-47660
aliases:
  - CVE-2024-47660
summary: 'In the Linux kernel, the following vulnerability has been resolved:  fsnotify: clear
  PARENT_WATCHED flags lazily  In some setups directories can have many (usually negative) dentries.
  Hence __fsnotify_update_child_dentry_flags() function can take a significant amount of time.
  Since the bulk of this function happens under inode->i_lock this causes a significant contention
  on the lock when we remove the watch from the directory as the __fsnotify_update_child_dentry_flags()
  call from fsnotify_recalc_mask() races with __fsnotify_update_child_dentry_flags() calls from
  __fsnotify_parent() happening on children. This can lead upto softlockup reports reported
  by users.  Fix the problem by calling fsnotify_update_children_dentry_flags() to set PARENT_WATCHED
  flags only when parent starts watching children.  When parent stops watching children, clear
  false positive PARENT_WATCHED flags lazily in __fsnotify_parent() for each accessed child.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.112-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.10.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
