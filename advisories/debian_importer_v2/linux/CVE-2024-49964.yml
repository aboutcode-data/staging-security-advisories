advisory_id: linux/CVE-2024-49964
datasource_id: debian_importer_v2/linux/CVE-2024-49964
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-49964
aliases:
  - CVE-2024-49964
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/hugetlb: fix
  memfd_pin_folios free_huge_pages leak  memfd_pin_folios followed by unpin_folios fails to
  restore free_huge_pages if the pages were not already faulted in, because the folio refcount
  for pages created by memfd_alloc_folio never goes to 0.  memfd_pin_folios needs another folio_put
  to undo the folio_try_get below:  memfd_alloc_folio()   alloc_hugetlb_folio_nodemask()     dequeue_hugetlb_folio_nodemask()       dequeue_hugetlb_folio_node_exact()         folio_ref_unfreeze(folio,
  1);    ; adds 1 refcount   folio_try_get()                        ; adds 1 refcount   hugetlb_add_to_page_cache()            ;
  adds 512 refcount (on x86)  With the fix, after memfd_pin_folios + unpin_folios, the refcount
  for the (unfaulted) page is 512, which is correct, as the refcount for a faulted unpinned
  page is 513.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
