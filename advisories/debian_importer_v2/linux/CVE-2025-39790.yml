advisory_id: linux/CVE-2025-39790
datasource_id: debian_importer_v2/linux/CVE-2025-39790
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39790
aliases:
  - CVE-2025-39790
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bus: mhi: host:
  Detect events pointing to unexpected TREs  When a remote device sends a completion event to
  the host, it contains a pointer to the consumed TRE. The host uses this pointer to process
  all of the TREs between it and the host''s local copy of the ring''s read pointer. This works
  when processing completion for chained transactions, but can lead to nasty results if the
  device sends an event for a single-element transaction with a read pointer that is multiple
  elements ahead of the host''s read pointer.  For instance, if the host accesses an event ring
  while the device is updating it, the pointer inside of the event might still point to an old
  TRE. If the host uses the channel''s xfer_cb() to directly free the buffer pointed to by the
  TRE, the buffer will be double-freed.  This behavior was observed on an ep that used upstream
  EP stack without ''commit 6f18d174b73d ("bus: mhi: ep: Update read pointer only after buffer
  is written")''. Where the device updated the events ring pointer before updating the event
  contents, so it left a window where the host was able to access the stale data the event pointed
  to, before the device had the chance to update them. The usual pattern was that the host received
  an event pointing to a TRE that is not immediately after the last processed one, so it got
  treated as if it was a chained transaction, processing all of the TREs in between the two
  read pointers.  This commit aims to harden the host by ensuring transactions where the event
  points to a TRE that isn''t local_rp + 1 are chained.  [mani: added stable tag and reworded
  commit message]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.153-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.16.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.48-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
