advisory_id: linux/CVE-2021-47225
datasource_id: debian_importer_v2/linux/CVE-2021-47225
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47225
aliases:
  - CVE-2021-47225
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mac80211: fix
  deadlock in AP/VLAN handling  Syzbot reports that when you have AP_VLAN interfaces that are
  up and close the AP interface they belong to, we get a deadlock. No surprise - since we dev_close()
  them with the wiphy mutex held, which goes back into the netdev notifier in cfg80211 and tries
  to acquire the wiphy mutex there.  To fix this, we need to do two things:  1) prevent changing
  iftype while AP_VLANs are up, we can''t     easily fix this case since cfg80211 already calls
  us with     the wiphy mutex held, but change_interface() is relatively     rare in drivers
  anyway, so changing iftype isn''t used much     (and userspace has to fall back to down/change/up
  anyway)  2) pull the dev_close() loop over VLANs out of the wiphy mutex     section in the
  normal stop case'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
