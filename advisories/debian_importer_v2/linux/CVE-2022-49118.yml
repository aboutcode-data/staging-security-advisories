advisory_id: linux/CVE-2022-49118
datasource_id: debian_importer_v2/linux/CVE-2022-49118
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49118
aliases:
  - CVE-2022-49118
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: hisi_sas:
  Free irq vectors in order for v3 HW  If the driver probe fails to request the channel IRQ
  or fatal IRQ, the driver will free the IRQ vectors before freeing the IRQs in free_irq(),
  and this will cause a kernel BUG like this:  ------------[ cut here ]------------ kernel BUG
  at drivers/pci/msi.c:369! Internal error: Oops - BUG: 0 [#1] PREEMPT SMP Call trace:    free_msi_irqs+0x118/0x13c    pci_disable_msi+0xfc/0x120    pci_free_irq_vectors+0x24/0x3c    hisi_sas_v3_probe+0x360/0x9d0
  [hisi_sas_v3_hw]    local_pci_probe+0x44/0xb0    work_for_cpu_fn+0x20/0x34    process_one_work+0x1d0/0x340    worker_thread+0x2e0/0x460    kthread+0x180/0x190    ret_from_fork+0x10/0x20
  ---[ end trace b88990335b610c11 ]---  So we use devm_add_action() to control the order in
  which we free the vectors.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.17.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.113-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
