advisory_id: linux/CVE-2025-71144
datasource_id: debian_importer_v2/linux/CVE-2025-71144
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71144
aliases:
  - CVE-2025-71144
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mptcp: ensure
  context reset on disconnect()  After the blamed commit below, if the MPC subflow is already
  in TCP_CLOSE status or has fallback to TCP at mptcp_disconnect() time, mptcp_do_fastclose()
  skips setting the `send_fastclose flag` and the later __mptcp_close_ssk() does not reset anymore
  the related subflow context.  Any later connection will be created with both the `request_mptcp`
  flag and the msk-level fallback status off (it is unconditionally cleared at MPTCP disconnect
  time), leading to a warning in subflow_data_ready():    WARNING: CPU: 26 PID: 8996 at net/mptcp/subflow.c:1519
  subflow_data_ready (net/mptcp/subflow.c:1519 (discriminator 13))   Modules linked in:   CPU:
  26 UID: 0 PID: 8996 Comm: syz.22.39 Not tainted 6.18.0-rc7-05427-g11fc074f6c36 #1 PREEMPT(voluntary)   Hardware
  name: Bochs Bochs, BIOS Bochs 01/01/2011   RIP: 0010:subflow_data_ready (net/mptcp/subflow.c:1519
  (discriminator 13))   Code: 90 0f 0b 90 90 e9 04 fe ff ff e8 b7 1e f5 fe 89 ee bf 07 00 00
  00 e8 db 19 f5 fe 83 fd 07 0f 84 35 ff ff ff e8 9d 1e f5 fe 90 <0f> 0b 90 e9 27 ff ff ff e8
  8f 1e f5 fe 4c 89 e7 48 89 de e8 14 09   RSP: 0018:ffffc9002646fb30 EFLAGS: 00010293   RAX:
  0000000000000000 RBX: ffff88813b218000 RCX: ffffffff825c8435   RDX: ffff8881300b3580 RSI:
  ffffffff825c8443 RDI: 0000000000000005   RBP: 000000000000000b R08: ffffffff825c8435 R09:
  000000000000000b   R10: 0000000000000005 R11: 0000000000000007 R12: ffff888131ac0000   R13:
  0000000000000000 R14: 0000000000000000 R15: 0000000000000000   FS:  00007f88330af6c0(0000)
  GS:ffff888a93dd2000(0000) knlGS:0000000000000000   CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033   CR2:
  00007f88330aefe8 CR3: 000000010ff59000 CR4: 0000000000350ef0   Call Trace:    <TASK>    tcp_data_ready
  (net/ipv4/tcp_input.c:5356)    tcp_data_queue (net/ipv4/tcp_input.c:5445)    tcp_rcv_state_process
  (net/ipv4/tcp_input.c:7165)    tcp_v4_do_rcv (net/ipv4/tcp_ipv4.c:1955)    __release_sock
  (include/net/sock.h:1158 (discriminator 6) net/core/sock.c:3180 (discriminator 6))    release_sock
  (net/core/sock.c:3737)    mptcp_sendmsg (net/mptcp/protocol.c:1763 net/mptcp/protocol.c:1857)    inet_sendmsg
  (net/ipv4/af_inet.c:853 (discriminator 7))    __sys_sendto (net/socket.c:727 (discriminator
  15) net/socket.c:742 (discriminator 15) net/socket.c:2244 (discriminator 15))    __x64_sys_sendto
  (net/socket.c:2247)    do_syscall_64 (arch/x86/entry/syscall_64.c:63 (discriminator 1) arch/x86/entry/syscall_64.c:94
  (discriminator 1))    entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)   RIP:
  0033:0x7f883326702d  Address the issue setting an explicit `fastclosing` flag at fastclose
  time, and checking such flag after mptcp_do_fastclose().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
