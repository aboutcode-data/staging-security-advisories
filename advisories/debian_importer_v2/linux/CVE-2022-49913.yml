advisory_id: linux/CVE-2022-49913
datasource_id: debian_importer_v2/linux/CVE-2022-49913
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49913
aliases:
  - CVE-2022-49913
summary: 'In the Linux kernel, the following vulnerability has been resolved:  btrfs: fix inode
  list leak during backref walking at find_parent_nodes()  During backref walking, at find_parent_nodes(),
  if we are dealing with a data extent and we get an error while resolving the indirect backrefs,
  at resolve_indirect_refs(), or in the while loop that iterates over the refs in the direct
  refs rbtree, we end up leaking the inode lists attached to the direct refs we have in the
  direct refs rbtree that were not yet added to the refs ulist passed as argument to find_parent_nodes().
  Since they were not yet added to the refs ulist and prelim_release() does not free the lists,
  on error the caller can only free the lists attached to the refs that were added to the refs
  ulist, all the remaining refs get their inode lists never freed, therefore leaking their memory.  Fix
  this by having prelim_release() always free any attached inode list to each ref found in the
  rbtree, and have find_parent_nodes() set the ref''s inode list to NULL once it transfers ownership
  of the inode list to a ref added to the refs ulist passed to find_parent_nodes().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
