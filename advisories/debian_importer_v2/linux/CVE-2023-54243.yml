advisory_id: linux/CVE-2023-54243
datasource_id: debian_importer_v2/linux/CVE-2023-54243
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54243
aliases:
  - CVE-2023-54243
summary: 'In the Linux kernel, the following vulnerability has been resolved:  netfilter: ebtables:
  fix table blob use-after-free  We are not allowed to return an error at this point. Looking
  at the code it looks like ret is always 0 at this point, but its not.  t = find_table_lock(net,
  repl->name, &ret, &ebt_mutex);  ... this can return a valid table, with ret != 0.  This bug
  causes update of table->private with the new blob, but then frees the blob right away in the
  caller.  Syzbot report:  BUG: KASAN: vmalloc-out-of-bounds in __ebt_unregister_table+0xc00/0xcd0
  net/bridge/netfilter/ebtables.c:1168 Read of size 4 at addr ffffc90005425000 by task kworker/u4:4/74
  Workqueue: netns cleanup_net Call Trace:  kasan_report+0xbf/0x1f0 mm/kasan/report.c:517  __ebt_unregister_table+0xc00/0xcd0
  net/bridge/netfilter/ebtables.c:1168  ebt_unregister_table+0x35/0x40 net/bridge/netfilter/ebtables.c:1372  ops_exit_list+0xb0/0x170
  net/core/net_namespace.c:169  cleanup_net+0x4ee/0xb10 net/core/net_namespace.c:613 ...  ip(6)tables
  appears to be ok (ret should be 0 at this point) but make this more obvious.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.20-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
