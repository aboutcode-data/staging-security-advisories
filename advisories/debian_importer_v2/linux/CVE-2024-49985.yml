advisory_id: linux/CVE-2024-49985
datasource_id: debian_importer_v2/linux/CVE-2024-49985
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-49985
aliases:
  - CVE-2024-49985
summary: 'In the Linux kernel, the following vulnerability has been resolved:  i2c: stm32f7:
  Do not prepare/unprepare clock during runtime suspend/resume  In case there is any sort of
  clock controller attached to this I2C bus controller, for example Versaclock or even an AIC32x4
  I2C codec, then an I2C transfer triggered from the clock controller clk_ops .prepare callback
  may trigger a deadlock on drivers/clk/clk.c prepare_lock mutex.  This is because the clock
  controller first grabs the prepare_lock mutex and then performs the prepare operation, including
  its I2C access. The I2C access resumes this I2C bus controller via .runtime_resume callback,
  which calls clk_prepare_enable(), which attempts to grab the prepare_lock mutex again and
  deadlocks.  Since the clock are already prepared since probe() and unprepared in remove(),
  use simple clk_enable()/clk_disable() calls to enable and disable the clock on runtime suspend
  and resume, to avoid hitting the prepare_lock mutex.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.115-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.234-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
