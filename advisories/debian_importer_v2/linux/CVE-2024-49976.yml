advisory_id: linux/CVE-2024-49976
datasource_id: debian_importer_v2/linux/CVE-2024-49976
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-49976
aliases:
  - CVE-2024-49976
summary: 'In the Linux kernel, the following vulnerability has been resolved:  tracing/timerlat:
  Drop interface_lock in stop_kthread()  stop_kthread() is the offline callback for "trace/osnoise:online",
  since commit 5bfbcd1ee57b ("tracing/timerlat: Add interface_lock around clearing of kthread
  in stop_kthread()"), the following ABBA deadlock scenario is introduced:  T1                            |
  T2 [BP]               | T3 [AP] osnoise_hotplug_workfn()      | work_for_cpu_fn()     | cpuhp_thread_fun()                               |   _cpu_down()         |   osnoise_cpu_die()   mutex_lock(&interface_lock)
  |                       |     stop_kthread()                               |     cpus_write_lock()
  |       mutex_lock(&interface_lock)   cpus_read_lock()            |     cpuhp_kick_ap()   |  As
  the interface_lock here in just for protecting the "kthread" field of the osn_var, use xchg()
  instead to fix this issue. Also use for_each_online_cpu() back in stop_per_cpu_kthreads()
  as it can take cpu_read_lock() again.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
