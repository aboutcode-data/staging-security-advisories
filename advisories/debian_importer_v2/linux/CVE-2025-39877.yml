advisory_id: linux/CVE-2025-39877
datasource_id: debian_importer_v2/linux/CVE-2025-39877
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39877
aliases:
  - CVE-2025-39877
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/damon/sysfs:
  fix use-after-free in state_show()  state_show() reads kdamond->damon_ctx without holding
  damon_sysfs_lock.  This allows a use-after-free race:  CPU 0                         CPU 1
  -----                         ----- state_show()                  damon_sysfs_turn_damon_on()
  ctx = kdamond->damon_ctx;     mutex_lock(&damon_sysfs_lock);                               damon_destroy_ctx(kdamond->damon_ctx);                               kdamond->damon_ctx
  = NULL;                               mutex_unlock(&damon_sysfs_lock); damon_is_running(ctx);        /*
  ctx is freed */ mutex_lock(&ctx->kdamond_lock); /* UAF */  (The race can also occur with damon_sysfs_kdamonds_rm_dirs()
  and damon_sysfs_kdamond_release(), which free or replace the context under damon_sysfs_lock.)  Fix
  by taking damon_sysfs_lock before dereferencing the context, mirroring the locking used in
  pid_show().  The bug has existed since state_show() first accessed kdamond->damon_ctx.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.153-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.48-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
