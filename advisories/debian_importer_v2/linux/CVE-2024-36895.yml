advisory_id: linux/CVE-2024-36895
datasource_id: debian_importer_v2/linux/CVE-2024-36895
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-36895
aliases:
  - CVE-2024-36895
summary: 'In the Linux kernel, the following vulnerability has been resolved:  usb: gadget:
  uvc: use correct buffer size when parsing configfs lists  This commit fixes uvc gadget support
  on 32-bit platforms.  Commit 0df28607c5cb ("usb: gadget: uvc: Generalise helper functions
  for reuse") introduced a helper function __uvcg_iter_item_entries() to aid with parsing lists
  of items on configfs attributes stores. This function is a generalization of another very
  similar function, which used a stack-allocated temporary buffer of fixed size for each item
  in the list and used the sizeof() operator to check for potential buffer overruns. The new
  function was changed to allocate the now variably sized temp buffer on heap, but wasn''t properly
  updated to also check for max buffer size using the computed size instead of sizeof() operator.  As
  a result, the maximum item size was 7 (plus null terminator) on 64-bit platforms, and 3 on
  32-bit ones. While 7 is accidentally just barely enough, 3 is definitely too small for some
  of UVC configfs attributes. For example, dwFrameInteval, specified in 100ns units, usually
  has 6-digit item values, e.g. 166666 for 60fps.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.8.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
