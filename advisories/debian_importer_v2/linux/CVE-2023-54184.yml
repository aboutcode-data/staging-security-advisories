advisory_id: linux/CVE-2023-54184
datasource_id: debian_importer_v2/linux/CVE-2023-54184
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54184
aliases:
  - CVE-2023-54184
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: target:
  iscsit: Free cmds before session free  Commands from recovery entries are freed after session
  has been closed. That leads to use-after-free at command free or NPE with such call trace:  Time2Retain
  timer expired for SID: 1, cleaning up iSCSI session. BUG: kernel NULL pointer dereference,
  address: 0000000000000140 RIP: 0010:sbitmap_queue_clear+0x3a/0xa0 Call Trace:  target_release_cmd_kref+0xd1/0x1f0
  [target_core_mod]  transport_generic_free_cmd+0xd1/0x180 [target_core_mod]  iscsit_free_cmd+0x53/0xd0
  [iscsi_target_mod]  iscsit_free_connection_recovery_entries+0x29d/0x320 [iscsi_target_mod]  iscsit_close_session+0x13a/0x140
  [iscsi_target_mod]  iscsit_check_post_dataout+0x440/0x440 [iscsi_target_mod]  call_timer_fn+0x24/0x140  Move
  cleanup of recovery enrties to before session freeing.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.37-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.191-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.3.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
