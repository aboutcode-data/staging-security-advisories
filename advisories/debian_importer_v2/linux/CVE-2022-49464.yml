advisory_id: linux/CVE-2022-49464
datasource_id: debian_importer_v2/linux/CVE-2022-49464
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49464
aliases:
  - CVE-2022-49464
summary: 'In the Linux kernel, the following vulnerability has been resolved:  erofs: fix buffer
  copy overflow of ztailpacking feature  I got some KASAN report as below:  [   46.959738] ==================================================================
  [   46.960430] BUG: KASAN: use-after-free in z_erofs_shifted_transform+0x2bd/0x370 [   46.960430]
  Read of size 4074 at addr ffff8880300c2f8e by task fssum/188 ... [   46.960430] Call Trace:
  [   46.960430]  <TASK> [   46.960430]  dump_stack_lvl+0x41/0x5e [   46.960430]  print_report.cold+0xb2/0x6b7
  [   46.960430]  ? z_erofs_shifted_transform+0x2bd/0x370 [   46.960430]  kasan_report+0x8a/0x140
  [   46.960430]  ? z_erofs_shifted_transform+0x2bd/0x370 [   46.960430]  kasan_check_range+0x14d/0x1d0
  [   46.960430]  memcpy+0x20/0x60 [   46.960430]  z_erofs_shifted_transform+0x2bd/0x370 [   46.960430]  z_erofs_decompress_pcluster+0xaae/0x1080  The
  root cause is that the tail pcluster won''t be a complete filesystem block anymore. So if
  ztailpacking is used, the second part of an uncompressed tail pcluster may not be ``rq->pageofs_out``.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
