advisory_id: linux/CVE-2025-40350
datasource_id: debian_importer_v2/linux/CVE-2025-40350
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40350
aliases:
  - CVE-2025-40350
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net/mlx5e: RX,
  Fix generating skb from non-linear xdp_buff for striding RQ  XDP programs can change the layout
  of an xdp_buff through bpf_xdp_adjust_tail() and bpf_xdp_adjust_head(). Therefore, the driver
  cannot assume the size of the linear data area nor fragments. Fix the bug in mlx5 by generating
  skb according to xdp_buff after XDP programs run.  Currently, when handling multi-buf XDP,
  the mlx5 driver assumes the layout of an xdp_buff to be unchanged. That is, the linear data
  area continues to be empty and fragments remain the same. This may cause the driver to generate
  erroneous skb or triggering a kernel warning. When an XDP program added linear data through
  bpf_xdp_adjust_head(), the linear data will be ignored as mlx5e_build_linear_skb() builds
  an skb without linear data and then pull data from fragments to fill the linear data area.
  When an XDP program has shrunk the non-linear data through bpf_xdp_adjust_tail(), the delta
  passed to __pskb_pull_tail() may exceed the actual nonlinear data size and trigger the BUG_ON
  in it.  To fix the issue, first record the original number of fragments. If the number of
  fragments changes after the XDP program runs, rewind the end fragment pointer by the difference
  and recalculate the truesize. Then, build the skb with the linear data area matching the xdp_buff.
  Finally, only pull data in if there is non-linear data and fill the linear part up to 256
  bytes.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
