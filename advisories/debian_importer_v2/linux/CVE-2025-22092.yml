advisory_id: linux/CVE-2025-22092
datasource_id: debian_importer_v2/linux/CVE-2025-22092
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-22092
aliases:
  - CVE-2025-22092
summary: 'In the Linux kernel, the following vulnerability has been resolved:  PCI: Fix NULL
  dereference in SR-IOV VF creation error path  Clean up when virtfn setup fails to prevent
  NULL pointer dereference during device removal. The kernel oops below occurred due to incorrect
  error handling flow when pci_setup_device() fails.  Add pci_iov_scan_device(), which handles
  virtfn allocation and setup and cleans up if pci_setup_device() fails, so pci_iov_add_virtfn()
  doesn''t need to call pci_stop_and_remove_bus_device().  This prevents accessing partially
  initialized virtfn devices during removal.    BUG: kernel NULL pointer dereference, address:
  00000000000000d0   RIP: 0010:device_del+0x3d/0x3d0   Call Trace:    pci_remove_bus_device+0x7c/0x100    pci_iov_add_virtfn+0xfa/0x200    sriov_enable+0x208/0x420    mlx5_core_sriov_configure+0x6a/0x160
  [mlx5_core]    sriov_numvfs_store+0xae/0x1a0  [bhelgaas: commit log, return ERR_PTR(-ENOMEM)
  directly]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
