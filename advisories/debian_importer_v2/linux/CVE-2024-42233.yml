advisory_id: linux/CVE-2024-42233
datasource_id: debian_importer_v2/linux/CVE-2024-42233
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-42233
aliases:
  - CVE-2024-42233
summary: 'In the Linux kernel, the following vulnerability has been resolved:  filemap: replace
  pte_offset_map() with pte_offset_map_nolock()  The vmf->ptl in filemap_fault_recheck_pte_none()
  is still set from handle_pte_fault().  But at the same time, we did a pte_unmap(vmf->pte).  After
  a pte_unmap(vmf->pte) unmap and rcu_read_unlock(), the page table may be racily changed and
  vmf->ptl maybe fails to protect the actual page table.  Fix this by replacing pte_offset_map()
  with pte_offset_map_nolock().  As David said, the PTL pointer might be stale so if we continue
  to use it infilemap_fault_recheck_pte_none(), it might trigger UAF.  Also, if the PTL fails,
  the issue fixed by commit 58f327f2ce80 ("filemap: avoid unnecessary major faults in filemap_fault()")
  might reappear.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
