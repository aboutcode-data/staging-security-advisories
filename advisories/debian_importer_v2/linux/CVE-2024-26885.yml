advisory_id: linux/CVE-2024-26885
datasource_id: debian_importer_v2/linux/CVE-2024-26885
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-26885
aliases:
  - CVE-2024-26885
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: Fix DEVMAP_HASH
  overflow check on 32-bit arches  The devmap code allocates a number hash buckets equal to
  the next power of two of the max_entries value provided when creating the map. When rounding
  up to the next power of two, the 32-bit variable storing the number of buckets can overflow,
  and the code checks for overflow by checking if the truncated 32-bit value is equal to 0.
  However, on 32-bit arches the rounding up itself can overflow mid-way through, because it
  ends up doing a left-shift of 32 bits on an unsigned long value. If the size of an unsigned
  long is four bytes, this is undefined behaviour, so there is no guarantee that we''ll end
  up with a nice and tidy 0-value at the end.  Syzbot managed to turn this into a crash on arm32
  by creating a DEVMAP_HASH with max_entries > 0x80000000 and then trying to update it. Fix
  this by moving the overflow check to before the rounding up operation.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.85-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
