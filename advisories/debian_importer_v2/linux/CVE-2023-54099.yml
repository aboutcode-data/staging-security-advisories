advisory_id: linux/CVE-2023-54099
datasource_id: debian_importer_v2/linux/CVE-2023-54099
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54099
aliases:
  - CVE-2023-54099
summary: 'In the Linux kernel, the following vulnerability has been resolved:  fs: Protect reconfiguration
  of sb read-write from racing writes  The reconfigure / remount code takes a lot of effort
  to protect filesystem''s reconfiguration code from racing writes on remounting read-only.
  However during remounting read-only filesystem to read-write mode userspace writes can start
  immediately once we clear SB_RDONLY flag. This is inconvenient for example for ext4 because
  we need to do some writes to the filesystem (such as preparation of quota files) before we
  can take userspace writes so we are clearing SB_RDONLY flag before we are fully ready to accept
  userpace writes and syzbot has found a way to exploit this [1]. Also as far as I''m reading
  the code the filesystem remount code was protected from racing writes in the legacy mount
  path by the mount''s MNT_READONLY flag so this is relatively new problem. It is actually fairly
  easy to protect remount read-write from racing writes using sb->s_readonly_remount flag so
  let''s just do that instead of having to workaround these races in the filesystem code.  [1]
  https://lore.kernel.org/all/00000000000006a0df05f6667499@google.com/T/'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.52-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.191-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.4.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
