advisory_id: linux/CVE-2023-54313
datasource_id: debian_importer_v2/linux/CVE-2023-54313
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54313
aliases:
  - CVE-2023-54313
summary: "In the Linux kernel, the following vulnerability has been resolved:  ovl: fix null\
  \ pointer dereference in ovl_get_acl_rcu()  Following process:          P1               \
  \      P2  path_openat   link_path_walk    may_lookup     inode_permission(rcu)      ovl_permission\
  \       acl_permission_check        check_acl         get_cached_acl_rcu \t ovl_get_inode_acl\
  \ \t  realinode = ovl_inode_real(ovl_inode) \t                      drop_cache \t\t      \
  \         __dentry_kill(ovl_dentry) \t\t\t\tiput(ovl_inode) \t\t                 ovl_destroy_inode(ovl_inode)\
  \ \t\t                  dput(oi->__upperdentry) \t\t                   dentry_kill(upperdentry)\
  \ \t\t                    dentry_unlink_inode \t\t\t\t     upperdentry->d_inode = NULL \t\
  \    ovl_inode_upper \t     upperdentry = ovl_i_dentry_upper(ovl_inode) \t     d_inode(upperdentry)\
  \ // returns NULL \t  IS_POSIXACL(realinode) // NULL pointer dereference , will trigger an\
  \ null pointer dereference at realinode:   [  205.472797] BUG: kernel NULL pointer dereference,\
  \ address:                  0000000000000028   [  205.476701] CPU: 2 PID: 2713 Comm: ls Not\
  \ tainted                  6.3.0-12064-g2edfa098e750-dirty #1216   [  205.478754] RIP: 0010:do_ovl_get_acl+0x5d/0x300\
  \   [  205.489584] Call Trace:   [  205.489812]  <TASK>   [  205.490014]  ovl_get_inode_acl+0x26/0x30\
  \   [  205.490466]  get_cached_acl_rcu+0x61/0xa0   [  205.490908]  generic_permission+0x1bf/0x4e0\
  \   [  205.491447]  ovl_permission+0x79/0x1b0   [  205.491917]  inode_permission+0x15e/0x2c0\
  \   [  205.492425]  link_path_walk+0x115/0x550   [  205.493311]  path_lookupat.isra.0+0xb2/0x200\
  \   [  205.493803]  filename_lookup+0xda/0x240   [  205.495747]  vfs_fstatat+0x7b/0xb0  Fetch\
  \ a reproducer in [Link].  Use the helper ovl_i_path_realinode() to get realinode and then\
  \ do non-nullptr checking."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.52-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.4.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
