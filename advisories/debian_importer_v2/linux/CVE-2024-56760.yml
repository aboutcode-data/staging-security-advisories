advisory_id: linux/CVE-2024-56760
datasource_id: debian_importer_v2/linux/CVE-2024-56760
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-56760
aliases:
  - CVE-2024-56760
summary: 'In the Linux kernel, the following vulnerability has been resolved:  PCI/MSI: Handle
  lack of irqdomain gracefully  Alexandre observed a warning emitted from pci_msi_setup_msi_irqs()
  on a RISCV platform which does not provide PCI/MSI support:   WARNING: CPU: 1 PID: 1 at drivers/pci/msi/msi.h:121
  pci_msi_setup_msi_irqs+0x2c/0x32  __pci_enable_msix_range+0x30c/0x596  pci_msi_setup_msi_irqs+0x2c/0x32  pci_alloc_irq_vectors_affinity+0xb8/0xe2  RISCV
  uses hierarchical interrupt domains and correctly does not implement the legacy fallback.
  The warning triggers from the legacy fallback stub.  That warning is bogus as the PCI/MSI
  layer knows whether a PCI/MSI parent domain is associated with the device or not. There is
  a check for MSI-X, which has a legacy assumption. But that legacy fallback assumption is only
  valid when legacy support is enabled, but otherwise the check should simply return -ENOTSUPP.  Loongarch
  tripped over the same problem and blindly enabled legacy support without implementing the
  legacy fallbacks. There are weak implementations which return an error, so the problem was
  papered over.  Correct pci_msi_domain_supports() to evaluate the legacy mode and add the missing
  supported check into the MSI enable path to complete it.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
