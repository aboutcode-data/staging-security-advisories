advisory_id: linux/CVE-2022-50568
datasource_id: debian_importer_v2/linux/CVE-2022-50568
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50568
aliases:
  - CVE-2022-50568
summary: "In the Linux kernel, the following vulnerability has been resolved:  usb: gadget:\
  \ f_hid: fix f_hidg lifetime vs cdev  The embedded struct cdev does not have its lifetime\
  \ correctly tied to the enclosing struct f_hidg, so there is a use-after-free if /dev/hidgN\
  \ is held open while the gadget is deleted.  This can readily be replicated with libusbgx's\
  \ example programs (for conciseness - operating directly via configfs is equivalent):  \t\
  gadget-hid \texec 3<> /dev/hidg0 \tgadget-vid-pid-remove \texec 3<&-  Pull the existing device\
  \ up in to struct f_hidg and make use of the cdev_device_{add,del}() helpers.  This changes\
  \ the lifetime of the device object to match struct f_hidg, but note that it is still added\
  \ and deleted at the same time."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
