advisory_id: linux/CVE-2022-48867
datasource_id: debian_importer_v2/linux/CVE-2022-48867
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-48867
aliases:
  - CVE-2022-48867
summary: "In the Linux kernel, the following vulnerability has been resolved:  dmaengine: idxd:\
  \ Prevent use after free on completion memory  On driver unload any pending descriptors are\
  \ flushed at the time the interrupt is freed: idxd_dmaengine_drv_remove() -> \tdrv_disable_wq()\
  \ -> \t\tidxd_wq_free_irq() -> \t\t\tidxd_flush_pending_descs().  If there are any descriptors\
  \ present that need to be flushed this flow triggers a \"not present\" page fault as below:\
  \   BUG: unable to handle page fault for address: ff391c97c70c9040  #PF: supervisor read access\
  \ in kernel mode  #PF: error_code(0x0000) - not-present page  The address that triggers the\
  \ fault is the address of the descriptor that was freed moments earlier via: drv_disable_wq()->idxd_wq_free_resources()\
  \  Fix the use after free by freeing the descriptors after any possible usage. This is done\
  \ after idxd_wq_reset() to ensure that the memory remains accessible during possible completion\
  \ writes by the device."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
