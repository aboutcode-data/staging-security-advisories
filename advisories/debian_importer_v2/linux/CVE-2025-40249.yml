advisory_id: linux/CVE-2025-40249
datasource_id: debian_importer_v2/linux/CVE-2025-40249
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40249
aliases:
  - CVE-2025-40249
summary: 'In the Linux kernel, the following vulnerability has been resolved:  gpio: cdev: make
  sure the cdev fd is still active before emitting events  With the final call to fput() on
  a file descriptor, the release action may be deferred and scheduled on a work queue. The reference
  count of that descriptor is still zero and it must not be used. It''s possible that a GPIO
  change, we want to notify the user-space about, happens AFTER the reference count on the file
  descriptor associated with the character device went down to zero but BEFORE the .release()
  callback was called from the workqueue and so BEFORE we unregistered from the notifier.  Using
  the regular get_file() routine in this situation triggers the following warning:    struct
  file::f_count incremented from zero; use-after-free condition present!  So use the get_file_active()
  variant that will return NULL on file descriptors that have been or are being released.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
