advisory_id: linux/CVE-2022-49381
datasource_id: debian_importer_v2/linux/CVE-2022-49381
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49381
aliases:
  - CVE-2022-49381
summary: 'In the Linux kernel, the following vulnerability has been resolved:  jffs2: fix memory
  leak in jffs2_do_fill_super  If jffs2_iget() or d_make_root() in jffs2_do_fill_super() returns
  an error, we can observe the following kmemleak report:  --------------------------------------------
  unreferenced object 0xffff888105a65340 (size 64):   comm "mount", pid 710, jiffies 4302851558
  (age 58.239s)   hex dump (first 32 bytes):     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  00  ................     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................   backtrace:     [<ffffffff859c45e5>]
  kmem_cache_alloc_trace+0x475/0x8a0     [<ffffffff86160146>] jffs2_sum_init+0x96/0x1a0     [<ffffffff86140e25>]
  jffs2_do_mount_fs+0x745/0x2120     [<ffffffff86149fec>] jffs2_do_fill_super+0x35c/0x810     [<ffffffff8614aae9>]
  jffs2_fill_super+0x2b9/0x3b0     [...] unreferenced object 0xffff8881bd7f0000 (size 65536):   comm
  "mount", pid 710, jiffies 4302851558 (age 58.239s)   hex dump (first 32 bytes):     bb bb
  bb bb bb bb bb bb bb bb bb bb bb bb bb bb  ................     bb bb bb bb bb bb bb bb bb
  bb bb bb bb bb bb bb  ................   backtrace:     [<ffffffff858579ba>] kmalloc_order+0xda/0x110     [<ffffffff85857a11>]
  kmalloc_order_trace+0x21/0x130     [<ffffffff859c2ed1>] __kmalloc+0x711/0x8a0     [<ffffffff86160189>]
  jffs2_sum_init+0xd9/0x1a0     [<ffffffff86140e25>] jffs2_do_mount_fs+0x745/0x2120     [<ffffffff86149fec>]
  jffs2_do_fill_super+0x35c/0x810     [<ffffffff8614aae9>] jffs2_fill_super+0x2b9/0x3b0     [...]
  --------------------------------------------  This is because the resources allocated in jffs2_sum_init()
  are not released. Call jffs2_sum_exit() to release these resources to solve the problem.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.127-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
