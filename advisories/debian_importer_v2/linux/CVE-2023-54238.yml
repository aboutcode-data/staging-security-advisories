advisory_id: linux/CVE-2023-54238
datasource_id: debian_importer_v2/linux/CVE-2023-54238
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54238
aliases:
  - CVE-2023-54238
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mlx5: fix skb
  leak while fifo resync and push  During ptp resync operation SKBs were poped from the fifo
  but were never freed neither by napi_consume nor by dev_kfree_skb_any. Add call to napi_consume_skb
  to properly free SKBs.  Another leak was happening because mlx5e_skb_fifo_has_room() had an
  error in the check. Comparing free running counters works well unless C promotes the types
  to something wider than the counter. In this case counters are u16 but the result of the substraction
  is promouted to int and it causes wrong result (negative value) of the check when producer
  have already overlapped but consumer haven''t yet. Explicit cast to u16 fixes the issue.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.20-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
