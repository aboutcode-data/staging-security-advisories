advisory_id: linux/CVE-2025-40272
datasource_id: debian_importer_v2/linux/CVE-2025-40272
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40272
aliases:
  - CVE-2025-40272
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/secretmem:
  fix use-after-free race in fault handler  When a page fault occurs in a secret memory file
  created with `memfd_secret(2)`, the kernel will allocate a new folio for it, mark the underlying
  page as not-present in the direct map, and add it to the file mapping.  If two tasks cause
  a fault in the same page concurrently, both could end up allocating a folio and removing the
  page from the direct map, but only one would succeed in adding the folio to the file mapping.  The
  task that failed undoes the effects of its attempt by (a) freeing the folio again and (b)
  putting the page back into the direct map.  However, by doing these two operations in this
  order, the page becomes available to the allocator again before it is placed back in the direct
  mapping.  If another task attempts to allocate the page between (a) and (b), and the kernel
  tries to access it via the direct map, it would result in a supervisor not-present page fault.  Fix
  the ordering to restore the direct map before the folio is freed.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
