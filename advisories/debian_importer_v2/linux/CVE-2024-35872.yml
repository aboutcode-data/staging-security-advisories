advisory_id: linux/CVE-2024-35872
datasource_id: debian_importer_v2/linux/CVE-2024-35872
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-35872
aliases:
  - CVE-2024-35872
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/secretmem:
  fix GUP-fast succeeding on secretmem folios  folio_is_secretmem() currently relies on secretmem
  folios being LRU folios, to save some cycles.  However, folios might reside in a folio batch
  without the LRU flag set, or temporarily have their LRU flag cleared.  Consequently, the LRU
  flag is unreliable for this purpose.  In particular, this is the case when secretmem_fault()
  allocates a fresh page and calls filemap_add_folio()->folio_add_lru().  The folio might be
  added to the per-cpu folio batch and won''t get the LRU flag set until the batch was drained
  using e.g., lru_add_drain().  Consequently, folio_is_secretmem() might not detect secretmem
  folios and GUP-fast can succeed in grabbing a secretmem folio, crashing the kernel when we
  would later try reading/writing to the folio, because the folio has been unmapped from the
  directmap.  Fix it by removing that unreliable check.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.85-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.8.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
