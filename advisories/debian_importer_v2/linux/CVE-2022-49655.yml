advisory_id: linux/CVE-2022-49655
datasource_id: debian_importer_v2/linux/CVE-2022-49655
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49655
aliases:
  - CVE-2022-49655
summary: 'In the Linux kernel, the following vulnerability has been resolved:  fscache: Fix
  invalidation/lookup race  If an NFS file is opened for writing and closed, fscache_invalidate()
  will be asked to invalidate the file - however, if the cookie is in the LOOKING_UP state (or
  the CREATING state), then request to invalidate doesn''t get recorded for fscache_cookie_state_machine()
  to do something with.  Fix this by making __fscache_invalidate() set a flag if it sees the
  cookie is in the LOOKING_UP state to indicate that we need to go to invalidation. Note that
  this requires a count on the n_accesses counter for the state machine, which that will release
  when it''s done.  fscache_cookie_state_machine() then shifts to the INVALIDATING state if
  it sees the flag.  Without this, an nfs file can get corrupted if it gets modified locally
  and then read locally as the cache contents may not get updated.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.14-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
