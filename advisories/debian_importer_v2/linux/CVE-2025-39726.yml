advisory_id: linux/CVE-2025-39726
datasource_id: debian_importer_v2/linux/CVE-2025-39726
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39726
aliases:
  - CVE-2025-39726
summary: 'In the Linux kernel, the following vulnerability has been resolved:  s390/ism: fix
  concurrency management in ism_cmd()  The s390x ISM device data sheet clearly states that only
  one request-response sequence is allowable per ISM function at any point in time.  Unfortunately
  as of today the s390/ism driver in Linux does not honor that requirement. This patch aims
  to rectify that.  This problem was discovered based on Aliaksei''s bug report which states
  that for certain workloads the ISM functions end up entering error state (with PEC 2 as seen
  from the logs) after a while and as a consequence connections handled by the respective function
  break, and for future connection requests the ISM device is not considered -- given it is
  in a dysfunctional state. During further debugging PEC 3A was observed as well.  A kernel
  message like [ 1211.244319] zpci: 061a:00:00.0: Event 0x2 reports an error for PCI function
  0x61a is a reliable indicator of the stated function entering error state with PEC 2. Let
  me also point out that a kernel message like [ 1211.244325] zpci: 061a:00:00.0: The ism driver
  bound to the device does not support error recovery is a reliable indicator that the ISM function
  won''t be auto-recovered because the ISM driver currently lacks support for it.  On a technical
  level, without this synchronization, commands (inputs to the FW) may be partially or fully
  overwritten (corrupted) by another CPU trying to issue commands on the same function. There
  is hard evidence that this can lead to DMB token values being used as DMB IOVAs, leading to
  PEC 2 PCI events indicating invalid DMA. But this is only one of the failure modes imaginable.
  In theory even completely losing one command and executing another one twice and then trying
  to interpret the outputs as if the command we intended to execute was actually executed and
  not the other one is also possible.  Frankly, I don''t feel confident about providing an exhaustive
  list of possible consequences.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.41-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
