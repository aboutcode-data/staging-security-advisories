advisory_id: linux/CVE-2021-47102
datasource_id: debian_importer_v2/linux/CVE-2021-47102
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47102
aliases:
  - CVE-2021-47102
summary: "In the Linux kernel, the following vulnerability has been resolved:  net: marvell:\
  \ prestera: fix incorrect structure access  In line: \tupper = info->upper_dev; We access\
  \ upper_dev field, which is related only for particular events (e.g. event == NETDEV_CHANGEUPPER).\
  \ So, this line cause invalid memory access for another events, when ptr is not netdev_notifier_changeupper_info.\
  \  The KASAN logs are as follows:  [   30.123165] BUG: KASAN: stack-out-of-bounds in prestera_netdev_port_event.constprop.0+0x68/0x538\
  \ [prestera] [   30.133336] Read of size 8 at addr ffff80000cf772b0 by task udevd/778 [  \
  \ 30.139866] [   30.141398] CPU: 0 PID: 778 Comm: udevd Not tainted 5.16.0-rc3 #6 [   30.147588]\
  \ Hardware name: DNI AmazonGo1 A7040 board (DT) [   30.153056] Call trace: [   30.155547]\
  \  dump_backtrace+0x0/0x2c0 [   30.159320]  show_stack+0x18/0x30 [   30.162729]  dump_stack_lvl+0x68/0x84\
  \ [   30.166491]  print_address_description.constprop.0+0x74/0x2b8 [   30.172346]  kasan_report+0x1e8/0x250\
  \ [   30.176102]  __asan_load8+0x98/0xe0 [   30.179682]  prestera_netdev_port_event.constprop.0+0x68/0x538\
  \ [prestera] [   30.186847]  prestera_netdev_event_handler+0x1b4/0x1c0 [prestera] [   30.193313]\
  \  raw_notifier_call_chain+0x74/0xa0 [   30.197860]  call_netdevice_notifiers_info+0x68/0xc0\
  \ [   30.202924]  register_netdevice+0x3cc/0x760 [   30.207190]  register_netdev+0x24/0x50\
  \ [   30.211015]  prestera_device_register+0x8a0/0xba0 [prestera]"
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.15.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
