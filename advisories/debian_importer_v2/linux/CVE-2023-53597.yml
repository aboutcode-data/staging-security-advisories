advisory_id: linux/CVE-2023-53597
datasource_id: debian_importer_v2/linux/CVE-2023-53597
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53597
aliases:
  - CVE-2023-53597
summary: 'In the Linux kernel, the following vulnerability has been resolved:  cifs: fix mid
  leak during reconnection after timeout threshold  When the number of responses with status
  of STATUS_IO_TIMEOUT exceeds a specified threshold (NUM_STATUS_IO_TIMEOUT), we reconnect the
  connection. But we do not return the mid, or the credits returned for the mid, or reduce the
  number of in-flight requests.  This bug could result in the server->in_flight count to go
  bad, and also cause a leak in the mids.  This change moves the check to a few lines below
  where the response is decrypted, even of the response is read from the transform header. This
  way, the code for returning the mids can be reused.  Also, the cifs_reconnect was reconnecting
  just the transport connection before. In case of multi-channel, this may not be what we want
  to do after several timeouts. Changed that to reconnect the session and the tree too.  Also
  renamed NUM_STATUS_IO_TIMEOUT to a more appropriate name MAX_STATUS_IO_TIMEOUT.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.52-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.4.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
