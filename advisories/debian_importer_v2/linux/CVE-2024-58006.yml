advisory_id: linux/CVE-2024-58006
datasource_id: debian_importer_v2/linux/CVE-2024-58006
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-58006
aliases:
  - CVE-2024-58006
summary: 'In the Linux kernel, the following vulnerability has been resolved:  PCI: dwc: ep:
  Prevent changing BAR size/flags in pci_epc_set_bar()  In commit 4284c88fff0e ("PCI: designware-ep:
  Allow pci_epc_set_bar() update inbound map address") set_bar() was modified to support dynamically
  changing the backing physical address of a BAR that was already configured.  This means that
  set_bar() can be called twice, without ever calling clear_bar() (as calling clear_bar() would
  clear the BAR''s PCI address assigned by the host).  This can only be done if the new BAR
  size/flags does not differ from the existing BAR configuration. Add these missing checks.  If
  we allow set_bar() to set e.g. a new BAR size that differs from the existing BAR size, the
  new address translation range will be smaller than the BAR size already determined by the
  host, which would mean that a read past the new BAR size would pass the iATU untranslated,
  which could allow the host to read memory not belonging to the new struct pci_epf_bar.  While
  at it, add comments which clarifies the support for dynamically changing the physical address
  of a BAR. (Which was also missing.)'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
