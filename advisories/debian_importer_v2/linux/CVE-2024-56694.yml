advisory_id: linux/CVE-2024-56694
datasource_id: debian_importer_v2/linux/CVE-2024-56694
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-56694
aliases:
  - CVE-2024-56694
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: fix recursive
  lock when verdict program return SK_PASS  When the stream_verdict program returns SK_PASS,
  it places the received skb into its own receive queue, but a recursive lock eventually occurs,
  leading to an operating system deadlock. This issue has been present since v6.9.  '''''' sk_psock_strp_data_ready     write_lock_bh(&sk->sk_callback_lock)     strp_data_ready       strp_read_sock         read_sock
  -> tcp_read_sock           strp_recv             cb.rcv_msg -> sk_psock_strp_read               #
  now stream_verdict return SK_PASS without peer sock assign               __SK_PASS = sk_psock_map_verd(SK_PASS,
  NULL)               sk_psock_verdict_apply                 sk_psock_skb_ingress_self                   sk_psock_skb_ingress_enqueue                     sk_psock_data_ready                       read_lock_bh(&sk->sk_callback_lock)
  <= dead lock  ''''''  This topic has been discussed before, but it has not been fixed. Previous
  discussion: https://lore.kernel.org/all/6684a5864ec86_403d20898@john.notmuch'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.123-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.234-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
