advisory_id: linux/CVE-2024-50142
datasource_id: debian_importer_v2/linux/CVE-2024-50142
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-50142
aliases:
  - CVE-2024-50142
summary: 'In the Linux kernel, the following vulnerability has been resolved:  xfrm: validate
  new SA''s prefixlen using SA family when sel.family is unset  This expands the validation
  introduced in commit 07bf7908950a ("xfrm: Validate address prefix lengths in the xfrm selector.")  syzbot
  created an SA with     usersa.sel.family = AF_UNSPEC     usersa.sel.prefixlen_s = 128     usersa.family
  = AF_INET  Because of the AF_UNSPEC selector, verify_newsa_info doesn''t put limits on prefixlen_{s,d}.
  But then copy_from_user_state sets x->sel.family to usersa.family (AF_INET). Do the same conversion
  in verify_newsa_info before validating prefixlen_{s,d}, since that''s how prefixlen is going
  to be used later on.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.115-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.234-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
