advisory_id: linux/CVE-2021-47412
datasource_id: debian_importer_v2/linux/CVE-2021-47412
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47412
aliases:
  - CVE-2021-47412
summary: 'In the Linux kernel, the following vulnerability has been resolved:  block: don''t
  call rq_qos_ops->done_bio if the bio isn''t tracked  rq_qos framework is only applied on request
  based driver, so:  1) rq_qos_done_bio() needn''t to be called for bio based driver  2) rq_qos_done_bio()
  needn''t to be called for bio which isn''t tracked, such as bios ended from error handling
  code.  Especially in bio_endio():  1) request queue is referred via bio->bi_bdev->bd_disk->queue,
  which may be gone since request queue refcount may not be held in above two cases  2) q->rq_qos
  may be freed in blk_cleanup_queue() when calling into __rq_qos_done_bio()  Fix the potential
  kernel panic by not calling rq_qos_ops->done_bio if the bio isn''t tracked. This way is safe
  because both ioc_rqos_done_bio() and blkcg_iolatency_done_bio() are nop if the bio isn''t
  tracked.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.14.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
