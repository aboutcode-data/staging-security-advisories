advisory_id: linux/CVE-2025-39927
datasource_id: debian_importer_v2/linux/CVE-2025-39927
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39927
aliases:
  - CVE-2025-39927
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ceph: fix race
  condition validating r_parent before applying state  Add validation to ensure the cached parent
  directory inode matches the directory info in MDS replies. This prevents client-side race
  conditions where concurrent operations (e.g. rename) cause r_parent to become stale between
  request initiation and reply processing, which could lead to applying state changes to incorrect
  directory inodes.  [ idryomov: folded a kerneldoc fixup and a follow-up fix from Alex to   move
  CEPH_CAP_PIN reference when r_parent is updated:    When the parent directory lock is not
  held, req->r_parent can become   stale and is updated to point to the correct inode.  However,
  the   associated CEPH_CAP_PIN reference was not being adjusted.  The   CEPH_CAP_PIN is a reference
  on an inode that is tracked for   accounting purposes.  Moving this pin is important to keep
  the   accounting balanced. When the pin was not moved from the old parent   to the new one,
  it created two problems: The reference on the old,   stale parent was never released, causing
  a reference leak.   A reference for the new parent was never acquired, creating the risk   of
  a reference underflow later in ceph_mdsc_release_request().  This   patch corrects the logic
  by releasing the pin from the old parent and   acquiring it for the new parent when r_parent
  is switched.  This   ensures reference accounting stays balanced. ]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.16.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.48-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
