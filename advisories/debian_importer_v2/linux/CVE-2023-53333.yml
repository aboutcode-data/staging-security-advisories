advisory_id: linux/CVE-2023-53333
datasource_id: debian_importer_v2/linux/CVE-2023-53333
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53333
aliases:
  - CVE-2023-53333
summary: 'In the Linux kernel, the following vulnerability has been resolved:  netfilter: conntrack:
  dccp: copy entire header to stack buffer, not just basic one  Eric Dumazet says:   nf_conntrack_dccp_packet()
  has an unique:    dh = skb_header_pointer(skb, dataoff, sizeof(_dh), &_dh);    And nothing
  more is ''pulled'' from the packet, depending on the content.   dh->dccph_doff, and/or dh->dccph_x
  ...)   So dccp_ack_seq() is happily reading stuff past the _dh buffer.  BUG: KASAN: stack-out-of-bounds
  in nf_conntrack_dccp_packet+0x1134/0x11c0 Read of size 4 at addr ffff000128f66e0c by task
  syz-executor.2/29371 [..]  Fix this by increasing the stack buffer to also include room for
  the extra sequence numbers and all the known dccp packet type headers, then pull again after
  the initial validation of the basic header.  While at it, mark packets invalid that lack 48bit
  sequence bit but where RFC says the type MUST use them.  Compile tested only.  v2: first skb_header_pointer()
  now needs to adjust the size to     only pull the generic header. (Eric)  Heads-up: I intend
  to remove dccp conntrack support later this year.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.52-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.191-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.4.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
