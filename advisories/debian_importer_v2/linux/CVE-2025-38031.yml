advisory_id: linux/CVE-2025-38031
datasource_id: debian_importer_v2/linux/CVE-2025-38031
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38031
aliases:
  - CVE-2025-38031
summary: 'In the Linux kernel, the following vulnerability has been resolved:  padata: do not
  leak refcount in reorder_work  A recent patch that addressed a UAF introduced a reference
  count leak: the parallel_data refcount is incremented unconditionally, regardless of the return
  value of queue_work(). If the work item is already queued, the incremented refcount is never
  decremented.  Fix this by checking the return value of queue_work() and decrementing the refcount
  when necessary.  Resolves:  Unreferenced object 0xffff9d9f421e3d80 (size 192):   comm "cryptomgr_probe",
  pid 157, jiffies 4294694003   hex dump (first 32 bytes):     80 8b cf 41 9f 9d ff ff b8 97
  e0 89 ff ff ff ff  ...A............     d0 97 e0 89 ff ff ff ff 19 00 00 00 1f 88 23 00  ..............#.   backtrace
  (crc 838fb36):     __kmalloc_cache_noprof+0x284/0x320     padata_alloc_pd+0x20/0x1e0     padata_alloc_shell+0x3b/0xa0     0xffffffffc040a54d     cryptomgr_probe+0x43/0xc0     kthread+0xf6/0x1f0     ret_from_fork+0x2f/0x50     ret_from_fork_asm+0x1a/0x30'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.147-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.32-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
