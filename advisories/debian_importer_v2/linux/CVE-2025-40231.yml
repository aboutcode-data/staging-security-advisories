advisory_id: linux/CVE-2025-40231
datasource_id: debian_importer_v2/linux/CVE-2025-40231
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40231
aliases:
  - CVE-2025-40231
summary: 'In the Linux kernel, the following vulnerability has been resolved:  vsock: fix lock
  inversion in vsock_assign_transport()  Syzbot reported a potential lock inversion deadlock
  between vsock_register_mutex and sk_lock-AF_VSOCK when vsock_linger() is called.  The issue
  was introduced by commit 687aa0c5581b ("vsock: Fix transport_* TOCTOU") which added vsock_register_mutex
  locking in vsock_assign_transport() around the transport->release() call, that can call vsock_linger().
  vsock_assign_transport() can be called with sk_lock held. vsock_linger() calls sk_wait_event()
  that temporarily releases and re-acquires sk_lock. During this window, if another thread hold
  vsock_register_mutex while trying to acquire sk_lock, a circular dependency is created.  Fix
  this by releasing vsock_register_mutex before calling transport->release() and vsock_deassign_transport().
  This is safe because we don''t need to hold vsock_register_mutex while releasing the old transport,
  and we ensure the new transport won''t disappear by obtaining a module reference first via
  try_module_get().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.247-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
