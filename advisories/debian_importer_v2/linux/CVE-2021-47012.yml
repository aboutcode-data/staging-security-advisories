advisory_id: linux/CVE-2021-47012
datasource_id: debian_importer_v2/linux/CVE-2021-47012
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47012
aliases:
  - CVE-2021-47012
summary: 'In the Linux kernel, the following vulnerability has been resolved:  RDMA/siw: Fix
  a use after free in siw_alloc_mr  Our code analyzer reported a UAF.  In siw_alloc_mr(), it
  calls siw_mr_add_mem(mr,..). In the implementation of siw_mr_add_mem(), mem is assigned to
  mr->mem and then mem is freed via kfree(mem) if xa_alloc_cyclic() failed. Here, mr->mem still
  point to a freed object. After, the execution continue up to the err_out branch of siw_alloc_mr,
  and the freed mr->mem is used in siw_mr_drop_mem(mr).  My patch moves "mr->mem = mem" behind
  the if (xa_alloc_cyclic(..)<0) {} section, to avoid the uaf.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.38-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
