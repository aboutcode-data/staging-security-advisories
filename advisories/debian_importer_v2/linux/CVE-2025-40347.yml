advisory_id: linux/CVE-2025-40347
datasource_id: debian_importer_v2/linux/CVE-2025-40347
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40347
aliases:
  - CVE-2025-40347
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: enetc: fix
  the deadlock of enetc_mdio_lock  After applying the workaround for err050089, the LS1028A
  platform experiences RCU stalls on RT kernel. This issue is caused by the recursive acquisition
  of the read lock enetc_mdio_lock. Here list some of the call stacks identified under the enetc_poll
  path that may lead to a deadlock:  enetc_poll   -> enetc_lock_mdio   -> enetc_clean_rx_ring
  OR napi_complete_done      -> napi_gro_receive         -> enetc_start_xmit            -> enetc_lock_mdio            ->
  enetc_map_tx_buffs            -> enetc_unlock_mdio   -> enetc_unlock_mdio  After enetc_poll
  acquires the read lock, a higher-priority writer attempts to acquire the lock, causing preemption.
  The writer detects that a read lock is already held and is scheduled out. However, readers
  under enetc_poll cannot acquire the read lock again because a writer is already waiting, leading
  to a thread hang.  Currently, the deadlock is avoided by adjusting enetc_lock_mdio to prevent
  recursive lock acquisition.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
