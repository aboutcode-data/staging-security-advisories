advisory_id: linux/CVE-2023-53221
datasource_id: debian_importer_v2/linux/CVE-2023-53221
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53221
aliases:
  - CVE-2023-53221
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: Fix memleak
  due to fentry attach failure  If it fails to attach fentry, the allocated bpf trampoline image
  will be left in the system. That can be verified by checking /proc/kallsyms.  This meamleak
  can be verified by a simple bpf program as follows:    SEC("fentry/trap_init")   int fentry_run()   {       return
  0;   }  It will fail to attach trap_init because this function is freed after kernel init,
  and then we can find the trampoline image is left in the system by checking /proc/kallsyms.    $
  tail /proc/kallsyms   ffffffffc0613000 t bpf_trampoline_6442453466_1  [bpf]   ffffffffc06c3000
  t bpf_trampoline_6442453466_1  [bpf]    $ bpftool btf dump file /sys/kernel/btf/vmlinux |
  grep "FUNC ''trap_init''"   [2522] FUNC ''trap_init'' type_id=119 linkage=static    $ echo
  $((6442453466 & 0x7fffffff))   2522  Note that there are two left bpf trampoline images, that
  is because the libbpf will fallback to raw tracepoint if -EINVAL is returned.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.52-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.4.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
