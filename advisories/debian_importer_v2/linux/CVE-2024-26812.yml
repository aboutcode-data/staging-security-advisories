advisory_id: linux/CVE-2024-26812
datasource_id: debian_importer_v2/linux/CVE-2024-26812
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-26812
aliases:
  - CVE-2024-26812
summary: 'In the Linux kernel, the following vulnerability has been resolved:  vfio/pci: Create
  persistent INTx handler  A vulnerability exists where the eventfd for INTx signaling can be
  deconfigured, which unregisters the IRQ handler but still allows eventfds to be signaled with
  a NULL context through the SET_IRQS ioctl or through unmask irqfd if the device interrupt
  is pending.  Ideally this could be solved with some additional locking; the igate mutex serializes
  the ioctl and config space accesses, and the interrupt handler is unregistered relative to
  the trigger, but the irqfd path runs asynchronous to those.  The igate mutex cannot be acquired
  from the atomic context of the eventfd wake function.  Disabling the irqfd relative to the
  eventfd registration is potentially incompatible with existing userspace.  As a result, the
  solution implemented here moves configuration of the INTx interrupt handler to track the lifetime
  of the INTx context object and irq_type configuration, rather than registration of a particular
  trigger eventfd.  Synchronization is added between the ioctl path and eventfd_signal() wrapper
  such that the eventfd trigger can be dynamically updated relative to in-flight interrupts
  or irqfd callbacks.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.85-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
