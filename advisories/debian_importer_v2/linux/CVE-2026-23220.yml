advisory_id: linux/CVE-2026-23220
datasource_id: debian_importer_v2/linux/CVE-2026-23220
datasource_url: https://security-tracker.debian.org/tracker/CVE-2026-23220
aliases:
  - CVE-2026-23220
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ksmbd: fix infinite
  loop caused by next_smb2_rcv_hdr_off reset in error paths  The problem occurs when a signed
  request fails smb2 signature verification check. In __process_request(), if check_sign_req()
  returns an error, set_smb2_rsp_status(work, STATUS_ACCESS_DENIED) is called. set_smb2_rsp_status()
  set work->next_smb2_rcv_hdr_off as zero. By resetting next_smb2_rcv_hdr_off to zero, the pointer
  to the next command in the chain is lost. Consequently, is_chained_smb2_message() continues
  to point to the same request header instead of advancing. If the header''s NextCommand field
  is non-zero, the function returns true, causing __handle_ksmbd_work() to repeatedly process
  the same failed request in an infinite loop. This results in the kernel log being flooded
  with "bad smb2 signature" messages and high CPU usage.  This patch fixes the issue by changing
  the return value from SERVER_HANDLER_CONTINUE to SERVER_HANDLER_ABORT. This ensures that the
  processing loop terminates immediately rather than attempting to continue from an invalidated
  offset.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.73-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
