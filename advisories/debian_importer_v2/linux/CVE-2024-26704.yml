advisory_id: linux/CVE-2024-26704
datasource_id: debian_importer_v2/linux/CVE-2024-26704
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-26704
aliases:
  - CVE-2024-26704
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ext4: fix double-free
  of blocks due to wrong extents moved_len  In ext4_move_extents(), moved_len is only updated
  when all moves are successfully executed, and only discards orig_inode and donor_inode preallocations
  when moved_len is not zero. When the loop fails to exit after successfully moving some extents,
  moved_len is not updated and remains at 0, so it does not discard the preallocations.  If
  the moved extents overlap with the preallocated extents, the overlapped extents are freed
  twice in ext4_mb_release_inode_pa() and ext4_process_freed_data() (as described in commit
  94d7c16cbbbd ("ext4: Fix double-free of blocks with EXT4_IOC_MOVE_EXT")), and bb_free is incremented
  twice. Hence when trim is executed, a zero-division bug is triggered in mb_update_avg_fragment_size()
  because bb_free is not zero and bb_fragments is zero.  Therefore, update move_len after each
  extent move to avoid the issue.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.82-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
