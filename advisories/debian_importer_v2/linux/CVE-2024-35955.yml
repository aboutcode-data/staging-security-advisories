advisory_id: linux/CVE-2024-35955
datasource_id: debian_importer_v2/linux/CVE-2024-35955
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-35955
aliases:
  - CVE-2024-35955
summary: 'In the Linux kernel, the following vulnerability has been resolved:  kprobes: Fix
  possible use-after-free issue on kprobe registration  When unloading a module, its state is
  changing MODULE_STATE_LIVE ->  MODULE_STATE_GOING -> MODULE_STATE_UNFORMED. Each change will
  take a time. `is_module_text_address()` and `__module_text_address()` works with MODULE_STATE_LIVE
  and MODULE_STATE_GOING. If we use `is_module_text_address()` and `__module_text_address()`
  separately, there is a chance that the first one is succeeded but the next one is failed because
  module->state becomes MODULE_STATE_UNFORMED between those operations.  In `check_kprobe_address_safe()`,
  if the second `__module_text_address()` is failed, that is ignored because it expected a kernel_text
  address. But it may have failed simply because module->state has been changed to MODULE_STATE_UNFORMED.
  In this case, arm_kprobe() will try to modify non-exist module text address (use-after-free).  To
  fix this problem, we should not use separated `is_module_text_address()` and `__module_text_address()`,
  but use only `__module_text_address()` once and do `try_module_get(module)` which is only
  available with MODULE_STATE_LIVE.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.90-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.8.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
