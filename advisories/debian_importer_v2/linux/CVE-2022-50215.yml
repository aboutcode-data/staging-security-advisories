advisory_id: linux/CVE-2022-50215
datasource_id: debian_importer_v2/linux/CVE-2022-50215
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50215
aliases:
  - CVE-2022-50215
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: sg: Allow
  waiting for commands to complete on removed device  When a SCSI device is removed while in
  active use, currently sg will immediately return -ENODEV on any attempt to wait for active
  commands that were sent before the removal.  This is problematic for commands that use SG_FLAG_DIRECT_IO
  since the data buffer may still be in use by the kernel when userspace frees or reuses it
  after getting ENODEV, leading to corrupted userspace memory (in the case of READ-type commands)
  or corrupted data being sent to the device (in the case of WRITE-type commands).  This has
  been seen in practice when logging out of a iscsi_tcp session, where the iSCSI driver may
  still be processing commands after the device has been marked for removal.  Change the policy
  to allow userspace to wait for active sg commands even when the device is being removed.  Return
  -ENODEV only when there are no more responses to read.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.140-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
