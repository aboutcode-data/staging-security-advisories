advisory_id: linux/CVE-2022-50616
datasource_id: debian_importer_v2/linux/CVE-2022-50616
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50616
aliases:
  - CVE-2022-50616
summary: "In the Linux kernel, the following vulnerability has been resolved:  regulator: core:\
  \ Use different devices for resource allocation and DT lookup  Following by the below discussion,\
  \ there's the potential UAF issue between regulator and mfd. https://lore.kernel.org/all/20221128143601.1698148-1-yangyingliang@huawei.com/\
  \  From the analysis of Yingliang  CPU A\t\t\t\t|CPU B mt6370_probe()\t\t\t|   devm_mfd_add_devices()\t\
  | \t\t\t\t|mt6370_regulator_probe() \t\t\t\t|  regulator_register() \t\t\t\t|    //allocate\
  \ init_data and add it to devres \t\t\t\t|    regulator_of_get_init_data() i2c_unregister_device()\t\
  \t|   device_del()\t\t\t|     devres_release_all()\t|       // init_data is freed\t|     \
  \  release_nodes()\t\t| \t\t\t\t|  // using init_data causes UAF \t\t\t\t|  regulator_register()\
  \  It's common to use mfd core to create child device for the regulator. In order to do the\
  \ DT lookup for init data, the child that registered the regulator would pass its parent as\
  \ the parameter. And this causes init data resource allocated to its parent, not itself. The\
  \ issue happen when parent device is going to release and regulator core is still doing some\
  \ operation of init data constraint for the regulator of child device.  To fix it, this patch\
  \ expand 'regulator_register' API to use the different devices for init data allocation and\
  \ DT lookup."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
