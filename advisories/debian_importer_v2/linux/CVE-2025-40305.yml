advisory_id: linux/CVE-2025-40305
datasource_id: debian_importer_v2/linux/CVE-2025-40305
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40305
aliases:
  - CVE-2025-40305
summary: 'In the Linux kernel, the following vulnerability has been resolved:  9p/trans_fd:
  p9_fd_request: kick rx thread if EPOLLIN  p9_read_work() doesn''t set Rworksched and doesn''t
  do schedule_work(m->rq) if list_empty(&m->req_list).  However, if the pipe is full, we need
  to read more data and this used to work prior to commit aaec5a95d59615 ("pipe_read: don''t
  wake up the writer if the pipe is still full").  p9_read_work() does p9_fd_read() -> ... ->
  anon_pipe_read() which (before the commit above) triggered the unnecessary wakeup. This wakeup
  calls p9_pollwake() which kicks p9_poll_workfn() -> p9_poll_mux(), p9_poll_mux() will notice
  EPOLLIN and schedule_work(&m->rq).  This no longer happens after the optimization above, change
  p9_fd_request() to use p9_poll_mux() instead of only checking for EPOLLOUT.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
