advisory_id: linux/CVE-2025-71096
datasource_id: debian_importer_v2/linux/CVE-2025-71096
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71096
aliases:
  - CVE-2025-71096
summary: 'In the Linux kernel, the following vulnerability has been resolved:  RDMA/core: Check
  for the presence of LS_NLA_TYPE_DGID correctly  The netlink response for RDMA_NL_LS_OP_IP_RESOLVE
  should always have a LS_NLA_TYPE_DGID attribute, it is invalid if it does not.  Use the nl
  parsing logic properly and call nla_parse_deprecated() to fill the nlattrs array and then
  directly index that array to get the data for the DGID. Just fail if it is NULL.  Remove the
  for loop searching for the nla, and squash the validation and parsing into one function.  Fixes
  an uninitialized read from the stack triggered by userspace if it does not provide the DGID
  to a kernel initiated RDMA_NL_LS_OP_IP_RESOLVE query.      BUG: KMSAN: uninit-value in hex_byte_pack
  include/linux/hex.h:13 [inline]     BUG: KMSAN: uninit-value in ip6_string+0xef4/0x13a0 lib/vsprintf.c:1490      hex_byte_pack
  include/linux/hex.h:13 [inline]      ip6_string+0xef4/0x13a0 lib/vsprintf.c:1490      ip6_addr_string+0x18a/0x3e0
  lib/vsprintf.c:1509      ip_addr_string+0x245/0xee0 lib/vsprintf.c:1633      pointer+0xc09/0x1bd0
  lib/vsprintf.c:2542      vsnprintf+0xf8a/0x1bd0 lib/vsprintf.c:2930      vprintk_store+0x3ae/0x1530
  kernel/printk/printk.c:2279      vprintk_emit+0x307/0xcd0 kernel/printk/printk.c:2426      vprintk_default+0x3f/0x50
  kernel/printk/printk.c:2465      vprintk+0x36/0x50 kernel/printk/printk_safe.c:82      _printk+0x17e/0x1b0
  kernel/printk/printk.c:2475      ib_nl_process_good_ip_rsep drivers/infiniband/core/addr.c:128
  [inline]      ib_nl_handle_ip_res_resp+0x963/0x9d0 drivers/infiniband/core/addr.c:141      rdma_nl_rcv_msg
  drivers/infiniband/core/netlink.c:-1 [inline]      rdma_nl_rcv_skb drivers/infiniband/core/netlink.c:239
  [inline]      rdma_nl_rcv+0xefa/0x11c0 drivers/infiniband/core/netlink.c:259      netlink_unicast_kernel
  net/netlink/af_netlink.c:1320 [inline]      netlink_unicast+0xf04/0x12b0 net/netlink/af_netlink.c:1346      netlink_sendmsg+0x10b3/0x1250
  net/netlink/af_netlink.c:1896      sock_sendmsg_nosec net/socket.c:714 [inline]      __sock_sendmsg+0x333/0x3d0
  net/socket.c:729      ____sys_sendmsg+0x7e0/0xd80 net/socket.c:2617      ___sys_sendmsg+0x271/0x3b0
  net/socket.c:2671      __sys_sendmsg+0x1aa/0x300 net/socket.c:2703      __compat_sys_sendmsg
  net/compat.c:346 [inline]      __do_compat_sys_sendmsg net/compat.c:353 [inline]      __se_compat_sys_sendmsg
  net/compat.c:350 [inline]      __ia32_compat_sys_sendmsg+0xa4/0x100 net/compat.c:350      ia32_sys_call+0x3f6c/0x4310
  arch/x86/include/generated/asm/syscalls_32.h:371      do_syscall_32_irqs_on arch/x86/entry/syscall_32.c:83
  [inline]      __do_fast_syscall_32+0xb0/0x150 arch/x86/entry/syscall_32.c:306      do_fast_syscall_32+0x38/0x80
  arch/x86/entry/syscall_32.c:331      do_SYSENTER_32+0x1f/0x30 arch/x86/entry/syscall_32.c:3'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.162-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.249-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
