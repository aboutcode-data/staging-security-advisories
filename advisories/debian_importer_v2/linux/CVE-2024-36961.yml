advisory_id: linux/CVE-2024-36961
datasource_id: debian_importer_v2/linux/CVE-2024-36961
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-36961
aliases:
  - CVE-2024-36961
summary: 'In the Linux kernel, the following vulnerability has been resolved:  thermal/debugfs:
  Fix two locking issues with thermal zone debug  With the current thermal zone locking arrangement
  in the debugfs code, user space can open the "mitigations" file for a thermal zone before
  the zone''s debugfs pointer is set which will result in a NULL pointer dereference in tze_seq_start().  Moreover,
  thermal_debug_tz_remove() is not called under the thermal zone lock, so it can run in parallel
  with the other functions accessing the thermal zone''s struct thermal_debugfs object.  Then,
  it may clear tz->debugfs after one of those functions has checked it and the struct thermal_debugfs
  object may be freed prematurely.  To address the first problem, pass a pointer to the thermal
  zone''s struct thermal_debugfs object to debugfs_create_file() in thermal_debug_tz_add() and
  make tze_seq_start(), tze_seq_next(), tze_seq_stop(), and tze_seq_show() retrieve it from
  s->private instead of a pointer to the thermal zone object.  This will ensure that tz_debugfs
  will be valid across the "mitigations" file accesses until thermal_debugfs_remove_id() called
  by thermal_debug_tz_remove() removes that file.  To address the second problem, use tz->lock
  in thermal_debug_tz_remove() around the tz->debugfs value check (in case the same thermal
  zone is removed at the same time in two different threads) and its reset to NULL.  Cc :6.8+
  <stable@vger.kernel.org> # 6.8+'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.8.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
