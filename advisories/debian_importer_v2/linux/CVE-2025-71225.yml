advisory_id: linux/CVE-2025-71225
datasource_id: debian_importer_v2/linux/CVE-2025-71225
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71225
aliases:
  - CVE-2025-71225
summary: 'In the Linux kernel, the following vulnerability has been resolved:  md: suspend array
  while updating raid_disks via sysfs  In raid1_reshape(), freeze_array() is called before modifying
  the r1bio memory pool (conf->r1bio_pool) and conf->raid_disks, and unfreeze_array() is called
  after the update is completed.  However, freeze_array() only waits until nr_sync_pending and
  (nr_pending - nr_queued) of all buckets reaches zero. When an I/O error occurs, nr_queued
  is increased and the corresponding r1bio is queued to either retry_list or bio_end_io_list.
  As a result, freeze_array() may unblock before these r1bios are released.  This can lead to
  a situation where conf->raid_disks and the mempool have already been updated while queued
  r1bios, allocated with the old raid_disks value, are later released. Consequently, free_r1bio()
  may access memory out of bounds in put_all_bios() and release r1bios of the wrong size to
  the new mempool, potentially causing issues with the mempool as well.  Since only normal I/O
  might increase nr_queued while an I/O error occurs, suspending the array avoids this issue.  Note:
  Updating raid_disks via ioctl SET_ARRAY_INFO already suspends the array. Therefore, we suspend
  the array when updating raid_disks via sysfs to avoid this issue too.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.73-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
