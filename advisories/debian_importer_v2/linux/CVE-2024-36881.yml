advisory_id: linux/CVE-2024-36881
datasource_id: debian_importer_v2/linux/CVE-2024-36881
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-36881
aliases:
  - CVE-2024-36881
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/userfaultfd:
  reset ptes when close() for wr-protected ones  Userfaultfd unregister includes a step to remove
  wr-protect bits from all the relevant pgtable entries, but that only covered an explicit UFFDIO_UNREGISTER
  ioctl, not a close() on the userfaultfd itself.  Cover that too.  This fixes a WARN trace.  The
  only user visible side effect is the user can observe leftover wr-protect bits even if the
  user close()ed on an userfaultfd when releasing the last reference of it.  However hopefully
  that should be harmless, and nothing bad should happen even if so.  This change is now more
  important after the recent page-table-check patch we merged in mm-unstable (446dd9ad37d0 ("mm/page_table_check:
  support userfault wr-protect entries")), as we''ll do sanity check on uffd-wp bits without
  vma context.  So it''s better if we can 100% guarantee no uffd-wp bit leftovers, to make sure
  each report will be valid.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.8.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
