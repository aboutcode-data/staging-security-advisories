advisory_id: linux/CVE-2022-48801
datasource_id: debian_importer_v2/linux/CVE-2022-48801
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-48801
aliases:
  - CVE-2022-48801
summary: 'In the Linux kernel, the following vulnerability has been resolved:  iio: buffer:
  Fix file related error handling in IIO_BUFFER_GET_FD_IOCTL  If we fail to copy the just created
  file descriptor to userland, we try to clean up by putting back ''fd'' and freeing ''ib''.
  The code uses put_unused_fd() for the former which is wrong, as the file descriptor was already
  published by fd_install() which gets called internally by anon_inode_getfd().  This makes
  the error handling code leaving a half cleaned up file descriptor table around and a partially
  destructed ''file'' object, allowing userland to play use-after-free tricks on us, by abusing
  the still usable fd and making the code operate on a dangling ''file->private_data'' pointer.  Instead
  of leaving the kernel in a partially corrupted state, don''t attempt to explicitly clean up
  and leave this to the process exit path that''ll release any still valid fds, including the
  one created by the previous call to anon_inode_getfd(). Simply return -EFAULT to indicate
  the error.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.16.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
