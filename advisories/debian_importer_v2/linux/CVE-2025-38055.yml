advisory_id: linux/CVE-2025-38055
datasource_id: debian_importer_v2/linux/CVE-2025-38055
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38055
aliases:
  - CVE-2025-38055
summary: 'In the Linux kernel, the following vulnerability has been resolved:  perf/x86/intel:
  Fix segfault with PEBS-via-PT with sample_freq  Currently, using PEBS-via-PT with a sample
  frequency instead of a sample period, causes a segfault.  For example:      BUG: kernel NULL
  pointer dereference, address: 0000000000000195     <NMI>     ? __die_body.cold+0x19/0x27     ?
  page_fault_oops+0xca/0x290     ? exc_page_fault+0x7e/0x1b0     ? asm_exc_page_fault+0x26/0x30     ?
  intel_pmu_pebs_event_update_no_drain+0x40/0x60     ? intel_pmu_pebs_event_update_no_drain+0x32/0x60     intel_pmu_drain_pebs_icl+0x333/0x350     handle_pmi_common+0x272/0x3c0     intel_pmu_handle_irq+0x10a/0x2e0     perf_event_nmi_handler+0x2a/0x50  That
  happens because intel_pmu_pebs_event_update_no_drain() assumes all the pebs_enabled bits represent
  counter indexes, which is not always the case. In this particular case, bits 60 and 61 are
  set for PEBS-via-PT purposes.  The behaviour of PEBS-via-PT with sample frequency is questionable
  because although a PMI is generated (PEBS_PMI_AFTER_EACH_RECORD), the period is not adjusted
  anyway.  Putting that aside, fix intel_pmu_pebs_event_update_no_drain() by passing the mask
  of counter bits instead of ''size''.  Note, prior to the Fixes commit, ''size'' would be limited
  to the maximum counter index, so the issue was not hit.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.32-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
