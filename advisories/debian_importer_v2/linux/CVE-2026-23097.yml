advisory_id: linux/CVE-2026-23097
datasource_id: debian_importer_v2/linux/CVE-2026-23097
datasource_url: https://security-tracker.debian.org/tracker/CVE-2026-23097
aliases:
  - CVE-2026-23097
summary: 'In the Linux kernel, the following vulnerability has been resolved:  migrate: correct
  lock ordering for hugetlb file folios  Syzbot has found a deadlock (analyzed by Lance Yang):  1)
  Task (5749): Holds folio_lock, then tries to acquire i_mmap_rwsem(read lock). 2) Task (5754):
  Holds i_mmap_rwsem(write lock), then tries to acquire folio_lock.  migrate_pages()   -> migrate_hugetlbs()     ->
  unmap_and_move_huge_page()     <- Takes folio_lock!       -> remove_migration_ptes()         ->
  __rmap_walk_file()           -> i_mmap_lock_read()       <- Waits for i_mmap_rwsem(read lock)!  hugetlbfs_fallocate()   ->
  hugetlbfs_punch_hole()           <- Takes i_mmap_rwsem(write lock)!     -> hugetlbfs_zero_partial_page()      ->
  filemap_lock_hugetlb_folio()       -> filemap_lock_folio()         -> __filemap_get_folio        <-
  Waits for folio_lock!  The migration path is the one taking locks in the wrong order according
  to the documentation at the top of mm/rmap.c.  So expand the scope of the existing i_mmap_lock
  to cover the calls to remove_migration_ptes() too.  This is (mostly) how it used to be after
  commit c0d0381ade79.  That was removed by 336bf30eb765 for both file & anon hugetlb pages
  when it should only have been removed for anon hugetlb pages.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.162-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.249-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
