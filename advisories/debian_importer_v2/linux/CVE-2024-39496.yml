advisory_id: linux/CVE-2024-39496
datasource_id: debian_importer_v2/linux/CVE-2024-39496
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-39496
aliases:
  - CVE-2024-39496
summary: 'In the Linux kernel, the following vulnerability has been resolved:  btrfs: zoned:
  fix use-after-free due to race with dev replace  While loading a zone''s info during creation
  of a block group, we can race with a device replace operation and then trigger a use-after-free
  on the device that was just replaced (source device of the replace operation).  This happens
  because at btrfs_load_zone_info() we extract a device from the chunk map into a local variable
  and then use the device while not under the protection of the device replace rwsem. So if
  there''s a device replace operation happening when we extract the device and that device is
  the source of the replace operation, we will trigger a use-after-free if before we finish
  using the device the replace operation finishes and frees the device.  Fix this by enlarging
  the critical section under the protection of the device replace rwsem so that all uses of
  the device are done inside the critical section.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.99-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
