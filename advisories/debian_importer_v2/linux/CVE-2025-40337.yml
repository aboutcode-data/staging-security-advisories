advisory_id: linux/CVE-2025-40337
datasource_id: debian_importer_v2/linux/CVE-2025-40337
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40337
aliases:
  - CVE-2025-40337
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: stmmac:
  Correctly handle Rx checksum offload errors  The stmmac_rx function would previously set skb->ip_summed
  to CHECKSUM_UNNECESSARY if hardware checksum offload (CoE) was enabled and the packet was
  of a known IP ethertype.  However, this logic failed to check if the hardware had actually
  reported a checksum error. The hardware status, indicating a header or payload checksum failure,
  was being ignored at this stage. This could cause corrupt packets to be passed up the network
  stack as valid.  This patch corrects the logic by checking the `csum_none` status flag, which
  is set when the hardware reports a checksum error. If this flag is set, skb->ip_summed is
  now correctly set to CHECKSUM_NONE, ensuring the kernel''s network stack will perform its
  own validation and properly handle the corrupt packet.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.17.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
