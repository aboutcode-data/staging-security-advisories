advisory_id: linux/CVE-2025-71181
datasource_id: debian_importer_v2/linux/CVE-2025-71181
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71181
aliases:
  - CVE-2025-71181
summary: "In the Linux kernel, the following vulnerability has been resolved:  rust_binder:\
  \ remove spin_lock() in rust_shrink_free_page()  When forward-porting Rust Binder to 6.18,\
  \ I neglected to take commit fb56fdf8b9a2 (\"mm/list_lru: split the lock to per-cgroup scope\"\
  ) into account, and apparently I did not end up running the shrinker callback when I sanity\
  \ tested the driver before submission. This leads to crashes like the following:  \t============================================\
  \ \tWARNING: possible recursive locking detected \t6.18.0-mainline-maybe-dirty #1 Tainted:\
  \ G          IO \t-------------------------------------------- \tkswapd0/68 is trying to acquire\
  \ lock: \tffff956000fa18b0 (&l->lock){+.+.}-{2:2}, at: lock_list_lru_of_memcg+0x128/0x230\
  \  \tbut task is already holding lock: \tffff956000fa18b0 (&l->lock){+.+.}-{2:2}, at: rust_helper_spin_lock+0xd/0x20\
  \  \tother info that might help us debug this: \t Possible unsafe locking scenario:  \t  \
  \     CPU0 \t       ---- \t  lock(&l->lock); \t  lock(&l->lock);  \t *** DEADLOCK ***  \t\
  \ May be due to missing lock nesting notation  \t3 locks held by kswapd0/68: \t #0: ffffffff90d2e260\
  \ (fs_reclaim){+.+.}-{0:0}, at: kswapd+0x597/0x1160 \t #1: ffff956000fa18b0 (&l->lock){+.+.}-{2:2},\
  \ at: rust_helper_spin_lock+0xd/0x20 \t #2: ffffffff90cf3680 (rcu_read_lock){....}-{1:2},\
  \ at: lock_list_lru_of_memcg+0x2d/0x230  To fix this, remove the spin_lock() call from rust_shrink_free_page()."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
