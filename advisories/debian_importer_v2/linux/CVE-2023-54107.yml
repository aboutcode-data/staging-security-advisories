advisory_id: linux/CVE-2023-54107
datasource_id: debian_importer_v2/linux/CVE-2023-54107
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54107
aliases:
  - CVE-2023-54107
summary: 'In the Linux kernel, the following vulnerability has been resolved:  blk-cgroup: dropping
  parent refcount after pd_free_fn() is done  Some cgroup policies will access parent pd through
  child pd even after pd_offline_fn() is done. If pd_free_fn() for parent is called before child,
  then UAF can be triggered. Hence it''s better to guarantee the order of pd_free_fn().  Currently
  refcount of parent blkg is dropped in __blkg_release(), which is before pd_free_fn() is called
  in blkg_free_work_fn() while blkg_free_work_fn() is called asynchronously.  This patch make
  sure pd_free_fn() called from removing cgroup is ordered by delaying dropping parent refcount
  after calling pd_free_fn() for child.  BTW, pd_free_fn() will also be called from blkcg_deactivate_policy()
  from deleting device, and following patches will guarantee the order.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.3.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
