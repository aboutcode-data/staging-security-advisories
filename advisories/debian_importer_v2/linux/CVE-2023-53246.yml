advisory_id: linux/CVE-2023-53246
datasource_id: debian_importer_v2/linux/CVE-2023-53246
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53246
aliases:
  - CVE-2023-53246
summary: 'In the Linux kernel, the following vulnerability has been resolved:  cifs: fix DFS
  traversal oops without CONFIG_CIFS_DFS_UPCALL  When compiled with CONFIG_CIFS_DFS_UPCALL disabled,
  cifs_dfs_d_automount is NULL. cifs.ko logic for mapping CIFS_FATTR_DFS_REFERRAL attributes
  to S_AUTOMOUNT and corresponding dentry flags is retained regardless of CONFIG_CIFS_DFS_UPCALL,
  leading to a NULL pointer dereference in VFS follow_automount() when traversing a DFS referral
  link:   BUG: kernel NULL pointer dereference, address: 0000000000000000   ...   Call Trace:    <TASK>    __traverse_mounts+0xb5/0x220    ?
  cifs_revalidate_mapping+0x65/0xc0 [cifs]    step_into+0x195/0x610    ? lookup_fast+0xe2/0xf0    path_lookupat+0x64/0x140    filename_lookup+0xc2/0x140    ?
  __create_object+0x299/0x380    ? kmem_cache_alloc+0x119/0x220    ? user_path_at_empty+0x31/0x50    user_path_at_empty+0x31/0x50    __x64_sys_chdir+0x2a/0xd0    ?
  exit_to_user_mode_prepare+0xca/0x100    do_syscall_64+0x42/0x90    entry_SYSCALL_64_after_hwframe+0x72/0xdc  This
  fix adds an inline cifs_dfs_d_automount() {return -EREMOTE} handler when CONFIG_CIFS_DFS_UPCALL
  is disabled. An alternative would be to avoid flagging S_AUTOMOUNT, etc. without CONFIG_CIFS_DFS_UPCALL.
  This approach was chosen as it provides more control over the error path.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.25-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
