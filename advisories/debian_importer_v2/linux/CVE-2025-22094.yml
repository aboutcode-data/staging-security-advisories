advisory_id: linux/CVE-2025-22094
datasource_id: debian_importer_v2/linux/CVE-2025-22094
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-22094
aliases:
  - CVE-2025-22094
summary: 'In the Linux kernel, the following vulnerability has been resolved:  powerpc/perf:
  Fix ref-counting on the PMU ''vpa_pmu''  Commit 176cda0619b6 ("powerpc/perf: Add perf interface
  to expose vpa counters") introduced ''vpa_pmu'' to expose Book3s-HV nested APIv2 provided
  L1<->L2 context switch latency counters to L1 user-space via perf-events. However the newly
  introduced PMU named ''vpa_pmu'' doesn''t assign ownership of the PMU to the module ''vpa_pmu''.
  Consequently the module ''vpa_pmu'' can be unloaded while one of the perf-events are still
  active, which can lead to kernel oops and panic of the form below on a Pseries-LPAR:  BUG:
  Kernel NULL pointer dereference on read at 0x00000058 <snip>  NIP [c000000000506cb8] event_sched_out+0x40/0x258  LR
  [c00000000050e8a4] __perf_remove_from_context+0x7c/0x2b0  Call Trace:  [c00000025fc3fc30]
  [c00000025f8457a8] 0xc00000025f8457a8 (unreliable)  [c00000025fc3fc80] [fffffffffffffee0]
  0xfffffffffffffee0  [c00000025fc3fcd0] [c000000000501e70] event_function+0xa8/0x120 <snip>  Kernel
  panic - not syncing: Aiee, killing interrupt handler!  Fix this by adding the module ownership
  to ''vpa_pmu'' so that the module ''vpa_pmu'' is ref-counted and prevented from being unloaded
  when perf-events are initialized.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
