advisory_id: linux/CVE-2022-50675
datasource_id: debian_importer_v2/linux/CVE-2022-50675
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50675
aliases:
  - CVE-2022-50675
summary: 'In the Linux kernel, the following vulnerability has been resolved:  arm64: mte: Avoid
  setting PG_mte_tagged if no tags cleared or restored  Prior to commit 69e3b846d8a7 ("arm64:
  mte: Sync tags for pages where PTE is untagged"), mte_sync_tags() was only called for pte_tagged()
  entries (those mapped with PROT_MTE). Therefore mte_sync_tags() could safely use test_and_set_bit(PG_mte_tagged,
  &page->flags) without inadvertently setting PG_mte_tagged on an untagged page.  The above
  commit was required as guests may enable MTE without any control at the stage 2 mapping, nor
  a PROT_MTE mapping in the VMM. However, the side-effect was that any page with a PTE that
  looked like swap (or migration) was getting PG_mte_tagged set automatically. A subsequent
  page copy (e.g. migration) copied the tags to the destination page even if the tags were owned
  by KASAN.  This issue was masked by the page_kasan_tag_reset() call introduced in commit e5b8d9218951
  ("arm64: mte: reset the page tag in page->flags"). When this commit was reverted (20794545c146),
  KASAN started reporting access faults because the overriding tags in a page did not match
  the original page->flags (with CONFIG_KASAN_HW_TAGS=y):    BUG: KASAN: invalid-access in copy_page+0x10/0xd0
  arch/arm64/lib/copy_page.S:26   Read at addr f5ff000017f2e000 by task syz-executor.1/2218   Pointer
  tag: [f5], memory tag: [f2]  Move the PG_mte_tagged bit setting from mte_sync_tags() to the
  actual place where tags are cleared (mte_sync_page_tags()) or restored (mte_restore_tags()).'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
