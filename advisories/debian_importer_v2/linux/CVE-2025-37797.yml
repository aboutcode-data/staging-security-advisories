advisory_id: linux/CVE-2025-37797
datasource_id: debian_importer_v2/linux/CVE-2025-37797
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-37797
aliases:
  - CVE-2025-37797
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net_sched: hfsc:
  Fix a UAF vulnerability in class handling  This patch fixes a Use-After-Free vulnerability
  in the HFSC qdisc class handling. The issue occurs due to a time-of-check/time-of-use condition
  in hfsc_change_class() when working with certain child qdiscs like netem or codel.  The vulnerability
  works as follows: 1. hfsc_change_class() checks if a class has packets (q.qlen != 0) 2. It
  then calls qdisc_peek_len(), which for certain qdiscs (e.g.,    codel, netem) might drop packets
  and empty the queue 3. The code continues assuming the queue is still non-empty, adding    the
  class to vttree 4. This breaks HFSC scheduler assumptions that only non-empty classes    are
  in vttree 5. Later, when the class is destroyed, this can lead to a Use-After-Free  The fix
  adds a second queue length check after qdisc_peek_len() to verify the queue wasn''t emptied.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.137-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.237-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.27-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
