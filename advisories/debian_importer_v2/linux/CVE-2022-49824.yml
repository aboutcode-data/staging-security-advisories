advisory_id: linux/CVE-2022-49824
datasource_id: debian_importer_v2/linux/CVE-2022-49824
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49824
aliases:
  - CVE-2022-49824
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ata: libata-transport:
  fix error handling in ata_tlink_add()  In ata_tlink_add(), the return value of transport_add_device()
  is not checked. As a result, it causes null-ptr-deref while removing the module, because transport_remove_device()
  is called to remove the device that was not added.  Unable to handle kernel NULL pointer dereference
  at virtual address 00000000000000d0 CPU: 33 PID: 13850 Comm: rmmod Kdump: loaded Tainted:
  G        W          6.1.0-rc3+ #12 pstate: 60400009 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)
  pc : device_del+0x48/0x39c lr : device_del+0x44/0x39c Call trace:  device_del+0x48/0x39c  attribute_container_class_device_del+0x28/0x40  transport_remove_classdev+0x60/0x7c  attribute_container_device_trigger+0x118/0x120  transport_remove_device+0x20/0x30  ata_tlink_delete+0x88/0xb0
  [libata]  ata_tport_delete+0x2c/0x60 [libata]  ata_port_detach+0x148/0x1b0 [libata]  ata_pci_remove_one+0x50/0x80
  [libata]  ahci_remove_one+0x4c/0x8c [ahci]  Fix this by checking and handling return value
  of transport_add_device() in ata_tlink_add().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
