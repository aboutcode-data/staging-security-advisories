advisory_id: linux/CVE-2021-47227
datasource_id: debian_importer_v2/linux/CVE-2021-47227
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47227
aliases:
  - CVE-2021-47227
summary: 'In the Linux kernel, the following vulnerability has been resolved:  x86/fpu: Prevent
  state corruption in __fpu__restore_sig()  The non-compacted slowpath uses __copy_from_user()
  and copies the entire user buffer into the kernel buffer, verbatim.  This means that the kernel
  buffer may now contain entirely invalid state on which XRSTOR will #GP. validate_user_xstate_header()
  can detect some of that corruption, but that leaves the onus on callers to clear the buffer.  Prior
  to XSAVES support, it was possible just to reinitialize the buffer, completely, but with supervisor
  states that is not longer possible as the buffer clearing code split got it backwards. Fixing
  that is possible but not corrupting the state in the first place is more robust.  Avoid corruption
  of the kernel XSAVE buffer by using copy_user_to_xstate() which validates the XSAVE header
  contents before copying the actual states to the kernel. copy_user_to_xstate() was previously
  only called for compacted-format kernel buffers, but it works for both compacted and non-compacted
  forms.  Using it for the non-compacted form is slower because of multiple __copy_from_user()
  operations, but that cost is less important than robust code in an already slow path.  [ Changelog
  polished by Dave Hansen ]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.46-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
