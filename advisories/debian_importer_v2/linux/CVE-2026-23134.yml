advisory_id: linux/CVE-2026-23134
datasource_id: debian_importer_v2/linux/CVE-2026-23134
datasource_url: https://security-tracker.debian.org/tracker/CVE-2026-23134
aliases:
  - CVE-2026-23134
summary: 'In the Linux kernel, the following vulnerability has been resolved:  slab: fix kmalloc_nolock()
  context check for PREEMPT_RT  On PREEMPT_RT kernels, local_lock becomes a sleeping lock. The
  current check in kmalloc_nolock() only verifies we''re not in NMI or hard IRQ context, but
  misses the case where preemption is disabled.  When a BPF program runs from a tracepoint with
  preemption disabled (preempt_count > 0), kmalloc_nolock() proceeds to call local_lock_irqsave()
  which attempts to acquire a sleeping lock, triggering:    BUG: sleeping function called from
  invalid context   in_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 6128   preempt_count:
  2, expected: 0  Fix this by checking !preemptible() on PREEMPT_RT, which directly expresses
  the constraint that we cannot take a sleeping lock when preemption is disabled. This encompasses
  the previous checks for NMI and hard IRQ contexts while also catching cases where preemption
  is disabled.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
