advisory_id: linux/CVE-2024-57876
datasource_id: debian_importer_v2/linux/CVE-2024-57876
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-57876
aliases:
  - CVE-2024-57876
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drm/dp_mst: Fix
  resetting msg rx state after topology removal  If the MST topology is removed during the reception
  of an MST down reply or MST up request sideband message, the drm_dp_mst_topology_mgr::up_req_recv/down_rep_recv
  states could be reset from one thread via drm_dp_mst_topology_mgr_set_mst(false), racing with
  the reading/parsing of the message from another thread via drm_dp_mst_handle_down_rep() or
  drm_dp_mst_handle_up_req(). The race is possible since the reader/parser doesn''t hold any
  lock while accessing the reception state. This in turn can lead to a memory corruption in
  the reader/parser as described by commit bd2fccac61b4 ("drm/dp_mst: Fix MST sideband message
  body length check").  Fix the above by resetting the message reception state if needed before
  reading/parsing a message. Another solution would be to hold the drm_dp_mst_topology_mgr::lock
  for the whole duration of the message reception/parsing in drm_dp_mst_handle_down_rep() and
  drm_dp_mst_handle_up_req(), however this would require a bigger change. Since the fix is also
  needed for stable, opting for the simpler solution in this patch.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.123-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
