advisory_id: linux/CVE-2021-47430
datasource_id: debian_importer_v2/linux/CVE-2021-47430
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47430
aliases:
  - CVE-2021-47430
summary: 'In the Linux kernel, the following vulnerability has been resolved:  x86/entry: Clear
  X86_FEATURE_SMAP when CONFIG_X86_SMAP=n  Commit    3c73b81a9164 ("x86/entry, selftests: Further
  improve user entry sanity checks")  added a warning if AC is set when in the kernel.  Commit    662a0221893a3d
  ("x86/entry: Fix AC assertion")  changed the warning to only fire if the CPU supports SMAP.  However,
  the warning can still trigger on a machine that supports SMAP but where it''s disabled in
  the kernel config and when running the syscall_nt selftest, for example:    ------------[
  cut here ]------------   WARNING: CPU: 0 PID: 49 at irqentry_enter_from_user_mode   CPU: 0
  PID: 49 Comm: init Tainted: G                T 5.15.0-rc4+ #98 e6202628ee053b4f310759978284bd8bb0ce6905   Hardware
  name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014   RIP: 0010:irqentry_enter_from_user_mode   ...   Call
  Trace:    ? irqentry_enter    ? exc_general_protection    ? asm_exc_general_protection    ?
  asm_exc_general_protectio  IS_ENABLED(CONFIG_X86_SMAP) could be added to the warning condition,
  but even this would not be enough in case SMAP is disabled at boot time with the "nosmap"
  parameter.  To be consistent with "nosmap" behaviour, clear X86_FEATURE_SMAP when !CONFIG_X86_SMAP.  Found
  using entry-fuzz + satrandconfig.   [ bp: Massage commit message. ]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.14.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.84-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
