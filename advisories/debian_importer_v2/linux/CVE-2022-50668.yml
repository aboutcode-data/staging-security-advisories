advisory_id: linux/CVE-2022-50668
datasource_id: debian_importer_v2/linux/CVE-2022-50668
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50668
aliases:
  - CVE-2022-50668
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ext4: fix deadlock
  due to mbcache entry corruption  When manipulating xattr blocks, we can deadlock infinitely
  looping inside ext4_xattr_block_set() where we constantly keep finding xattr block for reuse
  in mbcache but we are unable to reuse it because its reference count is too big. This happens
  because cache entry for the xattr block is marked as reusable (e_reusable set) although its
  reference count is too big. When this inconsistency happens, this inconsistent state is kept
  indefinitely and so ext4_xattr_block_set() keeps retrying indefinitely.  The inconsistent
  state is caused by non-atomic update of e_reusable bit. e_reusable is part of a bitfield and
  e_reusable update can race with update of e_referenced bit in the same bitfield resulting
  in loss of one of the updates. Fix the problem by using atomic bitops instead.  This bug has
  been around for many years, but it became *much* easier to hit after commit 65f8b80053a1 ("ext4:
  fix race when reusing xattr blocks").'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
