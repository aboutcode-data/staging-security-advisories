advisory_id: linux/CVE-2025-71132
datasource_id: debian_importer_v2/linux/CVE-2025-71132
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71132
aliases:
  - CVE-2025-71132
summary: 'In the Linux kernel, the following vulnerability has been resolved:  smc91x: fix broken
  irq-context in PREEMPT_RT  When smc91x.c is built with PREEMPT_RT, the following splat occurs
  in FVP_RevC:  [   13.055000] smc91x LNRO0003:00 eth0: link up, 10Mbps, half-duplex, lpa 0x0000
  [   13.062137] BUG: workqueue leaked atomic, lock or RCU: kworker/2:1[106] [   13.062137]      preempt=0x00000000
  lock=0->0 RCU=0->1 workfn=mld_ifc_work [   13.062266] C ** replaying previous printk message
  ** [   13.062266] CPU: 2 UID: 0 PID: 106 Comm: kworker/2:1 Not tainted 6.18.0-dirty #179 PREEMPT_{RT,(full)}
  [   13.062353] Hardware name:  , BIOS [   13.062382] Workqueue: mld mld_ifc_work [   13.062469]
  Call trace: [   13.062494]  show_stack+0x24/0x40 (C) [   13.062602]  __dump_stack+0x28/0x48
  [   13.062710]  dump_stack_lvl+0x7c/0xb0 [   13.062818]  dump_stack+0x18/0x34 [   13.062926]  process_scheduled_works+0x294/0x450
  [   13.063043]  worker_thread+0x260/0x3d8 [   13.063124]  kthread+0x1c4/0x228 [   13.063235]  ret_from_fork+0x10/0x20  This
  happens because smc_special_trylock() disables IRQs even on PREEMPT_RT, but smc_special_unlock()
  does not restore IRQs on PREEMPT_RT. The reason is that smc_special_unlock() calls spin_unlock_irqrestore(),
  and rcu_read_unlock_bh() in __dev_queue_xmit() cannot invoke rcu_read_unlock() through __local_bh_enable_ip()
  when current->softirq_disable_cnt becomes zero.  To address this issue, replace smc_special_trylock()
  with spin_trylock_irqsave().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.162-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
