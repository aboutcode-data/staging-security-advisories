advisory_id: linux/CVE-2021-46971
datasource_id: debian_importer_v2/linux/CVE-2021-46971
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-46971
aliases:
  - CVE-2021-46971
summary: 'In the Linux kernel, the following vulnerability has been resolved:  perf/core: Fix
  unconditional security_locked_down() call  Currently, the lockdown state is queried unconditionally,
  even though its result is used only if the PERF_SAMPLE_REGS_INTR bit is set in attr.sample_type.
  While that doesn''t matter in case of the Lockdown LSM, it causes trouble with the SELinux''s
  lockdown hook implementation.  SELinux implements the locked_down hook with a check whether
  the current task''s type has the corresponding "lockdown" class permission ("integrity" or
  "confidentiality") allowed in the policy. This means that calling the hook when the access
  control decision would be ignored generates a bogus permission check and audit record.  Fix
  this by checking sample_type first and only calling the hook when its result would be honored.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.38-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
