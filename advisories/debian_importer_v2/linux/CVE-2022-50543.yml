advisory_id: linux/CVE-2022-50543
datasource_id: debian_importer_v2/linux/CVE-2022-50543
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50543
aliases:
  - CVE-2022-50543
summary: 'In the Linux kernel, the following vulnerability has been resolved:  RDMA/rxe: Fix
  mr->map double free  rxe_mr_cleanup() which tries to free mr->map again will be called when
  rxe_mr_init_user() fails:     CPU: 0 PID: 4917 Comm: rdma_flush_serv Kdump: loaded Not tainted
  6.1.0-rc1-roce-flush+ #25    Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.0-0-gd239552ce722-prebuilt.qemu.org
  04/01/2014    Call Trace:     <TASK>     dump_stack_lvl+0x45/0x5d     panic+0x19e/0x349     end_report.part.0+0x54/0x7c     kasan_report.cold+0xa/0xf     rxe_mr_cleanup+0x9d/0xf0
  [rdma_rxe]     __rxe_cleanup+0x10a/0x1e0 [rdma_rxe]     rxe_reg_user_mr+0xb7/0xd0 [rdma_rxe]     ib_uverbs_reg_mr+0x26a/0x480
  [ib_uverbs]     ib_uverbs_handler_UVERBS_METHOD_INVOKE_WRITE+0x1a2/0x250 [ib_uverbs]     ib_uverbs_cmd_verbs+0x1397/0x15a0
  [ib_uverbs]  This issue was firstly exposed since commit b18c7da63fcb ("RDMA/rxe: Fix memory
  leak in error path code") and then we fixed it in commit 8ff5f5d9d8cf ("RDMA/rxe: Prevent
  double freeing rxe_map_set()") but this fix was reverted together at last by commit 1e75550648da
  (Revert "RDMA/rxe: Create duplicate mapping tables for FMRs")  Simply let rxe_mr_cleanup()
  always handle freeing the mr->map once it is successfully allocated.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
