advisory_id: linux/CVE-2024-47703
datasource_id: debian_importer_v2/linux/CVE-2024-47703
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-47703
aliases:
  - CVE-2024-47703
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf, lsm: Add
  check for BPF LSM return value  A bpf prog returning a positive number attached to file_alloc_security
  hook makes kernel panic.  This happens because file system can not filter out the positive
  number returned by the LSM prog using IS_ERR, and misinterprets this positive number as a
  file pointer.  Given that hook file_alloc_security never returned positive number before the
  introduction of BPF LSM, and other BPF LSM hooks may encounter similar issues, this patch
  adds LSM return value check in verifier, to ensure no unexpected value is returned.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.11.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
