advisory_id: linux/CVE-2025-68219
datasource_id: debian_importer_v2/linux/CVE-2025-68219
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68219
aliases:
  - CVE-2025-68219
summary: 'In the Linux kernel, the following vulnerability has been resolved:  cifs: fix memory
  leak in smb3_fs_context_parse_param error path  Add proper cleanup of ctx->source and fc->source
  to the cifs_parse_mount_err error handler. This ensures that memory allocated for the source
  strings is correctly freed on all error paths, matching the cleanup already performed in the
  success path by smb3_cleanup_fs_context_contents(). Pointers are also set to NULL after freeing
  to prevent potential double-free issues.  This change fixes a memory leak originally detected
  by syzbot. The leak occurred when processing Opt_source mount options if an error happened
  after ctx->source and fc->source were successfully allocated but before the function completed.  The
  specific leak sequence was: 1. ctx->source = smb3_fs_context_fullpath(ctx, ''/'') allocates
  memory 2. fc->source = kstrdup(ctx->source, GFP_KERNEL) allocates more memory 3. A subsequent
  error jumps to cifs_parse_mount_err 4. The old error handler freed passwords but not the source
  strings, causing the memory to leak.  This issue was not addressed by commit e8c73eb7db0a
  ("cifs: client: fix memory leak in smb3_fs_context_parse_param"), which only fixed leaks from
  repeated fsconfig() calls but not this error path.  Patch updated with minor change suggested
  by kernel test robot'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.17.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
