advisory_id: linux/CVE-2022-49535
datasource_id: debian_importer_v2/linux/CVE-2022-49535
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49535
aliases:
  - CVE-2022-49535
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: lpfc: Fix
  null pointer dereference after failing to issue FLOGI and PLOGI  If lpfc_issue_els_flogi()
  fails and returns non-zero status, the node reference count is decremented to trigger the
  release of the nodelist structure. However, if there is a prior registration or dev-loss-evt
  work pending, the node may be released prematurely.  When dev-loss-evt completes, the released
  node is referenced causing a use-after-free null pointer dereference.  Similarly, when processing
  non-zero ELS PLOGI completion status in lpfc_cmpl_els_plogi(), the ndlp flags are checked
  for a transport registration before triggering node removal.  If dev-loss-evt work is pending,
  the node may be released prematurely and a subsequent call to lpfc_dev_loss_tmo_handler()
  results in a use after free ndlp dereference.  Add test for pending dev-loss before decrementing
  the node reference count for FLOGI, PLOGI, PRLI, and ADISC handling.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
