advisory_id: linux/CVE-2021-47479
datasource_id: debian_importer_v2/linux/CVE-2021-47479
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47479
aliases:
  - CVE-2021-47479
summary: 'In the Linux kernel, the following vulnerability has been resolved:  staging: rtl8712:
  fix use-after-free in rtl8712_dl_fw  Syzbot reported use-after-free in rtl8712_dl_fw(). The
  problem was in race condition between r871xu_dev_remove() ->ndo_open() callback.  It''s easy
  to see from crash log, that driver accesses released firmware in ->ndo_open() callback. It
  may happen, since driver was releasing firmware _before_ unregistering netdev. Fix it by moving
  unregister_netdev() before cleaning up resources.  Call Trace: ...  rtl871x_open_fw drivers/staging/rtl8712/hal_init.c:83
  [inline]  rtl8712_dl_fw+0xd95/0xe10 drivers/staging/rtl8712/hal_init.c:170  rtl8712_hal_init
  drivers/staging/rtl8712/hal_init.c:330 [inline]  rtl871x_hal_init+0xae/0x180 drivers/staging/rtl8712/hal_init.c:394  netdev_open+0xe6/0x6c0
  drivers/staging/rtl8712/os_intfs.c:380  __dev_open+0x2bc/0x4d0 net/core/dev.c:1484  Freed
  by task 1306: ...  release_firmware+0x1b/0x30 drivers/base/firmware_loader/main.c:1053  r871xu_dev_remove+0xcc/0x2c0
  drivers/staging/rtl8712/usb_intf.c:599  usb_unbind_interface+0x1d8/0x8d0 drivers/usb/core/driver.c:458'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.15.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.84-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
