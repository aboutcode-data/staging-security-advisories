advisory_id: linux/CVE-2023-53998
datasource_id: debian_importer_v2/linux/CVE-2023-53998
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53998
aliases:
  - CVE-2023-53998
summary: 'In the Linux kernel, the following vulnerability has been resolved:  hwrng: virtio
  - Fix race on data_avail and actual data  The virtio rng device kicks off a new entropy request
  whenever the data available reaches zero.  When a new request occurs at the end of a read
  operation, that is, when the result of that request is only needed by the next reader, then
  there is a race between the writing of the new data and the next reader.  This is because
  there is no synchronisation whatsoever between the writer and the reader.  Fix this by writing
  data_avail with smp_store_release and reading it with smp_load_acquire when we first enter
  read.  The subsequent reads are safe because they''re either protected by the first load acquire,
  or by the completion mechanism.  Also remove the redundant zeroing of data_idx in random_recv_done
  (data_idx must already be zero at this point) and data_avail in request_entropy (ditto).'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.52-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.191-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.4.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
