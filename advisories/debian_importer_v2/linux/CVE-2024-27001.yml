advisory_id: linux/CVE-2024-27001
datasource_id: debian_importer_v2/linux/CVE-2024-27001
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-27001
aliases:
  - CVE-2024-27001
summary: 'In the Linux kernel, the following vulnerability has been resolved:  comedi: vmk80xx:
  fix incomplete endpoint checking  While vmk80xx does have endpoint checking implemented, some
  things can fall through the cracks. Depending on the hardware model, URBs can have either
  bulk or interrupt type, and current version of vmk80xx_find_usb_endpoints() function does
  not take that fully into account. While this warning does not seem to be too harmful, at the
  very least it will crash systems with ''panic_on_warn'' set on them.  Fix the issue found
  by Syzkaller [1] by somewhat simplifying the endpoint checking process with usb_find_common_endpoints()
  and ensuring that only expected endpoint types are present.  This patch has not been tested
  on real hardware.  [1] Syzkaller report: usb 1-1: BOGUS urb xfer, pipe 1 != type 3 WARNING:
  CPU: 0 PID: 781 at drivers/usb/core/urb.c:504 usb_submit_urb+0xc4e/0x18c0 drivers/usb/core/urb.c:503
  ... Call Trace:  <TASK>  usb_start_wait_urb+0x113/0x520 drivers/usb/core/message.c:59  vmk80xx_reset_device
  drivers/comedi/drivers/vmk80xx.c:227 [inline]  vmk80xx_auto_attach+0xa1c/0x1a40 drivers/comedi/drivers/vmk80xx.c:818  comedi_auto_config+0x238/0x380
  drivers/comedi/drivers.c:1067  usb_probe_interface+0x5cd/0xb00 drivers/usb/core/driver.c:399
  ...  Similar issue also found by Syzkaller:'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.90-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.8.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
