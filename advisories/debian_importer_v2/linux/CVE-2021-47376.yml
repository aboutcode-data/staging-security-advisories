advisory_id: linux/CVE-2021-47376
datasource_id: debian_importer_v2/linux/CVE-2021-47376
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47376
aliases:
  - CVE-2021-47376
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: Add oversize
  check before call kvcalloc()  Commit 7661809d493b ("mm: don''t allow oversized kvmalloc()
  calls") add the oversize check. When the allocation is larger than what kmalloc() supports,
  the following warning triggered:  WARNING: CPU: 0 PID: 8408 at mm/util.c:597 kvmalloc_node+0x108/0x110
  mm/util.c:597 Modules linked in: CPU: 0 PID: 8408 Comm: syz-executor221 Not tainted 5.14.0-syzkaller
  #0 Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
  RIP: 0010:kvmalloc_node+0x108/0x110 mm/util.c:597 Call Trace:  kvmalloc include/linux/mm.h:806
  [inline]  kvmalloc_array include/linux/mm.h:824 [inline]  kvcalloc include/linux/mm.h:829
  [inline]  check_btf_line kernel/bpf/verifier.c:9925 [inline]  check_btf_info kernel/bpf/verifier.c:10049
  [inline]  bpf_check+0xd634/0x150d0 kernel/bpf/verifier.c:13759  bpf_prog_load kernel/bpf/syscall.c:2301
  [inline]  __sys_bpf+0x11181/0x126e0 kernel/bpf/syscall.c:4587  __do_sys_bpf kernel/bpf/syscall.c:4691
  [inline]  __se_sys_bpf kernel/bpf/syscall.c:4689 [inline]  __x64_sys_bpf+0x78/0x90 kernel/bpf/syscall.c:4689  do_syscall_x64
  arch/x86/entry/common.c:50 [inline]  do_syscall_64+0x3d/0xb0 arch/x86/entry/common.c:80  entry_SYSCALL_64_after_hwframe+0x44/0xae'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.14.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.70-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
