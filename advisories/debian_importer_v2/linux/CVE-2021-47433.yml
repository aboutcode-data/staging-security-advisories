advisory_id: linux/CVE-2021-47433
datasource_id: debian_importer_v2/linux/CVE-2021-47433
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47433
aliases:
  - CVE-2021-47433
summary: 'In the Linux kernel, the following vulnerability has been resolved:  btrfs: fix abort
  logic in btrfs_replace_file_extents  Error injection testing uncovered a case where we''d
  end up with a corrupt file system with a missing extent in the middle of a file.  This occurs
  because the if statement to decide if we should abort is wrong.  The only way we would abort
  in this case is if we got a ret != -EOPNOTSUPP and we called from the file clone code.  However
  the prealloc code uses this path too.  Instead we need to abort if there is an error, and
  the only error we _don''t_ abort on is -EOPNOTSUPP and only if we came from the clone file
  code.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.14.16-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.84-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
