advisory_id: linux/CVE-2024-57981
datasource_id: debian_importer_v2/linux/CVE-2024-57981
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-57981
aliases:
  - CVE-2024-57981
summary: 'In the Linux kernel, the following vulnerability has been resolved:  usb: xhci: Fix
  NULL pointer dereference on certain command aborts  If a command is queued to the final usable
  TRB of a ring segment, the enqueue pointer is advanced to the subsequent link TRB and no further.
  If the command is later aborted, when the abort completion is handled the dequeue pointer
  is advanced to the first TRB of the next segment.  If no further commands are queued, xhci_handle_stopped_cmd_ring()
  sees the ring pointers unequal and assumes that there is a pending command, so it calls xhci_mod_cmd_timer()
  which crashes if cur_cmd was NULL.  Don''t attempt timer setup if cur_cmd is NULL. The subsequent
  doorbell ring likely is unnecessary too, but it''s harmless. Leave it alone.  This is probably
  Bug 219532, but no confirmation has been received.  The issue has been independently reproduced
  and confirmed fixed using a USB MCU programmed to NAK the Status stage of SET_ADDRESS forever.
  Everything continued working normally after several prevented crashes.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.129-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.237-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
