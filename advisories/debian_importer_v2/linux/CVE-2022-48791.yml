advisory_id: linux/CVE-2022-48791
datasource_id: debian_importer_v2/linux/CVE-2022-48791
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-48791
aliases:
  - CVE-2022-48791
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: pm8001:
  Fix use-after-free for aborted TMF sas_task  Currently a use-after-free may occur if a TMF
  sas_task is aborted before we handle the IO completion in mpi_ssp_completion(). The abort
  occurs due to timeout.  When the timeout occurs, the SAS_TASK_STATE_ABORTED flag is set and
  the sas_task is freed in pm8001_exec_internal_tmf_task().  However, if the I/O completion
  occurs later, the I/O completion still thinks that the sas_task is available. Fix this by
  clearing the ccb->task if the TMF times out - the I/O completion handler does nothing if this
  pointer is cleared.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.16.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.103-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
