advisory_id: linux/CVE-2025-40142
datasource_id: debian_importer_v2/linux/CVE-2025-40142
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40142
aliases:
  - CVE-2025-40142
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ALSA: pcm: Disable
  bottom softirqs as part of spin_lock_irq() on PREEMPT_RT  snd_pcm_group_lock_irq() acquires
  a spinlock_t and disables interrupts via spin_lock_irq(). This also implicitly disables the
  handling of softirqs such as TIMER_SOFTIRQ. On PREEMPT_RT softirqs are preemptible and spin_lock_irq()
  does not disable them. That means a timer can be invoked during spin_lock_irq() on the same
  CPU. Due to synchronisations reasons local_bh_disable() has a per-CPU lock named softirq_ctrl.lock
  which synchronizes individual softirq against each other. syz-bot managed to trigger a lockdep
  report where softirq_ctrl.lock is acquired in hrtimer_cancel() in addition to hrtimer_run_softirq().
  This is a possible deadlock.  The softirq_ctrl.lock can not be made part of spin_lock_irq()
  as this would lead to too much synchronisation against individual threads on the system. To
  avoid the possible deadlock, softirqs must be manually disabled before the lock is acquired.  Disable
  softirqs before the lock is acquired on PREEMPT_RT.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
