advisory_id: linux/CVE-2025-38084
datasource_id: debian_importer_v2/linux/CVE-2025-38084
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38084
aliases:
  - CVE-2025-38084
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/hugetlb: unshare
  page tables during VMA split, not before  Currently, __split_vma() triggers hugetlb page table
  unsharing through vm_ops->may_split().  This happens before the VMA lock and rmap locks are
  taken - which is too early, it allows racing VMA-locked page faults in our process and racing
  rmap walks from other processes to cause page tables to be shared again before we actually
  perform the split.  Fix it by explicitly calling into the hugetlb unshare logic from __split_vma()
  in the same place where THP splitting also happens.  At that point, both the VMA and the rmap(s)
  are write-locked.  An annoying detail is that we can now call into the helper hugetlb_unshare_pmds()
  from two different locking contexts:  1. from hugetlb_split(), holding:     - mmap lock (exclusively)     -
  VMA lock     - file rmap lock (exclusively) 2. hugetlb_unshare_all_pmds(), which I think is
  designed to be able to    call us with only the mmap lock held (in shared mode), but currently    only
  runs while holding mmap lock (exclusively) and VMA lock  Backporting note: This commit fixes
  a racy protection that was introduced in commit b30c14cd6102 ("hugetlb: unshare some PMDs
  when splitting VMAs"); that commit claimed to fix an issue introduced in 5.13, but it should
  actually also go all the way back.  [jannh@google.com: v2]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.147-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.35-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
