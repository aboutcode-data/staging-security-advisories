advisory_id: linux/CVE-2024-40935
datasource_id: debian_importer_v2/linux/CVE-2024-40935
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-40935
aliases:
  - CVE-2024-40935
summary: 'In the Linux kernel, the following vulnerability has been resolved:  cachefiles: flush
  all requests after setting CACHEFILES_DEAD  In ondemand mode, when the daemon is processing
  an open request, if the kernel flags the cache as CACHEFILES_DEAD, the cachefiles_daemon_write()
  will always return -EIO, so the daemon can''t pass the copen to the kernel. Then the kernel
  process that is waiting for the copen triggers a hung_task.  Since the DEAD state is irreversible,
  it can only be exited by closing /dev/cachefiles. Therefore, after calling cachefiles_io_error()
  to mark the cache as CACHEFILES_DEAD, if in ondemand mode, flush all requests to avoid the
  above hungtask. We may still be able to read some of the cached data before closing the fd
  of /dev/cachefiles.  Note that this relies on the patch that adds reference counting to the
  req, otherwise it may UAF.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.99-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
