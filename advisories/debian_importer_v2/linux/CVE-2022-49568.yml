advisory_id: linux/CVE-2022-49568
datasource_id: debian_importer_v2/linux/CVE-2022-49568
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49568
aliases:
  - CVE-2022-49568
summary: 'In the Linux kernel, the following vulnerability has been resolved:  KVM: Don''t null
  dereference ops->destroy  A KVM device cleanup happens in either of two callbacks: 1) destroy()
  which is called when the VM is being destroyed; 2) release() which is called when a device
  fd is closed.  Most KVM devices use 1) but Book3s''s interrupt controller KVM devices (XICS,
  XIVE, XIVE-native) use 2) as they need to close and reopen during the machine execution. The
  error handling in kvm_ioctl_create_device() assumes destroy() is always defined which leads
  to NULL dereference as discovered by Syzkaller.  This adds a checks for destroy!=NULL and
  adds a missing release().  This is not changing kvm_destroy_devices() as devices with defined
  release() should have been removed from the KVM devices list by then.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.16-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.136-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
