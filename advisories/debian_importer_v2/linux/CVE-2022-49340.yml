advisory_id: linux/CVE-2022-49340
datasource_id: debian_importer_v2/linux/CVE-2022-49340
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49340
aliases:
  - CVE-2022-49340
summary: "In the Linux kernel, the following vulnerability has been resolved:  ip_gre: test\
  \ csum_start instead of transport header  GRE with TUNNEL_CSUM will apply local checksum offload\
  \ on CHECKSUM_PARTIAL packets.  ipgre_xmit must validate csum_start after an optional skb_pull,\
  \ else lco_csum may trigger an overflow. The original check was  \tif (csum && skb_checksum_start(skb)\
  \ < skb->data) \t\treturn -EINVAL;  This had false positives when skb_checksum_start is undefined:\
  \ when ip_summed is not CHECKSUM_PARTIAL. A discussed refinement was straightforward  \tif\
  \ (csum && skb->ip_summed == CHECKSUM_PARTIAL && \t    skb_checksum_start(skb) < skb->data)\
  \ \t\treturn -EINVAL;  But was eventually revised more thoroughly: - restrict the check to\
  \ the only branch where needed, in an   uncommon GRE path that uses header_ops and calls skb_pull.\
  \ - test skb_transport_header, which is set along with csum_start   in skb_partial_csum_set\
  \ in the normal header_ops datapath.  Turns out skbs can arrive in this branch without the\
  \ transport header set, e.g., through BPF redirection.  Revise the check back to check csum_start\
  \ directly, and only if CHECKSUM_PARTIAL. Do leave the check in the updated location. Check\
  \ field regardless of whether TUNNEL_CSUM is configured."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.127-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
