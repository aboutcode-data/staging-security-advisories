advisory_id: linux/CVE-2025-21645
datasource_id: debian_importer_v2/linux/CVE-2025-21645
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-21645
aliases:
  - CVE-2025-21645
summary: 'In the Linux kernel, the following vulnerability has been resolved:  platform/x86/amd/pmc:
  Only disable IRQ1 wakeup where i8042 actually enabled it  Wakeup for IRQ1 should be disabled
  only in cases where i8042 had actually enabled it, otherwise "wake_depth" for this IRQ will
  try to drop below zero and there will be an unpleasant WARN() logged:  kernel: atkbd serio0:
  Disabling IRQ1 wakeup source to avoid platform firmware bug kernel: ------------[ cut here
  ]------------ kernel: Unbalanced IRQ 1 wake disable kernel: WARNING: CPU: 10 PID: 6431 at
  kernel/irq/manage.c:920 irq_set_irq_wake+0x147/0x1a0  The PMC driver uses DEFINE_SIMPLE_DEV_PM_OPS()
  to define its dev_pm_ops which sets amd_pmc_suspend_handler() to the .suspend, .freeze, and
  .poweroff handlers. i8042_pm_suspend(), however, is only set as the .suspend handler.  Fix
  the issue by call PMC suspend handler only from the same set of dev_pm_ops handlers as i8042_pm_suspend(),
  which currently means just the .suspend handler.  To reproduce this issue try hibernating
  (S4) the machine after a fresh boot without putting it into s2idle first.  [ij: edited the
  commit message.]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.140-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
