advisory_id: linux/CVE-2021-47062
datasource_id: debian_importer_v2/linux/CVE-2021-47062
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47062
aliases:
  - CVE-2021-47062
summary: 'In the Linux kernel, the following vulnerability has been resolved:  KVM: SVM: Use
  online_vcpus, not created_vcpus, to iterate over vCPUs  Use the kvm_for_each_vcpu() helper
  to iterate over vCPUs when encrypting VMSAs for SEV, which effectively switches to use online_vcpus
  instead of created_vcpus.  This fixes a possible null-pointer dereference as created_vcpus
  does not guarantee a vCPU exists, since it is updated at the very beginning of KVM_CREATE_VCPU.  created_vcpus
  exists to allow the bulk of vCPU creation to run in parallel, while still correctly restricting
  the max number of max vCPUs.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
