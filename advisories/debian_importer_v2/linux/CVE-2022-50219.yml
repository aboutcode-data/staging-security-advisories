advisory_id: linux/CVE-2022-50219
datasource_id: debian_importer_v2/linux/CVE-2022-50219
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50219
aliases:
  - CVE-2022-50219
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: Fix KASAN
  use-after-free Read in compute_effective_progs  Syzbot found a Use After Free bug in compute_effective_progs().
  The reproducer creates a number of BPF links, and causes a fault injected alloc to fail, while
  calling bpf_link_detach on them. Link detach triggers the link to be freed by bpf_link_free(),
  which calls __cgroup_bpf_detach() and update_effective_progs(). If the memory allocation in
  this function fails, the function restores the pointer to the bpf_cgroup_link on the cgroup
  list, but the memory gets freed just after it returns. After this, every subsequent call to
  update_effective_progs() causes this already deallocated pointer to be dereferenced in prog_list_length(),
  and triggers KASAN UAF error.  To fix this issue don''t preserve the pointer to the prog or
  link in the list, but remove it and replace it with a dummy prog without shrinking the table.
  The subsequent call to __cgroup_bpf_detach() or __cgroup_bpf_detach() will correct it.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.140-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
