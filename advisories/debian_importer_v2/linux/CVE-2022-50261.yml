advisory_id: linux/CVE-2022-50261
datasource_id: debian_importer_v2/linux/CVE-2022-50261
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50261
aliases:
  - CVE-2022-50261
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drm/sti: Fix
  return type of sti_{dvo,hda,hdmi}_connector_mode_valid()  With clang''s kernel control flow
  integrity (kCFI, CONFIG_CFI_CLANG), indirect call targets are validated against the expected
  function pointer prototype to make sure the call target is valid to help mitigate ROP attacks.
  If they are not identical, there is a failure at run time, which manifests as either a kernel
  panic or thread getting killed. A proposed warning in clang aims to catch these at compile
  time, which reveals:    drivers/gpu/drm/sti/sti_hda.c:637:16: error: incompatible function
  pointer types initializing ''enum drm_mode_status (*)(struct drm_connector *, struct drm_display_mode
  *)'' with an expression of type ''int (struct drm_connector *, struct drm_display_mode *)''
  [-Werror,-Wincompatible-function-pointer-types-strict]           .mode_valid = sti_hda_connector_mode_valid,                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~   drivers/gpu/drm/sti/sti_dvo.c:376:16:
  error: incompatible function pointer types initializing ''enum drm_mode_status (*)(struct
  drm_connector *, struct drm_display_mode *)'' with an expression of type ''int (struct drm_connector
  *, struct drm_display_mode *)'' [-Werror,-Wincompatible-function-pointer-types-strict]           .mode_valid
  = sti_dvo_connector_mode_valid,                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~   drivers/gpu/drm/sti/sti_hdmi.c:1035:16:
  error: incompatible function pointer types initializing ''enum drm_mode_status (*)(struct
  drm_connector *, struct drm_display_mode *)'' with an expression of type ''int (struct drm_connector
  *, struct drm_display_mode *)'' [-Werror,-Wincompatible-function-pointer-types-strict]           .mode_valid
  = sti_hdmi_connector_mode_valid,                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~  ->mode_valid()
  in ''struct drm_connector_helper_funcs'' expects a return type of ''enum drm_mode_status'',
  not ''int''. Adjust the return type of sti_{dvo,hda,hdmi}_connector_mode_valid() to match
  the prototype''s to resolve the warning and CFI failure.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
