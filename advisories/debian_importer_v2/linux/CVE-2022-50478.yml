advisory_id: linux/CVE-2022-50478
datasource_id: debian_importer_v2/linux/CVE-2022-50478
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50478
aliases:
  - CVE-2022-50478
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nilfs2: fix shift-out-of-bounds/overflow
  in nilfs_sb2_bad_offset()  Patch series "nilfs2: fix UBSAN shift-out-of-bounds warnings on
  mount time".  The first patch fixes a bug reported by syzbot, and the second one fixes the
  remaining bug of the same kind.  Although they are triggered by the same super block data
  anomaly, I divided it into the above two because the details of the issues and how to fix
  it are different.  Both are required to eliminate the shift-out-of-bounds issues at mount
  time.   This patch (of 2):  If the block size exponent information written in an on-disk superblock
  is corrupted, nilfs_sb2_bad_offset helper function can trigger shift-out-of-bounds warning
  followed by a kernel panic (if panic_on_warn is set):   shift exponent 38983 is too large
  for 64-bit type ''unsigned long long''  Call Trace:   <TASK>   __dump_stack lib/dump_stack.c:88
  [inline]   dump_stack_lvl+0x1b1/0x28e lib/dump_stack.c:106   ubsan_epilogue lib/ubsan.c:151
  [inline]   __ubsan_handle_shift_out_of_bounds+0x33d/0x3b0 lib/ubsan.c:322   nilfs_sb2_bad_offset
  fs/nilfs2/the_nilfs.c:449 [inline]   nilfs_load_super_block+0xdf5/0xe00 fs/nilfs2/the_nilfs.c:523   init_nilfs+0xb7/0x7d0
  fs/nilfs2/the_nilfs.c:577   nilfs_fill_super+0xb1/0x5d0 fs/nilfs2/super.c:1047   nilfs_mount+0x613/0x9b0
  fs/nilfs2/super.c:1317   ...  In addition, since nilfs_sb2_bad_offset() performs multiplication
  without considering the upper bound, the computation may overflow if the disk layout parameters
  are not normal.  This fixes these issues by inserting preliminary sanity checks for those
  parameters and by converting the comparison from one involving multiplication and left bit-shifting
  to one using division and right bit-shifting.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
