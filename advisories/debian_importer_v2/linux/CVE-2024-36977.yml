advisory_id: linux/CVE-2024-36977
datasource_id: debian_importer_v2/linux/CVE-2024-36977
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-36977
aliases:
  - CVE-2024-36977
summary: 'In the Linux kernel, the following vulnerability has been resolved:  usb: dwc3: Wait
  unconditionally after issuing EndXfer command  Currently all controller IP/revisions except
  DWC3_usb3 >= 310a wait 1ms unconditionally for ENDXFER completion when IOC is not set. This
  is because DWC_usb3 controller revisions >= 3.10a supports GUCTL2[14: Rst_actbitlater] bit
  which allows polling CMDACT bit to know whether ENDXFER command is completed.  Consider a
  case where an IN request was queued, and parallelly soft_disconnect was called (due to ffs_epfile_release).
  This eventually calls stop_active_transfer with IOC cleared, hence send_gadget_ep_cmd() skips
  waiting for CMDACT cleared during EndXfer. For DWC3 controllers with revisions >= 310a, we
  don''t forcefully wait for 1ms either, and we proceed by unmapping the requests. If ENDXFER
  didn''t complete by this time, it leads to SMMU faults since the controller would still be
  accessing those requests.  Fix this by ensuring ENDXFER completion by adding 1ms delay in
  __dwc3_stop_active_transfer() unconditionally.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.94-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.8.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
