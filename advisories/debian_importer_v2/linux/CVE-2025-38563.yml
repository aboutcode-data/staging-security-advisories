advisory_id: linux/CVE-2025-38563
datasource_id: debian_importer_v2/linux/CVE-2025-38563
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38563
aliases:
  - CVE-2025-38563
summary: 'In the Linux kernel, the following vulnerability has been resolved:  perf/core: Prevent
  VMA split of buffer mappings  The perf mmap code is careful about mmap()''ing the user page
  with the ringbuffer and additionally the auxiliary buffer, when the event supports it. Once
  the first mapping is established, subsequent mapping have to use the same offset and the same
  size in both cases. The reference counting for the ringbuffer and the auxiliary buffer depends
  on this being correct.  Though perf does not prevent that a related mapping is split via mmap(2),
  munmap(2) or mremap(2). A split of a VMA results in perf_mmap_open() calls, which take reference
  counts, but then the subsequent perf_mmap_close() calls are not longer fulfilling the offset
  and size checks. This leads to reference count leaks.  As perf already has the requirement
  for subsequent mappings to match the initial mapping, the obvious consequence is that VMA
  splits, caused by resizing of a mapping or partial unmapping, have to be prevented.  Implement
  the vm_operations_struct::may_split() callback and return unconditionally -EINVAL.  That ensures
  that the mapping offsets and sizes cannot be changed after the fact. Remapping to a different
  fixed address with the same size is still possible as it takes the references for the new
  mapping and drops those of the old mapping.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.148-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.43-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
