advisory_id: linux/CVE-2025-38322
datasource_id: debian_importer_v2/linux/CVE-2025-38322
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38322
aliases:
  - CVE-2025-38322
summary: 'In the Linux kernel, the following vulnerability has been resolved:  perf/x86/intel:
  Fix crash in icl_update_topdown_event()  The perf_fuzzer found a hard-lockup crash on a RaptorLake
  machine:    Oops: general protection fault, maybe for address 0xffff89aeceab400: 0000   CPU:
  23 UID: 0 PID: 0 Comm: swapper/23   Tainted: [W]=WARN   Hardware name: Dell Inc. Precision
  9660/0VJ762   RIP: 0010:native_read_pmc+0x7/0x40   Code: cc e8 8d a9 01 00 48 89 03 5b cd
  cc cc cc cc 0f 1f ...   RSP: 000:fffb03100273de8 EFLAGS: 00010046   ....   Call Trace:     <TASK>     icl_update_topdown_event+0x165/0x190     ?
  ktime_get+0x38/0xd0     intel_pmu_read_event+0xf9/0x210     __perf_event_read+0xf9/0x210  CPUs
  16-23 are E-core CPUs that don''t support the perf metrics feature. The icl_update_topdown_event()
  should not be invoked on these CPUs.  It''s a regression of commit:    f9bdf1f95339 ("perf/x86/intel:
  Avoid disable PMU if !cpuc->enabled in sample read")  The bug introduced by that commit is
  that the is_topdown_event() function is mistakenly used to replace the is_topdown_count()
  call to check if the topdown functions for the perf metrics feature should be invoked.  Fix
  it.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.153-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
