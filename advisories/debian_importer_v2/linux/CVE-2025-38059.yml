advisory_id: linux/CVE-2025-38059
datasource_id: debian_importer_v2/linux/CVE-2025-38059
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38059
aliases:
  - CVE-2025-38059
summary: 'In the Linux kernel, the following vulnerability has been resolved:  btrfs: avoid
  NULL pointer dereference if no valid csum tree  [BUG] When trying read-only scrub on a btrfs
  with rescue=idatacsums mount option, it will crash with the following call trace:    BUG:
  kernel NULL pointer dereference, address: 0000000000000208   #PF: supervisor read access in
  kernel mode   #PF: error_code(0x0000) - not-present page   CPU: 1 UID: 0 PID: 835 Comm: btrfs
  Tainted: G           O        6.15.0-rc3-custom+ #236 PREEMPT(full)   Hardware name: QEMU
  Standard PC (Q35 + ICH9, 2009), BIOS unknown 02/02/2022   RIP: 0010:btrfs_lookup_csums_bitmap+0x49/0x480
  [btrfs]   Call Trace:    <TASK>    scrub_find_fill_first_stripe+0x35b/0x3d0 [btrfs]    scrub_simple_mirror+0x175/0x290
  [btrfs]    scrub_stripe+0x5f7/0x6f0 [btrfs]    scrub_chunk+0x9a/0x150 [btrfs]    scrub_enumerate_chunks+0x333/0x660
  [btrfs]    btrfs_scrub_dev+0x23e/0x600 [btrfs]    btrfs_ioctl+0x1dcf/0x2f80 [btrfs]    __x64_sys_ioctl+0x97/0xc0    do_syscall_64+0x4f/0x120    entry_SYSCALL_64_after_hwframe+0x76/0x7e  [CAUSE]
  Mount option "rescue=idatacsums" will completely skip loading the csum tree, so that any data
  read will not find any data csum thus we will ignore data checksum verification.  Normally
  call sites utilizing csum tree will check the fs state flag NO_DATA_CSUMS bit, but unfortunately
  scrub does not check that bit at all.  This results in scrub to call btrfs_search_slot() on
  a NULL pointer and triggered above crash.  [FIX] Check both extent and csum tree root before
  doing any tree search.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.32-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
