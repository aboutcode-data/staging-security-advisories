advisory_id: linux/CVE-2025-38463
datasource_id: debian_importer_v2/linux/CVE-2025-38463
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38463
aliases:
  - CVE-2025-38463
summary: 'In the Linux kernel, the following vulnerability has been resolved:  tcp: Correct
  signedness in skb remaining space calculation  Syzkaller reported a bug [1] where sk->sk_forward_alloc
  can overflow.  When we send data, if an skb exists at the tail of the write queue, the kernel
  will attempt to append the new data to that skb. However, the code that checks for available
  space in the skb is flawed: '''''' copy = size_goal - skb->len ''''''  The types of the variables
  involved are: '''''' copy: ssize_t (s64 on 64-bit systems) size_goal: int skb->len: unsigned
  int ''''''  Due to C''s type promotion rules, the signed size_goal is converted to an unsigned
  int to match skb->len before the subtraction. The result is an unsigned int.  When this unsigned
  int result is then assigned to the s64 copy variable, it is zero-extended, preserving its
  non-negative value. Consequently, copy is always >= 0.  Assume we are sending 2GB of data
  and size_goal has been adjusted to a value smaller than skb->len. The subtraction will result
  in copy holding a very large positive integer. In the subsequent logic, this large value is
  used to update sk->sk_forward_alloc, which can easily cause it to overflow.  The syzkaller
  reproducer uses TCP_REPAIR to reliably create this condition. However, this can also occur
  in real-world scenarios. The tcp_bound_to_half_wnd() function can also reduce size_goal to
  a small value. This would cause the subsequent tcp_wmem_schedule() to set sk->sk_forward_alloc
  to a value close to INT_MAX. Further memory allocation requests would then cause sk_forward_alloc
  to wrap around and become negative.  [1]: https://syzkaller.appspot.com/bug?extid=de6565462ab540f50e47'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.41-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
