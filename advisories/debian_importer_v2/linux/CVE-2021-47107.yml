advisory_id: linux/CVE-2021-47107
datasource_id: debian_importer_v2/linux/CVE-2021-47107
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47107
aliases:
  - CVE-2021-47107
summary: 'In the Linux kernel, the following vulnerability has been resolved:  NFSD: Fix READDIR
  buffer overflow  If a client sends a READDIR count argument that is too small (say, zero),
  then the buffer size calculation in the new init_dirlist helper functions results in an underflow,
  allowing the XDR stream functions to write beyond the actual buffer.  This calculation has
  always been suspect. NFSD has never sanity- checked the READDIR count argument, but the old
  entry encoders managed the problem correctly.  With the commits below, entry encoding changed,
  exposing the underflow to the pointer arithmetic in xdr_reserve_space().  Modern NFS clients
  attempt to retrieve as much data as possible for each READDIR request. Also, we have no unit
  tests that exercise the behavior of READDIR at the lower bound of @count values. Thus this
  case was missed during testing.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.15.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
