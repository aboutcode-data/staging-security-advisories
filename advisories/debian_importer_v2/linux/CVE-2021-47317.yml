advisory_id: linux/CVE-2021-47317
datasource_id: debian_importer_v2/linux/CVE-2021-47317
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47317
aliases:
  - CVE-2021-47317
summary: 'In the Linux kernel, the following vulnerability has been resolved:  powerpc/bpf:
  Fix detecting BPF atomic instructions  Commit 91c960b0056672 ("bpf: Rename BPF_XADD and prepare
  to encode other atomics in .imm") converted BPF_XADD to BPF_ATOMIC and added a way to distinguish
  instructions based on the immediate field. Existing JIT implementations were updated to check
  for the immediate field and to reject programs utilizing anything more than BPF_ADD (such
  as BPF_FETCH) in the immediate field.  However, the check added to powerpc64 JIT did not look
  at the correct BPF instruction. Due to this, such programs would be accepted and incorrectly
  JIT''ed resulting in soft lockups, as seen with the atomic bounds test. Fix this by looking
  at the correct immediate value.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
