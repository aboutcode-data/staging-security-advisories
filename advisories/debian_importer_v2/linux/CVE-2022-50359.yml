advisory_id: linux/CVE-2022-50359
datasource_id: debian_importer_v2/linux/CVE-2022-50359
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50359
aliases:
  - CVE-2022-50359
summary: 'In the Linux kernel, the following vulnerability has been resolved:  media: cx88:
  Fix a null-ptr-deref bug in buffer_prepare()  When the driver calls cx88_risc_buffer() to
  prepare the buffer, the function call may fail, resulting in a empty buffer and null-ptr-deref
  later in buffer_queue().  The following log can reveal it:  [   41.822762] general protection
  fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN
  PTI [   41.824488] KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]
  [   41.828027] RIP: 0010:buffer_queue+0xc2/0x500 [   41.836311] Call Trace: [   41.836945]  __enqueue_in_driver+0x141/0x360
  [   41.837262]  vb2_start_streaming+0x62/0x4a0 [   41.838216]  vb2_core_streamon+0x1da/0x2c0
  [   41.838516]  __vb2_init_fileio+0x981/0xbc0 [   41.839141]  __vb2_perform_fileio+0xbf9/0x1120
  [   41.840072]  vb2_fop_read+0x20e/0x400 [   41.840346]  v4l2_read+0x215/0x290 [   41.840603]  vfs_read+0x162/0x4c0  Fix
  this by checking the return value of cx88_risc_buffer()  [hverkuil: fix coding style issues]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
