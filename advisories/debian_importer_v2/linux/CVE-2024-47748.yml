advisory_id: linux/CVE-2024-47748
datasource_id: debian_importer_v2/linux/CVE-2024-47748
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-47748
aliases:
  - CVE-2024-47748
summary: 'In the Linux kernel, the following vulnerability has been resolved:  vhost_vdpa: assign
  irq bypass producer token correctly  We used to call irq_bypass_unregister_producer() in vhost_vdpa_setup_vq_irq()
  which is problematic as we don''t know if the token pointer is still valid or not.  Actually,
  we use the eventfd_ctx as the token so the life cycle of the token should be bound to the
  VHOST_SET_VRING_CALL instead of vhost_vdpa_setup_vq_irq() which could be called by set_status().  Fixing
  this by setting up irq bypass producer''s token when handling VHOST_SET_VRING_CALL and un-registering
  the producer before calling vhost_vring_ioctl() to prevent a possible use after free as eventfd
  could have been released in vhost_vring_ioctl(). And such registering and unregistering will
  only be done if DRIVER_OK is set.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.115-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.234-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
