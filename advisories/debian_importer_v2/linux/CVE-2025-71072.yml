advisory_id: linux/CVE-2025-71072
datasource_id: debian_importer_v2/linux/CVE-2025-71072
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71072
aliases:
  - CVE-2025-71072
summary: 'In the Linux kernel, the following vulnerability has been resolved:  shmem: fix recovery
  on rename failures  maple_tree insertions can fail if we are seriously short on memory; simple_offset_rename()
  does not recover well if it runs into that. The same goes for simple_offset_rename_exchange().  Moreover,
  shmem_whiteout() expects that if it succeeds, the caller will progress to d_move(), i.e. that
  shmem_rename2() won''t fail past the successful call of shmem_whiteout().  Not hard to fix,
  fortunately - mtree_store() can''t fail if the index we are trying to store into is already
  present in the tree as a singleton.  For simple_offset_rename_exchange() that''s enough -
  we just need to be careful about the order of operations.  For simple_offset_rename() solution
  is to preinsert the target into the tree for new_dir; the rest can be done without any potentially
  failing operations.  That preinsertion has to be done in shmem_rename2() rather than in simple_offset_rename()
  itself - otherwise we''d need to deal with the possibility of failure after successful shmem_whiteout().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
