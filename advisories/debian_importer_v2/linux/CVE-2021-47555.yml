advisory_id: linux/CVE-2021-47555
datasource_id: debian_importer_v2/linux/CVE-2021-47555
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47555
aliases:
  - CVE-2021-47555
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: vlan: fix
  underflow for the real_dev refcnt  Inject error before dev_hold(real_dev) in register_vlan_dev(),
  and execute the following testcase:  ip link add dev dummy1 type dummy ip link add name dummy1.100
  link dummy1 type vlan id 100 ip link del dev dummy1  When the dummy netdevice is removed,
  we will get a WARNING as following:  =======================================================================
  refcount_t: decrement hit 0; leaking memory. WARNING: CPU: 2 PID: 0 at lib/refcount.c:31 refcount_warn_saturate+0xbf/0x1e0  and
  an endless loop of:  =======================================================================
  unregister_netdevice: waiting for dummy1 to become free. Usage count = -1073741824  That is
  because dev_put(real_dev) in vlan_dev_free() be called without dev_hold(real_dev) in register_vlan_dev().
  It makes the refcnt of real_dev underflow.  Move the dev_hold(real_dev) to vlan_dev_init()
  which is the call-back of ndo_init(). That makes dev_hold() and dev_put() for vlan''s real_dev
  symmetrical.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.15.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.84-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
