advisory_id: linux/CVE-2022-49080
datasource_id: debian_importer_v2/linux/CVE-2022-49080
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49080
aliases:
  - CVE-2022-49080
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/mempolicy:
  fix mpol_new leak in shared_policy_replace  If mpol_new is allocated but not used in restart
  loop, mpol_new will be freed via mpol_put before returning to the caller.  But refcnt is not
  initialized yet, so mpol_put could not do the right things and might leak the unused mpol_new.  This
  would happen if mempolicy was updated on the shared shmem file while the sp->lock has been
  dropped during the memory allocation.  This issue could be triggered easily with the below
  code snippet if there are many processes doing the below work at the same time:    shmid =
  shmget((key_t)5566, 1024 * PAGE_SIZE, 0666|IPC_CREAT);   shm = shmat(shmid, 0, 0);   loop
  many times {     mbind(shm, 1024 * PAGE_SIZE, MPOL_LOCAL, mask, maxnode, 0);     mbind(shm
  + 128 * PAGE_SIZE, 128 * PAGE_SIZE, MPOL_DEFAULT, mask,           maxnode, 0);   }'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.17.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.113-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
