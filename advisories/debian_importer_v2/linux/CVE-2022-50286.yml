advisory_id: linux/CVE-2022-50286
datasource_id: debian_importer_v2/linux/CVE-2022-50286
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50286
aliases:
  - CVE-2022-50286
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ext4: fix delayed
  allocation bug in ext4_clu_mapped for bigalloc + inline  When converting files with inline
  data to extents, delayed allocations made on a file system created with both the bigalloc
  and inline options can result in invalid extent status cache content, incorrect reserved cluster
  counts, kernel memory leaks, and potential kernel panics.  With bigalloc, the code that determines
  whether a block must be delayed allocated searches the extent tree to see if that block maps
  to a previously allocated cluster.  If not, the block is delayed allocated, and otherwise,
  it isn''t.  However, if the inline option is also used, and if the file containing the block
  is marked as able to store data inline, there isn''t a valid extent tree associated with the
  file.  The current code in ext4_clu_mapped() calls ext4_find_extent() to search the non-existent
  tree for a previously allocated cluster anyway, which typically finds nothing, as desired.
  However, a side effect of the search can be to cache invalid content from the non-existent
  tree (garbage) in the extent status tree, including bogus entries in the pending reservation
  tree.  To fix this, avoid searching the extent tree when allocating blocks for bigalloc +
  inline files that are being converted from inline to extent mapped.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
