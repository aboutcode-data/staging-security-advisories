advisory_id: linux/CVE-2024-35801
datasource_id: debian_importer_v2/linux/CVE-2024-35801
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-35801
aliases:
  - CVE-2024-35801
summary: 'In the Linux kernel, the following vulnerability has been resolved:  x86/fpu: Keep
  xfd_state in sync with MSR_IA32_XFD  Commit 672365477ae8 ("x86/fpu: Update XFD state where
  required") and commit 8bf26758ca96 ("x86/fpu: Add XFD state to fpstate") introduced a per
  CPU variable xfd_state to keep the MSR_IA32_XFD value cached, in order to avoid unnecessary
  writes to the MSR.  On CPU hotplug MSR_IA32_XFD is reset to the init_fpstate.xfd, which wipes
  out any stale state. But the per CPU cached xfd value is not reset, which brings them out
  of sync.  As a consequence a subsequent xfd_update_state() might fail to update the MSR which
  in turn can result in XRSTOR raising a #NM in kernel space, which crashes the kernel.  To
  fix this, introduce xfd_set_state() to write xfd_state together with MSR_IA32_XFD, and use
  it in all places that set MSR_IA32_XFD.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.85-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
