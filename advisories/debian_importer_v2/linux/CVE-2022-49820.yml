advisory_id: linux/CVE-2022-49820
datasource_id: debian_importer_v2/linux/CVE-2022-49820
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49820
aliases:
  - CVE-2022-49820
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mctp i2c: don''t
  count unused / invalid keys for flow release  We''re currently hitting the WARN_ON in mctp_i2c_flow_release:      if
  (midev->release_count > midev->i2c_lock_count) {         WARN_ONCE(1, "release count overflow");  This
  may be hit if we expire a flow before sending the first packet it contains - as we will not
  be pairing the increment of release_count (performed on flow release) with the i2c lock operation
  (only performed on actual TX).  To fix this, only release a flow if we''ve encountered it
  previously (ie, dev_flow_state does not indicate NEW), as we will mark the flow as ACTIVE
  at the same time as accounting for the i2c lock operation. We also need to add an INVALID
  flow state, to indicate when we''ve done the release.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
