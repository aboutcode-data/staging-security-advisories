advisory_id: linux/CVE-2022-50506
datasource_id: debian_importer_v2/linux/CVE-2022-50506
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50506
aliases:
  - CVE-2022-50506
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drbd: only clone
  bio if we have a backing device  Commit c347a787e34cb (drbd: set ->bi_bdev in drbd_req_new)
  moved a bio_set_dev call (which has since been removed) to "earlier", from drbd_request_prepare
  to drbd_req_new.  The problem is that this accesses device->ldev->backing_bdev, which is not
  NULL-checked at this point. When we don''t have an ldev (i.e. when the DRBD device is diskless),
  this leads to a null pointer deref.  So, only allocate the private_bio if we actually have
  a disk. This is also a small optimization, since we don''t clone the bio to only to immediately
  free it again in the diskless case.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
