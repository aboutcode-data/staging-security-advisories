advisory_id: linux/CVE-2025-38523
datasource_id: debian_importer_v2/linux/CVE-2025-38523
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38523
aliases:
  - CVE-2025-38523
summary: 'In the Linux kernel, the following vulnerability has been resolved:  cifs: Fix the
  smbd_response slab to allow usercopy  The handling of received data in the smbdirect client
  code involves using copy_to_iter() to copy data from the smbd_reponse struct''s packet trailer
  to a folioq buffer provided by netfslib that encapsulates a chunk of pagecache.  If, however,
  CONFIG_HARDENED_USERCOPY=y, this will result in the checks then performed in copy_to_iter()
  oopsing with something like the following:   CIFS: Attempting to mount //172.31.9.1/test  CIFS:
  VFS: RDMA transport established  usercopy: Kernel memory exposure attempt detected from SLUB
  object ''smbd_response_0000000091e24ea1'' (offset 81, size 63)!  ------------[ cut here ]------------  kernel
  BUG at mm/usercopy.c:102!  ...  RIP: 0010:usercopy_abort+0x6c/0x80  ...  Call Trace:   <TASK>   __check_heap_object+0xe3/0x120   __check_object_size+0x4dc/0x6d0   smbd_recv+0x77f/0xfe0
  [cifs]   cifs_readv_from_socket+0x276/0x8f0 [cifs]   cifs_read_from_socket+0xcd/0x120 [cifs]   cifs_demultiplex_thread+0x7e9/0x2d50
  [cifs]   kthread+0x396/0x830   ret_from_fork+0x2b8/0x3b0   ret_from_fork_asm+0x1a/0x30  The
  problem is that the smbd_response slab''s packet field isn''t marked as being permitted for
  usercopy.  Fix this by passing parameters to kmem_slab_create() to indicate that copy_to_iter()
  is permitted from the packet region of the smbd_response slab objects, less the header space.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.37-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
