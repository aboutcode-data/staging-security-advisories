advisory_id: linux/CVE-2022-50071
datasource_id: debian_importer_v2/linux/CVE-2022-50071
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50071
aliases:
  - CVE-2022-50071
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mptcp: move subflow
  cleanup in mptcp_destroy_common()  If the mptcp socket creation fails due to a CGROUP_INET_SOCK_CREATE
  eBPF program, the MPTCP protocol ends-up leaking all the subflows: the related cleanup happens
  in __mptcp_destroy_sock() that is not invoked in such code path.  Address the issue moving
  the subflow sockets cleanup in the mptcp_destroy_common() helper, which is invoked in every
  msk cleanup path.  Additionally get rid of the intermediate list_splice_init step, which is
  an unneeded relic from the past.  The issue is present since before the reported root cause
  commit, but any attempt to backport the fix before that hash will require a complete rewrite.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
