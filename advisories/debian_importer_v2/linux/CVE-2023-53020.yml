advisory_id: linux/CVE-2023-53020
datasource_id: debian_importer_v2/linux/CVE-2023-53020
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53020
aliases:
  - CVE-2023-53020
summary: 'In the Linux kernel, the following vulnerability has been resolved:  l2tp: close all
  race conditions in l2tp_tunnel_register()  The code in l2tp_tunnel_register() is racy in several
  ways:  1. It modifies the tunnel socket _after_ publishing it.  2. It calls setup_udp_tunnel_sock()
  on an existing socket without    locking.  3. It changes sock lock class on fly, which triggers
  many syzbot    reports.  This patch amends all of them by moving socket initialization code
  before publishing and under sock lock. As suggested by Jakub, the l2tp lockdep class is not
  necessary as we can just switch to bh_lock_sock_nested().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
