advisory_id: linux/CVE-2022-49814
datasource_id: debian_importer_v2/linux/CVE-2022-49814
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49814
aliases:
  - CVE-2022-49814
summary: 'In the Linux kernel, the following vulnerability has been resolved:  kcm: close race
  conditions on sk_receive_queue  sk->sk_receive_queue is protected by skb queue lock, but for
  KCM sockets its RX path takes mux->rx_lock to protect more than just skb queue. However, kcm_recvmsg()
  still only grabs the skb queue lock, so race conditions still exist.  We can teach kcm_recvmsg()
  to grab mux->rx_lock too but this would introduce a potential performance regression as struct
  kcm_mux can be shared by multiple KCM sockets.  So we have to enforce skb queue lock in requeue_rx_msgs()
  and handle skb peek case carefully in kcm_wait_data(). Fortunately, skb_recv_datagram() already
  handles it nicely and is widely used by other sockets, we can just switch to skb_recv_datagram()
  after getting rid of the unnecessary sock lock in kcm_recvmsg() and kcm_splice_read(). Side
  note: SOCK_DONE is not used by KCM sockets, so it is safe to get rid of this check too.  I
  ran the original syzbot reproducer for 30 min without seeing any issue.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
