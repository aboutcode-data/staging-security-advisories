advisory_id: linux/CVE-2024-39477
datasource_id: debian_importer_v2/linux/CVE-2024-39477
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-39477
aliases:
  - CVE-2024-39477
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/hugetlb: do
  not call vma_add_reservation upon ENOMEM  sysbot reported a splat [1] on __unmap_hugepage_range().  This
  is because vma_needs_reservation() can return -ENOMEM if allocate_file_region_entries() fails
  to allocate the file_region struct for the reservation.  Check for that and do not call vma_add_reservation()
  if that is the case, otherwise region_abort() and region_del() will see that we do not have
  any file_regions.  If we detect that vma_needs_reservation() returned -ENOMEM, we clear the
  hugetlb_restore_reserve flag as if this reservation was still consumed, so free_huge_folio()
  will not increment the resv count.  [1] https://lore.kernel.org/linux-mm/0000000000004096100617c58d54@google.com/T/#ma5983bc1ab18a54910da83416b3f89f3c7ee43aa'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
