advisory_id: linux/CVE-2024-26956
datasource_id: debian_importer_v2/linux/CVE-2024-26956
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-26956
aliases:
  - CVE-2024-26956
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nilfs2: fix failure
  to detect DAT corruption in btree and direct mappings  Patch series "nilfs2: fix kernel bug
  at submit_bh_wbc()".  This resolves a kernel BUG reported by syzbot.  Since there are two
  flaws involved, I''ve made each one a separate patch.  The first patch alone resolves the
  syzbot-reported bug, but I think both fixes should be sent to stable, so I''ve tagged them
  as such.   This patch (of 2):  Syzbot has reported a kernel bug in submit_bh_wbc() when writing
  file data to a nilfs2 file system whose metadata is corrupted.  There are two flaws involved
  in this issue.  The first flaw is that when nilfs_get_block() locates a data block using btree
  or direct mapping, if the disk address translation routine nilfs_dat_translate() fails with
  internal code -ENOENT due to DAT metadata corruption, it can be passed back to nilfs_get_block().  This
  causes nilfs_get_block() to misidentify an existing block as non-existent, causing both data
  block lookup and insertion to fail inconsistently.  The second flaw is that nilfs_get_block()
  returns a successful status in this inconsistent state.  This causes the caller __block_write_begin_int()
  or others to request a read even though the buffer is not mapped, resulting in a BUG_ON check
  for the BH_Mapped flag in submit_bh_wbc() failing.  This fixes the first issue by changing
  the return value to code -EINVAL when a conversion using DAT fails with code -ENOENT, avoiding
  the conflicting condition that leads to the kernel bug described above.  Here, code -EINVAL
  indicates that metadata corruption was detected during the block lookup, which will be properly
  handled as a file system error and converted to -EIO when passing through the nilfs2 bmap
  layer.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.85-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
