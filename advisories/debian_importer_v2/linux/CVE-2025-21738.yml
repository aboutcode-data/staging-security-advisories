advisory_id: linux/CVE-2025-21738
datasource_id: debian_importer_v2/linux/CVE-2025-21738
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-21738
aliases:
  - CVE-2025-21738
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ata: libata-sff:
  Ensure that we cannot write outside the allocated buffer  reveliofuzzing reported that a SCSI_IOCTL_SEND_COMMAND
  ioctl with out_len set to 0xd42, SCSI command set to ATA_16 PASS-THROUGH, ATA command set
  to ATA_NOP, and protocol set to ATA_PROT_PIO, can cause ata_pio_sector() to write outside
  the allocated buffer, overwriting random memory.  While a ATA device is supposed to abort
  a ATA_NOP command, there does seem to be a bug either in libata-sff or QEMU, where either
  this status is not set, or the status is cleared before read by ata_sff_hsm_move(). Anyway,
  that is most likely a separate bug.  Looking at __atapi_pio_bytes(), it already has a safety
  check to ensure that __atapi_pio_bytes() cannot write outside the allocated buffer.  Add a
  similar check to ata_pio_sector(), such that also ata_pio_sector() cannot write outside the
  allocated buffer.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.129-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
