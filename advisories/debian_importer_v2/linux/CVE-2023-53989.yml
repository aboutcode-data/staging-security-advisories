advisory_id: linux/CVE-2023-53989
datasource_id: debian_importer_v2/linux/CVE-2023-53989
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53989
aliases:
  - CVE-2023-53989
summary: "In the Linux kernel, the following vulnerability has been resolved:  arm64: mm: fix\
  \ VA-range sanity check  Both create_mapping_noalloc() and update_mapping_prot() sanity-check\
  \ their 'virt' parameter, but the check itself doesn't make much sense. The condition used\
  \ today appears to be a historical accident.  The sanity-check condition:  \tif ((virt >=\
  \ PAGE_END) && (virt < VMALLOC_START)) { \t\t[ ... warning here ... ] \t\treturn; \t}  ...\
  \ can only be true for the KASAN shadow region or the module region, and there's no reason\
  \ to exclude these specifically for creating and updateing mappings.  When arm64 support was\
  \ first upstreamed in commit:    c1cc1552616d0f35 (\"arm64: MMU initialisation\")  ... the\
  \ condition was:  \tif (virt < VMALLOC_START) { \t\t[ ... warning here ... ] \t\treturn; \t\
  }  At the time, VMALLOC_START was the lowest kernel address, and this was checking whether\
  \ 'virt' would be translated via TTBR1.  Subsequently in commit:    14c127c957c1c607 (\"arm64:\
  \ mm: Flip kernel VA space\")  ... the condition was changed to:  \tif ((virt >= VA_START)\
  \ && (virt < VMALLOC_START)) { \t\t[ ... warning here ... ] \t\treturn; \t}  This appear to\
  \ have been a thinko. The commit moved the linear map to the bottom of the kernel address\
  \ space, with VMALLOC_START being at the halfway point. The old condition would warn for changes\
  \ to the linear map below this, and at the time VA_START was the end of the linear map.  Subsequently\
  \ we cleaned up the naming of VA_START in commit:    77ad4ce69321abbe (\"arm64: memory: rename\
  \ VA_START to PAGE_END\")  ... keeping the erroneous condition as:  \tif ((virt >= PAGE_END)\
  \ && (virt < VMALLOC_START)) { \t\t[ ... warning here ... ] \t\treturn; \t}  Correct the condition\
  \ to check against the start of the TTBR1 address space, which is currently PAGE_OFFSET. This\
  \ simplifies the logic, and more clearly matches the \"outside kernel range\" message in the\
  \ warning."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/5.10.191-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.4.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
