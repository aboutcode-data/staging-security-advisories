advisory_id: linux/CVE-2025-40270
datasource_id: debian_importer_v2/linux/CVE-2025-40270
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40270
aliases:
  - CVE-2025-40270
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm, swap: fix
  potential UAF issue for VMA readahead  Since commit 78524b05f1a3 ("mm, swap: avoid redundant
  swap device pinning"), the common helper for allocating and preparing a folio in the swap
  cache layer no longer tries to get a swap device reference internally, because all callers
  of __read_swap_cache_async are already holding a swap entry reference.  The repeated swap
  device pinning isn''t needed on the same swap device.  Caller of VMA readahead is also holding
  a reference to the target entry''s swap device, but VMA readahead walks the page table, so
  it might encounter swap entries from other devices, and call __read_swap_cache_async on another
  device without holding a reference to it.  So it is possible to cause a UAF when swapoff of
  device A raced with swapin on device B, and VMA readahead tries to read swap entries from
  device A.  It''s not easy to trigger, but in theory, it could cause real issues.  Make VMA
  readahead try to get the device reference first if the swap device is a different one from
  the target entry.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
