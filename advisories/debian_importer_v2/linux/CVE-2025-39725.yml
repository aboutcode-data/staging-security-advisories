advisory_id: linux/CVE-2025-39725
datasource_id: debian_importer_v2/linux/CVE-2025-39725
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39725
aliases:
  - CVE-2025-39725
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/vmscan: fix
  hwpoisoned large folio handling in shrink_folio_list  In shrink_folio_list(), the hwpoisoned
  folio may be large folio, which can''t be handled by unmap_poisoned_folio().  For THP, try_to_unmap_one()
  must be passed with TTU_SPLIT_HUGE_PMD to split huge PMD first and then retry.  Without TTU_SPLIT_HUGE_PMD,
  we will trigger null-ptr deref of pvmw.pte.  Even we passed TTU_SPLIT_HUGE_PMD, we will trigger
  a WARN_ON_ONCE due to the page isn''t in swapcache.  Since UCE is rare in real world, and
  race with reclaimation is more rare, just skipping the hwpoisoned large folio is enough.  memory_failure()
  will handle it if the UCE is triggered again.  This happens when memory reclaim for large
  folio races with memory_failure(), and will lead to kernel panic.  The race is as follows:  cpu0      cpu1  shrink_folio_list
  memory_failure   TestSetPageHWPoison   unmap_poisoned_folio   --> trigger BUG_ON due to   unmap_poisoned_folio
  couldn''t    handle large folio  [tujinjiang@huawei.com: add comment to unmap_poisoned_folio()]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.41-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
