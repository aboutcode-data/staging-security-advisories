advisory_id: linux/CVE-2022-49305
datasource_id: debian_importer_v2/linux/CVE-2022-49305
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49305
aliases:
  - CVE-2022-49305
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drivers: staging:
  rtl8192u: Fix deadlock in ieee80211_beacons_stop()  There is a deadlock in ieee80211_beacons_stop(),
  which is shown below:     (Thread 1)              |      (Thread 2)                            |
  ieee80211_send_beacon() ieee80211_beacons_stop()   |  mod_timer()  spin_lock_irqsave() //(1)
  |  (wait a time)  ...                       | ieee80211_send_beacon_cb()  del_timer_sync()          |  spin_lock_irqsave()
  //(2)  (wait timer to stop)      |  ...  We hold ieee->beacon_lock in position (1) of thread
  1 and use del_timer_sync() to wait timer to stop, but timer handler also need ieee->beacon_lock
  in position (2) of thread 2. As a result, ieee80211_beacons_stop() will block forever.  This
  patch extracts del_timer_sync() from the protection of spin_lock_irqsave(), which could let
  timer handler to obtain the needed lock.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.127-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
