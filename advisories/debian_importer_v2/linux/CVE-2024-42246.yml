advisory_id: linux/CVE-2024-42246
datasource_id: debian_importer_v2/linux/CVE-2024-42246
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-42246
aliases:
  - CVE-2024-42246
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net, sunrpc:
  Remap EPERM in case of connection failure in xs_tcp_setup_socket  When using a BPF program
  on kernel_connect(), the call can return -EPERM. This causes xs_tcp_setup_socket() to loop
  forever, filling up the syslog and causing the kernel to potentially freeze up.  Neil suggested:    This
  will propagate -EPERM up into other layers which might not be ready   to handle it. It might
  be safer to map EPERM to an error we would be more   likely to expect from the network system
  - such as ECONNREFUSED or ENETDOWN.  ECONNREFUSED as error seems reasonable. For programs
  setting a different error can be out of reach (see handling in 4fbac77d2d09) in particular
  on kernels which do not have f10d05966196 ("bpf: Make BPF_PROG_RUN_ARRAY return -err instead
  of allow boolean"), thus given that it is better to simply remap for consistent behavior.
  UDP does handle EPERM in xs_udp_send_request().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.106-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.226-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
