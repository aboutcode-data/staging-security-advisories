advisory_id: linux/CVE-2023-53536
datasource_id: debian_importer_v2/linux/CVE-2023-53536
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53536
aliases:
  - CVE-2023-53536
summary: 'In the Linux kernel, the following vulnerability has been resolved:  blk-crypto: make
  blk_crypto_evict_key() more robust  If blk_crypto_evict_key() sees that the key is still in-use
  (due to a bug) or that ->keyslot_evict failed, it currently just returns while leaving the
  key linked into the keyslot management structures.  However, blk_crypto_evict_key() is only
  called in contexts such as inode eviction where failure is not an option.  So actually the
  caller proceeds with freeing the blk_crypto_key regardless of the return value of blk_crypto_evict_key().  These
  two assumptions don''t match, and the result is that there can be a use-after-free in blk_crypto_reprogram_all_keys()
  after one of these errors occurs.  (Note, these errors *shouldn''t* happen; we''re just talking
  about what happens if they do anyway.)  Fix this by making blk_crypto_evict_key() unlink the
  key from the keyslot management structures even on failure.  Also improve some comments.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.37-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.191-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.3.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
