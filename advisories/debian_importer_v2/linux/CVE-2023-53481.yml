advisory_id: linux/CVE-2023-53481
datasource_id: debian_importer_v2/linux/CVE-2023-53481
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53481
aliases:
  - CVE-2023-53481
summary: "In the Linux kernel, the following vulnerability has been resolved:  ubi: ubi_wl_put_peb:\
  \ Fix infinite loop when wear-leveling work failed  Following process will trigger an infinite\
  \ loop in ubi_wl_put_peb():  \tubifs_bgt\t\tubi_bgt ubifs_leb_unmap   ubi_leb_unmap     ubi_eba_unmap_leb\
  \       ubi_wl_put_peb\twear_leveling_worker                           e1 = rb_entry(rb_first(&ubi->used)\
  \ \t\t\t  e2 = get_peb_for_wl(ubi) \t\t\t  ubi_io_read_vid_hdr  // return err (flash fault)\
  \ \t\t\t  out_error: \t\t\t    ubi->move_from = ubi->move_to = NULL \t\t\t    wl_entry_destroy(ubi,\
  \ e1) \t\t\t      ubi->lookuptbl[e->pnum] = NULL       retry:         e = ubi->lookuptbl[pnum];\t\
  // return NULL \tif (e == ubi->move_from) {\t// NULL == NULL gets true \t  goto retry;\t\t\
  \t// infinite loop !!!  $ top   PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM  \
  \   COMMAND   7676 root     20   0       0      0      0 R 100.0  0.0  ubifs_bgt0_0  Fix it\
  \ by:  1) Letting ubi_wl_put_peb() returns directly if wearl leveling entry has     been removed\
  \ from 'ubi->lookuptbl'.  2) Using 'ubi->wl_lock' protecting wl entry deletion to preventing\
  \ an     use-after-free problem for wl entry in ubi_wl_put_peb().  Fetch a reproducer in [Link]."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.20-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
