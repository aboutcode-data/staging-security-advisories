advisory_id: linux/CVE-2023-53419
datasource_id: debian_importer_v2/linux/CVE-2023-53419
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53419
aliases:
  - CVE-2023-53419
summary: 'In the Linux kernel, the following vulnerability has been resolved:  rcu: Protect
  rcu_print_task_exp_stall() ->exp_tasks access  For kernels built with CONFIG_PREEMPT_RCU=y,
  the following scenario can result in a NULL-pointer dereference:             CPU1                                           CPU2
  rcu_preempt_deferred_qs_irqrestore                rcu_print_task_exp_stall   if (special.b.blocked)                            READ_ONCE(rnp->exp_tasks)
  != NULL     raw_spin_lock_rcu_node     np = rcu_next_node_entry(t, rnp)     if (&t->rcu_node_entry
  == rnp->exp_tasks)       WRITE_ONCE(rnp->exp_tasks, np)       ....       raw_spin_unlock_irqrestore_rcu_node                                                     raw_spin_lock_irqsave_rcu_node                                                     t
  = list_entry(rnp->exp_tasks->prev,                                                         struct
  task_struct, rcu_node_entry)                                                     (if rnp->exp_tasks
  is NULL, this                                                        will dereference a NULL
  pointer)  The problem is that CPU2 accesses the rcu_node structure''s->exp_tasks field without
  holding the rcu_node structure''s ->lock and CPU2 did not observe CPU1''s change to rcu_node
  structure''s ->exp_tasks in time. Therefore, if CPU1 sets rcu_node structure''s->exp_tasks
  pointer to NULL, then CPU2 might dereference that NULL pointer.  This commit therefore holds
  the rcu_node structure''s ->lock while accessing that structure''s->exp_tasks field.  [ paulmck:
  Apply Frederic Weisbecker feedback. ]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.37-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.191-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.3.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
