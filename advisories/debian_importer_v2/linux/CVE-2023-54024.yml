advisory_id: linux/CVE-2023-54024
datasource_id: debian_importer_v2/linux/CVE-2023-54024
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54024
aliases:
  - CVE-2023-54024
summary: 'In the Linux kernel, the following vulnerability has been resolved:  KVM: Destroy
  target device if coalesced MMIO unregistration fails  Destroy and free the target coalesced
  MMIO device if unregistering said device fails.  As clearly noted in the code, kvm_io_bus_unregister_dev()
  does not destroy the target device.    BUG: memory leak   unreferenced object 0xffff888112a54880
  (size 64):     comm "syz-executor.2", pid 5258, jiffies 4297861402 (age 14.129s)     hex dump
  (first 32 bytes):       38 c7 67 15 00 c9 ff ff 38 c7 67 15 00 c9 ff ff  8.g.....8.g.....       e0
  c7 e1 83 ff ff ff ff 00 30 67 15 00 c9 ff ff  .........0g.....     backtrace:       [<0000000006995a8a>]
  kmalloc include/linux/slab.h:556 [inline]       [<0000000006995a8a>] kzalloc include/linux/slab.h:690
  [inline]       [<0000000006995a8a>] kvm_vm_ioctl_register_coalesced_mmio+0x8e/0x3d0 arch/x86/kvm/../../../virt/kvm/coalesced_mmio.c:150       [<00000000022550c2>]
  kvm_vm_ioctl+0x47d/0x1600 arch/x86/kvm/../../../virt/kvm/kvm_main.c:3323       [<000000008a75102f>]
  vfs_ioctl fs/ioctl.c:46 [inline]       [<000000008a75102f>] file_ioctl fs/ioctl.c:509 [inline]       [<000000008a75102f>]
  do_vfs_ioctl+0xbab/0x1160 fs/ioctl.c:696       [<0000000080e3f669>] ksys_ioctl+0x76/0xa0 fs/ioctl.c:713       [<0000000059ef4888>]
  __do_sys_ioctl fs/ioctl.c:720 [inline]       [<0000000059ef4888>] __se_sys_ioctl fs/ioctl.c:718
  [inline]       [<0000000059ef4888>] __x64_sys_ioctl+0x6f/0xb0 fs/ioctl.c:718       [<000000006444fa05>]
  do_syscall_64+0x9f/0x4e0 arch/x86/entry/common.c:290       [<000000009a4ed50b>] entry_SYSCALL_64_after_hwframe+0x49/0xbe    BUG:
  leak checking failed'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.20-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
