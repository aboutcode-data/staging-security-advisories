advisory_id: linux/CVE-2024-42316
datasource_id: debian_importer_v2/linux/CVE-2024-42316
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-42316
aliases:
  - CVE-2024-42316
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/mglru: fix
  div-by-zero in vmpressure_calc_level()  evict_folios() uses a second pass to reclaim folios
  that have gone through page writeback and become clean before it finishes the first pass,
  since folio_rotate_reclaimable() cannot handle those folios due to the isolation.  The second
  pass tries to avoid potential double counting by deducting scan_control->nr_scanned.  However,
  this can result in underflow of nr_scanned, under a condition where shrink_folio_list() does
  not increment nr_scanned, i.e., when folio_trylock() fails.  The underflow can cause the divisor,
  i.e., scale=scanned+reclaimed in vmpressure_calc_level(), to become zero, resulting in the
  following crash:    [exception RIP: vmpressure_work_fn+101]   process_one_work at ffffffffa3313f2b  Since
  scan_control->nr_scanned has no established semantics, the potential double counting has minimal
  risks.  Therefore, fix the problem by not deducting scan_control->nr_scanned in evict_folios().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.106-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.10.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
