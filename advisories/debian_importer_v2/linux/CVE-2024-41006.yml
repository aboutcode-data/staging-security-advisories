advisory_id: linux/CVE-2024-41006
datasource_id: debian_importer_v2/linux/CVE-2024-41006
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-41006
aliases:
  - CVE-2024-41006
summary: 'In the Linux kernel, the following vulnerability has been resolved:  netrom: Fix a
  memory leak in nr_heartbeat_expiry()  syzbot reported a memory leak in nr_create() [0].  Commit
  409db27e3a2e ("netrom: Fix use-after-free of a listening socket.") added sock_hold() to the
  nr_heartbeat_expiry() function, where a) a socket has a SOCK_DESTROY flag or b) a listening
  socket has a SOCK_DEAD flag.  But in the case "a," when the SOCK_DESTROY flag is set, the
  file descriptor has already been closed and the nr_release() function has been called. So
  it makes no sense to hold the reference count because no one will call another nr_destroy_socket()
  and put it as in the case "b."  nr_connect   nr_establish_data_link     nr_start_heartbeat  nr_release   switch
  (nr->state)   case NR_STATE_3     nr->state = NR_STATE_2     sock_set_flag(sk, SOCK_DESTROY);                          nr_rx_frame                           nr_process_rx_frame                             switch
  (nr->state)                             case NR_STATE_2                               nr_state2_machine()                                 nr_disconnect()                                   nr_sk(sk)->state
  = NR_STATE_0                                   sock_set_flag(sk, SOCK_DEAD)                          nr_heartbeat_expiry                           switch
  (nr->state)                           case NR_STATE_0                             if (sock_flag(sk,
  SOCK_DESTROY) ||                                (sk->sk_state == TCP_LISTEN                                  &&
  sock_flag(sk, SOCK_DEAD)))                                sock_hold()  // ( !!! )                                nr_destroy_socket()  To
  fix the memory leak, let''s call sock_hold() only for a listening socket.  Found by InfoTeCS
  on behalf of Linux Verification Center (linuxtesting.org) with Syzkaller.  [0]: https://syzkaller.appspot.com/bug?extid=d327a1f3b12e1e206c16'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.99-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.221-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
