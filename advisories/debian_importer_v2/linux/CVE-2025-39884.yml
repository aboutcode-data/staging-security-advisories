advisory_id: linux/CVE-2025-39884
datasource_id: debian_importer_v2/linux/CVE-2025-39884
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39884
aliases:
  - CVE-2025-39884
summary: 'In the Linux kernel, the following vulnerability has been resolved:  btrfs: fix subvolume
  deletion lockup caused by inodes xarray race  There is a race condition between inode eviction
  and inode caching that can cause a live struct btrfs_inode to be missing from the root->inodes
  xarray. Specifically, there is a window during evict() between the inode being unhashed and
  deleted from the xarray. If btrfs_iget() is called for the same inode in that window, it will
  be recreated and inserted into the xarray, but then eviction will delete the new entry, leaving
  nothing in the xarray:  Thread 1                          Thread 2 ---------------------------------------------------------------
  evict()   remove_inode_hash()                                   btrfs_iget_path()                                     btrfs_iget_locked()                                     btrfs_read_locked_inode()                                       btrfs_add_inode_to_root()   destroy_inode()     btrfs_destroy_inode()       btrfs_del_inode_from_root()         __xa_erase  In
  turn, this can cause issues for subvolume deletion. Specifically, if an inode is in this lost
  state, and all other inodes are evicted, then btrfs_del_inode_from_root() will call btrfs_add_dead_root()
  prematurely. If the lost inode has a delayed_node attached to it, then when btrfs_clean_one_deleted_snapshot()
  calls btrfs_kill_all_delayed_nodes(), it will loop forever because the delayed_nodes xarray
  will never become empty (unless memory pressure forces the inode out). We saw this manifest
  as soft lockups in production.  Fix it by only deleting the xarray entry if it matches the
  given inode (using __xa_cmpxchg()).'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.48-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
