advisory_id: linux/CVE-2023-54130
datasource_id: debian_importer_v2/linux/CVE-2023-54130
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54130
aliases:
  - CVE-2023-54130
summary: 'In the Linux kernel, the following vulnerability has been resolved:  hfs/hfsplus:
  avoid WARN_ON() for sanity check, use proper error handling  Commit 55d1cbbbb29e ("hfs/hfsplus:
  use WARN_ON for sanity check") fixed a build warning by turning a comment into a WARN_ON(),
  but it turns out that syzbot then complains because it can trigger said warning with a corrupted
  hfs image.  The warning actually does warn about a bad situation, but we are much better off
  just handling it as the error it is.  So rather than warn about us doing bad things, stop
  doing the bad things and return -EIO.  While at it, also fix a memory leak that was introduced
  by an earlier fix for a similar syzbot warning situation, and add a check for one case that
  historically wasn''t handled at all (ie neither comment nor subsequent WARN_ON).'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
