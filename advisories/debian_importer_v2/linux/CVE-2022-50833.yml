advisory_id: linux/CVE-2022-50833
datasource_id: debian_importer_v2/linux/CVE-2022-50833
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50833
aliases:
  - CVE-2022-50833
summary: 'In the Linux kernel, the following vulnerability has been resolved:  Bluetooth: use
  hdev->workqueue when queuing hdev->{cmd,ncmd}_timer works  syzbot is reporting attempt to
  schedule hdev->cmd_work work from system_wq WQ into hdev->workqueue WQ which is under draining
  operation [1], for commit c8efcc2589464ac7 ("workqueue: allow chained queueing during destruction")
  does not allow such operation.  The check introduced by commit 877afadad2dce8aa ("Bluetooth:
  When HCI work queue is drained, only queue chained work") was incomplete.  Use hdev->workqueue
  WQ when queuing hdev->{cmd,ncmd}_timer works because hci_{cmd,ncmd}_timeout() calls queue_work(hdev->workqueue).
  Also, protect the queuing operation with RCU read lock in order to avoid calling queue_delayed_work()
  after cancel_delayed_work() completed.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
