advisory_id: linux/CVE-2024-57891
datasource_id: debian_importer_v2/linux/CVE-2024-57891
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-57891
aliases:
  - CVE-2024-57891
summary: 'In the Linux kernel, the following vulnerability has been resolved:  sched_ext: Fix
  invalid irq restore in scx_ops_bypass()  While adding outer irqsave/restore locking, 0e7ffff1b811
  ("scx: Fix raciness in scx_ops_bypass()") forgot to convert an inner rq_unlock_irqrestore()
  to rq_unlock() which could re-enable IRQ prematurely leading to the following warning:    raw_local_irq_restore()
  called with IRQs enabled   WARNING: CPU: 1 PID: 96 at kernel/locking/irqflag-debug.c:10 warn_bogus_irq_restore+0x30/0x40   ...   Sched_ext:
  create_dsq (enabling)   pstate: 60400005 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)   pc
  : warn_bogus_irq_restore+0x30/0x40   lr : warn_bogus_irq_restore+0x30/0x40   ...   Call trace:    warn_bogus_irq_restore+0x30/0x40
  (P)    warn_bogus_irq_restore+0x30/0x40 (L)    scx_ops_bypass+0x224/0x3b8    scx_ops_enable.isra.0+0x2c8/0xaa8    bpf_scx_reg+0x18/0x30   ...   irq
  event stamp: 33739   hardirqs last  enabled at (33739): [<ffff8000800b699c>] scx_ops_bypass+0x174/0x3b8   hardirqs
  last disabled at (33738): [<ffff800080d48ad4>] _raw_spin_lock_irqsave+0xb4/0xd8  Drop the
  stray _irqrestore().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
