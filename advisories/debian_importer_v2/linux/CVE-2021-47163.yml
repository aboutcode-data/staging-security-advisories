advisory_id: linux/CVE-2021-47163
datasource_id: debian_importer_v2/linux/CVE-2021-47163
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47163
aliases:
  - CVE-2021-47163
summary: 'In the Linux kernel, the following vulnerability has been resolved:  tipc: wait and
  exit until all work queues are done  On some host, a crash could be triggered simply by repeating
  these commands several times:    # modprobe tipc   # tipc bearer enable media udp name UDP1
  localip 127.0.0.1   # rmmod tipc    [] BUG: unable to handle kernel paging request at ffffffffc096bb00   []
  Workqueue: events 0xffffffffc096bb00   [] Call Trace:   []  ? process_one_work+0x1a7/0x360   []  ?
  worker_thread+0x30/0x390   []  ? create_worker+0x1a0/0x1a0   []  ? kthread+0x116/0x130   []  ?
  kthread_flush_work_fn+0x10/0x10   []  ? ret_from_fork+0x35/0x40  When removing the TIPC module,
  the UDP tunnel sock will be delayed to release in a work queue as sock_release() can''t be
  done in rtnl_lock(). If the work queue is schedule to run after the TIPC module is removed,
  kernel will crash as the work queue function cleanup_beareri() code no longer exists when
  trying to invoke it.  To fix it, this patch introduce a member wq_count in tipc_net to track
  the numbers of work queues in schedule, and  wait and exit until all work queues are done
  in tipc_exit_net().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.14.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.46-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
