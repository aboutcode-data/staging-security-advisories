advisory_id: linux/CVE-2024-50048
datasource_id: debian_importer_v2/linux/CVE-2024-50048
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-50048
aliases:
  - CVE-2024-50048
summary: "In the Linux kernel, the following vulnerability has been resolved:  fbcon: Fix a\
  \ NULL pointer dereference issue in fbcon_putcs  syzbot has found a NULL pointer dereference\
  \ bug in fbcon. Here is the simplified C reproducer:  struct param { \tuint8_t type; \tstruct\
  \ tiocl_selection ts; };  int main() { \tstruct fb_con2fbmap con2fb; \tstruct param param;\
  \  \tint fd = open(\"/dev/fb1\", 0, 0);  \tcon2fb.console = 0x19; \tcon2fb.framebuffer = 0;\
  \ \tioctl(fd, FBIOPUT_CON2FBMAP, &con2fb);  \tparam.type = 2; \tparam.ts.xs = 0; param.ts.ys\
  \ = 0; \tparam.ts.xe = 0; param.ts.ye = 0; \tparam.ts.sel_mode = 0;  \tint fd1 = open(\"/dev/tty1\"\
  , O_RDWR, 0); \tioctl(fd1, TIOCLINUX, &param);  \tcon2fb.console = 1; \tcon2fb.framebuffer\
  \ = 0; \tioctl(fd, FBIOPUT_CON2FBMAP, &con2fb);  \treturn 0; }  After calling ioctl(fd1, TIOCLINUX,\
  \ &param), the subsequent ioctl(fd, FBIOPUT_CON2FBMAP, &con2fb) causes the kernel to follow\
  \ a different execution path:   set_con2fb_map   -> con2fb_init_display    -> fbcon_set_disp\
  \     -> redraw_screen      -> hide_cursor       -> clear_selection        -> highlight  \
  \       -> invert_screen          -> do_update_region           -> fbcon_putcs           \
  \ -> ops->putcs  Since ops->putcs is a NULL pointer, this leads to a kernel panic. To prevent\
  \ this, we need to call set_blitting_type() within set_con2fb_map() to properly initialize\
  \ ops->putcs."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.115-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
