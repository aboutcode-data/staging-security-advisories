advisory_id: linux/CVE-2023-53635
datasource_id: debian_importer_v2/linux/CVE-2023-53635
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53635
aliases:
  - CVE-2023-53635
summary: 'In the Linux kernel, the following vulnerability has been resolved:  netfilter: conntrack:
  fix wrong ct->timeout value  (struct nf_conn)->timeout is an interval before the conntrack
  confirmed.  After confirmed, it becomes a timestamp.  It is observed that timeout of an unconfirmed
  conntrack: - Set by calling ctnetlink_change_timeout(). As a result,   `nfct_time_stamp` was
  wrongly added to `ct->timeout` twice. - Get by calling ctnetlink_dump_timeout(). As a result,   `nfct_time_stamp`
  was wrongly subtracted.  Call Trace:  <TASK>  dump_stack_lvl  ctnetlink_dump_timeout  __ctnetlink_glue_build  ctnetlink_glue_build  __nfqnl_enqueue_packet  nf_queue  nf_hook_slow  ip_mc_output  ?
  __pfx_ip_finish_output  ip_send_skb  ? __pfx_dst_output  udp_send_skb  udp_sendmsg  ? __pfx_ip_generic_getfrag  sock_sendmsg  Separate
  the 2 cases in: - Setting `ct->timeout` in __nf_ct_set_timeout(). - Getting `ct->timeout`
  in ctnetlink_dump_timeout().  Pablo appends:  Update ctnetlink to set up the timeout _after_
  the IPS_CONFIRMED flag is set on, otherwise conntrack creation via ctnetlink breaks.  Note
  that the problem described in this patch occurs since the introduction of the nfnetlink_queue
  conntrack support, select a sufficiently old Fixes: tag for -stable kernel to pick up this
  fix.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.37-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.3.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
