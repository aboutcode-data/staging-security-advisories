advisory_id: linux/CVE-2025-40004
datasource_id: debian_importer_v2/linux/CVE-2025-40004
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40004
aliases:
  - CVE-2025-40004
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net/9p: Fix buffer
  overflow in USB transport layer  A buffer overflow vulnerability exists in the USB 9pfs transport
  layer where inconsistent size validation between packet header parsing and actual data copying
  allows a malicious USB host to overflow heap buffers.  The issue occurs because: - usb9pfs_rx_header()
  validates only the declared size in packet header - usb9pfs_rx_complete() uses req->actual
  (actual received bytes) for memcpy  This allows an attacker to craft packets with small declared
  size (bypassing validation) but large actual payload (triggering overflow in memcpy).  Add
  validation in usb9pfs_rx_complete() to ensure req->actual does not exceed the buffer capacity
  before copying data.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
