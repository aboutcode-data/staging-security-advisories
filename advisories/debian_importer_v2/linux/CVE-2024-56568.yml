advisory_id: linux/CVE-2024-56568
datasource_id: debian_importer_v2/linux/CVE-2024-56568
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-56568
aliases:
  - CVE-2024-56568
summary: "In the Linux kernel, the following vulnerability has been resolved:  iommu/arm-smmu:\
  \ Defer probe of clients after smmu device bound  Null pointer dereference occurs due to a\
  \ race between smmu driver probe and client driver probe, when of_dma_configure() for client\
  \ is called after the iommu_device_register() for smmu driver probe has executed but before\
  \ the driver_bound() for smmu driver has been called.  Following is how the race occurs: \
  \ T1:Smmu device probe\t\tT2: Client device probe  really_probe() arm_smmu_device_probe()\
  \ iommu_device_register() \t\t\t\t\treally_probe() \t\t\t\t\tplatform_dma_configure() \t\t\
  \t\t\tof_dma_configure() \t\t\t\t\tof_dma_configure_id() \t\t\t\t\tof_iommu_configure() \t\
  \t\t\t\tiommu_probe_device() \t\t\t\t\tiommu_init_device() \t\t\t\t\tarm_smmu_probe_device()\
  \ \t\t\t\t\tarm_smmu_get_by_fwnode() \t\t\t\t\t\tdriver_find_device_by_fwnode() \t\t\t\t\t\
  \tdriver_find_device() \t\t\t\t\t\tnext_device() \t\t\t\t\t\tklist_next() \t\t\t\t\t\t   \
  \ /* null ptr \t\t\t\t\t\t       assigned to smmu */ \t\t\t\t\t/* null ptr dereference \t\t\
  \t\t\t   while smmu->streamid_mask */ driver_bound() \tklist_add_tail()  When this null smmu\
  \ pointer is dereferenced later in arm_smmu_probe_device, the device crashes.  Fix this by\
  \ deferring the probe of the client device until the smmu device has bound to the arm smmu\
  \ driver.  [will: Add comment]"
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.123-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.234-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
