advisory_id: linux/CVE-2024-36971
datasource_id: debian_importer_v2/linux/CVE-2024-36971
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-36971
aliases:
  - CVE-2024-36971
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: fix __dst_negative_advice()
  race  __dst_negative_advice() does not enforce proper RCU rules when sk->dst_cache must be
  cleared, leading to possible UAF.  RCU rules are that we must first clear sk->sk_dst_cache,
  then call dst_release(old_dst).  Note that sk_dst_reset(sk) is implementing this protocol
  correctly, while __dst_negative_advice() uses the wrong order.  Given that ip6_negative_advice()
  has special logic against RTF_CACHE, this means each of the three ->negative_advice() existing
  methods must perform the sk_dst_reset() themselves.  Note the check against NULL dst is centralized
  in __dst_negative_advice(), there is no need to duplicate it in various callbacks.  Many thanks
  to Clement Lecigne for tracking this issue.  This old bug became visible after the blamed
  commit, using UDP sockets.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.94-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.221-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
