advisory_id: linux/CVE-2025-71067
datasource_id: debian_importer_v2/linux/CVE-2025-71067
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71067
aliases:
  - CVE-2025-71067
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ntfs: set dummy
  blocksize to read boot_block when mounting  When mounting, sb->s_blocksize is used to read
  the boot_block without being defined or validated. Set a dummy blocksize before attempting
  to read the boot_block.  The issue can be triggered with the following syz reproducer:    mkdirat(0xffffffffffffff9c,
  &(0x7f0000000080)=''./file1\x00'', 0x0)   r4 = openat$nullb(0xffffffffffffff9c, &(0x7f0000000040),
  0x121403, 0x0)   ioctl$FS_IOC_SETFLAGS(r4, 0x40081271, &(0x7f0000000980)=0x4000)   mount(&(0x7f0000000140)=@nullb,
  &(0x7f0000000040)=''./cgroup\x00'',         &(0x7f0000000000)=''ntfs3\x00'', 0x2208004, 0x0)   syz_clone(0x88200200,
  0x0, 0x0, 0x0, 0x0, 0x0)  Here, the ioctl sets the bdev block size to 16384. During mount,
  get_tree_bdev_flags() calls sb_set_blocksize(sb, block_size(bdev)), but since block_size(bdev)
  > PAGE_SIZE, sb_set_blocksize() leaves sb->s_blocksize at zero.  Later, ntfs_init_from_boot()
  attempts to read the boot_block while sb->s_blocksize is still zero, which triggers the bug.  [almaz.alexandrovich@paragon-software.com:
  changed comment style, added return value handling]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.18.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
