advisory_id: linux/CVE-2025-40150
datasource_id: debian_importer_v2/linux/CVE-2025-40150
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40150
aliases:
  - CVE-2025-40150
summary: "In the Linux kernel, the following vulnerability has been resolved:  f2fs: fix to\
  \ avoid migrating empty section  It reports a bug from device w/ zufs:  F2FS-fs (dm-64): Inconsistent\
  \ segment (173822) type [1, 0] in SSA and SIT F2FS-fs (dm-64): Stopped filesystem due to reason:\
  \ 4  Thread A\t\t\t\tThread B - f2fs_expand_inode_data  - f2fs_allocate_pinning_section  \
  \ - f2fs_gc_range    - do_garbage_collect w/ segno #x \t\t\t\t\t- writepage \t\t\t\t\t - f2fs_allocate_data_block\
  \ \t\t\t\t\t  - new_curseg \t\t\t\t\t   - allocate segno #x  The root cause is: fallocate\
  \ on pinning file may race w/ block allocation as above, result in do_garbage_collect() from\
  \ fallocate() may migrate segment which is just allocated by a log, the log will update segment\
  \ type in its in-memory structure, however GC will get segment type from on-disk SSA block,\
  \ once segment type changes by log, we can detect such inconsistency, then shutdown filesystem.\
  \  In this case, on-disk SSA shows type of segno #173822 is 1 (SUM_TYPE_NODE), however segno\
  \ #173822 was just allocated as data type segment, so in-memory SIT shows type of segno #173822\
  \ is 0 (SUM_TYPE_DATA).  Change as below to fix this issue: - check whether current section\
  \ is empty before gc - add sanity checks on do_garbage_collect() to avoid any race case, result\
  \ in migrating segment used by log. - btw, it fixes misc issue in printed logs: \"SSA and\
  \ SIT\" -> \"SIT and SSA\"."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.12.63-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
