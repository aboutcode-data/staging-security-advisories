advisory_id: linux/CVE-2021-47491
datasource_id: debian_importer_v2/linux/CVE-2021-47491
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47491
aliases:
  - CVE-2021-47491
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm: khugepaged:
  skip huge page collapse for special files  The read-only THP for filesystems will collapse
  THP for files opened readonly and mapped with VM_EXEC.  The intended usecase is to avoid TLB
  misses for large text segments.  But it doesn''t restrict the file types so a THP could be
  collapsed for a non-regular file, for example, block device, if it is opened readonly and
  mapped with EXEC permission.  This may cause bugs, like [1] and [2].  This is definitely not
  the intended usecase, so just collapse THP for regular files in order to close the attack
  surface.  [shy828301@gmail.com: fix vm_file check [3]]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.15.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.84-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
