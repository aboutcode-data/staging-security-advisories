advisory_id: linux/CVE-2021-47203
datasource_id: debian_importer_v2/linux/CVE-2021-47203
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47203
aliases:
  - CVE-2021-47203
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: lpfc: Fix
  list_add() corruption in lpfc_drain_txq()  When parsing the txq list in lpfc_drain_txq(),
  the driver attempts to pass the requests to the adapter. If such an attempt fails, a local
  "fail_msg" string is set and a log message output.  The job is then added to a completions
  list for cancellation.  Processing of any further jobs from the txq list continues, but since
  "fail_msg" remains set, jobs are added to the completions list regardless of whether a wqe
  was passed to the adapter.  If successfully added to txcmplq, jobs are added to both lists
  resulting in list corruption.  Fix by clearing the fail_msg string after adding a job to the
  completions list. This stops the subsequent jobs from being added to the completions list
  unless they had an appropriate failure.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.15.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.84-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
