advisory_id: linux/CVE-2025-68341
datasource_id: debian_importer_v2/linux/CVE-2025-68341
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68341
aliases:
  - CVE-2025-68341
summary: 'In the Linux kernel, the following vulnerability has been resolved:  veth: reduce
  XDP no_direct return section to fix race  As explain in commit fa349e396e48 ("veth: Fix race
  with AF_XDP exposing old or uninitialized descriptors") for veth there is a chance after napi_complete_done()
  that another CPU can manage start another NAPI instance running veth_pool(). For NAPI this
  is correctly handled as the napi_schedule_prep() check will prevent multiple instances from
  getting scheduled, but for the remaining code in veth_pool() this can run concurrent with
  the newly started NAPI instance.  The problem/race is that xdp_clear_return_frame_no_direct()
  isn''t designed to be nested.  Prior to commit 401cb7dae813 ("net: Reference bpf_redirect_info
  via task_struct on PREEMPT_RT.") the temporary BPF net context bpf_redirect_info was stored
  per CPU, where this wasn''t an issue. Since this commit the BPF context is stored in ''current''
  task_struct. When running veth in threaded-NAPI mode, then the kthread becomes the storage
  area. Now a race exists between two concurrent veth_pool() function calls one exiting NAPI
  and one running new NAPI, both using the same BPF net context.  Race is when another CPU gets
  within the xdp_set_return_frame_no_direct() section before exiting veth_pool() calls the clear-function
  xdp_clear_return_frame_no_direct().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
