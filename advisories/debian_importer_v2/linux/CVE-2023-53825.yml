advisory_id: linux/CVE-2023-53825
datasource_id: debian_importer_v2/linux/CVE-2023-53825
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53825
aliases:
  - CVE-2023-53825
summary: 'In the Linux kernel, the following vulnerability has been resolved:  kcm: Fix error
  handling for SOCK_DGRAM in kcm_sendmsg().  syzkaller found a memory leak in kcm_sendmsg(),
  and commit c821a88bd720 ("kcm: Fix memory leak in error path of kcm_sendmsg()") suppressed
  it by updating kcm_tx_msg(head)->last_skb if partial data is copied so that the following
  sendmsg() will resume from the skb.  However, we cannot know how many bytes were copied when
  we get the error. Thus, we could mess up the MSG_MORE queue.  When kcm_sendmsg() fails for
  SOCK_DGRAM, we should purge the queue as we do so for UDP by udp_flush_pending_frames().  Even
  without this change, when the error occurred, the following sendmsg() resumed from a wrong
  skb and the queue was messed up.  However, we have yet to get such a report, and only syzkaller
  stumbled on it.  So, this can be changed safely.  Note this does not change SOCK_SEQPACKET
  behaviour.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.55-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.197-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.5.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
