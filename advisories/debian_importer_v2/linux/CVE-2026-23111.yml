advisory_id: linux/CVE-2026-23111
datasource_id: debian_importer_v2/linux/CVE-2026-23111
datasource_url: https://security-tracker.debian.org/tracker/CVE-2026-23111
aliases:
  - CVE-2026-23111
summary: 'In the Linux kernel, the following vulnerability has been resolved:  netfilter: nf_tables:
  fix inverted genmask check in nft_map_catchall_activate()  nft_map_catchall_activate() has
  an inverted element activity check compared to its non-catchall counterpart nft_mapelem_activate()
  and compared to what is logically required.  nft_map_catchall_activate() is called from the
  abort path to re-activate catchall map elements that were deactivated during a failed transaction.
  It should skip elements that are already active (they don''t need re-activation) and process
  elements that are inactive (they need to be restored). Instead, the current code does the
  opposite: it skips inactive elements and processes active ones.  Compare the non-catchall
  activate callback, which is correct:    nft_mapelem_activate():     if (nft_set_elem_active(ext,
  iter->genmask))         return 0;   /* skip active, process inactive */  With the buggy catchall
  version:    nft_map_catchall_activate():     if (!nft_set_elem_active(ext, genmask))         continue;   /*
  skip inactive, process active */  The consequence is that when a DELSET operation is aborted,
  nft_setelem_data_activate() is never called for the catchall element. For NFT_GOTO verdict
  elements, this means nft_data_hold() is never called to restore the chain->use reference count.
  Each abort cycle permanently decrements chain->use. Once chain->use reaches zero, DELCHAIN
  succeeds and frees the chain while catchall verdict elements still reference it, resulting
  in a use-after-free.  This is exploitable for local privilege escalation from an unprivileged
  user via user namespaces + nftables on distributions that enable CONFIG_USER_NS and CONFIG_NF_TABLES.  Fix
  by removing the negation so the check matches nft_mapelem_activate(): skip active elements,
  process inactive ones.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.73-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
