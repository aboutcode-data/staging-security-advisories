advisory_id: linux/CVE-2021-47369
datasource_id: debian_importer_v2/linux/CVE-2021-47369
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47369
aliases:
  - CVE-2021-47369
summary: 'In the Linux kernel, the following vulnerability has been resolved:  s390/qeth: fix
  NULL deref in qeth_clear_working_pool_list()  When qeth_set_online() calls qeth_clear_working_pool_list()
  to roll back after an error exit from qeth_hardsetup_card(), we are at risk of accessing card->qdio.in_q
  before it was allocated by qeth_alloc_qdio_queues() via qeth_mpc_initialize().  qeth_clear_working_pool_list()
  then dereferences NULL, and by writing to queue->bufs[i].pool_entry scribbles all over the
  CPU''s lowcore. Resulting in a crash when those lowcore areas are used next (eg. on the next
  machine-check interrupt).  Such a scenario would typically happen when the device is first
  set online and its queues aren''t allocated yet. An early IO error or certain misconfigs (eg.
  mismatched transport mode, bad portno) then cause us to error out from qeth_hardsetup_card()
  with card->qdio.in_q still being NULL.  Fix it by checking the pointer for NULL before accessing
  it.  Note that we also have (rare) paths inside qeth_mpc_initialize() where a configuration
  change can cause us to free the existing queues, expecting that subsequent code will allocate
  them again. If we then error out before that re-allocation happens, the same bug occurs.  Root-caused-by:
  Heiko Carstens <hca@linux.ibm.com>'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.14.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.70-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
