advisory_id: linux/CVE-2024-49981
datasource_id: debian_importer_v2/linux/CVE-2024-49981
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-49981
aliases:
  - CVE-2024-49981
summary: "In the Linux kernel, the following vulnerability has been resolved:  media: venus:\
  \ fix use after free bug in venus_remove due to race condition  in venus_probe, core->work\
  \ is bound with venus_sys_error_handler, which is used to handle error. The code use core->sys_err_done\
  \ to make sync work. The core->work is started in venus_event_notify.  If we call venus_remove,\
  \ there might be an unfished work. The possible sequence is as follows:  CPU0            \
  \      CPU1                       |venus_sys_error_handler venus_remove         | hfi_destroy\t\
  \ \t\t | venus_hfi_destroy\t | kfree(hdev);\t     |                      |hfi_reinit \t\t\t\
  \t\t |venus_hfi_queues_reinit                      |//use hdev  Fix it by canceling the work\
  \ in venus_remove."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.115-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.234-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
