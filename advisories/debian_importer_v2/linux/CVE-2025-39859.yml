advisory_id: linux/CVE-2025-39859
datasource_id: debian_importer_v2/linux/CVE-2025-39859
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39859
aliases:
  - CVE-2025-39859
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ptp: ocp: fix
  use-after-free bugs causing by ptp_ocp_watchdog  The ptp_ocp_detach() only shuts down the
  watchdog timer if it is pending. However, if the timer handler is already running, the timer_delete_sync()
  is not called. This leads to race conditions where the devlink that contains the ptp_ocp is
  deallocated while the timer handler is still accessing it, resulting in use-after-free bugs.
  The following details one of the race scenarios.  (thread 1)                           | (thread
  2) ptp_ocp_remove()                     |   ptp_ocp_detach()                   | ptp_ocp_watchdog()     if
  (timer_pending(&bp->watchdog))|   bp = timer_container_of()       timer_delete_sync()            |                                      |   devlink_free(devlink)
  //free       |                                      |   bp-> //use  Resolve this by unconditionally
  calling timer_delete_sync() to ensure the timer is reliably deactivated, preventing any access
  after free.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/6.16.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
