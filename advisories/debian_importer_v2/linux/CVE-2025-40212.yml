advisory_id: linux/CVE-2025-40212
datasource_id: debian_importer_v2/linux/CVE-2025-40212
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40212
aliases:
  - CVE-2025-40212
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nfsd: fix refcount
  leak in nfsd_set_fh_dentry()  nfsd exports a "pseudo root filesystem" which is used by NFSv4
  to find the various exported filesystems using LOOKUP requests from a known root filehandle.  NFSv3
  uses the MOUNT protocol to find those exported filesystems and so is not given access to the
  pseudo root filesystem.  If a v3 (or v2) client uses a filehandle from that filesystem, nfsd_set_fh_dentry()
  will report an error, but still stores the export in "struct svc_fh" even though it also drops
  the reference (exp_put()). This means that when fh_put() is called an extra reference will
  be dropped which can lead to use-after-free and possible denial of service.  Normal NFS usage
  will not provide a pseudo-root filehandle to a v3 client.  This bug can only be triggered
  by the client synthesising an incorrect filehandle.  To fix this we move the assignments to
  the svc_fh later, after all possible error cases have been detected.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
