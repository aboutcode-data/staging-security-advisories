advisory_id: linux/CVE-2023-54152
datasource_id: debian_importer_v2/linux/CVE-2023-54152
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54152
aliases:
  - CVE-2023-54152
summary: 'In the Linux kernel, the following vulnerability has been resolved:  can: j1939: prevent
  deadlock by moving j1939_sk_errqueue()  This commit addresses a deadlock situation that can
  occur in certain scenarios, such as when running data TP/ETP transfer and subscribing to the
  error queue while receiving a net down event. The deadlock involves locks in the following
  order:  3   j1939_session_list_lock ->  active_session_list_lock   j1939_session_activate   ...   j1939_sk_queue_activate_next
  -> sk_session_queue_lock   ...   j1939_xtp_rx_eoma_one  2   j1939_sk_queue_drop_all  ->  sk_session_queue_lock   ...   j1939_sk_netdev_event_netdown
  -> j1939_socks_lock   j1939_netdev_notify  1   j1939_sk_errqueue -> j1939_socks_lock   __j1939_session_cancel
  -> active_session_list_lock   j1939_tp_rxtimer         CPU0                    CPU1        ----                    ----   lock(&priv->active_session_list_lock);                                lock(&jsk->sk_session_queue_lock);                                lock(&priv->active_session_list_lock);   lock(&priv->j1939_socks_lock);  The
  solution implemented in this commit is to move the j1939_sk_errqueue() call out of the active_session_list_lock
  context, thus preventing the deadlock situation.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.25-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
