advisory_id: linux/CVE-2024-49982
datasource_id: debian_importer_v2/linux/CVE-2024-49982
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-49982
aliases:
  - CVE-2024-49982
summary: 'In the Linux kernel, the following vulnerability has been resolved:  aoe: fix the
  potential use-after-free problem in more places  For fixing CVE-2023-6270, f98364e92662 ("aoe:
  fix the potential use-after-free problem in aoecmd_cfg_pkts") makes tx() calling dev_put()
  instead of doing in aoecmd_cfg_pkts(). It avoids that the tx() runs into use-after-free.  Then
  Nicolai Stange found more places in aoe have potential use-after-free problem with tx(). e.g.
  revalidate(), aoecmd_ata_rw(), resend(), probe() and aoecmd_cfg_rsp(). Those functions also
  use aoenet_xmit() to push packet to tx queue. So they should also use dev_hold() to increase
  the refcnt of skb->dev.  On the other hand, moving dev_put() to tx() causes that the refcnt
  of skb->dev be reduced to a negative value, because corresponding dev_hold() are not called
  in revalidate(), aoecmd_ata_rw(), resend(), probe(), and aoecmd_cfg_rsp(). This patch fixed
  this issue.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.115-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.234-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
