advisory_id: linux/CVE-2022-49086
datasource_id: debian_importer_v2/linux/CVE-2022-49086
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49086
aliases:
  - CVE-2022-49086
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: openvswitch:
  fix leak of nested actions  While parsing user-provided actions, openvswitch module may dynamically
  allocate memory and store pointers in the internal copy of the actions. So this memory has
  to be freed while destroying the actions.  Currently there are only two such actions: ct()
  and set().  However, there are many actions that can hold nested lists of actions and ovs_nla_free_flow_actions()
  just jumps over them leaking the memory.  For example, removal of the flow with the following
  actions will lead to a leak of the memory allocated by nf_ct_tmpl_alloc():    actions:clone(ct(commit),0)  Non-freed
  set() action may also leak the ''dst'' structure for the tunnel info including device references.  Under
  certain conditions with a high rate of flow rotation that may cause significant memory leak
  problem (2MB per second in reporter''s case).  The problem is also hard to mitigate, because
  the user doesn''t have direct control over the datapath flows generated by OVS.  Fix that
  by iterating over all the nested actions and freeing everything that needs to be freed recursively.  New
  build time assertion should protect us from this problem if new actions will be added in the
  future.  Unfortunately, openvswitch module doesn''t use NLA_F_NESTED, so all attributes has
  to be explicitly checked.  sample() and clone() actions are mixing extra attributes into the
  user-provided action list.  That prevents some code generalization too.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.17.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.113-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
