advisory_id: linux/CVE-2024-49887
datasource_id: debian_importer_v2/linux/CVE-2024-49887
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-49887
aliases:
  - CVE-2024-49887
summary: 'In the Linux kernel, the following vulnerability has been resolved:  f2fs: fix to
  don''t panic system for no free segment fault injection  f2fs: fix to don''t panic system
  for no free segment fault injection  syzbot reports a f2fs bug as below:  F2FS-fs (loop0):
  inject no free segment in get_new_segment of __allocate_new_segment+0x1ce/0x940 fs/f2fs/segment.c:3167
  F2FS-fs (loop0): Stopped filesystem due to reason: 7 ------------[ cut here ]------------
  kernel BUG at fs/f2fs/segment.c:2748! CPU: 0 UID: 0 PID: 5109 Comm: syz-executor304 Not tainted
  6.11.0-rc6-syzkaller-00363-g89f5e14d05b4 #0 RIP: 0010:get_new_segment fs/f2fs/segment.c:2748
  [inline] RIP: 0010:new_curseg+0x1f61/0x1f70 fs/f2fs/segment.c:2836 Call Trace:  __allocate_new_segment+0x1ce/0x940
  fs/f2fs/segment.c:3167  f2fs_allocate_new_section fs/f2fs/segment.c:3181 [inline]  f2fs_allocate_pinning_section+0xfa/0x4e0
  fs/f2fs/segment.c:3195  f2fs_expand_inode_data+0x5d6/0xbb0 fs/f2fs/file.c:1799  f2fs_fallocate+0x448/0x960
  fs/f2fs/file.c:1903  vfs_fallocate+0x553/0x6c0 fs/open.c:334  do_vfs_ioctl+0x2592/0x2e50 fs/ioctl.c:886  __do_sys_ioctl
  fs/ioctl.c:905 [inline]  __se_sys_ioctl+0x81/0x170 fs/ioctl.c:893  do_syscall_x64 arch/x86/entry/common.c:52
  [inline]  do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83  entry_SYSCALL_64_after_hwframe+0x77/0x7f
  RIP: 0010:get_new_segment fs/f2fs/segment.c:2748 [inline] RIP: 0010:new_curseg+0x1f61/0x1f70
  fs/f2fs/segment.c:2836  The root cause is when we inject no free segment fault into f2fs,
  we should not panic system, fix it.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
