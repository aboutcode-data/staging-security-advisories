advisory_id: linux/CVE-2022-50422
datasource_id: debian_importer_v2/linux/CVE-2022-50422
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50422
aliases:
  - CVE-2022-50422
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: libsas:
  Fix use-after-free bug in smp_execute_task_sg()  When executing SMP task failed, the smp_execute_task_sg()
  calls del_timer() to delete "slow_task->timer". However, if the timer handler sas_task_internal_timedout()
  is running, the del_timer() in smp_execute_task_sg() will not stop it and a UAF will happen.
  The process is shown below:        (thread 1)               |        (thread 2) smp_execute_task_sg()          |
  sas_task_internal_timedout()  ...                           |  del_timer()                   |  ...                           |  ...  sas_free_task(task)           |   kfree(task->slow_task)
  //FREE|                                |  task->slow_task->... //USE  Fix by calling del_timer_sync()
  in smp_execute_task_sg(), which makes sure the timer handler have finished before the "task->slow_task"
  is deallocated.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
