advisory_id: linux/CVE-2025-21823
datasource_id: debian_importer_v2/linux/CVE-2025-21823
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-21823
aliases:
  - CVE-2025-21823
summary: 'In the Linux kernel, the following vulnerability has been resolved:  batman-adv: Drop
  unmanaged ELP metric worker  The ELP worker needs to calculate new metric values for all neighbors
  "reachable" over an interface. Some of the used metric sources require locks which might need
  to sleep. This sleep is incompatible with the RCU list iterator used for the recorded neighbors.
  The initial approach to work around of this problem was to queue another work item per neighbor
  and then run this in a new context.  Even when this solved the RCU vs might_sleep() conflict,
  it has a major problems: Nothing was stopping the work item in case it is not needed anymore
  - for example because one of the related interfaces was removed or the batman-adv module was
  unloaded - resulting in potential invalid memory accesses.  Directly canceling the metric
  worker also has various problems:  * cancel_work_sync for a to-be-deactivated interface is
  called with   rtnl_lock held. But the code in the ELP metric worker also tries to use   rtnl_lock()
  - which will never return in this case. This also means that   cancel_work_sync would never
  return because it is waiting for the worker   to finish. * iterating over the neighbor list
  for the to-be-deactivated interface is   currently done using the RCU specific methods. Which
  means that it is   possible to miss items when iterating over it without the associated   spinlock
  - a behaviour which is acceptable for a periodic metric check   but not for a cleanup routine
  (which must "stop" all still running   workers)  The better approch is to get rid of the per
  interface neighbor metric worker and handle everything in the interface worker. The original
  problems are solved by:  * creating a list of neighbors which require new metric information
  inside   the RCU protected context, gathering the metric according to the new list   outside
  the RCU protected context * only use rcu_trylock inside metric gathering code to avoid a deadlock   when
  the cancel_delayed_work_sync is called in the interface removal code   (which is called with
  the rtnl_lock held)'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.129-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.237-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.16-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
