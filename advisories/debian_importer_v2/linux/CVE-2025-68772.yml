advisory_id: linux/CVE-2025-68772
datasource_id: debian_importer_v2/linux/CVE-2025-68772
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68772
aliases:
  - CVE-2025-68772
summary: "In the Linux kernel, the following vulnerability has been resolved:  f2fs: fix to\
  \ avoid updating compression context during writeback  Bai, Shuangpeng <sjb7183@psu.edu> reported\
  \ a bug as below:  Oops: divide error: 0000 [#1] SMP KASAN PTI CPU: 0 UID: 0 PID: 11441 Comm:\
  \ syz.0.46 Not tainted 6.17.0 #1 PREEMPT(full) Hardware name: QEMU Standard PC (i440FX + PIIX,\
  \ 1996), BIOS 1.15.0-1 04/01/2014 RIP: 0010:f2fs_all_cluster_page_ready+0x106/0x550 fs/f2fs/compress.c:857\
  \ Call Trace:  <TASK>  f2fs_write_cache_pages fs/f2fs/data.c:3078 [inline]  __f2fs_write_data_pages\
  \ fs/f2fs/data.c:3290 [inline]  f2fs_write_data_pages+0x1c19/0x3600 fs/f2fs/data.c:3317  do_writepages+0x38e/0x640\
  \ mm/page-writeback.c:2634  filemap_fdatawrite_wbc mm/filemap.c:386 [inline]  __filemap_fdatawrite_range\
  \ mm/filemap.c:419 [inline]  file_write_and_wait_range+0x2ba/0x3e0 mm/filemap.c:794  f2fs_do_sync_file+0x6e6/0x1b00\
  \ fs/f2fs/file.c:294  generic_write_sync include/linux/fs.h:3043 [inline]  f2fs_file_write_iter+0x76e/0x2700\
  \ fs/f2fs/file.c:5259  new_sync_write fs/read_write.c:593 [inline]  vfs_write+0x7e9/0xe00\
  \ fs/read_write.c:686  ksys_write+0x19d/0x2d0 fs/read_write.c:738  do_syscall_x64 arch/x86/entry/syscall_64.c:63\
  \ [inline]  do_syscall_64+0xf7/0x470 arch/x86/entry/syscall_64.c:94  entry_SYSCALL_64_after_hwframe+0x77/0x7f\
  \  The bug was triggered w/ below race condition:  fsync\t\t\t\tsetattr\t\t\tioctl - f2fs_do_sync_file\
  \  - file_write_and_wait_range   - f2fs_write_cache_pages   : inode is non-compressed   :\
  \ cc.cluster_size =     F2FS_I(inode)->i_cluster_size = 0    - tag_pages_for_writeback \t\t\
  \t\t- f2fs_setattr \t\t\t\t - truncate_setsize \t\t\t\t - f2fs_truncate \t\t\t\t\t\t\t- f2fs_fileattr_set\
  \ \t\t\t\t\t\t\t - f2fs_setflags_common \t\t\t\t\t\t\t  - set_compress_context \t\t\t\t\t\t\
  \t  : F2FS_I(inode)->i_cluster_size = 4 \t\t\t\t\t\t\t  : set_inode_flag(inode, FI_COMPRESSED_FILE)\
  \    - f2fs_compressed_file    : return true    - f2fs_all_cluster_page_ready    : \"pgidx\
  \ % cc->cluster_size\" trigger dividing 0 issue  Let's change as below to fix this issue:\
  \ - introduce a new atomic type variable .writeback in structure f2fs_inode_info to track\
  \ the number of threads which calling f2fs_write_cache_pages(). - use .i_sem lock to protect\
  \ .writeback update. - check .writeback before update compression context in f2fs_setflags_common()\
  \ to avoid race w/ ->writepages."
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.162-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
