advisory_id: linux/CVE-2025-40028
datasource_id: debian_importer_v2/linux/CVE-2025-40028
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40028
aliases:
  - CVE-2025-40028
summary: 'In the Linux kernel, the following vulnerability has been resolved:  binder: fix double-free
  in dbitmap  A process might fail to allocate a new bitmap when trying to expand its proc->dmap.
  In that case, dbitmap_grow() fails and frees the old bitmap via dbitmap_free(). However, the
  driver calls dbitmap_free() again when the same process terminates, leading to a double-free
  error:    ==================================================================   BUG: KASAN:
  double-free in binder_proc_dec_tmpref+0x2e0/0x55c   Free of addr ffff00000b7c1420 by task
  kworker/9:1/209    CPU: 9 UID: 0 PID: 209 Comm: kworker/9:1 Not tainted 6.17.0-rc6-dirty #5
  PREEMPT   Hardware name: linux,dummy-virt (DT)   Workqueue: events binder_deferred_func   Call
  trace:    kfree+0x164/0x31c    binder_proc_dec_tmpref+0x2e0/0x55c    binder_deferred_func+0xc24/0x1120    process_one_work+0x520/0xba4   [...]    Allocated
  by task 448:    __kmalloc_noprof+0x178/0x3c0    bitmap_zalloc+0x24/0x30    binder_open+0x14c/0xc10   [...]    Freed
  by task 449:    kfree+0x184/0x31c    binder_inc_ref_for_node+0xb44/0xe44    binder_transaction+0x29b4/0x7fbc    binder_thread_write+0x1708/0x442c    binder_ioctl+0x1b50/0x2900   [...]   ==================================================================  Fix
  this issue by marking proc->map NULL in dbitmap_free().'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
