advisory_id: linux/CVE-2024-26840
datasource_id: debian_importer_v2/linux/CVE-2024-26840
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-26840
aliases:
  - CVE-2024-26840
summary: 'In the Linux kernel, the following vulnerability has been resolved:  cachefiles: fix
  memory leak in cachefiles_add_cache()  The following memory leak was reported after unbinding
  /dev/cachefiles:  ================================================================== unreferenced
  object 0xffff9b674176e3c0 (size 192):   comm "cachefilesd2", pid 680, jiffies 4294881224   hex
  dump (first 32 bytes):     01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................     00
  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................   backtrace (crc ea38a44b):     [<ffffffff8eb8a1a5>]
  kmem_cache_alloc+0x2d5/0x370     [<ffffffff8e917f86>] prepare_creds+0x26/0x2e0     [<ffffffffc002eeef>]
  cachefiles_determine_cache_security+0x1f/0x120     [<ffffffffc00243ec>] cachefiles_add_cache+0x13c/0x3a0     [<ffffffffc0025216>]
  cachefiles_daemon_write+0x146/0x1c0     [<ffffffff8ebc4a3b>] vfs_write+0xcb/0x520     [<ffffffff8ebc5069>]
  ksys_write+0x69/0xf0     [<ffffffff8f6d4662>] do_syscall_64+0x72/0x140     [<ffffffff8f8000aa>]
  entry_SYSCALL_64_after_hwframe+0x6e/0x76 ==================================================================  Put
  the reference count of cache_cred in cachefiles_daemon_unbind() to fix the problem. And also
  put cache_cred in cachefiles_add_cache() error branch to avoid memory leaks.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.82-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
