advisory_id: linux/CVE-2025-39878
datasource_id: debian_importer_v2/linux/CVE-2025-39878
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39878
aliases:
  - CVE-2025-39878
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ceph: fix crash
  after fscrypt_encrypt_pagecache_blocks() error  The function move_dirty_folio_in_page_array()
  was created by commit ce80b76dd327 ("ceph: introduce ceph_process_folio_batch() method") by
  moving code from ceph_writepages_start() to this function.  This new function is supposed
  to return an error code which is checked by the caller (now ceph_process_folio_batch()), and
  on error, the caller invokes redirty_page_for_writepage() and then breaks from the loop.  However,
  the refactoring commit has gone wrong, and it by accident, it always returns 0 (= success)
  because it first NULLs the pointer and then returns PTR_ERR(NULL) which is always 0.  This
  means errors are silently ignored, leaving NULL entries in the page array, which may later
  crash the kernel.  The simple solution is to call PTR_ERR() before clearing the pointer.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
