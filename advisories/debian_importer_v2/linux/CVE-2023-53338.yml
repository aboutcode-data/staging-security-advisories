advisory_id: linux/CVE-2023-53338
datasource_id: debian_importer_v2/linux/CVE-2023-53338
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-53338
aliases:
  - CVE-2023-53338
summary: 'In the Linux kernel, the following vulnerability has been resolved:  lwt: Fix return
  values of BPF xmit ops  BPF encap ops can return different types of positive values, such
  like NET_RX_DROP, NET_XMIT_CN, NETDEV_TX_BUSY, and so on, from function skb_do_redirect and
  bpf_lwt_xmit_reroute. At the xmit hook, such return values would be treated implicitly as
  LWTUNNEL_XMIT_CONTINUE in ip(6)_finish_output2. When this happens, skbs that have been freed
  would continue to the neighbor subsystem, causing use-after-free bug and kernel crashes.  To
  fix the incorrect behavior, skb_do_redirect return values can be simply discarded, the same
  as tc-egress behavior. On the other hand, bpf_lwt_xmit_reroute returns useful errors to local
  senders, e.g. PMTU information. Thus convert its return values to avoid the conflict with
  LWTUNNEL_XMIT_CONTINUE.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.55-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.197-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.5.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
