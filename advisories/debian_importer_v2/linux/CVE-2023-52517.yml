advisory_id: linux/CVE-2023-52517
datasource_id: debian_importer_v2/linux/CVE-2023-52517
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-52517
aliases:
  - CVE-2023-52517
summary: 'In the Linux kernel, the following vulnerability has been resolved:  spi: sun6i: fix
  race between DMA RX transfer completion and RX FIFO drain  Previously the transfer complete
  IRQ immediately drained to RX FIFO to read any data remaining in FIFO to the RX buffer. This
  behaviour is correct when dealing with SPI in interrupt mode. However in DMA mode the transfer
  complete interrupt still fires as soon as all bytes to be transferred have been stored in
  the FIFO. At that point data in the FIFO still needs to be picked up by the DMA engine. Thus
  the drain procedure and DMA engine end up racing to read from RX FIFO, corrupting any data
  read. Additionally the RX buffer pointer is never adjusted according to DMA progress in DMA
  mode, thus calling the RX FIFO drain procedure in DMA mode is a bug. Fix corruptions in DMA
  RX mode by draining RX FIFO only in interrupt mode. Also wait for completion of RX DMA when
  in DMA mode before returning to ensure all data has been copied to the supplied memory buffer.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.64-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.5.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
