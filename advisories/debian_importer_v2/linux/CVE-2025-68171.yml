advisory_id: linux/CVE-2025-68171
datasource_id: debian_importer_v2/linux/CVE-2025-68171
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68171
aliases:
  - CVE-2025-68171
summary: 'In the Linux kernel, the following vulnerability has been resolved:  x86/fpu: Ensure
  XFD state on signal delivery  Sean reported [1] the following splat when running KVM tests:     WARNING:
  CPU: 232 PID: 15391 at xfd_validate_state+0x65/0x70    Call Trace:     <TASK>     fpu__clear_user_states+0x9c/0x100     arch_do_signal_or_restart+0x142/0x210     exit_to_user_mode_loop+0x55/0x100     do_syscall_64+0x205/0x2c0     entry_SYSCALL_64_after_hwframe+0x4b/0x53  Chao
  further identified [2] a reproducible scenario involving signal delivery: a non-AMX task is
  preempted by an AMX-enabled task which modifies the XFD MSR.  When the non-AMX task resumes
  and reloads XSTATE with init values, a warning is triggered due to a mismatch between fpstate::xfd
  and the CPU''s current XFD state. fpu__clear_user_states() does not currently re-synchronize
  the XFD state after such preemption.  Invoke xfd_update_state() which detects and corrects
  the mismatch if there is a dynamic feature.  This also benefits the sigreturn path, as fpu__restore_sig()
  may call fpu__clear_user_states() when the sigframe is inaccessible.  [ dhansen: minor changelog
  munging ]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
