advisory_id: linux/CVE-2024-40913
datasource_id: debian_importer_v2/linux/CVE-2024-40913
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-40913
aliases:
  - CVE-2024-40913
summary: 'In the Linux kernel, the following vulnerability has been resolved:  cachefiles: defer
  exposing anon_fd until after copy_to_user() succeeds  After installing the anonymous fd, we
  can now see it in userland and close it. However, at this point we may not have gotten the
  reference count of the cache, but we will put it during colse fd, so this may cause a cache
  UAF.  So grab the cache reference count before fd_install(). In addition, by kernel convention,
  fd is taken over by the user land after fd_install(), and the kernel should not call close_fd()
  after that, i.e., it should call fd_install() after everything is ready, thus fd_install()
  is called after copy_to_user() succeeds.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.99-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
