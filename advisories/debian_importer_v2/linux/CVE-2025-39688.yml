advisory_id: linux/CVE-2025-39688
datasource_id: debian_importer_v2/linux/CVE-2025-39688
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39688
aliases:
  - CVE-2025-39688
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nfsd: allow SC_STATUS_FREEABLE
  when searching via nfs4_lookup_stateid()  The pynfs DELEG8 test fails when run against nfsd.
  It acquires a delegation and then lets the lease time out. It then tries to use the deleg
  stateid and expects to see NFS4ERR_DELEG_REVOKED, but it gets bad NFS4ERR_BAD_STATEID instead.  When
  a delegation is revoked, it''s initially marked with SC_STATUS_REVOKED, or SC_STATUS_ADMIN_REVOKED
  and later, it''s marked with the SC_STATUS_FREEABLE flag, which denotes that it is waiting
  for s FREE_STATEID call.  nfs4_lookup_stateid() accepts a statusmask that includes the status
  flags that a found stateid is allowed to have. Currently, that mask never includes SC_STATUS_FREEABLE,
  which means that revoked delegations are (almost) never found.  Add SC_STATUS_FREEABLE to
  the always-allowed status flags, and remove it from nfsd4_delegreturn() since it''s now always
  implied.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.25-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
