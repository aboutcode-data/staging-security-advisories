advisory_id: linux/CVE-2024-47740
datasource_id: debian_importer_v2/linux/CVE-2024-47740
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-47740
aliases:
  - CVE-2024-47740
summary: 'In the Linux kernel, the following vulnerability has been resolved:  f2fs: Require
  FMODE_WRITE for atomic write ioctls  The F2FS ioctls for starting and committing atomic writes
  check for inode_owner_or_capable(), but this does not give LSMs like SELinux or Landlock an
  opportunity to deny the write access - if the caller''s FSUID matches the inode''s UID, inode_owner_or_capable()
  immediately returns true.  There are scenarios where LSMs want to deny a process the ability
  to write particular files, even files that the FSUID of the process owns; but this can currently
  partially be bypassed using atomic write ioctls in two ways:   - F2FS_IOC_START_ATOMIC_REPLACE
  + F2FS_IOC_COMMIT_ATOMIC_WRITE can    truncate an inode to size 0  - F2FS_IOC_START_ATOMIC_WRITE
  + F2FS_IOC_ABORT_ATOMIC_WRITE can revert    changes another process concurrently made to a
  file  Fix it by requiring FMODE_WRITE for these operations, just like for F2FS_IOC_MOVE_RANGE.
  Since any legitimate caller should only be using these ioctls when intending to write into
  the file, that seems unlikely to break anything.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.115-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.234-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
