advisory_id: linux/CVE-2022-50005
datasource_id: debian_importer_v2/linux/CVE-2022-50005
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-50005
aliases:
  - CVE-2022-50005
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nfc: pn533: Fix
  use-after-free bugs caused by pn532_cmd_timeout  When the pn532 uart device is detaching,
  the pn532_uart_remove() is called. But there are no functions in pn532_uart_remove() that
  could delete the cmd_timeout timer, which will cause use-after-free bugs. The process is shown
  below:      (thread 1)                  |        (thread 2)                                 |  pn532_uart_send_frame
  pn532_uart_remove               |    mod_timer(&pn532->cmd_timeout,...)   ...                           |    (wait
  a time)   kfree(pn532) //FREE           |    pn532_cmd_timeout                                 |      pn532_uart_send_frame                                 |        pn532->...
  //USE  This patch adds del_timer_sync() in pn532_uart_remove() in order to prevent the use-after-free
  bugs. What''s more, the pn53x_unregister_nfc() is well synchronized, it sets nfc_dev->shutting_down
  to true and there are no syscalls could restart the cmd_timeout timer.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.140-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
