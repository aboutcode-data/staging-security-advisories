advisory_id: linux/CVE-2023-52447
datasource_id: debian_importer_v2/linux/CVE-2023-52447
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-52447
aliases:
  - CVE-2023-52447
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: Defer the
  free of inner map when necessary  When updating or deleting an inner map in map array or map
  htab, the map may still be accessed by non-sleepable program or sleepable program. However
  bpf_map_fd_put_ptr() decreases the ref-counter of the inner map directly through bpf_map_put(),
  if the ref-counter is the last one (which is true for most cases), the inner map will be freed
  by ops->map_free() in a kworker. But for now, most .map_free() callbacks don''t use synchronize_rcu()
  or its variants to wait for the elapse of a RCU grace period, so after the invocation of ops->map_free
  completes, the bpf program which is accessing the inner map may incur use-after-free problem.  Fix
  the free of inner map by invoking bpf_map_free_deferred() after both one RCU grace period
  and one tasks trace RCU grace period if the inner map has been removed from the outer map
  before. The deferment is accomplished by using call_rcu() or call_rcu_tasks_trace() when releasing
  the last ref-counter of bpf map. The newly-added rcu_head field in bpf_map shares the same
  storage space with work field to reduce the size of bpf_map.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.76-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.6.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
