advisory_id: linux/CVE-2023-52503
datasource_id: debian_importer_v2/linux/CVE-2023-52503
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-52503
aliases:
  - CVE-2023-52503
summary: 'In the Linux kernel, the following vulnerability has been resolved:  tee: amdtee:
  fix use-after-free vulnerability in amdtee_close_session  There is a potential race condition
  in amdtee_close_session that may cause use-after-free in amdtee_open_session. For instance,
  if a session has refcount == 1, and one thread tries to free this session via:      kref_put(&sess->refcount,
  destroy_session);  the reference count will get decremented, and the next step would be to
  call destroy_session(). However, if in another thread, amdtee_open_session() is called before
  destroy_session() has completed execution, alloc_session() may return ''sess'' that will be
  freed up later in destroy_session() leading to use-after-free in amdtee_open_session.  To
  fix this issue, treat decrement of sess->refcount and removal of ''sess'' from session list
  in destroy_session() as a critical section, so that it is executed atomically.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.64-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.205-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.5.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
