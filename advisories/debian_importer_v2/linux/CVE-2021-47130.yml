advisory_id: linux/CVE-2021-47130
datasource_id: debian_importer_v2/linux/CVE-2021-47130
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47130
aliases:
  - CVE-2021-47130
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nvmet: fix freeing
  unallocated p2pmem  In case p2p device was found but the p2p pool is empty, the nvme target
  is still trying to free the sgl from the p2p pool instead of the regular sgl pool and causing
  a crash (BUG() is called). Instead, assign the p2p_dev for the request only if it was allocated
  from p2p pool.  This is the crash that was caused:  [Sun May 30 19:13:53 2021] ------------[
  cut here ]------------ [Sun May 30 19:13:53 2021] kernel BUG at lib/genalloc.c:518! [Sun May
  30 19:13:53 2021] invalid opcode: 0000 [#1] SMP PTI ... [Sun May 30 19:13:53 2021] kernel
  BUG at lib/genalloc.c:518! ... [Sun May 30 19:13:53 2021] RIP: 0010:gen_pool_free_owner+0xa8/0xb0
  ... [Sun May 30 19:13:53 2021] Call Trace: [Sun May 30 19:13:53 2021] ------------[ cut here
  ]------------ [Sun May 30 19:13:53 2021]  pci_free_p2pmem+0x2b/0x70 [Sun May 30 19:13:53 2021]  pci_p2pmem_free_sgl+0x4f/0x80
  [Sun May 30 19:13:53 2021]  nvmet_req_free_sgls+0x1e/0x80 [nvmet] [Sun May 30 19:13:53 2021]
  kernel BUG at lib/genalloc.c:518! [Sun May 30 19:13:53 2021]  nvmet_rdma_release_rsp+0x4e/0x1f0
  [nvmet_rdma] [Sun May 30 19:13:53 2021]  nvmet_rdma_send_done+0x1c/0x60 [nvmet_rdma]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.46-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
