advisory_id: linux/CVE-2022-49755
datasource_id: debian_importer_v2/linux/CVE-2022-49755
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49755
aliases:
  - CVE-2022-49755
summary: 'In the Linux kernel, the following vulnerability has been resolved:  usb: gadget:
  f_fs: Prevent race during ffs_ep0_queue_wait  While performing fast composition switch, there
  is a possibility that the process of ffs_ep0_write/ffs_ep0_read get into a race condition
  due to ep0req being freed up from functionfs_unbind.  Consider the scenario that the ffs_ep0_write
  calls the ffs_ep0_queue_wait by taking a lock &ffs->ev.waitq.lock. However, the functionfs_unbind
  isn''t bounded so it can go ahead and mark the ep0req to NULL, and since there is no NULL
  check in ffs_ep0_queue_wait we will end up in use-after-free.  Fix this by making a serialized
  execution between the two functions using a mutex_lock(ffs->mutex).'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.178-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
