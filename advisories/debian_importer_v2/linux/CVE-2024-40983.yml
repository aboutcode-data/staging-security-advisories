advisory_id: linux/CVE-2024-40983
datasource_id: debian_importer_v2/linux/CVE-2024-40983
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-40983
aliases:
  - CVE-2024-40983
summary: 'In the Linux kernel, the following vulnerability has been resolved:  tipc: force a
  dst refcount before doing decryption  As it says in commit 3bc07321ccc2 ("xfrm: Force a dst
  refcount before entering the xfrm type handlers"):  "Crypto requests might return asynchronous.
  In this case we leave the  rcu protected region, so force a refcount on the skb''s destination  entry
  before we enter the xfrm type input/output handlers."  On TIPC decryption path it has the
  same problem, and skb_dst_force() should be called before doing decryption to avoid a possible
  crash.  Shuang reported this issue when this warning is triggered:    [] WARNING: include/net/dst.h:337
  tipc_sk_rcv+0x1055/0x1ea0 [tipc]   [] Kdump: loaded Tainted: G W --------- - - 4.18.0-496.el8.x86_64+debug   []
  Workqueue: crypto cryptd_queue_worker   [] RIP: 0010:tipc_sk_rcv+0x1055/0x1ea0 [tipc]   []
  Call Trace:   [] tipc_sk_mcast_rcv+0x548/0xea0 [tipc]   [] tipc_rcv+0xcf5/0x1060 [tipc]   []
  tipc_aead_decrypt_done+0x215/0x2e0 [tipc]   [] cryptd_aead_crypt+0xdb/0x190   [] cryptd_queue_worker+0xed/0x190   []
  process_one_work+0x93d/0x17e0'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.99-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.221-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
