advisory_id: linux/CVE-2025-68768
datasource_id: debian_importer_v2/linux/CVE-2025-68768
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68768
aliases:
  - CVE-2025-68768
summary: 'In the Linux kernel, the following vulnerability has been resolved:  inet: frags:
  flush pending skbs in fqdir_pre_exit()  We have been seeing occasional deadlocks on pernet_ops_rwsem
  since September in NIPA. The stuck task was usually modprobe (often loading a driver like
  ipvlan), trying to take the lock as a Writer. lockdep does not track readers for rwsems so
  the read wasn''t obvious from the reports.  On closer inspection the Reader holding the lock
  was conntrack looping forever in nf_conntrack_cleanup_net_list(). Based on past experience
  with occasional NIPA crashes I looked thru the tests which run before the crash and noticed
  that the crash follows ip_defrag.sh. An immediate red flag. Scouring thru (de)fragmentation
  queues reveals skbs sitting around, holding conntrack references.  The problem is that since
  conntrack depends on nf_defrag_ipv6, nf_defrag_ipv6 will load first. Since nf_defrag_ipv6
  loads first its netns exit hooks run _after_ conntrack''s netns exit hook.  Flush all fragment
  queue SKBs during fqdir_pre_exit() to release conntrack references before conntrack cleanup
  runs. Also flush the queues in timer expiry handlers when they discover fqdir->dead is set,
  in case packet sneaks in while we''re running the pre_exit flush.  The commit under Fixes
  is not exactly the culprit, but I think previously the timer firing would eventually unblock
  the spinning conntrack.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/6.18.3-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
