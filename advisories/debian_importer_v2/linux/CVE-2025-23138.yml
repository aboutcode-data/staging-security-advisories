advisory_id: linux/CVE-2025-23138
datasource_id: debian_importer_v2/linux/CVE-2025-23138
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-23138
aliases:
  - CVE-2025-23138
summary: 'In the Linux kernel, the following vulnerability has been resolved:  watch_queue:
  fix pipe accounting mismatch  Currently, watch_queue_set_size() modifies the pipe buffers
  charged to user->pipe_bufs without updating the pipe->nr_accounted on the pipe itself, due
  to the if (!pipe_has_watch_queue()) test in pipe_resize_ring(). This means that when the pipe
  is ultimately freed, we decrement user->pipe_bufs by something other than what than we had
  charged to it, potentially leading to an underflow. This in turn can cause subsequent too_many_pipe_buffers_soft()
  tests to fail with -EPERM.  To remedy this, explicitly account for the pipe usage in watch_queue_set_size()
  to match the number set via account_pipe_buffers()  (It''s unclear why watch_queue_set_size()
  does not update nr_accounted; it may be due to intentional overprovisioning in watch_queue_set_size()?)'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.135-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.237-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.25-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
