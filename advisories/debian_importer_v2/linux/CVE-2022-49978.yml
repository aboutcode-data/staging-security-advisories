advisory_id: linux/CVE-2022-49978
datasource_id: debian_importer_v2/linux/CVE-2022-49978
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49978
aliases:
  - CVE-2022-49978
summary: 'In the Linux kernel, the following vulnerability has been resolved:  fbdev: fb_pm2fb:
  Avoid potential divide by zero error  In `do_fb_ioctl()` of fbmem.c, if cmd is FBIOPUT_VSCREENINFO,
  var will be copied from user, then go through `fb_set_var()` and `info->fbops->fb_check_var()`
  which could may be `pm2fb_check_var()`. Along the path, `var->pixclock` won''t be modified.
  This function checks whether reciprocal of `var->pixclock` is too high. If `var->pixclock`
  is zero, there will be a divide by zero error. So, it is necessary to check whether denominator
  is zero to avoid crash. As this bug is found by Syzkaller, logs are listed below.  divide
  error in pm2fb_check_var Call Trace:  <TASK>  fb_set_var+0x367/0xeb0 drivers/video/fbdev/core/fbmem.c:1015  do_fb_ioctl+0x234/0x670
  drivers/video/fbdev/core/fbmem.c:1110  fb_ioctl+0xdd/0x130 drivers/video/fbdev/core/fbmem.c:1189'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.148-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
