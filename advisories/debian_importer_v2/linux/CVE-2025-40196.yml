advisory_id: linux/CVE-2025-40196
datasource_id: debian_importer_v2/linux/CVE-2025-40196
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40196
aliases:
  - CVE-2025-40196
summary: 'In the Linux kernel, the following vulnerability has been resolved:  fs: quota: create
  dedicated workqueue for quota_release_work  There is a kernel panic due to WARN_ONCE when
  panic_on_warn is set.  This issue occurs when writeback is triggered due to sync call for
  an opened file(ie, writeback reason is WB_REASON_SYNC). When f2fs balance is needed at sync
  path, flush for quota_release_work is triggered. By default quota_release_work is queued to
  "events_unbound" queue which does not have WQ_MEM_RECLAIM flag. During f2fs balance "writeback"
  workqueue tries to flush quota_release_work causing kernel panic due to MEM_RECLAIM flag mismatch
  errors.  This patch creates dedicated workqueue with WQ_MEM_RECLAIM flag for work quota_release_work.  ------------[
  cut here ]------------ WARNING: CPU: 4 PID: 14867 at kernel/workqueue.c:3721 check_flush_dependency+0x13c/0x148
  Call trace:  check_flush_dependency+0x13c/0x148  __flush_work+0xd0/0x398  flush_delayed_work+0x44/0x5c  dquot_writeback_dquots+0x54/0x318  f2fs_do_quota_sync+0xb8/0x1a8  f2fs_write_checkpoint+0x3cc/0x99c  f2fs_gc+0x190/0x750  f2fs_balance_fs+0x110/0x168  f2fs_write_single_data_page+0x474/0x7dc  f2fs_write_data_pages+0x7d0/0xd0c  do_writepages+0xe0/0x2f4  __writeback_single_inode+0x44/0x4ac  writeback_sb_inodes+0x30c/0x538  wb_writeback+0xf4/0x440  wb_workfn+0x128/0x5d4  process_scheduled_works+0x1c4/0x45c  worker_thread+0x32c/0x3e8  kthread+0x11c/0x1b0  ret_from_fork+0x10/0x20
  Kernel panic - not syncing: kernel: panic_on_warn set ...'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
