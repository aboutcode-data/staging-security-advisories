advisory_id: linux/CVE-2025-68211
datasource_id: debian_importer_v2/linux/CVE-2025-68211
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68211
aliases:
  - CVE-2025-68211
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ksm: use range-walk
  function to jump over holes in scan_get_next_rmap_item  Currently, scan_get_next_rmap_item()
  walks every page address in a VMA to locate mergeable pages.  This becomes highly inefficient
  when scanning large virtual memory areas that contain mostly unmapped regions, causing ksmd
  to use large amount of cpu without deduplicating much pages.  This patch replaces the per-address
  lookup with a range walk using walk_page_range().  The range walker allows KSM to skip over
  entire unmapped holes in a VMA, avoiding unnecessary lookups.  This problem was previously
  discussed in [1].  Consider the following test program which creates a 32 TiB mapping in the
  virtual address space but only populates a single page:  #include <unistd.h> #include <stdio.h>
  #include <sys/mman.h>  /* 32 TiB */ const size_t size = 32ul * 1024 * 1024 * 1024 * 1024;  int
  main() {         char *area = mmap(NULL, size, PROT_READ | PROT_WRITE,                           MAP_NORESERVE
  | MAP_PRIVATE | MAP_ANON, -1, 0);          if (area == MAP_FAILED) {                 perror("mmap()
  failed\n");                 return -1;         }          /* Populate a single page such that
  we get an anon_vma. */         *area = 0;          /* Enable KSM. */         madvise(area,
  size, MADV_MERGEABLE);         pause();         return 0; }  $ ./ksm-sparse  & $ echo 1 >
  /sys/kernel/mm/ksm/run   Without this patch ksmd uses 100% of the cpu for a long time (more
  then 1 hour in my test machine) scanning all the 32 TiB virtual address space that contain
  only one mapped page.  This makes ksmd essentially deadlocked not able to deduplicate anything
  of value.  With this patch ksmd walks only the one mapped page and skips the rest of the 32
  TiB virtual address space, making the scan fast using little cpu.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.162-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.249-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
