advisory_id: linux/CVE-2025-38048
datasource_id: debian_importer_v2/linux/CVE-2025-38048
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38048
aliases:
  - CVE-2025-38048
summary: 'In the Linux kernel, the following vulnerability has been resolved:  virtio_ring:
  Fix data race by tagging event_triggered as racy for KCSAN  syzbot reports a data-race when
  accessing the event_triggered, here is the simplified stack when the issue occurred:  ==================================================================
  BUG: KCSAN: data-race in virtqueue_disable_cb / virtqueue_enable_cb_delayed  write to 0xffff8881025bc452
  of 1 bytes by task 3288 on cpu 0:  virtqueue_enable_cb_delayed+0x42/0x3c0 drivers/virtio/virtio_ring.c:2653  start_xmit+0x230/0x1310
  drivers/net/virtio_net.c:3264  __netdev_start_xmit include/linux/netdevice.h:5151 [inline]  netdev_start_xmit
  include/linux/netdevice.h:5160 [inline]  xmit_one net/core/dev.c:3800 [inline]  read to 0xffff8881025bc452
  of 1 bytes by interrupt on cpu 1:  virtqueue_disable_cb_split drivers/virtio/virtio_ring.c:880
  [inline]  virtqueue_disable_cb+0x92/0x180 drivers/virtio/virtio_ring.c:2566  skb_xmit_done+0x5f/0x140
  drivers/net/virtio_net.c:777  vring_interrupt+0x161/0x190 drivers/virtio/virtio_ring.c:2715  __handle_irq_event_percpu+0x95/0x490
  kernel/irq/handle.c:158  handle_irq_event_percpu kernel/irq/handle.c:193 [inline]  value changed:
  0x01 -> 0x00 ==================================================================  When the
  data race occurs, the function virtqueue_enable_cb_delayed() sets event_triggered to false,
  and virtqueue_disable_cb_split/packed() reads it as false due to the race condition. Since
  event_triggered is an unreliable hint used for optimization, this should only cause the driver
  temporarily suggest that the device not send an interrupt notification when the event index
  is used.  Fix this KCSAN reported data-race issue by explicitly tagging the access as data_racy.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.147-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.32-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
