advisory_id: linux/CVE-2024-26748
datasource_id: debian_importer_v2/linux/CVE-2024-26748
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-26748
aliases:
  - CVE-2024-26748
summary: 'In the Linux kernel, the following vulnerability has been resolved:  usb: cdns3: fix
  memory double free when handle zero packet  829  if (request->complete) { 830          spin_unlock(&priv_dev->lock);
  831          usb_gadget_giveback_request(&priv_ep->endpoint, 832                                    request);
  833          spin_lock(&priv_dev->lock); 834  } 835 836  if (request->buf == priv_dev->zlp_buf)
  837      cdns3_gadget_ep_free_request(&priv_ep->endpoint, request);  Driver append an additional
  zero packet request when queue a packet, which length mod max packet size is 0. When transfer
  complete, run to line 831, usb_gadget_giveback_request() will free this requestion. 836 condition
  is true, so cdns3_gadget_ep_free_request() free this request again.  Log:  [ 1920.140696][  T150]
  BUG: KFENCE: use-after-free read in cdns3_gadget_giveback+0x134/0x2c0 [cdns3] [ 1920.140696][  T150]
  [ 1920.151837][  T150] Use-after-free read at 0x000000003d1cd10b (in kfence-#36): [ 1920.159082][  T150]  cdns3_gadget_giveback+0x134/0x2c0
  [cdns3] [ 1920.164988][  T150]  cdns3_transfer_completed+0x438/0x5f8 [cdns3]  Add check at
  line 829, skip call usb_gadget_giveback_request() if it is additional zero length packet request.
  Needn''t call usb_gadget_giveback_request() because it is allocated in this driver.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.82-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.216-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
