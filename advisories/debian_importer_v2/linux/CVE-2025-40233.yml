advisory_id: linux/CVE-2025-40233
datasource_id: debian_importer_v2/linux/CVE-2025-40233
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40233
aliases:
  - CVE-2025-40233
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ocfs2: clear
  extent cache after moving/defragmenting extents  The extent map cache can become stale when
  extents are moved or defragmented, causing subsequent operations to see outdated extent flags.  This
  triggers a BUG_ON in ocfs2_refcount_cal_cow_clusters().  The problem occurs when: 1. copy_file_range()
  creates a reflinked extent with OCFS2_EXT_REFCOUNTED 2. ioctl(FITRIM) triggers ocfs2_move_extents()
  3. __ocfs2_move_extents_range() reads and caches the extent (flags=0x2) 4. ocfs2_move_extent()/ocfs2_defrag_extent()
  calls __ocfs2_move_extent()    which clears OCFS2_EXT_REFCOUNTED flag on disk (flags=0x0)
  5. The extent map cache is not invalidated after the move 6. Later write() operations read
  stale cached flags (0x2) but disk has    updated flags (0x0), causing a mismatch 7. BUG_ON(!(rec->e_flags
  & OCFS2_EXT_REFCOUNTED)) triggers  Fix by clearing the extent map cache after each extent
  move/defrag operation in __ocfs2_move_extents_range().  This ensures subsequent operations
  read fresh extent data from disk.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.247-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
