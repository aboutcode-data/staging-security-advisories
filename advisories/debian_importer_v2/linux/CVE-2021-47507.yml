advisory_id: linux/CVE-2021-47507
datasource_id: debian_importer_v2/linux/CVE-2021-47507
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47507
aliases:
  - CVE-2021-47507
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nfsd: Fix nsfd
  startup race (again)  Commit bd5ae9288d64 ("nfsd: register pernet ops last, unregister first")
  has re-opened rpc_pipefs_event() race against nfsd_net_id registration (register_pernet_subsys())
  which has been fixed by commit bb7ffbf29e76 ("nfsd: fix nsfd startup race triggering BUG_ON").  Restore
  the order of register_pernet_subsys() vs register_cld_notifier(). Add WARN_ON() to prevent
  a future regression.  Crash info: Unable to handle kernel NULL pointer dereference at virtual
  address 0000000000000012 CPU: 8 PID: 345 Comm: mount Not tainted 5.4.144-... #1 pc : rpc_pipefs_event+0x54/0x120
  [nfsd] lr : rpc_pipefs_event+0x48/0x120 [nfsd] Call trace:  rpc_pipefs_event+0x54/0x120 [nfsd]  blocking_notifier_call_chain  rpc_fill_super  get_tree_keyed  rpc_fs_get_tree  vfs_get_tree  do_mount  ksys_mount  __arm64_sys_mount  el0_svc_handler  el0_svc'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.15.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.92-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
