advisory_id: linux/CVE-2023-54012
datasource_id: debian_importer_v2/linux/CVE-2023-54012
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54012
aliases:
  - CVE-2023-54012
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: fix stack
  overflow when LRO is disabled for virtual interfaces  When the virtual interface''s feature
  is updated, it synchronizes the updated feature for its own lower interface. This propagation
  logic should be worked as the iteration, not recursively. But it works recursively due to
  the netdev notification unexpectedly. This problem occurs when it disables LRO only for the
  team and bonding interface type.         team0          |   +------+------+-----+-----+   |      |      |     |     |
  team1  team2  team3  ...  team200  If team0''s LRO feature is updated, it generates the NETDEV_FEAT_CHANGE
  event to its own lower interfaces(team1 ~ team200). It is worked by netdev_sync_lower_features().
  So, the NETDEV_FEAT_CHANGE notification logic of each lower interface work iteratively. But
  generated NETDEV_FEAT_CHANGE event is also sent to the upper interface too. upper interface(team0)
  generates the NETDEV_FEAT_CHANGE event for its own lower interfaces again. lower and upper
  interfaces receive this event and generate this event again and again. So, the stack overflow
  occurs.  But it is not the infinite loop issue. Because the netdev_sync_lower_features() updates
  features before generating the NETDEV_FEAT_CHANGE event. Already synchronized lower interfaces
  skip notification logic. So, it is just the problem that iteration logic is changed to the
  recursive unexpectedly due to the notification mechanism.  Reproducer:  ip link add team0
  type team ethtool -K team0 lro on for i in {1..200} do         ip link add team$i master team0
  type team         ethtool -K team$i lro on done  ethtool -K team0 lro off  In order to fix
  it, the notifier_ctx member of bonding/team is introduced.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.37-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.191-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.3.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
