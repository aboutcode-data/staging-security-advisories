advisory_id: linux/CVE-2025-39835
datasource_id: debian_importer_v2/linux/CVE-2025-39835
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39835
aliases:
  - CVE-2025-39835
summary: "In the Linux kernel, the following vulnerability has been resolved:  xfs: do not propagate\
  \ ENODATA disk errors into xattr code  ENODATA (aka ENOATTR) has a very specific meaning in\
  \ the xfs xattr code; namely, that the requested attribute name could not be found.  However,\
  \ a medium error from disk may also return ENODATA. At best, this medium error may escape\
  \ to userspace as \"attribute not found\" when in fact it's an IO (disk) error.  At worst,\
  \ we may oops in xfs_attr_leaf_get() when we do:  \terror = xfs_attr_leaf_hasname(args, &bp);\
  \ \tif (error == -ENOATTR)  { \t\txfs_trans_brelse(args->trans, bp); \t\treturn error; \t\
  }  because an ENODATA/ENOATTR error from disk leaves us with a null bp, and the xfs_trans_brelse\
  \ will then null-deref it.  As discussed on the list, we really need to modify the lower level\
  \ IO functions to trap all disk errors and ensure that we don't let unique errors like this\
  \ leak up into higher xfs functions - many like this should be remapped to EIO.  However,\
  \ this patch directly addresses a reported bug in the xattr code, and should be safe to backport\
  \ to stable kernels. A larger-scope patch to handle more unique errors at lower levels can\
  \ follow later.  (Note, prior to 07120f1abdff we did not oops, but we did return the wrong\
  \ error code to userspace.)"
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.153-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.16.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.48-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
