advisory_id: linux/CVE-2023-54324
datasource_id: debian_importer_v2/linux/CVE-2023-54324
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-54324
aliases:
  - CVE-2023-54324
summary: 'In the Linux kernel, the following vulnerability has been resolved:  dm: fix a race
  condition in retrieve_deps  There''s a race condition in the multipath target when retrieve_deps
  races with multipath_message calling dm_get_device and dm_put_device. retrieve_deps walks
  the list of open devices without holding any lock but multipath may add or remove devices
  to the list while it is running. The end result may be memory corruption or use-after-free
  memory access.  See this description of a UAF with multipath_message(): https://listman.redhat.com/archives/dm-devel/2022-October/052373.html  Fix
  this bug by introducing a new rw semaphore "devices_lock". We grab devices_lock for read in
  retrieve_deps and we grab it for write in dm_get_device and dm_put_device.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.64-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.5.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
