advisory_id: linux/CVE-2021-47309
datasource_id: debian_importer_v2/linux/CVE-2021-47309
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47309
aliases:
  - CVE-2021-47309
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: validate
  lwtstate->data before returning from skb_tunnel_info()  skb_tunnel_info() returns pointer
  of lwtstate->data as ip_tunnel_info type without validation. lwtstate->data can have various
  types such as mpls_iptunnel_encap, etc and these are not compatible. So skb_tunnel_info()
  should validate before returning that pointer.  Splat looks like: BUG: KASAN: slab-out-of-bounds
  in vxlan_get_route+0x418/0x4b0 [vxlan] Read of size 2 at addr ffff888106ec2698 by task ping/811  CPU:
  1 PID: 811 Comm: ping Not tainted 5.13.0+ #1195 Call Trace:  dump_stack_lvl+0x56/0x7b  print_address_description.constprop.8.cold.13+0x13/0x2ee  ?
  vxlan_get_route+0x418/0x4b0 [vxlan]  ? vxlan_get_route+0x418/0x4b0 [vxlan]  kasan_report.cold.14+0x83/0xdf  ?
  vxlan_get_route+0x418/0x4b0 [vxlan]  vxlan_get_route+0x418/0x4b0 [vxlan]  [ ... ]  vxlan_xmit_one+0x148b/0x32b0
  [vxlan]  [ ... ]  vxlan_xmit+0x25c5/0x4780 [vxlan]  [ ... ]  dev_hard_start_xmit+0x1ae/0x6e0  __dev_queue_xmit+0x1f39/0x31a0  [
  ... ]  neigh_xmit+0x2f9/0x940  mpls_xmit+0x911/0x1600 [mpls_iptunnel]  lwtunnel_xmit+0x18f/0x450  ip_finish_output2+0x867/0x2040  [
  ... ]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.14.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.70-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
