advisory_id: linux/CVE-2023-52609
datasource_id: debian_importer_v2/linux/CVE-2023-52609
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-52609
aliases:
  - CVE-2023-52609
summary: 'In the Linux kernel, the following vulnerability has been resolved:  binder: fix race
  between mmput() and do_exit()  Task A calls binder_update_page_range() to allocate and insert
  pages on a remote address space from Task B. For this, Task A pins the remote mm via mmget_not_zero()
  first. This can race with Task B do_exit() and the final mmput() refcount decrement will come
  from Task A.    Task A            | Task B   ------------------+------------------   mmget_not_zero()  |                     |  do_exit()                     |    exit_mm()                     |      mmput()   mmput()           |     exit_mmap()     |       remove_vma()  |         fput()      |  In
  this case, the work of ____fput() from Task B is queued up in Task A as TWA_RESUME. So in
  theory, Task A returns to userspace and the cleanup work gets executed. However, Task A instead
  sleep, waiting for a reply from Task B that never comes (it''s dead).  This means the binder_deferred_release()
  is blocked until an unrelated binder event forces Task A to go back to userspace. All the
  associated death notifications will also be delayed until then.  In order to fix this use
  mmput_async() that will schedule the work in the corresponding mm->async_put_work WQ instead
  of Task A.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.76-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.209-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.6.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
