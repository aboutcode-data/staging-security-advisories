advisory_id: linux/CVE-2025-40241
datasource_id: debian_importer_v2/linux/CVE-2025-40241
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40241
aliases:
  - CVE-2025-40241
summary: 'In the Linux kernel, the following vulnerability has been resolved:  erofs: fix crafted
  invalid cases for encoded extents  Robert recently reported two corrupted images that can
  cause system crashes, which are related to the new encoded extents introduced in Linux 6.15:    -
  The first one [1] has plen != 0 (e.g. plen == 0x2000000) but     (plen & Z_EROFS_EXTENT_PLEN_MASK)
  == 0. It is used to represent     special extents such as sparse extents (!EROFS_MAP_MAPPED),
  but     previously only plen == 0 was handled;    - The second one [2] has pa 0xffffffffffdcffed
  and plen 0xb4000,     then "cur [0xfffffffffffff000] += bvec.bv_len [0x1000]" in     "} while
  ((cur += bvec.bv_len) < end);" wraps around, causing an     out-of-bound access of pcl->compressed_bvecs[]
  in     z_erofs_submit_queue().  EROFS only supports 48-bit physical block     addresses (up
  to 1EiB for 4k blocks), so add a sanity check to     enforce this.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
