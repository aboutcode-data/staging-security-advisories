advisory_id: linux/CVE-2025-38001
datasource_id: debian_importer_v2/linux/CVE-2025-38001
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38001
aliases:
  - CVE-2025-38001
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net_sched: hfsc:
  Address reentrant enqueue adding class to eltree twice  Savino says:     "We are writing to
  report that this recent patch     (141d34391abbb315d68556b7c67ad97885407547) [1]     can be
  bypassed, and a UAF can still occur when HFSC is utilized with     NETEM.      The patch only
  checks the cl->cl_nactive field to determine whether     it is the first insertion or not
  [2], but this field is only     incremented by init_vf [3].      By using HFSC_RSC (which
  uses init_ed) [4], it is possible to bypass the     check and insert the class twice in the
  eltree.     Under normal conditions, this would lead to an infinite loop in     hfsc_dequeue
  for the reasons we already explained in this report [5].      However, if TBF is added as
  root qdisc and it is configured with a     very low rate,     it can be utilized to prevent
  packets from being dequeued.     This behavior can be exploited to perform subsequent insertions
  in the     HFSC eltree and cause a UAF."  To fix both the UAF and the infinite loop, with
  netem as an hfsc child, check explicitly in hfsc_enqueue whether the class is already in the
  eltree whenever the HFSC_RSC flag is set.  [1] https://web.git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=141d34391abbb315d68556b7c67ad97885407547
  [2] https://elixir.bootlin.com/linux/v6.15-rc5/source/net/sched/sch_hfsc.c#L1572 [3] https://elixir.bootlin.com/linux/v6.15-rc5/source/net/sched/sch_hfsc.c#L677
  [4] https://elixir.bootlin.com/linux/v6.15-rc5/source/net/sched/sch_hfsc.c#L1574 [5] https://lore.kernel.org/netdev/8DuRWwfqjoRDLDmBMlIfbrsZg9Gx50DHJc1ilxsEBNe2D6NMoigR_eIRIG0LOjMc3r10nUUZtArXx4oZBIdUfZQrwjcQhdinnMis_0G7VEk=@willsroot.io/T/#u'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.147-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.244-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.32-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
