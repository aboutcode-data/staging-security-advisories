advisory_id: linux/CVE-2025-68324
datasource_id: debian_importer_v2/linux/CVE-2025-68324
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68324
aliases:
  - CVE-2025-68324
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: imm: Fix
  use-after-free bug caused by unfinished delayed work  The delayed work item ''imm_tq'' is
  initialized in imm_attach() and scheduled via imm_queuecommand() for processing SCSI commands.  When
  the IMM parallel port SCSI host adapter is detached through imm_detach(), the imm_struct device
  instance is deallocated.  However, the delayed work might still be pending or executing when
  imm_detach() is called, leading to use-after-free bugs when the work function imm_interrupt()
  accesses the already freed imm_struct memory.  The race condition can occur as follows:  CPU
  0(detach thread)   | CPU 1                        | imm_queuecommand()                        |   imm_queuecommand_lck()
  imm_detach()           |     schedule_delayed_work()   kfree(dev) //FREE    | imm_interrupt()                        |   dev
  = container_of(...) //USE                            dev-> //USE  Add disable_delayed_work_sync()
  in imm_detach() to guarantee proper cancellation of the delayed work item before imm_struct
  is deallocated.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.17.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
