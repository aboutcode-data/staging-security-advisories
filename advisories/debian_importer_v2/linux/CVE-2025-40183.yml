advisory_id: linux/CVE-2025-40183
datasource_id: debian_importer_v2/linux/CVE-2025-40183
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40183
aliases:
  - CVE-2025-40183
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: Fix metadata_dst
  leak __bpf_redirect_neigh_v{4,6}  Cilium has a BPF egress gateway feature which forces outgoing
  K8s Pod traffic to pass through dedicated egress gateways which then SNAT the traffic in order
  to interact with stable IPs outside the cluster.  The traffic is directed to the gateway via
  vxlan tunnel in collect md mode. A recent BPF change utilized the bpf_redirect_neigh() helper
  to forward packets after the arrival and decap on vxlan, which turned out over time that the
  kmalloc-256 slab usage in kernel was ever-increasing.  The issue was that vxlan allocates
  the metadata_dst object and attaches it through a fake dst entry to the skb. The latter was
  never released though given bpf_redirect_neigh() was merely setting the new dst entry via
  skb_dst_set() without dropping an existing one first.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.158-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.247-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.17.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.57-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
