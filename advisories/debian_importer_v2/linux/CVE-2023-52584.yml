advisory_id: linux/CVE-2023-52584
datasource_id: debian_importer_v2/linux/CVE-2023-52584
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-52584
aliases:
  - CVE-2023-52584
summary: 'In the Linux kernel, the following vulnerability has been resolved:  spmi: mediatek:
  Fix UAF on device remove  The pmif driver data that contains the clocks is allocated along
  with spmi_controller. On device remove, spmi_controller will be freed first, and then devres
  , including the clocks, will be cleanup. This leads to UAF because putting the clocks will
  access the clocks in the pmif driver data, which is already freed along with spmi_controller.  This
  can be reproduced by enabling DEBUG_TEST_DRIVER_REMOVE and building the kernel with KASAN.  Fix
  the UAF issue by using unmanaged clk_bulk_get() and putting the clocks before freeing spmi_controller.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.82-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.7.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
