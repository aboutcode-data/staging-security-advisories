advisory_id: linux/CVE-2025-38508
datasource_id: debian_importer_v2/linux/CVE-2025-38508
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38508
aliases:
  - CVE-2025-38508
summary: 'In the Linux kernel, the following vulnerability has been resolved:  x86/sev: Use
  TSC_FACTOR for Secure TSC frequency calculation  When using Secure TSC, the GUEST_TSC_FREQ
  MSR reports a frequency based on the nominal P0 frequency, which deviates slightly (typically
  ~0.2%) from the actual mean TSC frequency due to clocking parameters.  Over extended VM uptime,
  this discrepancy accumulates, causing clock skew between the hypervisor and a SEV-SNP VM,
  leading to early timer interrupts as perceived by the guest.  The guest kernel relies on the
  reported nominal frequency for TSC-based timekeeping, while the actual frequency set during
  SNP_LAUNCH_START may differ. This mismatch results in inaccurate time calculations, causing
  the guest to perceive hrtimers as firing earlier than expected.  Utilize the TSC_FACTOR from
  the SEV firmware''s secrets page (see "Secrets Page Format" in the SNP Firmware ABI Specification)
  to calculate the mean TSC frequency, ensuring accurate timekeeping and mitigating clock skew
  in SEV-SNP VMs.  Use early_ioremap_encrypted() to map the secrets page as ioremap_encrypted()
  uses kmalloc() which is not available during early TSC initialization and causes a panic.    [
  bp: Drop the silly dummy var:     https://lore.kernel.org/r/20250630192726.GBaGLlHl84xIopx4Pt@fat_crate.local
  ]'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
