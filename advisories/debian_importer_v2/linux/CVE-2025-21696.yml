advisory_id: linux/CVE-2025-21696
datasource_id: debian_importer_v2/linux/CVE-2025-21696
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-21696
aliases:
  - CVE-2025-21696
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm: clear uffd-wp
  PTE/PMD state on mremap()  When mremap()ing a memory region previously registered with userfaultfd
  as write-protected but without UFFD_FEATURE_EVENT_REMAP, an inconsistency in flag clearing
  leads to a mismatch between the vma flags (which have uffd-wp cleared) and the pte/pmd flags
  (which do not have uffd-wp cleared).  This mismatch causes a subsequent mprotect(PROT_WRITE)
  to trigger a warning in page_table_check_pte_flags() due to setting the pte to writable while
  uffd-wp is still set.  Fix this by always explicitly clearing the uffd-wp pte/pmd flags on
  any such mremap() so that the values are consistent with the existing clearing of VM_UFFD_WP.  Be
  careful to clear the logical flag regardless of its physical form; a PTE bit, a swap PTE bit,
  or a PTE marker.  Cover PTE, huge PMD and hugetlb paths.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.11-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
