advisory_id: linux/CVE-2024-50001
datasource_id: debian_importer_v2/linux/CVE-2024-50001
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-50001
aliases:
  - CVE-2024-50001
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net/mlx5: Fix
  error path in multi-packet WQE transmit  Remove the erroneous unmap in case no DMA mapping
  was established  The multi-packet WQE transmit code attempts to obtain a DMA mapping for the
  skb. This could fail, e.g. under memory pressure, when the IOMMU driver just can''t allocate
  more memory for page tables. While the code tries to handle this in the path below the err_unmap
  label it erroneously unmaps one entry from the sq''s FIFO list of active mappings. Since the
  current map attempt failed this unmap is removing some random DMA mapping that might still
  be required. If the PCI function now presents that IOVA, the IOMMU may assumes a rogue DMA
  access and e.g. on s390 puts the PCI function in error state.  The erroneous behavior was
  seen in a stress-test environment that created memory pressure.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.115-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.234-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
