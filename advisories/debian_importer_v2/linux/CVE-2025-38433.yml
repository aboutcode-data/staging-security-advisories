advisory_id: linux/CVE-2025-38433
datasource_id: debian_importer_v2/linux/CVE-2025-38433
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38433
aliases:
  - CVE-2025-38433
summary: 'In the Linux kernel, the following vulnerability has been resolved:  riscv: fix runtime
  constant support for nommu kernels  the `__runtime_fixup_32` function does not handle the
  case where `val` is zero correctly (as might occur when patching a nommu kernel and referring
  to a physical address below the 4GiB boundary whose upper 32 bits are all zero) because nothing
  in the existing logic prevents the code from taking the `else` branch of both nop-checks and
  emitting two `nop` instructions.  This leaves random garbage in the register that is supposed
  to receive the upper 32 bits of the pointer instead of zero that when combined with the value
  for the lower 32 bits yields an invalid pointer and causes a kernel panic when that pointer
  is eventually accessed.  The author clearly considered the fact that if the `lui` is converted
  into a `nop` that the second instruction needs to be adjusted to become an `li` instead of
  an `addi`, hence introducing the `addi_insn_mask` variable, but didn''t follow that logic
  through fully to the case where the `else` branch executes. To fix it just adjust the logic
  to ensure that the second `else` branch is not taken if the first instruction will be patched
  to a `nop`.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
