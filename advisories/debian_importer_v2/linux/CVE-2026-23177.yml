advisory_id: linux/CVE-2026-23177
datasource_id: debian_importer_v2/linux/CVE-2026-23177
datasource_url: https://security-tracker.debian.org/tracker/CVE-2026-23177
aliases:
  - CVE-2026-23177
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm, shmem: prevent
  infinite loop on truncate race  When truncating a large swap entry, shmem_free_swap() returns
  0 when the entry''s index doesn''t match the given index due to lookup alignment.  The failure
  fallback path checks if the entry crosses the end border and aborts when it happens, so truncate
  won''t erase an unexpected entry or range.  But one scenario was ignored.  When `index` points
  to the middle of a large swap entry, and the large swap entry doesn''t go across the end border,
  find_get_entries() will return that large swap entry as the first item in the batch with `indices[0]`
  equal to `index`.  The entry''s base index will be smaller than `indices[0]`, so shmem_free_swap()
  will fail and return 0 due to the "base < index" check.  The code will then call shmem_confirm_swap(),
  get the order, check if it crosses the END boundary (which it doesn''t), and retry with the
  same index.  The next iteration will find the same entry again at the same index with same
  indices, leading to an infinite loop.  Fix this by retrying with a round-down index, and abort
  if the index is smaller than the truncate range.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.10-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.73-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
