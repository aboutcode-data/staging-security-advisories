advisory_id: linux/CVE-2022-48985
datasource_id: debian_importer_v2/linux/CVE-2022-48985
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-48985
aliases:
  - CVE-2022-48985
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: mana: Fix
  race on per-CQ variable napi work_done  After calling napi_complete_done(), the NAPIF_STATE_SCHED
  bit may be cleared, and another CPU can start napi thread and access per-CQ variable, cq->work_done.
  If the other thread (for example, from busy_poll) sets it to a value >= budget, this thread
  will continue to run when it should stop, and cause memory corruption and panic.  To fix this
  issue, save the per-CQ work_done variable in a local variable before napi_complete_done(),
  so it won''t be corrupted by a possible concurrent thread after napi_complete_done().  Also,
  add a flag bit to advertise to the NIC firmware: the NAPI work_done variable race is fixed,
  so the driver is able to reliably support features like busy_poll.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
