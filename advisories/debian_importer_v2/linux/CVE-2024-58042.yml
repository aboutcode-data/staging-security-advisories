advisory_id: linux/CVE-2024-58042
datasource_id: debian_importer_v2/linux/CVE-2024-58042
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-58042
aliases:
  - CVE-2024-58042
summary: 'In the Linux kernel, the following vulnerability has been resolved:  rhashtable: Fix
  potential deadlock by moving schedule_work outside lock  Move the hash table growth check
  and work scheduling outside the rht lock to prevent a possible circular locking dependency.  The
  original implementation could trigger a lockdep warning due to a potential deadlock scenario
  involving nested locks between rhashtable bucket, rq lock, and dsq lock. By relocating the
  growth check and work scheduling after releasing the rth lock, we break this potential deadlock
  chain.  This change expands the flexibility of rhashtable by removing restrictive locking
  that previously limited its use in scheduler and workqueue contexts.  Import to say that this
  calls rht_grow_above_75(), which reads from struct rhashtable without holding the lock, if
  this is a problem, we can move the check to the lock, and schedule the workqueue after the
  lock.   Modified so that atomic_inc is also moved outside of the bucket lock along with the
  growth above 75% check.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
