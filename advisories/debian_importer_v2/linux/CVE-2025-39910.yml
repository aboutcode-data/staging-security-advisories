advisory_id: linux/CVE-2025-39910
datasource_id: debian_importer_v2/linux/CVE-2025-39910
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39910
aliases:
  - CVE-2025-39910
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/vmalloc, mm/kasan:
  respect gfp mask in kasan_populate_vmalloc()  kasan_populate_vmalloc() and its helpers ignore
  the caller''s gfp_mask and always allocate memory using the hardcoded GFP_KERNEL flag.  This
  makes them inconsistent with vmalloc(), which was recently extended to support GFP_NOFS and
  GFP_NOIO allocations.  Page table allocations performed during shadow population also ignore
  the external gfp_mask.  To preserve the intended semantics of GFP_NOFS and GFP_NOIO, wrap
  the apply_to_page_range() calls into the appropriate memalloc scope.  xfs calls vmalloc with
  GFP_NOFS, so this bug could lead to deadlock.  There was a report here https://lkml.kernel.org/r/686ea951.050a0220.385921.0016.GAE@google.com  This
  patch:  - Extends kasan_populate_vmalloc() and helpers to take gfp_mask;  - Passes gfp_mask
  down to alloc_pages_bulk() and __get_free_page();  - Enforces GFP_NOFS/NOIO semantics with
  memalloc_*_save()/restore()    around apply_to_page_range();  - Updates vmalloc.c and percpu
  allocator call sites accordingly.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/6.16.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/6.1.159-1|6.12.63-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
