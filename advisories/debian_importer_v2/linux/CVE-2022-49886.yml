advisory_id: linux/CVE-2022-49886
datasource_id: debian_importer_v2/linux/CVE-2022-49886
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49886
aliases:
  - CVE-2022-49886
summary: "In the Linux kernel, the following vulnerability has been resolved:  x86/tdx: Panic\
  \ on bad configs that #VE on \"private\" memory access  All normal kernel memory is \"TDX\
  \ private memory\".  This includes everything from kernel stacks to kernel text.  Handling\
  \ exceptions on arbitrary accesses to kernel memory is essentially impossible because they\
  \ can happen in horribly nasty places like kernel entry/exit.  But, TDX hardware can theoretically\
  \ _deliver_ a virtualization exception (#VE) on any access to private memory.  But, it's not\
  \ as bad as it sounds.  TDX can be configured to never deliver these exceptions on private\
  \ memory with a \"TD attribute\" called ATTR_SEPT_VE_DISABLE.  The guest has no way to *set*\
  \ this attribute, but it can check it.  Ensure ATTR_SEPT_VE_DISABLE is set in early boot.\
  \  panic() if it is unset.  There is no sane way for Linux to run with this attribute clear\
  \ so a panic() is appropriate.  There's small window during boot before the check where kernel\
  \ has an early #VE handler. But the handler is only for port I/O and will also panic() as\
  \ soon as it sees any other #VE, such as a one generated by a private memory access.  [ dhansen:\
  \ Rewrite changelog and rebase on new tdx_parse_tdinfo(). \t   Add Kirill's tested-by because\
  \ I made changes since \t   he wrote this. ]"
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
