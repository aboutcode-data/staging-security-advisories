advisory_id: linux/CVE-2025-71097
datasource_id: debian_importer_v2/linux/CVE-2025-71097
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-71097
aliases:
  - CVE-2025-71097
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ipv4: Fix reference
  count leak when using error routes with nexthop objects  When a nexthop object is deleted,
  it is marked as dead and then fib_table_flush() is called to flush all the routes that are
  using the dead nexthop.  The current logic in fib_table_flush() is to only flush error routes
  (e.g., blackhole) when it is called as part of network namespace dismantle (i.e., with flush_all=true).
  Therefore, error routes are not flushed when their nexthop object is deleted:   # ip link
  add name dummy1 up type dummy  # ip nexthop add id 1 dev dummy1  # ip route add 198.51.100.1/32
  nhid 1  # ip route add blackhole 198.51.100.2/32 nhid 1  # ip nexthop del id 1  # ip route
  show  blackhole 198.51.100.2 nhid 1 dev dummy1  As such, they keep holding a reference on
  the nexthop object which in turn holds a reference on the nexthop device, resulting in a reference
  count leak:   # ip link del dev dummy1  [   70.516258] unregister_netdevice: waiting for dummy1
  to become free. Usage count = 2  Fix by flushing error routes when their nexthop is marked
  as dead.  IPv6 does not suffer from this problem.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.162-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.249-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
