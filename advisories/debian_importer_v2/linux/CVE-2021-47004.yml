advisory_id: linux/CVE-2021-47004
datasource_id: debian_importer_v2/linux/CVE-2021-47004
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-47004
aliases:
  - CVE-2021-47004
summary: 'In the Linux kernel, the following vulnerability has been resolved:  f2fs: fix to
  avoid touching checkpointed data in get_victim()  In CP disabling mode, there are two issues
  when using LFS or SSR | AT_SSR mode to select victim:  1. LFS is set to find source section
  during GC, the victim should have no checkpointed data, since after GC, section could not
  be set free for reuse.  Previously, we only check valid chpt blocks in current segment rather
  than section, fix it.  2. SSR | AT_SSR are set to find target segment for writes which can
  be fully filled by checkpointed and newly written blocks, we should never select such segment,
  otherwise it can cause panic or data corruption during allocation, potential case is described
  as below:   a) target segment has ''n'' (n < 512) ckpt valid blocks  b) GC migrates ''n''
  valid blocks to other segment (segment is still     in dirty list)  c) GC migrates ''512 -
  n'' blocks to target segment (segment has ''n''     cp_vblocks and ''512 - n'' vblocks)  d)
  If GC selects target segment via {AT,}SSR allocator, however there     is no free space in
  targe segment.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.38-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
