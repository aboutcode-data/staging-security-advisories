advisory_id: linux/CVE-2022-49989
datasource_id: debian_importer_v2/linux/CVE-2022-49989
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49989
aliases:
  - CVE-2022-49989
summary: 'In the Linux kernel, the following vulnerability has been resolved:  xen/privcmd:
  fix error exit of privcmd_ioctl_dm_op()  The error exit of privcmd_ioctl_dm_op() is calling
  unlock_pages() potentially with pages being NULL, leading to a NULL dereference.  Additionally
  lock_pages() doesn''t check for pin_user_pages_fast() having been completely successful, resulting
  in potentially not locking all pages into memory. This could result in sporadic failures when
  using the related memory in user mode.  Fix all of that by calling unlock_pages() always with
  the real number of pinned pages, which will be zero in case pages being NULL, and by checking
  the number of pages pinned by pin_user_pages_fast() matching the expected number of pages.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.0.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.140-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
