advisory_id: linux/CVE-2024-50130
datasource_id: debian_importer_v2/linux/CVE-2024-50130
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-50130
aliases:
  - CVE-2024-50130
summary: 'In the Linux kernel, the following vulnerability has been resolved:  netfilter: bpf:
  must hold reference on net namespace  BUG: KASAN: slab-use-after-free in __nf_unregister_net_hook+0x640/0x6b0
  Read of size 8 at addr ffff8880106fe400 by task repro/72= bpf_nf_link_release+0xda/0x1e0 bpf_link_free+0x139/0x2d0
  bpf_link_release+0x68/0x80 __fput+0x414/0xb60  Eric says:  It seems that bpf was able to defer
  the __nf_unregister_net_hook()  after exit()/close() time.  Perhaps a netns reference is missing,
  because the netns has been  dismantled/freed already.  bpf_nf_link_attach() does :  link->net
  = net;  But I do not see a reference being taken on net.  Add such a reference and release
  it after hook unreg. Note that I was unable to get syzbot reproducer to work, so I do not
  know if this resolves this splat.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.11.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
