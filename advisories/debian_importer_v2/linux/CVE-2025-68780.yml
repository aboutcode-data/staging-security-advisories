advisory_id: linux/CVE-2025-68780
datasource_id: debian_importer_v2/linux/CVE-2025-68780
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68780
aliases:
  - CVE-2025-68780
summary: 'In the Linux kernel, the following vulnerability has been resolved:  sched/deadline:
  only set free_cpus for online runqueues  Commit 16b269436b72 ("sched/deadline: Modify cpudl::free_cpus
  to reflect rd->online") introduced the cpudl_set/clear_freecpu functions to allow the cpu_dl::free_cpus
  mask to be manipulated by the deadline scheduler class rq_on/offline callbacks so the mask
  would also reflect this state.  Commit 9659e1eeee28 ("sched/deadline: Remove cpu_active_mask
  from cpudl_find()") removed the check of the cpu_active_mask to save some processing on the
  premise that the cpudl::free_cpus mask already reflected the runqueue online state.  Unfortunately,
  there are cases where it is possible for the cpudl_clear function to set the free_cpus bit
  for a CPU when the deadline runqueue is offline. When this occurs while a CPU is connected
  to the default root domain the flag may retain the bad state after the CPU has been unplugged.
  Later, a different CPU that is transitioning through the default root domain may push a deadline
  task to the powered down CPU when cpudl_find sees its free_cpus bit is set. If this happens
  the task will not have the opportunity to run.  One example is outlined here: https://lore.kernel.org/lkml/20250110233010.2339521-1-opendmb@gmail.com  Another
  occurs when the last deadline task is migrated from a CPU that has an offlined runqueue. The
  dequeue_task member of the deadline scheduler class will eventually call cpudl_clear and set
  the free_cpus bit for the CPU.  This commit modifies the cpudl_clear function to be aware
  of the online state of the deadline runqueue so that the free_cpus mask can be updated appropriately.  It
  is no longer necessary to manage the mask outside of the cpudl_set/clear functions so the
  cpudl_set/clear_freecpu functions are removed. In addition, since the free_cpus mask is now
  only updated under the cpudl lock the code was changed to use the non-atomic __cpumask functions.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.1.162-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.18.15-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1
    fixed_versions: vers:deb/6.12.69-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
