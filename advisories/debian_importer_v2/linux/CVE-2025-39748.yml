advisory_id: linux/CVE-2025-39748
datasource_id: debian_importer_v2/linux/CVE-2025-39748
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-39748
aliases:
  - CVE-2025-39748
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: Forget ranges
  when refining tnum after JSET  Syzbot reported a kernel warning due to a range invariant violation
  on the following BPF program.    0: call bpf_get_netns_cookie   1: if r0 == 0 goto <exit>   2:
  if r0 & Oxffffffff goto <exit>  The issue is on the path where we fall through both jumps.  That
  path is unreachable at runtime: after insn 1, we know r0 != 0, but with the sign extension
  on the jset, we would only fallthrough insn 2 if r0 == 0. Unfortunately, is_branch_taken()
  isn''t currently able to figure this out, so the verifier walks all branches. The verifier
  then refines the register bounds using the second condition and we end up with inconsistent
  bounds on this unreachable path:    1: if r0 == 0 goto <exit>     r0: u64=[0x1, 0xffffffffffffffff]
  var_off=(0, 0xffffffffffffffff)   2: if r0 & 0xffffffff goto <exit>     r0 before reg_bounds_sync:
  u64=[0x1, 0xffffffffffffffff] var_off=(0, 0)     r0 after reg_bounds_sync:  u64=[0x1, 0] var_off=(0,
  0)  Improving the range refinement for JSET to cover all cases is tricky. We also don''t expect
  many users to rely on JSET given LLVM doesn''t generate those instructions. So instead of
  improving the range refinement for JSETs, Eduard suggested we forget the ranges whenever we''re
  narrowing tnums after a JSET. This patch implements that approach.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions: vers:deb/5.10.223-1|6.1.159-1
    fixed_versions: vers:deb/6.12.43-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
