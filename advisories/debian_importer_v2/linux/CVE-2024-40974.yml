advisory_id: linux/CVE-2024-40974
datasource_id: debian_importer_v2/linux/CVE-2024-40974
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-40974
aliases:
  - CVE-2024-40974
summary: 'In the Linux kernel, the following vulnerability has been resolved:  powerpc/pseries:
  Enforce hcall result buffer validity and size  plpar_hcall(), plpar_hcall9(), and related
  functions expect callers to provide valid result buffers of certain minimum size. Currently
  this is communicated only through comments in the code and the compiler has no idea.  For
  example, if I write a bug like this:    long retbuf[PLPAR_HCALL_BUFSIZE]; // should be PLPAR_HCALL9_BUFSIZE   plpar_hcall9(H_ALLOCATE_VAS_WINDOW,
  retbuf, ...);  This compiles with no diagnostics emitted, but likely results in stack corruption
  at runtime when plpar_hcall9() stores results past the end of the array. (To be clear this
  is a contrived example and I have not found a real instance yet.)  To make this class of error
  less likely, we can use explicitly-sized array parameters instead of pointers in the declarations
  for the hcall APIs. When compiled with -Warray-bounds[1], the code above now provokes a diagnostic
  like this:  error: array argument is too small; is of size 32, callee requires at least 72
  [-Werror,-Warray-bounds]    60 |                 plpar_hcall9(H_ALLOCATE_VAS_WINDOW, retbuf,       |                 ^                                   ~~~~~~  [1]
  Enabled for LLVM builds but not GCC for now. See commit     0da6e5fd6c37 ("gcc: disable ''-Warray-bounds''
  for gcc-13 too") and     related changes.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.99-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.221-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.9.7-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.13-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
