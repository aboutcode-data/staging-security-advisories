advisory_id: linux/CVE-2022-49304
datasource_id: debian_importer_v2/linux/CVE-2022-49304
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-49304
aliases:
  - CVE-2022-49304
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drivers: tty:
  serial: Fix deadlock in sa1100_set_termios()  There is a deadlock in sa1100_set_termios(),
  which is shown below:     (Thread 1)              |      (Thread 2)                            |
  sa1100_enable_ms() sa1100_set_termios()       |  mod_timer()  spin_lock_irqsave() //(1) |  (wait
  a time)  ...                       | sa1100_timeout()  del_timer_sync()          |  spin_lock_irqsave()
  //(2)  (wait timer to stop)      |  ...  We hold sport->port.lock in position (1) of thread
  1 and use del_timer_sync() to wait timer to stop, but timer handler also need sport->port.lock
  in position (2) of thread 2. As a result, sa1100_set_termios() will block forever.  This patch
  moves del_timer_sync() before spin_lock_irqsave() in order to prevent the deadlock.'
impacted_packages:
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.1.159-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.18.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.223-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.10.127-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.18.12-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/linux?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.12.63-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
