advisory_id: php-pear/CVE-2018-1000888
datasource_id: debian_importer_v2/php-pear/CVE-2018-1000888
datasource_url: https://security-tracker.debian.org/tracker/CVE-2018-1000888
aliases:
  - CVE-2018-1000888
summary: PEAR Archive_Tar version 1.4.3 and earlier contains a CWE-502, CWE-915 vulnerability
  in the Archive_Tar class. There are several file operations with `$v_header['filename']` as
  parameter (such as file_exists, is_file, is_dir, etc). When extract is called without a specific
  prefix path, we can trigger unserialization by crafting a tar file with `phar://[path_to_malicious_phar_file]`
  as path. Object injection can be used to trigger destruct in the loaded PHP classes, e.g.
  the Archive_Tar class itself. With Archive_Tar object injection, arbitrary file deletion can
  occur because `@unlink($this->_temp_tarname)` is called. If another class with useful gadget
  is loaded, it may possible to cause remote code execution that can result in files being deleted
  or possibly modified. This vulnerability appears to have been fixed in 1.4.4.
impacted_packages:
  - purl: pkg:deb/debian/php-pear?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1:1.10.13+submodules+notgz+2022032202-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/php-pear?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1:1.10.6+submodules+notgz-1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/php-pear?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1:1.10.12+submodules+notgz+20210212-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/php-pear?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1:1.10.16+submodules+notgz-3
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-502
  - CWE-915
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=919147
    reference_type:
    reference_id: 919147
