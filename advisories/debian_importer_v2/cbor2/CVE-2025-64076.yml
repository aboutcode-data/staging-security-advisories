advisory_id: cbor2/CVE-2025-64076
datasource_id: debian_importer_v2/cbor2/CVE-2025-64076
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-64076
aliases:
  - CVE-2025-64076
summary: 'Multiple vulnerabilities exist in cbor2 through version 5.7.0 in the decode_definite_long_string()
  function of the C extension decoder (source/decoder.c): (1) Integer Underflow Leading to Out-of-Bounds
  Read (CWE-191, CWE-125): An incorrect variable reference and missing state reset in the chunk
  processing loop causes buffer_length to not be reset to zero after UTF-8 character consumption.
  This results in subsequent chunk_length calculations producing negative values (e.g., chunk_length
  = 65536 - buffer_length), which are passed as signed integers to the read() method, potentially
  triggering unlimited read operations and resource exhaustion. (2) Memory Leak via Missing
  Reference Count Release (CWE-401): The main processing loop fails to release Python object
  references (Py_DECREF) for chunk objects allocated in each iteration. For CBOR strings longer
  than 65536 bytes, this causes cumulative memory leaks proportional to the payload size, enabling
  memory exhaustion attacks through repeated processing of large CBOR payloads. Both vulnerabilities
  can be exploited remotely without authentication by sending specially-crafted CBOR data containing
  definite-length text strings with multi-byte UTF-8 characters positioned at 65536-byte chunk
  boundaries. Successful exploitation results in denial of service through process crashes (CBORDecodeEOF
  exceptions) or memory exhaustion. The vulnerabilities affect all applications using cbor2''s
  C extension to process untrusted CBOR data, including web APIs, IoT data collectors, and message
  queue processors. Fixed in commit 851473490281f82d82560b2368284ef33cf6e8f9 pushed with released
  version 5.7.1.'
impacted_packages:
  - purl: pkg:deb/debian/cbor2?distro=trixie
    affected_versions: vers:deb/5.6.5-1
    fixed_versions: vers:deb/5.4.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/cbor2?distro=trixie
    affected_versions: vers:deb/5.6.5-1
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/cbor2?distro=trixie
    affected_versions: vers:deb/5.6.5-1
    fixed_versions: vers:deb/5.2.0-4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/cbor2?distro=trixie
    affected_versions: vers:deb/5.6.5-1
    fixed_versions: vers:deb/5.8.0-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/cbor2?distro=trixie
    affected_versions: vers:deb/5.6.5-1
    fixed_versions: vers:deb/5.7.1-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/cbor2?distro=trixie
    affected_versions: vers:deb/5.6.5-1
    fixed_versions: vers:deb/5.8.0-3
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses:
  - CWE-401
  - CWE-191
  - CWE-125
references: []
