advisory_id: nanopb/CVE-2021-21401
datasource_id: debian_importer_v2/nanopb/CVE-2021-21401
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-21401
aliases:
  - CVE-2021-21401
summary: Nanopb is a small code-size Protocol Buffers implementation in ansi C. In Nanopb before
  versions 0.3.9.8 and 0.4.5, decoding a specifically formed message can cause invalid `free()`
  or `realloc()` calls if the message type contains an `oneof` field, and the `oneof` directly
  contains both a pointer field and a non-pointer field. If the message data first contains
  the non-pointer field and then the pointer field, the data of the non-pointer field is incorrectly
  treated as if it was a pointer value. Such message data rarely occurs in normal messages,
  but it is a concern when untrusted data is parsed. This has been fixed in versions 0.3.9.8
  and 0.4.5. See referenced GitHub Security Advisory for more information including workarounds.
impacted_packages:
  - purl: pkg:deb/debian/nanopb?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0.4.7-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/nanopb?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0.4.4-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/nanopb?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0.4.9.1-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=985844
    reference_type:
    reference_id: 985844
