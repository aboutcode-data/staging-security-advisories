advisory_id: activemq/CVE-2022-41678
datasource_id: debian_importer_v2/activemq/CVE-2022-41678
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-41678
aliases:
  - CVE-2022-41678
summary: 'Once an user is authenticated on Jolokia, he can potentially trigger arbitrary code
  execution.Â   In details, in ActiveMQ configurations, jetty allows org.jolokia.http.AgentServlet
  to handler request to /api/jolokia  org.jolokia.http.HttpRequestHandler#handlePostRequest
  is able to create JmxRequest through JSONObject. And calls to org.jolokia.http.HttpRequestHandler#executeRequest.  Into
  deeper calling stacks, org.jolokia.handler.ExecHandler#doHandleRequest can be invoked through
  refection. This could lead to RCE through via various mbeans. One example is unrestricted
  deserialization in jdk.management.jfr.FlightRecorderMXBeanImpl which exists on Java version
  above 11.  1 Call newRecording.  2 Call setConfiguration. And a webshell data hides in it.  3
  Call startRecording.  4 Call copyTo method. The webshell will be written to a .jsp file.  The
  mitigation is to restrict (by default) the actions authorized on Jolokia, or disable Jolokia.
  A more restrictive Jolokia configuration has been defined in default ActiveMQ distribution.
  We encourage users to upgrade to ActiveMQ distributions version including updated Jolokia
  configuration: 5.16.6, 5.17.4, 5.18.0, 6.0.0.'
impacted_packages:
  - purl: pkg:deb/debian/activemq?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.17.2+dfsg-2+deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/activemq?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.16.1-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/activemq?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.16.1-1+deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/activemq?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.17.6+dfsg-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/activemq?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.17.6+dfsg-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
