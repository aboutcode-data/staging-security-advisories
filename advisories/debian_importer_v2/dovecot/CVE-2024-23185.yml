advisory_id: dovecot/CVE-2024-23185
datasource_id: debian_importer_v2/dovecot/CVE-2024-23185
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-23185
aliases:
  - CVE-2024-23185
summary: Very large headers can cause resource exhaustion when parsing message. The message-parser
  normally reads reasonably sized chunks of the message. However, when it feeds them to message-header-parser,
  it starts building up "full_value" buffer out of the smaller chunks. The full_value buffer
  has no size limit, so large headers can cause large memory usage. It doesn't matter whether
  it's a single long header line, or a single header split into multiple lines. This bug exists
  in all Dovecot versions. Incoming mails typically have some size limits set by MTA, so even
  largest possible header size may still fit into Dovecot's vsz_limit. So attackers probably
  can't DoS a victim user this way. A user could APPEND larger mails though, allowing them to
  DoS themselves (although maybe cause some memory issues for the backend in general). One can
  implement restrictions on headers on MTA component preceding Dovecot. No publicly available
  exploits are known.
impacted_packages:
  - purl: pkg:deb/debian/dovecot?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1:2.3.19.1+dfsg1-2.1+deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/dovecot?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1:2.3.13+dfsg1-2+deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/dovecot?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1:2.3.13+dfsg1-2+deb11u2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/dovecot?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1:2.4.2+dfsg1-3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/dovecot?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1:2.3.21.1+dfsg1-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/dovecot?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1:2.4.1+dfsg1-6+deb13u2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1078877
    reference_type:
    reference_id: 1078877
