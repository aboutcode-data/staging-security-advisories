advisory_id: openssl/CVE-2023-0215
datasource_id: debian_importer_v2/openssl/CVE-2023-0215
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-0215
aliases:
  - CVE-2023-0215
summary: The public API function BIO_new_NDEF is a helper function used for streaming ASN.1
  data via a BIO. It is primarily used internally to OpenSSL to support the SMIME, CMS and PKCS7
  streaming capabilities, but may also be called directly by end user applications.  The function
  receives a BIO from the caller, prepends a new BIO_f_asn1 filter BIO onto the front of it
  to form a BIO chain, and then returns the new head of the BIO chain to the caller. Under certain
  conditions, for example if a CMS recipient public key is invalid, the new filter BIO is freed
  and the function returns a NULL result indicating a failure. However, in this case, the BIO
  chain is not properly cleaned up and the BIO passed by the caller still retains internal pointers
  to the previously freed filter BIO. If the caller then goes on to call BIO_pop() on the BIO
  then a use-after-free will occur. This will most likely result in a crash.    This scenario
  occurs directly in the internal function B64_write_ASN1() which may cause BIO_new_NDEF() to
  be called and will subsequently call BIO_pop() on the BIO. This internal function is in turn
  called by the public API functions PEM_write_bio_ASN1_stream, PEM_write_bio_CMS_stream, PEM_write_bio_PKCS7_stream,
  SMIME_write_ASN1, SMIME_write_CMS and SMIME_write_PKCS7.  Other public API functions that
  may be impacted by this include i2d_ASN1_bio_stream, BIO_new_CMS, BIO_new_PKCS7, i2d_CMS_bio_stream
  and i2d_PKCS7_bio_stream.  The OpenSSL cms and smime command line applications are similarly
  affected.
impacted_packages:
  - purl: pkg:deb/debian/openssl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.0.18-1~deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/openssl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.0.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/openssl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.1.1w-0+deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/openssl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.1.1n-0+deb11u4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/openssl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.5.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/openssl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.5.4-1~deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
