advisory_id: guix/CVE-2021-27851
datasource_id: debian_importer_v2/guix/CVE-2021-27851
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-27851
aliases:
  - CVE-2021-27851
summary: A security vulnerability that can lead to local privilege escalation has been found
  in ’guix-daemon’. It affects multi-user setups in which ’guix-daemon’ runs locally. The attack
  consists in having an unprivileged user spawn a build process, for instance with `guix build`,
  that makes its build directory world-writable. The user then creates a hardlink to a root-owned
  file such as /etc/shadow in that build directory. If the user passed the --keep-failed option
  and the build eventually fails, the daemon changes ownership of the whole build tree, including
  the hardlink, to the user. At that point, the user has write access to the target file. Versions
  after and including v0.11.0-3298-g2608e40988, and versions prior to v1.2.0-75109-g94f0312546
  are vulnerable.
impacted_packages:
  - purl: pkg:deb/debian/guix?distro=sid
    affected_versions:
    fixed_versions: vers:deb/1.2.0-4+deb11u2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/guix?distro=sid
    affected_versions:
    fixed_versions: vers:deb/1.2.0-4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/guix?distro=sid
    affected_versions:
    fixed_versions: vers:deb/1.4.0-9
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=985467
    reference_type:
    reference_id: 985467
