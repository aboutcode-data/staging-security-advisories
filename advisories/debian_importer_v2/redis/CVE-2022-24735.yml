advisory_id: redis/CVE-2022-24735
datasource_id: debian_importer_v2/redis/CVE-2022-24735
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-24735
aliases:
  - CVE-2022-24735
summary: Redis is an in-memory database that persists on disk. By exploiting weaknesses in the
  Lua script execution environment, an attacker with access to Redis prior to version 7.0.0
  or 6.2.7 can inject Lua code that will execute with the (potentially higher) privileges of
  another Redis user. The Lua script execution environment in Redis provides some measures that
  prevent a script from creating side effects that persist and can affect the execution of the
  same, or different script, at a later time. Several weaknesses of these measures have been
  publicly known for a long time, but they had no security impact as the Redis security model
  did not endorse the concept of users or privileges. With the introduction of ACLs in Redis
  6.0, these weaknesses can be exploited by a less privileged users to inject Lua code that
  will execute at a later time, when a privileged user executes a Lua script. The problem is
  fixed in Redis versions 7.0.0 and 6.2.7. An additional workaround to mitigate this problem
  without patching the redis-server executable, if Lua scripting is not being used, is to block
  access to `SCRIPT LOAD` and `EVAL` commands using ACL rules.
impacted_packages:
  - purl: pkg:deb/debian/redis?distro=trixie
    affected_versions: vers:deb/5:6.0.16-1+deb11u2
    fixed_versions: vers:deb/5:7.0.15-1~deb12u6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/redis?distro=trixie
    affected_versions: vers:deb/5:6.0.16-1+deb11u2
    fixed_versions: vers:deb/5:7.0.1-4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/redis?distro=trixie
    affected_versions: vers:deb/5:6.0.16-1+deb11u2
    fixed_versions: vers:deb/5:8.0.5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/redis?distro=trixie
    affected_versions: vers:deb/5:6.0.16-1+deb11u2
    fixed_versions: vers:deb/5:8.0.2-3+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
