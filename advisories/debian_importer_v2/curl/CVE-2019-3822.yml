advisory_id: curl/CVE-2019-3822
datasource_id: debian_importer_v2/curl/CVE-2019-3822
datasource_url: https://security-tracker.debian.org/tracker/CVE-2019-3822
aliases:
  - CVE-2019-3822
summary: libcurl versions from 7.36.0 to before 7.64.0 are vulnerable to a stack-based buffer
  overflow. The function creating an outgoing NTLM type-3 header (`lib/vauth/ntlm.c:Curl_auth_create_ntlm_type3_message()`),
  generates the request HTTP header contents based on previously received data. The check that
  exists to prevent the local buffer from getting overflowed is implemented wrongly (using unsigned
  math) and as such it does not prevent the overflow from happening. This output data can grow
  larger than the local buffer if very large 'nt response' data is extracted from a previous
  NTLMv2 header provided by the malicious or broken HTTP server. Such a 'large value' needs
  to be around 1000 bytes or more. The actual payload data copied to the target buffer comes
  from the NTLMv2 type-2 response header.
impacted_packages:
  - purl: pkg:deb/debian/curl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/7.88.1-10+deb12u14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/curl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/7.64.0-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/curl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/7.74.0-1.3+deb11u13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/curl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/8.18.0-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/curl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/8.19.0~rc2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/curl?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/8.14.1-2+deb13u2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
