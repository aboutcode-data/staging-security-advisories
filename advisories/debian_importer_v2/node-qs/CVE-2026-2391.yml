advisory_id: node-qs/CVE-2026-2391
datasource_id: debian_importer_v2/node-qs/CVE-2026-2391
datasource_url: https://security-tracker.debian.org/tracker/CVE-2026-2391
aliases:
  - CVE-2026-2391
summary: '### Summary The `arrayLimit` option in qs does not enforce limits for comma-separated
  values when `comma: true` is enabled, allowing attackers to cause denial-of-service via memory
  exhaustion. This is a bypass of the array limit enforcement, similar to the bracket notation
  bypass addressed in GHSA-6rw7-vpxm-498p (CVE-2025-15284).  ### Details When the `comma` option
  is set to `true` (not the default, but configurable in applications), qs allows parsing comma-separated
  strings as arrays (e.g., `?param=a,b,c` becomes `[''a'', ''b'', ''c'']`). However, the limit
  check for `arrayLimit` (default: 20) and the optional throwOnLimitExceeded occur after the
  comma-handling logic in `parseArrayValue`, enabling a bypass. This permits creation of arbitrarily
  large arrays from a single parameter, leading to excessive memory allocation.  **Vulnerable
  code** (lib/parse.js: lines ~40-50): ```js if (val && typeof val === ''string'' && options.comma
  && val.indexOf('','') > -1) {     return val.split('',''); }  if (options.throwOnLimitExceeded
  && currentArrayLength >= options.arrayLimit) {     throw new RangeError(''Array limit exceeded.
  Only '' + options.arrayLimit + '' element'' + (options.arrayLimit === 1 ? '''' : ''s'') +
  '' allowed in an array.''); }  return val; ``` The `split('','')` returns the array immediately,
  skipping the subsequent limit check. Downstream merging via `utils.combine` does not prevent
  allocation, even if it marks overflows for sparse arrays.This discrepancy allows attackers
  to send a single parameter with millions of commas (e.g., `?param=,,,,,,,,...`), allocating
  massive arrays in memory without triggering limits. It bypasses the intent of `arrayLimit`,
  which is enforced correctly for indexed (`a[0]=`) and bracket (`a[]=`) notations (the latter
  fixed in v6.14.1 per GHSA-6rw7-vpxm-498p).  ### PoC **Test 1 - Basic bypass:** ``` npm install
  qs ```  ```js const qs = require(''qs'');  const payload = ''a='' + '',''.repeat(25);  //
  26 elements after split (bypasses arrayLimit: 5) const options = { comma: true, arrayLimit:
  5, throwOnLimitExceeded: true };  try {   const result = qs.parse(payload, options);   console.log(result.a.length);  //
  Outputs: 26 (bypass successful) } catch (e) {   console.log(''Limit enforced:'', e.message);  //
  Not thrown } ``` **Configuration:** - `comma: true` - `arrayLimit: 5` - `throwOnLimitExceeded:
  true`  Expected: Throws "Array limit exceeded" error. Actual: Parses successfully, creating
  an array of length 26.   ### Impact Denial of Service (DoS) via memory exhaustion.'
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1127940
    reference_type:
    reference_id: 1127940
