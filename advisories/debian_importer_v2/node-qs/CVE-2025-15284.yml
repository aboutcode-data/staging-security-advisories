advisory_id: node-qs/CVE-2025-15284
datasource_id: debian_importer_v2/node-qs/CVE-2025-15284
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-15284
aliases:
  - CVE-2025-15284
summary: 'Improper Input Validation vulnerability in qs (parse modules) allows HTTP DoS.This
  issue affects qs: < 6.14.1.   Summary  The arrayLimit option in qs did not enforce limits
  for bracket notation (a[]=1&a[]=2), only for indexed notation (a[0]=1). This is a consistency
  bug; arrayLimit should apply uniformly across all array notations.  Note: The default parameterLimit of
  1000 effectively mitigates the DoS scenario originally described. With default options, bracket
  notation cannot produce arrays larger than parameterLimit regardless of arrayLimit, because
  each a[]=valueconsumes one parameter slot. The severity has been reduced accordingly.  Details  The
  arrayLimit option only checked limits for indexed notation (a[0]=1&a[1]=2) but did not enforce
  it for bracket notation (a[]=1&a[]=2).  Vulnerable code (lib/parse.js:159-162):  if (root
  === ''[]'' && options.parseArrays) {     obj = utils.combine([], leaf);  // No arrayLimit
  check }      Working code (lib/parse.js:175):  else if (index <= options.arrayLimit) {  //
  Limit checked here     obj = [];     obj[index] = leaf; }      The bracket notation handler
  at line 159 uses utils.combine([], leaf) without validating against options.arrayLimit, while
  indexed notation at line 175 checks index <= options.arrayLimit before creating arrays.    PoC  const
  qs = require(''qs''); const result = qs.parse(''a[]=1&a[]=2&a[]=3&a[]=4&a[]=5&a[]=6'', { arrayLimit:
  5 }); console.log(result.a.length);  // Output: 6 (should be max 5)      Note on parameterLimit
  interaction: The original advisory''s "DoS demonstration" claimed a length of 10,000, but
  parameterLimit (default: 1000) caps parsing to 1,000 parameters. With default options, the
  actual output is 1,000, not 10,000.  Impact  Consistency bug in arrayLimit enforcement. With
  default parameterLimit, the practical DoS risk is negligible since parameterLimit already
  caps the total number of parsed parameters (and thus array elements from bracket notation).
  The risk increases only when parameterLimit is explicitly set to a very high value.'
impacted_packages:
  - purl: pkg:deb/debian/node-qs?distro=trixie
    affected_versions: vers:deb/6.9.4+ds-1+deb11u1|6.11.0+ds+~6.9.7-3|6.13.0+ds+~6.9.16-1
    fixed_versions: vers:deb/6.14.1+ds+~6.14.0-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1124315
    reference_type:
    reference_id: 1124315
