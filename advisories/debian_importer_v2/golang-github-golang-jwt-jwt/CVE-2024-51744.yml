advisory_id: golang-github-golang-jwt-jwt/CVE-2024-51744
datasource_id: debian_importer_v2/golang-github-golang-jwt-jwt/CVE-2024-51744
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-51744
aliases:
  - CVE-2024-51744
summary: golang-jwt is a Go implementation of JSON Web Tokens. Unclear documentation of the
  error behavior in `ParseWithClaims` can lead to situation where users are potentially not
  checking errors in the way they should be. Especially, if a token is both expired and invalid,
  the errors returned by `ParseWithClaims` return both error codes. If users only check for
  the `jwt.ErrTokenExpired ` using `error.Is`, they will ignore the embedded `jwt.ErrTokenSignatureInvalid`
  and thus potentially accept invalid tokens. A fix has been back-ported with the error handling
  logic from the `v5` branch to the `v4` branch. In this logic, the `ParseWithClaims` function
  will immediately return in "dangerous" situations (e.g., an invalid signature), limiting the
  combined errors only to situations where the signature is valid, but further validation failed
  (e.g., if the signature is valid, but is expired AND has the wrong audience). This fix is
  part of the 4.5.1 release. We are aware that this changes the behaviour of an established
  function and is not 100 % backwards compatible, so updating to 4.5.1 might break your code.
  In case you cannot update to 4.5.0, please make sure that you are properly checking for all
  errors ("dangerous" ones first), so that you are not running in the case detailed above.
impacted_packages:
  - purl: pkg:deb/debian/golang-github-golang-jwt-jwt?distro=trixie
    affected_versions: vers:deb/4.4.3-1
    fixed_versions: vers:deb/5.0.0+really4.5.2-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1086792
    reference_type:
    reference_id: 1086792
