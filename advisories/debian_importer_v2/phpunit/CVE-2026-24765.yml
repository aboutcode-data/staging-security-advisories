advisory_id: phpunit/CVE-2026-24765
datasource_id: debian_importer_v2/phpunit/CVE-2026-24765
datasource_url: https://security-tracker.debian.org/tracker/CVE-2026-24765
aliases:
  - CVE-2026-24765
summary: PHPUnit is a testing framework for PHP. A vulnerability has been discovered in versions
  prior to 12.5.8, 11.5.50, 10.5.62, 9.6.33, and 8.5.52 involving unsafe deserialization of
  code coverage data in PHPT test execution. The vulnerability exists in the `cleanupForCoverage()`
  method, which deserializes code coverage files without validation, potentially allowing remote
  code execution if malicious `.coverage` files are present prior to the execution of the PHPT
  test. The vulnerability occurs when a `.coverage` file, which should not exist before test
  execution, is deserialized without the `allowed_classes` parameter restriction. An attacker
  with local file write access can place a malicious serialized object with a `__wakeup()` method
  into the file system, leading to arbitrary code execution during test runs with code coverage
  instrumentation enabled. This vulnerability requires local file write access to the location
  where PHPUnit stores or expects code coverage files for PHPT tests. This can occur through
  CI/CD pipeline attacks, the local development environment, and/or compromised dependencies.
  Rather than just silently sanitizing the input via `['allowed_classes' => false]`, the maintainer
  has chosen to make the anomalous state explicit by treating pre-existing `.coverage` files
  for PHPT tests as an error condition. Starting in versions  in versions 12.5.8, 11.5.50, 10.5.62,
  9.6.33, when a `.coverage` file is detected for a PHPT test prior to execution, PHPUnit will
  emit a clear error message identifying the anomalous state. Organizations can reduce the effective
  risk of this vulnerability through proper CI/CD configuration, including ephemeral runners,
  code review enforcement, branch protection, artifact isolation, and access control.
impacted_packages:
  - purl: pkg:deb/debian/phpunit?distro=trixie
    affected_versions: vers:deb/9.6.7-1|11.5.19-1
    fixed_versions: vers:deb/9.5.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/phpunit?distro=trixie
    affected_versions: vers:deb/9.6.7-1|11.5.19-1
    fixed_versions: vers:deb/9.5.2-1+deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/phpunit?distro=trixie
    affected_versions: vers:deb/9.6.7-1|11.5.19-1
    fixed_versions: vers:deb/13.0.0-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/phpunit?distro=trixie
    affected_versions: vers:deb/9.6.7-1|11.5.19-1
    fixed_versions: vers:deb/12.5.8-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
