advisory_id: xen/CVE-2019-19577
datasource_id: debian_importer_v2/xen/CVE-2019-19577
datasource_url: https://security-tracker.debian.org/tracker/CVE-2019-19577
aliases:
  - CVE-2019-19577
summary: An issue was discovered in Xen through 4.12.x allowing x86 AMD HVM guest OS users to
  cause a denial of service or possibly gain privileges by triggering data-structure access
  during pagetable-height updates. When running on AMD systems with an IOMMU, Xen attempted
  to dynamically adapt the number of levels of pagetables (the pagetable height) in the IOMMU
  according to the guest's address space size. The code to select and update the height had
  several bugs. Notably, the update was done without taking a lock which is necessary for safe
  operation. A malicious guest administrator can cause Xen to access data structures while they
  are being modified, causing Xen to crash. Privilege escalation is thought to be very difficult
  but cannot be ruled out. Additionally, there is a potential memory leak of 4kb per guest boot,
  under memory pressure. Only Xen on AMD CPUs is vulnerable. Xen running on Intel CPUs is not
  vulnerable. ARM systems are not vulnerable. Only systems where guests are given direct access
  to physical devices are vulnerable. Systems which do not use PCI pass-through are not vulnerable.
  Only HVM guests can exploit the vulnerability. PV and PVH guests cannot. All versions of Xen
  with IOMMU support are vulnerable.
impacted_packages:
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.17.5+72-g01140da4e8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.11.3+24-g14b62ab3e5-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.14.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.20.2+37-g61ff35323e-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-0+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=947944
    reference_type:
    reference_id: 947944
