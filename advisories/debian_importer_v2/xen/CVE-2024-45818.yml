advisory_id: xen/CVE-2024-45818
datasource_id: debian_importer_v2/xen/CVE-2024-45818
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-45818
aliases:
  - CVE-2024-45818
summary: The hypervisor contains code to accelerate VGA memory accesses for HVM guests, when
  the (virtual) VGA is in "standard" mode.  Locking involved there has an unusual discipline,
  leaving a lock acquired past the return from the function that acquired it.  This behavior
  results in a problem when emulating an instruction with two memory accesses, both of which
  touch VGA memory (plus some further constraints which aren't relevant here).  When emulating
  the 2nd access, the lock that is already being held would be attempted to be re-acquired,
  resulting in a deadlock.  This deadlock was already found when the code was first introduced,
  but was analysed incorrectly and the fix was incomplete.  Analysis in light of the new finding
  cannot find a way to make the existing locking discipline work.  In staging, this logic has
  all been removed because it was discovered to be accidentally disabled since Xen 4.7.  Therefore,
  we are fixing the locking problem by backporting the removal of most of the feature.  Note
  that even with the feature disabled, the lock would still be acquired for any accesses to
  the VGA MMIO region.
impacted_packages:
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.5+72-g01140da4e8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.5+23-ga4e5191dc0-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+37-g61ff35323e-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.19.1-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-0+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
