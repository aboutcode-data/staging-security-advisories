advisory_id: xen/CVE-2025-58149
datasource_id: debian_importer_v2/xen/CVE-2025-58149
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-58149
aliases:
  - CVE-2025-58149
summary: When passing through PCI devices, the detach logic in libxl won't remove access permissions
  to any 64bit memory BARs the device might have.  As a result a domain can still have access
  any 64bit memory BAR when such device is no longer assigned to the domain.  For PV domains
  the permission leak allows the domain itself to map the memory in the page-tables.  For HVM
  it would require a compromised device model or stubdomain to map the leaked memory into the
  HVM domain p2m.
impacted_packages:
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.5+72-g01140da4e8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+37-g61ff35323e-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-0+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1120075
    reference_type:
    reference_id: 1120075
