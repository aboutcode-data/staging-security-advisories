advisory_id: xen/CVE-2021-28710
datasource_id: debian_importer_v2/xen/CVE-2021-28710
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-28710
aliases:
  - CVE-2021-28710
summary: certain VT-d IOMMUs may not work in shared page table mode For efficiency reasons,
  address translation control structures (page tables) may (and, on suitable hardware, by default
  will) be shared between CPUs, for second-level translation (EPT), and IOMMUs. These page tables
  are presently set up to always be 4 levels deep. However, an IOMMU may require the use of
  just 3 page table levels. In such a configuration the lop level table needs to be stripped
  before inserting the root table's address into the hardware pagetable base register. When
  sharing page tables, Xen erroneously skipped this stripping. Consequently, the guest is able
  to write to leaf page table entries.
impacted_packages:
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.17.5+72-g01140da4e8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.14.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.20.2+37-g61ff35323e-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-0+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
