advisory_id: xen/CVE-2018-12892
datasource_id: debian_importer_v2/xen/CVE-2018-12892
datasource_url: https://security-tracker.debian.org/tracker/CVE-2018-12892
aliases:
  - CVE-2018-12892
summary: An issue was discovered in Xen 4.7 through 4.10.x. libxl fails to pass the readonly
  flag to qemu when setting up a SCSI disk, due to what was probably an erroneous merge conflict
  resolution. Malicious guest administrators or (in some situations) users may be able to write
  to supposedly read-only disk images. Only emulated SCSI disks (specified as "sd" in the libxl
  disk configuration, or an equivalent) are affected. IDE disks ("hd") are not affected (because
  attempts to make them readonly are rejected). Additionally, CDROM devices (that is, devices
  specified to be presented to the guest as CDROMs, regardless of the nature of the backing
  storage on the host) are not affected; they are always read only. Only systems using qemu-xen
  (rather than qemu-xen-traditional) as the device model version are vulnerable. Only systems
  using libxl or libxl-based toolstacks are vulnerable. (This includes xl, and libvirt with
  the libxl driver.) The vulnerability is present in Xen versions 4.7 and later. (In earlier
  versions, provided that the patch for XSA-142 has been applied, attempts to create read only
  disks are rejected.) If the host and guest together usually support PVHVM, the issue is exploitable
  only if the malicious guest administrator has control of the guest kernel or guest kernel
  command line.
impacted_packages:
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.17.5+72-g01140da4e8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.14.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.20.2+37-g61ff35323e-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-0+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
