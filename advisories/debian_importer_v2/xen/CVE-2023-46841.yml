advisory_id: xen/CVE-2023-46841
datasource_id: debian_importer_v2/xen/CVE-2023-46841
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-46841
aliases:
  - CVE-2023-46841
summary: 'Recent x86 CPUs offer functionality named Control-flow Enforcement Technology (CET).  A
  sub-feature of this are Shadow Stacks (CET-SS). CET-SS is a hardware feature designed to protect
  against Return Oriented Programming attacks. When enabled, traditional stacks holding both
  data and return addresses are accompanied by so called "shadow stacks", holding little more
  than return addresses.  Shadow stacks aren''t writable by normal instructions, and upon function
  returns their contents are used to check for possible manipulation of a return address coming
  from the traditional stack.  In particular certain memory accesses need intercepting by Xen.  In
  various cases the necessary emulation involves kind of replaying of the instruction.  Such
  replaying typically involves filling and then invoking of a stub.  Such a replayed instruction
  may raise an exceptions, which is expected and dealt with accordingly.  Unfortunately the
  interaction of both of the above wasn''t right: Recovery involves removal of a call frame
  from the (traditional) stack. The counterpart of this operation for the shadow stack was missing.'
impacted_packages:
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.5+72-g01140da4e8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.5+23-ga4e5191dc0-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+37-g61ff35323e-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.3+36-g54dacb5c02-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-0+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
