advisory_id: xen/CVE-2023-46835
datasource_id: debian_importer_v2/xen/CVE-2023-46835
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-46835
aliases:
  - CVE-2023-46835
summary: The current setup of the quarantine page tables assumes that the quarantine domain
  (dom_io) has been initialized with an address width of DEFAULT_DOMAIN_ADDRESS_WIDTH (48) and
  hence 4 page table levels.  However dom_io being a PV domain gets the AMD-Vi IOMMU page tables
  levels based on the maximum (hot pluggable) RAM address, and hence on systems with no RAM
  above the 512GB mark only 3 page-table levels are configured in the IOMMU.  On systems without
  RAM above the 512GB boundary amd_iommu_quarantine_init() will setup page tables for the scratch
  page with 4 levels, while the IOMMU will be configured to use 3 levels only, resulting in
  the last page table directory (PDE) effectively becoming a page table entry (PTE), and hence
  a device in quarantine mode gaining write access to the page destined to be a PDE.  Due to
  this page table level mismatch, the sink page the device gets read/write access to is no longer
  cleared between device assignment, possibly leading to data leaks.
impacted_packages:
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.5+72-g01140da4e8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.2+76-ge1f9cb16e2-1~deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.2+76-ge1f9cb16e2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+37-g61ff35323e-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-0+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1056928
    reference_type:
    reference_id: 1056928
