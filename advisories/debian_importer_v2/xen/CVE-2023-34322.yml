advisory_id: xen/CVE-2023-34322
datasource_id: debian_importer_v2/xen/CVE-2023-34322
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-34322
aliases:
  - CVE-2023-34322
summary: For migration as well as to work around kernels unaware of L1TF (see XSA-273), PV guests
  may be run in shadow paging mode.  Since Xen itself needs to be mapped when PV guests run,
  Xen and shadowed PV guests run directly the respective shadow page tables.  For 64-bit PV
  guests this means running on the shadow of the guest root page table.  In the course of dealing
  with shortage of memory in the shadow pool associated with a domain, shadows of page tables
  may be torn down.  This tearing down may include the shadow root page table that the CPU in
  question is presently running on.  While a precaution exists to supposedly prevent the tearing
  down of the underlying live page table, the time window covered by that precaution isn't large
  enough.
impacted_packages:
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.5+72-g01140da4e8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.2+76-ge1f9cb16e2-1~deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.17.2+55-g0b56bed864-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+37-g61ff35323e-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions: vers:deb/4.14.6-1
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-0+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
