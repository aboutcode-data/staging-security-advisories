advisory_id: xen/CVE-2020-29483
datasource_id: debian_importer_v2/xen/CVE-2020-29483
datasource_url: https://security-tracker.debian.org/tracker/CVE-2020-29483
aliases:
  - CVE-2020-29483
summary: An issue was discovered in Xen through 4.14.x. Xenstored and guests communicate via
  a shared memory page using a specific protocol. When a guest violates this protocol, xenstored
  will drop the connection to that guest. Unfortunately, this is done by just removing the guest
  from xenstored's internal management, resulting in the same actions as if the guest had been
  destroyed, including sending an @releaseDomain event. @releaseDomain events do not say that
  the guest has been removed. All watchers of this event must look at the states of all guests
  to find the guest that has been removed. When an @releaseDomain is generated due to a domain
  xenstored protocol violation, because the guest is still running, the watchers will not react.
  Later, when the guest is actually destroyed, xenstored will no longer have it stored in its
  internal data base, so no further @releaseDomain event will be sent. This can lead to a zombie
  domain; memory mappings of that guest's memory will not be removed, due to the missing event.
  This zombie domain will be cleaned up only after another domain is destroyed, as that will
  trigger another @releaseDomain event. If the device model of the guest that violated the Xenstore
  protocol is running in a stub-domain, a use-after-free case could happen in xenstored, after
  having removed the guest from its internal data base, possibly resulting in a crash of xenstored.
  A malicious guest can block resources of the host for a period after its own death. Guests
  with a stub domain device model can eventually crash xenstored, resulting in a more serious
  denial of service (the prevention of any further domain management operations). Only the C
  variant of Xenstore is affected; the Ocaml variant is not affected. Only HVM guests with a
  stubdom device model can cause a serious DoS.
impacted_packages:
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.17.5+72-g01140da4e8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.14.0+88-g1d1d1f5391-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.14.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.20.2+37-g61ff35323e-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/xen?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.20.2+7-g1badcf5035-0+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
