advisory_id: linux-6.1/CVE-2026-22976
datasource_id: debian_importer_v2/linux-6.1/CVE-2026-22976
datasource_url: https://security-tracker.debian.org/tracker/CVE-2026-22976
aliases:
  - CVE-2026-22976
summary: "In the Linux kernel, the following vulnerability has been resolved:  net/sched: sch_qfq:\
  \ Fix NULL deref when deactivating inactive aggregate in qfq_reset  `qfq_class->leaf_qdisc->q.qlen\
  \ > 0` does not imply that the class itself is active.  Two qfq_class objects may point to\
  \ the same leaf_qdisc. This happens when:  1. one QFQ qdisc is attached to the dev as the\
  \ root qdisc, and  2. another QFQ qdisc is temporarily referenced (e.g., via qdisc_get() /\
  \ qdisc_put()) and is pending to be destroyed, as in function tc_new_tfilter.  When packets\
  \ are enqueued through the root QFQ qdisc, the shared leaf_qdisc->q.qlen increases. At the\
  \ same time, the second QFQ qdisc triggers qdisc_put and qdisc_destroy: the qdisc enters qfq_reset()\
  \ with its own q->q.qlen == 0, but its class's leaf qdisc->q.qlen > 0. Therefore, the qfq_reset\
  \ would wrongly deactivate an inactive aggregate and trigger a null-deref in qfq_deactivate_agg:\
  \  [    0.903172] BUG: kernel NULL pointer dereference, address: 0000000000000000 [    0.903571]\
  \ #PF: supervisor write access in kernel mode [    0.903860] #PF: error_code(0x0002) - not-present\
  \ page [    0.904177] PGD 10299b067 P4D 10299b067 PUD 10299c067 PMD 0 [    0.904502] Oops:\
  \ Oops: 0002 [#1] SMP NOPTI [    0.904737] CPU: 0 UID: 0 PID: 135 Comm: exploit Not tainted\
  \ 6.19.0-rc3+ #2 NONE [    0.905157] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996),\
  \ BIOS rel-1.17.0-0-gb52ca86e094d-prebuilt.qemu.org 04/01/2014 [    0.905754] RIP: 0010:qfq_deactivate_agg\
  \ (include/linux/list.h:992 (discriminator 2) include/linux/list.h:1006 (discriminator 2)\
  \ net/sched/sch_qfq.c:1367 (discriminator 2) net/sched/sch_qfq.c:1393 (discriminator 2)) [\
  \    0.906046] Code: 0f 84 4d 01 00 00 48 89 70 18 8b 4b 10 48 c7 c2 ff ff ff ff 48 8b 78\
  \ 08 48 d3 e2 48 21 f2 48 2b 13 48 8b 30 48 d3 ea 8b 4b 18 0  Code starting with the faulting\
  \ instruction ===========================================    0:\t0f 84 4d 01 00 00    \tje\
  \     0x153    6:\t48 89 70 18          \tmov    %rsi,0x18(%rax)    a:\t8b 4b 10         \
  \    \tmov    0x10(%rbx),%ecx    d:\t48 c7 c2 ff ff ff ff \tmov    $0xffffffffffffffff,%rdx\
  \   14:\t48 8b 78 08          \tmov    0x8(%rax),%rdi   18:\t48 d3 e2             \tshl  \
  \  %cl,%rdx   1b:\t48 21 f2             \tand    %rsi,%rdx   1e:\t48 2b 13             \t\
  sub    (%rbx),%rdx   21:\t48 8b 30             \tmov    (%rax),%rsi   24:\t48 d3 ea      \
  \       \tshr    %cl,%rdx   27:\t8b 4b 18             \tmov    0x18(%rbx),%ecx \t... [   \
  \ 0.907095] RSP: 0018:ffffc900004a39a0 EFLAGS: 00010246 [    0.907368] RAX: ffff8881043a0880\
  \ RBX: ffff888102953340 RCX: 0000000000000000 [    0.907723] RDX: 0000000000000000 RSI: 0000000000000000\
  \ RDI: 0000000000000000 [    0.908100] RBP: ffff888102952180 R08: 0000000000000000 R09: 0000000000000000\
  \ [    0.908451] R10: ffff8881043a0000 R11: 0000000000000000 R12: ffff888102952000 [    0.908804]\
  \ R13: ffff888102952180 R14: ffff8881043a0ad8 R15: ffff8881043a0880 [    0.909179] FS:  000000002a1a0380(0000)\
  \ GS:ffff888196d8d000(0000) knlGS:0000000000000000 [    0.909572] CS:  0010 DS: 0000 ES: 0000\
  \ CR0: 0000000080050033 [    0.909857] CR2: 0000000000000000 CR3: 0000000102993002 CR4: 0000000000772ef0\
  \ [    0.910247] PKRU: 55555554 [    0.910391] Call Trace: [    0.910527]  <TASK> [    0.910638]\
  \  qfq_reset_qdisc (net/sched/sch_qfq.c:357 net/sched/sch_qfq.c:1485) [    0.910826]  qdisc_reset\
  \ (include/linux/skbuff.h:2195 include/linux/skbuff.h:2501 include/linux/skbuff.h:3424 include/linux/skbuff.h:3430\
  \ net/sched/sch_generic.c:1036) [    0.911040]  __qdisc_destroy (net/sched/sch_generic.c:1076)\
  \ [    0.911236]  tc_new_tfilter (net/sched/cls_api.c:2447) [    0.911447]  rtnetlink_rcv_msg\
  \ (net/core/rtnetlink.c:6958) [    0.911663]  ? __pfx_rtnetlink_rcv_msg (net/core/rtnetlink.c:6861)\
  \ [    0.911894]  netlink_rcv_skb (net/netlink/af_netlink.c:2550) [    0.912100]  netlink_unicast\
  \ (net/netlink/af_netlink.c:1319 net/netlink/af_netlink.c:1344) [    0.912296]  ? __alloc_skb\
  \ (net/core/skbuff.c:706) [    0.912484]  netlink_sendmsg (net/netlink/af ---truncated---"
impacted_packages: []
severities: []
weaknesses: []
references: []
