advisory_id: linux-6.1/CVE-2025-40343
datasource_id: debian_importer_v2/linux-6.1/CVE-2025-40343
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40343
aliases:
  - CVE-2025-40343
summary: 'In the Linux kernel, the following vulnerability has been resolved:  nvmet-fc: avoid
  scheduling association deletion twice  When forcefully shutting down a port via the configfs
  interface, nvmet_port_subsys_drop_link() first calls nvmet_port_del_ctrls() and then nvmet_disable_port().
  Both functions will eventually schedule all remaining associations for deletion.  The current
  implementation checks whether an association is about to be removed, but only after the work
  item has already been scheduled. As a result, it is possible for the first scheduled work
  item to free all resources, and then for the same work item to be scheduled again for deletion.  Because
  the association list is an RCU list, it is not possible to take a lock and remove the list
  entry directly, so it cannot be looked up again. Instead, a flag (terminating) must be used
  to determine whether the association is already in the process of being deleted.'
impacted_packages: []
severities: []
weaknesses: []
references: []
