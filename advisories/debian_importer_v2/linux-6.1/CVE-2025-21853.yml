advisory_id: linux-6.1/CVE-2025-21853
datasource_id: debian_importer_v2/linux-6.1/CVE-2025-21853
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-21853
aliases:
  - CVE-2025-21853
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: avoid holding
  freeze_mutex during mmap operation  We use map->freeze_mutex to prevent races between map_freeze()
  and memory mapping BPF map contents with writable permissions. The way we naively do this
  means we''ll hold freeze_mutex for entire duration of all the mm and VMA manipulations, which
  is completely unnecessary. This can potentially also lead to deadlocks, as reported by syzbot
  in [0].  So, instead, hold freeze_mutex only during writeability checks, bump (proactively)
  "write active" count for the map, unlock the mutex and proceed with mmap logic. And only if
  something went wrong during mmap logic, then undo that "write active" counter increment.    [0]
  https://lore.kernel.org/bpf/678dcbc9.050a0220.303755.0066.GAE@google.com/'
impacted_packages: []
severities: []
weaknesses: []
references: []
