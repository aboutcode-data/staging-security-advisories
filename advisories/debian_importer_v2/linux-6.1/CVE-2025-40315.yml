advisory_id: linux-6.1/CVE-2025-40315
datasource_id: debian_importer_v2/linux-6.1/CVE-2025-40315
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40315
aliases:
  - CVE-2025-40315
summary: 'In the Linux kernel, the following vulnerability has been resolved:  usb: gadget:
  f_fs: Fix epfile null pointer access after ep enable.  A race condition occurs when ffs_func_eps_enable()
  runs concurrently with ffs_data_reset(). The ffs_data_clear() called in ffs_data_reset() sets
  ffs->epfiles to NULL before resetting ffs->eps_count to 0, leading to a NULL pointer dereference
  when accessing epfile->ep in ffs_func_eps_enable() after successful usb_ep_enable().  The
  ffs->epfiles pointer is set to NULL in both ffs_data_clear() and ffs_data_close() functions,
  and its modification is protected by the spinlock ffs->eps_lock. And the whole ffs_func_eps_enable()
  function is also protected by ffs->eps_lock.  Thus, add NULL pointer handling for ffs->epfiles
  in the ffs_func_eps_enable() function to fix issues'
impacted_packages: []
severities: []
weaknesses: []
references: []
