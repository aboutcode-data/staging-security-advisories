advisory_id: linux-6.1/CVE-2025-40314
datasource_id: debian_importer_v2/linux-6.1/CVE-2025-40314
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40314
aliases:
  - CVE-2025-40314
summary: 'In the Linux kernel, the following vulnerability has been resolved:  usb: cdns3: gadget:
  Use-after-free during failed initialization and exit of cdnsp gadget  In the __cdnsp_gadget_init()
  and cdnsp_gadget_exit() functions, the gadget structure (pdev->gadget) was freed before its
  endpoints. The endpoints are linked via the ep_list in the gadget structure. Freeing the gadget
  first leaves dangling pointers in the endpoint list. When the endpoints are subsequently freed,
  this results in a use-after-free.  Fix: By separating the usb_del_gadget_udc() operation into
  distinct "del" and "put" steps, cdnsp_gadget_free_endpoints() can be executed prior to the
  final release of the gadget structure with usb_put_gadget().  A patch similar to bb9c74a5bd14("usb:
  dwc3: gadget: Free gadget structure  only after freeing endpoints").'
impacted_packages: []
severities: []
weaknesses: []
references: []
