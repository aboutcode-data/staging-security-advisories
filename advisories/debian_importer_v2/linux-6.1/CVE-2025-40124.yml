advisory_id: linux-6.1/CVE-2025-40124
datasource_id: debian_importer_v2/linux-6.1/CVE-2025-40124
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40124
aliases:
  - CVE-2025-40124
summary: 'In the Linux kernel, the following vulnerability has been resolved:  sparc: fix accurate
  exception reporting in copy_{from_to}_user for UltraSPARC III  Anthony Yznaga tracked down
  that a BUG_ON in ext4 code with large folios enabled resulted from copy_from_user() returning
  impossibly large values greater than the size to be copied. This lead to __copy_from_iter()
  returning impossible values instead of the actual number of bytes it was able to copy.  The
  BUG_ON has been reported in https://lore.kernel.org/r/b14f55642207e63e907965e209f6323a0df6dcee.camel@physik.fu-berlin.de  The
  referenced commit introduced exception handlers on user-space memory references in copy_from_user
  and copy_to_user. These handlers return from the respective function and calculate the remaining
  bytes left to copy using the current register contents. The exception handlers expect that
  %o2 has already been masked during the bulk copy loop, but the masking was performed after
  that loop. This will fix the return value of copy_from_user and copy_to_user in the faulting
  case. The behaviour of memcpy stays unchanged.'
impacted_packages: []
severities: []
weaknesses: []
references: []
