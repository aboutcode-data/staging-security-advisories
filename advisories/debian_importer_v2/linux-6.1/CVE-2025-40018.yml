advisory_id: linux-6.1/CVE-2025-40018
datasource_id: debian_importer_v2/linux-6.1/CVE-2025-40018
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40018
aliases:
  - CVE-2025-40018
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ipvs: Defer ip_vs_ftp
  unregister during netns cleanup  On the netns cleanup path, __ip_vs_ftp_exit() may unregister
  ip_vs_ftp before connections with valid cp->app pointers are flushed, leading to a use-after-free.  Fix
  this by introducing a global `exiting_module` flag, set to true in ip_vs_ftp_exit() before
  unregistering the pernet subsystem. In __ip_vs_ftp_exit(), skip ip_vs_ftp unregister if called
  during netns cleanup (when exiting_module is false) and defer it to __ip_vs_cleanup_batch(),
  which unregisters all apps after all connections are flushed. If called during module exit,
  unregister ip_vs_ftp immediately.'
impacted_packages: []
severities: []
weaknesses: []
references: []
