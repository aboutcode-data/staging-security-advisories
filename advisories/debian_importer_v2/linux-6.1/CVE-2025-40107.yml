advisory_id: linux-6.1/CVE-2025-40107
datasource_id: debian_importer_v2/linux-6.1/CVE-2025-40107
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40107
aliases:
  - CVE-2025-40107
summary: 'In the Linux kernel, the following vulnerability has been resolved:  can: hi311x:
  fix null pointer dereference when resuming from sleep before interface was enabled  This issue
  is similar to the vulnerability in the `mcp251x` driver, which was fixed in commit 03c427147b2d
  ("can: mcp251x: fix resume from sleep before interface was brought up").  In the `hi311x`
  driver, when the device resumes from sleep, the driver schedules `priv->restart_work`. However,
  if the network interface was not previously enabled, the `priv->wq` (workqueue) is not allocated
  and initialized, leading to a null pointer dereference.  To fix this, we move the allocation
  and initialization of the workqueue from the `hi3110_open` function to the `hi3110_can_probe`
  function. This ensures that the workqueue is properly initialized before it is used during
  device resume. And added logic to destroy the workqueue in the error handling paths of `hi3110_can_probe`
  and in the `hi3110_can_remove` function to prevent resource leaks.'
impacted_packages: []
severities: []
weaknesses: []
references: []
