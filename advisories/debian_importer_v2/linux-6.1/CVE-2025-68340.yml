advisory_id: linux-6.1/CVE-2025-68340
datasource_id: debian_importer_v2/linux-6.1/CVE-2025-68340
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-68340
aliases:
  - CVE-2025-68340
summary: 'In the Linux kernel, the following vulnerability has been resolved:  team: Move team
  device type change at the end of team_port_add  Attempting to add a port device that is already
  up will expectedly fail, but not before modifying the team device header_ops.  In the case
  of the syzbot reproducer the gre0 device is already in state UP when it attempts to add it
  as a port device of team0, this fails but before that header_ops->create of team0 is changed
  from eth_header to ipgre_header in the call to team_dev_type_check_change.  Later when we
  end up in ipgre_header() struct ip_tunnel* points to nonsense as the private data of the device
  still holds a struct team.  Example sequence of iproute2 commands to reproduce the hang/BUG():
  ip link add dev team0 type team ip link add dev gre0 type gre ip link set dev gre0 up ip link
  set dev gre0 master team0 ip link set dev team0 up ping -I team0 1.1.1.1  Move team_dev_type_check_change
  down where all other checks have passed as it changes the dev type with no way to restore
  it in case one of the checks that follow it fail.  Also make sure to preserve the origial
  mtu assignment:   - If port_dev is not the same type as dev, dev takes mtu from port_dev   -
  If port_dev is the same type as dev, port_dev takes mtu from dev  This is done by adding a
  conditional before the call to dev_set_mtu to prevent it from assigning port_dev->mtu = dev->mtu
  and instead letting team_dev_type_check_change assign dev->mtu = port_dev->mtu. The conditional
  is needed because the patch moves the call to team_dev_type_check_change past dev_set_mtu.  Testing:   -
  team device driver in-tree selftests   - Add/remove various devices as slaves of team device   -
  syzbot'
impacted_packages: []
severities: []
weaknesses: []
references: []
