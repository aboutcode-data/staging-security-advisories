advisory_id: linux-6.1/CVE-2024-49978
datasource_id: debian_importer_v2/linux-6.1/CVE-2024-49978
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-49978
aliases:
  - CVE-2024-49978
summary: 'In the Linux kernel, the following vulnerability has been resolved:  gso: fix udp
  gso fraglist segmentation after pull from frag_list  Detect gso fraglist skbs with corrupted
  geometry (see below) and pass these to skb_segment instead of skb_segment_list, as the first
  can segment them correctly.  Valid SKB_GSO_FRAGLIST skbs - consist of two or more segments
  - the head_skb holds the protocol headers plus first gso_size - one or more frag_list skbs
  hold exactly one segment - all but the last must be gso_size  Optional datapath hooks such
  as NAT and BPF (bpf_skb_pull_data) can modify these skbs, breaking these invariants.  In extreme
  cases they pull all data into skb linear. For UDP, this causes a NULL ptr deref in __udpv4_gso_segment_list_csum
  at udp_hdr(seg->next)->dest.  Detect invalid geometry due to pull, by checking head_skb size.
  Don''t just drop, as this may blackhole a destination. Convert to be able to pass to regular
  skb_segment.'
impacted_packages: []
severities: []
weaknesses: []
references: []
