advisory_id: linux-6.1/CVE-2025-38000
datasource_id: debian_importer_v2/linux-6.1/CVE-2025-38000
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-38000
aliases:
  - CVE-2025-38000
summary: 'In the Linux kernel, the following vulnerability has been resolved:  sch_hfsc: Fix
  qlen accounting bug when using peek in hfsc_enqueue()  When enqueuing the first packet to
  an HFSC class, hfsc_enqueue() calls the child qdisc''s peek() operation before incrementing
  sch->q.qlen and sch->qstats.backlog. If the child qdisc uses qdisc_peek_dequeued(), this may
  trigger an immediate dequeue and potential packet drop. In such cases, qdisc_tree_reduce_backlog()
  is called, but the HFSC qdisc''s qlen and backlog have not yet been updated, leading to inconsistent
  queue accounting. This can leave an empty HFSC class in the active list, causing further consequences
  like use-after-free.  This patch fixes the bug by moving the increment of sch->q.qlen and
  sch->qstats.backlog before the call to the child qdisc''s peek() operation. This ensures that
  queue length and backlog are always accurate when packet drops or dequeues are triggered during
  the peek.'
impacted_packages: []
severities: []
weaknesses: []
references: []
