advisory_id: linux-6.1/CVE-2025-40248
datasource_id: debian_importer_v2/linux-6.1/CVE-2025-40248
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-40248
aliases:
  - CVE-2025-40248
summary: 'In the Linux kernel, the following vulnerability has been resolved:  vsock: Ignore
  signal/timeout on connect() if already established  During connect(), acting on a signal/timeout
  by disconnecting an already established socket leads to several issues:  1. connect() invoking
  vsock_transport_cancel_pkt() ->    virtio_transport_purge_skbs() may race with sendmsg() invoking    virtio_transport_get_credit().
  This results in a permanently elevated    `vvs->bytes_unsent`. Which, in turn, confuses the
  SOCK_LINGER handling.  2. connect() resetting a connected socket''s state may race with socket    being
  placed in a sockmap. A disconnected socket remaining in a sockmap    breaks sockmap''s assumptions.
  And gives rise to WARNs.  3. connect() transitioning SS_CONNECTED -> SS_UNCONNECTED allows
  for a    transport change/drop after TCP_ESTABLISHED. Which poses a problem for    any simultaneous
  sendmsg() or connect() and may result in a    use-after-free/null-ptr-deref.  Do not disconnect
  socket on signal/timeout. Keep the logic for unconnected sockets: they don''t linger, can''t
  be placed in a sockmap, are rejected by sendmsg().  [1]: https://lore.kernel.org/netdev/e07fd95c-9a38-4eea-9638-133e38c2ec9b@rbox.co/
  [2]: https://lore.kernel.org/netdev/20250317-vsock-trans-signal-race-v4-0-fc8837f3f1d4@rbox.co/
  [3]: https://lore.kernel.org/netdev/60f1b7db-3099-4f6a-875e-af9f6ef194f6@rbox.co/'
impacted_packages: []
severities: []
weaknesses: []
references: []
