advisory_id: wget/CVE-2017-13090
datasource_id: debian_importer_v2/wget/CVE-2017-13090
datasource_url: https://security-tracker.debian.org/tracker/CVE-2017-13090
aliases:
  - CVE-2017-13090
summary: The retr.c:fd_read_body() function is called when processing OK responses. When the
  response is sent chunked in wget before 1.19.2, the chunk parser uses strtol() to read each
  chunk's length, but doesn't check that the chunk length is a non-negative number. The code
  then tries to read the chunk in pieces of 8192 bytes by using the MIN() macro, but ends up
  passing the negative chunk length to retr.c:fd_read(). As fd_read() takes an int argument,
  the high 32 bits of the chunk length are discarded, leaving fd_read() with a completely attacker
  controlled length argument. The attacker can corrupt malloc metadata after the allocated buffer.
impacted_packages:
  - purl: pkg:deb/debian/wget?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.21.3-1+deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/wget?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.19.2-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/wget?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.21-1+deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/wget?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.25.0-2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=879957
    reference_type:
    reference_id: 879957
