advisory_id: node-matrix-js-sdk/CVE-2022-39249
datasource_id: debian_importer_v2/node-matrix-js-sdk/CVE-2022-39249
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-39249
aliases:
  - CVE-2022-39249
summary: Matrix Javascript SDK is the Matrix Client-Server SDK for JavaScript. Prior to version
  19.7.0, an attacker cooperating with a malicious homeserver can construct messages appearing
  to have come from another person. Such messages will be marked with a grey shield on some
  platforms, but this may be missing in others. This attack is possible due to the matrix-js-sdk
  implementing a too permissive key forwarding strategy on the receiving end. Starting with
  version 19.7.0, the default policy for accepting key forwards has been made more strict in
  the matrix-js-sdk. matrix-js-sdk will now only accept forwarded keys in response to previously
  issued requests and only from own, verified devices. The SDK now sets a `trusted` flag on
  the decrypted message upon decryption, based on whether the key used to decrypt the message
  was received from a trusted source. Clients need to ensure that messages decrypted with a
  key with `trusted = false` are decorated appropriately, for example, by showing a warning
  for such messages. This attack requires coordination between a malicious homeserver and an
  attacker, and those who trust your homeservers do not need a workaround.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1021136
    reference_type:
    reference_id: 1021136
