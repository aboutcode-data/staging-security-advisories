advisory_id: samba/CVE-2023-4154
datasource_id: debian_importer_v2/samba/CVE-2023-4154
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-4154
aliases:
  - CVE-2023-4154
summary: A design flaw was found in Samba's DirSync control implementation, which exposes passwords
  and secrets in Active Directory to privileged users and Read-Only Domain Controllers (RODCs).
  This flaw allows RODCs and users possessing the GET_CHANGES right to access all attributes,
  including sensitive secrets and passwords. Even in a default setup, RODC DC accounts, which
  should only replicate some passwords, can gain access to all domain secrets, including the
  vital krbtgt, effectively eliminating the RODC / DC distinction. Furthermore, the vulnerability
  fails to account for error conditions (fail open), like out-of-memory situations, potentially
  granting access to secret attributes, even under low-privileged attacker influence.
impacted_packages:
  - purl: pkg:deb/debian/samba?distro=trixie
    affected_versions: vers:deb/2:4.13.13+dfsg-1~deb11u6
    fixed_versions: vers:deb/2:4.17.12+dfsg-0+deb12u3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/samba?distro=trixie
    affected_versions: vers:deb/2:4.13.13+dfsg-1~deb11u6
    fixed_versions: vers:deb/2:4.17.12+dfsg-0+deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/samba?distro=trixie
    affected_versions: vers:deb/2:4.13.13+dfsg-1~deb11u6
    fixed_versions: vers:deb/2:4.23.5+dfsg-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/samba?distro=trixie
    affected_versions: vers:deb/2:4.13.13+dfsg-1~deb11u6
    fixed_versions: vers:deb/2:4.19.1+dfsg-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/samba?distro=trixie
    affected_versions: vers:deb/2:4.13.13+dfsg-1~deb11u6
    fixed_versions: vers:deb/2:4.23.6+dfsg-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/samba?distro=trixie
    affected_versions: vers:deb/2:4.13.13+dfsg-1~deb11u6
    fixed_versions: vers:deb/2:4.22.6+dfsg-0+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
