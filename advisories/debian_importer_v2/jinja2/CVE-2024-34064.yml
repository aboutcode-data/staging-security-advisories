advisory_id: jinja2/CVE-2024-34064
datasource_id: debian_importer_v2/jinja2/CVE-2024-34064
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-34064
aliases:
  - CVE-2024-34064
summary: Jinja is an extensible templating engine. The `xmlattr` filter in affected versions
  of Jinja accepts keys containing non-attribute characters. XML/HTML attributes cannot contain
  spaces, `/`, `>`, or `=`, as each would then be interpreted as starting a separate attribute.
  If an application accepts keys (as opposed to only values) as user input, and renders these
  in pages that other users see as well, an attacker could use this to inject other attributes
  and perform XSS. The fix for CVE-2024-22195 only addressed spaces but not other characters.
  Accepting keys as user input is now explicitly considered an unintended use case of the `xmlattr`
  filter, and code that does so without otherwise validating the input should be flagged as
  insecure, regardless of Jinja version. Accepting _values_ as user input continues to be safe.
  This vulnerability is fixed in 3.1.4.
impacted_packages:
  - purl: pkg:deb/debian/jinja2?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.1.2-1+deb12u3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/jinja2?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.1.2-1+deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/jinja2?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.11.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/jinja2?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.11.3-1+deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/jinja2?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.1.6-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/jinja2?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.1.3-1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1070712
    reference_type:
    reference_id: 1070712
