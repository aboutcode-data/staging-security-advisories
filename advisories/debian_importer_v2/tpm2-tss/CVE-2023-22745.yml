advisory_id: tpm2-tss/CVE-2023-22745
datasource_id: debian_importer_v2/tpm2-tss/CVE-2023-22745
datasource_url: https://security-tracker.debian.org/tracker/CVE-2023-22745
aliases:
  - CVE-2023-22745
summary: tpm2-tss is an open source software implementation of the Trusted Computing Group (TCG)
  Trusted Platform Module (TPM) 2 Software Stack (TSS2). In versions prior to 4.1.0-rc0, 4.0.1,
  and 3.2.2-rc1, `Tss2_RC_SetHandler` and `Tss2_RC_Decode` both index into `layer_handler` with
  an 8 bit layer number, but the array only has `TPM2_ERROR_TSS2_RC_LAYER_COUNT` entries, so
  trying to add a handler for higher-numbered layers or decode a response code with such a layer
  number reads/writes past the end of the buffer. This Buffer overrun, could result in arbitrary
  code execution. An example attack would be a MiTM bus attack that returns 0xFFFFFFFF for the
  RC. Given the common use case of TPM modules an attacker must have local access to the target
  machine with local system privileges which allows access to the TPM system. Usually TPM access
  requires administrative privilege. Versions 4.1.0-rc0, 4.0.1, and 3.2.2-rc1 fix the issue.
impacted_packages:
  - purl: pkg:deb/debian/tpm2-tss?distro=trixie
    affected_versions: vers:deb/3.0.3-2
    fixed_versions: vers:deb/3.2.1-3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/tpm2-tss?distro=trixie
    affected_versions: vers:deb/3.0.3-2
    fixed_versions: vers:deb/4.1.3-1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/tpm2-tss?distro=trixie
    affected_versions: vers:deb/3.0.3-2
    fixed_versions: vers:deb/4.1.3-4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/tpm2-tss?distro=trixie
    affected_versions: vers:deb/3.0.3-2
    fixed_versions: vers:deb/4.1.3-1.2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1029369
    reference_type:
    reference_id: 1029369
