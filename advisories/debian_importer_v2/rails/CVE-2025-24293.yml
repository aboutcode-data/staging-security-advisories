advisory_id: rails/CVE-2025-24293
datasource_id: debian_importer_v2/rails/CVE-2025-24293
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-24293
aliases:
  - CVE-2025-24293
summary: "# Active Storage allowed transformation methods potentially unsafe\r \r Active Storage\
  \ attempts to prevent the use of potentially unsafe image\r transformation methods and parameters\
  \ by default.\r \r The default allowed list contains three methods allow for the circumvention\r\
  \ of the safe defaults which enables potential command injection\r vulnerabilities in cases\
  \ where arbitrary user supplied input is accepted as\r valid transformation methods or parameters.\r\
  \ \r \r Impact\r ------\r This vulnerability impacts applications that use Active Storage\
  \ with the image_processing processing gem in addition to mini_magick as the image processor.\r\
  \ \r Vulnerable code will look something similar to this:\r ```\r <%= image_tag blob.variant(params[:t]\
  \ => params[:v]) %>\r ```\r \r Where the transformation method or its arguments are untrusted\
  \ arbitrary input.\r \r All users running an affected release should either upgrade or use\
  \ one of the workarounds immediately.\r \r \r \r Workarounds\r -----------\r Consuming user\
  \ supplied input for image transformation methods or their parameters is unsupported behavior\
  \ and should be considered dangerous.\r \r Strict validation of user supplied methods and\
  \ parameters should be performed\r as well as having a strong [ImageMagick security\r policy](https://imagemagick.org/script/security-policy.php)\
  \ deployed.\r \r Credits\r -------\r \r Thank you [lio346](https://hackerone.com/lio346) for\
  \ reporting this!"
impacted_packages:
  - purl: pkg:deb/debian/rails?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2:6.1.7.10+dfsg-1~deb12u2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/rails?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2:6.0.3.7+dfsg-2+deb11u2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/rails?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2:6.0.3.7+dfsg-2+deb11u4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/rails?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2:7.2.2.2+dfsg-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/rails?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2:7.2.2.2+dfsg-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/rails?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2:7.2.3+dfsg-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/rails?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2:7.2.2.2+dfsg-2~deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
