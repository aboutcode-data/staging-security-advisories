advisory_id: prometheus/CVE-2021-29622
datasource_id: debian_importer_v2/prometheus/CVE-2021-29622
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-29622
aliases:
  - CVE-2021-29622
summary: Prometheus is an open-source monitoring system and time series database. In 2.23.0,
  Prometheus changed its default UI to the New ui. To ensure a seamless transition, the URL's
  prefixed by /new redirect to /. Due to a bug in the code, it is possible for an attacker to
  craft an URL that can redirect to any other URL, in the /new endpoint. If a user visits a
  prometheus server with a specially crafted address, they can be redirected to an arbitrary
  URL. The issue was patched in the 2.26.1 and 2.27.1 releases. In 2.28.0, the /new endpoint
  will be removed completely. The workaround is to disable access to /new via a reverse proxy
  in front of Prometheus.
impacted_packages:
  - purl: pkg:deb/debian/prometheus?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.42.0+ds-5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/prometheus?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/prometheus?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.24.1+ds-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/prometheus?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.53.5+ds1-3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/prometheus?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.53.3+ds1-2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
