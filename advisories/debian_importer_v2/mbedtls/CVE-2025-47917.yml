advisory_id: mbedtls/CVE-2025-47917
datasource_id: debian_importer_v2/mbedtls/CVE-2025-47917
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-47917
aliases:
  - CVE-2025-47917
summary: Mbed TLS before 3.6.4 allows a use-after-free in certain situations of applications
  that are developed in accordance with the documentation. The function mbedtls_x509_string_to_names()
  takes a head argument that is documented as an output argument. The documentation does not
  suggest that the function will free that pointer; however, the function does call mbedtls_asn1_free_named_data_list()
  on that argument, which performs a deep free(). As a result, application code that uses this
  function (relying only on documented behavior) is likely to still hold pointers to the memory
  blocks that were freed, resulting in a high risk of use-after-free or double-free. In particular,
  the two sample programs x509/cert_write and x509/cert_req are affected (use-after-free if
  the san string contains more than one DN).
impacted_packages:
  - purl: pkg:deb/debian/mbedtls?distro=trixie
    affected_versions: vers:deb/2.28.3-1
    fixed_versions: vers:deb/2.16.9-0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/mbedtls?distro=trixie
    affected_versions: vers:deb/2.28.3-1
    fixed_versions: vers:deb/2.16.9-0.1+deb11u3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/mbedtls?distro=trixie
    affected_versions: vers:deb/2.28.3-1
    fixed_versions: vers:deb/3.6.5-0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/mbedtls?distro=trixie
    affected_versions: vers:deb/2.28.3-1
    fixed_versions: vers:deb/3.6.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/mbedtls?distro=trixie
    affected_versions: vers:deb/2.28.3-1
    fixed_versions: vers:deb/3.6.5-0.1~deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1108791
    reference_type:
    reference_id: 1108791
