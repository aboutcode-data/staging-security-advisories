advisory_id: mbedtls/CVE-2024-45159
datasource_id: debian_importer_v2/mbedtls/CVE-2024-45159
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-45159
aliases:
  - CVE-2024-45159
summary: An issue was discovered in Mbed TLS 3.x before 3.6.1. With TLS 1.3, when a server enables
  optional authentication of the client, if the client-provided certificate does not have appropriate
  values in if keyUsage or extKeyUsage extensions, then the return value of mbedtls_ssl_get_verify_result()
  would incorrectly have the MBEDTLS_X509_BADCERT_KEY_USAGE and MBEDTLS_X509_BADCERT_KEY_USAGE
  bits clear. As a result, an attacker that had a certificate valid for uses other than TLS
  client authentication would nonetheless be able to use it for TLS client authentication. Only
  TLS 1.3 servers were affected, and only with optional authentication (with required authentication,
  the handshake would be aborted with a fatal alert).
impacted_packages:
  - purl: pkg:deb/debian/mbedtls?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.28.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/mbedtls?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/mbedtls?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.16.9-0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/mbedtls?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.6.5-0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/mbedtls?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.6.5-0.1~deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
