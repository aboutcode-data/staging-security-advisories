advisory_id: libvirt/CVE-2024-4418
datasource_id: debian_importer_v2/libvirt/CVE-2024-4418
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-4418
aliases:
  - CVE-2024-4418
summary: A race condition leading to a stack use-after-free flaw was found in libvirt. Due to
  a bad assumption in the virNetClientIOEventLoop() method, the `data` pointer to a stack-allocated
  virNetClientIOEventData structure ended up being used in the virNetClientIOEventFD callback
  while the data pointer's stack frame was concurrently being "freed" when returning from virNetClientIOEventLoop().
  The 'virtproxyd' daemon can be used to trigger requests. If libvirt is configured with fine-grained
  access control, this issue, in theory, allows a user to escape their otherwise limited access.
  This flaw allows a local, unprivileged user to access virtproxyd without authenticating. Remote
  users would need to authenticate before they could access it.
impacted_packages:
  - purl: pkg:deb/debian/libvirt?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/9.0.0-4+deb12u2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libvirt?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libvirt?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/7.0.0-3+deb11u3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libvirt?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/12.0.0-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libvirt?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/10.3.0-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libvirt?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/11.3.0-3+deb13u2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1070330
    reference_type:
    reference_id: 1070330
