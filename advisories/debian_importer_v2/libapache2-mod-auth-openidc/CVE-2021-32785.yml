advisory_id: libapache2-mod-auth-openidc/CVE-2021-32785
datasource_id: debian_importer_v2/libapache2-mod-auth-openidc/CVE-2021-32785
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-32785
aliases:
  - CVE-2021-32785
summary: mod_auth_openidc is an authentication/authorization module for the Apache 2.x HTTP
  server that functions as an OpenID Connect Relying Party, authenticating users against an
  OpenID Connect Provider. When mod_auth_openidc versions prior to 2.4.9 are configured to use
  an unencrypted Redis cache (`OIDCCacheEncrypt off`, `OIDCSessionType server-cache`, `OIDCCacheType
  redis`), `mod_auth_openidc` wrongly performed argument interpolation before passing Redis
  requests to `hiredis`, which would perform it again and lead to an uncontrolled format string
  bug. Initial assessment shows that this bug does not appear to allow gaining arbitrary code
  execution, but can reliably provoke a denial of service by repeatedly crashing the Apache
  workers. This bug has been corrected in version 2.4.9 by performing argument interpolation
  only once, using the `hiredis` API. As a workaround, this vulnerability can be mitigated by
  setting `OIDCCacheEncrypt` to `on`, as cache keys are cryptographically hashed before use
  when this option is enabled.
impacted_packages:
  - purl: pkg:deb/debian/libapache2-mod-auth-openidc?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.4.12.3-2+deb12u4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libapache2-mod-auth-openidc?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.4.9-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libapache2-mod-auth-openidc?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.4.9.4-0+deb11u4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libapache2-mod-auth-openidc?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.4.19.1-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/libapache2-mod-auth-openidc?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.4.17-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=991583
    reference_type:
    reference_id: 991583
