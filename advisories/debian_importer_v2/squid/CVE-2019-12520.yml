advisory_id: squid/CVE-2019-12520
datasource_id: debian_importer_v2/squid/CVE-2019-12520
datasource_url: https://security-tracker.debian.org/tracker/CVE-2019-12520
aliases:
  - CVE-2019-12520
summary: An issue was discovered in Squid through 4.7 and 5. When receiving a request, Squid
  checks its cache to see if it can serve up a response. It does this by making a MD5 hash of
  the absolute URL of the request. If found, it servers the request. The absolute URL can include
  the decoded UserInfo (username and password) for certain protocols. This decoded info is prepended
  to the domain. This allows an attacker to provide a username that has special characters to
  delimit the domain, and treat the rest of the URL as a path or query string. An attacker could
  first make a request to their domain using an encoded username, then when a request for the
  target domain comes in that decodes to the exact URL, it will serve the attacker's HTML instead
  of the real HTML. On Squid servers that also act as reverse proxies, this allows an attacker
  to gain access to features that only reverse proxies can use, such as ESI.
impacted_packages:
  - purl: pkg:deb/debian/squid?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.7-2+deb12u5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/squid?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/squid?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.13-10+deb11u3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/squid?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/7.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/squid?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.13-2+deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
