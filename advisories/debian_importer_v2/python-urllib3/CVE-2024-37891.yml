advisory_id: python-urllib3/CVE-2024-37891
datasource_id: debian_importer_v2/python-urllib3/CVE-2024-37891
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-37891
aliases:
  - CVE-2024-37891
summary: 'urllib3 is a user-friendly HTTP client library for Python. When using urllib3''s proxy
  support with `ProxyManager`, the `Proxy-Authorization` header is only sent to the configured
  proxy, as expected. However, when sending HTTP requests *without* using urllib3''s proxy support,
  it''s possible to accidentally configure the `Proxy-Authorization` header even though it won''t
  have any effect as the request is not using a forwarding proxy or a tunneling proxy. In those
  cases, urllib3 doesn''t treat the `Proxy-Authorization` HTTP header as one carrying authentication
  material and thus doesn''t strip the header on cross-origin redirects. Because this is a highly
  unlikely scenario, we believe the severity of this vulnerability is low for almost all users.
  Out of an abundance of caution urllib3 will automatically strip the `Proxy-Authorization`
  header during cross-origin redirects to avoid the small chance that users are doing this on
  accident. Users should use urllib3''s proxy support or disable automatic redirects to achieve
  safe processing of the `Proxy-Authorization` header, but we still decided to strip the header
  by default in order to further protect users who aren''t using the correct approach. We believe
  the number of usages affected by this advisory is low. It requires all of the following to
  be true to be exploited: 1. Setting the `Proxy-Authorization` header without using urllib3''s
  built-in proxy support. 2. Not disabling HTTP redirects. 3. Either not using an HTTPS origin
  server or for the proxy or target origin to redirect to a malicious origin. Users are advised
  to update to either version 1.26.19 or version 2.2.2. Users unable to upgrade may use the
  `Proxy-Authorization` header with urllib3''s `ProxyManager`, disable HTTP redirects using
  `redirects=False` when sending requests, or not user the `Proxy-Authorization` header as mitigations.'
impacted_packages:
  - purl: pkg:deb/debian/python-urllib3?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.26.12-1+deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/python-urllib3?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.26.5-1~exp1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/python-urllib3?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.26.5-1~exp1+deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/python-urllib3?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.6.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/python-urllib3?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.2.3-3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/python-urllib3?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.3.0-3
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1074149
    reference_type:
    reference_id: 1074149
