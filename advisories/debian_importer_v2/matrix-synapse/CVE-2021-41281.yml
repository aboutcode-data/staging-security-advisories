advisory_id: matrix-synapse/CVE-2021-41281
datasource_id: debian_importer_v2/matrix-synapse/CVE-2021-41281
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-41281
aliases:
  - CVE-2021-41281
summary: Synapse is a package for Matrix homeservers written in Python 3/Twisted. Prior to version
  1.47.1, Synapse instances with the media repository enabled can be tricked into downloading
  a file from a remote server into an arbitrary directory. No authentication is required for
  the affected endpoint. The last 2 directories and file name of the path are chosen randomly
  by Synapse and cannot be controlled by an attacker, which limits the impact. Homeservers with
  the media repository disabled are unaffected. Homeservers with a federation whitelist are
  also unaffected, since Synapse will check the remote hostname, including the trailing `../`s,
  against the whitelist. Server administrators should upgrade to 1.47.1 or later. Server administrators
  using a reverse proxy could, at the expense of losing media functionality, may block the certain
  endpoints as a workaround. Alternatively, non-containerized deployments can be adapted to
  use the hardened systemd config.
impacted_packages:
  - purl: pkg:deb/debian/matrix-synapse?distro=sid
    affected_versions:
    fixed_versions: vers:deb/1.146.0-3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/matrix-synapse?distro=sid
    affected_versions:
    fixed_versions: vers:deb/1.47.1-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1000451
    reference_type:
    reference_id: 1000451
