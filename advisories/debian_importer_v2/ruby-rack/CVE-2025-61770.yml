advisory_id: ruby-rack/CVE-2025-61770
datasource_id: debian_importer_v2/ruby-rack/CVE-2025-61770
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-61770
aliases:
  - CVE-2025-61770
summary: Rack is a modular Ruby web server interface. In versions prior to 2.2.19, 3.1.17, and
  3.2.2, `Rack::Multipart::Parser` buffers the entire multipart preamble (bytes before the first
  boundary) in memory without any size limit. A client can send a large preamble followed by
  a valid boundary, causing significant memory use and potential process termination due to
  out-of-memory (OOM) conditions. Remote attackers can trigger large transient memory spikes
  by including a long preamble in multipart/form-data requests. The impact scales with allowed
  request sizes and concurrency, potentially causing worker crashes or severe slowdown due to
  garbage collection. Versions 2.2.19, 3.1.17, and 3.2.2 enforce a preamble size limit (e.g.,
  16 KiB) or discard preamble data entirely. Workarounds include limiting total request body
  size at the proxy or web server level and monitoring memory and set per-process limits to
  prevent OOM conditions.
impacted_packages:
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.2.20-0+deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.1.4-3+deb11u2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.1.4-3+deb11u4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.1.18-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.2.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.1.18-1~deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1117627
    reference_type:
    reference_id: 1117627
