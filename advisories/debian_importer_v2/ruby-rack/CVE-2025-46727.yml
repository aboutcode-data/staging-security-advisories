advisory_id: ruby-rack/CVE-2025-46727
datasource_id: debian_importer_v2/ruby-rack/CVE-2025-46727
datasource_url: https://security-tracker.debian.org/tracker/CVE-2025-46727
aliases:
  - CVE-2025-46727
summary: Rack is a modular Ruby web server interface. Prior to versions 2.2.14, 3.0.16, and
  3.1.14, `Rack::QueryParser` parses query strings and `application/x-www-form-urlencoded` bodies
  into Ruby data structures without imposing any limit on the number of parameters, allowing
  attackers to send requests with extremely large numbers of parameters. The vulnerability arises
  because `Rack::QueryParser` iterates over each `&`-separated key-value pair and adds it to
  a Hash without enforcing an upper bound on the total number of parameters. This allows an
  attacker to send a single request containing hundreds of thousands (or more) of parameters,
  which consumes excessive memory and CPU during parsing. An attacker can trigger denial of
  service by sending specifically crafted HTTP requests, which can cause memory exhaustion or
  pin CPU resources, stalling or crashing the Rack server. This results in full service disruption
  until the affected worker is restarted. Versions 2.2.14, 3.0.16, and 3.1.14 fix the issue.
  Some other mitigations are available. One may use middleware to enforce a maximum query string
  size or parameter count, or employ a reverse proxy (such as Nginx) to limit request sizes
  and reject oversized query strings or bodies. Limiting request body sizes and query string
  lengths at the web server or CDN level is an effective mitigation.
impacted_packages:
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.2.20-0+deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.1.4-3+deb11u2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.1.4-3+deb11u4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.1.18-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.1.16-0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.2.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/ruby-rack?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.1.18-1~deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1104927
    reference_type:
    reference_id: 1104927
