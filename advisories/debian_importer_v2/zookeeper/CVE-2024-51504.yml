advisory_id: zookeeper/CVE-2024-51504
datasource_id: debian_importer_v2/zookeeper/CVE-2024-51504
datasource_url: https://security-tracker.debian.org/tracker/CVE-2024-51504
aliases:
  - CVE-2024-51504
summary: When using IPAuthenticationProvider in ZooKeeper Admin Server there is a possibility
  of Authentication Bypass by Spoofing -- this only impacts IP based authentication implemented
  in ZooKeeper Admin Server. Default configuration of client's IP address detection in IPAuthenticationProvider,
  which uses HTTP request headers, is weak and allows an attacker to bypass authentication via
  spoofing client's IP address in request headers. Default configuration honors X-Forwarded-For
  HTTP header to read client's IP address. X-Forwarded-For request header is mainly used by
  proxy servers to identify the client and can be easily spoofed by an attacker pretending that
  the request comes from a different IP address. Admin Server commands, such as snapshot and
  restore arbitrarily can be executed on successful exploitation which could potentially lead
  to information leakage or service availability issues. Users are recommended to upgrade to
  version 3.9.3, which fixes this issue.
impacted_packages:
  - purl: pkg:deb/debian/zookeeper?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.8.0-11+deb12u2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/zookeeper?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/zookeeper?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.4.13-6+deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/zookeeper?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.9.4-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/zookeeper?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/3.9.3-1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1087275
    reference_type:
    reference_id: 1087275
