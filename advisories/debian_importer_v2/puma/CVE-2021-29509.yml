advisory_id: puma/CVE-2021-29509
datasource_id: debian_importer_v2/puma/CVE-2021-29509
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-29509
aliases:
  - CVE-2021-29509
summary: Puma is a concurrent HTTP 1.1 server for Ruby/Rack applications. The fix for CVE-2019-16770
  was incomplete. The original fix only protected existing connections that had already been
  accepted from having their requests starved by greedy persistent-connections saturating all
  threads in the same process. However, new connections may still be starved by greedy persistent-connections
  saturating all threads in all processes in the cluster. A `puma` server which received more
  concurrent `keep-alive` connections than the server had threads in its threadpool would service
  only a subset of connections, denying service to the unserved connections. This problem has
  been fixed in `puma` 4.3.8 and 5.3.1. Setting `queue_requests false` also fixes the issue.
  This is not advised when using `puma` without a reverse proxy, such as `nginx` or `apache`,
  because you will open yourself to slow client attacks (e.g. slowloris). The fix is very small
  and a git patch is available for those using unsupported versions of Puma.
impacted_packages:
  - purl: pkg:deb/debian/puma?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/5.6.5-3+deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/puma?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.3.8-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/puma?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/4.3.8-1+deb11u2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/puma?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/6.6.0-4
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=989054
    reference_type:
    reference_id: 989054
