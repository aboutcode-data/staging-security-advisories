advisory_id: flatpak/CVE-2022-21682
datasource_id: debian_importer_v2/flatpak/CVE-2022-21682
datasource_url: https://security-tracker.debian.org/tracker/CVE-2022-21682
aliases:
  - CVE-2022-21682
summary: Flatpak is a Linux application sandboxing and distribution framework. A path traversal
  vulnerability affects versions of Flatpak prior to 1.12.3 and 1.10.6. flatpak-builder applies
  `finish-args` last in the build. At this point the build directory will have the full access
  that is specified in the manifest, so running `flatpak build` against it will gain those permissions.
  Normally this will not be done, so this is not problem. However, if `--mirror-screenshots-url`
  is specified, then flatpak-builder will launch `flatpak build --nofilesystem=host appstream-utils
  mirror-screenshots` after finalization, which can lead to issues even with the `--nofilesystem=host`
  protection. In normal use, the only issue is that these empty directories can be created wherever
  the user has write permissions. However, a malicious application could replace the `appstream-util`
  binary and potentially do something more hostile. This has been resolved in Flatpak 1.12.3
  and 1.10.6 by changing the behaviour of `--nofilesystem=home` and `--nofilesystem=host`.
impacted_packages:
  - purl: pkg:deb/debian/flatpak?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.14.10-1~deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/flatpak?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.12.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/flatpak?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.10.8-0+deb11u2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/flatpak?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.10.7-0+deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/flatpak?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.16.3-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/flatpak?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/1.16.2-1~deb13u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
