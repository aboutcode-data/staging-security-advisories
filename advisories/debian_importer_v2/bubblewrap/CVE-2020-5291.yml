advisory_id: bubblewrap/CVE-2020-5291
datasource_id: debian_importer_v2/bubblewrap/CVE-2020-5291
datasource_url: https://security-tracker.debian.org/tracker/CVE-2020-5291
aliases:
  - CVE-2020-5291
summary: 'Bubblewrap (bwrap) before version 0.4.1, if installed in setuid mode and the kernel
  supports unprivileged user namespaces, then the `bwrap --userns2` option can be used to make
  the setuid process keep running as root while being traceable. This can in turn be used to
  gain root permissions. Note that this only affects the combination of bubblewrap in setuid
  mode (which is typically used when unprivileged user namespaces are not supported) and the
  support of unprivileged user namespaces. Known to be affected are: * Debian testing/unstable,
  if unprivileged user namespaces enabled (not default) * Debian buster-backports, if unprivileged
  user namespaces enabled (not default) * Arch if using `linux-hardened`, if unprivileged user
  namespaces enabled (not default) * Centos 7 flatpak COPR, if unprivileged user namespaces
  enabled (not default) This has been fixed in the 0.4.1 release, and all affected users should
  update.'
impacted_packages:
  - purl: pkg:deb/debian/bubblewrap?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0.8.0-2+deb12u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/bubblewrap?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0.4.1-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/bubblewrap?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0.4.1-3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/bubblewrap?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/0.11.0-2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=955441
    reference_type:
    reference_id: 955441
