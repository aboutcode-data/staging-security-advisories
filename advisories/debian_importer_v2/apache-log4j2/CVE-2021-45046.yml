advisory_id: apache-log4j2/CVE-2021-45046
datasource_id: debian_importer_v2/apache-log4j2/CVE-2021-45046
datasource_url: https://security-tracker.debian.org/tracker/CVE-2021-45046
aliases:
  - CVE-2021-45046
summary: It was found that the fix to address CVE-2021-44228 in Apache Log4j 2.15.0 was incomplete
  in certain non-default configurations. This could allows attackers with control over Thread
  Context Map (MDC) input data when the logging configuration uses a non-default Pattern Layout
  with either a Context Lookup (for example, $${ctx:loginId}) or a Thread Context Map pattern
  (%X, %mdc, or %MDC) to craft malicious input data using a JNDI Lookup pattern resulting in
  an information leak and remote code execution in some environments and local code execution
  in all environments. Log4j 2.16.0 (Java 8) and 2.12.2 (Java 7) fix this issue by removing
  support for message lookup patterns and disabling JNDI functionality by default.
impacted_packages:
  - purl: pkg:deb/debian/apache-log4j2?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.19.0-2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/apache-log4j2?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.16.0-1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/apache-log4j2?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.17.1-1~deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/debian/apache-log4j2?distro=trixie
    affected_versions:
    fixed_versions: vers:deb/2.16.0-1~deb11u1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1001729
    reference_type:
    reference_id: 1001729
