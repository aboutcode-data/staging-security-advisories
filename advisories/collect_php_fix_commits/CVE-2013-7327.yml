advisory_id: CVE-2013-7327
datasource_id: collect_php_fix_commits/CVE-2013-7327
datasource_url: https://github.com/php/php-src
aliases: []
summary: |
  0c74d5ef089302193b0b15172059af74dd4934b4:Merge branch 'PHP-5.5' of git.php.net:php-src into PHP-5.5

  # By Remi Collet (6) and others
  # Via Nikita Popov (1) and others
  * 'PHP-5.5' of git.php.net:php-src:
    Fixed null termination
    Updated NEWS for #65545
    Add fread(length) method
    Fix HTML entity table generation
    Fix order in NEWS
    Add CVE ref (not known at release time)
    Fix NEWS for 5.5.11 fix (really not in 5.5.10)
    5.5.10 release date for NEWS
    Set default Digest Message to use SHA1 instead of MD5 in openssl tests as MD5 signature are now rejected by newer openssl Version.
    NEWS
    Fixed Bug #66815 imagecrop(): insufficient fix for NULL defer CVE-2013-7327
  0880851f004ba8ad793b9fb68e3ee6755245a0ba:Fixed Bug #66815 imagecrop(): insufficient fix for NULL defer CVE-2013-7327

  This amends commit 8f4a537, which aimed to correct NULL dereference because of
  missing check of gdImageCreateTrueColor() / gdImageCreate() return value.  That
  commit checks for negative crop rectangle width and height, but
  gdImageCreate*() can also return NULL when width * height overflows.  Hence
  NULL deref is still possible, as gdImageSaveAlpha() and gdImagePaletteCopy()
  is called before dst == NULL check.

  This moves NULL check to happen right after gdImageCreate*().  It also removes
  width and height check before gdImageCreate*(), as the same check is done by
  image create functions (with an extra warning).

  From thoger redhat com
  3686b6bd90e4f2c2b176c8b514e8fa0bc25dbd76:Merge branch 'PHP-5.6'

  * PHP-5.6:
    NEWS
    Fixed Bug #66815 imagecrop(): insufficient fix for NULL defer CVE-2013-7327
  cf89ff3d2452b3d13562c85cf8523da6010dc0f3:Merge branch 'PHP-5.5' into PHP-5.6

  * PHP-5.5:
    NEWS
    Fixed Bug #66815 imagecrop(): insufficient fix for NULL defer CVE-2013-7327
  af09d8b96a8aacdd7d738fec81b695c1c58368f7:Fixed Bug #66815 imagecrop(): insufficient fix for NULL defer CVE-2013-7327

  This amends commit 8f4a537, which aimed to correct NULL dereference because of
  missing check of gdImageCreateTrueColor() / gdImageCreate() return value.  That
  commit checks for negative crop rectangle width and height, but
  gdImageCreate*() can also return NULL when width * height overflows.  Hence
  NULL deref is still possible, as gdImageSaveAlpha() and gdImagePaletteCopy()
  is called before dst == NULL check.

  This moves NULL check to happen right after gdImageCreate*().  It also removes
  width and height check before gdImageCreate*(), as the same check is done by
  image create functions (with an extra warning).

  From thoger redhat com
impacted_packages:
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 0880851f004ba8ad793b9fb68e3ee6755245a0ba
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 3686b6bd90e4f2c2b176c8b514e8fa0bc25dbd76
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 0c74d5ef089302193b0b15172059af74dd4934b4
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: cf89ff3d2452b3d13562c85cf8523da6010dc0f3
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: af09d8b96a8aacdd7d738fec81b695c1c58368f7
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/php/php-src/tree/0880851f004ba8ad793b9fb68e3ee6755245a0ba
    reference_type: commit
    reference_id: 0880851f004ba8ad793b9fb68e3ee6755245a0ba
  - url: https://github.com/php/php-src/tree/0c74d5ef089302193b0b15172059af74dd4934b4
    reference_type: commit
    reference_id: 0c74d5ef089302193b0b15172059af74dd4934b4
  - url: https://github.com/php/php-src/tree/3686b6bd90e4f2c2b176c8b514e8fa0bc25dbd76
    reference_type: commit
    reference_id: 3686b6bd90e4f2c2b176c8b514e8fa0bc25dbd76
  - url: https://github.com/php/php-src/tree/af09d8b96a8aacdd7d738fec81b695c1c58368f7
    reference_type: commit
    reference_id: af09d8b96a8aacdd7d738fec81b695c1c58368f7
  - url: https://github.com/php/php-src/tree/cf89ff3d2452b3d13562c85cf8523da6010dc0f3
    reference_type: commit
    reference_id: cf89ff3d2452b3d13562c85cf8523da6010dc0f3
