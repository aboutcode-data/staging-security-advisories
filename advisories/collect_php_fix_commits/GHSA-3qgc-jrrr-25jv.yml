advisory_id: GHSA-3qgc-jrrr-25jv
datasource_id: collect_php_fix_commits/GHSA-3qgc-jrrr-25jv
datasource_url: https://github.com/php/php-src
aliases: []
summary: |
  4dd9a36c165974c84c4217aa41849b70a9fc19c9:Fix GHSA-3qgc-jrrr-25jv

  The original code is error-prone due to the "best fit mapping" that
  happens with the argument parsing but not with the query string.
  When we get a non-ASCII character, try to remap it and see if it becomes
  a hyphen.

  An alternative approach is to create a custom main `wmain` receiving
  wide-character variations that does the ANSI transformation with the
  best-fit mapping, but that's more error-prone and could cause unexpected
  breakage.

  Another alternative was just don't doing this check altogether and
  always check for `cgi || fastcgi` instead, but that breaks real-world
  use-cases.
  938267314835de3c2ed1a3da4f2959f1d2709468:Fix GHSA-3qgc-jrrr-25jv

  The original code is error-prone due to the "best fit mapping" that
  happens with the argument parsing but not with the query string.
  When we get a non-ASCII character, try to remap it and see if it becomes
  a hyphen.

  An alternative approach is to create a custom main `wmain` receiving
  wide-character variations that does the ANSI transformation with the
  best-fit mapping, but that's more error-prone and could cause unexpected
  breakage.

  Another alternative was just don't doing this check altogether and
  always check for `cgi || fastcgi` instead, but that breaks real-world
  use-cases.
  b6d1d3980a664882f03021e9bb918089ed3dc428:Fix GHSA-3qgc-jrrr-25jv

  The original code is error-prone due to the "best fit mapping" that
  happens with the argument parsing but not with the query string.
  When we get a non-ASCII character, try to remap it and see if it becomes
  a hyphen.

  An alternative approach is to create a custom main `wmain` receiving
  wide-character variations that does the ANSI transformation with the
  best-fit mapping, but that's more error-prone and could cause unexpected
  breakage.

  Another alternative was just don't doing this check altogether and
  always check for `cgi || fastcgi` instead, but that breaks real-world
  use-cases.
  88315f263dc4d64855a54e24b71970ad605fbacc:Fix GHSA-3qgc-jrrr-25jv

  The original code is error-prone due to the "best fit mapping" that
  happens with the argument parsing but not with the query string.
  When we get a non-ASCII character, try to remap it and see if it becomes
  a hyphen.

  An alternative approach is to create a custom main `wmain` receiving
  wide-character variations that does the ANSI transformation with the
  best-fit mapping, but that's more error-prone and could cause unexpected
  breakage.

  Another alternative was just don't doing this check altogether and
  always check for `cgi || fastcgi` instead, but that breaks real-world
  use-cases.
impacted_packages:
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: b6d1d3980a664882f03021e9bb918089ed3dc428
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 938267314835de3c2ed1a3da4f2959f1d2709468
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 88315f263dc4d64855a54e24b71970ad605fbacc
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 4dd9a36c165974c84c4217aa41849b70a9fc19c9
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/php/php-src/tree/4dd9a36c165974c84c4217aa41849b70a9fc19c9
    reference_type: commit
    reference_id: 4dd9a36c165974c84c4217aa41849b70a9fc19c9
  - url: https://github.com/php/php-src/tree/88315f263dc4d64855a54e24b71970ad605fbacc
    reference_type: commit
    reference_id: 88315f263dc4d64855a54e24b71970ad605fbacc
  - url: https://github.com/php/php-src/tree/938267314835de3c2ed1a3da4f2959f1d2709468
    reference_type: commit
    reference_id: 938267314835de3c2ed1a3da4f2959f1d2709468
  - url: https://github.com/php/php-src/tree/b6d1d3980a664882f03021e9bb918089ed3dc428
    reference_type: commit
    reference_id: b6d1d3980a664882f03021e9bb918089ed3dc428
