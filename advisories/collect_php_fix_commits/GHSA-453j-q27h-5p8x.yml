advisory_id: GHSA-453j-q27h-5p8x
datasource_id: collect_php_fix_commits/GHSA-453j-q27h-5p8x
datasource_url: https://github.com/php/php-src
aliases: []
summary: "158aa141676f13c8802b3b593237e69e7f8eb1e4:Fix GHSA-453j-q27h-5p8x\n\nLibxml versions\
  \ prior to 2.13 cannot correctly handle a call to\nxmlNodeSetName() with a name longer than\
  \ 2G. It will leave the node\nobject in an invalid state with a NULL name. This later causes\
  \ a NULL\npointer dereference when using the name during message serialization.\n\nTo solve\
  \ this, implement a workaround that resets the name to the\nsentinel name if this situation\
  \ arises.\n\nVersions of libxml of 2.13 and higher are not affected.\n\nThis can be exploited\
  \ if a SoapVar is created with a fully qualified\nname that is longer than 2G. This would\
  \ be possible if some application\ncode uses a namespace prefix from an untrusted source like\
  \ from a remote\nSOAP service.\n\nCo-authored-by: Niels Dossche <7771979+nielsdos@users.noreply.github.com>\n\
  f71271dbaa0782d400d07376bc8be8fbccb7621d:Merge branch 'PHP-8.4'\n\n* PHP-8.4:\n  PHP-8.2 is\
  \ now for PHP 8.2.30-dev\n  Update NEWS with entries for security fixes\n  Fix GHSA-453j-q27h-5p8x\n\
  \  Fix GHSA-hrwm-9436-5mv3: pgsql escaping no error checks\n  Fix GHSA-3cr5-j632-f35r: Null\
  \ byte in hostnames\n7a3c0d3519cb1e39c524202d07583402106858bf:Merge branch 'PHP-8.3' into\
  \ PHP-8.4\n\n* PHP-8.3:\n  PHP-8.2 is now for PHP 8.2.30-dev\n  Update NEWS with entries for\
  \ security fixes\n  Fix GHSA-453j-q27h-5p8x\n  Fix GHSA-hrwm-9436-5mv3: pgsql escaping no\
  \ error checks\n  Fix GHSA-3cr5-j632-f35r: Null byte in hostnames\nb576ad4ca32407b3b32228afcad43708dfe0ba84:Merge\
  \ branch 'PHP-8.2' into PHP-8.3\n\n* PHP-8.2:\n  PHP-8.2 is now for PHP 8.2.30-dev\n  Update\
  \ NEWS with entries for security fixes\n  Fix GHSA-453j-q27h-5p8x\n  Fix GHSA-hrwm-9436-5mv3:\
  \ pgsql escaping no error checks\n  Fix GHSA-3cr5-j632-f35r: Null byte in hostnames\n\n# Conflicts:\n\
  #\tZend/zend.h\n#\tconfigure.ac\n#\text/pgsql/pgsql.c\n#\tmain/php_version.h\n0298837252fda06e0f86be3dfe91f166f45e85d4:Fix\
  \ GHSA-453j-q27h-5p8x\n\nLibxml versions prior to 2.13 cannot correctly handle a call to\n\
  xmlNodeSetName() with a name longer than 2G. It will leave the node\nobject in an invalid\
  \ state with a NULL name. This later causes a NULL\npointer dereference when using the name\
  \ during message serialization.\n\nTo solve this, implement a workaround that resets the name\
  \ to the\nsentinel name if this situation arises.\n\nVersions of libxml of 2.13 and higher\
  \ are not affected.\n\nThis can be exploited if a SoapVar is created with a fully qualified\n\
  name that is longer than 2G. This would be possible if some application\ncode uses a namespace\
  \ prefix from an untrusted source like from a remote\nSOAP service.\n\nCo-authored-by: Niels\
  \ Dossche <7771979+nielsdos@users.noreply.github.com>\n50e1b23efb56ffa2d61105634c277b7d2c43796a:Merge\
  \ branch 'PHP-8.4'\n\n* PHP-8.4:\n  Update NEWS with entries for security fixes\n  Fix GHSA-453j-q27h-5p8x\n\
  \  Fix GHSA-hrwm-9436-5mv3: pgsql escaping no error checks\n  Fix GHSA-3cr5-j632-f35r: Null\
  \ byte in hostnames\n7f5d491a05baa3817ba269d4d7ccd1b83ee5762c:Merge branch 'PHP-8.3' into\
  \ PHP-8.4\n\n* PHP-8.3:\n  Update NEWS with entries for security fixes\n  Fix GHSA-453j-q27h-5p8x\n\
  \  Fix GHSA-hrwm-9436-5mv3: pgsql escaping no error checks\n  Fix GHSA-3cr5-j632-f35r: Null\
  \ byte in hostnames\ndd060656d31fc2ba3fe9acd42bbc19d1c96ff914:Fix GHSA-453j-q27h-5p8x\n\n\
  Libxml versions prior to 2.13 cannot correctly handle a call to\nxmlNodeSetName() with a name\
  \ longer than 2G. It will leave the node\nobject in an invalid state with a NULL name. This\
  \ later causes a NULL\npointer dereference when using the name during message serialization.\n\
  \nTo solve this, implement a workaround that resets the name to the\nsentinel name if this\
  \ situation arises.\n\nVersions of libxml of 2.13 and higher are not affected.\n\nThis can\
  \ be exploited if a SoapVar is created with a fully qualified\nname that is longer than 2G.\
  \ This would be possible if some application\ncode uses a namespace prefix from an untrusted\
  \ source like from a remote\nSOAP service.\n\nCo-authored-by: Niels Dossche <7771979+nielsdos@users.noreply.github.com>\n\
  49d94cced0689f85ebb7baf4497b95cea77b5551:Merge branch 'PHP-8.4'\n\n* PHP-8.4:\n  Fix GHSA-453j-q27h-5p8x\n\
  \  Fix GHSA-hrwm-9436-5mv3: pgsql escaping no error checks\n  Fix GHSA-3cr5-j632-f35r: Null\
  \ byte in hostnames\n97c51c0e3d187fe5033e17a662af9ed9fe38901d:Fix GHSA-453j-q27h-5p8x\n\n\
  Libxml versions prior to 2.13 cannot correctly handle a call to\nxmlNodeSetName() with a name\
  \ longer than 2G. It will leave the node\nobject in an invalid state with a NULL name. This\
  \ later causes a NULL\npointer dereference when using the name during message serialization.\n\
  \nTo solve this, implement a workaround that resets the name to the\nsentinel name if this\
  \ situation arises.\n\nVersions of libxml of 2.13 and higher are not affected.\n\nThis can\
  \ be exploited if a SoapVar is created with a fully qualified\nname that is longer than 2G.\
  \ This would be possible if some application\ncode uses a namespace prefix from an untrusted\
  \ source like from a remote\nSOAP service.\n\nCo-authored-by: Niels Dossche <7771979+nielsdos@users.noreply.github.com>\n\
  a179e39c38001af3d40a0dbd7e0e57bbd7b66814:Fix GHSA-453j-q27h-5p8x\n\nLibxml versions prior\
  \ to 2.13 cannot correctly handle a call to\nxmlNodeSetName() with a name longer than 2G.\
  \ It will leave the node\nobject in an invalid state with a NULL name. This later causes a\
  \ NULL\npointer dereference when using the name during message serialization.\n\nTo solve\
  \ this, implement a workaround that resets the name to the\nsentinel name if this situation\
  \ arises.\n\nVersions of libxml of 2.13 and higher are not affected.\n\nThis can be exploited\
  \ if a SoapVar is created with a fully qualified\nname that is longer than 2G. This would\
  \ be possible if some application\ncode uses a namespace prefix from an untrusted source like\
  \ from a remote\nSOAP service.\n\nCo-authored-by: Niels Dossche <7771979+nielsdos@users.noreply.github.com>\n\
  026ab919d041312368bbbbeb4bfc50670cdd013b:Fix GHSA-453j-q27h-5p8x\n\nLibxml versions prior\
  \ to 2.13 cannot correctly handle a call to\nxmlNodeSetName() with a name longer than 2G.\
  \ It will leave the node\nobject in an invalid state with a NULL name. This later causes a\
  \ NULL\npointer dereference when using the name during message serialization.\n\nTo solve\
  \ this, implement a workaround that resets the name to the\nsentinel name if this situation\
  \ arises.\n\nVersions of libxml of 2.13 and higher are not affected.\n\nThis can be exploited\
  \ if a SoapVar is created with a fully qualified\nname that is longer than 2G. This would\
  \ be possible if some application\ncode uses a namespace prefix from an untrusted source like\
  \ from a remote\nSOAP service.\n\nCo-authored-by: Niels Dossche <7771979+nielsdos@users.noreply.github.com>\n\
  9cb3d8d200f0c822b17bda35a2a67a97b039d3e1:Fix GHSA-453j-q27h-5p8x\n\nLibxml versions prior\
  \ to 2.13 cannot correctly handle a call to\nxmlNodeSetName() with a name longer than 2G.\
  \ It will leave the node\nobject in an invalid state with a NULL name. This later causes a\
  \ NULL\npointer dereference when using the name during message serialization.\n\nTo solve\
  \ this, implement a workaround that resets the name to the\nsentinel name if this situation\
  \ arises.\n\nVersions of libxml of 2.13 and higher are not affected.\n\nThis can be exploited\
  \ if a SoapVar is created with a fully qualified\nname that is longer than 2G. This would\
  \ be possible if some application\ncode uses a namespace prefix from an untrusted source like\
  \ from a remote\nSOAP service.\n\nCo-authored-by: Niels Dossche <7771979+nielsdos@users.noreply.github.com>"
impacted_packages:
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: a179e39c38001af3d40a0dbd7e0e57bbd7b66814
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 7f5d491a05baa3817ba269d4d7ccd1b83ee5762c
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 158aa141676f13c8802b3b593237e69e7f8eb1e4
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 7a3c0d3519cb1e39c524202d07583402106858bf
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 49d94cced0689f85ebb7baf4497b95cea77b5551
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 026ab919d041312368bbbbeb4bfc50670cdd013b
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 50e1b23efb56ffa2d61105634c277b7d2c43796a
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 0298837252fda06e0f86be3dfe91f166f45e85d4
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: dd060656d31fc2ba3fe9acd42bbc19d1c96ff914
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: b576ad4ca32407b3b32228afcad43708dfe0ba84
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 97c51c0e3d187fe5033e17a662af9ed9fe38901d
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: 9cb3d8d200f0c822b17bda35a2a67a97b039d3e1
    introduced_in_commits: []
  - purl: pkg:github/php/php-src
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/php/php-src
        commit: f71271dbaa0782d400d07376bc8be8fbccb7621d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/php/php-src/tree/026ab919d041312368bbbbeb4bfc50670cdd013b
    reference_type: commit
    reference_id: 026ab919d041312368bbbbeb4bfc50670cdd013b
  - url: https://github.com/php/php-src/tree/0298837252fda06e0f86be3dfe91f166f45e85d4
    reference_type: commit
    reference_id: 0298837252fda06e0f86be3dfe91f166f45e85d4
  - url: https://github.com/php/php-src/tree/158aa141676f13c8802b3b593237e69e7f8eb1e4
    reference_type: commit
    reference_id: 158aa141676f13c8802b3b593237e69e7f8eb1e4
  - url: https://github.com/php/php-src/tree/49d94cced0689f85ebb7baf4497b95cea77b5551
    reference_type: commit
    reference_id: 49d94cced0689f85ebb7baf4497b95cea77b5551
  - url: https://github.com/php/php-src/tree/50e1b23efb56ffa2d61105634c277b7d2c43796a
    reference_type: commit
    reference_id: 50e1b23efb56ffa2d61105634c277b7d2c43796a
  - url: https://github.com/php/php-src/tree/7a3c0d3519cb1e39c524202d07583402106858bf
    reference_type: commit
    reference_id: 7a3c0d3519cb1e39c524202d07583402106858bf
  - url: https://github.com/php/php-src/tree/7f5d491a05baa3817ba269d4d7ccd1b83ee5762c
    reference_type: commit
    reference_id: 7f5d491a05baa3817ba269d4d7ccd1b83ee5762c
  - url: https://github.com/php/php-src/tree/97c51c0e3d187fe5033e17a662af9ed9fe38901d
    reference_type: commit
    reference_id: 97c51c0e3d187fe5033e17a662af9ed9fe38901d
  - url: https://github.com/php/php-src/tree/9cb3d8d200f0c822b17bda35a2a67a97b039d3e1
    reference_type: commit
    reference_id: 9cb3d8d200f0c822b17bda35a2a67a97b039d3e1
  - url: https://github.com/php/php-src/tree/a179e39c38001af3d40a0dbd7e0e57bbd7b66814
    reference_type: commit
    reference_id: a179e39c38001af3d40a0dbd7e0e57bbd7b66814
  - url: https://github.com/php/php-src/tree/b576ad4ca32407b3b32228afcad43708dfe0ba84
    reference_type: commit
    reference_id: b576ad4ca32407b3b32228afcad43708dfe0ba84
  - url: https://github.com/php/php-src/tree/dd060656d31fc2ba3fe9acd42bbc19d1c96ff914
    reference_type: commit
    reference_id: dd060656d31fc2ba3fe9acd42bbc19d1c96ff914
  - url: https://github.com/php/php-src/tree/f71271dbaa0782d400d07376bc8be8fbccb7621d
    reference_type: commit
    reference_id: f71271dbaa0782d400d07376bc8be8fbccb7621d
