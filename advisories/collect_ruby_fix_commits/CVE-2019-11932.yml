advisory_id: CVE-2019-11932
datasource_id: collect_ruby_fix_commits/CVE-2019-11932
datasource_url: https://github.com/ruby/ruby
aliases: []
summary: |
  a14cc07f2ffc704b73ba4b96543e2f85c3ed1921:avoid returning NULL from xrealloc

  This changeset is to kill future possibility of bugs similar to
  CVE-2019-11932.   The vulnerability occurs when reallocarray(3)
  (which is a variant of realloc(3) and roughly resembles our
  ruby_xmalloc2()) returns NULL.  In our C API, ruby_xmalloc()
  never returns NULL to raise NoMemoryError instead.  ruby_xfree()
  does not return NULL by definition.  ruby_xrealloc() on the other
  hand, _did_ return NULL, _and_ also raised sometimes.  It is very
  confusing.  Let's not do that.  x-series APIs shall raise on
  error and shall not return NULL.
impacted_packages:
  - purl: pkg:github/ruby/ruby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ruby/ruby
        commit: a14cc07f2ffc704b73ba4b96543e2f85c3ed1921
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/ruby/ruby/tree/a14cc07f2ffc704b73ba4b96543e2f85c3ed1921
    reference_type: commit
    reference_id: a14cc07f2ffc704b73ba4b96543e2f85c3ed1921
