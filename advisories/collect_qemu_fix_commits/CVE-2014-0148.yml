advisory_id: CVE-2014-0148
datasource_id: collect_qemu_fix_commits/CVE-2014-0148
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  1786c4225db1ff1241d76e1f96a2acc1bea51d2d:vhdx: Bounds checking for block_size and logical_sector_size (CVE-2014-0148)

  Other variables (e.g. sectors_per_block) are calculated using these
  variables, and if not range-checked illegal values could be obtained
  causing infinite loops and other potential issues when calculating
  BAT entries.

  The 1.00 VHDX spec requires BlockSize to be min 1MB, max 256MB.
  LogicalSectorSize is required to be either 512 or 4096 bytes.

  Reported-by: Kevin Wolf <kwolf@redhat.com>
  Signed-off-by: Jeff Cody <jcody@redhat.com>
  Signed-off-by: Kevin Wolf <kwolf@redhat.com>
  Reviewed-by: Max Reitz <mreitz@redhat.com>
  Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
  (cherry picked from commit 1d7678dec4761acdc43439da6ceda41a703ba1a6)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  1d7678dec4761acdc43439da6ceda41a703ba1a6:vhdx: Bounds checking for block_size and logical_sector_size (CVE-2014-0148)

  Other variables (e.g. sectors_per_block) are calculated using these
  variables, and if not range-checked illegal values could be obtained
  causing infinite loops and other potential issues when calculating
  BAT entries.

  The 1.00 VHDX spec requires BlockSize to be min 1MB, max 256MB.
  LogicalSectorSize is required to be either 512 or 4096 bytes.

  Reported-by: Kevin Wolf <kwolf@redhat.com>
  Signed-off-by: Jeff Cody <jcody@redhat.com>
  Signed-off-by: Kevin Wolf <kwolf@redhat.com>
  Reviewed-by: Max Reitz <mreitz@redhat.com>
  Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 1786c4225db1ff1241d76e1f96a2acc1bea51d2d
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 1d7678dec4761acdc43439da6ceda41a703ba1a6
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
