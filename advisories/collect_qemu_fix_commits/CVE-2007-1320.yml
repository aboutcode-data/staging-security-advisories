advisory_id: CVE-2007-1320
datasource_id: collect_qemu_fix_commits/CVE-2007-1320
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  d16136d22af0fcf0d651de04c9e3cbc7137cc6f9:cirrus: Fix host CPU blits

  Commit b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef
  "CVE-2007-1320 - Cirrus LGD-54XX "bitblt" heap overflow" broke
  cpu to video blits.

  When the ROP function is called from cirrus_bitblt_cputovideo_next(),
  we pass 0 for the pitch but only operate on one line at a time. The
  added test was tripping because after the initial substraction, the
  pitch becomes negative. Make the test only trip when the height is
  larger than one (ie. the pitch is actually used).

  This fixes HW cursor support in Windows NT4.0 (which otherwise was
  a white rectangle) and general display of icons in that OS when using
  8bpp mode.

  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  65d35a09979e63541afc5bfc595b9f1b1b4ae069:CVE-2008-4539: fix a heap overflow in Cirrus emulation

  The code in hw/cirrus_vga.c has changed a lot between CVE-2007-1320 has
  been announced and the patch has been applied. As a consequence it has
  wrongly applied and QEMU is still vulnerable to this bug if using VNC.

  (noticed by Jan Niehusmann)

  Signed-off-by: Aurelien Jarno <aurelien@aurel32.net>

  git-svn-id: svn://svn.savannah.nongnu.org/qemu/trunk@5587 c046a42c-6fe2-441c-8c8c-71466251a162
  b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef:CVE-2007-1320 - Cirrus LGD-54XX "bitblt" heap overflow

  I have just noticed that patch for CVE-2007-1320 has never been applied
  to the QEMU CVS. Please find it below.

  | Multiple heap-based buffer overflows in the cirrus_invalidate_region
  | function in the Cirrus VGA extension in QEMU 0.8.2, as used in Xen and
  | possibly other products, might allow local users to execute arbitrary
  | code via unspecified vectors related to "attempting to mark
  | non-existent regions as dirty," aka the "bitblt" heap overflow.


  git-svn-id: svn://svn.savannah.nongnu.org/qemu/trunk@4340 c046a42c-6fe2-441c-8c8c-71466251a162
  b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef:CVE-2007-1320 - Cirrus LGD-54XX "bitblt" heap overflow

  I have just noticed that patch for CVE-2007-1320 has never been applied
  to the QEMU CVS. Please find it below.

  | Multiple heap-based buffer overflows in the cirrus_invalidate_region
  | function in the Cirrus VGA extension in QEMU 0.8.2, as used in Xen and
  | possibly other products, might allow local users to execute arbitrary
  | code via unspecified vectors related to "attempting to mark
  | non-existent regions as dirty," aka the "bitblt" heap overflow.


  git-svn-id: svn://svn.savannah.nongnu.org/qemu/trunk@4340 c046a42c-6fe2-441c-8c8c-71466251a162
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 65d35a09979e63541afc5bfc595b9f1b1b4ae069
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d16136d22af0fcf0d651de04c9e3cbc7137cc6f9
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
