advisory_id: CVE-2025-8860
datasource_id: collect_qemu_fix_commits/CVE-2025-8860
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  34391a88612b6e01f79ebebdc7e49a0a3be8cb9d:hw/uefi: clear uefi-vars buffer in uefi_vars_write callback

  When the guest writes to register UEFI_VARS_REG_BUFFER_SIZE, the .write
  callback `uefi_vars_write` is invoked. The function allocates a
  heap buffer without zeroing the memory, leaving the buffer filled with
  residual data from prior allocations. When the guest later reads from
  register UEFI_VARS_REG_PIO_BUFFER_TRANSFER, the .read callback
  `uefi_vars_read` returns leftover metadata or other sensitive process
  memory from the previously allocated buffer, leading to an information
  disclosure vulnerability.

  Fixes: CVE-2025-8860
  Fixes: 90ca4e03c27d ("hw/uefi: add var-service-core.c")
  Reported-by: ZDI <zdi-disclosures@trendmicro.com>
  Suggested-by: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Mauro Matteo Cascella <mcascell@redhat.com>
  Message-ID: <20250811101128.17661-1-mcascell@redhat.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  (cherry picked from commit f757d9d90d19b914d4023663bfc4da73bbbf007e)
  Signed-off-by: Michael Tokarev <mjt@tls.msk.ru>
  f757d9d90d19b914d4023663bfc4da73bbbf007e:hw/uefi: clear uefi-vars buffer in uefi_vars_write callback

  When the guest writes to register UEFI_VARS_REG_BUFFER_SIZE, the .write
  callback `uefi_vars_write` is invoked. The function allocates a
  heap buffer without zeroing the memory, leaving the buffer filled with
  residual data from prior allocations. When the guest later reads from
  register UEFI_VARS_REG_PIO_BUFFER_TRANSFER, the .read callback
  `uefi_vars_read` returns leftover metadata or other sensitive process
  memory from the previously allocated buffer, leading to an information
  disclosure vulnerability.

  Fixes: CVE-2025-8860
  Fixes: 90ca4e03c27d ("hw/uefi: add var-service-core.c")
  Reported-by: ZDI <zdi-disclosures@trendmicro.com>
  Suggested-by: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Mauro Matteo Cascella <mcascell@redhat.com>
  Message-ID: <20250811101128.17661-1-mcascell@redhat.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: f757d9d90d19b914d4023663bfc4da73bbbf007e
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 34391a88612b6e01f79ebebdc7e49a0a3be8cb9d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
