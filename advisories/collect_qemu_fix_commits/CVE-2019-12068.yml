advisory_id: CVE-2019-12068
datasource_id: collect_qemu_fix_commits/CVE-2019-12068
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  051c9b3cbcb4beb42a6ed017c2146ec3e7a754fb:scsi: lsi: exit infinite loop while executing script (CVE-2019-12068)

  When executing script in lsi_execute_script(), the LSI scsi adapter
  emulator advances 's->dsp' index to read next opcode. This can lead
  to an infinite loop if the next opcode is empty. Move the existing
  loop exit after 10k iterations so that it covers no-op opcodes as
  well.

  Reported-by: Bugs SysSec <bugs-syssec@rub.de>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  (cherry picked from commit de594e47659029316bbf9391efb79da0a1a08e08)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  b65e78320bba2655b60355739ed1a1da2ccc6c78:scsi: lsi: exit infinite loop while executing script (CVE-2019-12068)

  When executing script in lsi_execute_script(), the LSI scsi adapter
  emulator advances 's->dsp' index to read next opcode. This can lead
  to an infinite loop if the next opcode is empty. Move the existing
  loop exit after 10k iterations so that it covers no-op opcodes as
  well.

  Reported-by: Bugs SysSec <bugs-syssec@rub.de>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  (cherry picked from commit de594e47659029316bbf9391efb79da0a1a08e08)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  f2cfa1229e539ee1bb1822912075cf25538ad6b9:Merge remote-tracking branch 'remotes/bonzini/tags/for-upstream' into staging

  * New KVM PV features (Marcelo, Wanpeng)
  * valgrind fixes (Andrey)
  * Remove clock reset notifiers (David)
  * KConfig and Makefile cleanups (Paolo)
  * Replay and icount improvements (Pavel)
  * x86 FP fixes (Peter M.)
  * TCG locking assertions (Roman)
  * x86 support for mmap-ed -kernel/-initrd (Stefano)
  * Other cleanups (Wei Yang, Yan Zhao, Tony)
  * LSI fix for infinite loop (Prasad)
  * ARM migration fix (Catherine)
  * AVX512_BF16 feature (Jing)

  # gpg: Signature made Tue 20 Aug 2019 19:00:54 BST
  # gpg:                using RSA key BFFBD25F78C7AE83
  # gpg: Good signature from "Paolo Bonzini <bonzini@gnu.org>" [full]
  # gpg:                 aka "Paolo Bonzini <pbonzini@redhat.com>" [full]
  # Primary key fingerprint: 46F5 9FBD 57D6 12E7 BFD4  E2F7 7E15 100C CD36 69B1
  #      Subkey fingerprint: F133 3857 4B66 2389 866C  7682 BFFB D25F 78C7 AE83

  * remotes/bonzini/tags/for-upstream: (33 commits)
    x86: Intel AVX512_BF16 feature enabling
    scsi: lsi: exit infinite loop while executing script (CVE-2019-12068)
    test-bitmap: test set 1 bit case for bitmap_set
    migration: do not rom_reset() during incoming migration
    HACKING: Document 'struct' keyword usage
    kvm: vmxcap: Enhance with latest features
    cpus-common: nuke finish_safe_work
    icount: remove unnecessary gen_io_end calls
    icount: clean up cpu_can_io at the entry to the block
    replay: rename step-related variables and functions
    replay: refine replay-time module
    replay: fix replay shutdown
    util/qemu-timer: refactor deadline calculation for external timers
    replay: document development rules
    replay: add missing fix for internal function
    timer: last, remove last bits of last
    replay: Remove host_clock_last
    timer: Remove reset notifiers
    mc146818rtc: Remove reset notifiers
    memory: fix race between TCG and accesses to dirty bitmap
    ...

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  de594e47659029316bbf9391efb79da0a1a08e08:scsi: lsi: exit infinite loop while executing script (CVE-2019-12068)

  When executing script in lsi_execute_script(), the LSI scsi adapter
  emulator advances 's->dsp' index to read next opcode. This can lead
  to an infinite loop if the next opcode is empty. Move the existing
  loop exit after 10k iterations so that it covers no-op opcodes as
  well.

  Reported-by: Bugs SysSec <bugs-syssec@rub.de>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: de594e47659029316bbf9391efb79da0a1a08e08
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b65e78320bba2655b60355739ed1a1da2ccc6c78
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 051c9b3cbcb4beb42a6ed017c2146ec3e7a754fb
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: f2cfa1229e539ee1bb1822912075cf25538ad6b9
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
