advisory_id: CVE-2013-6399
datasource_id: collect_qemu_fix_commits/CVE-2013-6399
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  7297dba2718e4558a246a4ec25790c2f1c81bb05:virtio: avoid buffer overrun on incoming migration

  CVE-2013-6399

  vdev->queue_sel is read from the wire, and later used in the
  emulation code as an index into vdev->vq[]. If the value of
  vdev->queue_sel exceeds the length of vdev->vq[], currently
  allocated to be VIRTIO_PCI_QUEUE_MAX elements, subsequent PIO
  operations such as VIRTIO_PCI_QUEUE_PFN can be used to overrun
  the buffer with arbitrary data originating from the source.

  Fix this by failing migration if the value from the wire exceeds
  VIRTIO_PCI_QUEUE_MAX.

  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Peter Maydell <peter.maydell@linaro.org>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit 4b53c2c72cb5541cf394033b528a6fe2a86c0ac1)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  8f0e369a52ff0b5e0642bda47e2ead3c7e273fe1:virtio: avoid buffer overrun on incoming migration

  CVE-2013-6399

  vdev->queue_sel is read from the wire, and later used in the
  emulation code as an index into vdev->vq[]. If the value of
  vdev->queue_sel exceeds the length of vdev->vq[], currently
  allocated to be VIRTIO_PCI_QUEUE_MAX elements, subsequent PIO
  operations such as VIRTIO_PCI_QUEUE_PFN can be used to overrun
  the buffer with arbitrary data originating from the source.

  Fix this by failing migration if the value from the wire exceeds
  VIRTIO_PCI_QUEUE_MAX.

  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Peter Maydell <peter.maydell@linaro.org>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit 4b53c2c72cb5541cf394033b528a6fe2a86c0ac1)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  4b53c2c72cb5541cf394033b528a6fe2a86c0ac1:virtio: avoid buffer overrun on incoming migration

  CVE-2013-6399

  vdev->queue_sel is read from the wire, and later used in the
  emulation code as an index into vdev->vq[]. If the value of
  vdev->queue_sel exceeds the length of vdev->vq[], currently
  allocated to be VIRTIO_PCI_QUEUE_MAX elements, subsequent PIO
  operations such as VIRTIO_PCI_QUEUE_PFN can be used to overrun
  the buffer with arbitrary data originating from the source.

  Fix this by failing migration if the value from the wire exceeds
  VIRTIO_PCI_QUEUE_MAX.

  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Peter Maydell <peter.maydell@linaro.org>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 7297dba2718e4558a246a4ec25790c2f1c81bb05
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 8f0e369a52ff0b5e0642bda47e2ead3c7e273fe1
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 4b53c2c72cb5541cf394033b528a6fe2a86c0ac1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
