advisory_id: CVE-2022-4144
datasource_id: collect_qemu_fix_commits/CVE-2022-4144
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  6dbbf055148c6f1b7d8a3251a65bd6f3d1e1f622:hw/display/qxl: Avoid buffer overrun in qxl_phys2virt (CVE-2022-4144)

  Have qxl_get_check_slot_offset() return false if the requested
  buffer size does not fit within the slot memory region.

  Similarly qxl_phys2virt() now returns NULL in such case, and
  qxl_dirty_one_surface() aborts.

  This avoids buffer overrun in the host pointer returned by
  memory_region_get_ram_ptr().

  Fixes: CVE-2022-4144 (out-of-bounds read)
  Reported-by: Wenxu Yin (@awxylitol)
  Resolves: https://gitlab.com/qemu-project/qemu/-/issues/1336
  Signed-off-by: Philippe Mathieu-Daudé <philmd@linaro.org>
  Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
  Message-Id: <20221128202741.4945-5-philmd@linaro.org>
  6dbbf055148c6f1b7d8a3251a65bd6f3d1e1f622:hw/display/qxl: Avoid buffer overrun in qxl_phys2virt (CVE-2022-4144)

  Have qxl_get_check_slot_offset() return false if the requested
  buffer size does not fit within the slot memory region.

  Similarly qxl_phys2virt() now returns NULL in such case, and
  qxl_dirty_one_surface() aborts.

  This avoids buffer overrun in the host pointer returned by
  memory_region_get_ram_ptr().

  Fixes: CVE-2022-4144 (out-of-bounds read)
  Reported-by: Wenxu Yin (@awxylitol)
  Resolves: https://gitlab.com/qemu-project/qemu/-/issues/1336
  Signed-off-by: Philippe Mathieu-Daudé <philmd@linaro.org>
  Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
  Message-Id: <20221128202741.4945-5-philmd@linaro.org>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 6dbbf055148c6f1b7d8a3251a65bd6f3d1e1f622
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
