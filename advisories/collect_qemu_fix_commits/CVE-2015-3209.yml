advisory_id: CVE-2015-3209
datasource_id: collect_qemu_fix_commits/CVE-2015-3209
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  e015fe008a3a8901913248cdb50c62dba795c588:Merge remote-tracking branch 'remotes/stefanha/tags/CVE-2015-3209-pcnet-tx-buffer-fix-pull-request' into staging

  # gpg: Signature made Wed Jun 10 15:04:11 2015 BST using RSA key ID 81AB73C8
  # gpg: Good signature from "Stefan Hajnoczi <stefanha@redhat.com>"
  # gpg:                 aka "Stefan Hajnoczi <stefanha@gmail.com>"

  * remotes/stefanha/tags/CVE-2015-3209-pcnet-tx-buffer-fix-pull-request:
    pcnet: force the buffer access to be in bounds during tx

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  e015fe008a3a8901913248cdb50c62dba795c588:Merge remote-tracking branch 'remotes/stefanha/tags/CVE-2015-3209-pcnet-tx-buffer-fix-pull-request' into staging

  # gpg: Signature made Wed Jun 10 15:04:11 2015 BST using RSA key ID 81AB73C8
  # gpg: Good signature from "Stefan Hajnoczi <stefanha@redhat.com>"
  # gpg:                 aka "Stefan Hajnoczi <stefanha@gmail.com>"

  * remotes/stefanha/tags/CVE-2015-3209-pcnet-tx-buffer-fix-pull-request:
    pcnet: force the buffer access to be in bounds during tx

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  9f7c594c006289ad41169b854d70f5da6e400a2a:pcnet: force the buffer access to be in bounds during tx

  4096 is the maximum length per TMD and it is also currently the size of
  the relay buffer pcnet driver uses for sending the packet data to QEMU
  for further processing. With packet spanning multiple TMDs it can
  happen that the overall packet size will be bigger than sizeof(buffer),
  which results in memory corruption.

  Fix this by only allowing to queue maximum sizeof(buffer) bytes.

  This is CVE-2015-3209.

  [Fixed 3-space indentation to QEMU's 4-space coding standard.
  --Stefan]

  Signed-off-by: Petr Matousek <pmatouse@redhat.com>
  Reported-by: Matt Tait <matttait@google.com>
  Reviewed-by: Peter Maydell <peter.maydell@linaro.org>
  Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
  Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 9f7c594c006289ad41169b854d70f5da6e400a2a
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: e015fe008a3a8901913248cdb50c62dba795c588
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
