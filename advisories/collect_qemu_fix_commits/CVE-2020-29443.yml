advisory_id: CVE-2020-29443
datasource_id: collect_qemu_fix_commits/CVE-2020-29443
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  d54d9b1d124bcea44293e25f3a45c593d798d2a8:fuzz: refine the ide/ahci fuzzer configs

  Disks work differently depending on the x86 machine type (SATA vs PATA).
  Additionally, we should fuzz the atapi code paths, which might contain
  vulnerabilities such as CVE-2020-29443. This patch adds hard-disk and
  cdrom generic-fuzzer configs for both the pc (PATA) and q35 (SATA)
  machine types.

  Signed-off-by: Alexander Bulekov <alxndr@bu.edu>
  Acked-by: Thomas Huth <thuth@redhat.com>
  Reviewed-by: Darren Kenny <darren.kenny@oracle.com>
  Message-Id: <20210120152211.109782-1-alxndr@bu.edu>
  b8d7f1bc59276fec85e4d09f1567613a3e14d31e:ide: atapi: check logical block address and read size (CVE-2020-29443)

  While processing ATAPI cmd_read/cmd_read_cd commands,
  Logical Block Address (LBA) maybe invalid OR closer to the last block,
  leading to an OOB access issues. Add range check to avoid it.

  Fixes: CVE-2020-29443
  Reported-by: Wenxiang Qian <leonwxqian@gmail.com>
  Suggested-by: Paolo Bonzini <pbonzini@redhat.com>
  Reviewed-by: Paolo Bonzini <pbonzini@redhat.com>
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Message-Id: <20210118115130.457044-1-ppandit@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  b8d7f1bc59276fec85e4d09f1567613a3e14d31e:ide: atapi: check logical block address and read size (CVE-2020-29443)

  While processing ATAPI cmd_read/cmd_read_cd commands,
  Logical Block Address (LBA) maybe invalid OR closer to the last block,
  leading to an OOB access issues. Add range check to avoid it.

  Fixes: CVE-2020-29443
  Reported-by: Wenxiang Qian <leonwxqian@gmail.com>
  Suggested-by: Paolo Bonzini <pbonzini@redhat.com>
  Reviewed-by: Paolo Bonzini <pbonzini@redhat.com>
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Message-Id: <20210118115130.457044-1-ppandit@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b8d7f1bc59276fec85e4d09f1567613a3e14d31e
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d54d9b1d124bcea44293e25f3a45c593d798d2a8
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
