advisory_id: CVE-2013-4535
datasource_id: collect_qemu_fix_commits/CVE-2013-4535
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  4e48018ae9edfafa25fb4ddca745307bd66cfc63:virtio: validate num_sg when mapping

  CVE-2013-4535
  CVE-2013-4536

  Both virtio-block and virtio-serial read,
  VirtQueueElements are read in as buffers, and passed to
  virtqueue_map_sg(), where num_sg is taken from the wire and can force
  writes to indicies beyond VIRTQUEUE_MAX_SIZE.

  To fix, validate num_sg.

  Reported-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Cc: Amit Shah <amit.shah@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit 36cf2a37132c7f01fa9adb5f95f5312b27742fd4)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  68801b7be1ddabe3495f68145b1202049b1486c2:virtio: validate num_sg when mapping

  CVE-2013-4535
  CVE-2013-4536

  Both virtio-block and virtio-serial read,
  VirtQueueElements are read in as buffers, and passed to
  virtqueue_map_sg(), where num_sg is taken from the wire and can force
  writes to indicies beyond VIRTQUEUE_MAX_SIZE.

  To fix, validate num_sg.

  Reported-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Cc: Amit Shah <amit.shah@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit 36cf2a37132c7f01fa9adb5f95f5312b27742fd4)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  36cf2a37132c7f01fa9adb5f95f5312b27742fd4:virtio: validate num_sg when mapping

  CVE-2013-4535
  CVE-2013-4536

  Both virtio-block and virtio-serial read,
  VirtQueueElements are read in as buffers, and passed to
  virtqueue_map_sg(), where num_sg is taken from the wire and can force
  writes to indicies beyond VIRTQUEUE_MAX_SIZE.

  To fix, validate num_sg.

  Reported-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Cc: Amit Shah <amit.shah@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 68801b7be1ddabe3495f68145b1202049b1486c2
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 4e48018ae9edfafa25fb4ddca745307bd66cfc63
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 36cf2a37132c7f01fa9adb5f95f5312b27742fd4
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
