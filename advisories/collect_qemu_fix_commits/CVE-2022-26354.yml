advisory_id: CVE-2022-26354
datasource_id: collect_qemu_fix_commits/CVE-2022-26354
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  8d1b247f3748ac4078524130c6d7ae42b6140aaf:vhost-vsock: detach the virqueue element in case of error

  In vhost_vsock_common_send_transport_reset(), if an element popped from
  the virtqueue is invalid, we should call virtqueue_detach_element() to
  detach it from the virtqueue before freeing its memory.

  Fixes: fc0b9b0e1c ("vhost-vsock: add virtio sockets device")
  Fixes: CVE-2022-26354
  Cc: qemu-stable@nongnu.org
  Reported-by: VictorV <vv474172261@gmail.com>
  Signed-off-by: Stefano Garzarella <sgarzare@redhat.com>
  Message-Id: <20220228095058.27899-1-sgarzare@redhat.com>
  Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 8d1b247f3748ac4078524130c6d7ae42b6140aaf
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
