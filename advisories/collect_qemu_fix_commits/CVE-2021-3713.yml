advisory_id: CVE-2021-3713
datasource_id: collect_qemu_fix_commits/CVE-2021-3713
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  23ba9f170feca6ae0d8442aab2c89656f9b01288:uas: add stream number sanity checks.

  The device uses the guest-supplied stream number unchecked, which can
  lead to guest-triggered out-of-band access to the UASDevice->data3 and
  UASDevice->status3 fields.  Add the missing checks.

  Fixes: CVE-2021-3713
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  Reported-by: Chen Zhe <chenzhe@huawei.com>
  Reported-by: Tan Jingguo <tanjingguo@huawei.com>
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Message-Id: <20210818120505.1258262-2-kraxel@redhat.com>
  (cherry picked from commit 13b250b12ad3c59114a6a17d59caf073ce45b33a)
  Signed-off-by: Michael Roth <michael.roth@amd.com>
  36403e8788a264dc96174f52584681ebcb4f54b1:uas: add stream number sanity checks.

  The device uses the guest-supplied stream number unchecked, which can
  lead to guest-triggered out-of-band access to the UASDevice->data3 and
  UASDevice->status3 fields.  Add the missing checks.

  Fixes: CVE-2021-3713
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  Reported-by: Chen Zhe <chenzhe@huawei.com>
  Reported-by: Tan Jingguo <tanjingguo@huawei.com>
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Message-Id: <20210818120505.1258262-2-kraxel@redhat.com>
  (cherry picked from commit 13b250b12ad3c59114a6a17d59caf073ce45b33a)
  Signed-off-by: Michael Roth <michael.roth@amd.com>
  13b250b12ad3c59114a6a17d59caf073ce45b33a:uas: add stream number sanity checks.

  The device uses the guest-supplied stream number unchecked, which can
  lead to guest-triggered out-of-band access to the UASDevice->data3 and
  UASDevice->status3 fields.  Add the missing checks.

  Fixes: CVE-2021-3713
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  Reported-by: Chen Zhe <chenzhe@huawei.com>
  Reported-by: Tan Jingguo <tanjingguo@huawei.com>
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Message-Id: <20210818120505.1258262-2-kraxel@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 36403e8788a264dc96174f52584681ebcb4f54b1
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 23ba9f170feca6ae0d8442aab2c89656f9b01288
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 13b250b12ad3c59114a6a17d59caf073ce45b33a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
