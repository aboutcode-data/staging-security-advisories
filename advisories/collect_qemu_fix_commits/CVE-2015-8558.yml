advisory_id: CVE-2015-8558
datasource_id: collect_qemu_fix_commits/CVE-2015-8558
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  ef5d5641f5f35f64a7f150bb3593dae0c08f236d:Merge remote-tracking branch 'remotes/kraxel/tags/pull-usb-20160419-1' into staging

  ehci: fix (s)iTD looping issue (CVE-2015-8558) in a different way.

  # gpg: Signature made Tue 19 Apr 2016 07:22:22 BST using RSA key ID D3E87138
  # gpg: Good signature from "Gerd Hoffmann (work) <kraxel@redhat.com>"
  # gpg:                 aka "Gerd Hoffmann <gerd@kraxel.org>"
  # gpg:                 aka "Gerd Hoffmann (private) <kraxel@gmail.com>"

  * remotes/kraxel/tags/pull-usb-20160419-1:
    Revert "ehci: make idt processing more robust"
    ehci: apply limit to iTD/sidt descriptors

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  0d335804e31b2d93935c957893f4007678390f98:ehci: make idt processing more robust

  Make ehci_process_itd return an error in case we didn't do any actual
  iso transfer because we've found no active transaction.  That'll avoid
  ehci happily run in circles forever if the guest builds a loop out of
  idts.

  This is CVE-2015-8558.

  Cc: qemu-stable@nongnu.org
  Reported-by: Qinghao Tang <luodalongde@gmail.com>
  Tested-by: P J P <ppandit@redhat.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  (cherry picked from commit 156a2e4dbffa85997636a7a39ef12da6f1b40254)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  156a2e4dbffa85997636a7a39ef12da6f1b40254:ehci: make idt processing more robust

  Make ehci_process_itd return an error in case we didn't do any actual
  iso transfer because we've found no active transaction.  That'll avoid
  ehci happily run in circles forever if the guest builds a loop out of
  idts.

  This is CVE-2015-8558.

  Cc: qemu-stable@nongnu.org
  Reported-by: Qinghao Tang <luodalongde@gmail.com>
  Tested-by: P J P <ppandit@redhat.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: ef5d5641f5f35f64a7f150bb3593dae0c08f236d
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 0d335804e31b2d93935c957893f4007678390f98
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 156a2e4dbffa85997636a7a39ef12da6f1b40254
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
