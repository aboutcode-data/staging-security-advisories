advisory_id: CVE-2020-29129
datasource_id: collect_qemu_fix_commits/CVE-2020-29129
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  43f547b73dfaf108c9aaacb0b36200e2e7a200f1:Update libslirp to v4.6.1

  Switch from stable-4.2 branch to upstream v4.6.1 release + fixes.

  ## [Unreleased]

  ### Fixed

   - Haiku fixes. !98 !99
   - Fix a minor DHCP regression introduced in 4.6.0. !97

  ## [4.6.1] - 2021-06-18

  ### Fixed

   - Fix DHCP regression introduced in 4.6.0. !95

  ## [4.6.0] - 2021-06-14

  ### Added

   - mbuf: Add debugging helpers for allocation. !90

  ### Changed

   -  Revert "Set macOS deployment target to macOS 10.4". !93

  ### Fixed

   - mtod()-related buffer overflows (CVE-2021-3592 #44, CVE-2021-3593 #45,
     CVE-2021-3594 #47, CVE-2021-3595 #46).
   - poll_fd: add missing fd registration for UDP and ICMP
   - ncsi: make ncsi_calculate_checksum work with unaligned data. !89
   - Various typos and doc fixes. !88

  ## [4.5.0] - 2021-05-18

  ### Added

   - IPv6 forwarding. !62 !75 !77
   - slirp_neighbor_info() to dump the ARP/NDP tables. !71

  ### Changed

   - Lazy guest address resolution for IPv6. !81
   - Improve signal handling when spawning a child. !61
   - Set macOS deployment target to macOS 10.4. !72
   - slirp_add_hostfwd: Ensure all error paths set errno. !80
   - More API documentation.

  ### Fixed

   - Assertion failure on unspecified IPv6 address. !86
   - Disable polling for PRI on MacOS, fixing some closing streams issues. !73
   - Various memory leak fixes on fastq/batchq. !68
   - Memory leak on IPv6 fast-send. !67
   - Slow socket response on Windows. !64
   - Misc build and code cleanups. !60 !63 !76 !79 !84

  ## [4.4.0] - 2020-12-02

  ### Added

   - udp, udp6, icmp: handle TTL value. !48
   - Enable forwarding ICMP errors. !49
   - Add DNS resolving for iOS. !54

  ### Changed

   - Improve meson subproject() support. !53
   - Removed Makefile-based build system. !56

  ### Fixed

   - socket: consume empty packets. !55
   - check pkt_len before reading protocol header (CVE-2020-29129). !57
   - ip_stripoptions use memmove (fixes undefined behaviour). !47
   - various Coverity-related changes/fixes.

  ## [4.3.1] - 2020-07-08

  ### Changed

   - A silent truncation could occur in `slirp_fmt()`, which will now print a
     critical message. See also #22.

  ### Fixed

   - CVE-2020-10756 - Drop bogus IPv6 messages that could lead to data leakage.
     See !44 and !42.
   - Fix win32 builds by using the SLIRP_PACKED definition.
   - Various coverity scan errors fixed. !41
   - Fix new GCC warnings. !43

  ## [4.3.0] - 2020-04-22

  ### Added

   - `SLIRP_VERSION_STRING` macro, with the git sha suffix when building from git
   - `SlirpConfig.disable_dns`, to disable DNS redirection #16

  ### Changed

   - `slirp_version_string()` now has the git sha suffix when building form git
   - Limit DNS redirection to port 53 #16

  ### Fixed

   - Fix build regression with mingw & NetBSD
   - Fix use-afte-free in `ip_reass()` (CVE-2020-1983)

  Signed-off-by: Marc-André Lureau <marcandre.lureau@redhat.com>
  Reviewed-by: Doug Evans <dje@google.com>
  944fdc5e27a5b5adbb765891e8e70e88ba9a00ec:Merge remote-tracking branch 'remotes/elmarco/tags/libslirp-pull-request' into staging

  # gpg: Signature made Fri 27 Nov 2020 17:06:28 GMT
  # gpg:                using RSA key 87A9BD933F87C606D276F62DDAE8E10975969CE5
  # gpg:                issuer "marcandre.lureau@redhat.com"
  # gpg: Good signature from "Marc-André Lureau <marcandre.lureau@redhat.com>" [full]
  # gpg:                 aka "Marc-André Lureau <marcandre.lureau@gmail.com>" [full]
  # Primary key fingerprint: 87A9 BD93 3F87 C606 D276  F62D DAE8 E109 7596 9CE5

  * remotes/elmarco/tags/libslirp-pull-request:
    slirp: update to fix CVE-2020-29129 CVE-2020-29130

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  37c0c885d19a4c2d69faed891b5c02aaffbdccfb:slirp: update to fix CVE-2020-29129 CVE-2020-29130

  An out-of-bounds access issue was found in the SLIRP user networking
  implementation of QEMU. It could occur while processing ARP/NCSI
  packets, if the packet length was shorter than required to accommodate
  respective protocol headers and payload. A privileged guest user may use
  this flaw to potentially leak host information bytes.

  Marc-André Lureau (1):
        Merge branch 'stable-4.2' into 'stable-4.2'

  Prasad J Pandit (1):
        slirp: check pkt_len before reading protocol header

  Signed-off-by: Marc-André Lureau <marcandre.lureau@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 37c0c885d19a4c2d69faed891b5c02aaffbdccfb
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 944fdc5e27a5b5adbb765891e8e70e88ba9a00ec
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 43f547b73dfaf108c9aaacb0b36200e2e7a200f1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
