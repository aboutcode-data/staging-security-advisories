advisory_id: CVE-2021-3416
datasource_id: collect_qemu_fix_commits/CVE-2021-3416
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  37cee01784ff0df13e5209517e1b3594a5e792d1:lan9118: switch to use qemu_receive_packet() for loopback

  This patch switches to use qemu_receive_packet() which can detect
  reentrancy and return early.

  This is intended to address CVE-2021-3416.

  Cc: Prasad J Pandit <ppandit@redhat.com>
  Cc: qemu-stable@nongnu.org
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com
  Signed-off-by: Alexander Bulekov <alxndr@bu.edu>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  e73adfbeec9d4e008630c814759052ed945c3fed:cadence_gem: switch to use qemu_receive_packet() for loopback

  This patch switches to use qemu_receive_packet() which can detect
  reentrancy and return early.

  This is intended to address CVE-2021-3416.

  Cc: Prasad J Pandit <ppandit@redhat.com>
  Cc: qemu-stable@nongnu.org
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Signed-off-by: Alexander Bulekov <alxndr@bu.edu>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  99ccfaa1edafd79f7a3a0ff7b58ae4da7c514928:pcnet: switch to use qemu_receive_packet() for loopback

  This patch switches to use qemu_receive_packet() which can detect
  reentrancy and return early.

  This is intended to address CVE-2021-3416.

  Cc: Prasad J Pandit <ppandit@redhat.com>
  Cc: qemu-stable@nongnu.org
  Buglink: https://bugs.launchpad.net/qemu/+bug/1917085
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com
  Signed-off-by: Alexander Bulekov <alxndr@bu.edu>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  5311fb805a4403bba024e83886fa0e7572265de4:rtl8139: switch to use qemu_receive_packet() for loopback

  This patch switches to use qemu_receive_packet() which can detect
  reentrancy and return early.

  This is intended to address CVE-2021-3416.

  Cc: Prasad J Pandit <ppandit@redhat.com>
  Cc: qemu-stable@nongnu.org
  Buglink: https://bugs.launchpad.net/qemu/+bug/1910826
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com
  Signed-off-by: Alexander Bulekov <alxndr@bu.edu>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  8c552542b81e56ff532dd27ec6e5328954bdda73:tx_pkt: switch to use qemu_receive_packet_iov() for loopback

  This patch switches to use qemu_receive_receive_iov() which can detect
  reentrancy and return early.

  This is intended to address CVE-2021-3416.

  Cc: Prasad J Pandit <ppandit@redhat.com>
  Cc: qemu-stable@nongnu.org
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  8c92060d3c0248bd4d515719a35922cd2391b9b4:sungem: switch to use qemu_receive_packet() for loopback

  This patch switches to use qemu_receive_packet() which can detect
  reentrancy and return early.

  This is intended to address CVE-2021-3416.

  Cc: Prasad J Pandit <ppandit@redhat.com>
  Cc: qemu-stable@nongnu.org
  Reviewed-by: Mark Cave-Ayland <mark.cave-ayland@ilande.co.uk>
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Reviewed-by: Alistair Francis <alistair.francis@wdc.com>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  26194a58f4eb83c5bdf4061a1628508084450ba1:msf2-mac: switch to use qemu_receive_packet() for loopback

  This patch switches to use qemu_receive_packet() which can detect
  reentrancy and return early.

  This is intended to address CVE-2021-3416.

  Cc: Prasad J Pandit <ppandit@redhat.com>
  Cc: qemu-stable@nongnu.org
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  331d2ac9ea307c990dc86e6493e8f0c48d14bb33:dp8393x: switch to use qemu_receive_packet() for loopback packet

  This patch switches to use qemu_receive_packet() which can detect
  reentrancy and return early.

  This is intended to address CVE-2021-3416.

  Cc: Prasad J Pandit <ppandit@redhat.com>
  Cc: qemu-stable@nongnu.org
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  1caff0340f49c93d535c6558a5138d20d475315c:e1000: switch to use qemu_receive_packet() for loopback

  This patch switches to use qemu_receive_packet() which can detect
  reentrancy and return early.

  This is intended to address CVE-2021-3416.

  Cc: Prasad J Pandit <ppandit@redhat.com>
  Cc: qemu-stable@nongnu.org
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  705df5466c98f3efdd2b68d3b31dad86858acad7:net: introduce qemu_receive_packet()

  Some NIC supports loopback mode and this is done by calling
  nc->info->receive() directly which in fact suppresses the effort of
  reentrancy check that is done in qemu_net_queue_send().

  Unfortunately we can't use qemu_net_queue_send() here since for
  loopback there's no sender as peer, so this patch introduce a
  qemu_receive_packet() which is used for implementing loopback mode
  for a NIC with this check.

  NIC that supports loopback mode will be converted to this helper.

  This is intended to address CVE-2021-3416.

  Cc: Prasad J Pandit <ppandit@redhat.com>
  Reviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Cc: qemu-stable@nongnu.org
  Signed-off-by: Jason Wang <jasowang@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 5311fb805a4403bba024e83886fa0e7572265de4
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 37cee01784ff0df13e5209517e1b3594a5e792d1
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 26194a58f4eb83c5bdf4061a1628508084450ba1
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 99ccfaa1edafd79f7a3a0ff7b58ae4da7c514928
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 705df5466c98f3efdd2b68d3b31dad86858acad7
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 8c92060d3c0248bd4d515719a35922cd2391b9b4
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: e73adfbeec9d4e008630c814759052ed945c3fed
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 8c552542b81e56ff532dd27ec6e5328954bdda73
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 331d2ac9ea307c990dc86e6493e8f0c48d14bb33
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 1caff0340f49c93d535c6558a5138d20d475315c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
