advisory_id: CVE-2016-3710
datasource_id: collect_qemu_fix_commits/CVE-2016-3710
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  53db932604dfa7bb9241d132e0173894cf54261c:Merge remote-tracking branch 'remotes/kraxel/tags/pull-vga-20160509-1' into staging

  vga security fixes (CVE-2016-3710, CVE-2016-3712)

  # gpg: Signature made Mon 09 May 2016 13:39:30 BST using RSA key ID D3E87138
  # gpg: Good signature from "Gerd Hoffmann (work) <kraxel@redhat.com>"
  # gpg:                 aka "Gerd Hoffmann <gerd@kraxel.org>"
  # gpg:                 aka "Gerd Hoffmann (private) <kraxel@gmail.com>"

  * remotes/kraxel/tags/pull-vga-20160509-1:
    vga: make sure vga register setup for vbe stays intact (CVE-2016-3712).
    vga: update vga register setup on vbe changes
    vga: factor out vga register setup
    vga: add vbe_enabled() helper
    vga: fix banked access bounds checking (CVE-2016-3710)

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  53db932604dfa7bb9241d132e0173894cf54261c:Merge remote-tracking branch 'remotes/kraxel/tags/pull-vga-20160509-1' into staging

  vga security fixes (CVE-2016-3710, CVE-2016-3712)

  # gpg: Signature made Mon 09 May 2016 13:39:30 BST using RSA key ID D3E87138
  # gpg: Good signature from "Gerd Hoffmann (work) <kraxel@redhat.com>"
  # gpg:                 aka "Gerd Hoffmann <gerd@kraxel.org>"
  # gpg:                 aka "Gerd Hoffmann (private) <kraxel@gmail.com>"

  * remotes/kraxel/tags/pull-vga-20160509-1:
    vga: make sure vga register setup for vbe stays intact (CVE-2016-3712).
    vga: update vga register setup on vbe changes
    vga: factor out vga register setup
    vga: add vbe_enabled() helper
    vga: fix banked access bounds checking (CVE-2016-3710)

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  4f0323d26c8da08b7bcfdd4722a38711bd2f1a3b:vga: fix banked access bounds checking (CVE-2016-3710)

  vga allows banked access to video memory using the window at 0xa00000
  and it supports a different access modes with different address
  calculations.

  The VBE bochs extentions support banked access too, using the
  VBE_DISPI_INDEX_BANK register.  The code tries to take the different
  address calculations into account and applies different limits to
  VBE_DISPI_INDEX_BANK depending on the current access mode.

  Which is probably effective in stopping misprogramming by accident.
  But from a security point of view completely useless as an attacker
  can easily change access modes after setting the bank register.

  Drop the bogus check, add range checks to vga_mem_{readb,writeb}
  instead.

  Fixes: CVE-2016-3710
  Reported-by: Qinghao Tang <luodalongde@gmail.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  4f0323d26c8da08b7bcfdd4722a38711bd2f1a3b:vga: fix banked access bounds checking (CVE-2016-3710)

  vga allows banked access to video memory using the window at 0xa00000
  and it supports a different access modes with different address
  calculations.

  The VBE bochs extentions support banked access too, using the
  VBE_DISPI_INDEX_BANK register.  The code tries to take the different
  address calculations into account and applies different limits to
  VBE_DISPI_INDEX_BANK depending on the current access mode.

  Which is probably effective in stopping misprogramming by accident.
  But from a security point of view completely useless as an attacker
  can easily change access modes after setting the bank register.

  Drop the bogus check, add range checks to vga_mem_{readb,writeb}
  instead.

  Fixes: CVE-2016-3710
  Reported-by: Qinghao Tang <luodalongde@gmail.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  3bf1817079bb0d80c0d8a86a7c7dd0bfe90eb82e:vga: fix banked access bounds checking (CVE-2016-3710)

  vga allows banked access to video memory using the window at 0xa00000
  and it supports a different access modes with different address
  calculations.

  The VBE bochs extentions support banked access too, using the
  VBE_DISPI_INDEX_BANK register.  The code tries to take the different
  address calculations into account and applies different limits to
  VBE_DISPI_INDEX_BANK depending on the current access mode.

  Which is probably effective in stopping misprogramming by accident.
  But from a security point of view completely useless as an attacker
  can easily change access modes after setting the bank register.

  Drop the bogus check, add range checks to vga_mem_{readb,writeb}
  instead.

  Fixes: CVE-2016-3710
  Reported-by: Qinghao Tang <luodalongde@gmail.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  3bf1817079bb0d80c0d8a86a7c7dd0bfe90eb82e:vga: fix banked access bounds checking (CVE-2016-3710)

  vga allows banked access to video memory using the window at 0xa00000
  and it supports a different access modes with different address
  calculations.

  The VBE bochs extentions support banked access too, using the
  VBE_DISPI_INDEX_BANK register.  The code tries to take the different
  address calculations into account and applies different limits to
  VBE_DISPI_INDEX_BANK depending on the current access mode.

  Which is probably effective in stopping misprogramming by accident.
  But from a security point of view completely useless as an attacker
  can easily change access modes after setting the bank register.

  Drop the bogus check, add range checks to vga_mem_{readb,writeb}
  instead.

  Fixes: CVE-2016-3710
  Reported-by: Qinghao Tang <luodalongde@gmail.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 3bf1817079bb0d80c0d8a86a7c7dd0bfe90eb82e
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 4f0323d26c8da08b7bcfdd4722a38711bd2f1a3b
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 53db932604dfa7bb9241d132e0173894cf54261c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
