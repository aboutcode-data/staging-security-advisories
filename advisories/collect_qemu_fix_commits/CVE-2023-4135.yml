advisory_id: CVE-2023-4135
datasource_id: collect_qemu_fix_commits/CVE-2023-4135
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  dd496f92b97a9a2d36f83a91d8adae90ba65465a:hw/nvme: fix oob memory read in fdp events log

  As reported by Trend Micro's Zero Day Initiative, an oob memory read
  vulnerability exists in nvme_fdp_events(). The host-provided offset is
  not verified.

  Fix this.

  This is only exploitable when Flexible Data Placement mode (fdp=on) is
  enabled.

  Fixes: CVE-2023-4135
  Fixes: 73064edfb864 ("hw/nvme: flexible data placement emulation")
  Reported-by: Trend Micro's Zero Day Initiative
  Signed-off-by: Klaus Jensen <k.jensen@samsung.com>
  (cherry picked from commit ecb1b7b082d3b7dceff0e486a114502fc52c0fdf)
  Signed-off-by: Michael Tokarev <mjt@tls.msk.ru>
  ecb1b7b082d3b7dceff0e486a114502fc52c0fdf:hw/nvme: fix oob memory read in fdp events log

  As reported by Trend Micro's Zero Day Initiative, an oob memory read
  vulnerability exists in nvme_fdp_events(). The host-provided offset is
  not verified.

  Fix this.

  This is only exploitable when Flexible Data Placement mode (fdp=on) is
  enabled.

  Fixes: CVE-2023-4135
  Fixes: 73064edfb864 ("hw/nvme: flexible data placement emulation")
  Reported-by: Trend Micro's Zero Day Initiative
  Signed-off-by: Klaus Jensen <k.jensen@samsung.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: ecb1b7b082d3b7dceff0e486a114502fc52c0fdf
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: dd496f92b97a9a2d36f83a91d8adae90ba65465a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
