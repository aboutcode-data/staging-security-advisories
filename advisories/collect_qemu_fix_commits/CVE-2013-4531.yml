advisory_id: CVE-2013-4531
datasource_id: collect_qemu_fix_commits/CVE-2013-4531
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: "9c01a91c7b201bcb7de04603450c3c64a2475f69:vmstate: fix buffer overflow in target-arm/machine.c\n\
  \nCVE-2013-4531\n\ncpreg_vmstate_indexes is a VARRAY_INT32. A negative value for\ncpreg_vmstate_array_len\
  \ will cause a buffer overflow.\n\nVMSTATE_INT32_LE was supposed to protect against this\n\
  but doesn't because it doesn't validate that input is\nnon-negative.\n\nFix this macro to\
  \ valide the value appropriately.\n\nThe only other user of VMSTATE_INT32_LE doesn't\never\
  \ use negative numbers so it doesn't care.\n\nReported-by: Anthony Liguori <anthony@codemonkey.ws>\n\
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>\nSigned-off-by: Juan Quintela <quintela@redhat.com>\n\
  (cherry picked from commit d2ef4b61fe6d33d2a5dcf100a9b9440de341ad62)\nSigned-off-by: Michael\
  \ Roth <mdroth@linux.vnet.ibm.com>\n630ebeffb4a08f85db748b6908339a60fc213cae:vmstate: fix\
  \ buffer overflow in target-arm/machine.c\n\nCVE-2013-4531\n\ncpreg_vmstate_indexes is a VARRAY_INT32.\
  \ A negative value for\ncpreg_vmstate_array_len will cause a buffer overflow.\n\nVMSTATE_INT32_LE\
  \ was supposed to protect against this\nbut doesn't because it doesn't validate that input\
  \ is\nnon-negative.\n\nFix this macro to valide the value appropriately.\n\nThe only other\
  \ user of VMSTATE_INT32_LE doesn't\never use negative numbers so it doesn't care.\n\nReported-by:\
  \ Anthony Liguori <anthony@codemonkey.ws>\nSigned-off-by: Michael S. Tsirkin <mst@redhat.com>\n\
  Signed-off-by: Juan Quintela <quintela@redhat.com>\n(cherry picked from commit d2ef4b61fe6d33d2a5dcf100a9b9440de341ad62)\n\
  \nConflicts:\n\tvmstate.c\n\n*removed dependency on b6fcfa59 (Move VMState code to vmstate.c)\n\
  \nSigned-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>\nd2ef4b61fe6d33d2a5dcf100a9b9440de341ad62:vmstate:\
  \ fix buffer overflow in target-arm/machine.c\n\nCVE-2013-4531\n\ncpreg_vmstate_indexes is\
  \ a VARRAY_INT32. A negative value for\ncpreg_vmstate_array_len will cause a buffer overflow.\n\
  \nVMSTATE_INT32_LE was supposed to protect against this\nbut doesn't because it doesn't validate\
  \ that input is\nnon-negative.\n\nFix this macro to valide the value appropriately.\n\nThe\
  \ only other user of VMSTATE_INT32_LE doesn't\never use negative numbers so it doesn't care.\n\
  \nReported-by: Anthony Liguori <anthony@codemonkey.ws>\nSigned-off-by: Michael S. Tsirkin\
  \ <mst@redhat.com>\nSigned-off-by: Juan Quintela <quintela@redhat.com>"
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 9c01a91c7b201bcb7de04603450c3c64a2475f69
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 630ebeffb4a08f85db748b6908339a60fc213cae
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d2ef4b61fe6d33d2a5dcf100a9b9440de341ad62
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
