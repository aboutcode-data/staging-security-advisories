advisory_id: CVE-2013-4150
datasource_id: collect_qemu_fix_commits/CVE-2013-4150
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  b24cfb0f1ef056263210cd6e80444a1113cea24a:virtio-net: out-of-bounds buffer write on invalid state load

  CVE-2013-4150 QEMU 1.5.0 out-of-bounds buffer write in
  virtio_net_load()@hw/net/virtio-net.c

  This code is in hw/net/virtio-net.c:

      if (n->max_queues > 1) {
          if (n->max_queues != qemu_get_be16(f)) {
              error_report("virtio-net: different max_queues ");
              return -1;
          }

          n->curr_queues = qemu_get_be16(f);
          for (i = 1; i < n->curr_queues; i++) {
              n->vqs[i].tx_waiting = qemu_get_be32(f);
          }
      }

  Number of vqs is max_queues, so if we get invalid input here,
  for example if max_queues = 2, curr_queues = 3, we get
  write beyond end of the buffer, with data that comes from
  wire.

  This might be used to corrupt qemu memory in hard to predict ways.
  Since we have lots of function pointers around, RCE might be possible.

  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Acked-by: Jason Wang <jasowang@redhat.com>
  Reviewed-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit eea750a5623ddac7a61982eec8f1c93481857578)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  2b15f410bd2c333add4db2e7c96f457cdac3d149:virtio-net: out-of-bounds buffer write on invalid state load

  CVE-2013-4150 QEMU 1.5.0 out-of-bounds buffer write in
  virtio_net_load()@hw/net/virtio-net.c

  This code is in hw/net/virtio-net.c:

      if (n->max_queues > 1) {
          if (n->max_queues != qemu_get_be16(f)) {
              error_report("virtio-net: different max_queues ");
              return -1;
          }

          n->curr_queues = qemu_get_be16(f);
          for (i = 1; i < n->curr_queues; i++) {
              n->vqs[i].tx_waiting = qemu_get_be32(f);
          }
      }

  Number of vqs is max_queues, so if we get invalid input here,
  for example if max_queues = 2, curr_queues = 3, we get
  write beyond end of the buffer, with data that comes from
  wire.

  This might be used to corrupt qemu memory in hard to predict ways.
  Since we have lots of function pointers around, RCE might be possible.

  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Acked-by: Jason Wang <jasowang@redhat.com>
  Reviewed-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit eea750a5623ddac7a61982eec8f1c93481857578)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  eea750a5623ddac7a61982eec8f1c93481857578:virtio-net: out-of-bounds buffer write on invalid state load

  CVE-2013-4150 QEMU 1.5.0 out-of-bounds buffer write in
  virtio_net_load()@hw/net/virtio-net.c

  This code is in hw/net/virtio-net.c:

      if (n->max_queues > 1) {
          if (n->max_queues != qemu_get_be16(f)) {
              error_report("virtio-net: different max_queues ");
              return -1;
          }

          n->curr_queues = qemu_get_be16(f);
          for (i = 1; i < n->curr_queues; i++) {
              n->vqs[i].tx_waiting = qemu_get_be32(f);
          }
      }

  Number of vqs is max_queues, so if we get invalid input here,
  for example if max_queues = 2, curr_queues = 3, we get
  write beyond end of the buffer, with data that comes from
  wire.

  This might be used to corrupt qemu memory in hard to predict ways.
  Since we have lots of function pointers around, RCE might be possible.

  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Acked-by: Jason Wang <jasowang@redhat.com>
  Reviewed-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: eea750a5623ddac7a61982eec8f1c93481857578
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 2b15f410bd2c333add4db2e7c96f457cdac3d149
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b24cfb0f1ef056263210cd6e80444a1113cea24a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
