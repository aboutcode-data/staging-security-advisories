advisory_id: CVE-2013-4541
datasource_id: collect_qemu_fix_commits/CVE-2013-4541
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  15c35dfd9299733e5391b65efd3e0356a01d01ad:usb: sanity check setup_index+setup_len in post_load

  CVE-2013-4541

  s->setup_len and s->setup_index are fed into usb_packet_copy as
  size/offset into s->data_buf, it's possible for invalid state to exploit
  this to load arbitrary data.

  setup_len and setup_index should be checked to make sure
  they are not negative.

  Cc: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit 9f8e9895c504149d7048e9fc5eb5cbb34b16e49a)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  c4bd2e4cb0550fd83321029b9ae7582073fcac67:usb: sanity check setup_index+setup_len in post_load

  CVE-2013-4541

  s->setup_len and s->setup_index are fed into usb_packet_copy as
  size/offset into s->data_buf, it's possible for invalid state to exploit
  this to load arbitrary data.

  setup_len and setup_index should be checked to make sure
  they are not negative.

  Cc: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit 9f8e9895c504149d7048e9fc5eb5cbb34b16e49a)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  9f8e9895c504149d7048e9fc5eb5cbb34b16e49a:usb: sanity check setup_index+setup_len in post_load

  CVE-2013-4541

  s->setup_len and s->setup_index are fed into usb_packet_copy as
  size/offset into s->data_buf, it's possible for invalid state to exploit
  this to load arbitrary data.

  setup_len and setup_index should be checked to make sure
  they are not negative.

  Cc: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: c4bd2e4cb0550fd83321029b9ae7582073fcac67
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 15c35dfd9299733e5391b65efd3e0356a01d01ad
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 9f8e9895c504149d7048e9fc5eb5cbb34b16e49a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
