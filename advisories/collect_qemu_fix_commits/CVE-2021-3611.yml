advisory_id: CVE-2021-3611
datasource_id: collect_qemu_fix_commits/CVE-2021-3611
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  b7a3a705b644495b7b578e94e0e9dedf93c4f661:Merge tag 'pull-request-2022-03-21' of https://gitlab.com/thuth/qemu into staging

  * Fix stack-overflow due to recursive DMA in intel-hda (CVE-2021-3611)
  * Fix heap overflow due to recursive DMA in sdhci code

  # gpg: Signature made Mon 21 Mar 2022 16:14:36 GMT
  # gpg:                using RSA key 27B88847EEE0250118F3EAB92ED9D774FE702DB5
  # gpg:                issuer "thuth@redhat.com"
  # gpg: Good signature from "Thomas Huth <th.huth@gmx.de>" [full]
  # gpg:                 aka "Thomas Huth <thuth@redhat.com>" [full]
  # gpg:                 aka "Thomas Huth <huth@tuxfamily.org>" [full]
  # gpg:                 aka "Thomas Huth <th.huth@posteo.de>" [unknown]
  # Primary key fingerprint: 27B8 8847 EEE0 2501 18F3  EAB9 2ED9 D774 FE70 2DB5

  * tag 'pull-request-2022-03-21' of https://gitlab.com/thuth/qemu:
    tests/qtest/fuzz-sdcard-test: Add reproducer for OSS-Fuzz (Issue 29225)
    hw/sd/sdhci: Prohibit DMA accesses to devices
    hw/sd/sdhci: Honor failed DMA transactions
    tests/qtest/intel-hda-test: Add reproducer for issue #542
    hw/audio/intel-hda: Restrict DMA engine to memories (not MMIO devices)
    hw/audio/intel-hda: Do not ignore DMA overrun errors
    softmmu/physmem: Introduce MemTxAttrs::memory field and MEMTX_ACCESS_ERROR
    softmmu/physmem: Simplify flatview_write and address_space_access_valid

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  79fa99831debc9782087e834382c577215f2f511:hw/audio/intel-hda: Restrict DMA engine to memories (not MMIO devices)

  Issue #542 reports a reentrancy problem when the DMA engine accesses
  the HDA controller I/O registers. Fix by restricting the DMA engine
  to memories regions (forbidding MMIO devices such the HDA controller).

  Reported-by: OSS-Fuzz (Issue 28435)
  Reported-by: Alexander Bulekov <alxndr@bu.edu>
  Signed-off-by: Philippe Mathieu-Daud√© <philmd@redhat.com>
  Reviewed-by: Thomas Huth <thuth@redhat.com>
  Resolves: https://gitlab.com/qemu-project/qemu/-/issues/542
  CVE: CVE-2021-3611
  Message-Id: <20211218160912.1591633-3-philmd@redhat.com>
  Signed-off-by: Thomas Huth <thuth@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b7a3a705b644495b7b578e94e0e9dedf93c4f661
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 79fa99831debc9782087e834382c577215f2f511
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
