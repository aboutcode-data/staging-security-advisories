advisory_id: CVE-2016-4952
datasource_id: collect_qemu_fix_commits/CVE-2016-4952
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  8b95d8e1d5157c7875ad6c0315b2b42b1f66a184:scsi: pvscsi: check command descriptor ring buffer size (CVE-2016-4952)

  Vmware Paravirtual SCSI emulation uses command descriptors to
  process SCSI commands. These descriptors come with their ring
  buffers. A guest could set the ring buffer size to an arbitrary
  value leading to OOB access issue. Add check to avoid it.

  Reported-by: Li Qiang <liqiang6-s@360.cn>
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Cc: qemu-stable@nongnu.org
  Message-Id: <1464000485-27041-1-git-send-email-ppandit@redhat.com>
  Reviewed-by: Shmulik Ladkani <shmulik.ladkani@ravellosystems.com>
  Reviewed-by: Dmitry Fleytman <dmitry@daynix.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  (cherry picked from commit 3e831b40e015ba34dfb55ff11f767001839425ff)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  3e831b40e015ba34dfb55ff11f767001839425ff:scsi: pvscsi: check command descriptor ring buffer size (CVE-2016-4952)

  Vmware Paravirtual SCSI emulation uses command descriptors to
  process SCSI commands. These descriptors come with their ring
  buffers. A guest could set the ring buffer size to an arbitrary
  value leading to OOB access issue. Add check to avoid it.

  Reported-by: Li Qiang <liqiang6-s@360.cn>
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Cc: qemu-stable@nongnu.org
  Message-Id: <1464000485-27041-1-git-send-email-ppandit@redhat.com>
  Reviewed-by: Shmulik Ladkani <shmulik.ladkani@ravellosystems.com>
  Reviewed-by: Dmitry Fleytman <dmitry@daynix.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 8b95d8e1d5157c7875ad6c0315b2b42b1f66a184
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 3e831b40e015ba34dfb55ff11f767001839425ff
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
