advisory_id: CVE-2014-8106
datasource_id: collect_qemu_fix_commits/CVE-2014-8106
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  fc8e94c3e5e74437c4e73a5582f17cfd4cae5ccf:cirrus: add blit_is_unsafe call to cirrus_bitblt_cputovideo (CVE-2017-2620)

  CIRRUS_BLTMODE_MEMSYSSRC blits do NOT check blit destination
  and blit width, at all.  Oops.  Fix it.

  Security impact: high.

  The missing blit destination check allows to write to host memory.
  Basically same as CVE-2014-8106 for the other blit variants.

  Cc: qemu-stable@nongnu.org
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  (cherry picked from commit 92f2b88cea48c6aeba8de568a45f2ed958f3c298)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  f054cead44cef75d330cfba39aa0c46be483813d:cirrus: fix oob access issue (CVE-2017-2615)

  When doing bitblt copy in backward mode, we should minus the
  blt width first just like the adding in the forward mode. This
  can avoid the oob access of the front of vga's vram.

  Signed-off-by: Li Qiang <liqiang6-s@360.cn>

  { kraxel: with backward blits (negative pitch) addr is the topmost
            address, so check it as-is against vram size ]

  Cc: qemu-stable@nongnu.org
  Cc: P J P <ppandit@redhat.com>
  Cc: Laszlo Ersek <lersek@redhat.com>
  Cc: Paolo Bonzini <pbonzini@redhat.com>
  Cc: Wolfgang Bumiller <w.bumiller@proxmox.com>
  Fixes: d3532a0db02296e687711b8cdc7791924efccea0 (CVE-2014-8106)
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  Message-id: 1485938101-26602-1-git-send-email-kraxel@redhat.com
  Reviewed-by: Laszlo Ersek <lersek@redhat.com>
  (cherry picked from commit 62d4c6bd5263bb8413a06c80144fc678df6dfb64)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  92f2b88cea48c6aeba8de568a45f2ed958f3c298:cirrus: add blit_is_unsafe call to cirrus_bitblt_cputovideo (CVE-2017-2620)

  CIRRUS_BLTMODE_MEMSYSSRC blits do NOT check blit destination
  and blit width, at all.  Oops.  Fix it.

  Security impact: high.

  The missing blit destination check allows to write to host memory.
  Basically same as CVE-2014-8106 for the other blit variants.

  Cc: qemu-stable@nongnu.org
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  62d4c6bd5263bb8413a06c80144fc678df6dfb64:cirrus: fix oob access issue (CVE-2017-2615)

  When doing bitblt copy in backward mode, we should minus the
  blt width first just like the adding in the forward mode. This
  can avoid the oob access of the front of vga's vram.

  Signed-off-by: Li Qiang <liqiang6-s@360.cn>

  { kraxel: with backward blits (negative pitch) addr is the topmost
            address, so check it as-is against vram size ]

  Cc: qemu-stable@nongnu.org
  Cc: P J P <ppandit@redhat.com>
  Cc: Laszlo Ersek <lersek@redhat.com>
  Cc: Paolo Bonzini <pbonzini@redhat.com>
  Cc: Wolfgang Bumiller <w.bumiller@proxmox.com>
  Fixes: d3532a0db02296e687711b8cdc7791924efccea0 (CVE-2014-8106)
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  Message-id: 1485938101-26602-1-git-send-email-kraxel@redhat.com
  Reviewed-by: Laszlo Ersek <lersek@redhat.com>
  bf25983345ca44aec3dd92c57142be45452bd38a:cirrus: don't overflow CirrusVGAState->cirrus_bltbuf

  This is CVE-2014-8106.

  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  d3532a0db02296e687711b8cdc7791924efccea0:cirrus: fix blit region check

  Issues:
   * Doesn't check pitches correctly in case it is negative.
   * Doesn't check width at all.

  Turn macro into functions while being at it, also factor out the check
  for one region which we then can simply call twice for src + dst.

  This is CVE-2014-8106.

  Reported-by: Paolo Bonzini <pbonzini@redhat.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  Reviewed-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: fc8e94c3e5e74437c4e73a5582f17cfd4cae5ccf
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: f054cead44cef75d330cfba39aa0c46be483813d
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 92f2b88cea48c6aeba8de568a45f2ed958f3c298
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d3532a0db02296e687711b8cdc7791924efccea0
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 62d4c6bd5263bb8413a06c80144fc678df6dfb64
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: bf25983345ca44aec3dd92c57142be45452bd38a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
