advisory_id: CVE-2013-4540
datasource_id: collect_qemu_fix_commits/CVE-2013-4540
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  e7ff13929f58acd1d21a50930fa500d6160f7356:zaurus: fix buffer overrun on invalid state load

  CVE-2013-4540

  Within scoop_gpio_handler_update, if prev_level has a high bit set, then
  we get bit > 16 and that causes a buffer overrun.

  Since prev_level comes from wire indirectly, this can
  happen on invalid state load.

  Similarly for gpio_level and gpio_dir.

  To fix, limit to 16 bit.

  Reported-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit 52f91c3723932f8340fe36c8ec8b18a757c37b2b)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  8d948a000d4963fe5ef20ba8478a0119b659c4ad:zaurus: fix buffer overrun on invalid state load

  CVE-2013-4540

  Within scoop_gpio_handler_update, if prev_level has a high bit set, then
  we get bit > 16 and that causes a buffer overrun.

  Since prev_level comes from wire indirectly, this can
  happen on invalid state load.

  Similarly for gpio_level and gpio_dir.

  To fix, limit to 16 bit.

  Reported-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit 52f91c3723932f8340fe36c8ec8b18a757c37b2b)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  52f91c3723932f8340fe36c8ec8b18a757c37b2b:zaurus: fix buffer overrun on invalid state load

  CVE-2013-4540

  Within scoop_gpio_handler_update, if prev_level has a high bit set, then
  we get bit > 16 and that causes a buffer overrun.

  Since prev_level comes from wire indirectly, this can
  happen on invalid state load.

  Similarly for gpio_level and gpio_dir.

  To fix, limit to 16 bit.

  Reported-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: e7ff13929f58acd1d21a50930fa500d6160f7356
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 52f91c3723932f8340fe36c8ec8b18a757c37b2b
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 8d948a000d4963fe5ef20ba8478a0119b659c4ad
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
