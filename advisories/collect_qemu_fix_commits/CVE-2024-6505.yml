advisory_id: CVE-2024-6505
datasource_id: collect_qemu_fix_commits/CVE-2024-6505
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  f8f1ea2a3c11b540befa3a8b1c572e0454450ce9:virtio-net: Ensure queue index fits with RSS

  Ensure the queue index points to a valid queue when software RSS
  enabled. The new calculation matches with the behavior of Linux's TAP
  device with the RSS eBPF program.

  Fixes: 4474e37a5b3a ("virtio-net: implement RX RSS processing")
  Reported-by: Zhibin Hu <huzhibin5@huawei.com>
  Cc: qemu-stable@nongnu.org
  Signed-off-by: Akihiko Odaki <akihiko.odaki@daynix.com>
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  (cherry picked from commit f1595ceb9aad36a6c1da95bcb77ab9509b38822d)
  Signed-off-by: Michael Tokarev <mjt@tls.msk.ru>
  Fixes: CVE-2024-6505
  44ef533498db5078c4432a3f1e160ed5539d7d29:virtio-net: Ensure queue index fits with RSS

  Ensure the queue index points to a valid queue when software RSS
  enabled. The new calculation matches with the behavior of Linux's TAP
  device with the RSS eBPF program.

  Fixes: 4474e37a5b3a ("virtio-net: implement RX RSS processing")
  Reported-by: Zhibin Hu <huzhibin5@huawei.com>
  Cc: qemu-stable@nongnu.org
  Signed-off-by: Akihiko Odaki <akihiko.odaki@daynix.com>
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  (cherry picked from commit f1595ceb9aad36a6c1da95bcb77ab9509b38822d)
  Signed-off-by: Michael Tokarev <mjt@tls.msk.ru>
  Fixes: CVE-2024-6505
  d2476ced2e34b661dded77d8774955b5a90fbda4:virtio-net: Ensure queue index fits with RSS

  Ensure the queue index points to a valid queue when software RSS
  enabled. The new calculation matches with the behavior of Linux's TAP
  device with the RSS eBPF program.

  Fixes: 4474e37a5b3a ("virtio-net: implement RX RSS processing")
  Reported-by: Zhibin Hu <huzhibin5@huawei.com>
  Cc: qemu-stable@nongnu.org
  Signed-off-by: Akihiko Odaki <akihiko.odaki@daynix.com>
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  (cherry picked from commit f1595ceb9aad36a6c1da95bcb77ab9509b38822d)
  Signed-off-by: Michael Tokarev <mjt@tls.msk.ru>
  Fixes: CVE-2024-6505
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 44ef533498db5078c4432a3f1e160ed5539d7d29
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: f8f1ea2a3c11b540befa3a8b1c572e0454450ce9
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d2476ced2e34b661dded77d8774955b5a90fbda4
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
