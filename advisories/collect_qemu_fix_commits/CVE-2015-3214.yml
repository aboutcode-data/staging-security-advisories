advisory_id: CVE-2015-3214
datasource_id: collect_qemu_fix_commits/CVE-2015-3214
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  49ef542e41526218fa28bf8762f95387a1cc4ccf:i8254: fix out-of-bounds memory access in pit_ioport_read()

  Due converting PIO to the new memory read/write api we no longer provide
  separate I/O region lenghts for read and write operations. As a result,
  reading from PIT Mode/Command register will end with accessing
  pit->channels with invalid index.

  Fix this by ignoring read from the Mode/Command register.

  This is CVE-2015-3214.

  Reported-by: Matt Tait <matttait@google.com>
  Fixes: 0505bcdec8228d8de39ab1a02644e71999e7c052
  Cc: qemu-stable@nongnu.org
  Signed-off-by: Petr Matousek <pmatouse@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  (cherry picked from commit d4862a87e31a51de9eb260f25c9e99a75efe3235)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  d4862a87e31a51de9eb260f25c9e99a75efe3235:i8254: fix out-of-bounds memory access in pit_ioport_read()

  Due converting PIO to the new memory read/write api we no longer provide
  separate I/O region lenghts for read and write operations. As a result,
  reading from PIT Mode/Command register will end with accessing
  pit->channels with invalid index.

  Fix this by ignoring read from the Mode/Command register.

  This is CVE-2015-3214.

  Reported-by: Matt Tait <matttait@google.com>
  Fixes: 0505bcdec8228d8de39ab1a02644e71999e7c052
  Cc: qemu-stable@nongnu.org
  Signed-off-by: Petr Matousek <pmatouse@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d4862a87e31a51de9eb260f25c9e99a75efe3235
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 49ef542e41526218fa28bf8762f95387a1cc4ccf
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
