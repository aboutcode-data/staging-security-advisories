advisory_id: CVE-2019-14378
datasource_id: collect_qemu_fix_commits/CVE-2019-14378
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  862240852be8ddb6fa720e84e83e234cee848b2f:slirp: update to fix CVE-2020-1983

  This is an update on the stable-4.2 branch of libslirp.git:

  git shortlog 55ab21c9a3..2faae0f778f81

  Marc-André Lureau (1):
        Fix use-afte-free in ip_reass() (CVE-2020-1983)

  CVE-2020-1983 is actually a follow up fix for commit
  126c04acbabd7ad32c2b018fe10dfac2a3bc1210 ("Fix heap overflow in
  ip_reass on big packet input") which was was included in qemu
  v4.1 (commit e1a4a24d262ba5ac74ea1795adb3ab1cd574c7fb "slirp: update
  with CVE-2019-14378 fix").

  Signed-off-by: Marc-André Lureau <marcandre.lureau@redhat.com>
  Message-id: 20200421170227.843555-1-marcandre.lureau@redhat.com
  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  (cherry picked from commit 7769c23774d1278f60b9e40d2c0b98784de6425f)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  7769c23774d1278f60b9e40d2c0b98784de6425f:slirp: update to fix CVE-2020-1983

  This is an update on the stable-4.2 branch of libslirp.git:

  git shortlog 55ab21c9a3..2faae0f778f81

  Marc-André Lureau (1):
        Fix use-afte-free in ip_reass() (CVE-2020-1983)

  CVE-2020-1983 is actually a follow up fix for commit
  126c04acbabd7ad32c2b018fe10dfac2a3bc1210 ("Fix heap overflow in
  ip_reass on big packet input") which was was included in qemu
  v4.1 (commit e1a4a24d262ba5ac74ea1795adb3ab1cd574c7fb "slirp: update
  with CVE-2019-14378 fix").

  Signed-off-by: Marc-André Lureau <marcandre.lureau@redhat.com>
  Message-id: 20200421170227.843555-1-marcandre.lureau@redhat.com
  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  b27192be13da3fb59f51185d9a1f944b3474b2fc:slirp: ip_reass: Fix use after free

  Using ip_deq after m_free might read pointers from an allocation reuse.

  This would be difficult to exploit, but that is still related with
  CVE-2019-14378 which generates fragmented IP packets that would trigger this
  issue and at least produce a DoS.

  Signed-off-by: Samuel Thibault <samuel.thibault@ens-lyon.org>
  (from libslirp.git commit c59279437eda91841b9d26079c70b8a540d41204)
  Fixes: CVE-2019-15890
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  c2e03e2aa42d0f4f41deb08c2655503835840afa:slirp: Fix heap overflow in ip_reass on big packet input

  When the first fragment does not fit in the preallocated buffer, q will
  already be pointing to the ext buffer, so we mustn't try to update it.

  Signed-off-by: Samuel Thibault <samuel.thibault@ens-lyon.org>
  (from libslirp.git commit 126c04acbabd7ad32c2b018fe10dfac2a3bc1210)
  (from libslirp.git commit e0be80430c390bce181ea04dfcdd6ea3dfa97de1)
  *squash in e0be80 (clarifying comments)
  Fixes: CVE-2019-14378
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  9efdbc0224a0edb05e109ad8e1f127b5ac004191:slrip: ip_reass: Fix use after free

  Using ip_deq after m_free might read pointers from an allocation reuse.

  This would be difficult to exploit, but that is still related with
  CVE-2019-14378 which generates fragmented IP packets that would trigger this
  issue and at least produce a DoS.

  Signed-off-by: Samuel Thibault <samuel.thibault@ens-lyon.org>
  (from libslirp.git commit c59279437eda91841b9d26079c70b8a540d41204)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  9bcf2dfa163f67b0fec6ee0fe88ad5dc5d69dc59:Merge remote-tracking branch 'remotes/elmarco/tags/slirp-CVE-2019-14378-pull-request' into staging

  Slirp CVE-2019-14378 pull request

  # gpg: Signature made Fri 02 Aug 2019 12:17:24 BST
  # gpg:                using RSA key 87A9BD933F87C606D276F62DDAE8E10975969CE5
  # gpg:                issuer "marcandre.lureau@redhat.com"
  # gpg: Good signature from "Marc-André Lureau <marcandre.lureau@redhat.com>" [full]
  # gpg:                 aka "Marc-André Lureau <marcandre.lureau@gmail.com>" [full]
  # Primary key fingerprint: 87A9 BD93 3F87 C606 D276  F62D DAE8 E109 7596 9CE5

  * remotes/elmarco/tags/slirp-CVE-2019-14378-pull-request:
    slirp: update with CVE-2019-14378 fix

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  9bcf2dfa163f67b0fec6ee0fe88ad5dc5d69dc59:Merge remote-tracking branch 'remotes/elmarco/tags/slirp-CVE-2019-14378-pull-request' into staging

  Slirp CVE-2019-14378 pull request

  # gpg: Signature made Fri 02 Aug 2019 12:17:24 BST
  # gpg:                using RSA key 87A9BD933F87C606D276F62DDAE8E10975969CE5
  # gpg:                issuer "marcandre.lureau@redhat.com"
  # gpg: Good signature from "Marc-André Lureau <marcandre.lureau@redhat.com>" [full]
  # gpg:                 aka "Marc-André Lureau <marcandre.lureau@gmail.com>" [full]
  # Primary key fingerprint: 87A9 BD93 3F87 C606 D276  F62D DAE8 E109 7596 9CE5

  * remotes/elmarco/tags/slirp-CVE-2019-14378-pull-request:
    slirp: update with CVE-2019-14378 fix

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  9bcf2dfa163f67b0fec6ee0fe88ad5dc5d69dc59:Merge remote-tracking branch 'remotes/elmarco/tags/slirp-CVE-2019-14378-pull-request' into staging

  Slirp CVE-2019-14378 pull request

  # gpg: Signature made Fri 02 Aug 2019 12:17:24 BST
  # gpg:                using RSA key 87A9BD933F87C606D276F62DDAE8E10975969CE5
  # gpg:                issuer "marcandre.lureau@redhat.com"
  # gpg: Good signature from "Marc-André Lureau <marcandre.lureau@redhat.com>" [full]
  # gpg:                 aka "Marc-André Lureau <marcandre.lureau@gmail.com>" [full]
  # Primary key fingerprint: 87A9 BD93 3F87 C606 D276  F62D DAE8 E109 7596 9CE5

  * remotes/elmarco/tags/slirp-CVE-2019-14378-pull-request:
    slirp: update with CVE-2019-14378 fix

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  9bcf2dfa163f67b0fec6ee0fe88ad5dc5d69dc59:Merge remote-tracking branch 'remotes/elmarco/tags/slirp-CVE-2019-14378-pull-request' into staging

  Slirp CVE-2019-14378 pull request

  # gpg: Signature made Fri 02 Aug 2019 12:17:24 BST
  # gpg:                using RSA key 87A9BD933F87C606D276F62DDAE8E10975969CE5
  # gpg:                issuer "marcandre.lureau@redhat.com"
  # gpg: Good signature from "Marc-André Lureau <marcandre.lureau@redhat.com>" [full]
  # gpg:                 aka "Marc-André Lureau <marcandre.lureau@gmail.com>" [full]
  # Primary key fingerprint: 87A9 BD93 3F87 C606 D276  F62D DAE8 E109 7596 9CE5

  * remotes/elmarco/tags/slirp-CVE-2019-14378-pull-request:
    slirp: update with CVE-2019-14378 fix

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  e1a4a24d262ba5ac74ea1795adb3ab1cd574c7fb:slirp: update with CVE-2019-14378 fix

  Signed-off-by: Marc-André Lureau <marcandre.lureau@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 9efdbc0224a0edb05e109ad8e1f127b5ac004191
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 9bcf2dfa163f67b0fec6ee0fe88ad5dc5d69dc59
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 7769c23774d1278f60b9e40d2c0b98784de6425f
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 862240852be8ddb6fa720e84e83e234cee848b2f
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: e1a4a24d262ba5ac74ea1795adb3ab1cd574c7fb
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: c2e03e2aa42d0f4f41deb08c2655503835840afa
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b27192be13da3fb59f51185d9a1f944b3474b2fc
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
