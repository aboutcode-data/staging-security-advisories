advisory_id: CVE-2013-4529
datasource_id: collect_qemu_fix_commits/CVE-2013-4529
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  f7ef3baa4950bbcad9a54c100313fb071908ff5b:hw/pci/pcie_aer.c: fix buffer overruns on invalid state load

  4) CVE-2013-4529
  hw/pci/pcie_aer.c    pcie aer log can overrun the buffer if log_num is
                       too large

  There are two issues in this file:
  1. log_max from remote can be larger than on local
  then buffer will overrun with data coming from state file.
  2. log_num can be larger then we get data corruption
  again with an overflow but not adversary controlled.

  Fix both issues.

  Reported-by: Anthony Liguori <anthony@codemonkey.ws>
  Reported-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit 5f691ff91d323b6f97c6600405a7f9dc115a0ad1)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  e83444f71eb48d18c7bcf3616846a6c2f9575f5c:hw/pci/pcie_aer.c: fix buffer overruns on invalid state load

  4) CVE-2013-4529
  hw/pci/pcie_aer.c    pcie aer log can overrun the buffer if log_num is
                       too large

  There are two issues in this file:
  1. log_max from remote can be larger than on local
  then buffer will overrun with data coming from state file.
  2. log_num can be larger then we get data corruption
  again with an overflow but not adversary controlled.

  Fix both issues.

  Reported-by: Anthony Liguori <anthony@codemonkey.ws>
  Reported-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit 5f691ff91d323b6f97c6600405a7f9dc115a0ad1)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  5f691ff91d323b6f97c6600405a7f9dc115a0ad1:hw/pci/pcie_aer.c: fix buffer overruns on invalid state load

  4) CVE-2013-4529
  hw/pci/pcie_aer.c    pcie aer log can overrun the buffer if log_num is
                       too large

  There are two issues in this file:
  1. log_max from remote can be larger than on local
  then buffer will overrun with data coming from state file.
  2. log_num can be larger then we get data corruption
  again with an overflow but not adversary controlled.

  Fix both issues.

  Reported-by: Anthony Liguori <anthony@codemonkey.ws>
  Reported-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 5f691ff91d323b6f97c6600405a7f9dc115a0ad1
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: e83444f71eb48d18c7bcf3616846a6c2f9575f5c
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: f7ef3baa4950bbcad9a54c100313fb071908ff5b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
