advisory_id: CVE-2020-14394
datasource_id: collect_qemu_fix_commits/CVE-2020-14394
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  d293d70a8d4720cc1458f4953ed9974d5df96f8e:Merge tag 'pull-request-2022-08-16' of https://gitlab.com/thuth/qemu into staging

  * Fix a possible endless loop in USB XHCI code
  * Minor fixes for the new readconfig test

  # -----BEGIN PGP SIGNATURE-----
  #
  # iQJFBAABCAAvFiEEJ7iIR+7gJQEY8+q5LtnXdP5wLbUFAmL7aT8RHHRodXRoQHJl
  # ZGhhdC5jb20ACgkQLtnXdP5wLbXm6w//TzGqEkzN6VeYqCgbI5ZuCcu3uL/X7KcO
  # vsljTTYeJgE3IuT4RARk4d2/K8xD/mzyxMTHP5SrbCIYSOBY4OusJN55fytX46mb
  # cdy3dHWbwaT7y8J+BLpwOg7om+oDp1Q2o1JxPY39BEi5T2C6PBHveDf9XxNv2n2j
  # 9kwF0la7EmhmNoUgWyvf3dVoOFS3G4BTP1ZSvjcUNRuAxGLGZ8XOhZYw5zQ4MMTF
  # OrNdVPmMDyLjAxpdO5dKItvTs8l0ioSXsbrNK+w2o58U1Wmczkn3BYcel2m+J14v
  # XY9jtq9qUHjTmFRCCop0LYitkDvW+mAmptFsc94Y0ulc3JQ1KNvvjBIgNKZGRCkv
  # Fw7xdArifc1TMpRdgNP1Gr88LXtSPEaPsHYMRy7AHcv2Abd9zrRm7JMa45mburzp
  # jhUvFYCLN2iDgd78HClDAGuRLWAEaJDLkbvxHtJxGW8m9lHHwkrUeLm6uJMrSwu6
  # 880O0/ayEz0jw5yDEDC/ooTbcWKgbpZ7KPREciSLTAPsC2orBrBIjlioY1YxfAMZ
  # rrP7KvGggP7yWrOn4BKUWRo7NC2WPQ69nJQCTsXij4NlKsWAaJ3EgldKDcFgungk
  # DsEm+FQhcDDfeOWN03dNxRxz8bFm1/HbSHgna5C5xnbQbQMiSPYVYWPjzK6E8kKO
  # NgjewJS4E7E=
  # =5xZ9
  # -----END PGP SIGNATURE-----
  # gpg: Signature made Tue 16 Aug 2022 04:54:07 AM CDT
  # gpg:                using RSA key 27B88847EEE0250118F3EAB92ED9D774FE702DB5
  # gpg:                issuer "thuth@redhat.com"
  # gpg: Good signature from "Thomas Huth <th.huth@gmx.de>" [undefined]
  # gpg:                 aka "Thomas Huth <thuth@redhat.com>" [undefined]
  # gpg:                 aka "Thomas Huth <th.huth@posteo.de>" [unknown]
  # gpg:                 aka "Thomas Huth <huth@tuxfamily.org>" [undefined]
  # gpg: WARNING: This key is not certified with a trusted signature!
  # gpg:          There is no indication that the signature belongs to the owner.
  # Primary key fingerprint: 27B8 8847 EEE0 2501 18F3  EAB9 2ED9 D774 FE70 2DB5

  * tag 'pull-request-2022-08-16' of https://gitlab.com/thuth/qemu:
    hw/usb/hcd-xhci: Fix unbounded loop in xhci_ring_chain_length() (CVE-2020-14394)
    tests/qtest: misc tweaks to readconfig

  Signed-off-by: Richard Henderson <richard.henderson@linaro.org>
  effaf5a240e03020f4ae953e10b764622c3e87cc:hw/usb/hcd-xhci: Fix unbounded loop in xhci_ring_chain_length() (CVE-2020-14394)

  The loop condition in xhci_ring_chain_length() is under control of
  the guest, and additionally the code does not check for failed DMA
  transfers (e.g. if reaching the end of the RAM), so the loop there
  could run for a very long time or even forever. Fix it by checking
  the return value of dma_memory_read() and by introducing a maximum
  loop length.

  Resolves: https://gitlab.com/qemu-project/qemu/-/issues/646
  Message-Id: <20220804131300.96368-1-thuth@redhat.com>
  Reviewed-by: Mauro Matteo Cascella <mcascell@redhat.com>
  Acked-by: Gerd Hoffmann <kraxel@redhat.com>
  Signed-off-by: Thomas Huth <thuth@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: effaf5a240e03020f4ae953e10b764622c3e87cc
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d293d70a8d4720cc1458f4953ed9974d5df96f8e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
