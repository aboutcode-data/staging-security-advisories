advisory_id: CVE-2015-6815
datasource_id: collect_qemu_fix_commits/CVE-2015-6815
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  3a56af1fbc17ff453f6e90fb08ce0c0e6fd0b61b:e1000: Avoid infinite loop in processing transmit descriptor (CVE-2015-6815)

  While processing transmit descriptors, it could lead to an infinite
  loop if 'bytes' was to become zero; Add a check to avoid it.

  [The guest can force 'bytes' to 0 by setting the hdr_len and mss
  descriptor fields to 0.
  --Stefan]

  Signed-off-by: P J P <pjp@fedoraproject.org>
  Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
  Reviewed-by: Thomas Huth <thuth@redhat.com>
  Message-id: 1441383666-6590-1-git-send-email-stefanha@redhat.com
  (cherry picked from commit b947ac2bf26479e710489739c465c8af336599e7)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  b76a0d5db25ad9f81346930230092fdf1e88a5a1:Merge remote-tracking branch 'remotes/stefanha/tags/net-pull-request' into staging

  This net pull request contains security fixes for qemu.git/master.  The patches
  should also be applied to stable trees.

  The ne2000 NIC model has QEMU memory corruption issue.  Both ne2000 and e1000
  have an infinite loop.

  Please see the patches for CVE numbers and details on the bugs.

  # gpg: Signature made Tue 15 Sep 2015 13:02:21 BST using RSA key ID 81AB73C8
  # gpg: Good signature from "Stefan Hajnoczi <stefanha@redhat.com>"
  # gpg:                 aka "Stefan Hajnoczi <stefanha@gmail.com>"

  * remotes/stefanha/tags/net-pull-request:
    net: avoid infinite loop when receiving packets(CVE-2015-5278)
    net: add checks to validate ring buffer pointers(CVE-2015-5279)
    e1000: Avoid infinite loop in processing transmit descriptor (CVE-2015-6815)

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  b947ac2bf26479e710489739c465c8af336599e7:e1000: Avoid infinite loop in processing transmit descriptor (CVE-2015-6815)

  While processing transmit descriptors, it could lead to an infinite
  loop if 'bytes' was to become zero; Add a check to avoid it.

  [The guest can force 'bytes' to 0 by setting the hdr_len and mss
  descriptor fields to 0.
  --Stefan]

  Signed-off-by: P J P <pjp@fedoraproject.org>
  Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
  Reviewed-by: Thomas Huth <thuth@redhat.com>
  Message-id: 1441383666-6590-1-git-send-email-stefanha@redhat.com
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b947ac2bf26479e710489739c465c8af336599e7
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b76a0d5db25ad9f81346930230092fdf1e88a5a1
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 3a56af1fbc17ff453f6e90fb08ce0c0e6fd0b61b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
