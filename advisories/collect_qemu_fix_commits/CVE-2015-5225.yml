advisory_id: CVE-2015-5225
datasource_id: collect_qemu_fix_commits/CVE-2015-5225
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  efec4dcd2552e85ed57f276b58f09fc385727450:vnc: fix memory corruption (CVE-2015-5225)

  The _cmp_bytes variable added by commit "bea60dd ui/vnc: fix potential
  memory corruption issues" can become negative.  Result is (possibly
  exploitable) memory corruption.  Reason for that is it uses the stride
  instead of bytes per scanline to apply limits.

  For the server surface is is actually fine.  vnc creates that itself,
  there is never any padding and thus scanline length always equals stride.

  For the guest surface scanline length and stride are typically identical
  too, but it doesn't has to be that way.  So add and use a new variable
  (guest_ll) for the guest scanline length.  Also rename min_stride to
  line_bytes to make more clear what it actually is.  Finally sprinkle
  in an assert() to make sure we never use a negative _cmp_bytes again.

  Reported-by: 范祚至(库特) <zuozhi.fzz@alibaba-inc.com>
  Reviewed-by: P J P <ppandit@redhat.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  (cherry picked from commit eb8934b0418b3b1d125edddc4fc334a54334a49b)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  47c9dfee808f9455d732aea7c4390ad0972bbd84:Merge remote-tracking branch 'remotes/kraxel/tags/pull-cve-2015-5225-20150826-1' into staging

  vnc: fix memory corruption (CVE-2015-5225)

  # gpg: Signature made Wed 26 Aug 2015 17:37:21 BST using RSA key ID D3E87138
  # gpg: Good signature from "Gerd Hoffmann (work) <kraxel@redhat.com>"
  # gpg:                 aka "Gerd Hoffmann <gerd@kraxel.org>"
  # gpg:                 aka "Gerd Hoffmann (private) <kraxel@gmail.com>"

  * remotes/kraxel/tags/pull-cve-2015-5225-20150826-1:
    vnc: fix memory corruption (CVE-2015-5225)

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  47c9dfee808f9455d732aea7c4390ad0972bbd84:Merge remote-tracking branch 'remotes/kraxel/tags/pull-cve-2015-5225-20150826-1' into staging

  vnc: fix memory corruption (CVE-2015-5225)

  # gpg: Signature made Wed 26 Aug 2015 17:37:21 BST using RSA key ID D3E87138
  # gpg: Good signature from "Gerd Hoffmann (work) <kraxel@redhat.com>"
  # gpg:                 aka "Gerd Hoffmann <gerd@kraxel.org>"
  # gpg:                 aka "Gerd Hoffmann (private) <kraxel@gmail.com>"

  * remotes/kraxel/tags/pull-cve-2015-5225-20150826-1:
    vnc: fix memory corruption (CVE-2015-5225)

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  eb8934b0418b3b1d125edddc4fc334a54334a49b:vnc: fix memory corruption (CVE-2015-5225)

  The _cmp_bytes variable added by commit "bea60dd ui/vnc: fix potential
  memory corruption issues" can become negative.  Result is (possibly
  exploitable) memory corruption.  Reason for that is it uses the stride
  instead of bytes per scanline to apply limits.

  For the server surface is is actually fine.  vnc creates that itself,
  there is never any padding and thus scanline length always equals stride.

  For the guest surface scanline length and stride are typically identical
  too, but it doesn't has to be that way.  So add and use a new variable
  (guest_ll) for the guest scanline length.  Also rename min_stride to
  line_bytes to make more clear what it actually is.  Finally sprinkle
  in an assert() to make sure we never use a negative _cmp_bytes again.

  Reported-by: 范祚至(库特) <zuozhi.fzz@alibaba-inc.com>
  Reviewed-by: P J P <ppandit@redhat.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: efec4dcd2552e85ed57f276b58f09fc385727450
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: eb8934b0418b3b1d125edddc4fc334a54334a49b
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 47c9dfee808f9455d732aea7c4390ad0972bbd84
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
