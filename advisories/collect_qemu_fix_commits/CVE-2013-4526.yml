advisory_id: CVE-2013-4526
datasource_id: collect_qemu_fix_commits/CVE-2013-4526
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  d4c90959004633c16279f06afba43f3a330108ba:ahci: fix buffer overrun on invalid state load

  CVE-2013-4526

  Within hw/ide/ahci.c, VARRAY refers to ports which is also loaded.  So
  we use the old version of ports to read the array but then allow any
  value for ports.  This can cause the code to overflow.

  There's no reason to migrate ports - it never changes.
  So just make sure it matches.

  Reported-by: Anthony Liguori <anthony@codemonkey.ws>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Peter Maydell <peter.maydell@linaro.org>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit ae2158ad6ce0845b2fae2a22aa7f19c0d7a71ce5)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  d34e6f796097bd46d1bf8b26916df757d54aba03:ahci: fix buffer overrun on invalid state load

  CVE-2013-4526

  Within hw/ide/ahci.c, VARRAY refers to ports which is also loaded.  So
  we use the old version of ports to read the array but then allow any
  value for ports.  This can cause the code to overflow.

  There's no reason to migrate ports - it never changes.
  So just make sure it matches.

  Reported-by: Anthony Liguori <anthony@codemonkey.ws>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Peter Maydell <peter.maydell@linaro.org>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit ae2158ad6ce0845b2fae2a22aa7f19c0d7a71ce5)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  ae2158ad6ce0845b2fae2a22aa7f19c0d7a71ce5:ahci: fix buffer overrun on invalid state load

  CVE-2013-4526

  Within hw/ide/ahci.c, VARRAY refers to ports which is also loaded.  So
  we use the old version of ports to read the array but then allow any
  value for ports.  This can cause the code to overflow.

  There's no reason to migrate ports - it never changes.
  So just make sure it matches.

  Reported-by: Anthony Liguori <anthony@codemonkey.ws>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Peter Maydell <peter.maydell@linaro.org>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: ae2158ad6ce0845b2fae2a22aa7f19c0d7a71ce5
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d4c90959004633c16279f06afba43f3a330108ba
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d34e6f796097bd46d1bf8b26916df757d54aba03
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
