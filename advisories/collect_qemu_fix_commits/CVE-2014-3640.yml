advisory_id: CVE-2014-3640
datasource_id: collect_qemu_fix_commits/CVE-2014-3640
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  9a72433843d912a45046959b1953861211d1838d:slirp: udp: fix NULL pointer dereference because of uninitialized socket

  When guest sends udp packet with source port and source addr 0,
  uninitialized socket is picked up when looking for matching and already
  created udp sockets, and later passed to sosendto() where NULL pointer
  dereference is hit during so->slirp->vnetwork_mask.s_addr access.

  Fix this by checking that the socket is not just a socket stub.

  This is CVE-2014-3640.

  Signed-off-by: Petr Matousek <pmatouse@redhat.com>
  Reported-by: Xavier Mehrenberger <xavier.mehrenberger@airbus.com>
  Reported-by: Stephane Duverger <stephane.duverger@eads.net>
  Reviewed-by: Jan Kiszka <jan.kiszka@siemens.com>
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Michael Tokarev <mjt@tls.msk.ru>
  Message-id: 20140918063537.GX9321@dhcp-25-225.brq.redhat.com
  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  (cherry picked from commit 01f7cecf0037997cb0e58ec0d56bf9b5a6f7cb2a)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  01f7cecf0037997cb0e58ec0d56bf9b5a6f7cb2a:slirp: udp: fix NULL pointer dereference because of uninitialized socket

  When guest sends udp packet with source port and source addr 0,
  uninitialized socket is picked up when looking for matching and already
  created udp sockets, and later passed to sosendto() where NULL pointer
  dereference is hit during so->slirp->vnetwork_mask.s_addr access.

  Fix this by checking that the socket is not just a socket stub.

  This is CVE-2014-3640.

  Signed-off-by: Petr Matousek <pmatouse@redhat.com>
  Reported-by: Xavier Mehrenberger <xavier.mehrenberger@airbus.com>
  Reported-by: Stephane Duverger <stephane.duverger@eads.net>
  Reviewed-by: Jan Kiszka <jan.kiszka@siemens.com>
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Michael Tokarev <mjt@tls.msk.ru>
  Message-id: 20140918063537.GX9321@dhcp-25-225.brq.redhat.com
  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 01f7cecf0037997cb0e58ec0d56bf9b5a6f7cb2a
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 9a72433843d912a45046959b1953861211d1838d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
