advisory_id: CVE-2014-7815
datasource_id: collect_qemu_fix_commits/CVE-2014-7815
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  b2f1d90530301d7915dddc8a750063757675b21a:vnc: sanitize bits_per_pixel from the client

  bits_per_pixel that are less than 8 could result in accessing
  non-initialized buffers later in the code due to the expectation
  that bytes_per_pixel value that is used to initialize these buffers is
  never zero.

  To fix this check that bits_per_pixel from the client is one of the
  values that the rfb protocol specification allows.

  This is CVE-2014-7815.

  Signed-off-by: Petr Matousek <pmatouse@redhat.com>

  [ kraxel: apply codestyle fix ]

  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  (cherry picked from commit e6908bfe8e07f2b452e78e677da1b45b1c0f6829)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  fecd54ccd79c647d7161878c92eba9bf37a4279d:Merge remote-tracking branch 'remotes/kraxel/tags/pull-vnc-20141028-1' into staging

  vnc: return directly if no vnc client connected
  vnc: sanitize bits_per_pixel from the client (CVE-2014-7815)

  # gpg: Signature made Tue 28 Oct 2014 10:52:31 GMT using RSA key ID D3E87138
  # gpg: Good signature from "Gerd Hoffmann (work) <kraxel@redhat.com>"
  # gpg:                 aka "Gerd Hoffmann <gerd@kraxel.org>"
  # gpg:                 aka "Gerd Hoffmann (private) <kraxel@gmail.com>"

  * remotes/kraxel/tags/pull-vnc-20141028-1:
    vnc: return directly if no vnc client connected
    vnc: sanitize bits_per_pixel from the client

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  e6908bfe8e07f2b452e78e677da1b45b1c0f6829:vnc: sanitize bits_per_pixel from the client

  bits_per_pixel that are less than 8 could result in accessing
  non-initialized buffers later in the code due to the expectation
  that bytes_per_pixel value that is used to initialize these buffers is
  never zero.

  To fix this check that bits_per_pixel from the client is one of the
  values that the rfb protocol specification allows.

  This is CVE-2014-7815.

  Signed-off-by: Petr Matousek <pmatouse@redhat.com>

  [ kraxel: apply codestyle fix ]

  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b2f1d90530301d7915dddc8a750063757675b21a
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: e6908bfe8e07f2b452e78e677da1b45b1c0f6829
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: fecd54ccd79c647d7161878c92eba9bf37a4279d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
