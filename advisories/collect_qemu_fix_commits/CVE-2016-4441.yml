advisory_id: CVE-2016-4441
datasource_id: collect_qemu_fix_commits/CVE-2016-4441
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  9b28a7fc883f570f7aef582721deb16fd743bee4:esp: check dma length before reading scsi command(CVE-2016-4441)

  The 53C9X Fast SCSI Controller(FSC) comes with an internal 16-byte
  FIFO buffer. It is used to handle command and data transfer.
  Routine get_cmd() uses DMA to read scsi commands into this buffer.
  Add check to validate DMA length against buffer size to avoid any
  overrun.

  Fixes CVE-2016-4441.

  Reported-by: Li Qiang <liqiang6-s@360.cn>
  Cc: qemu-stable@nongnu.org
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Message-Id: <1463654371-11169-3-git-send-email-ppandit@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  (cherry picked from commit 6c1fef6b59563cc415f21e03f81539ed4b33ad90)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  9b28a7fc883f570f7aef582721deb16fd743bee4:esp: check dma length before reading scsi command(CVE-2016-4441)

  The 53C9X Fast SCSI Controller(FSC) comes with an internal 16-byte
  FIFO buffer. It is used to handle command and data transfer.
  Routine get_cmd() uses DMA to read scsi commands into this buffer.
  Add check to validate DMA length against buffer size to avoid any
  overrun.

  Fixes CVE-2016-4441.

  Reported-by: Li Qiang <liqiang6-s@360.cn>
  Cc: qemu-stable@nongnu.org
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Message-Id: <1463654371-11169-3-git-send-email-ppandit@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  (cherry picked from commit 6c1fef6b59563cc415f21e03f81539ed4b33ad90)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  c9158547617584bb9d19db7fb139998fbef80133:Merge remote-tracking branch 'remotes/bonzini/tags/for-upstream' into staging

  * NMI cleanups (Bandan)
  * RAMBlock/Memory cleanups and fixes (Dominik, Gonglei, Fam, me)
  * first part of linuxboot support for fw_cfg DMA (Richard)
  * IOAPIC fix (Peter Xu)
  * iSCSI SG_IO fix (Vadim)
  * Various infrastructure bug fixes (Zhijian, Peter M., Stefan)
  * CVE fixes (Prasad)

  # gpg: Signature made Mon 23 May 2016 16:06:18 BST using RSA key ID 78C7AE83
  # gpg: Good signature from "Paolo Bonzini <bonzini@gnu.org>"
  # gpg:                 aka "Paolo Bonzini <pbonzini@redhat.com>"

  * remotes/bonzini/tags/for-upstream: (24 commits)
    cpus: call the core nmi injection function
    nmi: remove x86 specific nmi handling
    target-i386: add a generic x86 nmi handler
    coccinelle: add g_assert_cmp* to macro file
    iscsi: pass SCSI status back for SG_IO
    esp: check dma length before reading scsi command(CVE-2016-4441)
    esp: check command buffer length before write(CVE-2016-4439)
    scripts/signrom.py: Check for magic in option ROMs.
    scripts/signrom.py: Allow option ROM checksum script to write the size header.
    Remove config-devices.mak on 'make clean'
    cpus.c: Use pthread_sigmask() rather than sigprocmask()
    memory: remove unnecessary masking of MemoryRegion ram_addr
    memory: Drop FlatRange.romd_mode
    memory: Remove code for mr->may_overlap
    exec: adjust rcu_read_lock requirement
    memory: drop find_ram_block()
    vl: change runstate only if new state is different from current state
    ioapic: clear remote irr bit for edge-triggered interrupts
    ioapic: keep RO bits for IOAPIC entry
    target-i386: key sfence availability on CPUID_SSE, not CPUID_SSE2
    ...

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  6c1fef6b59563cc415f21e03f81539ed4b33ad90:esp: check dma length before reading scsi command(CVE-2016-4441)

  The 53C9X Fast SCSI Controller(FSC) comes with an internal 16-byte
  FIFO buffer. It is used to handle command and data transfer.
  Routine get_cmd() uses DMA to read scsi commands into this buffer.
  Add check to validate DMA length against buffer size to avoid any
  overrun.

  Fixes CVE-2016-4441.

  Reported-by: Li Qiang <liqiang6-s@360.cn>
  Cc: qemu-stable@nongnu.org
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Message-Id: <1463654371-11169-3-git-send-email-ppandit@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  6c1fef6b59563cc415f21e03f81539ed4b33ad90:esp: check dma length before reading scsi command(CVE-2016-4441)

  The 53C9X Fast SCSI Controller(FSC) comes with an internal 16-byte
  FIFO buffer. It is used to handle command and data transfer.
  Routine get_cmd() uses DMA to read scsi commands into this buffer.
  Add check to validate DMA length against buffer size to avoid any
  overrun.

  Fixes CVE-2016-4441.

  Reported-by: Li Qiang <liqiang6-s@360.cn>
  Cc: qemu-stable@nongnu.org
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Message-Id: <1463654371-11169-3-git-send-email-ppandit@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 9b28a7fc883f570f7aef582721deb16fd743bee4
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 6c1fef6b59563cc415f21e03f81539ed4b33ad90
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: c9158547617584bb9d19db7fb139998fbef80133
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
