advisory_id: CVE-2021-3582
datasource_id: collect_qemu_fix_commits/CVE-2021-3582
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  d25db58213557663140afb57bf3416b93a93a3e6:hw/rdma: Fix possible mremap overflow in the pvrdma device (CVE-2021-3582)

  Ensure mremap boundaries not trusting the guest kernel to
  pass the correct buffer length.

  Fixes: CVE-2021-3582
  Reported-by: VictorV (Kunlun Lab) <vv474172261@gmail.com>
  Tested-by: VictorV (Kunlun Lab) <vv474172261@gmail.com>
  Signed-off-by: Marcel Apfelbaum <marcel@redhat.com>
  Message-Id: <20210616110600.20889-1-marcel.apfelbaum@gmail.com>
  Reviewed-by: Yuval Shaia <yuval.shaia.ml@gmail.com>
  Tested-by: Yuval Shaia <yuval.shaia.ml@gmail.com>
  Reviewed-by: Prasad J Pandit <pjp@fedoraproject.org>
  Signed-off-by: Marcel Apfelbaum <marcel.apfelbaum@gmail.com>
  (cherry picked from commit 284f191b4abad213aed04cb0458e1600fd18d7c4)
  Signed-off-by: Michael Roth <michael.roth@amd.com>
  d25db58213557663140afb57bf3416b93a93a3e6:hw/rdma: Fix possible mremap overflow in the pvrdma device (CVE-2021-3582)

  Ensure mremap boundaries not trusting the guest kernel to
  pass the correct buffer length.

  Fixes: CVE-2021-3582
  Reported-by: VictorV (Kunlun Lab) <vv474172261@gmail.com>
  Tested-by: VictorV (Kunlun Lab) <vv474172261@gmail.com>
  Signed-off-by: Marcel Apfelbaum <marcel@redhat.com>
  Message-Id: <20210616110600.20889-1-marcel.apfelbaum@gmail.com>
  Reviewed-by: Yuval Shaia <yuval.shaia.ml@gmail.com>
  Tested-by: Yuval Shaia <yuval.shaia.ml@gmail.com>
  Reviewed-by: Prasad J Pandit <pjp@fedoraproject.org>
  Signed-off-by: Marcel Apfelbaum <marcel.apfelbaum@gmail.com>
  (cherry picked from commit 284f191b4abad213aed04cb0458e1600fd18d7c4)
  Signed-off-by: Michael Roth <michael.roth@amd.com>
  4fb2820854a796ab75ffb2ec896b67268281ecde:Merge remote-tracking branch 'remotes/marcel/tags/pvrdma-04-07-2021-v2' into staging

  PVRDMA queue

  Several CVE fixes for the PVRDMA device.

  # gpg: Signature made Sun 04 Jul 2021 20:56:05 BST
  # gpg:                using RSA key 36D4C0F0CF2FE46D
  # gpg: Good signature from "Marcel Apfelbaum <marcel.apfelbaum@zoho.com>" [marginal]
  # gpg:                 aka "Marcel Apfelbaum <marcel@redhat.com>" [marginal]
  # gpg:                 aka "Marcel Apfelbaum <marcel.apfelbaum@gmail.com>" [marginal]
  # gpg: WARNING: This key is not certified with sufficiently trusted signatures!
  # gpg:          It is not certain that the signature belongs to the owner.
  # Primary key fingerprint: B1C6 3A57 F92E 08F2 640F  31F5 36D4 C0F0 CF2F E46D

  * remotes/marcel/tags/pvrdma-04-07-2021-v2:
    pvrdma: Fix the ring init error flow (CVE-2021-3608)
    pvrdma: Ensure correct input on ring init (CVE-2021-3607)
    hw/rdma: Fix possible mremap overflow in the pvrdma device (CVE-2021-3582)

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  284f191b4abad213aed04cb0458e1600fd18d7c4:hw/rdma: Fix possible mremap overflow in the pvrdma device (CVE-2021-3582)

  Ensure mremap boundaries not trusting the guest kernel to
  pass the correct buffer length.

  Fixes: CVE-2021-3582
  Reported-by: VictorV (Kunlun Lab) <vv474172261@gmail.com>
  Tested-by: VictorV (Kunlun Lab) <vv474172261@gmail.com>
  Signed-off-by: Marcel Apfelbaum <marcel@redhat.com>
  Message-Id: <20210616110600.20889-1-marcel.apfelbaum@gmail.com>
  Reviewed-by: Yuval Shaia <yuval.shaia.ml@gmail.com>
  Tested-by: Yuval Shaia <yuval.shaia.ml@gmail.com>
  Reviewed-by: Prasad J Pandit <pjp@fedoraproject.org>
  Signed-off-by: Marcel Apfelbaum <marcel.apfelbaum@gmail.com>
  284f191b4abad213aed04cb0458e1600fd18d7c4:hw/rdma: Fix possible mremap overflow in the pvrdma device (CVE-2021-3582)

  Ensure mremap boundaries not trusting the guest kernel to
  pass the correct buffer length.

  Fixes: CVE-2021-3582
  Reported-by: VictorV (Kunlun Lab) <vv474172261@gmail.com>
  Tested-by: VictorV (Kunlun Lab) <vv474172261@gmail.com>
  Signed-off-by: Marcel Apfelbaum <marcel@redhat.com>
  Message-Id: <20210616110600.20889-1-marcel.apfelbaum@gmail.com>
  Reviewed-by: Yuval Shaia <yuval.shaia.ml@gmail.com>
  Tested-by: Yuval Shaia <yuval.shaia.ml@gmail.com>
  Reviewed-by: Prasad J Pandit <pjp@fedoraproject.org>
  Signed-off-by: Marcel Apfelbaum <marcel.apfelbaum@gmail.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 284f191b4abad213aed04cb0458e1600fd18d7c4
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d25db58213557663140afb57bf3416b93a93a3e6
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 4fb2820854a796ab75ffb2ec896b67268281ecde
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
