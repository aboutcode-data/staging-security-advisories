advisory_id: CVE-2022-26353
datasource_id: collect_qemu_fix_commits/CVE-2022-26353
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  abe300d9d894f7138e1af7c8e9c88c04bfe98b37:virtio-net: fix map leaking on error during receive

  Commit bedd7e93d0196 ("virtio-net: fix use after unmap/free for sg")
  tries to fix the use after free of the sg by caching the virtqueue
  elements in an array and unmap them at once after receiving the
  packets, But it forgot to unmap the cached elements on error which
  will lead to leaking of mapping and other unexpected results.

  Fixing this by detaching the cached elements on error. This addresses
  CVE-2022-26353.

  Reported-by: Victor Tom <vv474172261@gmail.com>
  Cc: qemu-stable@nongnu.org
  Fixes: CVE-2022-26353
  Fixes: bedd7e93d0196 ("virtio-net: fix use after unmap/free for sg")
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
  abe300d9d894f7138e1af7c8e9c88c04bfe98b37:virtio-net: fix map leaking on error during receive

  Commit bedd7e93d0196 ("virtio-net: fix use after unmap/free for sg")
  tries to fix the use after free of the sg by caching the virtqueue
  elements in an array and unmap them at once after receiving the
  packets, But it forgot to unmap the cached elements on error which
  will lead to leaking of mapping and other unexpected results.

  Fixing this by detaching the cached elements on error. This addresses
  CVE-2022-26353.

  Reported-by: Victor Tom <vv474172261@gmail.com>
  Cc: qemu-stable@nongnu.org
  Fixes: CVE-2022-26353
  Fixes: bedd7e93d0196 ("virtio-net: fix use after unmap/free for sg")
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Jason Wang <jasowang@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: abe300d9d894f7138e1af7c8e9c88c04bfe98b37
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
