advisory_id: CVE-2013-2007
datasource_id: collect_qemu_fix_commits/CVE-2013-2007
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: "60259539ee9f3b2e5c18fcae2938e7db9ff1e9c0:qga: set umask 0077 when daemonizing (CVE-2013-2007)\n\
  \nThe qemu guest agent creates a bunch of files with insecure permissions\nwhen started in\
  \ daemon mode. For example:\n\n  -rw-rw-rw- 1 root root /var/log/qemu-ga.log\n  -rw-rw-rw-\
  \ 1 root root /var/run/qga.state\n  -rw-rw-rw- 1 root root /var/log/qga-fsfreeze-hook.log\n\
  \nIn addition, at least all files created with the \"guest-file-open\" QMP\ncommand, and all\
  \ files created with shell output redirection (or\notherwise) by utilities invoked by the\
  \ fsfreeze hook script are affected.\n\nFor now mask all file mode bits for \"group\" and\
  \ \"others\" in\nbecome_daemon().\n\nTemporarily, for compatibility reasons, stick with the\
  \ 0666 file-mode in\ncase of files newly created by the \"guest-file-open\" QMP call. Do so\n\
  without changing the umask temporarily.\n\nSigned-off-by: Laszlo Ersek <lersek@redhat.com>\n\
  Signed-off-by: Anthony Liguori <aliguori@us.ibm.com>\n(cherry picked from commit c689b4f1bac352dcfd6ecb9a1d45337de0f1de67)\n\
  \nConflicts:\n\n\tqga/commands-posix.c\n\n*update includes to match stable\n\nSigned-off-by:\
  \ Michael Roth <mdroth@linux.vnet.ibm.com>\nc689b4f1bac352dcfd6ecb9a1d45337de0f1de67:qga:\
  \ set umask 0077 when daemonizing (CVE-2013-2007)\n\nThe qemu guest agent creates a bunch\
  \ of files with insecure permissions\nwhen started in daemon mode. For example:\n\n  -rw-rw-rw-\
  \ 1 root root /var/log/qemu-ga.log\n  -rw-rw-rw- 1 root root /var/run/qga.state\n  -rw-rw-rw-\
  \ 1 root root /var/log/qga-fsfreeze-hook.log\n\nIn addition, at least all files created with\
  \ the \"guest-file-open\" QMP\ncommand, and all files created with shell output redirection\
  \ (or\notherwise) by utilities invoked by the fsfreeze hook script are affected.\n\nFor now\
  \ mask all file mode bits for \"group\" and \"others\" in\nbecome_daemon().\n\nTemporarily,\
  \ for compatibility reasons, stick with the 0666 file-mode in\ncase of files newly created\
  \ by the \"guest-file-open\" QMP call. Do so\nwithout changing the umask temporarily.\n\n\
  Signed-off-by: Laszlo Ersek <lersek@redhat.com>\nSigned-off-by: Anthony Liguori <aliguori@us.ibm.com>"
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: c689b4f1bac352dcfd6ecb9a1d45337de0f1de67
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 60259539ee9f3b2e5c18fcae2938e7db9ff1e9c0
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
