advisory_id: CVE-2014-0223
datasource_id: collect_qemu_fix_commits/CVE-2014-0223
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  a4b73ed3f37df05f1fd13418f18feb026008301c:qcow1: Validate image size (CVE-2014-0223)

  A huge image size could cause s->l1_size to overflow. Make sure that
  images never require a L1 table larger than what fits in s->l1_size.

  This cannot only cause unbounded allocations, but also the allocation of
  a too small L1 table, resulting in out-of-bounds array accesses (both
  reads and writes).

  Cc: qemu-stable@nongnu.org
  Signed-off-by: Kevin Wolf <kwolf@redhat.com>
  (cherry picked from commit 46485de0cb357b57373e1ca895adedf1f3ed46ec)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  b53d8665a2665978d7f7da47d2fca13e9481b067:qcow1: Validate image size (CVE-2014-0223)

  A huge image size could cause s->l1_size to overflow. Make sure that
  images never require a L1 table larger than what fits in s->l1_size.

  This cannot only cause unbounded allocations, but also the allocation of
  a too small L1 table, resulting in out-of-bounds array accesses (both
  reads and writes).

  Cc: qemu-stable@nongnu.org
  Signed-off-by: Kevin Wolf <kwolf@redhat.com>
  (cherry picked from commit 46485de0cb357b57373e1ca895adedf1f3ed46ec)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  ca8c0fab9504f000216308cafc833eb957fe9284:Merge remote-tracking branch 'remotes/kevin/tags/for-upstream' into staging

  Block patches

  # gpg: Signature made Mon 19 May 2014 15:21:14 BST using RSA key ID C88F2FD6
  # gpg: Good signature from "Kevin Wolf <kwolf@redhat.com>"

  * remotes/kevin/tags/for-upstream: (22 commits)
    block: optimize zero writes with bdrv_write_zeroes
    blockdev: add a function to parse enum ids from strings
    util: add qemu_iovec_is_zero
    qcow1: Stricter backing file length check
    qcow1: Validate image size (CVE-2014-0223)
    qcow1: Validate L2 table size (CVE-2014-0222)
    qcow1: Check maximum cluster size
    qcow1: Make padding in the header explicit
    curl: Add usage documentation
    curl: Add sslverify option
    curl: Remove broken parsing of options from url
    curl: Fix build when curl_multi_socket_action isn't available
    qemu-iotests: Fix blkdebug in VM drive in 030
    qemu-iotests: Fix core dump suppression in test 039
    iotests: Add test for the JSON protocol
    block: Allow JSON filenames
    check-qdict: Add test for qdict_join()
    qdict: Add qdict_join()
    block: add test for vhdx image created by Disk2VHD
    block: vhdx - account for identical header sections
    ...

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  46485de0cb357b57373e1ca895adedf1f3ed46ec:qcow1: Validate image size (CVE-2014-0223)

  A huge image size could cause s->l1_size to overflow. Make sure that
  images never require a L1 table larger than what fits in s->l1_size.

  This cannot only cause unbounded allocations, but also the allocation of
  a too small L1 table, resulting in out-of-bounds array accesses (both
  reads and writes).

  Cc: qemu-stable@nongnu.org
  Signed-off-by: Kevin Wolf <kwolf@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 46485de0cb357b57373e1ca895adedf1f3ed46ec
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: a4b73ed3f37df05f1fd13418f18feb026008301c
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b53d8665a2665978d7f7da47d2fca13e9481b067
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: ca8c0fab9504f000216308cafc833eb957fe9284
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
