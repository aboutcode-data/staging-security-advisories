advisory_id: CVE-2017-5898
datasource_id: collect_qemu_fix_commits/CVE-2017-5898
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  31fb4444a485a348f8e2699d7c3dd15e1819ad2c:usb-ccid: add check message size checks

  Check message size too when figuring whenever we should expect more data.
  Fix debug message to show useful data, p->iov.size is fixed anyway if we
  land there, print how much we got meanwhile instead.

  Also check announced message size against actual message size.  That
  is a more general fix for CVE-2017-5898 than commit "c7dfbf3 usb: ccid:
  check ccid apdu length".

  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  Reviewed-by: Marc-Andr√© Lureau <marcandre.lureau@redhat.com>
  Message-id: 1487250819-23764-4-git-send-email-kraxel@redhat.com
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 31fb4444a485a348f8e2699d7c3dd15e1819ad2c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
