advisory_id: CVE-2022-3165
datasource_id: collect_qemu_fix_commits/CVE-2022-3165
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  d307040b18bfcb1393b910f1bae753d5c12a4dc7:ui/vnc-clipboard: fix integer underflow in vnc_client_cut_text_ext

  Extended ClientCutText messages start with a 4-byte header. If len < 4,
  an integer underflow occurs in vnc_client_cut_text_ext. The result is
  used to decompress data in a while loop in inflate_buffer, leading to
  CPU consumption and denial of service. Prevent this by checking dlen in
  protocol_client_msg.

  Fixes: CVE-2022-3165
  Fixes: 0bf41cab93e5 ("ui/vnc: clipboard support")
  Reported-by: TangPeng <tangpeng@qianxin.com>
  Signed-off-by: Mauro Matteo Cascella <mcascell@redhat.com>
  Message-Id: <20220925204511.1103214-1-mcascell@redhat.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: d307040b18bfcb1393b910f1bae753d5c12a4dc7
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
