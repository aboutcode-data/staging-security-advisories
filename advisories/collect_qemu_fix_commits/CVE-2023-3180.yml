advisory_id: CVE-2023-3180
datasource_id: collect_qemu_fix_commits/CVE-2023-3180
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  49f1e02bac166821c712534aaa775f50e1afe17f:virtio-crypto: verify src&dst buffer length for sym request

  For symmetric algorithms, the length of ciphertext must be as same
  as the plaintext.
  The missing verification of the src_len and the dst_len in
  virtio_crypto_sym_op_helper() may lead buffer overflow/divulged.

  This patch is originally written by Yiming Tao for QEMU-SECURITY,
  resend it(a few changes of error message) in qemu-devel.

  Fixes: CVE-2023-3180
  Fixes: 04b9b37edda("virtio-crypto: add data queue processing handler")
  Cc: Gonglei <arei.gonglei@huawei.com>
  Cc: Mauro Matteo Cascella <mcascell@redhat.com>
  Cc: Yiming Tao <taoym@zju.edu.cn>
  Signed-off-by: zhenwei pi <pizhenwei@bytedance.com>
  Message-Id: <20230803024314.29962-2-pizhenwei@bytedance.com>
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  (cherry picked from commit 9d38a8434721a6479fe03fb5afb150ca793d3980)
  Signed-off-by: Michael Tokarev <mjt@tls.msk.ru>
  35a60ba42ca2dfcd9600a9467650d440257f7986:virtio-crypto: verify src&dst buffer length for sym request

  For symmetric algorithms, the length of ciphertext must be as same
  as the plaintext.
  The missing verification of the src_len and the dst_len in
  virtio_crypto_sym_op_helper() may lead buffer overflow/divulged.

  This patch is originally written by Yiming Tao for QEMU-SECURITY,
  resend it(a few changes of error message) in qemu-devel.

  Fixes: CVE-2023-3180
  Fixes: 04b9b37edda("virtio-crypto: add data queue processing handler")
  Cc: Gonglei <arei.gonglei@huawei.com>
  Cc: Mauro Matteo Cascella <mcascell@redhat.com>
  Cc: Yiming Tao <taoym@zju.edu.cn>
  Signed-off-by: zhenwei pi <pizhenwei@bytedance.com>
  Message-Id: <20230803024314.29962-2-pizhenwei@bytedance.com>
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  (cherry picked from commit 9d38a8434721a6479fe03fb5afb150ca793d3980)
  Signed-off-by: Michael Tokarev <mjt@tls.msk.ru>
  9d38a8434721a6479fe03fb5afb150ca793d3980:virtio-crypto: verify src&dst buffer length for sym request

  For symmetric algorithms, the length of ciphertext must be as same
  as the plaintext.
  The missing verification of the src_len and the dst_len in
  virtio_crypto_sym_op_helper() may lead buffer overflow/divulged.

  This patch is originally written by Yiming Tao for QEMU-SECURITY,
  resend it(a few changes of error message) in qemu-devel.

  Fixes: CVE-2023-3180
  Fixes: 04b9b37edda("virtio-crypto: add data queue processing handler")
  Cc: Gonglei <arei.gonglei@huawei.com>
  Cc: Mauro Matteo Cascella <mcascell@redhat.com>
  Cc: Yiming Tao <taoym@zju.edu.cn>
  Signed-off-by: zhenwei pi <pizhenwei@bytedance.com>
  Message-Id: <20230803024314.29962-2-pizhenwei@bytedance.com>
  Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 35a60ba42ca2dfcd9600a9467650d440257f7986
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 9d38a8434721a6479fe03fb5afb150ca793d3980
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 49f1e02bac166821c712534aaa775f50e1afe17f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
