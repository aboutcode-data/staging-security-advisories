advisory_id: CVE-2014-7840
datasource_id: collect_qemu_fix_commits/CVE-2014-7840
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  ea5b201a0acfb4c3029afd4e7999b4278e1351d4:Merge remote-tracking branch 'remotes/amit-migration/tags/for-2.2' into staging

  Fix for CVE-2014-7840, avoiding arbitrary qemu memory overwrite for
  migration by Michael S. Tsirkin.

  # gpg: Signature made Tue 18 Nov 2014 11:23:00 GMT using RSA key ID 854083B6
  # gpg: Good signature from "Amit Shah <amit@amitshah.net>"
  # gpg:                 aka "Amit Shah <amit@kernel.org>"
  # gpg:                 aka "Amit Shah <amitshah@gmx.net>"

  * remotes/amit-migration/tags/for-2.2:
    migration: fix parameter validation on ram load

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  0be839a2701369f669532ea5884c15bead1c6e08:migration: fix parameter validation on ram load

  During migration, the values read from migration stream during ram load
  are not validated. Especially offset in host_from_stream_offset() and
  also the length of the writes in the callers of said function.

  To fix this, we need to make sure that the [offset, offset + length]
  range fits into one of the allocated memory regions.

  Validating addr < len should be sufficient since data seems to always be
  managed in TARGET_PAGE_SIZE chunks.

  Fixes: CVE-2014-7840

  Note: follow-up patches add extra checks on each block->host access.

  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Paolo Bonzini <pbonzini@redhat.com>
  Reviewed-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
  Signed-off-by: Amit Shah <amit.shah@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: ea5b201a0acfb4c3029afd4e7999b4278e1351d4
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 0be839a2701369f669532ea5884c15bead1c6e08
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
