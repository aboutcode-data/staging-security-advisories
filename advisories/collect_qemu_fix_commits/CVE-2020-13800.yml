advisory_id: CVE-2020-13800
datasource_id: collect_qemu_fix_commits/CVE-2020-13800
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  387a3ac89d5cc821c4064295122dc3183b6aca69:ati-vga: check mm_index before recursive call (CVE-2020-13800)

  While accessing VGA registers via ati_mm_read/write routines,
  a guest may set 's->regs.mm_index' such that it leads to infinite
  recursion. Check mm_index value to avoid such recursion. Log an
  error message for wrong values.

  Reported-by: Ren Ding <rding@gatech.edu>
  Reported-by: Hanqing Zhao <hanqing@gatech.edu>
  Reported-by: Yi Ren <c4tren@gmail.com>
  Message-id: 20200604090830.33885-1-ppandit@redhat.com
  Suggested-by: BALATON Zoltan <balaton@eik.bme.hu>
  Suggested-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  (cherry picked from commit a98610c429d52db0937c1e48659428929835c455)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  69a6048e1ef24a65da45a0c6802ace95066f0f37:ati-vga: check mm_index before recursive call (CVE-2020-13800)

  While accessing VGA registers via ati_mm_read/write routines,
  a guest may set 's->regs.mm_index' such that it leads to infinite
  recursion. Check mm_index value to avoid such recursion. Log an
  error message for wrong values.

  Reported-by: Ren Ding <rding@gatech.edu>
  Reported-by: Hanqing Zhao <hanqing@gatech.edu>
  Reported-by: Yi Ren <c4tren@gmail.com>
  Message-id: 20200604090830.33885-1-ppandit@redhat.com
  Suggested-by: BALATON Zoltan <balaton@eik.bme.hu>
  Suggested-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  (cherry picked from commit a98610c429d52db0937c1e48659428929835c455)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  5d2f557b47dfbf8f23277a5bdd8473d4607c681a:Merge remote-tracking branch 'remotes/kraxel/tags/vga-20200605-pull-request' into staging

  vga: ati security fix, cirrus cleanup.

  # gpg: Signature made Fri 05 Jun 2020 12:27:13 BST
  # gpg:                using RSA key 4CB6D8EED3E87138
  # gpg: Good signature from "Gerd Hoffmann (work) <kraxel@redhat.com>" [full]
  # gpg:                 aka "Gerd Hoffmann <gerd@kraxel.org>" [full]
  # gpg:                 aka "Gerd Hoffmann (private) <kraxel@gmail.com>" [full]
  # Primary key fingerprint: A032 8CFF B93A 17A7 9901  FE7D 4CB6 D8EE D3E8 7138

  * remotes/kraxel/tags/vga-20200605-pull-request:
    hw/display/cirrus_vga: Fix code mis-indentation
    ati-vga: check mm_index before recursive call (CVE-2020-13800)

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  a98610c429d52db0937c1e48659428929835c455:ati-vga: check mm_index before recursive call (CVE-2020-13800)

  While accessing VGA registers via ati_mm_read/write routines,
  a guest may set 's->regs.mm_index' such that it leads to infinite
  recursion. Check mm_index value to avoid such recursion. Log an
  error message for wrong values.

  Reported-by: Ren Ding <rding@gatech.edu>
  Reported-by: Hanqing Zhao <hanqing@gatech.edu>
  Reported-by: Yi Ren <c4tren@gmail.com>
  Message-id: 20200604090830.33885-1-ppandit@redhat.com
  Suggested-by: BALATON Zoltan <balaton@eik.bme.hu>
  Suggested-by: Philippe Mathieu-Daudé <philmd@redhat.com>
  Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: a98610c429d52db0937c1e48659428929835c455
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 387a3ac89d5cc821c4064295122dc3183b6aca69
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 69a6048e1ef24a65da45a0c6802ace95066f0f37
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 5d2f557b47dfbf8f23277a5bdd8473d4607c681a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
