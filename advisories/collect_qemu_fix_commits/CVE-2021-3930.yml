advisory_id: CVE-2021-3930
datasource_id: collect_qemu_fix_commits/CVE-2021-3930
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  c2c7f108b8228091d7ad4bd488c3abb9adc632e7:hw/scsi/scsi-disk: MODE_PAGE_ALLS not allowed in MODE SELECT commands

  This avoids an off-by-one read of 'mode_sense_valid' buffer in
  hw/scsi/scsi-disk.c:mode_sense_page().

  Fixes: CVE-2021-3930
  Cc: qemu-stable@nongnu.org
  Reported-by: Alexander Bulekov <alxndr@bu.edu>
  Fixes: a8f4bbe2900 ("scsi-disk: store valid mode pages in a table")
  Fixes: #546
  Reported-by: Qiuhao Li <Qiuhao.Li@outlook.com>
  Signed-off-by: Mauro Matteo Cascella <mcascell@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
  (cherry picked from commit b3af7fdf9cc537f8f0dd3e2423d83f5c99a457e8)
  Signed-off-by: Michael Roth <michael.roth@amd.com>
  b3af7fdf9cc537f8f0dd3e2423d83f5c99a457e8:hw/scsi/scsi-disk: MODE_PAGE_ALLS not allowed in MODE SELECT commands

  This avoids an off-by-one read of 'mode_sense_valid' buffer in
  hw/scsi/scsi-disk.c:mode_sense_page().

  Fixes: CVE-2021-3930
  Cc: qemu-stable@nongnu.org
  Reported-by: Alexander Bulekov <alxndr@bu.edu>
  Fixes: a8f4bbe2900 ("scsi-disk: store valid mode pages in a table")
  Fixes: #546
  Reported-by: Qiuhao Li <Qiuhao.Li@outlook.com>
  Signed-off-by: Mauro Matteo Cascella <mcascell@redhat.com>
  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: c2c7f108b8228091d7ad4bd488c3abb9adc632e7
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: b3af7fdf9cc537f8f0dd3e2423d83f5c99a457e8
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
