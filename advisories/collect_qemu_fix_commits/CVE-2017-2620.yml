advisory_id: CVE-2017-2620
datasource_id: collect_qemu_fix_commits/CVE-2017-2620
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  fc8e94c3e5e74437c4e73a5582f17cfd4cae5ccf:cirrus: add blit_is_unsafe call to cirrus_bitblt_cputovideo (CVE-2017-2620)

  CIRRUS_BLTMODE_MEMSYSSRC blits do NOT check blit destination
  and blit width, at all.  Oops.  Fix it.

  Security impact: high.

  The missing blit destination check allows to write to host memory.
  Basically same as CVE-2014-8106 for the other blit variants.

  Cc: qemu-stable@nongnu.org
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  (cherry picked from commit 92f2b88cea48c6aeba8de568a45f2ed958f3c298)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  63f495beb4007de5444614125fd6fd178ca6e2b1:Merge remote-tracking branch 'remotes/kraxel/tags/pull-cve-2017-2620-20170224-1' into staging

  cirrus: add blit_is_unsafe call to cirrus_bitblt_cputovideo (CVE-2017-2620)

  # gpg: Signature made Fri 24 Feb 2017 13:42:39 GMT
  # gpg:                using RSA key 0x4CB6D8EED3E87138
  # gpg: Good signature from "Gerd Hoffmann (work) <kraxel@redhat.com>"
  # gpg:                 aka "Gerd Hoffmann <gerd@kraxel.org>"
  # gpg:                 aka "Gerd Hoffmann (private) <kraxel@gmail.com>"
  # Primary key fingerprint: A032 8CFF B93A 17A7 9901  FE7D 4CB6 D8EE D3E8 7138

  * remotes/kraxel/tags/pull-cve-2017-2620-20170224-1:
    cirrus: add blit_is_unsafe call to cirrus_bitblt_cputovideo (CVE-2017-2620)

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  63f495beb4007de5444614125fd6fd178ca6e2b1:Merge remote-tracking branch 'remotes/kraxel/tags/pull-cve-2017-2620-20170224-1' into staging

  cirrus: add blit_is_unsafe call to cirrus_bitblt_cputovideo (CVE-2017-2620)

  # gpg: Signature made Fri 24 Feb 2017 13:42:39 GMT
  # gpg:                using RSA key 0x4CB6D8EED3E87138
  # gpg: Good signature from "Gerd Hoffmann (work) <kraxel@redhat.com>"
  # gpg:                 aka "Gerd Hoffmann <gerd@kraxel.org>"
  # gpg:                 aka "Gerd Hoffmann (private) <kraxel@gmail.com>"
  # Primary key fingerprint: A032 8CFF B93A 17A7 9901  FE7D 4CB6 D8EE D3E8 7138

  * remotes/kraxel/tags/pull-cve-2017-2620-20170224-1:
    cirrus: add blit_is_unsafe call to cirrus_bitblt_cputovideo (CVE-2017-2620)

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  92f2b88cea48c6aeba8de568a45f2ed958f3c298:cirrus: add blit_is_unsafe call to cirrus_bitblt_cputovideo (CVE-2017-2620)

  CIRRUS_BLTMODE_MEMSYSSRC blits do NOT check blit destination
  and blit width, at all.  Oops.  Fix it.

  Security impact: high.

  The missing blit destination check allows to write to host memory.
  Basically same as CVE-2014-8106 for the other blit variants.

  Cc: qemu-stable@nongnu.org
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 92f2b88cea48c6aeba8de568a45f2ed958f3c298
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: fc8e94c3e5e74437c4e73a5582f17cfd4cae5ccf
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 63f495beb4007de5444614125fd6fd178ca6e2b1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
