advisory_id: CVE-2021-4158
datasource_id: collect_qemu_fix_commits/CVE-2021-4158
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  9bd6565ccee68f72d5012e24646e12a1c662827e:acpi: validate hotplug selector on access

  When bus is looked up on a pci write, we didn't
  validate that the lookup succeeded.
  Fuzzers thus can trigger QEMU crash by dereferencing the NULL
  bus pointer.

  Fixes: b32bd763a1 ("pci: introduce acpi-index property for PCI device")
  Fixes: CVE-2021-4158
  Cc: "Igor Mammedov" <imammedo@redhat.com>
  Fixes: https://gitlab.com/qemu-project/qemu/-/issues/770
  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Philippe Mathieu-Daud√© <philmd@redhat.com>
  Reviewed-by: Ani Sinha <ani@anisinha.ca>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 9bd6565ccee68f72d5012e24646e12a1c662827e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
