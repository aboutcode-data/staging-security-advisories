advisory_id: CVE-2013-4151
datasource_id: collect_qemu_fix_commits/CVE-2013-4151
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  48935f029f5ae7f6bd6f01b2c942a7f2f1a7bc9a:virtio: out-of-bounds buffer write on invalid state load

  CVE-2013-4151 QEMU 1.0 out-of-bounds buffer write in
  virtio_load@hw/virtio/virtio.c

  So we have this code since way back when:

      num = qemu_get_be32(f);

      for (i = 0; i < num; i++) {
          vdev->vq[i].vring.num = qemu_get_be32(f);

  array of vqs has size VIRTIO_PCI_QUEUE_MAX, so
  on invalid input this will write beyond end of buffer.

  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit cc45995294b92d95319b4782750a3580cabdbc0c)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  5544b7e419fd47f6ad4552d30189e3a922acdfb1:virtio: out-of-bounds buffer write on invalid state load

  CVE-2013-4151 QEMU 1.0 out-of-bounds buffer write in
  virtio_load@hw/virtio/virtio.c

  So we have this code since way back when:

      num = qemu_get_be32(f);

      for (i = 0; i < num; i++) {
          vdev->vq[i].vring.num = qemu_get_be32(f);

  array of vqs has size VIRTIO_PCI_QUEUE_MAX, so
  on invalid input this will write beyond end of buffer.

  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
  (cherry picked from commit cc45995294b92d95319b4782750a3580cabdbc0c)
  Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  cc45995294b92d95319b4782750a3580cabdbc0c:virtio: out-of-bounds buffer write on invalid state load

  CVE-2013-4151 QEMU 1.0 out-of-bounds buffer write in
  virtio_load@hw/virtio/virtio.c

  So we have this code since way back when:

      num = qemu_get_be32(f);

      for (i = 0; i < num; i++) {
          vdev->vq[i].vring.num = qemu_get_be32(f);

  array of vqs has size VIRTIO_PCI_QUEUE_MAX, so
  on invalid input this will write beyond end of buffer.

  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
  Reviewed-by: Michael Roth <mdroth@linux.vnet.ibm.com>
  Signed-off-by: Juan Quintela <quintela@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 5544b7e419fd47f6ad4552d30189e3a922acdfb1
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: cc45995294b92d95319b4782750a3580cabdbc0c
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 48935f029f5ae7f6bd6f01b2c942a7f2f1a7bc9a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
