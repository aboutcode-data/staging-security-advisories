advisory_id: CVE-2021-4207
datasource_id: collect_qemu_fix_commits/CVE-2021-4207
datasource_url: https://gitlab.com/qemu-project/qemu
aliases: []
summary: |
  dde8689d1fe82e295a278ba4bf1abd9be5c7bcab:Merge tag 'fixes-20220408-pull-request' of git://git.kraxel.org/qemu into staging

  two cursor/qxl related security fixes.

  # gpg: Signature made Fri 08 Apr 2022 05:37:16 BST
  # gpg:                using RSA key A0328CFFB93A17A79901FE7D4CB6D8EED3E87138
  # gpg: Good signature from "Gerd Hoffmann (work) <kraxel@redhat.com>" [full]
  # gpg:                 aka "Gerd Hoffmann <gerd@kraxel.org>" [full]
  # gpg:                 aka "Gerd Hoffmann (private) <kraxel@gmail.com>" [full]
  # Primary key fingerprint: A032 8CFF B93A 17A7 9901  FE7D 4CB6 D8EE D3E8 7138

  * tag 'fixes-20220408-pull-request' of git://git.kraxel.org/qemu:
    ui/cursor: fix integer overflow in cursor_alloc (CVE-2021-4206)
    display/qxl-render: fix race condition in qxl_cursor (CVE-2021-4207)

  Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
  9569f5cb5b4bffa9d3ebc8ba7da1e03830a9a895:display/qxl-render: fix race condition in qxl_cursor (CVE-2021-4207)

  Avoid fetching 'width' and 'height' a second time to prevent possible
  race condition. Refer to security advisory
  https://starlabs.sg/advisories/22-4207/ for more information.

  Fixes: CVE-2021-4207
  Signed-off-by: Mauro Matteo Cascella <mcascell@redhat.com>
  Reviewed-by: Marc-André Lureau <marcandre.lureau@redhat.com>
  Message-Id: <20220407081106.343235-1-mcascell@redhat.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
  9569f5cb5b4bffa9d3ebc8ba7da1e03830a9a895:display/qxl-render: fix race condition in qxl_cursor (CVE-2021-4207)

  Avoid fetching 'width' and 'height' a second time to prevent possible
  race condition. Refer to security advisory
  https://starlabs.sg/advisories/22-4207/ for more information.

  Fixes: CVE-2021-4207
  Signed-off-by: Mauro Matteo Cascella <mcascell@redhat.com>
  Reviewed-by: Marc-André Lureau <marcandre.lureau@redhat.com>
  Message-Id: <20220407081106.343235-1-mcascell@redhat.com>
  Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
impacted_packages:
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: 9569f5cb5b4bffa9d3ebc8ba7da1e03830a9a895
    introduced_in_commits: []
  - purl: pkg:gitlab/qemu-project/qemu
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/qemu-project/qemu
        commit: dde8689d1fe82e295a278ba4bf1abd9be5c7bcab
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/qemu-project/qemu
    reference_type: commit
    reference_id: 91c6438caffc880e999a7312825479685d659b44
