advisory_id: CVE-2024-40913
datasource_id: vulnrichment_importer_v2/CVE-2024-40913
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/40xxx/CVE-2024-40913.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  cachefiles: defer exposing anon_fd until after copy_to_user() succeeds

  After installing the anonymous fd, we can now see it in userland and close
  it. However, at this point we may not have gotten the reference count of
  the cache, but we will put it during colse fd, so this may cause a cache
  UAF.

  So grab the cache reference count before fd_install(). In addition, by
  kernel convention, fd is taken over by the user land after fd_install(),
  and the kernel should not call close_fd() after that, i.e., it should call
  fd_install() after everything is ready, thus fd_install() is called after
  copy_to_user() succeeds.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:05:56Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/4b4391e77a6bf24cba2ef1590e113d9b73b11039
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d2d3eb377a5d081bf2bed177d354a4f59b74da88
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eac51d9daacd61dcc93333ff6a890cf3efc8c1c0
    reference_type:
    reference_id:
