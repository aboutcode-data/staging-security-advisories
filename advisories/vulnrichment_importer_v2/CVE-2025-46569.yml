advisory_id: CVE-2025-46569
datasource_id: vulnrichment_importer_v2/CVE-2025-46569
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/46xxx/CVE-2025-46569.json
aliases: []
summary: Open Policy Agent (OPA) is an open source, general-purpose policy engine. Prior to
  version 1.4.0, when run as a server, OPA exposes an HTTP Data API for reading and writing
  documents. Requesting a virtual document through the Data API entails policy evaluation, where
  a Rego query containing a single data document reference is constructed from the requested
  path. This query is then used for policy evaluation. A HTTP request path can be crafted in
  a way that injects Rego code into the constructed query. The evaluation result cannot be made
  to return any other data than what is generated by the requested path, but this path can be
  misdirected, and the injected Rego code can be crafted to make the query succeed or fail;
  opening up for oracle attacks or, given the right circumstances, erroneous policy decision
  results. Furthermore, the injected code can be crafted to be computationally expensive, resulting
  in a Denial Of Service (DoS) attack. This issue has been patched in version 1.4.0. A workaround
  involves having network access to OPAâ€™s RESTful APIs being limited to `localhost` and/or trusted
  networks, unless necessary for production reasons.
impacted_packages: []
severities:
  - score: '7.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:N/VA:H/SC:H/SI:H/SA:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-05-02T18:08:05Z/
    published_at: None
    url:
weaknesses:
  - CWE-863
  - CWE-94
references:
  - url: https://github.com/open-policy-agent/opa/commit/ad2063247a14711882f18c387a511fc8094aa79c
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/opa/security/advisories/GHSA-6m8w-jc87-6cr7
    reference_type:
    reference_id:
