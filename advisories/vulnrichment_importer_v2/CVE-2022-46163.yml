advisory_id: CVE-2022-46163
datasource_id: vulnrichment_importer_v2/CVE-2022-46163
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/46xxx/CVE-2022-46163.json
aliases: []
summary: 'Travel support program is a rails app to support the travel support program of openSUSE
  (TSP). Sensitive user data (bank account details, password Hash) can be extracted via Ransack
  query injection. Every deployment of travel-support-program below the patched version is affected.
  The travel-support-program uses the Ransack library to implement search functionality. In
  its default configuration, Ransack will allow for query conditions based on properties of
  associated database objects [1]. The `*_start`, `*_end` or `*_cont` search matchers [2] can
  then be abused to exfiltrate sensitive string values of associated database objects via character-by-character
  brute-force (A match is indicated by the returned JSON not being empty). A single bank account
  number can be extracted with <200 requests, a password hash can be extracted with ~1200 requests,
  all within a few minutes. The problem has been patched in commit d22916275c51500b4004933ff1b0a69bc807b2b7.
  In order to work around this issue, you can also cherry pick that patch, however it will not
  work without the Rails 5.0 migration that was done in #150, which in turn had quite a few
  pull requests it depended on.'
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-03-10T21:02:14Z/
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://github.com/openSUSE/travel-support-program/commit/d22916275c51500b4004933ff1b0a69bc807b2b7
    reference_type:
    reference_id:
  - url: https://github.com/openSUSE/travel-support-program/pull/158
    reference_type:
    reference_id:
  - url: https://github.com/openSUSE/travel-support-program/security/advisories/GHSA-2wwv-c6xh-cf68
    reference_type:
    reference_id:
