advisory_id: CVE-2023-52740
datasource_id: vulnrichment_importer_v2/CVE-2023-52740
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/52xxx/CVE-2023-52740.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  powerpc/64s/interrupt: Fix interrupt exit race with security mitigation switch

  The RFI and STF security mitigation options can flip the
  interrupt_exit_not_reentrant static branch condition concurrently with
  the interrupt exit code which tests that branch.

  Interrupt exit tests this condition to set MSR[EE|RI] for exit, then
  again in the case a soft-masked interrupt is found pending, to recover
  the MSR so the interrupt can be replayed before attempting to exit
  again. If the condition changes between these two tests, the MSR and irq
  soft-mask state will become corrupted, leading to warnings and possible
  crashes. For example, if the branch is initially true then false,
  MSR[EE] will be 0 but PACA_IRQ_HARD_DIS clear and EE may not get
  enabled, leading to warnings in irq_64.c.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-21T18:15:22Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2ea31e2e62bbc4d11c411eeb36f1b02841dbcab1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6f097c24815e67909a1fcc2c605586d02babd673
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/86f7e423933608d536015a0f2eb9e0338c1227e0
    reference_type:
    reference_id:
