advisory_id: CVE-2024-37021
datasource_id: vulnrichment_importer_v2/CVE-2024-37021
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/37xxx/CVE-2024-37021.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fpga: manager: add owner module and take its refcount

  The current implementation of the fpga manager assumes that the low-level
  module registers a driver for the parent device and uses its owner pointer
  to take the module's refcount. This approach is problematic since it can
  lead to a null pointer dereference while attempting to get the manager if
  the parent device does not have a driver.

  To address this problem, add a module owner pointer to the fpga_manager
  struct and use it to take the module's refcount. Modify the functions for
  registering the manager to take an additional owner module parameter and
  rename them to avoid conflicts. Use the old function names for helper
  macros that automatically set the module that registers the manager as the
  owner. This ensures compatibility with existing low-level control modules
  and reduces the chances of registering a manager without setting the owner.

  Also, update the documentation to keep it consistent with the new interface
  for registering an fpga manager.

  Other changes: opportunistically move put_device() from __fpga_mgr_get() to
  fpga_mgr_get() and of_fpga_mgr_get() to improve code clarity since the
  manager device is taken in these functions.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:08:30Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2da62a139a6221a345db4eb9f4f1c4b0937c89ad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/304f8032d601d4f9322ca841cd0b573bd1beb158
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4d4d2d4346857bf778fafaa97d6f76bb1663e3c9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/62ac496a01c9337a11362cea427038ba621ca9eb
    reference_type:
    reference_id:
