advisory_id: CVE-2024-45159
datasource_id: vulnrichment_importer_v2/CVE-2024-45159
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/45xxx/CVE-2024-45159.json
aliases: []
summary: An issue was discovered in Mbed TLS 3.x before 3.6.1. With TLS 1.3, when a server enables
  optional authentication of the client, if the client-provided certificate does not have appropriate
  values in if keyUsage or extKeyUsage extensions, then the return value of mbedtls_ssl_get_verify_result()
  would incorrectly have the MBEDTLS_X509_BADCERT_KEY_USAGE and MBEDTLS_X509_BADCERT_KEY_USAGE
  bits clear. As a result, an attacker that had a certificate valid for uses other than TLS
  client authentication would nonetheless be able to use it for TLS client authentication. Only
  TLS 1.3 servers were affected, and only with optional authentication (with required authentication,
  the handshake would be aborted with a fatal alert).
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-02-03T18:17:13Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/Mbed-TLS/mbedtls/releases/
    reference_type:
    reference_id:
  - url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/
    reference_type:
    reference_id:
  - url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-3/
    reference_type:
    reference_id:
