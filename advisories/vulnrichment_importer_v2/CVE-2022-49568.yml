advisory_id: CVE-2022-49568
datasource_id: vulnrichment_importer_v2/CVE-2022-49568
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/49xxx/CVE-2022-49568.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  KVM: Don't null dereference ops->destroy

  A KVM device cleanup happens in either of two callbacks:
  1) destroy() which is called when the VM is being destroyed;
  2) release() which is called when a device fd is closed.

  Most KVM devices use 1) but Book3s's interrupt controller KVM devices
  (XICS, XIVE, XIVE-native) use 2) as they need to close and reopen during
  the machine execution. The error handling in kvm_ioctl_create_device()
  assumes destroy() is always defined which leads to NULL dereference as
  discovered by Syzkaller.

  This adds a checks for destroy!=NULL and adds a missing release().

  This is not changing kvm_destroy_devices() as devices with defined
  release() should have been removed from the KVM devices list by then.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T19:36:56Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/170465715a60cbb7876e6b961b21bd3225469da8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3616776bc51cd3262bb1be60cc01c72e0a1959cf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d4a5a79b780891c5cbdfdc6124d46fdf8d13dba1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e8bc2427018826e02add7b0ed0fc625a60390ae5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e91665fbbf3ccb268b268a7d71a6513538d813ac
    reference_type:
    reference_id:
