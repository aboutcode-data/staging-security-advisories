advisory_id: CVE-2024-36952
datasource_id: vulnrichment_importer_v2/CVE-2024-36952
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/36xxx/CVE-2024-36952.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: lpfc: Move NPIV's transport unregistration to after resource clean up

  There are cases after NPIV deletion where the fabric switch still believes
  the NPIV is logged into the fabric.  This occurs when a vport is
  unregistered before the Remove All DA_ID CT and LOGO ELS are sent to the
  fabric.

  Currently fc_remove_host(), which calls dev_loss_tmo for all D_IDs including
  the fabric D_ID, removes the last ndlp reference and frees the ndlp rport
  object.  This sometimes causes the race condition where the final DA_ID and
  LOGO are skipped from being sent to the fabric switch.

  Fix by moving the fc_remove_host() and scsi_remove_host() calls after DA_ID
  and LOGO are sent.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-03T19:01:27Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0936809d968ecf81e0726fbd02ff2a5732d960c3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4ddf01f2f1504fa08b766e8cfeec558e9f8eef6c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/718602cd15f4c5710850090ea3066a89eeb46278
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/76337eb8daee32bcc67742efab3168ed4ca299d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f2c7f029051edc4b394bb48edbe2297575abefe0
    reference_type:
    reference_id:
