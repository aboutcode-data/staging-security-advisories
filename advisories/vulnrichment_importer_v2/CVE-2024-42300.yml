advisory_id: CVE-2024-42300
datasource_id: vulnrichment_importer_v2/CVE-2024-42300
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/42xxx/CVE-2024-42300.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  erofs: fix race in z_erofs_get_gbuf()

  In z_erofs_get_gbuf(), the current task may be migrated to another
  CPU between `z_erofs_gbuf_id()` and `spin_lock(&gbuf->lock)`.

  Therefore, z_erofs_put_gbuf() will trigger the following issue
  which was found by stress test:

  <2>[772156.434168] kernel BUG at fs/erofs/zutil.c:58!
  ..
  <4>[772156.435007]
  <4>[772156.439237] CPU: 0 PID: 3078 Comm: stress Kdump: loaded Tainted: G            E      6.10.0-rc7+ #2
  <4>[772156.439239] Hardware name: Alibaba Cloud Alibaba Cloud ECS, BIOS 1.0.0 01/01/2017
  <4>[772156.439241] pstate: 83400005 (Nzcv daif +PAN -UAO +TCO +DIT -SSBS BTYPE=--)
  <4>[772156.439243] pc : z_erofs_put_gbuf+0x64/0x70 [erofs]
  <4>[772156.439252] lr : z_erofs_lz4_decompress+0x600/0x6a0 [erofs]
  ..
  <6>[772156.445958] stress (3127): drop_caches: 1
  <4>[772156.446120] Call trace:
  <4>[772156.446121]  z_erofs_put_gbuf+0x64/0x70 [erofs]
  <4>[772156.446761]  z_erofs_lz4_decompress+0x600/0x6a0 [erofs]
  <4>[772156.446897]  z_erofs_decompress_queue+0x740/0xa10 [erofs]
  <4>[772156.447036]  z_erofs_runqueue+0x428/0x8c0 [erofs]
  <4>[772156.447160]  z_erofs_readahead+0x224/0x390 [erofs]
  ..
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:10:35Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/49b22e06a947727a6d1c802d2d9ad92420b90fc5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7dc5537c3f8be87e005f0844a7626c987914f8fd
    reference_type:
    reference_id:
