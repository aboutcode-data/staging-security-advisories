advisory_id: CVE-2024-52307
datasource_id: vulnrichment_importer_v2/CVE-2024-52307
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/52xxx/CVE-2024-52307.json
aliases: []
summary: authentik is an open-source identity provider. Due to the usage of a non-constant time
  comparison for the /-/metrics/ endpoint it was possible to brute-force the SECRET_KEY, which
  is used to authenticate the endpoint. The /-/metrics/ endpoint returns Prometheus metrics
  and is not intended to be accessed directly, as the Go proxy running in the authentik server
  container fetches data from this endpoint and serves it on a separate port (9300 by default),
  which can be scraped by Prometheus without being exposed publicly. authentik 2024.8.5 and
  2024.10.3 fix this issue. Since the /-/metrics/ endpoint is not intended to be accessed publicly,
  requests to the endpoint can be blocked by the reverse proxy/load balancer used in conjunction
  with authentik.
impacted_packages: []
severities:
  - score: '6.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:L/VA:L/SC:L/SI:N/SA:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-11-21T21:05:39Z/
    published_at: None
    url:
weaknesses:
  - CWE-208
references:
  - url: https://github.com/goauthentik/authentik/commit/5ea4580884f99369f0ccfe484c04cb03a66e65b8
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/security/advisories/GHSA-2xrw-5f2x-m56j
    reference_type:
    reference_id:
