advisory_id: CVE-2024-41078
datasource_id: vulnrichment_importer_v2/CVE-2024-41078
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/41xxx/CVE-2024-41078.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  btrfs: qgroup: fix quota root leak after quota disable failure

  If during the quota disable we fail when cleaning the quota tree or when
  deleting the root from the root tree, we jump to the 'out' label without
  ever dropping the reference on the quota root, resulting in a leak of the
  root since fs_info->quota_root is no longer pointing to the root (we have
  set it to NULL just before those steps).

  Fix this by always doing a btrfs_put_root() call under the 'out' label.
  This is a problem that exists since qgroups were first added in 2012 by
  commit bed92eae26cc ("Btrfs: qgroup implementation and prototypes"), but
  back then we missed a kfree on the quota root and free_extent_buffer()
  calls on its root and commit root nodes, since back then roots were not
  yet reference counted.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:21:14Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/5ef3961682e5310f2221bae99bcf9f5d0f4b0d51
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7dd6a5b96157a21245566b21fd58276a214357ff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8a69529f22590b67bb018de9acbcf94abc8603cf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/94818bdb00ef34a996a06aa63d11f591074cb757
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a7e4c6a3031c74078dba7fa36239d0f4fe476c53
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f88aeff5a173e8ba3133314eb4b964236ef3589d
    reference_type:
    reference_id:
