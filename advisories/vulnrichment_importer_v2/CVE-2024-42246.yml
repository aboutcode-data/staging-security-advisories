advisory_id: CVE-2024-42246
datasource_id: vulnrichment_importer_v2/CVE-2024-42246
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/42xxx/CVE-2024-42246.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net, sunrpc: Remap EPERM in case of connection failure in xs_tcp_setup_socket

  When using a BPF program on kernel_connect(), the call can return -EPERM. This
  causes xs_tcp_setup_socket() to loop forever, filling up the syslog and causing
  the kernel to potentially freeze up.

  Neil suggested:

    This will propagate -EPERM up into other layers which might not be ready
    to handle it. It might be safer to map EPERM to an error we would be more
    likely to expect from the network system - such as ECONNREFUSED or ENETDOWN.

  ECONNREFUSED as error seems reasonable. For programs setting a different error
  can be out of reach (see handling in 4fbac77d2d09) in particular on kernels
  which do not have f10d05966196 ("bpf: Make BPF_PROG_RUN_ARRAY return -err
  instead of allow boolean"), thus given that it is better to simply remap for
  consistent behavior. UDP does handle EPERM in xs_udp_send_request().
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:13:31Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/02ee1976edb21a96ce8e3fd4ef563f14cc16d041
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5d8254e012996cee1a0f9cc920531cb7e4d9a011
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/626dfed5fa3bfb41e0dffd796032b555b69f9cde
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/934247ea65bc5eca8bdb7f8c0ddc15cef992a5d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bc790261218952635f846aaf90bcc0974f6f62c6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d6c686c01c5f12ff8f7264e0ddf71df6cb0d4414
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f2431e7db0fe0daccb2f06bb0d23740affcd2fa6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f388cfd913a2b96c05339a335f365795db1b36b6
    reference_type:
    reference_id:
