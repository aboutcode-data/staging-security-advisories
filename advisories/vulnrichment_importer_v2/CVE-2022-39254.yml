advisory_id: CVE-2022-39254
datasource_id: vulnrichment_importer_v2/CVE-2022-39254
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/39xxx/CVE-2022-39254.json
aliases: []
summary: matrix-nio is a Python Matrix client library, designed according to sans I/O principles.
  Prior to version 0.20, when a users requests a room key from their devices, the software correctly
  remember the request. Once they receive a forwarded room key, they accept it without checking
  who the room key came from. This allows homeservers to try to insert room keys of questionable
  validity, potentially mounting an impersonation attack. Version 0.20 fixes the issue.
impacted_packages: []
severities:
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:50:24Z/
    published_at: None
    url:
weaknesses:
  - CWE-322
  - CWE-287
references:
  - url: https://github.com/poljar/matrix-nio/commit/b1cbf234a831daa160673defd596e6450e9c29f0
    reference_type:
    reference_id:
  - url: https://github.com/poljar/matrix-nio/security/advisories/GHSA-w4pr-4vjg-hffh
    reference_type:
    reference_id:
