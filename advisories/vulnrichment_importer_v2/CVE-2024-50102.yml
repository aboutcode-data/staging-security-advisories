advisory_id: CVE-2024-50102
datasource_id: vulnrichment_importer_v2/CVE-2024-50102
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/50xxx/CVE-2024-50102.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86: fix user address masking non-canonical speculation issue

  It turns out that AMD has a "Meltdown Lite(tm)" issue with non-canonical
  accesses in kernel space.  And so using just the high bit to decide
  whether an access is in user space or kernel space ends up with the good
  old "leak speculative data" if you have the right gadget using the
  result:

    CVE-2020-12965 “Transient Execution of Non-Canonical Accesses“

  Now, the kernel surrounds the access with a STAC/CLAC pair, and those
  instructions end up serializing execution on older Zen architectures,
  which closes the speculation window.

  But that was true only up until Zen 5, which renames the AC bit [1].
  That improves performance of STAC/CLAC a lot, but also means that the
  speculation window is now open.

  Note that this affects not just the new address masking, but also the
  regular valid_user_address() check used by access_ok(), and the asm
  version of the sign bit check in the get_user() helpers.

  It does not affect put_user() or clear_user() variants, since there's no
  speculative result to be used in a gadget for those operations.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T20:22:29Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/291313693677a345d4f50aae3c68e28b469f601e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/86e6b1547b3d013bc392adf775b89318441403c2
    reference_type:
    reference_id:
