advisory_id: CVE-2024-45030
datasource_id: vulnrichment_importer_v2/CVE-2024-45030
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/45xxx/CVE-2024-45030.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  igb: cope with large MAX_SKB_FRAGS

  Sabrina reports that the igb driver does not cope well with large
  MAX_SKB_FRAG values: setting MAX_SKB_FRAG to 45 causes payload
  corruption on TX.

  An easy reproducer is to run ssh to connect to the machine.  With
  MAX_SKB_FRAGS=17 it works, with MAX_SKB_FRAGS=45 it fails.  This has
  been reported originally in
  https://bugzilla.redhat.com/show_bug.cgi?id=2265320

  The root cause of the issue is that the driver does not take into
  account properly the (possibly large) shared info size when selecting
  the ring layout, and will try to fit two packets inside the same 4K
  page even when the 1st fraglist will trump over the 2nd head.

  Address the issue by checking if 2K buffers are insufficient.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-29T15:45:35Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/8aba27c4a5020abdf60149239198297f88338a8d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8ea80ff5d8298356d28077bc30913ed37df65109
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b52bd8bcb9e8ff250c79b44f9af8b15cae8911ab
    reference_type:
    reference_id:
