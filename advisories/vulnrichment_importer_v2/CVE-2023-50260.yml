advisory_id: CVE-2023-50260
datasource_id: vulnrichment_importer_v2/CVE-2023-50260
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/50xxx/CVE-2023-50260.json
aliases: []
summary: Wazuh is a free and open source platform used for threat prevention, detection, and
  response. A wrong validation in the `host_deny` script allows to write any string in the `hosts.deny`
  file, which can end in an arbitrary command execution on the target system. This vulnerability
  is part of the active response feature, which can automatically triggers actions in response
  to alerts. By default, active responses are limited to a set of pre defined executables. This
  is enforced by only allowing executables stored under `/var/ossec/active-response/bin` to
  be run as an active response. However, the `/var/ossec/active-response/bin/host_deny` can
  be exploited. `host_deny` is used to add IP address to the `/etc/hosts.deny` file to block
  incoming connections on a service level by using TCP wrappers. Attacker can inject arbitrary
  command into the `/etc/hosts.deny` file and execute arbitrary command by using the spawn directive.
  The active response can be triggered by writing events either to the local `execd` queue on
  server or to the `ar` queue which forwards the events to agents. So, it can leads to LPE on
  server as root and RCE on agent as root. This vulnerability is fixed in 4.7.2.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-04-22T19:12:01Z/
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/wazuh/wazuh/security/advisories/GHSA-mjq2-xf8g-68vw
    reference_type:
    reference_id:
