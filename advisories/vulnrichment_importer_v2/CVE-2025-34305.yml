advisory_id: CVE-2025-34305
datasource_id: vulnrichment_importer_v2/CVE-2025-34305
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/34xxx/CVE-2025-34305.json
aliases: []
summary: IPFire versions prior to 2.29 (Core Update 198) contain multiple stored cross-site
  scripting (XSS) vulnerabilities caused by a bug in the cleanhtml() function (/var/ipfire/header.pl)
  that fails to apply HTML-entity encoding to user input. When an authenticated user submits
  data to affected endpoints - for example, POST /cgi-bin/wakeonlan.cgi (CLIENT_COMMENT), /cgi-bin/dhcp.cgi
  (ADVOPT_DATA, FIX_REMARK, FIX_FILENAME, FIX_ROOTPATH), /cgi-bin/connscheduler.cgi (ACTION_COMMENT),
  /cgi-bin/dnsforward.cgi (REMARK), /cgi-bin/vpnmain.cgi (REMARK), or /cgi-bin/dns.cgi (REMARK)
  - the application calls escape() and HTML::Entities::encode_entities() but never assigns the
  sanitized result back to the output variable. The original unsanitized value is therefore
  stored and later rendered in the web interface without proper sanitation or encoding, allowing
  injected scripts to execute in the context of other users who view the affected entries.
impacted_packages: []
severities:
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-29T18:09:03Z/
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://bugzilla.ipfire.org/show_bug.cgi?id=13880
    reference_type:
    reference_id:
  - url: https://www.ipfire.org/blog/ipfire-2-29-core-update-198-released
    reference_type:
    reference_id:
  - url: https://www.vulncheck.com/advisories/ipfire-stored-xss-via-multiple-methods-in-cleanhtml
    reference_type:
    reference_id:
