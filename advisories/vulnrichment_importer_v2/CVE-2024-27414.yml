advisory_id: CVE-2024-27414
datasource_id: vulnrichment_importer_v2/CVE-2024-27414
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/27xxx/CVE-2024-27414.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  rtnetlink: fix error logic of IFLA_BRIDGE_FLAGS writing back

  In the commit d73ef2d69c0d ("rtnetlink: let rtnl_bridge_setlink checks
  IFLA_BRIDGE_MODE length"), an adjustment was made to the old loop logic
  in the function `rtnl_bridge_setlink` to enable the loop to also check
  the length of the IFLA_BRIDGE_MODE attribute. However, this adjustment
  removed the `break` statement and led to an error logic of the flags
  writing back at the end of this function.

  if (have_flags)
      memcpy(nla_data(attr), &flags, sizeof(flags));
      // attr should point to IFLA_BRIDGE_FLAGS NLA !!!

  Before the mentioned commit, the `attr` is granted to be IFLA_BRIDGE_FLAGS.
  However, this is not necessarily true fow now as the updated loop will let
  the attr point to the last NLA, even an invalid NLA which could cause
  overflow writes.

  This patch introduces a new variable `br_flag` to save the NLA pointer
  that points to IFLA_BRIDGE_FLAGS and uses it to resolve the mentioned
  error logic.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-21T15:56:59Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/167d8642daa6a44b51de17f8ff0f584e1e762db7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/743ad091fb46e622f1b690385bb15e3cd3daf874
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/831bc2728fb48a8957a824cba8c264b30dca1425
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/882a51a10ecf24ce135d573afa0872aef02c5125
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a1227b27fcccc99dc44f912b479e01a17e2d7d31
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b9fbc44159dfc3e9a7073032752d9e03f5194a6f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f2261eb994aa5757c1da046b78e3229a3ece0ad9
    reference_type:
    reference_id:
