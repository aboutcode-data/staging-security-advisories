advisory_id: CVE-2022-48647
datasource_id: vulnrichment_importer_v2/CVE-2022-48647
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48647.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sfc: fix TX channel offset when using legacy interrupts

  In legacy interrupt mode the tx_channel_offset was hardcoded to 1, but
  that's not correct if efx_sepparate_tx_channels is false. In that case,
  the offset is 0 because the tx queues are in the single existing channel
  at index 0, together with the rx queue.

  Without this fix, as soon as you try to send any traffic, it tries to
  get the tx queues from an uninitialized channel getting these errors:
    WARNING: CPU: 1 PID: 0 at drivers/net/ethernet/sfc/tx.c:540 efx_hard_start_xmit+0x12e/0x170 [sfc]
    [...]
    RIP: 0010:efx_hard_start_xmit+0x12e/0x170 [sfc]
    [...]
    Call Trace:
     <IRQ>
     dev_hard_start_xmit+0xd7/0x230
     sch_direct_xmit+0x9f/0x360
     __dev_queue_xmit+0x890/0xa40
    [...]
    BUG: unable to handle kernel NULL pointer dereference at 0000000000000020
    [...]
    RIP: 0010:efx_hard_start_xmit+0x153/0x170 [sfc]
    [...]
    Call Trace:
     <IRQ>
     dev_hard_start_xmit+0xd7/0x230
     sch_direct_xmit+0x9f/0x360
     __dev_queue_xmit+0x890/0xa40
    [...]
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-17T19:07:40Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/360910b88d1466a90644a4e0533803b594344a2b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5f623a77cfc2d501d72bcb4f9ee71721e6c766ff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b4afd3878f961d3517f27b3213730fceef77945c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f232af4295653afa4ade3230462b3be15ad16419
    reference_type:
    reference_id:
