advisory_id: CVE-2022-22223
datasource_id: vulnrichment_importer_v2/CVE-2022-22223
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/22xxx/CVE-2022-22223.json
aliases: []
summary: 'On QFX10000 Series devices using Juniper Networks Junos OS when configured as transit
  IP/MPLS penultimate hop popping (PHP) nodes with link aggregation group (LAG) interfaces,
  an Improper Validation of Specified Index, Position, or Offset in Input weakness allows an
  attacker sending certain IP packets to cause multiple interfaces in the LAG to detach causing
  a Denial of Service (DoS) condition. Continued receipt and processing of these packets will
  sustain the Denial of Service. This issue affects IPv4 and IPv6 packets. Packets of either
  type can cause and sustain the DoS event. These packets can be destined to the device or be
  transit packets. On devices such as the QFX10008 with line cards, line cards can be restarted
  to restore service. On devices such as the QFX10002 you can restart the PFE service, or reboot
  device to restore service. This issue affects: Juniper Networks Junos OS on QFX10000 Series:
  All versions prior to 15.1R7-S11; 18.4 versions prior to 18.4R2-S10, 18.4R3-S10; 19.1 versions
  prior to 19.1R3-S8; 19.2 versions prior to 19.2R3-S4; 19.3 versions prior to 19.3R3-S5; 19.4
  versions prior to 19.4R2-S6, 19.4R3-S7; 20.1 versions prior to 20.1R3-S3; 20.2 versions prior
  to 20.2R3-S3; 20.3 versions prior to 20.3R3-S2; 20.4 versions prior to 20.4R3-S4; 21.1 versions
  prior to 21.1R3; 21.2 versions prior to 21.2R3-S3; 21.3 versions prior to 21.3R3-S1. An indicator
  of compromise may be seen by issuing the command: request pfe execute target fpc0 command
  "show jspec pechip[3] registers ps l2_node 10" timeout 0 | refresh 1 | no-more and reviewing
  for backpressured output; for example: GOT: 0x220702a8 pe.ps.l2_node[10].pkt_cnt 00000076
  GOT: 0x220702b4 pe.ps.l2_node[10].backpressured 00000002 <<<< STICKS HERE and requesting detail
  on the pepic wanio: request pfe execute target fpc0 command "show pepic 0 wanio-info" timeout
  0 | no-more | match xe-0/0/0:2 GOT: 3 xe-0/0/0:2 10 6 3 0 1 10 189 10 0x6321b088 <<< LOOK
  HERE as well as looking for tail drops looking at the interface queue, for example: show interfaces
  queue xe-0/0/0:2 resulting in: Transmitted: Total-dropped packets: 1094137 0 pps << LOOK HERE'
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-05-12T14:42:59Z/
    published_at: None
    url:
weaknesses:
  - CWE-1285
references:
  - url: https://kb.juniper.net/JSA69873
    reference_type: other
    reference_id: JSA69873
