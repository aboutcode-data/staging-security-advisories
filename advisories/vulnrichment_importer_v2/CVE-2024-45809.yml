advisory_id: CVE-2024-45809
datasource_id: vulnrichment_importer_v2/CVE-2024-45809
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/45xxx/CVE-2024-45809.json
aliases: []
summary: 'Envoy is a cloud-native high-performance edge/middle/service proxy. Jwt filter will
  lead to an Envoy crash when clear route cache with remote JWKs. In the following case: 1.
  remote JWKs are used, which requires async header processing; 2. clear_route_cache is enabled
  on the provider; 3. header operations are enabled in JWT filter, e.g. header to claims feature;
  4. the routing table is configured in a way that the JWT header operations modify requests
  to not match any route. When these conditions are met, a crash is triggered in the upstream
  code due to nullptr reference conversion from route(). The root cause is the ordering of continueDecoding
  and clearRouteCache. This issue has been addressed in versions 1.31.2, 1.30.6, and 1.29.9.
  Users are advised to upgrade. There are no known workarounds for this vulnerability.'
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-20T17:23:06Z/
    published_at: None
    url:
weaknesses:
  - CWE-119
references:
  - url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-wqr5-qmq7-3qw3
    reference_type:
    reference_id:
