advisory_id: CVE-2024-28197
datasource_id: vulnrichment_importer_v2/CVE-2024-28197
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/28xxx/CVE-2024-28197.json
aliases: []
summary: 'Zitadel is an open source identity management system. Zitadel uses a cookie to identify
  the user agent (browser) and its user sessions.  Although the cookie was handled according
  to best practices, it was accessible on subdomains of the ZITADEL instance. An attacker could
  take advantage of this and provide a malicious link hosted on the subdomain to the user to
  gain access to the victimâ€™s account in certain scenarios. A possible victim would need to
  login through the malicious link for this exploit to work. If the possible victim already
  had the cookie present, the attack would not succeed. The attack would further only be possible
  if there was an initial vulnerability on the subdomain. This could either be the attacker
  being able to control DNS or a XSS vulnerability in an application hosted on a subdomain.
  Versions 2.46.0, 2.45.1, and 2.44.3 have been patched. Zitadel recommends upgrading to the
  latest versions available in due course. Note that applying the patch will invalidate the
  current cookie and thus users will need to start a new session and existing sessions (user
  selection) will be empty. For self-hosted environments unable to upgrade to a patched version,
  prevent setting the following cookie name on subdomains of your Zitadel instance (e.g. within
  your WAF): `__Secure-zitadel-useragent`.'
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-08-26T18:13:08Z/
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/zitadel/zitadel/security/advisories/GHSA-mq4x-r2w3-j7mr
    reference_type:
    reference_id:
