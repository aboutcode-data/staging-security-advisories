advisory_id: CVE-2023-53338
datasource_id: vulnrichment_importer_v2/CVE-2023-53338
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/53xxx/CVE-2023-53338.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  lwt: Fix return values of BPF xmit ops

  BPF encap ops can return different types of positive values, such like
  NET_RX_DROP, NET_XMIT_CN, NETDEV_TX_BUSY, and so on, from function
  skb_do_redirect and bpf_lwt_xmit_reroute. At the xmit hook, such return
  values would be treated implicitly as LWTUNNEL_XMIT_CONTINUE in
  ip(6)_finish_output2. When this happens, skbs that have been freed would
  continue to the neighbor subsystem, causing use-after-free bug and
  kernel crashes.

  To fix the incorrect behavior, skb_do_redirect return values can be
  simply discarded, the same as tc-egress behavior. On the other hand,
  bpf_lwt_xmit_reroute returns useful errors to local senders, e.g. PMTU
  information. Thus convert its return values to avoid the conflict with
  LWTUNNEL_XMIT_CONTINUE.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2026-01-14T18:38:11Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/065d5f17096ec9161180e2c890afdff4dc6125f2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/29b22badb7a84b783e3a4fffca16f7768fb31205
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/65583f9e070db7bece20710cfa2e3daeb0b831d9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/67f8f2bae8e7ac72e09def2b667e44704c4d1ee1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a97f221651fcdc891166e9bc270e3d9bfa5a0080
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d68c17402442f5f494a2c3ebde5cb82f6aa9160a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e3f647e4b642f9f6d32795a16f92c116c138d2af
    reference_type:
    reference_id:
