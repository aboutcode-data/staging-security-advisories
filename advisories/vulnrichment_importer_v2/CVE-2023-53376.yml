advisory_id: CVE-2023-53376
datasource_id: vulnrichment_importer_v2/CVE-2023-53376
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/53xxx/CVE-2023-53376.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: mpi3mr: Use number of bits to manage bitmap sizes

  To allocate bitmaps, the mpi3mr driver calculates sizes of bitmaps using
  byte as unit. However, bitmap helper functions assume that bitmaps are
  allocated using unsigned long as unit. This gap causes memory access beyond
  the bitmap sizes and results in "BUG: KASAN: slab-out-of-bounds".  The BUG
  was observed at firmware download to eHBA-9600. Call trace indicated that
  the out-of-bounds access happened in find_first_zero_bit() called from
  mpi3mr_send_event_ack() for miroc->evtack_cmds_bitmap.

  To fix the BUG, do not use bytes to manage bitmap sizes. Instead, use
  number of bits, and call bitmap helper functions which take number of bits
  as arguments. For memory allocation, call bitmap_zalloc() instead of
  kzalloc() and krealloc(). For memory free, call bitmap_free() instead of
  kfree(). For zero clear, call bitmap_clear() instead of memset().

  Remove three fields for bitmap byte sizes in struct scmd_priv which are no
  longer required. Replace the field dev_handle_bitmap_sz with
  dev_handle_bitmap_bits to keep number of bits of removepend_bitmap across
  resize.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2026-01-14T18:54:58Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/339e61565f81a6534afdc18fd854b2e2628bf5db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6a675a6d57d31da43d8da576465c1cd5d5b0bd3d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8ac713d2e9845e9234bb12ae5903040685d5aff9
    reference_type:
    reference_id:
