advisory_id: CVE-2024-49858
datasource_id: vulnrichment_importer_v2/CVE-2024-49858
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/49xxx/CVE-2024-49858.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  efistub/tpm: Use ACPI reclaim memory for event log to avoid corruption

  The TPM event log table is a Linux specific construct, where the data
  produced by the GetEventLog() boot service is cached in memory, and
  passed on to the OS using an EFI configuration table.

  The use of EFI_LOADER_DATA here results in the region being left
  unreserved in the E820 memory map constructed by the EFI stub, and this
  is the memory description that is passed on to the incoming kernel by
  kexec, which is therefore unaware that the region should be reserved.

  Even though the utility of the TPM2 event log after a kexec is
  questionable, any corruption might send the parsing code off into the
  weeds and crash the kernel. So let's use EFI_ACPI_RECLAIM_MEMORY
  instead, which is always treated as reserved by the E820 conversion
  logic.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:56:02Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/11690d7e76842f29b60fbb5b35bc97d206ea0e83
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/19fd2f2c5fb36b61506d3208474bfd8fdf1cada3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2e6871a632a99d9b9e2ce3a7847acabe99e5a26e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/38d9b07d99b789efb6d8dda21f1aaad636c38993
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5b22c038fb2757c652642933de5664da471f8cb7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/77d48d39e99170b528e4f2e9fc5d1d64cdedd386
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f76b69ab9cf04358266e3cea5748c0c2791fbb08
    reference_type:
    reference_id:
