advisory_id: CVE-2024-46695
datasource_id: vulnrichment_importer_v2/CVE-2024-46695
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/46xxx/CVE-2024-46695.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  selinux,smack: don't bypass permissions check in inode_setsecctx hook

  Marek Gresko reports that the root user on an NFS client is able to
  change the security labels on files on an NFS filesystem that is
  exported with root squashing enabled.

  The end of the kerneldoc comment for __vfs_setxattr_noperm() states:

   *  This function requires the caller to lock the inode's i_mutex before it
   *  is executed. It also assumes that the caller will make the appropriate
   *  permission checks.

  nfsd_setattr() does do permissions checking via fh_verify() and
  nfsd_permission(), but those don't do all the same permissions checks
  that are done by security_inode_setxattr() and its related LSM hooks do.

  Since nfsd_setattr() is the only consumer of security_inode_setsecctx(),
  simplest solution appears to be to replace the call to
  __vfs_setxattr_noperm() with a call to __vfs_setxattr_locked().  This
  fixes the above issue and has the added benefit of causing nfsd to
  recall conflicting delegations on a file when a client tries to change
  its security label.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-29T15:05:47Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2dbc4b7bac60b02cc6e70d05bf6a7dfd551f9dda
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/459584258d47ec3cc6245a82e8a49c9d08eb8b57
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/76a0e79bc84f466999fa501fce5bf7a07641b8a7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eebec98791d0137e455cc006411bb92a54250924
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f71ec019257ba4f7ab198bd948c5902a207bad96
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fe0cd53791119f6287b6532af8ce41576d664930
    reference_type:
    reference_id:
