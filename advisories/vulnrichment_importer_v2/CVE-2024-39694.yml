advisory_id: CVE-2024-39694
datasource_id: vulnrichment_importer_v2/CVE-2024-39694
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/39xxx/CVE-2024-39694.json
aliases: []
summary: 'Duende IdentityServer is an OpenID Connect and OAuth 2.x framework for ASP.NET Core.
  It is possible for an attacker to craft malicious Urls that certain functions in IdentityServer
  will incorrectly treat as local and trusted. If such a Url is returned as a redirect, some
  browsers will follow it to a third-party, untrusted site. Note: by itself, this vulnerability
  does **not** allow an attacker to obtain user credentials, authorization codes, access tokens,
  refresh tokens, or identity tokens. An attacker could however exploit this vulnerability as
  part of a phishing attack designed to steal user credentials. This vulnerability is fixed
  in 7.0.6, 6.3.10, 6.2.5, 6.1.8, and 6.0.5. Duende.IdentityServer 5.1 and earlier and all versions
  of IdentityServer4 are no longer supported and will not be receiving updates. If upgrading
  is not possible, use `IUrlHelper.IsLocalUrl` from ASP.NET Core to validate return Urls in
  user interface code in the IdentityServer host.'
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-07-31T16:51:39Z/
    published_at: None
    url:
weaknesses:
  - CWE-601
references:
  - url: https://github.com/DuendeSoftware/IdentityServer/commit/269ca2171fe1e901c87f2f0797bbc7c230db87c6
    reference_type:
    reference_id:
  - url: https://github.com/DuendeSoftware/IdentityServer/commit/765116a2d4fb0671b6eba015e698533900c61c8e
    reference_type:
    reference_id:
  - url: https://github.com/DuendeSoftware/IdentityServer/commit/d0d8eab35ad9183b14925496803ed8b36658d0a1
    reference_type:
    reference_id:
  - url: https://github.com/DuendeSoftware/IdentityServer/commit/f04cf0be859b93f43563f8f812eb92206ad94011
    reference_type:
    reference_id:
  - url: https://github.com/DuendeSoftware/IdentityServer/commit/fe817b499933d6ed6141b153492d7335c28b184a
    reference_type:
    reference_id:
  - url: https://github.com/DuendeSoftware/IdentityServer/security/advisories/GHSA-ff4q-64jc-gx98
    reference_type:
    reference_id:
