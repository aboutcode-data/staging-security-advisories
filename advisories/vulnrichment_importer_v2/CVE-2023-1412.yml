advisory_id: CVE-2023-1412
datasource_id: vulnrichment_importer_v2/CVE-2023-1412
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/1xxx/CVE-2023-1412.json
aliases: []
summary: |
  An unprivileged (non-admin) user can exploit an Improper Access Control vulnerability in the Cloudflare WARP Client for Windows (<= 2022.12.582.0) to perform privileged operations with SYSTEM context by working with a combination of opportunistic locks (oplock) and symbolic links (which can both be created by an unprivileged user).

  After installing the Cloudflare WARP Client (admin privileges required), an MSI-Installer is placed under C:\Windows\Installer. The vulnerability lies in the repair function of this MSI.

  ImpactAn unprivileged (non-admin) user can exploit this vulnerability to perform privileged operations with SYSTEM context, including deleting arbitrary files and reading arbitrary file content. This can lead to a variety of attacks, including the manipulation of system files and privilege escalation.

  PatchesA new installer with a fix that addresses this vulnerability was released in version 2023.3.381.0. While the WARP Client itself is not vulnerable (only the installer), users are encouraged to upgrade to the latest version and delete any older installers present in their systems.
impacted_packages: []
severities:
  - score: 7
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-02-10T18:02:23Z/
    published_at: None
    url:
weaknesses:
  - CWE-59
references:
  - url: https://developers.cloudflare.com/warp-client/get-started/windows/
    reference_type:
    reference_id:
  - url: https://github.com/cloudflare/advisories/security/advisories/GHSA-hgxh-48m3-3gq7
    reference_type:
    reference_id:
  - url: https://install.appcenter.ms/orgs/cloudflare/apps/1.1.1.1-windows-1/distribution_groups/release
    reference_type:
    reference_id:
