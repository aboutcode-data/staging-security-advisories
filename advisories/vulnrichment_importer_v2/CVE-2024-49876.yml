advisory_id: CVE-2024-49876
datasource_id: vulnrichment_importer_v2/CVE-2024-49876
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/49xxx/CVE-2024-49876.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/xe: fix UAF around queue destruction

  We currently do stuff like queuing the final destruction step on a
  random system wq, which will outlive the driver instance. With bad
  timing we can teardown the driver with one or more work workqueue still
  being alive leading to various UAF splats. Add a fini step to ensure
  user queues are properly torn down. At this point GuC should already be
  nuked so queue itself should no longer be referenced from hw pov.

  v2 (Matt B)
   - Looks much safer to use a waitqueue and then just wait for the
     xa_array to become empty before triggering the drain.

  (cherry picked from commit 861108666cc0e999cffeab6aff17b662e68774e3)
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-22T13:46:17Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/272b0e78874586d6ccae04079d75b27b47705544
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2d2be279f1ca9e7288282d4214f16eea8a727cdb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/421c74670b0f9d5c007f1276d3647aa58f407fde
    reference_type:
    reference_id:
