advisory_id: CVE-2021-47224
datasource_id: vulnrichment_importer_v2/CVE-2021-47224
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47224.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: ll_temac: Make sure to free skb when it is completely used

  With the skb pointer piggy-backed on the TX BD, we have a simple and
  efficient way to free the skb buffer when the frame has been transmitted.
  But in order to avoid freeing the skb while there are still fragments from
  the skb in use, we need to piggy-back on the TX BD of the skb, not the
  first.

  Without this, we are doing use-after-free on the DMA side, when the first
  BD of a multi TX BD packet is seen as completed in xmit_done, and the
  remaining BDs are still being processed.
impacted_packages: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T18:48:29Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/019ab7d044d0ebf97e1236bb8935b7809be92358
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6aa32217a9a446275440ee8724b1ecaf1838df47
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6d120ab4dc39a543c6b63361e1d0541c382900a3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e8afe05bd359ebe12a61dbdc94c06c00ea3e8d4b
    reference_type:
    reference_id:
