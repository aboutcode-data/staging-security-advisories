advisory_id: CVE-2023-37898
datasource_id: vulnrichment_importer_v2/CVE-2023-37898
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/37xxx/CVE-2023-37898.json
aliases: []
summary: Joplin is a free, open source note taking and to-do application. A Cross-site Scripting
  (XSS) vulnerability allows an untrusted note opened in safe mode to execute arbitrary code.
  `packages/renderer/MarkupToHtml.ts` renders note content in safe mode by surrounding it with
  <pre> and </pre>, without escaping any interior HTML tags. Thus, an attacker can create a
  note that closes the opening <pre> tag, then includes HTML that runs JavaScript. Because the
  rendered markdown iframe has the same origin as the toplevel document and is not sandboxed,
  any scripts running in the preview iframe can access the top variable and, thus, access the
  toplevel NodeJS `require` function. `require` can then be used to import modules like fs or
  child_process and run arbitrary commands. This issue has been addressed in version 2.12.9
  and all users are advised to upgrade. There are no known workarounds for this vulnerability.
impacted_packages: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-07-02T20:15:32Z/
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#sandbox
    reference_type:
    reference_id:
  - url: https://github.com/laurent22/joplin/security/advisories/GHSA-hjmq-3qh4-g2r8
    reference_type:
    reference_id:
