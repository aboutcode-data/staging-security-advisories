advisory_id: CVE-2024-40972
datasource_id: vulnrichment_importer_v2/CVE-2024-40972
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/40xxx/CVE-2024-40972.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: do not create EA inode under buffer lock

  ext4_xattr_set_entry() creates new EA inodes while holding buffer lock
  on the external xattr block. This is problematic as it nests all the
  allocation locking (which acquires locks on other buffers) under the
  buffer lock. This can even deadlock when the filesystem is corrupted and
  e.g. quota file is setup to contain xattr block as data block. Move the
  allocation of EA inode out of ext4_xattr_set_entry() into the callers.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:02:50Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0752e7fb549d90c33b4d4186f11cfd25a556d1dd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0a46ef234756dca04623b7591e8ebb3440622f0b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/111103907234bffd0a34fba070ad9367de058752
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/737fb7853acd5bc8984f6f42e4bfba3334be8ae1
    reference_type:
    reference_id:
