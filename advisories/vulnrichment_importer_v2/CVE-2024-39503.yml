advisory_id: CVE-2024-39503
datasource_id: vulnrichment_importer_v2/CVE-2024-39503
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/39xxx/CVE-2024-39503.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: ipset: Fix race between namespace cleanup and gc in the list:set type

  Lion Ackermann reported that there is a race condition between namespace cleanup
  in ipset and the garbage collection of the list:set type. The namespace
  cleanup can destroy the list:set type of sets while the gc of the set type is
  waiting to run in rcu cleanup. The latter uses data from the destroyed set which
  thus leads use after free. The patch contains the following parts:

  - When destroying all sets, first remove the garbage collectors, then wait
    if needed and then destroy the sets.
  - Fix the badly ordered "wait then remove gc" for the destroy a single set
    case.
  - Fix the missing rcu locking in the list:set type in the userspace test
    case.
  - Use proper RCU list handlings in the list:set type.

  The patch depends on c1193d9bbbd3 (netfilter: ipset: Add list flush to cancel_gc).
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:07:04Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0f1bb77c6d837c9513943bc7c08f04c5cc5c6568
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2ba35b37f780c6410bb4bba9c3072596d8576702
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/390b353d1a1da3e9c6c0fd14fe650d69063c95d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4e7aaa6b82d63e8ddcbfb56b4fd3d014ca586f10
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/90ae20d47de602198eb69e6cd7a3db3420abfc08
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/93b53c202b51a69e42ca57f5a183f7e008e19f83
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c0761d1f1ce1d5b85b5e82bbb714df12de1aa8c3
    reference_type:
    reference_id:
