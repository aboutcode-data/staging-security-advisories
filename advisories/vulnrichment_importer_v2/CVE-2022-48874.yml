advisory_id: CVE-2022-48874
datasource_id: vulnrichment_importer_v2/CVE-2022-48874
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48874.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  misc: fastrpc: Fix use-after-free and race in fastrpc_map_find

  Currently, there is a race window between the point when the mutex is
  unlocked in fastrpc_map_lookup and the reference count increasing
  (fastrpc_map_get) in fastrpc_map_find, which can also lead to
  use-after-free.

  So lets merge fastrpc_map_find into fastrpc_map_lookup which allows us
  to both protect the maps list by also taking the &fl->lock spinlock and
  the reference count, since the spinlock will be released only after.
  Add take_ref argument to make this suitable for all callers.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:05:19Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/9446fa1683a7e3937d9970248ced427c1983a1c5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a50c5c25b6e7d2824698c0e6385f882a18f4a498
    reference_type:
    reference_id:
