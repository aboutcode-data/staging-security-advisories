advisory_id: CVE-2021-47259
datasource_id: vulnrichment_importer_v2/CVE-2021-47259
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47259.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  NFS: Fix use-after-free in nfs4_init_client()

  KASAN reports a use-after-free when attempting to mount two different
  exports through two different NICs that belong to the same server.

  Olga was able to hit this with kernels starting somewhere between 5.7
  and 5.10, but I traced the patch that introduced the clear_bit() call to
  4.13. So something must have changed in the refcounting of the clp
  pointer to make this call to nfs_put_client() the very last one.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-05-22T16:41:04Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3e3c7ebbfac152d08be75c92802a64a1f6471a15
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/42c10b0db064e45f5c5ae7019bbf2168ffab766c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/476bdb04c501fc64bf3b8464ffddefc8dbe01577
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/72651c6579a25317a90536181d311c663d0329ab
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c3b6cf64dfe4ef96e7341508d50d6998da7062c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c7eab9e2d7b4e983ce280276fb920af649955897
    reference_type:
    reference_id:
