advisory_id: CVE-2023-26033
datasource_id: vulnrichment_importer_v2/CVE-2023-26033
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/26xxx/CVE-2023-26033.json
aliases: []
summary: 'Gentoo soko is the code that powers packages.gentoo.org. Versions prior to 1.0.1 are
  vulnerable to SQL Injection, leading to a Denial of Service. If the user selects (in user
  preferences) the "Recently Visited Packages" view for the index page, the value of the `search_history`
  cookie is used as a base64 encoded comma separated list of atoms. These are string loaded
  directly into the SQL query with `atom = ''%s''` format string. As a result, any user can
  modify the browser''s cookie value and inject most SQL queries. A proof of concept malformed
  cookie was generated that wiped the database or changed it''s content. On the database, only
  public data is stored, so there is no confidentiality issues to site users. If it is known
  that the database was modified, a full restoration of data is possible by performing a full
  database wipe and performing full update of all components. This issue is patched with commit
  id 5ae9ca83b73. Version 1.0.1 contains the patch. If users are unable to upgrade immediately,
  the following workarounds may be applied: (1.) Use a proxy to always drop the `search_history`
  cookie until upgraded. The impact on user experience is low. (2.) Sanitize to the value of
  `search_history` cookie after base64 decoding it.'
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-03-10T20:58:17Z/
    published_at: None
    url:
weaknesses:
  - CWE-89
references:
  - url: https://github.com/gentoo/soko/security/advisories/GHSA-gp8g-jfq9-5q2g
    reference_type:
    reference_id:
  - url: https://gitweb.gentoo.org/sites/soko.git/commit/?id=5ae9ca83b735804f2bd405592983a73d7fcc42f4
    reference_type:
    reference_id:
