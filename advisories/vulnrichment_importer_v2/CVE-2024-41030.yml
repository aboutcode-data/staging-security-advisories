advisory_id: CVE-2024-41030
datasource_id: vulnrichment_importer_v2/CVE-2024-41030
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/41xxx/CVE-2024-41030.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ksmbd: discard write access to the directory open

  may_open() does not allow a directory to be opened with the write access.
  However, some writing flags set by client result in adding write access
  on server, making ksmbd incompatible with FUSE file system. Simply, let's
  discard the write access when opening a directory.

  list_add corruption. next is NULL.
  ------------[ cut here ]------------
  kernel BUG at lib/list_debug.c:26!
  pc : __list_add_valid+0x88/0xbc
  lr : __list_add_valid+0x88/0xbc
  Call trace:
  __list_add_valid+0x88/0xbc
  fuse_finish_open+0x11c/0x170
  fuse_open_common+0x284/0x5e8
  fuse_dir_open+0x14/0x24
  do_dentry_open+0x2a4/0x4e0
  dentry_open+0x50/0x80
  smb2_open+0xbe4/0x15a4
  handle_ksmbd_work+0x478/0x5ec
  process_one_work+0x1b4/0x448
  worker_thread+0x25c/0x430
  kthread+0x104/0x1d4
  ret_from_fork+0x10/0x20
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:23:55Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/198498b2049c0f11f7670be6974570e02b0cc035
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/66cf853e1c7a2407f15d9f7aaa3e47d61745e361
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e84b1ba5c98fb5c9f869c85db1d870354613baa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e2e33caa5dc2eae7bddf88b22ce11ec3d760e5cd
    reference_type:
    reference_id:
