advisory_id: CVE-2024-50001
datasource_id: vulnrichment_importer_v2/CVE-2024-50001
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/50xxx/CVE-2024-50001.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/mlx5: Fix error path in multi-packet WQE transmit

  Remove the erroneous unmap in case no DMA mapping was established

  The multi-packet WQE transmit code attempts to obtain a DMA mapping for
  the skb. This could fail, e.g. under memory pressure, when the IOMMU
  driver just can't allocate more memory for page tables. While the code
  tries to handle this in the path below the err_unmap label it erroneously
  unmaps one entry from the sq's FIFO list of active mappings. Since the
  current map attempt failed this unmap is removing some random DMA mapping
  that might still be required. If the PCI function now presents that IOVA,
  the IOMMU may assumes a rogue DMA access and e.g. on s390 puts the PCI
  function in error state.

  The erroneous behavior was seen in a stress-test environment that created
  memory pressure.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-22T13:29:57Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/26fad69b34fcba80d5c7d9e651f628e6ac927754
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2bcae12c795f32ddfbf8c80d1b5f1d3286341c32
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8bb8c12fb5e2b1f03d603d493c92941676f109b5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca36d6c1a49b6965c86dd528a73f38bc62d9c625
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ce828b347cf1b3c1b12b091d02463c35ce5097f5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ecf310aaf256acbc8182189fe0aa1021c3ddef72
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fc357e78176945ca7bcacf92ab794b9ccd41b4f4
    reference_type:
    reference_id:
