advisory_id: CVE-2024-50253
datasource_id: vulnrichment_importer_v2/CVE-2024-50253
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/50xxx/CVE-2024-50253.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Check the validity of nr_words in bpf_iter_bits_new()

  Check the validity of nr_words in bpf_iter_bits_new(). Without this
  check, when multiplication overflow occurs for nr_bits (e.g., when
  nr_words = 0x0400-0001, nr_bits becomes 64), stack corruption may occur
  due to bpf_probe_read_kernel_common(..., nr_bytes = 0x2000-0008).

  Fix it by limiting the maximum value of nr_words to 511. The value is
  derived from the current implementation of BPF memory allocator. To
  ensure compatibility if the BPF memory allocator's size limitation
  changes in the future, use the helper bpf_mem_alloc_check_size() to
  check whether nr_bytes is too larger. And return -E2BIG instead of
  -ENOMEM for oversized nr_bytes.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T20:15:44Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/393397fbdcad7396639d7077c33f86169184ba99
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c9539e09c67880ecd88b51188c346a2cc078b06c
    reference_type:
    reference_id:
