advisory_id: CVE-2022-48991
datasource_id: vulnrichment_importer_v2/CVE-2022-48991
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48991.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/khugepaged: invoke MMU notifiers in shmem/file collapse paths

  Any codepath that zaps page table entries must invoke MMU notifiers to
  ensure that secondary MMUs (like KVM) don't keep accessing pages which
  aren't mapped anymore.  Secondary MMUs don't hold their own references to
  pages that are mirrored over, so failing to notify them can lead to page
  use-after-free.

  I'm marking this as addressing an issue introduced in commit f3f0e1d2150b
  ("khugepaged: add support of collapse for tmpfs/shmem pages"), but most of
  the security impact of this only came in commit 27e1f8273113 ("khugepaged:
  enable collapse pmd for pte-mapped THP"), which actually omitted flushes
  for the removal of present PTEs, not just for the removal of empty page
  tables.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-22T13:16:32Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1a3f8c6cd29d9078cc81b29d39d0e9ae1d6a03c3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/275c626c131cfe141beeb6c575e31fa53d32da19
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5450535901d89a5dcca5fbbc59a24fe89caeb465
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5ffc2a75534d9d74d49760f983f8eb675fa63d69
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7f445ca2e0e59c7971d0b7b853465e50844ab596
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c23105673228c349739e958fa33955ed8faddcaf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f268f6cf875f3220afc77bdd0bf1bb136eb54db9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff2a1a6f869650aec99e9d070b5ab625bfbc5bc3
    reference_type:
    reference_id:
