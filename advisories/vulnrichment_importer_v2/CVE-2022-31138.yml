advisory_id: CVE-2022-31138
datasource_id: vulnrichment_importer_v2/CVE-2022-31138
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/31xxx/CVE-2022-31138.json
aliases: []
summary: mailcow is a mailserver suite. Prior to mailcow-dockerized version 2022-06a, an extended
  privilege vulnerability can be exploited by manipulating the custom parameters regexmess,
  skipmess, regexflag, delete2foldersonly, delete2foldersbutnot, regextrans2, pipemess, or maxlinelengthcmd
  to execute arbitrary code. Users should update their mailcow instances with the `update.sh`
  script in the mailcow root directory to 2022-06a or newer to receive a patch for this issue.
  As a temporary workaround, the Syncjob ACL can be removed from all mailbox users, preventing
  changes to those settings.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-04-22T15:42:45Z/
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/ly1g3/Mailcow-CVE-2022-31138
    reference_type:
    reference_id:
  - url: https://github.com/mailcow/mailcow-dockerized/commit/d373164e13a14e058f82c9f1918a5612f375a9f9
    reference_type:
    reference_id:
  - url: https://github.com/mailcow/mailcow-dockerized/releases/tag/2022-06a
    reference_type:
    reference_id:
  - url: https://github.com/mailcow/mailcow-dockerized/security/advisories/GHSA-vx9w-h33p-5vhc
    reference_type:
    reference_id:
