advisory_id: CVE-2021-47433
datasource_id: vulnrichment_importer_v2/CVE-2021-47433
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47433.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  btrfs: fix abort logic in btrfs_replace_file_extents

  Error injection testing uncovered a case where we'd end up with a
  corrupt file system with a missing extent in the middle of a file.  This
  occurs because the if statement to decide if we should abort is wrong.

  The only way we would abort in this case is if we got a ret !=
  -EOPNOTSUPP and we called from the file clone code.  However the
  prealloc code uses this path too.  Instead we need to abort if there is
  an error, and the only error we _don't_ abort on is -EOPNOTSUPP and only
  if we came from the clone file code.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-10T18:56:43Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0e309e1152fc34ef75991d9d69b165dbf75bf26c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0e32a2b85c7d92ece86c17dfef390c5ed79c6378
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4afb912f439c4bc4e6a4f3e7547f2e69e354108f
    reference_type:
    reference_id:
