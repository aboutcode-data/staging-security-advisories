advisory_id: CVE-2023-48293
datasource_id: vulnrichment_importer_v2/CVE-2023-48293
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/48xxx/CVE-2023-48293.json
aliases: []
summary: The XWiki Admin Tools Application provides tools to help the administration of XWiki.
  Prior to version 4.5.1, a cross-site request forgery vulnerability in the query on XWiki tool
  allows executing arbitrary database queries on the database of the XWiki installation. Among
  other things, this allows modifying and deleting all data of the wiki. This could be both
  used to damage the wiki and to create an account with elevated privileges for the attacker,
  thus impacting the confidentiality, integrity and availability of the whole XWiki instance.
  A possible attack vector are comments on the wiki, by embedding an image with wiki syntax
  like `[[image:path:/xwiki/bin/view/Admin/QueryOnXWiki?query=DELETE%20FROM%20xwikidoc]]`, all
  documents would be deleted from the database when an admin user views this comment. This has
  been patched in Admin Tools Application 4.5.1 by adding form token checks. Some workarounds
  are available. The patch can also be applied manually to the affected pages. Alternatively,
  if the query tool is not needed, by deleting the document `Admin.SQLToolsGroovy`, all database
  query tools can be deactivated.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2023-12-19T20:11:10Z/
    published_at: None
    url:
weaknesses:
  - CWE-352
references:
  - url: https://github.com/xwiki-contrib/application-admintools/commit/45298b4fbcafba6914537dcdd798a1e1385f9e46
    reference_type:
    reference_id:
  - url: https://github.com/xwiki-contrib/application-admintools/security/advisories/GHSA-4f4c-rhjv-4wgv
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/ADMINTOOL-92
    reference_type:
    reference_id:
