advisory_id: CVE-2024-53859
datasource_id: vulnrichment_importer_v2/CVE-2024-53859
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/53xxx/CVE-2024-53859.json
aliases: []
summary: 'go-gh is a Go module for interacting with the `gh` utility and the GitHub API from
  the command line. A security vulnerability has been identified in `go-gh` that could leak
  authentication tokens intended for GitHub hosts to non-GitHub hosts when within a codespace.
  `go-gh` sources authentication tokens from different environment variables depending on the
  host involved: 1. `GITHUB_TOKEN`, `GH_TOKEN` for GitHub.com and ghe.com and 2. `GITHUB_ENTERPRISE_TOKEN`,
  `GH_ENTERPRISE_TOKEN` for GitHub Enterprise Server. Prior to version `2.11.1`, `auth.TokenForHost`
  could source a token from the `GITHUB_TOKEN` environment variable for a host other than GitHub.com
  or ghe.com when within a codespace. In version `2.11.1`, `auth.TokenForHost` will only source
  a token from the `GITHUB_TOKEN` environment variable for GitHub.com or ghe.com hosts. Successful
  exploitation could send authentication token to an unintended host. This issue has been addressed
  in version 2.11.1 and all users are advised to upgrade. Users are also advised to regenerate
  authentication tokens and to review their personal security log and any relevant audit logs
  for actions associated with their account or enterprise.'
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-03T16:13:23Z/
    published_at: None
    url:
weaknesses:
  - CWE-200
references:
  - url: https://docs.github.com/en/apps/using-github-apps/reviewing-and-revoking-authorization-of-github-apps#reviewing-your-authorized-github-apps
    reference_type:
    reference_id:
  - url: https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-security-log
    reference_type:
    reference_id:
  - url: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/identifying-audit-log-events-performed-by-an-access-token
    reference_type:
    reference_id:
  - url: https://docs.github.com/en/enterprise-cloud@latest/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens
    reference_type:
    reference_id:
  - url: https://github.com/cli/go-gh/blob/71770357e0cb12867d3e3e288854c0aa09d440b7/pkg/auth/auth.go#L73-L77
    reference_type:
    reference_id:
  - url: https://github.com/cli/go-gh/security/advisories/GHSA-55v3-xh23-96gh
    reference_type:
    reference_id:
