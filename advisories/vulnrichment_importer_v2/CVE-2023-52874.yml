advisory_id: CVE-2023-52874
datasource_id: vulnrichment_importer_v2/CVE-2023-52874
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/52xxx/CVE-2023-52874.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/tdx: Zero out the missing RSI in TDX_HYPERCALL macro

  In the TDX_HYPERCALL asm, after the TDCALL instruction returns from the
  untrusted VMM, the registers that the TDX guest shares to the VMM need
  to be cleared to avoid speculative execution of VMM-provided values.

  RSI is specified in the bitmap of those registers, but it is missing
  when zeroing out those registers in the current TDX_HYPERCALL.

  It was there when it was originally added in commit 752d13305c78
  ("x86/tdx: Expand __tdx_hypercall() to handle more arguments"), but was
  later removed in commit 1e70c680375a ("x86/tdx: Do not corrupt
  frame-pointer in __tdx_hypercall()"), which was correct because %rsi is
  later restored in the "pop %rsi".  However a later commit 7a3a401874be
  ("x86/tdx: Drop flags from __tdx_hypercall()") removed that "pop %rsi"
  but forgot to add the "xor %rsi, %rsi" back.

  Fix by adding it back.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T15:36:24Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2191950d35d8f81620ea8d4e04d983f664fe3a8a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5d092b66119d774853cc9308522620299048a662
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/de4c5bacca4f50233f1f791bec9eeb4dee1b14cd
    reference_type:
    reference_id:
