advisory_id: CVE-2023-52439
datasource_id: vulnrichment_importer_v2/CVE-2023-52439
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/52xxx/CVE-2023-52439.json
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nuio: Fix use-after-free\
  \ in uio_open\n\ncore-1\t\t\t\tcore-2\n-------------------------------------------------------\n\
  uio_unregister_device\t\tuio_open\n\t\t\t\tidev = idr_find()\ndevice_unregister(&idev->dev)\n\
  put_device(&idev->dev)\nuio_device_release\n\t\t\t\tget_device(&idev->dev)\nkfree(idev)\n\
  uio_free_minor(minor)\n\t\t\t\tuio_release\n\t\t\t\tput_device(&idev->dev)\n\t\t\t\tkfree(idev)\n\
  -------------------------------------------------------\n\nIn the core-1 uio_unregister_device(),\
  \ the device_unregister will kfree\nidev when the idev->dev kobject ref is 1. But after core-1\n\
  device_unregister, put_device and before doing kfree, the core-2 may\nget_device. Then:\n\
  1. After core-1 kfree idev, the core-2 will do use-after-free for idev.\n2. When core-2 do\
  \ uio_release and put_device, the idev will be double\n   freed.\n\nTo address this issue,\
  \ we can get idev atomic & inc idev reference with\nminor_lock."
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:02:55Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0c9ae0b8605078eafc3bea053cc78791e97ba2e2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/17a8519cb359c3b483fb5c7367efa9a8a508bdea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3174e0f7de1ba392dc191625da83df02d695b60c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35f102607054faafe78d2a6994b18d5d9d6e92ad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5cf604ee538ed0c467abe3b4cda5308a6398f0f7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e0be1229ae199ebb90b33102f74a0f22d152570
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/913205930da6213305616ac539447702eaa85e41
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e93da893d52d82d57fc0db2ca566024e0f26ff50
    reference_type:
    reference_id:
