advisory_id: CVE-2024-50036
datasource_id: vulnrichment_importer_v2/CVE-2024-50036
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/50xxx/CVE-2024-50036.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: do not delay dst_entries_add() in dst_release()

  dst_entries_add() uses per-cpu data that might be freed at netns
  dismantle from ip6_route_net_exit() calling dst_entries_destroy()

  Before ip6_route_net_exit() can be called, we release all
  the dsts associated with this netns, via calls to dst_release(),
  which waits an rcu grace period before calling dst_destroy()

  dst_entries_add() use in dst_destroy() is racy, because
  dst_entries_destroy() could have been called already.

  Decrementing the number of dsts must happen sooner.

  Notes:

  1) in CONFIG_XFRM case, dst_destroy() can call
     dst_release_immediate(child), this might also cause UAF
     if the child does not have DST_NOCOUNT set.
     IPSEC maintainers might take a look and see how to address this.

  2) There is also discussion about removing this count of dst,
     which might happen in future kernels.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-22T13:25:25Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3c7c918ec0aa3555372c5a57f18780b7a96c5cfc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/547087307bc19417b4f2bc85ba9664a3e8db5a6a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a60db84f772fc3a906c6c4072f9207579c41166f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac888d58869bb99753e7652be19a151df9ecb35d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e3915f028b1f1c37e87542e5aadd33728c259d96
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eae7435b48ffc8e9be0ff9cfeae40af479a609dd
    reference_type:
    reference_id:
