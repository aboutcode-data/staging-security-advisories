advisory_id: CVE-2025-22005
datasource_id: vulnrichment_importer_v2/CVE-2025-22005
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/22xxx/CVE-2025-22005.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ipv6: Fix memleak of nhc_pcpu_rth_output in fib_check_nh_v6_gw().

  fib_check_nh_v6_gw() expects that fib6_nh_init() cleans up everything
  when it fails.

  Commit 7dd73168e273 ("ipv6: Always allocate pcpu memory in a fib6_nh")
  moved fib_nh_common_init() before alloc_percpu_gfp() within fib6_nh_init()
  but forgot to add cleanup for fib6_nh->nh_common.nhc_pcpu_rth_output in
  case it fails to allocate fib6_nh->rt6i_pcpu, resulting in memleak.

  Let's call fib_nh_common_release() and clear nhc_pcpu_rth_output in the
  error path.

  Note that we can remove the fib6_nh_release() call in nh_create_ipv6()
  later in net-next.git.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T17:09:45Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/119dcafe36795a15ae53351cbbd6177aaf94ffef
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/16267a5036173d0173377545b4b6021b081d0933
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1bd12dfc058e1e68759d313d7727d68dbc1b8964
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/29d91820184d5cbc70f3246d4911d96eaeb930d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/596a883c4ce2d2e9c175f25b98fed3a1f33fea38
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/77c41cdbe6bce476e08d3251c0d501feaf10a9f3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9740890ee20e01f99ff1dde84c63dcf089fabb98
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d3d5b4b5ae263c3225db363ba08b937e2e2b0380
    reference_type:
    reference_id:
