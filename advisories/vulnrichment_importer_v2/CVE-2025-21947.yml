advisory_id: CVE-2025-21947
datasource_id: vulnrichment_importer_v2/CVE-2025-21947
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/21xxx/CVE-2025-21947.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ksmbd: fix type confusion via race condition when using ipc_msg_send_request

  req->handle is allocated using ksmbd_acquire_id(&ipc_ida), based on
  ida_alloc. req->handle from ksmbd_ipc_login_request and
  FSCTL_PIPE_TRANSCEIVE ioctl can be same and it could lead to type confusion
  between messages, resulting in access to unexpected parts of memory after
  an incorrect delivery. ksmbd check type of ipc response but missing add
  continue to check next ipc reponse.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T17:17:27Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1e8833c03a38e1d5d5df6484e3f670a2fd38fb76
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3cb2b2e41541fe6f9cc55ca22d4c0bd260498aea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6321bbda4244b93802d61cfe0887883aae322f4b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/76861630b29e51373e73e7b00ad0d467b6941162
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e2ff19f0b7a30e03516e6eb73b948e27a55bc9d2
    reference_type:
    reference_id:
