advisory_id: CVE-2025-30159
datasource_id: vulnrichment_importer_v2/CVE-2025-30159
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/30xxx/CVE-2025-30159.json
aliases: []
summary: Kirby is an open-source content management system. A vulnerability in versions prior
  to 3.9.8.3, 3.10.1.2, and 4.7.1 affects all Kirby sites that use the `snippet()` helper or
  `$kirby->snippet()` method with a dynamic snippet name (such as a snippet name that depends
  on request or user data). Sites that only use fixed calls to the `snippet()` helper/`$kirby->snippet()`
  method (i.e. calls with a simple string for the snippet name) are *not* affected. A missing
  path traversal check allowed attackers to navigate and access all files on the server that
  were accessible to the PHP process, including files outside of the snippets root or even outside
  of the Kirby installation. PHP code within such files was executed. Such attacks first require
  an attack vector in the site code that is caused by dynamic snippet names, such as `snippet('tags-'
  . get('tags'))`. It generally also requires knowledge of the site structure and the server's
  file system by the attacker, although it can be possible to find vulnerable setups through
  automated methods such as fuzzing. In a vulnerable setup, this could cause damage to the confidentiality
  and integrity of the server. The problem has been patched in Kirby 3.9.8.3, Kirby 3.10.1.2,
  and Kirby 4.7.1. In all of the mentioned releases, Kirby maintainers have added a check for
  the snippet path that ensures that the resulting path is contained within the configured snippets
  root. Snippet paths that point outside of the snippets root will not be loaded.
impacted_packages: []
severities:
  - score: '6.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-05-13T19:44:40Z/
    published_at: None
    url:
weaknesses:
  - CWE-23
  - CWE-22
references:
  - url: https://github.com/getkirby/kirby/releases/tag/3.10.1.2
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.9.8.3
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/4.7.1
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/security/advisories/GHSA-fw82-87p8-v6hp
    reference_type:
    reference_id:
