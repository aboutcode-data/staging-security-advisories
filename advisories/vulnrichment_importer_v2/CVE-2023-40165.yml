advisory_id: CVE-2023-40165
datasource_id: vulnrichment_importer_v2/CVE-2023-40165
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/40xxx/CVE-2023-40165.json
aliases: []
summary: 'rubygems.org is the Ruby community''s primary gem (library) hosting service. Insufficient
  input validation allowed malicious actors to replace any uploaded gem version that had a platform,
  version number, or gem name matching `/-\d/`, permanently replacing the legitimate upload
  in the canonical gem storage bucket, and triggering an immediate CDN purge so that the malicious
  gem would be served immediately. The maintainers have checked all gems matching the `/-\d/`
  pattern and can confirm that no unexpected `.gem`s were found. As a result, we believe this
  vulnerability was _not_ exploited. The easiest way to ensure that a user''s applications were
  not exploited by this vulnerability is to check that all of your downloaded .gems have a checksum
  that matches the checksum recorded in the RubyGems.org database. RubyGems contributor Maciej
  Mensfeld wrote a tool to automatically check that all downloaded .gem files match the checksums
  recorded in the RubyGems.org database. You can use it by running: `bundle add bundler-integrity`
  followed by `bundle exec bundler-integrity`. Neither this tool nor anything else can prove
  you were not exploited, but the can assist your investigation by quickly comparing RubyGems
  API-provided checksums with the checksums of files on your disk. The issue has been patched
  with improved input validation and the changes are live. No action is required on the part
  of the user. Users are advised to validate their local gems.'
impacted_packages: []
severities:
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-01T17:47:18Z/
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/rubygems/rubygems.org/commit/7e19c19247ddf5885a915710afc60ec6663d8502
    reference_type:
    reference_id:
  - url: https://github.com/rubygems/rubygems.org/security/advisories/GHSA-rxcq-2m4f-94wm
    reference_type:
    reference_id:
