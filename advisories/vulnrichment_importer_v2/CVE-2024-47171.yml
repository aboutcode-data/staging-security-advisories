advisory_id: CVE-2024-47171
datasource_id: vulnrichment_importer_v2/CVE-2024-47171
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/47xxx/CVE-2024-47171.json
aliases: []
summary: Agnai is an artificial-intelligence-agnostic multi-user, mult-bot roleplaying chat
  system. A vulnerability in versions prior to 1.0.330 permits attackers to upload image files
  at attacker-chosen location on the server. This issue can lead to image file uploads to unauthorized
  or unintended directories, including overwriting of existing images which may be used for
  defacement. This does not affect `agnai.chat`, installations using S3-compatible storage,
  or self-hosting that is not publicly exposed. Version 1.0.330 fixes this vulnerability.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-26T17:50:57Z/
    published_at: None
    url:
weaknesses:
  - CWE-35
references:
  - url: 'https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/character.ts#L140:'
    reference_type:
    reference_id:
  - url: https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/upload.ts#L55
    reference_type:
    reference_id:
  - url: https://github.com/agnaistic/agnai/security/advisories/GHSA-g54f-66mw-hv66
    reference_type:
    reference_id:
