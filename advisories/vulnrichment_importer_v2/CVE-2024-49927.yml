advisory_id: CVE-2024-49927
datasource_id: vulnrichment_importer_v2/CVE-2024-49927
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/49xxx/CVE-2024-49927.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/ioapic: Handle allocation failures gracefully

  Breno observed panics when using failslab under certain conditions during
  runtime:

     can not alloc irq_pin_list (-1,0,20)
     Kernel panic - not syncing: IO-APIC: failed to add irq-pin. Can not proceed

     panic+0x4e9/0x590
     mp_irqdomain_alloc+0x9ab/0xa80
     irq_domain_alloc_irqs_locked+0x25d/0x8d0
     __irq_domain_alloc_irqs+0x80/0x110
     mp_map_pin_to_irq+0x645/0x890
     acpi_register_gsi_ioapic+0xe6/0x150
     hpet_open+0x313/0x480

  That's a pointless panic which is a leftover of the historic IO/APIC code
  which panic'ed during early boot when the interrupt allocation failed.

  The only place which might justify panic is the PIT/HPET timer_check() code
  which tries to figure out whether the timer interrupt is delivered through
  the IO/APIC. But that code does not require to handle interrupt allocation
  failures. If the interrupt cannot be allocated then timer delivery fails
  and it either panics due to that or falls back to legacy mode.

  Cure this by removing the panic wrapper around __add_pin_to_irq_node() and
  making mp_irqdomain_alloc() aware of the failure condition and handle it as
  any other failure in this function gracefully.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-22T13:39:34Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/077e1b7cd521163ded545987bbbd389519aeed71
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/649a5c2ffae797ce792023a70e84c7fe4b6fb8e0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/830802a0fea8fb39d3dc9fb7d6b5581e1343eb1f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e479cb835feeb2abff97f25766e23b96a6eabe28
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ec862cd843faa6f0e84a7a07362f2786446bf697
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f17efbeb2922327ea01a9efa8829fea9a30e547d
    reference_type:
    reference_id:
