advisory_id: CVE-2021-47389
datasource_id: vulnrichment_importer_v2/CVE-2021-47389
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47389.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  KVM: SVM: fix missing sev_decommission in sev_receive_start

  DECOMMISSION the current SEV context if binding an ASID fails after
  RECEIVE_START.  Per AMD's SEV API, RECEIVE_START generates a new guest
  context and thus needs to be paired with DECOMMISSION:

       The RECEIVE_START command is the only command other than the LAUNCH_START
       command that generates a new guest context and guest handle.

  The missing DECOMMISSION can result in subsequent SEV launch failures,
  as the firmware leaks memory and might not able to allocate more SEV
  guest contexts in the future.

  Note, LAUNCH_START suffered the same bug, but was previously fixed by
  commit 934002cd660b ("KVM: SVM: Call SEV Guest Decommission if ASID
  binding fails").
impacted_packages: []
severities:
  - score: '5.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-05T17:52:37Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/efd7866e114dcb44f86d151e843f8276b7efbc67
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f1815e0aa770f2127c5df31eb5c2f0e37b60fa77
    reference_type:
    reference_id:
