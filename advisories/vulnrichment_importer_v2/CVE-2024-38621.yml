advisory_id: CVE-2024-38621
datasource_id: vulnrichment_importer_v2/CVE-2024-38621
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/38xxx/CVE-2024-38621.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  media: stk1160: fix bounds checking in stk1160_copy_video()

  The subtract in this condition is reversed.  The ->length is the length
  of the buffer.  The ->bytesused is how many bytes we have copied thus
  far.  When the condition is reversed that means the result of the
  subtraction is always negative but since it's unsigned then the result
  is a very high positive value.  That means the overflow check is never
  true.

  Additionally, the ->bytesused doesn't actually work for this purpose
  because we're not writing to "buf->mem + buf->bytesused".  Instead, the
  math to calculate the destination where we are writing is a bit
  involved.  You calculate the number of full lines already written,
  multiply by two, skip a line if necessary so that we start on an odd
  numbered line, and add the offset into the line.

  To fix this buffer overflow, just take the actual destination where we
  are writing, if the offset is already out of bounds print an error and
  return.  Otherwise, write up to buf->length bytes.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:09:18Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/7532bcec0797adfa08791301c3bcae14141db3bd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a08492832cc4cacc24e0612f483c86ca899b9261
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a16775828aaed1c54ff4e6fe83e8e4d5c6a50cb7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b504518a397059e1d55c521ba0ea2b545a6c4b52
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d410017a7181cb55e4a5c810b32b75e4416c6808
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ecf4ddc3aee8ade504c4d36b7b4053ce6093e200
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6a392266276730bea893b55d12940e32a25f56a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/faa4364bef2ec0060de381ff028d1d836600a381
    reference_type:
    reference_id:
