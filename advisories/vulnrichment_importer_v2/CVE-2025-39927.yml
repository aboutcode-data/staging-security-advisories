advisory_id: CVE-2025-39927
datasource_id: vulnrichment_importer_v2/CVE-2025-39927
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/39xxx/CVE-2025-39927.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ceph: fix race condition validating r_parent before applying state

  Add validation to ensure the cached parent directory inode matches the
  directory info in MDS replies. This prevents client-side race conditions
  where concurrent operations (e.g. rename) cause r_parent to become stale
  between request initiation and reply processing, which could lead to
  applying state changes to incorrect directory inodes.

  [ idryomov: folded a kerneldoc fixup and a follow-up fix from Alex to
    move CEPH_CAP_PIN reference when r_parent is updated:

    When the parent directory lock is not held, req->r_parent can become
    stale and is updated to point to the correct inode.  However, the
    associated CEPH_CAP_PIN reference was not being adjusted.  The
    CEPH_CAP_PIN is a reference on an inode that is tracked for
    accounting purposes.  Moving this pin is important to keep the
    accounting balanced. When the pin was not moved from the old parent
    to the new one, it created two problems: The reference on the old,
    stale parent was never released, causing a reference leak.
    A reference for the new parent was never acquired, creating the risk
    of a reference underflow later in ceph_mdsc_release_request().  This
    patch corrects the logic by releasing the pin from the old parent and
    acquiring it for the new parent when r_parent is switched.  This
    ensures reference accounting stays balanced. ]
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2026-01-14T17:39:17Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/15f519e9f883b316d86e2bb6b767a023aafd9d83
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2bfe45987eb346e299d9f763f9cd05f77011519f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db378e6f83ec705c6091c65d482d555edc2b0a72
    reference_type:
    reference_id:
