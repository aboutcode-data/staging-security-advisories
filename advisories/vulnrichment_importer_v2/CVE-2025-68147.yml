advisory_id: CVE-2025-68147
datasource_id: vulnrichment_importer_v2/CVE-2025-68147
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/68xxx/CVE-2025-68147.json
aliases: []
summary: Open Source Point of Sale (opensourcepos) is a web based point of sale application
  written in PHP using CodeIgniter framework. Starting in version 3.4.0 and prior to version
  3.4.2, a Stored Cross-Site Scripting (XSS) vulnerability exists in the "Return Policy" configuration
  field. The application does not properly sanitize user input before saving it to the database
  or displaying it on receipts. An attacker with access to the "Store Configuration" (such as
  a rogue administrator or an account compromised via the separate CSRF vulnerability) can inject
  malicious JavaScript payloads into this field. These payloads are executed in the browser
  of any user (including other administrators and sales staff) whenever they view a receipt
  or complete a transaction. This can lead to session hijacking, theft of sensitive data, or
  unauthorized actions performed on behalf of the victim. The vulnerability has been patched
  in version 3.4.2 by ensuring the output is escaped using the `esc()` function in the receipt
  template. As a temporary mitigation, administrators should ensure the "Return Policy" field
  contains only plain text and strictly avoid entering any HTML tags. There is no code-based
  workaround other than applying the patch.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-12-18T14:53:11Z/
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/Nixon-H/CVE-2025-68147-OSPOS-Stored-XSS
    reference_type:
    reference_id:
  - url: https://github.com/opensourcepos/opensourcepos/commit/22297a
    reference_type:
    reference_id:
  - url: https://github.com/opensourcepos/opensourcepos/security/advisories/GHSA-xgr7-7pvw-fpmh
    reference_type:
    reference_id:
