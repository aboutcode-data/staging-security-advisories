advisory_id: CVE-2021-47110
datasource_id: vulnrichment_importer_v2/CVE-2021-47110
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47110.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/kvm: Disable kvmclock on all CPUs on shutdown

  Currenly, we disable kvmclock from machine_shutdown() hook and this
  only happens for boot CPU. We need to disable it for all CPUs to
  guard against memory corruption e.g. on restore from hibernate.

  Note, writing '0' to kvmclock MSR doesn't clear memory location, it
  just prevents hypervisor from updating the location so for the short
  while after write and while CPU is still alive, the clock remains usable
  and correct so we don't need to switch to some other clocksource.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-03-18T16:10:03Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1df2dc09926f61319116c80ee85701df33577d70
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3b0becf8b1ecf642a9edaf4c9628ffc641e490d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9084fe1b3572664ad276f427dce575f580c9799a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c02027b5742b5aa804ef08a4a9db433295533046
    reference_type:
    reference_id:
