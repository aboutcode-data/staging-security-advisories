advisory_id: CVE-2024-57946
datasource_id: vulnrichment_importer_v2/CVE-2024-57946
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/57xxx/CVE-2024-57946.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  virtio-blk: don't keep queue frozen during system suspend

  Commit 4ce6e2db00de ("virtio-blk: Ensure no requests in virtqueues before
  deleting vqs.") replaces queue quiesce with queue freeze in virtio-blk's
  PM callbacks. And the motivation is to drain inflight IOs before suspending.

  block layer's queue freeze looks very handy, but it is also easy to cause
  deadlock, such as, any attempt to call into bio_queue_enter() may run into
  deadlock if the queue is frozen in current context. There are all kinds
  of ->suspend() called in suspend context, so keeping queue frozen in the
  whole suspend context isn't one good idea. And Marek reported lockdep
  warning[1] caused by virtio-blk's freeze queue in virtblk_freeze().

  [1] https://lore.kernel.org/linux-block/ca16370e-d646-4eee-b9cc-87277c89c43c@samsung.com/

  Given the motivation is to drain in-flight IOs, it can be done by calling
  freeze & unfreeze, meantime restore to previous behavior by keeping queue
  quiesced during suspend.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T19:52:30Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/12c0ddd6c551c1e438b087f874b4f1223a75f7ea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6dea8e3de59928974bf157dd0499d3958d744ae4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7678abee0867e6b7fb89aa40f6e9f575f755fb37
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/92d5139b91147ab372a17daf5dc27a5b9278e516
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ca428c6397abaa8c38f5c69133a2299e1efbbf2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e323f856cf4963120e0e3892a84ef8bd764a0e4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d738f3215bb4f88911ff4579780a44960c8e0ca5
    reference_type:
    reference_id:
