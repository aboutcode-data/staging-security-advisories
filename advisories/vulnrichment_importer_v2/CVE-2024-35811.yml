advisory_id: CVE-2024-35811
datasource_id: vulnrichment_importer_v2/CVE-2024-35811
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/35xxx/CVE-2024-35811.json
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: brcmfmac:\
  \ Fix use-after-free bug in brcmf_cfg80211_detach\n\nThis is the candidate patch of CVE-2023-47233\
  \ :\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-47233\n\nIn brcm80211 driver,it starts with\
  \ the following invoking chain\nto start init a timeout worker:\n\n->brcmf_usb_probe\n  ->brcmf_usb_probe_cb\n\
  \    ->brcmf_attach\n      ->brcmf_bus_started\n        ->brcmf_cfg80211_attach\n        \
  \  ->wl_init_priv\n            ->brcmf_init_escan\n              ->INIT_WORK(&cfg->escan_timeout_work,\n\
  \t\t  brcmf_cfg80211_escan_timeout_worker);\n\nIf we disconnect the USB by hotplug, it will\
  \ call\nbrcmf_usb_disconnect to make cleanup. The invoking chain is :\n\nbrcmf_usb_disconnect\n\
  \  ->brcmf_usb_disconnect_cb\n    ->brcmf_detach\n      ->brcmf_cfg80211_detach\n        ->kfree(cfg);\n\
  \nWhile the timeout woker may still be running. This will cause\na use-after-free bug on cfg\
  \ in brcmf_cfg80211_escan_timeout_worker.\n\nFix it by deleting the timer and canceling the\
  \ worker in\nbrcmf_cfg80211_detach.\n\n[arend.vanspriel@broadcom.com: keep timer delete as\
  \ is and cancel work just before free]"
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T15:42:35Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0a7591e14a8da794d0b93b5d1c6254ccb23adacb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0b812f706fd7090be74812101114a0e165b36744
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0f7352557a35ab7888bc7831411ec8a3cbe20d78
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/190794848e2b9d15de92d502b6ac652806904f5a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/202c503935042272e2f9e1bb549d5f69a8681169
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6678a1e7d896c00030b31491690e8ddc9a90767a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8c36205123dc57349b59b4f1a2301eb278cbc731
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8e3f03f4ef7c36091f46e7349096efb5a2cdb3a1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bacb8c3ab86dcd760c15903fcee58169bc3026aa
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html
    reference_type:
    reference_id:
