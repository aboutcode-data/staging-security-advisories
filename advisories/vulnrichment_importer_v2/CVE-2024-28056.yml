advisory_id: CVE-2024-28056
datasource_id: vulnrichment_importer_v2/CVE-2024-28056
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/28xxx/CVE-2024-28056.json
aliases: []
summary: 'Amazon AWS Amplify CLI before 12.10.1 incorrectly configures the role trust policy
  of IAM roles associated with Amplify projects. When the Authentication component is removed
  from an Amplify project, a Condition property is removed but "Effect":"Allow" remains present,
  and consequently sts:AssumeRoleWithWebIdentity would be available to threat actors with no
  conditions. Thus, if Amplify CLI had been used to remove the Authentication component from
  a project built between August 2019 and January 2024, an "assume role" may have occurred,
  and may have been leveraged to obtain unauthorized access to an organization''s AWS resources.
  NOTE: the problem could only occur if an authorized AWS user removed an Authentication component.
  (The vulnerability did not give a threat actor the ability to remove an Authentication component.)
  However, in realistic situations, an authorized AWS user may have removed an Authentication
  component, e.g., if the objective were to stop using built-in Cognito resources, or move to
  a completely different identity provider.'
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-06-18T18:02:47Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://aws.amazon.com/security/security-bulletins/AWS-2024-003/
    reference_type:
    reference_id:
  - url: https://github.com/aws-amplify/amplify-cli/blob/8ad57bf99a404f3c92547c8a175458016f682fac/packages/amplify-provider-awscloudformation/resources/update-idp-roles-cfn.json
    reference_type:
    reference_id:
  - url: https://github.com/aws-amplify/amplify-cli/commit/73b08dc424db2fb60399c5343c314e02e849d4a1
    reference_type:
    reference_id:
  - url: https://github.com/aws-amplify/amplify-cli/releases/tag/v12.10.1
    reference_type:
    reference_id:
  - url: https://securitylabs.datadoghq.com/articles/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover/
    reference_type:
    reference_id:
