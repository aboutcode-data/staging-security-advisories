advisory_id: CVE-2025-54472
datasource_id: vulnrichment_importer_v2/CVE-2025-54472
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/54xxx/CVE-2025-54472.json
aliases: []
summary: |
  Unlimited memory allocation in redis protocol parser in Apache bRPC (all versions < 1.14.1) on all platforms allows attackers to crash the service via network.



  Root Cause: In the bRPC Redis protocol parser code, memory for arrays or strings of corresponding sizes is allocated based on the integers read from the network. If the integer read from the network is too large, it may cause a bad alloc error and lead to the program crashing. Attackers can exploit this feature by sending special data packets to the bRPC service to carry out a denial-of-service attack on it.
  The bRPC 1.14.0 version tried to fix this issue by limited the memory allocation size, however, the limitation checking code is not well implemented that may cause integer overflow and evade such limitation. So the 1.14.0 version is also vulnerable, although the integer range that affect version 1.14.0 is different from that affect version < 1.14.0.



  Affected scenarios: Using bRPC as a Redis server to provide network services to untrusted clients, or using bRPC as a Redis client to call untrusted Redis services.



  How to Fix: we provide two methods, you can choose one of them:

  1. Upgrade bRPC to version 1.14.1.
  2. Apply this patch ( https://github.com/apache/brpc/pull/3050 ) manually.

  No matter you choose which method, you should note that the patch limits the maximum length of memory allocated for each time in the bRPC Redis parser. The default limit is 64M. If some of you redis request or response have a size larger than 64M, you might encounter error after upgrade. For such case, you can modify the gflag redis_max_allocation_size to set a larger limit.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-08-14T13:37:18Z/
    published_at: None
    url:
weaknesses:
  - CWE-190
  - CWE-400
references:
  - url: https://lists.apache.org/thread/r3xsy3wvs4kmfhc281173k5b6ll1xt2m
    reference_type:
    reference_id:
