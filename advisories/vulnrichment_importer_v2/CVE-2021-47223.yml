advisory_id: CVE-2021-47223
datasource_id: vulnrichment_importer_v2/CVE-2021-47223
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47223.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: bridge: fix vlan tunnel dst null pointer dereference

  This patch fixes a tunnel_dst null pointer dereference due to lockless
  access in the tunnel egress path. When deleting a vlan tunnel the
  tunnel_dst pointer is set to NULL without waiting a grace period (i.e.
  while it's still usable) and packets egressing are dereferencing it
  without checking. Use READ/WRITE_ONCE to annotate the lockless use of
  tunnel_id, use RCU for accessing tunnel_dst and make sure it is read
  only once and checked in the egress path. The dst is already properly RCU
  protected so we don't need to do anything fancy than to make sure
  tunnel_id and tunnel_dst are read only once and checked in the egress path.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-23T18:10:14Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/24a6e55f17aa123bc1fc54b7d3c410b41bc16530
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/58e2071742e38f29f051b709a5cca014ba51166f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a2241e62f6b4a774d8a92048fdf59c45f6c2fe5c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/abb02e05cb1c0a30dd873a29f33bc092067dc35d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ad7feefe7164892db424c45687472db803d87f79
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fe0448a3fad365a747283a00a1d1ad5e8d6675b7
    reference_type:
    reference_id:
