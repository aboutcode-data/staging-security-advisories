advisory_id: CVE-2024-46852
datasource_id: vulnrichment_importer_v2/CVE-2024-46852
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/46xxx/CVE-2024-46852.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dma-buf: heaps: Fix off-by-one in CMA heap fault handler

  Until VM_DONTEXPAND was added in commit 1c1914d6e8c6 ("dma-buf: heaps:
  Don't track CMA dma-buf pages under RssFile") it was possible to obtain
  a mapping larger than the buffer size via mremap and bypass the overflow
  check in dma_buf_mmap_internal. When using such a mapping to attempt to
  fault past the end of the buffer, the CMA heap fault handler also checks
  the fault offset against the buffer size, but gets the boundary wrong by
  1. Fix the boundary check so that we don't read off the end of the pages
  array and insert an arbitrary page in the mapping.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-29T13:58:24Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/79cce5e81d20fa9ad553be439d665ac3302d3c95
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/84175dc5b2c932266a50c04e5ce342c30f817a2f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e79050882b857c37634baedbdcf7c2047c24cbff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ea5ff5d351b520524019f7ff7f9ce418de2dad87
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eb7fc8b65cea22f9038c52398c8b22849e9620ea
    reference_type:
    reference_id:
