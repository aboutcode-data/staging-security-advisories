advisory_id: CVE-2024-36971
datasource_id: vulnrichment_importer_v2/CVE-2024-36971
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/36xxx/CVE-2024-36971.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: fix __dst_negative_advice() race

  __dst_negative_advice() does not enforce proper RCU rules when
  sk->dst_cache must be cleared, leading to possible UAF.

  RCU rules are that we must first clear sk->sk_dst_cache,
  then call dst_release(old_dst).

  Note that sk_dst_reset(sk) is implementing this protocol correctly,
  while __dst_negative_advice() uses the wrong order.

  Given that ip6_negative_advice() has special logic
  against RTF_CACHE, this means each of the three ->negative_advice()
  existing methods must perform the sk_dst_reset() themselves.

  Note the check against NULL dst is centralized in
  __dst_negative_advice(), there is no need to duplicate
  it in various callbacks.

  Many thanks to Clement Lecigne for tracking this issue.

  This old bug became visible after the blamed commit, using UDP sockets.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Attend
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:N/T:T/P:M/B:A/M:M/D:A/2024-08-08T03:55:25Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/051c0bde9f0450a2ec3d62a86d2a0d2fad117f13
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2295a7ef5c8c49241bff769e7826ef2582e532a6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5af198c387128a9d2ddd620b0f0803564a4d4508
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/81dd3c82a456b0015461754be7cb2693991421b4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/92f1655aa2b2294d0b49925f3b875a634bd3b59e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b8af8e6118a6605f0e495a58d591ca94a85a50fc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db0082825037794c5dba9959c9de13ca34cc5e72
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eacb8b195579c174a6d3e12a9690b206eb7f28cf
    reference_type:
    reference_id:
