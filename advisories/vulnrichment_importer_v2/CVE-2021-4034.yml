advisory_id: CVE-2021-4034
datasource_id: vulnrichment_importer_v2/CVE-2021-4034
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/4xxx/CVE-2021-4034.json
aliases: []
summary: A local privilege escalation vulnerability was found on polkit's pkexec utility. The
  pkexec application is a setuid tool designed to allow unprivileged users to run commands as
  privileged users according predefined policies. The current version of pkexec doesn't handle
  the calling parameters count correctly and ends trying to execute environment variables as
  commands. An attacker can leverage this by crafting environment variables in such a way it'll
  induce pkexec to execute arbitrary code. When successfully executed the attack can cause a
  local privilege escalation given unprivileged users administrative rights on the target machine.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Attend
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:N/T:T/P:M/B:A/M:M/D:A/2024-11-04T14:58:14Z/
    published_at: None
    url:
weaknesses:
  - CWE-787
references:
  - url: https://access.redhat.com/security/vulnerabilities/RHSB-2022-001
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuapr2022.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2025869
    reference_type: bug
    reference_id: 2025869
  - url: https://gitlab.freedesktop.org/polkit/polkit/-/commit/a2bf5c9c83b6ae46cbd5c779d3055bff81ded683
    reference_type: other
    reference_id: a2bf5c9c83b6ae46cbd5c779d3055bff81ded683
  - url: https://www.suse.com/support/kb/doc/?id=000020564
    reference_type: other
    reference_id: ?id=000020564
  - url: https://www.secpod.com/blog/local-privilege-escalation-vulnerability-in-major-linux-distributions-cve-2021-4034/
    reference_type: other
    reference_id: local-privilege-escalation-vulnerability-in-major-linux-distributions-cve-2021-4034
  - url: http://packetstormsecurity.com/files/166196/Polkit-pkexec-Local-Privilege-Escalation.html
    reference_type: other
    reference_id: Polkit-pkexec-Local-Privilege-Escalation.html
  - url: http://packetstormsecurity.com/files/166200/Polkit-pkexec-Privilege-Escalation.html
    reference_type: other
    reference_id: Polkit-pkexec-Privilege-Escalation.html
  - url: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt
    reference_type: other
    reference_id: pwnkit.txt
  - url: https://cert-portal.siemens.com/productcert/pdf/ssa-330556.pdf
    reference_type: other
    reference_id: ssa-330556.pdf
  - url: https://www.starwindsoftware.com/security/sw-20220818-0001/
    reference_type: other
    reference_id: sw-20220818-0001
