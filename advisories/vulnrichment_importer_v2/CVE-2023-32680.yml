advisory_id: CVE-2023-32680
datasource_id: vulnrichment_importer_v2/CVE-2023-32680
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/32xxx/CVE-2023-32680.json
aliases: []
summary: 'Metabase is an open source business analytics engine. To edit SQL Snippets, Metabase
  should have required people to be in at least one group with native query editing permissions
  to a database–but affected versions of Metabase didn''t enforce that requirement. This lack
  of enforcement meant that: Anyone–including people in sandboxed groups–could edit SQL snippets.
  They could edit snippets via the API or, in the application UI, when editing the metadata
  for a model based on a SQL question, and people in sandboxed groups could edit a SQL snippet
  used in a query that creates their sandbox. If the snippet contained logic that restricted
  which data that person could see, they could potentially edit that snippet and change their
  level of data access. The permissions model for SQL snippets has been fixed in Metabase versions
  0.46.3, 0.45.4, 0.44.7, 1.46.3, 1.45.4, and 1.44.7. Users are advised to upgrade. Users unable
  to upgrade should ensure that SQL queries used to create sandboxes exclude SQL snippets.'
impacted_packages: []
severities:
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-21T19:09:31Z/
    published_at: None
    url:
weaknesses:
  - CWE-306
references:
  - url: https://github.com/metabase/metabase/pull/30852
    reference_type:
    reference_id:
  - url: https://github.com/metabase/metabase/pull/30853
    reference_type:
    reference_id:
  - url: https://github.com/metabase/metabase/pull/30854
    reference_type:
    reference_id:
  - url: https://github.com/metabase/metabase/security/advisories/GHSA-mw6j-f894-4qxv
    reference_type:
    reference_id:
