advisory_id: CVE-2024-56740
datasource_id: vulnrichment_importer_v2/CVE-2024-56740
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/56xxx/CVE-2024-56740.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nfs/localio: must clear res.replen in nfs_local_read_done

  Otherwise memory corruption can occur due to NFSv3 LOCALIO reads
  leaving garbage in res.replen:
  - nfs3_read_done() copies that into server->read_hdrsize; from there
    nfs3_proc_read_setup() copies it to args.replen in new requests.
  - nfs3_xdr_enc_read3args() passes that to rpc_prepare_reply_pages()
    which includes it in hdrsize for xdr_init_pages, so that rq_rcv_buf
    contains a ridiculous len.
  - This is copied to rq_private_buf and xs_read_stream_request()
    eventually passes the kvec to sock_recvmsg() which receives incoming
    data into entirely the wrong place.

  This is easily reproduced with NFSv3 LOCALIO that is servicing reads
  when it is made to pivot back to using normal RPC.  This switch back
  to using normal NFSv3 with RPC can occur for a few reasons but this
  issue was exposed with a test that stops and then restarts the NFSv3
  server while LOCALIO is performing heavy read IO.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-10-01T19:57:38Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/650703bc4ed3edf841e851c99ab8e7ba9e5262a3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/de5dac261eeab99762bbdf7c20cee5d26ef4462e
    reference_type:
    reference_id:
