advisory_id: CVE-2024-35225
datasource_id: vulnrichment_importer_v2/CVE-2024-35225
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/35xxx/CVE-2024-35225.json
aliases: []
summary: Jupyter Server Proxy allows users to run arbitrary external processes alongside their
  notebook server and provide authenticated web access to them. Versions of 3.x prior to 3.2.4
  and 4.x prior to 4.2.0 have a reflected cross-site scripting (XSS) issue. The `/proxy` endpoint
  accepts a `host` path segment in the format `/proxy/<host>`. When this endpoint is called
  with an invalid `host` value, `jupyter-server-proxy` replies with a response that includes
  the value of `host`, without sanitization [2]. A third-party actor can leverage this by sending
  a phishing link with an invalid `host` value containing custom JavaScript to a user. When
  the user clicks this phishing link, the browser renders the response of `GET /proxy/<host>`,
  which runs the custom JavaScript contained in `host` set by the actor. As any arbitrary JavaScript
  can be run after the user clicks on a phishing link, this issue permits extensive access to
  the user's JupyterLab instance for an actor. Patches are included in versions 4.2.0 and 3.2.4.
  As a workaround, server operators who are unable to upgrade can disable the `jupyter-server-proxy`
  extension.
impacted_packages: []
severities:
  - score: '9.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-06-12T13:21:20Z/
    published_at: None
    url:
weaknesses:
  - CWE-116
  - CWE-79
references:
  - url: https://github.com/jupyterhub/jupyter-server-proxy/blob/62a290f08750f7ae55a0c29ca339c9a39a7b2a7b/jupyter_server_proxy/handlers.py#L328
    reference_type:
    reference_id:
  - url: https://github.com/jupyterhub/jupyter-server-proxy/commit/7abc9dc5bbb0b4b440548a5375261b8b8192fc22
    reference_type:
    reference_id:
  - url: https://github.com/jupyterhub/jupyter-server-proxy/commit/ff78128087e73fb9d0909e1366f8bf051e8ea878
    reference_type:
    reference_id:
  - url: https://github.com/jupyterhub/jupyter-server-proxy/security/advisories/GHSA-fvcq-4x64-hqxr
    reference_type:
    reference_id:
