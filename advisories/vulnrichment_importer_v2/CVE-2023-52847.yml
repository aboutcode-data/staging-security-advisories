advisory_id: CVE-2023-52847
datasource_id: vulnrichment_importer_v2/CVE-2023-52847
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/52xxx/CVE-2023-52847.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  media: bttv: fix use after free error due to btv->timeout timer

  There may be some a race condition between timer function
  bttv_irq_timeout and bttv_remove. The timer is setup in
  probe and there is no timer_delete operation in remove
  function. When it hit kfree btv, the function might still be
  invoked, which will cause use after free bug.

  This bug is found by static analysis, it may be false positive.

  Fix it by adding del_timer_sync invoking to the remove function.

  cpu0                cpu1
                    bttv_probe
                      ->timer_setup
                        ->bttv_set_dma
                          ->mod_timer;
  bttv_remove
    ->kfree(btv);
                    ->bttv_irq_timeout
                      ->USE btv
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-10T19:17:00Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1871014d6ef4812ad11ef7d838d73ce09d632267
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/20568d06f6069cb835e05eed432edf962645d226
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2f3d9198cdae1cb079ec8652f4defacd481eab2b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/51c94256a83fe4e17406c66ff3e1ad7d242d8574
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/847599fffa528b2cdec4e21b6bf7586dad982132
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b35fdade92c5058a5e727e233fe263b828de2c9a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bbc3b8dd2cb7817e703f112d988e4f4728f0f2a9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bd5b50b329e850d467e7bcc07b2b6bde3752fbda
    reference_type:
    reference_id:
