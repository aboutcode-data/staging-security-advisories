advisory_id: CVE-2024-28866
datasource_id: vulnrichment_importer_v2/CVE-2024-28866
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/28xxx/CVE-2024-28866.json
aliases: []
summary: |
  GoCD is a continuous delivery server. GoCD versions from 19.4.0 to 23.5.0 (inclusive) are potentially vulnerable to a reflected cross-site scripting vulnerability on the loading page displayed while GoCD is starting, via abuse of a `redirect_to` query parameter with inadequate validation.

  Attackers could theoretically abuse the query parameter to steal session tokens or other values from the user's browser. In practice exploiting this to perform privileged actions is likely rather difficult to exploit because the target user would need to be triggered to open an attacker-crafted link in the period where the server is starting up (but not completely started), requiring chaining with a separate denial-of-service vulnerability. Additionally, GoCD server restarts invalidate earlier session tokens (i.e GoCD does not support persistent sessions), so a stolen session token would be unusable once the server has completed restart, and executed XSS would be done within a logged-out context.

  The issue is fixed in GoCD 24.1.0. As a workaround, it is technically possible in earlier GoCD versions to override the loading page with an earlier version which is not vulnerable, by starting GoCD with the Java system property override as either `-Dloading.page.resource.path=/loading_pages/default.loading.page.html` (simpler early version of loading page without GoCD introduction) or `-Dloading.page.resource.path=/does_not_exist.html` (to display a simple message with no interactivity).
impacted_packages: []
severities:
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-13T17:15:21Z/
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402
    reference_type:
    reference_id:
  - url: https://github.com/gocd/gocd/releases/tag/24.1.0
    reference_type:
    reference_id:
  - url: https://github.com/gocd/gocd/security/advisories/GHSA-q882-q6mm-mgvh
    reference_type:
    reference_id:
  - url: https://www.gocd.org/releases/#24-1-0
    reference_type:
    reference_id:
