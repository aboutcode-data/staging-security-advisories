advisory_id: CVE-2022-24897
datasource_id: vulnrichment_importer_v2/CVE-2022-24897
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/24xxx/CVE-2022-24897.json
aliases: []
summary: APIs to evaluate content with Velocity is a package for APIs to evaluate content with
  Velocity. Starting with version 2.3 and prior to 12.6.7, 12.10.3, and 13.0, the velocity scripts
  are not properly sandboxed against using the Java File API to perform read or write operations
  on the filesystem. Writing an attacking script in Velocity requires the Script rights in XWiki
  so not all users can use it, and it also requires finding an XWiki API which returns a File.
  The problem has been patched in versions 12.6.7, 12.10.3, and 13.0. There is no easy workaround
  for fixing this vulnerability other than upgrading and being careful when giving Script rights.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-04-22T15:43:18Z/
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/xwiki/xwiki-commons/commit/215951cfb0f808d0bf5b1097c9e7d1e503449ab8
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-commons/pull/127
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-commons/security/advisories/GHSA-cvx5-m8vg-vxgc
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-5168
    reference_type:
    reference_id:
