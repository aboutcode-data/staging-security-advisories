advisory_id: CVE-2024-49937
datasource_id: vulnrichment_importer_v2/CVE-2024-49937
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/49xxx/CVE-2024-49937.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: cfg80211: Set correct chandef when starting CAC

  When starting CAC in a mode other than AP mode, it return a
  "WARNING: CPU: 0 PID: 63 at cfg80211_chandef_dfs_usable+0x20/0xaf [cfg80211]"
  caused by the chandef.chan being null at the end of CAC.

  Solution: Ensure the channel definition is set for the different modes
  when starting CAC to avoid getting a NULL 'chan' at the end of CAC.

   Call Trace:
    ? show_regs.part.0+0x14/0x16
    ? __warn+0x67/0xc0
    ? cfg80211_chandef_dfs_usable+0x20/0xaf [cfg80211]
    ? report_bug+0xa7/0x130
    ? exc_overflow+0x30/0x30
    ? handle_bug+0x27/0x50
    ? exc_invalid_op+0x18/0x60
    ? handle_exception+0xf6/0xf6
    ? exc_overflow+0x30/0x30
    ? cfg80211_chandef_dfs_usable+0x20/0xaf [cfg80211]
    ? exc_overflow+0x30/0x30
    ? cfg80211_chandef_dfs_usable+0x20/0xaf [cfg80211]
    ? regulatory_propagate_dfs_state.cold+0x1b/0x4c [cfg80211]
    ? cfg80211_propagate_cac_done_wk+0x1a/0x30 [cfg80211]
    ? process_one_work+0x165/0x280
    ? worker_thread+0x120/0x3f0
    ? kthread+0xc2/0xf0
    ? process_one_work+0x280/0x280
    ? kthread_complete_and_exit+0x20/0x20
    ? ret_from_fork+0x19/0x24

  [shorten subject, remove OCB, reorder cases to match previous list]
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-22T13:38:15Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/04053e55dd50741cf6c59b9bbaa4238218c05c70
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/20361712880396e44ce80aaeec2d93d182035651
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95f32191e50b75e0f75fae1bb925cdf51d8df0a3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c628026563f4ea9e0413dd4b69429e4a1db240b1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f4dbfda159e43d49b43003cc3c2914751939035f
    reference_type:
    reference_id:
