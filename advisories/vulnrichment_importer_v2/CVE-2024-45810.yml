advisory_id: CVE-2024-45810
datasource_id: vulnrichment_importer_v2/CVE-2024-45810
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/45xxx/CVE-2024-45810.json
aliases: []
summary: Envoy is a cloud-native high-performance edge/middle/service proxy. Envoy will crash
  when the http async client is handling `sendLocalReply` under some circumstance, e.g., websocket
  upgrade, and requests mirroring. The http async client will crash during the `sendLocalReply()`
  in http async client, one reason is http async client is duplicating the status code, another
  one is the destroy of router is called at the destructor of the async stream, while the stream
  is deferred deleted at first. There will be problems that the stream decoder is destroyed
  but its reference is called in `router.onDestroy()`, causing segment fault. This will impact
  ext_authz if the `upgrade` and `connection` header are allowed, and request mirrorring. This
  issue has been addressed in versions 1.31.2, 1.30.6, 1.29.9, and 1.28.7. Users are advised
  to upgrade. There are no known workarounds for this vulnerability.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-20T17:17:32Z/
    published_at: None
    url:
weaknesses:
  - CWE-119
references:
  - url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-qm74-x36m-555q
    reference_type:
    reference_id:
