advisory_id: CVE-2024-35827
datasource_id: vulnrichment_importer_v2/CVE-2024-35827
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/35xxx/CVE-2024-35827.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  io_uring/net: fix overflow check in io_recvmsg_mshot_prep()

  The "controllen" variable is type size_t (unsigned long).  Casting it
  to int could lead to an integer underflow.

  The check_add_overflow() function considers the type of the destination
  which is type int.  If we add two positive values and the result cannot
  fit in an integer then that's counted as an overflow.

  However, if we cast "controllen" to an int and it turns negative, then
  negative values *can* fit into an int type so there is no overflow.

  Good: 100 + (unsigned long)-4 = 96  <-- overflow
   Bad: 100 + (int)-4 = 96 <-- no overflow

  I deleted the cast of the sizeof() as well.  That's not a bug but the
  cast is unnecessary.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-17T15:12:59Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0c8c74bb59e7d77554016efc34c2d10376985e5e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/59a534690ecc3af72c6ab121aeac1237a4adae66
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/868ec868616438df487b9e2baa5a99f8662cc47c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8ede3db5061bb1fe28e2c9683329aafa89d2b1b4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b6563ad0d599110bd5cf8f56c47d279c3ed796fe
    reference_type:
    reference_id:
