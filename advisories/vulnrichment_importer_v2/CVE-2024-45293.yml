advisory_id: CVE-2024-45293
datasource_id: vulnrichment_importer_v2/CVE-2024-45293
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/45xxx/CVE-2024-45293.json
aliases: []
summary: PHPSpreadsheet is a pure PHP library for reading and writing spreadsheet files. The
  security scanner responsible for preventing XXE attacks in the XLSX reader can be bypassed
  by slightly modifying the XML structure, utilizing white-spaces. On servers that allow users
  to upload their own Excel (XLSX) sheets, Server files and sensitive information can be disclosed
  by providing a crafted sheet. The security scan function in src/PhpSpreadsheet/Reader/Security/XmlScanner.php
  contains a flawed XML encoding check to retrieve the input file's XML encoding in the toUtf8
  function. The function searches for the XML encoding through a defined regex which looks for
  `encoding="*"` and/or `encoding='*'`, if not found, it defaults to the UTF-8 encoding which
  bypasses the conversion logic. This logic can be used to pass a UTF-7 encoded XXE payload,
  by utilizing a whitespace before or after the = in the attribute definition. Sensitive information
  disclosure through the XXE on sites that allow users to upload their own excel spreadsheets,
  and parse them using PHPSpreadsheet's Excel parser. This issue has been addressed in release
  versions 1.29.1, 2.1.1, and 2.3.0. All users are advised to upgrade. There are no known workarounds
  for this vulnerability.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2024-10-07T20:23:44Z/
    published_at: None
    url:
weaknesses:
  - CWE-611
references:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88
    reference_type:
    reference_id:
