advisory_id: CVE-2024-40971
datasource_id: vulnrichment_importer_v2/CVE-2024-40971
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/40xxx/CVE-2024-40971.json
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: remove\
  \ clear SB_INLINECRYPT flag in default_options\n\nIn f2fs_remount, SB_INLINECRYPT flag will\
  \ be clear and re-set.\nIf create new file or open file during this gap, these files\nwill\
  \ not use inlinecrypt. Worse case, it may lead to data\ncorruption if wrappedkey_v0 is enable.\n\
  \nThread A:                               Thread B:\n\n-f2fs_remount\t\t\t\t-f2fs_file_open\
  \ or f2fs_new_inode\n  -default_options\n\t<- clear SB_INLINECRYPT flag\n\n              \
  \                            -fscrypt_select_encryption_impl\n\n  -parse_options\n\t<- set\
  \ SB_INLINECRYPT again"
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:02:54Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/38a82c8d00638bb642bef787eb1d5e0e4d3b7d71
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/724429db09e21ee153fef35e34342279d33df6ae
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a9cea0489c562c97cd56bb345e78939f9909e7f4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac5eecf481c29942eb9a862e758c0c8b68090c33
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ae39c8ec4250d2a35ddaab1c40faacfec306ff66
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eddeb8d941d5be11a9da5637dbe81ac37e8449a2
    reference_type:
    reference_id:
