advisory_id: CVE-2024-43843
datasource_id: vulnrichment_importer_v2/CVE-2024-43843
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/43xxx/CVE-2024-43843.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  riscv, bpf: Fix out-of-bounds issue when preparing trampoline image

  We get the size of the trampoline image during the dry run phase and
  allocate memory based on that size. The allocated image will then be
  populated with instructions during the real patch phase. But after
  commit 26ef208c209a ("bpf: Use arch_bpf_trampoline_size"), the `im`
  argument is inconsistent in the dry run and real patch phase. This may
  cause emit_imm in RV64 to generate a different number of instructions
  when generating the 'im' address, potentially causing out-of-bounds
  issues. Let's emit the maximum number of instructions for the "im"
  address during dry run to fix this problem.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:07:49Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3e6a1b1b179abb643ec3560c02bc3082bc92285f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9f1e16fb1fc9826001c69e0551d51fbbcd2d74e9
    reference_type:
    reference_id:
