advisory_id: CVE-2025-46834
datasource_id: vulnrichment_importer_v2/CVE-2025-46834
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/46xxx/CVE-2025-46834.json
aliases: []
summary: Alchemy's Modular Account is a smart contract account that is compatible with ERC-4337
  and ERC-6900. In versions on the 2.x branch prior to commit 5e6f540d249afcaeaf76ab95517d0359fde883b0,
  owners of Modular Accounts can grant session keys (scoped external keys) to external parties
  and would use the allowlist module to restrict which external contracts can be accessed by
  the session key. There is a bug in the allowlist module in that we don't check for the `executeUserOp`
  -> `execute` or `executeBatch` path, effectively allowing any session key to bypass any access
  control restrictions set on the session key. Session keys are able to access ERC20 and ERC721
  token contracts amongst others, transferring all tokens from the account out andonfigure the
  permissions on external modules on session keys. They would be able to remove all restrictions
  set on themselves this way, or rotate the keys of other keys with higher privileges into keys
  that they control. Commit 5e6f540d249afcaeaf76ab95517d0359fde883b0 fixes this issue.
impacted_packages: []
severities:
  - score: '6.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-05-19T14:41:50Z/
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/alchemyplatform/modular-account/commit/5e6f540d249afcaeaf76ab95517d0359fde883b0
    reference_type:
    reference_id:
  - url: https://github.com/alchemyplatform/modular-account/security/advisories/GHSA-jhp7-7cq9-m4pv
    reference_type:
    reference_id:
