advisory_id: CVE-2024-54149
datasource_id: vulnrichment_importer_v2/CVE-2024-54149
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/54xxx/CVE-2024-54149.json
aliases: []
summary: 'Winter is a free, open-source content management system (CMS) based on the Laravel
  PHP framework. Winter CMS prior to versions 1.2.7, 1.1.11, and 1.0.476 allow users with access
  to the CMS templates sections that modify Twig files to bypass the sandbox placed on Twig
  files and modify resources such as theme customisation values or modify, or remove, templates
  in the theme even if not provided direct access via the permissions. As all objects passed
  through to Twig are references to the live objects, it is also possible to also manipulate
  model data if models are passed directly to Twig, including changing attributes or even removing
  records entirely. In most cases, this is unwanted behavior and potentially dangerous. To actively
  exploit this security issue, an attacker would need access to the Backend with a user account
  with any of the following permissions: `cms.manage_layouts`; `cms.manage_pages`; or `cms.manage_partials`.
  The Winter CMS maintainers strongly recommend that these permissions only be reserved to trusted
  administrators and developers in general. The maintainers of Winter CMS have significantly
  increased the scope of the sandbox, effectively making all models and datasources read-only
  in Twig, in versions 1.2.7, 1.1.11, and 1.0.476. Thse who cannot upgrade may apply commit
  fb88e6fabde3b3278ce1844e581c87dcf7daee22 to their Winter CMS installation manually to resolve
  the issue. In the rare event that a Winter user was relying on being able to write to models/datasources
  within their Twig templates, they should instead use or create components to make changes
  to their models.'
impacted_packages: []
severities:
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T16:11:07Z/
    published_at: None
    url:
weaknesses:
  - CWE-184
references:
  - url: https://github.com/wintercms/winter/commit/fb88e6fabde3b3278ce1844e581c87dcf7daee22
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/winter/security/advisories/GHSA-xhw3-4j3m-hq53
    reference_type:
    reference_id:
