advisory_id: CVE-2024-53866
datasource_id: vulnrichment_importer_v2/CVE-2024-53866
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/53xxx/CVE-2024-53866.json
aliases: []
summary: 'The package manager pnpm prior to version 9.15.0 seems to mishandle overrides and
  global cache: Overrides from one workspace leak into npm metadata saved in global cache; npm
  metadata from global cache affects other workspaces; and installs by default don''t revalidate
  the data (including on first lockfile generation). This can make workspace A (even running
  with `ignore-scripts=true`) posion global cache and execute scripts in workspace B. Users
  generally expect `ignore-scripts` to be sufficient to prevent immediate code execution on
  install (e.g. when the tree is just repacked/bundled without executing it). Here, that expectation
  is broken. Global state integrity is lost via operations that one would expect to be secure,
  enabling subsequently running arbitrary code execution on installs. Version 9.15.0 fixes the
  issue. As a work-around, use separate cache and store dirs in each workspace.'
impacted_packages: []
severities:
  - score: '5.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:P/PR:N/UI:P/VC:N/VI:L/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-12-11T17:11:58Z/
    published_at: None
    url:
weaknesses:
  - CWE-426
references:
  - url: https://github.com/pnpm/pnpm/commit/11afcddea48f25ed5117a87dc1780a55222b9743
    reference_type:
    reference_id:
  - url: https://github.com/pnpm/pnpm/security/advisories/GHSA-vm32-9rqf-rh3r
    reference_type:
    reference_id:
