advisory_id: CVE-2024-22423
datasource_id: vulnrichment_importer_v2/CVE-2024-22423
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/22xxx/CVE-2024-22423.json
aliases: []
summary: yt-dlp is a youtube-dl fork with additional features and fixes. The patch that addressed
  CVE-2023-40581 attempted to prevent RCE when using `--exec` with `%q` by replacing double
  quotes with two double quotes. However, this escaping is not sufficient, and still allows
  expansion of environment variables. Support for output template expansion in `--exec`, along
  with this vulnerable behavior, was added to `yt-dlp` in version 2021.04.11. yt-dlp version
  2024.04.09 fixes this issue by properly escaping `%`. It replaces them with `%%cd:~,%`, a
  variable that expands to nothing, leaving only the leading percent. It is recommended to upgrade
  yt-dlp to version 2024.04.09 as soon as possible. Also, always be careful when using `--exec`,
  because while this specific vulnerability has been patched, using unvalidated input in shell
  commands is inherently dangerous. For Windows users who are not able to upgrade, avoid using
  any output template expansion in `--exec` other than `{}` (filepath); if expansion in `--exec`
  is needed, verify the fields you are using do not contain `"`, `|` or `&`; and/or instead
  of using `--exec`, write the info json and load the fields from it instead.
impacted_packages: []
severities:
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-04-10T19:34:51Z/
    published_at: None
    url:
weaknesses:
  - CWE-78
references:
  - url: https://github.com/yt-dlp/yt-dlp/commit/de015e930747165dbb8fcd360f8775fd973b7d6e
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/commit/ff07792676f404ffff6ee61b5638c9dc1a33a37a
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/releases/tag/2021.04.11
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/releases/tag/2024.04.09
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-42h4-v29r-42qg
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-hjq6-52gw-2g7p
    reference_type:
    reference_id:
  - url: https://www.kb.cert.org/vuls/id/123335
    reference_type:
    reference_id:
