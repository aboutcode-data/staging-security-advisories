advisory_id: CVE-2023-27490
datasource_id: vulnrichment_importer_v2/CVE-2023-27490
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/27xxx/CVE-2023-27490.json
aliases: []
summary: NextAuth.js is an open source authentication solution for Next.js applications. `next-auth`
  applications using OAuth provider versions before `v4.20.1` have been found to be subject
  to an authentication vulnerability. A bad actor who can read traffic on the victim's network
  or who is able to social engineer the victim to click a manipulated login link could intercept
  and tamper with the authorization URL to **log in as the victim**, bypassing the CSRF protection.
  This is due to a partial failure during a compromised OAuth session where a session code is
  erroneously generated. This issue has been addressed in version 4.20.1. Users are advised
  to upgrade. Users unable to upgrade may using Advanced Initialization, manually check the
  callback request for state, pkce, and nonce against the provider configuration to prevent
  this issue. See the linked GHSA for details.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-02-25T14:29:38Z/
    published_at: None
    url:
weaknesses:
  - CWE-352
  - CWE-384
references:
  - url: https://authjs.dev/reference/core/providers#checks
    reference_type:
    reference_id:
  - url: https://danielfett.de/2020/05/16/pkce-vs-nonce-equivalent-or-not/
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-7r7x-4c4q-c4qf
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/initialization#advanced-initialization
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/providers/oauth
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230420-0006/
    reference_type:
    reference_id:
  - url: https://www.rfc-editor.org/rfc/rfc6749#section-10.12
    reference_type:
    reference_id:
