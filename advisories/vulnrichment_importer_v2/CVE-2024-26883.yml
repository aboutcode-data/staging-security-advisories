advisory_id: CVE-2024-26883
datasource_id: vulnrichment_importer_v2/CVE-2024-26883
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/26xxx/CVE-2024-26883.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Fix stackmap overflow check on 32-bit arches

  The stackmap code relies on roundup_pow_of_two() to compute the number
  of hash buckets, and contains an overflow check by checking if the
  resulting value is 0. However, on 32-bit arches, the roundup code itself
  can overflow by doing a 32-bit left-shift of an unsigned long value,
  which is undefined behaviour, so it is not guaranteed to truncate
  neatly. This was triggered by syzbot on the DEVMAP_HASH type, which
  contains the same check, copied from the hashtab code.

  The commit in the fixes tag actually attempted to fix this, but the fix
  did not account for the UB, so the fix only works on CPUs where an
  overflow does result in a neat truncation to zero, which is not
  guaranteed. Checking the value before rounding does not have this
  problem.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T15:48:22Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0971126c8164abe2004b8536b49690a0d6005b0a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/15641007df0f0d35fa28742b25c2a7db9dcd6895
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/21e5fa4688e1a4d3db6b72216231b24232f75c1d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/43f798b9036491fb014b55dd61c4c5c3193267d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7070b274c7866a4c5036f8d54fcaf315c64ac33a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7a4b21250bf79eef26543d35bd390448646c536b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca1f06e72dec41ae4f76e7b1a8a97265447b46ae
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d0e214acc59145ce25113f617311aa79dda39cb3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f06899582ccee09bd85d0696290e3eaca9aa042d
    reference_type:
    reference_id:
