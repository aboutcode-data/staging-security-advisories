advisory_id: CVE-2024-49856
datasource_id: vulnrichment_importer_v2/CVE-2024-49856
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/49xxx/CVE-2024-49856.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/sgx: Fix deadlock in SGX NUMA node search

  When the current node doesn't have an EPC section configured by firmware
  and all other EPC sections are used up, CPU can get stuck inside the
  while loop that looks for an available EPC page from remote nodes
  indefinitely, leading to a soft lockup. Note how nid_of_current will
  never be equal to nid in that while loop because nid_of_current is not
  set in sgx_numa_mask.

  Also worth mentioning is that it's perfectly fine for the firmware not
  to setup an EPC section on a node. While setting up an EPC section on
  each node can enhance performance, it is not a requirement for
  functionality.

  Rework the loop to start and end on *a* node that has SGX memory. This
  avoids the deadlock looking for the current SGX-lacking node to show up
  in the loop when it never will.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:56:17Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0f89fb4042c08fd143bfc28af08bf6c8a0197eea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/20c96d0aaabfe361fc2a11c173968dc67feadbbf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/40fb64257dab507d86b5f1f2a62f3669ef0c91a8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8132510c915815e6b537ab937d94ed66893bc7b8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9c936844010466535bd46ea4ce4656ef17653644
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fb2d057539eda67ec7cfc369bf587e6518a9b99d
    reference_type:
    reference_id:
