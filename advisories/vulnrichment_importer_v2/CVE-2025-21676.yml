advisory_id: CVE-2025-21676
datasource_id: vulnrichment_importer_v2/CVE-2025-21676
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/21xxx/CVE-2025-21676.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: fec: handle page_pool_dev_alloc_pages error

  The fec_enet_update_cbd function calls page_pool_dev_alloc_pages but did
  not handle the case when it returned NULL. There was a WARN_ON(!new_page)
  but it would still proceed to use the NULL pointer and then crash.

  This case does seem somewhat rare but when the system is under memory
  pressure it can happen. One case where I can duplicate this with some
  frequency is when writing over a smbd share to a SATA HDD attached to an
  imx6q.

  Setting /proc/sys/vm/min_free_kbytes to higher values also seems to solve
  the problem for my test case. But it still seems wrong that the fec driver
  ignores the memory allocation error and can crash.

  This commit handles the allocation error by dropping the current packet.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T19:51:57Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/001ba0902046cb6c352494df610718c0763e77a5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1425cb829556398f594658512d49292f988a2ab0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8a0097db0544b658c159ac787319737712063a23
    reference_type:
    reference_id:
