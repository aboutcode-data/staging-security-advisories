advisory_id: CVE-2024-4146
datasource_id: vulnrichment_importer_v2/CVE-2024-4146
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/4xxx/CVE-2024-4146.json
aliases: []
summary: In lunary-ai/lunary version v1.2.13, an incorrect authorization vulnerability exists
  that allows unauthorized users to access and manipulate projects within an organization they
  should not have access to. Specifically, the vulnerability is located in the `checkProjectAccess`
  method within the authorization middleware, which fails to adequately verify if a user has
  the correct permissions to access a specific project. Instead, it only checks if the user
  is part of the organization owning the project, overlooking the necessary check against the
  `account_project` table for explicit project access rights. This flaw enables attackers to
  gain complete control over all resources within a project, including the ability to create,
  update, read, and delete any resource, compromising the privacy and security of sensitive
  information.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-07-25T15:42:42Z/
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/lunary-ai/lunary/commit/c43b6c62035f32ca455f66d5fd22ba661648cde7
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/a749e696-b398-4260-b2d0-b0054b9fffa7
    reference_type:
    reference_id:
