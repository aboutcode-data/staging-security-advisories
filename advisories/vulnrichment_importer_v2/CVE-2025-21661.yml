advisory_id: CVE-2025-21661
datasource_id: vulnrichment_importer_v2/CVE-2025-21661
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/21xxx/CVE-2025-21661.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  gpio: virtuser: fix missing lookup table cleanups

  When a virtuser device is created via configfs and the probe fails due
  to an incorrect lookup table, the table is not removed. This prevents
  subsequent probe attempts from succeeding, even if the issue is
  corrected, unless the device is released. Additionally, cleanup is also
  needed in the less likely case of platform_device_register_full()
  failure.

  Besides, a consistent memory leak in lookup_table->dev_id was spotted
  using kmemleak by toggling the live state between 0 and 1 with a correct
  lookup table.

  Introduce gpio_virtuser_remove_lookup_table() as the counterpart to the
  existing gpio_virtuser_make_lookup_table() and call it from all
  necessary points to ensure proper cleanup.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T19:52:33Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/a619cba8c69c434258ff4101d463322cd63e1bdc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d72d0126b1f6981f6ce8b4247305f359958c11b5
    reference_type:
    reference_id:
