advisory_id: CVE-2022-39205
datasource_id: vulnrichment_importer_v2/CVE-2022-39205
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/39xxx/CVE-2022-39205.json
aliases: []
summary: Onedev is an open source, self-hosted Git Server with CI/CD and Kanban. In versions
  of Onedev prior to 7.3.0 unauthenticated users can take over a OneDev instance if there is
  no properly configured reverse proxy. The /git-prereceive-callback endpoint is used by the
  pre-receive git hook on the server to check for branch protections during a push event. It
  is only intended to be accessed from localhost, but the check relies on the X-Forwarded-For
  header. Invoking this endpoint leads to the execution of one of various git commands. The
  environment variables of this command execution can be controlled via query parameters. This
  allows attackers to write to arbitrary files, which can in turn lead to the execution of arbitrary
  code. Such an attack would be very hard to detect, which increases the potential impact even
  more. Users are advised to upgrade. There are no known workarounds for this issue.
impacted_packages: []
severities:
  - score: 9
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-04-22T15:41:36Z/
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://blog.sonarsource.com/onedev-remote-code-execution/
    reference_type:
    reference_id:
  - url: https://github.com/theonedev/onedev/commit/f1e97688e4e19d6de1dfa1d00e04655209d39f8e
    reference_type:
    reference_id:
  - url: https://github.com/theonedev/onedev/releases/tag/v7.3.0
    reference_type:
    reference_id:
  - url: https://github.com/theonedev/onedev/security/advisories/GHSA-4f9h-h82c-4xm2
    reference_type:
    reference_id:
