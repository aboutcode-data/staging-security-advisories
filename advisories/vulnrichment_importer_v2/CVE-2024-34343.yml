advisory_id: CVE-2024-34343
datasource_id: vulnrichment_importer_v2/CVE-2024-34343
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/34xxx/CVE-2024-34343.json
aliases: []
summary: 'Nuxt is a free and open-source framework to create full-stack web applications and
  websites with Vue.js. The `navigateTo` function attempts to blockthe `javascript:` protocol,
  but does not correctly use API''s provided by `unjs/ufo`. This library also contains parsing
  discrepancies.  The function first tests to see if the specified URL has a protocol. This
  uses the unjs/ufo package for URL parsing. This function works effectively, and returns true
  for a javascript: protocol. After this, the URL is parsed using the parseURL function. This
  function will refuse to parse poorly formatted URLs. Parsing javascript:alert(1) returns null/""
  for all values. Next, the protocol of the URL is then checked using the isScriptProtocol function.
  This function simply checks the input against a list of protocols, and does not perform any
  parsing. The combination of refusing to parse poorly formatted URLs, and not performing additional
  parsing means that script checks fail as no protocol can be found. Even if a protocol was
  identified, whitespace is not stripped in the parseURL implementation, bypassing the isScriptProtocol
  checks. Certain special protocols are identified at the top of parseURL. Inserting a newline
  or tab into this sequence will block the special protocol check, and bypass the latter checks.
  This ONLY has impact after SSR has occured, the `javascript:` protocol within a location header
  does not trigger XSS. This issue has been addressed in release version 3.12.4 and all users
  are advised to upgrade. There are no known workarounds for this vulnerability.'
impacted_packages: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-08-08T15:48:37Z/
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/nuxt/nuxt/security/advisories/GHSA-vf6r-87q4-2vjf
    reference_type:
    reference_id:
