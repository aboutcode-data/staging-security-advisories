advisory_id: CVE-2024-32962
datasource_id: vulnrichment_importer_v2/CVE-2024-32962
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/32xxx/CVE-2024-32962.json
aliases: []
summary: xml-crypto is an xml digital signature and encryption library for Node.js. In affected
  versions the default configuration does not check authorization of the signer, it only checks
  the validity of the signature per section 3.2.2 of the w3 xmldsig-core-20080610 spec. As such,
  without additional validation steps, the default configuration allows a malicious actor to
  re-sign an XML document, place the certificate in a `<KeyInfo />` element, and pass `xml-crypto`
  default validation checks. As a result `xml-crypto` trusts by default any certificate provided
  via digitally signed XML document's `<KeyInfo />`. `xml-crypto` prefers to use any certificate
  provided via digitally signed XML document's `<KeyInfo />` even if library was configured
  to use specific certificate (`publicCert`) for signature verification purposes.  An attacker
  can spoof signature verification by modifying XML document and replacing existing signature
  with signature generated with malicious private key (created by attacker) and by attaching
  that private key's certificate to `<KeyInfo />` element. This vulnerability is combination
  of changes introduced to `4.0.0` on pull request 301 / commit `c2b83f98` and has been addressed
  in version 6.0.0 with pull request 445 / commit `21201723d`. Users are advised to upgrade.
  Users unable to upgrade may either check the certificate extracted via `getCertFromKeyInfo`
  against trusted certificates before accepting the results of the validation or set `xml-crypto's
  getCertFromKeyInfo` to `() => undefined` forcing `xml-crypto` to use an explicitly configured
  `publicCert` or `privateKey` for signature verification.
impacted_packages: []
severities:
  - score: 10
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-07-19T15:03:41Z/
    published_at: None
    url:
weaknesses:
  - CWE-347
references:
  - url: https://github.com/node-saml/xml-crypto/commit/21201723d2ca9bc11288f62cf72552b7d659b000
    reference_type:
    reference_id:
  - url: https://github.com/node-saml/xml-crypto/commit/c2b83f984049edb68ad1d7c6ad0739ec92af11ca
    reference_type:
    reference_id:
  - url: https://github.com/node-saml/xml-crypto/pull/301
    reference_type:
    reference_id:
  - url: https://github.com/node-saml/xml-crypto/pull/445
    reference_type:
    reference_id:
  - url: https://github.com/node-saml/xml-crypto/security/advisories/GHSA-2xp3-57p7-qf4v
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240705-0003/
    reference_type:
    reference_id:
  - url: https://www.w3.org/TR/2008/REC-xmldsig-core-20080610/#sec-CoreValidation
    reference_type:
    reference_id:
