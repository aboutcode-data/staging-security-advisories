advisory_id: CVE-2024-49987
datasource_id: vulnrichment_importer_v2/CVE-2024-49987
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/49xxx/CVE-2024-49987.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpftool: Fix undefined behavior in qsort(NULL, 0, ...)

  When netfilter has no entry to display, qsort is called with
  qsort(NULL, 0, ...). This results in undefined behavior, as UBSan
  reports:

  net.c:827:2: runtime error: null pointer passed as argument 1, which is declared to never be null

  Although the C standard does not explicitly state whether calling qsort
  with a NULL pointer when the size is 0 constitutes undefined behavior,
  Section 7.1.4 of the C standard (Use of library functions) mentions:

  "Each of the following statements applies unless explicitly stated
  otherwise in the detailed descriptions that follow: If an argument to a
  function has an invalid value (such as a value outside the domain of
  the function, or a pointer outside the address space of the program, or
  a null pointer, or a pointer to non-modifiable storage when the
  corresponding parameter is not const-qualified) or a type (after
  promotion) not expected by a function with variable number of
  arguments, the behavior is undefined."

  To avoid this, add an early return when nf_link_info is NULL to prevent
  calling qsort with a NULL pointer.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-22T13:31:44Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2e0f6f33f2aa87493b365a38a8fd87b8854b7734
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c208b02827eb642758cef65641995fd3f38c89af
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c2d9f9a7837ab29ccae0c42252f17d436bf0a501
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f04e2ad394e2755d0bb2d858ecb5598718bf00d5
    reference_type:
    reference_id:
