advisory_id: CVE-2021-47613
datasource_id: vulnrichment_importer_v2/CVE-2021-47613
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47613.json
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\ni2c: virtio:\
  \ fix completion handling\n\nThe driver currently assumes that the notify callback is only\
  \ received\nwhen the device is done with all the queued buffers.\n\nHowever, this is not true,\
  \ since the notify callback could be called\nwithout any of the queued buffers being completed\
  \ (for example, with\nvirtio-pci and shared interrupts) or with only some of the buffers being\n\
  completed (since the driver makes them available to the device in\nmultiple separate virtqueue_add_sgs()\
  \ calls).\n\nThis can lead to incorrect data on the I2C bus or memory corruption in\nthe guest\
  \ if the device operates on buffers which are have been freed by\nthe driver.  (The WARN_ON\
  \ in the driver is also triggered.)\n\n BUG kmalloc-128 (Tainted: G        W        ): Poison\
  \ overwritten\n First byte 0x0 instead of 0x6b\n Allocated in i2cdev_ioctl_rdwr+0x9d/0x1de\
  \ age=243 cpu=0 pid=28\n \tmemdup_user+0x2e/0xbd\n \ti2cdev_ioctl_rdwr+0x9d/0x1de\n \ti2cdev_ioctl+0x247/0x2ed\n\
  \ \tvfs_ioctl+0x21/0x30\n \tsys_ioctl+0xb18/0xb41\n Freed in i2cdev_ioctl_rdwr+0x1bb/0x1de\
  \ age=68 cpu=0 pid=28\n \tkfree+0x1bd/0x1cc\n \ti2cdev_ioctl_rdwr+0x1bb/0x1de\n \ti2cdev_ioctl+0x247/0x2ed\n\
  \ \tvfs_ioctl+0x21/0x30\n \tsys_ioctl+0xb18/0xb41\n\nFix this by calling virtio_get_buf()\
  \ from the notify handler like other\nvirtio drivers and by actually waiting for all the buffers\
  \ to be\ncompleted."
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:11:55Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/9cbb957441ed8873577d7d313a3d79d69f1dad5c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b503de239f62eca898cfb7e820d9a35499137d22
    reference_type:
    reference_id:
