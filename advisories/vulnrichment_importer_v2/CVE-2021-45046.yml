advisory_id: CVE-2021-45046
datasource_id: vulnrichment_importer_v2/CVE-2021-45046
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/45xxx/CVE-2021-45046.json
aliases: []
summary: It was found that the fix to address CVE-2021-44228 in Apache Log4j 2.15.0 was incomplete
  in certain non-default configurations. This could allows attackers with control over Thread
  Context Map (MDC) input data when the logging configuration uses a non-default Pattern Layout
  with either a Context Lookup (for example, $${ctx:loginId}) or a Thread Context Map pattern
  (%X, %mdc, or %MDC) to craft malicious input data using a JNDI Lookup pattern resulting in
  an information leak and remote code execution in some environments and local code execution
  in all environments. Log4j 2.16.0 (Java 8) and 2.12.2 (Java 7) fix this issue by removing
  support for message lookup patterns and disabling JNDI functionality by default.
impacted_packages: []
severities:
  - score: 9
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url:
  - score: Attend
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:N/T:T/P:M/B:A/M:M/D:A/2025-02-04T19:31:22Z/
    published_at: None
    url:
weaknesses:
  - CWE-917
references:
  - url: https://cert-portal.siemens.com/productcert/pdf/ssa-397453.pdf
    reference_type:
    reference_id:
  - url: https://cert-portal.siemens.com/productcert/pdf/ssa-479842.pdf
    reference_type:
    reference_id:
  - url: https://cert-portal.siemens.com/productcert/pdf/ssa-661247.pdf
    reference_type:
    reference_id:
  - url: https://cert-portal.siemens.com/productcert/pdf/ssa-714170.pdf
    reference_type:
    reference_id:
  - url: https://logging.apache.org/log4j/2.x/security.html
    reference_type:
    reference_id:
  - url: https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0032
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202310-16
    reference_type:
    reference_id:
  - url: https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-log4j-qRuKNEbd
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-44228
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2021/dsa-5022
    reference_type:
    reference_id:
  - url: https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00646.html
    reference_type:
    reference_id:
  - url: https://www.kb.cert.org/vuls/id/930724
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/alert-cve-2021-44228.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuapr2022.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpujan2022.html
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpujul2022.html
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/12/14/4
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/12/15/3
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/12/18/1
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/EOKPQGV24RRBBI4TBZUDQMM4MEH7MXCY/
    reference_type: advisory
    reference_id: EOKPQGV24RRBBI4TBZUDQMM4MEH7MXCY
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/SIG7FZULMNK2XF6FZRU4VWYDQXNMUGAJ/
    reference_type: advisory
    reference_id: SIG7FZULMNK2XF6FZRU4VWYDQXNMUGAJ
