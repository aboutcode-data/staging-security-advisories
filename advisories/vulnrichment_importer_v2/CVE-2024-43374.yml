advisory_id: CVE-2024-43374
datasource_id: vulnrichment_importer_v2/CVE-2024-43374
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/43xxx/CVE-2024-43374.json
aliases: []
summary: The UNIX editor Vim prior to version 9.1.0678 has a use-after-free error in argument
  list handling. When adding a new file to the argument list, this triggers `Buf*` autocommands.
  If in such an autocommand the buffer that was just opened is closed (including the window
  where it is shown), this causes the window structure to be freed which contains a reference
  to the argument list that we are actually modifying. Once the autocommands are completed,
  the references to the window and argument list are no longer valid and as such cause an use-after-free.
  Impact is low since the user must either intentionally add some unusual autocommands that
  wipe a buffer during creation (either manually or by sourcing a malicious plugin), but it
  will crash Vim. The issue has been fixed as of Vim patch v9.1.0678.
impacted_packages: []
severities:
  - score: '4.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-08-16T16:10:21Z/
    published_at: None
    url:
weaknesses:
  - CWE-416
references:
  - url: https://github.com/vim/vim/commit/0a6e57b09bc8c76691b367a5babfb79b31b770e8
    reference_type: other
    reference_id: 0a6e57b09bc8c76691b367a5babfb79b31b770e8
  - url: https://github.com/vim/vim/security/advisories/GHSA-2w8m-443v-cgvw
    reference_type: other
    reference_id: GHSA-2w8m-443v-cgvw
