advisory_id: CVE-2024-28255
datasource_id: vulnrichment_importer_v2/CVE-2024-28255
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/28xxx/CVE-2024-28255.json
aliases: []
summary: OpenMetadata is a unified platform for discovery, observability, and governance powered
  by a central metadata repository, in-depth lineage, and seamless team collaboration. The `JwtFilter`
  handles the API authentication by requiring and verifying JWT tokens. When a new request comes
  in, the request's path is checked against this list. When the request's path contains any
  of the excluded endpoints the filter returns without validating the JWT. Unfortunately, an
  attacker may use Path Parameters to make any path contain any arbitrary strings. For example,
  a request to `GET /api/v1;v1%2fusers%2flogin/events/subscriptions/validation/condition/111`
  will match the excluded endpoint condition and therefore will be processed with no JWT validation
  allowing an attacker to bypass the authentication mechanism and reach any arbitrary endpoint,
  including the ones listed above that lead to arbitrary SpEL expression injection. This bypass
  will not work when the endpoint uses the `SecurityContext.getUserPrincipal()` since it will
  return `null` and will throw an NPE. This issue may lead to authentication bypass and has
  been addressed in version 1.2.4. Users are advised to upgrade. There are no known workarounds
  for this vulnerability. This issue is also tracked as `GHSL-2023-237`.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-07-16T00:26:07Z/
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/open-metadata/OpenMetadata/blob/e2043a3f31312ebb42391d6c93a67584d798de52/openmetadata-service/src/main/java/org/openmetadata/service/security/JwtFilter.java#L111
    reference_type:
    reference_id:
  - url: https://github.com/open-metadata/OpenMetadata/blob/e2043a3f31312ebb42391d6c93a67584d798de52/openmetadata-service/src/main/java/org/openmetadata/service/security/JwtFilter.java#L113
    reference_type:
    reference_id:
  - url: https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-6wx7-qw5p-wh84
    reference_type:
    reference_id:
