advisory_id: CVE-2024-41021
datasource_id: vulnrichment_importer_v2/CVE-2024-41021
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/41xxx/CVE-2024-41021.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  s390/mm: Fix VM_FAULT_HWPOISON handling in do_exception()

  There is no support for HWPOISON, MEMORY_FAILURE, or ARCH_HAS_COPY_MC on
  s390. Therefore we do not expect to see VM_FAULT_HWPOISON in
  do_exception().

  However, since commit af19487f00f3 ("mm: make PTE_MARKER_SWAPIN_ERROR more
  general"), it is possible to see VM_FAULT_HWPOISON in combination with
  PTE_MARKER_POISONED, even on architectures that do not support HWPOISON
  otherwise. In this case, we will end up on the BUG() in do_exception().

  Fix this by treating VM_FAULT_HWPOISON the same as VM_FAULT_SIGBUS, similar
  to x86 when MEMORY_FAILURE is not configured. Also print unexpected fault
  flags, for easier debugging.

  Note that VM_FAULT_HWPOISON_LARGE is not expected, because s390 cannot
  support swap entries on other levels than PTE level.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:24:25Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/73a9260b7366d2906ec011e100319359fe2277d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e13767ccefdc4f8aa92514b592b60f6b54882ff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a3aefb871222a9880602d1a44a558177b4143e3b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/df39038cd89525d465c2c8827eb64116873f141a
    reference_type:
    reference_id:
