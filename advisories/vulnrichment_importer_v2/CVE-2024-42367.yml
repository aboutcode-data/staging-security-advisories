advisory_id: CVE-2024-42367
datasource_id: vulnrichment_importer_v2/CVE-2024-42367
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/42xxx/CVE-2024-42367.json
aliases: []
summary: aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. In
  versions on the 3.10 branch prior to version 3.10.2, static routes which contain files with
  compressed variants (`.gz` or `.br` extension) are vulnerable to path traversal outside the
  root directory if those variants are symbolic links. The server protects static routes from
  path traversal outside the root directory when `follow_symlinks=False` (default).  It does
  this by resolving the requested URL to an absolute path and then checking that path relative
  to the root. However, these checks are not performed when looking for compressed variants
  in the `FileResponse` class, and symbolic links are then automatically followed when performing
  the `Path.stat()` and `Path.open()` to send the file. Version 3.10.2 contains a patch for
  the issue.
impacted_packages: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-08-09T18:18:15Z/
    published_at: None
    url:
weaknesses:
  - CWE-61
references:
  - url: https://github.com/aio-libs/aiohttp/blob/e0ff5246e1d29b7710ab1a2bbc972b48169f1c05/aiohttp/web_fileresponse.py#L177
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/blob/e0ff5246e1d29b7710ab1a2bbc972b48169f1c05/aiohttp/web_urldispatcher.py#L674
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/commit/ce2e9758814527589b10759a20783fb03b98339f
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/pull/8653
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/security/advisories/GHSA-jwhx-xcg6-8xhj
    reference_type:
    reference_id:
