advisory_id: CVE-2024-43864
datasource_id: vulnrichment_importer_v2/CVE-2024-43864
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/43xxx/CVE-2024-43864.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/mlx5e: Fix CT entry update leaks of modify header context

  The cited commit allocates a new modify header to replace the old
  one when updating CT entry. But if failed to allocate a new one, eg.
  exceed the max number firmware can support, modify header will be
  an error pointer that will trigger a panic when deallocating it. And
  the old modify header point is copied to old attr. When the old
  attr is freed, the old modify header is lost.

  Fix it by restoring the old attr to attr when failed to allocate a
  new modify header context. So when the CT entry is freed, the right
  modify header context will be freed. And the panic of accessing
  error pointer is also fixed.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:06:42Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/025f2b85a5e5a46df14ecf162c3c80a957a36d0b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/89064d09c56b44c668509bf793c410484f63f5ad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/daab2cc17b6b6ab158566bba037e9551fd432b59
    reference_type:
    reference_id:
