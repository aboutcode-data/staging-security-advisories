advisory_id: CVE-2022-48806
datasource_id: vulnrichment_importer_v2/CVE-2022-48806
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48806.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  eeprom: ee1004: limit i2c reads to I2C_SMBUS_BLOCK_MAX

  Commit effa453168a7 ("i2c: i801: Don't silently correct invalid transfer
  size") revealed that ee1004_eeprom_read() did not properly limit how
  many bytes to read at once.

  In particular, i2c_smbus_read_i2c_block_data_or_emulated() takes the
  length to read as an u8.  If count == 256 after taking into account the
  offset and page boundary, the cast to u8 overflows.  And this is common
  when user space tries to read the entire EEPROM at once.

  To fix it, limit each read to I2C_SMBUS_BLOCK_MAX (32) bytes, already
  the maximum length i2c_smbus_read_i2c_block_data_or_emulated() allows.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:58:47Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3937c35493ee2847aaefcfa5460e94b7443eef49
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9443ddeb3754e9e382a396b50adc1961301713ce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9a5f471ae380f9fcb9756d453c12ca1f8595a93c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a37960df7eac3cc8094bd1ab84864e9e32c91345
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c0689e46be23160d925dca95dfc411f1a0462708
    reference_type:
    reference_id:
