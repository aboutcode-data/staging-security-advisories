advisory_id: CVE-2025-65947
datasource_id: vulnrichment_importer_v2/CVE-2025-65947
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/65xxx/CVE-2025-65947.json
aliases: []
summary: thread-amount is a tool that gets the amount of threads in the current process. Prior
  to version 0.2.2, there are resource leaks when querying thread counts on Windows and Apple
  platforms. In Windows platforms, the thread_amount function calls CreateToolhelp32Snapshot
  but fails to close the returned HANDLE using CloseHandle. Repeated calls to this function
  will cause the handle count of the process to grow indefinitely, eventually leading to system
  instability or process termination when the handle limit is reached. In Apple platforms, the
  thread_amount function calls task_threads (via Mach kernel APIs) which allocates memory for
  the thread list. The function fails to deallocate this memory using vm_deallocate. Repeated
  calls will result in a steady memory leak, eventually causing the process to be killed by
  the OOM (Out of Memory) killer. This issue has been patched in version 0.2.2.
impacted_packages: []
severities:
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-11-24T14:56:11Z/
    published_at: None
    url:
weaknesses:
  - CWE-772
  - CWE-400
references:
  - url: https://github.com/jzeuzs/thread-amount/commit/28860d4a38286609cb884c13b5b7941edc2390e5
    reference_type:
    reference_id:
  - url: https://github.com/jzeuzs/thread-amount/pull/29
    reference_type:
    reference_id:
  - url: https://github.com/jzeuzs/thread-amount/security/advisories/GHSA-jf9p-2fv9-2jp2
    reference_type:
    reference_id:
