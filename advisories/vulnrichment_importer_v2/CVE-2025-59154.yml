advisory_id: CVE-2025-59154
datasource_id: vulnrichment_importer_v2/CVE-2025-59154
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/59xxx/CVE-2025-59154.json
aliases: []
summary: Openfire is an XMPP server licensed under the Open Source Apache License. Openfireâ€™s
  SASL EXTERNAL mechanism for client TLS authentication contains a vulnerability in how it extracts
  user identities from X.509 certificates. Instead of parsing the structured ASN.1 data, the
  code calls X509Certificate.getSubjectDN().getName() and applies a regex to look for CN=. This
  method produces a provider-dependent string that does not escape special characters. In SunJSSE
  (sun.security.x509.X500Name), for example, commas and equals signs inside attribute values
  are not escaped. As a result, a malicious certificate can embed CN= inside another attribute
  value (e.g. OU="CN=admin,"). The regex will incorrectly interpret this as a legitimate Common
  Name and extract admin. If SASL EXTERNAL is enabled and configured to map CNs to user accounts,
  this allows the attacker to impersonate another user. The fix is included in Openfire 5.0.2
  and 5.1.0.
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-09-15T20:11:37Z/
    published_at: None
    url:
weaknesses:
  - CWE-290
references:
  - url: https://github.com/igniterealtime/Openfire/blob/8d073dda36905da0fdee7cb623c025a01a5cbf6b/xmppserver/src/main/java/org/jivesoftware/util/cert/CNCertificateIdentityMapping.java#L43
    reference_type:
    reference_id:
  - url: https://github.com/igniterealtime/Openfire/security/advisories/GHSA-w252-645g-87mp
    reference_type:
    reference_id:
  - url: https://igniterealtime.atlassian.net/browse/OF-3122
    reference_type:
    reference_id:
  - url: https://igniterealtime.atlassian.net/browse/OF-3123
    reference_type:
    reference_id:
  - url: https://igniterealtime.atlassian.net/browse/OF-3124
    reference_type:
    reference_id:
