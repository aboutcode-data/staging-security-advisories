advisory_id: CVE-2024-50021
datasource_id: vulnrichment_importer_v2/CVE-2024-50021
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/50xxx/CVE-2024-50021.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ice: Fix improper handling of refcount in ice_dpll_init_rclk_pins()

  This patch addresses a reference count handling issue in the
  ice_dpll_init_rclk_pins() function. The function calls ice_dpll_get_pins(),
  which increments the reference count of the relevant resources. However,
  if the condition WARN_ON((!vsi || !vsi->netdev)) is met, the function
  currently returns an error without properly releasing the resources
  acquired by ice_dpll_get_pins(), leading to a reference count leak.

  To resolve this, the check has been moved to the top of the function. This
  ensures that the function verifies the state before any resources are
  acquired, avoiding the need for additional resource management in the
  error path.

  This bug was identified by an experimental static analysis tool developed
  by our team. The tool specializes in analyzing reference count operations
  and detecting potential issues where resources are not properly managed.
  In this case, the tool flagged the missing release operation as a
  potential problem, which led to the development of this patch.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-22T13:27:23Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/aefecead9d08f4a35ab6f51ba2e408d2cef4e31d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ccca30a18e36a742e606d5bf0630e75be7711d0a
    reference_type:
    reference_id:
