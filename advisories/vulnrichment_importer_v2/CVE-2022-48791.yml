advisory_id: CVE-2022-48791
datasource_id: vulnrichment_importer_v2/CVE-2022-48791
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48791.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: pm8001: Fix use-after-free for aborted TMF sas_task

  Currently a use-after-free may occur if a TMF sas_task is aborted before we
  handle the IO completion in mpi_ssp_completion(). The abort occurs due to
  timeout.

  When the timeout occurs, the SAS_TASK_STATE_ABORTED flag is set and the
  sas_task is freed in pm8001_exec_internal_tmf_task().

  However, if the I/O completion occurs later, the I/O completion still
  thinks that the sas_task is available. Fix this by clearing the ccb->task
  if the TMF times out - the I/O completion handler does nothing if this
  pointer is cleared.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:59:35Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3c334cdfd94945b8edb94022a0371a8665b17366
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/510b21442c3a2e3ecc071ba3e666b320e7acdd61
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/61f162aa4381845acbdc7f2be4dfb694d027c018
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d872e7b5fe38f325f5206b6872746fa02c2b4819
    reference_type:
    reference_id:
