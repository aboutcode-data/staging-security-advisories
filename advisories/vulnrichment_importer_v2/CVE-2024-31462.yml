advisory_id: CVE-2024-31462
datasource_id: vulnrichment_importer_v2/CVE-2024-31462
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/31xxx/CVE-2024-31462.json
aliases: []
summary: stable-diffusion-webui is a web interface for Stable Diffusion, implemented using Gradio
  library. Stable-diffusion-webui 1.7.0 is vulnerable to a limited file write affecting Windows
  systems. The create_ui method (Backup/Restore tab) in modules/ui_extensions.py takes user
  input into the config_save_name variable on line 653. This user input is later used in the
  save_config_state method and used to create a file path on line 65, which is afterwards opened
  for writing on line 67, which leads to a limited file write exploitable on Windows systems.
  This issue may lead to limited file write. It allows for writing json files anywhere on the
  server where the web server has access.
impacted_packages: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T14:28:20Z/
    published_at: None
    url:
weaknesses:
  - CWE-22
references:
  - url: https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L59
    reference_type:
    reference_id:
  - url: https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L646-L660
    reference_type:
    reference_id:
  - url: https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L65
    reference_type:
    reference_id:
  - url: https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L653
    reference_type:
    reference_id:
  - url: https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L67
    reference_type:
    reference_id:
  - url: https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/v1.7.0/modules/ui_extensions.py
    reference_type:
    reference_id:
  - url: https://github.com/AUTOMATIC1111/stable-diffusion-webui/commit/d9708c92b444894bce8070e4dcfaa093f8eb8d43
    reference_type:
    reference_id:
  - url: https://github.com/AUTOMATIC1111/stable-diffusion-webui/discussions/15461
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2024-010_stable-diffusion-webui
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2024-010_stable-diffusion-webui/
    reference_type:
    reference_id:
