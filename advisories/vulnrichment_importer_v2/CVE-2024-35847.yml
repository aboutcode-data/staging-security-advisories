advisory_id: CVE-2024-35847
datasource_id: vulnrichment_importer_v2/CVE-2024-35847
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/35xxx/CVE-2024-35847.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  irqchip/gic-v3-its: Prevent double free on error

  The error handling path in its_vpe_irq_domain_alloc() causes a double free
  when its_vpe_init() fails after successfully allocating at least one
  interrupt. This happens because its_vpe_irq_domain_free() frees the
  interrupts along with the area bitmap and the vprop_page and
  its_vpe_irq_domain_alloc() subsequently frees the area bitmap and the
  vprop_page again.

  Fix this by unconditionally invoking its_vpe_irq_domain_free() which
  handles all cases correctly and by removing the bitmap/vprop_page freeing
  from its_vpe_irq_domain_alloc().

  [ tglx: Massaged change log ]
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-12T15:13:12Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/03170e657f62c26834172742492a8cb8077ef792
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5b012f77abde89bf0be8a0547636184fea618137
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5dbdbe1133911ca7d8466bb86885adec32ad9438
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aa44d21574751a7d6bca892eb8e0e9ac68372e52
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b72d2b1448b682844f995e660b77f2a1fabc1662
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c26591afd33adce296c022e3480dea4282b7ef91
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd681710ab77c8beafe2e263064cb1bd0e2d6ca9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f5417ff561b8ac9a7e53c747b8627a7ab58378ae
    reference_type:
    reference_id:
