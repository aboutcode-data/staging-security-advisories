advisory_id: CVE-2025-29781
datasource_id: vulnrichment_importer_v2/CVE-2025-29781
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/29xxx/CVE-2025-29781.json
aliases: []
summary: The Bare Metal Operator (BMO) implements a Kubernetes API for managing bare metal hosts
  in Metal3. Baremetal Operator enables users to load Secret from arbitrary namespaces upon
  deployment of the namespace scoped Custom Resource `BMCEventSubscription`. Prior to versions
  0.8.1 and 0.9.1, an adversary Kubernetes account with only namespace level roles (e.g. a tenant
  controlling a namespace) may create a `BMCEventSubscription` in his authorized namespace and
  then load Secrets from his unauthorized namespaces to his authorized namespace via the Baremetal
  Operator, causing Secret Leakage. The patch makes BMO refuse to read Secrets from other namespace
  than where the corresponding BMH resource is. The patch does not change the `BMCEventSubscription`
  API in BMO, but stricter validation will fail the request at admission time. It will also
  prevent the controller reading such Secrets, in case the BMCES CR has already been deployed.
  The issue exists for all versions of BMO, and is patched in BMO releases v0.9.1 and v0.8.1.
  Prior upgrading to patched BMO version, duplicate any existing Secret pointed to by `BMCEventSubscription`'s
  `httpHeadersRef` to the same namespace where the corresponding BMH exists. After upgrade,
  remove the old Secrets. As a workaround, the operator can configure BMO RBAC to be namespace
  scoped, instead of cluster scoped, to prevent BMO from accessing Secrets from other namespaces,
  and/or use `WATCH_NAMESPACE` configuration option to limit BMO to single namespace.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-03-18T14:09:58Z/
    published_at: None
    url:
weaknesses:
  - CWE-653
  - CWE-200
references:
  - url: https://github.com/metal3-io/baremetal-operator/commit/19f8443b1fe182f76dd81b43122e8dd102f8b94c
    reference_type:
    reference_id:
  - url: https://github.com/metal3-io/baremetal-operator/pull/2321
    reference_type:
    reference_id:
  - url: https://github.com/metal3-io/baremetal-operator/pull/2322
    reference_type:
    reference_id:
  - url: https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-c98h-7hp9-v9hq
    reference_type:
    reference_id:
  - url: https://github.com/metal3-io/metal3-docs/blob/main/design/baremetal-operator/bmc-events.md
    reference_type:
    reference_id:
