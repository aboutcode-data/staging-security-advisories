advisory_id: CVE-2025-27104
datasource_id: vulnrichment_importer_v2/CVE-2025-27104
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/27xxx/CVE-2025-27104.json
aliases: []
summary: 'vyper is a Pythonic Smart Contract Language for the EVM. Multiple evaluation of a
  single expression is possible in the iterator target of a for loop. While the iterator expression
  cannot produce multiple writes, it can consume side effects produced in the loop body (e.g.
  read a storage variable updated in the loop body) and thus lead to unexpected program behavior.
  Specifically, reads in iterators which contain an ifexp (e.g. `for s: uint256 in ([read(),
  read()] if True else [])`) may interleave reads with writes in the loop body. Vyper for loops
  allow two kinds of iterator targets, namely the `range()` builtin and an iterable type, like
  SArray and DArray. During codegen, iterable lists are required to not produce any side-effects
  (in the following code, `range_scope` forces `iter_list` to be parsed in a constant context,
  which is checked against `is_constant`). However, this does not prevent the iterator from
  consuming side effects provided by the body of the loop. For SArrays on the other hand, `iter_list`
  is instantiated in the body of a `repeat` ir, so it can be evaluated several times. This issue
  is being addressed and is expected to be available in version 0.4.1. Users are advised to
  upgrade as soon as the patched release is available. There are no known workarounds for this
  vulnerability.'
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-02-22T15:35:33Z/
    published_at: None
    url:
weaknesses:
  - CWE-662
references:
  - url: https://github.com/vyperlang/vyper/pull/4488
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-h33q-mhmp-8p67
    reference_type:
    reference_id:
