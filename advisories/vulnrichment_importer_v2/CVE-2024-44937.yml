advisory_id: CVE-2024-44937
datasource_id: vulnrichment_importer_v2/CVE-2024-44937
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/44xxx/CVE-2024-44937.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  platform/x86: intel-vbtn: Protect ACPI notify handler against recursion

  Since commit e2ffcda16290 ("ACPI: OSL: Allow Notify () handlers to run on
  all CPUs") ACPI notify handlers like the intel-vbtn notify_handler() may
  run on multiple CPU cores racing with themselves.

  This race gets hit on Dell Venue 7140 tablets when undocking from
  the keyboard, causing the handler to try and register priv->switches_dev
  twice, as can be seen from the dev_info() message getting logged twice:

  [ 83.861800] intel-vbtn INT33D6:00: Registering Intel Virtual Switches input-dev after receiving a switch event
  [ 83.861858] input: Intel Virtual Switches as /devices/pci0000:00/0000:00:1f.0/PNP0C09:00/INT33D6:00/input/input17
  [ 83.861865] intel-vbtn INT33D6:00: Registering Intel Virtual Switches input-dev after receiving a switch event

  After which things go seriously wrong:
  [ 83.861872] sysfs: cannot create duplicate filename '/devices/pci0000:00/0000:00:1f.0/PNP0C09:00/INT33D6:00/input/input17'
  ...
  [ 83.861967] kobject: kobject_add_internal failed for input17 with -EEXIST, don't try to register things with the same name in the same directory.
  [ 83.877338] BUG: kernel NULL pointer dereference, address: 0000000000000018
  ...

  Protect intel-vbtn notify_handler() from racing with itself with a mutex
  to fix this.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T15:27:41Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/5c9618a3b6ea94cf7bdff7702aca8bf2d777d97b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e075c3b13a0a142dcd3151b25d29a24f31b7b640
    reference_type:
    reference_id:
