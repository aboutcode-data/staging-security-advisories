advisory_id: CVE-2024-53192
datasource_id: vulnrichment_importer_v2/CVE-2024-53192
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/53xxx/CVE-2024-53192.json
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nclk: clk-loongson2:\
  \ Fix potential buffer overflow in flexible-array member access\n\nFlexible-array member `hws`\
  \ in `struct clk_hw_onecell_data` is annotated\nwith the `counted_by()` attribute. This means\
  \ that when memory is\nallocated for this array, the _counter_, which in this case is member\n\
  `num` in the flexible structure, should be set to the maximum number of\nelements the flexible\
  \ array can contain, or fewer.\n\nIn this case, the total number of elements for the flexible\
  \ array is\ndetermined by variable `clks_num` when allocating heap space via\n`devm_kzalloc()`,\
  \ as shown below:\n\n289         struct loongson2_clk_provider *clp;\n\t...\n296         for\
  \ (p = data; p->name; p++)\n297                 clks_num++;\n298\n299         clp = devm_kzalloc(dev,\
  \ struct_size(clp, clk_data.hws, clks_num),\n300                            GFP_KERNEL);\n\
  \nSo, `clp->clk_data.num` should be set to `clks_num` or less, and not\nexceed `clks_num`,\
  \ as is currently the case. Otherwise, if data is\nwritten into `clp->clk_data.hws[clks_num]`,\
  \ the instrumentation\nprovided by the compiler won't detect the overflow, leading to a\n\
  memory corruption bug at runtime.\n\nFix this issue by setting `clp->clk_data.num` to `clks_num`."
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-18T16:03:52Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/02fb4f0084331ef72c28d0c70fcb15d1bea369ec
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1bf8877150128c3abd9d233886a05f6966fbf0c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b96fc194984d0c82de1ca2b4166b35b1298b216c
    reference_type:
    reference_id:
