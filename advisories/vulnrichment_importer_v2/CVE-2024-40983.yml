advisory_id: CVE-2024-40983
datasource_id: vulnrichment_importer_v2/CVE-2024-40983
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/40xxx/CVE-2024-40983.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tipc: force a dst refcount before doing decryption

  As it says in commit 3bc07321ccc2 ("xfrm: Force a dst refcount before
  entering the xfrm type handlers"):

  "Crypto requests might return asynchronous. In this case we leave the
   rcu protected region, so force a refcount on the skb's destination
   entry before we enter the xfrm type input/output handlers."

  On TIPC decryption path it has the same problem, and skb_dst_force()
  should be called before doing decryption to avoid a possible crash.

  Shuang reported this issue when this warning is triggered:

    [] WARNING: include/net/dst.h:337 tipc_sk_rcv+0x1055/0x1ea0 [tipc]
    [] Kdump: loaded Tainted: G W --------- - - 4.18.0-496.el8.x86_64+debug
    [] Workqueue: crypto cryptd_queue_worker
    [] RIP: 0010:tipc_sk_rcv+0x1055/0x1ea0 [tipc]
    [] Call Trace:
    [] tipc_sk_mcast_rcv+0x548/0xea0 [tipc]
    [] tipc_rcv+0xcf5/0x1060 [tipc]
    [] tipc_aead_decrypt_done+0x215/0x2e0 [tipc]
    [] cryptd_aead_crypt+0xdb/0x190
    [] cryptd_queue_worker+0xed/0x190
    [] process_one_work+0x93d/0x17e0
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:02:13Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2ebe8f840c7450ecbfca9d18ac92e9ce9155e269
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3eb1b39627892c4e26cb0162b75725aa5fcc60c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/623c90d86a61e3780f682b32928af469c66ec4c2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6808b41371670c51feea14f63ade211e78100930
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/692803b39a36e63ac73208e0a3769ae6a2f9bc76
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b57a4a2dc8746cea58a922ebe31b6aa629d69d93
    reference_type:
    reference_id:
