advisory_id: CVE-2024-44951
datasource_id: vulnrichment_importer_v2/CVE-2024-44951
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/44xxx/CVE-2024-44951.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  serial: sc16is7xx: fix TX fifo corruption

  Sometimes, when a packet is received on channel A at almost the same time
  as a packet is about to be transmitted on channel B, we observe with a
  logic analyzer that the received packet on channel A is transmitted on
  channel B. In other words, the Tx buffer data on channel B is corrupted
  with data from channel A.

  The problem appeared since commit 4409df5866b7 ("serial: sc16is7xx: change
  EFR lock to operate on each channels"), which changed the EFR locking to
  operate on each channel instead of chip-wise.

  This commit has introduced a regression, because the EFR lock is used not
  only to protect the EFR registers access, but also, in a very obscure and
  undocumented way, to protect access to the data buffer, which is shared by
  the Tx and Rx handlers, but also by each channel of the IC.

  Fix this regression first by switching to kfifo_out_linear_ptr() in
  sc16is7xx_handle_tx() to eliminate the need for a shared Rx/Tx buffer.

  Secondly, replace the chip-wise Rx buffer with a separate Rx buffer for
  each channel.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:40:19Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/09cfe05e9907f3276887a20e267cc40e202f4fdd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/133f4c00b8b2bfcacead9b81e7e8edfceb4b06c4
    reference_type:
    reference_id:
