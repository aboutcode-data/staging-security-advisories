advisory_id: CVE-2025-21672
datasource_id: vulnrichment_importer_v2/CVE-2025-21672
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/21xxx/CVE-2025-21672.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  afs: Fix merge preference rule failure condition

  syzbot reported a lock held when returning to userspace[1].  This is
  because if argc is less than 0 and the function returns directly, the held
  inode lock is not released.

  Fix this by store the error in ret and jump to done to clean up instead of
  returning directly.

  [dh: Modified Lizhi Xu's original patch to make it honour the error code
  from afs_split_string()]

  [1]
  WARNING: lock held when returning to user space!
  6.13.0-rc3-syzkaller-00209-g499551201b5f #0 Not tainted
  ------------------------------------------------
  syz-executor133/5823 is leaving the kernel with locks still held!
  1 lock held by syz-executor133/5823:
   #0: ffff888071cffc00 (&sb->s_type->i_mutex_key#9){++++}-{4:4}, at: inode_lock include/linux/fs.h:818 [inline]
   #0: ffff888071cffc00 (&sb->s_type->i_mutex_key#9){++++}-{4:4}, at: afs_proc_addr_prefs_write+0x2bb/0x14e0 fs/afs/addr_prefs.c:388
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T19:52:11Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/17a4fde81d3a7478d97d15304a6d61094a10c2e3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/22be1d90a6211c88dd093b25d1f3aa974d0d9f9d
    reference_type:
    reference_id:
