advisory_id: CVE-2023-52676
datasource_id: vulnrichment_importer_v2/CVE-2023-52676
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/52xxx/CVE-2023-52676.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Guard stack limits against 32bit overflow

  This patch promotes the arithmetic around checking stack bounds to be
  done in the 64-bit domain, instead of the current 32bit. The arithmetic
  implies adding together a 64-bit register with a int offset. The
  register was checked to be below 1<<29 when it was variable, but not
  when it was fixed. The offset either comes from an instruction (in which
  case it is 16 bit), from another register (in which case the caller
  checked it to be below 1<<29 [1]), or from the size of an argument to a
  kfunc (in which case it can be a u32 [2]). Between the register being
  inconsistently checked to be below 1<<29, and the offset being up to an
  u32, it appears that we were open to overflowing the `int`s which were
  currently used for arithmetic.

  [1] https://github.com/torvalds/linux/blob/815fb87b753055df2d9e50f6cd80eb10235fe3e9/kernel/bpf/verifier.c#L7494-L7498
  [2] https://github.com/torvalds/linux/blob/815fb87b753055df2d9e50f6cd80eb10235fe3e9/kernel/bpf/verifier.c#L11904
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-12T15:14:32Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1d38a9ee81570c4bd61f557832dead4d6f816760
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ad140fc856f0b1d5e2215bcb6d0cc247a86805a2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e5ad9ecb84405637df82732ee02ad741a5f782a6
    reference_type:
    reference_id:
