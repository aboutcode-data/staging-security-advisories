advisory_id: CVE-2024-45818
datasource_id: vulnrichment_importer_v2/CVE-2024-45818
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/45xxx/CVE-2024-45818.json
aliases: []
summary: |
  The hypervisor contains code to accelerate VGA memory accesses for HVM
  guests, when the (virtual) VGA is in "standard" mode.  Locking involved
  there has an unusual discipline, leaving a lock acquired past the
  return from the function that acquired it.  This behavior results in a
  problem when emulating an instruction with two memory accesses, both of
  which touch VGA memory (plus some further constraints which aren't
  relevant here).  When emulating the 2nd access, the lock that is already
  being held would be attempted to be re-acquired, resulting in a
  deadlock.

  This deadlock was already found when the code was first introduced, but
  was analysed incorrectly and the fix was incomplete.  Analysis in light
  of the new finding cannot find a way to make the existing locking
  discipline work.

  In staging, this logic has all been removed because it was discovered
  to be accidentally disabled since Xen 4.7.  Therefore, we are fixing the
  locking problem by backporting the removal of most of the feature.  Note
  that even with the feature disabled, the lock would still be acquired
  for any accesses to the VGA MMIO region.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-31T18:59:24Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://xenbits.xenproject.org/xsa/advisory-463.html
    reference_type:
    reference_id:
