advisory_id: CVE-2023-32684
datasource_id: vulnrichment_importer_v2/CVE-2023-32684
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/32xxx/CVE-2023-32684.json
aliases: []
summary: Lima launches Linux virtual machines, typically on macOS, for running containerd. Prior
  to version 0.16.0, a virtual machine instance with a malicious disk image could read a single
  file on the host filesystem, even when no filesystem is mounted from the host. The official
  templates of Lima and the well-known third party products (Colima, Rancher Desktop, and Finch)
  are unlikely to be affected by this issue. To exploit this issue, the attacker has to embed
  the target file path (an absolute or a relative path from the instance directory) in a malicious
  disk image, as the qcow2 (or vmdk) backing file path string. As Lima refuses to run as the
  root, it is practically impossible for the attacker to read the entire host disk via `/dev/rdiskN`.
  Also, practically, the attacker cannot read at least the first 512 bytes (MBR) of the target
  file. The issue has been patched in Lima in version 0.16.0 by prohibiting using a backing
  file path in the VM base image.
impacted_packages: []
severities:
  - score: '2.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-10T16:52:00Z/
    published_at: None
    url:
weaknesses:
  - CWE-552
references:
  - url: https://github.com/lima-vm/lima/commit/01dbd4d9cabe692afa4517be3995771f0ebb38a5
    reference_type:
    reference_id:
  - url: https://github.com/lima-vm/lima/releases/tag/v0.16.0
    reference_type:
    reference_id:
  - url: https://github.com/lima-vm/lima/security/advisories/GHSA-f7qw-jj9c-rpq9
    reference_type:
    reference_id:
