advisory_id: CVE-2024-24560
datasource_id: vulnrichment_importer_v2/CVE-2024-24560
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/24xxx/CVE-2024-24560.json
aliases: []
summary: Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine. When
  calls to external contracts are made, we write the input buffer starting at byte 28, and allocate
  the return buffer to start at byte 0 (overlapping with the input buffer). When checking RETURNDATASIZE
  for dynamic types, the size is compared only to the minimum allowed size for that type, and
  not to the returned value's length. As a result, malformed return data can cause the contract
  to mistake data from the input buffer for returndata.  When the called contract returns invalid
  ABIv2 encoded data, the calling contract can read different invalid data (from the dirty buffer)
  than the called contract returned.
impacted_packages: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2024-06-26T14:31:50Z/
    published_at: None
    url:
weaknesses:
  - CWE-119
references:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-gp3w-2v2m-p686
    reference_type:
    reference_id:
