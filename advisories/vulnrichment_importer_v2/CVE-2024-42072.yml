advisory_id: CVE-2024-42072
datasource_id: vulnrichment_importer_v2/CVE-2024-42072
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/42xxx/CVE-2024-42072.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Fix may_goto with negative offset.

  Zac's syzbot crafted a bpf prog that exposed two bugs in may_goto.
  The 1st bug is the way may_goto is patched. When offset is negative
  it should be patched differently.
  The 2nd bug is in the verifier:
  when current state may_goto_depth is equal to visited state may_goto_depth
  it means there is an actual infinite loop. It's not correct to prune
  exploration of the program at this point.
  Note, that this check doesn't limit the program to only one may_goto insn,
  since 2nd and any further may_goto will increment may_goto_depth only
  in the queued state pushed for future exploration. The current state
  will have may_goto_depth == 0 regardless of number of may_goto insns
  and the verifier has to explore the program until bpf_exit.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:19:39Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/175827e04f4be53f3dfb57edf12d0d49b18fd939
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2b2efe1937ca9f8815884bd4dcd5b32733025103
    reference_type:
    reference_id:
