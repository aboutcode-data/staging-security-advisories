advisory_id: CVE-2024-26773
datasource_id: vulnrichment_importer_v2/CVE-2024-26773
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/26xxx/CVE-2024-26773.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: avoid allocating blocks from corrupted group in ext4_mb_try_best_found()

  Determine if the group block bitmap is corrupted before using ac_b_ex in
  ext4_mb_try_best_found() to avoid allocating blocks from a group with a
  corrupted block bitmap in the following concurrency and making the
  situation worse.

  ext4_mb_regular_allocator
    ext4_lock_group(sb, group)
    ext4_mb_good_group
     // check if the group bbitmap is corrupted
    ext4_mb_complex_scan_group
     // Scan group gets ac_b_ex but doesn't use it
    ext4_unlock_group(sb, group)
                             ext4_mark_group_bitmap_corrupted(group)
                             // The block bitmap was corrupted during
                             // the group unlock gap.
    ext4_mb_try_best_found
      ext4_lock_group(ac->ac_sb, group)
      ext4_mb_use_best_found
        mb_mark_used
        // Allocating blocks in block bitmap corrupted group
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-04-03T18:50:26Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0184747b552d6b5a14db3b7fcc3b792ce64dedd1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/21f8cfe79f776287459343e9cfa6055af61328ea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/260fc96283c0f594de18a1b045faf6d8fb42874d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4530b3660d396a646aad91a787b6ab37cf604b53
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4c21fa60a6f4606f6214a38f50612b17b2f738f5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/927794a02169778c9c2e7b25c768ab3ea8c1dc03
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a2576ae9a35c078e488f2c573e9e6821d651fbbe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f97e75fa4e12b0aa0224e83fcbda8853ac2adf36
    reference_type:
    reference_id:
