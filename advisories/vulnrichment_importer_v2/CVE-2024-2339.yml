advisory_id: CVE-2024-2339
datasource_id: vulnrichment_importer_v2/CVE-2024-2339
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/2xxx/CVE-2024-2339.json
aliases: []
summary: PostgreSQL Anonymizer v1.2 contains a vulnerability  that allows a user who owns a
  table to elevate to superuser. A user can define a masking function for a column and place
  malicious code in that function. When a privileged user applies the masking rules using the
  static masking or the anonymous dump method, the malicious code is executed and can grant
  escalated privileges to the malicious user. PostgreSQL Anonymizer v1.2 does provide a protection
  against this risk with the restrict_to_trusted_schemas option, but that protection is incomplete.
  Users that don't own a table, especially masked users cannot exploit this vulnerability. The
  problem is resolved in v1.3.
impacted_packages: []
severities:
  - score: 8
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-08-02T19:52:46Z/
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://gitlab.com/dalibo/postgresql_anonymizer/-/commit/e517b38e62e50871b04011598e73a7308bdae9d9
    reference_type:
    reference_id:
