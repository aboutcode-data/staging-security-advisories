advisory_id: CVE-2023-52597
datasource_id: vulnrichment_importer_v2/CVE-2023-52597
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/52xxx/CVE-2023-52597.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  KVM: s390: fix setting of fpc register

  kvm_arch_vcpu_ioctl_set_fpu() allows to set the floating point control
  (fpc) register of a guest cpu. The new value is tested for validity by
  temporarily loading it into the fpc register.

  This may lead to corruption of the fpc register of the host process:
  if an interrupt happens while the value is temporarily loaded into the fpc
  register, and within interrupt context floating point or vector registers
  are used, the current fp/vx registers are saved with save_fpu_regs()
  assuming they belong to user space and will be loaded into fp/vx registers
  when returning to user space.

  test_fp_ctl() restores the original user space / host process fpc register
  value, however it will be discarded, when returning to user space.

  In result the host process will incorrectly continue to run with the value
  that was supposed to be used for a guest cpu.

  Fix this by simply removing the test. There is another test right before
  the SIE context is entered which will handles invalid values.

  This results in a change of behaviour: invalid values will now be accepted
  instead of that the ioctl fails with -EINVAL. This seems to be acceptable,
  given that this interface is most likely not used anymore, and this is in
  addition the same behaviour implemented with the memory mapped interface
  (replace invalid values with zero) - see sync_regs() in kvm-s390.c.
impacted_packages: []
severities:
  - score: 4
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-03-06T15:59:20Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0671f42a9c1084db10d68ac347d08dbf6689ecb3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/150a3a3871490e8c454ffbac2e60abeafcecff99
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2823db0010c400e4b2b12d02aa5d0d3ecb15d7c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3a04410b0bc7e056e0843ac598825dd359246d18
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e63c9ae8055109d805aacdaf2a4fe2c3b371ba1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/732a3bea7aba5b15026ea42d14953c3425cc7dc2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b988b1bb0053c0dcd26187d29ef07566a565cf55
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c87d7d910775a025e230fd6359b60627e392460f
    reference_type:
    reference_id:
