advisory_id: CVE-2024-4418
datasource_id: vulnrichment_importer_v2/CVE-2024-4418
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/4xxx/CVE-2024-4418.json
aliases: []
summary: A race condition leading to a stack use-after-free flaw was found in libvirt. Due to
  a bad assumption in the virNetClientIOEventLoop() method, the `data` pointer to a stack-allocated
  virNetClientIOEventData structure ended up being used in the virNetClientIOEventFD callback
  while the data pointer's stack frame was concurrently being "freed" when returning from virNetClientIOEventLoop().
  The 'virtproxyd' daemon can be used to trigger requests. If libvirt is configured with fine-grained
  access control, this issue, in theory, allows a user to escape their otherwise limited access.
  This flaw allows a local, unprivileged user to access virtproxyd without authenticating. Remote
  users would need to authenticate before they could access it.
impacted_packages: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-08T15:25:15Z/
    published_at: None
    url:
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-4418
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2278616
    reference_type: bug
    reference_id: 2278616
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:/a:redhat:advanced_virtualization:8::el8
    reference_type: other
    reference_id: cpe:/a:redhat:advanced_virtualization:8::el8
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:/a:redhat:enterprise_linux:8::appstream
    reference_type: other
    reference_id: cpe:/a:redhat:enterprise_linux:8::appstream
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:/a:redhat:enterprise_linux:8::crb
    reference_type: other
    reference_id: cpe:/a:redhat:enterprise_linux:8::crb
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:/a:redhat:enterprise_linux:9::appstream
    reference_type: other
    reference_id: cpe:/a:redhat:enterprise_linux:9::appstream
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:/a:redhat:enterprise_linux:9::crb
    reference_type: other
    reference_id: cpe:/a:redhat:enterprise_linux:9::crb
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:/a:redhat:rhel_eus:9.2::appstream
    reference_type: other
    reference_id: cpe:/a:redhat:rhel_eus:9.2::appstream
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:/a:redhat:rhel_eus:9.2::crb
    reference_type: other
    reference_id: cpe:/a:redhat:rhel_eus:9.2::crb
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:/o:redhat:enterprise_linux:6
    reference_type: other
    reference_id: cpe:/o:redhat:enterprise_linux:6
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:/o:redhat:enterprise_linux:7
    reference_type: other
    reference_id: cpe:/o:redhat:enterprise_linux:7
  - url: https://access.redhat.com/errata/RHSA-2024:4351
    reference_type:
    reference_id: RHSA-2024:4351
  - url: https://access.redhat.com/errata/RHSA-2024:4432
    reference_type:
    reference_id: RHSA-2024:4432
  - url: https://access.redhat.com/errata/RHSA-2024:4757
    reference_type:
    reference_id: RHSA-2024:4757
