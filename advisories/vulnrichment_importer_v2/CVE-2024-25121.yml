advisory_id: CVE-2024-25121
datasource_id: vulnrichment_importer_v2/CVE-2024-25121
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/25xxx/CVE-2024-25121.json
aliases: []
summary: TYPO3 is an open source PHP based web content management system released under the
  GNU GPL. In affected versions of TYPO3 entities of the File Abstraction Layer (FAL) could
  be persisted directly via `DataHandler`. This allowed attackers to reference files in the
  fallback storage directly and retrieve their file names and contents. The fallback storage
  ("zero-storage") is used as a backward compatibility layer for files located outside properly
  configured file storages and within the public web root directory. Exploiting this vulnerability
  requires a valid backend user account. Users are advised to update to TYPO3 version 8.7.57
  ELTS, 9.5.46 ELTS, 10.4.43 ELTS, 11.5.35 LTS, 12.4.11 LTS, or 13.0.1 which fix the problem
  described. When persisting entities of the File Abstraction Layer directly via DataHandler,
  `sys_file` entities are now denied by default, and `sys_file_reference` & `sys_file_metadata`
  entities are not permitted to reference files in the fallback storage anymore. When importing
  data from secure origins, this must be explicitly enabled in the corresponding DataHandler
  instance by using `$dataHandler->isImporting = true;`.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-05-08T19:07:53Z/
    published_at: None
    url:
weaknesses:
  - CWE-200
  - CWE-284
references:
  - url: https://github.com/TYPO3/typo3/security/advisories/GHSA-rj3x-wvc6-5j66
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2024-006
    reference_type:
    reference_id:
