advisory_id: CVE-2023-28846
datasource_id: vulnrichment_importer_v2/CVE-2023-28846
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/28xxx/CVE-2023-28846.json
aliases: []
summary: 'Unpoly is a JavaScript framework for server-side web applications. There is a possible
  Denial of Service (DoS) vulnerability in the `unpoly-rails` gem that implements the Unpoly
  server protocol for Rails applications. This issues affects Rails applications that operate
  as an upstream of a load balancer''s that uses passive health checks. The `unpoly-rails` gem
  echoes the request URL as an `X-Up-Location` response header. By making a request with exceedingly
  long URLs (paths or query string), an attacker can cause unpoly-rails to write a exceedingly
  large response header.  If the response header is too large to be parsed by a load balancer
  downstream of the Rails application, it may cause the load balancer to remove the upstream
  from a load balancing group. This causes that application instance to become unavailable until
  a configured timeout is reached or until an active healthcheck succeeds. This issue has been
  fixed and released as version 2.7.2.2 which is available via RubyGems and GitHub. Users unable
  to upgrade may: Configure your load balancer to use active health checks, e.g. by periodically
  requesting a route with a known response that indicates healthiness; Configure your load balancer
  so the maximum size of response headers is at least twice the maximum size of a URL; or instead
  of changing your server configuration you may also configure your Rails application to delete
  redundant `X-Up-Location` headers set by unpoly-rails.'
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-11T18:46:12Z/
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://docs.nginx.com/nginx/admin-guide/load-balancer/http-health-check/#passive-health-checks
    reference_type:
    reference_id:
  - url: https://github.com/unpoly/unpoly-rails/
    reference_type:
    reference_id:
  - url: https://github.com/unpoly/unpoly-rails/commit/cd9ad0007daceeb3b2354fdcab4f88350427bf16
    reference_type:
    reference_id:
  - url: https://github.com/unpoly/unpoly-rails/security/advisories/GHSA-m875-3xf6-mf78
    reference_type:
    reference_id:
  - url: https://makandracards.com/operations/537537-nginx-proxy-buffer-tuning
    reference_type:
    reference_id:
  - url: https://tryhexadecimal.com/guides/http/414-request-uri-too-long
    reference_type:
    reference_id:
  - url: https://unpoly.com/up.protocol
    reference_type:
    reference_id:
