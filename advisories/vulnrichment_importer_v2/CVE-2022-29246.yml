advisory_id: CVE-2022-29246
datasource_id: vulnrichment_importer_v2/CVE-2022-29246
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/29xxx/CVE-2022-29246.json
aliases: []
summary: Azure RTOS USBX is a USB host, device, and on-the-go (OTG) embedded stack. Prior to
  version 6.1.11, he USBX DFU UPLOAD functionality may be utilized to introduce a buffer overflow
  resulting in overwrite of memory contents. In particular cases this may allow an attacker
  to bypass security features or execute arbitrary code. The implementation of `ux_device_class_dfu_control_request`
  function does not assure that a buffer overflow will not occur during handling of the DFU
  UPLOAD command. When an attacker issues the `UX_SLAVE_CLASS_DFU_COMMAND_UPLOAD` control transfer
  request with `wLenght` larger than the buffer size (`UX_SLAVE_REQUEST_CONTROL_MAX_LENGTH`,
  256 bytes), depending on the actual implementation of `dfu -> ux_slave_class_dfu_read`, a
  buffer overflow may occur. In example `ux_slave_class_dfu_read` may read 4096 bytes (or more
  up to 65k) to a 256 byte buffer ultimately resulting in an overflow. Furthermore in case an
  attacker has some control over the read flash memory, this may result in execution of arbitrary
  code and platform compromise. A fix for this issue has been included in USBX release 6.1.11.
  As a workaround, align request and buffer size to assure that buffer boundaries are respected.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:49:31Z/
    published_at: None
    url:
weaknesses:
  - CWE-120
references:
  - url: https://github.com/azure-rtos/usbx/blob/master/common/usbx_device_classes/src/ux_device_class_dfu_control_request.c
    reference_type:
    reference_id:
  - url: https://github.com/azure-rtos/usbx/releases/tag/v6.1.11_rel
    reference_type:
    reference_id:
  - url: https://github.com/azure-rtos/usbx/security/advisories/GHSA-hh5p-x584-j8hv
    reference_type:
    reference_id:
