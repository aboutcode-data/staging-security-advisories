advisory_id: CVE-2024-24752
datasource_id: vulnrichment_importer_v2/CVE-2024-24752
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/24xxx/CVE-2024-24752.json
aliases: []
summary: Bref enable serverless PHP on AWS Lambda. When Bref is used with the Event-Driven Function
  runtime and the handler is a `RequestHandlerInterface`, then the Lambda event is converted
  to a PSR7 object. During the conversion process, if the request is a MultiPart, each part
  is parsed and for each which contains a file, it is extracted and saved in `/tmp` with a random
  filename starting with `bref_upload_`. The flow mimics what plain PHP does but it does not
  delete the temporary files when the request has been processed. An attacker could fill the
  Lambda instance disk by performing multiple MultiPart requests containing files. This vulnerability
  is patched in 2.1.13.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-02-05T17:05:38Z/
    published_at: None
    url:
weaknesses:
  - CWE-400
references:
  - url: https://github.com/brefphp/bref/commit/350788de12880b6fd64c4c318ba995388bec840e
    reference_type:
    reference_id:
  - url: https://github.com/brefphp/bref/security/advisories/GHSA-x4hh-frx8-98r5
    reference_type:
    reference_id:
