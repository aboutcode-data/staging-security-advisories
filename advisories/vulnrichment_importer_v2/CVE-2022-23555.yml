advisory_id: CVE-2022-23555
datasource_id: vulnrichment_importer_v2/CVE-2022-23555
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/23xxx/CVE-2022-23555.json
aliases: []
summary: authentik is an open-source Identity Provider focused on flexibility and versatility.
  Versions prior to 2022.11.4 and 2022.10.4 are vulnerable to Improper Authentication. Token
  reuse in invitation URLs leads to access control bypass via the use of a different enrollment
  flow than in the one provided. The vulnerability allows an attacker that knows different invitation
  flows names (e.g. `enrollment-invitation-test` and `enrollment-invitation-admin`) via either
  different invite links or via brute forcing to signup via a single invitation url for any
  valid invite link received (it can even be a url for a third flow as long as it's a valid
  invite) as the token used in the `Invitations` section of the Admin interface does NOT change
  when a different `enrollment flow` is selected via the interface and it is NOT bound to the
  selected flow, so it will be valid for any flow when used. This issue is patched in authentik
  2022.11.4,2022.10.4 and 2022.12.0. Only configurations that use invitations and have multiple
  enrollment flows with invitation stages that grant different permissions are affected. The
  default configuration is not vulnerable, and neither are configurations with a single enrollment
  flow.  As a workaround, fixed data can be added to invitations which can be checked in the
  flow to deny requests. Alternatively, an identifier with high entropy (like a UUID) can be
  used as flow slug, mitigating the attack vector by exponentially decreasing the possibility
  of discovering other flows.
impacted_packages: []
severities:
  - score: '9.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-04-11T15:48:09Z/
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/goauthentik/authentik/security/advisories/GHSA-9qwp-jf7p-vr7h
    reference_type:
    reference_id:
