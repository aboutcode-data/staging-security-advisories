advisory_id: CVE-2024-1085
datasource_id: vulnrichment_importer_v2/CVE-2024-1085
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/1xxx/CVE-2024-1085.json
aliases: []
summary: |
  A use-after-free vulnerability in the Linux kernel's netfilter: nf_tables component can be exploited to achieve local privilege escalation.

  The nft_setelem_catchall_deactivate() function checks whether the catch-all set element is active in the current generation instead of the next generation before freeing it, but only flags it inactive in the next generation, making it possible to free the element multiple times, leading to a double free vulnerability.

  We recommend upgrading past commit b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-05-08T15:46:32Z/
    published_at: None
    url:
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7
    reference_type:
    reference_id:
  - url: https://kernel.dance/b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7
    reference_type:
    reference_id:
