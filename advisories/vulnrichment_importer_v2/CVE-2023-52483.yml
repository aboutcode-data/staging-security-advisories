advisory_id: CVE-2023-52483
datasource_id: vulnrichment_importer_v2/CVE-2023-52483
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/52xxx/CVE-2023-52483.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mctp: perform route lookups under a RCU read-side lock

  Our current route lookups (mctp_route_lookup and mctp_route_lookup_null)
  traverse the net's route list without the RCU read lock held. This means
  the route lookup is subject to preemption, resulting in an potential
  grace period expiry, and so an eventual kfree() while we still have the
  route pointer.

  Add the proper read-side critical section locks around the route
  lookups, preventing premption and a possible parallel kfree.

  The remaining net->mctp.routes accesses are already under a
  rcu_read_lock, or protected by the RTNL for updates.

  Based on an analysis from Sili Luo <rootlab@huawei.com>, where
  introducing a delay in the route lookup could cause a UAF on
  simultaneous sendmsg() and route deletion.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-03-01T17:49:14Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1db0724a01b558feb1ecae551782add1951a114a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2405f64a95a7a094eb24cba9bcfaffd1ea264de4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5093bbfc10ab6636b32728e35813cbd79feb063c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6c52b12159049046483fdb0c411a0a1869c41a67
    reference_type:
    reference_id:
