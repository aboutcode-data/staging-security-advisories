advisory_id: CVE-2022-46177
datasource_id: vulnrichment_importer_v2/CVE-2022-46177
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/46xxx/CVE-2022-46177.json
aliases: []
summary: Discourse is an option source discussion platform. Prior to version 2.8.14 on the `stable`
  branch and version 3.0.0.beta16 on the `beta` and `tests-passed` branches, when a user requests
  for a password reset link email, then changes their primary email, the old reset email is
  still valid. When the old reset email is used to reset the password, the Discourse account's
  primary email would be re-linked to the old email. If the old email address is compromised
  or has transferred ownership, this leads to an account takeover. This is however mitigated
  by the SiteSetting `email_token_valid_hours` which is currently 48 hours. Users should upgrade
  to versions 2.8.14 or 3.0.0.beta15 to receive a patch. As a workaround, lower `email_token_valid_hours
  ` as needed.
impacted_packages: []
severities:
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-03-10T20:58:54Z/
    published_at: None
    url:
weaknesses:
  - CWE-613
references:
  - url: https://github.com/discourse/discourse/commit/4bf306f0e3bf54a9ef9c5886bf1cfb85c20da570
    reference_type:
    reference_id:
  - url: https://github.com/discourse/discourse/commit/83944213b2b2454af80d0407f60d67641b1f0b38
    reference_type:
    reference_id:
  - url: https://github.com/discourse/discourse/security/advisories/GHSA-5www-jxvf-vrc3
    reference_type:
    reference_id:
