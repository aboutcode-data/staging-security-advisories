advisory_id: CVE-2022-48872
datasource_id: vulnrichment_importer_v2/CVE-2022-48872
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48872.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  misc: fastrpc: Fix use-after-free race condition for maps

  It is possible that in between calling fastrpc_map_get() until
  map->fl->lock is taken in fastrpc_free_map(), another thread can call
  fastrpc_map_lookup() and get a reference to a map that is about to be
  deleted.

  Rewrite fastrpc_map_get() to only increase the reference count of a map
  if it's non-zero. Propagate this to callers so they can know if a map is
  about to be deleted.

  Fixes this warning:
  refcount_t: addition on 0; use-after-free.
  WARNING: CPU: 5 PID: 10100 at lib/refcount.c:25 refcount_warn_saturate
  ...
  Call trace:
   refcount_warn_saturate
   [fastrpc_map_get inlined]
   [fastrpc_map_lookup inlined]
   fastrpc_map_create
   fastrpc_internal_invoke
   fastrpc_device_ioctl
   __arm64_sys_ioctl
   invoke_syscall
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:05:25Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/079c78c68714f7d8d58e66c477b0243b31806907
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/556dfdb226ce1e5231d8836159b23f8bb0395bf4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/61a0890cb95afec5c8a2f4a879de2b6220984ef1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/96b328d119eca7563c1edcc4e1039a62e6370ecb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b171d0d2cf1b8387c72c8d325c5d5746fa271e39
    reference_type:
    reference_id:
