advisory_id: CVE-2024-45389
datasource_id: vulnrichment_importer_v2/CVE-2024-45389
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/45xxx/CVE-2024-45389.json
aliases: []
summary: Pagefind, a fully static search library, initializes its dynamic JavaScript and WebAssembly
  files relative to the location of the first script the user loads. This information is gathered
  by looking up the value of `document.currentScript.src`. Prior to Pagefind version 1.1.1,
  it is possible to "clobber" this lookup with otherwise benign HTML on the page. This will
  cause `document.currentScript.src` to resolve as an external domain, which will then be used
  by Pagefind to load dependencies. This exploit would only work in the case that an attacker
  could inject HTML to a live, hosted, website. In these cases, this would act as a way to escalate
  the privilege available to an attacker. This assumes they have the ability to add some elements
  to the page (for example, `img` tags with a `name` attribute), but not others, as adding a
  `script` to the page would itself be the cross-site scripting vector. Pagefind has tightened
  this resolution in version 1.1.1 by ensuring the source is loaded from a valid script element.
  There are no reports of this being exploited in the wild via Pagefind.
impacted_packages: []
severities:
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-03T20:02:11Z/
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/CloudCannon/pagefind/commit/14ec96864eabaf1d7d809d5da0186a8856261eeb
    reference_type:
    reference_id:
  - url: https://github.com/CloudCannon/pagefind/security/advisories/GHSA-gprj-6m2f-j9hx
    reference_type:
    reference_id:
  - url: https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986
    reference_type:
    reference_id:
