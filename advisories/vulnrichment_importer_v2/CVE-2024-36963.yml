advisory_id: CVE-2024-36963
datasource_id: vulnrichment_importer_v2/CVE-2024-36963
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/36xxx/CVE-2024-36963.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tracefs: Reset permissions on remount if permissions are options

  There's an inconsistency with the way permissions are handled in tracefs.
  Because the permissions are generated when accessed, they default to the
  root inode's permission if they were never set by the user. If the user
  sets the permissions, then a flag is set and the permissions are saved via
  the inode (for tracefs files) or an internal attribute field (for
  eventfs).

  But if a remount happens that specify the permissions, all the files that
  were not changed by the user gets updated, but the ones that were are not.
  If the user were to remount the file system with a given permission, then
  all files and directories within that file system should be updated.

  This can cause security issues if a file's permission was updated but the
  admin forgot about it. They could incorrectly think that remounting with
  permissions set would update all files, but miss some.

  For example:

   # cd /sys/kernel/tracing
   # chgrp 1002 current_tracer
   # ls -l
  [..]
   -rw-r-----  1 root root 0 May  1 21:25 buffer_size_kb
   -rw-r-----  1 root root 0 May  1 21:25 buffer_subbuf_size_kb
   -r--r-----  1 root root 0 May  1 21:25 buffer_total_size_kb
   -rw-r-----  1 root lkp  0 May  1 21:25 current_tracer
   -rw-r-----  1 root root 0 May  1 21:25 dynamic_events
   -r--r-----  1 root root 0 May  1 21:25 dyn_ftrace_total_info
   -r--r-----  1 root root 0 May  1 21:25 enabled_functions

  Where current_tracer now has group "lkp".

   # mount -o remount,gid=1001 .
   # ls -l
   -rw-r-----  1 root tracing 0 May  1 21:25 buffer_size_kb
   -rw-r-----  1 root tracing 0 May  1 21:25 buffer_subbuf_size_kb
   -r--r-----  1 root tracing 0 May  1 21:25 buffer_total_size_kb
   -rw-r-----  1 root lkp     0 May  1 21:25 current_tracer
   -rw-r-----  1 root tracing 0 May  1 21:25 dynamic_events
   -r--r-----  1 root tracing 0 May  1 21:25 dyn_ftrace_total_info
   -r--r-----  1 root tracing 0 May  1 21:25 enabled_functions

  Everything changed but the "current_tracer".

  Add a new link list that keeps track of all the tracefs_inodes which has
  the permission flags that tell if the file/dir should use the root inode's
  permission or not. Then on remount, clear all the flags so that the
  default behavior of using the root inode's permission is done for all
  files and directories.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-05-20T14:06:38Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/414fb08628143203d29ccd0264b5a83fb9523c03
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5f91fc82794d4a6e41cdcd02d00baa377d94ca78
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/baa23a8d4360d981a49913841a726edede5cdd54
    reference_type:
    reference_id:
