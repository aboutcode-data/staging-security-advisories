advisory_id: CVE-2025-68146
datasource_id: vulnrichment_importer_v2/CVE-2025-68146
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/68xxx/CVE-2025-68146.json
aliases: []
summary: 'filelock is a platform-independent file lock for Python. In versions prior to 3.20.1,
  a Time-of-Check-Time-of-Use (TOCTOU) race condition allows local attackers to corrupt or truncate
  arbitrary user files through symlink attacks. The vulnerability exists in both Unix and Windows
  lock file creation where filelock checks if a file exists before opening it with O_TRUNC.
  An attacker can create a symlink pointing to a victim file in the time gap between the check
  and open, causing os.open() to follow the symlink and truncate the target file. All users
  of filelock on Unix, Linux, macOS, and Windows systems are impacted. The vulnerability cascades
  to dependent libraries. The attack requires local filesystem access and ability to create
  symlinks (standard user permissions on Unix; Developer Mode on Windows 10+). Exploitation
  succeeds within 1-3 attempts when lock file paths are predictable. The issue is fixed in version
  3.20.1. If immediate upgrade is not possible, use SoftFileLock instead of UnixFileLock/WindowsFileLock
  (note: different locking semantics, may not be suitable for all use cases); ensure lock file
  directories have restrictive permissions (chmod 0700) to prevent untrusted users from creating
  symlinks; and/or monitor lock file directories for suspicious symlinks before running trusted
  applications. These workarounds provide only partial mitigation. The race condition remains
  exploitable. Upgrading to version 3.20.1 is strongly recommended.'
impacted_packages: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-17T14:51:03Z/
    published_at: None
    url:
weaknesses:
  - CWE-362
  - CWE-59
  - CWE-367
references:
  - url: https://github.com/tox-dev/filelock/commit/4724d7f8c3393ec1f048c93933e6e3e6ec321f0e
    reference_type:
    reference_id:
  - url: https://github.com/tox-dev/filelock/pull/461
    reference_type:
    reference_id:
  - url: https://github.com/tox-dev/filelock/releases/tag/3.20.1
    reference_type:
    reference_id:
  - url: https://github.com/tox-dev/filelock/security/advisories/GHSA-w853-jp5j-5j7f
    reference_type:
    reference_id:
