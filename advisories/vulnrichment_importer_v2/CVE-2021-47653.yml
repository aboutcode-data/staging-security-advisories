advisory_id: CVE-2021-47653
datasource_id: vulnrichment_importer_v2/CVE-2021-47653
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47653.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  media: davinci: vpif: fix use-after-free on driver unbind

  The driver allocates and registers two platform device structures during
  probe, but the devices were never deregistered on driver unbind.

  This results in a use-after-free on driver unbind as the device
  structures were allocated using devres and would be freed by driver
  core when remove() returns.

  Fix this by adding the missing deregistration calls to the remove()
  callback and failing probe on registration errors.

  Note that the platform device structures must be freed using a proper
  release callback to avoid leaking associated resources like device
  names.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-02-27T18:17:48Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/43acb728bbc40169d2e2425e84a80068270974be
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6512c3c39cb6b573b791ce45365818a38b76afbe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ffc602e14d7b9f7e7cb2f67e18dfef9ef8af676
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b5a3bb7f6f164eb6ee74ef4898dcd019b2063448
    reference_type:
    reference_id:
