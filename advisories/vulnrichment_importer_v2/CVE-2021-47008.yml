advisory_id: CVE-2021-47008
datasource_id: vulnrichment_importer_v2/CVE-2021-47008
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47008.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  KVM: SVM: Make sure GHCB is mapped before updating

  Access to the GHCB is mainly in the VMGEXIT path and it is known that the
  GHCB will be mapped. But there are two paths where it is possible the GHCB
  might not be mapped.

  The sev_vcpu_deliver_sipi_vector() routine will update the GHCB to inform
  the caller of the AP Reset Hold NAE event that a SIPI has been delivered.
  However, if a SIPI is performed without a corresponding AP Reset Hold,
  then the GHCB might not be mapped (depending on the previous VMEXIT),
  which will result in a NULL pointer dereference.

  The svm_complete_emulated_msr() routine will update the GHCB to inform
  the caller of a RDMSR/WRMSR operation about any errors. While it is likely
  that the GHCB will be mapped in this situation, add a safe guard
  in this path to be certain a NULL pointer dereference is not encountered.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T15:58:15Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/a3ba26ecfb569f4aa3f867e80c02aa65f20aadad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fb9e14f4f8217a0980f8da2c8ff70dee058cbe47
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fd722a57fe0b80133dacae4e1c852ee4212f9b2e
    reference_type:
    reference_id:
