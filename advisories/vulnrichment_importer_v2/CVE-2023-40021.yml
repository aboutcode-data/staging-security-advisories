advisory_id: CVE-2023-40021
datasource_id: vulnrichment_importer_v2/CVE-2023-40021
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/40xxx/CVE-2023-40021.json
aliases: []
summary: Oppia is an online learning platform. When comparing a received CSRF token against
  the expected token, Oppia uses the string equality operator (`==`), which is not safe against
  timing attacks. By repeatedly submitting invalid tokens, an attacker can brute-force the expected
  CSRF token character by character. Once they have recovered the token, they can then submit
  a forged request on behalf of a logged-in user and execute privileged actions on that user's
  behalf. In particular the function to validate received CSRF tokens is at `oppia.core.controllers.base.CsrfTokenManager.is_csrf_token_valid`.
  An attacker who can lure a logged-in Oppia user to a malicious website can perform any change
  on Oppia that the user is authorized to do, including changing profile information; creating,
  deleting, and changing explorations; etc. Note that the attacker cannot change a user's login
  credentials. An attack would need to complete within 1 second because every second, the time
  used in computing the token changes. This issue has been addressed in commit `b89bf80837`
  which has been included in release `3.3.2-hotfix-2`. Users are advised to upgrade. There are
  no known workarounds for this vulnerability.
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-03T13:33:01Z/
    published_at: None
    url:
weaknesses:
  - CWE-208
  - CWE-203
references:
  - url: https://github.com/oppia/oppia/blob/3a05c3558a292f3db9e658e60e708c266c003fd0/core/controllers/base.py#L964-L990
    reference_type:
    reference_id:
  - url: https://github.com/oppia/oppia/commit/b89bf808378c1236874b5797a7bda32c77b4af23
    reference_type:
    reference_id:
  - url: https://github.com/oppia/oppia/pull/18769
    reference_type:
    reference_id:
  - url: https://github.com/oppia/oppia/security/advisories/GHSA-49jp-pjc3-2532
    reference_type:
    reference_id:
