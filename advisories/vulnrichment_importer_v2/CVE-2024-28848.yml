advisory_id: CVE-2024-28848
datasource_id: vulnrichment_importer_v2/CVE-2024-28848
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/28xxx/CVE-2024-28848.json
aliases: []
summary: OpenMetadata is a unified platform for discovery, observability, and governance powered
  by a central metadata repository, in-depth lineage, and seamless team collaboration. The `â€ŽCompiledRule::validateExpression`
  method evaluates an SpEL expression using an `StandardEvaluationContext`, allowing the expression
  to reach and interact with Java classes such as `java.lang.Runtime`, leading to Remote Code
  Execution. The `/api/v1/policies/validation/condition/<expression>` endpoint passes user-controlled
  data `CompiledRule::validateExpession` allowing authenticated (non-admin) users to execute
  arbitrary system commands on the underlaying operating system. In addition, there is a missing
  authorization check since `Authorizer.authorize()` is never called in the affected path and
  therefore any authenticated non-admin user is able to trigger this endpoint and evaluate arbitrary
  SpEL expressions leading to arbitrary command execution. This vulnerability was discovered
  with the help of CodeQL's Expression language injection (Spring) query and is also tracked
  as `GHSL-2023-236`. This issue may lead to Remote Code Execution and has been resolved in
  version 1.2.4. Users are advised to upgrade. There are no known workarounds for this vulnerability.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-07-19T16:59:58Z/
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://codeql.github.com/codeql-query-help/java/java-spel-expression-injection
    reference_type:
    reference_id:
  - url: https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/security/policyevaluator/CompiledRule.java#L51
    reference_type:
    reference_id:
  - url: https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/security/policyevaluator/CompiledRule.java#L57
    reference_type:
    reference_id:
  - url: https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-5xv3-fm7g-865r
    reference_type:
    reference_id:
