advisory_id: CVE-2024-28183
datasource_id: vulnrichment_importer_v2/CVE-2024-28183
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/28xxx/CVE-2024-28183.json
aliases: []
summary: ESP-IDF is the development framework for Espressif SoCs supported on Windows, Linux
  and macOS. A Time-of-Check to Time-of-Use (TOCTOU) vulnerability was discovered in the implementation
  of the ESP-IDF bootloader which could allow an attacker with physical access to flash of the
  device to bypass anti-rollback protection. Anti-rollback prevents rollback to application
  with security version lower than one programmed in eFuse of chip. This attack can allow to
  boot past (passive) application partition having lower security version of the same device
  even in the presence of the flash encryption scheme. The attack requires carefully modifying
  the flash contents after the anti-rollback checks have been performed by the bootloader (before
  loading the application). The vulnerability is fixed in 4.4.7 and 5.2.1.
impacted_packages: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-03-25T19:26:58Z/
    published_at: None
    url:
weaknesses:
  - CWE-367
references:
  - url: https://github.com/espressif/esp-idf/commit/3305cb4d235182067936f8e940e6db174e25b4b2
    reference_type:
    reference_id:
  - url: https://github.com/espressif/esp-idf/commit/4c95aa445d4e84f01f86b6f3a552aa299276abf3
    reference_type:
    reference_id:
  - url: https://github.com/espressif/esp-idf/commit/534e3ad1fa68526a5f989fb2163856d6b7cd2c87
    reference_type:
    reference_id:
  - url: https://github.com/espressif/esp-idf/commit/7003f1ef0dffc73c34eb153d1b0710babb078149
    reference_type:
    reference_id:
  - url: https://github.com/espressif/esp-idf/commit/b2cdc0678965790f49afeb6e6b0737cd24433a05
    reference_type:
    reference_id:
  - url: https://github.com/espressif/esp-idf/commit/c33b9e1426121ce8cccf1a94241740be9cff68de
    reference_type:
    reference_id:
  - url: https://github.com/espressif/esp-idf/commit/f327ddf6adab0c28d395975785727b2feef57803
    reference_type:
    reference_id:
  - url: https://github.com/espressif/esp-idf/security/advisories/GHSA-22x6-3756-pfp8
    reference_type:
    reference_id:
