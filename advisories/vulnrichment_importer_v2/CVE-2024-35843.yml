advisory_id: CVE-2024-35843
datasource_id: vulnrichment_importer_v2/CVE-2024-35843
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/35xxx/CVE-2024-35843.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  iommu/vt-d: Use device rbtree in iopf reporting path

  The existing I/O page fault handler currently locates the PCI device by
  calling pci_get_domain_bus_and_slot(). This function searches the list
  of all PCI devices until the desired device is found. To improve lookup
  efficiency, replace it with device_rbtree_find() to search the device
  within the probed device rbtree.

  The I/O page fault is initiated by the device, which does not have any
  synchronization mechanism with the software to ensure that the device
  stays in the probed device tree. Theoretically, a device could be released
  by the IOMMU subsystem after device_rbtree_find() and before
  iopf_get_dev_fault_param(), which would cause a use-after-free problem.

  Add a mutex to synchronize the I/O page fault reporting path and the IOMMU
  release device path. This lock doesn't introduce any performance overhead,
  as the conflict between I/O page fault reporting and device releasing is
  very rare.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-04T19:36:46Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3d39238991e745c5df85785604f037f35d9d1b15
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/def054b01a867822254e1dda13d587f5c7a99e2a
    reference_type:
    reference_id:
