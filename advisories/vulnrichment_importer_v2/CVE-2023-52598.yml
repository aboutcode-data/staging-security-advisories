advisory_id: CVE-2023-52598
datasource_id: vulnrichment_importer_v2/CVE-2023-52598
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/52xxx/CVE-2023-52598.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  s390/ptrace: handle setting of fpc register correctly

  If the content of the floating point control (fpc) register of a traced
  process is modified with the ptrace interface the new value is tested for
  validity by temporarily loading it into the fpc register.

  This may lead to corruption of the fpc register of the tracing process:
  if an interrupt happens while the value is temporarily loaded into the
  fpc register, and within interrupt context floating point or vector
  registers are used, the current fp/vx registers are saved with
  save_fpu_regs() assuming they belong to user space and will be loaded into
  fp/vx registers when returning to user space.

  test_fp_ctl() restores the original user space fpc register value, however
  it will be discarded, when returning to user space.

  In result the tracer will incorrectly continue to run with the value that
  was supposed to be used for the traced process.

  Fix this by saving fpu register contents with save_fpu_regs() before using
  test_fp_ctl().
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-03-11T15:45:25Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/02c6bbfb08bad78dd014e24c7b893723c15ec7a1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/28a1f492cb527f64593457a0a0f0d809b3f36c25
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6ccf904aac0292e1f6b1a1be6c407c414f7cf713
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6d0822f2cc9b153bf2df49a84599195a2e0d21a8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7a4d6481fbdd661f9e40e95febb95e3dee82bad3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/856caf2730ea18cb39e95833719c02a02447dc0a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8b13601d19c541158a6e18b278c00ba69ae37829
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bdce67df7f12fb0409fbc604ce7c4254703f56d4
    reference_type:
    reference_id:
