advisory_id: CVE-2022-48827
datasource_id: vulnrichment_importer_v2/CVE-2022-48827
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48827.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  NFSD: Fix the behavior of READ near OFFSET_MAX

  Dan Aloni reports:
  > Due to commit 8cfb9015280d ("NFS: Always provide aligned buffers to
  > the RPC read layers") on the client, a read of 0xfff is aligned up
  > to server rsize of 0x1000.
  >
  > As a result, in a test where the server has a file of size
  > 0x7fffffffffffffff, and the client tries to read from the offset
  > 0x7ffffffffffff000, the read causes loff_t overflow in the server
  > and it returns an NFS code of EINVAL to the client. The client as
  > a result indefinitely retries the request.

  The Linux NFS client does not handle NFS?ERR_INVAL, even though all
  NFS specifications permit servers to return that status code for a
  READ.

  Instead of NFS?ERR_INVAL, have out-of-range READ requests succeed
  and return a short result. Set the EOF flag in the result to prevent
  the client from retrying the READ request. This behavior appears to
  be consistent with Solaris NFS servers.

  Note that NFSv3 and NFSv4 use u64 offset values on the wire. These
  must be converted to loff_t internally before use -- an implicit
  type cast is not adequate for this purpose. Otherwise VFS checks
  against sb->s_maxbytes do not work properly.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:57:40Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0cb4d23ae08c48f6bf3c29a8e5c4a74b8388b960
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1726a39b0879acfb490b22dca643f26f4f907da9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/44502aca8e02ab32d6b0eb52e006a5ec9402719b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c6eff5c4277146a78b4fb8c9b668dd64542c41b0
    reference_type:
    reference_id:
