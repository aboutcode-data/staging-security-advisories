advisory_id: CVE-2021-47527
datasource_id: vulnrichment_importer_v2/CVE-2021-47527
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47527.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  serial: core: fix transmit-buffer reset and memleak

  Commit 761ed4a94582 ("tty: serial_core: convert uart_close to use
  tty_port_close") converted serial core to use tty_port_close() but
  failed to notice that the transmit buffer still needs to be freed on
  final close.

  Not freeing the transmit buffer means that the buffer is no longer
  cleared on next open so that any ioctl() waiting for the buffer to drain
  might wait indefinitely (e.g. on termios changes) or that stale data can
  end up being transmitted in case tx is restarted.

  Furthermore, the buffer of any port that has been opened would leak on
  driver unbind.

  Note that the port lock is held when clearing the buffer pointer due to
  the ldisc race worked around by commit a5ba1d95e46e ("uart: fix race
  between uart_put_char() and uart_shutdown()").

  Also note that the tty-port shutdown() callback is not called for
  console ports so it is not strictly necessary to free the buffer page
  after releasing the lock (cf. d72402145ace ("tty/serial: do not free
  trasnmit buffer page under port lock")).
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-10T18:53:22Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/00de977f9e0aa9760d9a79d1e41ff780f74e3424
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/011f6c92b5bf6e1fbfdedc8b5232f64c1c493206
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1179b168fa3f3a6aae3bd140000455a0e58457db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/64e491c1634b73d3bddc081d08620bdc92ab2c12
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c5da8aa441053958594f94254592bb41264bdfbf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e1722acf4f0d4d67b60f57e08ce16f8b66cd4b8f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e74d9663fd57640fc3394abb5c76fa95b9cc2f2e
    reference_type:
    reference_id:
