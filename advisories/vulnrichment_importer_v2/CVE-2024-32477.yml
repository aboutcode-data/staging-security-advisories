advisory_id: CVE-2024-32477
datasource_id: vulnrichment_importer_v2/CVE-2024-32477
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/32xxx/CVE-2024-32477.json
aliases: []
summary: Deno is a JavaScript, TypeScript, and WebAssembly runtime with secure defaults. By
  using ANSI escape sequences and a race between `libc::tcflush(0, libc::TCIFLUSH)` and reading
  standard input, it's possible to manipulate the permission prompt and force it to allow an
  unsafe action regardless of the user input. Some ANSI escape sequences act as a info request
  to the master terminal emulator and the terminal emulator sends back the reply in the PTY
  channel. standard streams also use this channel to send and get data. For example the `\033[6n`
  sequence requests the current cursor position. These sequences allow us to append data to
  the standard input of Deno. This vulnerability allows an attacker to bypass Deno permission
  policy.  This vulnerability is fixed in 1.42.2.
impacted_packages: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-04-22T20:24:47Z/
    published_at: None
    url:
weaknesses:
  - CWE-362
  - CWE-78
references:
  - url: https://github.com/denoland/deno/security/advisories/GHSA-95cj-3hr2-7j5j
    reference_type:
    reference_id:
