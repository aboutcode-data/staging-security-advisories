advisory_id: CVE-2024-57874
datasource_id: vulnrichment_importer_v2/CVE-2024-57874
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/57xxx/CVE-2024-57874.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  arm64: ptrace: fix partial SETREGSET for NT_ARM_TAGGED_ADDR_CTRL

  Currently tagged_addr_ctrl_set() doesn't initialize the temporary 'ctrl'
  variable, and a SETREGSET call with a length of zero will leave this
  uninitialized. Consequently tagged_addr_ctrl_set() will consume an
  arbitrary value, potentially leaking up to 64 bits of memory from the
  kernel stack. The read is limited to a specific slot on the stack, and
  the issue does not provide a write mechanism.

  As set_tagged_addr_ctrl() only accepts values where bits [63:4] zero and
  rejects other values, a partial SETREGSET attempt will randomly succeed
  or fail depending on the value of the uninitialized value, and the
  exposure is significantly limited.

  Fix this by initializing the temporary value before copying the regset
  from userspace, as for other regsets (e.g. NT_PRSTATUS, NT_PRFPREG,
  NT_ARM_SYSTEM_CALL). In the case of a zero-length write, the existing
  value of the tagged address ctrl will be retained.

  The NT_ARM_TAGGED_ADDR_CTRL regset is only visible in the
  user_aarch64_view used by a native AArch64 task to manipulate another
  native AArch64 task. As get_tagged_addr_ctrl() only returns an error
  value when called for a compat task, tagged_addr_ctrl_get() and
  tagged_addr_ctrl_set() should never observe an error value from
  get_tagged_addr_ctrl(). Add a WARN_ON_ONCE() to both to indicate that
  such an error would be unexpected, and error handlnig is not missing in
  either case.
impacted_packages: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T19:54:58Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1152dd13845efde5554f80c7e1233bae1d26bd3e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1370cf3eb5495d70e00547598583a4cd45b40b99
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1c176f5155ee6161fee6f416b64aa50394d3f220
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/96035c0093db258975b8887676afe59a64c34a72
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/abd614bbfcee73247495bd9472da8f85ac83546e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca62d90085f4af36de745883faab9f8a7cbb45d3
    reference_type:
    reference_id:
