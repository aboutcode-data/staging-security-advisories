advisory_id: CVE-2022-24817
datasource_id: vulnrichment_importer_v2/CVE-2022-24817
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/24xxx/CVE-2022-24817.json
aliases: []
summary: Flux2 is an open and extensible continuous delivery solution for Kubernetes. Flux2
  versions between 0.1.0 and 0.29.0, helm-controller 0.1.0 to v0.19.0, and kustomize-controller
  0.1.0 to v0.23.0 are vulnerable to Code Injection via malicious Kubeconfig. In multi-tenancy
  deployments this can also lead to privilege escalation if the controller's service account
  has elevated permissions. Workarounds include disabling functionality via Validating Admission
  webhooks by restricting users from setting the `spec.kubeConfig` field in Flux `Kustomization`
  and `HelmRelease` objects. Additional mitigations include applying restrictive AppArmor and
  SELinux profiles on the controllerâ€™s pod to limit what binaries can be executed. This vulnerability
  is fixed in kustomize-controller v0.23.0 and helm-controller v0.19.0, both included in flux2
  v0.29.0
impacted_packages: []
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:53:22Z/
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://github.com/fluxcd/flux2/security/advisories/GHSA-vvmq-fwmg-2gjc
    reference_type:
    reference_id:
