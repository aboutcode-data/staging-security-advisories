advisory_id: CVE-2025-37805
datasource_id: vulnrichment_importer_v2/CVE-2025-37805
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/37xxx/CVE-2025-37805.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sound/virtio: Fix cancel_sync warnings on uninitialized work_structs

  Betty reported hitting the following warning:

  [    8.709131][  T221] WARNING: CPU: 2 PID: 221 at kernel/workqueue.c:4182
  ...
  [    8.713282][  T221] Call trace:
  [    8.713365][  T221]  __flush_work+0x8d0/0x914
  [    8.713468][  T221]  __cancel_work_sync+0xac/0xfc
  [    8.713570][  T221]  cancel_work_sync+0x24/0x34
  [    8.713667][  T221]  virtsnd_remove+0xa8/0xf8 [virtio_snd ab15f34d0dd772f6d11327e08a81d46dc9c36276]
  [    8.713868][  T221]  virtsnd_probe+0x48c/0x664 [virtio_snd ab15f34d0dd772f6d11327e08a81d46dc9c36276]
  [    8.714035][  T221]  virtio_dev_probe+0x28c/0x390
  [    8.714139][  T221]  really_probe+0x1bc/0x4c8
  ...

  It seems we're hitting the error path in virtsnd_probe(), which
  triggers a virtsnd_remove() which iterates over the substreams
  calling cancel_work_sync() on the elapsed_period work_struct.

  Looking at the code, from earlier in:
  virtsnd_probe()->virtsnd_build_devs()->virtsnd_pcm_parse_cfg()

  We set snd->nsubstreams, allocate the snd->substreams, and if
  we then hit an error on the info allocation or something in
  virtsnd_ctl_query_info() fails, we will exit without having
  initialized the elapsed_period work_struct.

  When that error path unwinds we then call virtsnd_remove()
  which as long as the substreams array is allocated, will iterate
  through calling cancel_work_sync() on the uninitialized work
  struct hitting this warning.

  Takashi Iwai suggested this fix, which initializes the substreams
  structure right after allocation, so that if we hit the error
  paths we avoid trying to cleanup uninitialized data.

  Note: I have not yet managed to reproduce the issue myself, so
  this patch has had limited testing.

  Feedback or thoughts would be appreciated!
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T14:54:46Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3c7df2e27346eb40a0e86230db1ccab195c97cfe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/54c7b864fbe4423a07b443a4ada0106052942116
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5be9407b41eae20eef9140f5cfbfcbc3d01aaf45
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/66046b586c0aaa9332483bcdbd76e3305d6138e9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9908498ce929a5a052b79bb7942f9ea317312ce4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e03b10c45c7675b6098190c6e7de1b656d8bcdbe
    reference_type:
    reference_id:
