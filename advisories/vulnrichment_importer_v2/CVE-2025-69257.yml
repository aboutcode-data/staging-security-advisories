advisory_id: CVE-2025-69257
datasource_id: vulnrichment_importer_v2/CVE-2025-69257
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/69xxx/CVE-2025-69257.json
aliases: []
summary: theshit is a command-line utility that automatically detects and fixes common mistakes
  in shell commands. Prior to version 0.1.1, the application loads custom Python rules and configuration
  files from user-writable locations (e.g., `~/.config/theshit/`) without validating ownership
  or permissions when executed with elevated privileges. If the tool is invoked with `sudo`
  or otherwise runs with an effective UID of root, it continues to trust configuration files
  originating from the unprivileged user's environment. This allows a local attacker to inject
  arbitrary Python code via a malicious rule or configuration file, which is then executed with
  root privileges. Any system where this tool is executed with elevated privileges is affected.
  In environments where the tool is permitted to run via `sudo` without a password (`NOPASSWD`),
  a local unprivileged user can escalate privileges to root without additional interaction.
  The issue has been fixed in version 0.1.1. The patch introduces strict ownership and permission
  checks for all configuration files and custom rules. The application now enforces that rules
  are only loaded if they are owned by the effective user executing the tool. When executed
  with elevated privileges (`EUID=0`), the application refuses to load any files that are not
  owned by root or that are writable by non-root users. When executed as a non-root user, it
  similarly refuses to load rules owned by other users. This prevents both vertical and horizontal
  privilege escalation via execution of untrusted code. If upgrading is not possible, users
  should avoid executing the application with `sudo` or as the root user. As a temporary mitigation,
  ensure that directories containing custom rules and configuration files are owned by root
  and are not writable by non-root users. Administrators may also audit existing custom rules
  before running the tool with elevated privileges.
impacted_packages: []
severities:
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-12-30T19:28:06Z/
    published_at: None
    url:
weaknesses:
  - CWE-829
  - CWE-269
  - CWE-284
references:
  - url: https://github.com/AsfhtgkDavid/theshit/commit/8e0b565e7876a83b0e1cfbacb8af39dadfdcc500
    reference_type:
    reference_id:
  - url: https://github.com/AsfhtgkDavid/theshit/security/advisories/GHSA-95qg-89c2-w5hj
    reference_type:
    reference_id:
