advisory_id: CVE-2024-47674
datasource_id: vulnrichment_importer_v2/CVE-2024-47674
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/47xxx/CVE-2024-47674.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm: avoid leaving partial pfn mappings around in error case

  As Jann points out, PFN mappings are special, because unlike normal
  memory mappings, there is no lifetime information associated with the
  mapping - it is just a raw mapping of PFNs with no reference counting of
  a 'struct page'.

  That's all very much intentional, but it does mean that it's easy to
  mess up the cleanup in case of errors.  Yes, a failed mmap() will always
  eventually clean up any partial mappings, but without any explicit
  lifetime in the page table mapping itself, it's very easy to do the
  error handling in the wrong order.

  In particular, it's easy to mistakenly free the physical backing store
  before the page tables are actually cleaned up and (temporarily) have
  stale dangling PTE entries.

  To make this situation less error-prone, just make sure that any partial
  pfn mapping is torn down early, before any other error handling.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-15T12:44:14Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3213fdcab961026203dd587a4533600c70b3336b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35770ca6180caa24a2b258c99a87bd437a1ee10f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5b2c8b34f6d76bfbd1dd4936eb8a0fbfb9af3959
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/65d0db500d7c07f0f76fc24a4d837791c4862cd2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/79a61cc3fc0466ad2b7b89618a6157785f0293b3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/954fd4c81f22c4b6ba65379a81fd252971bf4ef3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a95a24fcaee1b892e47d5e6dcc403f713874ee80
    reference_type:
    reference_id:
  - url: https://project-zero.issues.chromium.org/issues/366053091
    reference_type:
    reference_id:
