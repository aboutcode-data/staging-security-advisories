advisory_id: CVE-2024-36883
datasource_id: vulnrichment_importer_v2/CVE-2024-36883
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/36xxx/CVE-2024-36883.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: fix out-of-bounds access in ops_init

  net_alloc_generic is called by net_alloc, which is called without any
  locking. It reads max_gen_ptrs, which is changed under pernet_ops_rwsem. It
  is read twice, first to allocate an array, then to set s.len, which is
  later used to limit the bounds of the array access.

  It is possible that the array is allocated and another thread is
  registering a new pernet ops, increments max_gen_ptrs, which is then used
  to set s.len with a larger than allocated length for the variable array.

  Fix it by reading max_gen_ptrs only once in net_alloc_generic. If
  max_gen_ptrs is later incremented, it will be caught in net_assign_generic.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-12T19:28:57Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0c3248bc708a7797be573214065cf908ff1f54c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2d60ff5874aefd006717ca5e22ac1e25eac29c42
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3cdc34d76c4f777579e28ad373979d36c030cfd3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b0e64583eab8c1d896b47e5dd0bf2e7d86ec41f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9518b79bfd2fbf99fa9b7e8e36bcb1825e7ba030
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a26ff37e624d12e28077e5b24d2b264f62764ad6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b6dbfd5bcc267a95a0bf1bf96af46243f96ec6cd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f4f94587e1bf87cb40ec33955a9d90148dd026ab
    reference_type:
    reference_id:
