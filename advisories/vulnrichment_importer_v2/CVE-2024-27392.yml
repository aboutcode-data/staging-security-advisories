advisory_id: CVE-2024-27392
datasource_id: vulnrichment_importer_v2/CVE-2024-27392
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/27xxx/CVE-2024-27392.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nvme: host: fix double-free of struct nvme_id_ns in ns_update_nuse()

  When nvme_identify_ns() fails, it frees the pointer to the struct
  nvme_id_ns before it returns. However, ns_update_nuse() calls kfree()
  for the pointer even when nvme_identify_ns() fails. This results in
  KASAN double-free, which was observed with blktests nvme/045 with
  proposed patches [1] on the kernel v6.8-rc7. Fix the double-free by
  skipping kfree() when nvme_identify_ns() fails.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T15:43:42Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/534f9dc7fe495b3f9cc84363898ac50c5a25fccb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8d0d2447394b13fb22a069f0330f9c49b7fff9d3
    reference_type:
    reference_id:
