advisory_id: CVE-2026-24905
datasource_id: vulnrichment_importer_v2/CVE-2026-24905
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2026/24xxx/CVE-2026-24905.json
aliases: []
summary: 'Inspektor Gadget is a set of tools and framework for data collection and system inspection
  on Kubernetes clusters and Linux hosts using eBPF. The `ig` binary provides a subcommand for
  image building, used to generate custom gadget OCI images. A part of this functionality is
  implemented in the file `inspektor-gadget/cmd/common/image/build.go`. The `Makefile.build`
  file is the Makefile template employed during the building process. This file includes user-controlled
  data in an unsafe fashion, specifically some parameters are embedded without an adequate escaping
  in the commands inside the Makefile. Prior to version 0.48.1, this implementation is vulnerable
  to command injection: an attacker able to control values in the `buildOptions` structure would
  be able to execute arbitrary commands during the building process. An attacker able to exploit
  this vulnerability would be able to execute arbitrary command on the Linux host where the
  `ig` command is launched, if images are built with the `--local` flag or on the build container
  invoked by `ig`, if the `--local` flag is not provided. The `buildOptions` structure is extracted
  from the YAML gadget manifest passed to the `ig image build` command. Therefore, the attacker
  would need a way to control either the full `build.yml` file passed to the `ig image build`
  command, or one of its options. Typically, this could happen in a CI/CD scenario that builds
  untrusted gadgets to verify correctness. Version 0.48.1 fixes the issue.'
impacted_packages: []
severities:
  - score: '6.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:P
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2026-01-30T14:39:04Z/
    published_at: None
    url:
weaknesses:
  - CWE-77
  - CWE-78
references:
  - url: https://github.com/inspektor-gadget/inspektor-gadget/commit/7c83ad84ff7a68565655253e2cf1c5d2da695c1a
    reference_type:
    reference_id:
  - url: https://github.com/inspektor-gadget/inspektor-gadget/security/advisories/GHSA-79qw-g77v-2vfh
    reference_type:
    reference_id:
