advisory_id: CVE-2024-47748
datasource_id: vulnrichment_importer_v2/CVE-2024-47748
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/47xxx/CVE-2024-47748.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  vhost_vdpa: assign irq bypass producer token correctly

  We used to call irq_bypass_unregister_producer() in
  vhost_vdpa_setup_vq_irq() which is problematic as we don't know if the
  token pointer is still valid or not.

  Actually, we use the eventfd_ctx as the token so the life cycle of the
  token should be bound to the VHOST_SET_VRING_CALL instead of
  vhost_vdpa_setup_vq_irq() which could be called by set_status().

  Fixing this by setting up irq bypass producer's token when handling
  VHOST_SET_VRING_CALL and un-registering the producer before calling
  vhost_vring_ioctl() to prevent a possible use after free as eventfd
  could have been released in vhost_vring_ioctl(). And such registering
  and unregistering will only be done if DRIVER_OK is set.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:58:17Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/02e9e9366fefe461719da5d173385b6685f70319
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0c170b1e918b9afac25e2bbd01eaa2bfc0ece8c0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7cf2fb51175cafe01df8c43fa15a06194a59c6e2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/927a2580208e0f9b0b47b08f1c802b7233a7ba3c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca64edd7ae93402af2596a952e0d94d545e2b9c0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ec5f1b54ceb23475049ada6e7a43452cf4df88d1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fae9b1776f53aab93ab345bdbf653b991aed717d
    reference_type:
    reference_id:
