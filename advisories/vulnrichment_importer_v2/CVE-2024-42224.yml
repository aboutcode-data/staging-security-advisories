advisory_id: CVE-2024-42224
datasource_id: vulnrichment_importer_v2/CVE-2024-42224
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/42xxx/CVE-2024-42224.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: dsa: mv88e6xxx: Correct check for empty list

  Since commit a3c53be55c95 ("net: dsa: mv88e6xxx: Support multiple MDIO
  busses") mv88e6xxx_default_mdio_bus() has checked that the
  return value of list_first_entry() is non-NULL.

  This appears to be intended to guard against the list chip->mdios being
  empty.  However, it is not the correct check as the implementation of
  list_first_entry is not designed to return NULL for empty lists.

  Instead, use list_first_entry_or_null() which does return NULL if the
  list is empty.

  Flagged by Smatch.
  Compile tested only.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:14:41Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2a2fe25a103cef73cde356e6d09da10f607e93f5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3bf8d70e1455f87856640c3433b3660a31001618
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3f25b5f1635449036692a44b771f39f772190c1d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/47d28dde172696031c880c5778633cdca30394ee
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4c7f3950a9fd53a62b156c0fe7c3a2c43b0ba19b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8c2c3cca816d074c75a2801d1ca0dea7b0148114
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aa03f591ef31ba603a4a99d05d25a0f21ab1cd89
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f75625db838ade28f032dacd0f0c8baca42ecde4
    reference_type:
    reference_id:
