advisory_id: CVE-2022-49062
datasource_id: vulnrichment_importer_v2/CVE-2022-49062
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/49xxx/CVE-2022-49062.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  cachefiles: Fix KASAN slab-out-of-bounds in cachefiles_set_volume_xattr

  Use the actual length of volume coherency data when setting the
  xattr to avoid the following KASAN report.

   BUG: KASAN: slab-out-of-bounds in cachefiles_set_volume_xattr+0xa0/0x350 [cachefiles]
   Write of size 4 at addr ffff888101e02af4 by task kworker/6:0/1347

   CPU: 6 PID: 1347 Comm: kworker/6:0 Kdump: loaded Not tainted 5.18.0-rc1-nfs-fscache-netfs+ #13
   Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.14.0-4.fc34 04/01/2014
   Workqueue: events fscache_create_volume_work [fscache]
   Call Trace:
    <TASK>
    dump_stack_lvl+0x45/0x5a
    print_report.cold+0x5e/0x5db
    ? __lock_text_start+0x8/0x8
    ? cachefiles_set_volume_xattr+0xa0/0x350 [cachefiles]
    kasan_report+0xab/0x120
    ? cachefiles_set_volume_xattr+0xa0/0x350 [cachefiles]
    kasan_check_range+0xf5/0x1d0
    memcpy+0x39/0x60
    cachefiles_set_volume_xattr+0xa0/0x350 [cachefiles]
    cachefiles_acquire_volume+0x2be/0x500 [cachefiles]
    ? __cachefiles_free_volume+0x90/0x90 [cachefiles]
    fscache_create_volume_work+0x68/0x160 [fscache]
    process_one_work+0x3b7/0x6a0
    worker_thread+0x2c4/0x650
    ? process_one_work+0x6a0/0x6a0
    kthread+0x16c/0x1a0
    ? kthread_complete_and_exit+0x20/0x20
    ret_from_fork+0x22/0x30
    </TASK>

   Allocated by task 1347:
    kasan_save_stack+0x1e/0x40
    __kasan_kmalloc+0x81/0xa0
    cachefiles_set_volume_xattr+0x76/0x350 [cachefiles]
    cachefiles_acquire_volume+0x2be/0x500 [cachefiles]
    fscache_create_volume_work+0x68/0x160 [fscache]
    process_one_work+0x3b7/0x6a0
    worker_thread+0x2c4/0x650
    kthread+0x16c/0x1a0
    ret_from_fork+0x22/0x30

   The buggy address belongs to the object at ffff888101e02af0
   which belongs to the cache kmalloc-8 of size 8
   The buggy address is located 4 bytes inside of
   8-byte region [ffff888101e02af0, ffff888101e02af8)

   The buggy address belongs to the physical page:
   page:00000000a2292d70 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x101e02
   flags: 0x17ffffc0000200(slab|node=0|zone=2|lastcpupid=0x1fffff)
   raw: 0017ffffc0000200 0000000000000000 dead000000000001 ffff888100042280
   raw: 0000000000000000 0000000080660066 00000001ffffffff 0000000000000000
   page dumped because: kasan: bad access detected

   Memory state around the buggy address:
   ffff888101e02980: fc 00 fc fc fc fc 00 fc fc fc fc 00 fc fc fc fc
   ffff888101e02a00: 00 fc fc fc fc 00 fc fc fc fc 00 fc fc fc fc 00
   >ffff888101e02a80: fc fc fc fc 00 fc fc fc fc 00 fc fc fc fc 04 fc
                                                              ^
   ffff888101e02b00: fc fc fc 00 fc fc fc fc 00 fc fc fc fc 00 fc fc
   ffff888101e02b80: fc fc 00 fc fc fc fc 00 fc fc fc fc 00 fc fc fc
   ==================================================================
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-10-01T19:49:46Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/09a5df1b88c8f126c8ff9938edf160edd4e92f42
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b2f6c306601240635c72caa61f682e74d4591b2
    reference_type:
    reference_id:
