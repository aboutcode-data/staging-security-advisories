advisory_id: CVE-2023-6507
datasource_id: vulnrichment_importer_v2/CVE-2023-6507
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/6xxx/CVE-2023-6507.json
aliases: []
summary: |
  An issue was found in CPython 3.12.0 `subprocess` module on POSIX platforms. The issue was fixed in CPython 3.12.1 and does not affect other stable releases.

  When using the `extra_groups=` parameter with an empty list as a value (ie `extra_groups=[]`) the logic regressed to not call `setgroups(0, NULL)` before calling `exec()`, thus not dropping the original processes' groups before starting the new process. There is no issue when the parameter isn't used or when any value is used besides an empty list.

  This issue only impacts CPython processes run with sufficient privilege to make the `setgroups` system call (typically `root`).
impacted_packages: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-01-31T20:16:20Z/
    published_at: None
    url:
weaknesses:
  - CWE-269
references:
  - url: https://github.com/python/cpython/commit/10e9bb13b8dcaa414645b9bd10718d8f7179e82b
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/85bbfa8a4bbdbb61a3a84fbd7cb29a4096ab8a06
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/9fe7655c6ce0b8e9adc229daf681b6d30e6b1610
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/issues/112334
    reference_type:
    reference_id:
  - url: https://mail.python.org/archives/list/security-announce@python.org/thread/AUL7QFHBLILGISS7U63B47AYSSGJJQZD/
    reference_type:
    reference_id:
