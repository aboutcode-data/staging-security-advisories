advisory_id: CVE-2022-49004
datasource_id: vulnrichment_importer_v2/CVE-2022-49004
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/49xxx/CVE-2022-49004.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  riscv: Sync efi page table's kernel mappings before switching

  The EFI page table is initially created as a copy of the kernel page table.
  With VMAP_STACK enabled, kernel stacks are allocated in the vmalloc area:
  if the stack is allocated in a new PGD (one that was not present at the
  moment of the efi page table creation or not synced in a previous vmalloc
  fault), the kernel will take a trap when switching to the efi page table
  when the vmalloc kernel stack is accessed, resulting in a kernel panic.

  Fix that by updating the efi kernel mappings before switching to the efi
  page table.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-22T13:14:45Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3f105a742725a1b78766a55169f1d827732e62b8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/96f479383d92944406d4b3f2bc03c2f640def9f1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fa7a7d185ef380546b4b1fed6f84f31dbae8cec7
    reference_type:
    reference_id:
