advisory_id: CVE-2022-21658
datasource_id: vulnrichment_importer_v2/CVE-2022-21658
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/21xxx/CVE-2022-21658.json
aliases: []
summary: 'Rust is a multi-paradigm, general-purpose programming language designed for performance
  and safety, especially safe concurrency. The Rust Security Response WG was notified that the
  `std::fs::remove_dir_all` standard library function is vulnerable a race condition enabling
  symlink following (CWE-363). An attacker could use this security issue to trick a privileged
  program into deleting files and directories the attacker couldn''t otherwise access or delete.
  Rust 1.0.0 through Rust 1.58.0 is affected by this vulnerability with 1.58.1 containing a
  patch. Note that the following build targets don''t have usable APIs to properly mitigate
  the attack, and are thus still vulnerable even with a patched toolchain: macOS before version
  10.10 (Yosemite) and REDOX. We recommend everyone to update to Rust 1.58.1 as soon as possible,
  especially people developing programs expected to run in privileged contexts (including system
  daemons and setuid binaries), as those have the highest risk of being affected by this. Note
  that adding checks in your codebase before calling remove_dir_all will not mitigate the vulnerability,
  as they would also be vulnerable to race conditions like remove_dir_all itself. The existing
  mitigation is working as intended outside of race conditions.'
impacted_packages: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:L/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:52:12Z/
    published_at: None
    url:
weaknesses:
  - CWE-363
  - CWE-367
references:
  - url: https://blog.rust-lang.org/2022/01/20/cve-2022-21658.html
    reference_type:
    reference_id:
  - url: https://github.com/rust-lang/rust/pull/93110
    reference_type:
    reference_id:
  - url: https://github.com/rust-lang/rust/pull/93110/commits/32ed6e599bb4722efefd78bbc9cd7ec4613cb946
    reference_type:
    reference_id:
  - url: https://github.com/rust-lang/rust/pull/93110/commits/406cc071d6cfdfdb678bf3d83d766851de95abaf
    reference_type:
    reference_id:
  - url: https://github.com/rust-lang/rust/pull/93110/commits/4f0ad1c92ca08da6e8dc17838070975762f59714
    reference_type:
    reference_id:
  - url: https://github.com/rust-lang/rust/security/advisories/GHSA-r9cc-f5pr-p3j2
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7JKZDTBMGAWIFJSNWKBMPO5EAKRR4BEW/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BK32QZLHDC2OVLPKTUHNT2G3VHWHD4LX/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/C63NH72Q7UHJM5V3IVYRI7LVBGGFQMSQ/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CKGTACKMKAPRDPWPTU26GYWBELIRFF5N/
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202210-09
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT213182
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT213183
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT213186
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT213193
    reference_type:
    reference_id:
