advisory_id: CVE-2024-31204
datasource_id: vulnrichment_importer_v2/CVE-2024-31204
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/31xxx/CVE-2024-31204.json
aliases: []
summary: 'mailcow: dockerized is an open source groupware/email suite based on docker. A security
  vulnerability has been identified in mailcow affecting versions prior to 2024-04. This vulnerability
  resides in the exception handling mechanism, specifically when not operating in DEV_MODE.
  The system saves exception details into a session array without proper sanitization or encoding.
  These details are later rendered into HTML and executed in a JavaScript block within the user''s
  browser, without adequate escaping of HTML entities. This flaw allows for Cross-Site Scripting
  (XSS) attacks, where attackers can inject malicious scripts into the admin panel by triggering
  exceptions with controlled input. The exploitation method involves using any function that
  might throw an exception with user-controllable argument. This issue can lead to session hijacking
  and unauthorized administrative actions, posing a significant security risk. Version 2024-04
  contains a fix for the issue.'
impacted_packages: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-07-19T17:48:22Z/
    published_at: None
    url:
weaknesses:
  - CWE-79
references:
  - url: https://github.com/mailcow/mailcow-dockerized/security/advisories/GHSA-fp6h-63w4-5hcm
    reference_type:
    reference_id:
  - url: https://www.sonarsource.com/blog/remote-code-execution-in-mailcow-always-sanitize-error-messages
    reference_type:
    reference_id:
