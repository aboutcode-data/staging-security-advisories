advisory_id: CVE-2024-45004
datasource_id: vulnrichment_importer_v2/CVE-2024-45004
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/45xxx/CVE-2024-45004.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  KEYS: trusted: dcp: fix leak of blob encryption key

  Trusted keys unseal the key blob on load, but keep the sealed payload in
  the blob field so that every subsequent read (export) will simply
  convert this field to hex and send it to userspace.

  With DCP-based trusted keys, we decrypt the blob encryption key (BEK)
  in the Kernel due hardware limitations and then decrypt the blob payload.
  BEK decryption is done in-place which means that the trusted key blob
  field is modified and it consequently holds the BEK in plain text.
  Every subsequent read of that key thus send the plain text BEK instead
  of the encrypted BEK to userspace.

  This issue only occurs when importing a trusted DCP-based key and
  then exporting it again. This should rarely happen as the common use cases
  are to either create a new trusted key and export it, or import a key
  blob and then just use it without exporting it again.

  Fix this by performing BEK decryption and encryption in a dedicated
  buffer. Further always wipe the plain text BEK buffer to prevent leaking
  the key via uninitialized memory.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-04T20:18:21Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0e28bf61a5f9ab30be3f3b4eafb8d097e39446bb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e3b266afcfe4294e84496f50f006f029d3100db
    reference_type:
    reference_id:
