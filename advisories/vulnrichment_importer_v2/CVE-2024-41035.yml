advisory_id: CVE-2024-41035
datasource_id: vulnrichment_importer_v2/CVE-2024-41035
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/41xxx/CVE-2024-41035.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  USB: core: Fix duplicate endpoint bug by clearing reserved bits in the descriptor

  Syzbot has identified a bug in usbcore (see the Closes: tag below)
  caused by our assumption that the reserved bits in an endpoint
  descriptor's bEndpointAddress field will always be 0.  As a result of
  the bug, the endpoint_is_duplicate() routine in config.c (and possibly
  other routines as well) may believe that two descriptors are for
  distinct endpoints, even though they have the same direction and
  endpoint number.  This can lead to confusion, including the bug
  identified by syzbot (two descriptors with matching endpoint numbers
  and directions, where one was interrupt and the other was bulk).

  To fix the bug, we will clear the reserved bits in bEndpointAddress
  when we parse the descriptor.  (Note that both the USB-2.0 and USB-3.1
  specs say these bits are "Reserved, reset to zero".)  This requires us
  to make a copy of the descriptor earlier in usb_parse_endpoint() and
  use the copy instead of the original when checking for duplicates.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:23:33Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2bd8534a1b83c65702aec3cab164170f8e584188
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/37514a5c1251a8c5c95c323f55050736e7069ac7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/60abea505b726b38232a0ef410d2bd1994a77f78
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/647d61aef106dbed9c70447bcddbd4968e67ca64
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9edcf317620d7c6a8354911b69b874cf89716646
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a368ecde8a5055b627749b09c6218ef793043e47
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d09dd21bb5215d583ca9a1cb1464dbc77a7e88cf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d8418fd083d1b90a6c007cf8dcf81aeae274727b
    reference_type:
    reference_id:
