advisory_id: CVE-2023-22474
datasource_id: vulnrichment_importer_v2/CVE-2023-22474
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/22xxx/CVE-2023-22474.json
aliases: []
summary: Parse Server is an open source backend that can be deployed to any infrastructure that
  can run Node.js. Parse Server uses the request header `x-forwarded-for` to determine the client
  IP address. If Parse Server doesn't run behind a proxy server, then a client can set this
  header and Parse Server will trust the value of the header. The incorrect client IP address
  will be used by various features in Parse Server. This allows to circumvent the security mechanism
  of the Parse Server option `masterKeyIps` by setting an allowed IP address as the `x-forwarded-for`
  header value. This issue has been patched in version 5.4.1. The mechanism to determine the
  client IP address has been rewritten. The correct IP address determination now requires to
  set the Parse Server option `trustProxy`.
impacted_packages: []
severities:
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-08-01T17:36:20Z/
    published_at: None
    url:
weaknesses:
  - CWE-290
references:
  - url: https://github.com/parse-community/parse-server/commit/e016d813e083ce6828f9abce245d15b681a224d8
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/security/advisories/GHSA-vm5r-c87r-pf6x
    reference_type:
    reference_id:
