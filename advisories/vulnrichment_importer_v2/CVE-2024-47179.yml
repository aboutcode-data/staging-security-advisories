advisory_id: CVE-2024-47179
datasource_id: vulnrichment_importer_v2/CVE-2024-47179
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/47xxx/CVE-2024-47179.json
aliases: []
summary: RSSHub is an RSS network. Prior to commit 64e00e7, RSSHub's `docker-test-cont.yml`
  workflow is vulnerable to Artifact Poisoning, which could have lead to a full repository takeover.
  Downstream users of RSSHub are not vulnerable to this issue, and commit 64e00e7 fixed the
  underlying issue and made the repository no longer vulnerable. The `docker-test-cont.yml`
  workflow gets triggered when the `PR - Docker build test` workflow completes successfully.
  It then collects some information about the Pull Request that triggered the triggering workflow
  and set some labels depending on the PR body and sender. If the PR also contains a `routes`
  markdown block, it will set the `TEST_CONTINUE` environment variable to `true`. The workflow
  then downloads and extracts an artifact uploaded by the triggering workflow which is expected
  to contain a single `rsshub.tar.zst` file. However, prior to commit 64e00e7, it did not validate
  and the contents were extracted in the root of the workspace overriding any existing files.
  Since the contents of the artifact were not validated, it is possible for a malicious actor
  to send a Pull Request which uploads, not just the `rsshub.tar.zst` compressed docker image,
  but also a malicious `package.json` file with a script to run arbitrary code in the context
  of the privileged workflow. As of commit 64e00e7, this scenario has been addressed and the
  RSSHub repository is no longer vulnerable.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-09-26T19:48:42Z/
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://codeql.github.com/codeql-query-help/javascript/js-actions-command-injection
    reference_type:
    reference_id:
  - url: https://github.com/DIYgod/RSSHub/actions/runs/10141104413/job/28037643579#step:1:17
    reference_type:
    reference_id:
  - url: https://github.com/DIYgod/RSSHub/blob/e08733f94c81440d19ee6a5fd5e915e9a65395f5/.github/workflows/docker-test-cont.yml
    reference_type:
    reference_id:
  - url: https://github.com/DIYgod/RSSHub/commit/64e00e743aba2a239508fea97825994e3d687ecc
    reference_type:
    reference_id:
  - url: https://github.com/DIYgod/RSSHub/security/advisories/GHSA-9mqc-fm24-h8cw
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2024-178_RSSHub
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/research/github-actions-preventing-pwn-requests
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/research/github-actions-untrusted-input
    reference_type:
    reference_id:
