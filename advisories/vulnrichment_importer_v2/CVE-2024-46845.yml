advisory_id: CVE-2024-46845
datasource_id: vulnrichment_importer_v2/CVE-2024-46845
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/46xxx/CVE-2024-46845.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tracing/timerlat: Only clear timer if a kthread exists

  The timerlat tracer can use user space threads to check for osnoise and
  timer latency. If the program using this is killed via a SIGTERM, the
  threads are shutdown one at a time and another tracing instance can start
  up resetting the threads before they are fully closed. That causes the
  hrtimer assigned to the kthread to be shutdown and freed twice when the
  dying thread finally closes the file descriptors, causing a use-after-free
  bug.

  Only cancel the hrtimer if the associated thread is still around. Also add
  the interface_lock around the resetting of the tlat_var->kthread.

  Note, this is just a quick fix that can be backported to stable. A real
  fix is to have a better synchronization between the shutdown of old
  threads and the starting of new ones.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-29T13:59:07Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/8a9d0d405159e9c796ddf771f7cff691c1a2bc1e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8c72f0b2c45f21cb8b00fc37f79f632d7e46c2ed
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e6a53481da292d970d1edf0d8831121d1c5e2f0d
    reference_type:
    reference_id:
