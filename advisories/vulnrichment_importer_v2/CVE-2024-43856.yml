advisory_id: CVE-2024-43856
datasource_id: vulnrichment_importer_v2/CVE-2024-43856
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/43xxx/CVE-2024-43856.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dma: fix call order in dmam_free_coherent

  dmam_free_coherent() frees a DMA allocation, which makes the
  freed vaddr available for reuse, then calls devres_destroy()
  to remove and free the data structure used to track the DMA
  allocation. Between the two calls, it is possible for a
  concurrent task to make an allocation with the same vaddr
  and add it to the devres list.

  If this happens, there will be two entries in the devres list
  with the same vaddr and devres_destroy() can free the wrong
  entry, triggering the WARN_ON() in dmam_match.

  Fix by destroying the devres entry before freeing the DMA
  allocation.

    kokonut //net/encryption
      http://sponge2/b9145fe6-0f72-4325-ac2f-a84d81075b03
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:07:08Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1fe97f68fce1ba24bf823bfb0eb0956003473130
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/22094f5f52e7bc16c5bf9613365049383650b02e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/257193083e8f43907e99ea633820fc2b3bcd24c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/28e8b7406d3a1f5329a03aa25a43aa28e087cb20
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2f7bbdc744f2e7051d1cb47c8e082162df1923c9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/87b34c8c94e29fa01d744e5147697f592998d954
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f993a4baf6b622232e4c190d34c220179e5d61eb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fe2d246080f035e0af5793cb79067ba125e4fb63
    reference_type:
    reference_id:
