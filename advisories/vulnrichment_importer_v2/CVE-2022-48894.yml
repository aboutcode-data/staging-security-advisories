advisory_id: CVE-2022-48894
datasource_id: vulnrichment_importer_v2/CVE-2022-48894
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48894.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  iommu/arm-smmu-v3: Don't unregister on shutdown

  Similar to SMMUv2, this driver calls iommu_device_unregister() from the
  shutdown path, which removes the IOMMU groups with no coordination
  whatsoever with their users - shutdown methods are optional in device
  drivers. This can lead to NULL pointer dereferences in those drivers'
  DMA API calls, or worse.

  Instead of calling the full arm_smmu_device_remove() from
  arm_smmu_device_shutdown(), let's pick only the relevant function call -
  arm_smmu_device_disable() - more or less the reverse of
  arm_smmu_device_reset() - and call just that from the shutdown path.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:04:12Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/32ea2c57dc216b6ad8125fa680d31daa5d421c95
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ead3e6c79479890444c777fd329afc125fecde48
    reference_type:
    reference_id:
