advisory_id: CVE-2024-21585
datasource_id: vulnrichment_importer_v2/CVE-2024-21585
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/21xxx/CVE-2024-21585.json
aliases: []
summary: |
  An Improper Handling of Exceptional Conditions vulnerability in BGP session processing of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated network-based attacker, using specific timing outside the attacker's control, to flap BGP sessions and cause the routing protocol daemon (rpd) process to crash and restart, leading to a Denial of Service (DoS) condition. Continued BGP session flapping will create a sustained Denial of Service (DoS) condition.

  This issue only affects routers configured with non-stop routing (NSR) enabled. Graceful Restart (GR) helper mode, enabled by default, is also required for this issue to be exploitable.


  Note: NSR is not supported on the SRX Series and is therefore not affected by this vulnerability.
  When the BGP session flaps on the NSR-enabled router, the device enters GR-helper/LLGR-helper mode due to the peer having negotiated GR/LLGR-restarter capability and the backup BGP requests for replication of the GR/LLGR-helper session, master BGP schedules, and initiates replication of GR/LLGR stale routes to the backup BGP. In this state, if the BGP session with the BGP peer comes up again, unsolicited replication is initiated for the peer without cleaning up the ongoing GR/LLGR-helper mode replication. This parallel two instances of replication for the same peer leads to the assert if the BGP session flaps again.

  This issue affects:

  Juniper Networks Junos OS



    *  All versions earlier than 20.4R3-S9;
    *  21.2 versions earlier than 21.2R3-S7;
    *  21.3 versions earlier than 21.3R3-S5;
    *  21.4 versions earlier than 21.4R3-S5;
    *  22.1 versions earlier than 22.1R3-S4;
    *  22.2 versions earlier than 22.2R3-S3;
    *  22.3 versions earlier than 22.3R3-S1;
    *  22.4 versions earlier than 22.4R2-S2, 22.4R3;
    *  23.2 versions earlier than 23.2R1-S1, 23.2R2.




  Juniper Networks Junos OS Evolved



    *  All versions earlier than 21.3R3-S5-EVO;
    *  21.4 versions earlier than 21.4R3-S5-EVO;
    *  22.1 versions earlier than 22.1R3-S4-EVO;
    *  22.2 versions earlier than 22.2R3-S3-EVO;
    *  22.3 versions earlier than 22.3R3-S1-EVO;
    *  22.4 versions earlier than 22.4R2-S2-EVO, 22.4R3-EVO;
    *  23.2 versions earlier than 23.2R1-S1-EVO, 23.2R2-EVO.
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-11-14T14:40:34Z/
    published_at: None
    url:
weaknesses:
  - CWE-755
references:
  - url: https://supportportal.juniper.net/JSA75723
    reference_type:
    reference_id:
  - url: https://supportportal.juniper.net/s/article/MX-GR-and-LLGR-capability-and-compatibility-changes-after-15-1-release
    reference_type:
    reference_id:
  - url: https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L
    reference_type:
    reference_id:
