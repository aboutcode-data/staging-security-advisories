advisory_id: CVE-2026-1664
datasource_id: vulnrichment_importer_v2/CVE-2026-1664
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2026/1xxx/CVE-2026-1664.json
aliases: []
summary: |
  Summary

  An Insecure Direct Object Reference has been found to exist in `createHeaderBasedEmailResolver()` function within the Cloudflare Agents SDK. The issue occurs because the `Message-ID` and `References` headers are parsed to derive the target agentName and agentId without proper validation or origin checks, allowing an external attacker with control of these headers to route inbound mail to arbitrary Durable Object instances and namespaces .




  Root cause

  The `createHeaderBasedEmailResolver()` function lacks cryptographic verification or origin validation for the headers used in the routing logic, effectively allowing external input to dictate internal object routing.




  Impact

  Insecure Direct Object Reference (IDOR) in email routing lets an attacker steer inbound mail to arbitrary Agent instances via spoofed Message-ID.





  Mitigation:

    *  PR:  https://github.com/cloudflare/agents/blob/main/docs/email.md ] provides the necessary architectural context for coding agents to mitigate the issue by refactoring the resolver to enforce strict identity boundaries.
    *  Agents-sdk users should  upgrade to agents@0.3.7
impacted_packages: []
severities:
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2026-02-03T14:38:24Z/
    published_at: None
    url:
weaknesses:
  - CWE-639
references:
  - url: https://github.com/cloudflare/agents
    reference_type:
    reference_id:
