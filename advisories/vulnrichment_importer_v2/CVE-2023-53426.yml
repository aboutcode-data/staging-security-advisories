advisory_id: CVE-2023-53426
datasource_id: vulnrichment_importer_v2/CVE-2023-53426
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/53xxx/CVE-2023-53426.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  xsk: Fix xsk_diag use-after-free error during socket cleanup

  Fix a use-after-free error that is possible if the xsk_diag interface
  is used after the socket has been unbound from the device. This can
  happen either due to the socket being closed or the device
  disappearing. In the early days of AF_XDP, the way we tested that a
  socket was not bound to a device was to simply check if the netdevice
  pointer in the xsk socket structure was NULL. Later, a better system
  was introduced by having an explicit state variable in the xsk socket
  struct. For example, the state of a socket that is on the way to being
  closed and has been unbound from the device is XSK_UNBOUND.

  The commit in the Fixes tag below deleted the old way of signalling
  that a socket is unbound, setting dev to NULL. This in the belief that
  all code using the old way had been exterminated. That was
  unfortunately not true as the xsk diagnostics code was still using the
  old way and thus does not work as intended when a socket is going
  down. Fix this by introducing a test against the state variable. If
  the socket is in the state XSK_UNBOUND, simply abort the diagnostic's
  netlink operation.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2026-01-14T19:13:38Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3e019d8a05a38abb5c85d4f1e85fda964610aa14
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/595931912357fa3507e522a7f8a0a76e423c23e4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5979985f2d6b565b6cf0f79a62670a2855c0e96c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6436973164ea5506a495f39e56be5aea375e7832
    reference_type:
    reference_id:
