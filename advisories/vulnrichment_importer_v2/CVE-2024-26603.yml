advisory_id: CVE-2024-26603
datasource_id: vulnrichment_importer_v2/CVE-2024-26603
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/26xxx/CVE-2024-26603.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/fpu: Stop relying on userspace for info to fault in xsave buffer

  Before this change, the expected size of the user space buffer was
  taken from fx_sw->xstate_size. fx_sw->xstate_size can be changed
  from user-space, so it is possible construct a sigreturn frame where:

   * fx_sw->xstate_size is smaller than the size required by valid bits in
     fx_sw->xfeatures.
   * user-space unmaps parts of the sigrame fpu buffer so that not all of
     the buffer required by xrstor is accessible.

  In this case, xrstor tries to restore and accesses the unmapped area
  which results in a fault. But fault_in_readable succeeds because buf +
  fx_sw->xstate_size is within the still mapped area, so it goes back and
  tries xrstor again. It will spin in this loop forever.

  Instead, fault in the maximum size which can be touched by XRSTOR (taken
  from fpstate->user_size).

  [ dhansen: tweak subject / changelog ]
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-03-05T22:13:53Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/627339cccdc9166792ecf96bc3c9f711a60ce996
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/627e28cbb65564e55008315d9e02fbb90478beda
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8bd3eee7720c14b59a206bd05b98d7586bccf99a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b2479ab426cef7ab79a13005650eff956223ced2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d877550eaf2dc9090d782864c96939397a3c6835
    reference_type:
    reference_id:
