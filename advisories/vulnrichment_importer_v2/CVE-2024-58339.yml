advisory_id: CVE-2024-58339
datasource_id: vulnrichment_importer_v2/CVE-2024-58339
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/58xxx/CVE-2024-58339.json
aliases: []
summary: LlamaIndex (run-llama/llama_index) versions up to and including 0.12.2 contain an uncontrolled
  resource consumption vulnerability in the VannaPack VannaQueryEngine implementation. The custom_query()
  logic generates SQL statements from a user-supplied prompt and executes them via vn.run_sql()
  without enforcing query execution limits In downstream deployments where untrusted users can
  supply prompts, an attacker can trigger expensive or unbounded SQL operations that exhaust
  CPU or memory resources, resulting in a denial-of-service condition. The vulnerable execution
  path occurs in llama_index/packs/vanna/base.py within custom_query().
impacted_packages: []
severities:
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-13T17:18:23Z/
    published_at: None
    url:
weaknesses:
  - CWE-770
references:
  - url: https://github.com/run-llama/llama_index
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/a1d6c30d-fce0-412a-bd22-14e0d4c1fa1f
    reference_type:
    reference_id:
  - url: https://www.llamaindex.ai/
    reference_type:
    reference_id:
  - url: https://www.vulncheck.com/advisories/llamaindex-vannaqueryengine-sql-execution-allows-resource-exhaustion
    reference_type:
    reference_id:
