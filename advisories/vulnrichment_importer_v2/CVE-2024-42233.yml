advisory_id: CVE-2024-42233
datasource_id: vulnrichment_importer_v2/CVE-2024-42233
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/42xxx/CVE-2024-42233.json
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nfilemap: replace\
  \ pte_offset_map() with pte_offset_map_nolock()\n\nThe vmf->ptl in filemap_fault_recheck_pte_none()\
  \ is still set from\nhandle_pte_fault().  But at the same time, we did a pte_unmap(vmf->pte).\
  \ \nAfter a pte_unmap(vmf->pte) unmap and rcu_read_unlock(), the page table\nmay be racily\
  \ changed and vmf->ptl maybe fails to protect the actual page\ntable.  Fix this by replacing\
  \ pte_offset_map() with\npte_offset_map_nolock().\n\nAs David said, the PTL pointer might\
  \ be stale so if we continue to use\nit infilemap_fault_recheck_pte_none(), it might trigger\
  \ UAF.  Also, if\nthe PTL fails, the issue fixed by commit 58f327f2ce80 (\"filemap: avoid\n\
  unnecessary major faults in filemap_fault()\") might reappear."
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:14:13Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/24be02a42181f0707be0498045c4c4b13273b16d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6a6c2aec1a89506595801b4cf7e8eef035f33748
    reference_type:
    reference_id:
