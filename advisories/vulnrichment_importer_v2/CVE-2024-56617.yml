advisory_id: CVE-2024-56617
datasource_id: vulnrichment_importer_v2/CVE-2024-56617
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/56xxx/CVE-2024-56617.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  cacheinfo: Allocate memory during CPU hotplug if not done from the primary CPU

  Commit

    5944ce092b97 ("arch_topology: Build cacheinfo from primary CPU")

  adds functionality that architectures can use to optionally allocate and
  build cacheinfo early during boot. Commit

    6539cffa9495 ("cacheinfo: Add arch specific early level initializer")

  lets secondary CPUs correct (and reallocate memory) cacheinfo data if
  needed.

  If the early build functionality is not used and cacheinfo does not need
  correction, memory for cacheinfo is never allocated. x86 does not use
  the early build functionality. Consequently, during the cacheinfo CPU
  hotplug callback, last_level_cache_is_valid() attempts to dereference
  a NULL pointer:

    BUG: kernel NULL pointer dereference, address: 0000000000000100
    #PF: supervisor read access in kernel mode
    #PF: error_code(0x0000) - not present page
    PGD 0 P4D 0
    Oops: 0000 [#1] PREEPMT SMP NOPTI
    CPU: 0 PID 19 Comm: cpuhp/0 Not tainted 6.4.0-rc2 #1
    RIP: 0010: last_level_cache_is_valid+0x95/0xe0a

  Allocate memory for cacheinfo during the cacheinfo CPU hotplug callback
  if not done earlier.

  Moreover, before determining the validity of the last-level cache info,
  ensure that it has been allocated. Simply checking for non-zero
  cache_leaves() is not sufficient, as some architectures (e.g., Intel
  processors) have non-zero cache_leaves() before allocation.

  Dereferencing NULL cacheinfo can occur in update_per_cpu_data_slice_size().
  This function iterates over all online CPUs. However, a CPU may have come
  online recently, but its cacheinfo may not have been allocated yet.

  While here, remove an unnecessary indentation in allocate_cache_info().

    [ bp: Massage. ]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T20:01:04Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/23b5908b11b77ff8d7b8f7b8f11cbab2e1f4bfc2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95e197354e0de07e9a20819bdae6562e4dda0f20
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b3fce429a1e030b50c1c91351d69b8667eef627b
    reference_type:
    reference_id:
