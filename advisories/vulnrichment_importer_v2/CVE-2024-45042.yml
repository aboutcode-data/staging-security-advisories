advisory_id: CVE-2024-45042
datasource_id: vulnrichment_importer_v2/CVE-2024-45042
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/45xxx/CVE-2024-45042.json
aliases: []
summary: Ory Kratos is an identity, user management and authentication system for cloud services.
  Prior to version 1.3.0, given a number of preconditions, the `highest_available` setting will
  incorrectly assume that the identity’s highest available AAL is `aal1` even though it really
  is `aal2`. This means that the `highest_available` configuration will act as if the user has
  only one factor set up, for that particular user. This means that they can call the settings
  and whoami endpoint without a `aal2` session, even though that should be disallowed. An attacker
  would need to steal or guess a valid login OTP of a user who has only OTP for login enabled
  and who has an incorrect `available_aal` value stored, to exploit this vulnerability. All
  other aspects of the session (e.g. the session’s aal) are not impacted by this issue. On the
  Ory Network, only 0.00066% of registered users were affected by this issue, and most of those
  users appeared to be test users. Their respective AAL values have since been updated and they
  are no longer vulnerable to this attack. Version 1.3.0 is not affected by this issue. As a
  workaround, those who require MFA should disable the passwordless code login method. If that
  is not possible, check the sessions `aal` to identify if the user has `aal1` or `aal2`.
impacted_packages: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-10T17:12:37Z/
    published_at: None
    url:
weaknesses:
  - CWE-287
references:
  - url: https://github.com/ory/kratos/security/advisories/GHSA-wc43-73w7-x2f5
    reference_type:
    reference_id:
