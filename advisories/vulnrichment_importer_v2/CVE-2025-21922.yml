advisory_id: CVE-2025-21922
datasource_id: vulnrichment_importer_v2/CVE-2025-21922
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/21xxx/CVE-2025-21922.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ppp: Fix KMSAN uninit-value warning with bpf

  Syzbot caught an "KMSAN: uninit-value" warning [1], which is caused by the
  ppp driver not initializing a 2-byte header when using socket filter.

  The following code can generate a PPP filter BPF program:
  '''
  struct bpf_program fp;
  pcap_t *handle;
  handle = pcap_open_dead(DLT_PPP_PPPD, 65535);
  pcap_compile(handle, &fp, "ip and outbound", 0, 0);
  bpf_dump(&fp, 1);
  '''
  Its output is:
  '''
  (000) ldh [2]
  (001) jeq #0x21 jt 2 jf 5
  (002) ldb [0]
  (003) jeq #0x1 jt 4 jf 5
  (004) ret #65535
  (005) ret #0
  '''
  Wen can find similar code at the following link:
  https://github.com/ppp-project/ppp/blob/master/pppd/options.c#L1680
  The maintainer of this code repository is also the original maintainer
  of the ppp driver.

  As you can see the BPF program skips 2 bytes of data and then reads the
  'Protocol' field to determine if it's an IP packet. Then it read the first
  byte of the first 2 bytes to determine the direction.

  The issue is that only the first byte indicating direction is initialized
  in current ppp driver code while the second byte is not initialized.

  For normal BPF programs generated by libpcap, uninitialized data won't be
  used, so it's not a problem. However, for carefully crafted BPF programs,
  such as those generated by syzkaller [2], which start reading from offset
  0, the uninitialized data will be used and caught by KMSAN.

  [1] https://syzkaller.appspot.com/bug?extid=853242d9c9917165d791
  [2] https://syzkaller.appspot.com/text?tag=ReproC&x=11994913980000
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T20:07:52Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1eacd47636a9de5bee25d9d5962dc538a82d9f0b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2f591cb158807bdcf424f66f1fbfa6e4e50f3757
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3de809a768464528762757e433cd50de35bcb3c1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4c2d14c40a68678d885eab4008a0129646805bae
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4e2191b0fd0c064d37b0db67396216f2d4787e0f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8aa8a40c766b3945b40565a70349d5581458ff63
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c036f5f2680cbdabdbbace86baee3c83721634d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d685096c8129c9a92689975193e268945fd21dbf
    reference_type:
    reference_id:
