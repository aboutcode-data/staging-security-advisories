advisory_id: CVE-2024-44948
datasource_id: vulnrichment_importer_v2/CVE-2024-44948
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/44xxx/CVE-2024-44948.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/mtrr: Check if fixed MTRRs exist before saving them

  MTRRs have an obsolete fixed variant for fine grained caching control
  of the 640K-1MB region that uses separate MSRs. This fixed variant has
  a separate capability bit in the MTRR capability MSR.

  So far all x86 CPUs which support MTRR have this separate bit set, so it
  went unnoticed that mtrr_save_state() does not check the capability bit
  before accessing the fixed MTRR MSRs.

  Though on a CPU that does not support the fixed MTRR capability this
  results in a #GP.  The #GP itself is harmless because the RDMSR fault is
  handled gracefully, but results in a WARN_ON().

  Add the missing capability check to prevent this.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:40:29Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/06c1de44d378ec5439db17bf476507d68589bfe9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/34f36e6ee5bd7eff8b2adcd9fcaef369f752d82e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/388f1c954019f253a8383f7eb733f38d541e10b6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/450b6b22acdaac67a18eaf5ed498421ffcf10051
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8a90d3fc7c24608548d3a750671f9dac21d1a462
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8aa79dfb216b865e96ff890bc4ea71650f9bc8d7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/919f18f961c03d6694aa726c514184f2311a4614
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca7d00c5656d1791e28369919e3e10febe9c3b16
    reference_type:
    reference_id:
