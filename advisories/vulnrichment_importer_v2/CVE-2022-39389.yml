advisory_id: CVE-2022-39389
datasource_id: vulnrichment_importer_v2/CVE-2022-39389
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/39xxx/CVE-2022-39389.json
aliases: []
summary: Lightning Network Daemon (lnd) is an implementation of a lightning bitcoin overlay
  network node. All lnd nodes before version `v0.15.4` are vulnerable to a block parsing bug
  that can cause a node to enter a degraded state once encountered. In this degraded state,
  nodes can continue to make payments and forward HTLCs, and close out channels. Opening channels
  is prohibited, and also on chain transaction events will be undetected. This can cause loss
  of funds if a CSV expiry is researched during a breach attempt or a CLTV delta expires forgetting
  the funds in the HTLC. A patch is available in `lnd` version 0.15.4. Users are advised to
  upgrade. Users unable to upgrade may use the `lncli updatechanpolicy` RPC call to increase
  their CLTV value to a very high amount or increase their fee policies. This will prevent nodes
  from routing through your node, meaning that no pending HTLCs can be present.
impacted_packages: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:39:14Z/
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://github.com/lightningnetwork/lnd/issues/7096
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/pull/7098
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr
    reference_type:
    reference_id:
