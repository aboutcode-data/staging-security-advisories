advisory_id: CVE-2024-42318
datasource_id: vulnrichment_importer_v2/CVE-2024-42318
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/42xxx/CVE-2024-42318.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  landlock: Don't lose track of restrictions on cred_transfer

  When a process' cred struct is replaced, this _almost_ always invokes
  the cred_prepare LSM hook; but in one special case (when
  KEYCTL_SESSION_TO_PARENT updates the parent's credentials), the
  cred_transfer LSM hook is used instead.  Landlock only implements the
  cred_prepare hook, not cred_transfer, so KEYCTL_SESSION_TO_PARENT causes
  all information on Landlock restrictions to be lost.

  This basically means that a process with the ability to use the fork()
  and keyctl() syscalls can get rid of all Landlock restrictions on
  itself.

  Fix it by adding a cred_transfer hook that does the same thing as the
  existing cred_prepare hook. (Implemented by having hook_cred_prepare()
  call hook_cred_transfer() so that the two functions are less likely to
  accidentally diverge in the future.)
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:09:35Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://bugs.chromium.org/p/project-zero/issues/detail?id=2566
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0d74fd54db0bd0c0c224bef0da8fc95ea9c9f36c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/16896914bace82d7811c62f3b6d5320132384f49
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/39705a6c29f8a2b93cf5b99528a55366c50014d1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/916c648323fa53b89eedb34a0988ddaf01406117
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b14cc2cf313bd29056fadbc8ecd7f957cf5791ff
    reference_type:
    reference_id:
  - url: https://lore.kernel.org/all/20240817.shahka3Ee1iy@digikod.net/
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2024/08/17/2
    reference_type:
    reference_id:
