advisory_id: CVE-2023-22731
datasource_id: vulnrichment_importer_v2/CVE-2023-22731
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/22xxx/CVE-2023-22731.json
aliases: []
summary: Shopware is an open source commerce platform based on Symfony Framework and Vue js.
  In a Twig environment **without the Sandbox extension**, it is possible to refer to PHP functions
  in twig filters like `map`, `filter`, `sort`. This allows a template to call any global PHP
  function and thus execute arbitrary code. The attacker must have access to a Twig environment
  in order to exploit this vulnerability. This problem has been fixed with 6.4.18.1 with an
  override of the specified filters until the integration of the Sandbox extension has been
  finished. Users are advised to upgrade. Users of major versions 6.1, 6.2, and 6.3 may also
  receive this fix via a plugin.
impacted_packages: []
severities:
  - score: 10
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-03-10T20:58:32Z/
    published_at: None
    url:
weaknesses:
  - CWE-94
references:
  - url: https://docs.shopware.com/en/shopware-6-en/security-updates/security-update-01-2023?category=security-updates
    reference_type:
    reference_id:
  - url: https://github.com/shopware/platform/commit/89d1ea154689cb6202e0d3a0ceeae0febb0c09e1
    reference_type:
    reference_id:
  - url: https://github.com/shopware/platform/security/advisories/GHSA-93cw-f5jj-x85w
    reference_type:
    reference_id:
