advisory_id: CVE-2024-40948
datasource_id: vulnrichment_importer_v2/CVE-2024-40948
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/40xxx/CVE-2024-40948.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/page_table_check: fix crash on ZONE_DEVICE

  Not all pages may apply to pgtable check.  One example is ZONE_DEVICE
  pages: they map PFNs directly, and they don't allocate page_ext at all
  even if there's struct page around.  One may reference
  devm_memremap_pages().

  When both ZONE_DEVICE and page-table-check enabled, then try to map some
  dax memories, one can trigger kernel bug constantly now when the kernel
  was trying to inject some pfn maps on the dax device:

   kernel BUG at mm/page_table_check.c:55!

  While it's pretty legal to use set_pxx_at() for ZONE_DEVICE pages for page
  fault resolutions, skip all the checks if page_ext doesn't even exist in
  pgtable checker, which applies to ZONE_DEVICE but maybe more.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:04:08Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/51897f99351fff7b57f4f141940fa93b4e90fd2b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/84d3549d54f5ff9fa3281257be3019386f51d1a0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8bb592c2eca8fd2bc06db7d80b38da18da4a2f43
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dec2382247860d2134c8d41e103e26460c099629
    reference_type:
    reference_id:
