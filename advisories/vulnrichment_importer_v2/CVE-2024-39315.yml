advisory_id: CVE-2024-39315
datasource_id: vulnrichment_importer_v2/CVE-2024-39315
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/39xxx/CVE-2024-39315.json
aliases: []
summary: Pomerium is an identity and context-aware access proxy. Prior to version 0.26.1, the
  Pomerium user info page (at `/.pomerium`) unintentionally included serialized OAuth2 access
  and ID tokens from the logged-in user's session. These tokens are not intended to be exposed
  to end users. This issue may be more severe in the presence of a cross-site scripting vulnerability
  in an upstream application proxied through Pomerium. If an attacker could insert a malicious
  script onto a web page proxied through Pomerium, that script could access these tokens by
  making a request to the `/.pomerium` endpoint. Upstream applications that authenticate only
  the ID token may be vulnerable to user impersonation using a token obtained in this manner.
  Note that an OAuth2 access token or ID token by itself is not sufficient to hijack a user's
  Pomerium session. Upstream applications should not be vulnerable to user impersonation via
  these tokens provided the application verifies the Pomerium JWT for each request, the connection
  between Pomerium and the application is secured by mTLS, or the connection between Pomerium
  and the application is otherwise secured at the network layer. The issue is patched in Pomerium
  v0.26.1. No known workarounds are available.
impacted_packages: []
severities:
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-07-22T16:30:03Z/
    published_at: None
    url:
weaknesses:
  - CWE-201
references:
  - url: https://github.com/pomerium/pomerium/commit/4c7c4320afb2ced70ba19b46de1ac4383f3daa48
    reference_type:
    reference_id:
  - url: https://github.com/pomerium/pomerium/security/advisories/GHSA-rrqr-7w59-637v
    reference_type:
    reference_id:
