advisory_id: CVE-2022-48861
datasource_id: vulnrichment_importer_v2/CVE-2022-48861
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48861.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  vdpa: fix use-after-free on vp_vdpa_remove

  When vp_vdpa driver is unbind, vp_vdpa is freed in vdpa_unregister_device
  and then vp_vdpa->mdev.pci_dev is dereferenced in vp_modern_remove,
  triggering use-after-free.

  Call Trace of unbinding driver free vp_vdpa :
  do_syscall_64
    vfs_write
      kernfs_fop_write_iter
        device_release_driver_internal
          pci_device_remove
            vp_vdpa_remove
              vdpa_unregister_device
                kobject_release
                  device_release
                    kfree

  Call Trace of dereference vp_vdpa->mdev.pci_dev:
  vp_modern_remove
    pci_release_selected_regions
      pci_release_region
        pci_resource_len
          pci_resource_end
            (dev)->resource[(bar)].end
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:25:32Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/4b1743bc715a3691a63ac21b349079b07bf1b19e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dc54ba9932aeaaa1a21fe214af1f446593a78274
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eb057b44dbe35ae14527830236a92f51de8f9184
    reference_type:
    reference_id:
