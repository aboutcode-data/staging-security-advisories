advisory_id: CVE-2024-43830
datasource_id: vulnrichment_importer_v2/CVE-2024-43830
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/43xxx/CVE-2024-43830.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  leds: trigger: Unregister sysfs attributes before calling deactivate()

  Triggers which have trigger specific sysfs attributes typically store
  related data in trigger-data allocated by the activate() callback and
  freed by the deactivate() callback.

  Calling device_remove_groups() after calling deactivate() leaves a window
  where the sysfs attributes show/store functions could be called after
  deactivation and then operate on the just freed trigger-data.

  Move the device_remove_groups() call to before deactivate() to close
  this race window.

  This also makes the deactivation path properly do things in reverse order
  of the activation path which calls the activate() callback before calling
  device_add_groups().
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:08:31Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0788a6f3523d3686a9eed5ea1e6fcce6841277b2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/09c1583f0e10c918855d6e7540a79461a353e5d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3fb6a9d67cfd812a547ac73ec02e1077c26c640d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/734ba6437e80dfc780e9ee9d95f912392d12b5ea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c0dc9adf9474ecb7106e60e5472577375aedaed3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c3b7a650c8717aa89df318364609c86cbc040156
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cb8aa9d2a4c8a15d6a43ccf901ef3d094aa60374
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d1415125b701ef13370e2761f691ec632a5eb93a
    reference_type:
    reference_id:
