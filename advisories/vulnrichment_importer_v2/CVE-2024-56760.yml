advisory_id: CVE-2024-56760
datasource_id: vulnrichment_importer_v2/CVE-2024-56760
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/56xxx/CVE-2024-56760.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  PCI/MSI: Handle lack of irqdomain gracefully

  Alexandre observed a warning emitted from pci_msi_setup_msi_irqs() on a
  RISCV platform which does not provide PCI/MSI support:

   WARNING: CPU: 1 PID: 1 at drivers/pci/msi/msi.h:121 pci_msi_setup_msi_irqs+0x2c/0x32
   __pci_enable_msix_range+0x30c/0x596
   pci_msi_setup_msi_irqs+0x2c/0x32
   pci_alloc_irq_vectors_affinity+0xb8/0xe2

  RISCV uses hierarchical interrupt domains and correctly does not implement
  the legacy fallback. The warning triggers from the legacy fallback stub.

  That warning is bogus as the PCI/MSI layer knows whether a PCI/MSI parent
  domain is associated with the device or not. There is a check for MSI-X,
  which has a legacy assumption. But that legacy fallback assumption is only
  valid when legacy support is enabled, but otherwise the check should simply
  return -ENOTSUPP.

  Loongarch tripped over the same problem and blindly enabled legacy support
  without implementing the legacy fallbacks. There are weak implementations
  which return an error, so the problem was papered over.

  Correct pci_msi_domain_supports() to evaluate the legacy mode and add
  the missing supported check into the MSI enable path to complete it.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T19:57:01Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/a60b990798eb17433d0283788280422b1bd94b18
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aed157301c659a48f5564cc4568cf0e5c8831af0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b1f7476e07b93d65a1a3643dcb4a7bed80d4328d
    reference_type:
    reference_id:
