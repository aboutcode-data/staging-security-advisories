advisory_id: CVE-2022-48801
datasource_id: vulnrichment_importer_v2/CVE-2022-48801
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48801.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  iio: buffer: Fix file related error handling in IIO_BUFFER_GET_FD_IOCTL

  If we fail to copy the just created file descriptor to userland, we
  try to clean up by putting back 'fd' and freeing 'ib'. The code uses
  put_unused_fd() for the former which is wrong, as the file descriptor
  was already published by fd_install() which gets called internally by
  anon_inode_getfd().

  This makes the error handling code leaving a half cleaned up file
  descriptor table around and a partially destructed 'file' object,
  allowing userland to play use-after-free tricks on us, by abusing
  the still usable fd and making the code operate on a dangling
  'file->private_data' pointer.

  Instead of leaving the kernel in a partially corrupted state, don't
  attempt to explicitly clean up and leave this to the process exit
  path that'll release any still valid fds, including the one created
  by the previous call to anon_inode_getfd(). Simply return -EFAULT to
  indicate the error.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T16:59:03Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/202071d2518537866d291aa7cf26af54e674f4d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b7f54894aa7517d2b6c797a499b9f491e9db9083
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c72ea20503610a4a7ba26c769357d31602769c01
    reference_type:
    reference_id:
