advisory_id: CVE-2023-22745
datasource_id: vulnrichment_importer_v2/CVE-2023-22745
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/22xxx/CVE-2023-22745.json
aliases: []
summary: tpm2-tss is an open source software implementation of the Trusted Computing Group (TCG)
  Trusted Platform Module (TPM) 2 Software Stack (TSS2). In versions prior to 4.1.0-rc0, 4.0.1,
  and 3.2.2-rc1, `Tss2_RC_SetHandler` and `Tss2_RC_Decode` both index into `layer_handler` with
  an 8 bit layer number, but the array only has `TPM2_ERROR_TSS2_RC_LAYER_COUNT` entries, so
  trying to add a handler for higher-numbered layers or decode a response code with such a layer
  number reads/writes past the end of the buffer. This Buffer overrun, could result in arbitrary
  code execution. An example attack would be a MiTM bus attack that returns 0xFFFFFFFF for the
  RC. Given the common use case of TPM modules an attacker must have local access to the target
  machine with local system privileges which allows access to the TPM system. Usually TPM access
  requires administrative privilege. Versions 4.1.0-rc0, 4.0.1, and 3.2.2-rc1 fix the issue.
impacted_packages: []
severities:
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-03-10T21:01:10Z/
    published_at: None
    url:
weaknesses:
  - CWE-120
references:
  - url: https://github.com/tpm2-software/tpm2-tss/commit/306490c8d848c367faa2d9df81f5e69dab46ffb5
    reference_type:
    reference_id:
  - url: https://github.com/tpm2-software/tpm2-tss/commit/49107d65d5c7be430671398416bbd89dae4e34e7
    reference_type:
    reference_id:
  - url: https://github.com/tpm2-software/tpm2-tss/commit/7ab42953216adec046d000a5e3085f3ee5e9cabf
    reference_type:
    reference_id:
  - url: https://github.com/tpm2-software/tpm2-tss/security/advisories/GHSA-4j3v-fh23-vx67
    reference_type:
    reference_id:
