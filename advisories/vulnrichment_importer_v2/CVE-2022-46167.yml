advisory_id: CVE-2022-46167
datasource_id: vulnrichment_importer_v2/CVE-2022-46167
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/46xxx/CVE-2022-46167.json
aliases: []
summary: Capsule is a multi-tenancy and policy-based framework for Kubernetes. Prior to version
  0.1.3, a ServiceAccount deployed in a Tenant Namespace, when granted with `PATCH` capabilities
  on its own Namespace, is able to edit it and remove the Owner Reference, breaking the reconciliation
  of the Capsule Operator and removing all the enforcement like Pod Security annotations, Network
  Policies, Limit Range and Resource Quota items. An attacker could detach the Namespace from
  a Tenant that is forbidding starting privileged Pods using the Pod Security labels by removing
  the OwnerReference, removing the enforcement labels, and being able to start privileged containers
  that would be able to start a generic Kubernetes privilege escalation. Patches have been released
  for version 0.1.3. No known workarounds are available.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:46:12Z/
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/clastix/capsule/commit/1df430e71be8c4778c82eca3459978ad7d0b4b7b
    reference_type:
    reference_id:
  - url: https://github.com/clastix/capsule/commit/75525ac19254b0c5111e34d7985e2be7bc8b1ac1
    reference_type:
    reference_id:
  - url: https://github.com/clastix/capsule/releases/tag/v0.1.3
    reference_type:
    reference_id:
  - url: https://github.com/clastix/capsule/security/advisories/GHSA-x45c-cvp8-q4fm
    reference_type:
    reference_id:
