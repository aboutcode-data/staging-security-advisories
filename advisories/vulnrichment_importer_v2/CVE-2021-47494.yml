advisory_id: CVE-2021-47494
datasource_id: vulnrichment_importer_v2/CVE-2021-47494
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2021/47xxx/CVE-2021-47494.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  cfg80211: fix management registrations locking

  The management registrations locking was broken, the list was
  locked for each wdev, but cfg80211_mgmt_registrations_update()
  iterated it without holding all the correct spinlocks, causing
  list corruption.

  Rather than trying to fix it with fine-grained locking, just
  move the lock to the wiphy/rdev (still need the list on each
  wdev), we already need to hold the wdev lock to change it, so
  there's no contention on the lock in any case. This trivially
  fixes the bug since we hold one wdev's lock already, and now
  will hold the lock that protects all lists.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-22T18:38:36Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/09b1d5dc6ce1c9151777f6c4e128a59457704c97
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3c897f39b71fe68f90599f6a45b5f7bf5618420e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4c22227e39c7a0b4dab55617ee8d34d171fab8d4
    reference_type:
    reference_id:
