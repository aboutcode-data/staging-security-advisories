advisory_id: CVE-2025-24964
datasource_id: vulnrichment_importer_v2/CVE-2025-24964
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2025/24xxx/CVE-2025-24964.json
aliases: []
summary: Vitest is a testing framework powered by Vite. Affected versions are subject to arbitrary
  remote Code Execution when accessing a malicious website while Vitest API server is listening
  by Cross-site WebSocket hijacking (CSWSH) attacks. When `api` option is enabled (Vitest UI
  enables it), Vitest starts a WebSocket server. This WebSocket server did not check Origin
  header and did not have any authorization mechanism and was vulnerable to CSWSH attacks. This
  WebSocket server has `saveTestFile` API that can edit a test file and `rerun` API that can
  rerun the tests. An attacker can execute arbitrary code by injecting a code in a test file
  by the `saveTestFile` API and then running that file by calling the `rerun` API. This vulnerability
  can result in remote code execution for users that are using Vitest serve API. This issue
  has been patched in versions 1.6.1, 2.1.9 and 3.0.5. Users are advised to upgrade. There are
  no known workarounds for this vulnerability.
impacted_packages: []
severities:
  - score: '9.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-02-04T19:45:47Z/
    published_at: None
    url:
weaknesses:
  - CWE-1385
references:
  - url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L32-L46
    reference_type:
    reference_id:
  - url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L66-L76
    reference_type:
    reference_id:
  - url: https://github.com/vitest-dev/vitest/security/advisories/GHSA-9crc-q9x8-hgqq
    reference_type:
    reference_id:
  - url: https://vitest.dev/config/#api
    reference_type:
    reference_id:
