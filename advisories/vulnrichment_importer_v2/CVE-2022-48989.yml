advisory_id: CVE-2022-48989
datasource_id: vulnrichment_importer_v2/CVE-2022-48989
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/48xxx/CVE-2022-48989.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fscache: Fix oops due to race with cookie_lru and use_cookie

  If a cookie expires from the LRU and the LRU_DISCARD flag is set, but
  the state machine has not run yet, it's possible another thread can call
  fscache_use_cookie and begin to use it.

  When the cookie_worker finally runs, it will see the LRU_DISCARD flag
  set, transition the cookie->state to LRU_DISCARDING, which will then
  withdraw the cookie.  Once the cookie is withdrawn the object is removed
  the below oops will occur because the object associated with the cookie
  is now NULL.

  Fix the oops by clearing the LRU_DISCARD bit if another thread uses the
  cookie before the cookie_worker runs.

    BUG: kernel NULL pointer dereference, address: 0000000000000008
    ...
    CPU: 31 PID: 44773 Comm: kworker/u130:1 Tainted: G     E    6.0.0-5.dneg.x86_64 #1
    Hardware name: Google Compute Engine/Google Compute Engine, BIOS Google 08/26/2022
    Workqueue: events_unbound netfs_rreq_write_to_cache_work [netfs]
    RIP: 0010:cachefiles_prepare_write+0x28/0x90 [cachefiles]
    ...
    Call Trace:
      netfs_rreq_write_to_cache_work+0x11c/0x320 [netfs]
      process_one_work+0x217/0x3e0
      worker_thread+0x4a/0x3b0
      kthread+0xd6/0x100
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-22T13:16:49Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/37f0b459c9b67e14fe4dcc3a15d286c4436ed01d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b5b52de3214a29911f949459a79f6640969b5487
    reference_type:
    reference_id:
