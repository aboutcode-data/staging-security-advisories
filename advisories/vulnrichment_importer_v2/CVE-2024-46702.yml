advisory_id: CVE-2024-46702
datasource_id: vulnrichment_importer_v2/CVE-2024-46702
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/46xxx/CVE-2024-46702.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  thunderbolt: Mark XDomain as unplugged when router is removed

  I noticed that when we do discrete host router NVM upgrade and it gets
  hot-removed from the PCIe side as a result of NVM firmware authentication,
  if there is another host connected with enabled paths we hang in tearing
  them down. This is due to fact that the Thunderbolt networking driver
  also tries to cleanup the paths and ends up blocking in
  tb_disconnect_xdomain_paths() waiting for the domain lock.

  However, at this point we already cleaned the paths in tb_stop() so
  there is really no need for tb_disconnect_xdomain_paths() to do that
  anymore. Furthermore it already checks if the XDomain is unplugged and
  bails out early so take advantage of that and mark the XDomain as
  unplugged when we remove the parent router.
impacted_packages: []
severities:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-29T15:03:56Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/18b3ad2a3cc877dd4b16f48d84aa27b78d53bf1d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/23ce6ba3b95488a2b9e9f6d43b340da0c15395dc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/747bc154577de6e6af4bc99abfa859b8419bb4d8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7ca24cf9163c112bb6b580c6fb57c04a1f8b76e1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/80ac8d194831eca0c2f4fd862f7925532fda320c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e2006140ad2e01a02ed0aff49cc2ae3ceeb11f8d
    reference_type:
    reference_id:
