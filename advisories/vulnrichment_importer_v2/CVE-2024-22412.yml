advisory_id: CVE-2024-22412
datasource_id: vulnrichment_importer_v2/CVE-2024-22412
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/22xxx/CVE-2024-22412.json
aliases: []
summary: ClickHouse is an open-source column-oriented database management system. A bug exists
  in the cloud ClickHouse offering prior to version 24.0.2.54535 and in github.com/clickhouse/clickhouse
  version 23.1. Query caching bypasses the role based access controls and the policies being
  enforced on roles. In affected versions, the query cache only respects separate users, however
  this is not documented and not expected behavior. People relying on ClickHouse roles can have
  their access control lists bypassed if they are using query caching. Attackers who have control
  of a role could guess queries and see data they shouldn't have access to. Version 24.1 of
  ClickHouse and version 24.0.2.54535 of ClickHouse Cloud contain a patch for this issue. Based
  on the documentation, role based access control should be enforced regardless if query caching
  is enabled or not.
impacted_packages: []
severities:
  - score: '2.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-07-16T00:15:45Z/
    published_at: None
    url:
weaknesses:
  - CWE-863
references:
  - url: https://github.com/ClickHouse/ClickHouse/blob/bd17ee769e337906c4b1f404861e042ad72fcbfc/src/Interpreters/executeQuery.cpp#L1013-L1015
    reference_type:
    reference_id:
  - url: https://github.com/ClickHouse/ClickHouse/pull/58611
    reference_type:
    reference_id:
  - url: https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-45h5-f7g3-gr8r
    reference_type:
    reference_id:
