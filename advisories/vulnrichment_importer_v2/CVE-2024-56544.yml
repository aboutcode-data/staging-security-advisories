advisory_id: CVE-2024-56544
datasource_id: vulnrichment_importer_v2/CVE-2024-56544
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/56xxx/CVE-2024-56544.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  udmabuf: change folios array from kmalloc to kvmalloc

  When PAGE_SIZE 4096, MAX_PAGE_ORDER 10, 64bit machine,
  page_alloc only support 4MB.
  If above this, trigger this warn and return NULL.

  udmabuf can change size limit, if change it to 3072(3GB), and then alloc
  3GB udmabuf, will fail create.

  [ 4080.876581] ------------[ cut here ]------------
  [ 4080.876843] WARNING: CPU: 3 PID: 2015 at mm/page_alloc.c:4556 __alloc_pages+0x2c8/0x350
  [ 4080.878839] RIP: 0010:__alloc_pages+0x2c8/0x350
  [ 4080.879470] Call Trace:
  [ 4080.879473]  <TASK>
  [ 4080.879473]  ? __alloc_pages+0x2c8/0x350
  [ 4080.879475]  ? __warn.cold+0x8e/0xe8
  [ 4080.880647]  ? __alloc_pages+0x2c8/0x350
  [ 4080.880909]  ? report_bug+0xff/0x140
  [ 4080.881175]  ? handle_bug+0x3c/0x80
  [ 4080.881556]  ? exc_invalid_op+0x17/0x70
  [ 4080.881559]  ? asm_exc_invalid_op+0x1a/0x20
  [ 4080.882077]  ? udmabuf_create+0x131/0x400

  Because MAX_PAGE_ORDER, kmalloc can max alloc 4096 * (1 << 10), 4MB
  memory, each array entry is pointer(8byte), so can save 524288 pages(2GB).

  Further more, costly order(order 3) may not be guaranteed that it can be
  applied for, due to fragmentation.

  This patch change udmabuf array use kvmalloc_array, this can fallback
  alloc into vmalloc, which can guarantee allocation for any size and does
  not affect the performance of kmalloc allocations.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-01T20:02:22Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1c0844c6184e658064e14c4335885785ad3bf84b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2acc6192aa8570661ed37868c02c03002b1dc290
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/85bb72397cb63649fe493c96e27e1d0e4ed2ff63
    reference_type:
    reference_id:
