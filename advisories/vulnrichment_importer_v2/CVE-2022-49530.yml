advisory_id: CVE-2022-49530
datasource_id: vulnrichment_importer_v2/CVE-2022-49530
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2022/49xxx/CVE-2022-49530.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/amd/pm: fix double free in si_parse_power_table()

  In function si_parse_power_table(), array adev->pm.dpm.ps and its member
  is allocated. If the allocation of each member fails, the array itself
  is freed and returned with an error code. However, the array is later
  freed again in si_dpm_fini() function which is called when the function
  returns an error.

  This leads to potential double free of the array adev->pm.dpm.ps, as
  well as leak of its array members, since the members are not freed in
  the allocation function and the array is not nulled when freed.
  In addition adev->pm.dpm.num_ps, which keeps track of the allocated
  array member, is not updated until the member allocation is
  successfully finished, this could also lead to either use after free,
  or uninitialized variable access in si_dpm_fini().

  Fix this by postponing the free of the array until si_dpm_fini() and
  increment adev->pm.dpm.num_ps everytime the array member is allocated.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-10-01T19:37:58Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2615464854505188f909d0c07c37a6623693b5c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/43eb9b667b95f2a31c63e8949b0d2161b9be59c3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6c5bdaa1325be7f04b79ea992ab216739192d342
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a5ce7051db044290b1a95045ff03c249005a3aa4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/af832028af6f44c6c45645757079c4ed6884ade5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c0e811c4ccf3b42705976285e3a94cc82dea7300
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca1ce206894dd976275c78ee38dbc19873f22de9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f3fa2becf2fc25b6ac7cf8d8b1a2e4a86b3b72bd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fd2eff8b9dcbe469c3b7bbbc7083ab5ed94de07b
    reference_type:
    reference_id:
