advisory_id: CVE-2023-53221
datasource_id: vulnrichment_importer_v2/CVE-2023-53221
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2023/53xxx/CVE-2023-53221.json
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Fix memleak due to fentry attach failure

  If it fails to attach fentry, the allocated bpf trampoline image will be
  left in the system. That can be verified by checking /proc/kallsyms.

  This meamleak can be verified by a simple bpf program as follows:

    SEC("fentry/trap_init")
    int fentry_run()
    {
        return 0;
    }

  It will fail to attach trap_init because this function is freed after
  kernel init, and then we can find the trampoline image is left in the
  system by checking /proc/kallsyms.

    $ tail /proc/kallsyms
    ffffffffc0613000 t bpf_trampoline_6442453466_1  [bpf]
    ffffffffc06c3000 t bpf_trampoline_6442453466_1  [bpf]

    $ bpftool btf dump file /sys/kernel/btf/vmlinux | grep "FUNC 'trap_init'"
    [2522] FUNC 'trap_init' type_id=119 linkage=static

    $ echo $((6442453466 & 0x7fffffff))
    2522

  Note that there are two left bpf trampoline images, that is because the
  libbpf will fallback to raw tracepoint if -EINVAL is returned.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2026-01-14T17:50:19Z/
    published_at: None
    url:
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/108598c39eefbedc9882273ac0df96127a629220
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/20109ddd5bea2c24d790debf5d02584ef24c3f5e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6aa27775db63ba8c7c73891c7dfb71ddc230c48d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f72c67d1a82dada7d6d504c806e111e913721a30
    reference_type:
    reference_id:
