advisory_id: CVE-2024-24771
datasource_id: vulnrichment_importer_v2/CVE-2024-24771
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/24xxx/CVE-2024-24771.json
aliases: []
summary: 'Open Forms allows users create and publish smart forms. Versions prior to 2.2.9, 2.3.7,
  2.4.5, and 2.5.2 contain a non-exploitable multi-factor authentication weakness. Superusers
  who have their credentials (username + password) compromised could potentially have the second-factor
  authentication bypassed if an attacker somehow managed to authenticate to Open Forms. The
  maintainers of Open Forms do not believe it is or has been possible to perform this login.
  However, if this were possible, the victim''s account may be abused to view (potentially sensitive)
  submission data or have been used to impersonate other staff accounts to view and/or modify
  data. Three mitigating factors to help prevent exploitation include: the usual login page
  (at `/admin/login/`) does not fully log in the user until the second factor was succesfully
  provided; the additional non-MFA protected login page at `/api/v2/api-authlogin/` was misconfigured
  and could not be used to log in; and there are no additional ways to log in. This also requires
  credentials of a superuser to be compromised to be exploitable. Versions 2.2.9, 2.3.7, 2.4.5,
  and 2.5.2 contain the following patches to address these weaknesses: Move and only enable
  the API auth endpoints (`/api/v2/api-auth/login/`) with `settings.DEBUG = True`. `settings.DEBUG
  = True` is insecure and should never be applied in production settings. Additionally, apply
  a custom permission check to the hijack flow to only allow second-factor-verified superusers
  to perform user hijacking.'
impacted_packages: []
severities:
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-02-07T19:33:10Z/
    published_at: None
    url:
weaknesses:
  - CWE-654
  - CWE-284
  - CWE-287
references:
  - url: https://github.com/open-formulieren/open-forms/releases/tag/2.2.9
    reference_type:
    reference_id:
  - url: https://github.com/open-formulieren/open-forms/releases/tag/2.3.7
    reference_type:
    reference_id:
  - url: https://github.com/open-formulieren/open-forms/releases/tag/2.4.5
    reference_type:
    reference_id:
  - url: https://github.com/open-formulieren/open-forms/releases/tag/2.5.2
    reference_type:
    reference_id:
  - url: https://github.com/open-formulieren/open-forms/security/advisories/GHSA-64r3-x3gf-vp63
    reference_type:
    reference_id:
