advisory_id: CVE-2024-2746
datasource_id: vulnrichment_importer_v2/CVE-2024-2746
datasource_url: https://github.com/cisagov/vulnrichment/blob/develop/2024/2xxx/CVE-2024-2746.json
aliases: []
summary: |
  Incomplete fix for CVE-2024-1929

  The problem with CVE-2024-1929 was that the dnf5 D-Bus daemon accepted arbitrary configuration parameters from unprivileged users, which allowed a
  local root exploit by tricking the daemon into loading a user controlled "plugin". All of this happened before Polkit authentication was even started.

  The dnf5 library code does not check whether non-root users control the directory in question. 

  On one hand, this poses a Denial-of-Service attack vector by making the daemonoperate on a blocking file (e.g. named FIFO special file) or a very large file
  that causes an out-of-memory situation (e.g. /dev/zero). On the other hand, this can be used to let the daemon process privileged files like /etc/shadow.
  The file in question is parsed as an INI file. Error diagnostics resulting from parsing privileged files could cause information leaks, if these diagnostics
  are accessible to unprivileged users. In the case of libdnf5, no such user accessible diagnostics should exist, though.

  Also, a local attacker can place a valid repository configuration file in this directory. This configuration file allows to specify
  a plethora of additional configuration options. This makes various additional code paths in libdnf5 accessible to the attacker.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url:
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-05-08T14:43:25Z/
    published_at: None
    url:
weaknesses:
  - CWE-20
references:
  - url: https://www.openwall.com/lists/oss-security/2024/04/03/5
    reference_type:
    reference_id:
