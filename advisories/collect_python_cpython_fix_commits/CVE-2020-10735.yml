advisory_id: CVE-2020-10735
datasource_id: collect_python_cpython_fix_commits/CVE-2020-10735
datasource_url: https://github.com/python/cpython
aliases: []
summary: "cf71e19297de5e94d534832f179f585c1a1570bb:[3.9] Correct CVE-2020-10735 documentation\
  \ (GH-100306). (#100697)\n\n(cherry picked from commit 1cf3d78c92eb07dc09d15cc2e773b0b1b9436825)\r\
  \n(cherry picked from commit 88fe8d701af3316c8869ea18ea1c7acec6f68c04)\r\n\r\nCo-authored-by:\
  \ Jeremy Paige <ucodery@gmail.com>\r\nCo-authored-by: Gregory P. Smith <greg@krypto.org>\n\
  594ba1901cd0ad49e353bc10a031be439856ccbf:[3.8] Correct CVE-2020-10735 documentation (GH-100306)\
  \ (#100698)\n\n(cherry picked from commit 1cf3d78c92eb07dc09d15cc2e773b0b1b9436825)\r\n(cherry\
  \ picked from commit 88fe8d701af3316c8869ea18ea1c7acec6f68c04)\r\n\r\nCo-authored-by: Jeremy\
  \ Paige <ucodery@gmail.com>\r\nCo-authored-by: Gregory P. Smith <greg@krypto.org>\nfbda1c26039c0c527db5ac02c41879edf0c37337:[3.7]\
  \ Correct CVE-2020-10735 documentation (GH-100306). (GH-100699)\n\nCo-authored-by: Jeremy\
  \ Paige <ucodery@gmail.com>.\r\n(cherry picked from commit 88fe8d701af3316c8869ea18ea1c7acec6f68c04)\r\
  \n\r\nCo-authored-by: Gregory P. Smith <greg@krypto.org>\n88fe8d701af3316c8869ea18ea1c7acec6f68c04:[3.10]\
  \ Correct CVE-2020-10735 documentation (GH-100306). (#100477)\n\n(cherry picked from commit\
  \ 1cf3d78c92eb07dc09d15cc2e773b0b1b9436825)\r\n\r\nCo-authored-by: Jeremy Paige <ucodery@gmail.com>\n\
  a852c5f8ee19f996335841a78b73549d7d4117c4:[3.11] Correct CVE-2020-10735 documentation (GH-100306).\
  \ (#100476)\n\n(cherry picked from commit 1cf3d78c92eb07dc09d15cc2e773b0b1b9436825)\r\n\r\n\
  Co-authored-by: Jeremy Paige <ucodery@gmail.com>\n1cf3d78c92eb07dc09d15cc2e773b0b1b9436825:Correct\
  \ CVE-2020-10735 documentation (#100306)\n15ec1afd4fcd2da1e2d2b256c562fb42d8d886a2:[3.7] gh-95778:\
  \ CVE-2020-10735: Prevent DoS by very large int() (GH-96504)\n\nConverting between `int` and\
  \ `str` in bases other than 2\r\n(binary), 4, 8 (octal), 16 (hexadecimal), or 32 such as base\
  \ 10 (decimal) now\r\nraises a `ValueError` if the number of digits in string form is above\
  \ a\r\nlimit to avoid potential denial of service attacks due to the algorithmic\r\ncomplexity.\
  \ This is a mitigation for CVE-2020-10735\r\n(https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10735).\r\
  \n\r\nThis new limit can be configured or disabled by environment variable, command\r\nline\
  \ flag, or :mod:`sys` APIs. See the `Integer String Conversion Length\r\nLimitation` documentation.\
  \  The default limit is 4300\r\ndigits in string form.\r\n\r\nPatch by Gregory P. Smith [Google]\
  \ and Christian Heimes [Red Hat] with feedback\r\nfrom Victor Stinner, Thomas Wouters, Steve\
  \ Dower, Ned Deily, and Mark Dickinson.\n15ec1afd4fcd2da1e2d2b256c562fb42d8d886a2:[3.7] gh-95778:\
  \ CVE-2020-10735: Prevent DoS by very large int() (GH-96504)\n\nConverting between `int` and\
  \ `str` in bases other than 2\r\n(binary), 4, 8 (octal), 16 (hexadecimal), or 32 such as base\
  \ 10 (decimal) now\r\nraises a `ValueError` if the number of digits in string form is above\
  \ a\r\nlimit to avoid potential denial of service attacks due to the algorithmic\r\ncomplexity.\
  \ This is a mitigation for CVE-2020-10735\r\n(https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10735).\r\
  \n\r\nThis new limit can be configured or disabled by environment variable, command\r\nline\
  \ flag, or :mod:`sys` APIs. See the `Integer String Conversion Length\r\nLimitation` documentation.\
  \  The default limit is 4300\r\ndigits in string form.\r\n\r\nPatch by Gregory P. Smith [Google]\
  \ and Christian Heimes [Red Hat] with feedback\r\nfrom Victor Stinner, Thomas Wouters, Steve\
  \ Dower, Ned Deily, and Mark Dickinson.\n15ec1afd4fcd2da1e2d2b256c562fb42d8d886a2:[3.7] gh-95778:\
  \ CVE-2020-10735: Prevent DoS by very large int() (GH-96504)\n\nConverting between `int` and\
  \ `str` in bases other than 2\r\n(binary), 4, 8 (octal), 16 (hexadecimal), or 32 such as base\
  \ 10 (decimal) now\r\nraises a `ValueError` if the number of digits in string form is above\
  \ a\r\nlimit to avoid potential denial of service attacks due to the algorithmic\r\ncomplexity.\
  \ This is a mitigation for CVE-2020-10735\r\n(https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10735).\r\
  \n\r\nThis new limit can be configured or disabled by environment variable, command\r\nline\
  \ flag, or :mod:`sys` APIs. See the `Integer String Conversion Length\r\nLimitation` documentation.\
  \  The default limit is 4300\r\ndigits in string form.\r\n\r\nPatch by Gregory P. Smith [Google]\
  \ and Christian Heimes [Red Hat] with feedback\r\nfrom Victor Stinner, Thomas Wouters, Steve\
  \ Dower, Ned Deily, and Mark Dickinson.\nb5e331fdb38684808ffc540d53e8595bdc408b89:[3.8] gh-95778:\
  \ CVE-2020-10735: Prevent DoS by very large int() (#96503)\n\n* Correctly pre-check for int-to-str\
  \ conversion\r\n\r\nConverting a large enough `int` to a decimal string raises `ValueError`\
  \ as expected. However, the raise comes _after_ the quadratic-time base-conversion algorithm\
  \ has run to completion. For effective DOS prevention, we need some kind of check before entering\
  \ the quadratic-time loop. Oops! =)\r\n\r\nThe quick fix: essentially we catch _most_ values\
  \ that exceed the threshold up front. Those that slip through will still be on the small side\
  \ (read: sufficiently fast), and will get caught by the existing check so that the limit remains\
  \ exact.\r\n\r\nThe justification for the current check. The C code check is:\r\n```c\r\n\
  max_str_digits / (3 * PyLong_SHIFT) <= (size_a - 11) / 10\r\n```\r\n\r\nIn GitHub markdown\
  \ math-speak, writing $M$ for `max_str_digits`, $L$ for `PyLong_SHIFT` and $s$ for `size_a`,\
  \ that check is:\r\n$$\\left\\lfloor\\frac{M}{3L}\\right\\rfloor \\le \\left\\lfloor\\frac{s\
  \ - 11}{10}\\right\\rfloor$$\r\n\r\nFrom this it follows that\r\n$$\\frac{M}{3L} < \\frac{s-1}{10}$$\r\
  \nhence that\r\n$$\\frac{L(s-1)}{M} > \\frac{10}{3} > \\log_2(10).$$\r\nSo\r\n$$2^{L(s-1)}\
  \ > 10^M.$$\r\nBut our input integer $a$ satisfies $|a| \\ge 2^{L(s-1)}$, so $|a|$ is larger\
  \ than $10^M$. This shows that we don't accidentally capture anything _below_ the intended\
  \ limit in the check.\r\n\r\n<!-- gh-issue-number: gh-95778 -->\r\n* Issue: gh-95778\r\n<!--\
  \ /gh-issue-number -->\r\n\r\nCo-authored-by: Gregory P. Smith [Google LLC] <greg@krypto.org>\r\
  \nCo-authored-by: Christian Heimes <christian@python.org>\r\nCo-authored-by: Mark Dickinson\
  \ <dickinsm@gmail.com>\ncec1e9dfd769bd3a16142d0fdd1a36f19c77ed15:[3.9] gh-95778: CVE-2020-10735:\
  \ Prevent DoS by very large int() (#96502)\n\n* Correctly pre-check for int-to-str conversion\
  \ (#96537)\r\n\r\nConverting a large enough `int` to a decimal string raises `ValueError`\
  \ as expected. However, the raise comes _after_ the quadratic-time base-conversion algorithm\
  \ has run to completion. For effective DOS prevention, we need some kind of check before entering\
  \ the quadratic-time loop. Oops! =)\r\n\r\nThe quick fix: essentially we catch _most_ values\
  \ that exceed the threshold up front. Those that slip through will still be on the small side\
  \ (read: sufficiently fast), and will get caught by the existing check so that the limit remains\
  \ exact.\r\n\r\nThe justification for the current check. The C code check is:\r\n```c\r\n\
  max_str_digits / (3 * PyLong_SHIFT) <= (size_a - 11) / 10\r\n```\r\n\r\nIn GitHub markdown\
  \ math-speak, writing $M$ for `max_str_digits`, $L$ for `PyLong_SHIFT` and $s$ for `size_a`,\
  \ that check is:\r\n$$\\left\\lfloor\\frac{M}{3L}\\right\\rfloor \\le \\left\\lfloor\\frac{s\
  \ - 11}{10}\\right\\rfloor$$\r\n\r\nFrom this it follows that\r\n$$\\frac{M}{3L} < \\frac{s-1}{10}$$\r\
  \nhence that\r\n$$\\frac{L(s-1)}{M} > \\frac{10}{3} > \\log_2(10).$$\r\nSo\r\n$$2^{L(s-1)}\
  \ > 10^M.$$\r\nBut our input integer $a$ satisfies $|a| \\ge 2^{L(s-1)}$, so $|a|$ is larger\
  \ than $10^M$. This shows that we don't accidentally capture anything _below_ the intended\
  \ limit in the check.\r\n\r\n<!-- gh-issue-number: gh-95778 -->\r\n* Issue: gh-95778\r\n<!--\
  \ /gh-issue-number -->\r\n\r\nCo-authored-by: Gregory P. Smith [Google LLC] <greg@krypto.org>\r\
  \nCo-authored-by: Christian Heimes <christian@python.org>\r\nCo-authored-by: Mark Dickinson\
  \ <dickinsm@gmail.com>\n8f0fa4bd10aba723aff988720cd26b93be99bc12:[3.10] gh-95778: CVE-2020-10735:\
  \ Prevent DoS by very large int() (#96501)\n\nInteger to and from text conversions via CPython's\
  \ bignum `int` type is not safe against denial of service attacks due to malicious input.\
  \ Very large input strings with hundred thousands of digits can consume several CPU seconds.\r\
  \n\r\nThis PR comes fresh from a pile of work done in our private PSRT security response team\
  \ repo.\r\n\r\nThis backports https://github.com/python/cpython/pull/96499 aka 511ca9452033ef95bc7d7fc404b8161068226002\r\
  \n\r\nSigned-off-by: Christian Heimes [Red Hat] <christian@python.org>\r\nTons-of-polishing-up-by:\
  \ Gregory P. Smith [Google] <greg@krypto.org>\r\nReviews via the private PSRT repo via many\
  \ others (see the NEWS entry in the PR).\r\n\r\n<!-- gh-issue-number: gh-95778 -->\r\n* Issue:\
  \ gh-95778\r\n<!-- /gh-issue-number -->\r\n\r\nI wrote up [a one pager for the release managers](https://docs.google.com/document/d/1KjuF_aXlzPUxTK4BMgezGJ2Pn7uevfX7g0_mvgHlL7Y/edit#).\n\
  f8b71da9aac6ea74808dcdd0cc266e705431356b:[3.11] gh-95778: CVE-2020-10735: Prevent DoS by very\
  \ large int() (#96500)\n\nInteger to and from text conversions via CPython's bignum `int`\
  \ type is not safe against denial of service attacks due to malicious input. Very large input\
  \ strings with hundred thousands of digits can consume several CPU seconds.\r\n\r\nThis PR\
  \ comes fresh from a pile of work done in our private PSRT security response team repo.\r\n\
  \r\nThis backports https://github.com/python/cpython/pull/96499 aka 511ca9452033ef95bc7d7fc404b8161068226002\r\
  \n\r\nSigned-off-by: Christian Heimes [Red Hat] <christian@python.org>\r\nTons-of-polishing-up-by:\
  \ Gregory P. Smith [Google] <greg@krypto.org>\r\nReviews via the private PSRT repo via many\
  \ others (see the NEWS entry in the PR).\r\n\r\n<!-- gh-issue-number: gh-95778 -->\r\n* Issue:\
  \ gh-95778\r\n<!-- /gh-issue-number -->\r\n\r\nI wrote up [a one pager for the release managers](https://docs.google.com/document/d/1KjuF_aXlzPUxTK4BMgezGJ2Pn7uevfX7g0_mvgHlL7Y/edit#).\n\
  511ca9452033ef95bc7d7fc404b8161068226002:gh-95778: CVE-2020-10735: Prevent DoS by very large\
  \ int() (#96499)\n\nInteger to and from text conversions via CPython's bignum `int` type is\
  \ not safe against denial of service attacks due to malicious input. Very large input strings\
  \ with hundred thousands of digits can consume several CPU seconds.\r\n\r\nThis PR comes fresh\
  \ from a pile of work done in our private PSRT security response team repo.\r\n\r\nSigned-off-by:\
  \ Christian Heimes [Red Hat] <christian@python.org>\r\nTons-of-polishing-up-by: Gregory P.\
  \ Smith [Google] <greg@krypto.org>\r\nReviews via the private PSRT repo via many others (see\
  \ the NEWS entry in the PR).\r\n\r\n<!-- gh-issue-number: gh-95778 -->\r\n* Issue: gh-95778\r\
  \n<!-- /gh-issue-number -->\r\n\r\nI wrote up [a one pager for the release managers](https://docs.google.com/document/d/1KjuF_aXlzPUxTK4BMgezGJ2Pn7uevfX7g0_mvgHlL7Y/edit#).\
  \ Much of that text wound up in the Issue. Backports PRs already exist. See the issue for\
  \ links."
impacted_packages:
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: fbda1c26039c0c527db5ac02c41879edf0c37337
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: 594ba1901cd0ad49e353bc10a031be439856ccbf
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: 511ca9452033ef95bc7d7fc404b8161068226002
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: 15ec1afd4fcd2da1e2d2b256c562fb42d8d886a2
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: 1cf3d78c92eb07dc09d15cc2e773b0b1b9436825
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: 88fe8d701af3316c8869ea18ea1c7acec6f68c04
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: a852c5f8ee19f996335841a78b73549d7d4117c4
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: cf71e19297de5e94d534832f179f585c1a1570bb
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: 8f0fa4bd10aba723aff988720cd26b93be99bc12
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: f8b71da9aac6ea74808dcdd0cc266e705431356b
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: cec1e9dfd769bd3a16142d0fdd1a36f19c77ed15
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: b5e331fdb38684808ffc540d53e8595bdc408b89
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/python/cpython/tree/15ec1afd4fcd2da1e2d2b256c562fb42d8d886a2
    reference_type: commit
    reference_id: 15ec1afd4fcd2da1e2d2b256c562fb42d8d886a2
  - url: https://github.com/python/cpython/tree/1cf3d78c92eb07dc09d15cc2e773b0b1b9436825
    reference_type: commit
    reference_id: 1cf3d78c92eb07dc09d15cc2e773b0b1b9436825
  - url: https://github.com/python/cpython/tree/511ca9452033ef95bc7d7fc404b8161068226002
    reference_type: commit
    reference_id: 511ca9452033ef95bc7d7fc404b8161068226002
  - url: https://github.com/python/cpython/tree/594ba1901cd0ad49e353bc10a031be439856ccbf
    reference_type: commit
    reference_id: 594ba1901cd0ad49e353bc10a031be439856ccbf
  - url: https://github.com/python/cpython/tree/88fe8d701af3316c8869ea18ea1c7acec6f68c04
    reference_type: commit
    reference_id: 88fe8d701af3316c8869ea18ea1c7acec6f68c04
  - url: https://github.com/python/cpython/tree/8f0fa4bd10aba723aff988720cd26b93be99bc12
    reference_type: commit
    reference_id: 8f0fa4bd10aba723aff988720cd26b93be99bc12
  - url: https://github.com/python/cpython/tree/a852c5f8ee19f996335841a78b73549d7d4117c4
    reference_type: commit
    reference_id: a852c5f8ee19f996335841a78b73549d7d4117c4
  - url: https://github.com/python/cpython/tree/b5e331fdb38684808ffc540d53e8595bdc408b89
    reference_type: commit
    reference_id: b5e331fdb38684808ffc540d53e8595bdc408b89
  - url: https://github.com/python/cpython/tree/cec1e9dfd769bd3a16142d0fdd1a36f19c77ed15
    reference_type: commit
    reference_id: cec1e9dfd769bd3a16142d0fdd1a36f19c77ed15
  - url: https://github.com/python/cpython/tree/cf71e19297de5e94d534832f179f585c1a1570bb
    reference_type: commit
    reference_id: cf71e19297de5e94d534832f179f585c1a1570bb
  - url: https://github.com/python/cpython/tree/f8b71da9aac6ea74808dcdd0cc266e705431356b
    reference_type: commit
    reference_id: f8b71da9aac6ea74808dcdd0cc266e705431356b
  - url: https://github.com/python/cpython/tree/fbda1c26039c0c527db5ac02c41879edf0c37337
    reference_type: commit
    reference_id: fbda1c26039c0c527db5ac02c41879edf0c37337
