advisory_id: CVE-2018-1061
datasource_id: collect_python_cpython_fix_commits/CVE-2018-1061
datasource_url: https://github.com/python/cpython
aliases: []
summary: "937ac1fe069a4dc8471dff205f553d82e724015b:[3.5] bpo-32981: Fix catastrophic backtracking\
  \ vulns (GH-5955) (#6034)\n\n* Prevent low-grade poplib REDOS (CVE-2018-1060)\r\n\r\nThe regex\
  \ to test a mail server's timestamp is susceptible to\r\ncatastrophic backtracking on long\
  \ evil responses from the server.\r\n\r\nHappily, the maximum length of malicious inputs is\
  \ 2K thanks\r\nto a limit introduced in the fix for CVE-2013-1752.\r\n\r\nA 2KB evil response\
  \ from the mail server would result in small slowdowns\r\n(milliseconds vs. microseconds)\
  \ accumulated over many apop calls.\r\nThis is a potential DOS vector via accumulated slowdowns.\r\
  \n\r\nReplace it with a similar non-vulnerable regex.\r\n\r\nThe new regex is RFC compliant.\r\
  \nThe old regex was non-compliant in edge cases.\r\n\r\n* Prevent difflib REDOS (CVE-2018-1061)\r\
  \n\r\nThe default regex for IS_LINE_JUNK is susceptible to\r\ncatastrophic backtracking.\r\
  \nThis is a potential DOS vector.\r\n\r\nReplace it with an equivalent non-vulnerable regex.\r\
  \n\r\nAlso introduce unit and REDOS tests for difflib.\r\n\r\nCo-authored-by: Tim Peters <tim.peters@gmail.com>\r\
  \nCo-authored-by: Christian Heimes <christian@python.org>.\r\n(cherry picked from commit 0e6c8ee2358a2e23117501826c008842acb835ac)\n\
  942cc04ae44825ea120e3a19a80c9b348b8194d0:[3.4] bpo-32981: Fix catastrophic backtracking vulns\
  \ (GH-5955) (#6035)\n\n* Prevent low-grade poplib REDOS (CVE-2018-1060)\r\n\r\nThe regex to\
  \ test a mail server's timestamp is susceptible to\r\ncatastrophic backtracking on long evil\
  \ responses from the server.\r\n\r\nHappily, the maximum length of malicious inputs is 2K\
  \ thanks\r\nto a limit introduced in the fix for CVE-2013-1752.\r\n\r\nA 2KB evil response\
  \ from the mail server would result in small slowdowns\r\n(milliseconds vs. microseconds)\
  \ accumulated over many apop calls.\r\nThis is a potential DOS vector via accumulated slowdowns.\r\
  \n\r\nReplace it with a similar non-vulnerable regex.\r\n\r\nThe new regex is RFC compliant.\r\
  \nThe old regex was non-compliant in edge cases.\r\n\r\n* Prevent difflib REDOS (CVE-2018-1061)\r\
  \n\r\nThe default regex for IS_LINE_JUNK is susceptible to\r\ncatastrophic backtracking.\r\
  \nThis is a potential DOS vector.\r\n\r\nReplace it with an equivalent non-vulnerable regex.\r\
  \n\r\nAlso introduce unit and REDOS tests for difflib.\r\n\r\nCo-authored-by: Tim Peters <tim.peters@gmail.com>\r\
  \nCo-authored-by: Christian Heimes <christian@python.org>.\nc9516754067d71fd7429a25ccfcb2141fc583523:[3.6]\
  \ bpo-32981: Fix catastrophic backtracking vulns (GH-5955)\n\n* Prevent low-grade poplib REDOS\
  \ (CVE-2018-1060)\r\n\r\nThe regex to test a mail server's timestamp is susceptible to\r\n\
  catastrophic backtracking on long evil responses from the server.\r\n\r\nHappily, the maximum\
  \ length of malicious inputs is 2K thanks\r\nto a limit introduced in the fix for CVE-2013-1752.\r\
  \n\r\nA 2KB evil response from the mail server would result in small slowdowns\r\n(milliseconds\
  \ vs. microseconds) accumulated over many apop calls.\r\nThis is a potential DOS vector via\
  \ accumulated slowdowns.\r\n\r\nReplace it with a similar non-vulnerable regex.\r\n\r\nThe\
  \ new regex is RFC compliant.\r\nThe old regex was non-compliant in edge cases.\r\n\r\n* Prevent\
  \ difflib REDOS (CVE-2018-1061)\r\n\r\nThe default regex for IS_LINE_JUNK is susceptible to\r\
  \ncatastrophic backtracking.\r\nThis is a potential DOS vector.\r\n\r\nReplace it with an\
  \ equivalent non-vulnerable regex.\r\n\r\nAlso introduce unit and REDOS tests for difflib.\r\
  \n\r\nCo-authored-by: Tim Peters <tim.peters@gmail.com>\r\nCo-authored-by: Christian Heimes\
  \ <christian@python.org>.\r\n(cherry picked from commit 0e6c8ee2358a2e23117501826c008842acb835ac)\n\
  e052d40cea15f582b50947f7d906b39744dc62a2:[2.7] bpo-32981: Fix catastrophic backtracking vulns\
  \ (GH-5955)\n\n* Prevent low-grade poplib REDOS (CVE-2018-1060)\r\n\r\nThe regex to test a\
  \ mail server's timestamp is susceptible to\r\ncatastrophic backtracking on long evil responses\
  \ from the server.\r\n\r\nHappily, the maximum length of malicious inputs is 2K thanks\r\n\
  to a limit introduced in the fix for CVE-2013-1752.\r\n\r\nA 2KB evil response from the mail\
  \ server would result in small slowdowns\r\n(milliseconds vs. microseconds) accumulated over\
  \ many apop calls.\r\nThis is a potential DOS vector via accumulated slowdowns.\r\n\r\nReplace\
  \ it with a similar non-vulnerable regex.\r\n\r\nThe new regex is RFC compliant.\r\nThe old\
  \ regex was non-compliant in edge cases.\r\n\r\n* Prevent difflib REDOS (CVE-2018-1061)\r\n\
  \r\nThe default regex for IS_LINE_JUNK is susceptible to\r\ncatastrophic backtracking.\r\n\
  This is a potential DOS vector.\r\n\r\nReplace it with an equivalent non-vulnerable regex.\r\
  \n\r\nAlso introduce unit and REDOS tests for difflib.\r\n\r\nCo-authored-by: Tim Peters <tim.peters@gmail.com>\r\
  \nCo-authored-by: Christian Heimes <christian@python.org>.\r\n(cherry picked from commit 0e6c8ee2358a2e23117501826c008842acb835ac)\n\
  0902a2d6b2d1d9dbde36aeaaccf1788ceaa97143:bpo-32981: Fix catastrophic backtracking vulns (GH-5955)\n\
  \n* Prevent low-grade poplib REDOS (CVE-2018-1060)\r\n\r\nThe regex to test a mail server's\
  \ timestamp is susceptible to\r\ncatastrophic backtracking on long evil responses from the\
  \ server.\r\n\r\nHappily, the maximum length of malicious inputs is 2K thanks\r\nto a limit\
  \ introduced in the fix for CVE-2013-1752.\r\n\r\nA 2KB evil response from the mail server\
  \ would result in small slowdowns\r\n(milliseconds vs. microseconds) accumulated over many\
  \ apop calls.\r\nThis is a potential DOS vector via accumulated slowdowns.\r\n\r\nReplace\
  \ it with a similar non-vulnerable regex.\r\n\r\nThe new regex is RFC compliant.\r\nThe old\
  \ regex was non-compliant in edge cases.\r\n\r\n* Prevent difflib REDOS (CVE-2018-1061)\r\n\
  \r\nThe default regex for IS_LINE_JUNK is susceptible to\r\ncatastrophic backtracking.\r\n\
  This is a potential DOS vector.\r\n\r\nReplace it with an equivalent non-vulnerable regex.\r\
  \n\r\nAlso introduce unit and REDOS tests for difflib.\r\n\r\nCo-authored-by: Tim Peters <tim.peters@gmail.com>\r\
  \nCo-authored-by: Christian Heimes <christian@python.org>\r\nCo-authored-by: Jamie Davis <davisjam@vt.edu>\r\
  \n(cherry picked from commit 0e6c8ee2358a2e23117501826c008842acb835ac)\n0e6c8ee2358a2e23117501826c008842acb835ac:bpo-32981:\
  \ Fix catastrophic backtracking vulns (#5955)\n\n* Prevent low-grade poplib REDOS (CVE-2018-1060)\r\
  \n\r\nThe regex to test a mail server's timestamp is susceptible to\r\ncatastrophic backtracking\
  \ on long evil responses from the server.\r\n\r\nHappily, the maximum length of malicious\
  \ inputs is 2K thanks\r\nto a limit introduced in the fix for CVE-2013-1752.\r\n\r\nA 2KB\
  \ evil response from the mail server would result in small slowdowns\r\n(milliseconds vs.\
  \ microseconds) accumulated over many apop calls.\r\nThis is a potential DOS vector via accumulated\
  \ slowdowns.\r\n\r\nReplace it with a similar non-vulnerable regex.\r\n\r\nThe new regex is\
  \ RFC compliant.\r\nThe old regex was non-compliant in edge cases.\r\n\r\n* Prevent difflib\
  \ REDOS (CVE-2018-1061)\r\n\r\nThe default regex for IS_LINE_JUNK is susceptible to\r\ncatastrophic\
  \ backtracking.\r\nThis is a potential DOS vector.\r\n\r\nReplace it with an equivalent non-vulnerable\
  \ regex.\r\n\r\nAlso introduce unit and REDOS tests for difflib.\r\n\r\nCo-authored-by: Tim\
  \ Peters <tim.peters@gmail.com>\r\nCo-authored-by: Christian Heimes <christian@python.org>"
impacted_packages:
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: c9516754067d71fd7429a25ccfcb2141fc583523
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: 0e6c8ee2358a2e23117501826c008842acb835ac
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: 0902a2d6b2d1d9dbde36aeaaccf1788ceaa97143
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: 937ac1fe069a4dc8471dff205f553d82e724015b
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: e052d40cea15f582b50947f7d906b39744dc62a2
    introduced_in_commits: []
  - purl: pkg:github/python/cpython
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/python/cpython
        commit: 942cc04ae44825ea120e3a19a80c9b348b8194d0
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/python/cpython/tree/0902a2d6b2d1d9dbde36aeaaccf1788ceaa97143
    reference_type: commit
    reference_id: 0902a2d6b2d1d9dbde36aeaaccf1788ceaa97143
  - url: https://github.com/python/cpython/tree/0e6c8ee2358a2e23117501826c008842acb835ac
    reference_type: commit
    reference_id: 0e6c8ee2358a2e23117501826c008842acb835ac
  - url: https://github.com/python/cpython/tree/937ac1fe069a4dc8471dff205f553d82e724015b
    reference_type: commit
    reference_id: 937ac1fe069a4dc8471dff205f553d82e724015b
  - url: https://github.com/python/cpython/tree/942cc04ae44825ea120e3a19a80c9b348b8194d0
    reference_type: commit
    reference_id: 942cc04ae44825ea120e3a19a80c9b348b8194d0
  - url: https://github.com/python/cpython/tree/c9516754067d71fd7429a25ccfcb2141fc583523
    reference_type: commit
    reference_id: c9516754067d71fd7429a25ccfcb2141fc583523
  - url: https://github.com/python/cpython/tree/e052d40cea15f582b50947f7d906b39744dc62a2
    reference_type: commit
    reference_id: e052d40cea15f582b50947f7d906b39744dc62a2
