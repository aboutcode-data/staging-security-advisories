advisory_id: CVE-2013-0153
datasource_id: collect_xen_project_fix_commits/CVE-2013-0153
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  7cf945cff33f605578ebcfcc6da2712c87d7fdba:AMD,IOMMU: Make per-device interrupt remapping table default

  Using global interrupt remapping table may be insecure, as
  described by XSA-36. This patch makes per-device mode default.

  This is XSA-36 / CVE-2013-0153.

  Signed-off-by: Boris Ostrovsky <boris.ostrovsky@amd.com>

  Moved warning in amd_iov_detect() to location covering all cases.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  xen-unstable changeset: 26519:1af531e7bc2f
  xen-unstable date: Tue Feb  5 14:22:11 UTC 2013
  e73a029ad25ebc27e5b15492bbceaf7f65861618:AMD,IOMMU: Disable IOMMU if SATA Combined mode is on

  AMD's SP5100 chipset can be placed into SATA Combined mode
  that may cause prevent dom0 from booting when IOMMU is
  enabled and per-device interrupt remapping table is used.
  While SP5100 erratum 28 requires BIOSes to disable this mode,
  some may still use it.

  This patch checks whether this mode is on and, if per-device
  table is in use, disables IOMMU.

  This is XSA-36 / CVE-2013-0153.

  Signed-off-by: Boris Ostrovsky <boris.ostrovsky@amd.com>

  Flipped operands of && in amd_iommu_init() to make the message issued
  by amd_sp5100_erratum28() match reality (when amd_iommu_perdev_intremap
  is zero, there's really no point in calling the function).

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  xen-unstable changeset: 26518:e379a23b0465
  xen-unstable date: Tue Feb  5 14:21:25 UTC 2013
  91e538b6c6ce08022cb1fdc8b6cd861ca7a16e2b:AMD,IOMMU: Clean up old entries in remapping tables when creating new one

  When changing the affinity of an IRQ associated with a passed
  through PCI device, clear previous mapping.

  This is XSA-36 / CVE-2013-0153.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>

  In addition, because some BIOSes may incorrectly program IVRS
  entries for IOAPIC try to check for entry's consistency. Specifically,
  if conflicting entries are found disable IOMMU if per-device
  remapping table is used. If entries refer to bogus IOAPIC IDs
  disable IOMMU unconditionally

  Signed-off-by: Boris Ostrovsky <boris.ostrovsky@amd.com>
  xen-unstable changeset: 26517:601139e2b0db
  xen-unstable date: Tue Feb  5 14:20:47 UTC 2013
  94be624294ab711528ac0eddca3259adf65669b4:AMD,IOMMU: Make per-device interrupt remapping table default

  Using global interrupt remapping table may be insecure, as
  described by XSA-36. This patch makes per-device mode default.

  This is XSA-36 / CVE-2013-0153.

  Signed-off-by: Boris Ostrovsky <boris.ostrovsky@amd.com>

  Moved warning in amd_iov_detect() to location covering all cases.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  xen-unstable changeset: 26519:1af531e7bc2f
  xen-unstable date: Tue Feb  5 14:22:11 UTC 2013
  15e595d003fc7b08e334683733048e43088cea4e:AMD,IOMMU: Disable IOMMU if SATA Combined mode is on

  AMD's SP5100 chipset can be placed into SATA Combined mode
  that may cause prevent dom0 from booting when IOMMU is
  enabled and per-device interrupt remapping table is used.
  While SP5100 erratum 28 requires BIOSes to disable this mode,
  some may still use it.

  This patch checks whether this mode is on and, if per-device
  table is in use, disables IOMMU.

  This is XSA-36 / CVE-2013-0153.

  Signed-off-by: Boris Ostrovsky <boris.ostrovsky@amd.com>

  Flipped operands of && in amd_iommu_init() to make the message issued
  by amd_sp5100_erratum28() match reality (when amd_iommu_perdev_intremap
  is zero, there's really no point in calling the function).

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  xen-unstable changeset: 26518:e379a23b0465
  xen-unstable date: Tue Feb  5 14:21:25 UTC 2013
  bbac9a8e5b2efdbb8f3adf23697b30295877b6ba:AMD,IOMMU: Clean up old entries in remapping tables when creating new one

  When changing the affinity of an IRQ associated with a passed
  through PCI device, clear previous mapping.

  This is XSA-36 / CVE-2013-0153.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>

  In addition, because some BIOSes may incorrectly program IVRS
  entries for IOAPIC try to check for entry's consistency. Specifically,
  if conflicting entries are found disable IOMMU if per-device
  remapping table is used. If entries refer to bogus IOAPIC IDs
  disable IOMMU unconditionally

  Signed-off-by: Boris Ostrovsky <boris.ostrovsky@amd.com>
  xen-unstable changeset: 26517:601139e2b0db
  xen-unstable date: Tue Feb  5 14:20:47 UTC 2013
  668635a35e65e9d98618ea0225f56893dde9b6e1:AMD,IOMMU: Make per-device interrupt remapping table default

  Using global interrupt remapping table may be insecure, as
  described by XSA-36. This patch makes per-device mode default.

  This is XSA-36 / CVE-2013-0153.

  Signed-off-by: Boris Ostrovsky <boris.ostrovsky@amd.com>

  Moved warning in amd_iov_detect() to location covering all cases.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Committed-by: Jan Beulich <jbeulich@suse.com>
  2175710e8eee2db19c2653f4f748af15cbfcdcd7:AMD,IOMMU: Disable IOMMU if SATA Combined mode is on

  AMD's SP5100 chipset can be placed into SATA Combined mode
  that may cause prevent dom0 from booting when IOMMU is
  enabled and per-device interrupt remapping table is used.
  While SP5100 erratum 28 requires BIOSes to disable this mode,
  some may still use it.

  This patch checks whether this mode is on and, if per-device
  table is in use, disables IOMMU.

  This is XSA-36 / CVE-2013-0153.

  Signed-off-by: Boris Ostrovsky <boris.ostrovsky@amd.com>

  Flipped operands of && in amd_iommu_init() to make the message issued
  by amd_sp5100_erratum28() match reality (when amd_iommu_perdev_intremap
  is zero, there's really no point in calling the function).

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Committed-by: Jan Beulich <jbeulich@suse.com>
  94d4a1119d938aecd02a6df8111e97358161cbf5:AMD,IOMMU: Clean up old entries in remapping tables when creating new one

  When changing the affinity of an IRQ associated with a passed
  through PCI device, clear previous mapping.

  This is XSA-36 / CVE-2013-0153.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>

  In addition, because some BIOSes may incorrectly program IVRS
  entries for IOAPIC try to check for entry's consistency. Specifically,
  if conflicting entries are found disable IOMMU if per-device
  remapping table is used. If entries refer to bogus IOAPIC IDs
  disable IOMMU unconditionally

  Signed-off-by: Boris Ostrovsky <boris.ostrovsky@amd.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 94d4a1119d938aecd02a6df8111e97358161cbf5
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7cf945cff33f605578ebcfcc6da2712c87d7fdba
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: bbac9a8e5b2efdbb8f3adf23697b30295877b6ba
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 91e538b6c6ce08022cb1fdc8b6cd861ca7a16e2b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 15e595d003fc7b08e334683733048e43088cea4e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 94be624294ab711528ac0eddca3259adf65669b4
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e73a029ad25ebc27e5b15492bbceaf7f65861618
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2175710e8eee2db19c2653f4f748af15cbfcdcd7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 668635a35e65e9d98618ea0225f56893dde9b6e1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/15e595d003fc7b08e334683733048e43088cea4e
    reference_type: commit
    reference_id: 15e595d003fc7b08e334683733048e43088cea4e
  - url: https://github.com/xen-project/xen/tree/2175710e8eee2db19c2653f4f748af15cbfcdcd7
    reference_type: commit
    reference_id: 2175710e8eee2db19c2653f4f748af15cbfcdcd7
  - url: https://github.com/xen-project/xen/tree/668635a35e65e9d98618ea0225f56893dde9b6e1
    reference_type: commit
    reference_id: 668635a35e65e9d98618ea0225f56893dde9b6e1
  - url: https://github.com/xen-project/xen/tree/7cf945cff33f605578ebcfcc6da2712c87d7fdba
    reference_type: commit
    reference_id: 7cf945cff33f605578ebcfcc6da2712c87d7fdba
  - url: https://github.com/xen-project/xen/tree/91e538b6c6ce08022cb1fdc8b6cd861ca7a16e2b
    reference_type: commit
    reference_id: 91e538b6c6ce08022cb1fdc8b6cd861ca7a16e2b
  - url: https://github.com/xen-project/xen/tree/94be624294ab711528ac0eddca3259adf65669b4
    reference_type: commit
    reference_id: 94be624294ab711528ac0eddca3259adf65669b4
  - url: https://github.com/xen-project/xen/tree/94d4a1119d938aecd02a6df8111e97358161cbf5
    reference_type: commit
    reference_id: 94d4a1119d938aecd02a6df8111e97358161cbf5
  - url: https://github.com/xen-project/xen/tree/bbac9a8e5b2efdbb8f3adf23697b30295877b6ba
    reference_type: commit
    reference_id: bbac9a8e5b2efdbb8f3adf23697b30295877b6ba
  - url: https://github.com/xen-project/xen/tree/e73a029ad25ebc27e5b15492bbceaf7f65861618
    reference_type: commit
    reference_id: e73a029ad25ebc27e5b15492bbceaf7f65861618
