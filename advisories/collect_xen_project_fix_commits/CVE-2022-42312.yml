advisory_id: CVE-2022-42312
datasource_id: collect_xen_project_fix_commits/CVE-2022-42312
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  538b61b90393f21ba9ce8cc73fc9eb8fc046ade6:tools/xenstore: limit outstanding requests

  Add another quota for limiting the number of outstanding requests of a
  guest. As the way to specify quotas on the command line is becoming
  rather nasty, switch to a new scheme using [--quota|-Q] <what>=<val>
  allowing to add more quotas in future easily.

  Set the default value to 20 (basically a random value not seeming to
  be too high or too low).

  A request is said to be outstanding if any message generated by this
  request (the direct response plus potential watch events) is not yet
  completely stored into a ring buffer. The initial watch event sent as
  a result of registering a watch is an exception.

  Note that across a live update the relation to buffered watch events
  for other domains is lost.

  Use talloc_zero() for allocating the domain structure in order to have
  all per-domain quota zeroed initially.

  This is part of XSA-326 / CVE-2022-42312.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Acked-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 36de433a273f55d614c83b89c9a8972287a1e475)
  3dafa5a77440325a51dfbd75a297febc618bb24a:tools/xenstore: limit outstanding requests

  Add another quota for limiting the number of outstanding requests of a
  guest. As the way to specify quotas on the command line is becoming
  rather nasty, switch to a new scheme using [--quota|-Q] <what>=<val>
  allowing to add more quotas in future easily.

  Set the default value to 20 (basically a random value not seeming to
  be too high or too low).

  A request is said to be outstanding if any message generated by this
  request (the direct response plus potential watch events) is not yet
  completely stored into a ring buffer. The initial watch event sent as
  a result of registering a watch is an exception.

  Note that across a live update the relation to buffered watch events
  for other domains is lost.

  Use talloc_zero() for allocating the domain structure in order to have
  all per-domain quota zeroed initially.

  This is part of XSA-326 / CVE-2022-42312.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Acked-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 36de433a273f55d614c83b89c9a8972287a1e475)
  56300e8e1781cee1b6a514e5f2bea234a7885d55:tools/xenstore: limit outstanding requests

  Add another quota for limiting the number of outstanding requests of a
  guest. As the way to specify quotas on the command line is becoming
  rather nasty, switch to a new scheme using [--quota|-Q] <what>=<val>
  allowing to add more quotas in future easily.

  Set the default value to 20 (basically a random value not seeming to
  be too high or too low).

  A request is said to be outstanding if any message generated by this
  request (the direct response plus potential watch events) is not yet
  completely stored into a ring buffer. The initial watch event sent as
  a result of registering a watch is an exception.

  Note that across a live update the relation to buffered watch events
  for other domains is lost.

  Use talloc_zero() for allocating the domain structure in order to have
  all per-domain quota zeroed initially.

  This is part of XSA-326 / CVE-2022-42312.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Acked-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 36de433a273f55d614c83b89c9a8972287a1e475)
  49344fb86ff040bae1107e236592c2d4dc4607f3:tools/xenstore: limit outstanding requests

  Add another quota for limiting the number of outstanding requests of a
  guest. As the way to specify quotas on the command line is becoming
  rather nasty, switch to a new scheme using [--quota|-Q] <what>=<val>
  allowing to add more quotas in future easily.

  Set the default value to 20 (basically a random value not seeming to
  be too high or too low).

  A request is said to be outstanding if any message generated by this
  request (the direct response plus potential watch events) is not yet
  completely stored into a ring buffer. The initial watch event sent as
  a result of registering a watch is an exception.

  Note that across a live update the relation to buffered watch events
  for other domains is lost.

  Use talloc_zero() for allocating the domain structure in order to have
  all per-domain quota zeroed initially.

  This is part of XSA-326 / CVE-2022-42312.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Acked-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 36de433a273f55d614c83b89c9a8972287a1e475)
  36de433a273f55d614c83b89c9a8972287a1e475:tools/xenstore: limit outstanding requests

  Add another quota for limiting the number of outstanding requests of a
  guest. As the way to specify quotas on the command line is becoming
  rather nasty, switch to a new scheme using [--quota|-Q] <what>=<val>
  allowing to add more quotas in future easily.

  Set the default value to 20 (basically a random value not seeming to
  be too high or too low).

  A request is said to be outstanding if any message generated by this
  request (the direct response plus potential watch events) is not yet
  completely stored into a ring buffer. The initial watch event sent as
  a result of registering a watch is an exception.

  Note that across a live update the relation to buffered watch events
  for other domains is lost.

  Use talloc_zero() for allocating the domain structure in order to have
  all per-domain quota zeroed initially.

  This is part of XSA-326 / CVE-2022-42312.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Acked-by: Julien Grall <jgrall@amazon.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 49344fb86ff040bae1107e236592c2d4dc4607f3
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3dafa5a77440325a51dfbd75a297febc618bb24a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 56300e8e1781cee1b6a514e5f2bea234a7885d55
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 36de433a273f55d614c83b89c9a8972287a1e475
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 538b61b90393f21ba9ce8cc73fc9eb8fc046ade6
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/36de433a273f55d614c83b89c9a8972287a1e475
    reference_type: commit
    reference_id: 36de433a273f55d614c83b89c9a8972287a1e475
  - url: https://github.com/xen-project/xen/tree/3dafa5a77440325a51dfbd75a297febc618bb24a
    reference_type: commit
    reference_id: 3dafa5a77440325a51dfbd75a297febc618bb24a
  - url: https://github.com/xen-project/xen/tree/49344fb86ff040bae1107e236592c2d4dc4607f3
    reference_type: commit
    reference_id: 49344fb86ff040bae1107e236592c2d4dc4607f3
  - url: https://github.com/xen-project/xen/tree/538b61b90393f21ba9ce8cc73fc9eb8fc046ade6
    reference_type: commit
    reference_id: 538b61b90393f21ba9ce8cc73fc9eb8fc046ade6
  - url: https://github.com/xen-project/xen/tree/56300e8e1781cee1b6a514e5f2bea234a7885d55
    reference_type: commit
    reference_id: 56300e8e1781cee1b6a514e5f2bea234a7885d55
