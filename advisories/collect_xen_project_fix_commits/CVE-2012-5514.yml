advisory_id: CVE-2012-5514
datasource_id: collect_xen_project_fix_commits/CVE-2012-5514
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  b535076955fbe0a54b794959eafc9b918adb3629:xen: fix error handling of guest_physmap_mark_populate_on_demand()

  The only user of the "out" label bypasses a necessary unlock, thus
  enabling the caller to lock up Xen.

  Also, the function was never meant to be called by a guest for itself,
  so rather than inspecting the code paths in depth for potential other
  problems this might cause, and adjusting e.g. the non-guest printk()
  in the above error path, just disallow the guest access to it.

  Finally, the printk() (considering its potential of spamming the log,
  the more that it's not using XENLOG_GUEST), is being converted to
  P2M_DEBUG(), as debugging is what it apparently was added for in the
  first place.

  This is XSA-30 / CVE-2012-5514.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: George Dunlap <george.dunlap@eu.citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson.citrix.com>
  54c82f996207b737abb50e0889d4de1696f833c1:xen: fix error handling of guest_physmap_mark_populate_on_demand()

  The only user of the "out" label bypasses a necessary unlock, thus
  enabling the caller to lock up Xen.

  Also, the function was never meant to be called by a guest for itself,
  so rather than inspecting the code paths in depth for potential other
  problems this might cause, and adjusting e.g. the non-guest printk()
  in the above error path, just disallow the guest access to it.

  Finally, the printk() (considering its potential of spamming the log,
  the more that it's not using XENLOG_GUEST), is being converted to
  P2M_DEBUG(), as debugging is what it apparently was added for in the
  first place.

  This is XSA-30 / CVE-2012-5514.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: George Dunlap <george.dunlap@eu.citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson.citrix.com>
  6ce2579617b866ad2d7ec66ef34a2b861b3bf670:xen: fix error handling of guest_physmap_mark_populate_on_demand()

  The only user of the "out" label bypasses a necessary unlock, thus
  enabling the caller to lock up Xen.

  Also, the function was never meant to be called by a guest for itself,
  so rather than inspecting the code paths in depth for potential other
  problems this might cause, and adjusting e.g. the non-guest printk()
  in the above error path, just disallow the guest access to it.

  Finally, the printk() (considering its potential of spamming the log,
  the more that it's not using XENLOG_GUEST), is being converted to
  P2M_DEBUG(), as debugging is what it apparently was added for in the
  first place.

  This is XSA-30 / CVE-2012-5514.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: George Dunlap <george.dunlap@eu.citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson.citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 6ce2579617b866ad2d7ec66ef34a2b861b3bf670
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 54c82f996207b737abb50e0889d4de1696f833c1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b535076955fbe0a54b794959eafc9b918adb3629
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/54c82f996207b737abb50e0889d4de1696f833c1
    reference_type: commit
    reference_id: 54c82f996207b737abb50e0889d4de1696f833c1
  - url: https://github.com/xen-project/xen/tree/6ce2579617b866ad2d7ec66ef34a2b861b3bf670
    reference_type: commit
    reference_id: 6ce2579617b866ad2d7ec66ef34a2b861b3bf670
  - url: https://github.com/xen-project/xen/tree/b535076955fbe0a54b794959eafc9b918adb3629
    reference_type: commit
    reference_id: b535076955fbe0a54b794959eafc9b918adb3629
