advisory_id: CVE-2012-5511
datasource_id: collect_xen_project_fix_commits/CVE-2012-5511
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  eefac7560f9a23e9330c04fe50e1185a1739a18d:x86/mm: Fix loop increment in paging_log_dirty_range()

  In 23417:53ef1f35a0f8 (the fix for XSA-27 / CVE-2012-5511), the
  loop variable gets incremented twice, so the loop only clears every
  second page of the bitmap.  This might cause the tools to think that
  pages are dirty when they are not.

  Reported-by: Steven Noonan <snoonan@amazon.com>
  Reported-by: Matt Wilson <msw@amazon.com>
  Signed-off-by: Tim Deegan <tim@xen.org>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Jan Beulich <jbeulich@suse.com>
  18c40b58752701b7a08e8394aa614cd4f6e21707:hvm: Limit the size of large HVM op batches

  Doing large p2m updates for HVMOP_track_dirty_vram without preemption
  ties up the physical processor. Integrating preemption into the p2m
  updates is hard so simply limit to 1GB which is sufficient for a 15000
  * 15000 * 32bpp framebuffer.

  For HVMOP_modified_memory and HVMOP_set_mem_type preemptible add the
  necessary machinery to handle preemption.

  This is CVE-2012-5511 / XSA-27.

  Signed-off-by: Tim Deegan <tim@xen.org>
  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson.citrix.com>

  x86/paging: Don't allocate user-controlled amounts of stack memory.

  This is XSA-27 / CVE-2012-5511.

  Signed-off-by: Tim Deegan <tim@xen.org>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  v2: Provide definition of GB to fix x86-32 compile.

  Signed-off-by: Jan Beulich <JBeulich@suse.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  18c40b58752701b7a08e8394aa614cd4f6e21707:hvm: Limit the size of large HVM op batches

  Doing large p2m updates for HVMOP_track_dirty_vram without preemption
  ties up the physical processor. Integrating preemption into the p2m
  updates is hard so simply limit to 1GB which is sufficient for a 15000
  * 15000 * 32bpp framebuffer.

  For HVMOP_modified_memory and HVMOP_set_mem_type preemptible add the
  necessary machinery to handle preemption.

  This is CVE-2012-5511 / XSA-27.

  Signed-off-by: Tim Deegan <tim@xen.org>
  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson.citrix.com>

  x86/paging: Don't allocate user-controlled amounts of stack memory.

  This is XSA-27 / CVE-2012-5511.

  Signed-off-by: Tim Deegan <tim@xen.org>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  v2: Provide definition of GB to fix x86-32 compile.

  Signed-off-by: Jan Beulich <JBeulich@suse.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  24ff9723e0398e78355ea4b83df50eafb154d4dc:hvm: Limit the size of large HVM op batches

  Doing large p2m updates for HVMOP_track_dirty_vram without preemption
  ties up the physical processor. Integrating preemption into the p2m
  updates is hard so simply limit to 1GB which is sufficient for a 15000
  * 15000 * 32bpp framebuffer.

  For HVMOP_modified_memory and HVMOP_set_mem_type preemptible add the
  necessary machinery to handle preemption.

  This is CVE-2012-5511 / XSA-27.

  Signed-off-by: Tim Deegan <tim@xen.org>
  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson.citrix.com>
  035f1023c47da339b7f710e32c42571326a7b887:hvm: Limit the size of large HVM op batches

  Doing large p2m updates for HVMOP_track_dirty_vram without preemption
  ties up the physical processor. Integrating preemption into the p2m
  updates is hard so simply limit to 1GB which is sufficient for a 15000
  * 15000 * 32bpp framebuffer.

  For HVMOP_modified_memory and HVMOP_set_mem_type preemptible add the
  necessary machinery to handle preemption.

  This is CVE-2012-5511 / XSA-27.

  Signed-off-by: Tim Deegan <tim@xen.org>
  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson.citrix.com>

  v2: Provide definition of GB to fix x86-32 compile.

  Signed-off-by: Jan Beulich <JBeulich@suse.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: eefac7560f9a23e9330c04fe50e1185a1739a18d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 24ff9723e0398e78355ea4b83df50eafb154d4dc
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 035f1023c47da339b7f710e32c42571326a7b887
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 18c40b58752701b7a08e8394aa614cd4f6e21707
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/035f1023c47da339b7f710e32c42571326a7b887
    reference_type: commit
    reference_id: 035f1023c47da339b7f710e32c42571326a7b887
  - url: https://github.com/xen-project/xen/tree/18c40b58752701b7a08e8394aa614cd4f6e21707
    reference_type: commit
    reference_id: 18c40b58752701b7a08e8394aa614cd4f6e21707
  - url: https://github.com/xen-project/xen/tree/24ff9723e0398e78355ea4b83df50eafb154d4dc
    reference_type: commit
    reference_id: 24ff9723e0398e78355ea4b83df50eafb154d4dc
  - url: https://github.com/xen-project/xen/tree/eefac7560f9a23e9330c04fe50e1185a1739a18d
    reference_type: commit
    reference_id: eefac7560f9a23e9330c04fe50e1185a1739a18d
