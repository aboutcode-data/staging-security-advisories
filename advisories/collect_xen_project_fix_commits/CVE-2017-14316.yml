advisory_id: CVE-2017-14316
datasource_id: collect_xen_project_fix_commits/CVE-2017-14316
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  e3f076893c48dfb63218f24d0977e43903bc48e1:xen/mm: make sure node is less than MAX_NUMNODES

  The output of MEMF_get_node(memflags) can be as large as nodeid_t can
  hold (currently 255).  This is then used as an index to arrays of size
  MAX_NUMNODE, which is 64 on x86 and 1 on ARM, can be passed in by an
  untrusted guest (via memory_exchange and increase_reservation) and is
  not currently bounds-checked.

  Check the value in page_alloc.c before using it, and also check the
  value in the hypercall call sites and return -EINVAL if appropriate.
  Don't permit domains other than the hardware or control domain to
  allocate node-constrained memory.

  This is CVE-2017-14316 / XSA-231.

  Reported-by: Matthew Daley <mattd@bugfuzz.com>
  Signed-off-by: George Dunlap <george.dunlap@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 2fece35303529395bfea6b03d2268380ef682c93
  master date: 2017-09-12 14:43:16 +0200
  629eddde2b6d23a08cf2fa3fb7a80399e8dbb96c:xen/mm: make sure node is less than MAX_NUMNODES

  The output of MEMF_get_node(memflags) can be as large as nodeid_t can
  hold (currently 255).  This is then used as an index to arrays of size
  MAX_NUMNODE, which is 64 on x86 and 1 on ARM, can be passed in by an
  untrusted guest (via memory_exchange and increase_reservation) and is
  not currently bounds-checked.

  Check the value in page_alloc.c before using it, and also check the
  value in the hypercall call sites and return -EINVAL if appropriate.
  Don't permit domains other than the hardware or control domain to
  allocate node-constrained memory.

  This is CVE-2017-14316 / XSA-231.

  Reported-by: Matthew Daley <mattd@bugfuzz.com>
  Signed-off-by: George Dunlap <george.dunlap@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 2fece35303529395bfea6b03d2268380ef682c93
  master date: 2017-09-12 14:43:16 +0200
  a67b22324a6e1a8c79b6fcff44ce33c83c416d64:xen/mm: make sure node is less than MAX_NUMNODES

  The output of MEMF_get_node(memflags) can be as large as nodeid_t can
  hold (currently 255).  This is then used as an index to arrays of size
  MAX_NUMNODE, which is 64 on x86 and 1 on ARM, can be passed in by an
  untrusted guest (via memory_exchange and increase_reservation) and is
  not currently bounds-checked.

  Check the value in page_alloc.c before using it, and also check the
  value in the hypercall call sites and return -EINVAL if appropriate.
  Don't permit domains other than the hardware or control domain to
  allocate node-constrained memory.

  This is CVE-2017-14316 / XSA-231.

  Reported-by: Matthew Daley <mattd@bugfuzz.com>
  Signed-off-by: George Dunlap <george.dunlap@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 2fece35303529395bfea6b03d2268380ef682c93
  master date: 2017-09-12 14:43:16 +0200
  90dafa46ea8e9e9a433b18fdf867d99606ea75a2:xen/mm: make sure node is less than MAX_NUMNODES

  The output of MEMF_get_node(memflags) can be as large as nodeid_t can
  hold (currently 255).  This is then used as an index to arrays of size
  MAX_NUMNODE, which is 64 on x86 and 1 on ARM, can be passed in by an
  untrusted guest (via memory_exchange and increase_reservation) and is
  not currently bounds-checked.

  Check the value in page_alloc.c before using it, and also check the
  value in the hypercall call sites and return -EINVAL if appropriate.
  Don't permit domains other than the hardware or control domain to
  allocate node-constrained memory.

  This is CVE-2017-14316 / XSA-231.

  Reported-by: Matthew Daley <mattd@bugfuzz.com>
  Signed-off-by: George Dunlap <george.dunlap@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 2fece35303529395bfea6b03d2268380ef682c93
  master date: 2017-09-12 14:43:16 +0200
  4821228a73d85685b1c2dc61f7d9682cf1b67f0e:xen/mm: make sure node is less than MAX_NUMNODES

  The output of MEMF_get_node(memflags) can be as large as nodeid_t can
  hold (currently 255).  This is then used as an index to arrays of size
  MAX_NUMNODE, which is 64 on x86 and 1 on ARM, can be passed in by an
  untrusted guest (via memory_exchange and increase_reservation) and is
  not currently bounds-checked.

  Check the value in page_alloc.c before using it, and also check the
  value in the hypercall call sites and return -EINVAL if appropriate.
  Don't permit domains other than the hardware or control domain to
  allocate node-constrained memory.

  This is CVE-2017-14316 / XSA-231.

  Reported-by: Matthew Daley <mattd@bugfuzz.com>
  Signed-off-by: George Dunlap <george.dunlap@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 2fece35303529395bfea6b03d2268380ef682c93
  master date: 2017-09-12 14:43:16 +0200
  2fece35303529395bfea6b03d2268380ef682c93:xen/mm: make sure node is less than MAX_NUMNODES

  The output of MEMF_get_node(memflags) can be as large as nodeid_t can
  hold (currently 255).  This is then used as an index to arrays of size
  MAX_NUMNODE, which is 64 on x86 and 1 on ARM, can be passed in by an
  untrusted guest (via memory_exchange and increase_reservation) and is
  not currently bounds-checked.

  Check the value in page_alloc.c before using it, and also check the
  value in the hypercall call sites and return -EINVAL if appropriate.
  Don't permit domains other than the hardware or control domain to
  allocate node-constrained memory.

  This is CVE-2017-14316 / XSA-231.

  Reported-by: Matthew Daley <mattd@bugfuzz.com>
  Signed-off-by: George Dunlap <george.dunlap@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2fece35303529395bfea6b03d2268380ef682c93
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e3f076893c48dfb63218f24d0977e43903bc48e1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 629eddde2b6d23a08cf2fa3fb7a80399e8dbb96c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a67b22324a6e1a8c79b6fcff44ce33c83c416d64
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 90dafa46ea8e9e9a433b18fdf867d99606ea75a2
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4821228a73d85685b1c2dc61f7d9682cf1b67f0e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/2fece35303529395bfea6b03d2268380ef682c93
    reference_type: commit
    reference_id: 2fece35303529395bfea6b03d2268380ef682c93
  - url: https://github.com/xen-project/xen/tree/4821228a73d85685b1c2dc61f7d9682cf1b67f0e
    reference_type: commit
    reference_id: 4821228a73d85685b1c2dc61f7d9682cf1b67f0e
  - url: https://github.com/xen-project/xen/tree/629eddde2b6d23a08cf2fa3fb7a80399e8dbb96c
    reference_type: commit
    reference_id: 629eddde2b6d23a08cf2fa3fb7a80399e8dbb96c
  - url: https://github.com/xen-project/xen/tree/90dafa46ea8e9e9a433b18fdf867d99606ea75a2
    reference_type: commit
    reference_id: 90dafa46ea8e9e9a433b18fdf867d99606ea75a2
  - url: https://github.com/xen-project/xen/tree/a67b22324a6e1a8c79b6fcff44ce33c83c416d64
    reference_type: commit
    reference_id: a67b22324a6e1a8c79b6fcff44ce33c83c416d64
  - url: https://github.com/xen-project/xen/tree/e3f076893c48dfb63218f24d0977e43903bc48e1
    reference_type: commit
    reference_id: e3f076893c48dfb63218f24d0977e43903bc48e1
