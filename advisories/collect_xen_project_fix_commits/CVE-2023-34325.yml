advisory_id: CVE-2023-34325
datasource_id: collect_xen_project_fix_commits/CVE-2023-34325
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  9c114178ffd700112e91f5ec66cf5151b9c9a8cc:libxl: limit bootloader execution in restricted mode

  Introduce a timeout for bootloader execution when running in restricted mode.

  Allow overwriting the default time out with an environment provided value.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Anthony PERARD <anthony.perard@citrix.com>
  1f762642d2cad1a40634e3280361928109d902f1:libxl: add support for running bootloader in restricted mode

  Much like the device model depriv mode, add the same kind of support for the
  bootloader.  Such feature allows passing a UID as a parameter for the
  bootloader to run as, together with the bootloader itself taking the necessary
  actions to isolate.

  Note that the user to run the bootloader as must have the right permissions to
  access the guest disk image (in read mode only), and that the bootloader will
  be run in non-interactive mode when restricted.

  If enabled bootloader restrict mode will attempt to re-use the user(s) from the
  QEMU depriv implementation if no user is provided on the configuration file or
  the environment.  See docs/features/qemu-deprivilege.pandoc for more
  information about how to setup those users.

  Bootloader restrict mode is not enabled by default as it requires certain
  setup to be done first (setup of the user(s) to use in restrict mode).

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Anthony PERARD <anthony.perard@citrix.com>
  e0342ae5556f2b6e2db50701b8a0679a45822ca6:tools/pygrub: Deprivilege pygrub

  Introduce a --runas=<uid> flag to deprivilege pygrub on Linux and *BSDs. It
  also implicitly creates a chroot env where it drops a deprivileged forked
  process. The chroot itself is cleaned up at the end.

  If the --runas arg is present, then pygrub forks, leaving the child to
  deprivilege itself, and waiting for it to complete. When the child exists,
  the parent performs cleanup and exits with the same error code.

  This is roughly what the child does:
    1. Initialize libfsimage (this loads every .so in memory so the chroot
       can avoid bind-mounting /{,usr}/lib*
    2. Create a temporary empty chroot directory
    3. Mount tmpfs in it
    4. Bind mount the disk inside, because libfsimage expects a path, not a
       file descriptor.
    5. Remount the root tmpfs to be stricter (ro,nosuid,nodev)
    6. Set RLIMIT_FSIZE to a sensibly high amount (128 MiB)
    7. Depriv gid, groups and uid

  With this scheme in place, the "output" files are writable (up to
  RLIMIT_FSIZE octets) and the exposed filesystem is immutable and contains
  the single only file we can't easily get rid of (the disk).

  If running on Linux, the child process also unshares mount, IPC, and
  network namespaces before dropping its privileges.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  990e65c3ad9ac08642ce62a92852c80be6c83e96:tools/libfsimage: Export a new function to preload all plugins

  This is work required in order to let pygrub operate in highly deprivileged
  chroot mode. This patch adds a function that preloads every plugin, hence
  ensuring that a on function exit, every shared library is loaded in memory.

  The new "init" function is supposed to be used before depriv, but that's
  fine because it's not acting on untrusted data.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  0710d7d44586251bfca9758890616dc3d6de8a74:tools/pygrub: Open the output files earlier

  This patch allows pygrub to get ahold of every RW file descriptor it needs
  early on. A later patch will clamp the filesystem it can access so it can't
  obtain any others.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  9f2ff9a7c9b3ac734ae99f17f0134ed0343dcccf:tools/pygrub: Small refactors

  Small tidy up to ensure output_directory always has a trailing '/' to ease
  concatenating paths and that `output` can only be a filename or None.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  f4b504c6170c446e61055cbd388ae4e832a9deca:tools/pygrub: Remove unnecessary hypercall

  There's a hypercall being issued in order to determine whether PV64 is
  supported, but since Xen 4.3 that's strictly true so it's not required.

  Plus, this way we can avoid mapping the privcmd interface altogether in the
  depriv pygrub.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  7d85c70431593550e32022e3a19a37f306f49e00:libfsimage/xfs: Add compile-time check to libfsimage

  Adds the common tools include folder to the -I compile flags
  of libfsimage. This allows us to use:
    xen-tools/common-macros.h:BUILD_BUG_ON()

  With it, statically assert a sanitized "blocklog - SECTOR_BITS" cannot
  underflow.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  620500dd1baf33347dfde5e7fde7cf7fe347da5c:libfsimage/xfs: Sanity-check the superblock during mounts

  Sanity-check the XFS superblock for wellformedness at the mount handler.
  This forces pygrub to abort parsing a potentially malformed filesystem and
  ensures the invariants assumed throughout the rest of the code hold.

  Also, derive parameters from previously sanitized parameters where possible
  (rather than reading them off the superblock)

  The code doesn't try to avoid overflowing the end of the disk, because
  that's an unlikely and benign error. Parameters used in calculations of
  xfs_daddr_t (like the root inode index) aren't in critical need of being
  sanitized.

  The sanitization of agblklog is basically checking that no obvious
  overflows happen on agblklog, and then ensuring agblocks is contained in
  the range (2^(sb_agblklog-1), 2^sb_agblklog].

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  ddc45e4eea946bb373a4b4a60c84bf9339cf413b:libfsimage/xfs: Amend mask32lo() to allow the value 32

  agblklog could plausibly be 32, but that would overflow this shift.
  Perform the shift as ULL and cast to u32 at the end instead.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  37fc1e6c1c5c63aafd9cfd76a37728d5baea7d71:libfsimage/xfs: Remove dead code

  xfs_info.agnolog (and related code) and XFS_INO_AGBNO_BITS are dead code
  that serve no purpose.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  c84412457d3507816b5f8e988a9c8dcc4010e984:libxl: limit bootloader execution in restricted mode

  Introduce a timeout for bootloader execution when running in restricted mode.

  Allow overwriting the default time out with an environment provided value.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Anthony PERARD <anthony.perard@citrix.com>
  (cherry picked from commit 9c114178ffd700112e91f5ec66cf5151b9c9a8cc)
  75aa1c977d116acb16dc3715864f92681f86cfb9:libxl: add support for running bootloader in restricted mode

  Much like the device model depriv mode, add the same kind of support for the
  bootloader.  Such feature allows passing a UID as a parameter for the
  bootloader to run as, together with the bootloader itself taking the necessary
  actions to isolate.

  Note that the user to run the bootloader as must have the right permissions to
  access the guest disk image (in read mode only), and that the bootloader will
  be run in non-interactive mode when restricted.

  If enabled bootloader restrict mode will attempt to re-use the user(s) from the
  QEMU depriv implementation if no user is provided on the configuration file or
  the environment.  See docs/features/qemu-deprivilege.pandoc for more
  information about how to setup those users.

  Bootloader restrict mode is not enabled by default as it requires certain
  setup to be done first (setup of the user(s) to use in restrict mode).

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Anthony PERARD <anthony.perard@citrix.com>
  (cherry picked from commit 1f762642d2cad1a40634e3280361928109d902f1)
  a157b71cf530603d794d16eca3dd92ce83d4d55f:libxl: limit bootloader execution in restricted mode

  Introduce a timeout for bootloader execution when running in restricted mode.

  Allow overwriting the default time out with an environment provided value.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Anthony PERARD <anthony.perard@citrix.com>
  (cherry picked from commit 9c114178ffd700112e91f5ec66cf5151b9c9a8cc)
  5182683fffa6b1d4c940203bbb85bb054558c137:libxl: add support for running bootloader in restricted mode

  Much like the device model depriv mode, add the same kind of support for the
  bootloader.  Such feature allows passing a UID as a parameter for the
  bootloader to run as, together with the bootloader itself taking the necessary
  actions to isolate.

  Note that the user to run the bootloader as must have the right permissions to
  access the guest disk image (in read mode only), and that the bootloader will
  be run in non-interactive mode when restricted.

  If enabled bootloader restrict mode will attempt to re-use the user(s) from the
  QEMU depriv implementation if no user is provided on the configuration file or
  the environment.  See docs/features/qemu-deprivilege.pandoc for more
  information about how to setup those users.

  Bootloader restrict mode is not enabled by default as it requires certain
  setup to be done first (setup of the user(s) to use in restrict mode).

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Anthony PERARD <anthony.perard@citrix.com>
  (cherry picked from commit 1f762642d2cad1a40634e3280361928109d902f1)
  46d00dbf4c22b28910f73f66a03e5cabe50b5395:libxl: limit bootloader execution in restricted mode

  Introduce a timeout for bootloader execution when running in restricted mode.

  Allow overwriting the default time out with an environment provided value.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Anthony PERARD <anthony.perard@citrix.com>
  (cherry picked from commit 9c114178ffd700112e91f5ec66cf5151b9c9a8cc)
  42bf49d74b711ca7fef37bcde12928220c8e9700:libxl: add support for running bootloader in restricted mode

  Much like the device model depriv mode, add the same kind of support for the
  bootloader.  Such feature allows passing a UID as a parameter for the
  bootloader to run as, together with the bootloader itself taking the necessary
  actions to isolate.

  Note that the user to run the bootloader as must have the right permissions to
  access the guest disk image (in read mode only), and that the bootloader will
  be run in non-interactive mode when restricted.

  If enabled bootloader restrict mode will attempt to re-use the user(s) from the
  QEMU depriv implementation if no user is provided on the configuration file or
  the environment.  See docs/features/qemu-deprivilege.pandoc for more
  information about how to setup those users.

  Bootloader restrict mode is not enabled by default as it requires certain
  setup to be done first (setup of the user(s) to use in restrict mode).

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Anthony PERARD <anthony.perard@citrix.com>
  (cherry picked from commit 1f762642d2cad1a40634e3280361928109d902f1)
  9a502b6b71665e0a876c33f49cd3e81ee0b0a935:tools/pygrub: Deprivilege pygrub

  Introduce a --runas=<uid> flag to deprivilege pygrub on Linux and *BSDs. It
  also implicitly creates a chroot env where it drops a deprivileged forked
  process. The chroot itself is cleaned up at the end.

  If the --runas arg is present, then pygrub forks, leaving the child to
  deprivilege itself, and waiting for it to complete. When the child exists,
  the parent performs cleanup and exits with the same error code.

  This is roughly what the child does:
    1. Initialize libfsimage (this loads every .so in memory so the chroot
       can avoid bind-mounting /{,usr}/lib*
    2. Create a temporary empty chroot directory
    3. Mount tmpfs in it
    4. Bind mount the disk inside, because libfsimage expects a path, not a
       file descriptor.
    5. Remount the root tmpfs to be stricter (ro,nosuid,nodev)
    6. Set RLIMIT_FSIZE to a sensibly high amount (128 MiB)
    7. Depriv gid, groups and uid

  With this scheme in place, the "output" files are writable (up to
  RLIMIT_FSIZE octets) and the exposed filesystem is immutable and contains
  the single only file we can't easily get rid of (the disk).

  If running on Linux, the child process also unshares mount, IPC, and
  network namespaces before dropping its privileges.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit e0342ae5556f2b6e2db50701b8a0679a45822ca6)
  3ab7e4a4fa0d3cc9dca3e21769938f09e5d62097:tools/libfsimage: Export a new function to preload all plugins

  This is work required in order to let pygrub operate in highly deprivileged
  chroot mode. This patch adds a function that preloads every plugin, hence
  ensuring that a on function exit, every shared library is loaded in memory.

  The new "init" function is supposed to be used before depriv, but that's
  fine because it's not acting on untrusted data.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit 990e65c3ad9ac08642ce62a92852c80be6c83e96)
  609b76c89d84f6c2139abdce459d2363d0c5c2e2:tools/pygrub: Open the output files earlier

  This patch allows pygrub to get ahold of every RW file descriptor it needs
  early on. A later patch will clamp the filesystem it can access so it can't
  obtain any others.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit 0710d7d44586251bfca9758890616dc3d6de8a74)
  844bcf0274938489caa8e431915c93f01b61b443:tools/pygrub: Small refactors

  Small tidy up to ensure output_directory always has a trailing '/' to ease
  concatenating paths and that `output` can only be a filename or None.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit 9f2ff9a7c9b3ac734ae99f17f0134ed0343dcccf)
  ff2ba13b6242843e07e77196f9671c0efb0219fe:tools/pygrub: Remove unnecessary hypercall

  There's a hypercall being issued in order to determine whether PV64 is
  supported, but since Xen 4.3 that's strictly true so it's not required.

  Plus, this way we can avoid mapping the privcmd interface altogether in the
  depriv pygrub.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  (cherry picked from commit f4b504c6170c446e61055cbd388ae4e832a9deca)
  586aab25bbc2e42b97cba514b50280526a870296:libfsimage/xfs: Add compile-time check to libfsimage

  Adds the common tools include folder to the -I compile flags
  of libfsimage. This allows us to use:
    xen-tools/common-macros.h:BUILD_BUG_ON()

  With it, statically assert a sanitized "blocklog - SECTOR_BITS" cannot
  underflow.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 7d85c70431593550e32022e3a19a37f306f49e00)
  964840afc1b74b547bf0fe5bd339ae1462f2b2f1:libfsimage/xfs: Sanity-check the superblock during mounts

  Sanity-check the XFS superblock for wellformedness at the mount handler.
  This forces pygrub to abort parsing a potentially malformed filesystem and
  ensures the invariants assumed throughout the rest of the code hold.

  Also, derive parameters from previously sanitized parameters where possible
  (rather than reading them off the superblock)

  The code doesn't try to avoid overflowing the end of the disk, because
  that's an unlikely and benign error. Parameters used in calculations of
  xfs_daddr_t (like the root inode index) aren't in critical need of being
  sanitized.

  The sanitization of agblklog is basically checking that no obvious
  overflows happen on agblklog, and then ensuring agblocks is contained in
  the range (2^(sb_agblklog-1), 2^sb_agblklog].

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 620500dd1baf33347dfde5e7fde7cf7fe347da5c)
  8c1075d1edd2b9ef43357eef55daa5af03f25155:libfsimage/xfs: Amend mask32lo() to allow the value 32

  agblklog could plausibly be 32, but that would overflow this shift.
  Perform the shift as ULL and cast to u32 at the end instead.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit ddc45e4eea946bb373a4b4a60c84bf9339cf413b)
  60aed4c82c7a1eab806e68c8cabd10d4b8011eb7:libfsimage/xfs: Remove dead code

  xfs_info.agnolog (and related code) and XFS_INO_AGBNO_BITS are dead code
  that serve no purpose.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 37fc1e6c1c5c63aafd9cfd76a37728d5baea7d71)
  1395852e1bc352bf727d18ebe33426e279cdc967:tools/pygrub: Deprivilege pygrub

  Introduce a --runas=<uid> flag to deprivilege pygrub on Linux and *BSDs. It
  also implicitly creates a chroot env where it drops a deprivileged forked
  process. The chroot itself is cleaned up at the end.

  If the --runas arg is present, then pygrub forks, leaving the child to
  deprivilege itself, and waiting for it to complete. When the child exists,
  the parent performs cleanup and exits with the same error code.

  This is roughly what the child does:
    1. Initialize libfsimage (this loads every .so in memory so the chroot
       can avoid bind-mounting /{,usr}/lib*
    2. Create a temporary empty chroot directory
    3. Mount tmpfs in it
    4. Bind mount the disk inside, because libfsimage expects a path, not a
       file descriptor.
    5. Remount the root tmpfs to be stricter (ro,nosuid,nodev)
    6. Set RLIMIT_FSIZE to a sensibly high amount (128 MiB)
    7. Depriv gid, groups and uid

  With this scheme in place, the "output" files are writable (up to
  RLIMIT_FSIZE octets) and the exposed filesystem is immutable and contains
  the single only file we can't easily get rid of (the disk).

  If running on Linux, the child process also unshares mount, IPC, and
  network namespaces before dropping its privileges.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit e0342ae5556f2b6e2db50701b8a0679a45822ca6)
  c1159b5ed4ad7fadc5c650f749b072da9a78fb13:tools/libfsimage: Export a new function to preload all plugins

  This is work required in order to let pygrub operate in highly deprivileged
  chroot mode. This patch adds a function that preloads every plugin, hence
  ensuring that a on function exit, every shared library is loaded in memory.

  The new "init" function is supposed to be used before depriv, but that's
  fine because it's not acting on untrusted data.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit 990e65c3ad9ac08642ce62a92852c80be6c83e96)
  d01f651da05b77714f0f172501993121b77039a7:tools/pygrub: Open the output files earlier

  This patch allows pygrub to get ahold of every RW file descriptor it needs
  early on. A later patch will clamp the filesystem it can access so it can't
  obtain any others.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit 0710d7d44586251bfca9758890616dc3d6de8a74)
  4f46a077fde520dcdc466da611d7abd124f260f8:tools/pygrub: Small refactors

  Small tidy up to ensure output_directory always has a trailing '/' to ease
  concatenating paths and that `output` can only be a filename or None.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit 9f2ff9a7c9b3ac734ae99f17f0134ed0343dcccf)
  3d760a3bb9b55e5dd45534cac3cdb561a57f2ee0:tools/pygrub: Remove unnecessary hypercall

  There's a hypercall being issued in order to determine whether PV64 is
  supported, but since Xen 4.3 that's strictly true so it's not required.

  Plus, this way we can avoid mapping the privcmd interface altogether in the
  depriv pygrub.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  (cherry picked from commit f4b504c6170c446e61055cbd388ae4e832a9deca)
  766126159ee963cdc16ba9cb2b0ca54b98bc148f:libfsimage/xfs: Add compile-time check to libfsimage

  Adds the common tools include folder to the -I compile flags
  of libfsimage. This allows us to use:
    xen-tools/common-macros.h:BUILD_BUG_ON()

  With it, statically assert a sanitized "blocklog - SECTOR_BITS" cannot
  underflow.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 7d85c70431593550e32022e3a19a37f306f49e00)
  2de503f8fd0d07401e92abed1097ceb5fd1801f6:libfsimage/xfs: Sanity-check the superblock during mounts

  Sanity-check the XFS superblock for wellformedness at the mount handler.
  This forces pygrub to abort parsing a potentially malformed filesystem and
  ensures the invariants assumed throughout the rest of the code hold.

  Also, derive parameters from previously sanitized parameters where possible
  (rather than reading them off the superblock)

  The code doesn't try to avoid overflowing the end of the disk, because
  that's an unlikely and benign error. Parameters used in calculations of
  xfs_daddr_t (like the root inode index) aren't in critical need of being
  sanitized.

  The sanitization of agblklog is basically checking that no obvious
  overflows happen on agblklog, and then ensuring agblocks is contained in
  the range (2^(sb_agblklog-1), 2^sb_agblklog].

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 620500dd1baf33347dfde5e7fde7cf7fe347da5c)
  7d520b8d4ec7495f1ef1e4343a4f705a363e0c9c:libfsimage/xfs: Amend mask32lo() to allow the value 32

  agblklog could plausibly be 32, but that would overflow this shift.
  Perform the shift as ULL and cast to u32 at the end instead.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit ddc45e4eea946bb373a4b4a60c84bf9339cf413b)
  d51a2a1843b612b03f764703159a0946fe026750:libfsimage/xfs: Remove dead code

  xfs_info.agnolog (and related code) and XFS_INO_AGBNO_BITS are dead code
  that serve no purpose.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 37fc1e6c1c5c63aafd9cfd76a37728d5baea7d71)
  f5e211654e5fbb7f1fc5cfea7f9c7ab525edb9e7:tools/pygrub: Deprivilege pygrub

  Introduce a --runas=<uid> flag to deprivilege pygrub on Linux and *BSDs. It
  also implicitly creates a chroot env where it drops a deprivileged forked
  process. The chroot itself is cleaned up at the end.

  If the --runas arg is present, then pygrub forks, leaving the child to
  deprivilege itself, and waiting for it to complete. When the child exists,
  the parent performs cleanup and exits with the same error code.

  This is roughly what the child does:
    1. Initialize libfsimage (this loads every .so in memory so the chroot
       can avoid bind-mounting /{,usr}/lib*
    2. Create a temporary empty chroot directory
    3. Mount tmpfs in it
    4. Bind mount the disk inside, because libfsimage expects a path, not a
       file descriptor.
    5. Remount the root tmpfs to be stricter (ro,nosuid,nodev)
    6. Set RLIMIT_FSIZE to a sensibly high amount (128 MiB)
    7. Depriv gid, groups and uid

  With this scheme in place, the "output" files are writable (up to
  RLIMIT_FSIZE octets) and the exposed filesystem is immutable and contains
  the single only file we can't easily get rid of (the disk).

  If running on Linux, the child process also unshares mount, IPC, and
  network namespaces before dropping its privileges.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit e0342ae5556f2b6e2db50701b8a0679a45822ca6)
  8ee19246ad2c1d0ce241a52683f56b144a4f0b0e:tools/libfsimage: Export a new function to preload all plugins

  This is work required in order to let pygrub operate in highly deprivileged
  chroot mode. This patch adds a function that preloads every plugin, hence
  ensuring that a on function exit, every shared library is loaded in memory.

  The new "init" function is supposed to be used before depriv, but that's
  fine because it's not acting on untrusted data.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit 990e65c3ad9ac08642ce62a92852c80be6c83e96)
  37977420670c65db220349510599d3fe47600ad8:tools/pygrub: Open the output files earlier

  This patch allows pygrub to get ahold of every RW file descriptor it needs
  early on. A later patch will clamp the filesystem it can access so it can't
  obtain any others.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit 0710d7d44586251bfca9758890616dc3d6de8a74)
  e7059f16f7c2b99fea30b9671fec74c0375eee8f:tools/pygrub: Small refactors

  Small tidy up to ensure output_directory always has a trailing '/' to ease
  concatenating paths and that `output` can only be a filename or None.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  (cherry picked from commit 9f2ff9a7c9b3ac734ae99f17f0134ed0343dcccf)
  8a584126eae53a44cefb0acdbca201233a557fa5:tools/pygrub: Remove unnecessary hypercall

  There's a hypercall being issued in order to determine whether PV64 is
  supported, but since Xen 4.3 that's strictly true so it's not required.

  Plus, this way we can avoid mapping the privcmd interface altogether in the
  depriv pygrub.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  (cherry picked from commit f4b504c6170c446e61055cbd388ae4e832a9deca)
  eb4efdac4cc7121f832ee156f39761312878f3a5:libfsimage/xfs: Add compile-time check to libfsimage

  Adds the common tools include folder to the -I compile flags
  of libfsimage. This allows us to use:
    xen-tools/common-macros.h:BUILD_BUG_ON()

  With it, statically assert a sanitized "blocklog - SECTOR_BITS" cannot
  underflow.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 7d85c70431593550e32022e3a19a37f306f49e00)
  78143c5336c8316bcc648e964d65a07f216cf77f:libfsimage/xfs: Sanity-check the superblock during mounts

  Sanity-check the XFS superblock for wellformedness at the mount handler.
  This forces pygrub to abort parsing a potentially malformed filesystem and
  ensures the invariants assumed throughout the rest of the code hold.

  Also, derive parameters from previously sanitized parameters where possible
  (rather than reading them off the superblock)

  The code doesn't try to avoid overflowing the end of the disk, because
  that's an unlikely and benign error. Parameters used in calculations of
  xfs_daddr_t (like the root inode index) aren't in critical need of being
  sanitized.

  The sanitization of agblklog is basically checking that no obvious
  overflows happen on agblklog, and then ensuring agblocks is contained in
  the range (2^(sb_agblklog-1), 2^sb_agblklog].

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 620500dd1baf33347dfde5e7fde7cf7fe347da5c)
  f1cd620cc3572c858e276463e05f695d949362c5:libfsimage/xfs: Amend mask32lo() to allow the value 32

  agblklog could plausibly be 32, but that would overflow this shift.
  Perform the shift as ULL and cast to u32 at the end instead.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit ddc45e4eea946bb373a4b4a60c84bf9339cf413b)
  d665c6690eb3c2c86cb2c7dac09804211481f926:libfsimage/xfs: Remove dead code

  xfs_info.agnolog (and related code) and XFS_INO_AGBNO_BITS are dead code
  that serve no purpose.

  This is part of XSA-443 / CVE-2023-34325

  Signed-off-by: Alejandro Vallejo <alejandro.vallejo@cloud.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 37fc1e6c1c5c63aafd9cfd76a37728d5baea7d71)
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 60aed4c82c7a1eab806e68c8cabd10d4b8011eb7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e7059f16f7c2b99fea30b9671fec74c0375eee8f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f4b504c6170c446e61055cbd388ae4e832a9deca
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ddc45e4eea946bb373a4b4a60c84bf9339cf413b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1395852e1bc352bf727d18ebe33426e279cdc967
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8ee19246ad2c1d0ce241a52683f56b144a4f0b0e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0710d7d44586251bfca9758890616dc3d6de8a74
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 766126159ee963cdc16ba9cb2b0ca54b98bc148f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7d520b8d4ec7495f1ef1e4343a4f705a363e0c9c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 75aa1c977d116acb16dc3715864f92681f86cfb9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8a584126eae53a44cefb0acdbca201233a557fa5
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7d85c70431593550e32022e3a19a37f306f49e00
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 586aab25bbc2e42b97cba514b50280526a870296
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5182683fffa6b1d4c940203bbb85bb054558c137
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1f762642d2cad1a40634e3280361928109d902f1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c84412457d3507816b5f8e988a9c8dcc4010e984
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 844bcf0274938489caa8e431915c93f01b61b443
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c1159b5ed4ad7fadc5c650f749b072da9a78fb13
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f1cd620cc3572c858e276463e05f695d949362c5
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4f46a077fde520dcdc466da611d7abd124f260f8
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3ab7e4a4fa0d3cc9dca3e21769938f09e5d62097
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 609b76c89d84f6c2139abdce459d2363d0c5c2e2
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 37fc1e6c1c5c63aafd9cfd76a37728d5baea7d71
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 78143c5336c8316bcc648e964d65a07f216cf77f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a157b71cf530603d794d16eca3dd92ce83d4d55f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8c1075d1edd2b9ef43357eef55daa5af03f25155
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2de503f8fd0d07401e92abed1097ceb5fd1801f6
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d665c6690eb3c2c86cb2c7dac09804211481f926
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 990e65c3ad9ac08642ce62a92852c80be6c83e96
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 620500dd1baf33347dfde5e7fde7cf7fe347da5c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f5e211654e5fbb7f1fc5cfea7f9c7ab525edb9e7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3d760a3bb9b55e5dd45534cac3cdb561a57f2ee0
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9c114178ffd700112e91f5ec66cf5151b9c9a8cc
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d51a2a1843b612b03f764703159a0946fe026750
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ff2ba13b6242843e07e77196f9671c0efb0219fe
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9a502b6b71665e0a876c33f49cd3e81ee0b0a935
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 46d00dbf4c22b28910f73f66a03e5cabe50b5395
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9f2ff9a7c9b3ac734ae99f17f0134ed0343dcccf
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 964840afc1b74b547bf0fe5bd339ae1462f2b2f1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: eb4efdac4cc7121f832ee156f39761312878f3a5
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d01f651da05b77714f0f172501993121b77039a7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 37977420670c65db220349510599d3fe47600ad8
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e0342ae5556f2b6e2db50701b8a0679a45822ca6
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 42bf49d74b711ca7fef37bcde12928220c8e9700
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/0710d7d44586251bfca9758890616dc3d6de8a74
    reference_type: commit
    reference_id: 0710d7d44586251bfca9758890616dc3d6de8a74
  - url: https://github.com/xen-project/xen/tree/1395852e1bc352bf727d18ebe33426e279cdc967
    reference_type: commit
    reference_id: 1395852e1bc352bf727d18ebe33426e279cdc967
  - url: https://github.com/xen-project/xen/tree/1f762642d2cad1a40634e3280361928109d902f1
    reference_type: commit
    reference_id: 1f762642d2cad1a40634e3280361928109d902f1
  - url: https://github.com/xen-project/xen/tree/2de503f8fd0d07401e92abed1097ceb5fd1801f6
    reference_type: commit
    reference_id: 2de503f8fd0d07401e92abed1097ceb5fd1801f6
  - url: https://github.com/xen-project/xen/tree/37977420670c65db220349510599d3fe47600ad8
    reference_type: commit
    reference_id: 37977420670c65db220349510599d3fe47600ad8
  - url: https://github.com/xen-project/xen/tree/37fc1e6c1c5c63aafd9cfd76a37728d5baea7d71
    reference_type: commit
    reference_id: 37fc1e6c1c5c63aafd9cfd76a37728d5baea7d71
  - url: https://github.com/xen-project/xen/tree/3ab7e4a4fa0d3cc9dca3e21769938f09e5d62097
    reference_type: commit
    reference_id: 3ab7e4a4fa0d3cc9dca3e21769938f09e5d62097
  - url: https://github.com/xen-project/xen/tree/3d760a3bb9b55e5dd45534cac3cdb561a57f2ee0
    reference_type: commit
    reference_id: 3d760a3bb9b55e5dd45534cac3cdb561a57f2ee0
  - url: https://github.com/xen-project/xen/tree/42bf49d74b711ca7fef37bcde12928220c8e9700
    reference_type: commit
    reference_id: 42bf49d74b711ca7fef37bcde12928220c8e9700
  - url: https://github.com/xen-project/xen/tree/46d00dbf4c22b28910f73f66a03e5cabe50b5395
    reference_type: commit
    reference_id: 46d00dbf4c22b28910f73f66a03e5cabe50b5395
  - url: https://github.com/xen-project/xen/tree/4f46a077fde520dcdc466da611d7abd124f260f8
    reference_type: commit
    reference_id: 4f46a077fde520dcdc466da611d7abd124f260f8
  - url: https://github.com/xen-project/xen/tree/5182683fffa6b1d4c940203bbb85bb054558c137
    reference_type: commit
    reference_id: 5182683fffa6b1d4c940203bbb85bb054558c137
  - url: https://github.com/xen-project/xen/tree/586aab25bbc2e42b97cba514b50280526a870296
    reference_type: commit
    reference_id: 586aab25bbc2e42b97cba514b50280526a870296
  - url: https://github.com/xen-project/xen/tree/609b76c89d84f6c2139abdce459d2363d0c5c2e2
    reference_type: commit
    reference_id: 609b76c89d84f6c2139abdce459d2363d0c5c2e2
  - url: https://github.com/xen-project/xen/tree/60aed4c82c7a1eab806e68c8cabd10d4b8011eb7
    reference_type: commit
    reference_id: 60aed4c82c7a1eab806e68c8cabd10d4b8011eb7
  - url: https://github.com/xen-project/xen/tree/620500dd1baf33347dfde5e7fde7cf7fe347da5c
    reference_type: commit
    reference_id: 620500dd1baf33347dfde5e7fde7cf7fe347da5c
  - url: https://github.com/xen-project/xen/tree/75aa1c977d116acb16dc3715864f92681f86cfb9
    reference_type: commit
    reference_id: 75aa1c977d116acb16dc3715864f92681f86cfb9
  - url: https://github.com/xen-project/xen/tree/766126159ee963cdc16ba9cb2b0ca54b98bc148f
    reference_type: commit
    reference_id: 766126159ee963cdc16ba9cb2b0ca54b98bc148f
  - url: https://github.com/xen-project/xen/tree/78143c5336c8316bcc648e964d65a07f216cf77f
    reference_type: commit
    reference_id: 78143c5336c8316bcc648e964d65a07f216cf77f
  - url: https://github.com/xen-project/xen/tree/7d520b8d4ec7495f1ef1e4343a4f705a363e0c9c
    reference_type: commit
    reference_id: 7d520b8d4ec7495f1ef1e4343a4f705a363e0c9c
  - url: https://github.com/xen-project/xen/tree/7d85c70431593550e32022e3a19a37f306f49e00
    reference_type: commit
    reference_id: 7d85c70431593550e32022e3a19a37f306f49e00
  - url: https://github.com/xen-project/xen/tree/844bcf0274938489caa8e431915c93f01b61b443
    reference_type: commit
    reference_id: 844bcf0274938489caa8e431915c93f01b61b443
  - url: https://github.com/xen-project/xen/tree/8a584126eae53a44cefb0acdbca201233a557fa5
    reference_type: commit
    reference_id: 8a584126eae53a44cefb0acdbca201233a557fa5
  - url: https://github.com/xen-project/xen/tree/8c1075d1edd2b9ef43357eef55daa5af03f25155
    reference_type: commit
    reference_id: 8c1075d1edd2b9ef43357eef55daa5af03f25155
  - url: https://github.com/xen-project/xen/tree/8ee19246ad2c1d0ce241a52683f56b144a4f0b0e
    reference_type: commit
    reference_id: 8ee19246ad2c1d0ce241a52683f56b144a4f0b0e
  - url: https://github.com/xen-project/xen/tree/964840afc1b74b547bf0fe5bd339ae1462f2b2f1
    reference_type: commit
    reference_id: 964840afc1b74b547bf0fe5bd339ae1462f2b2f1
  - url: https://github.com/xen-project/xen/tree/990e65c3ad9ac08642ce62a92852c80be6c83e96
    reference_type: commit
    reference_id: 990e65c3ad9ac08642ce62a92852c80be6c83e96
  - url: https://github.com/xen-project/xen/tree/9a502b6b71665e0a876c33f49cd3e81ee0b0a935
    reference_type: commit
    reference_id: 9a502b6b71665e0a876c33f49cd3e81ee0b0a935
  - url: https://github.com/xen-project/xen/tree/9c114178ffd700112e91f5ec66cf5151b9c9a8cc
    reference_type: commit
    reference_id: 9c114178ffd700112e91f5ec66cf5151b9c9a8cc
  - url: https://github.com/xen-project/xen/tree/9f2ff9a7c9b3ac734ae99f17f0134ed0343dcccf
    reference_type: commit
    reference_id: 9f2ff9a7c9b3ac734ae99f17f0134ed0343dcccf
  - url: https://github.com/xen-project/xen/tree/a157b71cf530603d794d16eca3dd92ce83d4d55f
    reference_type: commit
    reference_id: a157b71cf530603d794d16eca3dd92ce83d4d55f
  - url: https://github.com/xen-project/xen/tree/c1159b5ed4ad7fadc5c650f749b072da9a78fb13
    reference_type: commit
    reference_id: c1159b5ed4ad7fadc5c650f749b072da9a78fb13
  - url: https://github.com/xen-project/xen/tree/c84412457d3507816b5f8e988a9c8dcc4010e984
    reference_type: commit
    reference_id: c84412457d3507816b5f8e988a9c8dcc4010e984
  - url: https://github.com/xen-project/xen/tree/d01f651da05b77714f0f172501993121b77039a7
    reference_type: commit
    reference_id: d01f651da05b77714f0f172501993121b77039a7
  - url: https://github.com/xen-project/xen/tree/d51a2a1843b612b03f764703159a0946fe026750
    reference_type: commit
    reference_id: d51a2a1843b612b03f764703159a0946fe026750
  - url: https://github.com/xen-project/xen/tree/d665c6690eb3c2c86cb2c7dac09804211481f926
    reference_type: commit
    reference_id: d665c6690eb3c2c86cb2c7dac09804211481f926
  - url: https://github.com/xen-project/xen/tree/ddc45e4eea946bb373a4b4a60c84bf9339cf413b
    reference_type: commit
    reference_id: ddc45e4eea946bb373a4b4a60c84bf9339cf413b
  - url: https://github.com/xen-project/xen/tree/e0342ae5556f2b6e2db50701b8a0679a45822ca6
    reference_type: commit
    reference_id: e0342ae5556f2b6e2db50701b8a0679a45822ca6
  - url: https://github.com/xen-project/xen/tree/e7059f16f7c2b99fea30b9671fec74c0375eee8f
    reference_type: commit
    reference_id: e7059f16f7c2b99fea30b9671fec74c0375eee8f
  - url: https://github.com/xen-project/xen/tree/eb4efdac4cc7121f832ee156f39761312878f3a5
    reference_type: commit
    reference_id: eb4efdac4cc7121f832ee156f39761312878f3a5
  - url: https://github.com/xen-project/xen/tree/f1cd620cc3572c858e276463e05f695d949362c5
    reference_type: commit
    reference_id: f1cd620cc3572c858e276463e05f695d949362c5
  - url: https://github.com/xen-project/xen/tree/f4b504c6170c446e61055cbd388ae4e832a9deca
    reference_type: commit
    reference_id: f4b504c6170c446e61055cbd388ae4e832a9deca
  - url: https://github.com/xen-project/xen/tree/f5e211654e5fbb7f1fc5cfea7f9c7ab525edb9e7
    reference_type: commit
    reference_id: f5e211654e5fbb7f1fc5cfea7f9c7ab525edb9e7
  - url: https://github.com/xen-project/xen/tree/ff2ba13b6242843e07e77196f9671c0efb0219fe
    reference_type: commit
    reference_id: ff2ba13b6242843e07e77196f9671c0efb0219fe
