advisory_id: CVE-2016-1571
datasource_id: collect_xen_project_fix_commits/CVE-2016-1571
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  93d789e76102bc3ec940292f9c3450b777490931:x86/VMX: prevent INVVPID failure due to non-canonical guest address

  While INVLPG (and on SVM INVLPGA) don't fault on non-canonical
  addresses, INVVPID fails (in the "individual address" case) when passed
  such an address.

  Since such intercepted INVLPG are effectively no-ops anyway, don't fix
  this in vmx_invlpg_intercept(), but instead have paging_invlpg() never
  return true in such a case.

  This is CVE-2016-1571 / XSA-168.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  master commit: bf05e88ed7342a91cceba050b6c622accb809842
  master date: 2016-01-20 13:50:10 +0100
  f8aad022072157a41ad7a03d7596dc389eb66b70:x86/VMX: prevent INVVPID failure due to non-canonical guest address

  While INVLPG (and on SVM INVLPGA) don't fault on non-canonical
  addresses, INVVPID fails (in the "individual address" case) when passed
  such an address.

  Since such intercepted INVLPG are effectively no-ops anyway, don't fix
  this in vmx_invlpg_intercept(), but instead have paging_invlpg() never
  return true in such a case.

  This is CVE-2016-1571 / XSA-168.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  master commit: bf05e88ed7342a91cceba050b6c622accb809842
  master date: 2016-01-20 13:50:10 +0100
  934e86f1d9ba94bc7d50f4fa30cab495ef79bbdc:x86/VMX: prevent INVVPID failure due to non-canonical guest address

  While INVLPG (and on SVM INVLPGA) don't fault on non-canonical
  addresses, INVVPID fails (in the "individual address" case) when passed
  such an address.

  Since such intercepted INVLPG are effectively no-ops anyway, don't fix
  this in vmx_invlpg_intercept(), but instead have paging_invlpg() never
  return true in such a case.

  This is CVE-2016-1571 / XSA-168.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  master commit: bf05e88ed7342a91cceba050b6c622accb809842
  master date: 2016-01-20 13:50:10 +0100
  99e0fb590fab567221d3eec26d275473e1b05781:x86/VMX: prevent INVVPID failure due to non-canonical guest address

  While INVLPG (and on SVM INVLPGA) don't fault on non-canonical
  addresses, INVVPID fails (in the "individual address" case) when passed
  such an address.

  Since such intercepted INVLPG are effectively no-ops anyway, don't fix
  this in vmx_invlpg_intercept(), but instead have paging_invlpg() never
  return true in such a case.

  This is CVE-2016-1571 / XSA-168.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  master commit: bf05e88ed7342a91cceba050b6c622accb809842
  master date: 2016-01-20 13:50:10 +0100
  bf05e88ed7342a91cceba050b6c622accb809842:x86/VMX: prevent INVVPID failure due to non-canonical guest address

  While INVLPG (and on SVM INVLPGA) don't fault on non-canonical
  addresses, INVVPID fails (in the "individual address" case) when passed
  such an address.

  Since such intercepted INVLPG are effectively no-ops anyway, don't fix
  this in vmx_invlpg_intercept(), but instead have paging_invlpg() never
  return true in such a case.

  This is CVE-2016-1571 / XSA-168.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 93d789e76102bc3ec940292f9c3450b777490931
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f8aad022072157a41ad7a03d7596dc389eb66b70
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 99e0fb590fab567221d3eec26d275473e1b05781
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: bf05e88ed7342a91cceba050b6c622accb809842
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 934e86f1d9ba94bc7d50f4fa30cab495ef79bbdc
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/934e86f1d9ba94bc7d50f4fa30cab495ef79bbdc
    reference_type: commit
    reference_id: 934e86f1d9ba94bc7d50f4fa30cab495ef79bbdc
  - url: https://github.com/xen-project/xen/tree/93d789e76102bc3ec940292f9c3450b777490931
    reference_type: commit
    reference_id: 93d789e76102bc3ec940292f9c3450b777490931
  - url: https://github.com/xen-project/xen/tree/99e0fb590fab567221d3eec26d275473e1b05781
    reference_type: commit
    reference_id: 99e0fb590fab567221d3eec26d275473e1b05781
  - url: https://github.com/xen-project/xen/tree/bf05e88ed7342a91cceba050b6c622accb809842
    reference_type: commit
    reference_id: bf05e88ed7342a91cceba050b6c622accb809842
  - url: https://github.com/xen-project/xen/tree/f8aad022072157a41ad7a03d7596dc389eb66b70
    reference_type: commit
    reference_id: f8aad022072157a41ad7a03d7596dc389eb66b70
