advisory_id: CVE-2014-2915
datasource_id: collect_xen_project_fix_commits/CVE-2014-2915
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  da8e1586278dffd8510876e6fed8d47c9eba713c:xen/arm: Don't let guess access to Debug and Performance Monitor registers

  Debug and performance registers are not properly switched by Xen.

  Trap them and inject an undefined instruction, except for those registers
  which might be unconditionally accessed which we implement as RAZ/WI.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  8f416fc2669769a72783e13072547f8b2d071065:xen/arm: Don't expose implementation defined registers (Cp15 c15) to the guest

  On Cortex-A15, CP15 c15 contains registers to retrieve data from L1/L2 RAM.

  Exposing this registers to guest may result to leak data from Xen and/or
  another guest.

  By default trap every registers and inject an undefined instruction.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  4642a2146e3d309266f537e7bbf55f5d85249229:xen/arm: Trap cache and TCM lockdown registers

  Some cp15 c9/c10/c11 encodings are used for:
       - cache control
       - TCM control
       - branch predictor control

  All of them are implementation defined. For now inject an undefined exception
  if the guest wants try to access it.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  16ef39e797b0ef82449321ff5af7590e17b1b670:xen/arm: Upgrade DCISW into DCCISW

  A guest is allowed to use invalidate cache by set/way instruction (i.e DCISW)
  without any restriction. As the cache is shared with Xen, the guest invalidate
  an address being in used by Xen. This may lead a Xen crash because the memory
  state is invalid.
  Set the bit HCR.SWIO to upgrade invalidate cache by set/way instruction to an
  invalidate and clean.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Reported-by: Thomas Leonard <tal36@cam.ac.uk>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  9800bfa275b654b20522c1c8e78eba12d4b21e2f:xen/arm: Don't let the guest access the coprocessors registers

  In Xen we only handle save/restore for coprocessor 10 and 11 (NEON). Other
  coprocessors (0-9, 12-13) are currently exposed to the guest and may lead
  to data shared between guest.

  Disable access to all coprocessor except 10 and 11 by setting correctly
  HCTPR.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  ed13367f161c8e0716f75773c7915df1d0388263:xen/arm: Inject an undefined instruction when the coproc/sysreg is not handled

  Currently Xen panics if it's unable to handle a coprocessor/sysreg instruction.
  Replace this behavior by inject an undefined instruction to the faulty guest
  and log if Xen is in debug mode.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  0b182202fef8ebfc093a00ead9414a683eb8807c:xen/arm: Don't let guess access to Debug and Performance Monitor registers

  Debug and performance registers are not properly switched by Xen.

  Trap them and inject an undefined instruction, except for those registers
  which might be unconditionally accessed which we implement as RAZ/WI.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  a0453db0c6ead85e0e2143c133268bcc5a017f73:xen/arm: Don't expose implementation defined registers (Cp15 c15) to the guest

  On Cortex-A15, CP15 c15 contains registers to retrieve data from L1/L2 RAM.

  Exposing this registers to guest may result to leak data from Xen and/or
  another guest.

  By default trap every registers and inject an undefined instruction.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  11faafd9d9739a47d5fa360a43669f52672ef40e:xen/arm: Trap cache and TCM lockdown registers

  Some cp15 c9/c10/c11 encodings are used for:
       - cache control
       - TCM control
       - branch predictor control

  All of them are implementation defined. For now inject an undefined exception
  if the guest wants try to access it.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  cda12fa0cee7023878598ff8ced3613b57576ce3:xen/arm: Upgrade DCISW into DCCISW

  A guest is allowed to use invalidate cache by set/way instruction (i.e DCISW)
  without any restriction. As the cache is shared with Xen, the guest invalidate
  an address being in used by Xen. This may lead a Xen crash because the memory
  state is invalid.
  Set the bit HCR.SWIO to upgrade invalidate cache by set/way instruction to an
  invalidate and clean.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Reported-by: Thomas Leonard <tal36@cam.ac.uk>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  5496c642535da9c5738a3e19276de564304a5082:xen/arm: Don't let the guest access the coprocessors registers

  In Xen we only handle save/restore for coprocessor 10 and 11 (NEON). Other
  coprocessors (0-9, 12-13) are currently exposed to the guest and may lead
  to data shared between guest.

  Disable access to all coprocessor except 10 and 11 by setting correctly
  HCTPR.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  60f737636c2be52fe1af2f1a3a2f66acacdc6a30:xen/arm: Inject an undefined instruction when the coproc/sysreg is not handled

  Currently Xen panics if it's unable to handle a coprocessor/sysreg instruction.
  Replace this behavior by inject an undefined instruction to the faulty guest
  and log if Xen is in debug mode.

  This is CVE-2014-2915 / XSA-93.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4642a2146e3d309266f537e7bbf55f5d85249229
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: da8e1586278dffd8510876e6fed8d47c9eba713c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: cda12fa0cee7023878598ff8ced3613b57576ce3
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9800bfa275b654b20522c1c8e78eba12d4b21e2f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ed13367f161c8e0716f75773c7915df1d0388263
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8f416fc2669769a72783e13072547f8b2d071065
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a0453db0c6ead85e0e2143c133268bcc5a017f73
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 60f737636c2be52fe1af2f1a3a2f66acacdc6a30
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 11faafd9d9739a47d5fa360a43669f52672ef40e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 16ef39e797b0ef82449321ff5af7590e17b1b670
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5496c642535da9c5738a3e19276de564304a5082
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0b182202fef8ebfc093a00ead9414a683eb8807c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/0b182202fef8ebfc093a00ead9414a683eb8807c
    reference_type: commit
    reference_id: 0b182202fef8ebfc093a00ead9414a683eb8807c
  - url: https://github.com/xen-project/xen/tree/11faafd9d9739a47d5fa360a43669f52672ef40e
    reference_type: commit
    reference_id: 11faafd9d9739a47d5fa360a43669f52672ef40e
  - url: https://github.com/xen-project/xen/tree/16ef39e797b0ef82449321ff5af7590e17b1b670
    reference_type: commit
    reference_id: 16ef39e797b0ef82449321ff5af7590e17b1b670
  - url: https://github.com/xen-project/xen/tree/4642a2146e3d309266f537e7bbf55f5d85249229
    reference_type: commit
    reference_id: 4642a2146e3d309266f537e7bbf55f5d85249229
  - url: https://github.com/xen-project/xen/tree/5496c642535da9c5738a3e19276de564304a5082
    reference_type: commit
    reference_id: 5496c642535da9c5738a3e19276de564304a5082
  - url: https://github.com/xen-project/xen/tree/60f737636c2be52fe1af2f1a3a2f66acacdc6a30
    reference_type: commit
    reference_id: 60f737636c2be52fe1af2f1a3a2f66acacdc6a30
  - url: https://github.com/xen-project/xen/tree/8f416fc2669769a72783e13072547f8b2d071065
    reference_type: commit
    reference_id: 8f416fc2669769a72783e13072547f8b2d071065
  - url: https://github.com/xen-project/xen/tree/9800bfa275b654b20522c1c8e78eba12d4b21e2f
    reference_type: commit
    reference_id: 9800bfa275b654b20522c1c8e78eba12d4b21e2f
  - url: https://github.com/xen-project/xen/tree/a0453db0c6ead85e0e2143c133268bcc5a017f73
    reference_type: commit
    reference_id: a0453db0c6ead85e0e2143c133268bcc5a017f73
  - url: https://github.com/xen-project/xen/tree/cda12fa0cee7023878598ff8ced3613b57576ce3
    reference_type: commit
    reference_id: cda12fa0cee7023878598ff8ced3613b57576ce3
  - url: https://github.com/xen-project/xen/tree/da8e1586278dffd8510876e6fed8d47c9eba713c
    reference_type: commit
    reference_id: da8e1586278dffd8510876e6fed8d47c9eba713c
  - url: https://github.com/xen-project/xen/tree/ed13367f161c8e0716f75773c7915df1d0388263
    reference_type: commit
    reference_id: ed13367f161c8e0716f75773c7915df1d0388263
