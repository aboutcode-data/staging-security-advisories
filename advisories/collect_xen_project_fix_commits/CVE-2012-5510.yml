advisory_id: CVE-2012-5510
datasource_id: collect_xen_project_fix_commits/CVE-2012-5510
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  3ddccf9b60463dae9adffa7f8cef891e40aa1bd4:gnttab: fix releasing of memory upon switches between versions

  gnttab_unpopulate_status_frames() incompletely freed the pages
  previously used as status frame in that they did not get removed from
  the domain's xenpage_list, thus causing subsequent list corruption
  when those pages did get allocated again for the same or another purpose.

  Similarly, grant_table_create() and gnttab_grow_table() both improperly
  clean up in the event of an error - pages already shared with the guest
  can't be freed by just passing them to free_xenheap_page(). Fix this by
  sharing the pages only after all allocations succeeded.

  This is CVE-2012-5510 / XSA-26.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Ian Jackson <ian.jackson.citrix.com>
  23d9492080ae7ce6e281b6ccae1ecff9d4d9ea3a:gnttab: fix releasing of memory upon switches between versions

  gnttab_unpopulate_status_frames() incompletely freed the pages
  previously used as status frame in that they did not get removed from
  the domain's xenpage_list, thus causing subsequent list corruption
  when those pages did get allocated again for the same or another purpose.

  Similarly, grant_table_create() and gnttab_grow_table() both improperly
  clean up in the event of an error - pages already shared with the guest
  can't be freed by just passing them to free_xenheap_page(). Fix this by
  sharing the pages only after all allocations succeeded.

  This is CVE-2012-5510 / XSA-26.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Ian Jackson <ian.jackson.citrix.com>
  7e23d7b3687c6e69c4156f5b5d0bb529896e8156:gnttab: fix releasing of memory upon switches between versions

  gnttab_unpopulate_status_frames() incompletely freed the pages
  previously used as status frame in that they did not get removed from
  the domain's xenpage_list, thus causing subsequent list corruption
  when those pages did get allocated again for the same or another purpose.

  Similarly, grant_table_create() and gnttab_grow_table() both improperly
  clean up in the event of an error - pages already shared with the guest
  can't be freed by just passing them to free_xenheap_page(). Fix this by
  sharing the pages only after all allocations succeeded.

  This is CVE-2012-5510 / XSA-26.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Ian Jackson <ian.jackson.citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3ddccf9b60463dae9adffa7f8cef891e40aa1bd4
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7e23d7b3687c6e69c4156f5b5d0bb529896e8156
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 23d9492080ae7ce6e281b6ccae1ecff9d4d9ea3a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/23d9492080ae7ce6e281b6ccae1ecff9d4d9ea3a
    reference_type: commit
    reference_id: 23d9492080ae7ce6e281b6ccae1ecff9d4d9ea3a
  - url: https://github.com/xen-project/xen/tree/3ddccf9b60463dae9adffa7f8cef891e40aa1bd4
    reference_type: commit
    reference_id: 3ddccf9b60463dae9adffa7f8cef891e40aa1bd4
  - url: https://github.com/xen-project/xen/tree/7e23d7b3687c6e69c4156f5b5d0bb529896e8156
    reference_type: commit
    reference_id: 7e23d7b3687c6e69c4156f5b5d0bb529896e8156
