advisory_id: CVE-2012-4536
datasource_id: collect_xen_project_fix_commits/CVE-2012-4536
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  50d1a7fea0a60cd66733cfd8666a95f00d586549:x86/physdev: Range check pirq parameter from guests

  Otherwise Xen will read beyond either end of the struct
  domain.arch.pirq_emuirq array, usually resulting in a fatal page fault.

  This vulnerability was introduced by c/s 23241:d21100f1d00e, which adds
  a call to domain_pirq_to_emuirq() which uses the guest provided pirq
  value before range checking it, and was fixed by c/s 23573:584c2e5e03d9
  which changed the behaviour of the domain_pirq_to_emuirq() macro to use
  radix trees instead of a flat array.

  This is XSA-21 / CVE-2012-4536.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 50d1a7fea0a60cd66733cfd8666a95f00d586549
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/50d1a7fea0a60cd66733cfd8666a95f00d586549
    reference_type: commit
    reference_id: 50d1a7fea0a60cd66733cfd8666a95f00d586549
