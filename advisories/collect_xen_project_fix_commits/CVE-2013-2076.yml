advisory_id: CVE-2013-2076
datasource_id: collect_xen_project_fix_commits/CVE-2013-2076
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  c3401c1aece47dc5388184c9b6a3527655d5bbdf:x86/xsave: fix information leak on AMD CPUs

  Just like for FXSAVE/FXRSTOR, XSAVE/XRSTOR also don't save/restore the
  last instruction and operand pointers as well as the last opcode if
  there's no pending unmasked exception (see CVE-2006-1056 and commit
  9747:4d667a139318).

  While the FXSR solution sits in the save path, I prefer to have this in
  the restore path because there the handling is simpler (namely in the
  context of the pending changes to properly save the selector values for
  32-bit guest code).

  Also this is using FFREE instead of EMMS, as it doesn't seem unlikely
  that in the future we may see CPUs with x87 and SSE/AVX but no MMX
  support. The goal here anyway is just to avoid an FPU stack overflow.
  I would have preferred to use FFREEP instead of FFREE (freeing two
  stack slots at once), but AMD doesn't document that instruction.

  This is CVE-2013-2076 / XSA-52.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Tested-by: Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
  master commit: 8dcf9f0113454f233089e8e5bb3970d891928410
  master date: 2013-06-04 09:26:54 +0200
  16b0db2eeef6491fee4277b030c84678b1579863:x86/xsave: fix information leak on AMD CPUs

  Just like for FXSAVE/FXRSTOR, XSAVE/XRSTOR also don't save/restore the
  last instruction and operand pointers as well as the last opcode if
  there's no pending unmasked exception (see CVE-2006-1056 and commit
  9747:4d667a139318).

  While the FXSR solution sits in the save path, I prefer to have this in
  the restore path because there the handling is simpler (namely in the
  context of the pending changes to properly save the selector values for
  32-bit guest code).

  Also this is using FFREE instead of EMMS, as it doesn't seem unlikely
  that in the future we may see CPUs with x87 and SSE/AVX but no MMX
  support. The goal here anyway is just to avoid an FPU stack overflow.
  I would have preferred to use FFREEP instead of FFREE (freeing two
  stack slots at once), but AMD doesn't document that instruction.

  This is CVE-2013-2076 / XSA-52.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Tested-by: Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
  master commit: 8dcf9f0113454f233089e8e5bb3970d891928410
  master date: 2013-06-04 09:26:54 +0200
  8dcf9f0113454f233089e8e5bb3970d891928410:x86/xsave: fix information leak on AMD CPUs

  Just like for FXSAVE/FXRSTOR, XSAVE/XRSTOR also don't save/restore the
  last instruction and operand pointers as well as the last opcode if
  there's no pending unmasked exception (see CVE-2006-1056 and commit
  9747:4d667a139318).

  While the FXSR solution sits in the save path, I prefer to have this in
  the restore path because there the handling is simpler (namely in the
  context of the pending changes to properly save the selector values for
  32-bit guest code).

  Also this is using FFREE instead of EMMS, as it doesn't seem unlikely
  that in the future we may see CPUs with x87 and SSE/AVX but no MMX
  support. The goal here anyway is just to avoid an FPU stack overflow.
  I would have preferred to use FFREEP instead of FFREE (freeing two
  stack slots at once), but AMD doesn't document that instruction.

  This is CVE-2013-2076 / XSA-52.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Tested-by: Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c3401c1aece47dc5388184c9b6a3527655d5bbdf
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 16b0db2eeef6491fee4277b030c84678b1579863
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8dcf9f0113454f233089e8e5bb3970d891928410
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/16b0db2eeef6491fee4277b030c84678b1579863
    reference_type: commit
    reference_id: 16b0db2eeef6491fee4277b030c84678b1579863
  - url: https://github.com/xen-project/xen/tree/8dcf9f0113454f233089e8e5bb3970d891928410
    reference_type: commit
    reference_id: 8dcf9f0113454f233089e8e5bb3970d891928410
  - url: https://github.com/xen-project/xen/tree/c3401c1aece47dc5388184c9b6a3527655d5bbdf
    reference_type: commit
    reference_id: c3401c1aece47dc5388184c9b6a3527655d5bbdf
