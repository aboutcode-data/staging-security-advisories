advisory_id: CVE-2016-7093
datasource_id: collect_xen_project_fix_commits/CVE-2016-7093
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  bc9f72bb933aac7cd51419b1f5482094a1325518:x86/emulate: Correct boundary interactions of emulated instructions

  This reverts most of c/s 0640ffb6 "x86emul: fix rIP handling".

  Experimentally, in long mode processors will execute an instruction stream
  which crosses the 64bit -1 -> 0 virtual boundary, whether the instruction
  boundary is aligned on the virtual boundary, or is misaligned.

  In compatibility mode, Intel processors will execute an instruction stream
  which crosses the 32bit -1 -> 0 virtual boundary, while AMD processors raise a
  segmentation fault.  Xen's segmentation behaviour matches AMD.

  For 16bit code, hardware does not ever truncated %ip.  %eip is always used and
  behaves normally as a 32bit register, including in 16bit protected mode
  segments, as well as in Real and Unreal mode.

  This is XSA-186 / CVE-2016-7093.

  Reported-by: Brian Marcotte <marcotte@panix.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  master commit: e9575f980df81aeb0e5b6139f485fd6f7bb7f5b6
  master date: 2016-09-08 14:15:53 +0200
  be8c32a59e1bcd42f9c2e932ca194f2219a6ae25:x86/emulate: Correct boundary interactions of emulated instructions

  This reverts most of c/s 0640ffb6 "x86emul: fix rIP handling".

  Experimentally, in long mode processors will execute an instruction stream
  which crosses the 64bit -1 -> 0 virtual boundary, whether the instruction
  boundary is aligned on the virtual boundary, or is misaligned.

  In compatibility mode, Intel processors will execute an instruction stream
  which crosses the 32bit -1 -> 0 virtual boundary, while AMD processors raise a
  segmentation fault.  Xen's segmentation behaviour matches AMD.

  For 16bit code, hardware does not ever truncated %ip.  %eip is always used and
  behaves normally as a 32bit register, including in 16bit protected mode
  segments, as well as in Real and Unreal mode.

  This is XSA-186 / CVE-2016-7093.

  Reported-by: Brian Marcotte <marcotte@panix.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  master commit: e9575f980df81aeb0e5b6139f485fd6f7bb7f5b6
  master date: 2016-09-08 14:15:53 +0200
  cb3397acff56d0cd69c27f1ca2282657b7811a90:x86/emulate: Correct boundary interactions of emulated instructions

  This reverts most of c/s 0640ffb6 "x86emul: fix rIP handling".

  Experimentally, in long mode processors will execute an instruction stream
  which crosses the 64bit -1 -> 0 virtual boundary, whether the instruction
  boundary is aligned on the virtual boundary, or is misaligned.

  In compatibility mode, Intel processors will execute an instruction stream
  which crosses the 32bit -1 -> 0 virtual boundary, while AMD processors raise a
  segmentation fault.  Xen's segmentation behaviour matches AMD.

  For 16bit code, hardware does not ever truncated %ip.  %eip is always used and
  behaves normally as a 32bit register, including in 16bit protected mode
  segments, as well as in Real and Unreal mode.

  This is XSA-186 / CVE-2016-7093.

  Reported-by: Brian Marcotte <marcotte@panix.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  master commit: e9575f980df81aeb0e5b6139f485fd6f7bb7f5b6
  master date: 2016-09-08 14:15:53 +0200
  e9575f980df81aeb0e5b6139f485fd6f7bb7f5b6:x86/emulate: Correct boundary interactions of emulated instructions

  This reverts most of c/s 0640ffb6 "x86emul: fix rIP handling".

  Experimentally, in long mode processors will execute an instruction stream
  which crosses the 64bit -1 -> 0 virtual boundary, whether the instruction
  boundary is aligned on the virtual boundary, or is misaligned.

  In compatibility mode, Intel processors will execute an instruction stream
  which crosses the 32bit -1 -> 0 virtual boundary, while AMD processors raise a
  segmentation fault.  Xen's segmentation behaviour matches AMD.

  For 16bit code, hardware does not ever truncated %ip.  %eip is always used and
  behaves normally as a 32bit register, including in 16bit protected mode
  segments, as well as in Real and Unreal mode.

  This is XSA-186 / CVE-2016-7093.

  Reported-by: Brian Marcotte <marcotte@panix.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e9575f980df81aeb0e5b6139f485fd6f7bb7f5b6
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: be8c32a59e1bcd42f9c2e932ca194f2219a6ae25
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: bc9f72bb933aac7cd51419b1f5482094a1325518
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: cb3397acff56d0cd69c27f1ca2282657b7811a90
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/bc9f72bb933aac7cd51419b1f5482094a1325518
    reference_type: commit
    reference_id: bc9f72bb933aac7cd51419b1f5482094a1325518
  - url: https://github.com/xen-project/xen/tree/be8c32a59e1bcd42f9c2e932ca194f2219a6ae25
    reference_type: commit
    reference_id: be8c32a59e1bcd42f9c2e932ca194f2219a6ae25
  - url: https://github.com/xen-project/xen/tree/cb3397acff56d0cd69c27f1ca2282657b7811a90
    reference_type: commit
    reference_id: cb3397acff56d0cd69c27f1ca2282657b7811a90
  - url: https://github.com/xen-project/xen/tree/e9575f980df81aeb0e5b6139f485fd6f7bb7f5b6
    reference_type: commit
    reference_id: e9575f980df81aeb0e5b6139f485fd6f7bb7f5b6
