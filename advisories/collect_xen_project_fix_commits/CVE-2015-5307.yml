advisory_id: CVE-2015-5307
datasource_id: collect_xen_project_fix_commits/CVE-2015-5307
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  fd1e4cc4d1d100337931b6f6dc50ed0b9766968a:x86/HVM: always intercept #AC and #DB

  Both being benign exceptions, and both being possible to get triggered
  by exception delivery, this is required to prevent a guest from locking
  up a CPU (resulting from no other VM exits occurring once getting into
  such a loop).

  The specific scenarios:

  1) #AC may be raised during exception delivery if the handler is set to
  be a ring-3 one by a 32-bit guest, and the stack is misaligned.

  This is CVE-2015-5307 / XSA-156.

  Reported-by: Benjamin Serebrin <serebrin@google.com>

  2) #DB may be raised during exception delivery when a breakpoint got
  placed on a data structure involved in delivering the exception. This
  can result in an endless loop when a 64-bit guest uses a non-zero IST
  for the vector 1 IDT entry, but even without use of IST the time it
  takes until a contributory fault would get raised (results depending
  on the handler) may be quite long.

  This is CVE-2015-8104 / XSA-156.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Tested-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: bd2239d9fa975a1ee5bcd27c218ae042cd0a57bc
  master date: 2015-11-10 12:03:08 +0100
  26b09fa24faff16b3795b3d47088b17727a4e670:x86/HVM: always intercept #AC and #DB

  Both being benign exceptions, and both being possible to get triggered
  by exception delivery, this is required to prevent a guest from locking
  up a CPU (resulting from no other VM exits occurring once getting into
  such a loop).

  The specific scenarios:

  1) #AC may be raised during exception delivery if the handler is set to
  be a ring-3 one by a 32-bit guest, and the stack is misaligned.

  This is CVE-2015-5307 / XSA-156.

  Reported-by: Benjamin Serebrin <serebrin@google.com>

  2) #DB may be raised during exception delivery when a breakpoint got
  placed on a data structure involved in delivering the exception. This
  can result in an endless loop when a 64-bit guest uses a non-zero IST
  for the vector 1 IDT entry, but even without use of IST the time it
  takes until a contributory fault would get raised (results depending
  on the handler) may be quite long.

  This is CVE-2015-8104 / XSA-156.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Tested-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: bd2239d9fa975a1ee5bcd27c218ae042cd0a57bc
  master date: 2015-11-10 12:03:08 +0100
  6d8233dc06f75150ab6f7a3a4df1fd815d148b4d:x86/HVM: always intercept #AC and #DB

  Both being benign exceptions, and both being possible to get triggered
  by exception delivery, this is required to prevent a guest from locking
  up a CPU (resulting from no other VM exits occurring once getting into
  such a loop).

  The specific scenarios:

  1) #AC may be raised during exception delivery if the handler is set to
  be a ring-3 one by a 32-bit guest, and the stack is misaligned.

  This is CVE-2015-5307 / XSA-156.

  Reported-by: Benjamin Serebrin <serebrin@google.com>

  2) #DB may be raised during exception delivery when a breakpoint got
  placed on a data structure involved in delivering the exception. This
  can result in an endless loop when a 64-bit guest uses a non-zero IST
  for the vector 1 IDT entry, but even without use of IST the time it
  takes until a contributory fault would get raised (results depending
  on the handler) may be quite long.

  This is CVE-2015-8104 / XSA-156.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Tested-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: bd2239d9fa975a1ee5bcd27c218ae042cd0a57bc
  master date: 2015-11-10 12:03:08 +0100
  e3b0c81ba143939282d99d7cdc041f95bae9c917:x86/HVM: always intercept #AC and #DB

  Both being benign exceptions, and both being possible to get triggered
  by exception delivery, this is required to prevent a guest from locking
  up a CPU (resulting from no other VM exits occurring once getting into
  such a loop).

  The specific scenarios:

  1) #AC may be raised during exception delivery if the handler is set to
  be a ring-3 one by a 32-bit guest, and the stack is misaligned.

  This is CVE-2015-5307 / XSA-156.

  Reported-by: Benjamin Serebrin <serebrin@google.com>

  2) #DB may be raised during exception delivery when a breakpoint got
  placed on a data structure involved in delivering the exception. This
  can result in an endless loop when a 64-bit guest uses a non-zero IST
  for the vector 1 IDT entry, but even without use of IST the time it
  takes until a contributory fault would get raised (results depending
  on the handler) may be quite long.

  This is CVE-2015-8104 / XSA-156.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Tested-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: bd2239d9fa975a1ee5bcd27c218ae042cd0a57bc
  master date: 2015-11-10 12:03:08 +0100
  bd2239d9fa975a1ee5bcd27c218ae042cd0a57bc:x86/HVM: always intercept #AC and #DB

  Both being benign exceptions, and both being possible to get triggered
  by exception delivery, this is required to prevent a guest from locking
  up a CPU (resulting from no other VM exits occurring once getting into
  such a loop).

  The specific scenarios:

  1) #AC may be raised during exception delivery if the handler is set to
  be a ring-3 one by a 32-bit guest, and the stack is misaligned.

  This is CVE-2015-5307 / XSA-156.

  Reported-by: Benjamin Serebrin <serebrin@google.com>

  2) #DB may be raised during exception delivery when a breakpoint got
  placed on a data structure involved in delivering the exception. This
  can result in an endless loop when a 64-bit guest uses a non-zero IST
  for the vector 1 IDT entry, but even without use of IST the time it
  takes until a contributory fault would get raised (results depending
  on the handler) may be quite long.

  This is CVE-2015-8104 / XSA-156.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Tested-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: bd2239d9fa975a1ee5bcd27c218ae042cd0a57bc
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e3b0c81ba143939282d99d7cdc041f95bae9c917
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 6d8233dc06f75150ab6f7a3a4df1fd815d148b4d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 26b09fa24faff16b3795b3d47088b17727a4e670
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: fd1e4cc4d1d100337931b6f6dc50ed0b9766968a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/26b09fa24faff16b3795b3d47088b17727a4e670
    reference_type: commit
    reference_id: 26b09fa24faff16b3795b3d47088b17727a4e670
  - url: https://github.com/xen-project/xen/tree/6d8233dc06f75150ab6f7a3a4df1fd815d148b4d
    reference_type: commit
    reference_id: 6d8233dc06f75150ab6f7a3a4df1fd815d148b4d
  - url: https://github.com/xen-project/xen/tree/bd2239d9fa975a1ee5bcd27c218ae042cd0a57bc
    reference_type: commit
    reference_id: bd2239d9fa975a1ee5bcd27c218ae042cd0a57bc
  - url: https://github.com/xen-project/xen/tree/e3b0c81ba143939282d99d7cdc041f95bae9c917
    reference_type: commit
    reference_id: e3b0c81ba143939282d99d7cdc041f95bae9c917
  - url: https://github.com/xen-project/xen/tree/fd1e4cc4d1d100337931b6f6dc50ed0b9766968a
    reference_type: commit
    reference_id: fd1e4cc4d1d100337931b6f6dc50ed0b9766968a
