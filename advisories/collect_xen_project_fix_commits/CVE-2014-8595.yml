advisory_id: CVE-2014-8595
datasource_id: collect_xen_project_fix_commits/CVE-2014-8595
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  301bd3e8c53f2478da537a223386e153d046a063:x86emul: enforce privilege level restrictions when loading CS

  Privilege level checks were basically missing for the CS case, the
  only check that was done (RPL == DPL for nonconforming segments)
  was solely covering a single special case (return to non-conforming
  segment).

  Additionally in long mode the L bit set requires the D bit to be clear,
  as was recently pointed out for KVM by Nadav Amit
  <namit@cs.technion.ac.il>.

  Finally we also need to force the loaded selector's RPL to CPL (at
  least as long as lret/retf emulation doesn't support privilege level
  changes).

  This is CVE-2014-8595 / XSA-110.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  82fa0623454a52c7d1812a9419c4cc09567d243d:x86emul: enforce privilege level restrictions when loading CS

  Privilege level checks were basically missing for the CS case, the
  only check that was done (RPL == DPL for nonconforming segments)
  was solely covering a single special case (return to non-conforming
  segment).

  Additionally in long mode the L bit set requires the D bit to be clear,
  as was recently pointed out for KVM by Nadav Amit
  <namit@cs.technion.ac.il>.

  Finally we also need to force the loaded selector's RPL to CPL (at
  least as long as lret/retf emulation doesn't support privilege level
  changes).

  This is CVE-2014-8595 / XSA-110.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: 1d68c1a70e00ed95ef0889cfa005379dab27b37d
  master date: 2014-11-18 14:16:23 +0100
  d279f6e1344871d71e379cc06c7baa6d4f9f0b29:x86emul: enforce privilege level restrictions when loading CS

  Privilege level checks were basically missing for the CS case, the
  only check that was done (RPL == DPL for nonconforming segments)
  was solely covering a single special case (return to non-conforming
  segment).

  Additionally in long mode the L bit set requires the D bit to be clear,
  as was recently pointed out for KVM by Nadav Amit
  <namit@cs.technion.ac.il>.

  Finally we also need to force the loaded selector's RPL to CPL (at
  least as long as lret/retf emulation doesn't support privilege level
  changes).

  This is CVE-2014-8595 / XSA-110.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: 1d68c1a70e00ed95ef0889cfa005379dab27b37d
  master date: 2014-11-18 14:16:23 +0100
  1d68c1a70e00ed95ef0889cfa005379dab27b37d:x86emul: enforce privilege level restrictions when loading CS

  Privilege level checks were basically missing for the CS case, the
  only check that was done (RPL == DPL for nonconforming segments)
  was solely covering a single special case (return to non-conforming
  segment).

  Additionally in long mode the L bit set requires the D bit to be clear,
  as was recently pointed out for KVM by Nadav Amit
  <namit@cs.technion.ac.il>.

  Finally we also need to force the loaded selector's RPL to CPL (at
  least as long as lret/retf emulation doesn't support privilege level
  changes).

  This is CVE-2014-8595 / XSA-110.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 301bd3e8c53f2478da537a223386e153d046a063
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d279f6e1344871d71e379cc06c7baa6d4f9f0b29
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 82fa0623454a52c7d1812a9419c4cc09567d243d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1d68c1a70e00ed95ef0889cfa005379dab27b37d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/1d68c1a70e00ed95ef0889cfa005379dab27b37d
    reference_type: commit
    reference_id: 1d68c1a70e00ed95ef0889cfa005379dab27b37d
  - url: https://github.com/xen-project/xen/tree/301bd3e8c53f2478da537a223386e153d046a063
    reference_type: commit
    reference_id: 301bd3e8c53f2478da537a223386e153d046a063
  - url: https://github.com/xen-project/xen/tree/82fa0623454a52c7d1812a9419c4cc09567d243d
    reference_type: commit
    reference_id: 82fa0623454a52c7d1812a9419c4cc09567d243d
  - url: https://github.com/xen-project/xen/tree/d279f6e1344871d71e379cc06c7baa6d4f9f0b29
    reference_type: commit
    reference_id: d279f6e1344871d71e379cc06c7baa6d4f9f0b29
