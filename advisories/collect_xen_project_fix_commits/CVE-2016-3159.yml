advisory_id: CVE-2016-3159
datasource_id: collect_xen_project_fix_commits/CVE-2016-3159
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  c2f8ab34391e1a25e6cf30783aec5d18a7706765:x86: fix information leak on AMD CPUs

  The fix for XSA-52 was wrong, and so was the change synchronizing that
  new behavior to the FXRSTOR logic: AMD's manuals explictly state that
  writes to the ES bit are ignored, and it instead gets calculated from
  the exception and mask bits (it gets set whenever there is an unmasked
  exception, and cleared otherwise). Hence we need to follow that model
  in our workaround.

  This is CVE-2016-3158 / CVE-2016-3159 / XSA-172.
  [xen/arch/x86/xstate.c:xrstor: CVE-2016-3158]
  [xen/arch/x86/i387.c:fpu_fxrstor: CVE-2016-3159]

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 7bd9dc3adfbb014c55f0928ebb3b20950ca9c019
  master date: 2016-03-29 14:24:26 +0200
  c2f8ab34391e1a25e6cf30783aec5d18a7706765:x86: fix information leak on AMD CPUs

  The fix for XSA-52 was wrong, and so was the change synchronizing that
  new behavior to the FXRSTOR logic: AMD's manuals explictly state that
  writes to the ES bit are ignored, and it instead gets calculated from
  the exception and mask bits (it gets set whenever there is an unmasked
  exception, and cleared otherwise). Hence we need to follow that model
  in our workaround.

  This is CVE-2016-3158 / CVE-2016-3159 / XSA-172.
  [xen/arch/x86/xstate.c:xrstor: CVE-2016-3158]
  [xen/arch/x86/i387.c:fpu_fxrstor: CVE-2016-3159]

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 7bd9dc3adfbb014c55f0928ebb3b20950ca9c019
  master date: 2016-03-29 14:24:26 +0200
  1f92bdba97cd82726279c37fc604a2e1b854278a:x86: fix information leak on AMD CPUs

  The fix for XSA-52 was wrong, and so was the change synchronizing that
  new behavior to the FXRSTOR logic: AMD's manuals explictly state that
  writes to the ES bit are ignored, and it instead gets calculated from
  the exception and mask bits (it gets set whenever there is an unmasked
  exception, and cleared otherwise). Hence we need to follow that model
  in our workaround.

  This is CVE-2016-3158 / CVE-2016-3159 / XSA-172.
  [xen/arch/x86/xstate.c:xrstor: CVE-2016-3158]
  [xen/arch/x86/i387.c:fpu_fxrstor: CVE-2016-3159]

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 7bd9dc3adfbb014c55f0928ebb3b20950ca9c019
  master date: 2016-03-29 14:24:26 +0200
  1f92bdba97cd82726279c37fc604a2e1b854278a:x86: fix information leak on AMD CPUs

  The fix for XSA-52 was wrong, and so was the change synchronizing that
  new behavior to the FXRSTOR logic: AMD's manuals explictly state that
  writes to the ES bit are ignored, and it instead gets calculated from
  the exception and mask bits (it gets set whenever there is an unmasked
  exception, and cleared otherwise). Hence we need to follow that model
  in our workaround.

  This is CVE-2016-3158 / CVE-2016-3159 / XSA-172.
  [xen/arch/x86/xstate.c:xrstor: CVE-2016-3158]
  [xen/arch/x86/i387.c:fpu_fxrstor: CVE-2016-3159]

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 7bd9dc3adfbb014c55f0928ebb3b20950ca9c019
  master date: 2016-03-29 14:24:26 +0200
  5df279da341491dbe9966eb8716c015b71d16a8d:x86: fix information leak on AMD CPUs

  The fix for XSA-52 was wrong, and so was the change synchronizing that
  new behavior to the FXRSTOR logic: AMD's manuals explictly state that
  writes to the ES bit are ignored, and it instead gets calculated from
  the exception and mask bits (it gets set whenever there is an unmasked
  exception, and cleared otherwise). Hence we need to follow that model
  in our workaround.

  This is CVE-2016-3158 / CVE-2016-3159 / XSA-172.
  [xen/arch/x86/xstate.c:xrstor: CVE-2016-3158]
  [xen/arch/x86/i387.c:fpu_fxrstor: CVE-2016-3159]

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 7bd9dc3adfbb014c55f0928ebb3b20950ca9c019
  master date: 2016-03-29 14:24:26 +0200
  5df279da341491dbe9966eb8716c015b71d16a8d:x86: fix information leak on AMD CPUs

  The fix for XSA-52 was wrong, and so was the change synchronizing that
  new behavior to the FXRSTOR logic: AMD's manuals explictly state that
  writes to the ES bit are ignored, and it instead gets calculated from
  the exception and mask bits (it gets set whenever there is an unmasked
  exception, and cleared otherwise). Hence we need to follow that model
  in our workaround.

  This is CVE-2016-3158 / CVE-2016-3159 / XSA-172.
  [xen/arch/x86/xstate.c:xrstor: CVE-2016-3158]
  [xen/arch/x86/i387.c:fpu_fxrstor: CVE-2016-3159]

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 7bd9dc3adfbb014c55f0928ebb3b20950ca9c019
  master date: 2016-03-29 14:24:26 +0200
  7bd9dc3adfbb014c55f0928ebb3b20950ca9c019:x86: fix information leak on AMD CPUs

  The fix for XSA-52 was wrong, and so was the change synchronizing that
  new behavior to the FXRSTOR logic: AMD's manuals explictly state that
  writes to the ES bit are ignored, and it instead gets calculated from
  the exception and mask bits (it gets set whenever there is an unmasked
  exception, and cleared otherwise). Hence we need to follow that model
  in our workaround.

  This is CVE-2016-3158 / CVE-2016-3159 / XSA-172.
  [xen/arch/x86/xstate.c:xrstor: CVE-2016-3158]
  [xen/arch/x86/i387.c:fpu_fxrstor: CVE-2016-3159]

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  7bd9dc3adfbb014c55f0928ebb3b20950ca9c019:x86: fix information leak on AMD CPUs

  The fix for XSA-52 was wrong, and so was the change synchronizing that
  new behavior to the FXRSTOR logic: AMD's manuals explictly state that
  writes to the ES bit are ignored, and it instead gets calculated from
  the exception and mask bits (it gets set whenever there is an unmasked
  exception, and cleared otherwise). Hence we need to follow that model
  in our workaround.

  This is CVE-2016-3158 / CVE-2016-3159 / XSA-172.
  [xen/arch/x86/xstate.c:xrstor: CVE-2016-3158]
  [xen/arch/x86/i387.c:fpu_fxrstor: CVE-2016-3159]

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1f92bdba97cd82726279c37fc604a2e1b854278a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5df279da341491dbe9966eb8716c015b71d16a8d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c2f8ab34391e1a25e6cf30783aec5d18a7706765
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7bd9dc3adfbb014c55f0928ebb3b20950ca9c019
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/1f92bdba97cd82726279c37fc604a2e1b854278a
    reference_type: commit
    reference_id: 1f92bdba97cd82726279c37fc604a2e1b854278a
  - url: https://github.com/xen-project/xen/tree/5df279da341491dbe9966eb8716c015b71d16a8d
    reference_type: commit
    reference_id: 5df279da341491dbe9966eb8716c015b71d16a8d
  - url: https://github.com/xen-project/xen/tree/7bd9dc3adfbb014c55f0928ebb3b20950ca9c019
    reference_type: commit
    reference_id: 7bd9dc3adfbb014c55f0928ebb3b20950ca9c019
  - url: https://github.com/xen-project/xen/tree/c2f8ab34391e1a25e6cf30783aec5d18a7706765
    reference_type: commit
    reference_id: c2f8ab34391e1a25e6cf30783aec5d18a7706765
