advisory_id: CVE-2012-4537
datasource_id: collect_xen_project_fix_commits/CVE-2012-4537
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  e7dc3458699a97d8bdac6be9bde94751ef12bb3f:x86/physmap: Prevent incorrect updates of m2p mappings

  In certain conditions, such as low memory, set_p2m_entry() can fail.
  Currently, the p2m and m2p tables will get out of sync because we still
  update the m2p table after the p2m update has failed.

  If that happens, subsequent guest-invoked memory operations can cause
  BUG()s and ASSERT()s to kill Xen.

  This is fixed by only updating the m2p table iff the p2m was
  successfully updated.

  This is a security problem, XSA-22 / CVE-2012-4537.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  9070a6ef041756341286e88e7fad7de3e01c66f9:x86/physmap: Prevent incorrect updates of m2p mappings

  In certain conditions, such as low memory, set_p2m_entry() can fail.
  Currently, the p2m and m2p tables will get out of sync because we still
  update the m2p table after the p2m update has failed.

  If that happens, subsequent guest-invoked memory operations can cause
  BUG()s and ASSERT()s to kill Xen.

  This is fixed by only updating the m2p table iff the p2m was
  successfully updated.

  This is a security problem, XSA-22 / CVE-2012-4537.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  c870348ef5895bca245cf4fc9c1c3f452ccf9fa1:x86/physmap: Prevent incorrect updates of m2p mappings

  In certain conditions, such as low memory, set_p2m_entry() can fail.
  Currently, the p2m and m2p tables will get out of sync because we still
  update the m2p table after the p2m update has failed.

  If that happens, subsequent guest-invoked memory operations can cause
  BUG()s and ASSERT()s to kill Xen.

  This is fixed by only updating the m2p table iff the p2m was
  successfully updated.

  This is a security problem, XSA-22 / CVE-2012-4537.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>

  xen-unstable changeset: 26149:6b6a4007a609
  Backport-requested-by: security@xen.org
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  ef3cea268fdff77f93368369c5998b1c975aa297:x86/physmap: Prevent incorrect updates of m2p mappings

  In certain conditions, such as low memory, set_p2m_entry() can fail.
  Currently, the p2m and m2p tables will get out of sync because we still
  update the m2p table after the p2m update has failed.

  If that happens, subsequent guest-invoked memory operations can cause
  BUG()s and ASSERT()s to kill Xen.

  This is fixed by only updating the m2p table iff the p2m was
  successfully updated.

  This is a security problem, XSA-22 / CVE-2012-4537.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9070a6ef041756341286e88e7fad7de3e01c66f9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e7dc3458699a97d8bdac6be9bde94751ef12bb3f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ef3cea268fdff77f93368369c5998b1c975aa297
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c870348ef5895bca245cf4fc9c1c3f452ccf9fa1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/9070a6ef041756341286e88e7fad7de3e01c66f9
    reference_type: commit
    reference_id: 9070a6ef041756341286e88e7fad7de3e01c66f9
  - url: https://github.com/xen-project/xen/tree/c870348ef5895bca245cf4fc9c1c3f452ccf9fa1
    reference_type: commit
    reference_id: c870348ef5895bca245cf4fc9c1c3f452ccf9fa1
  - url: https://github.com/xen-project/xen/tree/e7dc3458699a97d8bdac6be9bde94751ef12bb3f
    reference_type: commit
    reference_id: e7dc3458699a97d8bdac6be9bde94751ef12bb3f
  - url: https://github.com/xen-project/xen/tree/ef3cea268fdff77f93368369c5998b1c975aa297
    reference_type: commit
    reference_id: ef3cea268fdff77f93368369c5998b1c975aa297
