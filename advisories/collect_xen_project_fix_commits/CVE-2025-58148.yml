advisory_id: CVE-2025-58148
datasource_id: collect_xen_project_fix_commits/CVE-2025-58148
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  464e9f4a40c2d72cb88ada20ada3f84b6bd9ee5f:x86/viridian: Enforce bounds check in send_ipi()

  Callers can pass in a vpmask which exceeds d->max_vcpus.  Prevent out-of-bound
  reads of d->vcpu[].

  This is XSA-475 / CVE-2025-58148.

  Fixes: 728acba1ba4a ("viridian: use hypercall_vpmask in hvcall_ipi()")
  Signed-off-by: Teddy Astie <teddy.astie@vates.tech>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: cc64c245023c3ff8e388c1c96aed3faed6fd00cb
  master date: 2025-10-21 14:10:13 +0200
  91434069502a3c62a8568dffbe59835eb159e23c:x86/viridian: Enforce bounds check in send_ipi()

  Callers can pass in a vpmask which exceeds d->max_vcpus.  Prevent out-of-bound
  reads of d->vcpu[].

  This is XSA-475 / CVE-2025-58148.

  Fixes: 728acba1ba4a ("viridian: use hypercall_vpmask in hvcall_ipi()")
  Signed-off-by: Teddy Astie <teddy.astie@vates.tech>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: cc64c245023c3ff8e388c1c96aed3faed6fd00cb
  master date: 2025-10-21 14:10:13 +0200
  5177ae067243dad9d1146f39f7a73b3ec4abb75c:x86/viridian: Enforce bounds check in send_ipi()

  Callers can pass in a vpmask which exceeds d->max_vcpus.  Prevent out-of-bound
  reads of d->vcpu[].

  This is XSA-475 / CVE-2025-58148.

  Fixes: 728acba1ba4a ("viridian: use hypercall_vpmask in hvcall_ipi()")
  Signed-off-by: Teddy Astie <teddy.astie@vates.tech>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: cc64c245023c3ff8e388c1c96aed3faed6fd00cb
  master date: 2025-10-21 14:10:13 +0200
  d8d23d168823c7ff8e9afa09bceb916c809f525c:x86/viridian: Enforce bounds check in send_ipi()

  Callers can pass in a vpmask which exceeds d->max_vcpus.  Prevent out-of-bound
  reads of d->vcpu[].

  This is XSA-475 / CVE-2025-58148.

  Fixes: 728acba1ba4a ("viridian: use hypercall_vpmask in hvcall_ipi()")
  Signed-off-by: Teddy Astie <teddy.astie@vates.tech>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: cc64c245023c3ff8e388c1c96aed3faed6fd00cb
  master date: 2025-10-21 14:10:13 +0200
  cc64c245023c3ff8e388c1c96aed3faed6fd00cb:x86/viridian: Enforce bounds check in send_ipi()

  Callers can pass in a vpmask which exceeds d->max_vcpus.  Prevent out-of-bound
  reads of d->vcpu[].

  This is XSA-475 / CVE-2025-58148.

  Fixes: 728acba1ba4a ("viridian: use hypercall_vpmask in hvcall_ipi()")
  Signed-off-by: Teddy Astie <teddy.astie@vates.tech>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 91434069502a3c62a8568dffbe59835eb159e23c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5177ae067243dad9d1146f39f7a73b3ec4abb75c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: cc64c245023c3ff8e388c1c96aed3faed6fd00cb
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 464e9f4a40c2d72cb88ada20ada3f84b6bd9ee5f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d8d23d168823c7ff8e9afa09bceb916c809f525c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/464e9f4a40c2d72cb88ada20ada3f84b6bd9ee5f
    reference_type: commit
    reference_id: 464e9f4a40c2d72cb88ada20ada3f84b6bd9ee5f
  - url: https://github.com/xen-project/xen/tree/5177ae067243dad9d1146f39f7a73b3ec4abb75c
    reference_type: commit
    reference_id: 5177ae067243dad9d1146f39f7a73b3ec4abb75c
  - url: https://github.com/xen-project/xen/tree/91434069502a3c62a8568dffbe59835eb159e23c
    reference_type: commit
    reference_id: 91434069502a3c62a8568dffbe59835eb159e23c
  - url: https://github.com/xen-project/xen/tree/cc64c245023c3ff8e388c1c96aed3faed6fd00cb
    reference_type: commit
    reference_id: cc64c245023c3ff8e388c1c96aed3faed6fd00cb
  - url: https://github.com/xen-project/xen/tree/d8d23d168823c7ff8e9afa09bceb916c809f525c
    reference_type: commit
    reference_id: d8d23d168823c7ff8e9afa09bceb916c809f525c
