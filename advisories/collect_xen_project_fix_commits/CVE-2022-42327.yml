advisory_id: CVE-2022-42327
datasource_id: collect_xen_project_fix_commits/CVE-2022-42327
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  62e7fb702db4adaa9415ac87d95e0f461e32d9ca:x86/vmx: Revert "VMX: use a single, global APIC access page"

  The claim "No accesses would ever go to this page." is false.  A consequence
  of how Intel's APIC Acceleration works, and Xen's choice to have per-domain
  P2Ms (rather than per-vCPU P2Ms) means that the APIC page is fully read-write
  to any vCPU which is not in xAPIC mode.

  This reverts commit 58850b9074d3e7affdf3bc94c84e417ecfa4d165.

  This is XSA-412 / CVE-2022-42327.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3b5beaf49033cddf4b2cc4e4d391b966f4203471)
  3b5beaf49033cddf4b2cc4e4d391b966f4203471:x86/vmx: Revert "VMX: use a single, global APIC access page"

  The claim "No accesses would ever go to this page." is false.  A consequence
  of how Intel's APIC Acceleration works, and Xen's choice to have per-domain
  P2Ms (rather than per-vCPU P2Ms) means that the APIC page is fully read-write
  to any vCPU which is not in xAPIC mode.

  This reverts commit 58850b9074d3e7affdf3bc94c84e417ecfa4d165.

  This is XSA-412 / CVE-2022-42327.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3b5beaf49033cddf4b2cc4e4d391b966f4203471
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 62e7fb702db4adaa9415ac87d95e0f461e32d9ca
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/3b5beaf49033cddf4b2cc4e4d391b966f4203471
    reference_type: commit
    reference_id: 3b5beaf49033cddf4b2cc4e4d391b966f4203471
  - url: https://github.com/xen-project/xen/tree/62e7fb702db4adaa9415ac87d95e0f461e32d9ca
    reference_type: commit
    reference_id: 62e7fb702db4adaa9415ac87d95e0f461e32d9ca
