advisory_id: CVE-2025-58149
datasource_id: collect_xen_project_fix_commits/CVE-2025-58149
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  14b0ce576874031d17959cf1df65917d6e838523:tools/libs/light: fix BAR memory address truncation

  64-bit BAR memory address is truncated when removing a passthrough
  pci device from guest since it uses "unsigned int".

  So, change to use 64-bit type to fix this problem.

  This is XSA-476 / CVE-2025-58149.

  Fixes: b0a1af61678b ("libxenlight: implement pci passthrough")
  Signed-off-by: Jiqian Chen <Jiqian.Chen@amd.com>
  Release-Acked-by: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Acked-by: Anthony PERARD <anthony.perard@vates.tech>
  (cherry picked from commit 421432b822184f990cd9ef157bbc2a24cfe96727)
  832ecbff8ec4cfbf39632a23b60db85dae4cfab9:tools/libs/light: fix BAR memory address truncation

  64-bit BAR memory address is truncated when removing a passthrough
  pci device from guest since it uses "unsigned int".

  So, change to use 64-bit type to fix this problem.

  This is XSA-476 / CVE-2025-58149.

  Fixes: b0a1af61678b ("libxenlight: implement pci passthrough")
  Signed-off-by: Jiqian Chen <Jiqian.Chen@amd.com>
  Release-Acked-by: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Acked-by: Anthony PERARD <anthony.perard@vates.tech>
  (cherry picked from commit 421432b822184f990cd9ef157bbc2a24cfe96727)
  20cda53ff1453d1029dc0ebdd1e873674c637d76:tools/libs/light: fix BAR memory address truncation

  64-bit BAR memory address is truncated when removing a passthrough
  pci device from guest since it uses "unsigned int".

  So, change to use 64-bit type to fix this problem.

  This is XSA-476 / CVE-2025-58149.

  Fixes: b0a1af61678b ("libxenlight: implement pci passthrough")
  Signed-off-by: Jiqian Chen <Jiqian.Chen@amd.com>
  Release-Acked-by: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Acked-by: Anthony PERARD <anthony.perard@vates.tech>
  (cherry picked from commit 421432b822184f990cd9ef157bbc2a24cfe96727)
  ff9de4517afc8a998f5d4d950418ecf0d18fa23c:tools/libs/light: fix BAR memory address truncation

  64-bit BAR memory address is truncated when removing a passthrough
  pci device from guest since it uses "unsigned int".

  So, change to use 64-bit type to fix this problem.

  This is XSA-476 / CVE-2025-58149.

  Fixes: b0a1af61678b ("libxenlight: implement pci passthrough")
  Signed-off-by: Jiqian Chen <Jiqian.Chen@amd.com>
  Release-Acked-by: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Acked-by: Anthony PERARD <anthony.perard@vates.tech>
  (cherry picked from commit 421432b822184f990cd9ef157bbc2a24cfe96727)
  421432b822184f990cd9ef157bbc2a24cfe96727:tools/libs/light: fix BAR memory address truncation

  64-bit BAR memory address is truncated when removing a passthrough
  pci device from guest since it uses "unsigned int".

  So, change to use 64-bit type to fix this problem.

  This is XSA-476 / CVE-2025-58149.

  Fixes: b0a1af61678b ("libxenlight: implement pci passthrough")
  Signed-off-by: Jiqian Chen <Jiqian.Chen@amd.com>
  Release-Acked-by: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Acked-by: Anthony PERARD <anthony.perard@vates.tech>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 832ecbff8ec4cfbf39632a23b60db85dae4cfab9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 421432b822184f990cd9ef157bbc2a24cfe96727
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ff9de4517afc8a998f5d4d950418ecf0d18fa23c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 20cda53ff1453d1029dc0ebdd1e873674c637d76
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 14b0ce576874031d17959cf1df65917d6e838523
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/14b0ce576874031d17959cf1df65917d6e838523
    reference_type: commit
    reference_id: 14b0ce576874031d17959cf1df65917d6e838523
  - url: https://github.com/xen-project/xen/tree/20cda53ff1453d1029dc0ebdd1e873674c637d76
    reference_type: commit
    reference_id: 20cda53ff1453d1029dc0ebdd1e873674c637d76
  - url: https://github.com/xen-project/xen/tree/421432b822184f990cd9ef157bbc2a24cfe96727
    reference_type: commit
    reference_id: 421432b822184f990cd9ef157bbc2a24cfe96727
  - url: https://github.com/xen-project/xen/tree/832ecbff8ec4cfbf39632a23b60db85dae4cfab9
    reference_type: commit
    reference_id: 832ecbff8ec4cfbf39632a23b60db85dae4cfab9
  - url: https://github.com/xen-project/xen/tree/ff9de4517afc8a998f5d4d950418ecf0d18fa23c
    reference_type: commit
    reference_id: ff9de4517afc8a998f5d4d950418ecf0d18fa23c
