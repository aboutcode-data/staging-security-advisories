advisory_id: CVE-2021-28708
datasource_id: collect_xen_project_fix_commits/CVE-2021-28708
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  1a2e8d6cccddf984fce09b7b8b1139d81cea421e:x86/PoD: handle intermediate page orders in p2m_pod_cache_add()

  p2m_pod_decrease_reservation() may pass pages to the function which
  aren't 4k, 2M, or 1G. Handle all intermediate orders as well, to avoid
  hitting the BUG() at the switch() statement's "default" case.

  This is CVE-2021-28708 / part of XSA-388.

  Fixes: 3c352011c0d3 ("x86/PoD: shorten certain operations on higher order ranges")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 8ec13f68e0b026863d23e7f44f252d06478bc809
  master date: 2021-11-22 12:27:30 +0000
  d3cfb4b3a680d3e2ddd36f18201d48441f36aea0:x86/PoD: handle intermediate page orders in p2m_pod_cache_add()

  p2m_pod_decrease_reservation() may pass pages to the function which
  aren't 4k, 2M, or 1G. Handle all intermediate orders as well, to avoid
  hitting the BUG() at the switch() statement's "default" case.

  This is CVE-2021-28708 / part of XSA-388.

  Fixes: 3c352011c0d3 ("x86/PoD: shorten certain operations on higher order ranges")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 8ec13f68e0b026863d23e7f44f252d06478bc809
  master date: 2021-11-22 12:27:30 +0000
  3ae94651cf0b08f86f1aba012f6bdd42c449c68b:x86/PoD: handle intermediate page orders in p2m_pod_cache_add()

  p2m_pod_decrease_reservation() may pass pages to the function which
  aren't 4k, 2M, or 1G. Handle all intermediate orders as well, to avoid
  hitting the BUG() at the switch() statement's "default" case.

  This is CVE-2021-28708 / part of XSA-388.

  Fixes: 3c352011c0d3 ("x86/PoD: shorten certain operations on higher order ranges")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 8ec13f68e0b026863d23e7f44f252d06478bc809
  master date: 2021-11-22 12:27:30 +0000
  4429ca0b29f481a2abfcc81990c5ac1f96276cb2:x86/PoD: handle intermediate page orders in p2m_pod_cache_add()

  p2m_pod_decrease_reservation() may pass pages to the function which
  aren't 4k, 2M, or 1G. Handle all intermediate orders as well, to avoid
  hitting the BUG() at the switch() statement's "default" case.

  This is CVE-2021-28708 / part of XSA-388.

  Fixes: 3c352011c0d3 ("x86/PoD: shorten certain operations on higher order ranges")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 8ec13f68e0b026863d23e7f44f252d06478bc809
  master date: 2021-11-22 12:27:30 +0000
  8ec13f68e0b026863d23e7f44f252d06478bc809:x86/PoD: handle intermediate page orders in p2m_pod_cache_add()

  p2m_pod_decrease_reservation() may pass pages to the function which
  aren't 4k, 2M, or 1G. Handle all intermediate orders as well, to avoid
  hitting the BUG() at the switch() statement's "default" case.

  This is CVE-2021-28708 / part of XSA-388.

  Fixes: 3c352011c0d3 ("x86/PoD: shorten certain operations on higher order ranges")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d3cfb4b3a680d3e2ddd36f18201d48441f36aea0
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3ae94651cf0b08f86f1aba012f6bdd42c449c68b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4429ca0b29f481a2abfcc81990c5ac1f96276cb2
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8ec13f68e0b026863d23e7f44f252d06478bc809
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1a2e8d6cccddf984fce09b7b8b1139d81cea421e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/1a2e8d6cccddf984fce09b7b8b1139d81cea421e
    reference_type: commit
    reference_id: 1a2e8d6cccddf984fce09b7b8b1139d81cea421e
  - url: https://github.com/xen-project/xen/tree/3ae94651cf0b08f86f1aba012f6bdd42c449c68b
    reference_type: commit
    reference_id: 3ae94651cf0b08f86f1aba012f6bdd42c449c68b
  - url: https://github.com/xen-project/xen/tree/4429ca0b29f481a2abfcc81990c5ac1f96276cb2
    reference_type: commit
    reference_id: 4429ca0b29f481a2abfcc81990c5ac1f96276cb2
  - url: https://github.com/xen-project/xen/tree/8ec13f68e0b026863d23e7f44f252d06478bc809
    reference_type: commit
    reference_id: 8ec13f68e0b026863d23e7f44f252d06478bc809
  - url: https://github.com/xen-project/xen/tree/d3cfb4b3a680d3e2ddd36f18201d48441f36aea0
    reference_type: commit
    reference_id: d3cfb4b3a680d3e2ddd36f18201d48441f36aea0
