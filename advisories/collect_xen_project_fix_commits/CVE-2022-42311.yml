advisory_id: CVE-2022-42311
datasource_id: collect_xen_project_fix_commits/CVE-2022-42311
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  cde36e0c369d0156e5f441635a2c45c0e28d926f:tools/xenstore: let unread watch events time out

  A future modification will limit the number of outstanding requests
  for a domain, where "outstanding" means that the response of the
  request or any resulting watch event hasn't been consumed yet.

  In order to avoid a malicious guest being capable to block other guests
  by not reading watch events, add a timeout for watch events. In case a
  watch event hasn't been consumed after this timeout, it is being
  deleted. Set the default timeout to 20 seconds (a random value being
  not too high).

  In order to support to specify other timeout values in future, use a
  generic command line option for that purpose:

  --timeout|-w watch-event=<seconds>

  This is part of XSA-326 / CVE-2022-42311.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 5285dcb1a5c01695c11e6397c95d906b5e765c98)
  36ed7fe5da0eb8554e94718fb6599795cdef21d0:tools/xenstore: let unread watch events time out

  A future modification will limit the number of outstanding requests
  for a domain, where "outstanding" means that the response of the
  request or any resulting watch event hasn't been consumed yet.

  In order to avoid a malicious guest being capable to block other guests
  by not reading watch events, add a timeout for watch events. In case a
  watch event hasn't been consumed after this timeout, it is being
  deleted. Set the default timeout to 20 seconds (a random value being
  not too high).

  In order to support to specify other timeout values in future, use a
  generic command line option for that purpose:

  --timeout|-w watch-event=<seconds>

  This is part of XSA-326 / CVE-2022-42311.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 5285dcb1a5c01695c11e6397c95d906b5e765c98)
  53a77b82717530d836300f1de0ad037de85477dd:tools/xenstore: let unread watch events time out

  A future modification will limit the number of outstanding requests
  for a domain, where "outstanding" means that the response of the
  request or any resulting watch event hasn't been consumed yet.

  In order to avoid a malicious guest being capable to block other guests
  by not reading watch events, add a timeout for watch events. In case a
  watch event hasn't been consumed after this timeout, it is being
  deleted. Set the default timeout to 20 seconds (a random value being
  not too high).

  In order to support to specify other timeout values in future, use a
  generic command line option for that purpose:

  --timeout|-w watch-event=<seconds>

  This is part of XSA-326 / CVE-2022-42311.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 5285dcb1a5c01695c11e6397c95d906b5e765c98)
  d08cdf0b19daf948a6b9754e90de9bc304bcd262:tools/xenstore: let unread watch events time out

  A future modification will limit the number of outstanding requests
  for a domain, where "outstanding" means that the response of the
  request or any resulting watch event hasn't been consumed yet.

  In order to avoid a malicious guest being capable to block other guests
  by not reading watch events, add a timeout for watch events. In case a
  watch event hasn't been consumed after this timeout, it is being
  deleted. Set the default timeout to 20 seconds (a random value being
  not too high).

  In order to support to specify other timeout values in future, use a
  generic command line option for that purpose:

  --timeout|-w watch-event=<seconds>

  This is part of XSA-326 / CVE-2022-42311.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 5285dcb1a5c01695c11e6397c95d906b5e765c98)
  5285dcb1a5c01695c11e6397c95d906b5e765c98:tools/xenstore: let unread watch events time out

  A future modification will limit the number of outstanding requests
  for a domain, where "outstanding" means that the response of the
  request or any resulting watch event hasn't been consumed yet.

  In order to avoid a malicious guest being capable to block other guests
  by not reading watch events, add a timeout for watch events. In case a
  watch event hasn't been consumed after this timeout, it is being
  deleted. Set the default timeout to 20 seconds (a random value being
  not too high).

  In order to support to specify other timeout values in future, use a
  generic command line option for that purpose:

  --timeout|-w watch-event=<seconds>

  This is part of XSA-326 / CVE-2022-42311.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 53a77b82717530d836300f1de0ad037de85477dd
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d08cdf0b19daf948a6b9754e90de9bc304bcd262
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: cde36e0c369d0156e5f441635a2c45c0e28d926f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 36ed7fe5da0eb8554e94718fb6599795cdef21d0
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5285dcb1a5c01695c11e6397c95d906b5e765c98
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/36ed7fe5da0eb8554e94718fb6599795cdef21d0
    reference_type: commit
    reference_id: 36ed7fe5da0eb8554e94718fb6599795cdef21d0
  - url: https://github.com/xen-project/xen/tree/5285dcb1a5c01695c11e6397c95d906b5e765c98
    reference_type: commit
    reference_id: 5285dcb1a5c01695c11e6397c95d906b5e765c98
  - url: https://github.com/xen-project/xen/tree/53a77b82717530d836300f1de0ad037de85477dd
    reference_type: commit
    reference_id: 53a77b82717530d836300f1de0ad037de85477dd
  - url: https://github.com/xen-project/xen/tree/cde36e0c369d0156e5f441635a2c45c0e28d926f
    reference_type: commit
    reference_id: cde36e0c369d0156e5f441635a2c45c0e28d926f
  - url: https://github.com/xen-project/xen/tree/d08cdf0b19daf948a6b9754e90de9bc304bcd262
    reference_type: commit
    reference_id: d08cdf0b19daf948a6b9754e90de9bc304bcd262
