advisory_id: CVE-2021-28705
datasource_id: collect_xen_project_fix_commits/CVE-2021-28705
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  1442eb9ac448ca43c58bd65dbd82dca0c412c143:x86/P2M: deal with partial success of p2m_set_entry()

  M2P and PoD stats need to remain in sync with P2M; if an update succeeds
  only partially, respective adjustments need to be made. If updates get
  made before the call, they may also need undoing upon complete failure
  (i.e. including the single-page case).

  Log-dirty state would better also be kept in sync.

  Note that the change to set_typed_p2m_entry() may not be strictly
  necessary (due to the order restriction enforced near the top of the
  function), but is being kept here to be on the safe side.

  This is CVE-2021-28705 and CVE-2021-28709 / XSA-389.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 74a11c43fd7e074b1f77631b446dd2115eacb9e8
  master date: 2021-11-22 12:27:30 +0000
  d3c2319ea1657f31ae3899713afc23789b771c10:x86/P2M: deal with partial success of p2m_set_entry()

  M2P and PoD stats need to remain in sync with P2M; if an update succeeds
  only partially, respective adjustments need to be made. If updates get
  made before the call, they may also need undoing upon complete failure
  (i.e. including the single-page case).

  Log-dirty state would better also be kept in sync.

  Note that the change to set_typed_p2m_entry() may not be strictly
  necessary (due to the order restriction enforced near the top of the
  function), but is being kept here to be on the safe side.

  This is CVE-2021-28705 and CVE-2021-28709 / XSA-389.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 74a11c43fd7e074b1f77631b446dd2115eacb9e8
  master date: 2021-11-22 12:27:30 +0000
  9de3671772d5019dab2ba7be7ad1032ad3c9e0f2:x86/P2M: deal with partial success of p2m_set_entry()

  M2P and PoD stats need to remain in sync with P2M; if an update succeeds
  only partially, respective adjustments need to be made. If updates get
  made before the call, they may also need undoing upon complete failure
  (i.e. including the single-page case).

  Log-dirty state would better also be kept in sync.

  Note that the change to set_typed_p2m_entry() may not be strictly
  necessary (due to the order restriction enforced near the top of the
  function), but is being kept here to be on the safe side.

  This is CVE-2021-28705 and CVE-2021-28709 / XSA-389.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 74a11c43fd7e074b1f77631b446dd2115eacb9e8
  master date: 2021-11-22 12:27:30 +0000
  544e547a63175ac6ef7cc29c4f5bda88da024f69:x86/P2M: deal with partial success of p2m_set_entry()

  M2P and PoD stats need to remain in sync with P2M; if an update succeeds
  only partially, respective adjustments need to be made. If updates get
  made before the call, they may also need undoing upon complete failure
  (i.e. including the single-page case).

  Log-dirty state would better also be kept in sync.

  Note that the change to set_typed_p2m_entry() may not be strictly
  necessary (due to the order restriction enforced near the top of the
  function), but is being kept here to be on the safe side.

  This is CVE-2021-28705 and CVE-2021-28709 / XSA-389.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 74a11c43fd7e074b1f77631b446dd2115eacb9e8
  master date: 2021-11-22 12:27:30 +0000
  74a11c43fd7e074b1f77631b446dd2115eacb9e8:x86/P2M: deal with partial success of p2m_set_entry()

  M2P and PoD stats need to remain in sync with P2M; if an update succeeds
  only partially, respective adjustments need to be made. If updates get
  made before the call, they may also need undoing upon complete failure
  (i.e. including the single-page case).

  Log-dirty state would better also be kept in sync.

  Note that the change to set_typed_p2m_entry() may not be strictly
  necessary (due to the order restriction enforced near the top of the
  function), but is being kept here to be on the safe side.

  This is CVE-2021-28705 and CVE-2021-28709 / XSA-389.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1442eb9ac448ca43c58bd65dbd82dca0c412c143
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d3c2319ea1657f31ae3899713afc23789b771c10
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 74a11c43fd7e074b1f77631b446dd2115eacb9e8
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 544e547a63175ac6ef7cc29c4f5bda88da024f69
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9de3671772d5019dab2ba7be7ad1032ad3c9e0f2
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/1442eb9ac448ca43c58bd65dbd82dca0c412c143
    reference_type: commit
    reference_id: 1442eb9ac448ca43c58bd65dbd82dca0c412c143
  - url: https://github.com/xen-project/xen/tree/544e547a63175ac6ef7cc29c4f5bda88da024f69
    reference_type: commit
    reference_id: 544e547a63175ac6ef7cc29c4f5bda88da024f69
  - url: https://github.com/xen-project/xen/tree/74a11c43fd7e074b1f77631b446dd2115eacb9e8
    reference_type: commit
    reference_id: 74a11c43fd7e074b1f77631b446dd2115eacb9e8
  - url: https://github.com/xen-project/xen/tree/9de3671772d5019dab2ba7be7ad1032ad3c9e0f2
    reference_type: commit
    reference_id: 9de3671772d5019dab2ba7be7ad1032ad3c9e0f2
  - url: https://github.com/xen-project/xen/tree/d3c2319ea1657f31ae3899713afc23789b771c10
    reference_type: commit
    reference_id: d3c2319ea1657f31ae3899713afc23789b771c10
