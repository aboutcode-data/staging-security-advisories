advisory_id: CVE-2012-3516
datasource_id: collect_xen_project_fix_commits/CVE-2012-3516
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  4b9e508290c67b1f13bc0f6e059d23ba738995ce:xen/gnttab: Validate input to GNTTABOP_swap_grant_ref

  xen-unstable c/s 24548:d115844ebfbb introduces a new GNTTABOP to swap
  grant refs.  However, it fails to validate the two refs passed from
  the guest.

  The result is that passing out-of-range refs can cause Xen to read
  past the end of the grant_table->active[] array, and deference
  whatever it finds.  Typically, this results in Xen trying to deference
  a low pointer and fail with a page-fault.

  As this hypercall can be issued by an unprivileged guest, this is a
  Denial of Service against Xen.  This is XSA-18 / CVE-2012-3516.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Paul Durrant <paul.durrant@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4b9e508290c67b1f13bc0f6e059d23ba738995ce
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/4b9e508290c67b1f13bc0f6e059d23ba738995ce
    reference_type: commit
    reference_id: 4b9e508290c67b1f13bc0f6e059d23ba738995ce
