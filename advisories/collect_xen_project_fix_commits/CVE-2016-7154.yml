advisory_id: CVE-2016-7154
datasource_id: collect_xen_project_fix_commits/CVE-2016-7154
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  dfddbf35d9df666fa731dcaf35afd8cf24ac8ecf:evtchn-fifo: prevent use after free

  evtchn_fifo_init_control() calls evtchn_fifo_destroy() on an error
  path, leading to cleanup_event_array() which frees d->evtchn_fifo
  without also clearing the pointer. Otoh the bulk of
  evtchn_fifo_init_control() is dependent on d->evtchn_fifo being NULL.

  This is XSA-188 / CVE-2016-7154.

  Reported-by: Mikhail V Gorobets <mikhail.v.gorobets@intel.com>
  Suggested-by: Mikhail V Gorobets <mikhail.v.gorobets@intel.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: dfddbf35d9df666fa731dcaf35afd8cf24ac8ecf
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/dfddbf35d9df666fa731dcaf35afd8cf24ac8ecf
    reference_type: commit
    reference_id: dfddbf35d9df666fa731dcaf35afd8cf24ac8ecf
