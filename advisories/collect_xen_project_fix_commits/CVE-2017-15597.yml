advisory_id: CVE-2017-15597
datasource_id: collect_xen_project_fix_commits/CVE-2017-15597
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  08aa260dd172de625ecc2b64b78b1aa68de1f472:gnttab: fix pin count / page reference race

  Dropping page references before decrementing pin counts is a bad idea
  if assumptions are being made that a non-zero pin count implies a valid
  page. Fix the order of operations in gnttab_copy_release_buf(), but at
  the same time also remove the assertion that was found to trigger:
  map_grant_ref() also has the potential of causing a race here, and
  changing the order of operations there would likely be quite a bit more
  involved.

  This is CVE-2017-15597 / XSA-236.

  Reported-by: Pawel Wieczorkiewicz <wipawel@amazon.de>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: e008f7619dcd6d549727c9635b3f9f3c7ee483ed
  master date: 2017-10-24 16:01:33 +0200
  9454e3030ae0835c11aa66471238a9e09db5074e:gnttab: fix pin count / page reference race

  Dropping page references before decrementing pin counts is a bad idea
  if assumptions are being made that a non-zero pin count implies a valid
  page. Fix the order of operations in gnttab_copy_release_buf(), but at
  the same time also remove the assertion that was found to trigger:
  map_grant_ref() also has the potential of causing a race here, and
  changing the order of operations there would likely be quite a bit more
  involved.

  This is CVE-2017-15597 / XSA-236.

  Reported-by: Pawel Wieczorkiewicz <wipawel@amazon.de>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: e008f7619dcd6d549727c9635b3f9f3c7ee483ed
  master date: 2017-10-24 16:01:33 +0200
  f03b9e86e7e18cbbc0b9ecb01ae74730362c6603:gnttab: fix pin count / page reference race

  Dropping page references before decrementing pin counts is a bad idea
  if assumptions are being made that a non-zero pin count implies a valid
  page. Fix the order of operations in gnttab_copy_release_buf(), but at
  the same time also remove the assertion that was found to trigger:
  map_grant_ref() also has the potential of causing a race here, and
  changing the order of operations there would likely be quite a bit more
  involved.

  This is CVE-2017-15597 / XSA-236.

  Reported-by: Pawel Wieczorkiewicz <wipawel@amazon.de>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: e008f7619dcd6d549727c9635b3f9f3c7ee483ed
  master date: 2017-10-24 16:01:33 +0200
  fcbbd0faeeb9a7dd204287fee7871df397c957ee:gnttab: fix pin count / page reference race

  Dropping page references before decrementing pin counts is a bad idea
  if assumptions are being made that a non-zero pin count implies a valid
  page. Fix the order of operations in gnttab_copy_release_buf(), but at
  the same time also remove the assertion that was found to trigger:
  map_grant_ref() also has the potential of causing a race here, and
  changing the order of operations there would likely be quite a bit more
  involved.

  This is CVE-2017-15597 / XSA-236.

  Reported-by: Pawel Wieczorkiewicz <wipawel@amazon.de>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: e008f7619dcd6d549727c9635b3f9f3c7ee483ed
  master date: 2017-10-24 16:01:33 +0200
  174a5690708a874b889f9436e82632b1187faea7:gnttab: fix pin count / page reference race

  Dropping page references before decrementing pin counts is a bad idea
  if assumptions are being made that a non-zero pin count implies a valid
  page. Fix the order of operations in gnttab_copy_release_buf(), but at
  the same time also remove the assertion that was found to trigger:
  map_grant_ref() also has the potential of causing a race here, and
  changing the order of operations there would likely be quite a bit more
  involved.

  This is CVE-2017-15597 / XSA-236.

  Reported-by: Pawel Wieczorkiewicz <wipawel@amazon.de>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: e008f7619dcd6d549727c9635b3f9f3c7ee483ed
  master date: 2017-10-24 16:01:33 +0200
  e008f7619dcd6d549727c9635b3f9f3c7ee483ed:gnttab: fix pin count / page reference race

  Dropping page references before decrementing pin counts is a bad idea
  if assumptions are being made that a non-zero pin count implies a valid
  page. Fix the order of operations in gnttab_copy_release_buf(), but at
  the same time also remove the assertion that was found to trigger:
  map_grant_ref() also has the potential of causing a race here, and
  changing the order of operations there would likely be quite a bit more
  involved.

  This is CVE-2017-15597 / XSA-236.

  Reported-by: Pawel Wieczorkiewicz <wipawel@amazon.de>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 08aa260dd172de625ecc2b64b78b1aa68de1f472
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 174a5690708a874b889f9436e82632b1187faea7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9454e3030ae0835c11aa66471238a9e09db5074e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f03b9e86e7e18cbbc0b9ecb01ae74730362c6603
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e008f7619dcd6d549727c9635b3f9f3c7ee483ed
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: fcbbd0faeeb9a7dd204287fee7871df397c957ee
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/08aa260dd172de625ecc2b64b78b1aa68de1f472
    reference_type: commit
    reference_id: 08aa260dd172de625ecc2b64b78b1aa68de1f472
  - url: https://github.com/xen-project/xen/tree/174a5690708a874b889f9436e82632b1187faea7
    reference_type: commit
    reference_id: 174a5690708a874b889f9436e82632b1187faea7
  - url: https://github.com/xen-project/xen/tree/9454e3030ae0835c11aa66471238a9e09db5074e
    reference_type: commit
    reference_id: 9454e3030ae0835c11aa66471238a9e09db5074e
  - url: https://github.com/xen-project/xen/tree/e008f7619dcd6d549727c9635b3f9f3c7ee483ed
    reference_type: commit
    reference_id: e008f7619dcd6d549727c9635b3f9f3c7ee483ed
  - url: https://github.com/xen-project/xen/tree/f03b9e86e7e18cbbc0b9ecb01ae74730362c6603
    reference_type: commit
    reference_id: f03b9e86e7e18cbbc0b9ecb01ae74730362c6603
  - url: https://github.com/xen-project/xen/tree/fcbbd0faeeb9a7dd204287fee7871df397c957ee
    reference_type: commit
    reference_id: fcbbd0faeeb9a7dd204287fee7871df397c957ee
