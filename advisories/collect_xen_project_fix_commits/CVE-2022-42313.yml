advisory_id: CVE-2022-42313
datasource_id: collect_xen_project_fix_commits/CVE-2022-42313
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  5fa4f2c6c8dbc225824a6f9c407b11c510d98674:tools/xenstore: simplify and fix per domain node accounting

  The accounting of nodes can be simplified now that each connection
  holds the associated domid.

  Fix the node accounting to cover nodes created for a domain before it
  has been introduced. This requires to react properly to an allocation
  failure inside domain_entry_inc() by returning an error code.

  Especially in error paths the node accounting has to be fixed in some
  cases.

  This is part of XSA-326 / CVE-2022-42313.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit dbef1f7482894c572d90cd73d99ed689c891e863)
  82dfb67578243a1abda3774df0dfd511bdff0572:tools/xenstore: simplify and fix per domain node accounting

  The accounting of nodes can be simplified now that each connection
  holds the associated domid.

  Fix the node accounting to cover nodes created for a domain before it
  has been introduced. This requires to react properly to an allocation
  failure inside domain_entry_inc() by returning an error code.

  Especially in error paths the node accounting has to be fixed in some
  cases.

  This is part of XSA-326 / CVE-2022-42313.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit dbef1f7482894c572d90cd73d99ed689c891e863)
  8ee7ed7c1ef435f43edc08be07c036d81642d8e1:tools/xenstore: simplify and fix per domain node accounting

  The accounting of nodes can be simplified now that each connection
  holds the associated domid.

  Fix the node accounting to cover nodes created for a domain before it
  has been introduced. This requires to react properly to an allocation
  failure inside domain_entry_inc() by returning an error code.

  Especially in error paths the node accounting has to be fixed in some
  cases.

  This is part of XSA-326 / CVE-2022-42313.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit dbef1f7482894c572d90cd73d99ed689c891e863)
  717460e062dfe13a69cb01f518dd7b65d39376ef:tools/xenstore: simplify and fix per domain node accounting

  The accounting of nodes can be simplified now that each connection
  holds the associated domid.

  Fix the node accounting to cover nodes created for a domain before it
  has been introduced. This requires to react properly to an allocation
  failure inside domain_entry_inc() by returning an error code.

  Especially in error paths the node accounting has to be fixed in some
  cases.

  This is part of XSA-326 / CVE-2022-42313.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit dbef1f7482894c572d90cd73d99ed689c891e863)
  dbef1f7482894c572d90cd73d99ed689c891e863:tools/xenstore: simplify and fix per domain node accounting

  The accounting of nodes can be simplified now that each connection
  holds the associated domid.

  Fix the node accounting to cover nodes created for a domain before it
  has been introduced. This requires to react properly to an allocation
  failure inside domain_entry_inc() by returning an error code.

  Especially in error paths the node accounting has to be fixed in some
  cases.

  This is part of XSA-326 / CVE-2022-42313.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 82dfb67578243a1abda3774df0dfd511bdff0572
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 717460e062dfe13a69cb01f518dd7b65d39376ef
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8ee7ed7c1ef435f43edc08be07c036d81642d8e1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5fa4f2c6c8dbc225824a6f9c407b11c510d98674
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: dbef1f7482894c572d90cd73d99ed689c891e863
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/5fa4f2c6c8dbc225824a6f9c407b11c510d98674
    reference_type: commit
    reference_id: 5fa4f2c6c8dbc225824a6f9c407b11c510d98674
  - url: https://github.com/xen-project/xen/tree/717460e062dfe13a69cb01f518dd7b65d39376ef
    reference_type: commit
    reference_id: 717460e062dfe13a69cb01f518dd7b65d39376ef
  - url: https://github.com/xen-project/xen/tree/82dfb67578243a1abda3774df0dfd511bdff0572
    reference_type: commit
    reference_id: 82dfb67578243a1abda3774df0dfd511bdff0572
  - url: https://github.com/xen-project/xen/tree/8ee7ed7c1ef435f43edc08be07c036d81642d8e1
    reference_type: commit
    reference_id: 8ee7ed7c1ef435f43edc08be07c036d81642d8e1
  - url: https://github.com/xen-project/xen/tree/dbef1f7482894c572d90cd73d99ed689c891e863
    reference_type: commit
    reference_id: dbef1f7482894c572d90cd73d99ed689c891e863
