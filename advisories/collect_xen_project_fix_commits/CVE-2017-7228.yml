advisory_id: CVE-2017-7228
datasource_id: collect_xen_project_fix_commits/CVE-2017-7228
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  89bd1cf12783b5c0e179b45f5d758c19d0355d83:memory: properly check guest memory ranges in XENMEM_exchange handling

  The use of guest_handle_okay() here (as introduced by the XSA-29 fix)
  is insufficient here, guest_handle_subrange_okay() needs to be used
  instead.

  Note that the uses are okay in
  - XENMEM_add_to_physmap_batch handling due to the size field being only
    16 bits wide,
  - livepatch_list() due to the limit of 1024 enforced on the
    number-of-entries input (leaving aside the fact that this can be
    called by a privileged domain only anyway),
  - compat mode handling due to counts there being limited to 32 bits,
  - everywhere else due to guest arrays being accessed sequentially from
    index zero.

  This is CVE-2017-7228 / XSA-212.

  Reported-by: Jann Horn <jannh@google.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 938fd2586eb081bcbd694f4c1f09ae6a263b0d90
  master date: 2017-04-04 14:47:46 +0200
  cde86fc9fd92041a5ad3d65082e45b9e6a2c7334:memory: properly check guest memory ranges in XENMEM_exchange handling

  The use of guest_handle_okay() here (as introduced by the XSA-29 fix)
  is insufficient here, guest_handle_subrange_okay() needs to be used
  instead.

  Note that the uses are okay in
  - XENMEM_add_to_physmap_batch handling due to the size field being only
    16 bits wide,
  - livepatch_list() due to the limit of 1024 enforced on the
    number-of-entries input (leaving aside the fact that this can be
    called by a privileged domain only anyway),
  - compat mode handling due to counts there being limited to 32 bits,
  - everywhere else due to guest arrays being accessed sequentially from
    index zero.

  This is CVE-2017-7228 / XSA-212.

  Reported-by: Jann Horn <jannh@google.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 938fd2586eb081bcbd694f4c1f09ae6a263b0d90
  master date: 2017-04-04 14:47:46 +0200
  ef63a62b3a7fd908af320133770dcc8dbdf02f2b:memory: properly check guest memory ranges in XENMEM_exchange handling

  The use of guest_handle_okay() here (as introduced by the XSA-29 fix)
  is insufficient here, guest_handle_subrange_okay() needs to be used
  instead.

  Note that the uses are okay in
  - XENMEM_add_to_physmap_batch handling due to the size field being only
    16 bits wide,
  - livepatch_list() due to the limit of 1024 enforced on the
    number-of-entries input (leaving aside the fact that this can be
    called by a privileged domain only anyway),
  - compat mode handling due to counts there being limited to 32 bits,
  - everywhere else due to guest arrays being accessed sequentially from
    index zero.

  This is CVE-2017-7228 / XSA-212.

  Reported-by: Jann Horn <jannh@google.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 938fd2586eb081bcbd694f4c1f09ae6a263b0d90
  master date: 2017-04-04 14:47:46 +0200
  4bd66bc3bbf1a3337c394d5bf16f4d7db8129935:memory: properly check guest memory ranges in XENMEM_exchange handling

  The use of guest_handle_okay() here (as introduced by the XSA-29 fix)
  is insufficient here, guest_handle_subrange_okay() needs to be used
  instead.

  Note that the uses are okay in
  - XENMEM_add_to_physmap_batch handling due to the size field being only
    16 bits wide,
  - livepatch_list() due to the limit of 1024 enforced on the
    number-of-entries input (leaving aside the fact that this can be
    called by a privileged domain only anyway),
  - compat mode handling due to counts there being limited to 32 bits,
  - everywhere else due to guest arrays being accessed sequentially from
    index zero.

  This is CVE-2017-7228 / XSA-212.

  Reported-by: Jann Horn <jannh@google.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 938fd2586eb081bcbd694f4c1f09ae6a263b0d90
  master date: 2017-04-04 14:47:46 +0200
  06403aa5f28bf697051de0435ef942f4c0d25849:memory: properly check guest memory ranges in XENMEM_exchange handling

  The use of guest_handle_okay() here (as introduced by the XSA-29 fix)
  is insufficient here, guest_handle_subrange_okay() needs to be used
  instead.

  Note that the uses are okay in
  - XENMEM_add_to_physmap_batch handling due to the size field being only
    16 bits wide,
  - livepatch_list() due to the limit of 1024 enforced on the
    number-of-entries input (leaving aside the fact that this can be
    called by a privileged domain only anyway),
  - compat mode handling due to counts there being limited to 32 bits,
  - everywhere else due to guest arrays being accessed sequentially from
    index zero.

  This is CVE-2017-7228 / XSA-212.

  Reported-by: Jann Horn <jannh@google.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 938fd2586eb081bcbd694f4c1f09ae6a263b0d90
  master date: 2017-04-04 14:47:46 +0200
  938fd2586eb081bcbd694f4c1f09ae6a263b0d90:memory: properly check guest memory ranges in XENMEM_exchange handling

  The use of guest_handle_okay() here (as introduced by the XSA-29 fix)
  is insufficient here, guest_handle_subrange_okay() needs to be used
  instead.

  Note that the uses are okay in
  - XENMEM_add_to_physmap_batch handling due to the size field being only
    16 bits wide,
  - livepatch_list() due to the limit of 1024 enforced on the
    number-of-entries input (leaving aside the fact that this can be
    called by a privileged domain only anyway),
  - compat mode handling due to counts there being limited to 32 bits,
  - everywhere else due to guest arrays being accessed sequentially from
    index zero.

  This is CVE-2017-7228 / XSA-212.

  Reported-by: Jann Horn <jannh@google.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 06403aa5f28bf697051de0435ef942f4c0d25849
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 89bd1cf12783b5c0e179b45f5d758c19d0355d83
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ef63a62b3a7fd908af320133770dcc8dbdf02f2b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 938fd2586eb081bcbd694f4c1f09ae6a263b0d90
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: cde86fc9fd92041a5ad3d65082e45b9e6a2c7334
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4bd66bc3bbf1a3337c394d5bf16f4d7db8129935
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/06403aa5f28bf697051de0435ef942f4c0d25849
    reference_type: commit
    reference_id: 06403aa5f28bf697051de0435ef942f4c0d25849
  - url: https://github.com/xen-project/xen/tree/4bd66bc3bbf1a3337c394d5bf16f4d7db8129935
    reference_type: commit
    reference_id: 4bd66bc3bbf1a3337c394d5bf16f4d7db8129935
  - url: https://github.com/xen-project/xen/tree/89bd1cf12783b5c0e179b45f5d758c19d0355d83
    reference_type: commit
    reference_id: 89bd1cf12783b5c0e179b45f5d758c19d0355d83
  - url: https://github.com/xen-project/xen/tree/938fd2586eb081bcbd694f4c1f09ae6a263b0d90
    reference_type: commit
    reference_id: 938fd2586eb081bcbd694f4c1f09ae6a263b0d90
  - url: https://github.com/xen-project/xen/tree/cde86fc9fd92041a5ad3d65082e45b9e6a2c7334
    reference_type: commit
    reference_id: cde86fc9fd92041a5ad3d65082e45b9e6a2c7334
  - url: https://github.com/xen-project/xen/tree/ef63a62b3a7fd908af320133770dcc8dbdf02f2b
    reference_type: commit
    reference_id: ef63a62b3a7fd908af320133770dcc8dbdf02f2b
