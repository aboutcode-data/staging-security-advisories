advisory_id: CVE-2016-6354
datasource_id: collect_xen_project_fix_commits/CVE-2016-6354
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  fde76f895d0aa817a1207d844d793239c6639bc6:tools: Commit flex (2.6.4) & bison (3.3.2) output from Debian buster

  These files are in tree so that people can build (including from git)
  without needing less-than-a-decade-old flex and bison.

  We should update them periodically.  Debian buster has been Debian
  stable for a while.  Our CI is running buster.

  There should be no significant functional change; it's possible that
  there are bugfixes but I have not reviewed the changes.  I *have*
  checked that the flex I am using has the fix for CVE-2016-6354.

  CC: Paul Durrant <paul@xen.org>
  CC: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Reviewed-by: Anthony PERARD <anthony.perard@citrix.com>
  Release-acked-by: Paul Durrant <paul@xen.org>
  eb502cb30cc5af309ed824da024014afca1d0fcf:libxl: update flex output files for DSA 3653-2

  We updated flex output files in 4b314c89 ("libxl: update flex output
  files") for DSA 3653-1 / CVE-2016-6354. But Debian security team
  discovered the fix to flex was incomplete and issued DSA 3653-2. We need
  to update our flex output files accordingly.

  Signed-off-by: Wei Liu <wei.liu2@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  4b314c89be24c26abfad47900f806cebeafc805e:libxl: update flex output files

  Libxl ships output files from flex (libxlu_*_l.{c,h}). We use the flex
  shipped in Debian to generate those files. Debian just patched their
  flex (DSA 3653-1) to fix CVE-2016-6354, which is a buffer overrun bug.

  Note that libxl is _NOT_ vulnerable to that CVE. See below for Ian's
  analysis to security@xen.

  It would still be nice that we update our shipped flex output files to
  avoid confusion.

  ===QUOTE===

  The bug is that with input >16K[1] flex would usually fail to resize
  the input buffer, and then overrun it.

  I have read the code in libxlu_cfg_l.c to try to understand the
  implications for libxl.

  AFAICT
   - libxl always does config file reading _from the file_ itself, and
     provides flex with a string or buffer.
   - so we always call whatever_yy_scan_bytes, not any other flex setup
     function to set up a `buffer' (as flex calls it)
   - yy_scan_bytes calls yy_scan_buffer to set up the buffer
   - yy_scan_buffer sets b->yy_fill_buffer
   - The effect of this is that yy_get_next_buffer will always
     return early, rather than continuing on to the vulnerable code.

  So I think libxl is not vulnerable, regardless of the contents of the
  configuration file.

  [1] the default buffer size, or whatever other buffer size is
  configured (but we don't change it)

  ===ENDQUOTE===

  Signed-off-by: Wei Liu <wei.liu2@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: fde76f895d0aa817a1207d844d793239c6639bc6
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: eb502cb30cc5af309ed824da024014afca1d0fcf
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4b314c89be24c26abfad47900f806cebeafc805e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/4b314c89be24c26abfad47900f806cebeafc805e
    reference_type: commit
    reference_id: 4b314c89be24c26abfad47900f806cebeafc805e
  - url: https://github.com/xen-project/xen/tree/eb502cb30cc5af309ed824da024014afca1d0fcf
    reference_type: commit
    reference_id: eb502cb30cc5af309ed824da024014afca1d0fcf
  - url: https://github.com/xen-project/xen/tree/fde76f895d0aa817a1207d844d793239c6639bc6
    reference_type: commit
    reference_id: fde76f895d0aa817a1207d844d793239c6639bc6
