advisory_id: CVE-2012-0217
datasource_id: collect_xen_project_fix_commits/CVE-2012-0217
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  00330de0073ca61fa45bd800df2cc4f4a947cbc9:x86_64: Do not execute sysret with a non-canonical return address

  Check for non-canonical guest RIP before attempting to execute sysret.
  If sysret is executed with a non-canonical value in RCX, Intel CPUs
  take the fault in ring0, but we will necessarily already have switched
  to the the user's stack pointer.

  This is a security vulnerability, XSA-7 / CVE-2012-0217.

  Signed-off-by: Jan Beulich <JBeulich@suse.com>
  Signed-off-by: Ian Campbell <Ian.Campbell@citrix.com>
  Signed-off-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Acked-by: Keir Fraser <keir.xen@gmail.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>

  xen-unstable changeset:   25480:76eaf5966c05
  xen-unstable date:        Tue Jun 12 11:33:40 2012 +0100
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  a5edee59689d6b4a0ca2ece6eb242ed7fd33bbe8:x86_64: Do not execute sysret with a non-canonical return address

  Check for non-canonical guest RIP before attempting to execute sysret.
  If sysret is executed with a non-canonical value in RCX, Intel CPUs
  take the fault in ring0, but we will necessarily already have switched
  to the the user's stack pointer.

  This is a security vulnerability, XSA-7 / CVE-2012-0217.

  Signed-off-by: Jan Beulich <JBeulich@suse.com>
  Signed-off-by: Ian Campbell <Ian.Campbell@citrix.com>
  Signed-off-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Acked-by: Keir Fraser <keir.xen@gmail.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>

  xen-unstable changeset:   25480:76eaf5966c05
  xen-unstable date:        Tue Jun 12 11:33:40 2012 +0100
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  6b091fa4457c6768c7fc505e2a42a5f32b83bc8d:x86_64: Do not execute sysret with a non-canonical return address

  Check for non-canonical guest RIP before attempting to execute sysret.
  If sysret is executed with a non-canonical value in RCX, Intel CPUs
  take the fault in ring0, but we will necessarily already have switched
  to the the user's stack pointer.

  This is a security vulnerability, XSA-7 / CVE-2012-0217.

  Signed-off-by: Jan Beulich <JBeulich@suse.com>
  Signed-off-by: Ian Campbell <Ian.Campbell@citrix.com>
  Signed-off-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Tested-by: Ian Campbell <Ian.Campbell@citrix.com>
  Acked-by: Keir Fraser <keir.xen@gmail.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a5edee59689d6b4a0ca2ece6eb242ed7fd33bbe8
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 00330de0073ca61fa45bd800df2cc4f4a947cbc9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 6b091fa4457c6768c7fc505e2a42a5f32b83bc8d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/00330de0073ca61fa45bd800df2cc4f4a947cbc9
    reference_type: commit
    reference_id: 00330de0073ca61fa45bd800df2cc4f4a947cbc9
  - url: https://github.com/xen-project/xen/tree/6b091fa4457c6768c7fc505e2a42a5f32b83bc8d
    reference_type: commit
    reference_id: 6b091fa4457c6768c7fc505e2a42a5f32b83bc8d
  - url: https://github.com/xen-project/xen/tree/a5edee59689d6b4a0ca2ece6eb242ed7fd33bbe8
    reference_type: commit
    reference_id: a5edee59689d6b4a0ca2ece6eb242ed7fd33bbe8
