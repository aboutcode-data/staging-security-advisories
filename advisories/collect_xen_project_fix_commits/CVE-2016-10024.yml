advisory_id: CVE-2016-10024
datasource_id: collect_xen_project_fix_commits/CVE-2016-10024
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  394ddc2de62cbcaf9d28cc7373fde175e6ba3a5d:x86: force EFLAGS.IF on when exiting to PV guests

  Guest kernels modifying instructions in the process of being emulated
  for another of their vCPU-s may effect EFLAGS.IF to be cleared upon
  next exiting to guest context, by converting the being emulated
  instruction to CLI (at the right point in time). Prevent any such bad
  effects by always forcing EFLAGS.IF on. And to cover hypothetical other
  similar issues, also force EFLAGS.{IOPL,NT,VM} to zero.

  This is CVE-2016-10024 / XSA-202.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 0e47f92b072548800223f9a21ea051a017173915
  master date: 2016-12-21 16:46:13 +0100
  0bd7faf010631d5bbebd2cf81c75a5f9ef635c51:x86: force EFLAGS.IF on when exiting to PV guests

  Guest kernels modifying instructions in the process of being emulated
  for another of their vCPU-s may effect EFLAGS.IF to be cleared upon
  next exiting to guest context, by converting the being emulated
  instruction to CLI (at the right point in time). Prevent any such bad
  effects by always forcing EFLAGS.IF on. And to cover hypothetical other
  similar issues, also force EFLAGS.{IOPL,NT,VM} to zero.

  This is CVE-2016-10024 / XSA-202.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 0e47f92b072548800223f9a21ea051a017173915
  master date: 2016-12-21 16:46:13 +0100
  c7f06e4eedcfd17024d48849bc8b047b813da0f7:x86: force EFLAGS.IF on when exiting to PV guests

  Guest kernels modifying instructions in the process of being emulated
  for another of their vCPU-s may effect EFLAGS.IF to be cleared upon
  next exiting to guest context, by converting the being emulated
  instruction to CLI (at the right point in time). Prevent any such bad
  effects by always forcing EFLAGS.IF on. And to cover hypothetical other
  similar issues, also force EFLAGS.{IOPL,NT,VM} to zero.

  This is CVE-2016-10024 / XSA-202.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 0e47f92b072548800223f9a21ea051a017173915
  master date: 2016-12-21 16:46:13 +0100
  c2a7cc912743e23423580fb1628dd86f8b1e4d96:x86: force EFLAGS.IF on when exiting to PV guests

  Guest kernels modifying instructions in the process of being emulated
  for another of their vCPU-s may effect EFLAGS.IF to be cleared upon
  next exiting to guest context, by converting the being emulated
  instruction to CLI (at the right point in time). Prevent any such bad
  effects by always forcing EFLAGS.IF on. And to cover hypothetical other
  similar issues, also force EFLAGS.{IOPL,NT,VM} to zero.

  This is CVE-2016-10024 / XSA-202.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 0e47f92b072548800223f9a21ea051a017173915
  master date: 2016-12-21 16:46:13 +0100
  7628c7efb4afca8cb2264bc3ab59830e481b37a8:x86: force EFLAGS.IF on when exiting to PV guests

  Guest kernels modifying instructions in the process of being emulated
  for another of their vCPU-s may effect EFLAGS.IF to be cleared upon
  next exiting to guest context, by converting the being emulated
  instruction to CLI (at the right point in time). Prevent any such bad
  effects by always forcing EFLAGS.IF on. And to cover hypothetical other
  similar issues, also force EFLAGS.{IOPL,NT,VM} to zero.

  This is CVE-2016-10024 / XSA-202.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 0e47f92b072548800223f9a21ea051a017173915
  master date: 2016-12-21 16:46:13 +0100
  0e47f92b072548800223f9a21ea051a017173915:x86: force EFLAGS.IF on when exiting to PV guests

  Guest kernels modifying instructions in the process of being emulated
  for another of their vCPU-s may effect EFLAGS.IF to be cleared upon
  next exiting to guest context, by converting the being emulated
  instruction to CLI (at the right point in time). Prevent any such bad
  effects by always forcing EFLAGS.IF on. And to cover hypothetical other
  similar issues, also force EFLAGS.{IOPL,NT,VM} to zero.

  This is CVE-2016-10024 / XSA-202.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c7f06e4eedcfd17024d48849bc8b047b813da0f7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7628c7efb4afca8cb2264bc3ab59830e481b37a8
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 394ddc2de62cbcaf9d28cc7373fde175e6ba3a5d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0e47f92b072548800223f9a21ea051a017173915
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0bd7faf010631d5bbebd2cf81c75a5f9ef635c51
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c2a7cc912743e23423580fb1628dd86f8b1e4d96
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/0bd7faf010631d5bbebd2cf81c75a5f9ef635c51
    reference_type: commit
    reference_id: 0bd7faf010631d5bbebd2cf81c75a5f9ef635c51
  - url: https://github.com/xen-project/xen/tree/0e47f92b072548800223f9a21ea051a017173915
    reference_type: commit
    reference_id: 0e47f92b072548800223f9a21ea051a017173915
  - url: https://github.com/xen-project/xen/tree/394ddc2de62cbcaf9d28cc7373fde175e6ba3a5d
    reference_type: commit
    reference_id: 394ddc2de62cbcaf9d28cc7373fde175e6ba3a5d
  - url: https://github.com/xen-project/xen/tree/7628c7efb4afca8cb2264bc3ab59830e481b37a8
    reference_type: commit
    reference_id: 7628c7efb4afca8cb2264bc3ab59830e481b37a8
  - url: https://github.com/xen-project/xen/tree/c2a7cc912743e23423580fb1628dd86f8b1e4d96
    reference_type: commit
    reference_id: c2a7cc912743e23423580fb1628dd86f8b1e4d96
  - url: https://github.com/xen-project/xen/tree/c7f06e4eedcfd17024d48849bc8b047b813da0f7
    reference_type: commit
    reference_id: c7f06e4eedcfd17024d48849bc8b047b813da0f7
