advisory_id: CVE-2022-42315
datasource_id: collect_xen_project_fix_commits/CVE-2022-42315
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  7dc06ed1f2ab191ec03e892329be90ecdcd764c8:tools/xenstore: add memory accounting for nodes

  Add the memory accounting for Xenstore nodes. In order to make this
  not too complicated allow for some sloppiness when writing nodes. Any
  hard quota violation will result in no further requests to be accepted.

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 00e9e32d022be1afc144b75acdaeba8393e63315)
  c17d49134aef23c8d017a64e5e36c626779bf863:tools/xenstore: add memory accounting for watches

  Add the memory accounting for registered watches.

  When a socket connection is destroyed, the associated watches are
  removed, too. In order to keep memory accounting correct the watches
  must be removed explicitly via a call of conn_delete_all_watches() from
  destroy_conn().

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 7f9978a2cc37aaffab2fb09593bc598c0712a69b)
  115156c416ad9a12d72d14f2df0c982ea1a254c4:tools/xenstore: add memory accounting for responses

  Add the memory accounting for queued responses.

  In case adding a watch event for a guest is causing the hard memory
  quota of that guest to be violated, the event is dropped. This will
  ensure that it is impossible to drive another guest past its memory
  quota by generating insane amounts of events for that guest. This is
  especially important for protecting driver domains from that attack
  vector.

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit f6d00133643a524d2138c9e3f192bbde719050ba)
  36812ae518975e2eb40ad14ff0c70dd0ab08bf82:tools/xenstore: add memory accounting for nodes

  Add the memory accounting for Xenstore nodes. In order to make this
  not too complicated allow for some sloppiness when writing nodes. Any
  hard quota violation will result in no further requests to be accepted.

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 00e9e32d022be1afc144b75acdaeba8393e63315)
  3a7c46a94454aa48f6e247ed91773d96b4b70afb:tools/xenstore: add memory accounting for watches

  Add the memory accounting for registered watches.

  When a socket connection is destroyed, the associated watches are
  removed, too. In order to keep memory accounting correct the watches
  must be removed explicitly via a call of conn_delete_all_watches() from
  destroy_conn().

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 7f9978a2cc37aaffab2fb09593bc598c0712a69b)
  cc289061d93786aa5bd504c91b583e1abb55bbb4:tools/xenstore: add memory accounting for responses

  Add the memory accounting for queued responses.

  In case adding a watch event for a guest is causing the hard memory
  quota of that guest to be violated, the event is dropped. This will
  ensure that it is impossible to drive another guest past its memory
  quota by generating insane amounts of events for that guest. This is
  especially important for protecting driver domains from that attack
  vector.

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit f6d00133643a524d2138c9e3f192bbde719050ba)
  32efe29a00efab2896cc973e966a35ecad556495:tools/xenstore: add memory accounting for nodes

  Add the memory accounting for Xenstore nodes. In order to make this
  not too complicated allow for some sloppiness when writing nodes. Any
  hard quota violation will result in no further requests to be accepted.

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 00e9e32d022be1afc144b75acdaeba8393e63315)
  9c2e71fe0611da9ed2ebbf2362a9bb05d42bf0c3:tools/xenstore: add memory accounting for watches

  Add the memory accounting for registered watches.

  When a socket connection is destroyed, the associated watches are
  removed, too. In order to keep memory accounting correct the watches
  must be removed explicitly via a call of conn_delete_all_watches() from
  destroy_conn().

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 7f9978a2cc37aaffab2fb09593bc598c0712a69b)
  0113aacb3d791600668cd7703f6f12ed94fc6d03:tools/xenstore: add memory accounting for responses

  Add the memory accounting for queued responses.

  In case adding a watch event for a guest is causing the hard memory
  quota of that guest to be violated, the event is dropped. This will
  ensure that it is impossible to drive another guest past its memory
  quota by generating insane amounts of events for that guest. This is
  especially important for protecting driver domains from that attack
  vector.

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit f6d00133643a524d2138c9e3f192bbde719050ba)
  578d422af0b444a9e437dd0ceddf2049364f1a40:tools/xenstore: add memory accounting for nodes

  Add the memory accounting for Xenstore nodes. In order to make this
  not too complicated allow for some sloppiness when writing nodes. Any
  hard quota violation will result in no further requests to be accepted.

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 00e9e32d022be1afc144b75acdaeba8393e63315)
  bce985745cde48a339954759677b77d3eeec41f3:tools/xenstore: add memory accounting for watches

  Add the memory accounting for registered watches.

  When a socket connection is destroyed, the associated watches are
  removed, too. In order to keep memory accounting correct the watches
  must be removed explicitly via a call of conn_delete_all_watches() from
  destroy_conn().

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 7f9978a2cc37aaffab2fb09593bc598c0712a69b)
  30c8e752f66f681b5c731a637c26510ae5f35965:tools/xenstore: add memory accounting for responses

  Add the memory accounting for queued responses.

  In case adding a watch event for a guest is causing the hard memory
  quota of that guest to be violated, the event is dropped. This will
  ensure that it is impossible to drive another guest past its memory
  quota by generating insane amounts of events for that guest. This is
  especially important for protecting driver domains from that attack
  vector.

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit f6d00133643a524d2138c9e3f192bbde719050ba)
  00e9e32d022be1afc144b75acdaeba8393e63315:tools/xenstore: add memory accounting for nodes

  Add the memory accounting for Xenstore nodes. In order to make this
  not too complicated allow for some sloppiness when writing nodes. Any
  hard quota violation will result in no further requests to be accepted.

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  7f9978a2cc37aaffab2fb09593bc598c0712a69b:tools/xenstore: add memory accounting for watches

  Add the memory accounting for registered watches.

  When a socket connection is destroyed, the associated watches are
  removed, too. In order to keep memory accounting correct the watches
  must be removed explicitly via a call of conn_delete_all_watches() from
  destroy_conn().

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  f6d00133643a524d2138c9e3f192bbde719050ba:tools/xenstore: add memory accounting for responses

  Add the memory accounting for queued responses.

  In case adding a watch event for a guest is causing the hard memory
  quota of that guest to be violated, the event is dropped. This will
  ensure that it is impossible to drive another guest past its memory
  quota by generating insane amounts of events for that guest. This is
  especially important for protecting driver domains from that attack
  vector.

  This is part of XSA-326 / CVE-2022-42315.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 30c8e752f66f681b5c731a637c26510ae5f35965
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 115156c416ad9a12d72d14f2df0c982ea1a254c4
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f6d00133643a524d2138c9e3f192bbde719050ba
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 36812ae518975e2eb40ad14ff0c70dd0ab08bf82
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 32efe29a00efab2896cc973e966a35ecad556495
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9c2e71fe0611da9ed2ebbf2362a9bb05d42bf0c3
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0113aacb3d791600668cd7703f6f12ed94fc6d03
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 578d422af0b444a9e437dd0ceddf2049364f1a40
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 00e9e32d022be1afc144b75acdaeba8393e63315
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7dc06ed1f2ab191ec03e892329be90ecdcd764c8
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c17d49134aef23c8d017a64e5e36c626779bf863
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: bce985745cde48a339954759677b77d3eeec41f3
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7f9978a2cc37aaffab2fb09593bc598c0712a69b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3a7c46a94454aa48f6e247ed91773d96b4b70afb
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: cc289061d93786aa5bd504c91b583e1abb55bbb4
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/00e9e32d022be1afc144b75acdaeba8393e63315
    reference_type: commit
    reference_id: 00e9e32d022be1afc144b75acdaeba8393e63315
  - url: https://github.com/xen-project/xen/tree/0113aacb3d791600668cd7703f6f12ed94fc6d03
    reference_type: commit
    reference_id: 0113aacb3d791600668cd7703f6f12ed94fc6d03
  - url: https://github.com/xen-project/xen/tree/115156c416ad9a12d72d14f2df0c982ea1a254c4
    reference_type: commit
    reference_id: 115156c416ad9a12d72d14f2df0c982ea1a254c4
  - url: https://github.com/xen-project/xen/tree/30c8e752f66f681b5c731a637c26510ae5f35965
    reference_type: commit
    reference_id: 30c8e752f66f681b5c731a637c26510ae5f35965
  - url: https://github.com/xen-project/xen/tree/32efe29a00efab2896cc973e966a35ecad556495
    reference_type: commit
    reference_id: 32efe29a00efab2896cc973e966a35ecad556495
  - url: https://github.com/xen-project/xen/tree/36812ae518975e2eb40ad14ff0c70dd0ab08bf82
    reference_type: commit
    reference_id: 36812ae518975e2eb40ad14ff0c70dd0ab08bf82
  - url: https://github.com/xen-project/xen/tree/3a7c46a94454aa48f6e247ed91773d96b4b70afb
    reference_type: commit
    reference_id: 3a7c46a94454aa48f6e247ed91773d96b4b70afb
  - url: https://github.com/xen-project/xen/tree/578d422af0b444a9e437dd0ceddf2049364f1a40
    reference_type: commit
    reference_id: 578d422af0b444a9e437dd0ceddf2049364f1a40
  - url: https://github.com/xen-project/xen/tree/7dc06ed1f2ab191ec03e892329be90ecdcd764c8
    reference_type: commit
    reference_id: 7dc06ed1f2ab191ec03e892329be90ecdcd764c8
  - url: https://github.com/xen-project/xen/tree/7f9978a2cc37aaffab2fb09593bc598c0712a69b
    reference_type: commit
    reference_id: 7f9978a2cc37aaffab2fb09593bc598c0712a69b
  - url: https://github.com/xen-project/xen/tree/9c2e71fe0611da9ed2ebbf2362a9bb05d42bf0c3
    reference_type: commit
    reference_id: 9c2e71fe0611da9ed2ebbf2362a9bb05d42bf0c3
  - url: https://github.com/xen-project/xen/tree/bce985745cde48a339954759677b77d3eeec41f3
    reference_type: commit
    reference_id: bce985745cde48a339954759677b77d3eeec41f3
  - url: https://github.com/xen-project/xen/tree/c17d49134aef23c8d017a64e5e36c626779bf863
    reference_type: commit
    reference_id: c17d49134aef23c8d017a64e5e36c626779bf863
  - url: https://github.com/xen-project/xen/tree/cc289061d93786aa5bd504c91b583e1abb55bbb4
    reference_type: commit
    reference_id: cc289061d93786aa5bd504c91b583e1abb55bbb4
  - url: https://github.com/xen-project/xen/tree/f6d00133643a524d2138c9e3f192bbde719050ba
    reference_type: commit
    reference_id: f6d00133643a524d2138c9e3f192bbde719050ba
