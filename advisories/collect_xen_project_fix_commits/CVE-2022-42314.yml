advisory_id: CVE-2022-42314
datasource_id: collect_xen_project_fix_commits/CVE-2022-42314
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  f859218309f09ec6d425e02b583e4494924304ad:tools/xenstore: limit max number of nodes accessed in a transaction

  Today a guest is free to access as many nodes in a single transaction
  as it wants. This can lead to unbounded memory consumption in Xenstore
  as there is the need to keep track of all nodes having been accessed
  during a transaction.

  In oxenstored the number of requests in a transaction is being limited
  via a quota maxrequests (default is 1024). As multiple accesses of a
  node are not problematic in C Xenstore, limit the number of accessed
  nodes.

  In order to let read_node() detect a quota error in case too many nodes
  are being accessed, check the return value of access_node() and return
  NULL in case an error has been seen. Introduce __must_check and add it
  to the access_node() prototype.

  This is part of XSA-326 / CVE-2022-42314.

  Suggested-by: Julien Grall <julien@xen.org>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 268369d8e322d227a74a899009c5748d7b0ea142)
  93a9c3a066193e21763c84e04fbe56902bcb5c07:tools/xenstore: limit max number of nodes accessed in a transaction

  Today a guest is free to access as many nodes in a single transaction
  as it wants. This can lead to unbounded memory consumption in Xenstore
  as there is the need to keep track of all nodes having been accessed
  during a transaction.

  In oxenstored the number of requests in a transaction is being limited
  via a quota maxrequests (default is 1024). As multiple accesses of a
  node are not problematic in C Xenstore, limit the number of accessed
  nodes.

  In order to let read_node() detect a quota error in case too many nodes
  are being accessed, check the return value of access_node() and return
  NULL in case an error has been seen. Introduce __must_check and add it
  to the access_node() prototype.

  This is part of XSA-326 / CVE-2022-42314.

  Suggested-by: Julien Grall <julien@xen.org>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 268369d8e322d227a74a899009c5748d7b0ea142)
  1035371fee5552b8cfe9819c4058a4c9e695ba5e:tools/xenstore: limit max number of nodes accessed in a transaction

  Today a guest is free to access as many nodes in a single transaction
  as it wants. This can lead to unbounded memory consumption in Xenstore
  as there is the need to keep track of all nodes having been accessed
  during a transaction.

  In oxenstored the number of requests in a transaction is being limited
  via a quota maxrequests (default is 1024). As multiple accesses of a
  node are not problematic in C Xenstore, limit the number of accessed
  nodes.

  In order to let read_node() detect a quota error in case too many nodes
  are being accessed, check the return value of access_node() and return
  NULL in case an error has been seen. Introduce __must_check and add it
  to the access_node() prototype.

  This is part of XSA-326 / CVE-2022-42314.

  Suggested-by: Julien Grall <julien@xen.org>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 268369d8e322d227a74a899009c5748d7b0ea142)
  7017cfefc455db535054ebc09124af8101746a4a:tools/xenstore: limit max number of nodes accessed in a transaction

  Today a guest is free to access as many nodes in a single transaction
  as it wants. This can lead to unbounded memory consumption in Xenstore
  as there is the need to keep track of all nodes having been accessed
  during a transaction.

  In oxenstored the number of requests in a transaction is being limited
  via a quota maxrequests (default is 1024). As multiple accesses of a
  node are not problematic in C Xenstore, limit the number of accessed
  nodes.

  In order to let read_node() detect a quota error in case too many nodes
  are being accessed, check the return value of access_node() and return
  NULL in case an error has been seen. Introduce __must_check and add it
  to the access_node() prototype.

  This is part of XSA-326 / CVE-2022-42314.

  Suggested-by: Julien Grall <julien@xen.org>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 268369d8e322d227a74a899009c5748d7b0ea142)
  268369d8e322d227a74a899009c5748d7b0ea142:tools/xenstore: limit max number of nodes accessed in a transaction

  Today a guest is free to access as many nodes in a single transaction
  as it wants. This can lead to unbounded memory consumption in Xenstore
  as there is the need to keep track of all nodes having been accessed
  during a transaction.

  In oxenstored the number of requests in a transaction is being limited
  via a quota maxrequests (default is 1024). As multiple accesses of a
  node are not problematic in C Xenstore, limit the number of accessed
  nodes.

  In order to let read_node() detect a quota error in case too many nodes
  are being accessed, check the return value of access_node() and return
  NULL in case an error has been seen. Introduce __must_check and add it
  to the access_node() prototype.

  This is part of XSA-326 / CVE-2022-42314.

  Suggested-by: Julien Grall <julien@xen.org>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 268369d8e322d227a74a899009c5748d7b0ea142
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1035371fee5552b8cfe9819c4058a4c9e695ba5e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f859218309f09ec6d425e02b583e4494924304ad
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 93a9c3a066193e21763c84e04fbe56902bcb5c07
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7017cfefc455db535054ebc09124af8101746a4a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/1035371fee5552b8cfe9819c4058a4c9e695ba5e
    reference_type: commit
    reference_id: 1035371fee5552b8cfe9819c4058a4c9e695ba5e
  - url: https://github.com/xen-project/xen/tree/268369d8e322d227a74a899009c5748d7b0ea142
    reference_type: commit
    reference_id: 268369d8e322d227a74a899009c5748d7b0ea142
  - url: https://github.com/xen-project/xen/tree/7017cfefc455db535054ebc09124af8101746a4a
    reference_type: commit
    reference_id: 7017cfefc455db535054ebc09124af8101746a4a
  - url: https://github.com/xen-project/xen/tree/93a9c3a066193e21763c84e04fbe56902bcb5c07
    reference_type: commit
    reference_id: 93a9c3a066193e21763c84e04fbe56902bcb5c07
  - url: https://github.com/xen-project/xen/tree/f859218309f09ec6d425e02b583e4494924304ad
    reference_type: commit
    reference_id: f859218309f09ec6d425e02b583e4494924304ad
