advisory_id: CVE-2022-23035
datasource_id: collect_xen_project_fix_commits/CVE-2022-23035
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  71e9d0c94dd710bf26adf115ee0a2dbee30bb8c1:passthrough/x86: stop pirq iteration immediately in case of error

  pt_pirq_iterate() will iterate in batch over all the PIRQs. The outer
  loop will bail out if 'rc' is non-zero but the inner loop will continue.

  This means 'rc' will get clobbered and we may miss any errors (such as
  -ERESTART in the case of the callback pci_clean_dpci_irq()).

  This is CVE-2022-23035 / XSA-395.

  Fixes: c24536b636f2 ("replace d->nr_pirqs sized arrays with radix tree")
  Fixes: f6dd295381f4 ("dpci: replace tasklet with softirq")
  Signed-off-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 9480a1a519cf016623f657dc544cb372a82b5708
  master date: 2022-01-25 13:27:02 +0100
  ce49a1d6d819f4587436b4ff73334d3676c1aab6:passthrough/x86: stop pirq iteration immediately in case of error

  pt_pirq_iterate() will iterate in batch over all the PIRQs. The outer
  loop will bail out if 'rc' is non-zero but the inner loop will continue.

  This means 'rc' will get clobbered and we may miss any errors (such as
  -ERESTART in the case of the callback pci_clean_dpci_irq()).

  This is CVE-2022-23035 / XSA-395.

  Fixes: c24536b636f2 ("replace d->nr_pirqs sized arrays with radix tree")
  Fixes: f6dd295381f4 ("dpci: replace tasklet with softirq")
  Signed-off-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 9480a1a519cf016623f657dc544cb372a82b5708
  master date: 2022-01-25 13:27:02 +0100
  5af939d96a6c7c5a0b4e00f7be3002333959e7e3:passthrough/x86: stop pirq iteration immediately in case of error

  pt_pirq_iterate() will iterate in batch over all the PIRQs. The outer
  loop will bail out if 'rc' is non-zero but the inner loop will continue.

  This means 'rc' will get clobbered and we may miss any errors (such as
  -ERESTART in the case of the callback pci_clean_dpci_irq()).

  This is CVE-2022-23035 / XSA-395.

  Fixes: c24536b636f2 ("replace d->nr_pirqs sized arrays with radix tree")
  Fixes: f6dd295381f4 ("dpci: replace tasklet with softirq")
  Signed-off-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 9480a1a519cf016623f657dc544cb372a82b5708
  master date: 2022-01-25 13:27:02 +0100
  13e7fe4c938f92933c6aa89e416e3085b13a22c7:passthrough/x86: stop pirq iteration immediately in case of error

  pt_pirq_iterate() will iterate in batch over all the PIRQs. The outer
  loop will bail out if 'rc' is non-zero but the inner loop will continue.

  This means 'rc' will get clobbered and we may miss any errors (such as
  -ERESTART in the case of the callback pci_clean_dpci_irq()).

  This is CVE-2022-23035 / XSA-395.

  Fixes: c24536b636f2 ("replace d->nr_pirqs sized arrays with radix tree")
  Fixes: f6dd295381f4 ("dpci: replace tasklet with softirq")
  Signed-off-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 9480a1a519cf016623f657dc544cb372a82b5708
  master date: 2022-01-25 13:27:02 +0100
  18d0f501596bd55412282aac3db1f0a349a68f50:passthrough/x86: stop pirq iteration immediately in case of error

  pt_pirq_iterate() will iterate in batch over all the PIRQs. The outer
  loop will bail out if 'rc' is non-zero but the inner loop will continue.

  This means 'rc' will get clobbered and we may miss any errors (such as
  -ERESTART in the case of the callback pci_clean_dpci_irq()).

  This is CVE-2022-23035 / XSA-395.

  Fixes: c24536b636f2 ("replace d->nr_pirqs sized arrays with radix tree")
  Fixes: f6dd295381f4 ("dpci: replace tasklet with softirq")
  Signed-off-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  master commit: 9480a1a519cf016623f657dc544cb372a82b5708
  master date: 2022-01-25 13:27:02 +0100
  9480a1a519cf016623f657dc544cb372a82b5708:passthrough/x86: stop pirq iteration immediately in case of error

  pt_pirq_iterate() will iterate in batch over all the PIRQs. The outer
  loop will bail out if 'rc' is non-zero but the inner loop will continue.

  This means 'rc' will get clobbered and we may miss any errors (such as
  -ERESTART in the case of the callback pci_clean_dpci_irq()).

  This is CVE-2022-23035 / XSA-395.

  Fixes: c24536b636f2 ("replace d->nr_pirqs sized arrays with radix tree")
  Fixes: f6dd295381f4 ("dpci: replace tasklet with softirq")
  Signed-off-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 13e7fe4c938f92933c6aa89e416e3085b13a22c7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 71e9d0c94dd710bf26adf115ee0a2dbee30bb8c1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5af939d96a6c7c5a0b4e00f7be3002333959e7e3
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9480a1a519cf016623f657dc544cb372a82b5708
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ce49a1d6d819f4587436b4ff73334d3676c1aab6
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 18d0f501596bd55412282aac3db1f0a349a68f50
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/13e7fe4c938f92933c6aa89e416e3085b13a22c7
    reference_type: commit
    reference_id: 13e7fe4c938f92933c6aa89e416e3085b13a22c7
  - url: https://github.com/xen-project/xen/tree/18d0f501596bd55412282aac3db1f0a349a68f50
    reference_type: commit
    reference_id: 18d0f501596bd55412282aac3db1f0a349a68f50
  - url: https://github.com/xen-project/xen/tree/5af939d96a6c7c5a0b4e00f7be3002333959e7e3
    reference_type: commit
    reference_id: 5af939d96a6c7c5a0b4e00f7be3002333959e7e3
  - url: https://github.com/xen-project/xen/tree/71e9d0c94dd710bf26adf115ee0a2dbee30bb8c1
    reference_type: commit
    reference_id: 71e9d0c94dd710bf26adf115ee0a2dbee30bb8c1
  - url: https://github.com/xen-project/xen/tree/9480a1a519cf016623f657dc544cb372a82b5708
    reference_type: commit
    reference_id: 9480a1a519cf016623f657dc544cb372a82b5708
  - url: https://github.com/xen-project/xen/tree/ce49a1d6d819f4587436b4ff73334d3676c1aab6
    reference_type: commit
    reference_id: ce49a1d6d819f4587436b4ff73334d3676c1aab6
