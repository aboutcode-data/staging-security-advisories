advisory_id: CVE-2025-58145
datasource_id: collect_xen_project_fix_commits/CVE-2025-58145
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  267fdd429fc3b0a71aaac3f3651ef9382a5a58f5:Arm: adjust locking in p2m_get_page_from_gfn()

  In order to safely acquire a reference for a foreign page mapping, the
  P2M lock needs to be held until we have the reference in hand (or
  getting one failed). Otherwise the page can change P2M type and
  ownership in between.

  This is CVE-2025-58145 / part of XSA-473.

  Fixes: 9486a8d07ba8 ("xen/arm: Handle remove foreign mapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  master commit: 2275bf83a1db579661b27fc4b310a7d92594dbc0
  master date: 2025-09-09 14:12:57 +0200
  c90cec6dfd8ed04577376efd2b929930451e78e9:Arm: adjust locking in p2m_get_page_from_gfn()

  In order to safely acquire a reference for a foreign page mapping, the
  P2M lock needs to be held until we have the reference in hand (or
  getting one failed). Otherwise the page can change P2M type and
  ownership in between.

  This is CVE-2025-58145 / part of XSA-473.

  Fixes: 9486a8d07ba8 ("xen/arm: Handle remove foreign mapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  master commit: 2275bf83a1db579661b27fc4b310a7d92594dbc0
  master date: 2025-09-09 14:12:57 +0200
  e9e054a161fb448172f29e2d08ad9a94cb13e787:Arm: adjust locking in p2m_get_page_from_gfn()

  In order to safely acquire a reference for a foreign page mapping, the
  P2M lock needs to be held until we have the reference in hand (or
  getting one failed). Otherwise the page can change P2M type and
  ownership in between.

  This is CVE-2025-58145 / part of XSA-473.

  Fixes: 9486a8d07ba8 ("xen/arm: Handle remove foreign mapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  master commit: 2275bf83a1db579661b27fc4b310a7d92594dbc0
  master date: 2025-09-09 14:12:57 +0200
  d7e55a41399ef1355e3df66270db7e682e7e1150:Arm: adjust locking in p2m_get_page_from_gfn()

  In order to safely acquire a reference for a foreign page mapping, the
  P2M lock needs to be held until we have the reference in hand (or
  getting one failed). Otherwise the page can change P2M type and
  ownership in between.

  This is CVE-2025-58145 / part of XSA-473.

  Fixes: 9486a8d07ba8 ("xen/arm: Handle remove foreign mapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  master commit: 2275bf83a1db579661b27fc4b310a7d92594dbc0
  master date: 2025-09-09 14:12:57 +0200
  2275bf83a1db579661b27fc4b310a7d92594dbc0:Arm: adjust locking in p2m_get_page_from_gfn()

  In order to safely acquire a reference for a foreign page mapping, the
  P2M lock needs to be held until we have the reference in hand (or
  getting one failed). Otherwise the page can change P2M type and
  ownership in between.

  This is CVE-2025-58145 / part of XSA-473.

  Fixes: 9486a8d07ba8 ("xen/arm: Handle remove foreign mapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 267fdd429fc3b0a71aaac3f3651ef9382a5a58f5
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e9e054a161fb448172f29e2d08ad9a94cb13e787
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c90cec6dfd8ed04577376efd2b929930451e78e9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2275bf83a1db579661b27fc4b310a7d92594dbc0
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d7e55a41399ef1355e3df66270db7e682e7e1150
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/2275bf83a1db579661b27fc4b310a7d92594dbc0
    reference_type: commit
    reference_id: 2275bf83a1db579661b27fc4b310a7d92594dbc0
  - url: https://github.com/xen-project/xen/tree/267fdd429fc3b0a71aaac3f3651ef9382a5a58f5
    reference_type: commit
    reference_id: 267fdd429fc3b0a71aaac3f3651ef9382a5a58f5
  - url: https://github.com/xen-project/xen/tree/c90cec6dfd8ed04577376efd2b929930451e78e9
    reference_type: commit
    reference_id: c90cec6dfd8ed04577376efd2b929930451e78e9
  - url: https://github.com/xen-project/xen/tree/d7e55a41399ef1355e3df66270db7e682e7e1150
    reference_type: commit
    reference_id: d7e55a41399ef1355e3df66270db7e682e7e1150
  - url: https://github.com/xen-project/xen/tree/e9e054a161fb448172f29e2d08ad9a94cb13e787
    reference_type: commit
    reference_id: e9e054a161fb448172f29e2d08ad9a94cb13e787
