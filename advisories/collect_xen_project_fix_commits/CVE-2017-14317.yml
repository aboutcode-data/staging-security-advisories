advisory_id: CVE-2017-14317
datasource_id: collect_xen_project_fix_commits/CVE-2017-14317
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  04b8c4c132842b554ddacee71d418a0ab2527ec4:tools/xenstore: dont unlink connection object twice

  A connection object of a domain with associated stubdom has two
  parents: the domain and the stubdom. When cleaning up the list of
  active domains in domain_cleanup() make sure not to unlink the
  connection twice from the same domain. This could happen when the
  domain and its stubdom are being destroyed at the same time leading
  to the domain loop being entered twice.

  Additionally don't use talloc_free() in this case as it will remove
  a random parent link, leading eventually to a memory leak. Use
  talloc_unlink() instead specifying the context from which the
  connection object should be removed.

  This is CVE-2017-14317 / XSA-233.

  Reported-by: Eric Chanudet <chanudete@ainfosec.com>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  master commit: 562a1c0f7ef3fbf3c122c3dfa4f2ad9dd51da9fe
  master date: 2017-09-12 14:44:56 +0200
  22b6dfab75c901cd70d382e1880941b02de7534f:tools/xenstore: dont unlink connection object twice

  A connection object of a domain with associated stubdom has two
  parents: the domain and the stubdom. When cleaning up the list of
  active domains in domain_cleanup() make sure not to unlink the
  connection twice from the same domain. This could happen when the
  domain and its stubdom are being destroyed at the same time leading
  to the domain loop being entered twice.

  Additionally don't use talloc_free() in this case as it will remove
  a random parent link, leading eventually to a memory leak. Use
  talloc_unlink() instead specifying the context from which the
  connection object should be removed.

  This is CVE-2017-14317 / XSA-233.

  Reported-by: Eric Chanudet <chanudete@ainfosec.com>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  master commit: 562a1c0f7ef3fbf3c122c3dfa4f2ad9dd51da9fe
  master date: 2017-09-12 14:44:56 +0200
  3331050a1ac28a7c60f6542469c239f74584b3dc:tools/xenstore: dont unlink connection object twice

  A connection object of a domain with associated stubdom has two
  parents: the domain and the stubdom. When cleaning up the list of
  active domains in domain_cleanup() make sure not to unlink the
  connection twice from the same domain. This could happen when the
  domain and its stubdom are being destroyed at the same time leading
  to the domain loop being entered twice.

  Additionally don't use talloc_free() in this case as it will remove
  a random parent link, leading eventually to a memory leak. Use
  talloc_unlink() instead specifying the context from which the
  connection object should be removed.

  This is CVE-2017-14317 / XSA-233.

  Reported-by: Eric Chanudet <chanudete@ainfosec.com>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  master commit: 562a1c0f7ef3fbf3c122c3dfa4f2ad9dd51da9fe
  master date: 2017-09-12 14:44:56 +0200
  4d7ccae75134a48e2e062f9f4f3587adb0df9496:tools/xenstore: dont unlink connection object twice

  A connection object of a domain with associated stubdom has two
  parents: the domain and the stubdom. When cleaning up the list of
  active domains in domain_cleanup() make sure not to unlink the
  connection twice from the same domain. This could happen when the
  domain and its stubdom are being destroyed at the same time leading
  to the domain loop being entered twice.

  Additionally don't use talloc_free() in this case as it will remove
  a random parent link, leading eventually to a memory leak. Use
  talloc_unlink() instead specifying the context from which the
  connection object should be removed.

  This is CVE-2017-14317 / XSA-233.

  Reported-by: Eric Chanudet <chanudete@ainfosec.com>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  master commit: 562a1c0f7ef3fbf3c122c3dfa4f2ad9dd51da9fe
  master date: 2017-09-12 14:44:56 +0200
  79775f57d399afbd238566f73700e1f3da31c034:tools/xenstore: dont unlink connection object twice

  A connection object of a domain with associated stubdom has two
  parents: the domain and the stubdom. When cleaning up the list of
  active domains in domain_cleanup() make sure not to unlink the
  connection twice from the same domain. This could happen when the
  domain and its stubdom are being destroyed at the same time leading
  to the domain loop being entered twice.

  Additionally don't use talloc_free() in this case as it will remove
  a random parent link, leading eventually to a memory leak. Use
  talloc_unlink() instead specifying the context from which the
  connection object should be removed.

  This is CVE-2017-14317 / XSA-233.

  Reported-by: Eric Chanudet <chanudete@ainfosec.com>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  master commit: 562a1c0f7ef3fbf3c122c3dfa4f2ad9dd51da9fe
  master date: 2017-09-12 14:44:56 +0200
  562a1c0f7ef3fbf3c122c3dfa4f2ad9dd51da9fe:tools/xenstore: dont unlink connection object twice

  A connection object of a domain with associated stubdom has two
  parents: the domain and the stubdom. When cleaning up the list of
  active domains in domain_cleanup() make sure not to unlink the
  connection twice from the same domain. This could happen when the
  domain and its stubdom are being destroyed at the same time leading
  to the domain loop being entered twice.

  Additionally don't use talloc_free() in this case as it will remove
  a random parent link, leading eventually to a memory leak. Use
  talloc_unlink() instead specifying the context from which the
  connection object should be removed.

  This is CVE-2017-14317 / XSA-233.

  Reported-by: Eric Chanudet <chanudete@ainfosec.com>
  Signed-off-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Ian Jackson <ian.jackson@eu.citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 79775f57d399afbd238566f73700e1f3da31c034
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3331050a1ac28a7c60f6542469c239f74584b3dc
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 22b6dfab75c901cd70d382e1880941b02de7534f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4d7ccae75134a48e2e062f9f4f3587adb0df9496
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 04b8c4c132842b554ddacee71d418a0ab2527ec4
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 562a1c0f7ef3fbf3c122c3dfa4f2ad9dd51da9fe
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/04b8c4c132842b554ddacee71d418a0ab2527ec4
    reference_type: commit
    reference_id: 04b8c4c132842b554ddacee71d418a0ab2527ec4
  - url: https://github.com/xen-project/xen/tree/22b6dfab75c901cd70d382e1880941b02de7534f
    reference_type: commit
    reference_id: 22b6dfab75c901cd70d382e1880941b02de7534f
  - url: https://github.com/xen-project/xen/tree/3331050a1ac28a7c60f6542469c239f74584b3dc
    reference_type: commit
    reference_id: 3331050a1ac28a7c60f6542469c239f74584b3dc
  - url: https://github.com/xen-project/xen/tree/4d7ccae75134a48e2e062f9f4f3587adb0df9496
    reference_type: commit
    reference_id: 4d7ccae75134a48e2e062f9f4f3587adb0df9496
  - url: https://github.com/xen-project/xen/tree/562a1c0f7ef3fbf3c122c3dfa4f2ad9dd51da9fe
    reference_type: commit
    reference_id: 562a1c0f7ef3fbf3c122c3dfa4f2ad9dd51da9fe
  - url: https://github.com/xen-project/xen/tree/79775f57d399afbd238566f73700e1f3da31c034
    reference_type: commit
    reference_id: 79775f57d399afbd238566f73700e1f3da31c034
