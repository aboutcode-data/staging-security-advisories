advisory_id: CVE-2014-8866
datasource_id: collect_xen_project_fix_commits/CVE-2014-8866
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  7d80d71da3369ddfed5ec4cb822194cfd0faf23e:x86: limit checks in hypercall_xlat_continuation() to actual arguments

  HVM/PVH guests can otherwise trigger the final BUG_ON() in that
  function by entering 64-bit mode, setting the high halves of affected
  registers to non-zero values, leaving 64-bit mode, and issuing a
  hypercall that might get preempted and hence become subject to
  continuation argument translation (HYPERVISOR_memory_op being the only
  one possible for HVM, PVH also having the option of using
  HYPERVISOR_mmuext_op). This issue got introduced when HVM code was
  switched to use compat_memory_op() - neither that nor
  hypercall_xlat_continuation() were originally intended to be used by
  other than PV guests (which can't enter 64-bit mode and hence have no
  way to alter the high halves of 64-bit registers).

  This is CVE-2014-8866 / XSA-111.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  5e687e7da367827344db3965b8a5f5f761a8431a:x86: limit checks in hypercall_xlat_continuation() to actual arguments

  HVM/PVH guests can otherwise trigger the final BUG_ON() in that
  function by entering 64-bit mode, setting the high halves of affected
  registers to non-zero values, leaving 64-bit mode, and issuing a
  hypercall that might get preempted and hence become subject to
  continuation argument translation (HYPERVISOR_memory_op being the only
  one possible for HVM, PVH also having the option of using
  HYPERVISOR_mmuext_op). This issue got introduced when HVM code was
  switched to use compat_memory_op() - neither that nor
  hypercall_xlat_continuation() were originally intended to be used by
  other than PV guests (which can't enter 64-bit mode and hence have no
  way to alter the high halves of 64-bit registers).

  This is CVE-2014-8866 / XSA-111.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  98c78711764082171b3fa189793c6db904f65ebc:x86: limit checks in hypercall_xlat_continuation() to actual arguments

  HVM/PVH guests can otherwise trigger the final BUG_ON() in that
  function by entering 64-bit mode, setting the high halves of affected
  registers to non-zero values, leaving 64-bit mode, and issuing a
  hypercall that might get preempted and hence become subject to
  continuation argument translation (HYPERVISOR_memory_op being the only
  one possible for HVM, PVH also having the option of using
  HYPERVISOR_mmuext_op). This issue got introduced when HVM code was
  switched to use compat_memory_op() - neither that nor
  hypercall_xlat_continuation() were originally intended to be used by
  other than PV guests (which can't enter 64-bit mode and hence have no
  way to alter the high halves of 64-bit registers).

  This is CVE-2014-8866 / XSA-111.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: 0ad715304b04739fd2fc9517ce8671d3947c7621
  master date: 2014-11-27 14:00:23 +0100
  0ad715304b04739fd2fc9517ce8671d3947c7621:x86: limit checks in hypercall_xlat_continuation() to actual arguments

  HVM/PVH guests can otherwise trigger the final BUG_ON() in that
  function by entering 64-bit mode, setting the high halves of affected
  registers to non-zero values, leaving 64-bit mode, and issuing a
  hypercall that might get preempted and hence become subject to
  continuation argument translation (HYPERVISOR_memory_op being the only
  one possible for HVM, PVH also having the option of using
  HYPERVISOR_mmuext_op). This issue got introduced when HVM code was
  switched to use compat_memory_op() - neither that nor
  hypercall_xlat_continuation() were originally intended to be used by
  other than PV guests (which can't enter 64-bit mode and hence have no
  way to alter the high halves of 64-bit registers).

  This is CVE-2014-8866 / XSA-111.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 98c78711764082171b3fa189793c6db904f65ebc
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5e687e7da367827344db3965b8a5f5f761a8431a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7d80d71da3369ddfed5ec4cb822194cfd0faf23e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0ad715304b04739fd2fc9517ce8671d3947c7621
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/0ad715304b04739fd2fc9517ce8671d3947c7621
    reference_type: commit
    reference_id: 0ad715304b04739fd2fc9517ce8671d3947c7621
  - url: https://github.com/xen-project/xen/tree/5e687e7da367827344db3965b8a5f5f761a8431a
    reference_type: commit
    reference_id: 5e687e7da367827344db3965b8a5f5f761a8431a
  - url: https://github.com/xen-project/xen/tree/7d80d71da3369ddfed5ec4cb822194cfd0faf23e
    reference_type: commit
    reference_id: 7d80d71da3369ddfed5ec4cb822194cfd0faf23e
  - url: https://github.com/xen-project/xen/tree/98c78711764082171b3fa189793c6db904f65ebc
    reference_type: commit
    reference_id: 98c78711764082171b3fa189793c6db904f65ebc
