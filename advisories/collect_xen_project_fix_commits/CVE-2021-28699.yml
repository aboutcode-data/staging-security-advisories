advisory_id: CVE-2021-28699
datasource_id: collect_xen_project_fix_commits/CVE-2021-28699
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  ec4654ce64d87f14567008cfb42568fd434f1bed:gnttab: fix array capacity check in gnttab_get_status_frames()

  The number of grant frames is of no interest here; converting the passed
  in op.nr_frames this way means we allow for 8 times as many GFNs to be
  written as actually fit in the array. We would corrupt xlat areas of
  higher vCPU-s (after having faulted many times while trying to write to
  the guard pages between any two areas) for 32-bit PV guests. For HVM
  guests we'd simply crash as soon as we hit the first guard page, as
  accesses to the xlat area are simply memcpy() there.

  This is CVE-2021-28699 / XSA-382.

  Fixes: 18b1be5e324b ("gnttab: make resource limits per domain")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  master commit: ec820035b875cdbedce5e73f481ce65963ede9ed
  master date: 2021-08-25 14:19:09 +0200
  9e39b7f71ac79eef0cdff3fa38e6fd9402ecdda7:gnttab: fix array capacity check in gnttab_get_status_frames()

  The number of grant frames is of no interest here; converting the passed
  in op.nr_frames this way means we allow for 8 times as many GFNs to be
  written as actually fit in the array. We would corrupt xlat areas of
  higher vCPU-s (after having faulted many times while trying to write to
  the guard pages between any two areas) for 32-bit PV guests. For HVM
  guests we'd simply crash as soon as we hit the first guard page, as
  accesses to the xlat area are simply memcpy() there.

  This is CVE-2021-28699 / XSA-382.

  Fixes: 18b1be5e324b ("gnttab: make resource limits per domain")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  master commit: ec820035b875cdbedce5e73f481ce65963ede9ed
  master date: 2021-08-25 14:19:09 +0200
  985b3e50cda925fb2755b49b3c4a1c7a339d8ae4:gnttab: fix array capacity check in gnttab_get_status_frames()

  The number of grant frames is of no interest here; converting the passed
  in op.nr_frames this way means we allow for 8 times as many GFNs to be
  written as actually fit in the array. We would corrupt xlat areas of
  higher vCPU-s (after having faulted many times while trying to write to
  the guard pages between any two areas) for 32-bit PV guests. For HVM
  guests we'd simply crash as soon as we hit the first guard page, as
  accesses to the xlat area are simply memcpy() there.

  This is CVE-2021-28699 / XSA-382.

  Fixes: 18b1be5e324b ("gnttab: make resource limits per domain")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  master commit: ec820035b875cdbedce5e73f481ce65963ede9ed
  master date: 2021-08-25 14:19:09 +0200
  66f5e867c6e3d400af354ab72e924fa7b3ada733:gnttab: fix array capacity check in gnttab_get_status_frames()

  The number of grant frames is of no interest here; converting the passed
  in op.nr_frames this way means we allow for 8 times as many GFNs to be
  written as actually fit in the array. We would corrupt xlat areas of
  higher vCPU-s (after having faulted many times while trying to write to
  the guard pages between any two areas) for 32-bit PV guests. For HVM
  guests we'd simply crash as soon as we hit the first guard page, as
  accesses to the xlat area are simply memcpy() there.

  This is CVE-2021-28699 / XSA-382.

  Fixes: 18b1be5e324b ("gnttab: make resource limits per domain")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  master commit: ec820035b875cdbedce5e73f481ce65963ede9ed
  master date: 2021-08-25 14:19:09 +0200
  8a8b16c44e3e4cae097224511b72dfd7b059152b:gnttab: fix array capacity check in gnttab_get_status_frames()

  The number of grant frames is of no interest here; converting the passed
  in op.nr_frames this way means we allow for 8 times as many GFNs to be
  written as actually fit in the array. We would corrupt xlat areas of
  higher vCPU-s (after having faulted many times while trying to write to
  the guard pages between any two areas) for 32-bit PV guests. For HVM
  guests we'd simply crash as soon as we hit the first guard page, as
  accesses to the xlat area are simply memcpy() there.

  This is CVE-2021-28699 / XSA-382.

  Fixes: 18b1be5e324b ("gnttab: make resource limits per domain")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  master commit: ec820035b875cdbedce5e73f481ce65963ede9ed
  master date: 2021-08-25 14:19:09 +0200
  ec820035b875cdbedce5e73f481ce65963ede9ed:gnttab: fix array capacity check in gnttab_get_status_frames()

  The number of grant frames is of no interest here; converting the passed
  in op.nr_frames this way means we allow for 8 times as many GFNs to be
  written as actually fit in the array. We would corrupt xlat areas of
  higher vCPU-s (after having faulted many times while trying to write to
  the guard pages between any two areas) for 32-bit PV guests. For HVM
  guests we'd simply crash as soon as we hit the first guard page, as
  accesses to the xlat area are simply memcpy() there.

  This is CVE-2021-28699 / XSA-382.

  Fixes: 18b1be5e324b ("gnttab: make resource limits per domain")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ec4654ce64d87f14567008cfb42568fd434f1bed
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 985b3e50cda925fb2755b49b3c4a1c7a339d8ae4
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9e39b7f71ac79eef0cdff3fa38e6fd9402ecdda7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ec820035b875cdbedce5e73f481ce65963ede9ed
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 66f5e867c6e3d400af354ab72e924fa7b3ada733
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8a8b16c44e3e4cae097224511b72dfd7b059152b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/66f5e867c6e3d400af354ab72e924fa7b3ada733
    reference_type: commit
    reference_id: 66f5e867c6e3d400af354ab72e924fa7b3ada733
  - url: https://github.com/xen-project/xen/tree/8a8b16c44e3e4cae097224511b72dfd7b059152b
    reference_type: commit
    reference_id: 8a8b16c44e3e4cae097224511b72dfd7b059152b
  - url: https://github.com/xen-project/xen/tree/985b3e50cda925fb2755b49b3c4a1c7a339d8ae4
    reference_type: commit
    reference_id: 985b3e50cda925fb2755b49b3c4a1c7a339d8ae4
  - url: https://github.com/xen-project/xen/tree/9e39b7f71ac79eef0cdff3fa38e6fd9402ecdda7
    reference_type: commit
    reference_id: 9e39b7f71ac79eef0cdff3fa38e6fd9402ecdda7
  - url: https://github.com/xen-project/xen/tree/ec4654ce64d87f14567008cfb42568fd434f1bed
    reference_type: commit
    reference_id: ec4654ce64d87f14567008cfb42568fd434f1bed
  - url: https://github.com/xen-project/xen/tree/ec820035b875cdbedce5e73f481ce65963ede9ed
    reference_type: commit
    reference_id: ec820035b875cdbedce5e73f481ce65963ede9ed
