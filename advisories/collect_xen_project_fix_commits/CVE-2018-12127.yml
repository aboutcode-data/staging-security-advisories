advisory_id: CVE-2018-12127
datasource_id: collect_xen_project_fix_commits/CVE-2018-12127
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  b205b6969f86d1f25e152ed0880cd3ee189b9358:x86/spec-ctrl: Introduce options to control VERW flushing

  The Microarchitectural Data Sampling vulnerability is split into categories
  with subtly different properties:

   MLPDS - Microarchitectural Load Port Data Sampling
   MSBDS - Microarchitectural Store Buffer Data Sampling
   MFBDS - Microarchitectural Fill Buffer Data Sampling
   MDSUM - Microarchitectural Data Sampling Uncacheable Memory

  MDSUM is a special case of the other three, and isn't distinguished further.

  These issues pertain to three microarchitectural buffers.  The Load Ports, the
  Store Buffers and the Fill Buffers.  Each of these structures are flushed by
  the new enhanced VERW functionality, but the conditions under which flushing
  is necessary vary.

  For this concise overview of the issues and default logic, the abbreviations
  SP (Store Port), FB (Fill Buffer), LP (Load Port) and HT (Hyperthreading) are
  used for brevity:

   * Vulnerable hardware is divided into two categories - parts which suffer
     from SP only, and parts with any other combination of vulnerabilities.

   * SP only has an HT interaction when the thread goes idle, due to the static
     partitioning of resources.  LP and FB have HT interactions at all points,
     due to the competitive sharing of resources.  All issues potentially leak
     data across the return-to-guest transition.

   * The microcode which implements VERW flushing also extends MSR_FLUSH_CMD, so
     we don't need to do both on the HVM return-to-guest path.  However, the
     Knights range of processors are immune to L1TF (therefore have no
     MSR_FLUSH_CMD), but are vulnerable to MDS, so do require VERW on the HVM
     path.

  Note that we deliberately support mds=1 even without MD_CLEAR in case the
  microcode has been updated but the feature bit not exposed.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3c04c258ab40405a74e194d9889a4cbc7abe94b4)
  8e7450f070927f8397c32fa4ec60cf58f876e984:x86/spec-ctrl: Infrastructure to use VERW to flush pipeline buffers

  Three synthetic features are introduced, as we need individual control of
  each, depending on circumstances.  A later change will enable them at
  appropriate points.

  The verw_sel field doesn't strictly need to live in struct cpu_info.  It lives
  there because there is a convenient hole it can fill, and it reduces the
  complexity of the SPEC_CTRL_EXIT_TO_{PV,HVM} assembly by avoiding the need for
  any temporary stack maintenance.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 548a932ac786d6bf3584e4b54f2ab993e1117710)
  e69793d6ba265bb52c0cdeec609c79c9efe5ad94:x86/spec-ctrl: CPUID/MSR definitions for Microarchitectural Data Sampling

  The MD_CLEAR feature can be automatically offered to guests.  No
  infrastructure is needed in Xen to support the guest making use of it.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit d4f6116c080dc013cd1204c4d8ceb95e5f278689)
  752fb21a2950679440d9e30887139ee7b7292fd9:x86/spec-ctrl: Introduce options to control VERW flushing

  The Microarchitectural Data Sampling vulnerability is split into categories
  with subtly different properties:

   MLPDS - Microarchitectural Load Port Data Sampling
   MSBDS - Microarchitectural Store Buffer Data Sampling
   MFBDS - Microarchitectural Fill Buffer Data Sampling
   MDSUM - Microarchitectural Data Sampling Uncacheable Memory

  MDSUM is a special case of the other three, and isn't distinguished further.

  These issues pertain to three microarchitectural buffers.  The Load Ports, the
  Store Buffers and the Fill Buffers.  Each of these structures are flushed by
  the new enhanced VERW functionality, but the conditions under which flushing
  is necessary vary.

  For this concise overview of the issues and default logic, the abbreviations
  SP (Store Port), FB (Fill Buffer), LP (Load Port) and HT (Hyperthreading) are
  used for brevity:

   * Vulnerable hardware is divided into two categories - parts which suffer
     from SP only, and parts with any other combination of vulnerabilities.

   * SP only has an HT interaction when the thread goes idle, due to the static
     partitioning of resources.  LP and FB have HT interactions at all points,
     due to the competitive sharing of resources.  All issues potentially leak
     data across the return-to-guest transition.

   * The microcode which implements VERW flushing also extends MSR_FLUSH_CMD, so
     we don't need to do both on the HVM return-to-guest path.  However, some
     parts are not vulnerable to L1TF (therefore have no MSR_FLUSH_CMD), but are
     vulnerable to MDS, so do require VERW on the HVM path.

  Note that we deliberately support mds=1 even without MD_CLEAR in case the
  microcode has been updated but the feature bit not exposed.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3c04c258ab40405a74e194d9889a4cbc7abe94b4)
  a95a1035f4e8ca5a24b33d72d680d50fff246500:x86/spec-ctrl: Infrastructure to use VERW to flush pipeline buffers

  Three synthetic features are introduced, as we need individual control of
  each, depending on circumstances.  A later change will enable them at
  appropriate points.

  The verw_sel field doesn't strictly need to live in struct cpu_info.  It lives
  there because there is a convenient hole it can fill, and it reduces the
  complexity of the SPEC_CTRL_EXIT_TO_{PV,HVM} assembly by avoiding the need for
  any temporary stack maintenance.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 548a932ac786d6bf3584e4b54f2ab993e1117710)
  3dcb199263c50943c258ec16f99c73e2ce61c254:x86/spec-ctrl: CPUID/MSR definitions for Microarchitectural Data Sampling

  The MD_CLEAR feature can be automatically offered to guests.  No
  infrastructure is needed in Xen to support the guest making use of it.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit d4f6116c080dc013cd1204c4d8ceb95e5f278689)
  9b6f1c090ab78148f6c15a669737f4b9da0b9ed7:x86/spec-ctrl: Introduce options to control VERW flushing

  The Microarchitectural Data Sampling vulnerability is split into categories
  with subtly different properties:

   MLPDS - Microarchitectural Load Port Data Sampling
   MSBDS - Microarchitectural Store Buffer Data Sampling
   MFBDS - Microarchitectural Fill Buffer Data Sampling
   MDSUM - Microarchitectural Data Sampling Uncacheable Memory

  MDSUM is a special case of the other three, and isn't distinguished further.

  These issues pertain to three microarchitectural buffers.  The Load Ports, the
  Store Buffers and the Fill Buffers.  Each of these structures are flushed by
  the new enhanced VERW functionality, but the conditions under which flushing
  is necessary vary.

  For this concise overview of the issues and default logic, the abbreviations
  SP (Store Port), FB (Fill Buffer), LP (Load Port) and HT (Hyperthreading) are
  used for brevity:

   * Vulnerable hardware is divided into two categories - parts which suffer
     from SP only, and parts with any other combination of vulnerabilities.

   * SP only has an HT interaction when the thread goes idle, due to the static
     partitioning of resources.  LP and FB have HT interactions at all points,
     due to the competitive sharing of resources.  All issues potentially leak
     data across the return-to-guest transition.

   * The microcode which implements VERW flushing also extends MSR_FLUSH_CMD, so
     we don't need to do both on the HVM return-to-guest path.  However, some
     parts are not vulnerable to L1TF (therefore have no MSR_FLUSH_CMD), but are
     vulnerable to MDS, so do require VERW on the HVM path.

  Note that we deliberately support mds=1 even without MD_CLEAR in case the
  microcode has been updated but the feature bit not exposed.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3c04c258ab40405a74e194d9889a4cbc7abe94b4)
  0c4bbad7e14446a9cfc243a717bf1475fcdd3a37:x86/spec-ctrl: Infrastructure to use VERW to flush pipeline buffers

  Three synthetic features are introduced, as we need individual control of
  each, depending on circumstances.  A later change will enable them at
  appropriate points.

  The verw_sel field doesn't strictly need to live in struct cpu_info.  It lives
  there because there is a convenient hole it can fill, and it reduces the
  complexity of the SPEC_CTRL_EXIT_TO_{PV,HVM} assembly by avoiding the need for
  any temporary stack maintenance.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 548a932ac786d6bf3584e4b54f2ab993e1117710)
  917d8d34a6d313ae2cbc52683ab7f729a5fe8dc7:x86/spec-ctrl: CPUID/MSR definitions for Microarchitectural Data Sampling

  The MD_CLEAR feature can be automatically offered to guests.  No
  infrastructure is needed in Xen to support the guest making use of it.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit d4f6116c080dc013cd1204c4d8ceb95e5f278689)
  ab261f5ac491a0a4d65a641fc7da29b810ec0fb2:x86/spec-ctrl: Introduce options to control VERW flushing

  The Microarchitectural Data Sampling vulnerability is split into categories
  with subtly different properties:

   MLPDS - Microarchitectural Load Port Data Sampling
   MSBDS - Microarchitectural Store Buffer Data Sampling
   MFBDS - Microarchitectural Fill Buffer Data Sampling
   MDSUM - Microarchitectural Data Sampling Uncacheable Memory

  MDSUM is a special case of the other three, and isn't distinguished further.

  These issues pertain to three microarchitectural buffers.  The Load Ports, the
  Store Buffers and the Fill Buffers.  Each of these structures are flushed by
  the new enhanced VERW functionality, but the conditions under which flushing
  is necessary vary.

  For this concise overview of the issues and default logic, the abbreviations
  SP (Store Port), FB (Fill Buffer), LP (Load Port) and HT (Hyperthreading) are
  used for brevity:

   * Vulnerable hardware is divided into two categories - parts which suffer
     from SP only, and parts with any other combination of vulnerabilities.

   * SP only has an HT interaction when the thread goes idle, due to the static
     partitioning of resources.  LP and FB have HT interactions at all points,
     due to the competitive sharing of resources.  All issues potentially leak
     data across the return-to-guest transition.

   * The microcode which implements VERW flushing also extends MSR_FLUSH_CMD, so
     we don't need to do both on the HVM return-to-guest path.  However, some
     parts are not vulnerable to L1TF (therefore have no MSR_FLUSH_CMD), but are
     vulnerable to MDS, so do require VERW on the HVM path.

  Note that we deliberately support mds=1 even without MD_CLEAR in case the
  microcode has been updated but the feature bit not exposed.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3c04c258ab40405a74e194d9889a4cbc7abe94b4)
  71f4a763b6818a8b88b7b2635420216a97468388:x86/spec-ctrl: Infrastructure to use VERW to flush pipeline buffers

  Three synthetic features are introduced, as we need individual control of
  each, depending on circumstances.  A later change will enable them at
  appropriate points.

  The verw_sel field doesn't strictly need to live in struct cpu_info.  It lives
  there because there is a convenient hole it can fill, and it reduces the
  complexity of the SPEC_CTRL_EXIT_TO_{PV,HVM} assembly by avoiding the need for
  any temporary stack maintenance.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 548a932ac786d6bf3584e4b54f2ab993e1117710)
  b32dde342c0a2d0bf97b2ff81c001714f64eb3f0:x86/spec-ctrl: CPUID/MSR definitions for Microarchitectural Data Sampling

  The MD_CLEAR feature can be automatically offered to guests.  No
  infrastructure is needed in Xen to support the guest making use of it.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit d4f6116c080dc013cd1204c4d8ceb95e5f278689)
  a6e07495c17158a01884a251b43c824926c60803:x86/spec-ctrl: Introduce options to control VERW flushing

  The Microarchitectural Data Sampling vulnerability is split into categories
  with subtly different properties:

   MLPDS - Microarchitectural Load Port Data Sampling
   MSBDS - Microarchitectural Store Buffer Data Sampling
   MFBDS - Microarchitectural Fill Buffer Data Sampling
   MDSUM - Microarchitectural Data Sampling Uncacheable Memory

  MDSUM is a special case of the other three, and isn't distinguished further.

  These issues pertain to three microarchitectural buffers.  The Load Ports, the
  Store Buffers and the Fill Buffers.  Each of these structures are flushed by
  the new enhanced VERW functionality, but the conditions under which flushing
  is necessary vary.

  For this concise overview of the issues and default logic, the abbreviations
  SP (Store Port), FB (Fill Buffer), LP (Load Port) and HT (Hyperthreading) are
  used for brevity:

   * Vulnerable hardware is divided into two categories - parts which suffer
     from SP only, and parts with any other combination of vulnerabilities.

   * SP only has an HT interaction when the thread goes idle, due to the static
     partitioning of resources.  LP and FB have HT interactions at all points,
     due to the competitive sharing of resources.  All issues potentially leak
     data across the return-to-guest transition.

   * The microcode which implements VERW flushing also extends MSR_FLUSH_CMD, so
     we don't need to do both on the HVM return-to-guest path.  However, some
     parts are not vulnerable to L1TF (therefore have no MSR_FLUSH_CMD), but are
     vulnerable to MDS, so do require VERW on the HVM path.

  Note that we deliberately support mds=1 even without MD_CLEAR in case the
  microcode has been updated but the feature bit not exposed.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3c04c258ab40405a74e194d9889a4cbc7abe94b4)
  bd03b27b9ac783e7a8fe473cff16d8a8d9a9ff81:x86/spec-ctrl: Infrastructure to use VERW to flush pipeline buffers

  Three synthetic features are introduced, as we need individual control of
  each, depending on circumstances.  A later change will enable them at
  appropriate points.

  The verw_sel field doesn't strictly need to live in struct cpu_info.  It lives
  there because there is a convenient hole it can fill, and it reduces the
  complexity of the SPEC_CTRL_EXIT_TO_{PV,HVM} assembly by avoiding the need for
  any temporary stack maintenance.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 548a932ac786d6bf3584e4b54f2ab993e1117710)
  b09886e3c9a40c6339e08e10a30e902e87f7d2ac:x86/spec-ctrl: CPUID/MSR definitions for Microarchitectural Data Sampling

  The MD_CLEAR feature can be automatically offered to guests.  No
  infrastructure is needed in Xen to support the guest making use of it.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit d4f6116c080dc013cd1204c4d8ceb95e5f278689)
  714207b3fae7498831a0df338e6a1fbfeea594a7:x86/spec-ctrl: Introduce options to control VERW flushing

  The Microarchitectural Data Sampling vulnerability is split into categories
  with subtly different properties:

   MLPDS - Microarchitectural Load Port Data Sampling
   MSBDS - Microarchitectural Store Buffer Data Sampling
   MFBDS - Microarchitectural Fill Buffer Data Sampling
   MDSUM - Microarchitectural Data Sampling Uncacheable Memory

  MDSUM is a special case of the other three, and isn't distinguished further.

  These issues pertain to three microarchitectural buffers.  The Load Ports, the
  Store Buffers and the Fill Buffers.  Each of these structures are flushed by
  the new enhanced VERW functionality, but the conditions under which flushing
  is necessary vary.

  For this concise overview of the issues and default logic, the abbreviations
  SP (Store Port), FB (Fill Buffer), LP (Load Port) and HT (Hyperthreading) are
  used for brevity:

   * Vulnerable hardware is divided into two categories - parts which suffer
     from SP only, and parts with any other combination of vulnerabilities.

   * SP only has an HT interaction when the thread goes idle, due to the static
     partitioning of resources.  LP and FB have HT interactions at all points,
     due to the competitive sharing of resources.  All issues potentially leak
     data across the return-to-guest transition.

   * The microcode which implements VERW flushing also extends MSR_FLUSH_CMD, so
     we don't need to do both on the HVM return-to-guest path.  However, some
     parts are not vulnerable to L1TF (therefore have no MSR_FLUSH_CMD), but are
     vulnerable to MDS, so do require VERW on the HVM path.

  Note that we deliberately support mds=1 even without MD_CLEAR in case the
  microcode has been updated but the feature bit not exposed.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3c04c258ab40405a74e194d9889a4cbc7abe94b4)
  45d570e30136117e788ded9fe0971ae3b1bed4b8:x86/spec-ctrl: Infrastructure to use VERW to flush pipeline buffers

  Three synthetic features are introduced, as we need individual control of
  each, depending on circumstances.  A later change will enable them at
  appropriate points.

  The verw_sel field doesn't strictly need to live in struct cpu_info.  It lives
  there because there is a convenient hole it can fill, and it reduces the
  complexity of the SPEC_CTRL_EXIT_TO_{PV,HVM} assembly by avoiding the need for
  any temporary stack maintenance.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 548a932ac786d6bf3584e4b54f2ab993e1117710)
  0a317c5162b98b287ad6bf212a754ca4614d7b50:x86/spec-ctrl: CPUID/MSR definitions for Microarchitectural Data Sampling

  The MD_CLEAR feature can be automatically offered to guests.  No
  infrastructure is needed in Xen to support the guest making use of it.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit d4f6116c080dc013cd1204c4d8ceb95e5f278689)
  3c04c258ab40405a74e194d9889a4cbc7abe94b4:x86/spec-ctrl: Introduce options to control VERW flushing

  The Microarchitectural Data Sampling vulnerability is split into categories
  with subtly different properties:

   MLPDS - Microarchitectural Load Port Data Sampling
   MSBDS - Microarchitectural Store Buffer Data Sampling
   MFBDS - Microarchitectural Fill Buffer Data Sampling
   MDSUM - Microarchitectural Data Sampling Uncacheable Memory

  MDSUM is a special case of the other three, and isn't distinguished further.

  These issues pertain to three microarchitectural buffers.  The Load Ports, the
  Store Buffers and the Fill Buffers.  Each of these structures are flushed by
  the new enhanced VERW functionality, but the conditions under which flushing
  is necessary vary.

  For this concise overview of the issues and default logic, the abbreviations
  SP (Store Port), FB (Fill Buffer), LP (Load Port) and HT (Hyperthreading) are
  used for brevity:

   * Vulnerable hardware is divided into two categories - parts which suffer
     from SP only, and parts with any other combination of vulnerabilities.

   * SP only has an HT interaction when the thread goes idle, due to the static
     partitioning of resources.  LP and FB have HT interactions at all points,
     due to the competitive sharing of resources.  All issues potentially leak
     data across the return-to-guest transition.

   * The microcode which implements VERW flushing also extends MSR_FLUSH_CMD, so
     we don't need to do both on the HVM return-to-guest path.  However, some
     parts are not vulnerable to L1TF (therefore have no MSR_FLUSH_CMD), but are
     vulnerable to MDS, so do require VERW on the HVM path.

  Note that we deliberately support mds=1 even without MD_CLEAR in case the
  microcode has been updated but the feature bit not exposed.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  548a932ac786d6bf3584e4b54f2ab993e1117710:x86/spec-ctrl: Infrastructure to use VERW to flush pipeline buffers

  Three synthetic features are introduced, as we need individual control of
  each, depending on circumstances.  A later change will enable them at
  appropriate points.

  The verw_sel field doesn't strictly need to live in struct cpu_info.  It lives
  there because there is a convenient hole it can fill, and it reduces the
  complexity of the SPEC_CTRL_EXIT_TO_{PV,HVM} assembly by avoiding the need for
  any temporary stack maintenance.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  d4f6116c080dc013cd1204c4d8ceb95e5f278689:x86/spec-ctrl: CPUID/MSR definitions for Microarchitectural Data Sampling

  The MD_CLEAR feature can be automatically offered to guests.  No
  infrastructure is needed in Xen to support the guest making use of it.

  This is part of XSA-297, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3c04c258ab40405a74e194d9889a4cbc7abe94b4
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 71f4a763b6818a8b88b7b2635420216a97468388
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ab261f5ac491a0a4d65a641fc7da29b810ec0fb2
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b32dde342c0a2d0bf97b2ff81c001714f64eb3f0
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 548a932ac786d6bf3584e4b54f2ab993e1117710
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d4f6116c080dc013cd1204c4d8ceb95e5f278689
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8e7450f070927f8397c32fa4ec60cf58f876e984
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0c4bbad7e14446a9cfc243a717bf1475fcdd3a37
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a6e07495c17158a01884a251b43c824926c60803
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b205b6969f86d1f25e152ed0880cd3ee189b9358
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3dcb199263c50943c258ec16f99c73e2ce61c254
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 45d570e30136117e788ded9fe0971ae3b1bed4b8
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a95a1035f4e8ca5a24b33d72d680d50fff246500
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: bd03b27b9ac783e7a8fe473cff16d8a8d9a9ff81
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 714207b3fae7498831a0df338e6a1fbfeea594a7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e69793d6ba265bb52c0cdeec609c79c9efe5ad94
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0a317c5162b98b287ad6bf212a754ca4614d7b50
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 917d8d34a6d313ae2cbc52683ab7f729a5fe8dc7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 752fb21a2950679440d9e30887139ee7b7292fd9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9b6f1c090ab78148f6c15a669737f4b9da0b9ed7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b09886e3c9a40c6339e08e10a30e902e87f7d2ac
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/0a317c5162b98b287ad6bf212a754ca4614d7b50
    reference_type: commit
    reference_id: 0a317c5162b98b287ad6bf212a754ca4614d7b50
  - url: https://github.com/xen-project/xen/tree/0c4bbad7e14446a9cfc243a717bf1475fcdd3a37
    reference_type: commit
    reference_id: 0c4bbad7e14446a9cfc243a717bf1475fcdd3a37
  - url: https://github.com/xen-project/xen/tree/3c04c258ab40405a74e194d9889a4cbc7abe94b4
    reference_type: commit
    reference_id: 3c04c258ab40405a74e194d9889a4cbc7abe94b4
  - url: https://github.com/xen-project/xen/tree/3dcb199263c50943c258ec16f99c73e2ce61c254
    reference_type: commit
    reference_id: 3dcb199263c50943c258ec16f99c73e2ce61c254
  - url: https://github.com/xen-project/xen/tree/45d570e30136117e788ded9fe0971ae3b1bed4b8
    reference_type: commit
    reference_id: 45d570e30136117e788ded9fe0971ae3b1bed4b8
  - url: https://github.com/xen-project/xen/tree/548a932ac786d6bf3584e4b54f2ab993e1117710
    reference_type: commit
    reference_id: 548a932ac786d6bf3584e4b54f2ab993e1117710
  - url: https://github.com/xen-project/xen/tree/714207b3fae7498831a0df338e6a1fbfeea594a7
    reference_type: commit
    reference_id: 714207b3fae7498831a0df338e6a1fbfeea594a7
  - url: https://github.com/xen-project/xen/tree/71f4a763b6818a8b88b7b2635420216a97468388
    reference_type: commit
    reference_id: 71f4a763b6818a8b88b7b2635420216a97468388
  - url: https://github.com/xen-project/xen/tree/752fb21a2950679440d9e30887139ee7b7292fd9
    reference_type: commit
    reference_id: 752fb21a2950679440d9e30887139ee7b7292fd9
  - url: https://github.com/xen-project/xen/tree/8e7450f070927f8397c32fa4ec60cf58f876e984
    reference_type: commit
    reference_id: 8e7450f070927f8397c32fa4ec60cf58f876e984
  - url: https://github.com/xen-project/xen/tree/917d8d34a6d313ae2cbc52683ab7f729a5fe8dc7
    reference_type: commit
    reference_id: 917d8d34a6d313ae2cbc52683ab7f729a5fe8dc7
  - url: https://github.com/xen-project/xen/tree/9b6f1c090ab78148f6c15a669737f4b9da0b9ed7
    reference_type: commit
    reference_id: 9b6f1c090ab78148f6c15a669737f4b9da0b9ed7
  - url: https://github.com/xen-project/xen/tree/a6e07495c17158a01884a251b43c824926c60803
    reference_type: commit
    reference_id: a6e07495c17158a01884a251b43c824926c60803
  - url: https://github.com/xen-project/xen/tree/a95a1035f4e8ca5a24b33d72d680d50fff246500
    reference_type: commit
    reference_id: a95a1035f4e8ca5a24b33d72d680d50fff246500
  - url: https://github.com/xen-project/xen/tree/ab261f5ac491a0a4d65a641fc7da29b810ec0fb2
    reference_type: commit
    reference_id: ab261f5ac491a0a4d65a641fc7da29b810ec0fb2
  - url: https://github.com/xen-project/xen/tree/b09886e3c9a40c6339e08e10a30e902e87f7d2ac
    reference_type: commit
    reference_id: b09886e3c9a40c6339e08e10a30e902e87f7d2ac
  - url: https://github.com/xen-project/xen/tree/b205b6969f86d1f25e152ed0880cd3ee189b9358
    reference_type: commit
    reference_id: b205b6969f86d1f25e152ed0880cd3ee189b9358
  - url: https://github.com/xen-project/xen/tree/b32dde342c0a2d0bf97b2ff81c001714f64eb3f0
    reference_type: commit
    reference_id: b32dde342c0a2d0bf97b2ff81c001714f64eb3f0
  - url: https://github.com/xen-project/xen/tree/bd03b27b9ac783e7a8fe473cff16d8a8d9a9ff81
    reference_type: commit
    reference_id: bd03b27b9ac783e7a8fe473cff16d8a8d9a9ff81
  - url: https://github.com/xen-project/xen/tree/d4f6116c080dc013cd1204c4d8ceb95e5f278689
    reference_type: commit
    reference_id: d4f6116c080dc013cd1204c4d8ceb95e5f278689
  - url: https://github.com/xen-project/xen/tree/e69793d6ba265bb52c0cdeec609c79c9efe5ad94
    reference_type: commit
    reference_id: e69793d6ba265bb52c0cdeec609c79c9efe5ad94
