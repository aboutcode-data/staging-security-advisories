advisory_id: CVE-2015-7835
datasource_id: collect_xen_project_fix_commits/CVE-2015-7835
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  3be91e6c200af155a1badefc5945008c8da12ce7:x86: guard against undue super page PTE creation

  When optional super page support got added (commit bd1cd81d64 "x86: PV
  support for hugepages"), two adjustments were missed: mod_l2_entry()
  needs to consider the PSE and RW bits when deciding whether to use the
  fast path, and the PSE bit must not be removed from L2_DISALLOW_MASK
  unconditionally.

  This is CVE-2015-7835 / XSA-148.

  Reported-by: "栾尚聪(好风)" <shangcong.lsc@alibaba-inc.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: fe360c90ea13f309ef78810f1a2b92f2ae3b30b8
  master date: 2015-10-29 13:35:07 +0100
  a6646a52fd7aad00c6d50668f7ae362288ec9a98:x86: guard against undue super page PTE creation

  When optional super page support got added (commit bd1cd81d64 "x86: PV
  support for hugepages"), two adjustments were missed: mod_l2_entry()
  needs to consider the PSE and RW bits when deciding whether to use the
  fast path, and the PSE bit must not be removed from L2_DISALLOW_MASK
  unconditionally.

  This is CVE-2015-7835 / XSA-148.

  Reported-by: "栾尚聪(好风)" <shangcong.lsc@alibaba-inc.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: fe360c90ea13f309ef78810f1a2b92f2ae3b30b8
  master date: 2015-10-29 13:35:07 +0100
  d2fa0eeaba32fab85db9046acc2021a9c112051a:x86: guard against undue super page PTE creation

  When optional super page support got added (commit bd1cd81d64 "x86: PV
  support for hugepages"), two adjustments were missed: mod_l2_entry()
  needs to consider the PSE and RW bits when deciding whether to use the
  fast path, and the PSE bit must not be removed from L2_DISALLOW_MASK
  unconditionally.

  This is CVE-2015-7835 / XSA-148.

  Reported-by: "栾尚聪(好风)" <shangcong.lsc@alibaba-inc.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: fe360c90ea13f309ef78810f1a2b92f2ae3b30b8
  master date: 2015-10-29 13:35:07 +0100
  2d094bd87072e26ac29b07917d31fcbf13892288:x86: guard against undue super page PTE creation

  When optional super page support got added (commit bd1cd81d64 "x86: PV
  support for hugepages"), two adjustments were missed: mod_l2_entry()
  needs to consider the PSE and RW bits when deciding whether to use the
  fast path, and the PSE bit must not be removed from L2_DISALLOW_MASK
  unconditionally.

  This is CVE-2015-7835 / XSA-148.

  Reported-by: "栾尚聪(好风)" <shangcong.lsc@alibaba-inc.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: fe360c90ea13f309ef78810f1a2b92f2ae3b30b8
  master date: 2015-10-29 13:35:07 +0100
  fe360c90ea13f309ef78810f1a2b92f2ae3b30b8:x86: guard against undue super page PTE creation

  When optional super page support got added (commit bd1cd81d64 "x86: PV
  support for hugepages"), two adjustments were missed: mod_l2_entry()
  needs to consider the PSE and RW bits when deciding whether to use the
  fast path, and the PSE bit must not be removed from L2_DISALLOW_MASK
  unconditionally.

  This is CVE-2015-7835 / XSA-148.

  Reported-by: "栾尚聪(好风)" <shangcong.lsc@alibaba-inc.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d2fa0eeaba32fab85db9046acc2021a9c112051a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2d094bd87072e26ac29b07917d31fcbf13892288
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a6646a52fd7aad00c6d50668f7ae362288ec9a98
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: fe360c90ea13f309ef78810f1a2b92f2ae3b30b8
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3be91e6c200af155a1badefc5945008c8da12ce7
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/2d094bd87072e26ac29b07917d31fcbf13892288
    reference_type: commit
    reference_id: 2d094bd87072e26ac29b07917d31fcbf13892288
  - url: https://github.com/xen-project/xen/tree/3be91e6c200af155a1badefc5945008c8da12ce7
    reference_type: commit
    reference_id: 3be91e6c200af155a1badefc5945008c8da12ce7
  - url: https://github.com/xen-project/xen/tree/a6646a52fd7aad00c6d50668f7ae362288ec9a98
    reference_type: commit
    reference_id: a6646a52fd7aad00c6d50668f7ae362288ec9a98
  - url: https://github.com/xen-project/xen/tree/d2fa0eeaba32fab85db9046acc2021a9c112051a
    reference_type: commit
    reference_id: d2fa0eeaba32fab85db9046acc2021a9c112051a
  - url: https://github.com/xen-project/xen/tree/fe360c90ea13f309ef78810f1a2b92f2ae3b30b8
    reference_type: commit
    reference_id: fe360c90ea13f309ef78810f1a2b92f2ae3b30b8
