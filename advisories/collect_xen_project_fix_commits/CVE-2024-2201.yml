advisory_id: CVE-2024-2201
datasource_id: collect_xen_project_fix_commits/CVE-2024-2201
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  adc7d540ae9d5e074ac56141a6d6e5462f47e70b:x86/spec-ctrl: Support the "long" BHB loop sequence

  Out of an abudnance of caution, implement the long loop too, and allowing for
  it to be opted in to.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit d5887c0decbd90e798b24ed696628645b04632fb)
  9efa5f2d3024b8d75030c1a46f29a809b01881c8:x86/spec-ctrl: Wire up the Native-BHI software sequences

  In the absence of BHI_DIS_S, mitigating Native-BHI requires the use of a
  software sequence.

  Introduce a new bhb-seq= option to select between avaialble sequences and
  bhb-entry= to control the per-PV/HVM actions like we have for other blocks.

  Activate the short sequence by default for PV and HVM guests on affected
  hardware if BHI_DIS_S isn't present.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 689ad48ce9cf4c38297cd126e7e003a1c13a3b9d)
  3419b2a8fd0965b87b83aa314555a50059428df6:x86/spec-ctrl: Software BHB-clearing sequences

  Implement clear_bhb_{tsx,loops}() as per the BHI guidance.  The loops variant
  is set up as the "short" sequence.

  Introduce SCF_entry_bhb and extend SPEC_CTRL_ENTRY_* with a conditional call
  to selected clearing routine.

  Note that due to a limitation in the ALTERNATIVE capability, the TEST/JZ can't
  be included alongside a CALL in a single alternative block.  This is going to
  require further work to untangle.

  The BHB sequences (if used) must be after the restoration of Xen's
  MSR_SPEC_CTRL value, which must be accounted for when judging whether it is
  safe to skip the safety LFENCEs.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 954c983abceee97bf5f6230b9ae164f2c49a9aa9)
  041f939e13b5c07434b3523323b97ecc2881bcf4:x86/spec-ctrl: Support BHI_DIS_S in order to mitigate BHI

  Introduce a "bhi-dis-s" boolean to match the other options we have for
  MSR_SPEC_CTRL values.  Also introduce bhi_calculations().

  Use BHI_DIS_S whenever possible.

  Guests which are levelled to be migration compatible with older CPUs can't see
  BHI_DIS_S, and Xen must fill in the difference to make the guest safe.  Use
  the virt MSR_SPEC_CTRL infrastructure to force BHI_DIS_S behind the guest's
  back.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 62a1106415c5e8a49b45147ca84d54a58d471343)
  1baac154c4fbf3ed33d9d027cd316c51ebe3adcc:x86/tsx: Expose RTM_ALWAYS_ABORT to guests

  A TSX Abort is one option mitigate Native-BHI, but a guest kernel doesn't get
  to see this if Xen has turned RTM off using MSR_TSX_{CTRL,FORCE_ABORT}.

  Therefore, the meaning of RTM_ALWAYS_ABORT has been adjusted to "XBEGIN won't
  fault", and it should be exposed to guests so they can make a better decision.

  Expose it in the max policy for any RTM-capable system.  Offer it by default
  only if RTM has been disabled.

  Update test-tsx to account for this new meaning.  While adjusting the logic in
  test_guest_policies(), take the opportunity to use feature names (now they're
  available) to make the logic easier to follow.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit c94e2105924347de0d9f32065370e802a20cc829)
  012c26451ab679256616e4b289ce2ab911d19c9e:x86: Drop INDIRECT_JMP

  Indirect JMPs which are not tailcalls can lead to an unwelcome form of
  speculative type confusion, and we've removed the uses of INDIRECT_JMP to
  compensate.  Remove the temptation to reintroduce new instances.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 0b66d7ce3c0290eaad28bdafb35200052d012b14)
  768ee6d99e2bb1ba315fc7244abf502fe5c16cea:x86: Use indirect calls in reset-stack infrastructure

  Mixing up JMP and CALL indirect targets leads a very fun form of speculative
  type confusion.  A target which is expecting to be called CALLed needs a
  return address on the stack, and an indirect JMP doesn't place one there.

  An indirect JMP which predicts to a target intending to be CALLed can end up
  with a RET speculatively executing with a value from the JMPers stack frame.

  There are several ways get indirect JMPs in Xen.

   * From tailcall optimisations.  These are safe because the compiler has
     arranged the stack to point at the callee's return address.

   * From jump tables.  These are unsafe, but Xen is built with -fno-jump-tables
     to work around several compiler issues.

   * From reset_stack_and_jump_ind(), which is particularly unsafe.  Because of
     the additional stack adjustment made, the value picked up off the stack is
     regs->r15 of the next vCPU to run.

  In order to mitigate this type confusion, we want to make all indirect targets
  be CALL targets, and remove the use of indirect JMP except via tailcall
  optimisation.

  Luckily due to XSA-348, all C target functions of reset_stack_and_jump_ind()
  are noreturn.  {svm,vmx}_do_resume() exits via reset_stack_and_jump(); a
  direct JMP with entirely different prediction properties.  idle_loop() is an
  infinite loop which eventually exits via reset_stack_and_jump_ind() from a new
  schedule.  i.e. These paths are all fine having one extra return address on
  the stack.

  This leaves continue_pv_domain(), which is expecting to be a JMP target.
  Alter it to strip the return address off the stack, which is safe because
  there isn't actually a RET expecting to return to its caller.

  This allows us change reset_stack_and_jump_ind() to reset_stack_and_call_ind()
  in order to mitigate the speculative type confusion.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 8e186f98ce0e35d1754ec9299da41ec98873b65c)
  fb263ffc1f7fc1975dc072a5ebbd9d6e9021337a:x86/spec-ctrl: Support the "long" BHB loop sequence

  Out of an abudnance of caution, implement the long loop too, and allowing for
  it to be opted in to.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit d5887c0decbd90e798b24ed696628645b04632fb)
  27f9a778bd2538f06d02fd79f3381ff0a27f4987:x86/spec-ctrl: Wire up the Native-BHI software sequences

  In the absence of BHI_DIS_S, mitigating Native-BHI requires the use of a
  software sequence.

  Introduce a new bhb-seq= option to select between avaialble sequences and
  bhb-entry= to control the per-PV/HVM actions like we have for other blocks.

  Activate the short sequence by default for PV and HVM guests on affected
  hardware if BHI_DIS_S isn't present.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 689ad48ce9cf4c38297cd126e7e003a1c13a3b9d)
  4e7d75c4a5e841cec840010edbc6dfcf3c8a7b61:x86/spec-ctrl: Software BHB-clearing sequences

  Implement clear_bhb_{tsx,loops}() as per the BHI guidance.  The loops variant
  is set up as the "short" sequence.

  Introduce SCF_entry_bhb and extend SPEC_CTRL_ENTRY_* with a conditional call
  to selected clearing routine.

  Note that due to a limitation in the ALTERNATIVE capability, the TEST/JZ can't
  be included alongside a CALL in a single alternative block.  This is going to
  require further work to untangle.

  The BHB sequences (if used) must be after the restoration of Xen's
  MSR_SPEC_CTRL value, which must be accounted for when judging whether it is
  safe to skip the safety LFENCEs.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 954c983abceee97bf5f6230b9ae164f2c49a9aa9)
  028ef7630704f0c7254f5cd0ea5ffbacf92267f2:x86/spec-ctrl: Support BHI_DIS_S in order to mitigate BHI

  Introduce a "bhi-dis-s" boolean to match the other options we have for
  MSR_SPEC_CTRL values.  Also introduce bhi_calculations().

  Use BHI_DIS_S whenever possible.

  Guests which are levelled to be migration compatible with older CPUs can't see
  BHI_DIS_S, and Xen must fill in the difference to make the guest safe.  Use
  the virt MSR_SPEC_CTRL infrastructure to force BHI_DIS_S behind the guest's
  back.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 62a1106415c5e8a49b45147ca84d54a58d471343)
  cf630e30dc4267d6b14ae95d345c8e3bb638ca82:x86/tsx: Expose RTM_ALWAYS_ABORT to guests

  A TSX Abort is one option mitigate Native-BHI, but a guest kernel doesn't get
  to see this if Xen has turned RTM off using MSR_TSX_{CTRL,FORCE_ABORT}.

  Therefore, the meaning of RTM_ALWAYS_ABORT has been adjusted to "XBEGIN won't
  fault", and it should be exposed to guests so they can make a better decision.

  Expose it in the max policy for any RTM-capable system.  Offer it by default
  only if RTM has been disabled.

  Update test-tsx to account for this new meaning.  While adjusting the logic in
  test_guest_policies(), take the opportunity to use feature names (now they're
  available) to make the logic easier to follow.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit c94e2105924347de0d9f32065370e802a20cc829)
  21113031fc0db5ff3de8bfb7a441f06e169a931b:x86: Drop INDIRECT_JMP

  Indirect JMPs which are not tailcalls can lead to an unwelcome form of
  speculative type confusion, and we've removed the uses of INDIRECT_JMP to
  compensate.  Remove the temptation to reintroduce new instances.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 0b66d7ce3c0290eaad28bdafb35200052d012b14)
  25a496fd22b7ef3b808c0dda35c4610ef41ef632:x86: Use indirect calls in reset-stack infrastructure

  Mixing up JMP and CALL indirect targets leads a very fun form of speculative
  type confusion.  A target which is expecting to be called CALLed needs a
  return address on the stack, and an indirect JMP doesn't place one there.

  An indirect JMP which predicts to a target intending to be CALLed can end up
  with a RET speculatively executing with a value from the JMPers stack frame.

  There are several ways get indirect JMPs in Xen.

   * From tailcall optimisations.  These are safe because the compiler has
     arranged the stack to point at the callee's return address.

   * From jump tables.  These are unsafe, but Xen is built with -fno-jump-tables
     to work around several compiler issues.

   * From reset_stack_and_jump_ind(), which is particularly unsafe.  Because of
     the additional stack adjustment made, the value picked up off the stack is
     regs->r15 of the next vCPU to run.

  In order to mitigate this type confusion, we want to make all indirect targets
  be CALL targets, and remove the use of indirect JMP except via tailcall
  optimisation.

  Luckily due to XSA-348, all C target functions of reset_stack_and_jump_ind()
  are noreturn.  {svm,vmx}_do_resume() exits via reset_stack_and_jump(); a
  direct JMP with entirely different prediction properties.  idle_loop() is an
  infinite loop which eventually exits via reset_stack_and_jump_ind() from a new
  schedule.  i.e. These paths are all fine having one extra return address on
  the stack.

  This leaves continue_pv_domain(), which is expecting to be a JMP target.
  Alter it to strip the return address off the stack, which is safe because
  there isn't actually a RET expecting to return to its caller.

  This allows us change reset_stack_and_jump_ind() to reset_stack_and_call_ind()
  in order to mitigate the speculative type confusion.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 8e186f98ce0e35d1754ec9299da41ec98873b65c)
  60859cc99033beb84da035fb1664ce6e9b698bc6:x86/spec-ctrl: Support the "long" BHB loop sequence

  Out of an abudnance of caution, implement the long loop too, and allowing for
  it to be opted in to.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit d5887c0decbd90e798b24ed696628645b04632fb)
  eab897caca018c126f925247e4c9fd4aac54afdb:x86/spec-ctrl: Wire up the Native-BHI software sequences

  In the absence of BHI_DIS_S, mitigating Native-BHI requires the use of a
  software sequence.

  Introduce a new bhb-seq= option to select between avaialble sequences and
  bhb-entry= to control the per-PV/HVM actions like we have for other blocks.

  Activate the short sequence by default for PV and HVM guests on affected
  hardware if BHI_DIS_S isn't present.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 689ad48ce9cf4c38297cd126e7e003a1c13a3b9d)
  4abd50dc17ced2e1221226b7893c437acbbd0d1b:x86/spec-ctrl: Software BHB-clearing sequences

  Implement clear_bhb_{tsx,loops}() as per the BHI guidance.  The loops variant
  is set up as the "short" sequence.

  Introduce SCF_entry_bhb and extend SPEC_CTRL_ENTRY_* with a conditional call
  to selected clearing routine.

  Note that due to a limitation in the ALTERNATIVE capability, the TEST/JZ can't
  be included alongside a CALL in a single alternative block.  This is going to
  require further work to untangle.

  The BHB sequences (if used) must be after the restoration of Xen's
  MSR_SPEC_CTRL value, which must be accounted for when judging whether it is
  safe to skip the safety LFENCEs.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 954c983abceee97bf5f6230b9ae164f2c49a9aa9)
  7d3ad6775d59ad292c3b6431e8eb73e10d191298:x86/spec-ctrl: Support BHI_DIS_S in order to mitigate BHI

  Introduce a "bhi-dis-s" boolean to match the other options we have for
  MSR_SPEC_CTRL values.  Also introduce bhi_calculations().

  Use BHI_DIS_S whenever possible.

  Guests which are levelled to be migration compatible with older CPUs can't see
  BHI_DIS_S, and Xen must fill in the difference to make the guest safe.  Use
  the virt MSR_SPEC_CTRL infrastructure to force BHI_DIS_S behind the guest's
  back.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 62a1106415c5e8a49b45147ca84d54a58d471343)
  02a424a7a8be13f6f85eb4fa2f43100b8e76f760:x86/tsx: Expose RTM_ALWAYS_ABORT to guests

  A TSX Abort is one option mitigate Native-BHI, but a guest kernel doesn't get
  to see this if Xen has turned RTM off using MSR_TSX_{CTRL,FORCE_ABORT}.

  Therefore, the meaning of RTM_ALWAYS_ABORT has been adjusted to "XBEGIN won't
  fault", and it should be exposed to guests so they can make a better decision.

  Expose it in the max policy for any RTM-capable system.  Offer it by default
  only if RTM has been disabled.

  Update test-tsx to account for this new meaning.  While adjusting the logic in
  test_guest_policies(), take the opportunity to use feature names (now they're
  available) to make the logic easier to follow.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit c94e2105924347de0d9f32065370e802a20cc829)
  801e251556c374ce3e84ca776f211e00431932ef:x86: Drop INDIRECT_JMP

  Indirect JMPs which are not tailcalls can lead to an unwelcome form of
  speculative type confusion, and we've removed the uses of INDIRECT_JMP to
  compensate.  Remove the temptation to reintroduce new instances.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 0b66d7ce3c0290eaad28bdafb35200052d012b14)
  e2a2cfb4ddf05a76e072ea84172d6a83ba392d20:x86: Use indirect calls in reset-stack infrastructure

  Mixing up JMP and CALL indirect targets leads a very fun form of speculative
  type confusion.  A target which is expecting to be called CALLed needs a
  return address on the stack, and an indirect JMP doesn't place one there.

  An indirect JMP which predicts to a target intending to be CALLed can end up
  with a RET speculatively executing with a value from the JMPers stack frame.

  There are several ways get indirect JMPs in Xen.

   * From tailcall optimisations.  These are safe because the compiler has
     arranged the stack to point at the callee's return address.

   * From jump tables.  These are unsafe, but Xen is built with -fno-jump-tables
     to work around several compiler issues.

   * From reset_stack_and_jump_ind(), which is particularly unsafe.  Because of
     the additional stack adjustment made, the value picked up off the stack is
     regs->r15 of the next vCPU to run.

  In order to mitigate this type confusion, we want to make all indirect targets
  be CALL targets, and remove the use of indirect JMP except via tailcall
  optimisation.

  Luckily due to XSA-348, all C target functions of reset_stack_and_jump_ind()
  are noreturn.  {svm,vmx}_do_resume() exits via reset_stack_and_jump(); a
  direct JMP with entirely different prediction properties.  idle_loop() is an
  infinite loop which eventually exits via reset_stack_and_jump_ind() from a new
  schedule.  i.e. These paths are all fine having one extra return address on
  the stack.

  This leaves continue_pv_domain(), which is expecting to be a JMP target.
  Alter it to strip the return address off the stack, which is safe because
  there isn't actually a RET expecting to return to its caller.

  This allows us change reset_stack_and_jump_ind() to reset_stack_and_call_ind()
  in order to mitigate the speculative type confusion.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 8e186f98ce0e35d1754ec9299da41ec98873b65c)
  40f2c69ad8f255aa93c1fc7c4d82577d32924ab1:x86/spec-ctrl: Support the "long" BHB loop sequence

  Out of an abudnance of caution, implement the long loop too, and allowing for
  it to be opted in to.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit d5887c0decbd90e798b24ed696628645b04632fb)
  9be85b14aa7d174bfa5978cbbebf0fb3dc909f13:x86/spec-ctrl: Wire up the Native-BHI software sequences

  In the absence of BHI_DIS_S, mitigating Native-BHI requires the use of a
  software sequence.

  Introduce a new bhb-seq= option to select between avaialble sequences and
  bhb-entry= to control the per-PV/HVM actions like we have for other blocks.

  Activate the short sequence by default for PV and HVM guests on affected
  hardware if BHI_DIS_S isn't present.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 689ad48ce9cf4c38297cd126e7e003a1c13a3b9d)
  72a357f4fa4e26fd7bc7dff0fdf1174caf90624e:x86/spec-ctrl: Software BHB-clearing sequences

  Implement clear_bhb_{tsx,loops}() as per the BHI guidance.  The loops variant
  is set up as the "short" sequence.

  Introduce SCF_entry_bhb and extend SPEC_CTRL_ENTRY_* with a conditional call
  to selected clearing routine.

  Note that due to a limitation in the ALTERNATIVE capability, the TEST/JZ can't
  be included alongside a CALL in a single alternative block.  This is going to
  require further work to untangle.

  The BHB sequences (if used) must be after the restoration of Xen's
  MSR_SPEC_CTRL value, which must be accounted for when judging whether it is
  safe to skip the safety LFENCEs.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 954c983abceee97bf5f6230b9ae164f2c49a9aa9)
  73a4229807c3b237a0b6d2e03d0301d3725b8f1d:x86/spec-ctrl: Support BHI_DIS_S in order to mitigate BHI

  Introduce a "bhi-dis-s" boolean to match the other options we have for
  MSR_SPEC_CTRL values.  Also introduce bhi_calculations().

  Use BHI_DIS_S whenever possible.

  Guests which are levelled to be migration compatible with older CPUs can't see
  BHI_DIS_S, and Xen must fill in the difference to make the guest safe.  Use
  the virt MSR_SPEC_CTRL infrastructure to force BHI_DIS_S behind the guest's
  back.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 62a1106415c5e8a49b45147ca84d54a58d471343)
  2be76f201814bd91a289d991e47746ca22c80c31:x86/tsx: Expose RTM_ALWAYS_ABORT to guests

  A TSX Abort is one option mitigate Native-BHI, but a guest kernel doesn't get
  to see this if Xen has turned RTM off using MSR_TSX_{CTRL,FORCE_ABORT}.

  Therefore, the meaning of RTM_ALWAYS_ABORT has been adjusted to "XBEGIN won't
  fault", and it should be exposed to guests so they can make a better decision.

  Expose it in the max policy for any RTM-capable system.  Offer it by default
  only if RTM has been disabled.

  Update test-tsx to account for this new meaning.  While adjusting the logic in
  test_guest_policies(), take the opportunity to use feature names (now they're
  available) to make the logic easier to follow.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit c94e2105924347de0d9f32065370e802a20cc829)
  62844c4415f50e01ab46fa8bedc127cc098aa77b:x86: Drop INDIRECT_JMP

  Indirect JMPs which are not tailcalls can lead to an unwelcome form of
  speculative type confusion, and we've removed the uses of INDIRECT_JMP to
  compensate.  Remove the temptation to reintroduce new instances.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 0b66d7ce3c0290eaad28bdafb35200052d012b14)
  9fd732d18d564001227c98ca8fa5da8eb348ede5:x86: Use indirect calls in reset-stack infrastructure

  Mixing up JMP and CALL indirect targets leads a very fun form of speculative
  type confusion.  A target which is expecting to be called CALLed needs a
  return address on the stack, and an indirect JMP doesn't place one there.

  An indirect JMP which predicts to a target intending to be CALLed can end up
  with a RET speculatively executing with a value from the JMPers stack frame.

  There are several ways get indirect JMPs in Xen.

   * From tailcall optimisations.  These are safe because the compiler has
     arranged the stack to point at the callee's return address.

   * From jump tables.  These are unsafe, but Xen is built with -fno-jump-tables
     to work around several compiler issues.

   * From reset_stack_and_jump_ind(), which is particularly unsafe.  Because of
     the additional stack adjustment made, the value picked up off the stack is
     regs->r15 of the next vCPU to run.

  In order to mitigate this type confusion, we want to make all indirect targets
  be CALL targets, and remove the use of indirect JMP except via tailcall
  optimisation.

  Luckily due to XSA-348, all C target functions of reset_stack_and_jump_ind()
  are noreturn.  {svm,vmx}_do_resume() exits via reset_stack_and_jump(); a
  direct JMP with entirely different prediction properties.  idle_loop() is an
  infinite loop which eventually exits via reset_stack_and_jump_ind() from a new
  schedule.  i.e. These paths are all fine having one extra return address on
  the stack.

  This leaves continue_pv_domain(), which is expecting to be a JMP target.
  Alter it to strip the return address off the stack, which is safe because
  there isn't actually a RET expecting to return to its caller.

  This allows us change reset_stack_and_jump_ind() to reset_stack_and_call_ind()
  in order to mitigate the speculative type confusion.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 8e186f98ce0e35d1754ec9299da41ec98873b65c)
  d5887c0decbd90e798b24ed696628645b04632fb:x86/spec-ctrl: Support the "long" BHB loop sequence

  Out of an abudnance of caution, implement the long loop too, and allowing for
  it to be opted in to.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  689ad48ce9cf4c38297cd126e7e003a1c13a3b9d:x86/spec-ctrl: Wire up the Native-BHI software sequences

  In the absence of BHI_DIS_S, mitigating Native-BHI requires the use of a
  software sequence.

  Introduce a new bhb-seq= option to select between avaialble sequences and
  bhb-entry= to control the per-PV/HVM actions like we have for other blocks.

  Activate the short sequence by default for PV and HVM guests on affected
  hardware if BHI_DIS_S isn't present.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  954c983abceee97bf5f6230b9ae164f2c49a9aa9:x86/spec-ctrl: Software BHB-clearing sequences

  Implement clear_bhb_{tsx,loops}() as per the BHI guidance.  The loops variant
  is set up as the "short" sequence.

  Introduce SCF_entry_bhb and extend SPEC_CTRL_ENTRY_* with a conditional call
  to selected clearing routine.

  Note that due to a limitation in the ALTERNATIVE capability, the TEST/JZ can't
  be included alongside a CALL in a single alternative block.  This is going to
  require further work to untangle.

  The BHB sequences (if used) must be after the restoration of Xen's
  MSR_SPEC_CTRL value, which must be accounted for when judging whether it is
  safe to skip the safety LFENCEs.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  62a1106415c5e8a49b45147ca84d54a58d471343:x86/spec-ctrl: Support BHI_DIS_S in order to mitigate BHI

  Introduce a "bhi-dis-s" boolean to match the other options we have for
  MSR_SPEC_CTRL values.  Also introduce bhi_calculations().

  Use BHI_DIS_S whenever possible.

  Guests which are levelled to be migration compatible with older CPUs can't see
  BHI_DIS_S, and Xen must fill in the difference to make the guest safe.  Use
  the virt MSR_SPEC_CTRL infrastructure to force BHI_DIS_S behind the guest's
  back.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Roger Pau Monné <roger.pau@citrix.com>
  c94e2105924347de0d9f32065370e802a20cc829:x86/tsx: Expose RTM_ALWAYS_ABORT to guests

  A TSX Abort is one option mitigate Native-BHI, but a guest kernel doesn't get
  to see this if Xen has turned RTM off using MSR_TSX_{CTRL,FORCE_ABORT}.

  Therefore, the meaning of RTM_ALWAYS_ABORT has been adjusted to "XBEGIN won't
  fault", and it should be exposed to guests so they can make a better decision.

  Expose it in the max policy for any RTM-capable system.  Offer it by default
  only if RTM has been disabled.

  Update test-tsx to account for this new meaning.  While adjusting the logic in
  test_guest_policies(), take the opportunity to use feature names (now they're
  available) to make the logic easier to follow.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  0b66d7ce3c0290eaad28bdafb35200052d012b14:x86: Drop INDIRECT_JMP

  Indirect JMPs which are not tailcalls can lead to an unwelcome form of
  speculative type confusion, and we've removed the uses of INDIRECT_JMP to
  compensate.  Remove the temptation to reintroduce new instances.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  8e186f98ce0e35d1754ec9299da41ec98873b65c:x86: Use indirect calls in reset-stack infrastructure

  Mixing up JMP and CALL indirect targets leads a very fun form of speculative
  type confusion.  A target which is expecting to be called CALLed needs a
  return address on the stack, and an indirect JMP doesn't place one there.

  An indirect JMP which predicts to a target intending to be CALLed can end up
  with a RET speculatively executing with a value from the JMPers stack frame.

  There are several ways get indirect JMPs in Xen.

   * From tailcall optimisations.  These are safe because the compiler has
     arranged the stack to point at the callee's return address.

   * From jump tables.  These are unsafe, but Xen is built with -fno-jump-tables
     to work around several compiler issues.

   * From reset_stack_and_jump_ind(), which is particularly unsafe.  Because of
     the additional stack adjustment made, the value picked up off the stack is
     regs->r15 of the next vCPU to run.

  In order to mitigate this type confusion, we want to make all indirect targets
  be CALL targets, and remove the use of indirect JMP except via tailcall
  optimisation.

  Luckily due to XSA-348, all C target functions of reset_stack_and_jump_ind()
  are noreturn.  {svm,vmx}_do_resume() exits via reset_stack_and_jump(); a
  direct JMP with entirely different prediction properties.  idle_loop() is an
  infinite loop which eventually exits via reset_stack_and_jump_ind() from a new
  schedule.  i.e. These paths are all fine having one extra return address on
  the stack.

  This leaves continue_pv_domain(), which is expecting to be a JMP target.
  Alter it to strip the return address off the stack, which is safe because
  there isn't actually a RET expecting to return to its caller.

  This allows us change reset_stack_and_jump_ind() to reset_stack_and_call_ind()
  in order to mitigate the speculative type confusion.

  This is part of XSA-456 / CVE-2024-2201.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9fd732d18d564001227c98ca8fa5da8eb348ede5
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 028ef7630704f0c7254f5cd0ea5ffbacf92267f2
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 768ee6d99e2bb1ba315fc7244abf502fe5c16cea
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 02a424a7a8be13f6f85eb4fa2f43100b8e76f760
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d5887c0decbd90e798b24ed696628645b04632fb
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 689ad48ce9cf4c38297cd126e7e003a1c13a3b9d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9be85b14aa7d174bfa5978cbbebf0fb3dc909f13
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 73a4229807c3b237a0b6d2e03d0301d3725b8f1d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c94e2105924347de0d9f32065370e802a20cc829
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4abd50dc17ced2e1221226b7893c437acbbd0d1b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: fb263ffc1f7fc1975dc072a5ebbd9d6e9021337a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 60859cc99033beb84da035fb1664ce6e9b698bc6
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4e7d75c4a5e841cec840010edbc6dfcf3c8a7b61
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 40f2c69ad8f255aa93c1fc7c4d82577d32924ab1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 62844c4415f50e01ab46fa8bedc127cc098aa77b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 041f939e13b5c07434b3523323b97ecc2881bcf4
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 954c983abceee97bf5f6230b9ae164f2c49a9aa9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 62a1106415c5e8a49b45147ca84d54a58d471343
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 72a357f4fa4e26fd7bc7dff0fdf1174caf90624e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: cf630e30dc4267d6b14ae95d345c8e3bb638ca82
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 012c26451ab679256616e4b289ce2ab911d19c9e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e2a2cfb4ddf05a76e072ea84172d6a83ba392d20
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 801e251556c374ce3e84ca776f211e00431932ef
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3419b2a8fd0965b87b83aa314555a50059428df6
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9efa5f2d3024b8d75030c1a46f29a809b01881c8
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7d3ad6775d59ad292c3b6431e8eb73e10d191298
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 21113031fc0db5ff3de8bfb7a441f06e169a931b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 27f9a778bd2538f06d02fd79f3381ff0a27f4987
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 25a496fd22b7ef3b808c0dda35c4610ef41ef632
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2be76f201814bd91a289d991e47746ca22c80c31
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8e186f98ce0e35d1754ec9299da41ec98873b65c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: eab897caca018c126f925247e4c9fd4aac54afdb
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1baac154c4fbf3ed33d9d027cd316c51ebe3adcc
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0b66d7ce3c0290eaad28bdafb35200052d012b14
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: adc7d540ae9d5e074ac56141a6d6e5462f47e70b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/012c26451ab679256616e4b289ce2ab911d19c9e
    reference_type: commit
    reference_id: 012c26451ab679256616e4b289ce2ab911d19c9e
  - url: https://github.com/xen-project/xen/tree/028ef7630704f0c7254f5cd0ea5ffbacf92267f2
    reference_type: commit
    reference_id: 028ef7630704f0c7254f5cd0ea5ffbacf92267f2
  - url: https://github.com/xen-project/xen/tree/02a424a7a8be13f6f85eb4fa2f43100b8e76f760
    reference_type: commit
    reference_id: 02a424a7a8be13f6f85eb4fa2f43100b8e76f760
  - url: https://github.com/xen-project/xen/tree/041f939e13b5c07434b3523323b97ecc2881bcf4
    reference_type: commit
    reference_id: 041f939e13b5c07434b3523323b97ecc2881bcf4
  - url: https://github.com/xen-project/xen/tree/0b66d7ce3c0290eaad28bdafb35200052d012b14
    reference_type: commit
    reference_id: 0b66d7ce3c0290eaad28bdafb35200052d012b14
  - url: https://github.com/xen-project/xen/tree/1baac154c4fbf3ed33d9d027cd316c51ebe3adcc
    reference_type: commit
    reference_id: 1baac154c4fbf3ed33d9d027cd316c51ebe3adcc
  - url: https://github.com/xen-project/xen/tree/21113031fc0db5ff3de8bfb7a441f06e169a931b
    reference_type: commit
    reference_id: 21113031fc0db5ff3de8bfb7a441f06e169a931b
  - url: https://github.com/xen-project/xen/tree/25a496fd22b7ef3b808c0dda35c4610ef41ef632
    reference_type: commit
    reference_id: 25a496fd22b7ef3b808c0dda35c4610ef41ef632
  - url: https://github.com/xen-project/xen/tree/27f9a778bd2538f06d02fd79f3381ff0a27f4987
    reference_type: commit
    reference_id: 27f9a778bd2538f06d02fd79f3381ff0a27f4987
  - url: https://github.com/xen-project/xen/tree/2be76f201814bd91a289d991e47746ca22c80c31
    reference_type: commit
    reference_id: 2be76f201814bd91a289d991e47746ca22c80c31
  - url: https://github.com/xen-project/xen/tree/3419b2a8fd0965b87b83aa314555a50059428df6
    reference_type: commit
    reference_id: 3419b2a8fd0965b87b83aa314555a50059428df6
  - url: https://github.com/xen-project/xen/tree/40f2c69ad8f255aa93c1fc7c4d82577d32924ab1
    reference_type: commit
    reference_id: 40f2c69ad8f255aa93c1fc7c4d82577d32924ab1
  - url: https://github.com/xen-project/xen/tree/4abd50dc17ced2e1221226b7893c437acbbd0d1b
    reference_type: commit
    reference_id: 4abd50dc17ced2e1221226b7893c437acbbd0d1b
  - url: https://github.com/xen-project/xen/tree/4e7d75c4a5e841cec840010edbc6dfcf3c8a7b61
    reference_type: commit
    reference_id: 4e7d75c4a5e841cec840010edbc6dfcf3c8a7b61
  - url: https://github.com/xen-project/xen/tree/60859cc99033beb84da035fb1664ce6e9b698bc6
    reference_type: commit
    reference_id: 60859cc99033beb84da035fb1664ce6e9b698bc6
  - url: https://github.com/xen-project/xen/tree/62844c4415f50e01ab46fa8bedc127cc098aa77b
    reference_type: commit
    reference_id: 62844c4415f50e01ab46fa8bedc127cc098aa77b
  - url: https://github.com/xen-project/xen/tree/62a1106415c5e8a49b45147ca84d54a58d471343
    reference_type: commit
    reference_id: 62a1106415c5e8a49b45147ca84d54a58d471343
  - url: https://github.com/xen-project/xen/tree/689ad48ce9cf4c38297cd126e7e003a1c13a3b9d
    reference_type: commit
    reference_id: 689ad48ce9cf4c38297cd126e7e003a1c13a3b9d
  - url: https://github.com/xen-project/xen/tree/72a357f4fa4e26fd7bc7dff0fdf1174caf90624e
    reference_type: commit
    reference_id: 72a357f4fa4e26fd7bc7dff0fdf1174caf90624e
  - url: https://github.com/xen-project/xen/tree/73a4229807c3b237a0b6d2e03d0301d3725b8f1d
    reference_type: commit
    reference_id: 73a4229807c3b237a0b6d2e03d0301d3725b8f1d
  - url: https://github.com/xen-project/xen/tree/768ee6d99e2bb1ba315fc7244abf502fe5c16cea
    reference_type: commit
    reference_id: 768ee6d99e2bb1ba315fc7244abf502fe5c16cea
  - url: https://github.com/xen-project/xen/tree/7d3ad6775d59ad292c3b6431e8eb73e10d191298
    reference_type: commit
    reference_id: 7d3ad6775d59ad292c3b6431e8eb73e10d191298
  - url: https://github.com/xen-project/xen/tree/801e251556c374ce3e84ca776f211e00431932ef
    reference_type: commit
    reference_id: 801e251556c374ce3e84ca776f211e00431932ef
  - url: https://github.com/xen-project/xen/tree/8e186f98ce0e35d1754ec9299da41ec98873b65c
    reference_type: commit
    reference_id: 8e186f98ce0e35d1754ec9299da41ec98873b65c
  - url: https://github.com/xen-project/xen/tree/954c983abceee97bf5f6230b9ae164f2c49a9aa9
    reference_type: commit
    reference_id: 954c983abceee97bf5f6230b9ae164f2c49a9aa9
  - url: https://github.com/xen-project/xen/tree/9be85b14aa7d174bfa5978cbbebf0fb3dc909f13
    reference_type: commit
    reference_id: 9be85b14aa7d174bfa5978cbbebf0fb3dc909f13
  - url: https://github.com/xen-project/xen/tree/9efa5f2d3024b8d75030c1a46f29a809b01881c8
    reference_type: commit
    reference_id: 9efa5f2d3024b8d75030c1a46f29a809b01881c8
  - url: https://github.com/xen-project/xen/tree/9fd732d18d564001227c98ca8fa5da8eb348ede5
    reference_type: commit
    reference_id: 9fd732d18d564001227c98ca8fa5da8eb348ede5
  - url: https://github.com/xen-project/xen/tree/adc7d540ae9d5e074ac56141a6d6e5462f47e70b
    reference_type: commit
    reference_id: adc7d540ae9d5e074ac56141a6d6e5462f47e70b
  - url: https://github.com/xen-project/xen/tree/c94e2105924347de0d9f32065370e802a20cc829
    reference_type: commit
    reference_id: c94e2105924347de0d9f32065370e802a20cc829
  - url: https://github.com/xen-project/xen/tree/cf630e30dc4267d6b14ae95d345c8e3bb638ca82
    reference_type: commit
    reference_id: cf630e30dc4267d6b14ae95d345c8e3bb638ca82
  - url: https://github.com/xen-project/xen/tree/d5887c0decbd90e798b24ed696628645b04632fb
    reference_type: commit
    reference_id: d5887c0decbd90e798b24ed696628645b04632fb
  - url: https://github.com/xen-project/xen/tree/e2a2cfb4ddf05a76e072ea84172d6a83ba392d20
    reference_type: commit
    reference_id: e2a2cfb4ddf05a76e072ea84172d6a83ba392d20
  - url: https://github.com/xen-project/xen/tree/eab897caca018c126f925247e4c9fd4aac54afdb
    reference_type: commit
    reference_id: eab897caca018c126f925247e4c9fd4aac54afdb
  - url: https://github.com/xen-project/xen/tree/fb263ffc1f7fc1975dc072a5ebbd9d6e9021337a
    reference_type: commit
    reference_id: fb263ffc1f7fc1975dc072a5ebbd9d6e9021337a
