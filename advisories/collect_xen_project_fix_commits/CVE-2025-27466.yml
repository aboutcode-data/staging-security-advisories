advisory_id: CVE-2025-27466
datasource_id: collect_xen_project_fix_commits/CVE-2025-27466
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  600db442cbb8d9292e6c0877caa1a63b7a3c1303:x86/viridian: avoid NULL pointer dereference in update_reference_tsc()

  The function is only called when the MSR has the enabled bit set, but even
  then the page might not be mapped because the guest provided gfn is not
  suitable.

  Prevent a NULL pointer dereference in update_reference_tsc() by checking
  whether the page is mapped.

  This is CVE-2025-27466 / part of XSA-472.

  Fixes: 386b3365221d ('viridian: use viridian_map/unmap_guest_page() for reference tsc page')
  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  master commit: 5776a2e9db0155cfd76388c8197ca7788bb4b361
  master date: 2025-09-09 14:11:09 +0200
  aba830fc0d20c25594bcfaa2febc8dc077f68172:x86/viridian: avoid NULL pointer dereference in update_reference_tsc()

  The function is only called when the MSR has the enabled bit set, but even
  then the page might not be mapped because the guest provided gfn is not
  suitable.

  Prevent a NULL pointer dereference in update_reference_tsc() by checking
  whether the page is mapped.

  This is CVE-2025-27466 / part of XSA-472.

  Fixes: 386b3365221d ('viridian: use viridian_map/unmap_guest_page() for reference tsc page')
  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  master commit: 5776a2e9db0155cfd76388c8197ca7788bb4b361
  master date: 2025-09-09 14:11:09 +0200
  8924243e5ffa9836f7484aecf5875a72389a8ab2:x86/viridian: avoid NULL pointer dereference in update_reference_tsc()

  The function is only called when the MSR has the enabled bit set, but even
  then the page might not be mapped because the guest provided gfn is not
  suitable.

  Prevent a NULL pointer dereference in update_reference_tsc() by checking
  whether the page is mapped.

  This is CVE-2025-27466 / part of XSA-472.

  Fixes: 386b3365221d ('viridian: use viridian_map/unmap_guest_page() for reference tsc page')
  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  master commit: 5776a2e9db0155cfd76388c8197ca7788bb4b361
  master date: 2025-09-09 14:11:09 +0200
  5f83f721fb62bc59505f07150af23a12ad90a711:x86/viridian: avoid NULL pointer dereference in update_reference_tsc()

  The function is only called when the MSR has the enabled bit set, but even
  then the page might not be mapped because the guest provided gfn is not
  suitable.

  Prevent a NULL pointer dereference in update_reference_tsc() by checking
  whether the page is mapped.

  This is CVE-2025-27466 / part of XSA-472.

  Fixes: 386b3365221d ('viridian: use viridian_map/unmap_guest_page() for reference tsc page')
  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  master commit: 5776a2e9db0155cfd76388c8197ca7788bb4b361
  master date: 2025-09-09 14:11:09 +0200
  5776a2e9db0155cfd76388c8197ca7788bb4b361:x86/viridian: avoid NULL pointer dereference in update_reference_tsc()

  The function is only called when the MSR has the enabled bit set, but even
  then the page might not be mapped because the guest provided gfn is not
  suitable.

  Prevent a NULL pointer dereference in update_reference_tsc() by checking
  whether the page is mapped.

  This is CVE-2025-27466 / part of XSA-472.

  Fixes: 386b3365221d ('viridian: use viridian_map/unmap_guest_page() for reference tsc page')
  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 600db442cbb8d9292e6c0877caa1a63b7a3c1303
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5776a2e9db0155cfd76388c8197ca7788bb4b361
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5f83f721fb62bc59505f07150af23a12ad90a711
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: aba830fc0d20c25594bcfaa2febc8dc077f68172
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8924243e5ffa9836f7484aecf5875a72389a8ab2
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/5776a2e9db0155cfd76388c8197ca7788bb4b361
    reference_type: commit
    reference_id: 5776a2e9db0155cfd76388c8197ca7788bb4b361
  - url: https://github.com/xen-project/xen/tree/5f83f721fb62bc59505f07150af23a12ad90a711
    reference_type: commit
    reference_id: 5f83f721fb62bc59505f07150af23a12ad90a711
  - url: https://github.com/xen-project/xen/tree/600db442cbb8d9292e6c0877caa1a63b7a3c1303
    reference_type: commit
    reference_id: 600db442cbb8d9292e6c0877caa1a63b7a3c1303
  - url: https://github.com/xen-project/xen/tree/8924243e5ffa9836f7484aecf5875a72389a8ab2
    reference_type: commit
    reference_id: 8924243e5ffa9836f7484aecf5875a72389a8ab2
  - url: https://github.com/xen-project/xen/tree/aba830fc0d20c25594bcfaa2febc8dc077f68172
    reference_type: commit
    reference_id: aba830fc0d20c25594bcfaa2febc8dc077f68172
