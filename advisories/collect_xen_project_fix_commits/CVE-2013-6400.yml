advisory_id: CVE-2013-6400
datasource_id: collect_xen_project_fix_commits/CVE-2013-6400
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  43359e14ffc64f95343c35c9a1eafbc36adad531:IOMMU: clear "don't flush" override on error paths

  Both xenmem_add_to_physmap() and iommu_populate_page_table() each have
  an error path that fails to clear that flag, thus suppressing further
  flushes on the respective pCPU.

  In iommu_populate_page_table() also slightly re-arrange code to avoid
  the false impression of the flag in question being guarded by a
  domain's page_alloc_lock.

  This is CVE-2013-6400 / XSA-80.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  master commit: 552b7fcb9a70f1d4dd0e0cd5fb4d3d9da410104a
  master date: 2013-12-10 16:10:37 +0100
  8940a13d6de1295cfdc4a189e0a5610849a9ef59:IOMMU: clear "don't flush" override on error paths

  Both xenmem_add_to_physmap() and iommu_populate_page_table() each have
  an error path that fails to clear that flag, thus suppressing further
  flushes on the respective pCPU.

  In iommu_populate_page_table() also slightly re-arrange code to avoid
  the false impression of the flag in question being guarded by a
  domain's page_alloc_lock.

  This is CVE-2013-6400 / XSA-80.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  master commit: 552b7fcb9a70f1d4dd0e0cd5fb4d3d9da410104a
  master date: 2013-12-10 16:10:37 +0100
  552b7fcb9a70f1d4dd0e0cd5fb4d3d9da410104a:IOMMU: clear "don't flush" override on error paths

  Both xenmem_add_to_physmap() and iommu_populate_page_table() each have
  an error path that fails to clear that flag, thus suppressing further
  flushes on the respective pCPU.

  In iommu_populate_page_table() also slightly re-arrange code to avoid
  the false impression of the flag in question being guarded by a
  domain's page_alloc_lock.

  This is CVE-2013-6400 / XSA-80.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8940a13d6de1295cfdc4a189e0a5610849a9ef59
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 552b7fcb9a70f1d4dd0e0cd5fb4d3d9da410104a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 43359e14ffc64f95343c35c9a1eafbc36adad531
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/43359e14ffc64f95343c35c9a1eafbc36adad531
    reference_type: commit
    reference_id: 43359e14ffc64f95343c35c9a1eafbc36adad531
  - url: https://github.com/xen-project/xen/tree/552b7fcb9a70f1d4dd0e0cd5fb4d3d9da410104a
    reference_type: commit
    reference_id: 552b7fcb9a70f1d4dd0e0cd5fb4d3d9da410104a
  - url: https://github.com/xen-project/xen/tree/8940a13d6de1295cfdc4a189e0a5610849a9ef59
    reference_type: commit
    reference_id: 8940a13d6de1295cfdc4a189e0a5610849a9ef59
