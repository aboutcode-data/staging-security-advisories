advisory_id: CVE-2016-9379
datasource_id: collect_xen_project_fix_commits/CVE-2016-9379
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  6639a202f285ace4adf57453ade066bd4b4298e0:pygrub: Properly quote results, when returning them to the caller:

  * When the caller wants sexpr output, use `repr()'
    This is what Xend expects.

    The returned S-expressions are now escaped and quoted by Python,
    generally using '...'.  Previously kernel and ramdisk were unquoted
    and args was quoted with "..." but without proper escaping.  This
    change may break toolstacks which do not properly dequote the
    returned S-expressions.

  * When the caller wants "simple" output, crash if the delimiter is
    contained in the returned value.

    With --output-format=simple it does not seem like this could ever
    happen, because the bootloader config parsers all take line-based
    input from the various bootloader config files.

    With --output-format=simple0, this can happen if the bootloader
    config file contains nul bytes.

  This is CVE-2016-9379 and CVE-2016-9380 / XSA-198.

  Signed-off-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  Tested-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 27e14d346ed6ff1c3a3cfc479507e62d133e92a9
  master date: 2016-11-22 13:52:09 +0100
  8e7b84dd2a187edc74f44b69437734b8e4af9628:pygrub: Properly quote results, when returning them to the caller:

  * When the caller wants sexpr output, use `repr()'
    This is what Xend expects.

    The returned S-expressions are now escaped and quoted by Python,
    generally using '...'.  Previously kernel and ramdisk were unquoted
    and args was quoted with "..." but without proper escaping.  This
    change may break toolstacks which do not properly dequote the
    returned S-expressions.

  * When the caller wants "simple" output, crash if the delimiter is
    contained in the returned value.

    With --output-format=simple it does not seem like this could ever
    happen, because the bootloader config parsers all take line-based
    input from the various bootloader config files.

    With --output-format=simple0, this can happen if the bootloader
    config file contains nul bytes.

  This is CVE-2016-9379 and CVE-2016-9380 / XSA-198.

  Signed-off-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  Tested-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 27e14d346ed6ff1c3a3cfc479507e62d133e92a9
  master date: 2016-11-22 13:52:09 +0100
  514173d3f8623194aa607f71866a240d02d432e8:pygrub: Properly quote results, when returning them to the caller:

  * When the caller wants sexpr output, use `repr()'
    This is what Xend expects.

    The returned S-expressions are now escaped and quoted by Python,
    generally using '...'.  Previously kernel and ramdisk were unquoted
    and args was quoted with "..." but without proper escaping.  This
    change may break toolstacks which do not properly dequote the
    returned S-expressions.

  * When the caller wants "simple" output, crash if the delimiter is
    contained in the returned value.

    With --output-format=simple it does not seem like this could ever
    happen, because the bootloader config parsers all take line-based
    input from the various bootloader config files.

    With --output-format=simple0, this can happen if the bootloader
    config file contains nul bytes.

  This is CVE-2016-9379 and CVE-2016-9380 / XSA-198.

  Signed-off-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  Tested-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 27e14d346ed6ff1c3a3cfc479507e62d133e92a9
  master date: 2016-11-22 13:52:09 +0100
  206fc7084dfaf05c55fd9de650f93a7ef9fe0722:pygrub: Properly quote results, when returning them to the caller:

  * When the caller wants sexpr output, use `repr()'
    This is what Xend expects.

    The returned S-expressions are now escaped and quoted by Python,
    generally using '...'.  Previously kernel and ramdisk were unquoted
    and args was quoted with "..." but without proper escaping.  This
    change may break toolstacks which do not properly dequote the
    returned S-expressions.

  * When the caller wants "simple" output, crash if the delimiter is
    contained in the returned value.

    With --output-format=simple it does not seem like this could ever
    happen, because the bootloader config parsers all take line-based
    input from the various bootloader config files.

    With --output-format=simple0, this can happen if the bootloader
    config file contains nul bytes.

  This is CVE-2016-9379 and CVE-2016-9380 / XSA-198.

  Signed-off-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  Tested-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 27e14d346ed6ff1c3a3cfc479507e62d133e92a9
  master date: 2016-11-22 13:52:09 +0100
  27e14d346ed6ff1c3a3cfc479507e62d133e92a9:pygrub: Properly quote results, when returning them to the caller:

  * When the caller wants sexpr output, use `repr()'
    This is what Xend expects.

    The returned S-expressions are now escaped and quoted by Python,
    generally using '...'.  Previously kernel and ramdisk were unquoted
    and args was quoted with "..." but without proper escaping.  This
    change may break toolstacks which do not properly dequote the
    returned S-expressions.

  * When the caller wants "simple" output, crash if the delimiter is
    contained in the returned value.

    With --output-format=simple it does not seem like this could ever
    happen, because the bootloader config parsers all take line-based
    input from the various bootloader config files.

    With --output-format=simple0, this can happen if the bootloader
    config file contains nul bytes.

  This is CVE-2016-9379 and CVE-2016-9380 / XSA-198.

  Signed-off-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  Tested-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 27e14d346ed6ff1c3a3cfc479507e62d133e92a9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 514173d3f8623194aa607f71866a240d02d432e8
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 6639a202f285ace4adf57453ade066bd4b4298e0
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8e7b84dd2a187edc74f44b69437734b8e4af9628
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 206fc7084dfaf05c55fd9de650f93a7ef9fe0722
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/206fc7084dfaf05c55fd9de650f93a7ef9fe0722
    reference_type: commit
    reference_id: 206fc7084dfaf05c55fd9de650f93a7ef9fe0722
  - url: https://github.com/xen-project/xen/tree/27e14d346ed6ff1c3a3cfc479507e62d133e92a9
    reference_type: commit
    reference_id: 27e14d346ed6ff1c3a3cfc479507e62d133e92a9
  - url: https://github.com/xen-project/xen/tree/514173d3f8623194aa607f71866a240d02d432e8
    reference_type: commit
    reference_id: 514173d3f8623194aa607f71866a240d02d432e8
  - url: https://github.com/xen-project/xen/tree/6639a202f285ace4adf57453ade066bd4b4298e0
    reference_type: commit
    reference_id: 6639a202f285ace4adf57453ade066bd4b4298e0
  - url: https://github.com/xen-project/xen/tree/8e7b84dd2a187edc74f44b69437734b8e4af9628
    reference_type: commit
    reference_id: 8e7b84dd2a187edc74f44b69437734b8e4af9628
