advisory_id: CVE-2013-1918
datasource_id: collect_xen_project_fix_commits/CVE-2013-1918
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  8eb2e89bfad8d55d0ca770e2a0988c945b318e03:x86: make page table handling error paths preemptible

  ... as they may take significant amounts of time.

  This requires cloning the tweaked continuation logic from
  do_mmuext_op() to do_mmu_update().

  Note that in mod_l[34]_entry() a negative "preemptible" value gets
  passed to put_page_from_l[34]e() now, telling the callee to store the
  respective page in current->arch.old_guest_table (for a hypercall
  continuation to pick up), rather than carrying out the put right away.
  This is going to be made a little more explicit by a subsequent cleanup
  patch.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: b8efae696c9a2d46e91fa0eda739427efc16c250
  master date: 2013-05-02 16:39:37 +0200
  09f9f72fa3dc2e239359741596fa349d8461cb50:x86: make page table unpinning preemptible

  ... as it may take significant amounts of time.

  Since we can't re-invoke the operation in a second attempt, the
  continuation logic must be slightly tweaked so that we make sure
  do_mmuext_op() gets run one more time even when the preempted unpin
  operation was the last one in a batch.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: a3e049f8e86fe18e3b87f18dc0c7be665026fd9f
  master date: 2013-05-02 16:39:06 +0200
  02615aaefd5c6c5856b4f81799bb6ec1ca0d89d0:x86: make arch_set_info_guest() preemptible

  .. as the root page table validation (and the dropping of an eventual
  old one) can require meaningful amounts of time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: 99d2b149915010e986f4d8778708c5891e7b4635
  master date: 2013-05-02 16:38:30 +0200
  c6fad967aabeb98da8307e59f73474b23b42f0d1:x86: make vcpu_reset() preemptible

  ... as dropping the old page tables may take significant amounts of
  time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: 4939f9a6dee4280f38730fd3066e5dce353112f6
  master date: 2013-05-02 16:37:24 +0200
  210e61b80c29ef824f5fdc5946d6d876b8875fe3:x86: make MMUEXT_NEW_USER_BASEPTR preemptible

  ... as it may take significant amounts of time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: 918a5f17b447072b40780f4d03a3adc99ff0073b
  master date: 2013-05-02 16:36:44 +0200
  06a68a09df243b175d1737a95df2e6f153cbae42:x86: make new_guest_cr3() preemptible

  ... as it may take significant amounts of time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: e2e6b7b627fec0d7a769ab46441f2985ebccbf04
  master date: 2013-05-02 16:35:50 +0200
  7a93b9a11c99a88f293c3e1e3a79914b6d13b3aa:x86: make vcpu_destroy_pagetables() preemptible

  ... as it may take significant amounts of time.

  The function, being moved to mm.c as the better home for it anyway, and
  to avoid having to make a new helper function there non-static, is
  given a "preemptible" parameter temporarily (until, in a subsequent
  patch, its other caller is also being made capable of dealing with
  preemption).

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: 6cdc9be2a5f2a87b4504404fbf648d16d9503c19
  master date: 2013-05-02 16:34:21 +0200
  a4b2683b11cce70f9bff74d6cb615e8effa2e32f:x86: make page table handling error paths preemptible

  ... as they may take significant amounts of time.

  This requires cloning the tweaked continuation logic from
  do_mmuext_op() to do_mmu_update().

  Note that in mod_l[34]_entry() a negative "preemptible" value gets
  passed to put_page_from_l[34]e() now, telling the callee to store the
  respective page in current->arch.old_guest_table (for a hypercall
  continuation to pick up), rather than carrying out the put right away.
  This is going to be made a little more explicit by a subsequent cleanup
  patch.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: b8efae696c9a2d46e91fa0eda739427efc16c250
  master date: 2013-05-02 16:39:37 +0200
  3e5c1c0093013a4274124eee7862f8e41021b220:x86: make page table unpinning preemptible

  ... as it may take significant amounts of time.

  Since we can't re-invoke the operation in a second attempt, the
  continuation logic must be slightly tweaked so that we make sure
  do_mmuext_op() gets run one more time even when the preempted unpin
  operation was the last one in a batch.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: a3e049f8e86fe18e3b87f18dc0c7be665026fd9f
  master date: 2013-05-02 16:39:06 +0200
  dba35fad5518ab3cd6a0972f9ed5629b1df91d69:x86: make arch_set_info_guest() preemptible

  .. as the root page table validation (and the dropping of an eventual
  old one) can require meaningful amounts of time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: 99d2b149915010e986f4d8778708c5891e7b4635
  master date: 2013-05-02 16:38:30 +0200
  f26f9b20b15b98a47906ae082bc56fd6832e0a73:x86: make vcpu_reset() preemptible

  ... as dropping the old page tables may take significant amounts of
  time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: 4939f9a6dee4280f38730fd3066e5dce353112f6
  master date: 2013-05-02 16:37:24 +0200
  f1d1abcc1f5b8c541dd8ef2d970907b2b3515465:x86: make MMUEXT_NEW_USER_BASEPTR preemptible

  ... as it may take significant amounts of time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: 918a5f17b447072b40780f4d03a3adc99ff0073b
  master date: 2013-05-02 16:36:44 +0200
  a8f694905923e9ad4067d0fb63dbbcfb6e585bff:x86: make new_guest_cr3() preemptible

  ... as it may take significant amounts of time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: e2e6b7b627fec0d7a769ab46441f2985ebccbf04
  master date: 2013-05-02 16:35:50 +0200
  f8bdc889ce8e8fe85e6a9f94922d30d765546e72:x86: make vcpu_destroy_pagetables() preemptible

  ... as it may take significant amounts of time.

  The function, being moved to mm.c as the better home for it anyway, and
  to avoid having to make a new helper function there non-static, is
  given a "preemptible" parameter temporarily (until, in a subsequent
  patch, its other caller is also being made capable of dealing with
  preemption).

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  master commit: 6cdc9be2a5f2a87b4504404fbf648d16d9503c19
  master date: 2013-05-02 16:34:21 +0200
  b8efae696c9a2d46e91fa0eda739427efc16c250:x86: make page table handling error paths preemptible

  ... as they may take significant amounts of time.

  This requires cloning the tweaked continuation logic from
  do_mmuext_op() to do_mmu_update().

  Note that in mod_l[34]_entry() a negative "preemptible" value gets
  passed to put_page_from_l[34]e() now, telling the callee to store the
  respective page in current->arch.old_guest_table (for a hypercall
  continuation to pick up), rather than carrying out the put right away.
  This is going to be made a little more explicit by a subsequent cleanup
  patch.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  a3e049f8e86fe18e3b87f18dc0c7be665026fd9f:x86: make page table unpinning preemptible

  ... as it may take significant amounts of time.

  Since we can't re-invoke the operation in a second attempt, the
  continuation logic must be slightly tweaked so that we make sure
  do_mmuext_op() gets run one more time even when the preempted unpin
  operation was the last one in a batch.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  99d2b149915010e986f4d8778708c5891e7b4635:x86: make arch_set_info_guest() preemptible

  .. as the root page table validation (and the dropping of an eventual
  old one) can require meaningful amounts of time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  4939f9a6dee4280f38730fd3066e5dce353112f6:x86: make vcpu_reset() preemptible

  ... as dropping the old page tables may take significant amounts of
  time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  918a5f17b447072b40780f4d03a3adc99ff0073b:x86: make MMUEXT_NEW_USER_BASEPTR preemptible

  ... as it may take significant amounts of time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  e2e6b7b627fec0d7a769ab46441f2985ebccbf04:x86: make new_guest_cr3() preemptible

  ... as it may take significant amounts of time.

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
  6cdc9be2a5f2a87b4504404fbf648d16d9503c19:x86: make vcpu_destroy_pagetables() preemptible

  ... as it may take significant amounts of time.

  The function, being moved to mm.c as the better home for it anyway, and
  to avoid having to make a new helper function there non-static, is
  given a "preemptible" parameter temporarily (until, in a subsequent
  patch, its other caller is also being made capable of dealing with
  preemption).

  This is part of CVE-2013-1918 / XSA-45.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Tim Deegan <tim@xen.org>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 99d2b149915010e986f4d8778708c5891e7b4635
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a4b2683b11cce70f9bff74d6cb615e8effa2e32f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f26f9b20b15b98a47906ae082bc56fd6832e0a73
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f1d1abcc1f5b8c541dd8ef2d970907b2b3515465
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 918a5f17b447072b40780f4d03a3adc99ff0073b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 210e61b80c29ef824f5fdc5946d6d876b8875fe3
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4939f9a6dee4280f38730fd3066e5dce353112f6
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8eb2e89bfad8d55d0ca770e2a0988c945b318e03
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7a93b9a11c99a88f293c3e1e3a79914b6d13b3aa
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 6cdc9be2a5f2a87b4504404fbf648d16d9503c19
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 09f9f72fa3dc2e239359741596fa349d8461cb50
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 02615aaefd5c6c5856b4f81799bb6ec1ca0d89d0
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 06a68a09df243b175d1737a95df2e6f153cbae42
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e2e6b7b627fec0d7a769ab46441f2985ebccbf04
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c6fad967aabeb98da8307e59f73474b23b42f0d1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a8f694905923e9ad4067d0fb63dbbcfb6e585bff
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3e5c1c0093013a4274124eee7862f8e41021b220
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b8efae696c9a2d46e91fa0eda739427efc16c250
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f8bdc889ce8e8fe85e6a9f94922d30d765546e72
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a3e049f8e86fe18e3b87f18dc0c7be665026fd9f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: dba35fad5518ab3cd6a0972f9ed5629b1df91d69
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/02615aaefd5c6c5856b4f81799bb6ec1ca0d89d0
    reference_type: commit
    reference_id: 02615aaefd5c6c5856b4f81799bb6ec1ca0d89d0
  - url: https://github.com/xen-project/xen/tree/06a68a09df243b175d1737a95df2e6f153cbae42
    reference_type: commit
    reference_id: 06a68a09df243b175d1737a95df2e6f153cbae42
  - url: https://github.com/xen-project/xen/tree/09f9f72fa3dc2e239359741596fa349d8461cb50
    reference_type: commit
    reference_id: 09f9f72fa3dc2e239359741596fa349d8461cb50
  - url: https://github.com/xen-project/xen/tree/210e61b80c29ef824f5fdc5946d6d876b8875fe3
    reference_type: commit
    reference_id: 210e61b80c29ef824f5fdc5946d6d876b8875fe3
  - url: https://github.com/xen-project/xen/tree/3e5c1c0093013a4274124eee7862f8e41021b220
    reference_type: commit
    reference_id: 3e5c1c0093013a4274124eee7862f8e41021b220
  - url: https://github.com/xen-project/xen/tree/4939f9a6dee4280f38730fd3066e5dce353112f6
    reference_type: commit
    reference_id: 4939f9a6dee4280f38730fd3066e5dce353112f6
  - url: https://github.com/xen-project/xen/tree/6cdc9be2a5f2a87b4504404fbf648d16d9503c19
    reference_type: commit
    reference_id: 6cdc9be2a5f2a87b4504404fbf648d16d9503c19
  - url: https://github.com/xen-project/xen/tree/7a93b9a11c99a88f293c3e1e3a79914b6d13b3aa
    reference_type: commit
    reference_id: 7a93b9a11c99a88f293c3e1e3a79914b6d13b3aa
  - url: https://github.com/xen-project/xen/tree/8eb2e89bfad8d55d0ca770e2a0988c945b318e03
    reference_type: commit
    reference_id: 8eb2e89bfad8d55d0ca770e2a0988c945b318e03
  - url: https://github.com/xen-project/xen/tree/918a5f17b447072b40780f4d03a3adc99ff0073b
    reference_type: commit
    reference_id: 918a5f17b447072b40780f4d03a3adc99ff0073b
  - url: https://github.com/xen-project/xen/tree/99d2b149915010e986f4d8778708c5891e7b4635
    reference_type: commit
    reference_id: 99d2b149915010e986f4d8778708c5891e7b4635
  - url: https://github.com/xen-project/xen/tree/a3e049f8e86fe18e3b87f18dc0c7be665026fd9f
    reference_type: commit
    reference_id: a3e049f8e86fe18e3b87f18dc0c7be665026fd9f
  - url: https://github.com/xen-project/xen/tree/a4b2683b11cce70f9bff74d6cb615e8effa2e32f
    reference_type: commit
    reference_id: a4b2683b11cce70f9bff74d6cb615e8effa2e32f
  - url: https://github.com/xen-project/xen/tree/a8f694905923e9ad4067d0fb63dbbcfb6e585bff
    reference_type: commit
    reference_id: a8f694905923e9ad4067d0fb63dbbcfb6e585bff
  - url: https://github.com/xen-project/xen/tree/b8efae696c9a2d46e91fa0eda739427efc16c250
    reference_type: commit
    reference_id: b8efae696c9a2d46e91fa0eda739427efc16c250
  - url: https://github.com/xen-project/xen/tree/c6fad967aabeb98da8307e59f73474b23b42f0d1
    reference_type: commit
    reference_id: c6fad967aabeb98da8307e59f73474b23b42f0d1
  - url: https://github.com/xen-project/xen/tree/dba35fad5518ab3cd6a0972f9ed5629b1df91d69
    reference_type: commit
    reference_id: dba35fad5518ab3cd6a0972f9ed5629b1df91d69
  - url: https://github.com/xen-project/xen/tree/e2e6b7b627fec0d7a769ab46441f2985ebccbf04
    reference_type: commit
    reference_id: e2e6b7b627fec0d7a769ab46441f2985ebccbf04
  - url: https://github.com/xen-project/xen/tree/f1d1abcc1f5b8c541dd8ef2d970907b2b3515465
    reference_type: commit
    reference_id: f1d1abcc1f5b8c541dd8ef2d970907b2b3515465
  - url: https://github.com/xen-project/xen/tree/f26f9b20b15b98a47906ae082bc56fd6832e0a73
    reference_type: commit
    reference_id: f26f9b20b15b98a47906ae082bc56fd6832e0a73
  - url: https://github.com/xen-project/xen/tree/f8bdc889ce8e8fe85e6a9f94922d30d765546e72
    reference_type: commit
    reference_id: f8bdc889ce8e8fe85e6a9f94922d30d765546e72
