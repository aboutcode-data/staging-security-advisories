advisory_id: CVE-2025-58144
datasource_id: collect_xen_project_fix_commits/CVE-2025-58144
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  0b39ff2964219f3321ece7abbfd87f98e8cfa5c7:Arm: foreign page handling in p2m_get_page_from_gfn()

  I can't see what would make the 1st of the assertions safe: For example,
  the P2M lock not being held, the foreign page may disappear before we
  get to call page_get_owner_and_reference(), which hence may return NULL.

  Even the 2nd, which appears to be safe safe, is lacking proper release
  build fallbacks.

  Drop the former in favor of an if(), and convert the latter to the
  equivalent of what x86 uses: ASSERT_UNREACHABLE() plus putting of the
  obtained page.

  This is CVE-2025-58144 / part of XSA-473.

  Fixes: 9486a8d07ba8 ("xen/arm: Handle remove foreign mapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  master commit: c5a6dd68508c998c95ca87f59e9ecb6da93ca6ab
  master date: 2025-09-09 14:12:13 +0200
  46c0b23f17e3fecacd0a9f156c2d1ca440a6b471:Arm: foreign page handling in p2m_get_page_from_gfn()

  I can't see what would make the 1st of the assertions safe: For example,
  the P2M lock not being held, the foreign page may disappear before we
  get to call page_get_owner_and_reference(), which hence may return NULL.

  Even the 2nd, which appears to be safe safe, is lacking proper release
  build fallbacks.

  Drop the former in favor of an if(), and convert the latter to the
  equivalent of what x86 uses: ASSERT_UNREACHABLE() plus putting of the
  obtained page.

  This is CVE-2025-58144 / part of XSA-473.

  Fixes: 9486a8d07ba8 ("xen/arm: Handle remove foreign mapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  master commit: c5a6dd68508c998c95ca87f59e9ecb6da93ca6ab
  master date: 2025-09-09 14:12:13 +0200
  8634f3ef0625cb7eee43dc972c75b427fd08c548:Arm: foreign page handling in p2m_get_page_from_gfn()

  I can't see what would make the 1st of the assertions safe: For example,
  the P2M lock not being held, the foreign page may disappear before we
  get to call page_get_owner_and_reference(), which hence may return NULL.

  Even the 2nd, which appears to be safe safe, is lacking proper release
  build fallbacks.

  Drop the former in favor of an if(), and convert the latter to the
  equivalent of what x86 uses: ASSERT_UNREACHABLE() plus putting of the
  obtained page.

  This is CVE-2025-58144 / part of XSA-473.

  Fixes: 9486a8d07ba8 ("xen/arm: Handle remove foreign mapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  master commit: c5a6dd68508c998c95ca87f59e9ecb6da93ca6ab
  master date: 2025-09-09 14:12:13 +0200
  1230b94f1c9eab96a2c6f4e0de8a511b6247c289:Arm: foreign page handling in p2m_get_page_from_gfn()

  I can't see what would make the 1st of the assertions safe: For example,
  the P2M lock not being held, the foreign page may disappear before we
  get to call page_get_owner_and_reference(), which hence may return NULL.

  Even the 2nd, which appears to be safe safe, is lacking proper release
  build fallbacks.

  Drop the former in favor of an if(), and convert the latter to the
  equivalent of what x86 uses: ASSERT_UNREACHABLE() plus putting of the
  obtained page.

  This is CVE-2025-58144 / part of XSA-473.

  Fixes: 9486a8d07ba8 ("xen/arm: Handle remove foreign mapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  master commit: c5a6dd68508c998c95ca87f59e9ecb6da93ca6ab
  master date: 2025-09-09 14:12:13 +0200
  c5a6dd68508c998c95ca87f59e9ecb6da93ca6ab:Arm: foreign page handling in p2m_get_page_from_gfn()

  I can't see what would make the 1st of the assertions safe: For example,
  the P2M lock not being held, the foreign page may disappear before we
  get to call page_get_owner_and_reference(), which hence may return NULL.

  Even the 2nd, which appears to be safe safe, is lacking proper release
  build fallbacks.

  Drop the former in favor of an if(), and convert the latter to the
  equivalent of what x86 uses: ASSERT_UNREACHABLE() plus putting of the
  obtained page.

  This is CVE-2025-58144 / part of XSA-473.

  Fixes: 9486a8d07ba8 ("xen/arm: Handle remove foreign mapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8634f3ef0625cb7eee43dc972c75b427fd08c548
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c5a6dd68508c998c95ca87f59e9ecb6da93ca6ab
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0b39ff2964219f3321ece7abbfd87f98e8cfa5c7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 46c0b23f17e3fecacd0a9f156c2d1ca440a6b471
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1230b94f1c9eab96a2c6f4e0de8a511b6247c289
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/0b39ff2964219f3321ece7abbfd87f98e8cfa5c7
    reference_type: commit
    reference_id: 0b39ff2964219f3321ece7abbfd87f98e8cfa5c7
  - url: https://github.com/xen-project/xen/tree/1230b94f1c9eab96a2c6f4e0de8a511b6247c289
    reference_type: commit
    reference_id: 1230b94f1c9eab96a2c6f4e0de8a511b6247c289
  - url: https://github.com/xen-project/xen/tree/46c0b23f17e3fecacd0a9f156c2d1ca440a6b471
    reference_type: commit
    reference_id: 46c0b23f17e3fecacd0a9f156c2d1ca440a6b471
  - url: https://github.com/xen-project/xen/tree/8634f3ef0625cb7eee43dc972c75b427fd08c548
    reference_type: commit
    reference_id: 8634f3ef0625cb7eee43dc972c75b427fd08c548
  - url: https://github.com/xen-project/xen/tree/c5a6dd68508c998c95ca87f59e9ecb6da93ca6ab
    reference_type: commit
    reference_id: c5a6dd68508c998c95ca87f59e9ecb6da93ca6ab
