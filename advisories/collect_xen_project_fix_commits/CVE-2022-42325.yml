advisory_id: CVE-2022-42325
datasource_id: collect_xen_project_fix_commits/CVE-2022-42325
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  30a293fba36b438d90b802132d70020e76086058:tools/xenstore: fix deleting node in transaction

  In case a node has been created in a transaction and it is later
  deleted in the same transaction, the transaction will be terminated
  with an error.

  As this error is encountered only when handling the deleted node at
  transaction finalization, the transaction will have been performed
  partially and without updating the accounting information. This will
  enable a malicious guest to create arbitrary number of nodes.

  This is part of XSA-421 / CVE-2022-42325.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Tested-by: Julien Grall <jgrall@amazon.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 13ac37f1416cae88d97f7baf6cf2a827edb9a187)
  fd44be9ccb0b8704497498e45e020738a11d27e3:tools/xenstore: fix deleting node in transaction

  In case a node has been created in a transaction and it is later
  deleted in the same transaction, the transaction will be terminated
  with an error.

  As this error is encountered only when handling the deleted node at
  transaction finalization, the transaction will have been performed
  partially and without updating the accounting information. This will
  enable a malicious guest to create arbitrary number of nodes.

  This is part of XSA-421 / CVE-2022-42325.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Tested-by: Julien Grall <jgrall@amazon.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 13ac37f1416cae88d97f7baf6cf2a827edb9a187)
  2d3476effe3a9236867562f14dc26979a6527080:tools/xenstore: fix deleting node in transaction

  In case a node has been created in a transaction and it is later
  deleted in the same transaction, the transaction will be terminated
  with an error.

  As this error is encountered only when handling the deleted node at
  transaction finalization, the transaction will have been performed
  partially and without updating the accounting information. This will
  enable a malicious guest to create arbitrary number of nodes.

  This is part of XSA-421 / CVE-2022-42325.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Tested-by: Julien Grall <jgrall@amazon.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 13ac37f1416cae88d97f7baf6cf2a827edb9a187)
  4305807dfdc183f4acd170fe00eb66b338fa6430:tools/xenstore: fix deleting node in transaction

  In case a node has been created in a transaction and it is later
  deleted in the same transaction, the transaction will be terminated
  with an error.

  As this error is encountered only when handling the deleted node at
  transaction finalization, the transaction will have been performed
  partially and without updating the accounting information. This will
  enable a malicious guest to create arbitrary number of nodes.

  This is part of XSA-421 / CVE-2022-42325.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Tested-by: Julien Grall <jgrall@amazon.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
  (cherry picked from commit 13ac37f1416cae88d97f7baf6cf2a827edb9a187)
  13ac37f1416cae88d97f7baf6cf2a827edb9a187:tools/xenstore: fix deleting node in transaction

  In case a node has been created in a transaction and it is later
  deleted in the same transaction, the transaction will be terminated
  with an error.

  As this error is encountered only when handling the deleted node at
  transaction finalization, the transaction will have been performed
  partially and without updating the accounting information. This will
  enable a malicious guest to create arbitrary number of nodes.

  This is part of XSA-421 / CVE-2022-42325.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Tested-by: Julien Grall <jgrall@amazon.com>
  Reviewed-by: Julien Grall <jgrall@amazon.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 30a293fba36b438d90b802132d70020e76086058
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 13ac37f1416cae88d97f7baf6cf2a827edb9a187
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4305807dfdc183f4acd170fe00eb66b338fa6430
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2d3476effe3a9236867562f14dc26979a6527080
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: fd44be9ccb0b8704497498e45e020738a11d27e3
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/13ac37f1416cae88d97f7baf6cf2a827edb9a187
    reference_type: commit
    reference_id: 13ac37f1416cae88d97f7baf6cf2a827edb9a187
  - url: https://github.com/xen-project/xen/tree/2d3476effe3a9236867562f14dc26979a6527080
    reference_type: commit
    reference_id: 2d3476effe3a9236867562f14dc26979a6527080
  - url: https://github.com/xen-project/xen/tree/30a293fba36b438d90b802132d70020e76086058
    reference_type: commit
    reference_id: 30a293fba36b438d90b802132d70020e76086058
  - url: https://github.com/xen-project/xen/tree/4305807dfdc183f4acd170fe00eb66b338fa6430
    reference_type: commit
    reference_id: 4305807dfdc183f4acd170fe00eb66b338fa6430
  - url: https://github.com/xen-project/xen/tree/fd44be9ccb0b8704497498e45e020738a11d27e3
    reference_type: commit
    reference_id: fd44be9ccb0b8704497498e45e020738a11d27e3
