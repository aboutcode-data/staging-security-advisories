advisory_id: CVE-2017-14319
datasource_id: collect_xen_project_fix_commits/CVE-2017-14319
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  83724d9f3ae21a3b96362742e2f052b19d9f559a:gnttab: also validate PTE permissions upon destroy/replace

  In order for PTE handling to match up with the reference counting done
  by common code, presence and writability of grant mapping PTEs must
  also be taken into account; validating just the frame number is not
  enough. This is in particular relevant if a guest fiddles with grant
  PTEs via non-grant hypercalls.

  Note that the flags being passed to replace_grant_host_mapping()
  already happen to be those of the existing mapping, so no new function
  parameter is needed.

  This is CVE-2017-14319 / XSA-234.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 16b1414de91b5a82a0996c67f6db3af7d7e32873
  master date: 2017-09-12 14:45:13 +0200
  1658a87690ac839e85db12bbf409be62bb938640:gnttab: also validate PTE permissions upon destroy/replace

  In order for PTE handling to match up with the reference counting done
  by common code, presence and writability of grant mapping PTEs must
  also be taken into account; validating just the frame number is not
  enough. This is in particular relevant if a guest fiddles with grant
  PTEs via non-grant hypercalls.

  Note that the flags being passed to replace_grant_host_mapping()
  already happen to be those of the existing mapping, so no new function
  parameter is needed.

  This is CVE-2017-14319 / XSA-234.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 16b1414de91b5a82a0996c67f6db3af7d7e32873
  master date: 2017-09-12 14:45:13 +0200
  c7783d9c26fc191862d9883da22387340b1fab18:gnttab: also validate PTE permissions upon destroy/replace

  In order for PTE handling to match up with the reference counting done
  by common code, presence and writability of grant mapping PTEs must
  also be taken into account; validating just the frame number is not
  enough. This is in particular relevant if a guest fiddles with grant
  PTEs via non-grant hypercalls.

  Note that the flags being passed to replace_grant_host_mapping()
  already happen to be those of the existing mapping, so no new function
  parameter is needed.

  This is CVE-2017-14319 / XSA-234.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 16b1414de91b5a82a0996c67f6db3af7d7e32873
  master date: 2017-09-12 14:45:13 +0200
  36898eb12572f0a1f85cb54d4a9e90afcb6f7045:gnttab: also validate PTE permissions upon destroy/replace

  In order for PTE handling to match up with the reference counting done
  by common code, presence and writability of grant mapping PTEs must
  also be taken into account; validating just the frame number is not
  enough. This is in particular relevant if a guest fiddles with grant
  PTEs via non-grant hypercalls.

  Note that the flags being passed to replace_grant_host_mapping()
  already happen to be those of the existing mapping, so no new function
  parameter is needed.

  This is CVE-2017-14319 / XSA-234.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 16b1414de91b5a82a0996c67f6db3af7d7e32873
  master date: 2017-09-12 14:45:13 +0200
  2cc3d32f40c71cb242477a3f8938074d4fc36829:gnttab: also validate PTE permissions upon destroy/replace

  In order for PTE handling to match up with the reference counting done
  by common code, presence and writability of grant mapping PTEs must
  also be taken into account; validating just the frame number is not
  enough. This is in particular relevant if a guest fiddles with grant
  PTEs via non-grant hypercalls.

  Note that the flags being passed to replace_grant_host_mapping()
  already happen to be those of the existing mapping, so no new function
  parameter is needed.

  This is CVE-2017-14319 / XSA-234.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 16b1414de91b5a82a0996c67f6db3af7d7e32873
  master date: 2017-09-12 14:45:13 +0200
  16b1414de91b5a82a0996c67f6db3af7d7e32873:gnttab: also validate PTE permissions upon destroy/replace

  In order for PTE handling to match up with the reference counting done
  by common code, presence and writability of grant mapping PTEs must
  also be taken into account; validating just the frame number is not
  enough. This is in particular relevant if a guest fiddles with grant
  PTEs via non-grant hypercalls.

  Note that the flags being passed to replace_grant_host_mapping()
  already happen to be those of the existing mapping, so no new function
  parameter is needed.

  This is CVE-2017-14319 / XSA-234.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 36898eb12572f0a1f85cb54d4a9e90afcb6f7045
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1658a87690ac839e85db12bbf409be62bb938640
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 83724d9f3ae21a3b96362742e2f052b19d9f559a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2cc3d32f40c71cb242477a3f8938074d4fc36829
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c7783d9c26fc191862d9883da22387340b1fab18
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 16b1414de91b5a82a0996c67f6db3af7d7e32873
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/1658a87690ac839e85db12bbf409be62bb938640
    reference_type: commit
    reference_id: 1658a87690ac839e85db12bbf409be62bb938640
  - url: https://github.com/xen-project/xen/tree/16b1414de91b5a82a0996c67f6db3af7d7e32873
    reference_type: commit
    reference_id: 16b1414de91b5a82a0996c67f6db3af7d7e32873
  - url: https://github.com/xen-project/xen/tree/2cc3d32f40c71cb242477a3f8938074d4fc36829
    reference_type: commit
    reference_id: 2cc3d32f40c71cb242477a3f8938074d4fc36829
  - url: https://github.com/xen-project/xen/tree/36898eb12572f0a1f85cb54d4a9e90afcb6f7045
    reference_type: commit
    reference_id: 36898eb12572f0a1f85cb54d4a9e90afcb6f7045
  - url: https://github.com/xen-project/xen/tree/83724d9f3ae21a3b96362742e2f052b19d9f559a
    reference_type: commit
    reference_id: 83724d9f3ae21a3b96362742e2f052b19d9f559a
  - url: https://github.com/xen-project/xen/tree/c7783d9c26fc191862d9883da22387340b1fab18
    reference_type: commit
    reference_id: c7783d9c26fc191862d9883da22387340b1fab18
