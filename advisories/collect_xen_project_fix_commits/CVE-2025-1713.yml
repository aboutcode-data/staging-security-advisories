advisory_id: CVE-2025-1713
datasource_id: collect_xen_project_fix_commits/CVE-2025-1713
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  574e42e3fbf32f3a4e03c1af6e4a1a2dc9628416:IOMMU/x86: the bus-to-bridge lock needs to be acquired IRQ-safe

  The function's use from set_msi_source_id() is guaranteed to be in an
  IRQs-off region. While the invocation of that function could be moved
  ahead in msi_msg_to_remap_entry() (doesn't need to be in the IOMMU-
  intremap-locked region), the call tree from map_domain_pirq() holds an
  IRQ descriptor lock. Hence all use sites of the lock need become IRQ-
  safe ones.

  In find_upstream_bridge() do a tiny bit of tidying in adjacent code:
  Change a variable's type to unsigned and merge a redundant assignment
  into another variable's initializer.

  This is XSA-467 / CVE-2025-1713.

  Fixes: 476bbccc811c ("VT-d: fix MSI source-id of interrupt remapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 39bc6af3ba483282ed6bbf94b08aec38c93d39e6)
  746df32732dcdb51d3af1a0070d3fdb8f8dd03b1:IOMMU/x86: the bus-to-bridge lock needs to be acquired IRQ-safe

  The function's use from set_msi_source_id() is guaranteed to be in an
  IRQs-off region. While the invocation of that function could be moved
  ahead in msi_msg_to_remap_entry() (doesn't need to be in the IOMMU-
  intremap-locked region), the call tree from map_domain_pirq() holds an
  IRQ descriptor lock. Hence all use sites of the lock need become IRQ-
  safe ones.

  In find_upstream_bridge() do a tiny bit of tidying in adjacent code:
  Change a variable's type to unsigned and merge a redundant assignment
  into another variable's initializer.

  This is XSA-467 / CVE-2025-1713.

  Fixes: 476bbccc811c ("VT-d: fix MSI source-id of interrupt remapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 39bc6af3ba483282ed6bbf94b08aec38c93d39e6)
  f2c5b4b1aa1972b522bfb5207f4b771681ef8fd2:IOMMU/x86: the bus-to-bridge lock needs to be acquired IRQ-safe

  The function's use from set_msi_source_id() is guaranteed to be in an
  IRQs-off region. While the invocation of that function could be moved
  ahead in msi_msg_to_remap_entry() (doesn't need to be in the IOMMU-
  intremap-locked region), the call tree from map_domain_pirq() holds an
  IRQ descriptor lock. Hence all use sites of the lock need become IRQ-
  safe ones.

  In find_upstream_bridge() do a tiny bit of tidying in adjacent code:
  Change a variable's type to unsigned and merge a redundant assignment
  into another variable's initializer.

  This is XSA-467 / CVE-2025-1713.

  Fixes: 476bbccc811c ("VT-d: fix MSI source-id of interrupt remapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 39bc6af3ba483282ed6bbf94b08aec38c93d39e6)
  c0a7c96182710106bdc8ba79ae2e3ec22cbede8c:IOMMU/x86: the bus-to-bridge lock needs to be acquired IRQ-safe

  The function's use from set_msi_source_id() is guaranteed to be in an
  IRQs-off region. While the invocation of that function could be moved
  ahead in msi_msg_to_remap_entry() (doesn't need to be in the IOMMU-
  intremap-locked region), the call tree from map_domain_pirq() holds an
  IRQ descriptor lock. Hence all use sites of the lock need become IRQ-
  safe ones.

  In find_upstream_bridge() do a tiny bit of tidying in adjacent code:
  Change a variable's type to unsigned and merge a redundant assignment
  into another variable's initializer.

  This is XSA-467 / CVE-2025-1713.

  Fixes: 476bbccc811c ("VT-d: fix MSI source-id of interrupt remapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
  (cherry picked from commit 39bc6af3ba483282ed6bbf94b08aec38c93d39e6)
  39bc6af3ba483282ed6bbf94b08aec38c93d39e6:IOMMU/x86: the bus-to-bridge lock needs to be acquired IRQ-safe

  The function's use from set_msi_source_id() is guaranteed to be in an
  IRQs-off region. While the invocation of that function could be moved
  ahead in msi_msg_to_remap_entry() (doesn't need to be in the IOMMU-
  intremap-locked region), the call tree from map_domain_pirq() holds an
  IRQ descriptor lock. Hence all use sites of the lock need become IRQ-
  safe ones.

  In find_upstream_bridge() do a tiny bit of tidying in adjacent code:
  Change a variable's type to unsigned and merge a redundant assignment
  into another variable's initializer.

  This is XSA-467 / CVE-2025-1713.

  Fixes: 476bbccc811c ("VT-d: fix MSI source-id of interrupt remapping")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  Reviewed-by: Roger Pau Monné <roger.pau@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c0a7c96182710106bdc8ba79ae2e3ec22cbede8c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 574e42e3fbf32f3a4e03c1af6e4a1a2dc9628416
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 746df32732dcdb51d3af1a0070d3fdb8f8dd03b1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 39bc6af3ba483282ed6bbf94b08aec38c93d39e6
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f2c5b4b1aa1972b522bfb5207f4b771681ef8fd2
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/39bc6af3ba483282ed6bbf94b08aec38c93d39e6
    reference_type: commit
    reference_id: 39bc6af3ba483282ed6bbf94b08aec38c93d39e6
  - url: https://github.com/xen-project/xen/tree/574e42e3fbf32f3a4e03c1af6e4a1a2dc9628416
    reference_type: commit
    reference_id: 574e42e3fbf32f3a4e03c1af6e4a1a2dc9628416
  - url: https://github.com/xen-project/xen/tree/746df32732dcdb51d3af1a0070d3fdb8f8dd03b1
    reference_type: commit
    reference_id: 746df32732dcdb51d3af1a0070d3fdb8f8dd03b1
  - url: https://github.com/xen-project/xen/tree/c0a7c96182710106bdc8ba79ae2e3ec22cbede8c
    reference_type: commit
    reference_id: c0a7c96182710106bdc8ba79ae2e3ec22cbede8c
  - url: https://github.com/xen-project/xen/tree/f2c5b4b1aa1972b522bfb5207f4b771681ef8fd2
    reference_type: commit
    reference_id: f2c5b4b1aa1972b522bfb5207f4b771681ef8fd2
