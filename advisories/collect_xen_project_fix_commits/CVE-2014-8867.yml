advisory_id: CVE-2014-8867
datasource_id: collect_xen_project_fix_commits/CVE-2014-8867
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  3e5c06aeea1ff91c3f2247baae372936b67cf411:x86/HVM: confine internally handled MMIO to solitary regions

  While it is generally wrong to cross region boundaries when dealing
  with MMIO accesses of repeated string instructions (currently only
  MOVS) as that would do things a guest doesn't expect (leaving aside
  that none of these regions would normally be accessed with repeated
  string instructions in the first place), this is even more of a problem
  for all virtual MSI-X page accesses (both msixtbl_{read,write}() can be
  made dereference NULL "entry" pointers this way) as well as undersized
  (1- or 2-byte) LAPIC writes (causing vlapic_read_aligned() to access
  space beyond the one memory page set up for holding LAPIC register
  values).

  Since those functions validly assume to be called only with addresses
  their respective checking functions indicated to be okay, it is generic
  code that needs to be fixed to clip the repetition count.

  To be on the safe side (and consistent), also do the same for buffered
  I/O intercepts, even if their only client (stdvga) doesn't put the
  hypervisor at risk (i.e. "only" guest misbehavior would result).

  This is CVE-2014-8867 / XSA-112.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  e0921ec746410f0a07eb3767e95e5eda25d4934a:x86/HVM: confine internally handled MMIO to solitary regions

  While it is generally wrong to cross region boundaries when dealing
  with MMIO accesses of repeated string instructions (currently only
  MOVS) as that would do things a guest doesn't expect (leaving aside
  that none of these regions would normally be accessed with repeated
  string instructions in the first place), this is even more of a problem
  for all virtual MSI-X page accesses (both msixtbl_{read,write}() can be
  made dereference NULL "entry" pointers this way) as well as undersized
  (1- or 2-byte) LAPIC writes (causing vlapic_read_aligned() to access
  space beyond the one memory page set up for holding LAPIC register
  values).

  Since those functions validly assume to be called only with addresses
  their respective checking functions indicated to be okay, it is generic
  code that needs to be fixed to clip the repetition count.

  To be on the safe side (and consistent), also do the same for buffered
  I/O intercepts, even if their only client (stdvga) doesn't put the
  hypervisor at risk (i.e. "only" guest misbehavior would result).

  This is CVE-2014-8867 / XSA-112.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  a39f202031d7f1d8d9e14b8c3d7d11c812db253e:x86/HVM: confine internally handled MMIO to solitary regions

  While it is generally wrong to cross region boundaries when dealing
  with MMIO accesses of repeated string instructions (currently only
  MOVS) as that would do things a guest doesn't expect (leaving aside
  that none of these regions would normally be accessed with repeated
  string instructions in the first place), this is even more of a problem
  for all virtual MSI-X page accesses (both msixtbl_{read,write}() can be
  made dereference NULL "entry" pointers this way) as well as undersized
  (1- or 2-byte) LAPIC writes (causing vlapic_read_aligned() to access
  space beyond the one memory page set up for holding LAPIC register
  values).

  Since those functions validly assume to be called only with addresses
  their respective checking functions indicated to be okay, it is generic
  code that needs to be fixed to clip the repetition count.

  To be on the safe side (and consistent), also do the same for buffered
  I/O intercepts, even if their only client (stdvga) doesn't put the
  hypervisor at risk (i.e. "only" guest misbehavior would result).

  This is CVE-2014-8867 / XSA-112.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: c5397354b998d030b021810b8202de93b9526818
  master date: 2014-11-27 14:01:40 +0100
  c5397354b998d030b021810b8202de93b9526818:x86/HVM: confine internally handled MMIO to solitary regions

  While it is generally wrong to cross region boundaries when dealing
  with MMIO accesses of repeated string instructions (currently only
  MOVS) as that would do things a guest doesn't expect (leaving aside
  that none of these regions would normally be accessed with repeated
  string instructions in the first place), this is even more of a problem
  for all virtual MSI-X page accesses (both msixtbl_{read,write}() can be
  made dereference NULL "entry" pointers this way) as well as undersized
  (1- or 2-byte) LAPIC writes (causing vlapic_read_aligned() to access
  space beyond the one memory page set up for holding LAPIC register
  values).

  Since those functions validly assume to be called only with addresses
  their respective checking functions indicated to be okay, it is generic
  code that needs to be fixed to clip the repetition count.

  To be on the safe side (and consistent), also do the same for buffered
  I/O intercepts, even if their only client (stdvga) doesn't put the
  hypervisor at risk (i.e. "only" guest misbehavior would result).

  This is CVE-2014-8867 / XSA-112.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3e5c06aeea1ff91c3f2247baae372936b67cf411
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c5397354b998d030b021810b8202de93b9526818
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a39f202031d7f1d8d9e14b8c3d7d11c812db253e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e0921ec746410f0a07eb3767e95e5eda25d4934a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/3e5c06aeea1ff91c3f2247baae372936b67cf411
    reference_type: commit
    reference_id: 3e5c06aeea1ff91c3f2247baae372936b67cf411
  - url: https://github.com/xen-project/xen/tree/a39f202031d7f1d8d9e14b8c3d7d11c812db253e
    reference_type: commit
    reference_id: a39f202031d7f1d8d9e14b8c3d7d11c812db253e
  - url: https://github.com/xen-project/xen/tree/c5397354b998d030b021810b8202de93b9526818
    reference_type: commit
    reference_id: c5397354b998d030b021810b8202de93b9526818
  - url: https://github.com/xen-project/xen/tree/e0921ec746410f0a07eb3767e95e5eda25d4934a
    reference_type: commit
    reference_id: e0921ec746410f0a07eb3767e95e5eda25d4934a
