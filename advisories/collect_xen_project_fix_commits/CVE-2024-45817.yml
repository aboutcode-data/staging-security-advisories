advisory_id: CVE-2024-45817
datasource_id: collect_xen_project_fix_commits/CVE-2024-45817
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  1765a3e0d178e9faf16cb3e19dd39cf22f29eae3:x86/vLAPIC: prevent undue recursion of vlapic_error()

  With the error vector set to an illegal value, the function invoking
  vlapic_set_irq() would bring execution back here, with the non-recursive
  lock already held. Avoid the call in this case, merely further updating
  ESR (if necessary).

  This is XSA-462 / CVE-2024-45817.

  Fixes: 5f32d186a8b1 ("x86/vlapic: don't silently accept bad vectors")
  Reported-by: Federico Serafini <federico.serafini@bugseng.com>
  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: c42d9ec61f6d11e25fa77bd44dd11dad1edda268
  master date: 2024-09-24 14:23:29 +0200
  3ef9196234bd3b0da239db8f10467d9fff257377:x86/vLAPIC: prevent undue recursion of vlapic_error()

  With the error vector set to an illegal value, the function invoking
  vlapic_set_irq() would bring execution back here, with the non-recursive
  lock already held. Avoid the call in this case, merely further updating
  ESR (if necessary).

  This is XSA-462 / CVE-2024-45817.

  Fixes: 5f32d186a8b1 ("x86/vlapic: don't silently accept bad vectors")
  Reported-by: Federico Serafini <federico.serafini@bugseng.com>
  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: c42d9ec61f6d11e25fa77bd44dd11dad1edda268
  master date: 2024-09-24 14:23:29 +0200
  641b8f2a924b86ab086878b5baaf2d50ba3658f1:x86/vLAPIC: prevent undue recursion of vlapic_error()

  With the error vector set to an illegal value, the function invoking
  vlapic_set_irq() would bring execution back here, with the non-recursive
  lock already held. Avoid the call in this case, merely further updating
  ESR (if necessary).

  This is XSA-462 / CVE-2024-45817.

  Fixes: 5f32d186a8b1 ("x86/vlapic: don't silently accept bad vectors")
  Reported-by: Federico Serafini <federico.serafini@bugseng.com>
  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: c42d9ec61f6d11e25fa77bd44dd11dad1edda268
  master date: 2024-09-24 14:23:29 +0200
  9358a7fad7f0427e7d1666da0c78cef341ee9072:x86/vLAPIC: prevent undue recursion of vlapic_error()

  With the error vector set to an illegal value, the function invoking
  vlapic_set_irq() would bring execution back here, with the non-recursive
  lock already held. Avoid the call in this case, merely further updating
  ESR (if necessary).

  This is XSA-462 / CVE-2024-45817.

  Fixes: 5f32d186a8b1 ("x86/vlapic: don't silently accept bad vectors")
  Reported-by: Federico Serafini <federico.serafini@bugseng.com>
  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: c42d9ec61f6d11e25fa77bd44dd11dad1edda268
  master date: 2024-09-24 14:23:29 +0200
  c42d9ec61f6d11e25fa77bd44dd11dad1edda268:x86/vLAPIC: prevent undue recursion of vlapic_error()

  With the error vector set to an illegal value, the function invoking
  vlapic_set_irq() would bring execution back here, with the non-recursive
  lock already held. Avoid the call in this case, merely further updating
  ESR (if necessary).

  This is XSA-462 / CVE-2024-45817.

  Fixes: 5f32d186a8b1 ("x86/vlapic: don't silently accept bad vectors")
  Reported-by: Federico Serafini <federico.serafini@bugseng.com>
  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c42d9ec61f6d11e25fa77bd44dd11dad1edda268
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1765a3e0d178e9faf16cb3e19dd39cf22f29eae3
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 641b8f2a924b86ab086878b5baaf2d50ba3658f1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3ef9196234bd3b0da239db8f10467d9fff257377
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9358a7fad7f0427e7d1666da0c78cef341ee9072
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/1765a3e0d178e9faf16cb3e19dd39cf22f29eae3
    reference_type: commit
    reference_id: 1765a3e0d178e9faf16cb3e19dd39cf22f29eae3
  - url: https://github.com/xen-project/xen/tree/3ef9196234bd3b0da239db8f10467d9fff257377
    reference_type: commit
    reference_id: 3ef9196234bd3b0da239db8f10467d9fff257377
  - url: https://github.com/xen-project/xen/tree/641b8f2a924b86ab086878b5baaf2d50ba3658f1
    reference_type: commit
    reference_id: 641b8f2a924b86ab086878b5baaf2d50ba3658f1
  - url: https://github.com/xen-project/xen/tree/9358a7fad7f0427e7d1666da0c78cef341ee9072
    reference_type: commit
    reference_id: 9358a7fad7f0427e7d1666da0c78cef341ee9072
  - url: https://github.com/xen-project/xen/tree/c42d9ec61f6d11e25fa77bd44dd11dad1edda268
    reference_type: commit
    reference_id: c42d9ec61f6d11e25fa77bd44dd11dad1edda268
