advisory_id: CVE-2016-9384
datasource_id: collect_xen_project_fix_commits/CVE-2016-9384
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  8ce2238f197fde118e291932d869a8a6c10ac539:libelf: fix stack memory leak when loading 32 bit symbol tables

  The 32 bit Elf structs are smaller than the 64 bit ones, which means that
  when loading them there's some padding left uninitialized at the end of each
  struct (because the size indicated in e_ehsize and e_shentsize is
  smaller than the size of elf_ehdr and elf_shdr).

  Fix this by introducing a new helper that is used to set
  [caller_]xdest_{base/size} and that takes care of performing the appropriate
  memset of the region. This newly introduced helper is then used to set and
  unset xdest_{base/size} in elf_load_bsdsyms. Now that the full struct
  is zeroed, there's no need to specifically zero the undefined section.

  This is CVE-2016-9384 / XSA-164.

  Suggested-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>

  Also remove the open coded (and redundant with the earlier
  elf_memset_unchecked()) use of caller_xdest_* from elf_init().

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Signed-off-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
  master commit: fb08f7d009a64b96efa4462c9d19ed6881936859
  master date: 2016-11-22 13:48:30 +0100
  fb08f7d009a64b96efa4462c9d19ed6881936859:libelf: fix stack memory leak when loading 32 bit symbol tables

  The 32 bit Elf structs are smaller than the 64 bit ones, which means that
  when loading them there's some padding left uninitialized at the end of each
  struct (because the size indicated in e_ehsize and e_shentsize is
  smaller than the size of elf_ehdr and elf_shdr).

  Fix this by introducing a new helper that is used to set
  [caller_]xdest_{base/size} and that takes care of performing the appropriate
  memset of the region. This newly introduced helper is then used to set and
  unset xdest_{base/size} in elf_load_bsdsyms. Now that the full struct
  is zeroed, there's no need to specifically zero the undefined section.

  This is CVE-2016-9384 / XSA-164.

  Suggested-by: Ian Jackson <ian.jackson@eu.citrix.com>
  Signed-off-by: Roger Pau Monné <roger.pau@citrix.com>

  Also remove the open coded (and redundant with the earlier
  elf_memset_unchecked()) use of caller_xdest_* from elf_init().

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Signed-off-by: Ian Jackson <Ian.Jackson@eu.citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: fb08f7d009a64b96efa4462c9d19ed6881936859
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8ce2238f197fde118e291932d869a8a6c10ac539
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/8ce2238f197fde118e291932d869a8a6c10ac539
    reference_type: commit
    reference_id: 8ce2238f197fde118e291932d869a8a6c10ac539
  - url: https://github.com/xen-project/xen/tree/fb08f7d009a64b96efa4462c9d19ed6881936859
    reference_type: commit
    reference_id: fb08f7d009a64b96efa4462c9d19ed6881936859
