advisory_id: CVE-2022-42323
datasource_id: collect_xen_project_fix_commits/CVE-2022-42323
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  94b2f97eaae17f3c49816c2f7224d5b698d28287:tools/ocaml/xenstored: Fix quota bypass on domain shutdown

  XSA-322 fixed a domid reuse vulnerability by assigning Dom0 as the owner of
  any nodes left after a domain is shutdown (e.g. outside its /local/domain/N
  tree).

  However Dom0 has no quota on purpose, so this opened up another potential
  attack vector. Avoid it by deleting these nodes instead of assigning them to
  Dom0.

  This is part of XSA-419 / CVE-2022-42323.

  Fixes: c46eff921209 ("tools/ocaml/xenstored: clean up permissions for dead domains")
  Signed-off-by: Edwin Török <edvin.torok@citrix.com>
  Acked-by: Christian Lindig <christian.lindig@citrix.com>
  (cherry picked from commit db471408edd46af403b8bd44d180a928ad7fbb80)
  0cd209a7e302f0754b19d38143932c3c10d4d7cc:tools/ocaml/xenstored: Fix quota bypass on domain shutdown

  XSA-322 fixed a domid reuse vulnerability by assigning Dom0 as the owner of
  any nodes left after a domain is shutdown (e.g. outside its /local/domain/N
  tree).

  However Dom0 has no quota on purpose, so this opened up another potential
  attack vector. Avoid it by deleting these nodes instead of assigning them to
  Dom0.

  This is part of XSA-419 / CVE-2022-42323.

  Fixes: c46eff921209 ("tools/ocaml/xenstored: clean up permissions for dead domains")
  Signed-off-by: Edwin Török <edvin.torok@citrix.com>
  Acked-by: Christian Lindig <christian.lindig@citrix.com>
  (cherry picked from commit db471408edd46af403b8bd44d180a928ad7fbb80)
  b9ede0950b3a6526d5ccea074841f093e0580948:tools/ocaml/xenstored: Fix quota bypass on domain shutdown

  XSA-322 fixed a domid reuse vulnerability by assigning Dom0 as the owner of
  any nodes left after a domain is shutdown (e.g. outside its /local/domain/N
  tree).

  However Dom0 has no quota on purpose, so this opened up another potential
  attack vector. Avoid it by deleting these nodes instead of assigning them to
  Dom0.

  This is part of XSA-419 / CVE-2022-42323.

  Fixes: c46eff921209 ("tools/ocaml/xenstored: clean up permissions for dead domains")
  Signed-off-by: Edwin Török <edvin.torok@citrix.com>
  Acked-by: Christian Lindig <christian.lindig@citrix.com>
  (cherry picked from commit db471408edd46af403b8bd44d180a928ad7fbb80)
  5b0919f2c0e5060f6e0bc328f100abae0a9f07b8:tools/ocaml/xenstored: Fix quota bypass on domain shutdown

  XSA-322 fixed a domid reuse vulnerability by assigning Dom0 as the owner of
  any nodes left after a domain is shutdown (e.g. outside its /local/domain/N
  tree).

  However Dom0 has no quota on purpose, so this opened up another potential
  attack vector. Avoid it by deleting these nodes instead of assigning them to
  Dom0.

  This is part of XSA-419 / CVE-2022-42323.

  Fixes: c46eff921209 ("tools/ocaml/xenstored: clean up permissions for dead domains")
  Signed-off-by: Edwin Török <edvin.torok@citrix.com>
  Acked-by: Christian Lindig <christian.lindig@citrix.com>
  (cherry picked from commit db471408edd46af403b8bd44d180a928ad7fbb80)
  db471408edd46af403b8bd44d180a928ad7fbb80:tools/ocaml/xenstored: Fix quota bypass on domain shutdown

  XSA-322 fixed a domid reuse vulnerability by assigning Dom0 as the owner of
  any nodes left after a domain is shutdown (e.g. outside its /local/domain/N
  tree).

  However Dom0 has no quota on purpose, so this opened up another potential
  attack vector. Avoid it by deleting these nodes instead of assigning them to
  Dom0.

  This is part of XSA-419 / CVE-2022-42323.

  Fixes: c46eff921209 ("tools/ocaml/xenstored: clean up permissions for dead domains")
  Signed-off-by: Edwin Török <edvin.torok@citrix.com>
  Acked-by: Christian Lindig <christian.lindig@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: db471408edd46af403b8bd44d180a928ad7fbb80
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0cd209a7e302f0754b19d38143932c3c10d4d7cc
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 94b2f97eaae17f3c49816c2f7224d5b698d28287
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b9ede0950b3a6526d5ccea074841f093e0580948
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5b0919f2c0e5060f6e0bc328f100abae0a9f07b8
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/0cd209a7e302f0754b19d38143932c3c10d4d7cc
    reference_type: commit
    reference_id: 0cd209a7e302f0754b19d38143932c3c10d4d7cc
  - url: https://github.com/xen-project/xen/tree/5b0919f2c0e5060f6e0bc328f100abae0a9f07b8
    reference_type: commit
    reference_id: 5b0919f2c0e5060f6e0bc328f100abae0a9f07b8
  - url: https://github.com/xen-project/xen/tree/94b2f97eaae17f3c49816c2f7224d5b698d28287
    reference_type: commit
    reference_id: 94b2f97eaae17f3c49816c2f7224d5b698d28287
  - url: https://github.com/xen-project/xen/tree/b9ede0950b3a6526d5ccea074841f093e0580948
    reference_type: commit
    reference_id: b9ede0950b3a6526d5ccea074841f093e0580948
  - url: https://github.com/xen-project/xen/tree/db471408edd46af403b8bd44d180a928ad7fbb80
    reference_type: commit
    reference_id: db471408edd46af403b8bd44d180a928ad7fbb80
