advisory_id: CVE-2015-2152
datasource_id: collect_xen_project_fix_commits/CVE-2015-2152
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: "5bec01c19839e150e489dd04376c65f961830c86:tools: libxl: Explicitly disable graphics\
  \ backends on qemu cmdline\n\nBy default qemu will try to create some sort of backend for\
  \ the\nemulated VGA device, either SDL or VNC.\n\nHowever when the user specifies sdl=0 and\
  \ vnc=0 in their configuration\nlibxl was not explicitly disabling either backend, which could\
  \ lead to\none unexpectedly running.\n\nIf either sdl=1 or vnc=1 is configured then both before\
  \ and after this\nchange only the backends which are explicitly enabled are configured,\n\
  i.e. this issue only occurs when all backends are supposed to have\nbeen disabled.\n\nThis\
  \ affects qemu-xen and qemu-xen-traditional differently.\n\nIf qemu-xen was compiled with\
  \ SDL support then this would result in an\nSDL window being opened if $DISPLAY is valid,\
  \ or a failure to start\nthe guest if not. Passing \"-display none\" to qemu before any further\n\
  -sdl options disables this default behaviour and ensures that SDL is\nonly started if the\
  \ libxl configuration demands it.\n\nIf qemu-xen was compiled without SDL support then qemu\
  \ would instead\nstart a VNC server listening on ::1 (IPv6 localhost) or 127.0.0.1\n(IPv4\
  \ localhost) with IPv6 preferred if available. Explicitly pass\n\"-vnc none\" when vnc is\
  \ not enabled in the libxl configuration to\nremove this possibility.\n\nqemu-xen-traditional\
  \ would never start a vnc backend unless asked.\nHowever by default it will start an SDL backend,\
  \ the way to disable\nthis is to pass a -vnc option. In other words passing \"-vnc none\"\
  \ will\ndisable both vnc and sdl by default. sdl can then be reenabled if\nconfigured by subsequent\
  \ use of the -sdl option.\n\nTested with both qemu-xen and qemu-xen-traditional built with\
  \ SDL\nsupport and:\n\txl cr # defaults\n\txl cr sdl=0 vnc=0\n\txl cr sdl=1 vnc=0\n\txl cr\
  \ sdl=0 vnc=1\n\txl cr sdl=0 vnc=0 vga=\\\"none\\\"\n\txl cr sdl=0 vnc=0 nographic=1\nwith\
  \ both valid and invalid $DISPLAY.\n\nThis is XSA-119 / CVE-2015-2152.\n\nReported-by: Sander\
  \ Eikelenboom <linux@eikelenboom.it>\nSigned-off-by: Ian Campbell <ian.campbell@citrix.com>\n\
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>\n1cf1e6024bfec941e10fe7308b04c9da1a7e74e4:tools:\
  \ libxl: Explicitly disable graphics backends on qemu cmdline\n\nBy default qemu will try\
  \ to create some sort of backend for the\nemulated VGA device, either SDL or VNC.\n\nHowever\
  \ when the user specifies sdl=0 and vnc=0 in their configuration\nlibxl was not explicitly\
  \ disabling either backend, which could lead to\none unexpectedly running.\n\nIf either sdl=1\
  \ or vnc=1 is configured then both before and after this\nchange only the backends which are\
  \ explicitly enabled are configured,\ni.e. this issue only occurs when all backends are supposed\
  \ to have\nbeen disabled.\n\nThis affects qemu-xen and qemu-xen-traditional differently.\n\
  \nIf qemu-xen was compiled with SDL support then this would result in an\nSDL window being\
  \ opened if $DISPLAY is valid, or a failure to start\nthe guest if not. Passing \"-display\
  \ none\" to qemu before any further\n-sdl options disables this default behaviour and ensures\
  \ that SDL is\nonly started if the libxl configuration demands it.\n\nIf qemu-xen was compiled\
  \ without SDL support then qemu would instead\nstart a VNC server listening on ::1 (IPv6 localhost)\
  \ or 127.0.0.1\n(IPv4 localhost) with IPv6 preferred if available. Explicitly pass\n\"-vnc\
  \ none\" when vnc is not enabled in the libxl configuration to\nremove this possibility.\n\
  \nqemu-xen-traditional would never start a vnc backend unless asked.\nHowever by default it\
  \ will start an SDL backend, the way to disable\nthis is to pass a -vnc option. In other words\
  \ passing \"-vnc none\" will\ndisable both vnc and sdl by default. sdl can then be reenabled\
  \ if\nconfigured by subsequent use of the -sdl option.\n\nTested with both qemu-xen and qemu-xen-traditional\
  \ built with SDL\nsupport and:\n\txl cr # defaults\n\txl cr sdl=0 vnc=0\n\txl cr sdl=1 vnc=0\n\
  \txl cr sdl=0 vnc=1\n\txl cr sdl=0 vnc=0 vga=\\\"none\\\"\n\txl cr sdl=0 vnc=0 nographic=1\n\
  with both valid and invalid $DISPLAY.\n\nThis is XSA-119 / CVE-2015-2152.\n\nReported-by:\
  \ Sander Eikelenboom <linux@eikelenboom.it>\nSigned-off-by: Ian Campbell <ian.campbell@citrix.com>\n\
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>\n(cherry picked from commit 91b0ae9db33f72468b1d411a07f53085c893c097)\n\
  (cherry picked from commit 6616c4d6fe454cf04c90057cc5e752e1aed23b23)\n(cherry picked from\
  \ commit 84ca072f37fa41de1d98524c1a60b7feba0fdc97)\n84ca072f37fa41de1d98524c1a60b7feba0fdc97:tools:\
  \ libxl: Explicitly disable graphics backends on qemu cmdline\n\nBy default qemu will try\
  \ to create some sort of backend for the\nemulated VGA device, either SDL or VNC.\n\nHowever\
  \ when the user specifies sdl=0 and vnc=0 in their configuration\nlibxl was not explicitly\
  \ disabling either backend, which could lead to\none unexpectedly running.\n\nIf either sdl=1\
  \ or vnc=1 is configured then both before and after this\nchange only the backends which are\
  \ explicitly enabled are configured,\ni.e. this issue only occurs when all backends are supposed\
  \ to have\nbeen disabled.\n\nThis affects qemu-xen and qemu-xen-traditional differently.\n\
  \nIf qemu-xen was compiled with SDL support then this would result in an\nSDL window being\
  \ opened if $DISPLAY is valid, or a failure to start\nthe guest if not. Passing \"-display\
  \ none\" to qemu before any further\n-sdl options disables this default behaviour and ensures\
  \ that SDL is\nonly started if the libxl configuration demands it.\n\nIf qemu-xen was compiled\
  \ without SDL support then qemu would instead\nstart a VNC server listening on ::1 (IPv6 localhost)\
  \ or 127.0.0.1\n(IPv4 localhost) with IPv6 preferred if available. Explicitly pass\n\"-vnc\
  \ none\" when vnc is not enabled in the libxl configuration to\nremove this possibility.\n\
  \nqemu-xen-traditional would never start a vnc backend unless asked.\nHowever by default it\
  \ will start an SDL backend, the way to disable\nthis is to pass a -vnc option. In other words\
  \ passing \"-vnc none\" will\ndisable both vnc and sdl by default. sdl can then be reenabled\
  \ if\nconfigured by subsequent use of the -sdl option.\n\nTested with both qemu-xen and qemu-xen-traditional\
  \ built with SDL\nsupport and:\n\txl cr # defaults\n\txl cr sdl=0 vnc=0\n\txl cr sdl=1 vnc=0\n\
  \txl cr sdl=0 vnc=1\n\txl cr sdl=0 vnc=0 vga=\\\"none\\\"\n\txl cr sdl=0 vnc=0 nographic=1\n\
  with both valid and invalid $DISPLAY.\n\nThis is XSA-119 / CVE-2015-2152.\n\nReported-by:\
  \ Sander Eikelenboom <linux@eikelenboom.it>\nSigned-off-by: Ian Campbell <ian.campbell@citrix.com>\n\
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>\n(cherry picked from commit 91b0ae9db33f72468b1d411a07f53085c893c097)\n\
  (cherry picked from commit 6616c4d6fe454cf04c90057cc5e752e1aed23b23)\n6616c4d6fe454cf04c90057cc5e752e1aed23b23:tools:\
  \ libxl: Explicitly disable graphics backends on qemu cmdline\n\nBy default qemu will try\
  \ to create some sort of backend for the\nemulated VGA device, either SDL or VNC.\n\nHowever\
  \ when the user specifies sdl=0 and vnc=0 in their configuration\nlibxl was not explicitly\
  \ disabling either backend, which could lead to\none unexpectedly running.\n\nIf either sdl=1\
  \ or vnc=1 is configured then both before and after this\nchange only the backends which are\
  \ explicitly enabled are configured,\ni.e. this issue only occurs when all backends are supposed\
  \ to have\nbeen disabled.\n\nThis affects qemu-xen and qemu-xen-traditional differently.\n\
  \nIf qemu-xen was compiled with SDL support then this would result in an\nSDL window being\
  \ opened if $DISPLAY is valid, or a failure to start\nthe guest if not. Passing \"-display\
  \ none\" to qemu before any further\n-sdl options disables this default behaviour and ensures\
  \ that SDL is\nonly started if the libxl configuration demands it.\n\nIf qemu-xen was compiled\
  \ without SDL support then qemu would instead\nstart a VNC server listening on ::1 (IPv6 localhost)\
  \ or 127.0.0.1\n(IPv4 localhost) with IPv6 preferred if available. Explicitly pass\n\"-vnc\
  \ none\" when vnc is not enabled in the libxl configuration to\nremove this possibility.\n\
  \nqemu-xen-traditional would never start a vnc backend unless asked.\nHowever by default it\
  \ will start an SDL backend, the way to disable\nthis is to pass a -vnc option. In other words\
  \ passing \"-vnc none\" will\ndisable both vnc and sdl by default. sdl can then be reenabled\
  \ if\nconfigured by subsequent use of the -sdl option.\n\nTested with both qemu-xen and qemu-xen-traditional\
  \ built with SDL\nsupport and:\n\txl cr # defaults\n\txl cr sdl=0 vnc=0\n\txl cr sdl=1 vnc=0\n\
  \txl cr sdl=0 vnc=1\n\txl cr sdl=0 vnc=0 vga=\\\"none\\\"\n\txl cr sdl=0 vnc=0 nographic=1\n\
  with both valid and invalid $DISPLAY.\n\nThis is XSA-119 / CVE-2015-2152.\n\nReported-by:\
  \ Sander Eikelenboom <linux@eikelenboom.it>\nSigned-off-by: Ian Campbell <ian.campbell@citrix.com>\n\
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>\n(cherry picked from commit 91b0ae9db33f72468b1d411a07f53085c893c097)\n\
  91b0ae9db33f72468b1d411a07f53085c893c097:tools: libxl: Explicitly disable graphics backends\
  \ on qemu cmdline\n\nBy default qemu will try to create some sort of backend for the\nemulated\
  \ VGA device, either SDL or VNC.\n\nHowever when the user specifies sdl=0 and vnc=0 in their\
  \ configuration\nlibxl was not explicitly disabling either backend, which could lead to\n\
  one unexpectedly running.\n\nIf either sdl=1 or vnc=1 is configured then both before and after\
  \ this\nchange only the backends which are explicitly enabled are configured,\ni.e. this issue\
  \ only occurs when all backends are supposed to have\nbeen disabled.\n\nThis affects qemu-xen\
  \ and qemu-xen-traditional differently.\n\nIf qemu-xen was compiled with SDL support then\
  \ this would result in an\nSDL window being opened if $DISPLAY is valid, or a failure to start\n\
  the guest if not. Passing \"-display none\" to qemu before any further\n-sdl options disables\
  \ this default behaviour and ensures that SDL is\nonly started if the libxl configuration\
  \ demands it.\n\nIf qemu-xen was compiled without SDL support then qemu would instead\nstart\
  \ a VNC server listening on ::1 (IPv6 localhost) or 127.0.0.1\n(IPv4 localhost) with IPv6\
  \ preferred if available. Explicitly pass\n\"-vnc none\" when vnc is not enabled in the libxl\
  \ configuration to\nremove this possibility.\n\nqemu-xen-traditional would never start a vnc\
  \ backend unless asked.\nHowever by default it will start an SDL backend, the way to disable\n\
  this is to pass a -vnc option. In other words passing \"-vnc none\" will\ndisable both vnc\
  \ and sdl by default. sdl can then be reenabled if\nconfigured by subsequent use of the -sdl\
  \ option.\n\nTested with both qemu-xen and qemu-xen-traditional built with SDL\nsupport and:\n\
  \txl cr # defaults\n\txl cr sdl=0 vnc=0\n\txl cr sdl=1 vnc=0\n\txl cr sdl=0 vnc=1\n\txl cr\
  \ sdl=0 vnc=0 vga=\\\"none\\\"\n\txl cr sdl=0 vnc=0 nographic=1\nwith both valid and invalid\
  \ $DISPLAY.\n\nThis is XSA-119 / CVE-2015-2152.\n\nReported-by: Sander Eikelenboom <linux@eikelenboom.it>\n\
  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>\nAcked-by: Ian Jackson <ian.jackson@eu.citrix.com>"
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 84ca072f37fa41de1d98524c1a60b7feba0fdc97
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 91b0ae9db33f72468b1d411a07f53085c893c097
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 6616c4d6fe454cf04c90057cc5e752e1aed23b23
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5bec01c19839e150e489dd04376c65f961830c86
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1cf1e6024bfec941e10fe7308b04c9da1a7e74e4
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/1cf1e6024bfec941e10fe7308b04c9da1a7e74e4
    reference_type: commit
    reference_id: 1cf1e6024bfec941e10fe7308b04c9da1a7e74e4
  - url: https://github.com/xen-project/xen/tree/5bec01c19839e150e489dd04376c65f961830c86
    reference_type: commit
    reference_id: 5bec01c19839e150e489dd04376c65f961830c86
  - url: https://github.com/xen-project/xen/tree/6616c4d6fe454cf04c90057cc5e752e1aed23b23
    reference_type: commit
    reference_id: 6616c4d6fe454cf04c90057cc5e752e1aed23b23
  - url: https://github.com/xen-project/xen/tree/84ca072f37fa41de1d98524c1a60b7feba0fdc97
    reference_type: commit
    reference_id: 84ca072f37fa41de1d98524c1a60b7feba0fdc97
  - url: https://github.com/xen-project/xen/tree/91b0ae9db33f72468b1d411a07f53085c893c097
    reference_type: commit
    reference_id: 91b0ae9db33f72468b1d411a07f53085c893c097
