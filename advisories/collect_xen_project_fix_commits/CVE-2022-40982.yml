advisory_id: CVE-2022-40982
datasource_id: collect_xen_project_fix_commits/CVE-2022-40982
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  5e90eb43f73c1f7c297f0dbbe079139beb754121:x86/spec-ctrl: Mitigate Gather Data Sampling

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 56d690efd3ca3c68e1d222f259fb3d216206e8e5)
  78eb1284a8f178b59a87225471fdc4865d81928a:x86/spec-ctrl: Enumerations for Gather Data Sampling

  GDS_CTRL is introduced by the August 2023 microcode.  GDS_NO is for current
  and future processors not susceptible to GDS.

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 9f585f59d90c8d3a1b21369a852b7d7eee8a29b9)
  3f9d9b47ef98eb641fe5fcbdf5341e7eef17cfab:x86/cpu-policy: Hide CLWB by default on SKX/CLX/CPX

  The August 2023 microcode for GDS has an impact on the CLWB instruction.  See
  code comments for full details.

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 2dd06b4ea10891750af38e4a0e1efaeb0a9b3518)
  b9ade05cbba977673d5a08bc7a5940c5fd8add0e:x86/spec-ctrl: Mitigate Gather Data Sampling

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 56d690efd3ca3c68e1d222f259fb3d216206e8e5)
  46a3c16f3656b1e0ba1a01669a85f57b61c37d74:x86/spec-ctrl: Enumerations for Gather Data Sampling

  GDS_CTRL is introduced by the August 2023 microcode.  GDS_NO is for current
  and future processors not susceptible to GDS.

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 9f585f59d90c8d3a1b21369a852b7d7eee8a29b9)
  bbf22355951dab5a66ac400b03cb9c88d2dc859f:x86/cpu-policy: Hide CLWB by default on SKX/CLX/CPX

  The August 2023 microcode for GDS has an impact on the CLWB instruction.  See
  code comments for full details.

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 2dd06b4ea10891750af38e4a0e1efaeb0a9b3518)
  56d690efd3ca3c68e1d222f259fb3d216206e8e5:x86/spec-ctrl: Mitigate Gather Data Sampling

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  9f585f59d90c8d3a1b21369a852b7d7eee8a29b9:x86/spec-ctrl: Enumerations for Gather Data Sampling

  GDS_CTRL is introduced by the August 2023 microcode.  GDS_NO is for current
  and future processors not susceptible to GDS.

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  2dd06b4ea10891750af38e4a0e1efaeb0a9b3518:x86/cpu-policy: Hide CLWB by default on SKX/CLX/CPX

  The August 2023 microcode for GDS has an impact on the CLWB instruction.  See
  code comments for full details.

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  050abf9e978c153e599d0aaeef4c2da71b6e0993:x86/spec-ctrl: Mitigate Gather Data Sampling

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 56d690efd3ca3c68e1d222f259fb3d216206e8e5)
  e138318362ac40572929327e2a3512a20ebb4488:x86/spec-ctrl: Enumerations for Gather Data Sampling

  GDS_CTRL is introduced by the August 2023 microcode.  GDS_NO is for current
  and future processors not susceptible to GDS.

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 9f585f59d90c8d3a1b21369a852b7d7eee8a29b9)
  5792b92fd9b6a65214e9980d0280eaef95e59b4a:x86/cpu-policy: Hide CLWB by default on SKX/CLX/CPX

  The August 2023 microcode for GDS has an impact on the CLWB instruction.  See
  code comments for full details.

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 2dd06b4ea10891750af38e4a0e1efaeb0a9b3518)
  1c5c12d3b3de6d62082c3e57825b5eeedd2b7dba:x86/spec-ctrl: Mitigate Gather Data Sampling

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 56d690efd3ca3c68e1d222f259fb3d216206e8e5)
  abdfd732864a913e8f060f0d8db4b8c0eaec9e1b:x86/spec-ctrl: Enumerations for Gather Data Sampling

  GDS_CTRL is introduced by the August 2023 microcode.  GDS_NO is for current
  and future processors not susceptible to GDS.

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 9f585f59d90c8d3a1b21369a852b7d7eee8a29b9)
  dab61d18df2e120a2ff40e3b101eb2792b480f4a:x86/cpu-policy: Hide CLWB by default on SKX/CLX/CPX

  The August 2023 microcode for GDS has an impact on the CLWB instruction.  See
  code comments for full details.

  This is part of XSA-435 / CVE-2022-40982

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 2dd06b4ea10891750af38e4a0e1efaeb0a9b3518)
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: bbf22355951dab5a66ac400b03cb9c88d2dc859f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 78eb1284a8f178b59a87225471fdc4865d81928a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b9ade05cbba977673d5a08bc7a5940c5fd8add0e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: abdfd732864a913e8f060f0d8db4b8c0eaec9e1b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1c5c12d3b3de6d62082c3e57825b5eeedd2b7dba
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 56d690efd3ca3c68e1d222f259fb3d216206e8e5
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 050abf9e978c153e599d0aaeef4c2da71b6e0993
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9f585f59d90c8d3a1b21369a852b7d7eee8a29b9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2dd06b4ea10891750af38e4a0e1efaeb0a9b3518
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5e90eb43f73c1f7c297f0dbbe079139beb754121
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: dab61d18df2e120a2ff40e3b101eb2792b480f4a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e138318362ac40572929327e2a3512a20ebb4488
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5792b92fd9b6a65214e9980d0280eaef95e59b4a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3f9d9b47ef98eb641fe5fcbdf5341e7eef17cfab
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 46a3c16f3656b1e0ba1a01669a85f57b61c37d74
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/050abf9e978c153e599d0aaeef4c2da71b6e0993
    reference_type: commit
    reference_id: 050abf9e978c153e599d0aaeef4c2da71b6e0993
  - url: https://github.com/xen-project/xen/tree/1c5c12d3b3de6d62082c3e57825b5eeedd2b7dba
    reference_type: commit
    reference_id: 1c5c12d3b3de6d62082c3e57825b5eeedd2b7dba
  - url: https://github.com/xen-project/xen/tree/2dd06b4ea10891750af38e4a0e1efaeb0a9b3518
    reference_type: commit
    reference_id: 2dd06b4ea10891750af38e4a0e1efaeb0a9b3518
  - url: https://github.com/xen-project/xen/tree/3f9d9b47ef98eb641fe5fcbdf5341e7eef17cfab
    reference_type: commit
    reference_id: 3f9d9b47ef98eb641fe5fcbdf5341e7eef17cfab
  - url: https://github.com/xen-project/xen/tree/46a3c16f3656b1e0ba1a01669a85f57b61c37d74
    reference_type: commit
    reference_id: 46a3c16f3656b1e0ba1a01669a85f57b61c37d74
  - url: https://github.com/xen-project/xen/tree/56d690efd3ca3c68e1d222f259fb3d216206e8e5
    reference_type: commit
    reference_id: 56d690efd3ca3c68e1d222f259fb3d216206e8e5
  - url: https://github.com/xen-project/xen/tree/5792b92fd9b6a65214e9980d0280eaef95e59b4a
    reference_type: commit
    reference_id: 5792b92fd9b6a65214e9980d0280eaef95e59b4a
  - url: https://github.com/xen-project/xen/tree/5e90eb43f73c1f7c297f0dbbe079139beb754121
    reference_type: commit
    reference_id: 5e90eb43f73c1f7c297f0dbbe079139beb754121
  - url: https://github.com/xen-project/xen/tree/78eb1284a8f178b59a87225471fdc4865d81928a
    reference_type: commit
    reference_id: 78eb1284a8f178b59a87225471fdc4865d81928a
  - url: https://github.com/xen-project/xen/tree/9f585f59d90c8d3a1b21369a852b7d7eee8a29b9
    reference_type: commit
    reference_id: 9f585f59d90c8d3a1b21369a852b7d7eee8a29b9
  - url: https://github.com/xen-project/xen/tree/abdfd732864a913e8f060f0d8db4b8c0eaec9e1b
    reference_type: commit
    reference_id: abdfd732864a913e8f060f0d8db4b8c0eaec9e1b
  - url: https://github.com/xen-project/xen/tree/b9ade05cbba977673d5a08bc7a5940c5fd8add0e
    reference_type: commit
    reference_id: b9ade05cbba977673d5a08bc7a5940c5fd8add0e
  - url: https://github.com/xen-project/xen/tree/bbf22355951dab5a66ac400b03cb9c88d2dc859f
    reference_type: commit
    reference_id: bbf22355951dab5a66ac400b03cb9c88d2dc859f
  - url: https://github.com/xen-project/xen/tree/dab61d18df2e120a2ff40e3b101eb2792b480f4a
    reference_type: commit
    reference_id: dab61d18df2e120a2ff40e3b101eb2792b480f4a
  - url: https://github.com/xen-project/xen/tree/e138318362ac40572929327e2a3512a20ebb4488
    reference_type: commit
    reference_id: e138318362ac40572929327e2a3512a20ebb4488
