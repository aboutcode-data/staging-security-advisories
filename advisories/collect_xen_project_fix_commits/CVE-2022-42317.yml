advisory_id: CVE-2022-42317
datasource_id: collect_xen_project_fix_commits/CVE-2022-42317
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  c084ee8e5834a33fba8e03fe9bcd1e1ebe03b09d:tools/ocaml/xenstored: Check for maxrequests before performing operations

  Previously we'd perform the operation, record the updated tree in the
  transaction record, then try to insert a watchop path and the reply packet.

  If we exceeded max requests we would've returned EQUOTA, but still:
  * have performed the operation on the transaction's tree
  * have recorded the watchop, making this queue effectively unbounded

  It is better if we check whether we'd have room to store the operation before
  performing the transaction, and raise EQUOTA there.  Then the transaction
  record won't grow.

  This is part of XSA-326 / CVE-2022-42317.

  Signed-off-by: Edwin Török <edvin.torok@citrix.com>
  Acked-by: Christian Lindig <christian.lindig@citrix.com>
  (cherry picked from commit 329f4d1a6535c6c5a34025ca0d03fc5c7228fcff)
  f6a5a1d2e34c995a570c9477010c75f3b87a51cd:tools/ocaml/xenstored: Check for maxrequests before performing operations

  Previously we'd perform the operation, record the updated tree in the
  transaction record, then try to insert a watchop path and the reply packet.

  If we exceeded max requests we would've returned EQUOTA, but still:
  * have performed the operation on the transaction's tree
  * have recorded the watchop, making this queue effectively unbounded

  It is better if we check whether we'd have room to store the operation before
  performing the transaction, and raise EQUOTA there.  Then the transaction
  record won't grow.

  This is part of XSA-326 / CVE-2022-42317.

  Signed-off-by: Edwin Török <edvin.torok@citrix.com>
  Acked-by: Christian Lindig <christian.lindig@citrix.com>
  (cherry picked from commit 329f4d1a6535c6c5a34025ca0d03fc5c7228fcff)
  45816222bb3da04f4cd3388efc46d127d48b8906:tools/ocaml/xenstored: Check for maxrequests before performing operations

  Previously we'd perform the operation, record the updated tree in the
  transaction record, then try to insert a watchop path and the reply packet.

  If we exceeded max requests we would've returned EQUOTA, but still:
  * have performed the operation on the transaction's tree
  * have recorded the watchop, making this queue effectively unbounded

  It is better if we check whether we'd have room to store the operation before
  performing the transaction, and raise EQUOTA there.  Then the transaction
  record won't grow.

  This is part of XSA-326 / CVE-2022-42317.

  Signed-off-by: Edwin Török <edvin.torok@citrix.com>
  Acked-by: Christian Lindig <christian.lindig@citrix.com>
  (cherry picked from commit 329f4d1a6535c6c5a34025ca0d03fc5c7228fcff)
  ab21bb1971a7fa9308053b0686f43277f6e8a6c9:tools/ocaml/xenstored: Check for maxrequests before performing operations

  Previously we'd perform the operation, record the updated tree in the
  transaction record, then try to insert a watchop path and the reply packet.

  If we exceeded max requests we would've returned EQUOTA, but still:
  * have performed the operation on the transaction's tree
  * have recorded the watchop, making this queue effectively unbounded

  It is better if we check whether we'd have room to store the operation before
  performing the transaction, and raise EQUOTA there.  Then the transaction
  record won't grow.

  This is part of XSA-326 / CVE-2022-42317.

  Signed-off-by: Edwin Török <edvin.torok@citrix.com>
  Acked-by: Christian Lindig <christian.lindig@citrix.com>
  (cherry picked from commit 329f4d1a6535c6c5a34025ca0d03fc5c7228fcff)
  329f4d1a6535c6c5a34025ca0d03fc5c7228fcff:tools/ocaml/xenstored: Check for maxrequests before performing operations

  Previously we'd perform the operation, record the updated tree in the
  transaction record, then try to insert a watchop path and the reply packet.

  If we exceeded max requests we would've returned EQUOTA, but still:
  * have performed the operation on the transaction's tree
  * have recorded the watchop, making this queue effectively unbounded

  It is better if we check whether we'd have room to store the operation before
  performing the transaction, and raise EQUOTA there.  Then the transaction
  record won't grow.

  This is part of XSA-326 / CVE-2022-42317.

  Signed-off-by: Edwin Török <edvin.torok@citrix.com>
  Acked-by: Christian Lindig <christian.lindig@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 45816222bb3da04f4cd3388efc46d127d48b8906
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 329f4d1a6535c6c5a34025ca0d03fc5c7228fcff
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c084ee8e5834a33fba8e03fe9bcd1e1ebe03b09d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ab21bb1971a7fa9308053b0686f43277f6e8a6c9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f6a5a1d2e34c995a570c9477010c75f3b87a51cd
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/329f4d1a6535c6c5a34025ca0d03fc5c7228fcff
    reference_type: commit
    reference_id: 329f4d1a6535c6c5a34025ca0d03fc5c7228fcff
  - url: https://github.com/xen-project/xen/tree/45816222bb3da04f4cd3388efc46d127d48b8906
    reference_type: commit
    reference_id: 45816222bb3da04f4cd3388efc46d127d48b8906
  - url: https://github.com/xen-project/xen/tree/ab21bb1971a7fa9308053b0686f43277f6e8a6c9
    reference_type: commit
    reference_id: ab21bb1971a7fa9308053b0686f43277f6e8a6c9
  - url: https://github.com/xen-project/xen/tree/c084ee8e5834a33fba8e03fe9bcd1e1ebe03b09d
    reference_type: commit
    reference_id: c084ee8e5834a33fba8e03fe9bcd1e1ebe03b09d
  - url: https://github.com/xen-project/xen/tree/f6a5a1d2e34c995a570c9477010c75f3b87a51cd
    reference_type: commit
    reference_id: f6a5a1d2e34c995a570c9477010c75f3b87a51cd
