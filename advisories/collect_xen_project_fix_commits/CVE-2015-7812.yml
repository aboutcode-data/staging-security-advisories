advisory_id: CVE-2015-7812
datasource_id: collect_xen_project_fix_commits/CVE-2015-7812
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  16486fc03070f678e3a5266ca53907e2862e9e6b:arm: Support hypercall_create_continuation for multicall

  Multicall for ARM has been supported since commit f0dbdc6 "xen: arm: fully
  implement multicall interface.". Although, if an hypercall in multicall
  requires preemption, it will crash the host:

  (XEN) Xen BUG at domain.c:347
  (XEN) ----[ Xen-4.7-unstable  arm64  debug=y  Tainted:    C ]----
  [...]
  (XEN) Xen call trace:
  (XEN)    [<00000000002420cc>] hypercall_create_continuation+0x64/0x380 (PC)
  (XEN)    [<0000000000217274>] do_memory_op+0x1b00/0x2334 (LR)
  (XEN)    [<0000000000250d2c>] do_multicall_call+0x114/0x124
  (XEN)    [<0000000000217ff0>] do_multicall+0x17c/0x23c
  (XEN)    [<000000000024f97c>] do_trap_hypercall+0x90/0x12c
  (XEN)    [<0000000000251ca8>] do_trap_hypervisor+0xd2c/0x1ba4
  (XEN)    [<00000000002582cc>] guest_sync+0x88/0xb8
  (XEN)
  (XEN)
  (XEN) ****************************************
  (XEN) Panic on CPU 5:
  (XEN) Xen BUG at domain.c:347
  (XEN) ****************************************
  (XEN)
  (XEN) Manual reset required ('noreboot' specified)

  Looking to the code, the support of multicall looks valid to me, as we only
  need to fill call.args[...]. So drop the BUG();

  This is CVE-2015-7812 / XSA-145.

  Signed-off-by: Julien Grall <julien.grall@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  master commit: 29bcf64ce8bc0b1b7aacd00c8668f255c4f0686c
  master date: 2015-10-29 13:31:10 +0100
  41dd3b8e73deafa0b05289d0430731ce2937d386:arm: Support hypercall_create_continuation for multicall

  Multicall for ARM has been supported since commit f0dbdc6 "xen: arm: fully
  implement multicall interface.". Although, if an hypercall in multicall
  requires preemption, it will crash the host:

  (XEN) Xen BUG at domain.c:347
  (XEN) ----[ Xen-4.7-unstable  arm64  debug=y  Tainted:    C ]----
  [...]
  (XEN) Xen call trace:
  (XEN)    [<00000000002420cc>] hypercall_create_continuation+0x64/0x380 (PC)
  (XEN)    [<0000000000217274>] do_memory_op+0x1b00/0x2334 (LR)
  (XEN)    [<0000000000250d2c>] do_multicall_call+0x114/0x124
  (XEN)    [<0000000000217ff0>] do_multicall+0x17c/0x23c
  (XEN)    [<000000000024f97c>] do_trap_hypercall+0x90/0x12c
  (XEN)    [<0000000000251ca8>] do_trap_hypervisor+0xd2c/0x1ba4
  (XEN)    [<00000000002582cc>] guest_sync+0x88/0xb8
  (XEN)
  (XEN)
  (XEN) ****************************************
  (XEN) Panic on CPU 5:
  (XEN) Xen BUG at domain.c:347
  (XEN) ****************************************
  (XEN)
  (XEN) Manual reset required ('noreboot' specified)

  Looking to the code, the support of multicall looks valid to me, as we only
  need to fill call.args[...]. So drop the BUG();

  This is CVE-2015-7812 / XSA-145.

  Signed-off-by: Julien Grall <julien.grall@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  master commit: 29bcf64ce8bc0b1b7aacd00c8668f255c4f0686c
  master date: 2015-10-29 13:31:10 +0100
  ea95ecb8bf30f83b52a079cdfc824a3ba6ffd4ef:arm: Support hypercall_create_continuation for multicall

  Multicall for ARM has been supported since commit f0dbdc6 "xen: arm: fully
  implement multicall interface.". Although, if an hypercall in multicall
  requires preemption, it will crash the host:

  (XEN) Xen BUG at domain.c:347
  (XEN) ----[ Xen-4.7-unstable  arm64  debug=y  Tainted:    C ]----
  [...]
  (XEN) Xen call trace:
  (XEN)    [<00000000002420cc>] hypercall_create_continuation+0x64/0x380 (PC)
  (XEN)    [<0000000000217274>] do_memory_op+0x1b00/0x2334 (LR)
  (XEN)    [<0000000000250d2c>] do_multicall_call+0x114/0x124
  (XEN)    [<0000000000217ff0>] do_multicall+0x17c/0x23c
  (XEN)    [<000000000024f97c>] do_trap_hypercall+0x90/0x12c
  (XEN)    [<0000000000251ca8>] do_trap_hypervisor+0xd2c/0x1ba4
  (XEN)    [<00000000002582cc>] guest_sync+0x88/0xb8
  (XEN)
  (XEN)
  (XEN) ****************************************
  (XEN) Panic on CPU 5:
  (XEN) Xen BUG at domain.c:347
  (XEN) ****************************************
  (XEN)
  (XEN) Manual reset required ('noreboot' specified)

  Looking to the code, the support of multicall looks valid to me, as we only
  need to fill call.args[...]. So drop the BUG();

  This is CVE-2015-7812 / XSA-145.

  Signed-off-by: Julien Grall <julien.grall@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  master commit: 29bcf64ce8bc0b1b7aacd00c8668f255c4f0686c
  master date: 2015-10-29 13:31:10 +0100
  29bcf64ce8bc0b1b7aacd00c8668f255c4f0686c:arm: Support hypercall_create_continuation for multicall

  Multicall for ARM has been supported since commit f0dbdc6 "xen: arm: fully
  implement multicall interface.". Although, if an hypercall in multicall
  requires preemption, it will crash the host:

  (XEN) Xen BUG at domain.c:347
  (XEN) ----[ Xen-4.7-unstable  arm64  debug=y  Tainted:    C ]----
  [...]
  (XEN) Xen call trace:
  (XEN)    [<00000000002420cc>] hypercall_create_continuation+0x64/0x380 (PC)
  (XEN)    [<0000000000217274>] do_memory_op+0x1b00/0x2334 (LR)
  (XEN)    [<0000000000250d2c>] do_multicall_call+0x114/0x124
  (XEN)    [<0000000000217ff0>] do_multicall+0x17c/0x23c
  (XEN)    [<000000000024f97c>] do_trap_hypercall+0x90/0x12c
  (XEN)    [<0000000000251ca8>] do_trap_hypervisor+0xd2c/0x1ba4
  (XEN)    [<00000000002582cc>] guest_sync+0x88/0xb8
  (XEN)
  (XEN)
  (XEN) ****************************************
  (XEN) Panic on CPU 5:
  (XEN) Xen BUG at domain.c:347
  (XEN) ****************************************
  (XEN)
  (XEN) Manual reset required ('noreboot' specified)

  Looking to the code, the support of multicall looks valid to me, as we only
  need to fill call.args[...]. So drop the BUG();

  This is CVE-2015-7812 / XSA-145.

  Signed-off-by: Julien Grall <julien.grall@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 29bcf64ce8bc0b1b7aacd00c8668f255c4f0686c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 16486fc03070f678e3a5266ca53907e2862e9e6b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 41dd3b8e73deafa0b05289d0430731ce2937d386
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ea95ecb8bf30f83b52a079cdfc824a3ba6ffd4ef
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/16486fc03070f678e3a5266ca53907e2862e9e6b
    reference_type: commit
    reference_id: 16486fc03070f678e3a5266ca53907e2862e9e6b
  - url: https://github.com/xen-project/xen/tree/29bcf64ce8bc0b1b7aacd00c8668f255c4f0686c
    reference_type: commit
    reference_id: 29bcf64ce8bc0b1b7aacd00c8668f255c4f0686c
  - url: https://github.com/xen-project/xen/tree/41dd3b8e73deafa0b05289d0430731ce2937d386
    reference_type: commit
    reference_id: 41dd3b8e73deafa0b05289d0430731ce2937d386
  - url: https://github.com/xen-project/xen/tree/ea95ecb8bf30f83b52a079cdfc824a3ba6ffd4ef
    reference_type: commit
    reference_id: ea95ecb8bf30f83b52a079cdfc824a3ba6ffd4ef
