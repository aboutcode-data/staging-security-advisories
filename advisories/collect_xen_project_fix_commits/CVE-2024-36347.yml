advisory_id: CVE-2024-36347
datasource_id: collect_xen_project_fix_commits/CVE-2024-36347
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  4f12a18da1c246d6ba4560fb175526cca595ca40:x86/ucode: Refine the boundary checks for Entrysign

  After initial publication, the SB-7033 / CVE-2024-36347 bulletin was updated
  to list Zen5 CPUs as vulnerable.  Use Fam1ah as an upper bound, and adjust the
  command line documentation.

  When the Zen6 (also Fam1ah processors) model numbers are known, they'll want
  excluding from the range.

  Fixes: 630e8875ab36 ("x86/ucode: Perform extra SHA2 checks on AMD Fam17h/19h microcode")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Release-Acked-By: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  (cherry picked from commit c2529496d07326f7a234c0c8e565bc8ec87d7836)
  0cbf79d2f68dc8411bd3e8de0111e8cdd4526f27:x86/ucode: Cross check the minimum revision

  For Zen3-5 microcode blobs signed with the updated signature scheme, the
  checksum field has been reused to be a min_revision field, referring to the
  microcode revision which fixed Entrysign (SB-7033, CVE-2024-36347).

  Cross-check this when trying to load microcode, but allow --force to override
  it.  If the signature scheme is genuinely different, a #GP will occur.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Release-Acked-By: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  (cherry picked from commit b3f015b8bad6e17300e299fe20beeef33be0007f)
  [Note: --force doesn't exist in this version of Xen]
  4112b5c6a2443f41f9b6047168d64ae897ffe616:x86/ucode: Refine the boundary checks for Entrysign

  After initial publication, the SB-7033 / CVE-2024-36347 bulletin was updated
  to list Zen5 CPUs as vulnerable.  Use Fam1ah as an upper bound, and adjust the
  command line documentation.

  When the Zen6 (also Fam1ah processors) model numbers are known, they'll want
  excluding from the range.

  Fixes: 630e8875ab36 ("x86/ucode: Perform extra SHA2 checks on AMD Fam17h/19h microcode")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Release-Acked-By: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  (cherry picked from commit c2529496d07326f7a234c0c8e565bc8ec87d7836)
  87466121fd64f6043278947cdc80ad218c9a9c34:x86/ucode: Cross check the minimum revision

  For Zen3-5 microcode blobs signed with the updated signature scheme, the
  checksum field has been reused to be a min_revision field, referring to the
  microcode revision which fixed Entrysign (SB-7033, CVE-2024-36347).

  Cross-check this when trying to load microcode, but allow --force to override
  it.  If the signature scheme is genuinely different, a #GP will occur.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Release-Acked-By: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  (cherry picked from commit b3f015b8bad6e17300e299fe20beeef33be0007f)
  [Note: --force doesn't exist in this version of Xen]
  b179b98a2e1ea336eb206bd24eb28388f5d08fb9:x86/ucode: Refine the boundary checks for Entrysign

  After initial publication, the SB-7033 / CVE-2024-36347 bulletin was updated
  to list Zen5 CPUs as vulnerable.  Use Fam1ah as an upper bound, and adjust the
  command line documentation.

  When the Zen6 (also Fam1ah processors) model numbers are known, they'll want
  excluding from the range.

  Fixes: 630e8875ab36 ("x86/ucode: Perform extra SHA2 checks on AMD Fam17h/19h microcode")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Release-Acked-By: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  (cherry picked from commit c2529496d07326f7a234c0c8e565bc8ec87d7836)
  aabe803e8ee8ea84d9e39fbfb35924b7b5d71eba:x86/ucode: Cross check the minimum revision

  For Zen3-5 microcode blobs signed with the updated signature scheme, the
  checksum field has been reused to be a min_revision field, referring to the
  microcode revision which fixed Entrysign (SB-7033, CVE-2024-36347).

  Cross-check this when trying to load microcode, but allow --force to override
  it.  If the signature scheme is genuinely different, a #GP will occur.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Release-Acked-By: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  (cherry picked from commit b3f015b8bad6e17300e299fe20beeef33be0007f)
  [Note: --force doesn't exist in this version of Xen]
  f42dff8429566c40e268c16e7266baa4fc7d4be7:x86/ucode: Refine the boundary checks for Entrysign

  After initial publication, the SB-7033 / CVE-2024-36347 bulletin was updated
  to list Zen5 CPUs as vulnerable.  Use Fam1ah as an upper bound, and adjust the
  command line documentation.

  When the Zen6 (also Fam1ah processors) model numbers are known, they'll want
  excluding from the range.

  Fixes: 630e8875ab36 ("x86/ucode: Perform extra SHA2 checks on AMD Fam17h/19h microcode")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Release-Acked-By: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  (cherry picked from commit c2529496d07326f7a234c0c8e565bc8ec87d7836)
  07c7069cb26a38622344f1a4bd8ef9c96ea60583:x86/ucode: Cross check the minimum revision

  For Zen3-5 microcode blobs signed with the updated signature scheme, the
  checksum field has been reused to be a min_revision field, referring to the
  microcode revision which fixed Entrysign (SB-7033, CVE-2024-36347).

  Cross-check this when trying to load microcode, but allow --force to override
  it.  If the signature scheme is genuinely different, a #GP will occur.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Release-Acked-By: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  (cherry picked from commit b3f015b8bad6e17300e299fe20beeef33be0007f)
  c2529496d07326f7a234c0c8e565bc8ec87d7836:x86/ucode: Refine the boundary checks for Entrysign

  After initial publication, the SB-7033 / CVE-2024-36347 bulletin was updated
  to list Zen5 CPUs as vulnerable.  Use Fam1ah as an upper bound, and adjust the
  command line documentation.

  When the Zen6 (also Fam1ah processors) model numbers are known, they'll want
  excluding from the range.

  Fixes: 630e8875ab36 ("x86/ucode: Perform extra SHA2 checks on AMD Fam17h/19h microcode")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Release-Acked-By: Oleksii Kurochko <oleksii.kurochko@gmail.com>
  b3f015b8bad6e17300e299fe20beeef33be0007f:x86/ucode: Cross check the minimum revision

  For Zen3-5 microcode blobs signed with the updated signature scheme, the
  checksum field has been reused to be a min_revision field, referring to the
  microcode revision which fixed Entrysign (SB-7033, CVE-2024-36347).

  Cross-check this when trying to load microcode, but allow --force to override
  it.  If the signature scheme is genuinely different, a #GP will occur.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Release-Acked-By: Oleksii Kurochko <oleksii.kurochko@gmail.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 07c7069cb26a38622344f1a4bd8ef9c96ea60583
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f42dff8429566c40e268c16e7266baa4fc7d4be7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b179b98a2e1ea336eb206bd24eb28388f5d08fb9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4f12a18da1c246d6ba4560fb175526cca595ca40
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b3f015b8bad6e17300e299fe20beeef33be0007f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0cbf79d2f68dc8411bd3e8de0111e8cdd4526f27
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c2529496d07326f7a234c0c8e565bc8ec87d7836
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4112b5c6a2443f41f9b6047168d64ae897ffe616
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: aabe803e8ee8ea84d9e39fbfb35924b7b5d71eba
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 87466121fd64f6043278947cdc80ad218c9a9c34
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/07c7069cb26a38622344f1a4bd8ef9c96ea60583
    reference_type: commit
    reference_id: 07c7069cb26a38622344f1a4bd8ef9c96ea60583
  - url: https://github.com/xen-project/xen/tree/0cbf79d2f68dc8411bd3e8de0111e8cdd4526f27
    reference_type: commit
    reference_id: 0cbf79d2f68dc8411bd3e8de0111e8cdd4526f27
  - url: https://github.com/xen-project/xen/tree/4112b5c6a2443f41f9b6047168d64ae897ffe616
    reference_type: commit
    reference_id: 4112b5c6a2443f41f9b6047168d64ae897ffe616
  - url: https://github.com/xen-project/xen/tree/4f12a18da1c246d6ba4560fb175526cca595ca40
    reference_type: commit
    reference_id: 4f12a18da1c246d6ba4560fb175526cca595ca40
  - url: https://github.com/xen-project/xen/tree/87466121fd64f6043278947cdc80ad218c9a9c34
    reference_type: commit
    reference_id: 87466121fd64f6043278947cdc80ad218c9a9c34
  - url: https://github.com/xen-project/xen/tree/aabe803e8ee8ea84d9e39fbfb35924b7b5d71eba
    reference_type: commit
    reference_id: aabe803e8ee8ea84d9e39fbfb35924b7b5d71eba
  - url: https://github.com/xen-project/xen/tree/b179b98a2e1ea336eb206bd24eb28388f5d08fb9
    reference_type: commit
    reference_id: b179b98a2e1ea336eb206bd24eb28388f5d08fb9
  - url: https://github.com/xen-project/xen/tree/b3f015b8bad6e17300e299fe20beeef33be0007f
    reference_type: commit
    reference_id: b3f015b8bad6e17300e299fe20beeef33be0007f
  - url: https://github.com/xen-project/xen/tree/c2529496d07326f7a234c0c8e565bc8ec87d7836
    reference_type: commit
    reference_id: c2529496d07326f7a234c0c8e565bc8ec87d7836
  - url: https://github.com/xen-project/xen/tree/f42dff8429566c40e268c16e7266baa4fc7d4be7
    reference_type: commit
    reference_id: f42dff8429566c40e268c16e7266baa4fc7d4be7
