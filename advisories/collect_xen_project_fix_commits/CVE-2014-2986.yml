advisory_id: CVE-2014-2986
datasource_id: collect_xen_project_fix_commits/CVE-2014-2986
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  139a62e98161051e7687d6c356d9a9b92a8801a3:xen/arm: vgic: Check rank in GICD_ICFGR* emulation before locking

  The function vgic_irq_rank may return NULL is the IRQ is not in range handled
  by the guest. This will result to derefence a NULL pointer which will crash
  Xen.

  I've checked the rest of the emulation and this is only place where the lock
  is taken before the rank is checked.

  This is CVE-2014-2986 / XSA-94.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Reported-by: Thomas Leonard <talex5@gmail.com>
  Reviewed-by: Jan Beulich <JBeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  bf70db7cea3794cf2f3c8d714b460bba86b04791:xen/arm: vgic: Check rank in GICD_ICFGR* emulation before locking

  The function vgic_irq_rank may return NULL is the IRQ is not in range handled
  by the guest. This will result to derefence a NULL pointer which will crash
  Xen.

  I've checked the rest of the emulation and this is only place where the lock
  is taken before the rank is checked.

  This is CVE-2014-2986 / XSA-94.

  Signed-off-by: Julien Grall <julien.grall@linaro.org>
  Reported-by: Thomas Leonard <talex5@gmail.com>
  Reviewed-by: Jan Beulich <JBeulich@suse.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: bf70db7cea3794cf2f3c8d714b460bba86b04791
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 139a62e98161051e7687d6c356d9a9b92a8801a3
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/139a62e98161051e7687d6c356d9a9b92a8801a3
    reference_type: commit
    reference_id: 139a62e98161051e7687d6c356d9a9b92a8801a3
  - url: https://github.com/xen-project/xen/tree/bf70db7cea3794cf2f3c8d714b460bba86b04791
    reference_type: commit
    reference_id: bf70db7cea3794cf2f3c8d714b460bba86b04791
