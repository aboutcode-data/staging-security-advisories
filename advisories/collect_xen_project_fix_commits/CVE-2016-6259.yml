advisory_id: CVE-2016-6259
datasource_id: collect_xen_project_fix_commits/CVE-2016-6259
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  c4c0312efaf8bd252ff06d55d6bf5b542a0a9421:x86/entry: Avoid SMAP violation in compat_create_bounce_frame()

  A 32bit guest kernel might be running on user mappings.
  compat_create_bounce_frame() must whitelist its guest accesses to avoid
  risking a SMAP violation.

  For both variants of create_bounce_frame(), re-blacklist user accesses if
  execution exits via an exception table redirection.

  This is XSA-183 / CVE-2016-6259

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: George Dunlap <george.dunlap@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  dfe85d302f5f127c4ab5e2a5e8bcd6a964f7218c:x86/entry: Avoid SMAP violation in compat_create_bounce_frame()

  A 32bit guest kernel might be running on user mappings.
  compat_create_bounce_frame() must whitelist its guest accesses to avoid
  risking a SMAP violation.

  For both variants of create_bounce_frame(), re-blacklist user accesses if
  execution exits via an exception table redirection.

  This is XSA-183 / CVE-2016-6259

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: George Dunlap <george.dunlap@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  899495b60a6e55fc2afa69d4616cb08af212de12:x86/entry: Avoid SMAP violation in compat_create_bounce_frame()

  A 32bit guest kernel might be running on user mappings.
  compat_create_bounce_frame() must whitelist its guest accesses to avoid
  risking a SMAP violation.

  For both variants of create_bounce_frame(), re-blacklist user accesses if
  execution exits via an exception table redirection.

  This is XSA-183 / CVE-2016-6259

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: George Dunlap <george.dunlap@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  9f1441487aa215193a7c00fd9cb80b335542465e:x86/entry: Avoid SMAP violation in compat_create_bounce_frame()

  A 32bit guest kernel might be running on user mappings.
  compat_create_bounce_frame() must whitelist its guest accesses to avoid
  risking a SMAP violation.

  For both variants of create_bounce_frame(), re-blacklist user accesses if
  execution exits via an exception table redirection.

  This is XSA-183 / CVE-2016-6259

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: George Dunlap <george.dunlap@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 899495b60a6e55fc2afa69d4616cb08af212de12
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c4c0312efaf8bd252ff06d55d6bf5b542a0a9421
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: dfe85d302f5f127c4ab5e2a5e8bcd6a964f7218c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9f1441487aa215193a7c00fd9cb80b335542465e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/899495b60a6e55fc2afa69d4616cb08af212de12
    reference_type: commit
    reference_id: 899495b60a6e55fc2afa69d4616cb08af212de12
  - url: https://github.com/xen-project/xen/tree/9f1441487aa215193a7c00fd9cb80b335542465e
    reference_type: commit
    reference_id: 9f1441487aa215193a7c00fd9cb80b335542465e
  - url: https://github.com/xen-project/xen/tree/c4c0312efaf8bd252ff06d55d6bf5b542a0a9421
    reference_type: commit
    reference_id: c4c0312efaf8bd252ff06d55d6bf5b542a0a9421
  - url: https://github.com/xen-project/xen/tree/dfe85d302f5f127c4ab5e2a5e8bcd6a964f7218c
    reference_type: commit
    reference_id: dfe85d302f5f127c4ab5e2a5e8bcd6a964f7218c
