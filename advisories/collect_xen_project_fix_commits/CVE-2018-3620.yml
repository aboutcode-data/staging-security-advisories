advisory_id: CVE-2018-3620
datasource_id: collect_xen_project_fix_commits/CVE-2018-3620
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  4b12b44b21a9d724beaff3330bfd2db57640e416:x86/spec-ctrl: Introduce an option to control L1D_FLUSH for HVM HAP guests

  This mitigation requires up-to-date microcode, and is enabled by default on
  affected hardware if available, and is used for HVM guests

  The default for SMT/Hyperthreading is far more complicated to reason about,
  not least because we don't know if the user is going to want to run any HVM
  guests to begin with.  If a explicit default isn't given, nag the user to
  perform a risk assessment and choose an explicit default, and leave other
  configuration to the toolstack.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3bd36952dab60290f33d6791070b57920e10754b)
  1fa97ce4faf5aff5a3b77bdd25e2b47f568d661e:x86/pv: Force a guest into shadow mode when it writes an L1TF-vulnerable PTE

  See the comment in shadow.h for an explanation of L1TF and the safety
  consideration of the PTEs.

  In the case that CONFIG_SHADOW_PAGING isn't compiled in, crash the domain
  instead.  This allows well-behaved PV guests to function, while preventing
  L1TF from being exploited.  (Note: PV guest kernels which haven't been updated
  with L1TF mitigations will likely be crashed as soon as they try paging a
  piece of userspace out to disk.)

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 06e8b622d3f3c0fa5075e91b041c6f45549ad70a)
  3bcdcd8fcb994f27fdf282828428ed7be237a368:x86/mm: Plumbing to allow any PTE update to fail with -ERESTART

  Switching to shadow mode is performed in tasklet context.  To facilitate this,
  we schedule the tasklet, then create a hypercall continuation to allow the
  switch to take place.

  As a consequence, the x86 mm code needs to cope with an L1e operation being
  continuable.  do_mmu{,ext}_op() may no longer assert that a continuation
  doesn't happen on the final iteration.

  To handle the arguments correctly on continuation, compat_update_va_mapping*()
  may no longer call into their non-compat counterparts.  Move the compat
  functions into mm.c rather than exporting __do_update_va_mapping() and
  {get,put}_pg_owner(), and fix an unsigned long/int inconsistency with
  compat_update_va_mapping_otherdomain().

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit c612481d1c9232c6abf91b03ec655e92f808805f)
  17b522ca3aee8c269736cd245b7b923a9d6b5d6f:x86/shadow: Infrastructure to force a PV guest into shadow mode

  To mitigate L1TF, we cannot alter an architecturally-legitimate PTE a PV guest
  chooses to write, but we can force the PV domain into shadow mode so Xen
  controls the PTEs which are reachable by the CPU pagewalk.

  Introduce new shadow mode, PG_SH_forced, and a tasklet to perform the
  transition.  Later patches will introduce the logic to enable this mode at the
  appropriate time.

  To simplify vcpu cleanup, make tasklet_kill() idempotent with respect to
  tasklet_init(), which involves adding a helper to check for an uninitialised
  list head.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b76ec3946bf6caca2c3950b857c008bc8db6723f)
  2b1e6a4868e1386d31a42feba2c2553463302282:x86/spec-ctrl: Introduce an option to control L1TF mitigation for PV guests

  Shadowing a PV guest is only available when shadow paging is compiled in.
  When shadow paging isn't available, guests can be crashed instead as
  mitigation from Xen's point of view.

  Ideally, dom0 would also be potentially-shadowed-by-default, but dom0 has
  never been shadowed before, and there are some stability issues under
  investigation.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 66a4e986819a86ba66ca2fe9d925e62a4fd30114)
  0840adeaa9555be3fbb5329bfdb902766a5d9712:x86/spec-ctrl: Calculate safe PTE addresses for L1TF mitigations

  Safe PTE addresses for L1TF mitigations are ones which are within the L1D
  address width (may be wider than reported in CPUID), and above the highest
  cacheable RAM/NVDIMM/BAR/etc.

  All logic here is best-effort heuristics, which should in practice be fine for
  most hardware.  Future work will see about disentangling the SRAT handling
  further, as well as having L0 pass this information down to lower levels when
  virtualised.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b03a57c9383b32181e60add6b6de12b473652aa4)
  0aa4696e13be72a5aadd2f6b347ece1af38d8c67:x86/spec-ctrl: Introduce an option to control L1D_FLUSH for HVM HAP guests

  This mitigation requires up-to-date microcode, and is enabled by default on
  affected hardware if available, and is used for HVM guests

  The default for SMT/Hyperthreading is far more complicated to reason about,
  not least because we don't know if the user is going to want to run any HVM
  guests to begin with.  If a explicit default isn't given, nag the user to
  perform a risk assessment and choose an explicit default, and leave other
  configuration to the toolstack.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3bd36952dab60290f33d6791070b57920e10754b)
  1a908037ee92848d14cb20cafbd95078b7dcbbb5:x86/pv: Force a guest into shadow mode when it writes an L1TF-vulnerable PTE

  See the comment in shadow.h for an explanation of L1TF and the safety
  consideration of the PTEs.

  In the case that CONFIG_SHADOW_PAGING isn't compiled in, crash the domain
  instead.  This allows well-behaved PV guests to function, while preventing
  L1TF from being exploited.  (Note: PV guest kernels which haven't been updated
  with L1TF mitigations will likely be crashed as soon as they try paging a
  piece of userspace out to disk.)

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 06e8b622d3f3c0fa5075e91b041c6f45549ad70a)
  0abc1aee7c1cbed1233d16fea96f85d63cf18122:x86/mm: Plumbing to allow any PTE update to fail with -ERESTART

  Switching to shadow mode is performed in tasklet context.  To facilitate this,
  we schedule the tasklet, then create a hypercall continuation to allow the
  switch to take place.

  As a consequence, the x86 mm code needs to cope with an L1e operation being
  continuable.  do_mmu{,ext}_op() may no longer assert that a continuation
  doesn't happen on the final iteration.

  To handle the arguments correctly on continuation, compat_update_va_mapping*()
  may no longer call into their non-compat counterparts.  Move the compat
  functions into mm.c rather than exporting __do_update_va_mapping() and
  {get,put}_pg_owner(), and fix an unsigned long/int inconsistency with
  compat_update_va_mapping_otherdomain().

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit c612481d1c9232c6abf91b03ec655e92f808805f)
  1fdb25a614b22a72b02d868893989d3b7ace35b4:x86/shadow: Infrastructure to force a PV guest into shadow mode

  To mitigate L1TF, we cannot alter an architecturally-legitimate PTE a PV guest
  chooses to write, but we can force the PV domain into shadow mode so Xen
  controls the PTEs which are reachable by the CPU pagewalk.

  Introduce new shadow mode, PG_SH_forced, and a tasklet to perform the
  transition.  Later patches will introduce the logic to enable this mode at the
  appropriate time.

  To simplify vcpu cleanup, make tasklet_kill() idempotent with respect to
  tasklet_init(), which involves adding a helper to check for an uninitialised
  list head.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b76ec3946bf6caca2c3950b857c008bc8db6723f)
  c9641d4b1fa43904c1b24a787899961c5a5428f2:x86/spec-ctrl: Introduce an option to control L1TF mitigation for PV guests

  Shadowing a PV guest is only available when shadow paging is compiled in.
  When shadow paging isn't available, guests can be crashed instead as
  mitigation from Xen's point of view.

  Ideally, dom0 would also be potentially-shadowed-by-default, but dom0 has
  never been shadowed before, and there are some stability issues under
  investigation.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 66a4e986819a86ba66ca2fe9d925e62a4fd30114)
  61c4360284826caba58b9ea5d547fa0fa7e28795:x86/spec-ctrl: Calculate safe PTE addresses for L1TF mitigations

  Safe PTE addresses for L1TF mitigations are ones which are within the L1D
  address width (may be wider than reported in CPUID), and above the highest
  cacheable RAM/NVDIMM/BAR/etc.

  All logic here is best-effort heuristics, which should in practice be fine for
  most hardware.  Future work will see about disentangling the SRAT handling
  further, as well as having L0 pass this information down to lower levels when
  virtualised.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b03a57c9383b32181e60add6b6de12b473652aa4)
  1c6c2def1cfc7220f0bb8aad5da9234402cf109d:x86/spec-ctrl: Introduce an option to control L1D_FLUSH for HVM HAP guests

  This mitigation requires up-to-date microcode, and is enabled by default on
  affected hardware if available, and is used for HVM guests

  The default for SMT/Hyperthreading is far more complicated to reason about,
  not least because we don't know if the user is going to want to run any HVM
  guests to begin with.  If a explicit default isn't given, nag the user to
  perform a risk assessment and choose an explicit default, and leave other
  configuration to the toolstack.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3bd36952dab60290f33d6791070b57920e10754b)
  9e7d5e266a1b3417c9b88943c9000181bfe920de:x86/pv: Force a guest into shadow mode when it writes an L1TF-vulnerable PTE

  See the comment in shadow.h for an explanation of L1TF and the safety
  consideration of the PTEs.

  In the case that CONFIG_SHADOW_PAGING isn't compiled in, crash the domain
  instead.  This allows well-behaved PV guests to function, while preventing
  L1TF from being exploited.  (Note: PV guest kernels which haven't been updated
  with L1TF mitigations will likely be crashed as soon as they try paging a
  piece of userspace out to disk.)

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 06e8b622d3f3c0fa5075e91b041c6f45549ad70a)
  7849d13d456916138d1b79fe92b0f8ee2fd60429:x86/mm: Plumbing to allow any PTE update to fail with -ERESTART

  Switching to shadow mode is performed in tasklet context.  To facilitate this,
  we schedule the tasklet, then create a hypercall continuation to allow the
  switch to take place.

  As a consequence, the x86 mm code needs to cope with an L1e operation being
  continuable.  do_mmu{,ext}_op() may no longer assert that a continuation
  doesn't happen on the final iteration.

  To handle the arguments correctly on continuation, compat_update_va_mapping*()
  may no longer call into their non-compat counterparts.  Move the compat
  functions into mm.c rather than exporting __do_update_va_mapping() and
  {get,put}_pg_owner(), and fix an unsigned long/int inconsistency with
  compat_update_va_mapping_otherdomain().

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit c612481d1c9232c6abf91b03ec655e92f808805f)
  e819108a41ce7f5ebd31bd8fe526e2b07523cfc4:x86/shadow: Infrastructure to force a PV guest into shadow mode

  To mitigate L1TF, we cannot alter an architecturally-legitimate PTE a PV guest
  chooses to write, but we can force the PV domain into shadow mode so Xen
  controls the PTEs which are reachable by the CPU pagewalk.

  Introduce new shadow mode, PG_SH_forced, and a tasklet to perform the
  transition.  Later patches will introduce the logic to enable this mode at the
  appropriate time.

  To simplify vcpu cleanup, make tasklet_kill() idempotent with respect to
  tasklet_init(), which involves adding a helper to check for an uninitialised
  list head.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b76ec3946bf6caca2c3950b857c008bc8db6723f)
  fe7882948064e4bae97ce9ef9c2f1cbad20b7618:x86/spec-ctrl: Introduce an option to control L1TF mitigation for PV guests

  Shadowing a PV guest is only available when shadow paging is compiled in.
  When shadow paging isn't available, guests can be crashed instead as
  mitigation from Xen's point of view.

  Ideally, dom0 would also be potentially-shadowed-by-default, but dom0 has
  never been shadowed before, and there are some stability issues under
  investigation.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 66a4e986819a86ba66ca2fe9d925e62a4fd30114)
  28fc483f3d18e96fc5cffb807892f61833320dce:x86/spec-ctrl: Calculate safe PTE addresses for L1TF mitigations

  Safe PTE addresses for L1TF mitigations are ones which are within the L1D
  address width (may be wider than reported in CPUID), and above the highest
  cacheable RAM/NVDIMM/BAR/etc.

  All logic here is best-effort heuristics, which should in practice be fine for
  most hardware.  Future work will see about disentangling the SRAT handling
  further, as well as having L0 pass this information down to lower levels when
  virtualised.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b03a57c9383b32181e60add6b6de12b473652aa4)
  cac6aa015c9d253c83e08091f7e3149c2a884908:x86/spec-ctrl: Introduce an option to control L1D_FLUSH for HVM HAP guests

  This mitigation requires up-to-date microcode, and is enabled by default on
  affected hardware if available, and is used for HVM guests

  The default for SMT/Hyperthreading is far more complicated to reason about,
  not least because we don't know if the user is going to want to run any HVM
  guests to begin with.  If a explicit default isn't given, nag the user to
  perform a risk assessment and choose an explicit default, and leave other
  configuration to the toolstack.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3bd36952dab60290f33d6791070b57920e10754b)
  f73c7770426344a670e0d42e926ff8c0f897ee1b:x86/pv: Force a guest into shadow mode when it writes an L1TF-vulnerable PTE

  See the comment in shadow.h for an explanation of L1TF and the safety
  consideration of the PTEs.

  In the case that CONFIG_SHADOW_PAGING isn't compiled in, crash the domain
  instead.  This allows well-behaved PV guests to function, while preventing
  L1TF from being exploited.  (Note: PV guest kernels which haven't been updated
  with L1TF mitigations will likely be crashed as soon as they try paging a
  piece of userspace out to disk.)

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 06e8b622d3f3c0fa5075e91b041c6f45549ad70a)
  a5d7667a38ebce4d07513349b0fb83b8fa78ba5b:x86/mm: Plumbing to allow any PTE update to fail with -ERESTART

  Switching to shadow mode is performed in tasklet context.  To facilitate this,
  we schedule the tasklet, then create a hypercall continuation to allow the
  switch to take place.

  As a consequence, the x86 mm code needs to cope with an L1e operation being
  continuable.  do_mmu{,ext}_op() may no longer assert that a continuation
  doesn't happen on the final iteration.

  To handle the arguments correctly on continuation, compat_update_va_mapping*()
  may no longer call into their non-compat counterparts.  Move the compat
  functions into mm.c rather than exporting __do_update_va_mapping() and
  {get,put}_pg_owner(), and fix an unsigned long/int inconsistency with
  compat_update_va_mapping_otherdomain().

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit c612481d1c9232c6abf91b03ec655e92f808805f)
  4704d590fa2ec7307d18e41f3e53ac4ae4a834a7:x86/shadow: Infrastructure to force a PV guest into shadow mode

  To mitigate L1TF, we cannot alter an architecturally-legitimate PTE a PV guest
  chooses to write, but we can force the PV domain into shadow mode so Xen
  controls the PTEs which are reachable by the CPU pagewalk.

  Introduce new shadow mode, PG_SH_forced, and a tasklet to perform the
  transition.  Later patches will introduce the logic to enable this mode at the
  appropriate time.

  To simplify vcpu cleanup, make tasklet_kill() idempotent with respect to
  tasklet_init(), which involves adding a helper to check for an uninitialised
  list head.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b76ec3946bf6caca2c3950b857c008bc8db6723f)
  3ad78aaa4cab2e5089c012e799e5b252469def74:x86/spec-ctrl: Introduce an option to control L1TF mitigation for PV guests

  Shadowing a PV guest is only available when shadow paging is compiled in.
  When shadow paging isn't available, guests can be crashed instead as
  mitigation from Xen's point of view.

  Ideally, dom0 would also be potentially-shadowed-by-default, but dom0 has
  never been shadowed before, and there are some stability issues under
  investigation.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 66a4e986819a86ba66ca2fe9d925e62a4fd30114)
  a060b6981a24aa6d9154fbc07e25f54fcd4af932:x86/spec-ctrl: Calculate safe PTE addresses for L1TF mitigations

  Safe PTE addresses for L1TF mitigations are ones which are within the L1D
  address width (may be wider than reported in CPUID), and above the highest
  cacheable RAM/NVDIMM/BAR/etc.

  All logic here is best-effort heuristics, which should in practice be fine for
  most hardware.  Future work will see about disentangling the SRAT handling
  further, as well as having L0 pass this information down to lower levels when
  virtualised.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b03a57c9383b32181e60add6b6de12b473652aa4)
  ed933041a8b36bcab65bb09cb2594215de7ac894:x86/spec-ctrl: Introduce an option to control L1D_FLUSH for HVM HAP guests

  This mitigation requires up-to-date microcode, and is enabled by default on
  affected hardware if available, and is used for HVM guests

  The default for SMT/Hyperthreading is far more complicated to reason about,
  not least because we don't know if the user is going to want to run any HVM
  guests to begin with.  If a explicit default isn't given, nag the user to
  perform a risk assessment and choose an explicit default, and leave other
  configuration to the toolstack.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3bd36952dab60290f33d6791070b57920e10754b)
  c67a8b808ad16864248f24ef099e7d181e107dcb:x86/pv: Force a guest into shadow mode when it writes an L1TF-vulnerable PTE

  See the comment in shadow.h for an explanation of L1TF and the safety
  consideration of the PTEs.

  In the case that CONFIG_SHADOW_PAGING isn't compiled in, crash the domain
  instead.  This allows well-behaved PV guests to function, while preventing
  L1TF from being exploited.  (Note: PV guest kernels which haven't been updated
  with L1TF mitigations will likely be crashed as soon as they try paging a
  piece of userspace out to disk.)

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 06e8b622d3f3c0fa5075e91b041c6f45549ad70a)
  85d133b90dcb2167b0b115c3420300068c711c32:x86/mm: Plumbing to allow any PTE update to fail with -ERESTART

  Switching to shadow mode is performed in tasklet context.  To facilitate this,
  we schedule the tasklet, then create a hypercall continuation to allow the
  switch to take place.

  As a consequence, the x86 mm code needs to cope with an L1e operation being
  continuable.  do_mmu{,ext}_op() may no longer assert that a continuation
  doesn't happen on the final iteration.

  To handle the arguments correctly on continuation, compat_update_va_mapping*()
  may no longer call into their non-compat counterparts.  Move the compat
  functions into mm.c rather than exporting __do_update_va_mapping() and
  {get,put}_pg_owner(), and fix an unsigned long/int inconsistency with
  compat_update_va_mapping_otherdomain().

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit c612481d1c9232c6abf91b03ec655e92f808805f)
  d46374d7943f6dbbf683f97f0c32196aee69a56b:x86/shadow: Infrastructure to force a PV guest into shadow mode

  To mitigate L1TF, we cannot alter an architecturally-legitimate PTE a PV guest
  chooses to write, but we can force the PV domain into shadow mode so Xen
  controls the PTEs which are reachable by the CPU pagewalk.

  Introduce new shadow mode, PG_SH_forced, and a tasklet to perform the
  transition.  Later patches will introduce the logic to enable this mode at the
  appropriate time.

  To simplify vcpu cleanup, make tasklet_kill() idempotent with respect to
  tasklet_init(), which involves adding a helper to check for an uninitialised
  list head.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b76ec3946bf6caca2c3950b857c008bc8db6723f)
  614fd2558f4183755e8fe6259f108698ee2bb131:x86/spec-ctrl: Introduce an option to control L1TF mitigation for PV guests

  Shadowing a PV guest is only available when shadow paging is compiled in.
  When shadow paging isn't available, guests can be crashed instead as
  mitigation from Xen's point of view.

  Ideally, dom0 would also be potentially-shadowed-by-default, but dom0 has
  never been shadowed before, and there are some stability issues under
  investigation.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 66a4e986819a86ba66ca2fe9d925e62a4fd30114)
  684fb8c7c46b6512c359b5e5ce1b0723aecc809c:x86/spec-ctrl: Calculate safe PTE addresses for L1TF mitigations

  Safe PTE addresses for L1TF mitigations are ones which are within the L1D
  address width (may be wider than reported in CPUID), and above the highest
  cacheable RAM/NVDIMM/BAR/etc.

  All logic here is best-effort heuristics, which should in practice be fine for
  most hardware.  Future work will see about disentangling the SRAT handling
  further, as well as having L0 pass this information down to lower levels when
  virtualised.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b03a57c9383b32181e60add6b6de12b473652aa4)
  2a47c7550910f5d591ca0de369234f8c18daa2d2:x86/spec-ctrl: Introduce an option to control L1D_FLUSH for HVM HAP guests

  This mitigation requires up-to-date microcode, and is enabled by default on
  affected hardware if available, and is used for HVM guests

  The default for SMT/Hyperthreading is far more complicated to reason about,
  not least because we don't know if the user is going to want to run any HVM
  guests to begin with.  If a explicit default isn't given, nag the user to
  perform a risk assessment and choose an explicit default, and leave other
  configuration to the toolstack.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 3bd36952dab60290f33d6791070b57920e10754b)
  665e7685b4f5a683101ef833c45415e2548d873f:x86/pv: Force a guest into shadow mode when it writes an L1TF-vulnerable PTE

  See the comment in shadow.h for an explanation of L1TF and the safety
  consideration of the PTEs.

  In the case that CONFIG_SHADOW_PAGING isn't compiled in, crash the domain
  instead.  This allows well-behaved PV guests to function, while preventing
  L1TF from being exploited.  (Note: PV guest kernels which haven't been updated
  with L1TF mitigations will likely be crashed as soon as they try paging a
  piece of userspace out to disk.)

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 06e8b622d3f3c0fa5075e91b041c6f45549ad70a)
  f4a049ede7ee9e1fafad6248cffc5e6deac1bc39:x86/mm: Plumbing to allow any PTE update to fail with -ERESTART

  Switching to shadow mode is performed in tasklet context.  To facilitate this,
  we schedule the tasklet, then create a hypercall continuation to allow the
  switch to take place.

  As a consequence, the x86 mm code needs to cope with an L1e operation being
  continuable.  do_mmu{,ext}_op() may no longer assert that a continuation
  doesn't happen on the final iteration.

  To handle the arguments correctly on continuation, compat_update_va_mapping*()
  may no longer call into their non-compat counterparts.  Move the compat
  functions into mm.c rather than exporting __do_update_va_mapping() and
  {get,put}_pg_owner(), and fix an unsigned long/int inconsistency with
  compat_update_va_mapping_otherdomain().

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit c612481d1c9232c6abf91b03ec655e92f808805f)
  02d2c660935cfd6ff2438afb3892776dfc7db711:x86/shadow: Infrastructure to force a PV guest into shadow mode

  To mitigate L1TF, we cannot alter an architecturally-legitimate PTE a PV guest
  chooses to write, but we can force the PV domain into shadow mode so Xen
  controls the PTEs which are reachable by the CPU pagewalk.

  Introduce new shadow mode, PG_SH_forced, and a tasklet to perform the
  transition.  Later patches will introduce the logic to enable this mode at the
  appropriate time.

  To simplify vcpu cleanup, make tasklet_kill() idempotent with respect to
  tasklet_init(), which involves adding a helper to check for an uninitialised
  list head.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b76ec3946bf6caca2c3950b857c008bc8db6723f)
  57483c09ef4fe9489ec4214989a97949916fecc0:x86/spec-ctrl: Introduce an option to control L1TF mitigation for PV guests

  Shadowing a PV guest is only available when shadow paging is compiled in.
  When shadow paging isn't available, guests can be crashed instead as
  mitigation from Xen's point of view.

  Ideally, dom0 would also be potentially-shadowed-by-default, but dom0 has
  never been shadowed before, and there are some stability issues under
  investigation.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 66a4e986819a86ba66ca2fe9d925e62a4fd30114)
  d044f6cc590c58178d87ad78f1859d1c7905ee0b:x86/spec-ctrl: Calculate safe PTE addresses for L1TF mitigations

  Safe PTE addresses for L1TF mitigations are ones which are within the L1D
  address width (may be wider than reported in CPUID), and above the highest
  cacheable RAM/NVDIMM/BAR/etc.

  All logic here is best-effort heuristics, which should in practice be fine for
  most hardware.  Future work will see about disentangling the SRAT handling
  further, as well as having L0 pass this information down to lower levels when
  virtualised.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit b03a57c9383b32181e60add6b6de12b473652aa4)
  3bd36952dab60290f33d6791070b57920e10754b:x86/spec-ctrl: Introduce an option to control L1D_FLUSH for HVM HAP guests

  This mitigation requires up-to-date microcode, and is enabled by default on
  affected hardware if available, and is used for HVM guests

  The default for SMT/Hyperthreading is far more complicated to reason about,
  not least because we don't know if the user is going to want to run any HVM
  guests to begin with.  If a explicit default isn't given, nag the user to
  perform a risk assessment and choose an explicit default, and leave other
  configuration to the toolstack.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  06e8b622d3f3c0fa5075e91b041c6f45549ad70a:x86/pv: Force a guest into shadow mode when it writes an L1TF-vulnerable PTE

  See the comment in shadow.h for an explanation of L1TF and the safety
  consideration of the PTEs.

  In the case that CONFIG_SHADOW_PAGING isn't compiled in, crash the domain
  instead.  This allows well-behaved PV guests to function, while preventing
  L1TF from being exploited.  (Note: PV guest kernels which haven't been updated
  with L1TF mitigations will likely be crashed as soon as they try paging a
  piece of userspace out to disk.)

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  c612481d1c9232c6abf91b03ec655e92f808805f:x86/mm: Plumbing to allow any PTE update to fail with -ERESTART

  Switching to shadow mode is performed in tasklet context.  To facilitate this,
  we schedule the tasklet, then create a hypercall continuation to allow the
  switch to take place.

  As a consequence, the x86 mm code needs to cope with an L1e operation being
  continuable.  do_mmu{,ext}_op() may no longer assert that a continuation
  doesn't happen on the final iteration.

  To handle the arguments correctly on continuation, compat_update_va_mapping*()
  may no longer call into their non-compat counterparts.  Move the compat
  functions into mm.c rather than exporting __do_update_va_mapping() and
  {get,put}_pg_owner(), and fix an unsigned long/int inconsistency with
  compat_update_va_mapping_otherdomain().

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  b76ec3946bf6caca2c3950b857c008bc8db6723f:x86/shadow: Infrastructure to force a PV guest into shadow mode

  To mitigate L1TF, we cannot alter an architecturally-legitimate PTE a PV guest
  chooses to write, but we can force the PV domain into shadow mode so Xen
  controls the PTEs which are reachable by the CPU pagewalk.

  Introduce new shadow mode, PG_SH_forced, and a tasklet to perform the
  transition.  Later patches will introduce the logic to enable this mode at the
  appropriate time.

  To simplify vcpu cleanup, make tasklet_kill() idempotent with respect to
  tasklet_init(), which involves adding a helper to check for an uninitialised
  list head.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Juergen Gross <jgross@suse.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  66a4e986819a86ba66ca2fe9d925e62a4fd30114:x86/spec-ctrl: Introduce an option to control L1TF mitigation for PV guests

  Shadowing a PV guest is only available when shadow paging is compiled in.
  When shadow paging isn't available, guests can be crashed instead as
  mitigation from Xen's point of view.

  Ideally, dom0 would also be potentially-shadowed-by-default, but dom0 has
  never been shadowed before, and there are some stability issues under
  investigation.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  b03a57c9383b32181e60add6b6de12b473652aa4:x86/spec-ctrl: Calculate safe PTE addresses for L1TF mitigations

  Safe PTE addresses for L1TF mitigations are ones which are within the L1D
  address width (may be wider than reported in CPUID), and above the highest
  cacheable RAM/NVDIMM/BAR/etc.

  All logic here is best-effort heuristics, which should in practice be fine for
  most hardware.  Future work will see about disentangling the SRAT handling
  further, as well as having L0 pass this information down to lower levels when
  virtualised.

  This is part of XSA-273 / CVE-2018-3620.

  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c9641d4b1fa43904c1b24a787899961c5a5428f2
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 28fc483f3d18e96fc5cffb807892f61833320dce
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 665e7685b4f5a683101ef833c45415e2548d873f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 06e8b622d3f3c0fa5075e91b041c6f45549ad70a
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9e7d5e266a1b3417c9b88943c9000181bfe920de
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d46374d7943f6dbbf683f97f0c32196aee69a56b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1a908037ee92848d14cb20cafbd95078b7dcbbb5
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c612481d1c9232c6abf91b03ec655e92f808805f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 17b522ca3aee8c269736cd245b7b923a9d6b5d6f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2b1e6a4868e1386d31a42feba2c2553463302282
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a5d7667a38ebce4d07513349b0fb83b8fa78ba5b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2a47c7550910f5d591ca0de369234f8c18daa2d2
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 57483c09ef4fe9489ec4214989a97949916fecc0
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c67a8b808ad16864248f24ef099e7d181e107dcb
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 61c4360284826caba58b9ea5d547fa0fa7e28795
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 614fd2558f4183755e8fe6259f108698ee2bb131
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1fa97ce4faf5aff5a3b77bdd25e2b47f568d661e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4b12b44b21a9d724beaff3330bfd2db57640e416
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1fdb25a614b22a72b02d868893989d3b7ace35b4
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 85d133b90dcb2167b0b115c3420300068c711c32
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f73c7770426344a670e0d42e926ff8c0f897ee1b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0840adeaa9555be3fbb5329bfdb902766a5d9712
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: cac6aa015c9d253c83e08091f7e3149c2a884908
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1c6c2def1cfc7220f0bb8aad5da9234402cf109d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0abc1aee7c1cbed1233d16fea96f85d63cf18122
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 02d2c660935cfd6ff2438afb3892776dfc7db711
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 66a4e986819a86ba66ca2fe9d925e62a4fd30114
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e819108a41ce7f5ebd31bd8fe526e2b07523cfc4
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ed933041a8b36bcab65bb09cb2594215de7ac894
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3ad78aaa4cab2e5089c012e799e5b252469def74
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 684fb8c7c46b6512c359b5e5ce1b0723aecc809c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3bd36952dab60290f33d6791070b57920e10754b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d044f6cc590c58178d87ad78f1859d1c7905ee0b
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7849d13d456916138d1b79fe92b0f8ee2fd60429
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b03a57c9383b32181e60add6b6de12b473652aa4
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: b76ec3946bf6caca2c3950b857c008bc8db6723f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0aa4696e13be72a5aadd2f6b347ece1af38d8c67
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4704d590fa2ec7307d18e41f3e53ac4ae4a834a7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a060b6981a24aa6d9154fbc07e25f54fcd4af932
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f4a049ede7ee9e1fafad6248cffc5e6deac1bc39
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3bcdcd8fcb994f27fdf282828428ed7be237a368
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: fe7882948064e4bae97ce9ef9c2f1cbad20b7618
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/02d2c660935cfd6ff2438afb3892776dfc7db711
    reference_type: commit
    reference_id: 02d2c660935cfd6ff2438afb3892776dfc7db711
  - url: https://github.com/xen-project/xen/tree/06e8b622d3f3c0fa5075e91b041c6f45549ad70a
    reference_type: commit
    reference_id: 06e8b622d3f3c0fa5075e91b041c6f45549ad70a
  - url: https://github.com/xen-project/xen/tree/0840adeaa9555be3fbb5329bfdb902766a5d9712
    reference_type: commit
    reference_id: 0840adeaa9555be3fbb5329bfdb902766a5d9712
  - url: https://github.com/xen-project/xen/tree/0aa4696e13be72a5aadd2f6b347ece1af38d8c67
    reference_type: commit
    reference_id: 0aa4696e13be72a5aadd2f6b347ece1af38d8c67
  - url: https://github.com/xen-project/xen/tree/0abc1aee7c1cbed1233d16fea96f85d63cf18122
    reference_type: commit
    reference_id: 0abc1aee7c1cbed1233d16fea96f85d63cf18122
  - url: https://github.com/xen-project/xen/tree/17b522ca3aee8c269736cd245b7b923a9d6b5d6f
    reference_type: commit
    reference_id: 17b522ca3aee8c269736cd245b7b923a9d6b5d6f
  - url: https://github.com/xen-project/xen/tree/1a908037ee92848d14cb20cafbd95078b7dcbbb5
    reference_type: commit
    reference_id: 1a908037ee92848d14cb20cafbd95078b7dcbbb5
  - url: https://github.com/xen-project/xen/tree/1c6c2def1cfc7220f0bb8aad5da9234402cf109d
    reference_type: commit
    reference_id: 1c6c2def1cfc7220f0bb8aad5da9234402cf109d
  - url: https://github.com/xen-project/xen/tree/1fa97ce4faf5aff5a3b77bdd25e2b47f568d661e
    reference_type: commit
    reference_id: 1fa97ce4faf5aff5a3b77bdd25e2b47f568d661e
  - url: https://github.com/xen-project/xen/tree/1fdb25a614b22a72b02d868893989d3b7ace35b4
    reference_type: commit
    reference_id: 1fdb25a614b22a72b02d868893989d3b7ace35b4
  - url: https://github.com/xen-project/xen/tree/28fc483f3d18e96fc5cffb807892f61833320dce
    reference_type: commit
    reference_id: 28fc483f3d18e96fc5cffb807892f61833320dce
  - url: https://github.com/xen-project/xen/tree/2a47c7550910f5d591ca0de369234f8c18daa2d2
    reference_type: commit
    reference_id: 2a47c7550910f5d591ca0de369234f8c18daa2d2
  - url: https://github.com/xen-project/xen/tree/2b1e6a4868e1386d31a42feba2c2553463302282
    reference_type: commit
    reference_id: 2b1e6a4868e1386d31a42feba2c2553463302282
  - url: https://github.com/xen-project/xen/tree/3ad78aaa4cab2e5089c012e799e5b252469def74
    reference_type: commit
    reference_id: 3ad78aaa4cab2e5089c012e799e5b252469def74
  - url: https://github.com/xen-project/xen/tree/3bcdcd8fcb994f27fdf282828428ed7be237a368
    reference_type: commit
    reference_id: 3bcdcd8fcb994f27fdf282828428ed7be237a368
  - url: https://github.com/xen-project/xen/tree/3bd36952dab60290f33d6791070b57920e10754b
    reference_type: commit
    reference_id: 3bd36952dab60290f33d6791070b57920e10754b
  - url: https://github.com/xen-project/xen/tree/4704d590fa2ec7307d18e41f3e53ac4ae4a834a7
    reference_type: commit
    reference_id: 4704d590fa2ec7307d18e41f3e53ac4ae4a834a7
  - url: https://github.com/xen-project/xen/tree/4b12b44b21a9d724beaff3330bfd2db57640e416
    reference_type: commit
    reference_id: 4b12b44b21a9d724beaff3330bfd2db57640e416
  - url: https://github.com/xen-project/xen/tree/57483c09ef4fe9489ec4214989a97949916fecc0
    reference_type: commit
    reference_id: 57483c09ef4fe9489ec4214989a97949916fecc0
  - url: https://github.com/xen-project/xen/tree/614fd2558f4183755e8fe6259f108698ee2bb131
    reference_type: commit
    reference_id: 614fd2558f4183755e8fe6259f108698ee2bb131
  - url: https://github.com/xen-project/xen/tree/61c4360284826caba58b9ea5d547fa0fa7e28795
    reference_type: commit
    reference_id: 61c4360284826caba58b9ea5d547fa0fa7e28795
  - url: https://github.com/xen-project/xen/tree/665e7685b4f5a683101ef833c45415e2548d873f
    reference_type: commit
    reference_id: 665e7685b4f5a683101ef833c45415e2548d873f
  - url: https://github.com/xen-project/xen/tree/66a4e986819a86ba66ca2fe9d925e62a4fd30114
    reference_type: commit
    reference_id: 66a4e986819a86ba66ca2fe9d925e62a4fd30114
  - url: https://github.com/xen-project/xen/tree/684fb8c7c46b6512c359b5e5ce1b0723aecc809c
    reference_type: commit
    reference_id: 684fb8c7c46b6512c359b5e5ce1b0723aecc809c
  - url: https://github.com/xen-project/xen/tree/7849d13d456916138d1b79fe92b0f8ee2fd60429
    reference_type: commit
    reference_id: 7849d13d456916138d1b79fe92b0f8ee2fd60429
  - url: https://github.com/xen-project/xen/tree/85d133b90dcb2167b0b115c3420300068c711c32
    reference_type: commit
    reference_id: 85d133b90dcb2167b0b115c3420300068c711c32
  - url: https://github.com/xen-project/xen/tree/9e7d5e266a1b3417c9b88943c9000181bfe920de
    reference_type: commit
    reference_id: 9e7d5e266a1b3417c9b88943c9000181bfe920de
  - url: https://github.com/xen-project/xen/tree/a060b6981a24aa6d9154fbc07e25f54fcd4af932
    reference_type: commit
    reference_id: a060b6981a24aa6d9154fbc07e25f54fcd4af932
  - url: https://github.com/xen-project/xen/tree/a5d7667a38ebce4d07513349b0fb83b8fa78ba5b
    reference_type: commit
    reference_id: a5d7667a38ebce4d07513349b0fb83b8fa78ba5b
  - url: https://github.com/xen-project/xen/tree/b03a57c9383b32181e60add6b6de12b473652aa4
    reference_type: commit
    reference_id: b03a57c9383b32181e60add6b6de12b473652aa4
  - url: https://github.com/xen-project/xen/tree/b76ec3946bf6caca2c3950b857c008bc8db6723f
    reference_type: commit
    reference_id: b76ec3946bf6caca2c3950b857c008bc8db6723f
  - url: https://github.com/xen-project/xen/tree/c612481d1c9232c6abf91b03ec655e92f808805f
    reference_type: commit
    reference_id: c612481d1c9232c6abf91b03ec655e92f808805f
  - url: https://github.com/xen-project/xen/tree/c67a8b808ad16864248f24ef099e7d181e107dcb
    reference_type: commit
    reference_id: c67a8b808ad16864248f24ef099e7d181e107dcb
  - url: https://github.com/xen-project/xen/tree/c9641d4b1fa43904c1b24a787899961c5a5428f2
    reference_type: commit
    reference_id: c9641d4b1fa43904c1b24a787899961c5a5428f2
  - url: https://github.com/xen-project/xen/tree/cac6aa015c9d253c83e08091f7e3149c2a884908
    reference_type: commit
    reference_id: cac6aa015c9d253c83e08091f7e3149c2a884908
  - url: https://github.com/xen-project/xen/tree/d044f6cc590c58178d87ad78f1859d1c7905ee0b
    reference_type: commit
    reference_id: d044f6cc590c58178d87ad78f1859d1c7905ee0b
  - url: https://github.com/xen-project/xen/tree/d46374d7943f6dbbf683f97f0c32196aee69a56b
    reference_type: commit
    reference_id: d46374d7943f6dbbf683f97f0c32196aee69a56b
  - url: https://github.com/xen-project/xen/tree/e819108a41ce7f5ebd31bd8fe526e2b07523cfc4
    reference_type: commit
    reference_id: e819108a41ce7f5ebd31bd8fe526e2b07523cfc4
  - url: https://github.com/xen-project/xen/tree/ed933041a8b36bcab65bb09cb2594215de7ac894
    reference_type: commit
    reference_id: ed933041a8b36bcab65bb09cb2594215de7ac894
  - url: https://github.com/xen-project/xen/tree/f4a049ede7ee9e1fafad6248cffc5e6deac1bc39
    reference_type: commit
    reference_id: f4a049ede7ee9e1fafad6248cffc5e6deac1bc39
  - url: https://github.com/xen-project/xen/tree/f73c7770426344a670e0d42e926ff8c0f897ee1b
    reference_type: commit
    reference_id: f73c7770426344a670e0d42e926ff8c0f897ee1b
  - url: https://github.com/xen-project/xen/tree/fe7882948064e4bae97ce9ef9c2f1cbad20b7618
    reference_type: commit
    reference_id: fe7882948064e4bae97ce9ef9c2f1cbad20b7618
