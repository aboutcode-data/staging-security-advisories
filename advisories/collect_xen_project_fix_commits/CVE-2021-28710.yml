advisory_id: CVE-2021-28710
datasource_id: collect_xen_project_fix_commits/CVE-2021-28710
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  963ab606b1228788eac54c1c7ff70d04bb325733:VT-d: fix reduced page table levels support when sharing tables

  domain_pgd_maddr() contains logic to adjust the root address to be put
  in the context entry in case 4-level page tables aren't supported by an
  IOMMU. This logic may not be bypassed when sharing page tables.

  This is CVE-2021-28710 / XSA-390.

  Fixes: 25ccd093425c ("iommu: remove the share_p2m operation")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Kevin Tian <kevin.tian@intel.com>
  master commit: 02b46377b69feb6dd3649f037e17684af9fb7853
  master date: 2021-11-19 15:14:08 +0100
  02b46377b69feb6dd3649f037e17684af9fb7853:VT-d: fix reduced page table levels support when sharing tables

  domain_pgd_maddr() contains logic to adjust the root address to be put
  in the context entry in case 4-level page tables aren't supported by an
  IOMMU. This logic may not be bypassed when sharing page tables.

  This is CVE-2021-28710 / XSA-390.

  Fixes: 25ccd093425c ("iommu: remove the share_p2m operation")
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Kevin Tian <kevin.tian@intel.com>
  Release-Acked-by: Ian Jackson <iwj@xenproject.org>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 963ab606b1228788eac54c1c7ff70d04bb325733
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 02b46377b69feb6dd3649f037e17684af9fb7853
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/02b46377b69feb6dd3649f037e17684af9fb7853
    reference_type: commit
    reference_id: 02b46377b69feb6dd3649f037e17684af9fb7853
  - url: https://github.com/xen-project/xen/tree/963ab606b1228788eac54c1c7ff70d04bb325733
    reference_type: commit
    reference_id: 963ab606b1228788eac54c1c7ff70d04bb325733
