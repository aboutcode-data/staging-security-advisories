advisory_id: CVE-2015-0361
datasource_id: collect_xen_project_fix_commits/CVE-2015-0361
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  95af3f09eeef089e0100a8518f7ca75206e33c7c:x86/HVM: prevent use-after-free when destroying a domain

  hvm_domain_relinquish_resources() can free certain domain resources
  which can still be accessed, e.g. by HVMOP_set_param, while the domain
  is being cleaned up.

  Signed-off-by: Mihai Donțu <mdontu@bitdefender.com>
  Tested-by: Răzvan Cojocaru <rcojocaru@bitdefender.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>

  This is CVE-2015-0361 / XSA-116.
  (cherry picked from commit 5d4e3ff19c33770ce01bec949c50326b11088fef)
  5d4e3ff19c33770ce01bec949c50326b11088fef:x86/HVM: prevent use-after-free when destroying a domain

  hvm_domain_relinquish_resources() can free certain domain resources
  which can still be accessed, e.g. by HVMOP_set_param, while the domain
  is being cleaned up.

  Signed-off-by: Mihai Donțu <mdontu@bitdefender.com>
  Tested-by: Răzvan Cojocaru <rcojocaru@bitdefender.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>

  This is CVE-2015-0361 / XSA-116.
  089dd62211042011e26de1b87b558394cdfe388b:x86/HVM: prevent use-after-free when destroying a domain

  hvm_domain_relinquish_resources() can free certain domain resources
  which can still be accessed, e.g. by HVMOP_set_param, while the domain
  is being cleaned up.

  This is CVE-2015-0361 / XSA-116.

  Signed-off-by: Mihai Donțu <mdontu@bitdefender.com>
  Tested-by: Răzvan Cojocaru <rcojocaru@bitdefender.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit d3c151fd3a4365fc6107198bfc975807d40d157d)
  d3c151fd3a4365fc6107198bfc975807d40d157d:x86/HVM: prevent use-after-free when destroying a domain

  hvm_domain_relinquish_resources() can free certain domain resources
  which can still be accessed, e.g. by HVMOP_set_param, while the domain
  is being cleaned up.

  This is CVE-2015-0361 / XSA-116.

  Signed-off-by: Mihai Donțu <mdontu@bitdefender.com>
  Tested-by: Răzvan Cojocaru <rcojocaru@bitdefender.com>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d3c151fd3a4365fc6107198bfc975807d40d157d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 5d4e3ff19c33770ce01bec949c50326b11088fef
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 95af3f09eeef089e0100a8518f7ca75206e33c7c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 089dd62211042011e26de1b87b558394cdfe388b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/089dd62211042011e26de1b87b558394cdfe388b
    reference_type: commit
    reference_id: 089dd62211042011e26de1b87b558394cdfe388b
  - url: https://github.com/xen-project/xen/tree/5d4e3ff19c33770ce01bec949c50326b11088fef
    reference_type: commit
    reference_id: 5d4e3ff19c33770ce01bec949c50326b11088fef
  - url: https://github.com/xen-project/xen/tree/95af3f09eeef089e0100a8518f7ca75206e33c7c
    reference_type: commit
    reference_id: 95af3f09eeef089e0100a8518f7ca75206e33c7c
  - url: https://github.com/xen-project/xen/tree/d3c151fd3a4365fc6107198bfc975807d40d157d
    reference_type: commit
    reference_id: d3c151fd3a4365fc6107198bfc975807d40d157d
