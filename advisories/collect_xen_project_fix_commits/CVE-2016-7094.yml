advisory_id: CVE-2016-7094
datasource_id: collect_xen_project_fix_commits/CVE-2016-7094
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  2f3e08d37b0500980f93b9e760b2f6db47839872:x86/shadow: Avoid overflowing sh_ctxt->seg_reg[]

  hvm_get_seg_reg() does not perform a range check on its input segment, calls
  hvm_get_segment_register() and writes straight into sh_ctxt->seg_reg[].

  x86_seg_none is outside the bounds of sh_ctxt->seg_reg[], and will hit a BUG()
  in {vmx,svm}_get_segment_register().

  HVM guests running with shadow paging can end up performing a virtual to
  linear translation with x86_seg_none.  This is used for addresses which are
  already linear.  However, none of this is a legitimate pagetable update, so
  fail the emulation in such a case.

  This is XSA-187 / CVE-2016-7094.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: a9f3b3bad17d91e2067fc00d51b0302349570d08
  master date: 2016-09-08 14:16:26 +0200
  433ebca120e8750eb8085745ccac703e47358e6f:x86/shadow: Avoid overflowing sh_ctxt->seg_reg[]

  hvm_get_seg_reg() does not perform a range check on its input segment, calls
  hvm_get_segment_register() and writes straight into sh_ctxt->seg_reg[].

  x86_seg_none is outside the bounds of sh_ctxt->seg_reg[], and will hit a BUG()
  in {vmx,svm}_get_segment_register().

  HVM guests running with shadow paging can end up performing a virtual to
  linear translation with x86_seg_none.  This is used for addresses which are
  already linear.  However, none of this is a legitimate pagetable update, so
  fail the emulation in such a case.

  This is XSA-187 / CVE-2016-7094.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: a9f3b3bad17d91e2067fc00d51b0302349570d08
  master date: 2016-09-08 14:16:26 +0200
  26352b6344ce5d5a2ee78e56ae631e156fbdce7f:x86/shadow: Avoid overflowing sh_ctxt->seg_reg[]

  hvm_get_seg_reg() does not perform a range check on its input segment, calls
  hvm_get_segment_register() and writes straight into sh_ctxt->seg_reg[].

  x86_seg_none is outside the bounds of sh_ctxt->seg_reg[], and will hit a BUG()
  in {vmx,svm}_get_segment_register().

  HVM guests running with shadow paging can end up performing a virtual to
  linear translation with x86_seg_none.  This is used for addresses which are
  already linear.  However, none of this is a legitimate pagetable update, so
  fail the emulation in such a case.

  This is XSA-187 / CVE-2016-7094.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: a9f3b3bad17d91e2067fc00d51b0302349570d08
  master date: 2016-09-08 14:16:26 +0200
  0c9b94208f91032a06198d10a307d86a66e9f207:x86/shadow: Avoid overflowing sh_ctxt->seg_reg[]

  hvm_get_seg_reg() does not perform a range check on its input segment, calls
  hvm_get_segment_register() and writes straight into sh_ctxt->seg_reg[].

  x86_seg_none is outside the bounds of sh_ctxt->seg_reg[], and will hit a BUG()
  in {vmx,svm}_get_segment_register().

  HVM guests running with shadow paging can end up performing a virtual to
  linear translation with x86_seg_none.  This is used for addresses which are
  already linear.  However, none of this is a legitimate pagetable update, so
  fail the emulation in such a case.

  This is XSA-187 / CVE-2016-7094.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
  master commit: a9f3b3bad17d91e2067fc00d51b0302349570d08
  master date: 2016-09-08 14:16:26 +0200
  a9f3b3bad17d91e2067fc00d51b0302349570d08:x86/shadow: Avoid overflowing sh_ctxt->seg_reg[]

  hvm_get_seg_reg() does not perform a range check on its input segment, calls
  hvm_get_segment_register() and writes straight into sh_ctxt->seg_reg[].

  x86_seg_none is outside the bounds of sh_ctxt->seg_reg[], and will hit a BUG()
  in {vmx,svm}_get_segment_register().

  HVM guests running with shadow paging can end up performing a virtual to
  linear translation with x86_seg_none.  This is used for addresses which are
  already linear.  However, none of this is a legitimate pagetable update, so
  fail the emulation in such a case.

  This is XSA-187 / CVE-2016-7094.

  Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Tim Deegan <tim@xen.org>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 26352b6344ce5d5a2ee78e56ae631e156fbdce7f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2f3e08d37b0500980f93b9e760b2f6db47839872
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 433ebca120e8750eb8085745ccac703e47358e6f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: a9f3b3bad17d91e2067fc00d51b0302349570d08
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0c9b94208f91032a06198d10a307d86a66e9f207
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/0c9b94208f91032a06198d10a307d86a66e9f207
    reference_type: commit
    reference_id: 0c9b94208f91032a06198d10a307d86a66e9f207
  - url: https://github.com/xen-project/xen/tree/26352b6344ce5d5a2ee78e56ae631e156fbdce7f
    reference_type: commit
    reference_id: 26352b6344ce5d5a2ee78e56ae631e156fbdce7f
  - url: https://github.com/xen-project/xen/tree/2f3e08d37b0500980f93b9e760b2f6db47839872
    reference_type: commit
    reference_id: 2f3e08d37b0500980f93b9e760b2f6db47839872
  - url: https://github.com/xen-project/xen/tree/433ebca120e8750eb8085745ccac703e47358e6f
    reference_type: commit
    reference_id: 433ebca120e8750eb8085745ccac703e47358e6f
  - url: https://github.com/xen-project/xen/tree/a9f3b3bad17d91e2067fc00d51b0302349570d08
    reference_type: commit
    reference_id: a9f3b3bad17d91e2067fc00d51b0302349570d08
