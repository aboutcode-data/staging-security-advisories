advisory_id: CVE-2025-58147
datasource_id: collect_xen_project_fix_commits/CVE-2025-58147
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  17bfa36a41c82af904fba99f120ddacc862f4b1f:x86/viridian: Enforce bounds check in vpmask_set()

  Callers can pass vp/mask values which exceed the size of vpmask->mask.  Ensure
  we only set bits which are within bounds.

  This is XSA-475 / CVE-2025-58147.

  Fixes: b4124682db6e ("viridian: add ExProcessorMasks variants of the flush hypercalls")
  Signed-off-by: Teddy Astie <teddy.astie@vates.tech>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 36e90c4ef1f2667dc8159c634fb00d393fc2d857
  master date: 2025-10-21 14:09:37 +0200
  1ac5088ca06ce67528c46a5b1454f0026a5e2e21:x86/viridian: Enforce bounds check in vpmask_set()

  Callers can pass vp/mask values which exceed the size of vpmask->mask.  Ensure
  we only set bits which are within bounds.

  This is XSA-475 / CVE-2025-58147.

  Fixes: b4124682db6e ("viridian: add ExProcessorMasks variants of the flush hypercalls")
  Signed-off-by: Teddy Astie <teddy.astie@vates.tech>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 36e90c4ef1f2667dc8159c634fb00d393fc2d857
  master date: 2025-10-21 14:09:37 +0200
  965fdf7b4278392c35888c4949a98d7cc650280d:x86/viridian: Enforce bounds check in vpmask_set()

  Callers can pass vp/mask values which exceed the size of vpmask->mask.  Ensure
  we only set bits which are within bounds.

  This is XSA-475 / CVE-2025-58147.

  Fixes: b4124682db6e ("viridian: add ExProcessorMasks variants of the flush hypercalls")
  Signed-off-by: Teddy Astie <teddy.astie@vates.tech>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 36e90c4ef1f2667dc8159c634fb00d393fc2d857
  master date: 2025-10-21 14:09:37 +0200
  188b66cf0fd7492645b1e77d872f65307d5ce550:x86/viridian: Enforce bounds check in vpmask_set()

  Callers can pass vp/mask values which exceed the size of vpmask->mask.  Ensure
  we only set bits which are within bounds.

  This is XSA-475 / CVE-2025-58147.

  Fixes: b4124682db6e ("viridian: add ExProcessorMasks variants of the flush hypercalls")
  Signed-off-by: Teddy Astie <teddy.astie@vates.tech>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
  master commit: 36e90c4ef1f2667dc8159c634fb00d393fc2d857
  master date: 2025-10-21 14:09:37 +0200
  36e90c4ef1f2667dc8159c634fb00d393fc2d857:x86/viridian: Enforce bounds check in vpmask_set()

  Callers can pass vp/mask values which exceed the size of vpmask->mask.  Ensure
  we only set bits which are within bounds.

  This is XSA-475 / CVE-2025-58147.

  Fixes: b4124682db6e ("viridian: add ExProcessorMasks variants of the flush hypercalls")
  Signed-off-by: Teddy Astie <teddy.astie@vates.tech>
  Reviewed-by: Andrew Cooper <andrew.cooper3@citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 188b66cf0fd7492645b1e77d872f65307d5ce550
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 965fdf7b4278392c35888c4949a98d7cc650280d
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 17bfa36a41c82af904fba99f120ddacc862f4b1f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 36e90c4ef1f2667dc8159c634fb00d393fc2d857
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1ac5088ca06ce67528c46a5b1454f0026a5e2e21
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/17bfa36a41c82af904fba99f120ddacc862f4b1f
    reference_type: commit
    reference_id: 17bfa36a41c82af904fba99f120ddacc862f4b1f
  - url: https://github.com/xen-project/xen/tree/188b66cf0fd7492645b1e77d872f65307d5ce550
    reference_type: commit
    reference_id: 188b66cf0fd7492645b1e77d872f65307d5ce550
  - url: https://github.com/xen-project/xen/tree/1ac5088ca06ce67528c46a5b1454f0026a5e2e21
    reference_type: commit
    reference_id: 1ac5088ca06ce67528c46a5b1454f0026a5e2e21
  - url: https://github.com/xen-project/xen/tree/36e90c4ef1f2667dc8159c634fb00d393fc2d857
    reference_type: commit
    reference_id: 36e90c4ef1f2667dc8159c634fb00d393fc2d857
  - url: https://github.com/xen-project/xen/tree/965fdf7b4278392c35888c4949a98d7cc650280d
    reference_type: commit
    reference_id: 965fdf7b4278392c35888c4949a98d7cc650280d
