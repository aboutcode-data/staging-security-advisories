advisory_id: CVE-2024-31142
datasource_id: collect_xen_project_fix_commits/CVE-2024-31142
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  6672d8ceae4acf0e0ef7dc7002e6146d10507c37:x86/spec-ctrl: Fix BTC/SRSO mitigations

  We were looking for SCF_entry_ibpb in the wrong variable in the top-of-stack
  block, and xen_spec_ctrl won't have had bit 5 set because Xen doesn't
  understand SPEC_CTRL_RRSBA_DIS_U yet.

  This is XSA-455 / CVE-2024-31142.

  Fixes: 53a570b28569 ("x86/spec-ctrl: Support IBPB-on-entry")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  28f5ceb0b19b13a7c0ebd125c587e469490ab872:x86/spec-ctrl: Fix BTC/SRSO mitigations

  We were looking for SCF_entry_ibpb in the wrong variable in the top-of-stack
  block, and xen_spec_ctrl won't have had bit 5 set because Xen doesn't
  understand SPEC_CTRL_RRSBA_DIS_U yet.

  This is XSA-455 / CVE-2024-31142.

  Fixes: 53a570b28569 ("x86/spec-ctrl: Support IBPB-on-entry")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  19887194865cff7d87650c323d5c6b185dfe3ddc:x86/spec-ctrl: Fix BTC/SRSO mitigations

  We were looking for SCF_entry_ibpb in the wrong variable in the top-of-stack
  block, and xen_spec_ctrl won't have had bit 5 set because Xen doesn't
  understand SPEC_CTRL_RRSBA_DIS_U yet.

  This is XSA-455 / CVE-2024-31142.

  Fixes: 53a570b28569 ("x86/spec-ctrl: Support IBPB-on-entry")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  6d4055b9a5d1d800d7f0e5584b9a0213bf25cd8b:x86/spec-ctrl: Fix BTC/SRSO mitigations

  We were looking for SCF_entry_ibpb in the wrong variable in the top-of-stack
  block, and xen_spec_ctrl won't have had bit 5 set because Xen doesn't
  understand SPEC_CTRL_RRSBA_DIS_U yet.

  This is XSA-455 / CVE-2024-31142.

  Fixes: 53a570b28569 ("x86/spec-ctrl: Support IBPB-on-entry")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  489d93cd0fdd9609ca0414d7efae51c381106dbc:x86/spec-ctrl: Fix BTC/SRSO mitigations

  We were looking for SCF_entry_ibpb in the wrong variable in the top-of-stack
  block, and xen_spec_ctrl won't have had bit 5 set because Xen doesn't
  understand SPEC_CTRL_RRSBA_DIS_U yet.

  This is XSA-455 / CVE-2024-31142.

  Fixes: 53a570b28569 ("x86/spec-ctrl: Support IBPB-on-entry")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 6672d8ceae4acf0e0ef7dc7002e6146d10507c37
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 489d93cd0fdd9609ca0414d7efae51c381106dbc
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 28f5ceb0b19b13a7c0ebd125c587e469490ab872
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: '19887194865cff7d87650c323d5c6b185dfe3ddc'
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 6d4055b9a5d1d800d7f0e5584b9a0213bf25cd8b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/19887194865cff7d87650c323d5c6b185dfe3ddc
    reference_type: commit
    reference_id: '19887194865cff7d87650c323d5c6b185dfe3ddc'
  - url: https://github.com/xen-project/xen/tree/28f5ceb0b19b13a7c0ebd125c587e469490ab872
    reference_type: commit
    reference_id: 28f5ceb0b19b13a7c0ebd125c587e469490ab872
  - url: https://github.com/xen-project/xen/tree/489d93cd0fdd9609ca0414d7efae51c381106dbc
    reference_type: commit
    reference_id: 489d93cd0fdd9609ca0414d7efae51c381106dbc
  - url: https://github.com/xen-project/xen/tree/6672d8ceae4acf0e0ef7dc7002e6146d10507c37
    reference_type: commit
    reference_id: 6672d8ceae4acf0e0ef7dc7002e6146d10507c37
  - url: https://github.com/xen-project/xen/tree/6d4055b9a5d1d800d7f0e5584b9a0213bf25cd8b
    reference_type: commit
    reference_id: 6d4055b9a5d1d800d7f0e5584b9a0213bf25cd8b
