advisory_id: CVE-2012-4538
datasource_id: collect_xen_project_fix_commits/CVE-2012-4538
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  e201bce9a19d158ee979ed9a6690cfeede925c1f:xen/mm/shadow: check toplevel pagetables are present before unhooking them.

  If the guest has not fully populated its top-level PAE entries when it calls
  HVMOP_pagetable_dying, the shadow code could try to unhook entries from
  MFN 0.  Add a check to avoid that case.

  This issue was introduced by c/s 21239:b9d2db109cf5.

  This is a security problem, XSA-23 / CVE-2012-4538.

  Signed-off-by: Tim Deegan <tim@xen.org>
  Tested-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>

  xen-4.1-testing changeset: 23409:61eb3d030f52
  Backport-requested-by: security@xen.org
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  1d435032de14b9dec808102940309047903f7ed0:xen/mm/shadow: check toplevel pagetables are present before unhooking them.

  If the guest has not fully populated its top-level PAE entries when it calls
  HVMOP_pagetable_dying, the shadow code could try to unhook entries from
  MFN 0.  Add a check to avoid that case.

  This issue was introduced by c/s 21239:b9d2db109cf5.

  This is a security problem, XSA-23 / CVE-2012-4538.

  Signed-off-by: Tim Deegan <tim@xen.org>
  Tested-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  33df3b4a744312c01a8fa9929f06d62a81f50c28:xen/mm/shadow: check toplevel pagetables are present before unhooking them.

  If the guest has not fully populated its top-level PAE entries when it calls
  HVMOP_pagetable_dying, the shadow code could try to unhook entries from
  MFN 0.  Add a check to avoid that case.

  This issue was introduced by c/s 21239:b9d2db109cf5.

  This is a security problem, XSA-23 / CVE-2012-4538.

  Signed-off-by: Tim Deegan <tim@xen.org>
  Tested-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>

  xen-unstable changeset: 26150:c7a01b6450e4
  Backport-requested-by: security@xen.org
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
  52c1374d7fc35cd275ced4daf7101d713d7ec294:xen/mm/shadow: check toplevel pagetables are present before unhooking them.

  If the guest has not fully populated its top-level PAE entries when it calls
  HVMOP_pagetable_dying, the shadow code could try to unhook entries from
  MFN 0.  Add a check to avoid that case.

  This issue was introduced by c/s 21239:b9d2db109cf5.

  This is a security problem, XSA-23 / CVE-2012-4538.

  Signed-off-by: Tim Deegan <tim@xen.org>
  Tested-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Acked-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Ian Jackson <ian.jackson@eu.citrix.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 33df3b4a744312c01a8fa9929f06d62a81f50c28
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 52c1374d7fc35cd275ced4daf7101d713d7ec294
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1d435032de14b9dec808102940309047903f7ed0
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e201bce9a19d158ee979ed9a6690cfeede925c1f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/1d435032de14b9dec808102940309047903f7ed0
    reference_type: commit
    reference_id: 1d435032de14b9dec808102940309047903f7ed0
  - url: https://github.com/xen-project/xen/tree/33df3b4a744312c01a8fa9929f06d62a81f50c28
    reference_type: commit
    reference_id: 33df3b4a744312c01a8fa9929f06d62a81f50c28
  - url: https://github.com/xen-project/xen/tree/52c1374d7fc35cd275ced4daf7101d713d7ec294
    reference_type: commit
    reference_id: 52c1374d7fc35cd275ced4daf7101d713d7ec294
  - url: https://github.com/xen-project/xen/tree/e201bce9a19d158ee979ed9a6690cfeede925c1f
    reference_type: commit
    reference_id: e201bce9a19d158ee979ed9a6690cfeede925c1f
