advisory_id: CVE-2012-2625
datasource_id: collect_xen_project_fix_commits/CVE-2012-2625
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  7ce4c765975097bddffaa2fc482d5c16355687af:libxc: builder: limit maximum size of kernel/ramdisk.

  Allowing user supplied kernels of arbitrary sizes, especially during
  decompression, can swallow up dom0 memory leading to either virtual
  address space exhaustion in the builder process or allocation
  failures/OOM killing of both toolstack and unrelated processes.

  We disable these checks when building in a stub domain for pvgrub
  since this uses the guest's own memory and is isolated.

  Decompression of gzip compressed kernels and ramdisks has been safe
  since 14954:58205257517d (Xen 3.1.0 onwards).

  This is XSA-25 / CVE-2012-4544.

  Also make explicit checks for buffer overflows in various
  decompression routines. These were already ruled out due to other
  properties of the code but check them as a belt-and-braces measure.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Ian Jackson <ian.jackson@eu.citrix.com>
  [ Includes 25589:60f09d1ab1fe for CVE-2012-2625 ]
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7ce4c765975097bddffaa2fc482d5c16355687af
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/7ce4c765975097bddffaa2fc482d5c16355687af
    reference_type: commit
    reference_id: 7ce4c765975097bddffaa2fc482d5c16355687af
