advisory_id: CVE-2021-28690
datasource_id: collect_xen_project_fix_commits/CVE-2021-28690
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  ef32c7afa2731b758226d6e10a1e489b1a15fc41:x86/spec-ctrl: Mitigate TAA after S3 resume

  The user chosen setting for MSR_TSX_CTRL needs restoring after S3.

  All APs get the correct setting via start_secondary(), but the BSP was missed
  out.

  This is XSA-377 / CVE-2021-28690.

  Fixes: 8c4330818f6 ("x86/spec-ctrl: Mitigate the TSX Asynchronous Abort sidechannel")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 8cf276cb2e0b99b96333865873f56b0b31555ff1)
  ea20eee97e9e0861127a8070cc7b9ae3557b09fb:x86/spec-ctrl: Mitigate TAA after S3 resume

  The user chosen setting for MSR_TSX_CTRL needs restoring after S3.

  All APs get the correct setting via start_secondary(), but the BSP was missed
  out.

  This is XSA-377 / CVE-2021-28690.

  Fixes: 8c4330818f6 ("x86/spec-ctrl: Mitigate the TSX Asynchronous Abort sidechannel")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 8cf276cb2e0b99b96333865873f56b0b31555ff1)
  9bd6416528f9080cead0f8c22441f5568dbd0bf3:x86/spec-ctrl: Mitigate TAA after S3 resume

  The user chosen setting for MSR_TSX_CTRL needs restoring after S3.

  All APs get the correct setting via start_secondary(), but the BSP was missed
  out.

  This is XSA-377 / CVE-2021-28690.

  Fixes: 8c4330818f6 ("x86/spec-ctrl: Mitigate the TSX Asynchronous Abort sidechannel")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 8cf276cb2e0b99b96333865873f56b0b31555ff1)
  0ff7f9c5aa02cd2469a8fc03f1ed262f18933721:x86/spec-ctrl: Mitigate TAA after S3 resume

  The user chosen setting for MSR_TSX_CTRL needs restoring after S3.

  All APs get the correct setting via start_secondary(), but the BSP was missed
  out.

  This is XSA-377 / CVE-2021-28690.

  Fixes: 8c4330818f6 ("x86/spec-ctrl: Mitigate the TSX Asynchronous Abort sidechannel")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 8cf276cb2e0b99b96333865873f56b0b31555ff1)
  f034c96e882b81738720472cd28e75e6d6eb66fe:x86/spec-ctrl: Mitigate TAA after S3 resume

  The user chosen setting for MSR_TSX_CTRL needs restoring after S3.

  All APs get the correct setting via start_secondary(), but the BSP was missed
  out.

  This is XSA-377 / CVE-2021-28690.

  Fixes: 8c4330818f6 ("x86/spec-ctrl: Mitigate the TSX Asynchronous Abort sidechannel")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
  (cherry picked from commit 8cf276cb2e0b99b96333865873f56b0b31555ff1)
  8cf276cb2e0b99b96333865873f56b0b31555ff1:x86/spec-ctrl: Mitigate TAA after S3 resume

  The user chosen setting for MSR_TSX_CTRL needs restoring after S3.

  All APs get the correct setting via start_secondary(), but the BSP was missed
  out.

  This is XSA-377 / CVE-2021-28690.

  Fixes: 8c4330818f6 ("x86/spec-ctrl: Mitigate the TSX Asynchronous Abort sidechannel")
  Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
  Reviewed-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 9bd6416528f9080cead0f8c22441f5568dbd0bf3
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ea20eee97e9e0861127a8070cc7b9ae3557b09fb
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f034c96e882b81738720472cd28e75e6d6eb66fe
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 8cf276cb2e0b99b96333865873f56b0b31555ff1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: ef32c7afa2731b758226d6e10a1e489b1a15fc41
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 0ff7f9c5aa02cd2469a8fc03f1ed262f18933721
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/0ff7f9c5aa02cd2469a8fc03f1ed262f18933721
    reference_type: commit
    reference_id: 0ff7f9c5aa02cd2469a8fc03f1ed262f18933721
  - url: https://github.com/xen-project/xen/tree/8cf276cb2e0b99b96333865873f56b0b31555ff1
    reference_type: commit
    reference_id: 8cf276cb2e0b99b96333865873f56b0b31555ff1
  - url: https://github.com/xen-project/xen/tree/9bd6416528f9080cead0f8c22441f5568dbd0bf3
    reference_type: commit
    reference_id: 9bd6416528f9080cead0f8c22441f5568dbd0bf3
  - url: https://github.com/xen-project/xen/tree/ea20eee97e9e0861127a8070cc7b9ae3557b09fb
    reference_type: commit
    reference_id: ea20eee97e9e0861127a8070cc7b9ae3557b09fb
  - url: https://github.com/xen-project/xen/tree/ef32c7afa2731b758226d6e10a1e489b1a15fc41
    reference_type: commit
    reference_id: ef32c7afa2731b758226d6e10a1e489b1a15fc41
  - url: https://github.com/xen-project/xen/tree/f034c96e882b81738720472cd28e75e6d6eb66fe
    reference_type: commit
    reference_id: f034c96e882b81738720472cd28e75e6d6eb66fe
