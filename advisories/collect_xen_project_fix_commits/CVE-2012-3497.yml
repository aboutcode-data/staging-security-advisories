advisory_id: CVE-2012-3497
datasource_id: collect_xen_project_fix_commits/CVE-2012-3497
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  1266749162fd232c79898706f01082847a0e618e:tmem: don't access guest memory without using the accessors intended for this

  This is not permitted, not even for buffers coming from Dom0 (and it
  would also break the moment Dom0 runs in HVM mode). An implication from
  the changes here is that tmh_copy_page() can't be used anymore for
  control operations calling tmh_copy_{from,to}_client() (as those pass
  the buffer by virtual address rather than MFN).

  Note that tmemc_save_get_next_page() previously didn't set the returned
  handle's pool_id field, while the new code does. It need to be
  confirmed that this is not a problem (otherwise the copy-out operation
  will require further tmh_...() abstractions to be added).

  Further note that the patch removes (rather than adjusts) an invalid
  call to unmap_domain_page() (no matching map_domain_page()) from
  tmh_compress_from_client() and adds a missing one to an error return
  path in tmh_copy_from_client().

  Finally note that the patch adds a previously missing return statement
  to cli_get_page() (without which that function could de-reference a
  NULL pointer, triggerable from guest mode).

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  xen-unstable changeset: 25854:ccd60ed6c555
  xen-unstable date: Tue Sep 11 12:17:49 UTC 2012
  e28173699e5651c323f66062e73cca29a65c097f:tmem: check for a valid client ("domain") in the save subops

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  xen-unstable changeset: 25853:f53c5aadbba9
  xen-unstable date: Tue Sep 11 12:17:27 UTC 2012
  c7cafe83e0bee450cb0bde6c4921d5819dc96542:tmem: check the pool_id is valid when destroying a tmem pool

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  xen-unstable changeset: 25852:d189d99ef00c
  xen-unstable date: Tue Sep 11 12:06:54 UTC 2012
  afdc11f69ab71efa24145f9e747964066bcecefd:tmem: consistently make pool_id a uint32_t

  Treating it as an int could allow a malicious guest to provide a
  negative pool_Id, by passing the MAX_POOLS_PER_DOMAIN limit check and
  allowing access to the negative offsets of the pool array.

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  xen-unstable changeset: 25851:fcf567acc92a
  xen-unstable date: Tue Sep 11 12:06:43 UTC 2012
  16bae237b197bc925a60c5c783004e609e9b43c1:tmem: only allow tmem control operations from privileged domains

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  xen-unstable changeset: 25850:0dba5a888655
  xen-unstable date: Tue Sep 11 12:06:30 UTC 2012
  6cbcc87364a59ee0ef1e56e28cf7cb2dd52a1b44:tmem: don't access guest memory without using the accessors intended for this

  This is not permitted, not even for buffers coming from Dom0 (and it
  would also break the moment Dom0 runs in HVM mode). An implication from
  the changes here is that tmh_copy_page() can't be used anymore for
  control operations calling tmh_copy_{from,to}_client() (as those pass
  the buffer by virtual address rather than MFN).

  Note that tmemc_save_get_next_page() previously didn't set the returned
  handle's pool_id field, while the new code does. It need to be
  confirmed that this is not a problem (otherwise the copy-out operation
  will require further tmh_...() abstractions to be added).

  Further note that the patch removes (rather than adjusts) an invalid
  call to unmap_domain_page() (no matching map_domain_page()) from
  tmh_compress_from_client() and adds a missing one to an error return
  path in tmh_copy_from_client().

  Finally note that the patch adds a previously missing return statement
  to cli_get_page() (without which that function could de-reference a
  NULL pointer, triggerable from guest mode).

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  xen-unstable changeset: 25854:ccd60ed6c555
  xen-unstable date: Tue Sep 11 12:17:49 UTC 2012
  c15cdd31b5f8652c1c3d32cacadd46be837edaed:tmem: check for a valid client ("domain") in the save subops

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  xen-unstable changeset: 25853:f53c5aadbba9
  xen-unstable date: Tue Sep 11 12:17:27 UTC 2012
  7d8457781fdf5885cf0293621d1c672200ab52c1:tmem: check the pool_id is valid when destroying a tmem pool

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  xen-unstable changeset: 25852:d189d99ef00c
  xen-unstable date: Tue Sep 11 12:06:54 UTC 2012
  2bdde48224943066db46d766f0f6117df11e728c:tmem: consistently make pool_id a uint32_t

  Treating it as an int could allow a malicious guest to provide a
  negative pool_Id, by passing the MAX_POOLS_PER_DOMAIN limit check and
  allowing access to the negative offsets of the pool array.

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  xen-unstable changeset: 25851:fcf567acc92a
  xen-unstable date: Tue Sep 11 12:06:43 UTC 2012
  998f42b36c5dba6939a54836caad7c564b2d07b7:tmem: only allow tmem control operations from privileged domains

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  Acked-by-by: Jan Beulich <jbeulich@suse.com>
  xen-unstable changeset: 25850:0dba5a888655
  xen-unstable date: Tue Sep 11 12:06:30 UTC 2012
  09d39e0108811d6bfe1ab7f819b951ea0b1611d7:tmem: don't access guest memory without using the accessors intended for this

  This is not permitted, not even for buffers coming from Dom0 (and it
  would also break the moment Dom0 runs in HVM mode). An implication from
  the changes here is that tmh_copy_page() can't be used anymore for
  control operations calling tmh_copy_{from,to}_client() (as those pass
  the buffer by virtual address rather than MFN).

  Note that tmemc_save_get_next_page() previously didn't set the returned
  handle's pool_id field, while the new code does. It need to be
  confirmed that this is not a problem (otherwise the copy-out operation
  will require further tmh_...() abstractions to be added).

  Further note that the patch removes (rather than adjusts) an invalid
  call to unmap_domain_page() (no matching map_domain_page()) from
  tmh_compress_from_client() and adds a missing one to an error return
  path in tmh_copy_from_client().

  Finally note that the patch adds a previously missing return statement
  to cli_get_page() (without which that function could de-reference a
  NULL pointer, triggerable from guest mode).

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  3fed6db242883d824ab41c00920e0c96c058f3aa:tmem: check for a valid client ("domain") in the save subops

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Acked-by: Jan Beulich <jbeulich@suse.com>
  Acked-by: Dan Magenheimer <dan.magenheimer@oracle.com>
  Committed-by: Jan Beulich <jbeulich@suse.com>
  e75ecdea85ff23d916420ec299753e31c5610f47:tmem: check the pool_id is valid when destroying a tmem pool

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Jan Beulich <jbeulich@suse.com>
  f14fc87af896228782ab5eaf174ce7eb27c0c4ca:tmem: consistently make pool_id a uint32_t

  Treating it as an int could allow a malicious guest to provide a
  negative pool_Id, by passing the MAX_POOLS_PER_DOMAIN limit check and
  allowing access to the negative offsets of the pool array.

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Jan Beulich <jbeulich@suse.com>
  60172eff1eacf9fff67ee80857f8735a3664c831:tmem: only allow tmem control operations from privileged domains

  This is part of XSA-15 / CVE-2012-3497.

  Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
  Committed-by: Jan Beulich <jbeulich@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e28173699e5651c323f66062e73cca29a65c097f
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 1266749162fd232c79898706f01082847a0e618e
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 16bae237b197bc925a60c5c783004e609e9b43c1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 6cbcc87364a59ee0ef1e56e28cf7cb2dd52a1b44
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c15cdd31b5f8652c1c3d32cacadd46be837edaed
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 998f42b36c5dba6939a54836caad7c564b2d07b7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 09d39e0108811d6bfe1ab7f819b951ea0b1611d7
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e75ecdea85ff23d916420ec299753e31c5610f47
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: c7cafe83e0bee450cb0bde6c4921d5819dc96542
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 60172eff1eacf9fff67ee80857f8735a3664c831
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 7d8457781fdf5885cf0293621d1c672200ab52c1
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 2bdde48224943066db46d766f0f6117df11e728c
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: f14fc87af896228782ab5eaf174ce7eb27c0c4ca
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 3fed6db242883d824ab41c00920e0c96c058f3aa
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: afdc11f69ab71efa24145f9e747964066bcecefd
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/09d39e0108811d6bfe1ab7f819b951ea0b1611d7
    reference_type: commit
    reference_id: 09d39e0108811d6bfe1ab7f819b951ea0b1611d7
  - url: https://github.com/xen-project/xen/tree/1266749162fd232c79898706f01082847a0e618e
    reference_type: commit
    reference_id: 1266749162fd232c79898706f01082847a0e618e
  - url: https://github.com/xen-project/xen/tree/16bae237b197bc925a60c5c783004e609e9b43c1
    reference_type: commit
    reference_id: 16bae237b197bc925a60c5c783004e609e9b43c1
  - url: https://github.com/xen-project/xen/tree/2bdde48224943066db46d766f0f6117df11e728c
    reference_type: commit
    reference_id: 2bdde48224943066db46d766f0f6117df11e728c
  - url: https://github.com/xen-project/xen/tree/3fed6db242883d824ab41c00920e0c96c058f3aa
    reference_type: commit
    reference_id: 3fed6db242883d824ab41c00920e0c96c058f3aa
  - url: https://github.com/xen-project/xen/tree/60172eff1eacf9fff67ee80857f8735a3664c831
    reference_type: commit
    reference_id: 60172eff1eacf9fff67ee80857f8735a3664c831
  - url: https://github.com/xen-project/xen/tree/6cbcc87364a59ee0ef1e56e28cf7cb2dd52a1b44
    reference_type: commit
    reference_id: 6cbcc87364a59ee0ef1e56e28cf7cb2dd52a1b44
  - url: https://github.com/xen-project/xen/tree/7d8457781fdf5885cf0293621d1c672200ab52c1
    reference_type: commit
    reference_id: 7d8457781fdf5885cf0293621d1c672200ab52c1
  - url: https://github.com/xen-project/xen/tree/998f42b36c5dba6939a54836caad7c564b2d07b7
    reference_type: commit
    reference_id: 998f42b36c5dba6939a54836caad7c564b2d07b7
  - url: https://github.com/xen-project/xen/tree/afdc11f69ab71efa24145f9e747964066bcecefd
    reference_type: commit
    reference_id: afdc11f69ab71efa24145f9e747964066bcecefd
  - url: https://github.com/xen-project/xen/tree/c15cdd31b5f8652c1c3d32cacadd46be837edaed
    reference_type: commit
    reference_id: c15cdd31b5f8652c1c3d32cacadd46be837edaed
  - url: https://github.com/xen-project/xen/tree/c7cafe83e0bee450cb0bde6c4921d5819dc96542
    reference_type: commit
    reference_id: c7cafe83e0bee450cb0bde6c4921d5819dc96542
  - url: https://github.com/xen-project/xen/tree/e28173699e5651c323f66062e73cca29a65c097f
    reference_type: commit
    reference_id: e28173699e5651c323f66062e73cca29a65c097f
  - url: https://github.com/xen-project/xen/tree/e75ecdea85ff23d916420ec299753e31c5610f47
    reference_type: commit
    reference_id: e75ecdea85ff23d916420ec299753e31c5610f47
  - url: https://github.com/xen-project/xen/tree/f14fc87af896228782ab5eaf174ce7eb27c0c4ca
    reference_type: commit
    reference_id: f14fc87af896228782ab5eaf174ce7eb27c0c4ca
