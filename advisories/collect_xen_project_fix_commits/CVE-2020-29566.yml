advisory_id: CVE-2020-29566
datasource_id: collect_xen_project_fix_commits/CVE-2020-29566
datasource_url: https://github.com/xen-project/xen
aliases: []
summary: |
  cbc06ee4280371f78f5858cd613c8d1e2a53ecd3:x86: avoid calling {svm,vmx}_do_resume()

  These functions follow the following path: hvm_do_resume() ->
  handle_hvm_io_completion() -> hvm_wait_for_io() ->
  wait_on_xen_event_channel() -> do_softirq() -> schedule() ->
  sched_context_switch() -> continue_running() and hence may
  recursively invoke themselves. If this ends up happening a couple of
  times, a stack overflow would result.

  Prevent this by also resetting the stack at the
  ->arch.ctxt_switch->tail() invocations (in both places for consistency)
  and thus jumping to the functions instead of calling them.

  This is XSA-348 / CVE-2020-29566.

  Reported-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  master commit: e6ebd394385db52855d1517cea829ffff68b34b8
  master date: 2020-12-15 13:41:23 +0100
  24f7d0305aed5a9657202bb8b4927dfbebca82a2:x86: avoid calling {svm,vmx}_do_resume()

  These functions follow the following path: hvm_do_resume() ->
  handle_hvm_io_completion() -> hvm_wait_for_io() ->
  wait_on_xen_event_channel() -> do_softirq() -> schedule() ->
  sched_context_switch() -> continue_running() and hence may
  recursively invoke themselves. If this ends up happening a couple of
  times, a stack overflow would result.

  Prevent this by also resetting the stack at the
  ->arch.ctxt_switch->tail() invocations (in both places for consistency)
  and thus jumping to the functions instead of calling them.

  This is XSA-348 / CVE-2020-29566.

  Reported-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  master commit: e6ebd394385db52855d1517cea829ffff68b34b8
  master date: 2020-12-15 13:41:23 +0100
  4943ea778876ac705b4264198663b5f8c9280fb9:x86: avoid calling {svm,vmx}_do_resume()

  These functions follow the following path: hvm_do_resume() ->
  handle_hvm_io_completion() -> hvm_wait_for_io() ->
  wait_on_xen_event_channel() -> do_softirq() -> schedule() ->
  sched_context_switch() -> continue_running() and hence may
  recursively invoke themselves. If this ends up happening a couple of
  times, a stack overflow would result.

  Prevent this by also resetting the stack at the
  ->arch.ctxt_switch->tail() invocations (in both places for consistency)
  and thus jumping to the functions instead of calling them.

  This is XSA-348 / CVE-2020-29566.

  Reported-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  master commit: e6ebd394385db52855d1517cea829ffff68b34b8
  master date: 2020-12-15 13:41:23 +0100
  16d0dc0edaac18d7e269324b183ddccdcf8a5e94:x86: avoid calling {svm,vmx}_do_resume()

  These functions follow the following path: hvm_do_resume() ->
  handle_hvm_io_completion() -> hvm_wait_for_io() ->
  wait_on_xen_event_channel() -> do_softirq() -> schedule() ->
  sched_context_switch() -> continue_running() and hence may
  recursively invoke themselves. If this ends up happening a couple of
  times, a stack overflow would result.

  Prevent this by also resetting the stack at the
  ->arch.ctxt_switch->tail() invocations (in both places for consistency)
  and thus jumping to the functions instead of calling them.

  This is XSA-348 / CVE-2020-29566.

  Reported-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  master commit: e6ebd394385db52855d1517cea829ffff68b34b8
  master date: 2020-12-15 13:41:23 +0100
  d8f08a44bc8da1401a9731667daecdb9b213c073:x86: avoid calling {svm,vmx}_do_resume()

  These functions follow the following path: hvm_do_resume() ->
  handle_hvm_io_completion() -> hvm_wait_for_io() ->
  wait_on_xen_event_channel() -> do_softirq() -> schedule() ->
  sched_context_switch() -> continue_running() and hence may
  recursively invoke themselves. If this ends up happening a couple of
  times, a stack overflow would result.

  Prevent this by also resetting the stack at the
  ->arch.ctxt_switch->tail() invocations (in both places for consistency)
  and thus jumping to the functions instead of calling them.

  This is XSA-348 / CVE-2020-29566.

  Reported-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
  master commit: e6ebd394385db52855d1517cea829ffff68b34b8
  master date: 2020-12-15 13:41:23 +0100
  e6ebd394385db52855d1517cea829ffff68b34b8:x86: avoid calling {svm,vmx}_do_resume()

  These functions follow the following path: hvm_do_resume() ->
  handle_hvm_io_completion() -> hvm_wait_for_io() ->
  wait_on_xen_event_channel() -> do_softirq() -> schedule() ->
  sched_context_switch() -> continue_running() and hence may
  recursively invoke themselves. If this ends up happening a couple of
  times, a stack overflow would result.

  Prevent this by also resetting the stack at the
  ->arch.ctxt_switch->tail() invocations (in both places for consistency)
  and thus jumping to the functions instead of calling them.

  This is XSA-348 / CVE-2020-29566.

  Reported-by: Julien Grall <jgrall@amazon.com>
  Signed-off-by: Jan Beulich <jbeulich@suse.com>
  Reviewed-by: Juergen Gross <jgross@suse.com>
impacted_packages:
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 4943ea778876ac705b4264198663b5f8c9280fb9
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 16d0dc0edaac18d7e269324b183ddccdcf8a5e94
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: 24f7d0305aed5a9657202bb8b4927dfbebca82a2
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: d8f08a44bc8da1401a9731667daecdb9b213c073
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: cbc06ee4280371f78f5858cd613c8d1e2a53ecd3
    introduced_in_commits: []
  - purl: pkg:github/xen-project/xen
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/xen-project/xen
        commit: e6ebd394385db52855d1517cea829ffff68b34b8
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/xen-project/xen/tree/16d0dc0edaac18d7e269324b183ddccdcf8a5e94
    reference_type: commit
    reference_id: 16d0dc0edaac18d7e269324b183ddccdcf8a5e94
  - url: https://github.com/xen-project/xen/tree/24f7d0305aed5a9657202bb8b4927dfbebca82a2
    reference_type: commit
    reference_id: 24f7d0305aed5a9657202bb8b4927dfbebca82a2
  - url: https://github.com/xen-project/xen/tree/4943ea778876ac705b4264198663b5f8c9280fb9
    reference_type: commit
    reference_id: 4943ea778876ac705b4264198663b5f8c9280fb9
  - url: https://github.com/xen-project/xen/tree/cbc06ee4280371f78f5858cd613c8d1e2a53ecd3
    reference_type: commit
    reference_id: cbc06ee4280371f78f5858cd613c8d1e2a53ecd3
  - url: https://github.com/xen-project/xen/tree/d8f08a44bc8da1401a9731667daecdb9b213c073
    reference_type: commit
    reference_id: d8f08a44bc8da1401a9731667daecdb9b213c073
  - url: https://github.com/xen-project/xen/tree/e6ebd394385db52855d1517cea829ffff68b34b8
    reference_type: commit
    reference_id: e6ebd394385db52855d1517cea829ffff68b34b8
