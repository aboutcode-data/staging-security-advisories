advisory_id: CVE-2023-39325
datasource_id: collect_kubernetes_fix_commits/CVE-2023-39325
datasource_url: https://github.com/kubernetes/kubernetes
aliases: []
summary: |
  d40f08f4a44785c238c280a8ec4fb944928253ed:Prevent rapid reset http2 DOS on API server

  This change fully addresses CVE-2023-44487 and CVE-2023-39325 for
  the API server when the client is unauthenticated.

  The changes to util/runtime are required because otherwise a large
  number of requests can get blocked on the time.Sleep calls.

  For unauthenticated clients (either via 401 or the anonymous user),
  we simply no longer allow such clients to hold open http2
  connections.  They can use http2, but with the performance of http1
  (with keep-alive disabled).

  Since this change has the potential to cause issues, the
  UnauthenticatedHTTP2DOSMitigation feature gate can be disabled to
  remove this protection (it is enabled by default).  For example,
  when the API server is fronted by an L7 load balancer that is set up
  to mitigate http2 attacks, unauthenticated clients could force
  disable connection reuse between the load balancer and the API
  server (many incoming connections could share the same backend
  connection).  An API server that is on a private network may opt to
  disable this protection to prevent performance regressions for
  unauthenticated clients.

  For all other clients, we rely on the golang.org/x/net fix in
  https://github.com/golang/net/commit/b225e7ca6dde1ef5a5ae5ce922861bda011cfabd
  That change is not sufficient to adequately protect against a
  motivated client - future changes to Kube and/or golang.org/x/net
  will be explored to address this gap.

  The Kube API server now uses a max stream of 100 instead of 250
  (this matches the Go http2 client default).  This lowers the abuse
  limit from 1000 to 400.

  Signed-off-by: Monis Khan <mok@microsoft.com>
  a78347c67ee74086aad7ed7c799db0f8c760412a:Prevent rapid reset http2 DOS on API server

  This change fully addresses CVE-2023-44487 and CVE-2023-39325 for
  the API server when the client is unauthenticated.

  The changes to util/runtime are required because otherwise a large
  number of requests can get blocked on the time.Sleep calls.

  For unauthenticated clients (either via 401 or the anonymous user),
  we simply no longer allow such clients to hold open http2
  connections.  They can use http2, but with the performance of http1
  (with keep-alive disabled).

  Since this change has the potential to cause issues, the
  UnauthenticatedHTTP2DOSMitigation feature gate can be disabled to
  remove this protection (it is enabled by default).  For example,
  when the API server is fronted by an L7 load balancer that is set up
  to mitigate http2 attacks, unauthenticated clients could force
  disable connection reuse between the load balancer and the API
  server (many incoming connections could share the same backend
  connection).  An API server that is on a private network may opt to
  disable this protection to prevent performance regressions for
  unauthenticated clients.

  For all other clients, we rely on the golang.org/x/net fix in
  https://github.com/golang/net/commit/b225e7ca6dde1ef5a5ae5ce922861bda011cfabd
  That change is not sufficient to adequately protect against a
  motivated client - future changes to Kube and/or golang.org/x/net
  will be explored to address this gap.

  The Kube API server now uses a max stream of 100 instead of 250
  (this matches the Go http2 client default).  This lowers the abuse
  limit from 1000 to 400.

  Signed-off-by: Monis Khan <mok@microsoft.com>
  c883ca7f035ad2b9c3126d113d234f632e1c7b83:Prevent rapid reset http2 DOS on API server

  This change fully addresses CVE-2023-44487 and CVE-2023-39325 for
  the API server when the client is unauthenticated.

  The changes to util/runtime are required because otherwise a large
  number of requests can get blocked on the time.Sleep calls.

  For unauthenticated clients (either via 401 or the anonymous user),
  we simply no longer allow such clients to hold open http2
  connections.  They can use http2, but with the performance of http1
  (with keep-alive disabled).

  Since this change has the potential to cause issues, the
  UnauthenticatedHTTP2DOSMitigation feature gate can be disabled to
  remove this protection (it is enabled by default).  For example,
  when the API server is fronted by an L7 load balancer that is set up
  to mitigate http2 attacks, unauthenticated clients could force
  disable connection reuse between the load balancer and the API
  server (many incoming connections could share the same backend
  connection).  An API server that is on a private network may opt to
  disable this protection to prevent performance regressions for
  unauthenticated clients.

  For all other clients, we rely on the golang.org/x/net fix in
  https://github.com/golang/net/commit/b225e7ca6dde1ef5a5ae5ce922861bda011cfabd
  That change is not sufficient to adequately protect against a
  motivated client - future changes to Kube and/or golang.org/x/net
  will be explored to address this gap.

  The Kube API server now uses a max stream of 100 instead of 250
  (this matches the Go http2 client default).  This lowers the abuse
  limit from 1000 to 400.

  Signed-off-by: Monis Khan <mok@microsoft.com>
  238d89c9a068dcd7ab994be1b3e646ce8d296ef8:Prevent rapid reset http2 DOS on API server

  This change fully addresses CVE-2023-44487 and CVE-2023-39325 for
  the API server when the client is unauthenticated.

  The changes to util/runtime are required because otherwise a large
  number of requests can get blocked on the time.Sleep calls.

  For unauthenticated clients (either via 401 or the anonymous user),
  we simply no longer allow such clients to hold open http2
  connections.  They can use http2, but with the performance of http1
  (with keep-alive disabled).

  Since this change has the potential to cause issues, the
  UnauthenticatedHTTP2DOSMitigation feature gate can be disabled to
  remove this protection (it is enabled by default).  For example,
  when the API server is fronted by an L7 load balancer that is set up
  to mitigate http2 attacks, unauthenticated clients could force
  disable connection reuse between the load balancer and the API
  server (many incoming connections could share the same backend
  connection).  An API server that is on a private network may opt to
  disable this protection to prevent performance regressions for
  unauthenticated clients.

  For all other clients, we rely on the golang.org/x/net fix in
  https://github.com/golang/net/commit/b225e7ca6dde1ef5a5ae5ce922861bda011cfabd
  That change is not sufficient to adequately protect against a
  motivated client - future changes to Kube and/or golang.org/x/net
  will be explored to address this gap.

  The Kube API server now uses a max stream of 100 instead of 250
  (this matches the Go http2 client default).  This lowers the abuse
  limit from 1000 to 400.

  Signed-off-by: Monis Khan <mok@microsoft.com>
  800a8eaba7f25bd223fefe6e7613e39a5d7f1eeb:Prevent rapid reset http2 DOS on API server

  This change fully addresses CVE-2023-44487 and CVE-2023-39325 for
  the API server when the client is unauthenticated.

  The changes to util/runtime are required because otherwise a large
  number of requests can get blocked on the time.Sleep calls.

  For unauthenticated clients (either via 401 or the anonymous user),
  we simply no longer allow such clients to hold open http2
  connections.  They can use http2, but with the performance of http1
  (with keep-alive disabled).

  Since this change has the potential to cause issues, the
  UnauthenticatedHTTP2DOSMitigation feature gate can be disabled to
  remove this protection (it is enabled by default).  For example,
  when the API server is fronted by an L7 load balancer that is set up
  to mitigate http2 attacks, unauthenticated clients could force
  disable connection reuse between the load balancer and the API
  server (many incoming connections could share the same backend
  connection).  An API server that is on a private network may opt to
  disable this protection to prevent performance regressions for
  unauthenticated clients.

  For all other clients, we rely on the golang.org/x/net fix in
  https://github.com/golang/net/commit/b225e7ca6dde1ef5a5ae5ce922861bda011cfabd
  That change is not sufficient to adequately protect against a
  motivated client - future changes to Kube and/or golang.org/x/net
  will be explored to address this gap.

  The Kube API server now uses a max stream of 100 instead of 250
  (this matches the Go http2 client default).  This lowers the abuse
  limit from 1000 to 400.

  Signed-off-by: Monis Khan <mok@microsoft.com>
  f86a84670e550f31e04df95bd32b0cf035629a0d:Merge pull request #121128 from MadhavJivrajani/bump-x-net-128

  [1.28][CVE-2023-39325] .: bump golang.org/x/net to v0.17.0
  82bc4ccf0051fbd3beb53b32cb04b0418aa46064:Merge pull request #121127 from MadhavJivrajani/bump-x-net-127

  [1.27][CVE-2023-39325] .: bump golang.org/x/net to v0.17.0
  3da6e3c67afa5accc945cb78f4793e391e4791f0:Merge pull request #121125 from MadhavJivrajani/bump-x-net-125

  [1.25][CVE-2023-39325] .: bump golang.org/x/net to v0.17.0
  3ec9fd3fbe2873205939935052b04f2668a3db7e:Merge pull request #121126 from MadhavJivrajani/bump-x-net-126

  [1.26][CVE-2023-39325] .: bump golang.org/x/net to v0.17.0
  3d980e0633d9043f1bc4e6a3141185fbece78183:.: bump golang.org/x/net to v0.17.0

  Bumping golang.org/x/net in light of CVE-2023-39325 and CVE-2023-44487.

  Signed-off-by: Madhav Jivrajani <madhav.jiv@gmail.com>
  1cd2ac99542ad0b9f82e3c0177ed3c3e18465136:.: bump golang.org/x/net to v0.17.0

  Bumping golang.org/x/net in light of CVE-2023-39325 and CVE-2023-44487.

  Signed-off-by: Madhav Jivrajani <madhav.jiv@gmail.com>
  ff52c6daa8ce633bb94bdc3e8e80f4eebf3a2e39:.: bump golang.org/x/net to v0.17.0

  Bumping golang.org/x/net in light of CVE-2023-39325 and CVE-2023-44487.

  Signed-off-by: Madhav Jivrajani <madhav.jiv@gmail.com>
  ab65c7d3b71fc22b9c456e841de55128e9efd03b:.: bump golang.org/x/net to v0.17.0

  Bumping golang.org/x/net in light of CVE-2023-39325 and CVE-2023-44487.

  Signed-off-by: Madhav Jivrajani <madhav.jiv@gmail.com>
  7ee2af5cc5fee6a6f837975a70a35ce681a8e9d4:Merge pull request #121117 from MadhavJivrajani/bump-x-net

  [CVE-2023-39325] .: bump golang.org/x/net to v0.17.0
  fc7c951d5a5b8b75dfa105e3bea7bbddaf4c792e:.: bump golang.org/x/net to v0.17.0

  Bumping golang.org/x/net in light of CVE-2023-39325 and CVE-2023-44487.

  Signed-off-by: Madhav Jivrajani <madhav.jiv@gmail.com>
impacted_packages:
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: 3d980e0633d9043f1bc4e6a3141185fbece78183
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: a78347c67ee74086aad7ed7c799db0f8c760412a
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: ab65c7d3b71fc22b9c456e841de55128e9efd03b
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: 1cd2ac99542ad0b9f82e3c0177ed3c3e18465136
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: c883ca7f035ad2b9c3126d113d234f632e1c7b83
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: 7ee2af5cc5fee6a6f837975a70a35ce681a8e9d4
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: 82bc4ccf0051fbd3beb53b32cb04b0418aa46064
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: fc7c951d5a5b8b75dfa105e3bea7bbddaf4c792e
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: 3da6e3c67afa5accc945cb78f4793e391e4791f0
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: 3ec9fd3fbe2873205939935052b04f2668a3db7e
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: f86a84670e550f31e04df95bd32b0cf035629a0d
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: 800a8eaba7f25bd223fefe6e7613e39a5d7f1eeb
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: ff52c6daa8ce633bb94bdc3e8e80f4eebf3a2e39
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: 238d89c9a068dcd7ab994be1b3e646ce8d296ef8
    introduced_in_commits: []
  - purl: pkg:github/kubernetes/kubernetes
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/kubernetes/kubernetes
        commit: d40f08f4a44785c238c280a8ec4fb944928253ed
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/kubernetes/kubernetes/tree/1cd2ac99542ad0b9f82e3c0177ed3c3e18465136
    reference_type: commit
    reference_id: 1cd2ac99542ad0b9f82e3c0177ed3c3e18465136
  - url: https://github.com/kubernetes/kubernetes/tree/238d89c9a068dcd7ab994be1b3e646ce8d296ef8
    reference_type: commit
    reference_id: 238d89c9a068dcd7ab994be1b3e646ce8d296ef8
  - url: https://github.com/kubernetes/kubernetes/tree/3d980e0633d9043f1bc4e6a3141185fbece78183
    reference_type: commit
    reference_id: 3d980e0633d9043f1bc4e6a3141185fbece78183
  - url: https://github.com/kubernetes/kubernetes/tree/3da6e3c67afa5accc945cb78f4793e391e4791f0
    reference_type: commit
    reference_id: 3da6e3c67afa5accc945cb78f4793e391e4791f0
  - url: https://github.com/kubernetes/kubernetes/tree/3ec9fd3fbe2873205939935052b04f2668a3db7e
    reference_type: commit
    reference_id: 3ec9fd3fbe2873205939935052b04f2668a3db7e
  - url: https://github.com/kubernetes/kubernetes/tree/7ee2af5cc5fee6a6f837975a70a35ce681a8e9d4
    reference_type: commit
    reference_id: 7ee2af5cc5fee6a6f837975a70a35ce681a8e9d4
  - url: https://github.com/kubernetes/kubernetes/tree/800a8eaba7f25bd223fefe6e7613e39a5d7f1eeb
    reference_type: commit
    reference_id: 800a8eaba7f25bd223fefe6e7613e39a5d7f1eeb
  - url: https://github.com/kubernetes/kubernetes/tree/82bc4ccf0051fbd3beb53b32cb04b0418aa46064
    reference_type: commit
    reference_id: 82bc4ccf0051fbd3beb53b32cb04b0418aa46064
  - url: https://github.com/kubernetes/kubernetes/tree/a78347c67ee74086aad7ed7c799db0f8c760412a
    reference_type: commit
    reference_id: a78347c67ee74086aad7ed7c799db0f8c760412a
  - url: https://github.com/kubernetes/kubernetes/tree/ab65c7d3b71fc22b9c456e841de55128e9efd03b
    reference_type: commit
    reference_id: ab65c7d3b71fc22b9c456e841de55128e9efd03b
  - url: https://github.com/kubernetes/kubernetes/tree/c883ca7f035ad2b9c3126d113d234f632e1c7b83
    reference_type: commit
    reference_id: c883ca7f035ad2b9c3126d113d234f632e1c7b83
  - url: https://github.com/kubernetes/kubernetes/tree/d40f08f4a44785c238c280a8ec4fb944928253ed
    reference_type: commit
    reference_id: d40f08f4a44785c238c280a8ec4fb944928253ed
  - url: https://github.com/kubernetes/kubernetes/tree/f86a84670e550f31e04df95bd32b0cf035629a0d
    reference_type: commit
    reference_id: f86a84670e550f31e04df95bd32b0cf035629a0d
  - url: https://github.com/kubernetes/kubernetes/tree/fc7c951d5a5b8b75dfa105e3bea7bbddaf4c792e
    reference_type: commit
    reference_id: fc7c951d5a5b8b75dfa105e3bea7bbddaf4c792e
  - url: https://github.com/kubernetes/kubernetes/tree/ff52c6daa8ce633bb94bdc3e8e80f4eebf3a2e39
    reference_type: commit
    reference_id: ff52c6daa8ce633bb94bdc3e8e80f4eebf3a2e39
