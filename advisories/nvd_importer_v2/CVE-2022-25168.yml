advisory_id: CVE-2022-25168
datasource_id: nvd_importer_v2/CVE-2022-25168
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-25168
aliases: []
summary: Apache Hadoop's FileUtil.unTar(File, File) API does not escape the input file name
  before being passed to the shell. An attacker can inject arbitrary commands. This is only
  used in Hadoop 3.3 InMemoryAliasMap.completeBootstrapTransfer, which is only ever run by a
  local user. It has been used in Hadoop 2.x for yarn localization, which does enable remote
  code execution. It is used in Apache Spark, from the SQL command ADD ARCHIVE. As the ADD ARCHIVE
  command adds new binaries to the classpath, being able to execute shell scripts does not confer
  new permissions to the caller. SPARK-38305. "Check existence of file before untarring/zipping",
  which is included in 3.3.0, 3.1.4, 3.2.2, prevents shell commands being executed, regardless
  of which version of the hadoop libraries are in use. Users should upgrade to Apache Hadoop
  2.10.2, 3.2.4, 3.3.3 or upper (including HADOOP-18136).
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-25168
weaknesses:
  - CWE-78
references:
  - url: https://lists.apache.org/thread/mxqnb39jfrwgs3j6phwvlrfq4mlox130
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220915-0007/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:hadoop:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:hadoop:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-25168
    reference_type:
    reference_id: CVE-2022-25168
