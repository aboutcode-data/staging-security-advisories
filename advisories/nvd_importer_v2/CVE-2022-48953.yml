advisory_id: CVE-2022-48953
datasource_id: nvd_importer_v2/CVE-2022-48953
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-48953
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  rtc: cmos: Fix event handler registration ordering issue

  Because acpi_install_fixed_event_handler() enables the event
  automatically on success, it is incorrect to call it before the
  handler routine passed to it is ready to handle events.

  Unfortunately, the rtc-cmos driver does exactly the incorrect thing
  by calling cmos_wake_setup(), which passes rtc_handler() to
  acpi_install_fixed_event_handler(), before cmos_do_probe(), because
  rtc_handler() uses dev_get_drvdata() to get to the cmos object
  pointer and the driver data pointer is only populated in
  cmos_do_probe().

  This leads to a NULL pointer dereference in rtc_handler() on boot
  if the RTC fixed event happens to be active at the init time.

  To address this issue, change the initialization ordering of the
  driver so that cmos_wake_setup() is always called after a successful
  cmos_do_probe() call.

  While at it, change cmos_pnp_probe() to call cmos_do_probe() after
  the initial if () statement used for computing the IRQ argument to
  be passed to cmos_do_probe() which is cleaner than calling it in
  each branch of that if () (local variable "irq" can be of type int,
  because it is passed to that function as an argument of type int).

  Note that commit 6492fed7d8c9 ("rtc: rtc-cmos: Do not check
  ACPI_FADT_LOW_POWER_S0") caused this issue to affect a larger number
  of systems, because previously it only affected systems with
  ACPI_FADT_LOW_POWER_S0 set, but it is present regardless of that
  commit.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48953
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/0bcfccb48696aba475f046c2021f0733659ce0ef
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1ba745fce13d19775100eece30b0bfb8b8b10ea6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4919d3eb2ec0ee364f7e3cf2d99646c1b224fae8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/60c6e563a843032cf6ff84b2fb732cd8754fc10d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc8:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc8:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48953
    reference_type:
    reference_id: CVE-2022-48953
