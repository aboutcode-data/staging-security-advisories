advisory_id: CVE-2023-53565
datasource_id: nvd_importer_v2/CVE-2023-53565
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53565
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: brcmfmac: Check for probe() id argument being NULL

  The probe() id argument may be NULL in 2 scenarios:

  1. brcmf_pcie_pm_leave_D3() calling brcmf_pcie_probe() to reprobe
     the device.

  2. If a user tries to manually bind the driver from sysfs then the sdio /
     pcie / usb probe() function gets called with NULL as id argument.

  1. Is being hit by users causing the following oops on resume and causing
  wifi to stop working:

  BUG: kernel NULL pointer dereference, address: 0000000000000018
  <snip>
  Hardware name: Dell Inc. XPS 13 9350/0PWNCR, BIDS 1.13.0 02/10/2020
  Workgueue: events_unbound async_run_entry_fn
  RIP: 0010:brcmf_pcie_probe+Ox16b/0x7a0 [brcmfmac]
  <snip>
  Call Trace:
   <TASK>
   brcmf_pcie_pm_leave_D3+0xc5/8x1a0 [brcmfmac be3b4cefca451e190fa35be8f00db1bbec293887]
   ? pci_pm_resume+0x5b/0xf0
   ? pci_legacy_resume+0x80/0x80
   dpm_run_callback+0x47/0x150
   device_resume+0xa2/0x1f0
   async_resume+0x1d/0x30
  <snip>

  Fix this by checking for id being NULL.

  In the PCI and USB cases try a manual lookup of the id so that manually
  binding the driver through sysfs and more importantly brcmf_pcie_probe()
  on resume will work.

  For the SDIO case there is no helper to do a manual sdio_device_id lookup,
  so just directly error out on a NULL id there.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53565
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/60fc756fc8e6954a5618eecac73b255d651602e4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/84766e77a5c35e2b60e34f570c62fc97adc05e09
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.4:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.4:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.4:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.4:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53565
    reference_type:
    reference_id: CVE-2023-53565
