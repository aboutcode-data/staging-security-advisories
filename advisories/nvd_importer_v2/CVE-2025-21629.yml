advisory_id: CVE-2025-21629
datasource_id: nvd_importer_v2/CVE-2025-21629
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21629
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: reenable NETIF_F_IPV6_CSUM offload for BIG TCP packets

  The blamed commit disabled hardware offoad of IPv6 packets with
  extension headers on devices that advertise NETIF_F_IPV6_CSUM,
  based on the definition of that feature in skbuff.h:

   *   * - %NETIF_F_IPV6_CSUM
   *     - Driver (device) is only able to checksum plain
   *       TCP or UDP packets over IPv6. These are specifically
   *       unencapsulated packets of the form IPv6|TCP or
   *       IPv6|UDP where the Next Header field in the IPv6
   *       header is either TCP or UDP. IPv6 extension headers
   *       are not supported with this feature. This feature
   *       cannot be set in features for a device with
   *       NETIF_F_HW_CSUM also set. This feature is being
   *       DEPRECATED (see below).

  The change causes skb_warn_bad_offload to fire for BIG TCP
  packets.

  [  496.310233] WARNING: CPU: 13 PID: 23472 at net/core/dev.c:3129 skb_warn_bad_offload+0xc4/0xe0

  [  496.310297]  ? skb_warn_bad_offload+0xc4/0xe0
  [  496.310300]  skb_checksum_help+0x129/0x1f0
  [  496.310303]  skb_csum_hwoffload_help+0x150/0x1b0
  [  496.310306]  validate_xmit_skb+0x159/0x270
  [  496.310309]  validate_xmit_skb_list+0x41/0x70
  [  496.310312]  sch_direct_xmit+0x5c/0x250
  [  496.310317]  __qdisc_run+0x388/0x620

  BIG TCP introduced an IPV6_TLV_JUMBO IPv6 extension header to
  communicate packet length, as this is an IPv6 jumbogram. But, the
  feature is only enabled on devices that support BIG TCP TSO. The
  header is only present for PF_PACKET taps like tcpdump, and not
  transmitted by physical devices.

  For this specific case of extension headers that are not
  transmitted, return to the situation before the blamed commit
  and support hardware offload.

  ipv6_has_hopopt_jumbo() tests not only whether this header is present,
  but also that it is the only extension header before a terminal (L4)
  header.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21629
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/68e068cabd2c6c533ef934c2e5151609cf6ecc6d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95ccf006bbc8b59044313b8c309dcf29c546abd4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac9cfef69565021c9e1022a493a9c40b03e2caf9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d3b7a9c7597b779039a51d7b34116fbe424bf2b7
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21629
    reference_type:
    reference_id: CVE-2025-21629
