advisory_id: CVE-2025-71221
datasource_id: nvd_importer_v2/CVE-2025-71221
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-71221
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dmaengine: mmp_pdma: Fix race condition in mmp_pdma_residue()

  Add proper locking in mmp_pdma_residue() to prevent use-after-free when
  accessing descriptor list and descriptor contents.

  The race occurs when multiple threads call tx_status() while the tasklet
  on another CPU is freeing completed descriptors:

  CPU 0                              CPU 1
  -----                              -----
  mmp_pdma_tx_status()
  mmp_pdma_residue()
    -> NO LOCK held
       list_for_each_entry(sw, ..)
                                     DMA interrupt
                                     dma_do_tasklet()
                                       -> spin_lock(&desc_lock)
                                          list_move(sw->node, ...)
                                          spin_unlock(&desc_lock)
    |                                     dma_pool_free(sw) <- FREED!
    -> access sw->desc <- UAF!

  This issue can be reproduced when running dmatest on the same channel with
  multiple threads (threads_per_chan > 1).

  Fix by protecting the chain_running list iteration and descriptor access
  with the chan->desc_lock spinlock.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/9f665b3c3d9a168410251f27a5d019b7bf93185c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a143545855bc2c6e1330f6f57ae375ac44af00a7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-71221
    reference_type:
    reference_id: CVE-2025-71221
