advisory_id: CVE-2025-68251
datasource_id: nvd_importer_v2/CVE-2025-68251
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68251
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  erofs: avoid infinite loops due to corrupted subpage compact indexes

  Robert reported an infinite loop observed by two crafted images.

  The root cause is that `clusterofs` can be larger than `lclustersize`
  for !NONHEAD `lclusters` in corrupted subpage compact indexes, e.g.:

    blocksize = lclustersize = 512   lcn = 6   clusterofs = 515

  Move the corresponding check for full compress indexes to
  `z_erofs_load_lcluster_from_disk()` to also cover subpage compact
  compress indexes.

  It also fixes the position of `m->type >= Z_EROFS_LCLUSTER_TYPE_MAX`
  check, since it should be placed right after
  `z_erofs_load_{compact,full}_lcluster()`.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/8675447a8794983f2b7e694b378112772c17635e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e13d315ae077bb7c3c6027cc292401bc0f4ec683
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68251
    reference_type:
    reference_id: CVE-2025-68251
