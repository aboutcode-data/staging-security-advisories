advisory_id: CVE-2024-56706
datasource_id: nvd_importer_v2/CVE-2024-56706
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-56706
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  s390/cpum_sf: Fix and protect memory allocation of SDBs with mutex

  Reservation of the PMU hardware is done at first event creation
  and is protected by a pair of mutex_lock() and mutex_unlock().
  After reservation of the PMU hardware the memory
  required for the PMUs the event is to be installed on is
  allocated by allocate_buffers() and alloc_sampling_buffer().
  This done outside of the mutex protection.
  Without mutex protection two or more concurrent invocations of
  perf_event_init() may run in parallel.
  This can lead to allocation of Sample Data Blocks (SDBs)
  multiple times for the same PMU.
  Prevent this and protect memory allocation of SDBs by
  mutex.
impacted_packages: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56706
weaknesses:
  - CWE-362
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/4b3bdfa89635db6a53e02955548bd07bebcae233
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f55bd479d8663a4a4e403b3d308d3d1aa33d92df
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56706
    reference_type:
    reference_id: CVE-2024-56706
