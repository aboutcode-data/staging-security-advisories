advisory_id: CVE-2025-40101
datasource_id: nvd_importer_v2/CVE-2025-40101
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40101
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  btrfs: fix memory leaks when rejecting a non SINGLE data profile without an RST

  At the end of btrfs_load_block_group_zone_info() the first thing we do
  is to ensure that if the mapping type is not a SINGLE one and there is
  no RAID stripe tree, then we return early with an error.

  Doing that, though, prevents the code from running the last calls from
  this function which are about freeing memory allocated during its
  run. Hence, in this case, instead of returning early, we set the ret
  value and fall through the rest of the cleanup code.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/187333e6d484c6630286bfdd07c79d6815a63887
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/602701d00439e113331ee9c1283e95afdcb8849d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fec9b9d3ced39f16be8d7afdf81f4dd2653da319
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40101
    reference_type:
    reference_id: CVE-2025-40101
