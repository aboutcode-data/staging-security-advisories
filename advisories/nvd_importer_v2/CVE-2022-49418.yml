advisory_id: CVE-2022-49418
datasource_id: nvd_importer_v2/CVE-2022-49418
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49418
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  NFSv4: Fix free of uninitialized nfs4_label on referral lookup.

  Send along the already-allocated fattr along with nfs4_fs_locations, and
  drop the memcpy of fattr.  We end up growing two more allocations, but this
  fixes up a crash as:

  PID: 790    TASK: ffff88811b43c000  CPU: 0   COMMAND: "ls"
   #0 [ffffc90000857920] panic at ffffffff81b9bfde
   #1 [ffffc900008579c0] do_trap at ffffffff81023a9b
   #2 [ffffc90000857a10] do_error_trap at ffffffff81023b78
   #3 [ffffc90000857a58] exc_stack_segment at ffffffff81be1f45
   #4 [ffffc90000857a80] asm_exc_stack_segment at ffffffff81c009de
   #5 [ffffc90000857b08] nfs_lookup at ffffffffa0302322 [nfs]
   #6 [ffffc90000857b70] __lookup_slow at ffffffff813a4a5f
   #7 [ffffc90000857c60] walk_component at ffffffff813a86c4
   #8 [ffffc90000857cb8] path_lookupat at ffffffff813a9553
   #9 [ffffc90000857cf0] filename_lookup at ffffffff813ab86b
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49418
weaknesses:
  - CWE-908
references:
  - url: https://git.kernel.org/stable/c/6015292653d95ba9f72906e2b65e536aa5807d64
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c3ed222745d9ad7b69299b349a64ba533c64a34f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49418
    reference_type:
    reference_id: CVE-2022-49418
