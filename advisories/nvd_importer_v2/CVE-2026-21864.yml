advisory_id: CVE-2026-21864
datasource_id: nvd_importer_v2/CVE-2026-21864
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-21864
aliases: []
summary: Valkey-Bloom is a Rust based Valkey module which brings a Bloom Filter (Module) data
  type into the Valkey distributed key-value database. Prior to commit a68614b6e3845777d383b3a513cedcc08b3b7ccd,
  a specially crafted `RESTORE` command can cause Valkey to hit an assertion, causes the server
  to shutdown. Valkey modules are required to handle errors in RDB parsing by using `VALKEYMODULE_OPTIONS_HANDLE_IO_ERRORS`
  flag. If this flag is not set, errors encountered during parsing result in a system assertion
  which shuts down the system. Even though the Valkey-bloom module correctly handled the parsing,
  it did not originally set the flag. Commit a68614b6e3845777d383b3a513cedcc08b3b7ccd contains
  a patch. One may mitigate this defect by disabling the `RESTORE` command if it is unused by
  one's application.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-21864
weaknesses:
  - CWE-20
references:
  - url: https://github.com/valkey-io/valkey-bloom/commit/a68614b6e3845777d383b3a513cedcc08b3b7ccd
    reference_type:
    reference_id:
  - url: https://github.com/valkey-io/valkey-bloom/security/advisories/GHSA-mc2g-h759-3qw2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-21864
    reference_type:
    reference_id: CVE-2026-21864
