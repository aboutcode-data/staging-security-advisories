advisory_id: CVE-2022-50446
datasource_id: nvd_importer_v2/CVE-2022-50446
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50446
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ARC: mm: fix leakage of memory allocated for PTE

  Since commit d9820ff ("ARC: mm: switch pgtable_t back to struct page *")
  a memory leakage problem occurs. Memory allocated for page table entries
  not released during process termination. This issue can be reproduced by
  a small program that allocates a large amount of memory. After several
  runs, you'll see that the amount of free memory has reduced and will
  continue to reduce after each run. All ARC CPUs are effected by this
  issue. The issue was introduced since the kernel stable release v5.15-rc1.

  As described in commit d9820ff after switch pgtable_t back to struct
  page *, a pointer to "struct page" and appropriate functions are used to
  allocate and free a memory page for PTEs, but the pmd_pgtable macro hasn't
  changed and returns the direct virtual address from the PMD (PGD) entry.
  Than this address used as a parameter in the __pte_free() and as a result
  this function couldn't release memory page allocated for PTEs.

  Fix this issue by changing the pmd_pgtable macro and returning pointer to
  struct page.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50446
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/14009ada5712649589ab4ad0441b811780ea8773
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4fd9df10cb7a9289fbd22d669f9f98164d95a1ce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d83a69966e8b6ae9dd447f3ac704c0223bceb7f7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50446
    reference_type:
    reference_id: CVE-2022-50446
