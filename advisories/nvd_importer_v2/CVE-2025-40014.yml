advisory_id: CVE-2025-40014
datasource_id: nvd_importer_v2/CVE-2025-40014
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40014
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  objtool, spi: amd: Fix out-of-bounds stack access in amd_set_spi_freq()

  If speed_hz < AMD_SPI_MIN_HZ, amd_set_spi_freq() iterates over the
  entire amd_spi_freq array without breaking out early, causing 'i' to go
  beyond the array bounds.

  Fix that by stopping the loop when it gets to the last entry, so the low
  speed_hz value gets clamped up to AMD_SPI_MIN_HZ.

  Fixes the following warning with an UBSAN kernel:

    drivers/spi/spi-amd.o: error: objtool: amd_set_spi_freq() falls through to next function amd_spi_set_opcode()
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-40014
weaknesses:
  - CWE-129
references:
  - url: https://git.kernel.org/stable/c/76e51db43fe4aaaebcc5ddda67b0807f7c9bdecc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7f2c746e09a3746bf937bc708129dc8af61d8f19
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40014
    reference_type:
    reference_id: CVE-2025-40014
