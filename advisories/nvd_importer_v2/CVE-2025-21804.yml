advisory_id: CVE-2025-21804
datasource_id: nvd_importer_v2/CVE-2025-21804
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21804
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  PCI: rcar-ep: Fix incorrect variable used when calling devm_request_mem_region()

  The rcar_pcie_parse_outbound_ranges() uses the devm_request_mem_region()
  macro to request a needed resource. A string variable that lives on the
  stack is then used to store a dynamically computed resource name, which
  is then passed on as one of the macro arguments. This can lead to
  undefined behavior.

  Depending on the current contents of the memory, the manifestations of
  errors may vary. One possible output may be as follows:

    $ cat /proc/iomem
    30000000-37ffffff :
    38000000-3fffffff :

  Sometimes, garbage may appear after the colon.

  In very rare cases, if no NULL-terminator is found in memory, the system
  might crash because the string iterator will overrun which can lead to
  access of unmapped memory above the stack.

  Thus, fix this by replacing outbound_name with the name of the previously
  requested resource. With the changes applied, the output will be as
  follows:

    $ cat /proc/iomem
    30000000-37ffffff : memory2
    38000000-3fffffff : memory3

  [kwilczynski: commit log]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21804
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/24576899c49509c0d533bcf569139f691d8f7af7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2c54b9fca1755e80a343ccfde0652dc5ea4744b2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2d2da5a4c1b4509f6f7e5a8db015cd420144beb4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/44708208c2a4b828a57a2abe7799c9d3962e7eaa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6987e021b64cbb49981d140bb72d9d1466f191c4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7a47e14c5fb0b6dba7073be7b0119fb8fe864e01
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ff46b0bfeb6e0724a4ace015aa7a0b887cdb7c1
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00028.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21804
    reference_type:
    reference_id: CVE-2025-21804
