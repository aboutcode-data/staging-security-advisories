advisory_id: CVE-2024-39305
datasource_id: nvd_importer_v2/CVE-2024-39305
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-39305
aliases: []
summary: Envoy is a cloud-native, open source edge and service proxy. Prior to versions 1.30.4,
  1.29.7, 1.28.5, and 1.27.7. Envoy references already freed memory when route hash policy is
  configured with cookie attributes. Note that this vulnerability has been fixed in the open
  as the effect would be immediately apparent if it was configured. Memory allocated for holding
  attribute values is freed after configuration was parsed. During request processing Envoy
  will attempt to copy content of de-allocated memory into request cookie header. This can lead
  to arbitrary content of Envoy's memory to be sent to the upstream service or abnormal process
  termination. This vulnerability is fixed in Envoy versions v1.30.4, v1.29.7, v1.28.5, and
  v1.27.7. As a workaround, do not use cookie attributes in route action hash policy.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-39305
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-39305
weaknesses:
  - CWE-416
references:
  - url: https://github.com/envoyproxy/envoy/commit/02a06681fbe0e039b1c7a9215257a7537eddb518
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/envoy/commit/50b384cb203a1f2894324cbae64b6d9bc44cce45
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/envoy/commit/99b6e525fb9f6f6f19a0425f779bc776f121c7e5
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/envoy/commit/b7f509607ad860fd6a63cde4f7d6f0197f9f63bb
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-fp35-g349-h66f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:1.27.6:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:1.27.6:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:1.28.4:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:1.28.4:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:1.29.6:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:1.29.6:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:1.30.3:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:1.30.3:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-39305
    reference_type:
    reference_id: CVE-2024-39305
