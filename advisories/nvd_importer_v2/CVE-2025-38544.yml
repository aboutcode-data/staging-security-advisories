advisory_id: CVE-2025-38544
datasource_id: nvd_importer_v2/CVE-2025-38544
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38544
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  rxrpc: Fix bug due to prealloc collision

  When userspace is using AF_RXRPC to provide a server, it has to preallocate
  incoming calls and assign to them call IDs that will be used to thread
  related recvmsg() and sendmsg() together.  The preallocated call IDs will
  automatically be attached to calls as they come in until the pool is empty.

  To the kernel, the call IDs are just arbitrary numbers, but userspace can
  use the call ID to hold a pointer to prepared structs.  In any case, the
  user isn't permitted to create two calls with the same call ID (call IDs
  become available again when the call ends) and EBADSLT should result from
  sendmsg() if an attempt is made to preallocate a call with an in-use call
  ID.

  However, the cleanup in the error handling will trigger both assertions in
  rxrpc_cleanup_call() because the call isn't marked complete and isn't
  marked as having been released.

  Fix this by setting the call state in rxrpc_service_prealloc_one() and then
  marking it as being released before calling the cleanup function.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38544
weaknesses:
  - CWE-617
references:
  - url: https://git.kernel.org/stable/c/432c5363cd6fe5a928bbc94524d28b05515684dd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5385ad53793de2ab11e396bdcdaa65bb04b4dad6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/69e4186773c6445b258fb45b6e1df18df831ec45
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d8ffb47a443919277cb093c3db1ec6c0a06880b1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38544
    reference_type:
    reference_id: CVE-2025-38544
