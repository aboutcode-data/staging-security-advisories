advisory_id: CVE-2023-53307
datasource_id: nvd_importer_v2/CVE-2023-53307
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53307
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  rbd: avoid use-after-free in do_rbd_add() when rbd_dev_create() fails

  If getting an ID or setting up a work queue in rbd_dev_create() fails,
  use-after-free on rbd_dev->rbd_client, rbd_dev->spec and rbd_dev->opts
  is triggered in do_rbd_add().  The root cause is that the ownership of
  these structures is transfered to rbd_dev prematurely and they all end
  up getting freed when rbd_dev_create() calls rbd_dev_free() prior to
  returning to do_rbd_add().

  Found by Linux Verification Center (linuxtesting.org) with SVACE, an
  incomplete patch submitted by Natalia Petrova <n.petrova@fintech.ru>.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53307
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/71da2a151ed1adb0aea4252b16d81b53012e7afd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9787b328c42c13c4f31e7d5042c4e877e9344068
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a73783e4e0c4d1507794da211eeca75498544dff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ae16346078b1189aee934afd872d9f3d0a682c33
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cc8c0dd2984503ed09efa37bcafcef3d3da104e8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e3cbb4d60764295992c95344f2d779439e8b34ce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f7c4d9b133c7a04ca619355574e96b6abf209fba
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/faa7b683e436664fff5648426950718277831348
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53307
    reference_type:
    reference_id: CVE-2023-53307
