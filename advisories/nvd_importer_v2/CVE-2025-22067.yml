advisory_id: CVE-2025-22067
datasource_id: nvd_importer_v2/CVE-2025-22067
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-22067
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  spi: cadence: Fix out-of-bounds array access in cdns_mrvl_xspi_setup_clock()

  If requested_clk > 128, cdns_mrvl_xspi_setup_clock() iterates over the
  entire cdns_mrvl_xspi_clk_div_list array without breaking out early,
  causing 'i' to go beyond the array bounds.

  Fix that by stopping the loop when it gets to the last entry, clamping
  the clock to the minimum 6.25 MHz.

  Fixes the following warning with an UBSAN kernel:

    vmlinux.o: warning: objtool: cdns_mrvl_xspi_setup_clock: unexpected end of section .text.cdns_mrvl_xspi_setup_clock
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-22067
weaknesses:
  - CWE-129
references:
  - url: https://git.kernel.org/stable/c/645f1813fe0dc96381c36b834131e643b798fd73
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7ba0847fa1c22e7801cebfe5f7b75aee4fae317e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c1fb84e274cb6a2bce6ba5e65116c06e0b3ab275
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e50781bf7accc75883cb8a6a9921fb4e2fa8cca4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22067
    reference_type:
    reference_id: CVE-2025-22067
