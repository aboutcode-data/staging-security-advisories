advisory_id: CVE-2025-40120
datasource_id: nvd_importer_v2/CVE-2025-40120
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40120
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: usb: asix: hold PM usage ref to avoid PM/MDIO + RTNL deadlock

  Prevent USB runtime PM (autosuspend) for AX88772* in bind.

  usbnet enables runtime PM (autosuspend) by default, so disabling it via
  the usb_driver flag is ineffective. On AX88772B, autosuspend shows no
  measurable power saving with current driver (no link partner, admin
  up/down). The ~0.453 W -> ~0.248 W drop on v6.1 comes from phylib powering
  the PHY off on admin-down, not from USB autosuspend.

  The real hazard is that with runtime PM enabled, ndo_open() (under RTNL)
  may synchronously trigger autoresume (usb_autopm_get_interface()) into
  asix_resume() while the USB PM lock is held. Resume paths then invoke
  phylink/phylib and MDIO, which also expect RTNL, leading to possible
  deadlocks or PM lock vs MDIO wake issues.

  To avoid this, keep the device runtime-PM active by taking a usage
  reference in ax88772_bind() and dropping it in unbind(). A non-zero PM
  usage count blocks runtime suspend regardless of userspace policy
  (.../power/control - pm_runtime_allow/forbid), making this approach
  robust against sysfs overrides.

  Holding a runtime-PM usage ref does not affect system-wide suspend;
  system sleep/resume callbacks continue to run as before.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1534517300e12f2930b6ff477b8820ff658afd11
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3d3c4cd5c62f24bb3cb4511b7a95df707635e00a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3e96cd27ff1a004d84908c1b6cc68ac60913874e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/71a0ba7fdaf8d035426912a4ed7bf1738a81010c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/724a9db84188f80ef60b1f21cc7b4e9c84e0cb64
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9d8bcaf6fae1bd82bc27ec09a2694497e6f6c4b4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40120
    reference_type:
    reference_id: CVE-2025-40120
