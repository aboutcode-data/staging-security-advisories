advisory_id: CVE-2024-26832
datasource_id: nvd_importer_v2/CVE-2024-26832
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26832
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm: zswap: fix missing folio cleanup in writeback race path

  In zswap_writeback_entry(), after we get a folio from
  __read_swap_cache_async(), we grab the tree lock again to check that the
  swap entry was not invalidated and recycled.  If it was, we delete the
  folio we just added to the swap cache and exit.

  However, __read_swap_cache_async() returns the folio locked when it is
  newly allocated, which is always true for this path, and the folio is
  ref'd.  Make sure to unlock and put the folio before returning.

  This was discovered by code inspection, probably because this path handles
  a race condition that should not happen often, and the bug would not crash
  the system, it will only strand the folio indefinitely.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26832
weaknesses:
  - CWE-459
references:
  - url: https://git.kernel.org/stable/c/14f1992430ef9e647b02aa8ca12c5bcb9a1dffea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6156277d1b26cb3fdb6fcbf0686ab78268571644
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e2891c763aa2cff74dd6b5e978411ccf0cf94abe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e3b63e966cac0bf78aaa1efede1827a252815a1d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.3.4:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.3.4:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26832
    reference_type:
    reference_id: CVE-2024-26832
