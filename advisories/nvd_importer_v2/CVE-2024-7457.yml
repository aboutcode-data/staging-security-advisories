advisory_id: CVE-2024-7457
datasource_id: nvd_importer_v2/CVE-2024-7457
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-7457
aliases: []
summary: The ws.stash.app.mac.daemon.helper tool contains a vulnerability caused by an incorrect
  use of macOSâ€™s authorization model. Instead of validating the client's authorization reference,
  the helper invokes AuthorizationCopyRights() using its own privileged context (root), effectively
  authorizing itself rather than the client. As a result, it grants the system.preferences.admin
  right internally, regardless of the requesting client's privileges. This flawed logic allows
  unprivileged clients to invoke privileged operations via XPC, including unauthorized changes
  to system-wide network preferences such as SOCKS, HTTP, and HTTPS proxy settings. The absence
  of proper code-signing checks further enables arbitrary processes to exploit this flaw, leading
  to man-in-the-middle (MITM) attacks through traffic redirection.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-7457
weaknesses:
  - CWE-863
references:
  - url: https://pentraze.com/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-7457
    reference_type:
    reference_id: CVE-2024-7457
