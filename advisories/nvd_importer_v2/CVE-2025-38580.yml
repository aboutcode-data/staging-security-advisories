advisory_id: CVE-2025-38580
datasource_id: nvd_importer_v2/CVE-2025-38580
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38580
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: fix inode use after free in ext4_end_io_rsv_work()

  In ext4_io_end_defer_completion(), check if io_end->list_vec is empty to
  avoid adding an io_end that requires no conversion to the
  i_rsv_conversion_list, which in turn prevents starting an unnecessary
  worker. An ext4_emergency_state() check is also added to avoid attempting
  to abort the journal in an emergency state.

  Additionally, ext4_put_io_end_defer() is refactored to call
  ext4_io_end_defer_completion() directly instead of being open-coded.
  This also prevents starting an unnecessary worker when EXT4_IO_END_FAILED
  is set but data_err=abort is not enabled.

  This ensures that the check in ext4_put_io_end_defer() is consistent with
  the check in ext4_end_bio(). Otherwise, we might add an io_end to the
  i_rsv_conversion_list and then call ext4_finish_bio(), after which the
  inode could be freed before ext4_end_io_rsv_work() is called, triggering
  a use-after-free issue.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38580
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/469c44e66e2110054949609dde095788320139d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac999862b98a0f49e858e509f776be51406f1e77
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c678bdc998754589cea2e6afab9401d7d8312ac4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38580
    reference_type:
    reference_id: CVE-2025-38580
