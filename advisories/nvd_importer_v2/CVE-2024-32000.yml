advisory_id: CVE-2024-32000
datasource_id: nvd_importer_v2/CVE-2024-32000
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-32000
aliases: []
summary: matrix-appservice-irc is a Node.js IRC bridge for the Matrix messaging protocol. matrix-appservice-irc
  before version 2.0.0 can be exploited to leak the truncated body of a message if a malicious
  user sends a Matrix reply to an event ID they don't have access to. As a precondition to the
  attack, the malicious user needs to know the event ID of the message they want to leak, as
  well as to be joined to both the Matrix room and the IRC channel it is bridged to. The message
  reply containing the leaked message content is visible to IRC channel members when this happens.
  matrix-appservice-irc 2.0.0 checks whether the user has permission to view an event before
  constructing a reply. Administrators should upgrade to this version. It's possible to limit
  the amount of information leaked by setting a reply template that doesn't contain the original
  message. See these lines `601-604` in the configuration file linked.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-32000
weaknesses:
  - CWE-280
  - CWE-755
references:
  - url: https://github.com/matrix-org/matrix-appservice-irc/blob/d5d67d1d3ea3f0f6962a0af2cc57b56af3ad2129/config.sample.yaml#L601-L604
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/pull/1799
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-wm4w-7h2q-3pf7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32000
    reference_type:
    reference_id: CVE-2024-32000
