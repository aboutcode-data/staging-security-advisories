advisory_id: CVE-2022-50567
datasource_id: nvd_importer_v2/CVE-2022-50567
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50567
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fs: jfs: fix shift-out-of-bounds in dbAllocAG

  Syzbot found a crash : UBSAN: shift-out-of-bounds in dbAllocAG. The
  underlying bug is the missing check of bmp->db_agl2size. The field can
  be greater than 64 and trigger the shift-out-of-bounds.

  Fix this bug by adding a check of bmp->db_agl2size in dbMount since this
  field is used in many following functions. The upper bound for this
  field is L2MAXL2SIZE - L2MAXAG, thanks for the help of Dave Kleikamp.
  Note that, for maintenance, I reorganized error handling code of dbMount.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0536f76a2bca83d1a3740517ba22cc93a44b3099
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2c575c8905f7a8b32d5611b91856b69bac2a5bf1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3115313cf03113e87c87adee18ee49a20bbdb9ba
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/359616ce587e524107730504891afa4b1a8be58c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3e997e4ce8ae7ab89d72334120f6aee49c5bbdbd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/67973caae78e21ee46a7281aaa8ca364eb9c444f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/898f706695682b9954f280d95e49fa86ffa55d08
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d3b486946a4e62c7ef6023f7d9c1d049051384ba
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eea87acb6027be3dd4d3c57186bb22800d57fdda
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50567
    reference_type:
    reference_id: CVE-2022-50567
