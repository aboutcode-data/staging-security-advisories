advisory_id: CVE-2020-15137
datasource_id: nvd_importer_v2/CVE-2020-15137
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2020-15137
aliases: []
summary: All versions of HoRNDIS are affected by an integer overflow in the RNDIS packet parsing
  routines. A malicious USB device can trigger disclosure of unrelated kernel memory to userspace
  applications on the host, or can cause the kernel to crash. Kernel memory disclosure is especially
  likely on 32-bit kernels; 64-bit kernels are more likely to crash on attempted exploitation.
  It is not believed that kernel memory corruption is possible, or that unattended kernel memory
  disclosure without the collaboration of a userspace program running on the host is possible.
  The vulnerability is in `HoRNDIS::receivePacket`. `msg_len`, `data_ofs`, and `data_len` can
  be controlled by an attached USB device, and a negative value of `data_ofs` can bypass the
  check for `(data_ofs + data_len + 8) > msg_len`, and subsequently can cause a wild pointer
  copy in the `mbuf_copyback` call. The software is not maintained and no patches are planned.
  Users of multi-tenant systems with HoRNDIS installed should only connect trusted USB devices
  to their system.
impacted_packages: []
severities:
  - score: '3.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15137
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:P/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15137
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:P/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15137
weaknesses:
  - CWE-190
references:
  - url: https://github.com/jwise/HoRNDIS/security/advisories/GHSA-8q4r-m3rh-57jx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:horndis_project:horndis:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:horndis_project:horndis:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15137
    reference_type:
    reference_id: CVE-2020-15137
