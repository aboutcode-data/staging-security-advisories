advisory_id: CVE-2023-52981
datasource_id: nvd_importer_v2/CVE-2023-52981
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-52981
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/i915: Fix request ref counting during error capture & debugfs dump

  When GuC support was added to error capture, the reference counting
  around the request object was broken. Fix it up.

  The context based search manages the spinlocking around the search
  internally. So it needs to grab the reference count internally as
  well. The execlist only request based search relies on external
  locking, so it needs an external reference count but within the
  spinlock not outside it.

  The only other caller of the context based search is the code for
  dumping engine state to debugfs. That code wasn't previously getting
  an explicit reference at all as it does everything while holding the
  execlist specific spinlock. So, that needs updaing as well as that
  spinlock doesn't help when using GuC submission. Rather than trying to
  conditionally get/put depending on submission model, just change it to
  always do the get/put.

  v2: Explicitly document adding an extra blank line in some dense code
  (Andy Shevchenko). Fix multiple potential null pointer derefs in case
  of no request found (some spotted by Tvrtko, but there was more!).
  Also fix a leaked request in case of !started and another in
  __guc_reset_context now that intel_context_find_active_request is
  actually reference counting the returned request.
  v3: Add a _get suffix to intel_context_find_active_request now that it
  grabs a reference (Daniele).
  v4: Split the intel_guc_find_hung_context change to a separate patch
  and rename intel_context_find_active_request_get to
  intel_context_get_active_request (Tvrtko).
  v5: s/locking/reference counting/ in commit message (Tvrtko)

  (cherry picked from commit 3700e353781e27f1bc7222f51f2cc36cbeb9b4ec)
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52981
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/86d8ddc74124c3fdfc139f246ba6da15e45e86e3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9467397f417dd7b5d0db91452f0474e79716a527
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52981
    reference_type:
    reference_id: CVE-2023-52981
