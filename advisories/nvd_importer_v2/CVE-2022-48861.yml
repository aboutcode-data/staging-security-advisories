advisory_id: CVE-2022-48861
datasource_id: nvd_importer_v2/CVE-2022-48861
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-48861
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  vdpa: fix use-after-free on vp_vdpa_remove

  When vp_vdpa driver is unbind, vp_vdpa is freed in vdpa_unregister_device
  and then vp_vdpa->mdev.pci_dev is dereferenced in vp_modern_remove,
  triggering use-after-free.

  Call Trace of unbinding driver free vp_vdpa :
  do_syscall_64
    vfs_write
      kernfs_fop_write_iter
        device_release_driver_internal
          pci_device_remove
            vp_vdpa_remove
              vdpa_unregister_device
                kobject_release
                  device_release
                    kfree

  Call Trace of dereference vp_vdpa->mdev.pci_dev:
  vp_modern_remove
    pci_release_selected_regions
      pci_release_region
        pci_resource_len
          pci_resource_end
            (dev)->resource[(bar)].end
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48861
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/4b1743bc715a3691a63ac21b349079b07bf1b19e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dc54ba9932aeaaa1a21fe214af1f446593a78274
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eb057b44dbe35ae14527830236a92f51de8f9184
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48861
    reference_type:
    reference_id: CVE-2022-48861
