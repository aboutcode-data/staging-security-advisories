advisory_id: CVE-2025-38648
datasource_id: nvd_importer_v2/CVE-2025-38648
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38648
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  spi: stm32: Check for cfg availability in stm32_spi_probe

  The stm32_spi_probe function now includes a check to ensure that the
  pointer returned by of_device_get_match_data is not NULL before
  accessing its members. This resolves a warning where a potential NULL
  pointer dereference could occur when accessing cfg->has_device_mode.

  Before accessing the 'has_device_mode' member, we verify that 'cfg' is
  not NULL. If 'cfg' is NULL, an error message is logged.

  This change ensures that the driver does not attempt to access
  configuration data if it is not available, thus preventing a potential
  system crash due to a NULL pointer dereference.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38648
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/21f1c800f6620e43f31dfd76709dbac8ebaa5a16
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3a571a8d52272cc26858ab1bc83d0f66e5dee938
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6031a54f4eac921efe6122a561d44df89b37f2d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a7645815edf4478f3258bb0db95a08986a77f5c0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cc063d23ad80ef7d201c41b2716b1bae7c662cf9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38648
    reference_type:
    reference_id: CVE-2025-38648
