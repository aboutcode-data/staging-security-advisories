advisory_id: CVE-2025-39855
datasource_id: nvd_importer_v2/CVE-2025-39855
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39855
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ice: fix NULL access of tx->in_use in ice_ptp_ts_irq

  The E810 device has support for a "low latency" firmware interface to
  access and read the Tx timestamps. This interface does not use the standard
  Tx timestamp logic, due to the latency overhead of proxying sideband
  command requests over the firmware AdminQ.

  The logic still makes use of the Tx timestamp tracking structure,
  ice_ptp_tx, as it uses the same "ready" bitmap to track which Tx
  timestamps complete.

  Unfortunately, the ice_ptp_ts_irq() function does not check if the tracker
  is initialized before its first access. This results in NULL dereference or
  use-after-free bugs similar to the following:

  [245977.278756] BUG: kernel NULL pointer dereference, address: 0000000000000000
  [245977.278774] RIP: 0010:_find_first_bit+0x19/0x40
  [245977.278796] Call Trace:
  [245977.278809]  ? ice_misc_intr+0x364/0x380 [ice]

  This can occur if a Tx timestamp interrupt races with the driver reset
  logic.

  Fix this by only checking the in_use bitmap (and other fields) if the
  tracker is marked as initialized. The reset flow will clear the init field
  under lock before it tears the tracker down, thus preventing any
  use-after-free or NULL access.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39855
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/1467a873b20110263cc9c93de99335d139c11e16
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/403bf043d9340196e06769065169df7444b91f7a
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39855
    reference_type:
    reference_id: CVE-2025-39855
