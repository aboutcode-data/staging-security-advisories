advisory_id: CVE-2024-52595
datasource_id: nvd_importer_v2/CVE-2024-52595
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-52595
aliases: []
summary: lxml_html_clean is a project for HTML cleaning functionalities copied from `lxml.html.clean`.
  Prior to version 0.4.0, the HTML Parser in lxml does not properly handle context-switching
  for special HTML tags such as `<svg>`, `<math>` and `<noscript>`. This behavior deviates from
  how web browsers parse and interpret such tags. Specifically, content in CSS comments is ignored
  by lxml_html_clean but may be interpreted differently by web browsers, enabling malicious
  scripts to bypass the cleaning process. This vulnerability could lead to Cross-Site Scripting
  (XSS) attacks, compromising the security of users relying on lxml_html_clean in default configuration
  for sanitizing untrusted HTML content. Users employing the HTML cleaner in a security-sensitive
  context should upgrade to lxml 0.4.0, which addresses this issue. As a temporary mitigation,
  users can configure lxml_html_clean with the following settings to prevent the exploitation
  of this vulnerability. Via `remove_tags`, one may specify tags to remove - their content is
  moved to their parents' tags. Via `kill_tags`, one may specify tags to be removed completely.
  Via `allow_tags`, one may restrict the set of permissible tags, excluding context-switching
  tags like `<svg>`, `<math>` and `<noscript>`.
impacted_packages: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-52595
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-52595
weaknesses:
  - CWE-184
  - CWE-83
  - CWE-79
references:
  - url: https://github.com/fedora-python/lxml_html_clean/commit/c5d816f86eb3707d72a8ecf5f3823e0daa1b3808
    reference_type:
    reference_id:
  - url: https://github.com/fedora-python/lxml_html_clean/pull/19
    reference_type:
    reference_id:
  - url: https://github.com/fedora-python/lxml_html_clean/security/advisories/GHSA-5jfw-gq64-q45f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:fedoralovespython:lxml_html_clean:*:*:*:*:*:python:*:*
    reference_type:
    reference_id: cpe:2.3:a:fedoralovespython:lxml_html_clean:*:*:*:*:*:python:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-52595
    reference_type:
    reference_id: CVE-2024-52595
