advisory_id: CVE-2023-53717
datasource_id: nvd_importer_v2/CVE-2023-53717
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53717
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: ath9k: Fix potential stack-out-of-bounds write in ath9k_wmi_rsp_callback()

  Fix a stack-out-of-bounds write that occurs in a WMI response callback
  function that is called after a timeout occurs in ath9k_wmi_cmd().
  The callback writes to wmi->cmd_rsp_buf, a stack-allocated buffer that
  could no longer be valid when a timeout occurs. Set wmi->last_seq_id to
  0 when a timeout occurred.

  Found by a modified version of syzkaller.

  BUG: KASAN: stack-out-of-bounds in ath9k_wmi_ctrl_rx
  Write of size 4
  Call Trace:
   memcpy
   ath9k_wmi_ctrl_rx
   ath9k_htc_rx_msg
   ath9k_hif_usb_reg_in_cb
   __usb_hcd_giveback_urb
   usb_hcd_giveback_urb
   dummy_timer
   call_timer_fn
   run_timer_softirq
   __do_softirq
   irq_exit_rcu
   sysvec_apic_timer_interrupt
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1af7eacfad45149c54893a8a9df9e92ef89f0a90
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/554048a72d7ecfdd58cc1bfb56e0a1864e64e82c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/78b56b0a613a87b61290b95be497fdfe2fe58aa6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/89a33c3c847b19b19205cde1d924df2a6c70d8eb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8a2f35b9830692f7a616f2f627f943bc748af13a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8f28513d9520184059530c01a9f928a1b3809d3f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ae4933b4f17de8e2b7ff6f91b17d3b0099a6d6bc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bf6dc175a2b53098a69db1236d9d53982f4b1bc0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53717
    reference_type:
    reference_id: CVE-2023-53717
