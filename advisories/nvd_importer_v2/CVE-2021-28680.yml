advisory_id: CVE-2021-28680
datasource_id: nvd_importer_v2/CVE-2021-28680
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-28680
aliases: []
summary: The devise_masquerade gem before 1.3 allows certain attacks when a password's salt
  is unknown. An application that uses this gem to let administrators masquerade/impersonate
  users loses one layer of security protection compared to a situation where Devise (without
  this extension) is used. If the server-side secret_key_base value became publicly known (for
  instance if it is committed to a public repository by mistake), there are still other protections
  in place that prevent an attacker from impersonating any user on the site. When masquerading
  is not used in a plain Devise application, one must know the password salt of the target user
  if one wants to encrypt and sign a valid session cookie. When devise_masquerade is used, however,
  an attacker can decide which user the "back" action will go back to without knowing that user's
  password salt and simply knowing the user ID, by manipulating the session cookie and pretending
  that a user is already masqueraded by an administrator.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-28680
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-28680
weaknesses: []
references:
  - url: https://github.com/oivoodoo/devise_masquerade/issues/83
    reference_type:
    reference_id:
  - url: https://labanskoller.se/blog/2021/03/23/the-devise-extension-that-peeled-off-one-layer-of-the-security-onion-cve-2021-28680/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:devise_masquerade_project:devise_masquerade:*:*:*:*:*:ruby:*:*
    reference_type:
    reference_id: cpe:2.3:a:devise_masquerade_project:devise_masquerade:*:*:*:*:*:ruby:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28680
    reference_type:
    reference_id: CVE-2021-28680
