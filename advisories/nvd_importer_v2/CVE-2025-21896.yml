advisory_id: CVE-2025-21896
datasource_id: nvd_importer_v2/CVE-2025-21896
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21896
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fuse: revert back to __readahead_folio() for readahead

  In commit 3eab9d7bc2f4 ("fuse: convert readahead to use folios"), the
  logic was converted to using the new folio readahead code, which drops
  the reference on the folio once it is locked, using an inferred
  reference on the folio. Previously we held a reference on the folio for
  the entire duration of the readpages call.

  This is fine, however for the case for splice pipe responses where we
  will remove the old folio and splice in the new folio (see
  fuse_try_move_page()), we assume that there is a reference held on the
  folio for ap->folios, which is no longer the case.

  To fix this, revert back to __readahead_folio() which allows us to hold
  the reference on the folio for the duration of readpages until either we
  drop the reference ourselves in fuse_readpages_end() or the reference is
  dropped after it's replaced in the page cache in the splice case.
  This will fix the UAF bug that was reported.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21896
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/0c67c37e1710b2a8f61c8a02db95a51fe577e2c1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/60db11f1b7fba4a66b117ea998d965818784a98d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21896
    reference_type:
    reference_id: CVE-2025-21896
