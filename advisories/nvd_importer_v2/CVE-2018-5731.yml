advisory_id: CVE-2018-5731
datasource_id: nvd_importer_v2/CVE-2018-5731
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2018-5731
aliases: []
summary: 'An issue was discovered in Heimdal PRO 2.2.190. As part of the scanning feature, a
  process called md.hs writes an executable called CS1.tmp to C:\windows\TEMP. Afterwards the
  executable is run. It is possible for an attacker to create the file first, let md.hs overwrite
  it, and then rewrite the file in the window between md.hs closing the file and executing it.
  This can be exploited via opportunistic locks and a high priority thread. The vulnerability
  is triggered when a scan starts. NOTE: any affected Heimdal products are completely unrelated
  to the Heimdal vendor of a Kerberos 5 product on the h5l.org web site.'
impacted_packages: []
severities:
  - score: '4.4'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-5731
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-5731
weaknesses:
  - CWE-20
references:
  - url: https://improsec.com/blog/heimdal-advisory-2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:heimdalsecurity:heimdal:2.2.190:*:*:*:pro:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:heimdalsecurity:heimdal:2.2.190:*:*:*:pro:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-5731
    reference_type:
    reference_id: CVE-2018-5731
