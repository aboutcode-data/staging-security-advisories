advisory_id: CVE-2021-29460
datasource_id: nvd_importer_v2/CVE-2021-29460
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-29460
aliases: []
summary: Kirby is an open source CMS. An editor with write access to the Kirby Panel can upload
  an SVG file that contains harmful content like `<script>` tags. The direct link to that file
  can be sent to other users or visitors of the site. If the victim opens that link in a browser
  where they are logged in to Kirby, the script will run and can for example trigger requests
  to Kirby's API with the permissions of the victim. This vulnerability is critical if you might
  have potential attackers in your group of authenticated Panel users, as they can escalate
  their privileges if they get access to the Panel session of an admin user. Depending on your
  site, other JavaScript-powered attacks are possible. Visitors without Panel access can only
  use this attack vector if your site allows SVG file uploads in frontend forms and you don't
  already sanitize uploaded SVG files. The problem has been patched in Kirby 3.5.4. Please update
  to this or a later version to fix the vulnerability. Frontend upload forms need to be patched
  separately depending on how they store the uploaded file(s). If you use `File::create()`,
  you are protected by updating to 3.5.4+. As a work around you can disable the upload of SVG
  files in your file blueprints.
impacted_packages: []
severities:
  - score: '3.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29460
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29460
  - score: '7.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29460
weaknesses:
  - CWE-79
references:
  - url: http://packetstormsecurity.com/files/162359/Kirby-CMS-3.5.3.1-Cross-Site-Scripting.html
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.5.4
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/security/advisories/GHSA-qgp4-5qx6-548g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:getkirby:kirby:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:getkirby:kirby:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29460
    reference_type:
    reference_id: CVE-2021-29460
