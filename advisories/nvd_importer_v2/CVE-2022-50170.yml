advisory_id: CVE-2022-50170
datasource_id: nvd_importer_v2/CVE-2022-50170
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50170
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  kunit: executor: Fix a memory leak on failure in kunit_filter_tests

  It's possible that memory allocation for 'filtered' will fail, but for the
  copy of the suite to succeed. In this case, the copy could be leaked.

  Properly free 'copy' in the error case for the allocation of 'filtered'
  failing.

  Note that there may also have been a similar issue in
  kunit_filter_subsuites, before it was removed in "kunit: flatten
  kunit_suite*** to kunit_suite** in .kunit_test_suites".

  This was reported by clang-analyzer via the kernel test robot, here:
  https://lore.kernel.org/all/c8073b8e-7b9e-0830-4177-87c12f16349c@intel.com/

  And by smatch via Dan Carpenter and the kernel test robot:
  https://lore.kernel.org/all/202207101328.ASjx88yj-lkp@intel.com/
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50170
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/7d69764fa3442c7615a75c6b5c02eaa1f274bccf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/94681e289bf5d10c9db9db143d1a22d8717205c5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a8a7e3ced362b88b659ab54239990196ff975982
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50170
    reference_type:
    reference_id: CVE-2022-50170
