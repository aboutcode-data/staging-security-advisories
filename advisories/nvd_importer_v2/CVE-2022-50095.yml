advisory_id: CVE-2022-50095
datasource_id: nvd_importer_v2/CVE-2022-50095
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50095
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  posix-cpu-timers: Cleanup CPU timers before freeing them during exec

  Commit 55e8c8eb2c7b ("posix-cpu-timers: Store a reference to a pid not a
  task") started looking up tasks by PID when deleting a CPU timer.

  When a non-leader thread calls execve, it will switch PIDs with the leader
  process. Then, as it calls exit_itimers, posix_cpu_timer_del cannot find
  the task because the timer still points out to the old PID.

  That means that armed timers won't be disarmed, that is, they won't be
  removed from the timerqueue_list. exit_itimers will still release their
  memory, and when that list is later processed, it leads to a
  use-after-free.

  Clean up the timers from the de-threaded task before freeing them. This
  prevents a reported use-after-free.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50095
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/541840859ace9c2ccebc32fa9e376c7bd3def490
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e255ed238fc67058df87b0388ad6d4b2ef3a2bd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b2fc1723eb65abb83e00d5f011de670296af0b28
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e362359ace6f87c201531872486ff295df306d13
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e8cb6e8fd9890780f1bfcf5592889e1b879e779c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50095
    reference_type:
    reference_id: CVE-2022-50095
