advisory_id: CVE-2024-42233
datasource_id: nvd_importer_v2/CVE-2024-42233
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-42233
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nfilemap: replace\
  \ pte_offset_map() with pte_offset_map_nolock()\n\nThe vmf->ptl in filemap_fault_recheck_pte_none()\
  \ is still set from\nhandle_pte_fault().  But at the same time, we did a pte_unmap(vmf->pte).\
  \ \nAfter a pte_unmap(vmf->pte) unmap and rcu_read_unlock(), the page table\nmay be racily\
  \ changed and vmf->ptl maybe fails to protect the actual page\ntable.  Fix this by replacing\
  \ pte_offset_map() with\npte_offset_map_nolock().\n\nAs David said, the PTL pointer might\
  \ be stale so if we continue to use\nit infilemap_fault_recheck_pte_none(), it might trigger\
  \ UAF.  Also, if\nthe PTL fails, the issue fixed by commit 58f327f2ce80 (\"filemap: avoid\n\
  unnecessary major faults in filemap_fault()\") might reappear."
impacted_packages: []
severities:
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42233
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/24be02a42181f0707be0498045c4c4b13273b16d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6a6c2aec1a89506595801b4cf7e8eef035f33748
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42233
    reference_type:
    reference_id: CVE-2024-42233
