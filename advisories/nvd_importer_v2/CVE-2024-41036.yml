advisory_id: CVE-2024-41036
datasource_id: nvd_importer_v2/CVE-2024-41036
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-41036
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: ks8851: Fix deadlock with the SPI chip variant

  When SMP is enabled and spinlocks are actually functional then there is
  a deadlock with the 'statelock' spinlock between ks8851_start_xmit_spi
  and ks8851_irq:

      watchdog: BUG: soft lockup - CPU#0 stuck for 27s!
      call trace:
        queued_spin_lock_slowpath+0x100/0x284
        do_raw_spin_lock+0x34/0x44
        ks8851_start_xmit_spi+0x30/0xb8
        ks8851_start_xmit+0x14/0x20
        netdev_start_xmit+0x40/0x6c
        dev_hard_start_xmit+0x6c/0xbc
        sch_direct_xmit+0xa4/0x22c
        __qdisc_run+0x138/0x3fc
        qdisc_run+0x24/0x3c
        net_tx_action+0xf8/0x130
        handle_softirqs+0x1ac/0x1f0
        __do_softirq+0x14/0x20
        ____do_softirq+0x10/0x1c
        call_on_irq_stack+0x3c/0x58
        do_softirq_own_stack+0x1c/0x28
        __irq_exit_rcu+0x54/0x9c
        irq_exit_rcu+0x10/0x1c
        el1_interrupt+0x38/0x50
        el1h_64_irq_handler+0x18/0x24
        el1h_64_irq+0x64/0x68
        __netif_schedule+0x6c/0x80
        netif_tx_wake_queue+0x38/0x48
        ks8851_irq+0xb8/0x2c8
        irq_thread_fn+0x2c/0x74
        irq_thread+0x10c/0x1b0
        kthread+0xc8/0xd8
        ret_from_fork+0x10/0x20

  This issue has not been identified earlier because tests were done on
  a device with SMP disabled and so spinlocks were actually NOPs.

  Now use spin_(un)lock_bh for TX queue related locking to avoid execution
  of softirq work synchronously that would lead to a deadlock.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41036
weaknesses:
  - CWE-667
references:
  - url: https://git.kernel.org/stable/c/0913ec336a6c0c4a2b296bd9f74f8e41c4c83c8c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/10fec0cd0e8f56ff06c46bb24254c7d8f8f2bbf0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/80ece00137300d74642f2038c8fe5440deaf9f05
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a0c69c492f4a8fad52f0a97565241c926160c9a4
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41036
    reference_type:
    reference_id: CVE-2024-41036
