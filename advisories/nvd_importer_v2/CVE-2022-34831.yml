advisory_id: CVE-2022-34831
datasource_id: nvd_importer_v2/CVE-2022-34831
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-34831
aliases: []
summary: An issue was discovered in Keyfactor PrimeKey EJBCA before 7.9.0, related to possible
  inconsistencies in DNS identifiers submitted in an ACME order and the corresponding CSR submitted
  during finalization. During the ACME enrollment process, an order is submitted containing
  an identifier for one or multiple dnsNames. These are validated properly in the ACME challenge.
  However, if the validation passes, a non-compliant client can include additional dnsNames
  the CSR sent to the finalize endpoint, resulting in EJBCA issuing a certificate including
  the identifiers that were not validated. This occurs even if the certificate profile is configured
  to not allow a DN override by the CSR.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-34831
weaknesses:
  - CWE-295
references:
  - url: https://support.keyfactor.com/s/detail/a6x1Q000000CwC5QAK
    reference_type:
    reference_id:
  - url: https://www.primekey.com/products/ejbca-enterprise/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:primekey:ejbca:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:primekey:ejbca:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-34831
    reference_type:
    reference_id: CVE-2022-34831
