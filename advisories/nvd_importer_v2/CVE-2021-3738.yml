advisory_id: CVE-2021-3738
datasource_id: nvd_importer_v2/CVE-2021-3738
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-3738
aliases: []
summary: In DCE/RPC it is possible to share the handles (cookies for resource state) between
  multiple connections via a mechanism called 'association groups'. These handles can reference
  connections to our sam.ldb database. However while the database was correctly shared, the
  user credentials state was only pointed at, and when one connection within that association
  group ended, the database would be left pointing at an invalid 'struct session_info'. The
  most likely outcome here is a crash, but it is possible that the use-after-free could instead
  allow different user state to be pointed at and this might allow more privileged access.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3738
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3738
weaknesses:
  - CWE-416
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2021726
    reference_type:
    reference_id:
  - url: https://bugzilla.samba.org/show_bug.cgi?id=14468
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202309-06
    reference_type:
    reference_id:
  - url: https://www.samba.org/samba/security/CVE-2021-3738.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3738
    reference_type:
    reference_id: CVE-2021-3738
