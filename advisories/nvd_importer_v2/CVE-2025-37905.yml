advisory_id: CVE-2025-37905
datasource_id: nvd_importer_v2/CVE-2025-37905
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37905
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  firmware: arm_scmi: Balance device refcount when destroying devices

  Using device_find_child() to lookup the proper SCMI device to destroy
  causes an unbalance in device refcount, since device_find_child() calls an
  implicit get_device(): this, in turns, inhibits the call of the provided
  release methods upon devices destruction.

  As a consequence, one of the structures that is not freed properly upon
  destruction is the internal struct device_private dev->p populated by the
  drivers subsystem core.

  KMemleak detects this situation since loading/unloding some SCMI driver
  causes related devices to be created/destroyed without calling any
  device_release method.

  unreferenced object 0xffff00000f583800 (size 512):
    comm "insmod", pid 227, jiffies 4294912190
    hex dump (first 32 bytes):
      00 00 00 00 ad 4e ad de ff ff ff ff 00 00 00 00  .....N..........
      ff ff ff ff ff ff ff ff 60 36 1d 8a 00 80 ff ff  ........`6......
    backtrace (crc 114e2eed):
      kmemleak_alloc+0xbc/0xd8
      __kmalloc_cache_noprof+0x2dc/0x398
      device_add+0x954/0x12d0
      device_register+0x28/0x40
      __scmi_device_create.part.0+0x1bc/0x380
      scmi_device_create+0x2d0/0x390
      scmi_create_protocol_devices+0x74/0xf8
      scmi_device_request_notifier+0x1f8/0x2a8
      notifier_call_chain+0x110/0x3b0
      blocking_notifier_call_chain+0x70/0xb0
      scmi_driver_register+0x350/0x7f0
      0xffff80000a3b3038
      do_one_initcall+0x12c/0x730
      do_init_module+0x1dc/0x640
      load_module+0x4b20/0x5b70
      init_module_from_file+0xec/0x158

  $ ./scripts/faddr2line ./vmlinux device_add+0x954/0x12d0
  device_add+0x954/0x12d0:
  kmalloc_noprof at include/linux/slab.h:901
  (inlined by) kzalloc_noprof at include/linux/slab.h:1037
  (inlined by) device_private_init at drivers/base/core.c:3510
  (inlined by) device_add at drivers/base/core.c:3561

  Balance device refcount by issuing a put_device() on devices found via
  device_find_child().
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37905
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/2fbf6c9695ad9f05e7e5c166bf43fac7cb3276b3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8a8a3547d5c4960da053df49c75bf623827a25da
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/91ff1e9652fb9beb0174267d6bb38243dff211bb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/969d8beaa2e374387bf9aa5602ef84fc50bb48d8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ca67840c0ddf3f39407339624cef824a4f27599
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff4273d47da81b95ed9396110bcbd1b7b7470fe8
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/08/msg00010.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37905
    reference_type:
    reference_id: CVE-2025-37905
