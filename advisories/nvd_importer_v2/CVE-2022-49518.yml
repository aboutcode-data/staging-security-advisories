advisory_id: CVE-2022-49518
datasource_id: nvd_importer_v2/CVE-2022-49518
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49518
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ASoC: SOF: ipc3-topology: Correct get_control_data for non bytes payload

  It is possible to craft a topology where sof_get_control_data() would do
  out of bounds access because it expects that it is only called when the
  payload is bytes type.
  Confusingly it also handles other types of controls, but the payload
  parsing implementation is only valid for bytes.

  Fix the code to count the non bytes controls and instead of storing a
  pointer to sof_abi_hdr in sof_widget_data (which is only valid for bytes),
  store the pointer to the data itself and add a new member to save the size
  of the data.

  In case of non bytes controls we store the pointer to the chanv itself,
  which is just an array of values at the end.

  In case of bytes control, drop the wrong cdata->data (wdata[i].pdata) check
  against NULL since it is incorrect and invalid in this context.
  The data is pointing to the end of cdata struct, so it should never be
  null.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49518
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/896b03bb7c7010042786cfae2115083d4c241dd3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a962890a5a3cce903ff7c7a19fadee63ed9efdc7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49518
    reference_type:
    reference_id: CVE-2022-49518
