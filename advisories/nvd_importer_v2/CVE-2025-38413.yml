advisory_id: CVE-2025-38413
datasource_id: nvd_importer_v2/CVE-2025-38413
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38413
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nvirtio-net:\
  \ xsk: rx: fix the frame's length check\n\nWhen calling buf_to_xdp, the len argument is the\
  \ frame data's length\nwithout virtio header's length (vi->hdr_len). We check that len with\n\
  \n\txsk_pool_get_rx_frame_size() + vi->hdr_len\n\nto ensure the provided len does not larger\
  \ than the allocated chunk\nsize. The additional vi->hdr_len is because in virtnet_add_recvbuf_xsk,\n\
  we use part of XDP_PACKET_HEADROOM for virtio header and ask the vhost\nto start placing data\
  \ from\n\n\thard_start + XDP_PACKET_HEADROOM - vi->hdr_len\nnot\n\thard_start + XDP_PACKET_HEADROOM\n\
  \nBut the first buffer has virtio_header, so the maximum frame's length in\nthe first buffer\
  \ can only be\n\n\txsk_pool_get_rx_frame_size()\nnot\n\txsk_pool_get_rx_frame_size() + vi->hdr_len\n\
  \nlike in the current check.\n\nThis commit adds an additional argument to buf_to_xdp differentiate\n\
  between the first buffer and other ones to correctly calculate the maximum\nframe's length."
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38413
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/5177373c31318c3c6a190383bfd232e6cf565c36
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6013bb6bc24c2cac3f45b37a15b71b232a5b00ff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/892f6ed9a4a38bb3360fdff091b9241cfa105b61
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38413
    reference_type:
    reference_id: CVE-2025-38413
