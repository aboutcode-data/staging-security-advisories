advisory_id: CVE-2021-24105
datasource_id: nvd_importer_v2/CVE-2021-24105
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-24105
aliases: []
summary: |
  <p>Depending on configuration of various package managers it is possible for an attacker to insert a malicious package into a package manager's repository which can be retrieved and used during development, build, and release processes. This insertion could lead to remote code execution. We believe this vulnerability affects multiple package managers across multiple languages, including but not limited to: Python/pip, .NET/NuGet, Java/Maven, JavaScript/npm.</p>
  <p><strong>Attack scenarios</strong></p>
  <p>An attacker could take advantage of this ecosystem-wide issue to cause harm in a variety of ways. The original attack scenarios were discovered by Alex Birsan and are detailed in their whitepaper, <a href="https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610">Dependency Confusion: How I Hacked Into Apple, Microsoft and Dozens of Other Companies</a>.</p>
  <ul>
  <li><p>With basic knowledge of the target ecosystems, an attacker could create an empty shell for a package and insert malicious code in the install scripts, give it a high version, and publish it to the public repository. Vulnerable victim machines will download the higher version of the package between the public and private repositories and attempt to install it. Due to code incompatibility it will probably error out upon import or upon compilation, making it easier to detect; however the attacker would have gained code execution by that point.</p>
  </li>
  <li><p>An advanced attacker with some inside knowledge of the target could take a copy of a working package, insert the malicious code (in the package itself or in the install), and then publish it to a public repository. The package will likely install and import correctly, granting the attacker an initial foothold and persistence.</p>
  </li>
  </ul>
  <p>These two methods could affect target organizations at any of these various levels:</p>
  <ul>
  <li>Developer machines</li>
  <li>An entire team if the configuration to import the malicious package is uploaded to a code repository</li>
  <li>Continuous integration pipelines if they pull the malicious packages during the build, test, and/or deploy stages</li>
  <li>Customers, download servers, production services if the malicious code has not been detected</li>
  </ul>
  <p>This remote code execution vulnerability can only be addressed by reconfiguring installation tools and workflows, and not by correcting anything in the package repositories themselves. See the <strong>FAQ</strong> section of this CVE for configuration guidance.</p>
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-24105
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-24105
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-24105
weaknesses: []
references:
  - url: https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-24105
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:microsoft:package_manager_configurations:-:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:microsoft:package_manager_configurations:-:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-24105
    reference_type:
    reference_id: CVE-2021-24105
