advisory_id: CVE-2025-21777
datasource_id: nvd_importer_v2/CVE-2025-21777
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21777
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ring-buffer: Validate the persistent meta data subbuf array

  The meta data for a mapped ring buffer contains an array of indexes of all
  the subbuffers. The first entry is the reader page, and the rest of the
  entries lay out the order of the subbuffers in how the ring buffer link
  list is to be created.

  The validator currently makes sure that all the entries are within the
  range of 0 and nr_subbufs. But it does not check if there are any
  duplicates.

  While working on the ring buffer, I corrupted this array, where I added
  duplicates. The validator did not catch it and created the ring buffer
  link list on top of it. Luckily, the corruption was only that the reader
  page was also in the writer path and only presented corrupted data but did
  not crash the kernel. But if there were duplicates in the writer side,
  then it could corrupt the ring buffer link list and cause a crash.

  Create a bitmask array with the size of the number of subbuffers. Then
  clear it. When walking through the subbuf array checking to see if the
  entries are within the range, test if its bit is already set in the
  subbuf_mask. If it is, then there is duplicates and fail the validation.
  If not, set the corresponding bit and continue.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21777
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0d547a6f5e8fad26ebc12f501d7d19fccdbad6bf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3ec743d558f111d8999aea24577ba66c65ee2eeb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f5b95f1fa2ef3a03f49eeec658ba97e721412b32
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21777
    reference_type:
    reference_id: CVE-2025-21777
