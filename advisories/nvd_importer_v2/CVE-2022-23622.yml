advisory_id: CVE-2022-23622
datasource_id: nvd_importer_v2/CVE-2022-23622
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-23622
aliases: []
summary: 'XWiki Platform is a generic wiki platform offering runtime services for applications
  built on top of it. In affected versions there is a cross site scripting (XSS) vector in the
  `registerinline.vm` template related to the `xredirect` hidden field. This template is only
  used in the following conditions: 1. The wiki must be open to registration for anyone. 2.
  The wiki must be closed to view for Guest users or more specifically the XWiki.Registration
  page must be forbidden in View for guest user. A way to obtain the second condition is when
  administrators checked the "Prevent unregistered users from viewing pages, regardless of the
  page rights" box in the administration rights. This issue is patched in versions 12.10.11,
  14.0-rc-1, 13.4.7, 13.10.3. There are two main ways for protecting against this vulnerability,
  the easiest and the best one is by applying a patch in the `registerinline.vm` template, the
  patch consists in checking the value of the xredirect field to ensure it matches: `<input
  type="hidden" name="xredirect" value="$escapetool.xml($!request.xredirect)" />`. If for some
  reason it''s not possible to patch this file, another workaround is to ensure "Prevent unregistered
  users from viewing pages, regardless of the page rights" is not checked in the rights and
  apply a better right scheme using groups and rights on spaces.'
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-23622
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-23622
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-23622
weaknesses:
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-platform/commit/053d957d53f2a543d158f3ab651e390d2728e0b9
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-gx6h-936c-vrrr
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19291
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:13.10:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:13.10:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:13.10.1:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:13.10.1:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:13.10.2:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:13.10.2:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:14.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:14.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23622
    reference_type:
    reference_id: CVE-2022-23622
