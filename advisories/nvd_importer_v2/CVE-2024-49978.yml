advisory_id: CVE-2024-49978
datasource_id: nvd_importer_v2/CVE-2024-49978
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-49978
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  gso: fix udp gso fraglist segmentation after pull from frag_list

  Detect gso fraglist skbs with corrupted geometry (see below) and
  pass these to skb_segment instead of skb_segment_list, as the first
  can segment them correctly.

  Valid SKB_GSO_FRAGLIST skbs
  - consist of two or more segments
  - the head_skb holds the protocol headers plus first gso_size
  - one or more frag_list skbs hold exactly one segment
  - all but the last must be gso_size

  Optional datapath hooks such as NAT and BPF (bpf_skb_pull_data) can
  modify these skbs, breaking these invariants.

  In extreme cases they pull all data into skb linear. For UDP, this
  causes a NULL ptr deref in __udpv4_gso_segment_list_csum at
  udp_hdr(seg->next)->dest.

  Detect invalid geometry due to pull, by checking head_skb size.
  Don't just drop, as this may blackhole a destination. Convert to be
  able to pass to regular skb_segment.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49978
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/080e6c9a3908de193a48f646c5ce1bfb15676ffc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/33e28acf42ee863f332a958bfc2f1a284a3659df
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3cd00d2e3655fad3bda96dc1ebf17b6495f86fea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a1e40ac5b5e9077fe1f7ae0eb88034db0f9ae1ab
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/af3122f5fdc0d00581d6e598a668df6bf54c9daa
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49978
    reference_type:
    reference_id: CVE-2024-49978
