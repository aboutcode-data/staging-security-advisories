advisory_id: CVE-2023-54238
datasource_id: nvd_importer_v2/CVE-2023-54238
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54238
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mlx5: fix skb leak while fifo resync and push

  During ptp resync operation SKBs were poped from the fifo but were never
  freed neither by napi_consume nor by dev_kfree_skb_any. Add call to
  napi_consume_skb to properly free SKBs.

  Another leak was happening because mlx5e_skb_fifo_has_room() had an error
  in the check. Comparing free running counters works well unless C promotes
  the types to something wider than the counter. In this case counters are
  u16 but the result of the substraction is promouted to int and it causes
  wrong result (negative value) of the check when producer have already
  overlapped but consumer haven't yet. Explicit cast to u16 fixes the issue.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/234cffda95e1049f58e8ec136ef105c633f0ed19
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/68504c66d08c70fb92799722e25a932d311d74fd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e435941b1da1a0be4ff8a7ae425774c76a5ac514
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54238
    reference_type:
    reference_id: CVE-2023-54238
