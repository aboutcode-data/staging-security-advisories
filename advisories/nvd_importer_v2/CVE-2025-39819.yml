advisory_id: CVE-2025-39819
datasource_id: nvd_importer_v2/CVE-2025-39819
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39819
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fs/smb: Fix inconsistent refcnt update

  A possible inconsistent update of refcount was identified in `smb2_compound_op`.
  Such inconsistent update could lead to possible resource leaks.

  Why it is a possible bug:
  1. In the comment section of the function, it clearly states that the
  reference to `cfile` should be dropped after calling this function.
  2. Every control flow path would check and drop the reference to
  `cfile`, except the patched one.
  3. Existing callers would not handle refcount update of `cfile` if
  -ENOMEM is returned.

  To fix the bug, an extra goto label "out" is added, to make sure that the
  cleanup logic would always be respected. As the problem is caused by the
  allocation failure of `vars`, the cleanup logic between label "finished"
  and "out" can be safely ignored. According to the definition of function
  `is_replayable_error`, the error code of "-ENOMEM" is not recoverable.
  Therefore, the replay logic also gets ignored.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39819
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3fc11ff13fbc2749871d6ac2141685cf54699997
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4191ea1f0bb3e27d65c5dcde7bd00e709ec67141
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4735f5991f51468b85affb8366b7067248457a71
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ab529e6ca1f67bcf31f3ea80c72bffde2e9e053e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cc82c6dff548f0066a51a6e577c7454e7d26a968
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39819
    reference_type:
    reference_id: CVE-2025-39819
