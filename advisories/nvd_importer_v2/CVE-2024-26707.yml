advisory_id: CVE-2024-26707
datasource_id: nvd_importer_v2/CVE-2024-26707
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26707
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: hsr: remove WARN_ONCE() in send_hsr_supervision_frame()

  Syzkaller reported [1] hitting a warning after failing to allocate
  resources for skb in hsr_init_skb(). Since a WARN_ONCE() call will
  not help much in this case, it might be prudent to switch to
  netdev_warn_once(). At the very least it will suppress syzkaller
  reports such as [1].

  Just in case, use netdev_warn_once() in send_prp_supervision_frame()
  for similar reasons.

  [1]
  HSR: Could not send supervision frame
  WARNING: CPU: 1 PID: 85 at net/hsr/hsr_device.c:294 send_hsr_supervision_frame+0x60a/0x810 net/hsr/hsr_device.c:294
  RIP: 0010:send_hsr_supervision_frame+0x60a/0x810 net/hsr/hsr_device.c:294
  ...
  Call Trace:
   <IRQ>
   hsr_announce+0x114/0x370 net/hsr/hsr_device.c:382
   call_timer_fn+0x193/0x590 kernel/time/timer.c:1700
   expire_timers kernel/time/timer.c:1751 [inline]
   __run_timers+0x764/0xb20 kernel/time/timer.c:2022
   run_timer_softirq+0x58/0xd0 kernel/time/timer.c:2035
   __do_softirq+0x21a/0x8de kernel/softirq.c:553
   invoke_softirq kernel/softirq.c:427 [inline]
   __irq_exit_rcu kernel/softirq.c:632 [inline]
   irq_exit_rcu+0xb7/0x120 kernel/softirq.c:644
   sysvec_apic_timer_interrupt+0x95/0xb0 arch/x86/kernel/apic/apic.c:1076
   </IRQ>
   <TASK>
   asm_sysvec_apic_timer_interrupt+0x1a/0x20 arch/x86/include/asm/idtentry.h:649
  ...

  This issue is also found in older kernels (at least up to 5.10).
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26707
weaknesses:
  - CWE-770
references:
  - url: https://git.kernel.org/stable/c/0d8011a878fdf96123bc0d6a12e2fe7ced5fddfb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/37e8c97e539015637cb920d3e6f1e404f707a06e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/547545e50c913861219947ce490c68a1776b9b51
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/56440799fc4621c279df16176f83a995d056023a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/923dea2a7ea9e1ef5ac4031fba461c1cc92e32b8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/de769423b2f053182a41317c4db5a927e90622a0
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26707
    reference_type:
    reference_id: CVE-2024-26707
