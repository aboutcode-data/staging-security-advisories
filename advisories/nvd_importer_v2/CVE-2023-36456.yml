advisory_id: CVE-2023-36456
datasource_id: nvd_importer_v2/CVE-2023-36456
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-36456
aliases: []
summary: |
  authentik is an open-source Identity Provider. Prior to versions 2023.4.3 and 2023.5.5, authentik does not verify the source of the X-Forwarded-For and X-Real-IP headers, both in the Python code and the go code. Only authentik setups that are directly accessible by users without a reverse proxy are susceptible to this. Possible spoofing of IP addresses in logs, downstream applications proxied by (built in) outpost, IP bypassing in custom flows if used.

  This poses a possible security risk when someone has flows or policies that check the user's IP address, e.g. when they want to ignore the user's 2 factor authentication when the user is connected to the company network. A second security risk is that the IP addresses in the logfiles and user sessions are not reliable anymore. Anybody can spoof this address and one cannot verify that the user has logged in from the IP address that is in their account's log. A third risk is that this header is passed on to the proxied application behind an outpost. The application may do any kind of verification, logging, blocking or rate limiting based on the IP address, and this IP address can be overridden by anybody that want to.

  Versions 2023.4.3 and 2023.5.5 contain a patch for this issue.
impacted_packages: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-36456
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-36456
weaknesses:
  - CWE-436
references:
  - url: https://github.com/goauthentik/authentik/commit/15026748d19d490eb2baf9a9566ead4f805f7dff
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/commit/c07a48a3eccbd7b23026f72136d3392bbc6f795a
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/security/advisories/GHSA-cmxp-jcw7-jjjv
    reference_type:
    reference_id:
  - url: https://goauthentik.io/docs/releases/2023.4#fixed-in-202343
    reference_type:
    reference_id:
  - url: https://goauthentik.io/docs/releases/2023.5#fixed-in-202355
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-36456
    reference_type:
    reference_id: CVE-2023-36456
