advisory_id: CVE-2022-49098
datasource_id: nvd_importer_v2/CVE-2022-49098
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49098
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  Drivers: hv: vmbus: Fix potential crash on module unload

  The vmbus driver relies on the panic notifier infrastructure to perform
  some operations when a panic event is detected. Since vmbus can be built
  as module, it is required that the driver handles both registering and
  unregistering such panic notifier callback.

  After commit 74347a99e73a ("x86/Hyper-V: Unload vmbus channel in hv panic callback")
  though, the panic notifier registration is done unconditionally in the module
  initialization routine whereas the unregistering procedure is conditionally
  guarded and executes only if HV_FEATURE_GUEST_CRASH_MSR_AVAILABLE capability
  is set.

  This patch fixes that by unconditionally unregistering the panic notifier
  in the module's exit routine as well.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49098
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2133c422a103cf7c7768c37b9ac382e73b691892
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3d0078f8bddd58d9bb1ad40bbe929f8633abb276
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5ea98d0f5f035c1bcf1517ccec0e024ae35a48b2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6b4c0149a56147b29169e07000d566162892722a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/792f232d57ff28bbd5f9c4abe0466b23d5879dc8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cf580d2e3884dbafd6b90269b03a24d661578624
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dcd6b1a624c0ffa21034d8b1e02e9d068458f596
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.7:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.7:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.7:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.7:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.7:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.7:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.7:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.7:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.7:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.7:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.7:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.7:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.7:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.7:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49098
    reference_type:
    reference_id: CVE-2022-49098
