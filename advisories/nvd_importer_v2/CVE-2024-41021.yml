advisory_id: CVE-2024-41021
datasource_id: nvd_importer_v2/CVE-2024-41021
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-41021
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  s390/mm: Fix VM_FAULT_HWPOISON handling in do_exception()

  There is no support for HWPOISON, MEMORY_FAILURE, or ARCH_HAS_COPY_MC on
  s390. Therefore we do not expect to see VM_FAULT_HWPOISON in
  do_exception().

  However, since commit af19487f00f3 ("mm: make PTE_MARKER_SWAPIN_ERROR more
  general"), it is possible to see VM_FAULT_HWPOISON in combination with
  PTE_MARKER_POISONED, even on architectures that do not support HWPOISON
  otherwise. In this case, we will end up on the BUG() in do_exception().

  Fix this by treating VM_FAULT_HWPOISON the same as VM_FAULT_SIGBUS, similar
  to x86 when MEMORY_FAILURE is not configured. Also print unexpected fault
  flags, for easier debugging.

  Note that VM_FAULT_HWPOISON_LARGE is not expected, because s390 cannot
  support swap entries on other levels than PTE level.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41021
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/73a9260b7366d2906ec011e100319359fe2277d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e13767ccefdc4f8aa92514b592b60f6b54882ff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a3aefb871222a9880602d1a44a558177b4143e3b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/df39038cd89525d465c2c8827eb64116873f141a
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41021
    reference_type:
    reference_id: CVE-2024-41021
