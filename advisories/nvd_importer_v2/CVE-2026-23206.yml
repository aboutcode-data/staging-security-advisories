advisory_id: CVE-2026-23206
datasource_id: nvd_importer_v2/CVE-2026-23206
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23206
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dpaa2-switch: prevent ZERO_SIZE_PTR dereference when num_ifs is zero

  The driver allocates arrays for ports, FDBs, and filter blocks using
  kcalloc() with ethsw->sw_attr.num_ifs as the element count. When the
  device reports zero interfaces (either due to hardware configuration
  or firmware issues), kcalloc(0, ...) returns ZERO_SIZE_PTR (0x10)
  instead of NULL.

  Later in dpaa2_switch_probe(), the NAPI initialization unconditionally
  accesses ethsw->ports[0]->netdev, which attempts to dereference
  ZERO_SIZE_PTR (address 0x10), resulting in a kernel panic.

  Add a check to ensure num_ifs is greater than zero after retrieving
  device attributes. This prevents the zero-sized allocations and
  subsequent invalid pointer dereference.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/155eb99aff2920153bf21217ae29565fff81e6af
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2fcccca88456b592bd668db13aa1d29ed257ca2b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4acc40db06ffd0fd92683505342b00c8a7394c60
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/80165ff16051448d6f840585ebe13f2400415df3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b97415c4362f739e25ec6f71012277086fabdf6f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ed48a84a72fefb20a82dd90a7caa7807e90c6f66
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23206
    reference_type:
    reference_id: CVE-2026-23206
