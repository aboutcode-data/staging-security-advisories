advisory_id: CVE-2024-26659
datasource_id: nvd_importer_v2/CVE-2024-26659
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26659
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  xhci: handle isoc Babble and Buffer Overrun events properly

  xHCI 4.9 explicitly forbids assuming that the xHC has released its
  ownership of a multi-TRB TD when it reports an error on one of the
  early TRBs. Yet the driver makes such assumption and releases the TD,
  allowing the remaining TRBs to be freed or overwritten by new TDs.

  The xHC should also report completion of the final TRB due to its IOC
  flag being set by us, regardless of prior errors. This event cannot
  be recognized if the TD has already been freed earlier, resulting in
  "Transfer event TRB DMA ptr not part of current TD" error message.

  Fix this by reusing the logic for processing isoc Transaction Errors.
  This also handles hosts which fail to report the final completion.

  Fix transfer length reporting on Babble errors. They may be caused by
  device malfunction, no guarantee that the buffer has been filled.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26659
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/2aa7bcfdbb46241c701811bbc0d64d7884e3346c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2e3ec80ea7ba58bbb210e83b5a0afefee7c171d3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/418456c0ce56209610523f21734c5612ee634134
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/696e4112e5c1ee61996198f0ebb6ca3fab55166e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7c4650ded49e5b88929ecbbb631efb8b0838e811
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f5e7ffa9269a448a720e21f1ed1384d118298c97
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26659
    reference_type:
    reference_id: CVE-2024-26659
