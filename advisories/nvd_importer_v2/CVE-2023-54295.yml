advisory_id: CVE-2023-54295
datasource_id: nvd_importer_v2/CVE-2023-54295
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54295
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mtd: spi-nor: Fix shift-out-of-bounds in spi_nor_set_erase_type

  spi_nor_set_erase_type() was used either to set or to mask out an erase
  type. When we used it to mask out an erase type a shift-out-of-bounds
  was hit:
  UBSAN: shift-out-of-bounds in drivers/mtd/spi-nor/core.c:2237:24
  shift exponent 4294967295 is too large for 32-bit type 'int'

  The setting of the size_{shift, mask} and of the opcode are unnecessary
  when the erase size is zero, as throughout the code just the erase size
  is considered to determine whether an erase type is supported or not.
  Setting the opcode to 0xFF was wrong too as nobody guarantees that 0xFF
  is an unused opcode. Thus when masking out an erase type, just set the
  erase size to zero. This will fix the shift-out-of-bounds.

  [ta: refine changes, new commit message, fix compilation error]
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/53b2916ebde741c657a857fa1936c0d9fcb59170
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/61d44a4db2f54dbac7d22c2541574ea5755e0468
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/99341b8aee7b5b4255b339345bbcaa35867dfd0c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e6409208c13f7c56adc12dd795abf4141e3d5e64
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f0f0cfdc3a024e21161714f2e05f0df3b84d42ad
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54295
    reference_type:
    reference_id: CVE-2023-54295
