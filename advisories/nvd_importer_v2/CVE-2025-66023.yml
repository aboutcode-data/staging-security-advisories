advisory_id: CVE-2025-66023
datasource_id: nvd_importer_v2/CVE-2025-66023
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-66023
aliases: []
summary: NanoMQ MQTT Broker (NanoMQ) is an all-around Edge Messaging Platform. Versions prior
  to 0.24.5 have a Heap-Use-After-Free (UAF) vulnerability within the MQTT bridge client component
  (implemented via the underlying NanoNNG library). The vulnerability is triggered when NanoMQ
  acts as a bridge connecting to a remote MQTT broker. A malicious remote broker can trigger
  a crash (Denial of Service) or potential memory corruption by accepting the connection and
  immediately sending a malformed packet sequence. Version 0.34.5 contains a patch. The patch
  enforces stricter protocol adherence in the MQTT client SDK embedded in NanoMQ. Specifically,
  it ensures that CONNACK is always the first packet processed in the line. This prevents the
  state confusion that led to the Heap-Use-After-Free (UAF) when a malicious server sent a malformed
  packet sequence immediately after connection establishment. As a workaround, validate the
  remote broker before bridging.
impacted_packages: []
severities:
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66023
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:P/PR:H/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:H/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66023
weaknesses:
  - CWE-416
references:
  - url: https://github.com/nanomq/nanomq/issues/2145
    reference_type:
    reference_id:
  - url: https://github.com/nanomq/nanomq/security/advisories/GHSA-24f7-q5hh-27hf
    reference_type:
    reference_id:
  - url: https://github.com/nanomq/NanoNNG/pull/1365
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:emqx:nanomq:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:emqx:nanomq:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66023
    reference_type:
    reference_id: CVE-2025-66023
