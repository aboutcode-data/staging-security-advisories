advisory_id: CVE-2025-68296
datasource_id: nvd_importer_v2/CVE-2025-68296
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68296
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm, fbcon, vga_switcheroo: Avoid race condition in fbcon setup

  Protect vga_switcheroo_client_fb_set() with console lock. Avoids OOB
  access in fbcon_remap_all(). Without holding the console lock the call
  races with switching outputs.

  VGA switcheroo calls fbcon_remap_all() when switching clients. The fbcon
  function uses struct fb_info.node, which is set by register_framebuffer().
  As the fb-helper code currently sets up VGA switcheroo before registering
  the framebuffer, the value of node is -1 and therefore not a legal value.
  For example, fbcon uses the value within set_con2fb_map() [1] as an index
  into an array.

  Moving vga_switcheroo_client_fb_set() after register_framebuffer() can
  result in VGA switching that does not switch fbcon correctly.

  Therefore move vga_switcheroo_client_fb_set() under fbcon_fb_registered(),
  which already holds the console lock. Fbdev calls fbcon_fb_registered()
  from within register_framebuffer(). Serializes the helper with VGA
  switcheroo's call to fbcon_remap_all().

  Although vga_switcheroo_client_fb_set() takes an instance of struct fb_info
  as parameter, it really only needs the contained fbcon state. Moving the
  call to fbcon initialization is therefore cleaner than before. Only amdgpu,
  i915, nouveau and radeon support vga_switcheroo. For all other drivers,
  this change does nothing.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/05814c389b53d2f3a0b9eeb90ba7a05ba77c4c2a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/482330f8261b4bea8146d9bd69c1199e5dfcbb5c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eb76d0f5553575599561010f24c277cc5b31d003
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68296
    reference_type:
    reference_id: CVE-2025-68296
