advisory_id: CVE-2023-53282
datasource_id: nvd_importer_v2/CVE-2023-53282
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53282
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: lpfc: Fix use-after-free KFENCE violation during sysfs firmware write

  During the sysfs firmware write process, a use-after-free read warning is
  logged from the lpfc_wr_object() routine:

    BUG: KFENCE: use-after-free read in lpfc_wr_object+0x235/0x310 [lpfc]
    Use-after-free read at 0x0000000000cf164d (in kfence-#111):
    lpfc_wr_object+0x235/0x310 [lpfc]
    lpfc_write_firmware.cold+0x206/0x30d [lpfc]
    lpfc_sli4_request_firmware_update+0xa6/0x100 [lpfc]
    lpfc_request_firmware_upgrade_store+0x66/0xb0 [lpfc]
    kernfs_fop_write_iter+0x121/0x1b0
    new_sync_write+0x11c/0x1b0
    vfs_write+0x1ef/0x280
    ksys_write+0x5f/0xe0
    do_syscall_64+0x59/0x90
    entry_SYSCALL_64_after_hwframe+0x63/0xcd

  The driver accessed wr_object pointer data, which was initialized into
  mailbox payload memory, after the mailbox object was released back to the
  mailbox pool.

  Fix by moving the mailbox free calls to the end of the routine ensuring
  that we don't reference internal mailbox memory after release.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53282
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/21681b81b9ae548c5dae7ae00d931197a27f480c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/51ab4eb1a25e73c7fc2ad9026520c4d8369c93cc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8becb97918f04bb177bc9c4e00c2bdb302e00944
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8dfefa8f424ab208e552df1bfd008b732f3d0ad1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53282
    reference_type:
    reference_id: CVE-2023-53282
