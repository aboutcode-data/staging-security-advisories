advisory_id: CVE-2022-49083
datasource_id: nvd_importer_v2/CVE-2022-49083
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49083
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  iommu/omap: Fix regression in probe for NULL pointer dereference

  Commit 3f6634d997db ("iommu: Use right way to retrieve iommu_ops") started
  triggering a NULL pointer dereference for some omap variants:

  __iommu_probe_device from probe_iommu_group+0x2c/0x38
  probe_iommu_group from bus_for_each_dev+0x74/0xbc
  bus_for_each_dev from bus_iommu_probe+0x34/0x2e8
  bus_iommu_probe from bus_set_iommu+0x80/0xc8
  bus_set_iommu from omap_iommu_init+0x88/0xcc
  omap_iommu_init from do_one_initcall+0x44/0x24

  This is caused by omap iommu probe returning 0 instead of ERR_PTR(-ENODEV)
  as noted by Jason Gunthorpe <jgg@ziepe.ca>.

  Looks like the regression already happened with an earlier commit
  6785eb9105e3 ("iommu/omap: Convert to probe/release_device() call-backs")
  that changed the function return type and missed converting one place.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49083
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/1d89f2b9eadbcf3ce93c6d7238f68299a1f84968
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/47e239117bd97c8556f9187af7a9a7938db4e021
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/71ff461c3f41f6465434b9e980c01782763e7ad8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bd905fed87ce01ac010011bb8f44ed0140116ceb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ea518578aa8a9a0280605b53cc33f707e10c8178
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49083
    reference_type:
    reference_id: CVE-2022-49083
