advisory_id: CVE-2025-21902
datasource_id: nvd_importer_v2/CVE-2025-21902
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21902
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  acpi: typec: ucsi: Introduce a ->poll_cci method

  For the ACPI backend of UCSI the UCSI "registers" are just a memory copy
  of the register values in an opregion. The ACPI implementation in the
  BIOS ensures that the opregion contents are synced to the embedded
  controller and it ensures that the registers (in particular CCI) are
  synced back to the opregion on notifications. While there is an ACPI call
  that syncs the actual registers to the opregion there is rarely a need to
  do this and on some ACPI implementations it actually breaks in various
  interesting ways.

  The only reason to force a sync from the embedded controller is to poll
  CCI while notifications are disabled. Only the ucsi core knows if this
  is the case and guessing based on the current command is suboptimal, i.e.
  leading to the following spurious assertion splat:

  WARNING: CPU: 3 PID: 76 at drivers/usb/typec/ucsi/ucsi.c:1388 ucsi_reset_ppm+0x1b4/0x1c0 [typec_ucsi]
  CPU: 3 UID: 0 PID: 76 Comm: kworker/3:0 Not tainted 6.12.11-200.fc41.x86_64 #1
  Hardware name: LENOVO 21D0/LNVNB161216, BIOS J6CN45WW 03/17/2023
  Workqueue: events_long ucsi_init_work [typec_ucsi]
  RIP: 0010:ucsi_reset_ppm+0x1b4/0x1c0 [typec_ucsi]
  Call Trace:
   <TASK>
   ucsi_init_work+0x3c/0xac0 [typec_ucsi]
   process_one_work+0x179/0x330
   worker_thread+0x252/0x390
   kthread+0xd2/0x100
   ret_from_fork+0x34/0x50
   ret_from_fork_asm+0x1a/0x30
   </TASK>

  Thus introduce a ->poll_cci() method that works like ->read_cci() with an
  additional forced sync and document that this should be used when polling
  with notifications disabled. For all other backends that presumably don't
  have this issue use the same implementation for both methods.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21902
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/012b98cdb54c7d47743ee7fc402fa23f2d90529a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1aec5c9066965ac0984e385bbc31455ae31cbffc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/976e7e9bdc7719a023a4ecccd2e3daec9ab20a40
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21902
    reference_type:
    reference_id: CVE-2025-21902
