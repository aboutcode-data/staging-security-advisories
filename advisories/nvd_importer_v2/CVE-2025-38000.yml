advisory_id: CVE-2025-38000
datasource_id: nvd_importer_v2/CVE-2025-38000
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38000
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sch_hfsc: Fix qlen accounting bug when using peek in hfsc_enqueue()

  When enqueuing the first packet to an HFSC class, hfsc_enqueue() calls the
  child qdisc's peek() operation before incrementing sch->q.qlen and
  sch->qstats.backlog. If the child qdisc uses qdisc_peek_dequeued(), this may
  trigger an immediate dequeue and potential packet drop. In such cases,
  qdisc_tree_reduce_backlog() is called, but the HFSC qdisc's qlen and backlog
  have not yet been updated, leading to inconsistent queue accounting. This
  can leave an empty HFSC class in the active list, causing further
  consequences like use-after-free.

  This patch fixes the bug by moving the increment of sch->q.qlen and
  sch->qstats.backlog before the call to the child qdisc's peek() operation.
  This ensures that queue length and backlog are always accurate when packet
  drops or dequeues are triggered during the peek.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38000
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/1034e3310752e8675e313f7271b348914008719a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3f3a22eebbc32b4fa8ce9c1d5f9db214b45b9335
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3f981138109f63232a5fb7165938d4c945cc1b9d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/49b21795b8e5654a7df3d910a12e1060da4c04cf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/89c301e929a0db14ebd94b4d97764ce1d6981653
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/93c276942e75de0e5bc91576300d292e968f5a02
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f1dde3eb17dc1b8bd07aed00004b1e05fc87a3d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f9f593e34d2fb67644372c8f7b033bdc622ad228
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38000
    reference_type:
    reference_id: CVE-2025-38000
