advisory_id: CVE-2025-38048
datasource_id: nvd_importer_v2/CVE-2025-38048
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38048
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  virtio_ring: Fix data race by tagging event_triggered as racy for KCSAN

  syzbot reports a data-race when accessing the event_triggered, here is the
  simplified stack when the issue occurred:

  ==================================================================
  BUG: KCSAN: data-race in virtqueue_disable_cb / virtqueue_enable_cb_delayed

  write to 0xffff8881025bc452 of 1 bytes by task 3288 on cpu 0:
   virtqueue_enable_cb_delayed+0x42/0x3c0 drivers/virtio/virtio_ring.c:2653
   start_xmit+0x230/0x1310 drivers/net/virtio_net.c:3264
   __netdev_start_xmit include/linux/netdevice.h:5151 [inline]
   netdev_start_xmit include/linux/netdevice.h:5160 [inline]
   xmit_one net/core/dev.c:3800 [inline]

  read to 0xffff8881025bc452 of 1 bytes by interrupt on cpu 1:
   virtqueue_disable_cb_split drivers/virtio/virtio_ring.c:880 [inline]
   virtqueue_disable_cb+0x92/0x180 drivers/virtio/virtio_ring.c:2566
   skb_xmit_done+0x5f/0x140 drivers/net/virtio_net.c:777
   vring_interrupt+0x161/0x190 drivers/virtio/virtio_ring.c:2715
   __handle_irq_event_percpu+0x95/0x490 kernel/irq/handle.c:158
   handle_irq_event_percpu kernel/irq/handle.c:193 [inline]

  value changed: 0x01 -> 0x00
  ==================================================================

  When the data race occurs, the function virtqueue_enable_cb_delayed() sets
  event_triggered to false, and virtqueue_disable_cb_split/packed() reads it
  as false due to the race condition. Since event_triggered is an unreliable
  hint used for optimization, this should only cause the driver temporarily
  suggest that the device not send an interrupt notification when the event
  index is used.

  Fix this KCSAN reported data-race issue by explicitly tagging the access as
  data_racy.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38048
weaknesses:
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/02d2d6caee3abc9335cfca35f8eb4492173ae6f2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2e2f925fe737576df2373931c95e1a2b66efdfef
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4ed8f0e808b3fcc71c5b8be7902d8738ed595b17
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b49b5132e4c7307599492aee1cdc6d89f7f2a7da
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b6d6419548286b2b9d2b90df824d3cab797f6ae8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b730cb109633c455ce8a7cd6934986c6a16d88d8
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38048
    reference_type:
    reference_id: CVE-2025-38048
