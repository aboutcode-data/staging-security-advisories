advisory_id: CVE-2025-68762
datasource_id: nvd_importer_v2/CVE-2025-68762
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68762
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: netpoll: initialize work queue before error checks

  Prevent a kernel warning when netconsole setup fails on devices with
  IFF_DISABLE_NETPOLL flag. The warning (at kernel/workqueue.c:4242 in
  __flush_work) occurs because the cleanup path tries to cancel an
  uninitialized work queue.

  When __netpoll_setup() encounters a device with IFF_DISABLE_NETPOLL,
  it fails early and calls skb_pool_flush() for cleanup. This function
  calls cancel_work_sync(&np->refill_wq), but refill_wq hasn't been
  initialized yet, triggering the warning.

  Move INIT_WORK() to the beginning of __netpoll_setup(), ensuring the
  work queue is properly initialized before any potential failure points.
  This allows the cleanup path to safely cancel the work queue regardless
  of where the setup fails.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/760bc6ceda8e2c273c0e2018ad2595967c3dd308
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a90d0dc38a10347078cca60e7495ad0648838f18
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e5235eb6cfe02a51256013a78f7b28779a7740d5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68762
    reference_type:
    reference_id: CVE-2025-68762
