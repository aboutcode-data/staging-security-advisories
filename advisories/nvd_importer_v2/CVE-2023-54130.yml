advisory_id: CVE-2023-54130
datasource_id: nvd_importer_v2/CVE-2023-54130
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54130
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  hfs/hfsplus: avoid WARN_ON() for sanity check, use proper error handling

  Commit 55d1cbbbb29e ("hfs/hfsplus: use WARN_ON for sanity check") fixed
  a build warning by turning a comment into a WARN_ON(), but it turns out
  that syzbot then complains because it can trigger said warning with a
  corrupted hfs image.

  The warning actually does warn about a bad situation, but we are much
  better off just handling it as the error it is.  So rather than warn
  about us doing bad things, stop doing the bad things and return -EIO.

  While at it, also fix a memory leak that was introduced by an earlier
  fix for a similar syzbot warning situation, and add a check for one case
  that historically wasn't handled at all (ie neither comment nor
  subsequent WARN_ON).
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/45917be9f0af339a45b4619f31c902d37b8aed59
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/82725be426bce0a425cc5e26fbad61ffd29cff03
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/90e019006644dad35862cb4aa270f561b0732066
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/be01f35efa876eb81cebab2cb0add068b7280ef4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cb7a95af78d29442b8294683eca4897544b8ef46
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cc2164ada548addfa8ee215196661c3afe0c5154
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/da23752d9660ba7a8ca6c5768fd8776f67f59ee7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f10defb0be6ac42fb6a97b45920d32da6bd6fde8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54130
    reference_type:
    reference_id: CVE-2023-54130
