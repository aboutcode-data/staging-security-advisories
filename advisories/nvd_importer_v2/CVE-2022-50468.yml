advisory_id: CVE-2022-50468
datasource_id: nvd_importer_v2/CVE-2022-50468
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50468
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  platform/chrome: cros_usbpd_notify: Fix error handling in cros_usbpd_notify_init()

  The following WARNING message was given when rmmod cros_usbpd_notify:

   Unexpected driver unregister!
   WARNING: CPU: 0 PID: 253 at drivers/base/driver.c:270 driver_unregister+0x8a/0xb0
   Modules linked in: cros_usbpd_notify(-)
   CPU: 0 PID: 253 Comm: rmmod Not tainted 6.1.0-rc3 #24
   ...
   Call Trace:
    <TASK>
    cros_usbpd_notify_exit+0x11/0x1e [cros_usbpd_notify]
    __x64_sys_delete_module+0x3c7/0x570
    ? __ia32_sys_delete_module+0x570/0x570
    ? lock_is_held_type+0xe3/0x140
    ? syscall_enter_from_user_mode+0x17/0x50
    ? rcu_read_lock_sched_held+0xa0/0xd0
    ? syscall_enter_from_user_mode+0x1c/0x50
    do_syscall_64+0x37/0x90
    entry_SYSCALL_64_after_hwframe+0x63/0xcd
   RIP: 0033:0x7f333fe9b1b7

  The reason is that the cros_usbpd_notify_init() does not check the return
  value of platform_driver_register(), and the cros_usbpd_notify can
  install successfully even if platform_driver_register() failed.

  Fix by checking the return value of platform_driver_register() and
  unregister cros_usbpd_notify_plat_driver when it failed.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50468
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/5a2d96623670155d94aca72c320c0ac27bdc6bd2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5c0cacdd354987f8f5348d16908716f154047890
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/751f12696d797e785d2611099fe9f0569d47556e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b6ee54995739202b4a0cc01b7e9269f761c573d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cab345f9d51943898e406275f9607c145adb1877
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50468
    reference_type:
    reference_id: CVE-2022-50468
