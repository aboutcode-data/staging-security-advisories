advisory_id: CVE-2021-39197
datasource_id: nvd_importer_v2/CVE-2021-39197
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-39197
aliases: []
summary: better_errors is an open source replacement for the standard Rails error page with
  more information rich error pages. It is also usable outside of Rails in any Rack app as Rack
  middleware. better_errors prior to 2.8.0 did not implement CSRF protection for its internal
  requests. It also did not enforce the correct "Content-Type" header for these requests, which
  allowed a cross-origin "simple request" to be made without CORS protection. These together
  left an application with better_errors enabled open to cross-origin attacks. As a developer
  tool, better_errors documentation strongly recommends addition only to the `development` bundle
  group, so this vulnerability should only affect development environments. Please ensure that
  your project limits better_errors to the `development` group (or the non-Rails equivalent).
  Starting with release 2.8.x, CSRF protection is enforced. It is recommended that you upgrade
  to the latest release, or minimally to "~> 2.8.3". There are no known workarounds to mitigate
  the risk of using older releases of better_errors.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39197
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39197
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39197
weaknesses:
  - CWE-352
references:
  - url: https://github.com/BetterErrors/better_errors/commit/8e8e796bfbde4aa088741823c8a3fc6df2089bb0
    reference_type:
    reference_id:
  - url: https://github.com/BetterErrors/better_errors/discussions/507
    reference_type:
    reference_id:
  - url: https://github.com/BetterErrors/better_errors/pull/474
    reference_type:
    reference_id:
  - url: https://github.com/BetterErrors/better_errors/security/advisories/GHSA-w3j4-76qw-wwjm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:better_errors_project:better_errors:*:*:*:*:*:ruby:*:*
    reference_type:
    reference_id: cpe:2.3:a:better_errors_project:better_errors:*:*:*:*:*:ruby:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39197
    reference_type:
    reference_id: CVE-2021-39197
