advisory_id: CVE-2026-23154
datasource_id: nvd_importer_v2/CVE-2026-23154
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23154
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: fix segmentation of forwarding fraglist GRO

  This patch enhances GSO segment handling by properly checking
  the SKB_GSO_DODGY flag for frag_list GSO packets, addressing
  low throughput issues observed when a station accesses IPv4
  servers via hotspots with an IPv6-only upstream interface.

  Specifically, it fixes a bug in GSO segmentation when forwarding
  GRO packets containing a frag_list. The function skb_segment_list
  cannot correctly process GRO skbs that have been converted by XLAT,
  since XLAT only translates the header of the head skb. Consequently,
  skbs in the frag_list may remain untranslated, resulting in protocol
  inconsistencies and reduced throughput.

  To address this, the patch explicitly sets the SKB_GSO_DODGY flag
  for GSO packets in XLAT's IPv4/IPv6 protocol translation helpers
  (bpf_skb_proto_4_to_6 and bpf_skb_proto_6_to_4). This marks GSO
  packets as potentially modified after protocol translation. As a
  result, GSO segmentation will avoid using skb_segment_list and
  instead falls back to skb_segment for packets with the SKB_GSO_DODGY
  flag. This ensures that only safe and fully translated frag_list
  packets are processed by skb_segment_list, resolving protocol
  inconsistencies and improving throughput when forwarding GRO packets
  converted by XLAT.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3d48d59235c494d34e32052f768393111c0806ef
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3e62db1e3140449608975e29e0979cc5f3b1cc07
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/426ca15c7f6cb6562a081341ca88893a50c59fa2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23154
    reference_type:
    reference_id: CVE-2026-23154
