advisory_id: CVE-2020-15135
datasource_id: nvd_importer_v2/CVE-2020-15135
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2020-15135
aliases: []
summary: save-server (npm package) before version 1.05 is affected by a CSRF vulnerability,
  as there is no CSRF mitigation (Tokens etc.). The fix introduced in version version 1.05 unintentionally
  breaks uploading so version v1.0.7 is the fixed version. This is patched by implementing Double
  submit. The CSRF attack would require you to navigate to a malicious site while you have an
  active session with Save-Server (Session key stored in cookies). The malicious user would
  then be able to perform some actions, including uploading/deleting files and adding redirects.
  If you are logged in as root, this attack is significantly more severe. They can in addition
  create, delete and update users. If they updated the password of a user, that user's files
  would then be available. If the root password is updated, all files would be visible if they
  logged in with the new password. Note that due to the same origin policy malicious actors
  cannot view the gallery or the response of any of the methods, nor be sure they succeeded.
  This issue has been patched in version 1.0.7.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15135
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15135
  - score: '7.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15135
weaknesses:
  - CWE-352
references:
  - url: https://github.com/Neztore/save-server/security/advisories/GHSA-wwrj-35w6-77ff
    reference_type:
    reference_id:
  - url: https://medium.com/cross-site-request-forgery-csrf/double-submit-cookie-pattern-65bb71d80d9f
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/save-server
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:save-server_project:save-server:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:save-server_project:save-server:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15135
    reference_type:
    reference_id: CVE-2020-15135
