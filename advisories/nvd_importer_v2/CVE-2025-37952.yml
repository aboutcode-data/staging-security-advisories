advisory_id: CVE-2025-37952
datasource_id: nvd_importer_v2/CVE-2025-37952
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37952
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ksmbd: Fix UAF in __close_file_table_ids

  A use-after-free is possible if one thread destroys the file
  via __ksmbd_close_fd while another thread holds a reference to
  it. The existing checks on fp->refcount are not sufficient to
  prevent this.

  The fix takes ft->lock around the section which removes the
  file from the file table. This prevents two threads acquiring the
  same file pointer via __close_file_table_ids, as well as the other
  functions which retrieve a file from the IDR and which already use
  this same lock.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37952
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/16727e442568a46d9cca69fe2595896de86e120d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/36991c1ccde2d5a521577c448ffe07fcccfe104d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e9841e232b51171ddf3bc4ee517d5d28dc8cad6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fec1f9e9a650e8e7011330a085c77e7bf2a08ea9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37952
    reference_type:
    reference_id: CVE-2025-37952
