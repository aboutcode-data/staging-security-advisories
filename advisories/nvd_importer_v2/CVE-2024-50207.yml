advisory_id: CVE-2024-50207
datasource_id: nvd_importer_v2/CVE-2024-50207
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-50207
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ring-buffer: Fix reader locking when changing the sub buffer order

  The function ring_buffer_subbuf_order_set() updates each
  ring_buffer_per_cpu and installs new sub buffers that match the requested
  page order. This operation may be invoked concurrently with readers that
  rely on some of the modified data, such as the head bit (RB_PAGE_HEAD), or
  the ring_buffer_per_cpu.pages and reader_page pointers. However, no
  exclusive access is acquired by ring_buffer_subbuf_order_set(). Modifying
  the mentioned data while a reader also operates on them can then result in
  incorrect memory access and various crashes.

  Fix the problem by taking the reader_lock when updating a specific
  ring_buffer_per_cpu in ring_buffer_subbuf_order_set().
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50207
weaknesses:
  - CWE-667
references:
  - url: https://git.kernel.org/stable/c/09661f75e75cb6c1d2d8326a70c311d46729235f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a569290525a05162d5dd26d9845591eaf46e5802
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50207
    reference_type:
    reference_id: CVE-2024-50207
