advisory_id: CVE-2022-49664
datasource_id: nvd_importer_v2/CVE-2022-49664
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49664
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tipc: move bc link creation back to tipc_node_create

  Shuang Li reported a NULL pointer dereference crash:

    [] BUG: kernel NULL pointer dereference, address: 0000000000000068
    [] RIP: 0010:tipc_link_is_up+0x5/0x10 [tipc]
    [] Call Trace:
    []  <IRQ>
    []  tipc_bcast_rcv+0xa2/0x190 [tipc]
    []  tipc_node_bc_rcv+0x8b/0x200 [tipc]
    []  tipc_rcv+0x3af/0x5b0 [tipc]
    []  tipc_udp_recv+0xc7/0x1e0 [tipc]

  It was caused by the 'l' passed into tipc_bcast_rcv() is NULL. When it
  creates a node in tipc_node_check_dest(), after inserting the new node
  into hashtable in tipc_node_create(), it creates the bc link. However,
  there is a gap between this insert and bc link creation, a bc packet
  may come in and get the node from the hashtable then try to dereference
  its bc link, which is NULL.

  This patch is to fix it by moving the bc link creation before inserting
  into the hashtable.

  Note that for a preliminary node becoming "real", the bc link creation
  should also be called before it's rehashed, as we don't create it for
  preliminary nodes.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49664
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/35fcb2ba35b4d9b592b558c3bcc6e0d90e213588
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/456bc338871c4a52117dd5ef29cce3745456d248
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cb8092d70a6f5f01ec1490fce4d35efed3ed996c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e52910e671f58c619e33dac476b11b35e2d3ab6f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49664
    reference_type:
    reference_id: CVE-2022-49664
