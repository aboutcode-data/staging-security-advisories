advisory_id: CVE-2024-50063
datasource_id: nvd_importer_v2/CVE-2024-50063
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-50063
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Prevent tail call between progs attached to different hooks

  bpf progs can be attached to kernel functions, and the attached functions
  can take different parameters or return different return values. If
  prog attached to one kernel function tail calls prog attached to another
  kernel function, the ctx access or return value verification could be
  bypassed.

  For example, if prog1 is attached to func1 which takes only 1 parameter
  and prog2 is attached to func2 which takes two parameters. Since verifier
  assumes the bpf ctx passed to prog2 is constructed based on func2's
  prototype, verifier allows prog2 to access the second parameter from
  the bpf ctx passed to it. The problem is that verifier does not prevent
  prog1 from passing its bpf ctx to prog2 via tail call. In this case,
  the bpf ctx passed to prog2 is constructed from func1 instead of func2,
  that is, the assumption for ctx access verification is bypassed.

  Another example, if BPF LSM prog1 is attached to hook file_alloc_security,
  and BPF LSM prog2 is attached to hook bpf_lsm_audit_rule_known. Verifier
  knows the return value rules for these two hooks, e.g. it is legal for
  bpf_lsm_audit_rule_known to return positive number 1, and it is illegal
  for file_alloc_security to return positive number. So verifier allows
  prog2 to return positive number 1, but does not allow prog1 to return
  positive number. The problem is that verifier does not prevent prog1
  from calling prog2 via tail call. In this case, prog2's return value 1
  will be used as the return value for prog1's hook file_alloc_security.
  That is, the return value rule is bypassed.

  This patch adds restriction for tail call to prevent such bypasses.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50063
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/28ead3eaabc16ecc907cfb71876da028080f6356
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5d5e3b4cbe8ee16b7bf96fd73a421c92a9da3ca1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/88c2a10e6c176c2860cd0659f4c0e9d20b3f64d1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d9a807fb7cbfad4328824186e2e4bee28f72169b
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50063
    reference_type:
    reference_id: CVE-2024-50063
