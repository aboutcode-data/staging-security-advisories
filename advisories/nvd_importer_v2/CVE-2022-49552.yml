advisory_id: CVE-2022-49552
datasource_id: nvd_importer_v2/CVE-2022-49552
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49552
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Fix combination of jit blinding and pointers to bpf subprogs.

  The combination of jit blinding and pointers to bpf subprogs causes:
  [   36.989548] BUG: unable to handle page fault for address: 0000000100000001
  [   36.990342] #PF: supervisor instruction fetch in kernel mode
  [   36.990968] #PF: error_code(0x0010) - not-present page
  [   36.994859] RIP: 0010:0x100000001
  [   36.995209] Code: Unable to access opcode bytes at RIP 0xffffffd7.
  [   37.004091] Call Trace:
  [   37.004351]  <TASK>
  [   37.004576]  ? bpf_loop+0x4d/0x70
  [   37.004932]  ? bpf_prog_3899083f75e4c5de_F+0xe3/0x13b

  The jit blinding logic didn't recognize that ld_imm64 with an address
  of bpf subprogram is a special instruction and proceeded to randomize it.
  By itself it wouldn't have been an issue, but jit_subprogs() logic
  relies on two step process to JIT all subprogs and then JIT them
  again when addresses of all subprogs are known.
  Blinding process in the first JIT phase caused second JIT to miss
  adjustment of special ld_imm64.

  Fix this issue by ignoring special ld_imm64 instructions that don't have
  user controlled constants and shouldn't be blinded.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49552
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/4b6313cf99b0d51b49aeaea98ec76ca8161ecb80
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a029b02b47dd5bb87a21550d9d9a80cb4dd3f714
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d106a3e96fca30e44081eae9c27aab28fc132a46
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49552
    reference_type:
    reference_id: CVE-2022-49552
