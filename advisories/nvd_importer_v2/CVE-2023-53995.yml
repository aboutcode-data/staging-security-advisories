advisory_id: CVE-2023-53995
datasource_id: nvd_importer_v2/CVE-2023-53995
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53995
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: ipv4: fix one memleak in __inet_del_ifa()

  I got the below warning when do fuzzing test:
  unregister_netdevice: waiting for bond0 to become free. Usage count = 2

  It can be repoduced via:

  ip link add bond0 type bond
  sysctl -w net.ipv4.conf.bond0.promote_secondaries=1
  ip addr add 4.117.174.103/0 scope 0x40 dev bond0
  ip addr add 192.168.100.111/255.255.255.254 scope 0 dev bond0
  ip addr add 0.0.0.4/0 scope 0x40 secondary dev bond0
  ip addr del 4.117.174.103/0 scope 0x40 dev bond0
  ip link delete bond0 type bond

  In this reproduction test case, an incorrect 'last_prim' is found in
  __inet_del_ifa(), as a result, the secondary address(0.0.0.4/0 scope 0x40)
  is lost. The memory of the secondary address is leaked and the reference of
  in_device and net_device is leaked.

  Fix this problem:
  Look for 'last_prim' starting at location of the deleted IP and inserting
  the promoted IP into the location of 'last_prim'.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2f1e86014d0cc084886c36a2d77bc620e2d42618
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/42652af5360d30b43b06057c193739e7dfb18f42
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5624f26a3574500ce23929cb2c9976a0dec9920a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7c8ddcdab1b900bed69cad6beef477fff116289e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/980f8445479814509a3cd55a8eabaae1c9030a4c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac28b1ec6135649b5d78b028e47264cb3ebca5ea
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53995
    reference_type:
    reference_id: CVE-2023-53995
