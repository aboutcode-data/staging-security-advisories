advisory_id: CVE-2021-43979
datasource_id: nvd_importer_v2/CVE-2021-43979
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-43979
aliases: []
summary: 'Styra Open Policy Agent (OPA) Gatekeeper through 3.7.0 mishandles concurrency, sometimes
  resulting in incorrect access control. The data replication mechanism allows policies to access
  the Kubernetes cluster state. During data replication, OPA/Gatekeeper does not wait for the
  replication to finish before processing a request, which might cause inconsistencies between
  the replicated resources in OPA/Gatekeeper and the resources actually present in the cluster.
  Inconsistency can later be reflected in a policy bypass. NOTE: the vendor disagrees that this
  is a vulnerability, because Kubernetes states are only eventually consistent'
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43979
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43979
weaknesses:
  - CWE-670
references:
  - url: https://github.com/hkerma/opa-gatekeeper-concurrency-issue
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/gatekeeper/releases
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openpolicyagent:gatekeeper:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:openpolicyagent:gatekeeper:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43979
    reference_type:
    reference_id: CVE-2021-43979
