advisory_id: CVE-2024-47740
datasource_id: nvd_importer_v2/CVE-2024-47740
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-47740
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  f2fs: Require FMODE_WRITE for atomic write ioctls

  The F2FS ioctls for starting and committing atomic writes check for
  inode_owner_or_capable(), but this does not give LSMs like SELinux or
  Landlock an opportunity to deny the write access - if the caller's FSUID
  matches the inode's UID, inode_owner_or_capable() immediately returns true.

  There are scenarios where LSMs want to deny a process the ability to write
  particular files, even files that the FSUID of the process owns; but this
  can currently partially be bypassed using atomic write ioctls in two ways:

   - F2FS_IOC_START_ATOMIC_REPLACE + F2FS_IOC_COMMIT_ATOMIC_WRITE can
     truncate an inode to size 0
   - F2FS_IOC_START_ATOMIC_WRITE + F2FS_IOC_ABORT_ATOMIC_WRITE can revert
     changes another process concurrently made to a file

  Fix it by requiring FMODE_WRITE for these operations, just like for
  F2FS_IOC_MOVE_RANGE. Since any legitimate caller should only be using these
  ioctls when intending to write into the file, that seems unlikely to break
  anything.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47740
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/000bab8753ae29a259feb339b99ee759795a48ac
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/32f348ecc149e9ca70a1c424ae8fa9b6919d2713
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4583290898c13c2c2e5eb8773886d153c2c5121d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4ce87674c3a6b4d3b3d45f85b584ab8618a3cece
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4f5a100f87f32cb65d4bb1ad282a08c92f6f591e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e0de753bfe87768ebe6744d869caa92f35e5731
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/700f3a7c7fa5764c9f24bbf7c78e0b6e479fa653
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/88ff021e1fea2d9b40b2d5efd9013c89f7be04ac
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f3bfac2cabf5333506b263bc0c8497c95302f32d
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47740
    reference_type:
    reference_id: CVE-2024-47740
