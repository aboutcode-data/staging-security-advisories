advisory_id: CVE-2022-49195
datasource_id: nvd_importer_v2/CVE-2022-49195
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49195
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: dsa: fix panic on shutdown if multi-chip tree failed to probe

  DSA probing is atypical because a tree of devices must probe all at
  once, so out of N switches which call dsa_tree_setup_routing_table()
  during probe, for (N - 1) of them, "complete" will return false and they
  will exit probing early. The Nth switch will set up the whole tree on
  their behalf.

  The implication is that for (N - 1) switches, the driver binds to the
  device successfully, without doing anything. When the driver is bound,
  the ->shutdown() method may run. But if the Nth switch has failed to
  initialize the tree, there is nothing to do for the (N - 1) driver
  instances, since the slave devices have not been created, etc. Moreover,
  dsa_switch_shutdown() expects that the calling @ds has been in fact
  initialized, so it jumps at dereferencing the various data structures,
  which is incorrect.

  Avoid the ensuing NULL pointer dereferences by simply checking whether
  the Nth switch has previously set "ds->setup = true" for the switch
  which is currently shutting down. The entire setup is serialized under
  dsa2_mutex which we already hold.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49195
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/8fd36358ce82382519b50b05f437493e1e00c4a9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95df5cd5a446df6738d2d45872e08594819080e4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b6e668ff43ebd87ccc8a19e5481345c428672295
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b864d5350c18bea9369d0bdd9e7eb6f6172cc283
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49195
    reference_type:
    reference_id: CVE-2022-49195
