advisory_id: CVE-2025-40160
datasource_id: nvd_importer_v2/CVE-2025-40160
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40160
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  xen/events: Return -EEXIST for bound VIRQs

  Change find_virq() to return -EEXIST when a VIRQ is bound to a
  different CPU than the one passed in.  With that, remove the BUG_ON()
  from bind_virq_to_irq() to propogate the error upwards.

  Some VIRQs are per-cpu, but others are per-domain or global.  Those must
  be bound to CPU0 and can then migrate elsewhere.  The lookup for
  per-domain and global will probably fail when migrated off CPU 0,
  especially when the current CPU is tracked.  This now returns -EEXIST
  instead of BUG_ON().

  A second call to bind a per-domain or global VIRQ is not expected, but
  make it non-fatal to avoid trying to look up the irq, since we don't
  know which per_cpu(virq_to_irq) it will be in.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/07ce121d93a5e5fb2440a24da3dbf408fcee978e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/612ef6056855c0aacb9b25d1d853c435754483f7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a1e7f07ae6b594f1ba5be46c6125b43bc505c5aa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f81db055a793eca9d05f79658ff62adafb41d664
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40160
    reference_type:
    reference_id: CVE-2025-40160
