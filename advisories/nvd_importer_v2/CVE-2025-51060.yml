advisory_id: CVE-2025-51060
datasource_id: nvd_importer_v2/CVE-2025-51060
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-51060
aliases: []
summary: An issue was discovered in CPUID cpuz.sys 1.0.5.4. An attacker can use DeviceIoControl
  with the unvalidated parameters 0x9C402440 and 0x9C402444 as IoControlCodes to perform RDMSR
  and WRMSR, respectively. Through this process, the attacker can modify MSR_LSTAR and hook
  KiSystemCall64. Afterward, using Return-Oriented Programming (ROP), the attacker can manipulate
  the stack with pre-prepared gadgets, disable the SMAP flag in the CR4 register, and execute
  a user-mode syscall handler in the kernel context. It has not been confirmed whether this
  works on 32-bit Windows, but it functions on 64-bit Windows if the core isolation feature
  is either absent or disabled.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-51060
weaknesses:
  - CWE-284
references:
  - url: http://cpuid.com
    reference_type:
    reference_id:
  - url: http://cpuzsys.com
    reference_type:
    reference_id:
  - url: https://github.com/ZiaLib/Zmsr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:cpuid:cpuz.sys:1.0.5.4:*:*:*:*:windows:*:*
    reference_type:
    reference_id: cpe:2.3:a:cpuid:cpuz.sys:1.0.5.4:*:*:*:*:windows:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-51060
    reference_type:
    reference_id: CVE-2025-51060
