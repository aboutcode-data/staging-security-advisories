advisory_id: CVE-2021-46969
datasource_id: nvd_importer_v2/CVE-2021-46969
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-46969
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bus: mhi: core: Fix invalid error returning in mhi_queue

  mhi_queue returns an error when the doorbell is not accessible in
  the current state. This can happen when the device is in non M0
  state, like M3, and needs to be waken-up prior ringing the DB. This
  case is managed earlier by triggering an asynchronous M3 exit via
  controller resume/suspend callbacks, that in turn will cause M0
  transition and DB update.

  So, since it's not an error but just delaying of doorbell update, there
  is no reason to return an error.

  This also fixes a use after free error for skb case, indeed a caller
  queuing skb will try to free the skb if the queueing fails, but in
  that case queueing has been done.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46969
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/0ecc1c70dcd32c0f081b173a1a5d89952686f271
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a99b661c3187365f81026d89b1133a76cd2652b3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-46969
    reference_type:
    reference_id: CVE-2021-46969
