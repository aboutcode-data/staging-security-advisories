advisory_id: CVE-2024-43402
datasource_id: nvd_importer_v2/CVE-2024-43402
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-43402
aliases: []
summary: Rust is a programming language. The fix for CVE-2024-24576, where `std::process::Command`
  incorrectly escaped arguments when invoking batch files on Windows, was incomplete. Prior
  to Rust version 1.81.0, it was possible to bypass the fix when the batch file name had trailing
  whitespace or periods (which are ignored and stripped by Windows). To determine whether to
  apply the `cmd.exe` escaping rules, the original fix for the vulnerability checked whether
  the command name ended with `.bat` or `.cmd`. At the time that seemed enough, as we refuse
  to invoke batch scripts with no file extension. Windows removes trailing whitespace and periods
  when parsing file paths. For example, `.bat. .` is interpreted by Windows as `.bat`, but the
  original fix didn't check for that. Affected users who are using Rust 1.77.2 or greater can
  remove the trailing whitespace (ASCII 0x20) and trailing periods (ASCII 0x2E) from the batch
  file name to bypass the incomplete fix and enable the mitigations. Users are affected if their
  code or one of their dependencies invoke a batch script on Windows with trailing whitespace
  or trailing periods in the name, and pass untrusted arguments to it. Rust 1.81.0 will update
  the standard library to apply the CVE-2024-24576 mitigations to all batch files invocations,
  regardless of the trailing chars in the file name.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-43402
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-43402
weaknesses:
  - CWE-88
  - CWE-78
references:
  - url: https://blog.rust-lang.org/2024/04/09/cve-2024-24576.html
    reference_type:
    reference_id:
  - url: https://github.com/rust-lang/rust/security/advisories/GHSA-2xg3-7mm6-98jj
    reference_type:
    reference_id:
  - url: https://learn.microsoft.com/en-us/troubleshoot/windows-client/shell-experience/file-folder-name-whitespace-characters
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:rust-lang:rust:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:rust-lang:rust:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43402
    reference_type:
    reference_id: CVE-2024-43402
