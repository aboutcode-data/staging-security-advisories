advisory_id: CVE-2024-57924
datasource_id: nvd_importer_v2/CVE-2024-57924
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-57924
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fs: relax assertions on failure to encode file handles

  Encoding file handles is usually performed by a filesystem >encode_fh()
  method that may fail for various reasons.

  The legacy users of exportfs_encode_fh(), namely, nfsd and
  name_to_handle_at(2) syscall are ready to cope with the possibility
  of failure to encode a file handle.

  There are a few other users of exportfs_encode_{fh,fid}() that
  currently have a WARN_ON() assertion when ->encode_fh() fails.
  Relax those assertions because they are wrong.

  The second linked bug report states commit 16aac5ad1fa9 ("ovl: support
  encoding non-decodable file handles") in v6.6 as the regressing commit,
  but this is not accurate.

  The aforementioned commit only increases the chances of the assertion
  and allows triggering the assertion with the reproducer using overlayfs,
  inotify and drop_caches.

  Triggering this assertion was always possible with other filesystems and
  other reasons of ->encode_fh() failures and more particularly, it was
  also possible with the exact same reproducer using overlayfs that is
  mounted with options index=on,nfs_export=on also on kernels < v6.6.
  Therefore, I am not listing the aforementioned commit as a Fixes commit.

  Backport hint: this patch will have a trivial conflict applying to
  v6.6.y, and other trivial conflicts applying to stable kernels < v6.6.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-57924
weaknesses:
  - CWE-617
references:
  - url: https://git.kernel.org/stable/c/73697928c806fe4689939722184a86fc1c1957b4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/974e3fe0ac61de85015bbe5a4990cf4127b304b2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/adcde2872f8fc399b249758ae1990dcd53b694ea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f47c834a9131ae64bee3c462f4e610c67b0a000f
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-57924
    reference_type:
    reference_id: CVE-2024-57924
