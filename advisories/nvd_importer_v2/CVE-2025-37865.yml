advisory_id: CVE-2025-37865
datasource_id: nvd_importer_v2/CVE-2025-37865
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37865
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: dsa: mv88e6xxx:\
  \ fix -ENOENT when deleting VLANs and MST is unsupported\n\nRussell King reports that on the\
  \ ZII dev rev B, deleting a bridge VLAN\nfrom a user port fails with -ENOENT:\nhttps://lore.kernel.org/netdev/Z_lQXNP0s5-IiJzd@shell.armlinux.org.uk/\n\
  \nThis comes from mv88e6xxx_port_vlan_leave() -> mv88e6xxx_mst_put(),\nwhich tries to find\
  \ an MST entry in &chip->msts associated with the SID,\nbut fails and returns -ENOENT as such.\n\
  \nBut we know that this chip does not support MST at all, so that is not\nsurprising. The\
  \ question is why does the guard in mv88e6xxx_mst_put()\nnot exit early:\n\n\tif (!sid)\n\t\
  \treturn 0;\n\nAnd the answer seems to be simple: the sid comes from vlan.sid which\nsupposedly\
  \ was previously populated by mv88e6xxx_vtu_get().\nBut some chip->info->ops->vtu_getnext()\
  \ implementations do not populate\nvlan.sid, for example see mv88e6185_g1_vtu_getnext(). In\
  \ that case,\nlater in mv88e6xxx_port_vlan_leave() we are using a garbage sid which is\njust\
  \ residual stack memory.\n\nTesting for sid == 0 covers all cases of a non-bridge VLAN or\
  \ a bridge\nVLAN mapped to the default MSTI. For some chips, SID 0 is valid and\ninstalled\
  \ by mv88e6xxx_stu_setup(). A chip which does not support the\nSTU would implicitly only support\
  \ mapping all VLANs to the default MSTI,\nso although SID 0 is not valid, it would be sufficient,\
  \ if we were to\nzero-initialize the vlan structure, to fix the bug, due to the\ncoincidence\
  \ that a test for vlan.sid == 0 already exists and leads to\nthe same (correct) behavior.\n\
  \nAnother option which would be sufficient would be to add a test for\nmv88e6xxx_has_stu()\
  \ inside mv88e6xxx_mst_put(), symmetric to the one\nwhich already exists in mv88e6xxx_mst_get().\
  \ But that placement means\nthe caller will have to dereference vlan.sid, which means it will\
  \ access\nuninitialized memory, which is not nice even if it ignores it later.\n\nSo we end\
  \ up making both modifications, in order to not rely just on the\nsid == 0 coincidence, but\
  \ also to avoid having uninitialized structure\nfields which might get temporarily accessed."
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37865
weaknesses:
  - CWE-908
references:
  - url: https://git.kernel.org/stable/c/35cde75c08a1fa1a5ac0467afe2709caceeef002
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9da4acbd60664271d34a627f7f63cd5bad8eba74
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ee6d3a368ed34f2457863da3085c676e9e37a3d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/afae9087301471970254a9180e5a26d3d8e8af09
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ea08dfc35f83cfc73493c52f63ae4f2e29edfe8d
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37865
    reference_type:
    reference_id: CVE-2025-37865
