advisory_id: CVE-2021-29534
datasource_id: nvd_importer_v2/CVE-2021-29534
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-29534
aliases: []
summary: TensorFlow is an end-to-end open source platform for machine learning. An attacker
  can trigger a denial of service via a `CHECK`-fail in `tf.raw_ops.SparseConcat`. This is because
  the implementation(https://github.com/tensorflow/tensorflow/blob/b432a38fe0e1b4b904a6c222cbce794c39703e87/tensorflow/core/kernels/sparse_concat_op.cc#L76)
  takes the values specified in `shapes[0]` as dimensions for the output shape. The `TensorShape`
  constructor(https://github.com/tensorflow/tensorflow/blob/6f9896890c4c703ae0a0845394086e2e1e523299/tensorflow/core/framework/tensor_shape.cc#L183-L188)
  uses a `CHECK` operation which triggers when `InitDims`(https://github.com/tensorflow/tensorflow/blob/6f9896890c4c703ae0a0845394086e2e1e523299/tensorflow/core/framework/tensor_shape.cc#L212-L296)
  returns a non-OK status. This is a legacy implementation of the constructor and operations
  should use `BuildTensorShapeBase` or `AddDimWithStatus` to prevent `CHECK`-failures in the
  presence of overflows. The fix will be included in TensorFlow 2.5.0. We will also cherrypick
  this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4,
  as these are also affected and still in supported range.
impacted_packages: []
severities:
  - score: '2.1'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29534
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29534
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29534
weaknesses:
  - CWE-754
references:
  - url: https://github.com/tensorflow/tensorflow/commit/69c68ecbb24dff3fa0e46da0d16c821a2dd22d7c
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-6j9c-grc6-5m6g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29534
    reference_type:
    reference_id: CVE-2021-29534
