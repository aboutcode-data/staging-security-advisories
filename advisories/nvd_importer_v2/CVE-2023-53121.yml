advisory_id: CVE-2023-53121
datasource_id: nvd_importer_v2/CVE-2023-53121
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53121
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tcp: tcp_make_synack() can be called from process context

  tcp_rtx_synack() now could be called in process context as explained in
  0a375c822497 ("tcp: tcp_rtx_synack() can be called from process
  context").

  tcp_rtx_synack() might call tcp_make_synack(), which will touch per-CPU
  variables with preemption enabled. This causes the following BUG:

      BUG: using __this_cpu_add() in preemptible [00000000] code: ThriftIO1/5464
      caller is tcp_make_synack+0x841/0xac0
      Call Trace:
       <TASK>
       dump_stack_lvl+0x10d/0x1a0
       check_preemption_disabled+0x104/0x110
       tcp_make_synack+0x841/0xac0
       tcp_v6_send_synack+0x5c/0x450
       tcp_rtx_synack+0xeb/0x1f0
       inet_rtx_syn_ack+0x34/0x60
       tcp_check_req+0x3af/0x9e0
       tcp_rcv_state_process+0x59b/0x2030
       tcp_v6_do_rcv+0x5f5/0x700
       release_sock+0x3a/0xf0
       tcp_sendmsg+0x33/0x40
       ____sys_sendmsg+0x2f2/0x490
       __sys_sendmsg+0x184/0x230
       do_syscall_64+0x3d/0x90

  Avoid calling __TCP_INC_STATS() with will touch per-cpu variables. Use
  TCP_INC_STATS() which is safe to be called from context switch.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53121
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/442aa78ed70188b21ccd8669738448702c0a3281
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7613cde8c0c1f02a7ec2e1d536c01b65b135fc1c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/77ad58bca0119e8cc3e0e9d91a3f22caa66e4dfa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9180aa4622a720b433e842b4d3aa34d73eec577a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ad07290d63ff6689f50565b02f5b6f34ec15a5ca
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bced3f7db95ff2e6ca29dc4d1c9751ab5e736a09
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d493d4fe88195a144d6a277a90062a7534ed2192
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e23ca307745be3df7fe9762f3e2a7e311a57852e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.3:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.3:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.3:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.3:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53121
    reference_type:
    reference_id: CVE-2023-53121
