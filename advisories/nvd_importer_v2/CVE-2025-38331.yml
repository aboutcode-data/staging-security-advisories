advisory_id: CVE-2025-38331
datasource_id: nvd_importer_v2/CVE-2025-38331
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38331
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: ethernet: cortina: Use TOE/TSO on all TCP

  It is desireable to push the hardware accelerator to also
  process non-segmented TCP frames: we pass the skb->len
  to the "TOE/TSO" offloader and it will handle them.

  Without this quirk the driver becomes unstable and lock
  up and and crash.

  I do not know exactly why, but it is probably due to the
  TOE (TCP offload engine) feature that is coupled with the
  segmentation feature - it is not possible to turn one
  part off and not the other, either both TOE and TSO are
  active, or neither of them.

  Not having the TOE part active seems detrimental, as if
  that hardware feature is not really supposed to be turned
  off.

  The datasheet says:

    "Based on packet parsing and TCP connection/NAT table
     lookup results, the NetEngine puts the packets
     belonging to the same TCP connection to the same queue
     for the software to process. The NetEngine puts
     incoming packets to the buffer or series of buffers
     for a jumbo packet. With this hardware acceleration,
     IP/TCP header parsing, checksum validation and
     connection lookup are offloaded from the software
     processing."

  After numerous tests with the hardware locking up after
  something between minutes and hours depending on load
  using iperf3 I have concluded this is necessary to stabilize
  the hardware.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38331
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1b503b790109d19710ec83c589c3ee59e95347ec
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2bd434bb0eeb680c2b3dd6c68ca319b30cb8d47f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6a07e3af4973402fa199a80036c10060b922c92c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a37888a435b0737128d2d9c6f67b8d608f83df7a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ebe12e232f1d58ebb4b53b6d9149962b707bed91
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38331
    reference_type:
    reference_id: CVE-2025-38331
