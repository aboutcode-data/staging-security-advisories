advisory_id: CVE-2022-50222
datasource_id: nvd_importer_v2/CVE-2022-50222
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50222
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tty: vt: initialize unicode screen buffer

  syzbot reports kernel infoleak at vcs_read() [1], for buffer can be read
  immediately after resize operation. Initialize buffer using kzalloc().

    ----------
    #include <fcntl.h>
    #include <unistd.h>
    #include <sys/ioctl.h>
    #include <linux/fb.h>

    int main(int argc, char *argv[])
    {
      struct fb_var_screeninfo var = { };
      const int fb_fd = open("/dev/fb0", 3);
      ioctl(fb_fd, FBIOGET_VSCREENINFO, &var);
      var.yres = 0x21;
      ioctl(fb_fd, FBIOPUT_VSCREENINFO, &var);
      return read(open("/dev/vcsu", O_RDONLY), &var, sizeof(var)) == -1;
    }
    ----------
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50222
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/446f123aa6021e5f75a20789f05ff3f7ae51a42f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5c6c65681f39bf71bc72ed589dec3b8b20e75cac
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/777a462e1ae50a01fc4a871efa8e34d596a1e17d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/af77c56aa35325daa2bc2bed5c2ebf169be61b86
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cc9e874dace0c89ae535230c7da19b764746811e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e02fa87e572bb7d90dcdbce9c0f519f1eb992e96
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e0ef23e9b0ad18b9fd3741b0f1ad2282e4a18def
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50222
    reference_type:
    reference_id: CVE-2022-50222
