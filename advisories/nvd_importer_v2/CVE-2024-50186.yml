advisory_id: CVE-2024-50186
datasource_id: nvd_importer_v2/CVE-2024-50186
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-50186
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: explicitly clear the sk pointer, when pf->create fails

  We have recently noticed the exact same KASAN splat as in commit
  6cd4a78d962b ("net: do not leave a dangling sk pointer, when socket
  creation fails"). The problem is that commit did not fully address the
  problem, as some pf->create implementations do not use sk_common_release
  in their error paths.

  For example, we can use the same reproducer as in the above commit, but
  changing ping to arping. arping uses AF_PACKET socket and if packet_create
  fails, it will just sk_free the allocated sk object.

  While we could chase all the pf->create implementations and make sure they
  NULL the freed sk object on error from the socket, we can't guarantee
  future protocols will not make the same mistake.

  So it is easier to just explicitly NULL the sk pointer upon return from
  pf->create in __sock_create. We do know that pf->create always releases the
  allocated sk object on error, so if the pointer is not NULL, it is
  definitely dangling.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50186
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/563e6892e21d6ecabdf62103fc4e7b326d212334
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/631083143315d1b192bd7d915b967b37819e88ea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8e1b72fd74bf9da3b099d09857f4e7f114f38e12
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b7d22a79ff4e962b8af5ffe623abd1d6c179eb9f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/daf462ff3cde6ecf22b98d9ae770232c10d28de2
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50186
    reference_type:
    reference_id: CVE-2024-50186
