advisory_id: CVE-2021-32708
datasource_id: nvd_importer_v2/CVE-2021-32708
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-32708
aliases: []
summary: 'Flysystem is an open source file storage library for PHP. The whitespace normalisation
  using in 1.x and 2.x removes any unicode whitespace. Under certain specific conditions this
  could potentially allow a malicious user to execute code remotely. The conditions are: A user
  is allowed to supply the path or filename of an uploaded file, the supplied path or filename
  is not checked against unicode chars, the supplied pathname checked against an extension deny-list,
  not an allow-list, the supplied path or filename contains a unicode whitespace char in the
  extension, the uploaded file is stored in a directory that allows PHP code to be executed.
  Given these conditions are met a user can upload and execute arbitrary code on the system
  under attack. The unicode whitespace removal has been replaced with a rejection (exception).
  For 1.x users, upgrade to 1.1.4. For 2.x users, upgrade to 2.1.1.'
impacted_packages: []
severities:
  - score: '9.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32708
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32708
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32708
weaknesses:
  - CWE-367
references:
  - url: https://github.com/thephpleague/flysystem/commit/a3c694de9f7e844b76f9d1b61296ebf6e8d89d74
    reference_type:
    reference_id:
  - url: https://github.com/thephpleague/flysystem/commit/f3ad69181b8afed2c9edf7be5a2918144ff4ea32
    reference_type:
    reference_id:
  - url: https://github.com/thephpleague/flysystem/security/advisories/GHSA-9f46-5r25-5wfm
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NWPTENBYKI2IG47GI4DHAACLNRLTWUR5/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RNZSWK4GOMJOOHKLZEOE5AQSLC4DNCRZ/
    reference_type:
    reference_id:
  - url: https://packagist.org/packages/league/flysystem
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:thephpleague:flysystem:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:thephpleague:flysystem:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32708
    reference_type:
    reference_id: CVE-2021-32708
