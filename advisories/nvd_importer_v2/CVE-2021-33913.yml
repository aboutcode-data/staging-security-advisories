advisory_id: CVE-2021-33913
datasource_id: nvd_importer_v2/CVE-2021-33913
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-33913
aliases: []
summary: libspf2 before 1.2.11 has a heap-based buffer overflow that might allow remote attackers
  to execute arbitrary code (via an unauthenticated e-mail message from anywhere on the Internet)
  with a crafted SPF DNS record, because of SPF_record_expand_data in spf_expand.c. The amount
  of overflowed data depends on the relationship between the length of an entire domain name
  and the length of its leftmost label. The vulnerable code may be part of the supply chain
  of a site's e-mail infrastructure (e.g., with additional configuration, Exim can use libspf2;
  the Postfix web site links to unofficial patches for use of libspf2 with Postfix; older versions
  of spfquery relied on libspf2) but most often is not.
impacted_packages: []
severities:
  - score: '9.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-33913
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-33913
weaknesses:
  - CWE-787
references:
  - url: https://github.com/shevek/libspf2/tree/8131fe140704eaae695e76b5cd09e39bd1dd220b
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/01/msg00015.html
    reference_type:
    reference_id:
  - url: https://nathanielbennett.com/blog/libspf2-cve-jan-2022-disclosure
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202401-22
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:libspf2_project:libspf2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:libspf2_project:libspf2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-33913
    reference_type:
    reference_id: CVE-2021-33913
