advisory_id: CVE-2021-47258
datasource_id: nvd_importer_v2/CVE-2021-47258
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47258
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: core: Fix error handling of scsi_host_alloc()

  After device is initialized via device_initialize(), or its name is set via
  dev_set_name(), the device has to be freed via put_device().  Otherwise
  device name will be leaked because it is allocated dynamically in
  dev_set_name().

  Fix the leak by replacing kfree() with put_device(). Since
  scsi_host_dev_release() properly handles IDA and kthread removal, remove
  special-casing these from the error handling as well.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47258
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/2dc85045ae65b9302a1d2e2ddd7ce4c030153a6a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/45d83db4728127944b237c0c8248987df9d478e7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/66a834d092930cf41d809c0e989b13cd6f9ca006
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/79296e292d67fa7b5fb8d8c27343683e823872c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7a696ce1d5d16a33a6cd6400bbcc0339b2460e11
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8958181c1663e24a13434448e7d6b96b5d04900a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db08ce595dd64ea9859f7d088b51cbfc8e685c66
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47258
    reference_type:
    reference_id: CVE-2021-47258
