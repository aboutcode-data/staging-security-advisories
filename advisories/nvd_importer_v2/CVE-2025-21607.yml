advisory_id: CVE-2025-21607
datasource_id: nvd_importer_v2/CVE-2025-21607
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21607
aliases: []
summary: Vyper is a Pythonic Smart Contract Language for the EVM. When the Vyper Compiler uses
  the precompiles EcRecover (0x1) and Identity (0x4), the success flag of the call is not checked.
  As a consequence an attacker can provide a specific amount of gas to make these calls fail
  but let the overall execution continue. Then the execution result can be incorrect. Based
  on EVM's rules, after the failed precompile the remaining code has only 1/64 of the pre-call-gas
  left (as 63/64 were forwarded and spent). Hence, only fairly simple executions can follow
  the failed precompile calls. Therefore, we found no significantly impacted real-world contracts.
  None the less an advisory has been made out of an abundance of caution. This issue is fixed
  in 0.4.1.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21607
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:P/PR:L/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21607
weaknesses:
  - CWE-670
references:
  - url: https://github.com/vyperlang/vyper/commit/7136eab0a254aa2ff7ddca41cc05f2ee1fa99caf
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/pull/4451
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-vgf2-gvx8-xwc3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vyperlang:vyper:*:-:*:*:*:python:*:*
    reference_type:
    reference_id: cpe:2.3:a:vyperlang:vyper:*:-:*:*:*:python:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21607
    reference_type:
    reference_id: CVE-2025-21607
