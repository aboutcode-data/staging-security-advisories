advisory_id: CVE-2022-50229
datasource_id: nvd_importer_v2/CVE-2022-50229
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50229
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ALSA: bcd2000: Fix a UAF bug on the error path of probing

  When the driver fails in snd_card_register() at probe time, it will free
  the 'bcd2k->midi_out_urb' before killing it, which may cause a UAF bug.

  The following log can reveal it:

  [   50.727020] BUG: KASAN: use-after-free in bcd2000_input_complete+0x1f1/0x2e0 [snd_bcd2000]
  [   50.727623] Read of size 8 at addr ffff88810fab0e88 by task swapper/4/0
  [   50.729530] Call Trace:
  [   50.732899]  bcd2000_input_complete+0x1f1/0x2e0 [snd_bcd2000]

  Fix this by adding usb_kill_urb() before usb_free_urb().
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50229
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/05e0bb8c3c4dde3e21b9c1cf9395afb04e8b24db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1d6a246cf97c380f2da76591f03019dd9c9599c3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/348620464a5c127399ac09b266f494f393661952
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4fc41f7ebb7efca282f1740ea934d16f33c1d109
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e7338f4dd92b2f8915a82abfa1dd3ad3464bea0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/64ca7f50ad96c2c65ae390b954925a36eabe04aa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a718eba7e458e2f40531be3c6b6a0028ca7fcace
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b0d4af0a4763ddc02344789ef2a281c494bc330d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ffb2759df7efbc00187bfd9d1072434a13a54139
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50229
    reference_type:
    reference_id: CVE-2022-50229
