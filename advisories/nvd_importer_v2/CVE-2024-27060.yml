advisory_id: CVE-2024-27060
datasource_id: nvd_importer_v2/CVE-2024-27060
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-27060
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  thunderbolt: Fix NULL pointer dereference in tb_port_update_credits()

  Olliver reported that his system crashes when plugging in Thunderbolt 1
  device:

   BUG: kernel NULL pointer dereference, address: 0000000000000020
   #PF: supervisor read access in kernel mode
   #PF: error_code(0x0000) - not-present page
   PGD 0 P4D 0
   Oops: 0000 [#1] PREEMPT SMP NOPTI
   RIP: 0010:tb_port_do_update_credits+0x1b/0x130 [thunderbolt]
   Call Trace:
    <TASK>
    ? __die+0x23/0x70
    ? page_fault_oops+0x171/0x4e0
    ? exc_page_fault+0x7f/0x180
    ? asm_exc_page_fault+0x26/0x30
    ? tb_port_do_update_credits+0x1b/0x130
    ? tb_switch_update_link_attributes+0x83/0xd0
    tb_switch_add+0x7a2/0xfe0
    tb_scan_port+0x236/0x6f0
    tb_handle_hotplug+0x6db/0x900
    process_one_work+0x171/0x340
    worker_thread+0x27b/0x3a0
    ? __pfx_worker_thread+0x10/0x10
    kthread+0xe5/0x120
    ? __pfx_kthread+0x10/0x10
    ret_from_fork+0x31/0x50
    ? __pfx_kthread+0x10/0x10
    ret_from_fork_asm+0x1b/0x30
    </TASK>

  This is due the fact that some Thunderbolt 1 devices only have one lane
  adapter. Fix this by checking for the lane 1 before we read its credits.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-27060
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/440fba897c5ae32d7df1f1d609dbb19e2bba7fbb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ce64ba1f6ec3439e4b4d880b4db99673f4507228
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d3d17e23d1a0d1f959b4fa55b35f1802d9c584fa
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-27060
    reference_type:
    reference_id: CVE-2024-27060
