advisory_id: CVE-2024-41088
datasource_id: nvd_importer_v2/CVE-2024-41088
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-41088
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  can: mcp251xfd: fix infinite loop when xmit fails

  When the mcp251xfd_start_xmit() function fails, the driver stops
  processing messages, and the interrupt routine does not return,
  running indefinitely even after killing the running application.

  Error messages:
  [  441.298819] mcp251xfd spi2.0 can0: ERROR in mcp251xfd_start_xmit: -16
  [  441.306498] mcp251xfd spi2.0 can0: Transmit Event FIFO buffer not empty. (seq=0x000017c7, tef_tail=0x000017cf, tef_head=0x000017d0, tx_head=0x000017d3).
  ... and repeat forever.

  The issue can be triggered when multiple devices share the same SPI
  interface. And there is concurrent access to the bus.

  The problem occurs because tx_ring->head increments even if
  mcp251xfd_start_xmit() fails. Consequently, the driver skips one TX
  package while still expecting a response in
  mcp251xfd_handle_tefif_one().

  Resolve the issue by starting a workqueue to write the tx obj
  synchronously if err = -EBUSY. In case of another error, decrement
  tx_ring->head, remove skb from the echo stack, and drop the message.

  [mkl: use more imperative wording in patch description]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41088
weaknesses:
  - CWE-835
references:
  - url: https://git.kernel.org/stable/c/3e72558c1711d524e3150103739ddd06650e291b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6c6b4afa59c2fb4d1759235f866d8caed2aa4729
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d8fb63e46c884c898a38f061c2330f7729e75510
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f926c022ebaabf7963bebf89a97201d66978a025
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41088
    reference_type:
    reference_id: CVE-2024-41088
