advisory_id: CVE-2022-50616
datasource_id: nvd_importer_v2/CVE-2022-50616
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50616
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nregulator:\
  \ core: Use different devices for resource allocation and DT lookup\n\nFollowing by the below\
  \ discussion, there's the potential UAF issue\nbetween regulator and mfd.\nhttps://lore.kernel.org/all/20221128143601.1698148-1-yangyingliang@huawei.com/\n\
  \nFrom the analysis of Yingliang\n\nCPU A\t\t\t\t|CPU B\nmt6370_probe()\t\t\t|\n  devm_mfd_add_devices()\t\
  |\n\t\t\t\t|mt6370_regulator_probe()\n\t\t\t\t|  regulator_register()\n\t\t\t\t|    //allocate\
  \ init_data and add it to devres\n\t\t\t\t|    regulator_of_get_init_data()\ni2c_unregister_device()\t\
  \t|\n  device_del()\t\t\t|\n    devres_release_all()\t|\n      // init_data is freed\t|\n\
  \      release_nodes()\t\t|\n\t\t\t\t|  // using init_data causes UAF\n\t\t\t\t|  regulator_register()\n\
  \nIt's common to use mfd core to create child device for the regulator.\nIn order to do the\
  \ DT lookup for init data, the child that registered\nthe regulator would pass its parent\
  \ as the parameter. And this causes\ninit data resource allocated to its parent, not itself.\
  \ The issue happen\nwhen parent device is going to release and regulator core is still doing\n\
  some operation of init data constraint for the regulator of child device.\n\nTo fix it, this\
  \ patch expand 'regulator_register' API to use the\ndifferent devices for init data allocation\
  \ and DT lookup."
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/8f3cbcd6b440032ebc7f7d48a1689dcc70a4eb98
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b0f25ca1ff9be7abd1679ae7e59a8f25dbffe67a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cb29811d989bcb7ea81ca111c4b13878b344e086
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50616
    reference_type:
    reference_id: CVE-2022-50616
