advisory_id: CVE-2025-39805
datasource_id: nvd_importer_v2/CVE-2025-39805
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39805
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: macb: fix unregister_netdev call order in macb_remove()

  When removing a macb device, the driver calls phy_exit() before
  unregister_netdev(). This leads to a WARN from kernfs:

    ------------[ cut here ]------------
    kernfs: can not remove 'attached_dev', no directory
    WARNING: CPU: 1 PID: 27146 at fs/kernfs/dir.c:1683
    Call trace:
      kernfs_remove_by_name_ns+0xd8/0xf0
      sysfs_remove_link+0x24/0x58
      phy_detach+0x5c/0x168
      phy_disconnect+0x4c/0x70
      phylink_disconnect_phy+0x6c/0xc0 [phylink]
      macb_close+0x6c/0x170 [macb]
      ...
      macb_remove+0x60/0x168 [macb]
      platform_remove+0x5c/0x80
      ...

  The warning happens because the PHY is being exited while the netdev
  is still registered. The correct order is to unregister the netdev
  before shutting down the PHY and cleaning up the MDIO bus.

  Fix this by moving unregister_netdev() ahead of phy_exit() in
  macb_remove().
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39805
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/01b9128c5db1b470575d07b05b67ffa3cb02ebf1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2b9719ccad38dffad7dbdd2f39896f723f9b9011
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7351782f2fc8ac31ced52e3d4e6fa120f819a7ab
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/775fe690fd4a3337ad2115de2adb41b227d4dae7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff0d3bad32108b57265e5b48f15327549af771d3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39805
    reference_type:
    reference_id: CVE-2025-39805
