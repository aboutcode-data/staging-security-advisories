advisory_id: CVE-2025-39809
datasource_id: nvd_importer_v2/CVE-2025-39809
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39809
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  HID: intel-thc-hid: intel-quicki2c: Fix ACPI dsd ICRS/ISUB length

  The QuickI2C ACPI _DSD methods return ICRS and ISUB data with a
  trailing byte, making the actual length is one more byte than the
  structs defined.

  It caused stack-out-of-bounds and kernel crash:

  kernel: BUG: KASAN: stack-out-of-bounds in quicki2c_acpi_get_dsd_property.constprop.0+0x111/0x1b0 [intel_quicki2c]
  kernel: Write of size 12 at addr ffff888106d1f900 by task kworker/u33:2/75
  kernel:
  kernel: CPU: 3 UID: 0 PID: 75 Comm: kworker/u33:2 Not tainted 6.16.0+ #3 PREEMPT(voluntary)
  kernel: Workqueue: async async_run_entry_fn
  kernel: Call Trace:
  kernel:  <TASK>
  kernel:  dump_stack_lvl+0x76/0xa0
  kernel:  print_report+0xd1/0x660
  kernel:  ? __pfx__raw_spin_lock_irqsave+0x10/0x10
  kernel:  ? __kasan_slab_free+0x5d/0x80
  kernel:  ? kasan_addr_to_slab+0xd/0xb0
  kernel:  kasan_report+0xe1/0x120
  kernel:  ? quicki2c_acpi_get_dsd_property.constprop.0+0x111/0x1b0 [intel_quicki2c]
  kernel:  ? quicki2c_acpi_get_dsd_property.constprop.0+0x111/0x1b0 [intel_quicki2c]
  kernel:  kasan_check_range+0x11c/0x200
  kernel:  __asan_memcpy+0x3b/0x80
  kernel:  quicki2c_acpi_get_dsd_property.constprop.0+0x111/0x1b0 [intel_quicki2c]
  kernel:  ? __pfx_quicki2c_acpi_get_dsd_property.constprop.0+0x10/0x10 [intel_quicki2c]
  kernel:  quicki2c_get_acpi_resources+0x237/0x730 [intel_quicki2c]
  [...]
  kernel:  </TASK>
  kernel:
  kernel: The buggy address belongs to stack of task kworker/u33:2/75
  kernel:  and is located at offset 48 in frame:
  kernel:  quicki2c_get_acpi_resources+0x0/0x730 [intel_quicki2c]
  kernel:
  kernel: This frame has 3 objects:
  kernel:  [32, 36) 'hid_desc_addr'
  kernel:  [48, 59) 'i2c_param'
  kernel:  [80, 224) 'i2c_config'

  ACPI DSD methods return:

  \_SB.PC00.THC0.ICRS Buffer       000000003fdc947b 001 Len 0C = 0A 00 80 1A 06 00 00 00 00 00 00 00
  \_SB.PC00.THC0.ISUB Buffer       00000000f2fcbdc4 001 Len 91 = 00 00 00 00 00 00 00 00 00 00 00 00

  Adding reserved padding to quicki2c_subip_acpi_parameter/config.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39809
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/1db9df89a213318a48d958385dc1b17b379dc32b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4adce86d4b13d15dec7810967839b931b1598700
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39809
    reference_type:
    reference_id: CVE-2025-39809
