advisory_id: CVE-2021-21246
datasource_id: nvd_importer_v2/CVE-2021-21246
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21246
aliases: []
summary: OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, the REST UserResource
  endpoint performs a security check to make sure that only administrators can list user details.
  However for the `/users/{id}` endpoint there are no security checks enforced so it is possible
  to retrieve arbitrary user details including their Access Tokens! These access tokens can
  be used to access the API or clone code in the build spec via the HTTP(S) protocol. It has
  permissions to all projects accessible by the user account. This issue may lead to `Sensitive
  data leak` and leak the Access Token which can be used to impersonate the administrator or
  any other users. This issue was addressed in 4.0.3 by removing user info from restful api.
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21246
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21246
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21246
weaknesses:
  - CWE-862
references:
  - url: https://github.com/theonedev/onedev/commit/a4491e5f79dc6cc96eac20972eedc8905ddf6089
    reference_type:
    reference_id:
  - url: https://github.com/theonedev/onedev/security/advisories/GHSA-66v7-gg85-f4gx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21246
    reference_type:
    reference_id: CVE-2021-21246
