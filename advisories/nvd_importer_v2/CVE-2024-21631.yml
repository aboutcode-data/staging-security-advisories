advisory_id: CVE-2024-21631
datasource_id: nvd_importer_v2/CVE-2024-21631
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-21631
aliases: []
summary: Vapor is an HTTP web framework for Swift. Prior to version 4.90.0, Vapor's `vapor_urlparser_parse`
  function uses `uint16_t` indexes when parsing a URI's components, which may cause integer
  overflows when parsing untrusted inputs. This vulnerability does not affect Vapor directly
  but could impact applications relying on the URI type for validating user input. The URI type
  is used in several places in Vapor. A developer may decide to use URI to represent a URL in
  their application (especially if that URL is then passed to the HTTP Client) and rely on its
  public properties and methods. However, URI may fail to properly parse a valid (albeit abnormally
  long) URL, due to string ranges being converted to 16-bit integers. An attacker may use this
  behavior to trick the application into accepting a URL to an untrusted destination. By padding
  the port number with zeros, an attacker can cause an integer overflow to occur when the URL
  authority is parsed and, as a result, spoof the host. Version 4.90.0 contains a patch for
  this issue. As a workaround, validate user input before parsing as a URI or, if possible,
  use Foundation's `URL` and `URLComponents` utilities.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-21631
weaknesses:
  - CWE-1104
  - CWE-190
  - CWE-20
references:
  - url: https://github.com/vapor/vapor/commit/6db3d917b5ce5024a84eb265ef65691383305d70
    reference_type:
    reference_id:
  - url: https://github.com/vapor/vapor/security/advisories/GHSA-r6r4-5pr8-gjcp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vapor:vapor:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:vapor:vapor:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-21631
    reference_type:
    reference_id: CVE-2024-21631
