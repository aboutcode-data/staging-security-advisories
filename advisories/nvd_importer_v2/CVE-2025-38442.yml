advisory_id: CVE-2025-38442
datasource_id: nvd_importer_v2/CVE-2025-38442
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38442
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  block: reject bs > ps block devices when THP is disabled

  If THP is disabled and when a block device with logical block size >
  page size is present, the following null ptr deref panic happens during
  boot:

  [   [13.2 mK  AOSAN: null-ptr-deref in range [0x0000000000000000-0x0000000000K0 0 0[07]
  [   13.017749] RIP: 0010:create_empty_buffers+0x3b/0x380
  <snip>
  [   13.025448] Call Trace:
  [   13.025692]  <TASK>
  [   13.025895]  block_read_full_folio+0x610/0x780
  [   13.026379]  ? __pfx_blkdev_get_block+0x10/0x10
  [   13.027008]  ? __folio_batch_add_and_move+0x1fa/0x2b0
  [   13.027548]  ? __pfx_blkdev_read_folio+0x10/0x10
  [   13.028080]  filemap_read_folio+0x9b/0x200
  [   13.028526]  ? __pfx_filemap_read_folio+0x10/0x10
  [   13.029030]  ? __filemap_get_folio+0x43/0x620
  [   13.029497]  do_read_cache_folio+0x155/0x3b0
  [   13.029962]  ? __pfx_blkdev_read_folio+0x10/0x10
  [   13.030381]  read_part_sector+0xb7/0x2a0
  [   13.030805]  read_lba+0x174/0x2c0
  <snip>
  [   13.045348]  nvme_scan_ns+0x684/0x850 [nvme_core]
  [   13.045858]  ? __pfx_nvme_scan_ns+0x10/0x10 [nvme_core]
  [   13.046414]  ? _raw_spin_unlock+0x15/0x40
  [   13.046843]  ? __switch_to+0x523/0x10a0
  [   13.047253]  ? kvm_clock_get_cycles+0x14/0x30
  [   13.047742]  ? __pfx_nvme_scan_ns_async+0x10/0x10 [nvme_core]
  [   13.048353]  async_run_entry_fn+0x96/0x4f0
  [   13.048787]  process_one_work+0x667/0x10a0
  [   13.049219]  worker_thread+0x63c/0xf60

  As large folio support depends on THP, only allow bs > ps block devices
  if THP is enabled.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38442
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/4cdf1bdd45ac78a088773722f009883af30ad318
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b025d81b96bfe8a62b6e3e6ac776608206ccbf6d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38442
    reference_type:
    reference_id: CVE-2025-38442
