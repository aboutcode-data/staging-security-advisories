advisory_id: CVE-2023-54140
datasource_id: nvd_importer_v2/CVE-2023-54140
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54140
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nilfs2: fix WARNING in mark_buffer_dirty due to discarded buffer reuse

  A syzbot stress test using a corrupted disk image reported that
  mark_buffer_dirty() called from __nilfs_mark_inode_dirty() or
  nilfs_palloc_commit_alloc_entry() may output a kernel warning, and can
  panic if the kernel is booted with panic_on_warn.

  This is because nilfs2 keeps buffer pointers in local structures for some
  metadata and reuses them, but such buffers may be forcibly discarded by
  nilfs_clear_dirty_page() in some critical situations.

  This issue is reported to appear after commit 28a65b49eb53 ("nilfs2: do
  not write dirty data after degenerating to read-only"), but the issue has
  potentially existed before.

  Fix this issue by checking the uptodate flag when attempting to reuse an
  internally held buffer, and reloading the metadata instead of reusing the
  buffer if the flag was lost.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/46c11be2dca295742a5508ea910a77f7733fb7f4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/473795610594f261e98920f0945550314df36f07
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4da07e958bfda2d69d83db105780e8916e3ac02e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/99a73016a5e12a09586a96f998e91f9ea145cd00
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b308b3eabc429649b5501d36290cea403fbd746c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b911bef132a06de01a745c6a24172d6db7216333
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cdaac8e7e5a059f9b5e816cda257f08d0abffacd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d95e403588738c7ec38f52b9f490b15e7745d393
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f1d637b63d8a27ac3386f186a694907f2717fc13
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54140
    reference_type:
    reference_id: CVE-2023-54140
