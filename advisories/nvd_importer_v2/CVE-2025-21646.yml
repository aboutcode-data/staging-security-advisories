advisory_id: CVE-2025-21646
datasource_id: nvd_importer_v2/CVE-2025-21646
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21646
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  afs: Fix the maximum cell name length

  The kafs filesystem limits the maximum length of a cell to 256 bytes, but a
  problem occurs if someone actually does that: kafs tries to create a
  directory under /proc/net/afs/ with the name of the cell, but that fails
  with a warning:

          WARNING: CPU: 0 PID: 9 at fs/proc/generic.c:405

  because procfs limits the maximum filename length to 255.

  However, the DNS limits the maximum lookup length and, by extension, the
  maximum cell name, to 255 less two (length count and trailing NUL).

  Fix this by limiting the maximum acceptable cellname length to 253.  This
  also allows us to be sure we can create the "/afs/.<cell>/" mountpoint too.

  Further, split the YFS VL record cell name maximum to be the 256 allowed by
  the protocol and ignore the record retrieved by YFSVL.GetCellName if it
  exceeds 253.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21646
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/7673030efe0f8ca1056d3849d61784c6caa052af
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7922b1f058fe24a93730511dd0ae2e1630920096
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7cb3e77e9b4e6ffa325a5559393d3283c9af3d01
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8fd56ad6e7c90ac2bddb0741c6b248c8c5d56ac8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9340385468d056bb700b8f28df236b81fc86a079
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aabe47cf5ac5e1db2ae0635f189d836f67024904
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21646
    reference_type:
    reference_id: CVE-2025-21646
