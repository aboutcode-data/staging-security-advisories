advisory_id: CVE-2024-27001
datasource_id: nvd_importer_v2/CVE-2024-27001
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-27001
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  comedi: vmk80xx: fix incomplete endpoint checking

  While vmk80xx does have endpoint checking implemented, some things
  can fall through the cracks. Depending on the hardware model,
  URBs can have either bulk or interrupt type, and current version
  of vmk80xx_find_usb_endpoints() function does not take that fully
  into account. While this warning does not seem to be too harmful,
  at the very least it will crash systems with 'panic_on_warn' set on
  them.

  Fix the issue found by Syzkaller [1] by somewhat simplifying the
  endpoint checking process with usb_find_common_endpoints() and
  ensuring that only expected endpoint types are present.

  This patch has not been tested on real hardware.

  [1] Syzkaller report:
  usb 1-1: BOGUS urb xfer, pipe 1 != type 3
  WARNING: CPU: 0 PID: 781 at drivers/usb/core/urb.c:504 usb_submit_urb+0xc4e/0x18c0 drivers/usb/core/urb.c:503
  ...
  Call Trace:
   <TASK>
   usb_start_wait_urb+0x113/0x520 drivers/usb/core/message.c:59
   vmk80xx_reset_device drivers/comedi/drivers/vmk80xx.c:227 [inline]
   vmk80xx_auto_attach+0xa1c/0x1a40 drivers/comedi/drivers/vmk80xx.c:818
   comedi_auto_config+0x238/0x380 drivers/comedi/drivers.c:1067
   usb_probe_interface+0x5cd/0xb00 drivers/usb/core/driver.c:399
  ...

  Similar issue also found by Syzkaller:
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-27001
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3a63ae0348d990e137cca04eced5b08379969ea9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/59f33af9796160f851641d960bd93937f282c696
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6ec3514a7d35ad9cfab600187612c29f669069d2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a3b8ae7e9297dd453f2977b011c5bc75eb20e71b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac882d6b21bffecb57bcc4486701239eef5aa67b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b0b268eeb087e324ef3ea71f8e6cabd07630517f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d1718530e3f640b7d5f0050e725216eab57a85d8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f15370e315976198f338b41611f37ce82af6cf54
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4EZ6PJW7VOZ224TD7N4JZNU6KV32ZJ53/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DAMSOZXJEPUOXW33WZYWCVAY7Z5S7OOY/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GCBZZEC7L7KTWWAS2NLJK6SO3IZIL4WW/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:39:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:39:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:40:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:40:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-27001
    reference_type:
    reference_id: CVE-2024-27001
