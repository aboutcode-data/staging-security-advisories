advisory_id: CVE-2023-54033
datasource_id: nvd_importer_v2/CVE-2023-54033
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54033
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: fix a memory leak in the LRU and LRU_PERCPU hash maps

  The LRU and LRU_PERCPU maps allocate a new element on update before locking the
  target hash table bucket. Right after that the maps try to lock the bucket.
  If this fails, then maps return -EBUSY to the caller without releasing the
  allocated element. This makes the element untracked: it doesn't belong to
  either of free lists, and it doesn't belong to the hash table, so can't be
  re-used; this eventually leads to the permanent -ENOMEM on LRU map updates,
  which is unexpected. Fix this by returning the element to the local free list
  if bucket locking fails.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1a9e80f757bbb1562d82e350afce2bb2f712cc3d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/79ea1a12fb9a8275b6e19d4ca625dd872dedcbb9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/965e9cccbe6b9c7b379908cebcb5e3a47f20dd5e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b34ffb0c6d23583830f9327864b9c1f486003305
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54033
    reference_type:
    reference_id: CVE-2023-54033
