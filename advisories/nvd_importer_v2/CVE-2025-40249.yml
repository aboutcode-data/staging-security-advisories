advisory_id: CVE-2025-40249
datasource_id: nvd_importer_v2/CVE-2025-40249
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40249
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  gpio: cdev: make sure the cdev fd is still active before emitting events

  With the final call to fput() on a file descriptor, the release action
  may be deferred and scheduled on a work queue. The reference count of
  that descriptor is still zero and it must not be used. It's possible
  that a GPIO change, we want to notify the user-space about, happens
  AFTER the reference count on the file descriptor associated with the
  character device went down to zero but BEFORE the .release() callback
  was called from the workqueue and so BEFORE we unregistered from the
  notifier.

  Using the regular get_file() routine in this situation triggers the
  following warning:

    struct file::f_count incremented from zero; use-after-free condition present!

  So use the get_file_active() variant that will return NULL on file
  descriptors that have been or are being released.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/d4cd0902c156b2ca60fdda8cd8b5bcb4b0e9ed64
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dccc6daa8afa0f64c432e4c867f275747e3415e1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40249
    reference_type:
    reference_id: CVE-2025-40249
