advisory_id: CVE-2025-39923
datasource_id: nvd_importer_v2/CVE-2025-39923
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39923
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dmaengine: qcom: bam_dma: Fix DT error handling for num-channels/ees

  When we don't have a clock specified in the device tree, we have no way to
  ensure the BAM is on. This is often the case for remotely-controlled or
  remotely-powered BAM instances. In this case, we need to read num-channels
  from the DT to have all the necessary information to complete probing.

  However, at the moment invalid device trees without clock and without
  num-channels still continue probing, because the error handling is missing
  return statements. The driver will then later try to read the number of
  channels from the registers. This is unsafe, because it relies on boot
  firmware and lucky timing to succeed. Unfortunately, the lack of proper
  error handling here has been abused for several Qualcomm SoCs upstream,
  causing early boot crashes in several situations [1, 2].

  Avoid these early crashes by erroring out when any of the required DT
  properties are missing. Note that this will break some of the existing DTs
  upstream (mainly BAM instances related to the crypto engine). However,
  clearly these DTs have never been tested properly, since the error in the
  kernel log was just ignored. It's safer to disable the crypto engine for
  these broken DTBs.

  [1]: https://lore.kernel.org/r/CY01EKQVWE36.B9X5TDXAREPF@fairphone.com/
  [2]: https://lore.kernel.org/r/20230626145959.646747-1-krzysztof.kozlowski@linaro.org/
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39923
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0ff9df758af7022d749718fb6b8385cc5693acf3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1d98ba204d8a6db0d986c7f1aefaa0dcd1c007a2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1fc14731f0be4885e60702b9596d14d9a79cf053
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2e257a6125c63350f00dc42b9674f20fd3cf4a9f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5068b5254812433e841a40886e695633148d362d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/555bd16351a35c79efb029a196975a5a27f7fbc4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6ac1599d0e78036d9d08efc2f58c2d91f0a3ee4c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ebf6c7c908e5999531c3517289598f187776124f
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39923
    reference_type:
    reference_id: CVE-2025-39923
