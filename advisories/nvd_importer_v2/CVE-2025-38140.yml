advisory_id: CVE-2025-38140
datasource_id: nvd_importer_v2/CVE-2025-38140
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38140
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dm: limit swapping tables for devices with zone write plugs

  dm_revalidate_zones() only allowed new or previously unzoned devices to
  call blk_revalidate_disk_zones(). If the device was already zoned,
  disk->nr_zones would always equal md->nr_zones, so dm_revalidate_zones()
  returned without doing any work. This would make the zoned settings for
  the device not match the new table. If the device had zone write plug
  resources, it could run into errors like bdev_zone_is_seq() reading
  invalid memory because disk->conv_zones_bitmap was the wrong size.

  If the device doesn't have any zone write plug resources, calling
  blk_revalidate_disk_zones() will always correctly update device.  If
  blk_revalidate_disk_zones() fails, it can still overwrite or clear the
  current disk->nr_zones value. In this case, DM must restore the previous
  value of disk->nr_zones, so that the zoned settings will continue to
  match the previous value that it fell back to.

  If the device already has zone write plug resources,
  blk_revalidate_disk_zones() will not correctly update them, if it is
  called for arbitrary zoned device changes.  Since there is not much need
  for this ability, the easiest solution is to disallow any table reloads
  that change the zoned settings, for devices that already have zone plug
  resources.  Specifically, if a device already has zone plug resources
  allocated, it can only switch to another zoned table that also emulates
  zone append.  Also, it cannot change the device size or the zone size. A
  device can switch to an error target.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38140
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/121218bef4c1df165181f5cd8fc3a2246bac817e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac8acb0bfd98a1c65f3ca9a3e217a766124eebd8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38140
    reference_type:
    reference_id: CVE-2025-38140
