advisory_id: CVE-2021-21310
datasource_id: nvd_importer_v2/CVE-2021-21310
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21310
aliases: []
summary: NextAuth.js (next-auth) is am open source authentication solution for Next.js applications.
  In next-auth before version 3.3.0 there is a token verification vulnerability. Implementations
  using the Prisma database adapter in conjunction with the Email provider are impacted. Implementations
  using the Email provider with the default database adapter are not impacted. Implementations
  using the Prisma database adapter but not using the Email provider are not impacted. The Prisma
  database adapter was checking the verification token, but was not verifying the email address
  associated with that token. This made it possible to use a valid token to sign in as another
  user when using the Prima adapter in conjunction with the Email provider. This issue is specific
  to the community supported Prisma adapter. This issue is fixed in version 3.3.0.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21310
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21310
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21310
weaknesses:
  - CWE-290
references:
  - url: https://github.com/nextauthjs/next-auth/releases/tag/v3.3.0
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-pg53-56cg-4m8q
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/next-auth
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21310
    reference_type:
    reference_id: CVE-2021-21310
