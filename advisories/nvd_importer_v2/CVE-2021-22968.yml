advisory_id: CVE-2021-22968
datasource_id: nvd_importer_v2/CVE-2021-22968
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-22968
aliases: []
summary: A bypass of adding remote files in Concrete CMS (previously concrete5) File Manager
  leads to remote code execution in Concrete CMS (concrete5) versions 8.5.6 and below.The external
  file upload feature stages files in the public directory even if they have disallowed file
  extensions. They are stored in a directory with a random name, but it's possible to stall
  the uploads and brute force the directory name. You have to be an admin with the ability to
  upload files, but this bug gives you the ability to upload restricted file types and execute
  them depending on server configuration.To fix this, a check for allowed file extensions was
  added before downloading files to a tmp directory.Concrete CMS Security Team gave this a CVSS
  v3.1 score of 5.4 AV:N/AC:H/PR:H/UI:R/S:C/C:N/I:H/A:NThis fix is also in Concrete version
  9.0.0
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-22968
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-22968
weaknesses:
  - CWE-330
  - CWE-434
  - CWE-98
references:
  - url: https://documentation.concretecms.org/developers/introduction/version-history/857-release-notes
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1350444
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:concretecms:concrete_cms:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:concretecms:concrete_cms:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-22968
    reference_type:
    reference_id: CVE-2021-22968
