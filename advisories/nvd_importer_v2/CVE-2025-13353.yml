advisory_id: CVE-2025-13353
datasource_id: nvd_importer_v2/CVE-2025-13353
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-13353
aliases: []
summary: "In gokey versions <0.2.0,\n a flaw in the seed decryption logic resulted in passwords\
  \ incorrectly \nbeing derived solely from the initial vector and the AES-GCM \nauthentication\
  \ tag of the key seed.\n\n\nThis issue has been fixed in gokey version 0.2.0. This is a breaking\
  \ change. The fix has invalidated any passwords/secrets that were derived from the seed file\
  \ (using the -s option). Even if the input seed file stays the same, version 0.2.0 gokey will\
  \ generate different secrets.\n\n\nImpact\nThis vulnerability impacts generated keys/secrets\
  \ using a seed file as an entropy input (using the -s option). Keys/secrets generated just\
  \ from the master password (without the -s\n option) are not impacted. The confidentiality\
  \ of the seed itself is \nalso not impacted (it is not required to regenerate the seed itself).\
  \ \nSpecific impact includes:\n\n\n\n  *  keys/secrets generated from a seed file may have\
  \ lower entropy: it \nwas expected that the whole seed would be used to generate keys (240\
  \ \nbytes of entropy input), where in vulnerable versions only 28 bytes was \nused\n\n  *\
  \  a malicious entity could have recovered all passwords, generated \nfrom a particular seed,\
  \ having only the seed file in possession without \nthe knowledge of the seed master password\n\
  \n\n\n\nPatches\nThe code logic bug has been fixed in gokey version 0.2.0\n and above. Due\
  \ to the deterministic nature of gokey, fixed versions \nwill produce different passwords/secrets\
  \ using seed files, as all seed \nentropy will be used now.\n\n\nSystem secret rotation guidance\n\
  It is advised for users to regenerate passwords/secrets using the patched version of gokey\
  \ (0.2.0\n and above), and provision/rotate these secrets into respective systems \nin place\
  \ of the old secret. A specific rotation procedure is \nsystem-dependent, but most common\
  \ patterns are described below.\n\n\nSystems that do not require the old password/secret for\
  \ rotation\nSuch systems usually have a \"Forgot password\" facility or a\n similar facility\
  \ allowing users to rotate their password/secrets by \nsending a unique \"magic\" link to\
  \ the user's email or phone. In such \ncases users are advised to use this facility and input\
  \ the newly \ngenerated password secret, when prompted by the system.\n\n\nSystems that require\
  \ the old password/secret for rotation\nSuch systems usually have a modal password rotation\
  \ window\n usually in the user settings section requiring the user to input the \nold and\
  \ the new password sometimes with a confirmation. To \ngenerate/recover the old password in\
  \ such cases users are advised to:\n\n\n\n  *  temporarily download  gokey version 0.1.3 https://github.com/cloudflare/gokey/releases/tag/v0.1.3\
  \  for their respective operating system to recover the old password\n\n  *  use gokey version\
  \ 0.2.0 or above to generate the new password\n\n  *  populate the system provided password\
  \ rotation form\n\n\n\n\nSystems that allow multiple credentials for the same account to be\
  \ provisioned\nSuch systems usually require a secret or a cryptographic \nkey as a credential\
  \ for access, but allow several credentials at the \nsame time. One example is SSH: a particular\
  \ user may have several \nauthorized public keys configured on the SSH server for access.\
  \ For such\n systems users are advised to:\n\n\n\n  *  generate a new secret/key/credential\
  \ using gokey version 0.2.0 or above\n\n  *  provision the new secret/key/credential in addition\
  \ to the existing credential on the system\n\n  *  verify that the access or required system\
  \ operation is still possible with the new secret/key/credential\n\n  *  revoke authorization\
  \ for the existing/old credential from the system\n\n\n\n\nCredit\nThis vulnerability was\
  \ found by ThÃ©o Cusnir ( @mister_mime https://hackerone.com/mister_mime ) and responsibly\
  \ disclosed through Cloudflare's bug bounty program."
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-13353
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-13353
weaknesses:
  - CWE-330
references:
  - url: https://github.com/cloudflare/gokey/security/advisories/GHSA-69jw-4jj8-fcxm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-13353
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:cloudflare:gokey:*:*:*:*:*:go:*:*
    reference_type:
    reference_id: cpe:2.3:a:cloudflare:gokey:*:*:*:*:*:go:*:*
