advisory_id: CVE-2025-21681
datasource_id: nvd_importer_v2/CVE-2025-21681
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21681
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  openvswitch: fix lockup on tx to unregistering netdev with carrier

  Commit in a fixes tag attempted to fix the issue in the following
  sequence of calls:

      do_output
      -> ovs_vport_send
         -> dev_queue_xmit
            -> __dev_queue_xmit
               -> netdev_core_pick_tx
                  -> skb_tx_hash

  When device is unregistering, the 'dev->real_num_tx_queues' goes to
  zero and the 'while (unlikely(hash >= qcount))' loop inside the
  'skb_tx_hash' becomes infinite, locking up the core forever.

  But unfortunately, checking just the carrier status is not enough to
  fix the issue, because some devices may still be in unregistering
  state while reporting carrier status OK.

  One example of such device is a net/dummy.  It sets carrier ON
  on start, but it doesn't implement .ndo_stop to set the carrier off.
  And it makes sense, because dummy doesn't really have a carrier.
  Therefore, while this device is unregistering, it's still easy to hit
  the infinite loop in the skb_tx_hash() from the OVS datapath.  There
  might be other drivers that do the same, but dummy by itself is
  important for the OVS ecosystem, because it is frequently used as a
  packet sink for tcpdump while debugging OVS deployments.  And when the
  issue is hit, the only way to recover is to reboot.

  Fix that by also checking if the device is running.  The running
  state is handled by the net core during unregistering, so it covers
  unregistering case better, and we don't really need to send packets
  to devices that are not running anyway.

  While only checking the running state might be enough, the carrier
  check is preserved.  The running and the carrier states seem disjoined
  throughout the code and different drivers.  And other core functions
  like __dev_direct_xmit() check both before attempting to transmit
  a packet.  So, it seems safer to check both flags in OVS as well.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21681
weaknesses:
  - CWE-835
references:
  - url: https://git.kernel.org/stable/c/47e55e4b410f7d552e43011baa5be1aab4093990
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/82f433e8dd0629e16681edf6039d094b5518d8ed
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/87fcf0d137c770e6040ebfdb0abd8e7dd481b504
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/930268823f6bccb697aa5d2047aeffd4a497308c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b5c73fc92f8d15c16e5dc87b5c17d2abf1e6d092
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ea966b6698785fb9cd0fdb867acd91b222e4723f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ea9e990356b7bee95440ba0e6e83cc4d701afaca
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21681
    reference_type:
    reference_id: CVE-2025-21681
