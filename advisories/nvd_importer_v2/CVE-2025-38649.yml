advisory_id: CVE-2025-38649
datasource_id: nvd_importer_v2/CVE-2025-38649
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38649
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  arm64: dts: qcom: qcs615: fix a crash issue caused by infinite loop for Coresight

  An infinite loop has been created by the Coresight devices. When only a
  source device is enabled, the coresight_find_activated_sysfs_sink function
  is recursively invoked in an attempt to locate an active sink device,
  ultimately leading to a stack overflow and system crash. Therefore, disable
  the replicator1 to break the infinite loop and prevent a potential stack
  overflow.

  replicator1_out   ->   funnel_swao_in6   ->   tmc_etf_swao_in   ->  tmc_etf_swao_out
       |                                                                     |
  replicator1_in                                                     replicator_swao_in
       |                                                                     |
  replicator0_out1                                                   replicator_swao_out0
       |                                                                     |
  replicator0_in                                                     funnel_in1_in3
       |                                                                     |
  tmc_etf_out <- tmc_etf_in <- funnel_merg_out <- funnel_merg_in1 <- funnel_in1_out

  [call trace]
     dump_backtrace+0x9c/0x128
     show_stack+0x20/0x38
     dump_stack_lvl+0x48/0x60
     dump_stack+0x18/0x28
     panic+0x340/0x3b0
     nmi_panic+0x94/0xa0
     panic_bad_stack+0x114/0x138
     handle_bad_stack+0x34/0xb8
     __bad_stack+0x78/0x80
     coresight_find_activated_sysfs_sink+0x28/0xa0 [coresight]
     coresight_find_activated_sysfs_sink+0x5c/0xa0 [coresight]
     coresight_find_activated_sysfs_sink+0x5c/0xa0 [coresight]
     coresight_find_activated_sysfs_sink+0x5c/0xa0 [coresight]
     coresight_find_activated_sysfs_sink+0x5c/0xa0 [coresight]
     ...
     coresight_find_activated_sysfs_sink+0x5c/0xa0 [coresight]
     coresight_enable_sysfs+0x80/0x2a0 [coresight]

  side effect after the change:
  Only trace data originating from AOSS can reach the ETF_SWAO and EUD sinks.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38649
weaknesses:
  - CWE-835
references:
  - url: https://git.kernel.org/stable/c/a9aaadcb0a6ce0c19616c46525112bc947c6f2b1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bd4f35786d5f0798cc1f8c187a81a7c998e6c58f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fbe5be7893b8c7f58c999a26839cd30bc07654c6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38649
    reference_type:
    reference_id: CVE-2025-38649
