advisory_id: CVE-2025-39689
datasource_id: nvd_importer_v2/CVE-2025-39689
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39689
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ftrace: Also allocate and copy hash for reading of filter files

  Currently the reader of set_ftrace_filter and set_ftrace_notrace just adds
  the pointer to the global tracer hash to its iterator. Unlike the writer
  that allocates a copy of the hash, the reader keeps the pointer to the
  filter hashes. This is problematic because this pointer is static across
  function calls that release the locks that can update the global tracer
  hashes. This can cause UAF and similar bugs.

  Allocate and copy the hash for reading the filter files like it is done
  for the writers. This not only fixes UAF bugs, but also makes the code a
  bit simpler as it doesn't have to differentiate when to free the
  iterator's hash between writers and readers.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39689
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/12064e1880fc9202be75ff668205b1703d92f74f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3b114a3282ab1a12cb4618a8f45db5d7185e784a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/64db338140d2bad99a0a8c6a118dd60b3e1fb8cb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a40c69f4f1ed96acbcd62e9b5ff3a596f0a91309
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bfb336cf97df7b37b2b2edec0f69773e06d11955
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c4cd93811e038d19f961985735ef7bb128078dfb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c591ba1acd081d4980713e47869dd1cc3d963d19
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e0b6b223167e1edde5c82edf38e393c06eda1f13
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39689
    reference_type:
    reference_id: CVE-2025-39689
