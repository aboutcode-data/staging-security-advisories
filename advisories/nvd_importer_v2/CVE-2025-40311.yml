advisory_id: CVE-2025-40311
datasource_id: nvd_importer_v2/CVE-2025-40311
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40311
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  accel/habanalabs: support mapping cb with vmalloc-backed coherent memory

  When IOMMU is enabled, dma_alloc_coherent() with GFP_USER may return
  addresses from the vmalloc range. If such an address is mapped without
  VM_MIXEDMAP, vm_insert_page() will trigger a BUG_ON due to the
  VM_PFNMAP restriction.

  Fix this by checking for vmalloc addresses and setting VM_MIXEDMAP
  in the VMA before mapping. This ensures safe mapping and avoids kernel
  crashes. The memory is still driver-allocated and cannot be accessed
  directly by userspace.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/513024d5a0e34fd34247043f1876b6138ca52847
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/73c7c2cdb442fc4160d2a2a4bfffbd162af06cb9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7ec8ac9f73d4a9438c2186768d6de27ace37531e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d1dfe21a332d38a6a09658ec29a55940afb5fe36
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40311
    reference_type:
    reference_id: CVE-2025-40311
