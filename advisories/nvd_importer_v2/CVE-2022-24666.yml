advisory_id: CVE-2022-24666
datasource_id: nvd_importer_v2/CVE-2022-24666
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-24666
aliases: []
summary: 'A program using swift-nio-http2 is vulnerable to a denial of service attack, caused
  by a network peer sending a specially crafted HTTP/2 frame. This attack affects all swift-nio-http2
  versions from 1.0.0 to 1.19.1. This vulnerability is caused by a logical error when parsing
  a HTTP/2 HEADERS frame where the frame contains priority information without any other data.
  This logical error caused confusion about the size of the frame, leading to a parsing error.
  This parsing error immediately crashes the entire process. Sending a HEADERS frame with HTTP/2
  priority information does not require any special permission, so any HTTP/2 connection peer
  may send such a frame. For clients, this means any server to which they connect may launch
  this attack. For servers, anyone they allow to connect to them may launch such an attack.
  The attack is low-effort: it takes very little resources to send an appropriately crafted
  frame. The impact on availability is high: receiving the frame immediately crashes the server,
  dropping all in-flight connections and causing the service to need to restart. It is straightforward
  for an attacker to repeatedly send appropriately crafted frames, so attackers require very
  few resources to achieve a substantial denial of service. The attack does not have any confidentiality
  or integrity risks in and of itself: swift-nio-http2 is parsing the frame in memory-safe code,
  so the crash is safe. However, sudden process crashes can lead to violations of invariants
  in services, so it is possible that this attack can be used to trigger an error condition
  that has confidentiality or integrity risks. The risk can be mitigated if untrusted peers
  can be prevented from communicating with the service. This mitigation is not available to
  many services. The issue is fixed by rewriting the parsing code to correctly handle the condition.
  The issue was found by automated fuzzing by oss-fuzz.'
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-24666
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-24666
weaknesses:
  - CWE-130
references:
  - url: https://github.com/apple/swift-nio-http2/security/advisories/GHSA-ccw9-q5h2-8c2w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apple:swiftnio_http\/2:*:*:*:*:*:swift:*:*
    reference_type:
    reference_id: cpe:2.3:a:apple:swiftnio_http\/2:*:*:*:*:*:swift:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24666
    reference_type:
    reference_id: CVE-2022-24666
