advisory_id: CVE-2021-47183
datasource_id: nvd_importer_v2/CVE-2021-47183
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47183
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: lpfc: Fix link down processing to address NULL pointer dereference

  If an FC link down transition while PLOGIs are outstanding to fabric well
  known addresses, outstanding ABTS requests may result in a NULL pointer
  dereference. Driver unload requests may hang with repeated "2878" log
  messages.

  The Link down processing results in ABTS requests for outstanding ELS
  requests. The Abort WQEs are sent for the ELSs before the driver had set
  the link state to down. Thus the driver is sending the Abort with the
  expectation that an ABTS will be sent on the wire. The Abort request is
  stalled waiting for the link to come up. In some conditions the driver may
  auto-complete the ELSs thus if the link does come up, the Abort completions
  may reference an invalid structure.

  Fix by ensuring that Abort set the flag to avoid link traffic if issued due
  to conditions where the link failed.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47183
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/04c1af683270e4709a594bb1691b8800b945035a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1854f53ccd88ad4e7568ddfafafffe71f1ceb0a6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/28de48a7cea495ab48082d9ff4ef63f7cb4e563a
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47183
    reference_type:
    reference_id: CVE-2021-47183
