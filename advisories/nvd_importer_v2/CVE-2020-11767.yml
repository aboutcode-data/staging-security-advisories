advisory_id: CVE-2020-11767
datasource_id: nvd_importer_v2/CVE-2020-11767
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2020-11767
aliases: []
summary: Istio through 1.5.1 and Envoy through 1.14.1 have a data-leak issue. If there is a
  TCP connection (negotiated with SNI over HTTPS) to *.example.com, a request for a domain concurrently
  configured explicitly (e.g., abc.example.com) is sent to the server(s) listening behind *.example.com.
  The outcome should instead be 421 Misdirected Request. Imagine a shared caching forward proxy
  re-using an HTTP/2 connection for a large subnet with many users. If a victim is interacting
  with abc.example.com, and a server (for abc.example.com) recycles the TCP connection to the
  forward proxy, the victim's browser may suddenly start sending sensitive data to a *.example.com
  server. This occurs because the forward proxy between the victim and the origin server reuses
  connections (which obeys the specification), but neither Istio nor Envoy corrects this by
  sending a 421 error. Similarly, this behavior voids the security model browsers have put in
  place between domains.
impacted_packages: []
severities:
  - score: '2.6'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:H/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-11767
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-11767
weaknesses: []
references:
  - url: https://bugs.chromium.org/p/chromium/issues/detail?id=954160#c5
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/envoy/issues/6767
    reference_type:
    reference_id:
  - url: https://github.com/istio/istio/issues/13589
    reference_type:
    reference_id:
  - url: https://github.com/istio/istio/issues/9429
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:istio:istio:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:istio:istio:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-11767
    reference_type:
    reference_id: CVE-2020-11767
