advisory_id: CVE-2020-24046
datasource_id: nvd_importer_v2/CVE-2020-24046
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2020-24046
aliases: []
summary: A sandbox escape issue was discovered in TitanHQ SpamTitan Gateway 7.07. It limits
  the admin user to a restricted shell, allowing execution of a small number of tools of the
  operating system. This restricted shell can be bypassed after changing the properties of the
  user admin in the operating system file /etc/passwd. This file cannot be accessed though the
  restricted shell, but it can be modified by abusing the Backup/Import Backup functionality
  of the web interface. An authenticated attacker would be able to obtain the file /var/tmp/admin.passwd
  after executing a Backup operation. This file can be manually modified to change the GUID
  of the user to 0 (root) and change the restricted shell to a normal shell /bin/sh. After the
  modification is done, the file can be recompressed to a .tar.bz file and imported again via
  the Import Backup functionality. The properties of the admin user will be overwritten and
  a root shell will be granted to the user upon the next successful login.
impacted_packages: []
severities:
  - score: '9.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-24046
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-24046
weaknesses:
  - CWE-269
references:
  - url: https://github.com/felmoltor
    reference_type:
    reference_id:
  - url: https://sensepost.com/blog/2020/clash-of-the-spamtitan/
    reference_type:
    reference_id:
  - url: https://twitter.com/felmoltor
    reference_type:
    reference_id:
  - url: https://www.titanhq.com
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:titanhq:spamtitan:7.07:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:titanhq:spamtitan:7.07:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-24046
    reference_type:
    reference_id: CVE-2020-24046
