advisory_id: CVE-2025-38126
datasource_id: nvd_importer_v2/CVE-2025-38126
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38126
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: stmmac: make sure that ptp_rate is not 0 before configuring timestamping

  The stmmac platform drivers that do not open-code the clk_ptp_rate value
  after having retrieved the default one from the device-tree can end up
  with 0 in clk_ptp_rate (as clk_get_rate can return 0). It will
  eventually propagate up to PTP initialization when bringing up the
  interface, leading to a divide by 0:

   Division by zero in kernel.
   CPU: 1 UID: 0 PID: 1 Comm: swapper/0 Not tainted 6.12.30-00001-g48313bd5768a #22
   Hardware name: STM32 (Device Tree Support)
   Call trace:
    unwind_backtrace from show_stack+0x18/0x1c
    show_stack from dump_stack_lvl+0x6c/0x8c
    dump_stack_lvl from Ldiv0_64+0x8/0x18
    Ldiv0_64 from stmmac_init_tstamp_counter+0x190/0x1a4
    stmmac_init_tstamp_counter from stmmac_hw_setup+0xc1c/0x111c
    stmmac_hw_setup from __stmmac_open+0x18c/0x434
    __stmmac_open from stmmac_open+0x3c/0xbc
    stmmac_open from __dev_open+0xf4/0x1ac
    __dev_open from __dev_change_flags+0x1cc/0x224
    __dev_change_flags from dev_change_flags+0x24/0x60
    dev_change_flags from ip_auto_config+0x2e8/0x11a0
    ip_auto_config from do_one_initcall+0x84/0x33c
    do_one_initcall from kernel_init_freeable+0x1b8/0x214
    kernel_init_freeable from kernel_init+0x24/0x140
    kernel_init from ret_from_fork+0x14/0x28
   Exception stack(0xe0815fb0 to 0xe0815ff8)

  Prevent this division by 0 by adding an explicit check and error log
  about the actual issue. While at it, remove the same check from
  stmmac_ptp_register, which then becomes duplicate
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38126
weaknesses:
  - CWE-369
references:
  - url: https://git.kernel.org/stable/c/030ce919e114a111e83b7976ecb3597cefd33f26
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/32af9c289234990752281c805500dfe03c5b2b8f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/379cd990dfe752b38fcf46034698a9a150626c7a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b263088ee8ab14563817a8be3519af8e25225793
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bb033c6781ce1b0264c3993b767b4aa9021959c2
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38126
    reference_type:
    reference_id: CVE-2025-38126
