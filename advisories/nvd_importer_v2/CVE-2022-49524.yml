advisory_id: CVE-2022-49524
datasource_id: nvd_importer_v2/CVE-2022-49524
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49524
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  media: pci: cx23885: Fix the error handling in cx23885_initdev()

  When the driver fails to call the dma_set_mask(), the driver will get
  the following splat:

  [   55.853884] BUG: KASAN: use-after-free in __process_removed_driver+0x3c/0x240
  [   55.854486] Read of size 8 at addr ffff88810de60408 by task modprobe/590
  [   55.856822] Call Trace:
  [   55.860327]  __process_removed_driver+0x3c/0x240
  [   55.861347]  bus_for_each_dev+0x102/0x160
  [   55.861681]  i2c_del_driver+0x2f/0x50

  This is because the driver has initialized the i2c related resources
  in cx23885_dev_setup() but not released them in error handling, fix this
  bug by modifying the error path that jumps after failing to call the
  dma_set_mask().
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49524
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/453514a874c78df1e7804e6e3aaa60c8d8deb6a8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6041d1a0365baa729b6adfb6ed5386d9388018db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b9978e1c94e569d65a0e7e719abb9340f5db4a0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/86bd6a579c6c60547706cabf299cd2c9feab3332
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/98106f100f50c487469903b9cf6d966785fc9cc3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca17e7a532d1a55466cc007b3f4d319541a27493
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e8123311cf06d7dae71e8c5fe78e0510d20cd30b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fa636e9ee4442215cd9a2e079cd5a8e1fe0cb8ba
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49524
    reference_type:
    reference_id: CVE-2022-49524
