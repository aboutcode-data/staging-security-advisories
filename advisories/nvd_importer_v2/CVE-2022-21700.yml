advisory_id: CVE-2022-21700
datasource_id: nvd_importer_v2/CVE-2022-21700
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-21700
aliases: []
summary: 'Micronaut is a JVM-based, full stack Java framework designed for building JVM web
  applications with support for Java, Kotlin and the Groovy language. In affected versions sending
  an invalid Content Type header leads to memory leak in DefaultArgumentConversionContext as
  this type is erroneously used in static state. ### Impact Sending an invalid Content Type
  header leads to memory leak in `DefaultArgumentConversionContext` as this type is erroneously
  used in static state. ### Patches The problem is patched in Micronaut 3.2.7 and above. ###
  Workarounds The default content type binder can be replaced in an existing Micronaut application
  to mitigate the issue: ```java package example; import java.util.List; import io.micronaut.context.annotation.Replaces;
  import io.micronaut.core.convert.ConversionService; import io.micronaut.http.MediaType; import
  io.micronaut.http.bind.DefaultRequestBinderRegistry; import io.micronaut.http.bind.binders.RequestArgumentBinder;
  import jakarta.inject.Singleton; @Singleton @Replaces(DefaultRequestBinderRegistry.class)
  class FixedRequestBinderRegistry extends DefaultRequestBinderRegistry { public FixedRequestBinderRegistry(ConversionService
  conversionService, List<RequestArgumentBinder> binders) { super(conversionService, binders);
  } @Override protected void registerDefaultConverters(ConversionService<?> conversionService)
  { super.registerDefaultConverters(conversionService); conversionService.addConverter(CharSequence.class,
  MediaType.class, charSequence -> { try { return MediaType.of(charSequence); } catch (IllegalArgumentException
  e) { return null; } }); } } ``` ### References Commit that introduced the vulnerability https://github.com/micronaut-projects/micronaut-core/commit/b8ec32c311689667c69ae7d9f9c3b3a8abc96fe3
  ### For more information If you have any questions or comments about this advisory: * Open
  an issue in [Micronaut Core](https://github.com/micronaut-projects/micronaut-core/issues)
  * Email us at [info@micronaut.io](mailto:info@micronaut.io)'
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21700
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21700
weaknesses:
  - CWE-400
references:
  - url: https://github.com/micronaut-projects/micronaut-core/commit/b8ec32c311689667c69ae7d9f9c3b3a8abc96fe3
    reference_type:
    reference_id:
  - url: https://github.com/micronaut-projects/micronaut-core/security/advisories/GHSA-2457-2263-mm9f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:objectcomputing:micronaut:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:objectcomputing:micronaut:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21700
    reference_type:
    reference_id: CVE-2022-21700
