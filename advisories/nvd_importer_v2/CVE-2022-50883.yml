advisory_id: CVE-2022-50883
datasource_id: nvd_importer_v2/CVE-2022-50883
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50883
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Prevent decl_tag from being referenced in func_proto arg

  Syzkaller managed to hit another decl_tag issue:

    btf_func_proto_check kernel/bpf/btf.c:4506 [inline]
    btf_check_all_types kernel/bpf/btf.c:4734 [inline]
    btf_parse_type_sec+0x1175/0x1980 kernel/bpf/btf.c:4763
    btf_parse kernel/bpf/btf.c:5042 [inline]
    btf_new_fd+0x65a/0xb00 kernel/bpf/btf.c:6709
    bpf_btf_load+0x6f/0x90 kernel/bpf/syscall.c:4342
    __sys_bpf+0x50a/0x6c0 kernel/bpf/syscall.c:5034
    __do_sys_bpf kernel/bpf/syscall.c:5093 [inline]
    __se_sys_bpf kernel/bpf/syscall.c:5091 [inline]
    __x64_sys_bpf+0x7c/0x90 kernel/bpf/syscall.c:5091
    do_syscall_64+0x54/0x70 arch/x86/entry/common.c:48

  This seems similar to commit ea68376c8bed ("bpf: prevent decl_tag from being
  referenced in func_proto") but for the argument.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3f3d54962a032581996edda8e6bcbf7a30371234
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e6d276dcc9204f95632580c43d66c52ca502d7ec
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f17472d4599697d701aa239b4c475a506bccfd19
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50883
    reference_type:
    reference_id: CVE-2022-50883
