advisory_id: CVE-2026-23103
datasource_id: nvd_importer_v2/CVE-2026-23103
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23103
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ipvlan: Make the addrs_lock be per port

  Make the addrs_lock be per port, not per ipvlan dev.

  Initial code seems to be written in the assumption,
  that any address change must occur under RTNL.
  But it is not so for the case of IPv6. So

  1) Introduce per-port addrs_lock.

  2) It was needed to fix places where it was forgotten
  to take lock (ipvlan_open/ipvlan_close)

  This appears to be a very minor problem though.
  Since it's highly unlikely that ipvlan_add_addr() will
  be called on 2 CPU simultaneously. But nevertheless,
  this could cause:

  1) False-negative of ipvlan_addr_busy(): one interface
  iterated through all port->ipvlans + ipvlan->addrs
  under some ipvlan spinlock, and another added IP
  under its own lock. Though this is only possible
  for IPv6, since looks like only ipvlan_addr6_event() can be
  called without rtnl_lock.

  2) Race since ipvlan_ht_addr_add(port) is called under
  different ipvlan->addrs_lock locks

  This should not affect performance, since add/remove IP
  is a rare situation and spinlock is not taken on fast
  paths.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/04ba6de6eff61238e5397c14ac26a6578c7735a5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1f300c10d92c547c3a7d978e1212ff52f18256ed
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3c149b662cbb202a450e81f938e702ba333864ad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6a81e2db096913d7e43aada1c350c1282e76db39
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/70feb16e3fbfb10b15de1396557c38e99f1ab8df
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/88f83e6c9cdb46b8c8ddd0ba01393362963cf589
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d3ba32162488283c0a4c5bedd8817aec91748802
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23103
    reference_type:
    reference_id: CVE-2026-23103
