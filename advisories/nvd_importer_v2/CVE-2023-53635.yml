advisory_id: CVE-2023-53635
datasource_id: nvd_importer_v2/CVE-2023-53635
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53635
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: conntrack: fix wrong ct->timeout value

  (struct nf_conn)->timeout is an interval before the conntrack
  confirmed.  After confirmed, it becomes a timestamp.

  It is observed that timeout of an unconfirmed conntrack:
  - Set by calling ctnetlink_change_timeout(). As a result,
    `nfct_time_stamp` was wrongly added to `ct->timeout` twice.
  - Get by calling ctnetlink_dump_timeout(). As a result,
    `nfct_time_stamp` was wrongly subtracted.

  Call Trace:
   <TASK>
   dump_stack_lvl
   ctnetlink_dump_timeout
   __ctnetlink_glue_build
   ctnetlink_glue_build
   __nfqnl_enqueue_packet
   nf_queue
   nf_hook_slow
   ip_mc_output
   ? __pfx_ip_finish_output
   ip_send_skb
   ? __pfx_dst_output
   udp_send_skb
   udp_sendmsg
   ? __pfx_ip_generic_getfrag
   sock_sendmsg

  Separate the 2 cases in:
  - Setting `ct->timeout` in __nf_ct_set_timeout().
  - Getting `ct->timeout` in ctnetlink_dump_timeout().

  Pablo appends:

  Update ctnetlink to set up the timeout _after_ the IPS_CONFIRMED flag is
  set on, otherwise conntrack creation via ctnetlink breaks.

  Note that the problem described in this patch occurs since the
  introduction of the nfnetlink_queue conntrack support, select a
  sufficiently old Fixes: tag for -stable kernel to pick up this fix.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53635
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/73db1b8f2bb6725b7391e85aab41fdf592b3c0c1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/80c5ba0078e20d926d11d0778f9a43902664ebf0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f612ae1ab4793701caf39386fb3b7f4b3ef44e48
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff5e4ac8dd7be7f1faba955c5779a68571eeb0f8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53635
    reference_type:
    reference_id: CVE-2023-53635
