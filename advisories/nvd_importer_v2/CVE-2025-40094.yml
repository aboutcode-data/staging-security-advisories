advisory_id: CVE-2025-40094
datasource_id: nvd_importer_v2/CVE-2025-40094
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40094
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: gadget: f_acm: Refactor bind path to use __free()

  After an bind/unbind cycle, the acm->notify_req is left stale. If a
  subsequent bind fails, the unified error label attempts to free this
  stale request, leading to a NULL pointer dereference when accessing
  ep->ops->free_request.

  Refactor the error handling in the bind path to use the __free()
  automatic cleanup mechanism.

  Unable to handle kernel NULL pointer dereference at virtual address 0000000000000020
  Call trace:
   usb_ep_free_request+0x2c/0xec
   gs_free_req+0x30/0x44
   acm_bind+0x1b8/0x1f4
   usb_add_function+0xcc/0x1f0
   configfs_composite_bind+0x468/0x588
   gadget_bind_driver+0x104/0x270
   really_probe+0x190/0x374
   __driver_probe_device+0xa0/0x12c
   driver_probe_device+0x3c/0x218
   __device_attach_driver+0x14c/0x188
   bus_for_each_drv+0x10c/0x168
   __device_attach+0xfc/0x198
   device_initial_probe+0x14/0x24
   bus_probe_device+0x94/0x11c
   device_add+0x268/0x48c
   usb_add_gadget+0x198/0x28c
   dwc3_gadget_init+0x700/0x858
   __dwc3_set_mode+0x3cc/0x664
   process_scheduled_works+0x1d8/0x488
   worker_thread+0x244/0x334
   kthread+0x114/0x1bc
   ret_from_fork+0x10/0x20
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/201a66d8e6630762e760e1d78f1d149da1691e7b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2b1546f7c5fc6c44555a8e7a2b34229d1dcd2175
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/47b2116e54b4a854600341487e8b55249e926324
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c4301e4dd6b32faccb744f1c2320e64235b68d3b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c5d116862dd3ed162d079738a5ebddf9fceea850
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e348d18fb0124b662cfefb3001733b49da428215
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40094
    reference_type:
    reference_id: CVE-2025-40094
