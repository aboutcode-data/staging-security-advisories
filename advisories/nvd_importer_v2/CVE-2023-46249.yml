advisory_id: CVE-2023-46249
datasource_id: nvd_importer_v2/CVE-2023-46249
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-46249
aliases: []
summary: authentik is an open-source Identity Provider. Prior to versions 2023.8.4 and 2023.10.2,
  when the default admin user has been deleted, it is potentially possible for an attacker to
  set the password of the default admin user without any authentication. authentik uses a blueprint
  to create the default admin user, which can also optionally set the default admin users' password
  from an environment variable. When the user is deleted, the `initial-setup` flow used to configure
  authentik after the first installation becomes available again. authentik 2023.8.4 and 2023.10.2
  fix this issue. As a workaround, ensure the default admin user (Username `akadmin`) exists
  and has a password set. It is recommended to use a very strong password for this user, and
  store it in a secure location like a password manager. It is also possible to deactivate the
  user to prevent any logins as akadmin.
impacted_packages: []
severities:
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-46249
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-46249
weaknesses:
  - CWE-306
  - CWE-287
references:
  - url: https://github.com/goauthentik/authentik/commit/261879022d25016d58867cf1f24e90b81ad618d0
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/commit/ea75741ec22ecef34bc7073f1163e17a8a2bf9fc
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/releases/tag/version%2F2023.10.2
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/releases/tag/version%2F2023.8.4
    reference_type:
    reference_id:
  - url: https://github.com/goauthentik/authentik/security/advisories/GHSA-rjvp-29xq-f62w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-46249
    reference_type:
    reference_id: CVE-2023-46249
