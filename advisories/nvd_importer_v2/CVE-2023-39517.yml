advisory_id: CVE-2023-39517
datasource_id: nvd_importer_v2/CVE-2023-39517
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-39517
aliases: []
summary: Joplin is a free, open source note taking and to-do application. A Cross site scripting
  (XSS) vulnerability in affected versions allows clicking on an untrusted image link to execute
  arbitrary shell commands. The HTML sanitizer (`packages/renderer/htmlUtils.ts::sanitizeHtml`)
  preserves `<map>` `<area>` links. However, unlike `<a>` links, the `target` and `href` attributes
  are not removed. Additionally, because the note preview pane isn't sandboxed to prevent top
  navigation, links with `target` set to `_top` can replace the toplevel electron page. Because
  any toplevel electron page, with Joplin's setup, has access to `require` and can require node
  libraries, a malicious replacement toplevel page can import `child_process` and execute arbitrary
  shell commands. This issue has been fixed in commit 7c52c3e9a81a52ef1b42a951f9deb9d378d59b0f
  which is included in release version 2.12.8. Users are advised to upgrade. There are no known
  workarounds for this vulnerability.
impacted_packages: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-39517
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-39517
weaknesses:
  - CWE-79
references:
  - url: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#sandbox
    reference_type:
    reference_id:
  - url: https://github.com/laurent22/joplin/commit/7c52c3e9a81a52ef1b42a951f9deb9d378d59b0f
    reference_type:
    reference_id:
  - url: https://github.com/laurent22/joplin/security/advisories/GHSA-2h88-m32f-qh5m
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:joplin_project:joplin:*:*:*:*:*:-:*:*
    reference_type:
    reference_id: cpe:2.3:a:joplin_project:joplin:*:*:*:*:*:-:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-39517
    reference_type:
    reference_id: CVE-2023-39517
