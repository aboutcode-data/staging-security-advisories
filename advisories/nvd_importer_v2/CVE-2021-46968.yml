advisory_id: CVE-2021-46968
datasource_id: nvd_importer_v2/CVE-2021-46968
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-46968
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  s390/zcrypt: fix zcard and zqueue hot-unplug memleak

  Tests with kvm and a kmemdebug kernel showed, that on hot unplug the
  zcard and zqueue structs for the unplugged card or queue are not
  properly freed because of a mismatch with get/put for the embedded
  kref counter.

  This fix now adjusts the handling of the kref counters. With init the
  kref counter starts with 1. This initial value needs to drop to zero
  with the unregister of the card or queue to trigger the release and
  free the object.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46968
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/026499a9c2e002e621ad568d1378324ae97e5524
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/055a063a18bcd19b93709e3eac8078d6b2f04599
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/70fac8088cfad9f3b379c9082832b4d7532c16c2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/971dc8706cee47393d393905d294ea47e39503d3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-46968
    reference_type:
    reference_id: CVE-2021-46968
