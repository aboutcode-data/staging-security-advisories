advisory_id: CVE-2022-49410
datasource_id: nvd_importer_v2/CVE-2022-49410
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49410
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tracing: Fix potential double free in create_var_ref()

  In create_var_ref(), init_var_ref() is called to initialize the fields
  of variable ref_field, which is allocated in the previous function call
  to create_hist_field(). Function init_var_ref() allocates the
  corresponding fields such as ref_field->system, but frees these fields
  when the function encounters an error. The caller later calls
  destroy_hist_field() to conduct error handling, which frees the fields
  and the variable itself. This results in double free of the fields which
  are already freed in the previous function.

  Fix this by storing NULL to the corresponding fields when they are freed
  in init_var_ref().
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49410
weaknesses:
  - CWE-415
references:
  - url: https://git.kernel.org/stable/c/058cb6d86b9789377216c936506b346aaa1eb581
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/37443b3508b8cce6832f8d25cb4550b2f7801f50
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4fdfb15e08598711dbf50daf56a33965232daf0e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/99696a2592bca641eb88cc9a80c90e591afebd0f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bd83ff3bbfb003832481c9bff999d12385f396ae
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c27f744ceefadc7bbeb14233b6abc150ced617d2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f8b383f83cb573152c577eca1ef101e89995b72a
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49410
    reference_type:
    reference_id: CVE-2022-49410
