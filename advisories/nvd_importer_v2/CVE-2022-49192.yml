advisory_id: CVE-2022-49192
datasource_id: nvd_importer_v2/CVE-2022-49192
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49192
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drivers: ethernet: cpsw: fix panic when interrupt coaleceing is set via ethtool

  cpsw_ethtool_begin directly returns the result of pm_runtime_get_sync
  when successful.
  pm_runtime_get_sync returns -error code on failure and 0 on successful
  resume but also 1 when the device is already active. So the common case
  for cpsw_ethtool_begin is to return 1. That leads to inconsistent calls
  to pm_runtime_put in the call-chain so that pm_runtime_put is called
  one too many times and as result leaving the cpsw dev behind suspended.

  The suspended cpsw dev leads to an access violation later on by
  different parts of the cpsw driver.

  Fix this by calling the return-friendly pm_runtime_resume_and_get
  function.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49192
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2844e2434385819f674d1fb4130c308c50ba681e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/30ad11bff021a94aff6dab1ec9236fdfd884fbff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/459080fab12b23c0526026e5cedbf3fabb5457cc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/585dc196a08fccdcd1b7fcf473cf566b34c4b840
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49192
    reference_type:
    reference_id: CVE-2022-49192
