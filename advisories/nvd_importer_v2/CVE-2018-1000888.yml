advisory_id: CVE-2018-1000888
datasource_id: nvd_importer_v2/CVE-2018-1000888
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2018-1000888
aliases: []
summary: PEAR Archive_Tar version 1.4.3 and earlier contains a CWE-502, CWE-915 vulnerability
  in the Archive_Tar class. There are several file operations with `$v_header['filename']` as
  parameter (such as file_exists, is_file, is_dir, etc). When extract is called without a specific
  prefix path, we can trigger unserialization by crafting a tar file with `phar://[path_to_malicious_phar_file]`
  as path. Object injection can be used to trigger destruct in the loaded PHP classes, e.g.
  the Archive_Tar class itself. With Archive_Tar object injection, arbitrary file deletion can
  occur because `@unlink($this->_temp_tarname)` is called. If another class with useful gadget
  is loaded, it may possible to cause remote code execution that can result in files being deleted
  or possibly modified. This vulnerability appears to have been fixed in 1.4.4.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-1000888
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-1000888
weaknesses:
  - CWE-502
references:
  - url: https://blog.ripstech.com/2018/new-php-exploitation-technique/
    reference_type:
    reference_id:
  - url: https://cdn2.hubspot.net/hubfs/3853213/us-18-Thomas-It%27s-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-....pdf
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2019/02/msg00020.html
    reference_type:
    reference_id:
  - url: https://pear.php.net/bugs/bug.php?id=23782
    reference_type:
    reference_id:
  - url: https://pear.php.net/package/Archive_Tar/download/
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202006-14
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/3857-1/
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2019/dsa-4378
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/46108/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:php:pear_archive_tar:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:php:pear_archive_tar:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.10:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.10:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-1000888
    reference_type:
    reference_id: CVE-2018-1000888
