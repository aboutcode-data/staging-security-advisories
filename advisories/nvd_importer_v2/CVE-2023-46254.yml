advisory_id: CVE-2023-46254
datasource_id: nvd_importer_v2/CVE-2023-46254
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-46254
aliases: []
summary: 'capsule-proxy is a reverse proxy for Capsule kubernetes multi-tenancy framework. A
  bug in the RoleBinding reflector used by `capsule-proxy` gives ServiceAccount tenant owners
  the right to list Namespaces of other tenants backed by the same owner kind and name. For
  example consider two tenants `solar` and `wind`. Tenant `solar`, owned by a ServiceAccount
  named `tenant-owner` in the Namespace `solar`. Tenant `wind`, owned by a ServiceAccount named
  `tenant-owner` in the Namespace `wind`. The Tenant owner `solar` would be able to list the
  namespaces of the Tenant `wind` and vice-versa, although this is not correct. The bug introduces
  an exfiltration vulnerability since allows the listing of Namespace resources of other Tenants,
  although just in some specific conditions: 1. `capsule-proxy` runs with the `--disable-caching=false`
  (default value: `false`) and 2. Tenant owners are ServiceAccount, with the same resource name,
  but in different Namespaces. This vulnerability doesn''t allow any privilege escalation on
  the outer tenant Namespace-scoped resources, since the Kubernetes RBAC is enforcing this.
  This issue has been addressed in version 0.4.5. Users are advised to upgrade. There are no
  known workarounds for this vulnerability.'
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-46254
weaknesses:
  - CWE-200
references:
  - url: https://github.com/projectcapsule/capsule-proxy/commit/615202f7b02eaec7681336bd63daed1f39ae00c5
    reference_type:
    reference_id:
  - url: https://github.com/projectcapsule/capsule-proxy/security/advisories/GHSA-6758-979h-249x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:clastix:capsule:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:clastix:capsule:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:clastix:capsule-proxy:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:clastix:capsule-proxy:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-46254
    reference_type:
    reference_id: CVE-2023-46254
