advisory_id: CVE-2025-40183
datasource_id: nvd_importer_v2/CVE-2025-40183
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40183
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Fix metadata_dst leak __bpf_redirect_neigh_v{4,6}

  Cilium has a BPF egress gateway feature which forces outgoing K8s Pod
  traffic to pass through dedicated egress gateways which then SNAT the
  traffic in order to interact with stable IPs outside the cluster.

  The traffic is directed to the gateway via vxlan tunnel in collect md
  mode. A recent BPF change utilized the bpf_redirect_neigh() helper to
  forward packets after the arrival and decap on vxlan, which turned out
  over time that the kmalloc-256 slab usage in kernel was ever-increasing.

  The issue was that vxlan allocates the metadata_dst object and attaches
  it through a fake dst entry to the skb. The latter was never released
  though given bpf_redirect_neigh() was merely setting the new dst entry
  via skb_dst_set() without dropping an existing one first.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/057764172fcc6ee2ccb6c41351a55a9f054dc8fd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/23f3770e1a53e6c7a553135011f547209e141e72
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2e67c2037382abb56497bb9d7b7e10be04eb5598
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3fba965a9aac0fa3cbd8138436a37af9ab466d79
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7404ce888a45eb7da0508b7cbbe6f2e95302eeb8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b6bfe44b6dbb14a31d86c475cdc9c7689534fb09
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f36a305d30f557306d87c787ddffe094ac5dac89
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40183
    reference_type:
    reference_id: CVE-2025-40183
