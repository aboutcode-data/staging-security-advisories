advisory_id: CVE-2025-38158
datasource_id: nvd_importer_v2/CVE-2025-38158
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38158
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  hisi_acc_vfio_pci: fix XQE dma address error

  The dma addresses of EQE and AEQE are wrong after migration and
  results in guest kernel-mode encryption services  failure.
  Comparing the definition of hardware registers, we found that
  there was an error when the data read from the register was
  combined into an address. Therefore, the address combination
  sequence needs to be corrected.

  Even after fixing the above problem, we still have an issue
  where the Guest from an old kernel can get migrated to
  new kernel and may result in wrong data.

  In order to ensure that the address is correct after migration,
  if an old magic number is detected, the dma address needs to be
  updated.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38158
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/7710c883eb8cb5cf510ca47ec0e26c6cb7e94a4f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/809a9c10274e1bcf6d05f1c0341459a425a4f05f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/884a76e813178778d271fea59783763d32bb7e72
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8bb7170c5a055ea17c6857c256ee73c10ff872eb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f0423873e7aeb69cb68f4e8fa3827832e7b037ba
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38158
    reference_type:
    reference_id: CVE-2025-38158
