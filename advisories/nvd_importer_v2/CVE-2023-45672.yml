advisory_id: CVE-2023-45672
datasource_id: nvd_importer_v2/CVE-2023-45672
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-45672
aliases: []
summary: 'Frigate is an open source network video recorder. Prior to version 0.13.0 Beta 3,
  an unsafe deserialization vulnerability was identified in the endpoints used to save configurations
  for Frigate. This can lead to unauthenticated remote code execution. This can be performed
  through the UI at `/config` or through a direct call to `/api/config/save`. Exploiting this
  vulnerability requires the attacker to both know very specific information about a user''s
  Frigate server and requires an authenticated user to be tricked into clicking a specially
  crafted link to their Frigate instance. This vulnerability could exploited by an attacker
  under the following circumstances: Frigate publicly exposed to the internet (even with authentication);
  attacker knows the address of a user''s Frigate instance; attacker crafts a specialized page
  which links to the user''s Frigate instance; attacker finds a way to get an authenticated
  user to visit their specialized page and click the button/link. Input is initially accepted
  through `http.py`. The user-provided input is then parsed and loaded by `load_config_with_no_duplicates`.
  However, `load_config_with_no_duplicates` does not sanitize this input by merit of using `yaml.loader.Loader`
  which can instantiate custom constructors. A provided payload will be executed directly at
  `frigate/util/builtin.py:110`. This issue may lead to pre-authenticated Remote Code Execution.
  Version 0.13.0 Beta 3 contains a patch.'
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-45672
weaknesses:
  - CWE-502
references:
  - url: https://github.com/blakeblackshear/frigate/blob/5658e5a4cc7376504af9de5e1eff178939a13e7f/frigate/config.py#L1244-L1244
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/5658e5a4cc7376504af9de5e1eff178939a13e7f/frigate/http.py#L998-L998
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/5658e5a4cc7376504af9de5e1eff178939a13e7f/frigate/util/builtin.py#L110-L110
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/security/advisories/GHSA-qp3h-4q62-p428
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2023-190_Frigate/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:frigate:frigate:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:frigate:frigate:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:frigate:frigate:0.13.0:beta1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:frigate:frigate:0.13.0:beta1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:frigate:frigate:0.13.0:beta2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:frigate:frigate:0.13.0:beta2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-45672
    reference_type:
    reference_id: CVE-2023-45672
