advisory_id: CVE-2026-23220
datasource_id: nvd_importer_v2/CVE-2026-23220
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23220
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ksmbd: fix infinite loop caused by next_smb2_rcv_hdr_off reset in error paths

  The problem occurs when a signed request fails smb2 signature verification
  check. In __process_request(), if check_sign_req() returns an error,
  set_smb2_rsp_status(work, STATUS_ACCESS_DENIED) is called.
  set_smb2_rsp_status() set work->next_smb2_rcv_hdr_off as zero. By resetting
  next_smb2_rcv_hdr_off to zero, the pointer to the next command in the chain
  is lost. Consequently, is_chained_smb2_message() continues to point to
  the same request header instead of advancing. If the header's NextCommand
  field is non-zero, the function returns true, causing __handle_ksmbd_work()
  to repeatedly process the same failed request in an infinite loop.
  This results in the kernel log being flooded with "bad smb2 signature"
  messages and high CPU usage.

  This patch fixes the issue by changing the return value from
  SERVER_HANDLER_CONTINUE to SERVER_HANDLER_ABORT. This ensures that
  the processing loop terminates immediately rather than attempting to
  continue from an invalidated offset.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/010eb01ce23b34b50531448b0da391c7f05a72af
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5accdc5b7f28a81bbc5880ac0b8886e60c86e8c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/71b5e7c528315ca360a1825a4ad2f8ae48c5dc16
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9135e791ec2709bcf0cda0335535c74762489498
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f7b1c2f5642bbd60b1beef1f3298cbac81eb232c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fb3b66bd72deb5543addaefa67963b34fb163a7b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23220
    reference_type:
    reference_id: CVE-2026-23220
