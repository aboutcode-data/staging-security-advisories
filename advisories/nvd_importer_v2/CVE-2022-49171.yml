advisory_id: CVE-2022-49171
datasource_id: nvd_importer_v2/CVE-2022-49171
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49171
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: don't BUG if someone dirty pages without asking ext4 first

  [un]pin_user_pages_remote is dirtying pages without properly warning
  the file system in advance.  A related race was noted by Jan Kara in
  2018[1]; however, more recently instead of it being a very hard-to-hit
  race, it could be reliably triggered by process_vm_writev(2) which was
  discovered by Syzbot[2].

  This is technically a bug in mm/gup.c, but arguably ext4 is fragile in
  that if some other kernel subsystem dirty pages without properly
  notifying the file system using page_mkwrite(), ext4 will BUG, while
  other file systems will not BUG (although data will still be lost).

  So instead of crashing with a BUG, issue a warning (since there may be
  potential data loss) and just mark the page as clean to avoid
  unprivileged denial of service attacks until the problem can be
  properly fixed.  More discussion and background can be found in the
  thread starting at [2].

  [1] https://lore.kernel.org/linux-mm/20180103100430.GE4911@quack2.suse.cz
  [2] https://lore.kernel.org/r/Yg0m6IjcNmfaSokM@google.com
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49171
weaknesses:
  - CWE-617
references:
  - url: https://git.kernel.org/stable/c/0d3a6926f7e8be3c897fa46216ce13b119a9f56a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/330d0e44fc5a47c27df958ecdd4693a3cb1d8b81
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/343117559ef41e992e326f7a92da1a8f254dfa8c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5a016c053f426a73752c3b41b60b497b58694d48
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5db60e76edf5680ff1f3a7221036fc44b308f146
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/677c9d30e8487bee6c8e3b034070319d98f6e203
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a0856764dc1276ad2dc7891288c2e9246bf11a37
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cc5095747edfb054ca2068d01af20be3fcc3634f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d666dfaa571465a19f014534a214c255ea33f301
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49171
    reference_type:
    reference_id: CVE-2022-49171
