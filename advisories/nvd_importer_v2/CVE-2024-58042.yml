advisory_id: CVE-2024-58042
datasource_id: nvd_importer_v2/CVE-2024-58042
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-58042
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  rhashtable: Fix potential deadlock by moving schedule_work outside lock

  Move the hash table growth check and work scheduling outside the
  rht lock to prevent a possible circular locking dependency.

  The original implementation could trigger a lockdep warning due to
  a potential deadlock scenario involving nested locks between
  rhashtable bucket, rq lock, and dsq lock. By relocating the
  growth check and work scheduling after releasing the rth lock, we break
  this potential deadlock chain.

  This change expands the flexibility of rhashtable by removing
  restrictive locking that previously limited its use in scheduler
  and workqueue contexts.

  Import to say that this calls rht_grow_above_75(), which reads from
  struct rhashtable without holding the lock, if this is a problem, we can
  move the check to the lock, and schedule the workqueue after the lock.


  Modified so that atomic_inc is also moved outside of the bucket
  lock along with the growth above 75% check.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-58042
weaknesses:
  - CWE-667
references:
  - url: https://git.kernel.org/stable/c/ced8ce3c83a7150c5f5d371a8c332d7bc7f9b66d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e1d3422c95f003eba241c176adfe593c33e8a8f6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eb2e58484b838fb4e777ee9721bb9e20e6ca971d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-58042
    reference_type:
    reference_id: CVE-2024-58042
