advisory_id: CVE-2021-41254
datasource_id: nvd_importer_v2/CVE-2021-41254
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-41254
aliases: []
summary: kustomize-controller is a Kubernetes operator, specialized in running continuous delivery
  pipelines for infrastructure and workloads defined with Kubernetes manifests and assembled
  with Kustomize. Users that can create Kubernetes Secrets, Service Accounts and Flux Kustomization
  objects, could execute commands inside the kustomize-controller container by embedding a shell
  script in a Kubernetes Secret. This can be used to run `kubectl` commands under the Service
  Account of kustomize-controller, thus allowing an authenticated Kubernetes user to gain cluster
  admin privileges. In affected versions multitenant environments where non-admin users have
  permissions to create Flux Kustomization objects are affected by this issue. This vulnerability
  was fixed in kustomize-controller v0.15.0 (included in flux2 v0.18.0) released on 2021-10-08.
  Starting with v0.15, the kustomize-controller no longer executes shell commands on the container
  OS and the `kubectl` binary has been removed from the container image. To prevent the creation
  of Kubernetes Service Accounts with `secrets` in namespaces owned by tenants, a Kubernetes
  validation webhook such as Gatekeeper OPA or Kyverno can be used.
impacted_packages: []
severities:
  - score: '9.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41254
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41254
weaknesses:
  - CWE-78
references:
  - url: https://github.com/fluxcd/kustomize-controller/security/advisories/GHSA-35rf-v2jv-gfg7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:fluxcd:kustomize-controller:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:fluxcd:kustomize-controller:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41254
    reference_type:
    reference_id: CVE-2021-41254
