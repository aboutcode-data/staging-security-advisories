advisory_id: CVE-2021-32802
datasource_id: nvd_importer_v2/CVE-2021-32802
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-32802
aliases: []
summary: Nextcloud server is an open source, self hosted personal cloud. Nextcloud supports
  rendering image previews for user provided file content. For some image types, the Nextcloud
  server was invoking a third-party library that wasn't suited for untrusted user-supplied content.
  There are several security concerns with passing user-generated content to this library, such
  as Server-Side-Request-Forgery, file disclosure or potentially executing code on the system.
  The risk depends on your system configuration and the installed library version. It is recommended
  that the Nextcloud Server is upgraded to 20.0.12, 21.0.4 or 22.1.0. These versions do not
  use this library anymore. As a workaround users may disable previews by setting `enable_previews`
  to `false` in `config.php`.
impacted_packages: []
severities:
  - score: '10.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32802
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32802
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32802
weaknesses:
  - CWE-829
references:
  - url: https://docs.nextcloud.com/server/21/admin_manual/configuration_files/previews_configuration.html#disabling-previews
    reference_type:
    reference_id:
  - url: https://github.com/nextcloud/security-advisories/security/advisories/GHSA-m682-v4g9-wrq7
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1261413
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202208-17
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32802
    reference_type:
    reference_id: CVE-2021-32802
