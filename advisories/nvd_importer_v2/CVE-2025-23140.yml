advisory_id: CVE-2025-23140
datasource_id: nvd_importer_v2/CVE-2025-23140
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-23140
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  misc: pci_endpoint_test: Avoid issue of interrupts remaining after request_irq error

  After devm_request_irq() fails with error in pci_endpoint_test_request_irq(),
  the pci_endpoint_test_free_irq_vectors() is called assuming that all IRQs
  have been released.

  However, some requested IRQs remain unreleased, so there are still
  /proc/irq/* entries remaining, and this results in WARN() with the
  following message:

    remove_proc_entry: removing non-empty directory 'irq/30', leaking at least 'pci-endpoint-test.0'
    WARNING: CPU: 0 PID: 202 at fs/proc/generic.c:719 remove_proc_entry +0x190/0x19c

  To solve this issue, set the number of remaining IRQs to test->num_irqs,
  and release IRQs in advance by calling pci_endpoint_test_release_irq().

  [kwilczynski: commit log]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-23140
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0557e70e2aeba8647bf5a950820b67cfb86533db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/54c9f299ad7d7c4be5d271ed12d01a59e95b8907
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5a4b7181213268c9b07bef8800905528435db44a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/705be96504779e4a333ea042b4779ea941f0ace9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/770407f6173f4f39f4e2c1b54422b79ce6c98bdb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9d5118b107b1a2353ed0dff24404aee2e6b7ca0a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e516e187bf32d8decc7c7d0025ae4857cad13c0e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6cb7828c8e17520d4f5afb416515d3fae1af9a9
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23140
    reference_type:
    reference_id: CVE-2025-23140
