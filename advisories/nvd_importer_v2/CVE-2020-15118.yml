advisory_id: CVE-2020-15118
datasource_id: nvd_importer_v2/CVE-2020-15118
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2020-15118
aliases: []
summary: In Wagtail before versions 2.7.4 and 2.9.3, when a form page type is made available
  to Wagtail editors through the `wagtail.contrib.forms` app, and the page template is built
  using Django's standard form rendering helpers such as form.as_p, any HTML tags used within
  a form field's help text will be rendered unescaped in the page. Allowing HTML within help
  text is an intentional design decision by Django; however, as a matter of policy Wagtail does
  not allow editors to insert arbitrary HTML by default, as this could potentially be used to
  carry out cross-site scripting attacks, including privilege escalation. This functionality
  should therefore not have been made available to editor-level users. The vulnerability is
  not exploitable by an ordinary site visitor without access to the Wagtail admin. Patched versions
  have been released as Wagtail 2.7.4 (for the LTS 2.7 branch) and Wagtail 2.9.3 (for the current
  2.9 branch). In these versions, help text will be escaped to prevent the inclusion of HTML
  tags. Site owners who wish to re-enable the use of HTML within help text (and are willing
  to accept the risk of this being exploited by editors) may set WAGTAILFORMS_HELP_TEXT_ALLOW_HTML
  = True in their configuration settings. Site owners who are unable to upgrade to the new versions
  can secure their form page templates by rendering forms field-by-field as per Django's documentation,
  but omitting the |safe filter when outputting the help text.
impacted_packages: []
severities:
  - score: '3.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15118
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15118
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15118
weaknesses:
  - CWE-79
references:
  - url: https://docs.djangoproject.com/en/3.0/ref/models/fields/#django.db.models.Field.help_text
    reference_type:
    reference_id:
  - url: https://docs.wagtail.io/en/stable/reference/contrib/forms/index.html#usage
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/blob/master/docs/releases/2.9.3.rst
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/d9a41e7f24d08c024acc9a3094940199df94db34
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/security/advisories/GHSA-2473-9hgq-j7xw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:torchbox:wagtail:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:torchbox:wagtail:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15118
    reference_type:
    reference_id: CVE-2020-15118
