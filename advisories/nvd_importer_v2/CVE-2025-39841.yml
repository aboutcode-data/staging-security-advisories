advisory_id: CVE-2025-39841
datasource_id: nvd_importer_v2/CVE-2025-39841
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39841
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: lpfc: Fix buffer free/clear order in deferred receive path

  Fix a use-after-free window by correcting the buffer release sequence in
  the deferred receive path. The code freed the RQ buffer first and only
  then cleared the context pointer under the lock. Concurrent paths (e.g.,
  ABTS and the repost path) also inspect and release the same pointer under
  the lock, so the old order could lead to double-free/UAF.

  Note that the repost path already uses the correct pattern: detach the
  pointer under the lock, then free it after dropping the lock. The
  deferred path should do the same.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39841
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/367cb5ffd8a8a4c85dc89f55e7fa7cc191425b11
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/55658c7501467ca9ef3bd4453dd920010db8bc13
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/897f64b01c1249ac730329b83f4f40bab71e86c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95b63d15fce5c54a73bbf195e1aacb5a75b128e2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9dba9a45c348e8460da97c450cddf70b2056deb3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ab34084f42ee06a9028d67c78feafb911d33d111
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/baa39f6ad79d372a6ce0aa639fbb2f1578479f57
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d96cc9a1b57725930c60b607423759d563b4d900
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39841
    reference_type:
    reference_id: CVE-2025-39841
