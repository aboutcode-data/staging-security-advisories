advisory_id: CVE-2021-31876
datasource_id: nvd_importer_v2/CVE-2021-31876
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-31876
aliases: []
summary: Bitcoin Core 0.12.0 through 0.21.1 does not properly implement the replacement policy
  specified in BIP125, which makes it easier for attackers to trigger a loss of funds, or a
  denial of service attack against downstream projects such as Lightning network nodes. An unconfirmed
  child transaction with nSequence = 0xff_ff_ff_ff, spending an unconfirmed parent with nSequence
  <= 0xff_ff_ff_fd, should be replaceable because there is inherited signaling by the child
  transaction. However, the actual PreChecks implementation does not enforce this. Instead,
  mempool rejects the replacement attempt of the unconfirmed child transaction.
impacted_packages: []
severities:
  - score: '6.4'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-31876
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-31876
weaknesses:
  - CWE-863
references:
  - url: https://bitcoinops.org/en/newsletters/2021/05/12/
    reference_type:
    reference_id:
  - url: https://bitcoinops.org/en/topics/replace-by-fee/
    reference_type:
    reference_id:
  - url: https://en.bitcoin.it/wiki/Common_Vulnerabilities_and_Exposures#CVE-2021-31876
    reference_type:
    reference_id:
  - url: https://github.com/bitcoin/bitcoin
    reference_type:
    reference_id:
  - url: https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018893.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:bitcoin:bitcoin:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:bitcoin:bitcoin:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-31876
    reference_type:
    reference_id: CVE-2021-31876
