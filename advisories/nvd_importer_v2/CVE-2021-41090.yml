advisory_id: CVE-2021-41090
datasource_id: nvd_importer_v2/CVE-2021-41090
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-41090
aliases: []
summary: 'Grafana Agent is a telemetry collector for sending metrics, logs, and trace data to
  the opinionated Grafana observability stack. Prior to versions 0.20.1 and 0.21.2, inline secrets
  defined within a metrics instance config are exposed in plaintext over two endpoints: metrics
  instance configs defined in the base YAML file are exposed at `/-/config` and metrics instance
  configs defined for the scraping service are exposed at `/agent/api/v1/configs/:key`. Inline
  secrets will be exposed to anyone being able to reach these endpoints. If HTTPS with client
  authentication is not configured, these endpoints are accessible to unauthenticated users.
  Secrets found in these sections are used for delivering metrics to a Prometheus Remote Write
  system, authenticating against a system for discovering Prometheus targets, and authenticating
  against a system for collecting metrics. This does not apply for non-inlined secrets, such
  as `*_file` based secrets. This issue is patched in Grafana Agent versions 0.20.1 and 0.21.2.
  A few workarounds are available. Users who cannot upgrade should use non-inline secrets where
  possible. Users may also desire to restrict API access to Grafana Agent with some combination
  of restricting the network interfaces Grafana Agent listens on through `http_listen_address`
  in the `server` block, configuring Grafana Agent to use HTTPS with client authentication,
  and/or using firewall rules to restrict external access to Grafana Agent''s API.'
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41090
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41090
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41090
weaknesses:
  - CWE-312
  - CWE-200
references:
  - url: https://github.com/grafana/agent/commit/af7fb01e31fe2d389e5f1c36b399ddc46b412b21
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent/pull/1152
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent/releases/tag/v0.20.1
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent/releases/tag/v0.21.2
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent/security/advisories/GHSA-9c4x-5hgq-q3wh
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20211229-0004/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:grafana:agent:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:grafana:agent:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41090
    reference_type:
    reference_id: CVE-2021-41090
