advisory_id: CVE-2024-26654
datasource_id: nvd_importer_v2/CVE-2024-26654
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26654
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ALSA: sh: aica: reorder cleanup operations to avoid UAF bugs

  The dreamcastcard->timer could schedule the spu_dma_work and the
  spu_dma_work could also arm the dreamcastcard->timer.

  When the snd_pcm_substream is closing, the aica_channel will be
  deallocated. But it could still be dereferenced in the worker
  thread. The reason is that del_timer() will return directly
  regardless of whether the timer handler is running or not and
  the worker could be rescheduled in the timer handler. As a result,
  the UAF bug will happen. The racy situation is shown below:

        (Thread 1)                 |      (Thread 2)
  snd_aicapcm_pcm_close()          |
   ...                             |  run_spu_dma() //worker
                                   |    mod_timer()
    flush_work()                   |
    del_timer()                    |  aica_period_elapsed() //timer
    kfree(dreamcastcard->channel)  |    schedule_work()
                                   |  run_spu_dma() //worker
    ...                            |    dreamcastcard->channel-> //USE

  In order to mitigate this bug and other possible corner cases,
  call mod_timer() conditionally in run_spu_dma(), then implement
  PCM sync_stop op to cancel both the timer and worker. The sync_stop
  op will be called from PCM core appropriately when needed.
impacted_packages: []
severities:
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26654
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/051e0840ffa8ab25554d6b14b62c9ab9e4901457
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3c907bf56905de7d27b329afaf59c2fb35d17b04
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4206ad65a0ee76920041a755bd3c17c6ba59bba2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/61d4787692c1fccdc268ffa7a891f9c149f50901
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8c990221681688da34295d6d76cc2f5b963e83f5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9d66ae0e7bb78b54e1e0525456c6b54e1d132046
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aa39e6878f61f50892ee2dd9d2176f72020be845
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e955e8a7f38a856fc6534ba4e6bffd4d5cc80ac3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eeb2a2ca0b8de7e1c66afaf719529154e7dc60b2
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26654
    reference_type:
    reference_id: CVE-2024-26654
