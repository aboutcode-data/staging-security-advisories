advisory_id: CVE-2023-54143
datasource_id: nvd_importer_v2/CVE-2023-54143
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54143
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  media: mediatek: vcodec: fix resource leaks in vdec_msg_queue_init()

  If we encounter any error in the vdec_msg_queue_init() then we need
  to set "msg_queue->wdma_addr.size = 0;".  Normally, this is done
  inside the vdec_msg_queue_deinit() function.  However, if the
  first call to allocate &msg_queue->wdma_addr fails, then the
  vdec_msg_queue_deinit() function is a no-op.  For that situation, just
  set the size to zero explicitly and return.

  There were two other error paths which did not clean up before returning.
  Change those error paths to goto mem_alloc_err.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/451dc187cadd47771e5d9434fe220fad7be84057
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/858322c409e0aba8f70810d23f35c482744f007c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b7dbc27301f560c3b915235c53383155b3512083
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cf10b0bb503c974ba049d6f888b21178be20a962
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54143
    reference_type:
    reference_id: CVE-2023-54143
