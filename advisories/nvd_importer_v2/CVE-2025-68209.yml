advisory_id: CVE-2025-68209
datasource_id: nvd_importer_v2/CVE-2025-68209
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68209
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mlx5: Fix default values in create CQ

  Currently, CQs without a completion function are assigned the
  mlx5_add_cq_to_tasklet function by default. This is problematic since
  only user CQs created through the mlx5_ib driver are intended to use
  this function.

  Additionally, all CQs that will use doorbells instead of polling for
  completions must call mlx5_cq_arm. However, the default CQ creation flow
  leaves a valid value in the CQ's arm_db field, allowing FW to send
  interrupts to polling-only CQs in certain corner cases.

  These two factors would allow a polling-only kernel CQ to be triggered
  by an EQ interrupt and call a completion function intended only for user
  CQs, causing a null pointer exception.

  Some areas in the driver have prevented this issue with one-off fixes
  but did not address the root cause.

  This patch fixes the described issue by adding defaults to the create CQ
  flow. It adds a default dummy completion function to protect against
  null pointer exceptions, and it sets an invalid command sequence number
  by default in kernel CQs to prevent the FW from sending an interrupt to
  the CQ until it is armed. User CQs are responsible for their own
  initialization values.

  Callers of mlx5_core_create_cq are responsible for changing the
  completion function and arming the CQ per their needs.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/08469f5393a1a39f26a6e2eb2e8c33187665c1f4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e5eba42f01340f73888dfe560be2806057c25913
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68209
    reference_type:
    reference_id: CVE-2025-68209
