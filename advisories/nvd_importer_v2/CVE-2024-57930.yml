advisory_id: CVE-2024-57930
datasource_id: nvd_importer_v2/CVE-2024-57930
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-57930
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tracing: Have process_string() also allow arrays

  In order to catch a common bug where a TRACE_EVENT() TP_fast_assign()
  assigns an address of an allocated string to the ring buffer and then
  references it in TP_printk(), which can be executed hours later when the
  string is free, the function test_event_printk() runs on all events as
  they are registered to make sure there's no unwanted dereferencing.

  It calls process_string() to handle cases in TP_printk() format that has
  "%s". It returns whether or not the string is safe. But it can have some
  false positives.

  For instance, xe_bo_move() has:

   TP_printk("move_lacks_source:%s, migrate object %p [size %zu] from %s to %s device_id:%s",
              __entry->move_lacks_source ? "yes" : "no", __entry->bo, __entry->size,
              xe_mem_type_to_name[__entry->old_placement],
              xe_mem_type_to_name[__entry->new_placement], __get_str(device_id))

  Where the "%s" references into xe_mem_type_to_name[]. This is an array of
  pointers that should be safe for the event to access. Instead of flagging
  this as a bad reference, if a reference points to an array, where the
  record field is the index, consider it safe.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-57930
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3bcdc9039a6e9e6e47ed689a37b8d57894a3c571
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/631b1e09e213c86d5a4ce23d45c81af473bb0ac7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/92bd18c74624e5eb9f96e70076aa46293f4b626f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a64e5295ebc4afdefe69cdf16cc286a60ff8ba4b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/afc6717628f959941d7b33728570568b4af1c4b8
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-57930
    reference_type:
    reference_id: CVE-2024-57930
