advisory_id: CVE-2022-49849
datasource_id: nvd_importer_v2/CVE-2022-49849
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49849
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  btrfs: fix match incorrectly in dev_args_match_device

  syzkaller found a failed assertion:

    assertion failed: (args->devid != (u64)-1) || args->missing, in fs/btrfs/volumes.c:6921

  This can be triggered when we set devid to (u64)-1 by ioctl. In this
  case, the match of devid will be skipped and the match of device may
  succeed incorrectly.

  Patch 562d7b1512f7 introduced this function which is used to match device.
  This function contains two matching scenarios, we can distinguish them by
  checking the value of args->missing rather than check whether args->devid
  and args->uuid is default value.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49849
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0fca385d6ebc3cabb20f67bcf8a71f1448bdc001
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bc6c127c377010f136360552ebf91c2723081c1b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c9fe4719c662e0af17eea723cf345e37719fd3c9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49849
    reference_type:
    reference_id: CVE-2022-49849
