advisory_id: CVE-2024-49979
datasource_id: nvd_importer_v2/CVE-2024-49979
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-49979
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: gso: fix tcp fraglist segmentation after pull from frag_list

  Detect tcp gso fraglist skbs with corrupted geometry (see below) and
  pass these to skb_segment instead of skb_segment_list, as the first
  can segment them correctly.

  Valid SKB_GSO_FRAGLIST skbs
  - consist of two or more segments
  - the head_skb holds the protocol headers plus first gso_size
  - one or more frag_list skbs hold exactly one segment
  - all but the last must be gso_size

  Optional datapath hooks such as NAT and BPF (bpf_skb_pull_data) can
  modify these skbs, breaking these invariants.

  In extreme cases they pull all data into skb linear. For TCP, this
  causes a NULL ptr deref in __tcpv4_gso_segment_list_csum at
  tcp_hdr(seg->next).

  Detect invalid geometry due to pull, by checking head_skb size.
  Don't just drop, as this may blackhole a destination. Convert to be
  able to pass to regular skb_segment.

  Approach and description based on a patch by Willem de Bruijn.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49979
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/17bd3bd82f9f79f3feba15476c2b2c95a9b11ff8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2d4a83a44428de45bfe9dccb0192a3711d1097e0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3fdd8c83e83fa5e82f1b5585245c51e0355c9f46
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49979
    reference_type:
    reference_id: CVE-2024-49979
