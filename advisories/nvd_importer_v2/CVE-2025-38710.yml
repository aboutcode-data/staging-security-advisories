advisory_id: CVE-2025-38710
datasource_id: nvd_importer_v2/CVE-2025-38710
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38710
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  gfs2: Validate i_depth for exhash directories

  A fuzzer test introduced corruption that ends up with a depth of 0 in
  dir_e_read(), causing an undefined shift by 32 at:

    index = hash >> (32 - dip->i_depth);

  As calculated in an open-coded way in dir_make_exhash(), the minimum
  depth for an exhash directory is ilog2(sdp->sd_hash_ptrs) and 0 is
  invalid as sdp->sd_hash_ptrs is fixed as sdp->bsize / 16 at mount time.

  So we can avoid the undefined behaviour by checking for depth values
  lower than the minimum in gfs2_dinode_in(). Values greater than the
  maximum are already being checked for there.

  Also switch the calculation in dir_make_exhash() to use ilog2() to
  clarify how the depth is calculated.

  Tested with the syzkaller repro.c and xfstests '-g quick'.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38710
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/53a0249d68a210c16e961b83adfa82f94ee0a53d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/557c024ca7250bb65ae60f16c02074106c2f197b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9680c58675b82348ab84d387e4fa727f7587e1a0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b5f46951e62377b6e406fadc18bc3c5bdf1632a7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38710
    reference_type:
    reference_id: CVE-2025-38710
