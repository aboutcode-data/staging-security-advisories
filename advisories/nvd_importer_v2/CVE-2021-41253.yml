advisory_id: CVE-2021-41253
datasource_id: nvd_importer_v2/CVE-2021-41253
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-41253
aliases: []
summary: Zydis is an x86/x86-64 disassembler library. Users of Zydis versions v3.2.0 and older
  that use the string functions provided in `zycore` in order to append untrusted user data
  to the formatter buffer within their custom formatter hooks can run into heap buffer overflows.
  Older versions of Zydis failed to properly initialize the string object within the formatter
  buffer, forgetting to initialize a few fields, leaving their value to chance. This could then
  in turn cause zycore functions like `ZyanStringAppend` to make incorrect calculations for
  the new target size, resulting in heap memory corruption. This does not affect the regular
  uncustomized Zydis formatter, because Zydis internally doesn't use the string functions in
  zycore that act upon these fields. However, because the zycore string functions are the intended
  way to work with the formatter buffer for users of the library that wish to extend the formatter,
  we still consider this to be a vulnerability in Zydis. This bug is patched starting in version
  3.2.1. As a workaround, users may refrain from using zycore string functions in their formatter
  hooks until updating to a patched version.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41253
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41253
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41253
weaknesses:
  - CWE-457
  - CWE-122
  - CWE-908
references:
  - url: https://github.com/zyantific/zydis/commit/55dd08c210722aed81b38132f5fd4a04ec1943b5
    reference_type:
    reference_id:
  - url: https://github.com/zyantific/zydis/security/advisories/GHSA-q42v-hv86-3m4g
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/96b0a482-7041-45b1-9327-c6a4a8f32d3a
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/d2536d7d-36ce-4723-928c-98d1ee039784
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:zyantific:zydis:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:zyantific:zydis:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41253
    reference_type:
    reference_id: CVE-2021-41253
