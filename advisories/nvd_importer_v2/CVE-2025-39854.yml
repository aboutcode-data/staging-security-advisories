advisory_id: CVE-2025-39854
datasource_id: nvd_importer_v2/CVE-2025-39854
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39854
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ice: fix NULL access of tx->in_use in ice_ll_ts_intr

  Recent versions of the E810 firmware have support for an extra interrupt to
  handle report of the "low latency" Tx timestamps coming from the
  specialized low latency firmware interface. Instead of polling the
  registers, software can wait until the low latency interrupt is fired.

  This logic makes use of the Tx timestamp tracking structure, ice_ptp_tx, as
  it uses the same "ready" bitmap to track which Tx timestamps complete.

  Unfortunately, the ice_ll_ts_intr() function does not check if the
  tracker is initialized before its first access. This results in NULL
  dereference or use-after-free bugs similar to the issues fixed in the
  ice_ptp_ts_irq() function.

  Fix this by only checking the in_use bitmap (and other fields) if the
  tracker is marked as initialized. The reset flow will clear the init field
  under lock before it tears the tracker down, thus preventing any
  use-after-free or NULL access.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39854
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/2cde98a02da958357fe240a6ba269b69d913b6ba
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/923c267bdbb64f65bc1149d184efcf8b047d7d64
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6486338fde3f04ed0ec59fe67a69a208c32734f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39854
    reference_type:
    reference_id: CVE-2025-39854
