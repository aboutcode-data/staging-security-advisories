advisory_id: CVE-2022-31093
datasource_id: nvd_importer_v2/CVE-2022-31093
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-31093
aliases: []
summary: NextAuth.js is a complete open source authentication solution for Next.js applications.
  In affected versions an attacker can send a request to an app using NextAuth.js with an invalid
  `callbackUrl` query parameter, which internally is converted to a `URL` object. The URL instantiation
  would fail due to a malformed URL being passed into the constructor, causing it to throw an
  unhandled error which led to the **API route handler timing out and logging in to fail**.
  This has been remedied in versions 3.29.5 and 4.5.0. If for some reason you cannot upgrade,
  the workaround requires you to rely on Advanced Initialization. Please see the documentation
  for more.
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31093
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31093
weaknesses:
  - CWE-754
references:
  - url: https://github.com/nextauthjs/next-auth/commit/25517b73153332d948114bacdff3b5908de91d85
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/commit/e498483b23273d1bfc81be68339607f88d411bd6
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-g5fm-jp9v-2432
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/initialization#advanced-initialization
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31093
    reference_type:
    reference_id: CVE-2022-31093
