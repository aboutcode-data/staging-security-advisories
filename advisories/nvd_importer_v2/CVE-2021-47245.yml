advisory_id: CVE-2021-47245
datasource_id: nvd_importer_v2/CVE-2021-47245
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47245
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: synproxy: Fix out of bounds when parsing TCP options

  The TCP option parser in synproxy (synproxy_parse_options) could read
  one byte out of bounds. When the length is 1, the execution flow gets
  into the loop, reads one byte of the opcode, and if the opcode is
  neither TCPOPT_EOL nor TCPOPT_NOP, it reads one more byte, which exceeds
  the length of 1.

  This fix is inspired by commit 9609dad263f8 ("ipv4: tcp_input: fix stack
  out of bounds when parsing TCP options.").

  v2 changes:

  Added an early return when length < 0 to avoid calling
  skb_header_pointer with negative length.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47245
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/576c1526b4d83c44ad7b673cb841f36cbc6cb6c4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5fc177ab759418c9537433e63301096e733fb915
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/674b5f0c6a4fc5d3abce877048290cea6091fcb1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6defc77d48eff74075b80ad5925061b2fc010d98
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7d9a9a1a88a3da574e019b4de756bc73337b3b0b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9cdf299ba4e153b5e56187648420de22c6216f02
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f648089337cb8ed40b2bb96e244f72b9d97dc96b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47245
    reference_type:
    reference_id: CVE-2021-47245
