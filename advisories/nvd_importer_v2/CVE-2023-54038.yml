advisory_id: CVE-2023-54038
datasource_id: nvd_importer_v2/CVE-2023-54038
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54038
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  Bluetooth: hci_conn: return ERR_PTR instead of NULL when there is no link

  hci_connect_sco currently returns NULL when there is no link (i.e. when
  hci_conn_link() returns NULL).

  sco_connect() expects an ERR_PTR in case of any error (see line 266 in
  sco.c). Thus, hcon set as NULL passes through to sco_conn_add(), which
  tries to get hcon->hdev, resulting in dereferencing a NULL pointer as
  reported by syzkaller.

  The same issue exists for iso_connect_cis() calling hci_connect_cis().

  Thus, make hci_connect_sco() and hci_connect_cis() return ERR_PTR
  instead of NULL.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/357ab53c83a5322437fa434e9a9e3e0bafe6b383
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b4066eb04bb67e7ff66e5aaab0db4a753f37eaad
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54038
    reference_type:
    reference_id: CVE-2023-54038
