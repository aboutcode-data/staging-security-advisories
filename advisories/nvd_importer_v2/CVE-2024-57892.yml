advisory_id: CVE-2024-57892
datasource_id: nvd_importer_v2/CVE-2024-57892
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-57892
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ocfs2: fix slab-use-after-free due to dangling pointer dqi_priv

  When mounting ocfs2 and then remounting it as read-only, a
  slab-use-after-free occurs after the user uses a syscall to
  quota_getnextquota.  Specifically, sb_dqinfo(sb, type)->dqi_priv is the
  dangling pointer.

  During the remounting process, the pointer dqi_priv is freed but is never
  set as null leaving it to be accessed.  Additionally, the read-only option
  for remounting sets the DQUOT_SUSPENDED flag instead of setting the
  DQUOT_USAGE_ENABLED flags.  Moreover, later in the process of getting the
  next quota, the function ocfs2_get_next_id is called and only checks the
  quota usage flags and not the quota suspended flags.

  To fix this, I set dqi_priv to null when it is freed after remounting with
  read-only and put a check for DQUOT_SUSPENDED in ocfs2_get_next_id.

  [akpm@linux-foundation.org: coding-style cleanups]
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-57892
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/2d431192486367eee03cc28d0b53b97dafcb8e63
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2e3d203b1adede46bbba049e497765d67865be18
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/58f9e20e2a7602e1dd649a1ec4790077c251cb6c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5f3fd772d152229d94602bca243fbb658068a597
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8ff6f635a08c30559ded0c110c7ce03ba7747d11
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ba950a02d8d23811aa1120affd3adedcfac6153d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f44e6d70c100614c211703f065cad448050e4a0e
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-57892
    reference_type:
    reference_id: CVE-2024-57892
