advisory_id: CVE-2021-22903
datasource_id: nvd_importer_v2/CVE-2021-22903
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-22903
aliases: []
summary: The actionpack ruby gem before 6.1.3.2 suffers from a possible open redirect vulnerability.
  Specially crafted Host headers in combination with certain "allowed host" formats can cause
  the Host Authorization middleware in Action Pack to redirect users to a malicious website.
  This is similar to CVE-2021-22881. Strings in config.hosts that do not have a leading dot
  are converted to regular expressions without proper escaping. This causes, for example, `config.hosts
  << "sub.example.com"` to permit a request with a Host header value of `sub-example.com`.
impacted_packages: []
severities:
  - score: '5.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-22903
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-22903
weaknesses:
  - CWE-601
references:
  - url: https://discuss.rubyonrails.org/t/cve-2021-22903-possible-open-redirect-vulnerability-in-action-pack/77867
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1148025
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:rubyonrails:rails:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:rubyonrails:rails:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:rubyonrails:rails:6.1.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:rubyonrails:rails:6.1.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-22903
    reference_type:
    reference_id: CVE-2021-22903
