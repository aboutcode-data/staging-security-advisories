advisory_id: CVE-2025-38004
datasource_id: nvd_importer_v2/CVE-2025-38004
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38004
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  can: bcm: add locking for bcm_op runtime updates

  The CAN broadcast manager (CAN BCM) can send a sequence of CAN frames via
  hrtimer. The content and also the length of the sequence can be changed
  resp reduced at runtime where the 'currframe' counter is then set to zero.

  Although this appeared to be a safe operation the updates of 'currframe'
  can be triggered from user space and hrtimer context in bcm_can_tx().
  Anderson Nascimento created a proof of concept that triggered a KASAN
  slab-out-of-bounds read access which can be prevented with a spin_lock_bh.

  At the rework of bcm_can_tx() the 'count' variable has been moved into
  the protected section as this variable can be modified from both contexts
  too.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38004
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/2a437b86ac5a9893c902f30ef66815bf13587bf6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7595de7bc56e0e52b74e56c90f7e247bf626d628
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/76c84c3728178b2d38d5604e399dfe8b0752645e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8f1c022541bf5a923c8d6fa483112c15250f30a4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c2aba69d0c36a496ab4f2e81e9c2b271f2693fd7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c4e8a172501e677ebd8ea9d9161d97dc4df56fbd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cc55dd28c20a6611e30596019b3b2f636819a4c0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fbd8fdc2b218e979cfe422b139b8f74c12419d1f
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38004
    reference_type:
    reference_id: CVE-2025-38004
