advisory_id: CVE-2022-49168
datasource_id: nvd_importer_v2/CVE-2022-49168
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49168
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  btrfs: do not clean up repair bio if submit fails

  The submit helper will always run bio_endio() on the bio if it fails to
  submit, so cleaning up the bio just leads to a variety of use-after-free
  and NULL pointer dereference bugs because we race with the endio
  function that is cleaning up the bio.  Instead just return BLK_STS_OK as
  the repair function has to continue to process the rest of the pages,
  and the endio for the repair bio will do the appropriate cleanup for the
  page that it was given.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49168
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/7170875083254b51fcc5d67f96640977083f481e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8cbc3001a3264d998d6b6db3e23f935c158abd4d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d1cb11fb45ebbb1e7dfe5e9038b32ea72c184b14
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e76c78c48902dae6fa612749f59162bca0a79e0b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e7e1d15d2bd8c373cf621614ddd17971a2132713
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49168
    reference_type:
    reference_id: CVE-2022-49168
