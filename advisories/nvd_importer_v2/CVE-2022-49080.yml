advisory_id: CVE-2022-49080
datasource_id: nvd_importer_v2/CVE-2022-49080
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49080
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/mempolicy: fix mpol_new leak in shared_policy_replace

  If mpol_new is allocated but not used in restart loop, mpol_new will be
  freed via mpol_put before returning to the caller.  But refcnt is not
  initialized yet, so mpol_put could not do the right things and might
  leak the unused mpol_new.  This would happen if mempolicy was updated on
  the shared shmem file while the sp->lock has been dropped during the
  memory allocation.

  This issue could be triggered easily with the below code snippet if
  there are many processes doing the below work at the same time:

    shmid = shmget((key_t)5566, 1024 * PAGE_SIZE, 0666|IPC_CREAT);
    shm = shmat(shmid, 0, 0);
    loop many times {
      mbind(shm, 1024 * PAGE_SIZE, MPOL_LOCAL, mask, maxnode, 0);
      mbind(shm + 128 * PAGE_SIZE, 128 * PAGE_SIZE, MPOL_DEFAULT, mask,
            maxnode, 0);
    }
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49080
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/198932a14aeb19a15cf19e51e151d023bc4cd648
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/25f506273b6ae806fd46bfcb6fdaa5b9ec81a05b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/39a32f3c06f6d68a530bf9612afa19f50f12e93d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4ad099559b00ac01c3726e5c95dc3108ef47d03e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e16dc5378abd749a836daa9ee4ab2c8d2668999
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6e00309ac716fa8225f0cbde2cd9c24f0e74ee21
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8510c2346d9e47a72b7f018a36ef0c39483e53d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f7e183b0a7136b6dc9c7b9b2a85a608a8feba894
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fe39ac59dbbf893b73b24e3184161d0bd06d6651
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49080
    reference_type:
    reference_id: CVE-2022-49080
