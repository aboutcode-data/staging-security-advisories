advisory_id: CVE-2025-21816
datasource_id: nvd_importer_v2/CVE-2025-21816
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21816
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  hrtimers: Force migrate away hrtimers queued after CPUHP_AP_HRTIMERS_DYING

  hrtimers are migrated away from the dying CPU to any online target at
  the CPUHP_AP_HRTIMERS_DYING stage in order not to delay bandwidth timers
  handling tasks involved in the CPU hotplug forward progress.

  However wakeups can still be performed by the outgoing CPU after
  CPUHP_AP_HRTIMERS_DYING. Those can result again in bandwidth timers being
  armed. Depending on several considerations (crystal ball power management
  based election, earliest timer already enqueued, timer migration enabled or
  not), the target may eventually be the current CPU even if offline. If that
  happens, the timer is eventually ignored.

  The most notable example is RCU which had to deal with each and every of
  those wake-ups by deferring them to an online CPU, along with related
  workarounds:

  _ e787644caf76 (rcu: Defer RCU kthreads wakeup when CPU is dying)
  _ 9139f93209d1 (rcu/nocb: Fix RT throttling hrtimer armed from offline CPU)
  _ f7345ccc62a4 (rcu/nocb: Fix rcuog wake-up from offline softirq)

  The problem isn't confined to RCU though as the stop machine kthread
  (which runs CPUHP_AP_HRTIMERS_DYING) reports its completion at the end
  of its work through cpu_stop_signal_done() and performs a wake up that
  eventually arms the deadline server timer:

     WARNING: CPU: 94 PID: 588 at kernel/time/hrtimer.c:1086 hrtimer_start_range_ns+0x289/0x2d0
     CPU: 94 UID: 0 PID: 588 Comm: migration/94 Not tainted
     Stopper: multi_cpu_stop+0x0/0x120 <- stop_machine_cpuslocked+0x66/0xc0
     RIP: 0010:hrtimer_start_range_ns+0x289/0x2d0
     Call Trace:
     <TASK>
       start_dl_timer
       enqueue_dl_entity
       dl_server_start
       enqueue_task_fair
       enqueue_task
       ttwu_do_activate
       try_to_wake_up
       complete
       cpu_stopper_thread

  Instead of providing yet another bandaid to work around the situation, fix
  it in the hrtimers infrastructure instead: always migrate away a timer to
  an online target whenever it is enqueued from an offline CPU.

  This will also allow to revert all the above RCU disgraceful hacks.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21816
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2aecec58e9040ce3d2694707889f9914a2374955
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/53dac345395c0d2493cbc2f4c85fe38aef5b63f5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/63815bef47ec25f5a125019ca480882481ee1553
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/82ac6adbbb2aad14548a71d5e2e37f4964a15e38
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e456a88bddae4030ba962447bb84be6669f2a0c1
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.7:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.7:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.7:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.7:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.7:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.7:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.7:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.7:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.7:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.7:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.7:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.7:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.7:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.7:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.7:rc8:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.7:rc8:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21816
    reference_type:
    reference_id: CVE-2025-21816
