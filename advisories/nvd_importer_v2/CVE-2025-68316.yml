advisory_id: CVE-2025-68316
datasource_id: nvd_importer_v2/CVE-2025-68316
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68316
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: ufs: core: Fix invalid probe error return value

  After DME Link Startup, the error return value is set to the MIPI UniPro
  GenericErrorCode which can be 0 (SUCCESS) or 1 (FAILURE).  Upon failure
  during driver probe, the error code 1 is propagated back to the driver
  probe function which must return a negative value to indicate an error,
  but 1 is not negative, so the probe is considered to be successful even
  though it failed.  Subsequently, removing the driver results in an oops
  because it is not in a valid state.

  This happens because none of the callers of ufshcd_init() expect a
  non-negative error code.

  Fix the return value and documentation to match actual usage.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/a2b32bc1d9e359a9f90d0de6af16699facb10935
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/df96dbe1af7f6591c09f862f1226d3619b07e1b6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68316
    reference_type:
    reference_id: CVE-2025-68316
