advisory_id: CVE-2022-46145
datasource_id: nvd_importer_v2/CVE-2022-46145
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-46145
aliases: []
summary: authentik is an open-source identity provider. Versions prior to 2022.11.2 and 2022.10.2
  are vulnerable to unauthorized user creation and potential account takeover. With the default
  flows, unauthenticated users can create new accounts in authentik. If a flow exists that allows
  for email-verified password recovery, this can be used to overwrite the email address of admin
  accounts and take over their accounts. authentik 2022.11.2 and 2022.10.2 fix this issue. As
  a workaround, a policy can be created and bound to the `default-user-settings-flow flow` with
  the contents `return request.user.is_authenticated`.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-46145
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-46145
weaknesses:
  - CWE-306
  - CWE-287
references:
  - url: https://github.com/goauthentik/authentik/security/advisories/GHSA-mjfw-54m5-fvjf
    reference_type:
    reference_id:
  - url: https://goauthentik.io/docs/releases/2022.10#fixed-in-2022102
    reference_type:
    reference_id:
  - url: https://goauthentik.io/docs/releases/2022.11#fixed-in-2022112
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-46145
    reference_type:
    reference_id: CVE-2022-46145
