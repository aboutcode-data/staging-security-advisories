advisory_id: CVE-2025-38735
datasource_id: nvd_importer_v2/CVE-2025-38735
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38735
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  gve: prevent ethtool ops after shutdown

  A crash can occur if an ethtool operation is invoked
  after shutdown() is called.

  shutdown() is invoked during system shutdown to stop DMA operations
  without performing expensive deallocations. It is discouraged to
  unregister the netdev in this path, so the device may still be visible
  to userspace and kernel helpers.

  In gve, shutdown() tears down most internal data structures. If an
  ethtool operation is dispatched after shutdown(), it will dereference
  freed or NULL pointers, leading to a kernel panic. While graceful
  shutdown normally quiesces userspace before invoking the reboot
  syscall, forced shutdowns (as observed on GCP VMs) can still trigger
  this path.

  Fix by calling netif_device_detach() in shutdown().
  This marks the device as detached so the ethtool ioctl handler
  will skip dispatching operations to the driver.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38735
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/48a4e89d50e8ea52e800bc7865970b92fcf4647c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/75a9a46d67f46d608205888f9b34e315c1786345
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9d8a41e9a4ff83ff666de811e7f012167cdc00e9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a7efffeecb881b4649fdc30de020ef910f35d646
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ba51d73408edf815cbaeab148625576c2dd90192
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38735
    reference_type:
    reference_id: CVE-2025-38735
