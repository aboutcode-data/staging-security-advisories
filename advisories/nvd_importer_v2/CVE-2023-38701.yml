advisory_id: CVE-2023-38701
datasource_id: nvd_importer_v2/CVE-2023-38701
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-38701
aliases: []
summary: Hydra is the layer-two scalability solution for Cardano. Users of the Hydra head protocol
  send the UTxOs they wish to commit into the Hydra head first to the `commit` validator, where
  they remain until they are either collected into the `head` validator or the protocol initialisation
  is aborted and the value in the committed UTxOs is returned to the users who committed them.
  Prior to version 0.12.0, the `commit` validator contains a flawed check when the `ViaAbort`
  redeemer is used, which allows any user to spend any UTxO which is at the validator arbitrarily,
  meaning an attacker can steal the funds that users are trying to commit into the head validator.
  The intended behavior is that the funds must be returned to the user which committed the funds
  and can only be performed by a participant of the head. The `initial` validator also is similarly
  affected as the same flawed check is performed for the `ViaAbort` redeemer. Due to this issue,
  an attacker can steal any funds that user's try to commit into a Hydra head. Also, an attacker
  can prevent any Hydra head from being successfully opened. It does not allow an attacker to
  take funds which have been successfully collected into and currently reside in the `head`
  validator. Version 0.12.0 contains a fix for this issue.
impacted_packages: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38701
weaknesses:
  - CWE-20
references:
  - url: https://github.com/input-output-hk/hydra/blob/master/CHANGELOG.md#0120---2023-08-18
    reference_type:
    reference_id:
  - url: https://github.com/input-output-hk/hydra/blob/master/hydra-plutus/src/Hydra/Contract/Commit.hs#L94-L97
    reference_type:
    reference_id:
  - url: https://github.com/input-output-hk/hydra/blob/master/hydra-plutus/src/Hydra/Contract/Util.hs#L32-L42
    reference_type:
    reference_id:
  - url: https://github.com/input-output-hk/hydra/security/advisories/GHSA-6x9v-7x5r-w8w6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:iohk:hydra:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:iohk:hydra:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38701
    reference_type:
    reference_id: CVE-2023-38701
