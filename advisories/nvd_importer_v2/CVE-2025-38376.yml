advisory_id: CVE-2025-38376
datasource_id: nvd_importer_v2/CVE-2025-38376
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38376
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: chipidea: udc: disconnect/reconnect from host when do suspend/resume

  Shawn and John reported a hang issue during system suspend as below:

   - USB gadget is enabled as Ethernet
   - There is data transfer over USB Ethernet (scp a big file between host
                                               and device)
   - Device is going in/out suspend (echo mem > /sys/power/state)

  The root cause is the USB device controller is suspended but the USB bus
  is still active which caused the USB host continues to transfer data with
  device and the device continues to queue USB requests (in this case, a
  delayed TCP ACK packet trigger the issue) after controller is suspended,
  however the USB controller clock is already gated off. Then if udc driver
  access registers after that point, the system will hang.

  The correct way to avoid such issue is to disconnect device from host when
  the USB bus is not at suspend state. Then the host will receive disconnect
  event and stop data transfer in time. To continue make USB gadget device
  work after system resume, this will reconnect device automatically.

  To make usb wakeup work if USB bus is already at suspend state, this will
  keep connection for it only when USB device controller has enabled wakeup
  capability.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38376
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/31a6afbe86e8e9deba9ab53876ec49eafc7fd901
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5fd585fedb79bac2af9976b0fa3ffa354f0cc0bb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/937f49be49d6ee696eb5457c21ff89c135c9b5ae
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c68a27bbebbdb4e0ccd45d4f0df7111a09ddac24
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38376
    reference_type:
    reference_id: CVE-2025-38376
