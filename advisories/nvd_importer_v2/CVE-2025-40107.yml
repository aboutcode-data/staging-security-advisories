advisory_id: CVE-2025-40107
datasource_id: nvd_importer_v2/CVE-2025-40107
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40107
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  can: hi311x: fix null pointer dereference when resuming from sleep before interface was enabled

  This issue is similar to the vulnerability in the `mcp251x` driver,
  which was fixed in commit 03c427147b2d ("can: mcp251x: fix resume from
  sleep before interface was brought up").

  In the `hi311x` driver, when the device resumes from sleep, the driver
  schedules `priv->restart_work`. However, if the network interface was
  not previously enabled, the `priv->wq` (workqueue) is not allocated and
  initialized, leading to a null pointer dereference.

  To fix this, we move the allocation and initialization of the workqueue
  from the `hi3110_open` function to the `hi3110_can_probe` function.
  This ensures that the workqueue is properly initialized before it is
  used during device resume. And added logic to destroy the workqueue
  in the error handling paths of `hi3110_can_probe` and in the
  `hi3110_can_remove` function to prevent resource leaks.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1d2ef21f02baff0c109ad78b9e835fb4acb14533
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6b696808472197b77b888f50bc789a3bae077743
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d1fc4c041459e2d4856c1b2501486ba4f0cbf96b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e93af787187e585933570563c643337fa731584a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fd00cf38fd437c979f0e5905e3ebdfc3f55a4b96
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40107
    reference_type:
    reference_id: CVE-2025-40107
