advisory_id: CVE-2022-48713
datasource_id: nvd_importer_v2/CVE-2022-48713
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-48713
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  perf/x86/intel/pt: Fix crash with stop filters in single-range mode

  Add a check for !buf->single before calling pt_buffer_region_size in a
  place where a missing check can cause a kernel crash.

  Fixes a bug introduced by commit 670638477aed ("perf/x86/intel/pt:
  Opportunistically use single range output mode"), which added a
  support for PT single-range output mode. Since that commit if a PT
  stop filter range is hit while tracing, the kernel will crash because
  of a null pointer dereference in pt_handle_status due to calling
  pt_buffer_region_size without a ToPA configured.

  The commit which introduced single-range mode guarded almost all uses of
  the ToPA buffer variables with checks of the buf->single variable, but
  missed the case where tracing was stopped by the PT hardware, which
  happens when execution hits a configured stop filter.

  Tested that hitting a stop filter while PT recording successfully
  records a trace with this patch but crashes without this patch.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48713
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/1d9093457b243061a9bba23543c38726e864a643
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/456f041e035913fcedb275aff6f8a71dfebcd394
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e83d941fd3445f660d2f43647c580a320cc384f6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/feffb6ae2c80b9a8206450cdef90f5943baced99
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48713
    reference_type:
    reference_id: CVE-2022-48713
