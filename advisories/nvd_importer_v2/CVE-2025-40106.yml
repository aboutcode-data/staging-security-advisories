advisory_id: CVE-2025-40106
datasource_id: nvd_importer_v2/CVE-2025-40106
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40106
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  comedi: fix divide-by-zero in comedi_buf_munge()

  The comedi_buf_munge() function performs a modulo operation
  `async->munge_chan %= async->cmd.chanlist_len` without first
  checking if chanlist_len is zero. If a user program submits a command with
  chanlist_len set to zero, this causes a divide-by-zero error when the device
  processes data in the interrupt handler path.

  Add a check for zero chanlist_len at the beginning of the
  function, similar to the existing checks for !map and
  CMDF_RAWDATA flag. When chanlist_len is zero, update
  munge_count and return early, indicating the data was
  handled without munging.

  This prevents potential kernel panics from malformed user commands.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2670932f2465793fea1ef073e40883e8390fa4d9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4ffea48c69cb2b96a281cb7e5e42d706996631db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/55520f65fd447e04099a2c44185453c18ea73b7e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6db19822512396be1a3e1e20c16c97270285ba1a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/87b318ba81dda2ee7b603f4f6c55e78ec3e95974
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8f3e4cd9be4b47246ea73ce5e3e0fa2f57f0d10c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a4bb5d1bc2f238461bcbe5303eb500466690bb2c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d4854eff25efb06d0d84c13e7129bbdba4125f8c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40106
    reference_type:
    reference_id: CVE-2025-40106
