advisory_id: CVE-2022-49801
datasource_id: nvd_importer_v2/CVE-2022-49801
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49801
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tracing: Fix memory leak in tracing_read_pipe()

  kmemleak reports this issue:

  unreferenced object 0xffff888105a18900 (size 128):
    comm "test_progs", pid 18933, jiffies 4336275356 (age 22801.766s)
    hex dump (first 32 bytes):
      25 73 00 90 81 88 ff ff 26 05 00 00 42 01 58 04  %s......&...B.X.
      03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00  ................
    backtrace:
      [<00000000560143a1>] __kmalloc_node_track_caller+0x4a/0x140
      [<000000006af00822>] krealloc+0x8d/0xf0
      [<00000000c309be6a>] trace_iter_expand_format+0x99/0x150
      [<000000005a53bdb6>] trace_check_vprintf+0x1e0/0x11d0
      [<0000000065629d9d>] trace_event_printf+0xb6/0xf0
      [<000000009a690dc7>] trace_raw_output_bpf_trace_printk+0x89/0xc0
      [<00000000d22db172>] print_trace_line+0x73c/0x1480
      [<00000000cdba76ba>] tracing_read_pipe+0x45c/0x9f0
      [<0000000015b58459>] vfs_read+0x17b/0x7c0
      [<000000004aeee8ed>] ksys_read+0xed/0x1c0
      [<0000000063d3d898>] do_syscall_64+0x3b/0x90
      [<00000000a06dda7f>] entry_SYSCALL_64_after_hwframe+0x63/0xcd

  iter->fmt alloced in
    tracing_read_pipe() -> .. ->trace_iter_expand_format(), but not
  freed, to fix, add free in tracing_release_pipe()
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49801
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/2c21ee020ce43d744ecd7f3e9bddfcaafef270ce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/649e72070cbbb8600eb823833e4748f5a0815116
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a7d3f8f33c113478737bc61bb32ec5f9a987da7d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49801
    reference_type:
    reference_id: CVE-2022-49801
