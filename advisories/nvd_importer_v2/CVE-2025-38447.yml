advisory_id: CVE-2025-38447
datasource_id: nvd_importer_v2/CVE-2025-38447
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38447
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/rmap: fix potential out-of-bounds page table access during batched unmap

  As pointed out by David[1], the batched unmap logic in
  try_to_unmap_one() may read past the end of a PTE table when a large
  folio's PTE mappings are not fully contained within a single page
  table.

  While this scenario might be rare, an issue triggerable from userspace
  must be fixed regardless of its likelihood.  This patch fixes the
  out-of-bounds access by refactoring the logic into a new helper,
  folio_unmap_pte_batch().

  The new helper correctly calculates the safe batch size by capping the
  scan at both the VMA and PMD boundaries.  To simplify the code, it also
  supports partial batching (i.e., any number of pages from 1 up to the
  calculated safe maximum), as there is no strong reason to special-case
  for fully mapped folios.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38447
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/510fe9c15d07e765d96be9a9dc37e5057c6c09f4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ddd05742b45b083975a0855ef6ebbf88cf1f532a
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38447
    reference_type:
    reference_id: CVE-2025-38447
