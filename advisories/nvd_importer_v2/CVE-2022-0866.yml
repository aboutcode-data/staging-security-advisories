advisory_id: CVE-2022-0866
datasource_id: nvd_importer_v2/CVE-2022-0866
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-0866
aliases: []
summary: This is a concurrency issue that can result in the wrong caller principal being returned
  from the session context of an EJB that is configured with a RunAs principal. In particular,
  the org.jboss.as.ejb3.component.EJBComponent class has an incomingRunAsIdentity field. This
  field is used by the org.jboss.as.ejb3.security.RunAsPrincipalInterceptor to keep track of
  the current identity prior to switching to a new identity created using the RunAs principal.
  The exploit consist that the EJBComponent#incomingRunAsIdentity field is currently just a
  SecurityIdentity. This means in a concurrent environment, where multiple users are repeatedly
  invoking an EJB that is configured with a RunAs principal, it's possible for the wrong the
  caller principal to be returned from EJBComponent#getCallerPrincipal. Similarly, it's also
  possible for EJBComponent#isCallerInRole to return the wrong value. Both of these methods
  rely on incomingRunAsIdentity. Affects all versions of JBoss EAP from 7.1.0 and all versions
  of WildFly 11+ when Elytron is enabled.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-0866
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-0866
weaknesses:
  - CWE-863
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2060929#c0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:redhat:jboss_enterprise_application_platform:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:redhat:jboss_enterprise_application_platform:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:redhat:openstack_platform:13.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:redhat:openstack_platform:13.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:redhat:wildfly:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:redhat:wildfly:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:redhat:wildfly:27.0.0:alpha1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:redhat:wildfly:27.0.0:alpha1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-0866
    reference_type:
    reference_id: CVE-2022-0866
