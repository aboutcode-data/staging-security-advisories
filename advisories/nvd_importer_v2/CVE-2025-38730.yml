advisory_id: CVE-2025-38730
datasource_id: nvd_importer_v2/CVE-2025-38730
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38730
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  io_uring/net: commit partial buffers on retry

  Ring provided buffers are potentially only valid within the single
  execution context in which they were acquired. io_uring deals with this
  and invalidates them on retry. But on the networking side, if
  MSG_WAITALL is set, or if the socket is of the streaming type and too
  little was processed, then it will hang on to the buffer rather than
  recycle or commit it. This is problematic for two reasons:

  1) If someone unregisters the provided buffer ring before a later retry,
     then the req->buf_list will no longer be valid.

  2) If multiple sockers are using the same buffer group, then multiple
     receives can consume the same memory. This can cause data corruption
     in the application, as either receive could land in the same
     userspace buffer.

  Fix this by disallowing partial retries from pinning a provided buffer
  across multiple executions, if ring provided buffers are used.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38730
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/21a4ddb0f5e933f372808c10b9ac704505751bb1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2eb7937b5fc7fcd90eab7bebb0181214b61b9283
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3b53dc1c641f2884d4750fc25aaf6c36b90db606
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/41b70df5b38bc80967d2e0ed55cc3c3896bba781
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fe9da1812f8697a38f7e30991d568ec199e16059
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38730
    reference_type:
    reference_id: CVE-2025-38730
