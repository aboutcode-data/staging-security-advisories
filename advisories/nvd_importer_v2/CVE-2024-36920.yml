advisory_id: CVE-2024-36920
datasource_id: nvd_importer_v2/CVE-2024-36920
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-36920
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: mpi3mr: Avoid memcpy field-spanning write WARNING

  When the "storcli2 show" command is executed for eHBA-9600, mpi3mr driver
  prints this WARNING message:

    memcpy: detected field-spanning write (size 128) of single field "bsg_reply_buf->reply_buf" at drivers/scsi/mpi3mr/mpi3mr_app.c:1658 (size 1)
    WARNING: CPU: 0 PID: 12760 at drivers/scsi/mpi3mr/mpi3mr_app.c:1658 mpi3mr_bsg_request+0x6b12/0x7f10 [mpi3mr]

  The cause of the WARN is 128 bytes memcpy to the 1 byte size array "__u8
  replay_buf[1]" in the struct mpi3mr_bsg_in_reply_buf. The array is intended
  to be a flexible length array, so the WARN is a false positive.

  To suppress the WARN, remove the constant number '1' from the array
  declaration and clarify that it has flexible length. Also, adjust the
  memory allocation size to match the change.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-36920
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/429846b4b6ce9853e0d803a2357bb2e55083adf0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4d2772324f43cf5674ac3dbe3f74a7e656396716
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5f0266044dc611563539705bff0b3e1545fbb6aa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f09318244c6cafd10aca741b9c01e0a2c362d43a
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-36920
    reference_type:
    reference_id: CVE-2024-36920
