advisory_id: CVE-2021-21291
datasource_id: nvd_importer_v2/CVE-2021-21291
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21291
aliases: []
summary: OAuth2 Proxy is an open-source reverse proxy and static file server that provides authentication
  using Providers (Google, GitHub, and others) to validate accounts by email, domain or group.
  In OAuth2 Proxy before version 7.0.0, for users that use the whitelist domain feature, a domain
  that ended in a similar way to the intended domain could have been allowed as a redirect.
  For example, if a whitelist domain was configured for ".example.com", the intention is that
  subdomains of example.com are allowed. Instead, "example.com" and "badexample.com" could also
  match. This is fixed in version 7.0.0 onwards. As a workaround, one can disable the whitelist
  domain feature and run separate OAuth2 Proxy instances for each subdomain.
impacted_packages: []
severities:
  - score: '5.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21291
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21291
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21291
weaknesses:
  - CWE-601
references:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/commit/780ae4f3c99b579cb2ea9845121caebb6192f725
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/releases/tag/v7.0.0
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-4mf2-f3wh-gvf2
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/github.com/oauth2-proxy/oauth2-proxy/v7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:oauth2_proxy_project:oauth2_proxy:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:oauth2_proxy_project:oauth2_proxy:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21291
    reference_type:
    reference_id: CVE-2021-21291
