advisory_id: CVE-2025-64484
datasource_id: nvd_importer_v2/CVE-2025-64484
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-64484
aliases: []
summary: OAuth2-Proxy is an open-source tool that can act as either a standalone reverse proxy
  or a middleware component integrated into existing reverse proxy or load balancer setups.
  In versions prior to 7.13.0, all deployments of OAuth2 Proxy in front of applications that
  normalize underscores to dashes in HTTP headers (e.g., WSGI-based frameworks such as Django,
  Flask, FastAPI, and PHP applications). Authenticated users can inject underscore variants
  of X-Forwarded-* headers that bypass the proxyâ€™s filtering logic, potentially escalating privileges
  in the upstream app. OAuth2 Proxy authentication/authorization itself is not compromised.
  The problem has been patched with v7.13.0. By default all specified headers will now be normalized,
  meaning that both capitalization and the use of underscores (_) versus dashes (-) will be
  ignored when matching headers to be stripped. For example, both `X-Forwarded-For` and `X_Forwarded-for`
  will now be treated as equivalent and stripped away. For those who have a rational that requires
  keeping a similar looking header and not stripping it, the maintainers introduced a new configuration
  field for Headers managed through the AlphaConfig called `InsecureSkipHeaderNormalization`.
  As a workaround, ensure filtering and processing logic in upstream services don't treat underscores
  and hyphens in Headers the same way.
impacted_packages: []
severities:
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-64484
weaknesses:
  - CWE-644
references:
  - url: https://datatracker.ietf.org/doc/html/rfc2616#section-4.2
    reference_type:
    reference_id:
  - url: https://datatracker.ietf.org/doc/html/rfc822#section-3.2
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-vjrc-mh2v-45x6
    reference_type:
    reference_id:
  - url: https://github.security.telekom.com/2020/05/smuggling-http-headers-through-reverse-proxies.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64484
    reference_type:
    reference_id:
  - url: https://www.uptimia.com/questions/why-are-http-headers-with-underscores-dropped-by-nginx
    reference_type:
    reference_id:
