advisory_id: CVE-2025-39976
datasource_id: nvd_importer_v2/CVE-2025-39976
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39976
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  futex: Use correct exit on failure from futex_hash_allocate_default()

  copy_process() uses the wrong error exit path from futex_hash_allocate_default().
  After exiting from futex_hash_allocate_default(), neither tasklist_lock
  nor siglock has been acquired. The exit label bad_fork_core_free unlocks
  both of these locks which is wrong.

  The next exit label, bad_fork_cancel_cgroup, is the correct exit.
  sched_cgroup_fork() did not allocate any resources that need to freed.

  Use bad_fork_cancel_cgroup on error exit from futex_hash_allocate_default().
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/4ec3c15462b9f44562f45723a92e2807746ba7d1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f1635765cd0fdbf27b04d9a50be91a01b5adda13
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39976
    reference_type:
    reference_id: CVE-2025-39976
