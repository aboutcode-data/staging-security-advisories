advisory_id: CVE-2023-54300
datasource_id: nvd_importer_v2/CVE-2023-54300
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54300
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: ath9k: avoid referencing uninit memory in ath9k_wmi_ctrl_rx

  For the reasons also described in commit b383e8abed41 ("wifi: ath9k: avoid
  uninit memory read in ath9k_htc_rx_msg()"), ath9k_htc_rx_msg() should
  validate pkt_len before accessing the SKB.

  For example, the obtained SKB may have been badly constructed with
  pkt_len = 8. In this case, the SKB can only contain a valid htc_frame_hdr
  but after being processed in ath9k_htc_rx_msg() and passed to
  ath9k_wmi_ctrl_rx() endpoint RX handler, it is expected to have a WMI
  command header which should be located inside its data payload.

  Implement sanity checking inside ath9k_wmi_ctrl_rx(). Otherwise, uninit
  memory can be referenced.

  Tested on Qualcomm Atheros Communications AR9271 802.11n .

  Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0bc12e41af4e3ae1f0efecc377f0514459df0707
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/250efb4d3f5b32a115ea6bf25437ba44a1b3c04f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/28259ce4f1f1f9ab37fa817756c89098213d2fc0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/75acec91aeaa07375cd5f418069e61b16d39bbad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8ed572e52714593b209e3aa352406aff84481179
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/90e3c10177573b8662ac9858abd9bf731d5d98e0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ad5425e70789c29b93acafb5bb4629e4eb908296
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d1c2ff2bd84c3692c9df267a2b991ce92bfca8ef
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f24292e827088bba8de7158501ac25a59b064953
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54300
    reference_type:
    reference_id: CVE-2023-54300
