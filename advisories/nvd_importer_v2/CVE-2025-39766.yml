advisory_id: CVE-2025-39766
datasource_id: nvd_importer_v2/CVE-2025-39766
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39766
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/sched: Make cake_enqueue return NET_XMIT_CN when past buffer_limit

  The following setup can trigger a WARNING in htb_activate due to
  the condition: !cl->leaf.q->q.qlen

  tc qdisc del dev lo root
  tc qdisc add dev lo root handle 1: htb default 1
  tc class add dev lo parent 1: classid 1:1 \
         htb rate 64bit
  tc qdisc add dev lo parent 1:1 handle f: \
         cake memlimit 1b
  ping -I lo -f -c1 -s64 -W0.001 127.0.0.1

  This is because the low memlimit leads to a low buffer_limit, which
  causes packet dropping. However, cake_enqueue still returns
  NET_XMIT_SUCCESS, causing htb_enqueue to call htb_activate with an
  empty child qdisc. We should return NET_XMIT_CN when packets are
  dropped from the same tin and flow.

  I do not believe return value of NET_XMIT_CN is necessary for packet
  drops in the case of ack filtering, as that is meant to optimize
  performance, not to signal congestion.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39766
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0dacfc5372e314d1219f03e64dde3ab495a5a25e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/15de71d06a400f7fdc15bf377a2552b0ec437cf5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/62d591dde4defb1333d202410609c4ddeae060b3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/710866fc0a64eafcb8bacd91bcb1329eb7e5035f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7689ab22de36f8db19095f6bdf11f28cfde92f5c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aa12ee1c1bd260943fd6ab556d8635811c332eeb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/de04ddd2980b48caa8d7e24a7db2742917a8b280
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff57186b2cc39766672c4c0332323933e5faaa88
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39766
    reference_type:
    reference_id: CVE-2025-39766
