advisory_id: CVE-2024-36895
datasource_id: nvd_importer_v2/CVE-2024-36895
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-36895
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: gadget: uvc: use correct buffer size when parsing configfs lists

  This commit fixes uvc gadget support on 32-bit platforms.

  Commit 0df28607c5cb ("usb: gadget: uvc: Generalise helper functions for
  reuse") introduced a helper function __uvcg_iter_item_entries() to aid
  with parsing lists of items on configfs attributes stores. This function
  is a generalization of another very similar function, which used a
  stack-allocated temporary buffer of fixed size for each item in the list
  and used the sizeof() operator to check for potential buffer overruns.
  The new function was changed to allocate the now variably sized temp
  buffer on heap, but wasn't properly updated to also check for max buffer
  size using the computed size instead of sizeof() operator.

  As a result, the maximum item size was 7 (plus null terminator) on
  64-bit platforms, and 3 on 32-bit ones. While 7 is accidentally just
  barely enough, 3 is definitely too small for some of UVC configfs
  attributes. For example, dwFrameInteval, specified in 100ns units,
  usually has 6-digit item values, e.g. 166666 for 60fps.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-36895
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/650ae71c80749fc7cb8858c8049f532eaec64410
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7a54e5052bde582fd0e7677334fe7a5be92e242c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a422089ce42ced73713e5032aad29a9a7cbe9528
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-36895
    reference_type:
    reference_id: CVE-2024-36895
