advisory_id: CVE-2025-38563
datasource_id: nvd_importer_v2/CVE-2025-38563
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38563
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  perf/core: Prevent VMA split of buffer mappings

  The perf mmap code is careful about mmap()'ing the user page with the
  ringbuffer and additionally the auxiliary buffer, when the event supports
  it. Once the first mapping is established, subsequent mapping have to use
  the same offset and the same size in both cases. The reference counting for
  the ringbuffer and the auxiliary buffer depends on this being correct.

  Though perf does not prevent that a related mapping is split via mmap(2),
  munmap(2) or mremap(2). A split of a VMA results in perf_mmap_open() calls,
  which take reference counts, but then the subsequent perf_mmap_close()
  calls are not longer fulfilling the offset and size checks. This leads to
  reference count leaks.

  As perf already has the requirement for subsequent mappings to match the
  initial mapping, the obvious consequence is that VMA splits, caused by
  resizing of a mapping or partial unmapping, have to be prevented.

  Implement the vm_operations_struct::may_split() callback and return
  unconditionally -EINVAL.

  That ensures that the mapping offsets and sizes cannot be changed after the
  fact. Remapping to a different fixed address with the same size is still
  possible as it takes the references for the new mapping and drops those of
  the old mapping.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38563
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3bd518cc7ea61076bcd725e36ff0e690754977c0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/65311aad4c808bedad0c05d9bb8b06c47dae73eb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6757a31a8e295ae4f01717a954afda173f25a121
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b84cb58d1f0aa07656802eae24689566e5f5b1b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b024d7b56c77191cde544f838debb7f8451cd0d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d52451a9210f2e5a079ba052918c93563518a9ff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e4346ffec2c44d6b0be834d59b20632b5bb5729e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e529888b7e8092912dd8789bdfc76685ccd2ff5f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff668930871e0198c7f4e325058b8b7c286787bd
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://www.zerodayinitiative.com/advisories/ZDI-25-873/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38563
    reference_type:
    reference_id: CVE-2025-38563
