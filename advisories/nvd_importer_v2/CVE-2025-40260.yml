advisory_id: CVE-2025-40260
datasource_id: nvd_importer_v2/CVE-2025-40260
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40260
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sched_ext: Fix scx_enable() crash on helper kthread creation failure

  A crash was observed when the sched_ext selftests runner was
  terminated with Ctrl+\ while test 15 was running:

  NIP [c00000000028fa58] scx_enable.constprop.0+0x358/0x12b0
  LR [c00000000028fa2c] scx_enable.constprop.0+0x32c/0x12b0
  Call Trace:
  scx_enable.constprop.0+0x32c/0x12b0 (unreliable)
  bpf_struct_ops_link_create+0x18c/0x22c
  __sys_bpf+0x23f8/0x3044
  sys_bpf+0x2c/0x6c
  system_call_exception+0x124/0x320
  system_call_vectored_common+0x15c/0x2ec

  kthread_run_worker() returns an ERR_PTR() on failure rather than NULL,
  but the current code in scx_alloc_and_add_sched() only checks for a NULL
  helper. Incase of failure on SIGQUIT, the error is not handled in
  scx_alloc_and_add_sched() and scx_enable() ends up dereferencing an
  error pointer.

  Error handling is fixed in scx_alloc_and_add_sched() to propagate
  PTR_ERR() into ret, so that scx_enable() jumps to the existing error
  path, avoiding random dereference on failure.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/625e173e2a59b6cf6cbfb51c0a6bea47f3861eab
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b6216baae751369195fa3c83d434d23bcda406a
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40260
    reference_type:
    reference_id: CVE-2025-40260
