advisory_id: CVE-2022-50367
datasource_id: nvd_importer_v2/CVE-2022-50367
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50367
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fs: fix UAF/GPF bug in nilfs_mdt_destroy

  In alloc_inode, inode_init_always() could return -ENOMEM if
  security_inode_alloc() fails, which causes inode->i_private
  uninitialized. Then nilfs_is_metadata_file_inode() returns
  true and nilfs_free_inode() wrongly calls nilfs_mdt_destroy(),
  which frees the uninitialized inode->i_private
  and leads to crashes(e.g., UAF/GPF).

  Fix this by moving security_inode_alloc just prior to
  this_cpu_inc(nr_inodes)
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50367
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/1e555c3ed1fce4b278aaebe18a64a934cece57d8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2a96b532098284ecf8e4849b8b9e5fc7a28bdee9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2e488f13755ffbb60f307e991b27024716a33b29
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/64b79e632869ad3ef6c098a4731d559381da1115
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/70e4f70d54e0225f91814e8610477d65f33cefe4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/81de80330fa6907aec32eb54c5619059e6e36452
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c0aa76b0f17f59dd9c9d3463550a2986a1d592e4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d1ff475d7c83289d0a7faef346ea3bbf90818bad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ec2aab115eb38ac4992ea2fcc2a02fbe7af5cf48
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50367
    reference_type:
    reference_id: CVE-2022-50367
