advisory_id: CVE-2025-40337
datasource_id: nvd_importer_v2/CVE-2025-40337
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40337
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: stmmac: Correctly handle Rx checksum offload errors

  The stmmac_rx function would previously set skb->ip_summed to
  CHECKSUM_UNNECESSARY if hardware checksum offload (CoE) was enabled
  and the packet was of a known IP ethertype.

  However, this logic failed to check if the hardware had actually
  reported a checksum error. The hardware status, indicating a header or
  payload checksum failure, was being ignored at this stage. This could
  cause corrupt packets to be passed up the network stack as valid.

  This patch corrects the logic by checking the `csum_none` status flag,
  which is set when the hardware reports a checksum error. If this flag
  is set, skb->ip_summed is now correctly set to CHECKSUM_NONE,
  ensuring the kernel's network stack will perform its own validation and
  properly handle the corrupt packet.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1aa319e0f12d2d761a31556b82a5852c98eb0bea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/63fbe0e6413279d5ea5842e2423e351ded547683
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/719fcdf29051f7471d5d433475af76219019d33d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ee0aace5f844ef59335148875d05bec8764e71e8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40337
    reference_type:
    reference_id: CVE-2025-40337
