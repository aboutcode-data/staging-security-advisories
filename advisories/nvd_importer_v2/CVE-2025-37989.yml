advisory_id: CVE-2025-37989
datasource_id: nvd_importer_v2/CVE-2025-37989
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37989
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: phy: leds: fix memory leak

  A network restart test on a router led to an out-of-memory condition,
  which was traced to a memory leak in the PHY LED trigger code.

  The root cause is misuse of the devm API. The registration function
  (phy_led_triggers_register) is called from phy_attach_direct, not
  phy_probe, and the unregister function (phy_led_triggers_unregister)
  is called from phy_detach, not phy_remove. This means the register and
  unregister functions can be called multiple times for the same PHY
  device, but devm-allocated memory is not freed until the driver is
  unbound.

  This also prevents kmemleak from detecting the leak, as the devm API
  internally stores the allocated pointer.

  Fix this by replacing devm_kzalloc/devm_kcalloc with standard
  kzalloc/kcalloc, and add the corresponding kfree calls in the unregister
  path.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37989
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/41143e71052a00d654c15dc924fda50c1e7357d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/618541a6cc1511064dfa58c89b3445e21844092f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/663c3da86e807c6c07ed48f911c7526fad6fe1ff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7f3d5880800f962c347777c4f8358f29f5fc403c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95bed65cc0eb2a610550abf849a8b94374da80a7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/966d6494e2ed9be9052fcd9815afba830896aaf8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b7f0ee992adf601aa00c252418266177eb7ac2bc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f41f097f68a33d392579885426d0734a81219501
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37989
    reference_type:
    reference_id: CVE-2025-37989
