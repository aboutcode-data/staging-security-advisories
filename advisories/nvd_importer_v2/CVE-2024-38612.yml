advisory_id: CVE-2024-38612
datasource_id: nvd_importer_v2/CVE-2024-38612
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-38612
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ipv6: sr: fix invalid unregister error path

  The error path of seg6_init() is wrong in case CONFIG_IPV6_SEG6_LWTUNNEL
  is not defined. In that case if seg6_hmac_init() fails, the
  genl_unregister_family() isn't called.

  This issue exist since commit 46738b1317e1 ("ipv6: sr: add option to control
  lwtunnel support"), and commit 5559cea2d5aa ("ipv6: sr: fix possible
  use-after-free and null-ptr-deref") replaced unregister_pernet_subsys()
  with genl_unregister_family() in this error path.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-38612
weaknesses:
  - CWE-416
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/00e6335329f23ac6cf3105931691674e28bc598c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/10610575a3ac2a702bf5c57aa931beaf847949c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/160e9d2752181fcf18c662e74022d77d3164cd45
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1a63730fb315bb1bab97edd69ff58ad45e04bb01
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3398a40dccb88d3a7eef378247a023a78472db66
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/646cd236c55e2cb5f146fc41bbe4034c4af5b2a4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/85a70ff1e572160f1eeb096ed48d09a1c9d4d89a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c04d6a914e890ccea4a9d11233009a2ee7978bf4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e77a3ec7ada84543e75722a1283785a6544de925
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-38612
    reference_type:
    reference_id: CVE-2024-38612
