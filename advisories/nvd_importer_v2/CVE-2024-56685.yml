advisory_id: CVE-2024-56685
datasource_id: nvd_importer_v2/CVE-2024-56685
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-56685
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ASoC: mediatek: Check num_codecs is not zero to avoid panic during probe

  Following commit 13f58267cda3 ("ASoC: soc.h: don't create dummy
  Component via COMP_DUMMY()"), COMP_DUMMY() became an array with zero
  length, and only gets populated with the dummy struct after the card is
  registered. Since the sound card driver's probe happens before the card
  registration, accessing any of the members of a dummy component during
  probe will result in undefined behavior.

  This can be observed in the mt8188 and mt8195 machine sound drivers. By
  omitting a dai link subnode in the sound card's node in the Devicetree,
  the default uninitialized dummy codec is used, and when its dai_name
  pointer gets passed to strcmp() it results in a null pointer dereference
  and a kernel panic.

  In addition to that, set_card_codec_info() in the generic helpers file,
  mtk-soundcard-driver.c, will populate a dai link with a dummy codec when
  a dai link node is present in DT but with no codec property.

  The result is that at probe time, a dummy codec can either be
  uninitialized with num_codecs = 0, or be an initialized dummy codec,
  with num_codecs = 1 and dai_name = "snd-soc-dummy-dai". In order to
  accommodate for both situations, check that num_codecs is not zero
  before accessing the codecs' fields but still check for the codec's dai
  name against "snd-soc-dummy-dai" as needed.

  While at it, also drop the check that dai_name is not null in the mt8192
  driver, introduced in commit 4d4e1b6319e5 ("ASoC: mediatek: mt8192:
  Check existence of dai_name before dereferencing"), as it is actually
  redundant given the preceding num_codecs != 0 check.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56685
weaknesses:
  - CWE-908
references:
  - url: https://git.kernel.org/stable/c/2f2020327cc8561d7c520d2f2d9acea84fa7b3a3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/376f4800f34a28def026ff5c5d4fc5e54e1744ff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/550279449ff54c5aa28cfca5c567308cbfb145f0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56685
    reference_type:
    reference_id: CVE-2024-56685
