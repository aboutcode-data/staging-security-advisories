advisory_id: CVE-2025-38620
datasource_id: nvd_importer_v2/CVE-2025-38620
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38620
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  zloop: fix KASAN use-after-free of tag set

  When a zoned loop device, or zloop device, is removed, KASAN enabled
  kernel reports "BUG KASAN use-after-free" in blk_mq_free_tag_set(). The
  BUG happens because zloop_ctl_remove() calls put_disk(), which invokes
  zloop_free_disk(). The zloop_free_disk() frees the memory allocated for
  the zlo pointer. However, after the memory is freed, zloop_ctl_remove()
  calls blk_mq_free_tag_set(&zlo->tag_set), which accesses the freed zlo.
  Hence the KASAN use-after-free.

   zloop_ctl_remove()
    put_disk(zlo->disk)
     put_device()
      kobject_put()
       ...
        zloop_free_disk()
          kvfree(zlo)
    blk_mq_free_tag_set(&zlo->tag_set)

  To avoid the BUG, move the call to blk_mq_free_tag_set(&zlo->tag_set)
  from zloop_ctl_remove() into zloop_free_disk(). This ensures that
  the tag_set is freed before the call to kvfree(zlo).
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38620
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/765761851d89c772f482494d452e266795460278
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c7c87046b41a9ef28ee7ac476c369da5b5228bc5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38620
    reference_type:
    reference_id: CVE-2025-38620
