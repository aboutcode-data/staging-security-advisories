advisory_id: CVE-2021-3882
datasource_id: nvd_importer_v2/CVE-2021-3882
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-3882
aliases: []
summary: LedgerSMB does not set the 'Secure' attribute on the session authorization cookie when
  the client uses HTTPS and the LedgerSMB server is behind a reverse proxy. By tricking a user
  to use an unencrypted connection (HTTP), an attacker may be able to obtain the authentication
  data by capturing network traffic. LedgerSMB 1.8 and newer switched from Basic authentication
  to using cookie authentication with encrypted cookies. Although an attacker can't access the
  information inside the cookie, nor the password of the user, possession of the cookie is enough
  to access the application as the user from which the cookie has been obtained. In order for
  the attacker to obtain the cookie, first of all the server must be configured to respond to
  unencrypted requests, the attacker must be suitably positioned to eavesdrop on the network
  traffic between the client and the server *and* the user must be tricked into using unencrypted
  HTTP traffic. Proper audit control and separation of duties limit Integrity impact of the
  attack vector. Users of LedgerSMB 1.8 are urged to upgrade to known-fixed versions. Users
  of LedgerSMB 1.7 or 1.9 are unaffected by this vulnerability and don't need to take action.
  As a workaround, users may configure their Apache or Nginx reverse proxy to add the Secure
  attribute at the network boundary instead of relying on LedgerSMB. For Apache, please refer
  to the 'Header always edit' configuration command in the mod_headers module. For Nginx, please
  refer to the 'proxy_cookie_flags' configuration command.
impacted_packages: []
severities:
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:H/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3882
  - score: '5.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3882
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3882
weaknesses:
  - CWE-311
  - CWE-614
references:
  - url: https://github.com/ledgersmb/ledgersmb/commit/c242f5a2abf4b99b0da205473cbba034f306bfe2
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/7061d97a-98a5-495a-8ba0-3a4c66091e9d
    reference_type:
    reference_id:
  - url: https://ledgersmb.org/cve-2021-3882-sensitive-non-secure-cookie
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:ledgersmb:ledgersmb:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:ledgersmb:ledgersmb:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3882
    reference_type:
    reference_id: CVE-2021-3882
