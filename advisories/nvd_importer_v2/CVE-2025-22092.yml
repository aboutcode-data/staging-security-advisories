advisory_id: CVE-2025-22092
datasource_id: nvd_importer_v2/CVE-2025-22092
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-22092
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  PCI: Fix NULL dereference in SR-IOV VF creation error path

  Clean up when virtfn setup fails to prevent NULL pointer dereference
  during device removal. The kernel oops below occurred due to incorrect
  error handling flow when pci_setup_device() fails.

  Add pci_iov_scan_device(), which handles virtfn allocation and setup and
  cleans up if pci_setup_device() fails, so pci_iov_add_virtfn() doesn't need
  to call pci_stop_and_remove_bus_device().  This prevents accessing
  partially initialized virtfn devices during removal.

    BUG: kernel NULL pointer dereference, address: 00000000000000d0
    RIP: 0010:device_del+0x3d/0x3d0
    Call Trace:
     pci_remove_bus_device+0x7c/0x100
     pci_iov_add_virtfn+0xfa/0x200
     sriov_enable+0x208/0x420
     mlx5_core_sriov_configure+0x6a/0x160 [mlx5_core]
     sriov_numvfs_store+0xae/0x1a0

  [bhelgaas: commit log, return ERR_PTR(-ENOMEM) directly]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-22092
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/04d50d953ab46d96b0b32d5ad955fceaa28622db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c67a233834b778b8c78f8b62c072ccf87a9eb6d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ef421b4d206f0d3681804b8f94f06a8458a53aaf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22092
    reference_type:
    reference_id: CVE-2025-22092
