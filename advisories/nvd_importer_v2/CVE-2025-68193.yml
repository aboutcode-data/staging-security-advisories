advisory_id: CVE-2025-68193
datasource_id: nvd_importer_v2/CVE-2025-68193
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68193
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/xe/guc: Add devm release action to safely tear down CT

  When a buffer object (BO) is allocated with the XE_BO_FLAG_GGTT_INVALIDATE
  flag, the driver initiates TLB invalidation requests via the CTB mechanism
  while releasing the BO. However a premature release of the CTB BO can lead
  to system crashes, as observed in:

  Oops: Oops: 0000 [#1] SMP NOPTI
  RIP: 0010:h2g_write+0x2f3/0x7c0 [xe]
  Call Trace:
   guc_ct_send_locked+0x8b/0x670 [xe]
   xe_guc_ct_send_locked+0x19/0x60 [xe]
   send_tlb_invalidation+0xb4/0x460 [xe]
   xe_gt_tlb_invalidation_ggtt+0x15e/0x2e0 [xe]
   ggtt_invalidate_gt_tlb.part.0+0x16/0x90 [xe]
   ggtt_node_remove+0x110/0x140 [xe]
   xe_ggtt_node_remove+0x40/0xa0 [xe]
   xe_ggtt_remove_bo+0x87/0x250 [xe]

  Introduce a devm-managed release action during xe_guc_ct_init() and
  xe_guc_ct_init_post_hwconfig() to ensure proper CTB disablement before
  resource deallocation, preventing the use-after-free scenario.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/52faa05fcd9f78af99abebe30a4b7b444744c991
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ee4b32220a6b41e71512e8804585325e685456ba
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68193
    reference_type:
    reference_id: CVE-2025-68193
