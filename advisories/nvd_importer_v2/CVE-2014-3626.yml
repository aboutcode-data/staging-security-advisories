advisory_id: CVE-2014-3626
datasource_id: nvd_importer_v2/CVE-2014-3626
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2014-3626
aliases: []
summary: 'The Grails Resource Plugin often has to exchange URIs for resources with other internal
  components. Those other components will decode any URI passed to them. To protect against
  directory traversal the Grails Resource Plugin did the following: normalized the URI, checked
  the normalized URI did not step outside the appropriate root directory (e.g. the web application
  root), decoded the URI and checked that this did not introduce additional /../ (and similar)
  sequences. A bug was introduced where the Grails Resource Plugin before 1.2.13 returned the
  decoded version of the URI rather than the normalized version of the URI after the directory
  traversal check. This exposed a double decoding vulnerability. To address this issue, the
  Grails Resource Plugin now repeatedly decodes the URI up to three times or until decoding
  no longer changes the URI. If the decode limit of 3 is exceeded the URI is rejected. A side-effect
  of this is that the Grails Resource Plugin is unable to serve a resource that includes a ''%''
  character in the full path to the resource. Not all environments are vulnerable because of
  the differences in URL resolving in different servlet containers. Applications deployed to
  Tomcat 8 and Jetty 9 were found not not be vulnerable, however applications deployed to JBoss
  EAP 6.3 / JBoss AS 7.4 and JBoss AS 7.1 were found to be vulnerable (other JBoss versions
  weren''t tested). In certain cases JBoss returns JBoss specific vfs protocol urls from URL
  resolution methods (ClassLoader.getResources). The JBoss vfs URL protocol supports resolving
  any file on the filesystem. This made the directory traversal possible. There may be other
  containers, in addition to JBoss, on which this vulnerability is exposed.'
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2014-3626
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2014-3626
weaknesses:
  - CWE-22
references:
  - url: https://pivotal.io/security/cve-2014-3626
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:grails:resources:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:grails:resources:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2014-3626
    reference_type:
    reference_id: CVE-2014-3626
