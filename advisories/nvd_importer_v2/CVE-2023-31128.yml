advisory_id: CVE-2023-31128
datasource_id: nvd_importer_v2/CVE-2023-31128
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-31128
aliases: []
summary: NextCloud Cookbook is a recipe library app. Prior to commit a46d9855 on the `master`
  branch and commit 489bb744 on the `main-0.9.x` branch, the `pull-checks.yml` workflow is vulnerable
  to command injection attacks because of using an untrusted `github.head_ref` field. The `github.head_ref`
  value is an attacker-controlled value. Assigning the value to `zzz";echo${IFS}"hello";#` can
  lead to command injection. Since the permission is not restricted, the attacker has a write-access
  to the repository. This issue is fixed in commit a46d9855 on the `master` branch and commit
  489bb744 on the `main-0.9.x` branch. There is no risk for the user of the app within the NextCloud
  server. This only affects the main repository and possible forks of it. Those who have forked
  the NextCloud Cookbook repository should make sure their forks are on the latest version to
  prevent code injection attacks and similar.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-31128
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-31128
weaknesses:
  - CWE-78
references:
  - url: https://github.com/nextcloud/cookbook/blob/a14d6ffc4d45e1447556f68606129dfd6c1505cf/.github/workflows/pull-checks.yml#L67
    reference_type:
    reference_id:
  - url: https://github.com/nextcloud/cookbook/commit/489bb744
    reference_type:
    reference_id:
  - url: https://github.com/nextcloud/cookbook/commit/a46d98559e2c64292da9ffb06138cccc2e50ae1b
    reference_type:
    reference_id:
  - url: https://github.com/nextcloud/cookbook/security/advisories/GHSA-c5pc-mf2f-xq8h
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/research/github-actions-untrusted-input/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nextcloud:cookbook:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:nextcloud:cookbook:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-31128
    reference_type:
    reference_id: CVE-2023-31128
