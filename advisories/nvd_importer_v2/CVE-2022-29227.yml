advisory_id: CVE-2022-29227
datasource_id: nvd_importer_v2/CVE-2022-29227
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-29227
aliases: []
summary: Envoy is a cloud-native high-performance edge/middle/service proxy. In versions prior
  to 1.22.1 if Envoy attempts to send an internal redirect of an HTTP request consisting of
  more than HTTP headers, thereâ€™s a lifetime bug which can be triggered. If while replaying
  the request Envoy sends a local reply when the redirect headers are processed, the downstream
  state indicates that the downstream stream is not complete. On sending the local reply, Envoy
  will attempt to reset the upstream stream, but as it is actually complete, and deleted, this
  result in a use-after-free. Users are advised to upgrade. Users unable to upgrade are advised
  to disable internal redirects if crashes are observed.
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29227
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29227
weaknesses:
  - CWE-416
references:
  - url: https://github.com/envoyproxy/envoy/commit/fe7c69c248f4fe5a9080c7ccb35275b5218bb5ab
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-rm2p-qvf6-pvr6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29227
    reference_type:
    reference_id: CVE-2022-29227
