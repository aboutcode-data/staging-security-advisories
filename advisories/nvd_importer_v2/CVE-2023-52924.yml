advisory_id: CVE-2023-52924
datasource_id: nvd_importer_v2/CVE-2023-52924
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-52924
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: nf_tables: don't skip expired elements during walk

  There is an asymmetry between commit/abort and preparation phase if the
  following conditions are met:

  1. set is a verdict map ("1.2.3.4 : jump foo")
  2. timeouts are enabled

  In this case, following sequence is problematic:

  1. element E in set S refers to chain C
  2. userspace requests removal of set S
  3. kernel does a set walk to decrement chain->use count for all elements
     from preparation phase
  4. kernel does another set walk to remove elements from the commit phase
     (or another walk to do a chain->use increment for all elements from
      abort phase)

  If E has already expired in 1), it will be ignored during list walk, so its use count
  won't have been changed.

  Then, when set is culled, ->destroy callback will zap the element via
  nf_tables_set_elem_destroy(), but this function is only safe for
  elements that have been deactivated earlier from the preparation phase:
  lack of earlier deactivate removes the element but leaks the chain use
  count, which results in a WARN splat when the chain gets removed later,
  plus a leak of the nft_chain structure.

  Update pipapo_get() not to skip expired elements, otherwise flush
  command reports bogus ENOENT errors.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52924
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1da4874d05da1526b11b82fc7f3c7ac38749ddf8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/24138933b97b055d486e8064b4a1721702442a9b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/59dab3bf0b8fc08eb802721c0532f13dd89209b8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7c7e658a36f8b1522bd3586d8137e5f93a25ddc5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/94313a196b44184b5b52c1876da6a537701b425a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b15ea4017af82011dd55225ce77cce3d4dfc169c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bd156ce9553dcaf2d6ee2c825d1a5a1718e86524
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52924
    reference_type:
    reference_id: CVE-2023-52924
