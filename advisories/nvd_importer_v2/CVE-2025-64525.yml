advisory_id: CVE-2025-64525
datasource_id: nvd_importer_v2/CVE-2025-64525
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-64525
aliases: []
summary: 'Astro is a web framework. In Astro versions 2.16.0 up to but excluding 5.15.5 which
  utilizeon-demand rendering, request headers `x-forwarded-proto` and `x-forwarded-port` are
  insecurely used, without sanitization, to build the URL. This has several consequences, the
  most important of which are: middleware-based protected route bypass (only via `x-forwarded-proto`),
  DoS via cache poisoning (if a CDN is present), SSRF (only via `x-forwarded-proto`), URL pollution
  (potential SXSS, if a CDN is present), and WAF bypass. Version 5.15.5 contains a patch.'
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-64525
weaknesses:
  - CWE-918
references:
  - url: https://github.com/withastro/astro/blob/970ac0f51172e1e6bff4440516a851e725ac3097/packages/astro/src/core/app/node.ts#L121
    reference_type:
    reference_id:
  - url: https://github.com/withastro/astro/blob/970ac0f51172e1e6bff4440516a851e725ac3097/packages/astro/src/core/app/node.ts#L97
    reference_type:
    reference_id:
  - url: https://github.com/withastro/astro/commit/dafbb1ba29912099c4faff1440033edc768af8b4
    reference_type:
    reference_id:
  - url: https://github.com/withastro/astro/security/advisories/GHSA-hr2q-hp5q-x767
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64525
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:astro:astro:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:astro:astro:*:*:*:*:*:node.js:*:*
