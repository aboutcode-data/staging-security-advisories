advisory_id: CVE-2022-49669
datasource_id: nvd_importer_v2/CVE-2022-49669
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49669
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mptcp: fix race on unaccepted mptcp sockets

  When the listener socket owning the relevant request is closed,
  it frees the unaccepted subflows and that causes later deletion
  of the paired MPTCP sockets.

  The mptcp socket's worker can run in the time interval between such delete
  operations. When that happens, any access to msk->first will cause an UaF
  access, as the subflow cleanup did not cleared such field in the mptcp
  socket.

  Address the issue explicitly traversing the listener socket accept
  queue at close time and performing the needed cleanup on the pending
  msk.

  Note that the locking is a bit tricky, as we need to acquire the msk
  socket lock, while still owning the subflow socket one.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49669
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/6aeed9045071f2252ff4e98fc13d1e304f33e5b0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a8a3e95c74e48c2c9b07b81fafda9122993f2e12
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49669
    reference_type:
    reference_id: CVE-2022-49669
