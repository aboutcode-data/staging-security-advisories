advisory_id: CVE-2025-40060
datasource_id: nvd_importer_v2/CVE-2025-40060
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40060
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  coresight: trbe: Return NULL pointer for allocation failures

  When the TRBE driver fails to allocate a buffer, it currently returns
  the error code "-ENOMEM". However, the caller etm_setup_aux() only
  checks for a NULL pointer, so it misses the error. As a result, the
  driver continues and eventually causes a kernel panic.

  Fix this by returning a NULL pointer from arm_trbe_alloc_buffer() on
  allocation failures. This allows that the callers can properly handle
  the failure.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/296da78494633e1ab5e2e74173a9c8683b04aa6b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8a55c161f7f9c1aa1c70611b39830d51c83ef36d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9768536f82600a05ce901e31ccfabd92c027ff71
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cef047e0a55cb07906fcaae99170f19a9c0bb6c2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f505a165f1c7cd37b4cb6952042a5984693a4067
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fe53a726d5edf864e80b490780cc135fc1adece9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40060
    reference_type:
    reference_id: CVE-2025-40060
