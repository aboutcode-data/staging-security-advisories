advisory_id: CVE-2024-58005
datasource_id: nvd_importer_v2/CVE-2024-58005
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-58005
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tpm: Change to kvalloc() in eventlog/acpi.c

  The following failure was reported on HPE ProLiant D320:

  [   10.693310][    T1] tpm_tis STM0925:00: 2.0 TPM (device-id 0x3, rev-id 0)
  [   10.848132][    T1] ------------[ cut here ]------------
  [   10.853559][    T1] WARNING: CPU: 59 PID: 1 at mm/page_alloc.c:4727 __alloc_pages_noprof+0x2ca/0x330
  [   10.862827][    T1] Modules linked in:
  [   10.866671][    T1] CPU: 59 UID: 0 PID: 1 Comm: swapper/0 Not tainted 6.12.0-lp155.2.g52785e2-default #1 openSUSE Tumbleweed (unreleased) 588cd98293a7c9eba9013378d807364c088c9375
  [   10.882741][    T1] Hardware name: HPE ProLiant DL320 Gen12/ProLiant DL320 Gen12, BIOS 1.20 10/28/2024
  [   10.892170][    T1] RIP: 0010:__alloc_pages_noprof+0x2ca/0x330
  [   10.898103][    T1] Code: 24 08 e9 4a fe ff ff e8 34 36 fa ff e9 88 fe ff ff 83 fe 0a 0f 86 b3 fd ff ff 80 3d 01 e7 ce 01 00 75 09 c6 05 f8 e6 ce 01 01 <0f> 0b 45 31 ff e9 e5 fe ff ff f7 c2 00 00 08 00 75 42 89 d9 80 e1
  [   10.917750][    T1] RSP: 0000:ffffb7cf40077980 EFLAGS: 00010246
  [   10.923777][    T1] RAX: 0000000000000000 RBX: 0000000000040cc0 RCX: 0000000000000000
  [   10.931727][    T1] RDX: 0000000000000000 RSI: 000000000000000c RDI: 0000000000040cc0

  The above transcript shows that ACPI pointed a 16 MiB buffer for the log
  events because RSI maps to the 'order' parameter of __alloc_pages_noprof().
  Address the bug by moving from devm_kmalloc() to devm_add_action() and
  kvmalloc() and devm_add_action().
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-58005
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0621d2599d6e02d05c85d6bbd58eaea2f15b3503
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/422d7f4e8d817be467986589c7968d3ea402f7da
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4c8bfe643bbd00b04ee8f9545ef33bf6a68c38db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/50365a6304a57266e8f4d3078060743c3b7a1e0d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/77779d1258a287f2c5c2c6aeae203e0996209c77
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a3a860bc0fd6c07332e4911cf9a238d20de90173
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a676c0401de59548a5bc1b7aaf98f556ae8ea6db
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-58005
    reference_type:
    reference_id: CVE-2024-58005
