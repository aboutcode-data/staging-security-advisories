advisory_id: CVE-2025-21647
datasource_id: nvd_importer_v2/CVE-2025-21647
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21647
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sched: sch_cake: add bounds checks to host bulk flow fairness counts

  Even though we fixed a logic error in the commit cited below, syzbot
  still managed to trigger an underflow of the per-host bulk flow
  counters, leading to an out of bounds memory access.

  To avoid any such logic errors causing out of bounds memory accesses,
  this commit factors out all accesses to the per-host bulk flow counters
  to a series of helpers that perform bounds-checking before any
  increments and decrements. This also has the benefit of improving
  readability by moving the conditional checks for the flow mode into
  these helpers, instead of having them spread out throughout the
  code (which was the cause of the original logic error).

  As part of this change, the flow quantum calculation is consolidated
  into a helper function, which means that the dithering applied to the
  ost load scaling is now applied both in the DRR rotation and when a
  sparse flow's quantum is first initiated. The only user-visible effect
  of this is that the maximum packet size that can be sent while a flow
  stays sparse will now vary with +/- one byte in some cases. This should
  not make a noticeable difference in practice, and thus it's not worth
  complicating the code to preserve the old behaviour.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21647
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/27202e2e8721c3b23831563c36ed5ac7818641ba
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/44fe1efb4961c1a5ccab16bb579dfc6b308ad58b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/737d4d91d35b5f7fa5bb442651472277318b0bfd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/91bb18950b88f955838ec0c1d97f74d135756dc7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a777e06dfc72bed73c05dcb437d7c27ad5f90f3f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b1a1743aaa4906c41c426eda97e2e2586f79246d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bb0245fa72b783cb23a9949c5048781341e91423
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21647
    reference_type:
    reference_id: CVE-2025-21647
