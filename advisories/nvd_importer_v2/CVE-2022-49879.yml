advisory_id: CVE-2022-49879
datasource_id: nvd_importer_v2/CVE-2022-49879
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49879
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: fix BUG_ON() when directory entry has invalid rec_len

  The rec_len field in the directory entry has to be a multiple of 4.  A
  corrupted filesystem image can be used to hit a BUG() in
  ext4_rec_len_to_disk(), called from make_indexed_dir().

   ------------[ cut here ]------------
   kernel BUG at fs/ext4/ext4.h:2413!
   ...
   RIP: 0010:make_indexed_dir+0x53f/0x5f0
   ...
   Call Trace:
    <TASK>
    ? add_dirent_to_buf+0x1b2/0x200
    ext4_add_entry+0x36e/0x480
    ext4_add_nondir+0x2b/0xc0
    ext4_create+0x163/0x200
    path_openat+0x635/0xe90
    do_filp_open+0xb4/0x160
    ? __create_object.isra.0+0x1de/0x3b0
    ? _raw_spin_unlock+0x12/0x30
    do_sys_openat2+0x91/0x150
    __x64_sys_open+0x6c/0xa0
    do_syscall_64+0x3c/0x80
    entry_SYSCALL_64_after_hwframe+0x46/0xb0

  The fix simply adds a call to ext4_check_dir_entry() to validate the
  directory entry, returning -EFSCORRUPTED if the entry is invalid.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49879
weaknesses:
  - CWE-617
references:
  - url: https://git.kernel.org/stable/c/156451a67b93986fb07c274ef6995ff40766c5ad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/17a0bc9bd697f75cfdf9b378d5eb2d7409c91340
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2fa24d0274fbf913b56ee31f15bc01168669d909
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/999cff2b6ce3b45c08abf793bf55534777421327
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ce1ee2c8827fb6493e91acbd50f664cf2a972c3d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49879
    reference_type:
    reference_id: CVE-2022-49879
