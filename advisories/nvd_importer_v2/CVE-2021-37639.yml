advisory_id: CVE-2021-37639
datasource_id: nvd_importer_v2/CVE-2021-37639
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-37639
aliases: []
summary: TensorFlow is an end-to-end open source platform for machine learning. When restoring
  tensors via raw APIs, if the tensor name is not provided, TensorFlow can be tricked into dereferencing
  a null pointer. Alternatively, attackers can read memory outside the bounds of heap allocated
  data by providing some tensor names but not enough for a successful restoration. The [implementation](https://github.com/tensorflow/tensorflow/blob/47a06f40411a69c99f381495f490536972152ac0/tensorflow/core/kernels/save_restore_tensor.cc#L158-L159)
  retrieves the tensor list corresponding to the `tensor_name` user controlled input and immediately
  retrieves the tensor at the restoration index (controlled via `preferred_shard` argument).
  This occurs without validating that the provided list has enough values. If the list is empty
  this results in dereferencing a null pointer (undefined behavior). If, however, the list has
  some elements, if the restoration index is outside the bounds this results in heap OOB read.
  We have patched the issue in GitHub commit 9e82dce6e6bd1f36a57e08fa85af213e2b2f2622. The fix
  will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1,
  TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported
  range.
impacted_packages: []
severities:
  - score: '4.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37639
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37639
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37639
weaknesses:
  - CWE-476
  - CWE-125
references:
  - url: https://github.com/tensorflow/tensorflow/commit/9e82dce6e6bd1f36a57e08fa85af213e2b2f2622
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-gh6x-4whr-2qv4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37639
    reference_type:
    reference_id: CVE-2021-37639
