advisory_id: CVE-2022-49558
datasource_id: nvd_importer_v2/CVE-2022-49558
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49558
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: nf_tables: double hook unregistration in netns path

  __nft_release_hooks() is called from pre_netns exit path which
  unregisters the hooks, then the NETDEV_UNREGISTER event is triggered
  which unregisters the hooks again.

  [  565.221461] WARNING: CPU: 18 PID: 193 at net/netfilter/core.c:495 __nf_unregister_net_hook+0x247/0x270
  [...]
  [  565.246890] CPU: 18 PID: 193 Comm: kworker/u64:1 Tainted: G            E     5.18.0-rc7+ #27
  [  565.253682] Workqueue: netns cleanup_net
  [  565.257059] RIP: 0010:__nf_unregister_net_hook+0x247/0x270
  [...]
  [  565.297120] Call Trace:
  [  565.300900]  <TASK>
  [  565.304683]  nf_tables_flowtable_event+0x16a/0x220 [nf_tables]
  [  565.308518]  raw_notifier_call_chain+0x63/0x80
  [  565.312386]  unregister_netdevice_many+0x54f/0xb50

  Unregister and destroy netdev hook from netns pre_exit via kfree_rcu
  so the NETDEV_UNREGISTER path see unregistered hooks.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49558
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3fac8ce48fa9fd61ee9056d3ed48b2edefca8b82
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/86c0154f4c3a56c5db8b9dd09e3ce885382c2c19
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9c413a8c8bb49cc16796371805ecb260e885bb2b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a3940dcf552f2393d1e8f263b386593f98abe829
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b09e6ccf0d12f9356e8e3508d3e3dce126298538
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f9a43007d3f7ba76d5e7f9421094f00f2ef202f8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.11:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.11:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49558
    reference_type:
    reference_id: CVE-2022-49558
