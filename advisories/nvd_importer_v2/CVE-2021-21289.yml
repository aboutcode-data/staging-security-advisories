advisory_id: CVE-2021-21289
datasource_id: nvd_importer_v2/CVE-2021-21289
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21289
aliases: []
summary: 'Mechanize is an open-source ruby library that makes automated web interaction easy.
  In Mechanize from version 2.0.0 and before version 2.7.7 there is a command injection vulnerability.
  Affected versions of mechanize allow for OS commands to be injected using several classes''
  methods which implicitly use Ruby''s Kernel.open method. Exploitation is possible only if
  untrusted input is used as a local filename and passed to any of these calls: Mechanize::CookieJar#load,
  Mechanize::CookieJar#save_as, Mechanize#download, Mechanize::Download#save, Mechanize::File#save,
  and Mechanize::FileResponse#read_body. This is fixed in version 2.7.7.'
impacted_packages: []
severities:
  - score: '7.6'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:H/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21289
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21289
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21289
weaknesses:
  - CWE-78
references:
  - url: https://github.com/sparklemotion/mechanize/commit/66a6a1bfa653a5f13274a396a5e5441238656aa0
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/mechanize/releases/tag/v2.7.7
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/mechanize/security/advisories/GHSA-qrqm-fpv6-6r8g
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2021/02/msg00021.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LBVVJUL4P4KCJH4IQTHFZ4ATXY7XXZPV/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YNFZ7ROYS6V4J5L5PRAJUG2AWC7VXR2V/
    reference_type:
    reference_id:
  - url: https://rubygems.org/gems/mechanize/
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202107-17
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mechanize_project:mechanize:*:*:*:*:*:ruby:*:*
    reference_type:
    reference_id: cpe:2.3:a:mechanize_project:mechanize:*:*:*:*:*:ruby:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21289
    reference_type:
    reference_id: CVE-2021-21289
