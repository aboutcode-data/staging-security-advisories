advisory_id: CVE-2025-21874
datasource_id: nvd_importer_v2/CVE-2025-21874
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21874
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dm-integrity: Avoid divide by zero in table status in Inline mode

  In Inline mode, the journal is unused, and journal_sectors is zero.

  Calculating the journal watermark requires dividing by journal_sectors,
  which should be done only if the journal is configured.

  Otherwise, a simple table query (dmsetup table) can cause OOPS.

  This bug did not show on some systems, perhaps only due to
  compiler optimization.

  On my 32-bit testing machine, this reliably crashes with the following:

   : Oops: divide error: 0000 [#1] PREEMPT SMP
   : CPU: 0 UID: 0 PID: 2450 Comm: dmsetup Not tainted 6.14.0-rc2+ #959
   : EIP: dm_integrity_status+0x2f8/0xab0 [dm_integrity]
   ...
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21874
weaknesses:
  - CWE-369
references:
  - url: https://git.kernel.org/stable/c/06d9895f265282e939a8933bb18de82eba2b4dda
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/22c6f577b3cb184857b440ae5e5916f6c9e7021d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7fb39882b20c98a9a393c244c86b56ef6933cff8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21874
    reference_type:
    reference_id: CVE-2025-21874
