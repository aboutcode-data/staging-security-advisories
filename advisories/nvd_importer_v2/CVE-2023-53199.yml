advisory_id: CVE-2023-53199
datasource_id: nvd_importer_v2/CVE-2023-53199
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53199
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: ath9k: hif_usb: clean up skbs if ath9k_hif_usb_rx_stream() fails

  Syzkaller detected a memory leak of skbs in ath9k_hif_usb_rx_stream().
  While processing skbs in ath9k_hif_usb_rx_stream(), the already allocated
  skbs in skb_pool are not freed if ath9k_hif_usb_rx_stream() fails. If we
  have an incorrect pkt_len or pkt_tag, the input skb is considered invalid
  and dropped. All the associated packets already in skb_pool should be
  dropped and freed. Added a comment describing this issue.

  The patch also makes remain_skb NULL after being processed so that it
  cannot be referenced after potential free. The initialization of hif_dev
  fields which are associated with remain_skb (rx_remain_len,
  rx_transfer_len and rx_pad_len) is moved after a new remain_skb is
  allocated.

  Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53199
weaknesses:
  - CWE-772
references:
  - url: https://git.kernel.org/stable/c/0af54343a76263a12dbae7fafb64eb47c4a6ad38
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3fc6401fafde11712a83089fa2cc874cfd10e2cd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/61490d2710277e8a55009b7682456ae22f8087cf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9acdec72787af1bc8ed92711b52118c8e3e638a2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c766e37fccd5a5c5059be7efcd9618bf8a2c17c3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cd8316767099920a5d41feed1afab0c482a43e9f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f26dd69f61eff2eedf5df2d199bdd23108309947
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53199
    reference_type:
    reference_id: CVE-2023-53199
