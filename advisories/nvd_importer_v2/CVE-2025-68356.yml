advisory_id: CVE-2025-68356
datasource_id: nvd_importer_v2/CVE-2025-68356
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68356
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  gfs2: Prevent recursive memory reclaim

  Function new_inode() returns a new inode with inode->i_mapping->gfp_mask
  set to GFP_HIGHUSER_MOVABLE.  This value includes the __GFP_FS flag, so
  allocations in that address space can recurse into filesystem memory
  reclaim.  We don't want that to happen because it can consume a
  significant amount of stack memory.

  Worse than that is that it can also deadlock: for example, in several
  places, gfs2_unstuff_dinode() is called inside filesystem transactions.
  This calls filemap_grab_folio(), which can allocate a new folio, which
  can trigger memory reclaim.  If memory reclaim recurses into the
  filesystem and starts another transaction, a deadlock will ensue.

  To fix these kinds of problems, prevent memory reclaim from recursing
  into filesystem code by making sure that the gfp_mask of inode address
  spaces doesn't include __GFP_FS.

  The "meta" and resource group address spaces were already using GFP_NOFS
  as their gfp_mask (which doesn't include __GFP_FS).  The default value
  of GFP_HIGHUSER_MOVABLE is less restrictive than GFP_NOFS, though.  To
  avoid being overly limiting, use the default value and only knock off
  the __GFP_FS flag.  I'm not sure if this will actually make a
  difference, but it also shouldn't hurt.

  This patch is loosely based on commit ad22c7a043c2 ("xfs: prevent stack
  overflows from page cache allocation").

  Fixes xfstest generic/273.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2c5f4a53476e3cab70adc77b38942c066bd2c17c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/49e7347f4644d031306d56cb4d51e467cbdcbc69
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9c0960ed112398bdb6c60ccf6e6b583bc59acede
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/edb2b255618621dc83d0ec23150e16b2c697077f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68356
    reference_type:
    reference_id: CVE-2025-68356
