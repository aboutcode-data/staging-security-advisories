advisory_id: CVE-2022-49051
datasource_id: nvd_importer_v2/CVE-2022-49051
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49051
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: usb: aqc111: Fix out-of-bounds accesses in RX fixup

  aqc111_rx_fixup() contains several out-of-bounds accesses that can be
  triggered by a malicious (or defective) USB device, in particular:

   - The metadata array (desc_offset..desc_offset+2*pkt_count) can be out of bounds,
     causing OOB reads and (on big-endian systems) OOB endianness flips.
   - A packet can overlap the metadata array, causing a later OOB
     endianness flip to corrupt data used by a cloned SKB that has already
     been handed off into the network stack.
   - A packet SKB can be constructed whose tail is far beyond its end,
     causing out-of-bounds heap data to be considered part of the SKB's
     data.

  Found doing variant analysis. Tested it with another driver (ax88179_178a), since
  I don't have a aqc111 device to test it, but the code looks very similar.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49051
weaknesses:
  - CWE-787
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/36311fe98f55dea9200c69e2dd6d6ddb8fc94080
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/404998a137bcb8a926f7c949030afbe285472593
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/afb8e246527536848b9b4025b40e613edf776a9d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b416898442f2b6aa9f1b2f2968ce07e3abaa05f7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d90df6da50c56ad8b1a132e3cf86b6cdf8f507b7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49051
    reference_type:
    reference_id: CVE-2022-49051
