advisory_id: CVE-2022-31122
datasource_id: nvd_importer_v2/CVE-2022-31122
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-31122
aliases: []
summary: Wire is an encrypted communication and collaboration platform. Versions prior to 2022-07-12/Chart
  4.19.0 are subject to Token Recipient Confusion. If an attacker has certain details of SAML
  IdP metadata, and configures their own SAML on the same backend, the attacker can delete all
  SAML authenticated accounts of a targeted team, Authenticate as a user of the attacked team
  and create arbitrary accounts in the context of the team if it is not managed by SCIM. This
  issue is fixed in wire-server 2022-07-12 and is already deployed on all Wire managed services.
  On-premise instances of wire-server need to be updated to 2022-07-12/Chart 4.19.0, so that
  their backends are no longer affected. As a workaround, the risk of an attack can be reduced
  by disabling SAML configuration for teams (galley.config.settings.featureFlags.sso). Helm
  overrides are located in `values/wire-server/values.yaml` Note that the ability to configure
  SAML SSO as a team is disabled by default for on-premise installations.
impacted_packages: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31122
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31122
weaknesses:
  - CWE-1270
  - CWE-287
references:
  - url: https://github.com/wireapp/wire-server/security/advisories/GHSA-gq27-gmgq-fmxw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:wire:wire_server:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:wire:wire_server:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31122
    reference_type:
    reference_id: CVE-2022-31122
