advisory_id: CVE-2022-50212
datasource_id: nvd_importer_v2/CVE-2022-50212
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50212
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: nf_tables: do not allow CHAIN_ID to refer to another table

  When doing lookups for chains on the same batch by using its ID, a chain
  from a different table can be used. If a rule is added to a table but
  refers to a chain in a different table, it will be linked to the chain in
  table2, but would have expressions referring to objects in table1.

  Then, when table1 is removed, the rule will not be removed as its linked to
  a chain in table2. When expressions in the rule are processed or removed,
  that will lead to a use-after-free.

  When looking for chains by ID, use the table that was used for the lookup
  by name, and only return chains belonging to that same table.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50212
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/0f49613a213d918af790c1276f79da741968de11
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/58e863f64ee3d0879297e5e53b646e4b91e59620
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/91501513016903077f91033fa5d2aa26cac399b2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95f466d22364a33d183509629d0879885b4f547e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e7dcb88ec8e85e4a8ad0ea494ea2f90f32d2583
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50212
    reference_type:
    reference_id: CVE-2022-50212
