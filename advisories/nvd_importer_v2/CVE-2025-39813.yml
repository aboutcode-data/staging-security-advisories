advisory_id: CVE-2025-39813
datasource_id: nvd_importer_v2/CVE-2025-39813
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39813
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ftrace: Fix potential warning in trace_printk_seq during ftrace_dump

  When calling ftrace_dump_one() concurrently with reading trace_pipe,
  a WARN_ON_ONCE() in trace_printk_seq() can be triggered due to a race
  condition.

  The issue occurs because:

  CPU0 (ftrace_dump)                              CPU1 (reader)
  echo z > /proc/sysrq-trigger

  !trace_empty(&iter)
  trace_iterator_reset(&iter) <- len = size = 0
                                                  cat /sys/kernel/tracing/trace_pipe
  trace_find_next_entry_inc(&iter)
    __find_next_entry
      ring_buffer_empty_cpu <- all empty
    return NULL

  trace_printk_seq(&iter.seq)
    WARN_ON_ONCE(s->seq.len >= s->seq.size)

  In the context between trace_empty() and trace_find_next_entry_inc()
  during ftrace_dump, the ring buffer data was consumed by other readers.
  This caused trace_find_next_entry_inc to return NULL, failing to populate
  `iter.seq`. At this point, due to the prior trace_iterator_reset, both
  `iter.seq.len` and `iter.seq.size` were set to 0. Since they are equal,
  the WARN_ON_ONCE condition is triggered.

  Move the trace_printk_seq() into the if block that checks to make sure the
  return value of trace_find_next_entry_inc() is non-NULL in
  ftrace_dump_one(), ensuring the 'iter.seq' is properly populated before
  subsequent operations.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39813
weaknesses:
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/28c8fb7ae2ad27d81c8de3c4fe608c509f6a18aa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4013aef2ced9b756a410f50d12df9ebe6a883e4a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5ab0ec206deb99eb3baf8f1d7602aeaa91dbcc85
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a6f0f8873cc30fd4543b09adf03f7f51d293f0e6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ced94e137e6cd5e79c65564841d3b7695d0f5fa3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e80ff23ba8bdb0f41a1afe2657078e4097d13a9a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f299353e7ccbcc5c2ed8993c48fbe7609cbe729a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fbd4cf7ee4db65ef36796769fe978e9eba6f0de4
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39813
    reference_type:
    reference_id: CVE-2025-39813
