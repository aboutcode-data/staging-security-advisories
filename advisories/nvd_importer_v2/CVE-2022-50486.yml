advisory_id: CVE-2022-50486
datasource_id: nvd_importer_v2/CVE-2022-50486
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50486
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: ethernet: ti: Fix return type of netcp_ndo_start_xmit()

  With clang's kernel control flow integrity (kCFI, CONFIG_CFI_CLANG),
  indirect call targets are validated against the expected function
  pointer prototype to make sure the call target is valid to help mitigate
  ROP attacks. If they are not identical, there is a failure at run time,
  which manifests as either a kernel panic or thread getting killed. A
  proposed warning in clang aims to catch these at compile time, which
  reveals:

    drivers/net/ethernet/ti/netcp_core.c:1944:21: error: incompatible function pointer types initializing 'netdev_tx_t (*)(struct sk_buff *, struct net_device *)' (aka 'enum netdev_tx (*)(struct sk_buff *, struct net_device *)') with an expression of type 'int (struct sk_buff *, struct net_device *)' [-Werror,-Wincompatible-function-pointer-types-strict]
            .ndo_start_xmit         = netcp_ndo_start_xmit,
                                      ^~~~~~~~~~~~~~~~~~~~
    1 error generated.

  ->ndo_start_xmit() in 'struct net_device_ops' expects a return type of
  'netdev_tx_t', not 'int'. Adjust the return type of
  netcp_ndo_start_xmit() to match the prototype's to resolve the warning
  and CFI failure.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50486
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/17bb9bdf701f3e811a9f4820b08b9538ade2641c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1e4953b826e12b31995564a459dbd4e9e4604a35
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5b0b6553bf4ad3a435a57e02c68d6075f384e1be
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/63fe6ff674a96cfcfc0fa8df1051a27aa31c70b4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/765636e58ba505cfe4927eda7ee83791b1c6402a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a413ebb6049edd881c6427cfa25a7efddd6a4f74
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a447479ea2cf35603b5739ea947885024b901222
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d837d74eae077cc3ef9e191ba8535b5f602d4673
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dbe1a6b930ae9647e8ce0b684c903ac67d4398eb
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50486
    reference_type:
    reference_id: CVE-2022-50486
