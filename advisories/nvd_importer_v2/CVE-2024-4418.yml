advisory_id: CVE-2024-4418
datasource_id: nvd_importer_v2/CVE-2024-4418
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-4418
aliases: []
summary: A race condition leading to a stack use-after-free flaw was found in libvirt. Due to
  a bad assumption in the virNetClientIOEventLoop() method, the `data` pointer to a stack-allocated
  virNetClientIOEventData structure ended up being used in the virNetClientIOEventFD callback
  while the data pointer's stack frame was concurrently being "freed" when returning from virNetClientIOEventLoop().
  The 'virtproxyd' daemon can be used to trigger requests. If libvirt is configured with fine-grained
  access control, this issue, in theory, allows a user to escape their otherwise limited access.
  This flaw allows a local, unprivileged user to access virtproxyd without authenticating. Remote
  users would need to authenticate before they could access it.
impacted_packages: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-4418
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-4418
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4IE44UIIC3QWBFRB4EUSFNLJBU6JLNSD/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/Q4ZQBAJVHIZMCZNTRPUW3ZKXRKLXRQZU/
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20250411-0002/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2278616
    reference_type: bug
    reference_id: 2278616
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-4418
    reference_type:
    reference_id: CVE-2024-4418
  - url: https://access.redhat.com/errata/RHSA-2024:4351
    reference_type:
    reference_id: RHSA-2024:4351
  - url: https://access.redhat.com/errata/RHSA-2024:4432
    reference_type:
    reference_id: RHSA-2024:4432
  - url: https://access.redhat.com/errata/RHSA-2024:4757
    reference_type:
    reference_id: RHSA-2024:4757
