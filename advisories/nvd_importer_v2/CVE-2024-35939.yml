advisory_id: CVE-2024-35939
datasource_id: nvd_importer_v2/CVE-2024-35939
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-35939
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dma-direct: Leak pages on dma_set_decrypted() failure

  On TDX it is possible for the untrusted host to cause
  set_memory_encrypted() or set_memory_decrypted() to fail such that an
  error is returned and the resulting memory is shared. Callers need to
  take care to handle these errors to avoid returning decrypted (shared)
  memory to the page allocator, which could lead to functional or security
  issues.

  DMA could free decrypted/shared pages if dma_set_decrypted() fails. This
  should be a rare case. Just leak the pages in this case instead of
  freeing them.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-35939
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/4031b72ca747a1e6e9ae4fa729e765b43363d66a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4e0cfb25d49da2e6261ad582f58ffa5b5dd8c8e9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b57326c96b7bc7638aa8c44e12afa2defe0c934c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b9fa16949d18e06bdf728a560f5c8af56d2bdcaf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35939
    reference_type:
    reference_id: CVE-2024-35939
