advisory_id: CVE-2023-54107
datasource_id: nvd_importer_v2/CVE-2023-54107
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54107
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  blk-cgroup: dropping parent refcount after pd_free_fn() is done

  Some cgroup policies will access parent pd through child pd even
  after pd_offline_fn() is done. If pd_free_fn() for parent is called
  before child, then UAF can be triggered. Hence it's better to guarantee
  the order of pd_free_fn().

  Currently refcount of parent blkg is dropped in __blkg_release(), which
  is before pd_free_fn() is called in blkg_free_work_fn() while
  blkg_free_work_fn() is called asynchronously.

  This patch make sure pd_free_fn() called from removing cgroup is ordered
  by delaying dropping parent refcount after calling pd_free_fn() for
  child.

  BTW, pd_free_fn() will also be called from blkcg_deactivate_policy()
  from deleting device, and following patches will guarantee the order.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/c7241babf0855d8a6180cd1743ff0ec34de40b4e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54107
    reference_type:
    reference_id: CVE-2023-54107
