advisory_id: CVE-2025-38704
datasource_id: nvd_importer_v2/CVE-2025-38704
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38704
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  rcu/nocb: Fix possible invalid rdp's->nocb_cb_kthread pointer access

  In the preparation stage of CPU online, if the corresponding
  the rdp's->nocb_cb_kthread does not exist, will be created,
  there is a situation where the rdp's rcuop kthreads creation fails,
  and then de-offload this CPU's rdp, does not assign this CPU's
  rdp->nocb_cb_kthread pointer, but this rdp's->nocb_gp_rdp and
  rdp's->rdp_gp->nocb_gp_kthread is still valid.

  This will cause the subsequent re-offload operation of this offline
  CPU, which will pass the conditional check and the kthread_unpark()
  will access invalid rdp's->nocb_cb_kthread pointer.

  This commit therefore use rdp's->nocb_gp_kthread instead of
  rdp_gp's->nocb_gp_kthread for safety check.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38704
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1bba3900ca18bdae28d1b9fa10f16a8f8cb2ada1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1c951683a720b17c9ecaad1932bc95b29044611f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9b5ec8e6b31755288a07b3abeeab8cd38e9d3c9d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cce3d027227c69e85896af9fbc6fa9af5c68f067
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38704
    reference_type:
    reference_id: CVE-2025-38704
