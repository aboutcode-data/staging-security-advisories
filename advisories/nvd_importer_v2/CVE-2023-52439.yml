advisory_id: CVE-2023-52439
datasource_id: nvd_importer_v2/CVE-2023-52439
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-52439
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nuio: Fix use-after-free\
  \ in uio_open\n\ncore-1\t\t\t\tcore-2\n-------------------------------------------------------\n\
  uio_unregister_device\t\tuio_open\n\t\t\t\tidev = idr_find()\ndevice_unregister(&idev->dev)\n\
  put_device(&idev->dev)\nuio_device_release\n\t\t\t\tget_device(&idev->dev)\nkfree(idev)\n\
  uio_free_minor(minor)\n\t\t\t\tuio_release\n\t\t\t\tput_device(&idev->dev)\n\t\t\t\tkfree(idev)\n\
  -------------------------------------------------------\n\nIn the core-1 uio_unregister_device(),\
  \ the device_unregister will kfree\nidev when the idev->dev kobject ref is 1. But after core-1\n\
  device_unregister, put_device and before doing kfree, the core-2 may\nget_device. Then:\n\
  1. After core-1 kfree idev, the core-2 will do use-after-free for idev.\n2. When core-2 do\
  \ uio_release and put_device, the idev will be double\n   freed.\n\nTo address this issue,\
  \ we can get idev atomic & inc idev reference with\nminor_lock."
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52439
weaknesses:
  - CWE-415
references:
  - url: https://git.kernel.org/stable/c/0c9ae0b8605078eafc3bea053cc78791e97ba2e2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/17a8519cb359c3b483fb5c7367efa9a8a508bdea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3174e0f7de1ba392dc191625da83df02d695b60c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35f102607054faafe78d2a6994b18d5d9d6e92ad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5cf604ee538ed0c467abe3b4cda5308a6398f0f7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e0be1229ae199ebb90b33102f74a0f22d152570
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/913205930da6213305616ac539447702eaa85e41
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e93da893d52d82d57fc0db2ca566024e0f26ff50
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00016.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20241227-0006/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.18:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.18:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.18:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.18:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.18:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.18:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.18:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.18:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.18:rc8:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.18:rc8:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52439
    reference_type:
    reference_id: CVE-2023-52439
