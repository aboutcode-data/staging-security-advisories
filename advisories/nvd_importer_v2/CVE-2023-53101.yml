advisory_id: CVE-2023-53101
datasource_id: nvd_importer_v2/CVE-2023-53101
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53101
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: zero i_disksize when initializing the bootloader inode

  If the boot loader inode has never been used before, the
  EXT4_IOC_SWAP_BOOT inode will initialize it, including setting the
  i_size to 0.  However, if the "never before used" boot loader has a
  non-zero i_size, then i_disksize will be non-zero, and the
  inconsistency between i_size and i_disksize can trigger a kernel
  warning:

   WARNING: CPU: 0 PID: 2580 at fs/ext4/file.c:319
   CPU: 0 PID: 2580 Comm: bb Not tainted 6.3.0-rc1-00004-g703695902cfa
   RIP: 0010:ext4_file_write_iter+0xbc7/0xd10
   Call Trace:
    vfs_write+0x3b1/0x5c0
    ksys_write+0x77/0x160
    __x64_sys_write+0x22/0x30
    do_syscall_64+0x39/0x80

  Reproducer:
   1. create corrupted image and mount it:
         mke2fs -t ext4 /tmp/foo.img 200
         debugfs -wR "sif <5> size 25700" /tmp/foo.img
         mount -t ext4 /tmp/foo.img /mnt
         cd /mnt
         echo 123 > file
   2. Run the reproducer program:
         posix_memalign(&buf, 1024, 1024)
         fd = open("file", O_RDWR | O_DIRECT);
         ioctl(fd, EXT4_IOC_SWAP_BOOT);
         write(fd, buf, 1024);

  Fix this by setting i_disksize as well as i_size to zero when
  initiaizing the boot loader inode.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53101
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/01a821aacc64d4b05dafd239dbc9b7856686002f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0d8a6c9a6415999fee1259ccf1796480c026b7d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3f00c476da8fe7c4c34ea16abb55d74127120413
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/59eee0cdf8c036f554add97a4da7c06d7a9ff34a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9cb27b1e76f0cc886ac09055bc41c0ab3f205167
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e9a4cc5486356158554f6ad73027d8635a48b34
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d6c1447e483c05dbcfb3ff77ac04237a82070b8c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f5361da1e60d54ec81346aee8e3d8baf1be0b762
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.3:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.3:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53101
    reference_type:
    reference_id: CVE-2023-53101
