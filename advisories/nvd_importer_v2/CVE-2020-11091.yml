advisory_id: CVE-2020-11091
datasource_id: nvd_importer_v2/CVE-2020-11091
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2020-11091
aliases: []
summary: In Weave Net before version 2.6.3, an attacker able to run a process as root in a container
  is able to respond to DNS requests from the host and thereby insert themselves as a fake service.
  In a cluster with an IPv4 internal network, if IPv6 is not totally disabled on the host (via
  ipv6.disable=1 on the kernel cmdline), it will be either unconfigured or configured on some
  interfaces, but it's pretty likely that ipv6 forwarding is disabled, ie /proc/sys/net/ipv6/conf//forwarding
  == 0. Also by default, /proc/sys/net/ipv6/conf//accept_ra == 1. The combination of these 2
  sysctls means that the host accepts router advertisements and configure the IPv6 stack using
  them. By sending rogue router advertisements, an attacker can reconfigure the host to redirect
  part or all of the IPv6 traffic of the host to the attacker controlled container. Even if
  there was no IPv6 traffic before, if the DNS returns A (IPv4) and AAAA (IPv6) records, many
  HTTP libraries will try to connect via IPv6 first then fallback to IPv4, giving an opportunity
  to the attacker to respond. If by chance you also have on the host a vulnerability like last
  year's RCE in apt (CVE-2019-3462), you can now escalate to the host. Weave Net version 2.6.3
  disables the accept_ra option on the veth devices that it creates.
impacted_packages: []
severities:
  - score: '3.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-11091
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-11091
weaknesses:
  - CWE-350
references:
  - url: https://github.com/weaveworks/weave/commit/15f21f1899060f7716c70a8555a084e836f39a60
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/weave/security/advisories/GHSA-59qg-grp7-5r73
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:weave:weave_net:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:weave:weave_net:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-11091
    reference_type:
    reference_id: CVE-2020-11091
