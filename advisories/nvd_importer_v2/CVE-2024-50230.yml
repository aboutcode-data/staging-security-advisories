advisory_id: CVE-2024-50230
datasource_id: nvd_importer_v2/CVE-2024-50230
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-50230
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nilfs2: fix kernel bug due to missing clearing of checked flag

  Syzbot reported that in directory operations after nilfs2 detects
  filesystem corruption and degrades to read-only,
  __block_write_begin_int(), which is called to prepare block writes, may
  fail the BUG_ON check for accesses exceeding the folio/page size,
  triggering a kernel bug.

  This was found to be because the "checked" flag of a page/folio was not
  cleared when it was discarded by nilfs2's own routine, which causes the
  sanity check of directory entries to be skipped when the directory
  page/folio is reloaded.  So, fix that.

  This was necessary when the use of nilfs2's own page discard routine was
  applied to more than just metadata files.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50230
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/41e192ad2779cae0102879612dfe46726e4396aa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/56c6171932a7fb267ac6cb4ff8759b93ee1d0e2e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/64afad73e4623308d8943645e5631f2c7a2d7971
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/994b2fa13a6c9cf3feca93090a9c337d48e3d60d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aa0cee46c5d3fd9a39575a4c8a4f65f25f095b89
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cd0cdb51b15203fa27d4b714be83b7dfffa0b752
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f05dbebb8ee34882505d53d83af7d18f28a49248
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f2f1fa446676c21edb777e6d2bc4fa8f956fab68
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50230
    reference_type:
    reference_id: CVE-2024-50230
