advisory_id: CVE-2023-20903
datasource_id: nvd_importer_v2/CVE-2023-20903
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-20903
aliases: []
summary: This disclosure regards a vulnerability related to UAA refresh tokens and external
  identity providers.Assuming that an external identity provider is linked to the UAA, a refresh
  token is issued to a client on behalf of a user from that identity provider, the administrator
  of the UAA deactivates the identity provider from the UAA. It is expected that the UAA would
  reject a refresh token during a refresh token grant, but it does not (hence the vulnerability).
  It will continue to issue access tokens to request presenting such refresh tokens, as if the
  identity provider was still active. As a result, clients with refresh tokens issued through
  the deactivated identity provider would still have access to Cloud Foundry resources until
  their refresh token expires (which defaults to 30 days).
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-20903
weaknesses:
  - CWE-613
references:
  - url: https://www.cloudfoundry.org/blog/cve-2023-20903-tokens-for-inactivated-idps-are-not-revoked-and-remain-valid-until-expiration/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:cloudfoundry:user_account_and_authentication:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:cloudfoundry:user_account_and_authentication:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-20903
    reference_type:
    reference_id: CVE-2023-20903
