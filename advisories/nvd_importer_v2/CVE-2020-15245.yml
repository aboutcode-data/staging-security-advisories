advisory_id: CVE-2020-15245
datasource_id: nvd_importer_v2/CVE-2020-15245
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2020-15245
aliases: []
summary: In Sylius before versions 1.6.9, 1.7.9 and 1.8.3, the user may register in a shop by
  email mail@example.com, verify it, change it to the mail another@domain.com and stay verified
  and enabled. This may lead to having accounts addressed to totally different emails, that
  were verified. Note, that this way one is not able to take over any existing account (guest
  or normal one). The issue has been patched in Sylius 1.6.9, 1.7.9 and 1.8.3. As a workaround,
  you may resolve this issue on your own by creating a custom event listener, which will listen
  to the sylius.customer.pre_update event. You can determine that email has been changed if
  customer email and user username are different. They are synchronized later on. Pay attention,
  to email changing behavior for administrators. You may need to skip this logic for them. In
  order to achieve this, you should either check master request path info, if it does not contain
  /admin prefix or adjust event triggered during customer update in the shop. You can find more
  information on how to customize the event here.
impacted_packages: []
severities:
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15245
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15245
weaknesses:
  - CWE-862
  - CWE-79
references:
  - url: https://github.com/Sylius/Sylius/commit/60636d711a4011e8694d10d201b53632c7e8ecaf
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/Sylius/security/advisories/GHSA-6gw4-x63h-5499
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sylius:sylius:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sylius:sylius:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15245
    reference_type:
    reference_id: CVE-2020-15245
