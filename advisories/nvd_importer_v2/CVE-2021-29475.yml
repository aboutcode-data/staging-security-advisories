advisory_id: CVE-2021-29475
datasource_id: nvd_importer_v2/CVE-2021-29475
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-29475
aliases: []
summary: 'HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown editor.
  An attacker is able to receive arbitrary files from the file system when exporting a note
  to PDF. Since the code injection has to take place as note content, there fore this exploit
  requires the attackers ability to modify a note. This will affect all instances, which have
  pdf export enabled. This issue has been fixed by https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65
  and is available in version 1.5.0. Starting the CodiMD/HedgeDoc instance with `CMD_ALLOW_PDF_EXPORT=false`
  or set `"allowPDFExport": false` in config.json can mitigate this issue for those who cannot
  upgrade. This exploit works because while PhantomJS doesn''t actually render the `file:///`
  references to the PDF file itself, it still uses them internally, and exfiltration is possible,
  and easy through JavaScript rendering. The impact is pretty bad, as the attacker is able to
  read the CodiMD/HedgeDoc `config.json` file as well any other files on the filesystem. Even
  though the suggested Docker deploy option doesn''t have many interesting files itself, the
  `config.json` still often contains sensitive information, database credentials, and maybe
  OAuth secrets among other things.'
impacted_packages: []
severities:
  - score: '5.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29475
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29475
weaknesses:
  - CWE-918
  - CWE-94
references:
  - url: https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65
    reference_type:
    reference_id:
  - url: https://github.com/hedgedoc/hedgedoc/security/advisories/GHSA-pxxg-px9v-6qf3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:hedgedoc:hedgedoc:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:hedgedoc:hedgedoc:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29475
    reference_type:
    reference_id: CVE-2021-29475
