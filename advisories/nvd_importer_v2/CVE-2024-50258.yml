advisory_id: CVE-2024-50258
datasource_id: nvd_importer_v2/CVE-2024-50258
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-50258
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: fix crash when config small gso_max_size/gso_ipv4_max_size

  Config a small gso_max_size/gso_ipv4_max_size will lead to an underflow
  in sk_dst_gso_max_size(), which may trigger a BUG_ON crash,
  because sk->sk_gso_max_size would be much bigger than device limits.
  Call Trace:
  tcp_write_xmit
      tso_segs = tcp_init_tso_segs(skb, mss_now);
          tcp_set_skb_tso_segs
              tcp_skb_pcount_set
                  // skb->len = 524288, mss_now = 8
                  // u16 tso_segs = 524288/8 = 65535 -> 0
                  tso_segs = DIV_ROUND_UP(skb->len, mss_now)
      BUG_ON(!tso_segs)
  Add check for the minimum value of gso_max_size and gso_ipv4_max_size.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50258
weaknesses:
  - CWE-191
references:
  - url: https://git.kernel.org/stable/c/90c8482a5d9791259ba77bfdc1849fc5128b4be7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ab5cf19fb0e4680f95e506d6c544259bf1111c4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac5977001eee7660c643f8e07a2de9001990b7b8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e72fd1389a5364bc6aa6312ecf30bdb5891b9486
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e9365368b483328639c03fc730448dccd5a25b6b
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50258
    reference_type:
    reference_id: CVE-2024-50258
