advisory_id: CVE-2026-27840
datasource_id: nvd_importer_v2/CVE-2026-27840
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-27840
aliases: []
summary: ZITADEL is an open source identity management platform. Starting in version 2.31.0
  and prior to versions 3.4.7 and 4.11.0, opaque OIDC access tokens in the v2 format truncated
  to 80 characters are still considered valid.  Zitadel uses a symmetric AES encryption for
  opaque tokens. The cleartext payload is a concatenation of a couple of identifiers, such as
  a token ID and user ID. Internally Zitadel has 2 different versions of token payloads. v1
  tokens are no longer created, but are still verified as to not invalidate existing session
  after upgrade. The cleartext payload has a format of `<token_id>:<user_id>`. v2 tokens distinguished
  further where the `token_id` is of the format `v2_<oidc_session_id>-at_<access_token_id>`.
  V1 token authZ/N session data is retrieved from the database using the (simple) `token_id`
  value and `user_id` value. The `user_id` (called `subject` in some parts of our code) was
  used as being the trusted user ID. V2 token authZ/N session data is retrieved from the database
  using the `oidc_session_id` and `access_token_id` and in this case the `user_id` from the
  token is ignored and taken from the session data in the database. By truncating the token
  to 80 chars, the user_id is now missing from the cleartext of the v2 token. The back-end still
  accepts this for above reasons. This issue is not considered exploitable, but may look awkward
  when reproduced. The patch in versions 4.11.0 and 3.4.7 resolves the issue by verifying the
  `user_id` from the token against the session data from the database. No known workarounds
  are available.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-27840
weaknesses:
  - CWE-302
references:
  - url: https://github.com/zitadel/zitadel/releases/tag/v3.4.7
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v4.11.0
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/security/advisories/GHSA-6mq3-xmgp-pjm5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-27840
    reference_type:
    reference_id: CVE-2026-27840
