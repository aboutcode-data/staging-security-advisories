advisory_id: CVE-2023-53484
datasource_id: nvd_importer_v2/CVE-2023-53484
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53484
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  lib: cpu_rmap: Avoid use after free on rmap->obj array entries

  When calling irq_set_affinity_notifier() with NULL at the notify
  argument, it will cause freeing of the glue pointer in the
  corresponding array entry but will leave the pointer in the array. A
  subsequent call to free_irq_cpu_rmap() will try to free this entry again
  leading to possible use after free.

  Fix that by setting NULL to the array entry and checking that we have
  non-zero at the array entry when iterating over the array in
  free_irq_cpu_rmap().

  The current code does not suffer from this since there are no cases
  where irq_set_affinity_notifier(irq, NULL) (note the NULL passed for the
  notify arg) is called, followed by a call to free_irq_cpu_rmap() so we
  don't hit and issue. Subsequent patches in this series excersize this
  flow, hence the required fix.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53484
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/4e0473f1060aa49621d40a113afde24818101d37
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/67bca5f1d644f4e79b694abd8052a177de81c37f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/981f339d2905b6a92ef59358158b326493aecac5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c6ed54dd90698dc0744d669524cc1c122ded8a16
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c9115f49cf260d24d8b5f2d9a4b63cb31a627bb4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cc2d2b3dbfb0ba57bc027fb7e1121250c50e4000
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d1308bd0b24cb1d78fa2747d5fa3e055cc628a48
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f748e15253833b771acbede14ea98f50831ac289
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.8:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.8:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53484
    reference_type:
    reference_id: CVE-2023-53484
