advisory_id: CVE-2021-41281
datasource_id: nvd_importer_v2/CVE-2021-41281
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-41281
aliases: []
summary: Synapse is a package for Matrix homeservers written in Python 3/Twisted. Prior to version
  1.47.1, Synapse instances with the media repository enabled can be tricked into downloading
  a file from a remote server into an arbitrary directory. No authentication is required for
  the affected endpoint. The last 2 directories and file name of the path are chosen randomly
  by Synapse and cannot be controlled by an attacker, which limits the impact. Homeservers with
  the media repository disabled are unaffected. Homeservers with a federation whitelist are
  also unaffected, since Synapse will check the remote hostname, including the trailing `../`s,
  against the whitelist. Server administrators should upgrade to 1.47.1 or later. Server administrators
  using a reverse proxy could, at the expense of losing media functionality, may block the certain
  endpoints as a workaround. Alternatively, non-containerized deployments can be adapted to
  use the hardened systemd config.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41281
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41281
weaknesses:
  - CWE-22
references:
  - url: https://github.com/matrix-org/synapse/commit/91f2bd090
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/releases/tag/v1.47.1
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-3hfw-x7gx-437c
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/EU7QRE55U4IUEDLKT5IYPWL3UXMELFAS/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/N3WY56LCEZ4ZECLWV5KMAXF2PSMUB4F2/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41281
    reference_type:
    reference_id: CVE-2021-41281
