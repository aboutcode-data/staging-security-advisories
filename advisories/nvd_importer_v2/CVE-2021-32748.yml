advisory_id: CVE-2021-32748
datasource_id: nvd_importer_v2/CVE-2021-32748
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-32748
aliases: []
summary: Nextcloud Richdocuments in an open source self hosted online office. Nextcloud uses
  the WOPI ("Web Application Open Platform Interface") protocol to communicate with the Collabora
  Editor, the communication between these two services was not protected by a credentials or
  IP check. Whilst this does not result in gaining access to data that the user has not yet
  access to, it can result in a bypass of any enforced watermark on documents as described on
  the [Nextcloud Virtual Data Room](https://nextcloud.com/virtual-data-room/) website and [our
  documentation](https://portal.nextcloud.com/article/nextcloud-and-virtual-data-room-configuration-59.html).
  The Nextcloud Richdocuments releases 3.8.3 and 4.2.0 add an additional admin settings for
  an allowlist of IP addresses that can access the WOPI API. We recommend upgrading and configuring
  the allowlist to a list of Collabora servers. There is no known workaround. Note that this
  primarily results a bypass of any configured watermark or download protection using File Access
  Control. If you do not require or rely on these as a security feature no immediate action
  is required on your end.
impacted_packages: []
severities:
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32748
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32748
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32748
weaknesses:
  - CWE-862
references:
  - url: https://github.com/nextcloud/richdocuments/pull/1640
    reference_type:
    reference_id:
  - url: https://github.com/nextcloud/security-advisories/security/advisories/GHSA-24x8-h6m2-9jf2
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1194606
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nextcloud:richdocuments:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:nextcloud:richdocuments:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32748
    reference_type:
    reference_id: CVE-2021-32748
