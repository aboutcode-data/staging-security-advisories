advisory_id: CVE-2025-21994
datasource_id: nvd_importer_v2/CVE-2025-21994
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21994
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ksmbd: fix incorrect validation for num_aces field of smb_acl

  parse_dcal() validate num_aces to allocate posix_ace_state_array.

  if (num_aces > ULONG_MAX / sizeof(struct smb_ace *))

  It is an incorrect validation that we can create an array of size ULONG_MAX.
  smb_acl has ->size field to calculate actual number of aces in request buffer
  size. Use this to check invalid num_aces.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21994
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1b8b67f3c5e5169535e26efedd3e422172e2db64
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9c4e202abff45f8eac17989e549fc7a75095f675
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a4cb17797a5d241f1e509cb5b46ed95a80c2f5fd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c3a3484d9d31b27a3db0fab91fcf191132d65236
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d0f87370622a853b57e851f7d5a5452b72300f19
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6a6721802ac2f12f4c1bbe839a4c229b61866f2
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21994
    reference_type:
    reference_id: CVE-2025-21994
