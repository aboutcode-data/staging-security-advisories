advisory_id: CVE-2026-23158
datasource_id: nvd_importer_v2/CVE-2026-23158
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23158
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  gpio: virtuser: fix UAF in configfs release path

  The gpio-virtuser configfs release path uses guard(mutex) to protect
  the device structure. However, the device is freed before the guard
  cleanup runs, causing mutex_unlock() to operate on freed memory.

  Specifically, gpio_virtuser_device_config_group_release() destroys
  the mutex and frees the device while still inside the guard(mutex)
  scope. When the function returns, the guard cleanup invokes
  mutex_unlock(&dev->lock), resulting in a slab use-after-free.

  Limit the mutex lifetime by using a scoped_guard() only around the
  activation check, so that the lock is released before mutex_destroy()
  and kfree() are called.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/53ad4a948a4586359b841d607c08fb16c5503230
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7bec90f605cfb138006f5ba575f2310593347110
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/815a8e3bf72811d402b30bd4a53cde5e9df7a563
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23158
    reference_type:
    reference_id: CVE-2026-23158
