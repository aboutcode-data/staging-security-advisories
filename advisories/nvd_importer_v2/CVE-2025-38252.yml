advisory_id: CVE-2025-38252
datasource_id: nvd_importer_v2/CVE-2025-38252
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38252
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  cxl/ras: Fix CPER handler device confusion

  By inspection, cxl_cper_handle_prot_err() is making a series of fragile
  assumptions that can lead to crashes:

  1/ It assumes that endpoints identified in the record are a CXL-type-3
     device, nothing guarantees that.

  2/ It assumes that the device is bound to the cxl_pci driver, nothing
     guarantees that.

  3/ Minor, it holds the device lock over the switch-port tracing for no
     reason as the trace is 100% generated from data in the record.

  Correct those by checking that the PCIe endpoint parents a cxl_memdev
  before assuming the format of the driver data, and move the lock to where
  it is required. Consequently this also makes the implementation ready for
  CXL accelerators that are not bound to cxl_pci.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38252
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3c70ec71abdaf4e4fa48cd8fdfbbd864d78235a8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4bcb8dd36e9e3fad6c22862ac5b6993df838309b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38252
    reference_type:
    reference_id: CVE-2025-38252
