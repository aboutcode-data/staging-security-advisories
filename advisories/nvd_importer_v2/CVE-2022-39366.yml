advisory_id: CVE-2022-39366
datasource_id: nvd_importer_v2/CVE-2022-39366
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-39366
aliases: []
summary: DataHub is an open-source metadata platform. Prior to version 0.8.45, the `StatelessTokenService`
  of the DataHub metadata service (GMS) does not verify the signature of JWT tokens. This allows
  an attacker to connect to DataHub instances as any user if Metadata Service authentication
  is enabled. This vulnerability occurs because the `StatelessTokenService` of the Metadata
  service uses the `parse` method of `io.jsonwebtoken.JwtParser`, which does not perform a verification
  of the cryptographic token signature. This means that JWTs are accepted regardless of the
  used algorithm. This issue may lead to an authentication bypass. Version 0.8.45 contains a
  patch for the issue. There are no known workarounds.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39366
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:H/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39366
weaknesses:
  - CWE-347
  - CWE-303
  - CWE-287
references:
  - url: https://codeql.github.com/codeql-query-help/java/java-missing-jwt-signature-check/
    reference_type:
    reference_id:
  - url: https://github.com/datahub-project/datahub/blob/aa146db611e3a4ca3aa17bb740783f789d4444d3/metadata-service/auth-impl/src/main/java/com/datahub/authentication/token/StatelessTokenService.java#L134
    reference_type:
    reference_id:
  - url: https://github.com/datahub-project/datahub/blob/aa146db611e3a4ca3aa17bb740783f789d4444d3/metadata-service/auth-impl/src/main/java/com/datahub/authentication/token/StatelessTokenService.java#L30
    reference_type:
    reference_id:
  - url: https://github.com/datahub-project/datahub/releases/tag/v0.8.45
    reference_type:
    reference_id:
  - url: https://github.com/datahub-project/datahub/security/advisories/GHSA-r8gm-v65f-c973
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:datahub:datahub:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:datahub:datahub:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39366
    reference_type:
    reference_id: CVE-2022-39366
