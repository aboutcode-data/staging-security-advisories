advisory_id: CVE-2022-50266
datasource_id: nvd_importer_v2/CVE-2022-50266
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50266
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  kprobes: Fix check for probe enabled in kill_kprobe()

  In kill_kprobe(), the check whether disarm_kprobe_ftrace() needs to be
  called always fails. This is because before that we set the
  KPROBE_FLAG_GONE flag for kprobe so that "!kprobe_disabled(p)" is always
  false.

  The disarm_kprobe_ftrace() call introduced by commit:

    0cb2f1372baa ("kprobes: Fix NULL pointer dereference at kprobe_ftrace_handler")

  to fix the NULL pointer reference problem. When the probe is enabled, if
  we do not disarm it, this problem still exists.

  Fix it by putting the probe enabled check before setting the
  KPROBE_FLAG_GONE flag.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50266
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/0c76ef3f26d5ef2ac2c21b47e7620cff35809fbb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c909985dd0c0f74b61e3f8f0e04bf8aa9c8b97c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f20a067f13106565816b4b6a6b665b2088a63824
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.9:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.9:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.9:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.9:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.9:rc8:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.9:rc8:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50266
    reference_type:
    reference_id: CVE-2022-50266
