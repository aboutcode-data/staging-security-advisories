advisory_id: CVE-2021-46994
datasource_id: nvd_importer_v2/CVE-2021-46994
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-46994
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  can: mcp251x: fix resume from sleep before interface was brought up

  Since 8ce8c0abcba3 the driver queues work via priv->restart_work when
  resuming after suspend, even when the interface was not previously
  enabled. This causes a null dereference error as the workqueue is only
  allocated and initialized in mcp251x_open().

  To fix this we move the workqueue init to mcp251x_can_probe() as there
  is no reason to do it later and repeat it whenever mcp251x_open() is
  called.

  [mkl: fix error handling in mcp251x_stop()]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46994
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/03c427147b2d3e503af258711af4fc792b89b0af
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6f8f1c27b577de15f69fefce3c502bb6300d825c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e1e10a390fd9479209c4d834d916ca5e6d5d396b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eecb4df8ec9f896b19ee05bfa632ac6c1dcd8f21
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-46994
    reference_type:
    reference_id: CVE-2021-46994
