advisory_id: CVE-2021-29512
datasource_id: nvd_importer_v2/CVE-2021-29512
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-29512
aliases: []
summary: TensorFlow is an end-to-end open source platform for machine learning. If the `splits`
  argument of `RaggedBincount` does not specify a valid `SparseTensor`(https://www.tensorflow.org/api_docs/python/tf/sparse/SparseTensor),
  then an attacker can trigger a heap buffer overflow. This will cause a read from outside the
  bounds of the `splits` tensor buffer in the implementation of the `RaggedBincount` op(https://github.com/tensorflow/tensorflow/blob/8b677d79167799f71c42fd3fa074476e0295413a/tensorflow/core/kernels/bincount_op.cc#L430-L433).
  Before the `for` loop, `batch_idx` is set to 0. The user controls the `splits` array, making
  it contain only one element, 0. Thus, the code in the `while` loop would increment `batch_idx`
  and then try to read `splits(1)`, which is outside of bounds. The fix will be included in
  TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2 and TensorFlow 2.3.3,
  as these are also affected.
impacted_packages: []
severities:
  - score: '4.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29512
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29512
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29512
weaknesses:
  - CWE-787
  - CWE-120
references:
  - url: https://github.com/tensorflow/tensorflow/commit/eebb96c2830d48597d055d247c0e9aebaea94cd5
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-4278-2v5v-65r4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29512
    reference_type:
    reference_id: CVE-2021-29512
