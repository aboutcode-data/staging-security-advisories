advisory_id: CVE-2021-32779
datasource_id: nvd_importer_v2/CVE-2021-32779
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-32779
aliases: []
summary: Envoy is an open source L7 proxy and communication bus designed for large modern service
  oriented architectures. In affected versions envoy incorrectly handled a URI '#fragment' element
  as part of the path element. Envoy is configured with an RBAC filter for authorization or
  similar mechanism with an explicit case of a final "/admin" path element, or is using a negative
  assertion with final path element of "/admin". The client sends request to "/app1/admin#foo".
  In Envoy prior to 1.18.0, or 1.18.0+ configured with path_normalization=false. Envoy treats
  fragment as a suffix of the query string when present, or as a suffix of the path when query
  string is absent, so it evaluates the final path element as "/admin#foo" and mismatches with
  the configured "/admin" path element. In Envoy 1.18.0+ configured with path_normalization=true.
  Envoy transforms this to /app1/admin%23foo and mismatches with the configured /admin prefix.
  The resulting URI is sent to the next server-agent with the offending "#foo" fragment which
  violates RFC3986 or with the nonsensical "%23foo" text appended. A specifically constructed
  request with URI containing '#fragment' element delivered by an untrusted client in the presence
  of path based request authorization resulting in escalation of Privileges when path based
  request authorization extensions. Envoy versions 1.19.1, 1.18.4, 1.17.4, 1.16.5 contain fixes
  that removes fragment from URI path in incoming requests.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32779
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32779
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32779
weaknesses:
  - CWE-863
  - CWE-551
  - CWE-697
references:
  - url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-r222-74fw-jqr9
    reference_type:
    reference_id:
  - url: https://www.envoyproxy.io/docs/envoy/v1.19.0/version_history/version_history
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:1.19.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:1.19.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32779
    reference_type:
    reference_id: CVE-2021-32779
