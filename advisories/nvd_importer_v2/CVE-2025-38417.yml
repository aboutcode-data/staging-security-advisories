advisory_id: CVE-2025-38417
datasource_id: nvd_importer_v2/CVE-2025-38417
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38417
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ice: fix eswitch code memory leak in reset scenario

  Add simple eswitch mode checker in attaching VF procedure and allocate
  required port representor memory structures only in switchdev mode.
  The reset flows triggers VF (if present) detach/attach procedure.
  It might involve VF port representor(s) re-creation if the device is
  configured is switchdev mode (not legacy one).
  The memory was blindly allocated in current implementation,
  regardless of the mode and not freed if in legacy mode.

  Kmemeleak trace:
  unreferenced object (percpu) 0x7e3bce5b888458 (size 40):
    comm "bash", pid 1784, jiffies 4295743894
    hex dump (first 32 bytes on cpu 45):
      00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
      00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
    backtrace (crc 0):
      pcpu_alloc_noprof+0x4c4/0x7c0
      ice_repr_create+0x66/0x130 [ice]
      ice_repr_create_vf+0x22/0x70 [ice]
      ice_eswitch_attach_vf+0x1b/0xa0 [ice]
      ice_reset_all_vfs+0x1dd/0x2f0 [ice]
      ice_pci_err_resume+0x3b/0xb0 [ice]
      pci_reset_function+0x8f/0x120
      reset_store+0x56/0xa0
      kernfs_fop_write_iter+0x120/0x1b0
      vfs_write+0x31c/0x430
      ksys_write+0x61/0xd0
      do_syscall_64+0x5b/0x180
      entry_SYSCALL_64_after_hwframe+0x76/0x7e

  Testing hints (ethX is PF netdev):
  - create at least one VF
      echo 1 > /sys/class/net/ethX/device/sriov_numvfs
  - trigger the reset
      echo 1 > /sys/class/net/ethX/device/reset
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38417
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/48c8b214974dc55283bd5f12e3a483b27c403bbc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d6715193de439b79f1d6a4c03593c7529239b545
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e97a7a051b55f55f276c1568491d0ed7f890ee94
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38417
    reference_type:
    reference_id: CVE-2025-38417
