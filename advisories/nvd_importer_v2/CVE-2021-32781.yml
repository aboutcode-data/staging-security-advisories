advisory_id: CVE-2021-32781
datasource_id: nvd_importer_v2/CVE-2021-32781
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-32781
aliases: []
summary: Envoy is an open source L7 proxy and communication bus designed for large modern service
  oriented architectures. In affected versions after Envoy sends a locally generated response
  it must stop further processing of request or response data. However when local response is
  generated due the internal buffer overflow while request or response is processed by the filter
  chain the operation may not be stopped completely and result in accessing a freed memory block.
  A specifically constructed request delivered by an untrusted downstream or upstream peer in
  the presence of extensions that modify and increase the size of request or response bodies
  resulting in a Denial of Service when using extensions that modify and increase the size of
  request or response bodies, such as decompressor filter. Envoy versions 1.19.1, 1.18.4, 1.17.4,
  1.16.5 contain fixes to address incomplete termination of request processing after locally
  generated response. As a workaround disable Envoy's decompressor, json-transcoder or grpc-web
  extensions or proprietary extensions that modify and increase the size of request or response
  bodies, if feasible.
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32781
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32781
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32781
weaknesses:
  - CWE-416
  - CWE-120
references:
  - url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-5vhv-gp9v-42qv
    reference_type:
    reference_id:
  - url: https://www.envoyproxy.io/docs/envoy/v1.19.0/version_history/version_history
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:1.19.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:1.19.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32781
    reference_type:
    reference_id: CVE-2021-32781
