advisory_id: CVE-2024-8013
datasource_id: nvd_importer_v2/CVE-2024-8013
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-8013
aliases: []
summary: A bug in query analysis of certain complex self-referential $lookup subpipelines may
  result in literal values in expressions for encrypted fields to be sent to the server as plaintext
  instead of ciphertext. Should this occur, no documents would be returned or written. This
  issue affects mongocryptd binary (v5.0 versions prior to 5.0.29, v6.0 versions prior to 6.0.17,
  v7.0 versions prior to 7.0.12 and v7.3 versions prior to 7.3.4) and mongo_crypt_v1.so shared
  libraries (v6.0 versions prior to 6.0.17, v7.0 versions prior to 7.0.12 and v7.3 versions
  prior to 7.3.4) released alongside MongoDB Enterprise Server versions.
impacted_packages: []
severities:
  - score: '2.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-8013
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-8013
weaknesses:
  - CWE-319
references:
  - url: https://jira.mongodb.org/browse/SERVER-96254
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mongodb:mongocryptd:*:*:*:*:*:mongodb:*:*
    reference_type:
    reference_id: cpe:2.3:a:mongodb:mongocryptd:*:*:*:*:*:mongodb:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mongodb:mongo_crypt_v1.so:*:*:*:*:*:mongodb:*:*
    reference_type:
    reference_id: cpe:2.3:a:mongodb:mongo_crypt_v1.so:*:*:*:*:*:mongodb:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-8013
    reference_type:
    reference_id: CVE-2024-8013
