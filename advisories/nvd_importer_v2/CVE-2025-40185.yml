advisory_id: CVE-2025-40185
datasource_id: nvd_importer_v2/CVE-2025-40185
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40185
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ice: ice_adapter: release xa entry on adapter allocation failure

  When ice_adapter_new() fails, the reserved XArray entry created by
  xa_insert() is not released. This causes subsequent insertions at
  the same index to return -EBUSY, potentially leading to
  NULL pointer dereferences.

  Reorder the operations as suggested by Przemek Kitszel:
  1. Check if adapter already exists (xa_load)
  2. Reserve the XArray slot (xa_reserve)
  3. Allocate the adapter (ice_adapter_new)
  4. Store the adapter (xa_store)
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2db687f3469dbc5c59bc53d55acafd75d530b497
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/794abb265de3e792167fe3ea0440c064c722bb84
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b9269de9815fc34d93dab90bd5169bacbe78e70
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40185
    reference_type:
    reference_id: CVE-2025-40185
