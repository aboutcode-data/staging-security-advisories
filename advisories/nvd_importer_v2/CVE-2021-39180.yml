advisory_id: CVE-2021-39180
datasource_id: nvd_importer_v2/CVE-2021-39180
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-39180
aliases: []
summary: OpenOLAT is a web-based learning management system (LMS). A path traversal vulnerability
  exists in versions prior to 15.3.18, 15.5.3, and 16.0.0. Using a specially prepared ZIP file,
  it is possible to overwrite any file that is writable by the application server user (e.g.
  the tomcat user). Depending on the configuration this can be limited to files of the OpenOlat
  user data directory, however, if not properly set up, the attack could also be used to overwrite
  application server config files, java code or even operating system files. The attack could
  be used to corrupt or modify any OpenOlat file such as course structures, config files or
  temporary test data. Those attack would require in-depth knowledge of the installation and
  thus more theoretical. If the app server configuration allows the execution of jsp files and
  the path to the context is known, it is also possible to execute java code. If the app server
  runs with the same user that is used to deploy the OpenOlat code or has write permissions
  on the OpenOlat code files and the path to the context is know, code injection is possible.
  The attack requires an OpenOlat user account to upload a ZIP file and trigger the unzip method.
  It can not be exploited by unregistered users. The problem is fixed in versions 15.3.18, 15.5.3
  and 16.0.0. There are no known workarounds aside from upgrading.
impacted_packages: []
severities:
  - score: '9.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39180
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39180
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39180
weaknesses:
  - CWE-22
references:
  - url: https://github.com/OpenOLAT/OpenOLAT/commit/2cf73c972e23ccd69cc1e103e43c2c8253571d3e
    reference_type:
    reference_id:
  - url: https://github.com/OpenOLAT/OpenOLAT/commit/5668a41ab3f1753102a89757be013487544279d5
    reference_type:
    reference_id:
  - url: https://github.com/OpenOLAT/OpenOLAT/commit/699490be8e931af0ef1f135c55384db1f4232637
    reference_type:
    reference_id:
  - url: https://github.com/OpenOLAT/OpenOLAT/security/advisories/GHSA-x95v-2pgj-9x8j
    reference_type:
    reference_id:
  - url: https://jira.openolat.org/browse/OO-5549
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:frentix:openolat:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:frentix:openolat:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39180
    reference_type:
    reference_id: CVE-2021-39180
