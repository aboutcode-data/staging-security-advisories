advisory_id: CVE-2022-21731
datasource_id: nvd_importer_v2/CVE-2022-21731
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-21731
aliases: []
summary: Tensorflow is an Open Source Machine Learning Framework. The implementation of shape
  inference for `ConcatV2` can be used to trigger a denial of service attack via a segfault
  caused by a type confusion. The `axis` argument is translated into `concat_dim` in the `ConcatShapeHelper`
  helper function. Then, a value for `min_rank` is computed based on `concat_dim`. This is then
  used to validate that the `values` tensor has at least the required rank. However, `WithRankAtLeast`
  receives the lower bound as a 64-bits value and then compares it against the maximum 32-bits
  integer value that could be represented. Due to the fact that `min_rank` is a 32-bits value
  and the value of `axis`, the `rank` argument is a negative value, so the error check is bypassed.
  The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow
  2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported
  range.
impacted_packages: []
severities:
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21731
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21731
weaknesses:
  - CWE-843
references:
  - url: https://github.com/tensorflow/tensorflow/blob/5100e359aef5c8021f2e71c7b986420b85ce7b3d/tensorflow/core/framework/common_shape_fns.cc#L1961-L2059
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/blob/5100e359aef5c8021f2e71c7b986420b85ce7b3d/tensorflow/core/framework/shape_inference.cc#L345-L358
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/08d7b00c0a5a20926363849f611729f53f3ec022
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-m4hf-j54p-p353
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.7.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.7.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21731
    reference_type:
    reference_id: CVE-2022-21731
