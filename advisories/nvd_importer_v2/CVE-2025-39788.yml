advisory_id: CVE-2025-39788
datasource_id: nvd_importer_v2/CVE-2025-39788
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39788
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: ufs: exynos: Fix programming of HCI_UTRL_NEXUS_TYPE

  On Google gs101, the number of UTP transfer request slots (nutrs) is 32,
  and in this case the driver ends up programming the UTRL_NEXUS_TYPE
  incorrectly as 0.

  This is because the left hand side of the shift is 1, which is of type
  int, i.e. 31 bits wide. Shifting by more than that width results in
  undefined behaviour.

  Fix this by switching to the BIT() macro, which applies correct type
  casting as required. This ensures the correct value is written to
  UTRL_NEXUS_TYPE (0xffffffff on gs101), and it also fixes a UBSAN shift
  warning:

      UBSAN: shift-out-of-bounds in drivers/ufs/host/ufs-exynos.c:1113:21
      shift exponent 32 is too large for 32-bit type 'int'

  For consistency, apply the same change to the nutmrs / UTMRL_NEXUS_TYPE
  write.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39788
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/01510a9e8222f11cce064410f3c2fcf0756c0a08
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/01aad16c2257ab8ff33b152b972c9f2e1af47912
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/098b2c8ee208c77126839047b9e6e1925bb35baa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5b9f1ef293428ea9c0871d96fcec2a87c4445832
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6d53b2a134da77eb7fe65c5c7c7a3c193539a78a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c1f025da8f370a015e412b55cbcc583f91de8316
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dc8fb963742f1a38d284946638f9358bdaa0ddee
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39788
    reference_type:
    reference_id: CVE-2025-39788
