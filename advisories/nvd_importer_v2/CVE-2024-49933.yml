advisory_id: CVE-2024-49933
datasource_id: nvd_importer_v2/CVE-2024-49933
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-49933
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  blk_iocost: fix more out of bound shifts

  Recently running UBSAN caught few out of bound shifts in the
  ioc_forgive_debts() function:

  UBSAN: shift-out-of-bounds in block/blk-iocost.c:2142:38
  shift exponent 80 is too large for 64-bit type 'u64' (aka 'unsigned long
  long')
  ...
  UBSAN: shift-out-of-bounds in block/blk-iocost.c:2144:30
  shift exponent 80 is too large for 64-bit type 'u64' (aka 'unsigned long
  long')
  ...
  Call Trace:
  <IRQ>
  dump_stack_lvl+0xca/0x130
  __ubsan_handle_shift_out_of_bounds+0x22c/0x280
  ? __lock_acquire+0x6441/0x7c10
  ioc_timer_fn+0x6cec/0x7750
  ? blk_iocost_init+0x720/0x720
  ? call_timer_fn+0x5d/0x470
  call_timer_fn+0xfa/0x470
  ? blk_iocost_init+0x720/0x720
  __run_timer_base+0x519/0x700
  ...

  Actual impact of this issue was not identified but I propose to fix the
  undefined behaviour.
  The proposed fix to prevent those out of bound shifts consist of
  precalculating exponent before using it the shift operations by taking
  min value from the actual exponent and maximum possible number of bits.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49933
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1ab2cfe19700fb3dde4c7dfec392acff34db3120
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1b120f151871eb47ce9f283c007af3f8ae1d990e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1f61d509257d6a05763d05bf37943b35306522b1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/364022095bdd4108efdaaa68576afa4712a5d085
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/59121bb38fdc01434ea3fe361ee02b59f036227f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9bce8005ec0dcb23a58300e8522fe4a31da606fa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f4ef9bef023d5c543cb0f3194ecacfd47ef590ec
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49933
    reference_type:
    reference_id: CVE-2024-49933
