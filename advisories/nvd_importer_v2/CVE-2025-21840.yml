advisory_id: CVE-2025-21840
datasource_id: nvd_importer_v2/CVE-2025-21840
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21840
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  thermal/netlink: Prevent userspace segmentation fault by adjusting UAPI header

  The intel-lpmd tool [1], which uses the THERMAL_GENL_ATTR_CPU_CAPABILITY
  attribute to receive HFI events from kernel space, encounters a
  segmentation fault after commit 1773572863c4 ("thermal: netlink: Add the
  commands and the events for the thresholds").

  The issue arises because the THERMAL_GENL_ATTR_CPU_CAPABILITY raw value
  was changed while intel_lpmd still uses the old value.

  Although intel_lpmd can be updated to check the THERMAL_GENL_VERSION and
  use the appropriate THERMAL_GENL_ATTR_CPU_CAPABILITY value, the commit
  itself is questionable.

  The commit introduced a new element in the middle of enum thermal_genl_attr,
  which affects many existing attributes and introduces potential risks
  and unnecessary maintenance burdens for userspace thermal netlink event
  users.

  Solve the issue by moving the newly introduced
  THERMAL_GENL_ATTR_TZ_PREV_TEMP attribute to the end of the
  enum thermal_genl_attr. This ensures that all existing thermal generic
  netlink attributes remain unaffected.

  [ rjw: Subject edits ]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21840
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3a4ca365c51729143a2cab693cd40fe0bb585ef0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c195b9c6ab9c383d7aa3f4a65879b3ca90cb378b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21840
    reference_type:
    reference_id: CVE-2025-21840
