advisory_id: CVE-2024-26995
datasource_id: nvd_importer_v2/CVE-2024-26995
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26995
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: typec: tcpm: Correct the PDO counting in pd_set

  Off-by-one errors happen because nr_snk_pdo and nr_src_pdo are
  incorrectly added one. The index of the loop is equal to the number of
  PDOs to be updated when leaving the loop and it doesn't need to be added
  one.

  When doing the power negotiation, TCPM relies on the "nr_snk_pdo" as
  the size of the local sink PDO array to match the Source capabilities
  of the partner port. If the off-by-one overflow occurs, a wrong RDO
  might be sent and unexpected power transfer might happen such as over
  voltage or over current (than expected).

  "nr_src_pdo" is used to set the Rp level when the port is in Source
  role. It is also the array size of the local Source capabilities when
  filling up the buffer which will be sent as the Source PDOs (such as
  in Power Negotiation). If the off-by-one overflow occurs, a wrong Rp
  level might be set and wrong Source PDOs will be sent to the partner
  port. This could potentially cause over current or port resets.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26995
weaknesses:
  - CWE-193
references:
  - url: https://git.kernel.org/stable/c/c4128304c2169b4664ed6fb6200f228cead2ab70
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f3da3192cdd3fefe213390e976eec424a8e270b5
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4EZ6PJW7VOZ224TD7N4JZNU6KV32ZJ53/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DAMSOZXJEPUOXW33WZYWCVAY7Z5S7OOY/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GCBZZEC7L7KTWWAS2NLJK6SO3IZIL4WW/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26995
    reference_type:
    reference_id: CVE-2024-26995
