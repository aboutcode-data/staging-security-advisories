advisory_id: CVE-2024-26866
datasource_id: nvd_importer_v2/CVE-2024-26866
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26866
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  spi: lpspi: Avoid potential use-after-free in probe()

  fsl_lpspi_probe() is allocating/disposing memory manually with
  spi_alloc_host()/spi_alloc_target(), but uses
  devm_spi_register_controller(). In case of error after the latter call the
  memory will be explicitly freed in the probe function by
  spi_controller_put() call, but used afterwards by "devm" management outside
  probe() (spi_unregister_controller() <- devm_spi_unregister() below).

  Unable to handle kernel NULL pointer dereference at virtual address 0000000000000070
  ...
  Call trace:
   kernfs_find_ns
   kernfs_find_and_get_ns
   sysfs_remove_group
   sysfs_remove_groups
   device_remove_attrs
   device_del
   spi_unregister_controller
   devm_spi_unregister
   release_nodes
   devres_release_all
   really_probe
   driver_probe_device
   __device_attach_driver
   bus_for_each_drv
   __device_attach
   device_initial_probe
   bus_probe_device
   deferred_probe_work_func
   process_one_work
   worker_thread
   kthread
   ret_from_fork
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26866
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/1543418e82789cc383cd36d41469983c64e3fc7f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2ae0ab0143fcc06190713ed81a6486ed0ad3c861
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/996ce839606afd0fef91355627868022aa73eb68
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/da83ed350e4604b976e94239b08d8e2e7eaee7ea
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26866
    reference_type:
    reference_id: CVE-2024-26866
