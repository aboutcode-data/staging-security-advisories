advisory_id: CVE-2025-38616
datasource_id: nvd_importer_v2/CVE-2025-38616
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38616
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tls: handle data disappearing from under the TLS ULP

  TLS expects that it owns the receive queue of the TCP socket.
  This cannot be guaranteed in case the reader of the TCP socket
  entered before the TLS ULP was installed, or uses some non-standard
  read API (eg. zerocopy ones). Replace the WARN_ON() and a buggy
  early exit (which leaves anchor pointing to a freed skb) with real
  error handling. Wipe the parsing state and tell the reader to retry.

  We already reload the anchor every time we (re)acquire the socket lock,
  so the only condition we need to avoid is an out of bounds read
  (not having enough bytes in the socket for previously parsed record len).

  If some data was read from under TLS but there's enough in the queue
  we'll reload and decrypt what is most likely not a valid TLS record.
  Leading to some undefined behavior from TLS perspective (corrupting
  a stream? missing an alert? missing an attack?) but no kernel crash
  should take place.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38616
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/2fb97ed9e2672b4f6e24ce206ac1a875ce4bcb38
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6db015fc4b5d5f63a64a193f65d98da3a7fc811d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db3658a12d5ec4db7185ae7476151a50521b7207
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eb0336f213fe88bbdb7d2b19c9c9ec19245a3155
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f1fe99919f629f980d0b8a7ff16950bffe06a859
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38616
    reference_type:
    reference_id: CVE-2025-38616
