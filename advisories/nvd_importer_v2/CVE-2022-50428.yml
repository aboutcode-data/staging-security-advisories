advisory_id: CVE-2022-50428
datasource_id: nvd_importer_v2/CVE-2022-50428
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50428
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: fix off-by-one errors in fast-commit block filling

  Due to several different off-by-one errors, or perhaps due to a late
  change in design that wasn't fully reflected in the code that was
  actually merged, there are several very strange constraints on how
  fast-commit blocks are filled with tlv entries:

  - tlvs must start at least 10 bytes before the end of the block, even
    though the minimum tlv length is 8.  Otherwise, the replay code will
    ignore them.  (BUG: ext4_fc_reserve_space() could violate this
    requirement if called with a len of blocksize - 9 or blocksize - 8.
    Fortunately, this doesn't seem to happen currently.)

  - tlvs must end at least 1 byte before the end of the block.  Otherwise
    the replay code will consider them to be invalid.  This quirk
    contributed to a bug (fixed by an earlier commit) where uninitialized
    memory was being leaked to disk in the last byte of blocks.

  Also, strangely these constraints don't apply to the replay code in
  e2fsprogs, which will accept any tlvs in the blocks (with no bounds
  checks at all, but that is a separate issue...).

  Given that this all seems to be a bug, let's fix it by just filling
  blocks with tlv entries in the natural way.

  Note that old kernels will be unable to replay fast-commit journals
  created by kernels that have this commit.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50428
weaknesses:
  - CWE-193
references:
  - url: https://git.kernel.org/stable/c/18f28f13301d1afb8cea9c4ddcecdbff14488ec6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/48a6a66db82b8043d298a630f22c62d43550cae5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5439ad45c0d0c8db41eb6f4dce6f778f15a5ee16
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5ca65dffdead16572ca046c43fb576b227f7f635
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50428
    reference_type:
    reference_id: CVE-2022-50428
