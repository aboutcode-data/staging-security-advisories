advisory_id: CVE-2025-39748
datasource_id: nvd_importer_v2/CVE-2025-39748
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39748
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Forget ranges when refining tnum after JSET

  Syzbot reported a kernel warning due to a range invariant violation on
  the following BPF program.

    0: call bpf_get_netns_cookie
    1: if r0 == 0 goto <exit>
    2: if r0 & Oxffffffff goto <exit>

  The issue is on the path where we fall through both jumps.

  That path is unreachable at runtime: after insn 1, we know r0 != 0, but
  with the sign extension on the jset, we would only fallthrough insn 2
  if r0 == 0. Unfortunately, is_branch_taken() isn't currently able to
  figure this out, so the verifier walks all branches. The verifier then
  refines the register bounds using the second condition and we end
  up with inconsistent bounds on this unreachable path:

    1: if r0 == 0 goto <exit>
      r0: u64=[0x1, 0xffffffffffffffff] var_off=(0, 0xffffffffffffffff)
    2: if r0 & 0xffffffff goto <exit>
      r0 before reg_bounds_sync: u64=[0x1, 0xffffffffffffffff] var_off=(0, 0)
      r0 after reg_bounds_sync:  u64=[0x1, 0] var_off=(0, 0)

  Improving the range refinement for JSET to cover all cases is tricky. We
  also don't expect many users to rely on JSET given LLVM doesn't generate
  those instructions. So instead of improving the range refinement for
  JSETs, Eduard suggested we forget the ranges whenever we're narrowing
  tnums after a JSET. This patch implements that approach.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39748
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2fd0c26bacd90ef26522bd3169000a4715bf151f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6279846b9b2532e1b04559ef8bd0dec049f29383
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/80a6b11862a7cfdf691e8f9faee89cfea219f098
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f01e06930444cab289a8783017af9b64255bd103
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39748
    reference_type:
    reference_id: CVE-2025-39748
