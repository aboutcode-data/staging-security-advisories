advisory_id: CVE-2022-1642
datasource_id: nvd_importer_v2/CVE-2022-1642
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-1642
aliases: []
summary: 'A program using swift-corelibs-foundation is vulnerable to a denial of service attack
  caused by a potentially malicious source producing a JSON document containing a type mismatch.
  This vulnerability is caused by the interaction between a deserialization mechanism offered
  by the Swift standard library, the Codable protocol; and the JSONDecoder class offered by
  swift-corelibs-foundation, which can deserialize types that adopt the Codable protocol based
  on the content of a provided JSON document. When a type that adopts Codable requests the initialization
  of a field with an integer value, the JSONDecoder class uses a type-erased container with
  different accessor methods to attempt and coerce a corresponding JSON value and produce an
  integer. In the case the JSON value was a numeric literal with a floating-point portion, JSONDecoder
  used different type-eraser methods during validation than it did during the final casting
  of the value. The checked casting produces a deterministic crash due to this mismatch. The
  JSONDecoder class is often wrapped by popular Swift-based web frameworks to parse the body
  of HTTP requests and perform basic type validation. This makes the attack low-effort: sending
  a specifically crafted JSON document during a request to these endpoints will cause them to
  crash. The attack does not have any confidentiality or integrity risks in and of itself; the
  crash is produced deterministically by an abort function that ensures that execution does
  not continue in the face of this violation of assumptions. However, unexpected crashes can
  lead to violations of invariants in services, so it''s possible that this attack can be used
  to trigger error conditions that escalate the risk. Producing a denial of service may also
  be the goal of an attacker in itself. This issue is solved in Swift 5.6.2 for Linux and Windows.
  This issue was solved by ensuring that the same methods are invoked both when validating and
  during casting, so that no type mismatch occurs. Swift for Linux and Windows versions are
  not ABI-interchangeable. To upgrade a service, its owner must update to this version of the
  Swift toolchain, then recompile and redeploy their software. The new version of Swift includes
  an updated swift-corelibs-foundation package. Versions of Swift running on Darwin-based operating
  systems are not affected.'
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-1642
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-1642
weaknesses:
  - CWE-704
  - CWE-241
  - CWE-351
references:
  - url: https://github.com/apple/swift-corelibs-foundation/security/advisories/GHSA-239c-6cv2-wwx8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apple:swift:*:*:*:*:*:linux:*:*
    reference_type:
    reference_id: cpe:2.3:a:apple:swift:*:*:*:*:*:linux:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apple:swift:*:*:*:*:*:windows:*:*
    reference_type:
    reference_id: cpe:2.3:a:apple:swift:*:*:*:*:*:windows:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-1642
    reference_type:
    reference_id: CVE-2022-1642
