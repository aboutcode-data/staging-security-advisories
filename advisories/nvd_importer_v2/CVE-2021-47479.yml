advisory_id: CVE-2021-47479
datasource_id: nvd_importer_v2/CVE-2021-47479
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47479
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  staging: rtl8712: fix use-after-free in rtl8712_dl_fw

  Syzbot reported use-after-free in rtl8712_dl_fw(). The problem was in
  race condition between r871xu_dev_remove() ->ndo_open() callback.

  It's easy to see from crash log, that driver accesses released firmware
  in ->ndo_open() callback. It may happen, since driver was releasing
  firmware _before_ unregistering netdev. Fix it by moving
  unregister_netdev() before cleaning up resources.

  Call Trace:
  ...
   rtl871x_open_fw drivers/staging/rtl8712/hal_init.c:83 [inline]
   rtl8712_dl_fw+0xd95/0xe10 drivers/staging/rtl8712/hal_init.c:170
   rtl8712_hal_init drivers/staging/rtl8712/hal_init.c:330 [inline]
   rtl871x_hal_init+0xae/0x180 drivers/staging/rtl8712/hal_init.c:394
   netdev_open+0xe6/0x6c0 drivers/staging/rtl8712/os_intfs.c:380
   __dev_open+0x2bc/0x4d0 net/core/dev.c:1484

  Freed by task 1306:
  ...
   release_firmware+0x1b/0x30 drivers/base/firmware_loader/main.c:1053
   r871xu_dev_remove+0xcc/0x2c0 drivers/staging/rtl8712/usb_intf.c:599
   usb_unbind_interface+0x1d8/0x8d0 drivers/usb/core/driver.c:458
impacted_packages: []
severities:
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47479
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/a65c9afe9f2f55b7a7fb4a25ab654cd4139683a4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/befd23bd3b17f1a3f9c943a8580b47444c7c63ed
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c052cc1a069c3e575619cf64ec427eb41176ca70
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c430094541a80575259a94ff879063ef01473506
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.3:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.3:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.3:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.3:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.3:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.3:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.3:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.3:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:3.3:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:3.3:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47479
    reference_type:
    reference_id: CVE-2021-47479
