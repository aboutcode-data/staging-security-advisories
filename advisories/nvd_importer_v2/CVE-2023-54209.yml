advisory_id: CVE-2023-54209
datasource_id: nvd_importer_v2/CVE-2023-54209
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54209
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  block: fix blktrace debugfs entries leakage

  Commit 99d055b4fd4b ("block: remove per-disk debugfs files in
  blk_unregister_queue") moves blk_trace_shutdown() from
  blk_release_queue() to blk_unregister_queue(), this is safe if blktrace
  is created through sysfs, however, there is a regression in corner
  case.

  blktrace can still be enabled after del_gendisk() through ioctl if
  the disk is opened before del_gendisk(), and if blktrace is not shutdown
  through ioctl before closing the disk, debugfs entries will be leaked.

  Fix this problem by shutdown blktrace in disk_release(), this is safe
  because blk_trace_remove() is reentrant.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/7149e57cf01184fba175589f8fbe9fbf33be02e1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/942e81650b81b4ca62f1d8c61de455c9e7c7e6ca
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aa07e56c6a9c7558165690d14eed4fe8babf34fb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd7de3704af9989b780693d51eaea49a665bd9c2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54209
    reference_type:
    reference_id: CVE-2023-54209
