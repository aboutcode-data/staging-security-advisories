advisory_id: CVE-2021-36371
datasource_id: nvd_importer_v2/CVE-2021-36371
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-36371
aliases: []
summary: Emissary-Ingress (formerly Ambassador API Gateway) through 1.13.9 allows attackers
  to bypass client certificate requirements (i.e., mTLS cert_required) on backend upstreams
  when more than one TLSContext is defined and at least one configuration exists that does not
  require client certificate authentication. The attacker must send an SNI specifying an unprotected
  backend and an HTTP Host header specifying a protected backend. (2.x versions are unaffected.
  1.x versions are unaffected with certain configuration settings involving prune_unreachable_routes
  and a wildcard Host resource.)
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-36371
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-36371
weaknesses:
  - CWE-295
references:
  - url: https://github.com/emissary-ingress/emissary/issues/3340
    reference_type:
    reference_id:
  - url: https://github.com/emissary-ingress/emissary/releases/tag/v2.0.0-ea
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:getambassador:emissary-ingress:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:getambassador:emissary-ingress:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-36371
    reference_type:
    reference_id: CVE-2021-36371
