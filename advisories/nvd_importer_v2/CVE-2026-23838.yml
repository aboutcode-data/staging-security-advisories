advisory_id: CVE-2026-23838
datasource_id: nvd_importer_v2/CVE-2026-23838
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23838
aliases: []
summary: Tandoor Recipes is a recipe manager than can be installed with the Nix package manager.
  Starting in version 23.05 and prior to version 26.05, when using the default configuration
  of Tandoor Recipes, specifically using SQLite and default `MEDIA_ROOT`, the full database
  file may be externally accessible, potentially on the Internet. The root cause is that the
  NixOS module configures the working directory of Tandoor Recipes, as well as the value of
  `MEDIA_ROOT`, to be `/var/lib/tandoor-recipes`. This causes Tandoor Recipes to create its
  `db.sqlite3` database file in the same directory as `MEDIA_ROOT` causing it to be accessible
  without authentication through HTTP like any other media file. This is the case when using
  `GUNICORN_MEDIA=1` or when using a web server like nginx to serve media files. NixOS 26.05
  changes the default value of `MEDIA_ROOT` to a sub folder of the data directory. This only
  applies to configurations with `system.stateVersion` >= 26.05. For older configurations, one
  of the workarounds should be applied instead. NixOS 25.11 has received a backport of this
  patch, though it doesn't fix this vulnerability without user intervention. A recommended workaround
  is to move `MEDIA_ROOT` into a subdirectory. Non-recommended workarounds include switching
  to PostgreSQL or disallowing access to `db.sqlite3`.
impacted_packages: []
severities:
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-23838
weaknesses:
  - CWE-538
references:
  - url: https://github.com/NixOS/nixpkgs/issues/338339
    reference_type:
    reference_id:
  - url: https://github.com/NixOS/nixpkgs/pull/427845
    reference_type:
    reference_id:
  - url: https://github.com/NixOS/nixpkgs/pull/481140
    reference_type:
    reference_id:
  - url: https://github.com/NixOS/nixpkgs/security/advisories/GHSA-g8w3-p77x-mmxh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23838
    reference_type:
    reference_id: CVE-2026-23838
