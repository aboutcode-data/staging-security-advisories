advisory_id: CVE-2025-40300
datasource_id: nvd_importer_v2/CVE-2025-40300
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40300
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/vmscape: Add conditional IBPB mitigation

  VMSCAPE is a vulnerability that exploits insufficient branch predictor
  isolation between a guest and a userspace hypervisor (like QEMU). Existing
  mitigations already protect kernel/KVM from a malicious guest. Userspace
  can additionally be protected by flushing the branch predictors after a
  VMexit.

  Since it is the userspace that consumes the poisoned branch predictors,
  conditionally issue an IBPB after a VMexit and before returning to
  userspace. Workloads that frequently switch between hypervisor and
  userspace will incur the most overhead from the new IBPB.

  This new IBPB is not integrated with the existing IBPB sites. For
  instance, a task can use the existing speculation control prctl() to
  get an IBPB at context switch time. With this implementation, the
  IBPB is doubled up: one at context switch and another before running
  userspace.

  The intent is to integrate and optimize these cases post-embargo.

  [ dhansen: elaborate on suboptimal IBPB solution ]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-40300
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/15006289e5c38b2a830e1fba221977a27598176c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2f4f2f8f860cb4c3336a7435ebe8dcfded0c9c6e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2f8f173413f1cbf52660d04df92d0069c4306d25
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/34e5667041050711a947e260fc9ebebe08bddee5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/459274c77b37ac63b78c928b4b4e748d1f9d05c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/510603f504796c3535f67f55fb0b124a303b44c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/893387c18612bb452336a5881da0d015a7e8f4a2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9c23a90648e831d611152ac08dbcd1283d405e7f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac60717f9a8d21c58617d0b34274babf24135835
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c08192b5d6730a914dee6175bc71092ee6a65f14
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d5490dfa35427a2967e00a4c7a1b95fdbc8ede34
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d7ddc93392e4a7ffcccc86edf6ef3e64c778db52
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f866eef8d1c65504d30923c3f14082ad294d0e6d
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2025/11/14/3
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2025/11/14/4
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2025/11/14/6
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2025/11/17/2
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2025/11/17/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40300
    reference_type:
    reference_id: CVE-2025-40300
