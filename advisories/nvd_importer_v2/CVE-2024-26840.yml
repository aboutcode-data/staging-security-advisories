advisory_id: CVE-2024-26840
datasource_id: nvd_importer_v2/CVE-2024-26840
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26840
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  cachefiles: fix memory leak in cachefiles_add_cache()

  The following memory leak was reported after unbinding /dev/cachefiles:

  ==================================================================
  unreferenced object 0xffff9b674176e3c0 (size 192):
    comm "cachefilesd2", pid 680, jiffies 4294881224
    hex dump (first 32 bytes):
      01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
      00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
    backtrace (crc ea38a44b):
      [<ffffffff8eb8a1a5>] kmem_cache_alloc+0x2d5/0x370
      [<ffffffff8e917f86>] prepare_creds+0x26/0x2e0
      [<ffffffffc002eeef>] cachefiles_determine_cache_security+0x1f/0x120
      [<ffffffffc00243ec>] cachefiles_add_cache+0x13c/0x3a0
      [<ffffffffc0025216>] cachefiles_daemon_write+0x146/0x1c0
      [<ffffffff8ebc4a3b>] vfs_write+0xcb/0x520
      [<ffffffff8ebc5069>] ksys_write+0x69/0xf0
      [<ffffffff8f6d4662>] do_syscall_64+0x72/0x140
      [<ffffffff8f8000aa>] entry_SYSCALL_64_after_hwframe+0x6e/0x76
  ==================================================================

  Put the reference count of cache_cred in cachefiles_daemon_unbind() to
  fix the problem. And also put cache_cred in cachefiles_add_cache() error
  branch to avoid memory leaks.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26840
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/037d5a949b0455540ef9aab34c10ddf54b65d285
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/38e921616320d159336b0ffadb09e9fb4945c7c3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/43eccc5823732ba6daab2511ed32dfc545a666d8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8b218e2f0a27a9f09428b1847b4580640b9d1e58
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/94965be37add0983672e48ecb33cdbda92b62579
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9cac69912052a4def571fedf1cb9bb4ec590e25a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cb5466783793e66272624cf71925ae1d1ba32083
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e21a2f17566cbd64926fb8f16323972f7a064444
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26840
    reference_type:
    reference_id: CVE-2024-26840
