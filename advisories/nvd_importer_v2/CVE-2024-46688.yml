advisory_id: CVE-2024-46688
datasource_id: nvd_importer_v2/CVE-2024-46688
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-46688
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  erofs: fix out-of-bound access when z_erofs_gbuf_growsize() partially fails

  If z_erofs_gbuf_growsize() partially fails on a global buffer due to
  memory allocation failure or fault injection (as reported by syzbot [1]),
  new pages need to be freed by comparing to the existing pages to avoid
  memory leaks.

  However, the old gbuf->pages[] array may not be large enough, which can
  lead to null-ptr-deref or out-of-bound access.

  Fix this by checking against gbuf->nrpages in advance.

  [1] https://lore.kernel.org/r/000000000000f7b96e062018c6e3@google.com
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-46688
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/0005e01e1e875c5e27130c5e2ed0189749d1e08a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/49c0e081998008cde0c872c0ff9affa1ece4b878
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-46688
    reference_type:
    reference_id: CVE-2024-46688
