advisory_id: CVE-2025-21846
datasource_id: nvd_importer_v2/CVE-2025-21846
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21846
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  acct: perform last write from workqueue

  In [1] it was reported that the acct(2) system call can be used to
  trigger NULL deref in cases where it is set to write to a file that
  triggers an internal lookup. This can e.g., happen when pointing acc(2)
  to /sys/power/resume. At the point the where the write to this file
  happens the calling task has already exited and called exit_fs(). A
  lookup will thus trigger a NULL-deref when accessing current->fs.

  Reorganize the code so that the the final write happens from the
  workqueue but with the caller's credentials. This preserves the
  (strange) permission model and has almost no regression risk.

  This api should stop to exist though.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21846
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/56d5f3eba3f5de0efdd556de4ef381e109b973a9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5a59ced8ffc71973d42c82484a719c8f6ac8f7f7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5c928e14a2ccd99462f2351ead627b58075bb736
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5d5b936cfa4b0d5670ca7420ef165a074bc008eb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5ee8da9bea70dda492d61f075658939af33d8410
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8acbf4a88c6a98c8ed00afd1a7d1abcca9b4735e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a8136afca090412a36429cb6c2543c714d9c0f84
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b03782ae707cc45e65242c7cddd8e28f1c22cde5
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21846
    reference_type:
    reference_id: CVE-2025-21846
