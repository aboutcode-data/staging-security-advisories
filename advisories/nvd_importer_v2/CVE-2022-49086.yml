advisory_id: CVE-2022-49086
datasource_id: nvd_importer_v2/CVE-2022-49086
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49086
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: openvswitch: fix leak of nested actions

  While parsing user-provided actions, openvswitch module may dynamically
  allocate memory and store pointers in the internal copy of the actions.
  So this memory has to be freed while destroying the actions.

  Currently there are only two such actions: ct() and set().  However,
  there are many actions that can hold nested lists of actions and
  ovs_nla_free_flow_actions() just jumps over them leaking the memory.

  For example, removal of the flow with the following actions will lead
  to a leak of the memory allocated by nf_ct_tmpl_alloc():

    actions:clone(ct(commit),0)

  Non-freed set() action may also leak the 'dst' structure for the
  tunnel info including device references.

  Under certain conditions with a high rate of flow rotation that may
  cause significant memory leak problem (2MB per second in reporter's
  case).  The problem is also hard to mitigate, because the user doesn't
  have direct control over the datapath flows generated by OVS.

  Fix that by iterating over all the nested actions and freeing
  everything that needs to be freed recursively.

  New build time assertion should protect us from this problem if new
  actions will be added in the future.

  Unfortunately, openvswitch module doesn't use NLA_F_NESTED, so all
  attributes has to be explicitly checked.  sample() and clone() actions
  are mixing extra attributes into the user-provided action list.  That
  prevents some code generalization too.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49086
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/1f30fb9166d4f15a1aa19449b9da871fe0ed4796
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3554c214b83ec9a839ed574263a34218f372990c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/53bce9d19b0a9d245b25cd050b81652ed974a509
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5ae05b5eb58773cfec307ff88aff4cfd843c4cff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7438dc55c0709819b813f4778aec2c48b782990b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/837b96d8103938e35e7d92cd9db96af914ca4fff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ef6f9ce0a79aa23b10fc5f3b3cab3814a25aac40
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49086
    reference_type:
    reference_id: CVE-2022-49086
