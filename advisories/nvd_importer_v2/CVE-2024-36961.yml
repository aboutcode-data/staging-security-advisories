advisory_id: CVE-2024-36961
datasource_id: nvd_importer_v2/CVE-2024-36961
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-36961
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  thermal/debugfs: Fix two locking issues with thermal zone debug

  With the current thermal zone locking arrangement in the debugfs code,
  user space can open the "mitigations" file for a thermal zone before
  the zone's debugfs pointer is set which will result in a NULL pointer
  dereference in tze_seq_start().

  Moreover, thermal_debug_tz_remove() is not called under the thermal
  zone lock, so it can run in parallel with the other functions accessing
  the thermal zone's struct thermal_debugfs object.  Then, it may clear
  tz->debugfs after one of those functions has checked it and the
  struct thermal_debugfs object may be freed prematurely.

  To address the first problem, pass a pointer to the thermal zone's
  struct thermal_debugfs object to debugfs_create_file() in
  thermal_debug_tz_add() and make tze_seq_start(), tze_seq_next(),
  tze_seq_stop(), and tze_seq_show() retrieve it from s->private
  instead of a pointer to the thermal zone object.  This will ensure
  that tz_debugfs will be valid across the "mitigations" file accesses
  until thermal_debugfs_remove_id() called by thermal_debug_tz_remove()
  removes that file.

  To address the second problem, use tz->lock in thermal_debug_tz_remove()
  around the tz->debugfs value check (in case the same thermal zone is
  removed at the same time in two different threads) and its reset to NULL.

  Cc :6.8+ <stable@vger.kernel.org> # 6.8+
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-36961
weaknesses:
  - CWE-667
references:
  - url: https://git.kernel.org/stable/c/6c57bdd0505422d5ccd2df541d993aec978c842e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c7f7c37271787a7f77d7eedc132b0b419a76b4c8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-36961
    reference_type:
    reference_id: CVE-2024-36961
