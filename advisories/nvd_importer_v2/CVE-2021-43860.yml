advisory_id: CVE-2021-43860
datasource_id: nvd_importer_v2/CVE-2021-43860
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-43860
aliases: []
summary: Flatpak is a Linux application sandboxing and distribution framework. Prior to versions
  1.12.3 and 1.10.6, Flatpak doesn't properly validate that the permissions displayed to the
  user for an app at install time match the actual permissions granted to the app at runtime,
  in the case that there's a null byte in the metadata file of an app. Therefore apps can grant
  themselves permissions without the consent of the user. Flatpak shows permissions to the user
  during install by reading them from the "xa.metadata" key in the commit metadata. This cannot
  contain a null terminator, because it is an untrusted GVariant. Flatpak compares these permissions
  to the *actual* metadata, from the "metadata" file to ensure it wasn't lied to. However, the
  actual metadata contents are loaded in several places where they are read as simple C-style
  strings. That means that, if the metadata file includes a null terminator, only the content
  of the file from *before* the terminator gets compared to xa.metadata. Thus, any permissions
  that appear in the metadata file after a null terminator are applied at runtime but not shown
  to the user. So maliciously crafted apps can give themselves hidden permissions. Users who
  have Flatpaks installed from untrusted sources are at risk in case the Flatpak has a maliciously
  crafted metadata file, either initially or in an update. This issue is patched in versions
  1.12.3 and 1.10.6. As a workaround, users can manually check the permissions of installed
  apps by checking the metadata file or the xa.metadata key on the commit metadata.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43860
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43860
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43860
weaknesses:
  - CWE-276
  - CWE-269
references:
  - url: https://github.com/flatpak/flatpak/commit/54ec1a482dfc668127eaae57f135e6a8e0bc52da
    reference_type:
    reference_id:
  - url: https://github.com/flatpak/flatpak/commit/65cbfac982cb1c83993a9e19aa424daee8e9f042
    reference_type:
    reference_id:
  - url: https://github.com/flatpak/flatpak/commit/93357d357119093804df05acc32ff335839c6451
    reference_type:
    reference_id:
  - url: https://github.com/flatpak/flatpak/commit/ba818f504c926baaf6e362be8159cfacf994310e
    reference_type:
    reference_id:
  - url: https://github.com/flatpak/flatpak/commit/d9a8f9d8ccc0b7c1135d0ecde006a75d25f66aee
    reference_type:
    reference_id:
  - url: https://github.com/flatpak/flatpak/releases/tag/1.10.6
    reference_type:
    reference_id:
  - url: https://github.com/flatpak/flatpak/releases/tag/1.12.3
    reference_type:
    reference_id:
  - url: https://github.com/flatpak/flatpak/security/advisories/GHSA-qpjc-vq3c-572j
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/APFTBYGJJVJPFVHRXUW5PII5XOAFI4KH/
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202312-12
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2022/dsa-5049
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:flatpak:flatpak:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:flatpak:flatpak:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43860
    reference_type:
    reference_id: CVE-2021-43860
