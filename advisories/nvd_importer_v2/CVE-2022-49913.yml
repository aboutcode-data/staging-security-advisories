advisory_id: CVE-2022-49913
datasource_id: nvd_importer_v2/CVE-2022-49913
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49913
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  btrfs: fix inode list leak during backref walking at find_parent_nodes()

  During backref walking, at find_parent_nodes(), if we are dealing with a
  data extent and we get an error while resolving the indirect backrefs, at
  resolve_indirect_refs(), or in the while loop that iterates over the refs
  in the direct refs rbtree, we end up leaking the inode lists attached to
  the direct refs we have in the direct refs rbtree that were not yet added
  to the refs ulist passed as argument to find_parent_nodes(). Since they
  were not yet added to the refs ulist and prelim_release() does not free
  the lists, on error the caller can only free the lists attached to the
  refs that were added to the refs ulist, all the remaining refs get their
  inode lists never freed, therefore leaking their memory.

  Fix this by having prelim_release() always free any attached inode list
  to each ref found in the rbtree, and have find_parent_nodes() set the
  ref's inode list to NULL once it transfers ownership of the inode list
  to a ref added to the refs ulist passed to find_parent_nodes().
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49913
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/222a3d533027b9492d5b7f5ecdc01a90f57bb5a9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/61e06128113711df0534c404fb6bb528eb7d2332
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6a6731a0df8c47ecc703bd7bb73459df767051e0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/83ea8c5b54d452a5769e605e3c5c687e8ca06d89
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/92876eec382a0f19f33d09d2c939e9ca49038ae5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49913
    reference_type:
    reference_id: CVE-2022-49913
