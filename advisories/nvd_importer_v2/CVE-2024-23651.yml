advisory_id: CVE-2024-23651
datasource_id: nvd_importer_v2/CVE-2024-23651
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-23651
aliases: []
summary: BuildKit is a toolkit for converting source code to build artifacts in an efficient,
  expressive and repeatable manner. Two malicious build steps running in parallel sharing the
  same cache mounts with subpaths could cause a race condition that can lead to files from the
  host system being accessible to the build container. The issue has been fixed in v0.12.5.
  Workarounds include, avoiding using BuildKit frontend from an untrusted source or building
  an untrusted Dockerfile containing cache mounts with --mount=type=cache,source=... options.
impacted_packages: []
severities:
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23651
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23651
weaknesses:
  - CWE-362
references:
  - url: https://github.com/moby/buildkit/pull/4604
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/releases/tag/v0.12.5
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/security/advisories/GHSA-m3r6-h7wv-7xxv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mobyproject:buildkit:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:mobyproject:buildkit:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23651
    reference_type:
    reference_id: CVE-2024-23651
