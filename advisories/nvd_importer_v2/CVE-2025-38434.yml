advisory_id: CVE-2025-38434
datasource_id: nvd_importer_v2/CVE-2025-38434
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38434
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  Revert "riscv: Define TASK_SIZE_MAX for __access_ok()"

  This reverts commit ad5643cf2f69 ("riscv: Define TASK_SIZE_MAX for
  __access_ok()").

  This commit changes TASK_SIZE_MAX to be LONG_MAX to optimize access_ok(),
  because the previous TASK_SIZE_MAX (default to TASK_SIZE) requires some
  computation.

  The reasoning was that all user addresses are less than LONG_MAX, and all
  kernel addresses are greater than LONG_MAX. Therefore access_ok() can
  filter kernel addresses.

  Addresses between TASK_SIZE and LONG_MAX are not valid user addresses, but
  access_ok() let them pass. That was thought to be okay, because they are
  not valid addresses at hardware level.

  Unfortunately, one case is missed: get_user_pages_fast() happily accepts
  addresses between TASK_SIZE and LONG_MAX. futex(), for instance, uses
  get_user_pages_fast(). This causes the problem reported by Robert [1].

  Therefore, revert this commit. TASK_SIZE_MAX is changed to the default:
  TASK_SIZE.

  This unfortunately reduces performance, because TASK_SIZE is more expensive
  to compute compared to LONG_MAX. But correctness first, we can think about
  optimization later, if required.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38434
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/890ba5be6335dbbbc99af14ea007befb5f83f174
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f8b1898748dfeb4f9b67b6a6d661f354b9de3523
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fe30c30bf3bb68d4a4d8c7c814769857b5c973e6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38434
    reference_type:
    reference_id: CVE-2025-38434
