advisory_id: CVE-2022-29184
datasource_id: nvd_importer_v2/CVE-2022-29184
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-29184
aliases: []
summary: GoCD is a continuous delivery server. In GoCD versions prior to 22.1.0, it is possible
  for existing authenticated users who have permissions to edit or create pipeline materials
  or pipeline configuration repositories to get remote code execution capability on the GoCD
  server via configuring a malicious branch name which abuses Mercurial hooks/aliases to exploit
  a command injection weakness. An attacker would require access to an account with existing
  GoCD administration permissions to either create/edit (`hg`-based) configuration repositories;
  create/edit pipelines and their (`hg`-based) materials; or, where "pipelines-as-code" configuration
  repositories are used, to commit malicious configuration to such an external repository which
  will be automatically parsed into a pipeline configuration and (`hg`) material definition
  by the GoCD server. This issue is fixed in GoCD 22.1.0. As a workaround, users who do not
  use/rely upon Mercurial materials can uninstall/remove the `hg`/Mercurial binary from the
  underlying GoCD Server operating system or Docker image.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29184
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29184
weaknesses:
  - CWE-77
  - CWE-88
references:
  - url: https://github.com/gocd/gocd/commit/37d35115db2ada2190173f9413cfe1bc6c295ecb
    reference_type:
    reference_id:
  - url: https://github.com/gocd/gocd/releases/tag/22.1.0
    reference_type:
    reference_id:
  - url: https://github.com/gocd/gocd/security/advisories/GHSA-vf5r-r7j2-cf2h
    reference_type:
    reference_id:
  - url: https://www.gocd.org/releases/#22-1-0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:thoughtworks:gocd:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:thoughtworks:gocd:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29184
    reference_type:
    reference_id: CVE-2022-29184
