advisory_id: CVE-2024-26689
datasource_id: nvd_importer_v2/CVE-2024-26689
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26689
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ceph: prevent use-after-free in encode_cap_msg()

  In fs/ceph/caps.c, in encode_cap_msg(), "use after free" error was
  caught by KASAN at this line - 'ceph_buffer_get(arg->xattr_buf);'. This
  implies before the refcount could be increment here, it was freed.

  In same file, in "handle_cap_grant()" refcount is decremented by this
  line - 'ceph_buffer_put(ci->i_xattrs.blob);'. It appears that a race
  occurred and resource was freed by the latter line before the former
  line could increment it.

  encode_cap_msg() is called by __send_cap() and __send_cap() is called by
  ceph_check_caps() after calling __prep_cap(). __prep_cap() is where
  arg->xattr_buf is assigned to ci->i_xattrs.blob. This is the spot where
  the refcount must be increased to prevent "use after free" error.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26689
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/70e329b440762390258a6fe8c0de93c9fdd56c77
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7958c1bf5b03c6f1f58e724dbdec93f8f60b96fc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8180d0c27b93a6eb60da1b08ea079e3926328214
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ae20db45e482303a20e56f2db667a9d9c54ac7e7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cda4672da1c26835dcbd7aec2bfed954eda9b5ef
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f3f98d7d84b31828004545e29fd7262b9f444139
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26689
    reference_type:
    reference_id: CVE-2024-26689
