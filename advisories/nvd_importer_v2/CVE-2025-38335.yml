advisory_id: CVE-2025-38335
datasource_id: nvd_importer_v2/CVE-2025-38335
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38335
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  Input: gpio-keys - fix a sleep while atomic with PREEMPT_RT

  When enabling PREEMPT_RT, the gpio_keys_irq_timer() callback runs in
  hard irq context, but the input_event() takes a spin_lock, which isn't
  allowed there as it is converted to a rt_spin_lock().

  [ 4054.289999] BUG: sleeping function called from invalid context at kernel/locking/spinlock_rt.c:48
  [ 4054.290028] in_atomic(): 1, irqs_disabled(): 1, non_block: 0, pid: 0, name: swapper/0
  ...
  [ 4054.290195]  __might_resched+0x13c/0x1f4
  [ 4054.290209]  rt_spin_lock+0x54/0x11c
  [ 4054.290219]  input_event+0x48/0x80
  [ 4054.290230]  gpio_keys_irq_timer+0x4c/0x78
  [ 4054.290243]  __hrtimer_run_queues+0x1a4/0x438
  [ 4054.290257]  hrtimer_interrupt+0xe4/0x240
  [ 4054.290269]  arch_timer_handler_phys+0x2c/0x44
  [ 4054.290283]  handle_percpu_devid_irq+0x8c/0x14c
  [ 4054.290297]  handle_irq_desc+0x40/0x58
  [ 4054.290307]  generic_handle_domain_irq+0x1c/0x28
  [ 4054.290316]  gic_handle_irq+0x44/0xcc

  Considering the gpio_keys_irq_isr() can run in any context, e.g. it can
  be threaded, it seems there's no point in requesting the timer isr to
  run in hard irq context.

  Relax the hrtimer not to use the hard context.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38335
weaknesses:
  - CWE-667
references:
  - url: https://git.kernel.org/stable/c/664e5a6f541ff226621487d1280d2ec28e86be28
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a7b79db25846459de63ca8974268f0c41c734c4b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a8f01e51109f77229e426b57c5d19251b462c6aa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ec8f5da79b425deef5aebacdd4fe645620cd4f0b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f4a8f561d08e39f7833d4a278ebfb12a41eef15f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fa53beab4740c4e5fe969f218a379f9558be33dc
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38335
    reference_type:
    reference_id: CVE-2025-38335
