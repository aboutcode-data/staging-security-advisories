advisory_id: CVE-2024-26885
datasource_id: nvd_importer_v2/CVE-2024-26885
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26885
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: Fix DEVMAP_HASH overflow check on 32-bit arches

  The devmap code allocates a number hash buckets equal to the next power
  of two of the max_entries value provided when creating the map. When
  rounding up to the next power of two, the 32-bit variable storing the
  number of buckets can overflow, and the code checks for overflow by
  checking if the truncated 32-bit value is equal to 0. However, on 32-bit
  arches the rounding up itself can overflow mid-way through, because it
  ends up doing a left-shift of 32 bits on an unsigned long value. If the
  size of an unsigned long is four bytes, this is undefined behaviour, so
  there is no guarantee that we'll end up with a nice and tidy 0-value at
  the end.

  Syzbot managed to turn this into a crash on arm32 by creating a
  DEVMAP_HASH with max_entries > 0x80000000 and then trying to update it.
  Fix this by moving the overflow check to before the rounding up
  operation.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26885
weaknesses:
  - CWE-119
references:
  - url: https://git.kernel.org/stable/c/1f5e352b9088211fa5eb4e1639cd365f4f7d2f65
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/22079b3a423382335f47d9ed32114e6c9fe88d7c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/225da02acdc97af01b6bc6ce1a3e5362bf01d3fb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/250051acc21f9d4c5c595e4fcb55986ea08c4691
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/281d464a34f540de166cee74b723e97ac2515ec3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4b81a9f92b3676cb74b907a7a209b3d15bd9a7f9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c826502bed93970f2fd488918a7b8d5f1d30e2e3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e89386f62ce9a9ab9a94835a9890883c23d9d52c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/edf7990baa48de5097daa9ac02e06cb4c798a737
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26885
    reference_type:
    reference_id: CVE-2024-26885
