advisory_id: CVE-2022-49942
datasource_id: nvd_importer_v2/CVE-2022-49942
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49942
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: mac80211: Don't finalize CSA in IBSS mode if state is disconnected

  When we are not connected to a channel, sending channel "switch"
  announcement doesn't make any sense.

  The BSS list is empty in that case. This causes the for loop in
  cfg80211_get_bss() to be bypassed, so the function returns NULL
  (check line 1424 of net/wireless/scan.c), causing the WARN_ON()
  in ieee80211_ibss_csa_beacon() to get triggered (check line 500
  of net/mac80211/ibss.c), which was consequently reported on the
  syzkaller dashboard.

  Thus, check if we have an existing connection before generating
  the CSA beacon in ieee80211_ibss_finish_csa().
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49942
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/15bc8966b6d3a5b9bfe4c9facfa02f2b69b1e5f0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1691a48aef0a82d1754b9853dae7e3f5cacdf70b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/552ba102a6898630a7d16887f29e606d6fabe508
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/66689c5c02acd4d76c28498fe220998610aec61e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/864e280cb3a9a0f5212b16ef5057c4e692f7039d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cdb9a8da9b84800eb15506cd9363cf0cf059e677
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d9eb37db6a28b59a95a3461450ee209654c5f95b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd649b49219a0388cc10fc40e4c2ea681566a780
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49942
    reference_type:
    reference_id: CVE-2022-49942
