advisory_id: CVE-2024-46735
datasource_id: nvd_importer_v2/CVE-2024-46735
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-46735
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ublk_drv: fix NULL pointer dereference in ublk_ctrl_start_recovery()

  When two UBLK_CMD_START_USER_RECOVERY commands are submitted, the
  first one sets 'ubq->ubq_daemon' to NULL, and the second one triggers
  WARN in ublk_queue_reinit() and subsequently a NULL pointer dereference
  issue.

  Fix it by adding the check in ublk_ctrl_start_recovery() and return
  immediately in case of zero 'ub->nr_queues_ready'.

    BUG: kernel NULL pointer dereference, address: 0000000000000028
    RIP: 0010:ublk_ctrl_start_recovery.constprop.0+0x82/0x180
    Call Trace:
     <TASK>
     ? __die+0x20/0x70
     ? page_fault_oops+0x75/0x170
     ? exc_page_fault+0x64/0x140
     ? asm_exc_page_fault+0x22/0x30
     ? ublk_ctrl_start_recovery.constprop.0+0x82/0x180
     ublk_ctrl_uring_cmd+0x4f7/0x6c0
     ? pick_next_task_idle+0x26/0x40
     io_uring_cmd+0x9a/0x1b0
     io_issue_sqe+0x193/0x3f0
     io_wq_submit_work+0x9b/0x390
     io_worker_handle_work+0x165/0x360
     io_wq_worker+0xcb/0x2f0
     ? finish_task_switch.isra.0+0x203/0x290
     ? finish_task_switch.isra.0+0x203/0x290
     ? __pfx_io_wq_worker+0x10/0x10
     ret_from_fork+0x2d/0x50
     ? __pfx_io_wq_worker+0x10/0x10
     ret_from_fork_asm+0x1a/0x30
     </TASK>
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-46735
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/136a29d8112df4ea0a57f9602ddf3579e04089dc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7c890ef60bf417d3fe5c6f7a9f6cef0e1d77f74f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca249435893dda766f3845c15ca77ca5672022d8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e58f5142f88320a5b1449f96a146f2f24615c5c7
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-46735
    reference_type:
    reference_id: CVE-2024-46735
