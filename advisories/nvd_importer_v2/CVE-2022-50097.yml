advisory_id: CVE-2022-50097
datasource_id: nvd_importer_v2/CVE-2022-50097
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50097
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  video: fbdev: s3fb: Check the size of screen before memset_io()

  In the function s3fb_set_par(), the value of 'screen_size' is
  calculated by the user input. If the user provides the improper value,
  the value of 'screen_size' may larger than 'info->screen_size', which
  may cause the following bug:

  [   54.083733] BUG: unable to handle page fault for address: ffffc90003000000
  [   54.083742] #PF: supervisor write access in kernel mode
  [   54.083744] #PF: error_code(0x0002) - not-present page
  [   54.083760] RIP: 0010:memset_orig+0x33/0xb0
  [   54.083782] Call Trace:
  [   54.083788]  s3fb_set_par+0x1ec6/0x4040
  [   54.083806]  fb_set_var+0x604/0xeb0
  [   54.083836]  do_fb_ioctl+0x234/0x670

  Fix the this by checking the value of 'screen_size' before memset_io().
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50097
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3c35a0dc2b4e7acf24c796043b64fa3eee799239
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/52461d387cc8c8f8dc40320caa2e9e101f73e7ba
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/574912261528589012b61f82d368256247c3a5a8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e0da18956d38e7106664dc1d06367b22f06edd3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6ba592fa014f21f35a8ee8da4ca7b95a018f13e8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ce50d94afcb8690813c5522f24cd38737657db81
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e2d7cacc6a2a1d77e7e20a492daf458a12cf19e0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eacb50f1733660911827d7c3720f4c5425d0cdda
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50097
    reference_type:
    reference_id: CVE-2022-50097
