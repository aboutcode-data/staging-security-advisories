advisory_id: CVE-2026-22686
datasource_id: nvd_importer_v2/CVE-2026-22686
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-22686
aliases: []
summary: Enclave is a secure JavaScript sandbox designed for safe AI agent code execution. Prior
  to 2.7.0, there is a critical sandbox escape vulnerability in enclave-vm that allows untrusted,
  sandboxed JavaScript code to execute arbitrary code in the host Node.js runtime. When a tool
  invocation fails, enclave-vm exposes a host-side Error object to sandboxed code. This Error
  object retains its host realm prototype chain, which can be traversed to reach the host Function
  constructor. An attacker can intentionally trigger a host error, then climb the prototype
  chain. Using the host Function constructor, arbitrary JavaScript can be compiled and executed
  in the host context, fully bypassing the sandbox and granting access to sensitive resources
  such as process.env, filesystem, and network. This breaks enclave-vmâ€™s core security guarantee
  of isolating untrusted code. This vulnerability is fixed in 2.7.0.
impacted_packages: []
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-22686
weaknesses:
  - CWE-94
  - CWE-693
references:
  - url: https://github.com/agentfront/enclave/commit/ed8bc438b2cd6e6f0b5f2de321e5be6f0169b5a1
    reference_type:
    reference_id:
  - url: https://github.com/agentfront/enclave/security/advisories/GHSA-7qm7-455j-5p63
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-22686
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:agentfront:enclave:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:agentfront:enclave:*:*:*:*:*:node.js:*:*
