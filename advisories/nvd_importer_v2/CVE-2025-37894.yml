advisory_id: CVE-2025-37894
datasource_id: nvd_importer_v2/CVE-2025-37894
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37894
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: use sock_gen_put() when sk_state is TCP_TIME_WAIT

  It is possible for a pointer of type struct inet_timewait_sock to be
  returned from the functions __inet_lookup_established() and
  __inet6_lookup_established(). This can cause a crash when the
  returned pointer is of type struct inet_timewait_sock and
  sock_put() is called on it. The following is a crash call stack that
  shows sk->sk_wmem_alloc being accessed in sk_free() during the call to
  sock_put() on a struct inet_timewait_sock pointer. To avoid this issue,
  use sock_gen_put() instead of sock_put() when sk->sk_state
  is TCP_TIME_WAIT.

  mrdump.ko        ipanic() + 120
  vmlinux          notifier_call_chain(nr_to_call=-1, nr_calls=0) + 132
  vmlinux          atomic_notifier_call_chain(val=0) + 56
  vmlinux          panic() + 344
  vmlinux          add_taint() + 164
  vmlinux          end_report() + 136
  vmlinux          kasan_report(size=0) + 236
  vmlinux          report_tag_fault() + 16
  vmlinux          do_tag_recovery() + 16
  vmlinux          __do_kernel_fault() + 88
  vmlinux          do_bad_area() + 28
  vmlinux          do_tag_check_fault() + 60
  vmlinux          do_mem_abort() + 80
  vmlinux          el1_abort() + 56
  vmlinux          el1h_64_sync_handler() + 124
  vmlinux        > 0xFFFFFFC080011294()
  vmlinux          __lse_atomic_fetch_add_release(v=0xF2FFFF82A896087C)
  vmlinux          __lse_atomic_fetch_sub_release(v=0xF2FFFF82A896087C)
  vmlinux          arch_atomic_fetch_sub_release(i=1, v=0xF2FFFF82A896087C)
  + 8
  vmlinux          raw_atomic_fetch_sub_release(i=1, v=0xF2FFFF82A896087C)
  + 8
  vmlinux          atomic_fetch_sub_release(i=1, v=0xF2FFFF82A896087C) + 8
  vmlinux          __refcount_sub_and_test(i=1, r=0xF2FFFF82A896087C,
  oldp=0) + 8
  vmlinux          __refcount_dec_and_test(r=0xF2FFFF82A896087C, oldp=0) + 8
  vmlinux          refcount_dec_and_test(r=0xF2FFFF82A896087C) + 8
  vmlinux          sk_free(sk=0xF2FFFF82A8960700) + 28
  vmlinux          sock_put() + 48
  vmlinux          tcp6_check_fraglist_gro() + 236
  vmlinux          tcp6_gro_receive() + 624
  vmlinux          ipv6_gro_receive() + 912
  vmlinux          dev_gro_receive() + 1116
  vmlinux          napi_gro_receive() + 196
  ccmni.ko         ccmni_rx_callback() + 208
  ccmni.ko         ccmni_queue_recv_skb() + 388
  ccci_dpmaif.ko   dpmaif_rxq_push_thread() + 1088
  vmlinux          kthread() + 268
  vmlinux          0xFFFFFFC08001F30C()
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37894
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/786650e644c5b1c063921799ca203c0b8670d79a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c0dba059b118b5206e755042b15b49368a388898
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f920436a44295ca791ebb6dae3f4190142eec703
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37894
    reference_type:
    reference_id: CVE-2025-37894
