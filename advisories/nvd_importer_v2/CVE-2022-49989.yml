advisory_id: CVE-2022-49989
datasource_id: nvd_importer_v2/CVE-2022-49989
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49989
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  xen/privcmd: fix error exit of privcmd_ioctl_dm_op()

  The error exit of privcmd_ioctl_dm_op() is calling unlock_pages()
  potentially with pages being NULL, leading to a NULL dereference.

  Additionally lock_pages() doesn't check for pin_user_pages_fast()
  having been completely successful, resulting in potentially not
  locking all pages into memory. This could result in sporadic failures
  when using the related memory in user mode.

  Fix all of that by calling unlock_pages() always with the real number
  of pinned pages, which will be zero in case pages being NULL, and by
  checking the number of pages pinned by pin_user_pages_fast() matching
  the expected number of pages.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49989
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/45d47bd9b96e7874b98dbcc7602fe2826c5d62a6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6de50db104af0dc921f593fd95c55db86a52ceef
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c2b7bae7c90051fd6a679d5dee00400d67ebbf4a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c5deb27895e017a0267de0a20d140ad5fcc55a54
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49989
    reference_type:
    reference_id: CVE-2022-49989
