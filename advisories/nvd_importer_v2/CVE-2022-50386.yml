advisory_id: CVE-2022-50386
datasource_id: nvd_importer_v2/CVE-2022-50386
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50386
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  Bluetooth: L2CAP: Fix user-after-free

  This uses l2cap_chan_hold_unless_zero() after calling
  __l2cap_get_chan_blah() to prevent the following trace:

  Bluetooth: l2cap_core.c:static void l2cap_chan_destroy(struct kref
  *kref)
  Bluetooth: chan 0000000023c4974d
  Bluetooth: parent 00000000ae861c08
  ==================================================================
  BUG: KASAN: use-after-free in __mutex_waiter_is_first
  kernel/locking/mutex.c:191 [inline]
  BUG: KASAN: use-after-free in __mutex_lock_common
  kernel/locking/mutex.c:671 [inline]
  BUG: KASAN: use-after-free in __mutex_lock+0x278/0x400
  kernel/locking/mutex.c:729
  Read of size 8 at addr ffff888006a49b08 by task kworker/u3:2/389
impacted_packages: []
severities:
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50386
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/0c108cf3ad386e0084277093b55a351c49e0be27
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/11e40d6c0823f699d8ad501e48d1c3ae4be386cd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/15fc21695eb606bdc5d483b92118ee42610a952d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35fcbc4243aad7e7d020b7c1dfb14bb888b20a4f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6ffde6e03085874ae22263ff4cef4869f797e84f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7d6f9cb24d2b2f6b6370eac074e2e6b1bafdad45
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/843fc4e386dd84b806a7f07fb062d8c3a44e5364
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d1e894f950ad48897d1a7cb05909ea29d8c3810e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d91fc2836562f299f34e361e089e9fe154da4f73
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50386
    reference_type:
    reference_id: CVE-2022-50386
