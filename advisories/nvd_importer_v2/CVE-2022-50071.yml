advisory_id: CVE-2022-50071
datasource_id: nvd_importer_v2/CVE-2022-50071
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50071
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mptcp: move subflow cleanup in mptcp_destroy_common()

  If the mptcp socket creation fails due to a CGROUP_INET_SOCK_CREATE
  eBPF program, the MPTCP protocol ends-up leaking all the subflows:
  the related cleanup happens in __mptcp_destroy_sock() that is not
  invoked in such code path.

  Address the issue moving the subflow sockets cleanup in the
  mptcp_destroy_common() helper, which is invoked in every msk cleanup
  path.

  Additionally get rid of the intermediate list_splice_init step, which
  is an unneeded relic from the past.

  The issue is present since before the reported root cause commit, but
  any attempt to backport the fix before that hash will require a complete
  rewrite.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50071
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/6139039c8fc5c9dbcdc3ad389b9a6d0cacb4d693
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c0bf3c6aa444a5ef44acc57ef6cfa53fd4fc1c9b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50071
    reference_type:
    reference_id: CVE-2022-50071
