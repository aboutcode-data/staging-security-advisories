advisory_id: CVE-2023-53387
datasource_id: nvd_importer_v2/CVE-2023-53387
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53387
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: ufs: core: Fix device management cmd timeout flow

  In the UFS error handling flow, the host will send a device management cmd
  (NOP OUT) to the device for link recovery. If this cmd times out and
  clearing the doorbell fails, ufshcd_wait_for_dev_cmd() will do nothing and
  return. hba->dev_cmd.complete struct is not set to NULL.

  When this happens, if cmd has been completed by device, then we will call
  complete() in __ufshcd_transfer_req_compl(). Because the complete struct is
  allocated on the stack, the following crash will occur:

    ipanic_die+0x24/0x38 [mrdump]
    die+0x344/0x748
    arm64_notify_die+0x44/0x104
    do_debug_exception+0x104/0x1e0
    el1_dbg+0x38/0x54
    el1_sync_handler+0x40/0x88
    el1_sync+0x8c/0x140
    queued_spin_lock_slowpath+0x2e4/0x3c0
    __ufshcd_transfer_req_compl+0x3b0/0x1164
    ufshcd_trc_handler+0x15c/0x308
    ufshcd_host_reset_and_restore+0x54/0x260
    ufshcd_reset_and_restore+0x28c/0x57c
    ufshcd_err_handler+0xeb8/0x1b6c
    process_one_work+0x288/0x964
    worker_thread+0x4bc/0xc7c
    kthread+0x15c/0x264
    ret_from_fork+0x10/0x30
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53387
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/36822124f9de200cedc2f42516301b50d386a6cd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3ffd2cd644e0f1eea01339831bac4b1054e8817c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cf45493432704786a0f8294c7723ad4eeb5fff24
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53387
    reference_type:
    reference_id: CVE-2023-53387
