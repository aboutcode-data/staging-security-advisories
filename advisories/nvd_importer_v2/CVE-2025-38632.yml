advisory_id: CVE-2025-38632
datasource_id: nvd_importer_v2/CVE-2025-38632
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38632
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  pinmux: fix race causing mux_owner NULL with active mux_usecount

  commit 5a3e85c3c397 ("pinmux: Use sequential access to access
  desc->pinmux data") tried to address the issue when two client of the
  same gpio calls pinctrl_select_state() for the same functionality, was
  resulting in NULL pointer issue while accessing desc->mux_owner.
  However, issue was not completely fixed due to the way it was handled
  and it can still result in the same NULL pointer.

  The issue occurs due to the following interleaving:

       cpu0 (process A)                   cpu1 (process B)

        pin_request() {                   pin_free() {

                                           mutex_lock()
                                           desc->mux_usecount--; //becomes 0
                                           ..
                                           mutex_unlock()

    mutex_lock(desc->mux)
    desc->mux_usecount++; // becomes 1
    desc->mux_owner = owner;
    mutex_unlock(desc->mux)

                                           mutex_lock(desc->mux)
                                           desc->mux_owner = NULL;
                                           mutex_unlock(desc->mux)

  This sequence leads to a state where the pin appears to be in use
  (`mux_usecount == 1`) but has no owner (`mux_owner == NULL`), which can
  cause NULL pointer on next pin_request on the same pin.

  Ensure that updates to mux_usecount and mux_owner are performed
  atomically under the same lock. Only clear mux_owner when mux_usecount
  reaches zero and no new owner has been assigned.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38632
weaknesses:
  - CWE-476
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/0b075c011032f88d1cfde3b45d6dcf08b44140eb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/22b585cbd67d14df3b91529d1b990661c300faa9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9b2a3e7189028aa7c4d53a84364f2ea9fb209787
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ea3f6b9a67be3476e331ce51cac316c2614a564
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b7bd6e3971eb7f0e34d2fdce1b18b08094e0c804
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38632
    reference_type:
    reference_id: CVE-2025-38632
