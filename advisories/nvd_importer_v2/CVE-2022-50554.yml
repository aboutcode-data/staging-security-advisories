advisory_id: CVE-2022-50554
datasource_id: nvd_importer_v2/CVE-2022-50554
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50554
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  blk-mq: avoid double ->queue_rq() because of early timeout

  David Jeffery found one double ->queue_rq() issue, so far it can
  be triggered in VM use case because of long vmexit latency or preempt
  latency of vCPU pthread or long page fault in vCPU pthread, then block
  IO req could be timed out before queuing the request to hardware but after
  calling blk_mq_start_request() during ->queue_rq(), then timeout handler
  may handle it by requeue, then double ->queue_rq() is caused, and kernel
  panic.

  So far, it is driver's responsibility to cover the race between timeout
  and completion, so it seems supposed to be solved in driver in theory,
  given driver has enough knowledge.

  But it is really one common problem, lots of driver could have similar
  issue, and could be hard to fix all affected drivers, even it isn't easy
  for driver to handle the race. So David suggests this patch by draining
  in-progress ->queue_rq() for solving this issue.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50554
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/7a73c54a3750895888ab586896736c9434e062a1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/82c229476b8f6afd7e09bc4dc77d89dc19ff7688
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8b3d6b029a552d2978bbac275303d11419826a69
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50554
    reference_type:
    reference_id: CVE-2022-50554
