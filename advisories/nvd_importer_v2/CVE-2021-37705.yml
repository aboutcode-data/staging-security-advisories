advisory_id: CVE-2021-37705
datasource_id: nvd_importer_v2/CVE-2021-37705
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-37705
aliases: []
summary: OneFuzz is an open source self-hosted Fuzzing-As-A-Service platform. Starting with
  OneFuzz 2.12.0 or greater, an incomplete authorization check allows an authenticated user
  from any Azure Active Directory tenant to make authorized API calls to a vulnerable OneFuzz
  instance. To be vulnerable, a OneFuzz deployment must be both version 2.12.0 or greater and
  deployed with the non-default --multi_tenant_domain option. This can result in read/write
  access to private data such as software vulnerability and crash information, security testing
  tools and proprietary code and symbols. Via authorized API calls, this also enables tampering
  with existing data and unauthorized code execution on Azure compute resources. This issue
  is resolved starting in release 2.31.0, via the addition of application-level check of the
  bearer token's `issuer` against an administrator-configured allowlist. As a workaround users
  can restrict access to the tenant of a deployed OneFuzz instance < 2.31.0 by redeploying in
  the default configuration, which omits the `--multi_tenant_domain` option.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37705
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37705
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37705
weaknesses:
  - CWE-285
  - CWE-863
  - CWE-346
references:
  - url: https://github.com/microsoft/onefuzz/commit/2fcb4998887959b4fa11894a068d689189742cb1
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/onefuzz/pull/1153
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/onefuzz/releases/tag/2.31.0
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/onefuzz/security/advisories/GHSA-q5vh-6whw-x745
    reference_type:
    reference_id:
  - url: https://pypi.org/project/onefuzz/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:microsoft:onefuzz:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:microsoft:onefuzz:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37705
    reference_type:
    reference_id: CVE-2021-37705
