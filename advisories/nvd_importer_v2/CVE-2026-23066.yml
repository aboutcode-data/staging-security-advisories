advisory_id: CVE-2026-23066
datasource_id: nvd_importer_v2/CVE-2026-23066
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23066
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  rxrpc: Fix recvmsg() unconditional requeue

  If rxrpc_recvmsg() fails because MSG_DONTWAIT was specified but the call at
  the front of the recvmsg queue already has its mutex locked, it requeues
  the call - whether or not the call is already queued.  The call may be on
  the queue because MSG_PEEK was also passed and so the call was not dequeued
  or because the I/O thread requeued it.

  The unconditional requeue may then corrupt the recvmsg queue, leading to
  things like UAFs or refcount underruns.

  Fix this by only requeuing the call if it isn't already on the queue - and
  moving it to the front if it is already queued.  If we don't queue it, we
  have to put the ref we obtained by dequeuing it.

  Also, MSG_PEEK doesn't dequeue the call so shouldn't call
  rxrpc_notify_socket() for the call if we didn't use up all the data on the
  queue, so fix that also.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2c28769a51deb6022d7fbd499987e237a01dd63a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/930114425065f7ace6e0c0630fab4af75e059ea8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23066
    reference_type:
    reference_id: CVE-2026-23066
