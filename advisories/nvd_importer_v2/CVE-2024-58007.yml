advisory_id: CVE-2024-58007
datasource_id: nvd_importer_v2/CVE-2024-58007
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-58007
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  soc: qcom: socinfo: Avoid out of bounds read of serial number

  On MSM8916 devices, the serial number exposed in sysfs is constant and does
  not change across individual devices. It's always:

    db410c:/sys/devices/soc0$ cat serial_number
    2644893864

  The firmware used on MSM8916 exposes SOCINFO_VERSION(0, 8), which does not
  have support for the serial_num field in the socinfo struct. There is an
  existing check to avoid exposing the serial number in that case, but it's
  not correct: When checking the item_size returned by SMEM, we need to make
  sure the *end* of the serial_num is within bounds, instead of comparing
  with the *start* offset. The serial_number currently exposed on MSM8916
  devices is just an out of bounds read of whatever comes after the socinfo
  struct in SMEM.

  Fix this by changing offsetof() to offsetofend(), so that the size of the
  field is also taken into account.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-58007
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/0a92feddae0634a0b87c04b19d343f6af97af700
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/22cf4fae6660b6e1a583a41cbf84e3046ca9ccd0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2495c6598731b6d7f565140f2bd63ef4bc36ce7d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2d09d3c9afa2fc422ac3df7c9b8534f350ee19dd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/407c928305c1a37232a63811c400ef616f85ccbc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/47470acd719d45c4c8c418c07962f74cc995652b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7445fa05317534bbd8b373c0eff8319187916030
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9c88b3a3fae4d60641c3a45be66269d00eff33cd
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00028.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-58007
    reference_type:
    reference_id: CVE-2024-58007
