advisory_id: CVE-2025-21871
datasource_id: nvd_importer_v2/CVE-2025-21871
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21871
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tee: optee: Fix supplicant wait loop

  OP-TEE supplicant is a user-space daemon and it's possible for it
  be hung or crashed or killed in the middle of processing an OP-TEE
  RPC call. It becomes more complicated when there is incorrect shutdown
  ordering of the supplicant process vs the OP-TEE client application which
  can eventually lead to system hang-up waiting for the closure of the
  client application.

  Allow the client process waiting in kernel for supplicant response to
  be killed rather than indefinitely waiting in an unkillable state. Also,
  a normal uninterruptible wait should not have resulted in the hung-task
  watchdog getting triggered, but the endless loop would.

  This fixes issues observed during system reboot/shutdown when supplicant
  got hung for some reason or gets crashed/killed which lead to client
  getting hung in an unkillable state. It in turn lead to system being in
  hung up state requiring hard power off/on to recover.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21871
weaknesses:
  - CWE-835
references:
  - url: https://git.kernel.org/stable/c/0180cf0373f84fff61b16f8c062553a13dd7cfca
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/21234efe2a8474a6d2d01ea9573319de7858ce44
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3eb4911364c764572e9db4ab900a57689a54e8ce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/70b0d6b0a199c5a3ee6c72f5e61681ed6f759612
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c0a9a948159153be145f9471435695373904ee6d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d61cc1a435e6894bfb0dd3370c6f765d2d12825d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ec18520f5edc20a00c34a8c9fdd6507c355e880f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fd9d2d6124c293e40797a080adf8a9c237efd8b8
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21871
    reference_type:
    reference_id: CVE-2025-21871
