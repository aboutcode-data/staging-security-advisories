advisory_id: CVE-2025-39790
datasource_id: nvd_importer_v2/CVE-2025-39790
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39790
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bus: mhi: host: Detect events pointing to unexpected TREs

  When a remote device sends a completion event to the host, it contains a
  pointer to the consumed TRE. The host uses this pointer to process all of
  the TREs between it and the host's local copy of the ring's read pointer.
  This works when processing completion for chained transactions, but can
  lead to nasty results if the device sends an event for a single-element
  transaction with a read pointer that is multiple elements ahead of the
  host's read pointer.

  For instance, if the host accesses an event ring while the device is
  updating it, the pointer inside of the event might still point to an old
  TRE. If the host uses the channel's xfer_cb() to directly free the buffer
  pointed to by the TRE, the buffer will be double-freed.

  This behavior was observed on an ep that used upstream EP stack without
  'commit 6f18d174b73d ("bus: mhi: ep: Update read pointer only after buffer
  is written")'. Where the device updated the events ring pointer before
  updating the event contents, so it left a window where the host was able to
  access the stale data the event pointed to, before the device had the
  chance to update them. The usual pattern was that the host received an
  event pointing to a TRE that is not immediately after the last processed
  one, so it got treated as if it was a chained transaction, processing all
  of the TREs in between the two read pointers.

  This commit aims to harden the host by ensuring transactions where the
  event points to a TRE that isn't local_rp + 1 are chained.

  [mani: added stable tag and reworded commit message]
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39790
weaknesses:
  - CWE-415
references:
  - url: https://git.kernel.org/stable/c/2ec99b922f4661521927eeada76f431eebfbabc4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4079c6c59705b96285219b9efc63cab870d757b7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/44e1a079e18f78d6594a715b0c6d7e18c656f7b9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5bd398e20f0833ae8a1267d4f343591a2dd20185
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e17429679a8545afe438ce7a82a13a54e8ceabb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b3f0e3b60c27f4fcb69927d84987e5fd6240530
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39790
    reference_type:
    reference_id: CVE-2025-39790
