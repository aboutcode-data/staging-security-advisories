advisory_id: CVE-2025-37875
datasource_id: nvd_importer_v2/CVE-2025-37875
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37875
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  igc: fix PTM cycle trigger logic

  Writing to clear the PTM status 'valid' bit while the PTM cycle is
  triggered results in unreliable PTM operation. To fix this, clear the
  PTM 'trigger' and status after each PTM transaction.

  The issue can be reproduced with the following:

  $ sudo phc2sys -R 1000 -O 0 -i tsn0 -m

  Note: 1000 Hz (-R 1000) is unrealistically large, but provides a way to
  quickly reproduce the issue.

  PHC2SYS exits with:

  "ioctl PTP_OFFSET_PRECISE: Connection timed out" when the PTM transaction
    fails

  This patch also fixes a hang in igc_probe() when loading the igc
  driver in the kdump kernel on systems supporting PTM.

  The igc driver running in the base kernel enables PTM trigger in
  igc_probe().  Therefore the driver is always in PTM trigger mode,
  except in brief periods when manually triggering a PTM cycle.

  When a crash occurs, the NIC is reset while PTM trigger is enabled.
  Due to a hardware problem, the NIC is subsequently in a bad busmaster
  state and doesn't handle register reads/writes.  When running
  igc_probe() in the kdump kernel, the first register access to a NIC
  register hangs driver probing and ultimately breaks kdump.

  With this patch, igc has PTM trigger disabled most of the time,
  and the trigger is only enabled for very brief (10 - 100 us) periods
  when manually triggering a PTM cycle.  Chances that a crash occurs
  during a PTM trigger are not 0, but extremely reduced.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37875
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0c03e4fbe1321697d9d04587e21e416705e1b19f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/16194ca3f3b4448a062650c869a7b3b206c6f5d3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/31959e06143692f7e02b8eef7d7d6ac645637906
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8e404ad95d2c10c261e2ef6992c7c12dde03df0e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c1f174edaccc5a00f8e218c42a0aa9156efd5f76
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f3516229cd12dcd45f23ed01adab17e8772b1bd5
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37875
    reference_type:
    reference_id: CVE-2025-37875
