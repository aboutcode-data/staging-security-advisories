advisory_id: CVE-2020-29487
datasource_id: nvd_importer_v2/CVE-2020-29487
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2020-29487
aliases: []
summary: An issue was discovered in Xen XAPI before 2020-12-15. Certain xenstore keys provide
  feedback from the guest, and are therefore watched by toolstack. Specifically, keys are watched
  by xenopsd, and data are forwarded via RPC through message-switch to xapi. The watching logic
  in xenopsd sends one RPC update containing all data, any time any single xenstore key is updated,
  and therefore has O(N^2) time complexity. Furthermore, message-switch retains recent (currently
  128) RPC messages for diagnostic purposes, yielding O(M*N) space complexity. The quantity
  of memory a single guest can monopolise is bounded by xenstored quota, but the quota is fairly
  large. It is believed to be in excess of 1G per malicious guest. In practice, this manifests
  as a host denial of service, either through message-switch thrashing against swap, or OOMing
  entirely, depending on dom0's configuration. (There are no quotas in xenopsd to limit the
  quantity of keys that result in RPC traffic.) A buggy or malicious guest can cause unreasonable
  memory usage in dom0, resulting in a host denial of service. All versions of XAPI are vulnerable.
  Systems that are not using the XAPI toolstack are not vulnerable.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-29487
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-29487
weaknesses:
  - CWE-770
references:
  - url: https://security.gentoo.org/glsa/202107-30
    reference_type:
    reference_id:
  - url: https://xenbits.xenproject.org/xsa/advisory-354.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:xen:xapi:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:xen:xapi:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-29487
    reference_type:
    reference_id: CVE-2020-29487
