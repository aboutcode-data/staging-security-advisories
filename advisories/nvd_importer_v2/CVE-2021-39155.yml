advisory_id: CVE-2021-39155
datasource_id: nvd_importer_v2/CVE-2021-39155
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-39155
aliases: []
summary: Istio is an open source platform for providing a uniform way to integrate microservices,
  manage traffic flow across microservices, enforce policies and aggregate telemetry data. According
  to [RFC 4343](https://datatracker.ietf.org/doc/html/rfc4343), Istio authorization policy should
  compare the hostname in the HTTP Host header in a case insensitive way, but currently the
  comparison is case sensitive. The proxy will route the request hostname in a case-insensitive
  way which means the authorization policy could be bypassed. As an example, the user may have
  an authorization policy that rejects request with hostname "httpbin.foo" for some source IPs,
  but the attacker can bypass this by sending the request with hostname "Httpbin.Foo". Patches
  are available in Istio 1.11.1, Istio 1.10.4 and Istio 1.9.8. As a work around a Lua filter
  may be written to normalize Host header before the authorization check. This is similar to
  the Path normalization presented in the [Security Best Practices](https://istio.io/latest/docs/ops/best-practices/security/#case-normalization)
  guide.
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39155
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39155
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39155
weaknesses:
  - CWE-863
  - CWE-178
references:
  - url: https://datatracker.ietf.org/doc/html/rfc4343
    reference_type:
    reference_id:
  - url: https://github.com/istio/istio/security/advisories/GHSA-7774-7vr3-cc8j
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:istio:istio:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:istio:istio:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39155
    reference_type:
    reference_id: CVE-2021-39155
