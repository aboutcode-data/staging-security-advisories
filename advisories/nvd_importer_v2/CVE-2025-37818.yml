advisory_id: CVE-2025-37818
datasource_id: nvd_importer_v2/CVE-2025-37818
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37818
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  LoongArch: Return NULL from huge_pte_offset() for invalid PMD

  LoongArch's huge_pte_offset() currently returns a pointer to a PMD slot
  even if the underlying entry points to invalid_pte_table (indicating no
  mapping). Callers like smaps_hugetlb_range() fetch this invalid entry
  value (the address of invalid_pte_table) via this pointer.

  The generic is_swap_pte() check then incorrectly identifies this address
  as a swap entry on LoongArch, because it satisfies the "!pte_present()
  && !pte_none()" conditions. This misinterpretation, combined with a
  coincidental match by is_migration_entry() on the address bits, leads to
  kernel crashes in pfn_swap_entry_to_page().

  Fix this at the architecture level by modifying huge_pte_offset() to
  check the PMD entry's content using pmd_none() before returning. If the
  entry is invalid (i.e., it points to invalid_pte_table), return NULL
  instead of the pointer to the slot.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37818
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/2ca9380b12711afe95b3589bd82b59623b3c96b3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/34256805720993e37adf6127371a1265aea8376a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/51424fd171cee6a33f01f7c66b8eb23ac42289d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b49f085cd671addbda4802d6b9382513f7dd0f30
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bd51834d1cf65a2c801295d230c220aeebf87a73
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37818
    reference_type:
    reference_id: CVE-2025-37818
