advisory_id: CVE-2025-38364
datasource_id: nvd_importer_v2/CVE-2025-38364
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38364
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  maple_tree: fix MA_STATE_PREALLOC flag in mas_preallocate()

  Temporarily clear the preallocation flag when explicitly requesting
  allocations.  Pre-existing allocations are already counted against the
  request through mas_node_count_gfp(), but the allocations will not happen
  if the MA_STATE_PREALLOC flag is set.  This flag is meant to avoid
  re-allocating in bulk allocation mode, and to detect issues with
  preallocation calculations.

  The MA_STATE_PREALLOC flag should also always be set on zero allocations
  so that detection of underflow allocations will print a WARN_ON() during
  consumption.

  User visible effect of this flaw is a WARN_ON() followed by a null pointer
  dereference when subsequent requests for larger number of nodes is
  ignored, such as the vma merge retry in mmap_region() caused by drivers
  altering the vma flags (which happens in v6.6, at least)
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38364
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/9e32f4700867abbd5d19abfcf698dbd0d2ce36a4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cf95f8426f889949b738f51ffcd72884411f3a6a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d69cd64bd5af41c6fd409313504089970edaf02f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e63032e66bca1d06e600033f3369ba3db3af0870
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fba46a5d83ca8decb338722fb4899026d8d9ead2
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38364
    reference_type:
    reference_id: CVE-2025-38364
