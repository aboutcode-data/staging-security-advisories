advisory_id: CVE-2025-23142
datasource_id: nvd_importer_v2/CVE-2025-23142
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-23142
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sctp: detect and prevent references to a freed transport in sendmsg

  sctp_sendmsg() re-uses associations and transports when possible by
  doing a lookup based on the socket endpoint and the message destination
  address, and then sctp_sendmsg_to_asoc() sets the selected transport in
  all the message chunks to be sent.

  There's a possible race condition if another thread triggers the removal
  of that selected transport, for instance, by explicitly unbinding an
  address with setsockopt(SCTP_SOCKOPT_BINDX_REM), after the chunks have
  been set up and before the message is sent. This can happen if the send
  buffer is full, during the period when the sender thread temporarily
  releases the socket lock in sctp_wait_for_sndbuf().

  This causes the access to the transport data in
  sctp_outq_select_transport(), when the association outqueue is flushed,
  to result in a use-after-free read.

  This change avoids this scenario by having sctp_transport_free() signal
  the freeing of the transport, tagging it as "dead". In order to do this,
  the patch restores the "dead" bit in struct sctp_transport, which was
  removed in
  commit 47faa1e4c50e ("sctp: remove the dead field of sctp_transport").

  Then, in the scenario where the sender thread has released the socket
  lock in sctp_wait_for_sndbuf(), the bit is checked again after
  re-acquiring the socket lock to detect the deletion. This is done while
  holding a reference to the transport to prevent it from being freed in
  the process.

  If the transport was deleted while the socket lock was relinquished,
  sctp_sendmsg_to_asoc() will return -EAGAIN to let userspace retry the
  send.

  The bug was found by a private syzbot instance (see the error report [1]
  and the C reproducer that triggers it [2]).
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-23142
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/0f7df4899299ce4662e5f95badb9dbc57cc37fa5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2e5068b7e0ae0a54f6cfd03a2f80977da657f1ee
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3257386be6a7eb8a8bfc9cbfb746df4eb4fc70e8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/547762250220325d350d0917a7231480e0f4142b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5bc83bdf5f5b8010d1ca5a4555537e62413ab4e2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7a63f4fb0efb4e69efd990cbb740a848679ec4b0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e7c37fadb3be1fc33073fcf10aa96d166caa697
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c6fefcb71d246baaf3bacdad1af7ff50ebcfe652
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f1a69a940de58b16e8249dff26f74c8cc59b32be
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23142
    reference_type:
    reference_id: CVE-2025-23142
