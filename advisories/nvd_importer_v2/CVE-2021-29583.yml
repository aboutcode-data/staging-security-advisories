advisory_id: CVE-2021-29583
datasource_id: nvd_importer_v2/CVE-2021-29583
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-29583
aliases: []
summary: TensorFlow is an end-to-end open source platform for machine learning. The implementation
  of `tf.raw_ops.FusedBatchNorm` is vulnerable to a heap buffer overflow. If the tensors are
  empty, the same implementation can trigger undefined behavior by dereferencing null pointers.
  The implementation(https://github.com/tensorflow/tensorflow/blob/57d86e0db5d1365f19adcce848dfc1bf89fdd4c7/tensorflow/core/kernels/fused_batch_norm_op.cc)
  fails to validate that `scale`, `offset`, `mean` and `variance` (the last two only when required)
  all have the same number of elements as the number of channels of `x`. This results in heap
  out of bounds reads when the buffers backing these tensors are indexed past their boundary.
  If the tensors are empty, the validation mentioned in the above paragraph would also trigger
  and prevent the undefined behavior. The fix will be included in TensorFlow 2.5.0. We will
  also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow
  2.1.4, as these are also affected and still in supported range.
impacted_packages: []
severities:
  - score: '4.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29583
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29583
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29583
weaknesses:
  - CWE-476
  - CWE-125
references:
  - url: https://github.com/tensorflow/tensorflow/commit/6972f9dfe325636b3db4e0bc517ee22a159365c0
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-9xh4-23q4-v6wr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29583
    reference_type:
    reference_id: CVE-2021-29583
