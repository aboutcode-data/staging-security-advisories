advisory_id: CVE-2021-43820
datasource_id: nvd_importer_v2/CVE-2021-43820
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-43820
aliases: []
summary: Seafile is an open source cloud storage system. A sync token is used in Seafile file
  syncing protocol to authorize access to library data. To improve performance, the token is
  cached in memory in seaf-server. Upon receiving a token from sync client or SeaDrive client,
  the server checks whether the token exist in the cache. However, if the token exists in cache,
  the server doesn't check whether it's associated with the specific library in the URL. This
  vulnerability makes it possible to use any valid sync token to access data from any **known**
  library. Note that the attacker has to first find out the ID of a library which it has no
  access to. The library ID is a random UUID, which is not possible to be guessed. There are
  no workarounds for this issue.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43820
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43820
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43820
weaknesses:
  - CWE-639
references:
  - url: https://github.com/haiwen/seafile-server/pull/520
    reference_type:
    reference_id:
  - url: https://github.com/haiwen/seafile-server/security/advisories/GHSA-m3wc-jv6r-hvv8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:seafile:seafile_server:*:*:*:*:community:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:seafile:seafile_server:*:*:*:*:community:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:seafile:seafile_server:*:*:*:*:professional:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:seafile:seafile_server:*:*:*:*:professional:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43820
    reference_type:
    reference_id: CVE-2021-43820
