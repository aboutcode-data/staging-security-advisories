advisory_id: CVE-2024-50077
datasource_id: nvd_importer_v2/CVE-2024-50077
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-50077
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  Bluetooth: ISO: Fix multiple init when debugfs is disabled

  If bt_debugfs is not created successfully, which happens if either
  CONFIG_DEBUG_FS or CONFIG_DEBUG_FS_ALLOW_ALL is unset, then iso_init()
  returns early and does not set iso_inited to true. This means that a
  subsequent call to iso_init() will result in duplicate calls to
  proto_register(), bt_sock_register(), etc.

  With CONFIG_LIST_HARDENED and CONFIG_BUG_ON_DATA_CORRUPTION enabled, the
  duplicate call to proto_register() triggers this BUG():

    list_add double add: new=ffffffffc0b280d0, prev=ffffffffbab56250,
      next=ffffffffc0b280d0.
    ------------[ cut here ]------------
    kernel BUG at lib/list_debug.c:35!
    Oops: invalid opcode: 0000 [#1] PREEMPT SMP PTI
    CPU: 2 PID: 887 Comm: bluetoothd Not tainted 6.10.11-1-ao-desktop #1
    RIP: 0010:__list_add_valid_or_report+0x9a/0xa0
    ...
      __list_add_valid_or_report+0x9a/0xa0
      proto_register+0x2b5/0x340
      iso_init+0x23/0x150 [bluetooth]
      set_iso_socket_func+0x68/0x1b0 [bluetooth]
      kmem_cache_free+0x308/0x330
      hci_sock_sendmsg+0x990/0x9e0 [bluetooth]
      __sock_sendmsg+0x7b/0x80
      sock_write_iter+0x9a/0x110
      do_iter_readv_writev+0x11d/0x220
      vfs_writev+0x180/0x3e0
      do_writev+0xca/0x100
    ...

  This change removes the early return. The check for iso_debugfs being
  NULL was unnecessary, it is always NULL when iso_inited is false.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50077
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/8fb8e912afb4c47dec12ea9a5853e7a8db95816f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a9b7b535ba192c6b77e6c15a4c82d853163eab8c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/adf1b179c2ff8073c24bf87e5a605fcc5a09798b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fa4b832c5a6ec35023a1b997cf658c436619c752
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50077
    reference_type:
    reference_id: CVE-2024-50077
