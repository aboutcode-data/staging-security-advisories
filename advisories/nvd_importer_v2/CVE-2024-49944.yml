advisory_id: CVE-2024-49944
datasource_id: nvd_importer_v2/CVE-2024-49944
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-49944
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sctp: set sk_state back to CLOSED if autobind fails in sctp_listen_start

  In sctp_listen_start() invoked by sctp_inet_listen(), it should set the
  sk_state back to CLOSED if sctp_autobind() fails due to whatever reason.

  Otherwise, next time when calling sctp_inet_listen(), if sctp_sk(sk)->reuse
  is already set via setsockopt(SCTP_REUSE_PORT), sctp_sk(sk)->bind_hash will
  be dereferenced as sk_state is LISTENING, which causes a crash as bind_hash
  is NULL.

    KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]
    RIP: 0010:sctp_inet_listen+0x7f0/0xa20 net/sctp/socket.c:8617
    Call Trace:
     <TASK>
     __sys_listen_socket net/socket.c:1883 [inline]
     __sys_listen+0x1b7/0x230 net/socket.c:1894
     __do_sys_listen net/socket.c:1902 [inline]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49944
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0e4e2e60556c6ed00e8450b720f106a268d23062
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7f64cb5b4d8c872296eda0fdce3bcf099eec7aa7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/89bbead9d897c77d0b566349c8643030ff2abeba
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8beee4d8dee76b67c75dc91fd8185d91e845c160
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9230a59eda0878d7ecaa901d876aec76f57bd455
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd70c8a89ef99c3d53127fe19e51ef47c3f860fa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e7a8442195e8ebd97df467ce4742980ab57edcce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e914bf68dab88815a7ae7b7a3a5e8913c8ff14a5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f032e1dac30b3376c7d6026fb01a8c403c47a80d
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49944
    reference_type:
    reference_id: CVE-2024-49944
