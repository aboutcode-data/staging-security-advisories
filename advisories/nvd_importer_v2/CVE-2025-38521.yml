advisory_id: CVE-2025-38521
datasource_id: nvd_importer_v2/CVE-2025-38521
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38521
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/imagination: Fix kernel crash when hard resetting the GPU

  The GPU hard reset sequence calls pm_runtime_force_suspend() and
  pm_runtime_force_resume(), which according to their documentation should
  only be used during system-wide PM transitions to sleep states.

  The main issue though is that depending on some internal runtime PM
  state as seen by pm_runtime_force_suspend() (whether the usage count is
  <= 1), pm_runtime_force_resume() might not resume the device unless
  needed. If that happens, the runtime PM resume callback
  pvr_power_device_resume() is not called, the GPU clocks are not
  re-enabled, and the kernel crashes on the next attempt to access GPU
  registers as part of the power-on sequence.

  Replace calls to pm_runtime_force_suspend() and
  pm_runtime_force_resume() with direct calls to the driver's runtime PM
  callbacks, pvr_power_device_suspend() and pvr_power_device_resume(),
  to ensure clocks are re-enabled and avoid the kernel crash.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38521
weaknesses:
  - CWE-668
references:
  - url: https://git.kernel.org/stable/c/9f852d301f642223c4798f3c13ba15e91165d078
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d38376b3ee48d073c64e75e150510d7e6b4b04f7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e066cc6e0f094ca2120f1928d126d56f686cd73e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38521
    reference_type:
    reference_id: CVE-2025-38521
