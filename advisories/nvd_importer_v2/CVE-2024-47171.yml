advisory_id: CVE-2024-47171
datasource_id: nvd_importer_v2/CVE-2024-47171
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-47171
aliases: []
summary: Agnai is an artificial-intelligence-agnostic multi-user, mult-bot roleplaying chat
  system. A vulnerability in versions prior to 1.0.330 permits attackers to upload image files
  at attacker-chosen location on the server. This issue can lead to image file uploads to unauthorized
  or unintended directories, including overwriting of existing images which may be used for
  defacement. This does not affect `agnai.chat`, installations using S3-compatible storage,
  or self-hosting that is not publicly exposed. Version 1.0.330 fixes this vulnerability.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47171
weaknesses:
  - CWE-22
  - CWE-35
references:
  - url: 'https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/character.ts#L140:'
    reference_type:
    reference_id:
  - url: https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/upload.ts#L55
    reference_type:
    reference_id:
  - url: https://github.com/agnaistic/agnai/security/advisories/GHSA-g54f-66mw-hv66
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:agnai:agnai:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:agnai:agnai:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47171
    reference_type:
    reference_id: CVE-2024-47171
