advisory_id: CVE-2019-17212
datasource_id: nvd_importer_v2/CVE-2019-17212
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2019-17212
aliases: []
summary: Buffer overflows were discovered in the CoAP library in Arm Mbed OS 5.14.0. The CoAP
  parser is responsible for parsing received CoAP packets. The function sn_coap_parser_options_parse()
  parses CoAP input linearly using a while loop. Once an option is parsed in a loop, the current
  point (*packet_data_pptr) is increased correspondingly. The pointer is restricted by the size
  of the received buffer, as well as by the 0xFF delimiter byte. Inside each while loop, the
  check of the value of *packet_data_pptr is not strictly enforced. More specifically, inside
  a loop, *packet_data_pptr could be increased and then dereferenced without checking. Moreover,
  there are many other functions in the format of sn_coap_parser_****() that do not check whether
  the pointer is within the bounds of the allocated buffer. All of these lead to heap-based
  or stack-based buffer overflows, depending on how the CoAP packet buffer is allocated.
impacted_packages: []
severities:
  - score: '10.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-17212
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-17212
weaknesses:
  - CWE-787
  - CWE-129
references:
  - url: https://github.com/ARMmbed/mbed-os/blob/d91ed5fa42ea0f32e4422a3c562e7b045a17da40/features/frameworks/mbed-coap/source/sn_coap_parser.c#L257
    reference_type:
    reference_id:
  - url: https://github.com/ARMmbed/mbed-os/blob/d91ed5fa42ea0f32e4422a3c562e7b045a17da40/features/frameworks/mbed-coap/source/sn_coap_parser.c#L301
    reference_type:
    reference_id:
  - url: https://github.com/ARMmbed/mbed-os/blob/d91ed5fa42ea0f32e4422a3c562e7b045a17da40/features/frameworks/mbed-coap/source/sn_coap_parser.c#L310
    reference_type:
    reference_id:
  - url: https://github.com/ARMmbed/mbed-os/blob/d91ed5fa42ea0f32e4422a3c562e7b045a17da40/features/frameworks/mbed-coap/source/sn_coap_parser.c#L313
    reference_type:
    reference_id:
  - url: https://github.com/ARMmbed/mbed-os/blob/d91ed5fa42ea0f32e4422a3c562e7b045a17da40/features/frameworks/mbed-coap/source/sn_coap_parser.c#L331
    reference_type:
    reference_id:
  - url: https://github.com/ARMmbed/mbed-os/blob/d91ed5fa42ea0f32e4422a3c562e7b045a17da40/features/frameworks/mbed-coap/source/sn_coap_parser.c#L660
    reference_type:
    reference_id:
  - url: https://github.com/ARMmbed/mbed-os/issues/11803
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:mbed:mbed:5.13.2:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:mbed:mbed:5.13.2:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:mbed:mbed:5.14.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:mbed:mbed:5.14.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-17212
    reference_type:
    reference_id: CVE-2019-17212
