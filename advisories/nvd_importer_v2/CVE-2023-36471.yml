advisory_id: CVE-2023-36471
datasource_id: nvd_importer_v2/CVE-2023-36471
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-36471
aliases: []
summary: Xwiki commons is the common modules used by other XWiki top level projects. The HTML
  sanitizer that is included in XWiki since version 14.6RC1 allowed form and input HTML tags.
  In the context of XWiki, this allows an attacker without script right to either create forms
  that can be used for phishing attacks or also in the context of a sheet, the attacker could
  add an input like `{{html}}<input type="hidden" name="content" value="{{groovy}}println(&quot;Hello
  from Groovy!&quot;)" />{{/html}}` that would allow remote code execution when it is submitted
  by an admin (the sheet is rendered as part of the edit form). The attacker would need to ensure
  that the edit form looks plausible, though, which can be non-trivial as without script right
  the attacker cannot display the regular content of the document. This has been patched in
  XWiki 14.10.6 and 15.2RC1 by removing the central form-related tags from the list of allowed
  tags. Users are advised to upgrade. As a workaround an admin can manually disallow the tags
  by adding `form, input, select, textarea, button` to the configuration option `xml.htmlElementSanitizer.forbidTags`
  in the `xwiki.properties` configuration file.
impacted_packages: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-36471
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-36471
weaknesses:
  - CWE-74
  - CWE-79
references:
  - url: https://github.com/xwiki/xwiki-commons/commit/99484d48e899a68a1b6e33d457825b776c6fe8c3
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-commons/security/advisories/GHSA-6pqf-c99p-758v
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XCOMMONS-2634
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:commons:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:commons:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:commons:15.0:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:commons:15.0:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:commons:15.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:commons:15.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:commons:15.1:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:commons:15.1:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:commons:15.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:commons:15.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-36471
    reference_type:
    reference_id: CVE-2023-36471
