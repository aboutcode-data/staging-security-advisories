advisory_id: CVE-2025-39725
datasource_id: nvd_importer_v2/CVE-2025-39725
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39725
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/vmscan: fix hwpoisoned large folio handling in shrink_folio_list

  In shrink_folio_list(), the hwpoisoned folio may be large folio, which
  can't be handled by unmap_poisoned_folio().  For THP, try_to_unmap_one()
  must be passed with TTU_SPLIT_HUGE_PMD to split huge PMD first and then
  retry.  Without TTU_SPLIT_HUGE_PMD, we will trigger null-ptr deref of
  pvmw.pte.  Even we passed TTU_SPLIT_HUGE_PMD, we will trigger a
  WARN_ON_ONCE due to the page isn't in swapcache.

  Since UCE is rare in real world, and race with reclaimation is more rare,
  just skipping the hwpoisoned large folio is enough.  memory_failure() will
  handle it if the UCE is triggered again.

  This happens when memory reclaim for large folio races with
  memory_failure(), and will lead to kernel panic.  The race is as
  follows:

  cpu0      cpu1
   shrink_folio_list memory_failure
    TestSetPageHWPoison
    unmap_poisoned_folio
    --> trigger BUG_ON due to
    unmap_poisoned_folio couldn't
     handle large folio

  [tujinjiang@huawei.com: add comment to unmap_poisoned_folio()]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39725
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/656eaddbc952e1baae2f69281c22debe22140312
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9f1e8cd0b7c4c944e9921b52a6661b5eda2705ab
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c1101113d45838a823188ae25c61af97552a28ae
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39725
    reference_type:
    reference_id: CVE-2025-39725
