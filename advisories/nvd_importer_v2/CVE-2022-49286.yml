advisory_id: CVE-2022-49286
datasource_id: nvd_importer_v2/CVE-2022-49286
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49286
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tpm: use try_get_ops() in tpm-space.c

  As part of the series conversion to remove nested TPM operations:

  https://lore.kernel.org/all/20190205224723.19671-1-jarkko.sakkinen@linux.intel.com/

  exposure of the chip->tpm_mutex was removed from much of the upper
  level code.  In this conversion, tpm2_del_space() was missed.  This
  didn't matter much because it's usually called closely after a
  converted operation, so there's only a very tiny race window where the
  chip can be removed before the space flushing is done which causes a
  NULL deref on the mutex.  However, there are reports of this window
  being hit in practice, so fix this by converting tpm2_del_space() to
  use tpm_try_get_ops(), which performs all the teardown checks before
  acquring the mutex.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49286
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/476ddd23f818fb94cf86fb5617f3bb9a7c92113d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5b1d2561a03e534064b51c50c774657833d3d2cf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95193d12f10a8a088843b25e0f5fe1d83ec6b079
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ba84f9a48366dcc3cdef978599433efe101dd5bd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eda1662cce964c8a65bb86321f8d9cfa6e9ceaab
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fb5abce6b2bb5cb3d628aaa63fa821da8c4600f9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49286
    reference_type:
    reference_id: CVE-2022-49286
