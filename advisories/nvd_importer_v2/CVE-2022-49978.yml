advisory_id: CVE-2022-49978
datasource_id: nvd_importer_v2/CVE-2022-49978
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49978
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fbdev: fb_pm2fb: Avoid potential divide by zero error

  In `do_fb_ioctl()` of fbmem.c, if cmd is FBIOPUT_VSCREENINFO, var will be
  copied from user, then go through `fb_set_var()` and
  `info->fbops->fb_check_var()` which could may be `pm2fb_check_var()`.
  Along the path, `var->pixclock` won't be modified. This function checks
  whether reciprocal of `var->pixclock` is too high. If `var->pixclock` is
  zero, there will be a divide by zero error. So, it is necessary to check
  whether denominator is zero to avoid crash. As this bug is found by
  Syzkaller, logs are listed below.

  divide error in pm2fb_check_var
  Call Trace:
   <TASK>
   fb_set_var+0x367/0xeb0 drivers/video/fbdev/core/fbmem.c:1015
   do_fb_ioctl+0x234/0x670 drivers/video/fbdev/core/fbmem.c:1110
   fb_ioctl+0xdd/0x130 drivers/video/fbdev/core/fbmem.c:1189
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49978
weaknesses:
  - CWE-369
references:
  - url: https://git.kernel.org/stable/c/0f1174f4972ea9fad6becf8881d71adca8e9ca91
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/19f953e7435644b81332dd632ba1b2d80b1e37af
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/34c3dea1189525cd533071ed5c176fc4ea8d982b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3ec326a6a0d4667585ca595f438c7293e5ced7c4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7d9591b32a9092fc6391a316b56e8016c6181c3d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7f88cdfea8d7f4dbaf423d808241403b2bb945e4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8fc778ee2fb2853f7a3531fa7273349640d8e4e9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cb4bb011a683532841344ca7f281b5e04389b4f8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49978
    reference_type:
    reference_id: CVE-2022-49978
