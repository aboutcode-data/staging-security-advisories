advisory_id: CVE-2022-50135
datasource_id: nvd_importer_v2/CVE-2022-50135
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50135
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  RDMA/rxe: Fix BUG: KASAN: null-ptr-deref in rxe_qp_do_cleanup

  The function rxe_create_qp calls rxe_qp_from_init. If some error
  occurs, the error handler of function rxe_qp_from_init will set
  both scq and rcq to NULL.

  Then rxe_create_qp calls rxe_put to handle qp. In the end,
  rxe_qp_do_cleanup is called by rxe_put. rxe_qp_do_cleanup directly
  accesses scq and rcq before checking them. This will cause
  null-ptr-deref error.

  The call graph is as below:

  rxe_create_qp {
    ...
    rxe_qp_from_init {
      ...
    err1:
      ...
      qp->rcq = NULL;  <---rcq is set to NULL
      qp->scq = NULL;  <---scq is set to NULL
      ...
    }

  qp_init:
    rxe_put{
      ...
      rxe_qp_do_cleanup {
        ...
        atomic_dec(&qp->scq->num_wq); <--- scq is accessed
        ...
        atomic_dec(&qp->rcq->num_wq); <--- rcq is accessed
      }
  }
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50135
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/37da51efe6eaa0560f46803c8c436a48a2084da7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8598b9d0a364c1663c96fc0fab9df0d36c809aea
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50135
    reference_type:
    reference_id: CVE-2022-50135
