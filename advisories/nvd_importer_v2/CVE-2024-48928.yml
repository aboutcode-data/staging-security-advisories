advisory_id: CVE-2024-48928
datasource_id: nvd_importer_v2/CVE-2024-48928
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-48928
aliases: []
summary: Piwigo is an open source photo gallery application for the web. In versions on the
  14.x branch, when installing, the secret_key configuration parameter is set to MD5(RAND())
  in MySQL. However, RAND() only has 30 bits of randomness, making it feasible to brute-force
  the secret key. The CSRF token is constructed partially from the secret key, and this can
  be used to check if the brute force succeeded. Trying all possible values takes approximately
  one hour. The impact of this is limited. The auto login key uses the user's password on top
  of the secret key. The pwg token uses the user's session identifier on top of the secret key.
  It seems that values for get_ephemeral_key can be generated when one knows the secret key.
  Version 15.0.0 contains a fix for the issue.
impacted_packages: []
severities:
  - score: '2.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:U/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-48928
weaknesses:
  - CWE-330
references:
  - url: https://github.com/Piwigo/Piwigo/commit/552499e0533ce54b55f4304b41ca6cd7ccce51f8
    reference_type:
    reference_id:
  - url: https://github.com/Piwigo/Piwigo/security/advisories/GHSA-hghg-37rg-7r42
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-48928
    reference_type:
    reference_id: CVE-2024-48928
