advisory_id: CVE-2025-38681
datasource_id: nvd_importer_v2/CVE-2025-38681
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38681
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/ptdump: take the memory hotplug lock inside ptdump_walk_pgd()

  Memory hot remove unmaps and tears down various kernel page table regions
  as required.  The ptdump code can race with concurrent modifications of
  the kernel page tables.  When leaf entries are modified concurrently, the
  dump code may log stale or inconsistent information for a VA range, but
  this is otherwise not harmful.

  But when intermediate levels of kernel page table are freed, the dump code
  will continue to use memory that has been freed and potentially
  reallocated for another purpose.  In such cases, the ptdump code may
  dereference bogus addresses, leading to a number of potential problems.

  To avoid the above mentioned race condition, platforms such as arm64,
  riscv and s390 take memory hotplug lock, while dumping kernel page table
  via the sysfs interface /sys/kernel/debug/kernel_page_tables.

  Similar race condition exists while checking for pages that might have
  been marked W+X via /sys/kernel/debug/kernel_page_tables/check_wx_pages
  which in turn calls ptdump_check_wx().  Instead of solving this race
  condition again, let's just move the memory hotplug lock inside generic
  ptdump_check_wx() which will benefit both the scenarios.

  Drop get_online_mems() and put_online_mems() combination from all existing
  platform ptdump code paths.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38681
weaknesses:
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/1636b5e9c3543b87d673e32a47e7c18698882425
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3ee9a8c27bfd72c3f465004fa8455785d61be5e8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/59305202c67fea50378dcad0cc199dbc13a0e99a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/67995d4244694928ce701928e530b5b4adeb17b4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/69bea84b06b5e779627e7afdbf4b60a7d231c76f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac25ec5fa2bf6e606dc7954488e4dded272fa9cd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca8c414499f2e5337a95a76be0d21b728ee31c6b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff40839e018b82c4d756d035f34a63aa2d93be83
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38681
    reference_type:
    reference_id: CVE-2025-38681
