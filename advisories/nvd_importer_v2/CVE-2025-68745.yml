advisory_id: CVE-2025-68745
datasource_id: nvd_importer_v2/CVE-2025-68745
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68745
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: qla2xxx: Clear cmds after chip reset

  Commit aefed3e5548f ("scsi: qla2xxx: target: Fix offline port handling
  and host reset handling") caused two problems:

  1. Commands sent to FW, after chip reset got stuck and never freed as FW
     is not going to respond to them anymore.

  2. BUG_ON(cmd->sg_mapped) in qlt_free_cmd().  Commit 26f9ce53817a
     ("scsi: qla2xxx: Fix missed DMA unmap for aborted commands")
     attempted to fix this, but introduced another bug under different
     circumstances when two different CPUs were racing to call
     qlt_unmap_sg() at the same time: BUG_ON(!valid_dma_direction(dir)) in
     dma_unmap_sg_attrs().

  So revert "scsi: qla2xxx: Fix missed DMA unmap for aborted commands" and
  partially revert "scsi: qla2xxx: target: Fix offline port handling and
  host reset handling" at __qla2x00_abort_all_cmds.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/5c1fb3fd05da3d55b8cbc42d7d660b313cbdc936
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d46c69a087aa3d1513f7a78f871b80251ea0c1ae
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68745
    reference_type:
    reference_id: CVE-2025-68745
