advisory_id: CVE-2022-49959
datasource_id: nvd_importer_v2/CVE-2022-49959
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49959
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  openvswitch: fix memory leak at failed datapath creation

  ovs_dp_cmd_new()->ovs_dp_change()->ovs_dp_set_upcall_portids()
  allocates array via kmalloc.
  If for some reason new_vport() fails during ovs_dp_cmd_new()
  dp->upcall_portids must be freed.
  Add missing kfree.

  Kmemleak example:
  unreferenced object 0xffff88800c382500 (size 64):
    comm "dump_state", pid 323, jiffies 4294955418 (age 104.347s)
    hex dump (first 32 bytes):
      5e c2 79 e4 1f 7a 38 c7 09 21 38 0c 80 88 ff ff  ^.y..z8..!8.....
      03 00 00 00 0a 00 00 00 14 00 00 00 28 00 00 00  ............(...
    backtrace:
      [<0000000071bebc9f>] ovs_dp_set_upcall_portids+0x38/0xa0
      [<000000000187d8bd>] ovs_dp_change+0x63/0xe0
      [<000000002397e446>] ovs_dp_cmd_new+0x1f0/0x380
      [<00000000aa06f36e>] genl_family_rcv_msg_doit+0xea/0x150
      [<000000008f583bc4>] genl_rcv_msg+0xdc/0x1e0
      [<00000000fa10e377>] netlink_rcv_skb+0x50/0x100
      [<000000004959cece>] genl_rcv+0x24/0x40
      [<000000004699ac7f>] netlink_unicast+0x23e/0x360
      [<00000000c153573e>] netlink_sendmsg+0x24e/0x4b0
      [<000000006f4aa380>] sock_sendmsg+0x62/0x70
      [<00000000d0068654>] ____sys_sendmsg+0x230/0x270
      [<0000000012dacf7d>] ___sys_sendmsg+0x88/0xd0
      [<0000000011776020>] __sys_sendmsg+0x59/0xa0
      [<000000002e8f2dc1>] do_syscall_64+0x3b/0x90
      [<000000003243e7cb>] entry_SYSCALL_64_after_hwframe+0x63/0xcd
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49959
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/a87406f4adee9c53b311d8a1ba2849c69e29a6d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c0c1c0241917459644326a1a3102207c871ae159
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca54b2bfaab385778e55a9fd33f6c31e7f743b48
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49959
    reference_type:
    reference_id: CVE-2022-49959
