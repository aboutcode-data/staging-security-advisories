advisory_id: CVE-2022-49378
datasource_id: nvd_importer_v2/CVE-2022-49378
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49378
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sfc: fix considering that all channels have TX queues

  Normally, all channels have RX and TX queues, but this is not true if
  modparam efx_separate_tx_channels=1 is used. In that cases, some
  channels only have RX queues and others only TX queues (or more
  preciselly, they have them allocated, but not initialized).

  Fix efx_channel_has_tx_queues to return the correct value for this case
  too.

  Messages shown at probe time before the fix:
   sfc 0000:03:00.0 ens6f0np0: MC command 0x82 inlen 544 failed rc=-22 (raw=0) arg=0
   ------------[ cut here ]------------
   netdevice: ens6f0np0: failed to initialise TXQ -1
   WARNING: CPU: 1 PID: 626 at drivers/net/ethernet/sfc/ef10.c:2393 efx_ef10_tx_init+0x201/0x300 [sfc]
   [...] stripped
   RIP: 0010:efx_ef10_tx_init+0x201/0x300 [sfc]
   [...] stripped
   Call Trace:
    efx_init_tx_queue+0xaa/0xf0 [sfc]
    efx_start_channels+0x49/0x120 [sfc]
    efx_start_all+0x1f8/0x430 [sfc]
    efx_net_open+0x5a/0xe0 [sfc]
    __dev_open+0xd0/0x190
    __dev_change_flags+0x1b3/0x220
    dev_change_flags+0x21/0x60
   [...] stripped

  Messages shown at remove time before the fix:
   sfc 0000:03:00.0 ens6f0np0: failed to flush 10 queues
   sfc 0000:03:00.0 ens6f0np0: failed to flush queues
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49378
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2e102b53f8a778f872dc137f4c7ac548705817aa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5567d69b95b9c07e1c56f15cf0301251d12e5f97
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8f81a4113e1e574d2cbde4f2cd599380a9189c0f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/913d45f02d346ce41c4aad057eaf53a8ed449dc3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e7e8d5e25dc762b70f9c88ec6b7d451d0816eead
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.5:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.5:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.5:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.5:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.5:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.5:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.5:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.5:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.5:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.5:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.5:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.5:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49378
    reference_type:
    reference_id: CVE-2022-49378
