advisory_id: CVE-2025-37958
datasource_id: nvd_importer_v2/CVE-2025-37958
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37958
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/huge_memory: fix dereferencing invalid pmd migration entry

  When migrating a THP, concurrent access to the PMD migration entry during
  a deferred split scan can lead to an invalid address access, as
  illustrated below.  To prevent this invalid access, it is necessary to
  check the PMD migration entry and return early.  In this context, there is
  no need to use pmd_to_swp_entry and pfn_swap_entry_to_page to verify the
  equality of the target folio.  Since the PMD migration entry is locked, it
  cannot be served as the target.

  Mailing list discussion and explanation from Hugh Dickins: "An anon_vma
  lookup points to a location which may contain the folio of interest, but
  might instead contain another folio: and weeding out those other folios is
  precisely what the "folio != pmd_folio((*pmd)" check (and the "risk of
  replacing the wrong folio" comment a few lines above it) is for."

  BUG: unable to handle page fault for address: ffffea60001db008
  CPU: 0 UID: 0 PID: 2199114 Comm: tee Not tainted 6.14.0+ #4 NONE
  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
  RIP: 0010:split_huge_pmd_locked+0x3b5/0x2b60
  Call Trace:
  <TASK>
  try_to_migrate_one+0x28c/0x3730
  rmap_walk_anon+0x4f6/0x770
  unmap_folio+0x196/0x1f0
  split_huge_page_to_list_to_order+0x9f6/0x1560
  deferred_split_scan+0xac5/0x12a0
  shrinker_debugfs_scan_write+0x376/0x470
  full_proxy_write+0x15c/0x220
  vfs_write+0x2fc/0xcb0
  ksys_write+0x146/0x250
  do_syscall_64+0x6a/0x120
  entry_SYSCALL_64_after_hwframe+0x76/0x7e

  The bug is found by syzkaller on an internal kernel, then confirmed on
  upstream.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37958
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/22f6368768340260e862f35151d2e1c55cb1dc75
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3977946f61cdba87b6b5aaf7d7094e96089583a5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6166c3cf405441f7147b322980144feb3cefc617
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/753f142f7ff7d2223a47105b61e1efd91587d711
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9468afbda3fbfcec21ac8132364dff3dab945faf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/be6e843fc51a584672dfd9c4a6a24c8cb81d5fb7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ef5706bed97e240b4abf4233ceb03da7336bc775
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fbab262b0c8226c697af1851a424896ed47dedcc
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37958
    reference_type:
    reference_id: CVE-2025-37958
