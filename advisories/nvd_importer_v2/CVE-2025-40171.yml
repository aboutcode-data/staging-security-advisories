advisory_id: CVE-2025-40171
datasource_id: nvd_importer_v2/CVE-2025-40171
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40171
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nvmet-fc: move lsop put work to nvmet_fc_ls_req_op

  Itâ€™s possible for more than one async command to be in flight from
  __nvmet_fc_send_ls_req. For each command, a tgtport reference is taken.

  In the current code, only one put work item is queued at a time, which
  results in a leaked reference.

  To fix this, move the work item to the nvmet_fc_ls_req_op struct, which
  already tracks all resources related to the command.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/060ecc81240ef9d60d9485a3a5eb55a0d6e7a25c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/11269c08013f4ee8b8f5edc6c56700acb34092d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7331925c247b03b7767b8cd93cfe1b7aa2377850
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7a619f8c869117ffed08365b377f66b7e1d941b4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a28112cc55013cd8cbd5d36b5115a5b851151bd9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db5a5406fb7e5337a074385c7a3e53c77f2c1bd3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40171
    reference_type:
    reference_id: CVE-2025-40171
