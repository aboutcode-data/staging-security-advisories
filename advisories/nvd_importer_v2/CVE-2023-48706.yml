advisory_id: CVE-2023-48706
datasource_id: nvd_importer_v2/CVE-2023-48706
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-48706
aliases: []
summary: Vim is a UNIX editor that, prior to version 9.0.2121, has a heap-use-after-free vulnerability.
  When executing a `:s` command for the very first time and using a sub-replace-special atom
  inside the substitution part, it is possible that the recursive `:s` call causes free-ing
  of memory which may later then be accessed by the initial `:s` command. The user must intentionally
  execute the payload and the whole process is a bit tricky to do since it seems to work only
  reliably for the very first :s command. It may also cause a crash of Vim. Version 9.0.2121
  contains a fix for this issue.
impacted_packages: []
severities:
  - score: '3.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-48706
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-48706
weaknesses:
  - CWE-416
references:
  - url: https://github.com/gandalf4a/crash_report/blob/main/vim/vim_huaf
    reference_type:
    reference_id:
  - url: https://github.com/vim/vim/commit/26c11c56888d01e298cd8044caf860f3c26f57bb
    reference_type:
    reference_id:
  - url: https://github.com/vim/vim/pull/13552
    reference_type:
    reference_id:
  - url: https://github.com/vim/vim/security/advisories/GHSA-c8qm-x72m-q53q
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DNMFS3IH74KEMMESOA3EOB6MZ56TWGFF/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/IVA7K73WHQH4KVFDJQ7ELIUD2WK5ZT5E/
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240105-0001/
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/11/22/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vim:vim:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:vim:vim:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-48706
    reference_type:
    reference_id: CVE-2023-48706
