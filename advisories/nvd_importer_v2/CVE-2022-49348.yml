advisory_id: CVE-2022-49348
datasource_id: nvd_importer_v2/CVE-2022-49348
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49348
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: filter out EXT4_FC_REPLAY from on-disk superblock field s_state

  The EXT4_FC_REPLAY bit in sbi->s_mount_state is used to indicate that
  we are in the middle of replay the fast commit journal.  This was
  actually a mistake, since the sbi->s_mount_info is initialized from
  es->s_state.  Arguably s_mount_state is misleadingly named, but the
  name is historical --- s_mount_state and s_state dates back to ext2.

  What should have been used is the ext4_{set,clear,test}_mount_flag()
  inline functions, which sets EXT4_MF_* bits in sbi->s_mount_flags.

  The problem with using EXT4_FC_REPLAY is that a maliciously corrupted
  superblock could result in EXT4_FC_REPLAY getting set in
  s_mount_state.  This bypasses some sanity checks, and this can trigger
  a BUG() in ext4_es_cache_extent().  As a easy-to-backport-fix, filter
  out the EXT4_FC_REPLAY bit for now.  We should eventually transition
  away from EXT4_FC_REPLAY to something like EXT4_MF_REPLAY.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49348
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/55b4dbb29054a05d839562f6d635ce05669b016d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/af2f1932743fb52ebcb008ad7ac500d9df0aa796
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b99fd73418350dea360da8311e87a6a7b0e15a4c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c878bea3c9d724ddfa05a813f30de3d25a0ba83f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cc5b09cb6dacd4b32640537929ab4ee8fb2b9e04
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49348
    reference_type:
    reference_id: CVE-2022-49348
