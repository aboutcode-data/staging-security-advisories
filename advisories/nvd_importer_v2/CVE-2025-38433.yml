advisory_id: CVE-2025-38433
datasource_id: nvd_importer_v2/CVE-2025-38433
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38433
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  riscv: fix runtime constant support for nommu kernels

  the `__runtime_fixup_32` function does not handle the case where `val` is
  zero correctly (as might occur when patching a nommu kernel and referring
  to a physical address below the 4GiB boundary whose upper 32 bits are all
  zero) because nothing in the existing logic prevents the code from taking
  the `else` branch of both nop-checks and emitting two `nop` instructions.

  This leaves random garbage in the register that is supposed to receive the
  upper 32 bits of the pointer instead of zero that when combined with the
  value for the lower 32 bits yields an invalid pointer and causes a kernel
  panic when that pointer is eventually accessed.

  The author clearly considered the fact that if the `lui` is converted into
  a `nop` that the second instruction needs to be adjusted to become an `li`
  instead of an `addi`, hence introducing the `addi_insn_mask` variable, but
  didn't follow that logic through fully to the case where the `else` branch
  executes. To fix it just adjust the logic to ensure that the second `else`
  branch is not taken if the first instruction will be patched to a `nop`.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38433
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/0a24b00dcde83934a3cc13e4c6b775522903496b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8d90d9872edae7e78c3a12b98e239bfaa66f3639
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38433
    reference_type:
    reference_id: CVE-2025-38433
