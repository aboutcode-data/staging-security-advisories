advisory_id: CVE-2021-47616
datasource_id: nvd_importer_v2/CVE-2021-47616
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47616
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  RDMA: Fix use-after-free in rxe_queue_cleanup

  On error handling path in rxe_qp_from_init() qp->sq.queue is freed and
  then rxe_create_qp() will drop last reference to this object. qp clean up
  function will try to free this queue one time and it causes UAF bug.

  Fix it by zeroing queue pointer after freeing queue in rxe_qp_from_init().
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47616
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/84b01721e8042cdd1e8ffeb648844a09cd4213e0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/acb53e47db1fbc7cd37ab10b46388f045a76e383
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47616
    reference_type:
    reference_id: CVE-2021-47616
