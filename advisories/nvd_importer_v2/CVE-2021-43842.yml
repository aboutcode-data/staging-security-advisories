advisory_id: CVE-2021-43842
datasource_id: nvd_importer_v2/CVE-2021-43842
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-43842
aliases: []
summary: Wiki.js is a wiki app built on Node.js. Wiki.js versions 2.5.257 and earlier are vulnerable
  to stored cross-site scripting through a SVG file upload. By creating a crafted SVG file,
  a malicious Wiki.js user may stage a stored cross-site scripting attack. This allows the attacker
  to execute malicious JavaScript when the SVG is viewed directly by other users. Scripts do
  not execute when loaded inside a page via normal `<img>` tags. Commit 5d3e81496fba1f0fbd64eeb855f30f69a9040718
  fixes this vulnerability by adding an optional (enabled by default) SVG sanitization step
  to all file uploads that match the SVG mime type. As a workaround, disable file upload for
  all non-trusted users. Wiki.js version 2.5.260 is the first production version to contain
  a patch. Version 2.5.258 is the first development build to contain a patch and is available
  only as a Docker image as requarks/wiki:canary-2.5.258.
impacted_packages: []
severities:
  - score: '3.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43842
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43842
weaknesses:
  - CWE-79
references:
  - url: https://github.com/Requarks/wiki/commit/5d3e81496fba1f0fbd64eeb855f30f69a9040718
    reference_type:
    reference_id:
  - url: https://github.com/Requarks/wiki/releases/tag/2.5.260
    reference_type:
    reference_id:
  - url: https://github.com/Requarks/wiki/security/advisories/GHSA-3qv4-gp35-rgh7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:requarks:wiki.js:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:requarks:wiki.js:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43842
    reference_type:
    reference_id: CVE-2021-43842
