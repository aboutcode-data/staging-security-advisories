advisory_id: CVE-2024-57917
datasource_id: nvd_importer_v2/CVE-2024-57917
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-57917
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  topology: Keep the cpumask unchanged when printing cpumap

  During fuzz testing, the following warning was discovered:

   different return values (15 and 11) from vsnprintf("%*pbl
   ", ...)

   test:keyward is WARNING in kvasprintf
   WARNING: CPU: 55 PID: 1168477 at lib/kasprintf.c:30 kvasprintf+0x121/0x130
   Call Trace:
    kvasprintf+0x121/0x130
    kasprintf+0xa6/0xe0
    bitmap_print_to_buf+0x89/0x100
    core_siblings_list_read+0x7e/0xb0
    kernfs_file_read_iter+0x15b/0x270
    new_sync_read+0x153/0x260
    vfs_read+0x215/0x290
    ksys_read+0xb9/0x160
    do_syscall_64+0x56/0x100
    entry_SYSCALL_64_after_hwframe+0x78/0xe2

  The call trace shows that kvasprintf() reported this warning during the
  printing of core_siblings_list. kvasprintf() has several steps:

   (1) First, calculate the length of the resulting formatted string.

   (2) Allocate a buffer based on the returned length.

   (3) Then, perform the actual string formatting.

   (4) Check whether the lengths of the formatted strings returned in
       steps (1) and (2) are consistent.

  If the core_cpumask is modified between steps (1) and (3), the lengths
  obtained in these two steps may not match. Indeed our test includes cpu
  hotplugging, which should modify core_cpumask while printing.

  To fix this issue, cache the cpumask into a temporary variable before
  calling cpumap_print_{list, cpumask}_to_buf(), to keep it unchanged
  during the printing process.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-57917
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1c7818e2746e747838a3de1687e89eac7b947f08
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/360596e7fe319a5db1b5fb34a3952862ae53c924
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b02cf1d27e460ab2b3e1c8c9ce472d562cad2e8d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca47e933a900492d89dcf5db18a99c28bd4a742d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cbd399f78e23ad4492c174fc5e6b3676dba74a52
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-57917
    reference_type:
    reference_id: CVE-2024-57917
