advisory_id: CVE-2025-38700
datasource_id: nvd_importer_v2/CVE-2025-38700
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38700
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: libiscsi: Initialize iscsi_conn->dd_data only if memory is allocated

  In case of an ib_fast_reg_mr allocation failure during iSER setup, the
  machine hits a panic because iscsi_conn->dd_data is initialized
  unconditionally, even when no memory is allocated (dd_size == 0).  This
  leads invalid pointer dereference during connection teardown.

  Fix by setting iscsi_conn->dd_data only if memory is actually allocated.

  Panic trace:
  ------------
   iser: iser_create_fastreg_desc: Failed to allocate ib_fast_reg_mr err=-12
   iser: iser_alloc_rx_descriptors: failed allocating rx descriptors / data buffers
   BUG: unable to handle page fault for address: fffffffffffffff8
   RIP: 0010:swake_up_locked.part.5+0xa/0x40
   Call Trace:
    complete+0x31/0x40
    iscsi_iser_conn_stop+0x88/0xb0 [ib_iser]
    iscsi_stop_conn+0x66/0xc0 [scsi_transport_iscsi]
    iscsi_if_stop_conn+0x14a/0x150 [scsi_transport_iscsi]
    iscsi_if_rx+0x1135/0x1834 [scsi_transport_iscsi]
    ? netlink_lookup+0x12f/0x1b0
    ? netlink_deliver_tap+0x2c/0x200
    netlink_unicast+0x1ab/0x280
    netlink_sendmsg+0x257/0x4f0
    ? _copy_from_user+0x29/0x60
    sock_sendmsg+0x5f/0x70
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38700
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/2b242ea14386a510010eabfbfc3ce81a101f3802
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35782c32528d82aa21f84cb5ceb2abd3526a8159
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3ea3a256ed81f95ab0f3281a0e234b01a9cae605
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/66a373f50b4249d57f5a88c7be9676f9d5884865
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ea6d961566c7d762ed0204b06db05756fdda3b6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a145c269dc5380c063a20a0db7e6df2995962e9d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a33d42b7fc24fe03f239fbb0880dd5b4b4b97c19
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f53af99f441ee79599d8df6113a7144d74cf9153
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fd5aad080edb501ab5c84b7623d612d0e3033403
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38700
    reference_type:
    reference_id: CVE-2025-38700
