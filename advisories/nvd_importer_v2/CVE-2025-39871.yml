advisory_id: CVE-2025-39871
datasource_id: nvd_importer_v2/CVE-2025-39871
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39871
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dmaengine: idxd: Remove improper idxd_free

  The call to idxd_free() introduces a duplicate put_device() leading to a
  reference count underflow:
  refcount_t: underflow; use-after-free.
  WARNING: CPU: 15 PID: 4428 at lib/refcount.c:28 refcount_warn_saturate+0xbe/0x110
  ...
  Call Trace:
   <TASK>
    idxd_remove+0xe4/0x120 [idxd]
    pci_device_remove+0x3f/0xb0
    device_release_driver_internal+0x197/0x200
    driver_detach+0x48/0x90
    bus_remove_driver+0x74/0xf0
    pci_unregister_driver+0x2e/0xb0
    idxd_exit_module+0x34/0x7a0 [idxd]
    __do_sys_delete_module.constprop.0+0x183/0x280
    do_syscall_64+0x54/0xd70
    entry_SYSCALL_64_after_hwframe+0x76/0x7e

  The idxd_unregister_devices() which is invoked at the very beginning of
  idxd_remove(), already takes care of the necessary put_device() through the
  following call path:
  idxd_unregister_devices() -> device_unregister() -> put_device()

  In addition, when CONFIG_DEBUG_KOBJECT_RELEASE is enabled, put_device() may
  trigger asynchronous cleanup via schedule_delayed_work(). If idxd_free() is
  called immediately after, it can result in a use-after-free.

  Remove the improper idxd_free() to avoid both the refcount underflow and
  potential memory corruption during module unload.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39871
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/0e95ee7f532b21206fe3f1c4054002b0d21e3b9c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/24414bbcb37e1af95190af36c21ae51d497e1a9e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/da4fbc1488a4cec6748da685181ee4449a878dac
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd7a7e43269711d757fc260b0bbdf7138f75de11
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f41c538881eec4dcf5961a242097d447f848cda6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39871
    reference_type:
    reference_id: CVE-2025-39871
