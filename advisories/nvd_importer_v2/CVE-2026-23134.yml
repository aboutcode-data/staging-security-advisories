advisory_id: CVE-2026-23134
datasource_id: nvd_importer_v2/CVE-2026-23134
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23134
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  slab: fix kmalloc_nolock() context check for PREEMPT_RT

  On PREEMPT_RT kernels, local_lock becomes a sleeping lock. The current
  check in kmalloc_nolock() only verifies we're not in NMI or hard IRQ
  context, but misses the case where preemption is disabled.

  When a BPF program runs from a tracepoint with preemption disabled
  (preempt_count > 0), kmalloc_nolock() proceeds to call
  local_lock_irqsave() which attempts to acquire a sleeping lock,
  triggering:

    BUG: sleeping function called from invalid context
    in_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 6128
    preempt_count: 2, expected: 0

  Fix this by checking !preemptible() on PREEMPT_RT, which directly
  expresses the constraint that we cannot take a sleeping lock when
  preemption is disabled. This encompasses the previous checks for NMI
  and hard IRQ contexts while also catching cases where preemption is
  disabled.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/99a3e3a1cfc93b8fe318c0a3a5cfb01f1d4ad53c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f60ba4a97ae3f94e4818722ed2e4d260bbb17b44
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23134
    reference_type:
    reference_id: CVE-2026-23134
