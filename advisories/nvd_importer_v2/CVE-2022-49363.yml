advisory_id: CVE-2022-49363
datasource_id: nvd_importer_v2/CVE-2022-49363
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49363
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  f2fs: fix to do sanity check on block address in f2fs_do_zero_range()

  As Yanming reported in bugzilla:

  https://bugzilla.kernel.org/show_bug.cgi?id=215894

  I have encountered a bug in F2FS file system in kernel v5.17.

  I have uploaded the system call sequence as case.c, and a fuzzed image can
  be found in google net disk

  The kernel should enable CONFIG_KASAN=y and CONFIG_KASAN_INLINE=y. You can
  reproduce the bug by running the following commands:

  kernel BUG at fs/f2fs/segment.c:2291!
  Call Trace:
   f2fs_invalidate_blocks+0x193/0x2d0
   f2fs_fallocate+0x2593/0x4a70
   vfs_fallocate+0x2a5/0xac0
   ksys_fallocate+0x35/0x70
   __x64_sys_fallocate+0x8e/0xf0
   do_syscall_64+0x3b/0x90
   entry_SYSCALL_64_after_hwframe+0x44/0xae

  The root cause is, after image was fuzzed, block mapping info in inode
  will be inconsistent with SIT table, so in f2fs_fallocate(), it will cause
  panic when updating SIT with invalid blkaddr.

  Let's fix the issue by adding sanity check on block address before updating
  SIT table with it.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49363
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/25f8236213a91efdf708b9d77e9e51b6fc3e141c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/470493be19a5730ed432e3ac0f29a2ee7fc6c557
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7361c9f2bd6a8f0cbb41cdea9aff04765ff23f67
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/805b48b234a2803cb7daec7f158af12f0fbaefac
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a34d7b49894b0533222188a52e2958750f830efd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f2e1c38b5ac64eb1a16a89c52fb419409d12c25b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49363
    reference_type:
    reference_id: CVE-2022-49363
