advisory_id: CVE-2023-52501
datasource_id: nvd_importer_v2/CVE-2023-52501
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-52501
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ring-buffer: Do not attempt to read past "commit"

  When iterating over the ring buffer while the ring buffer is active, the
  writer can corrupt the reader. There's barriers to help detect this and
  handle it, but that code missed the case where the last event was at the
  very end of the page and has only 4 bytes left.

  The checks to detect the corruption by the writer to reads needs to see the
  length of the event. If the length in the first 4 bytes is zero then the
  length is stored in the second 4 bytes. But if the writer is in the process
  of updating that code, there's a small window where the length in the first
  4 bytes could be zero even though the length is only 4 bytes. That will
  cause rb_event_length() to read the next 4 bytes which could happen to be off the
  allocated page.

  To protect against this, fail immediately if the next event pointer is
  less than 8 bytes from the end of the commit (last byte of data), as all
  events must be a minimum of 8 bytes anyway.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52501
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/344f2f3e61a90f0150c754796ec9a17fcaeec03d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/75fc9e99b3a71006720ad1e029db11a4b5c32d4a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95a404bd60af6c4d9d8db01ad14fe8957ece31ca
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b08a4938229dbb530a35c41b83002a1457c6ff49
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cee5151c5410e868826b8afecfb356f3799ebea3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.6:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.6:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52501
    reference_type:
    reference_id: CVE-2023-52501
