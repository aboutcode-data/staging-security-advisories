advisory_id: CVE-2024-26678
datasource_id: nvd_importer_v2/CVE-2024-26678
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26678
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/efistub: Use 1:1 file:memory mapping for PE/COFF .compat section

  The .compat section is a dummy PE section that contains the address of
  the 32-bit entrypoint of the 64-bit kernel image if it is bootable from
  32-bit firmware (i.e., CONFIG_EFI_MIXED=y)

  This section is only 8 bytes in size and is only referenced from the
  loader, and so it is placed at the end of the memory view of the image,
  to avoid the need for padding it to 4k, which is required for sections
  appearing in the middle of the image.

  Unfortunately, this violates the PE/COFF spec, and even if most EFI
  loaders will work correctly (including the Tianocore reference
  implementation), PE loaders do exist that reject such images, on the
  basis that both the file and memory views of the file contents should be
  described by the section headers in a monotonically increasing manner
  without leaving any gaps.

  So reorganize the sections to avoid this issue. This results in a slight
  padding overhead (< 4k) which can be avoided if desired by disabling
  CONFIG_EFI_MIXED (which is only needed in rare cases these days)
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26678
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/0a962f2fbaa976af9eed21d0306370cded485787
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1ad55cecf22f05f1c884adf63cc09d3c3e609ebf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4adeeff8c12321cd453412a659c3c0eeb9bb2397
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d327e961573fc335af0ae8a160302205327e1f4e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26678
    reference_type:
    reference_id: CVE-2024-26678
