advisory_id: CVE-2024-56620
datasource_id: nvd_importer_v2/CVE-2024-56620
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-56620
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: ufs: qcom: Only free platform MSIs when ESI is enabled

  Otherwise, it will result in a NULL pointer dereference as below:

  Unable to handle kernel NULL pointer dereference at virtual address 0000000000000008
  Call trace:
   mutex_lock+0xc/0x54
   platform_device_msi_free_irqs_all+0x14/0x20
   ufs_qcom_remove+0x34/0x48 [ufs_qcom]
   platform_remove+0x28/0x44
   device_remove+0x4c/0x80
   device_release_driver_internal+0xd8/0x178
   driver_detach+0x50/0x9c
   bus_remove_driver+0x6c/0xbc
   driver_unregister+0x30/0x60
   platform_driver_unregister+0x14/0x20
   ufs_qcom_pltform_exit+0x18/0xb94 [ufs_qcom]
   __arm64_sys_delete_module+0x180/0x260
   invoke_syscall+0x44/0x100
   el0_svc_common.constprop.0+0xc0/0xe0
   do_el0_svc+0x1c/0x28
   el0_svc+0x34/0xdc
   el0t_64_sync_handler+0xc0/0xc4
   el0t_64_sync+0x190/0x194
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56620
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/64506b3d23a337e98a74b18dcb10c8619365f2bd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f16a097047e38dcdd169a15e3eed1b2f2147a2e7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f99cb5f6344ef93777fd3add7979ebf291a852df
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56620
    reference_type:
    reference_id: CVE-2024-56620
