advisory_id: CVE-2024-56694
datasource_id: nvd_importer_v2/CVE-2024-56694
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-56694
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: fix recursive lock when verdict program return SK_PASS

  When the stream_verdict program returns SK_PASS, it places the received skb
  into its own receive queue, but a recursive lock eventually occurs, leading
  to an operating system deadlock. This issue has been present since v6.9.

  '''
  sk_psock_strp_data_ready
      write_lock_bh(&sk->sk_callback_lock)
      strp_data_ready
        strp_read_sock
          read_sock -> tcp_read_sock
            strp_recv
              cb.rcv_msg -> sk_psock_strp_read
                # now stream_verdict return SK_PASS without peer sock assign
                __SK_PASS = sk_psock_map_verd(SK_PASS, NULL)
                sk_psock_verdict_apply
                  sk_psock_skb_ingress_self
                    sk_psock_skb_ingress_enqueue
                      sk_psock_data_ready
                        read_lock_bh(&sk->sk_callback_lock) <= dead lock

  '''

  This topic has been discussed before, but it has not been fixed.
  Previous discussion:
  https://lore.kernel.org/all/6684a5864ec86_403d20898@john.notmuch
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56694
weaknesses:
  - CWE-667
references:
  - url: https://git.kernel.org/stable/c/01f1b88acfd79103da0610b45471f6c88ea98d72
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/221109ba2127eabd0aa64718543638b58b15df56
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/386efa339e08563dd33e83bc951aea5d407fe578
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6694f7acd625ed854bf6342926e771d65dad7f69
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8ca2a1eeadf09862190b2810697702d803ceef2d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/da2bc8a0c8f3ac66fdf980fc59936f851a083561
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f84c5ef6ca23cc2f72f3b830d74f67944684bb05
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56694
    reference_type:
    reference_id: CVE-2024-56694
