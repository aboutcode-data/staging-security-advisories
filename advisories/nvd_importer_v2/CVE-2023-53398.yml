advisory_id: CVE-2023-53398
datasource_id: nvd_importer_v2/CVE-2023-53398
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53398
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mlx5: fix possible ptp queue fifo use-after-free

  Fifo indexes are not checked during pop operations and it leads to
  potential use-after-free when poping from empty queue. Such case was
  possible during re-sync action. WARN_ON_ONCE covers future cases.

  There were out-of-order cqe spotted which lead to drain of the queue and
  use-after-free because of lack of fifo pointers check. Special check and
  counter are added to avoid resync operation if SKB could not exist in the
  fifo because of OOO cqe (skb_id must be between consumer and producer
  index).
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53398
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/3a50cf1e8e5157b82268eee7e330dbe5736a0948
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/52e6e7a0bc04c85012a9251c7cf2d444a77eb966
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6afdedc4e66e3846ce497744f01b95c34bf39d21
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53398
    reference_type:
    reference_id: CVE-2023-53398
