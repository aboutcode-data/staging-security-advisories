advisory_id: CVE-2022-50117
datasource_id: nvd_importer_v2/CVE-2022-50117
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50117
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  vfio: Split migration ops from main device ops

  vfio core checks whether the driver sets some migration op (e.g.
  set_state/get_state) and accordingly calls its op.

  However, currently mlx5 driver sets the above ops without regards to its
  migration caps.

  This might lead to unexpected usage/Oops if user space may call to the
  above ops even if the driver doesn't support migration. As for example,
  the migration state_mutex is not initialized in that case.

  The cleanest way to manage that seems to split the migration ops from
  the main device ops, this will let the driver setting them separately
  from the main ops when it's applicable.

  As part of that, validate ops construction on registration and include a
  check for VFIO_MIGRATION_STOP_COPY since the uAPI claims it must be set
  in migration_flags.

  HISI driver was changed as well to match this scheme.

  This scheme may enable down the road to come with some extra group of
  ops (e.g. DMA log) that can be set without regards to the other options
  based on driver caps.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50117
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/6e97eba8ad8748fabb795cffc5d9e1a7dcfd7367
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bba6b12d73d36e0ddbc2c3ac5668a667b00d4345
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50117
    reference_type:
    reference_id: CVE-2022-50117
