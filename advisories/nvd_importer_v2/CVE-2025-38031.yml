advisory_id: CVE-2025-38031
datasource_id: nvd_importer_v2/CVE-2025-38031
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38031
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  padata: do not leak refcount in reorder_work

  A recent patch that addressed a UAF introduced a reference count leak:
  the parallel_data refcount is incremented unconditionally, regardless
  of the return value of queue_work(). If the work item is already queued,
  the incremented refcount is never decremented.

  Fix this by checking the return value of queue_work() and decrementing
  the refcount when necessary.

  Resolves:

  Unreferenced object 0xffff9d9f421e3d80 (size 192):
    comm "cryptomgr_probe", pid 157, jiffies 4294694003
    hex dump (first 32 bytes):
      80 8b cf 41 9f 9d ff ff b8 97 e0 89 ff ff ff ff  ...A............
      d0 97 e0 89 ff ff ff ff 19 00 00 00 1f 88 23 00  ..............#.
    backtrace (crc 838fb36):
      __kmalloc_cache_noprof+0x284/0x320
      padata_alloc_pd+0x20/0x1e0
      padata_alloc_shell+0x3b/0xa0
      0xffffffffc040a54d
      cryptomgr_probe+0x43/0xc0
      kthread+0xf6/0x1f0
      ret_from_fork+0x2f/0x50
      ret_from_fork_asm+0x1a/0x30
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38031
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1a426abdf1c86882c9203dd8182f3b8274b89938
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1c65ae4988714716101555fe2b9830e33136d6fb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5300e487487d7a2e3e1e6e9d8f03ed9452e4019e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/584a729615fa92f4de45480efb7e569d14be1516
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b9ad8e50e8589607e68e6c4cefa7f72bf35a2cb1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cceb15864e1612ebfbc10ec4e4dcd19a10c0056c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d6ebcde6d4ecf34f8495fb30516645db3aea8993
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38031
    reference_type:
    reference_id: CVE-2025-38031
