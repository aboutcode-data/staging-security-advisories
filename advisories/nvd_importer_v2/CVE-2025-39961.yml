advisory_id: CVE-2025-39961
datasource_id: nvd_importer_v2/CVE-2025-39961
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39961
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\niommu/amd/pgtbl:\
  \ Fix possible race while increase page table level\n\nThe AMD IOMMU host page table implementation\
  \ supports dynamic page table levels\n(up to 6 levels), starting with a 3-level configuration\
  \ that expands based on\nIOVA address. The kernel maintains a root pointer and current page\
  \ table level\nto enable proper page table walks in alloc_pte()/fetch_pte() operations.\n\n\
  The IOMMU IOVA allocator initially starts with 32-bit address and onces its\nexhuasted it\
  \ switches to 64-bit address (max address is determined based\non IOMMU and device DMA capability).\
  \ To support larger IOVA, AMD IOMMU\ndriver increases page table level.\n\nBut in unmap path\
  \ (iommu_v1_unmap_pages()), fetch_pte() reads\npgtable->[root/mode] without lock. So its possible\
  \ that in exteme corner case,\nwhen increase_address_space() is updating pgtable->[root/mode],\
  \ fetch_pte()\nreads wrong page table level (pgtable->mode). It does compare the value with\n\
  level encoded in page table and returns NULL. This will result is\niommu_unmap ops to fail\
  \ and upper layer may retry/log WARN_ON.\n\nCPU 0                                        \
  \ CPU 1\n------                                       ------\nmap pages                  \
  \                  unmap pages\nalloc_pte() -> increase_address_space()      iommu_v1_unmap_pages()\
  \ -> fetch_pte()\n  pgtable->root = pte (new root value)\n                               \
  \              READ pgtable->[mode/root]\n\t\t\t\t\t       Reads new root, old mode\n  Updates\
  \ mode (pgtable->mode += 1)\n\nSince Page table level updates are infrequent and already synchronized\
  \ with a\nspinlock, implement seqcount to enable lock-free read operations on the read path."
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39961
weaknesses:
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/075abf0b1a958acfbea2435003d228e738e90346
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1e56310b40fd2e7e0b9493da9ff488af145bdd0c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7d462bdecb7d9c32934dab44aaeb7ea7d73a27a2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cd92c8ab336c3a633d46e6f35ebcd3509ae7db3b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.3:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.3:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.3:rc8:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.3:rc8:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39961
    reference_type:
    reference_id: CVE-2025-39961
