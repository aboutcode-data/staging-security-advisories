advisory_id: CVE-2025-38691
datasource_id: nvd_importer_v2/CVE-2025-38691
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38691
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  pNFS: Fix uninited ptr deref in block/scsi layout

  The error occurs on the third attempt to encode extents. When function
  ext_tree_prepare_commit() reallocates a larger buffer to retry encoding
  extents, the "layoutupdate_pages" page array is initialized only after the
  retry loop. But ext_tree_free_commitdata() is called on every iteration
  and tries to put pages in the array, thus dereferencing uninitialized
  pointers.

  An additional problem is that there is no limit on the maximum possible
  buffer_size. When there are too many extents, the client may create a
  layoutcommit that is larger than the maximum possible RPC size accepted
  by the server.

  During testing, we observed two typical scenarios. First, one memory page
  for extents is enough when we work with small files, append data to the
  end of the file, or preallocate extents before writing. But when we fill
  a new large file without preallocating, the number of extents can be huge,
  and counting the number of written extents in ext_tree_encode_commit()
  does not help much. Since this number increases even more between
  unlocking and locking of ext_tree, the reallocated buffer may not be
  large enough again and again.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38691
weaknesses:
  - CWE-908
references:
  - url: https://git.kernel.org/stable/c/24334f3cf8a294f253071b5bf22d754dbb6d0f2d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2896f101110076ac6bf99d7aaf463d61e26f89dd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/37c3443a2685528f972d910a6fb87716b96fef46
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4f783333cbfa2ee7d4aa8e47f6bd1b3f77534fcf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/579b85f893d9885162e1cabf99a4a088916e143e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/94ec6d939031a616474376dadbf4a8d0ef8b0bcc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9768797c219326699778fba9cd3b607b2f1e7950
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9be5c04beca3202d0a5f09fb4b2ecb644caa0bc5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f0b2eee3fbba9b7e3746ef698424ef5e4a197776
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38691
    reference_type:
    reference_id: CVE-2025-38691
