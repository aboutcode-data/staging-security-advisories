advisory_id: CVE-2026-23137
datasource_id: nvd_importer_v2/CVE-2026-23137
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23137
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  of: unittest: Fix memory leak in unittest_data_add()

  In unittest_data_add(), if of_resolve_phandles() fails, the allocated
  unittest_data is not freed, leading to a memory leak.

  Fix this by using scope-based cleanup helper __free(kfree) for automatic
  resource cleanup. This ensures unittest_data is automatically freed when
  it goes out of scope in error paths.

  For the success path, use retain_and_null_ptr() to transfer ownership
  of the memory to the device tree and prevent double freeing.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/235a1eb8d2dcc49a6cf0a5ee1aa85544a5d0054b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f09b0f705bd7197863b90256ef533a6414d1db2c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23137
    reference_type:
    reference_id: CVE-2026-23137
