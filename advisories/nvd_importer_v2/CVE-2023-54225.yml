advisory_id: CVE-2023-54225
datasource_id: nvd_importer_v2/CVE-2023-54225
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54225
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: ipa: only reset hashed tables when supported

  Last year, the code that manages GSI channel transactions switched
  from using spinlock-protected linked lists to using indexes into the
  ring buffer used for a channel.  Recently, Google reported seeing
  transaction reference count underflows occasionally during shutdown.

  Doug Anderson found a way to reproduce the issue reliably, and
  bisected the issue to the commit that eliminated the linked lists
  and the lock.  The root cause was ultimately determined to be
  related to unused transactions being committed as part of the modem
  shutdown cleanup activity.  Unused transactions are not normally
  expected (except in error cases).

  The modem uses some ranges of IPA-resident memory, and whenever it
  shuts down we zero those ranges.  In ipa_filter_reset_table() a
  transaction is allocated to zero modem filter table entries.  If
  hashing is not supported, hashed table memory should not be zeroed.
  But currently nothing prevents that, and the result is an unused
  transaction.  Something similar occurs when we zero routing table
  entries for the modem.

  By preventing any attempt to clear hashed tables when hashing is not
  supported, the reference count underflow is avoided in this case.

  Note that there likely remains an issue with properly freeing unused
  transactions (if they occur due to errors).  This patch addresses
  only the underflows that Google originally reported.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/50c24f0c940728792c8bdf65c1eaf6b91b3b0dcd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c00af3a818cc573e10100cc6770f0e47befa1fa4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e11ec2b868af2b351c6c1e2e50eb711cc5423a10
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54225
    reference_type:
    reference_id: CVE-2023-54225
