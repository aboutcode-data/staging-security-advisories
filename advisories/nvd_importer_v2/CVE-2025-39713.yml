advisory_id: CVE-2025-39713
datasource_id: nvd_importer_v2/CVE-2025-39713
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39713
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  media: rainshadow-cec: fix TOCTOU race condition in rain_interrupt()

  In the interrupt handler rain_interrupt(), the buffer full check on
  rain->buf_len is performed before acquiring rain->buf_lock. This
  creates a Time-of-Check to Time-of-Use (TOCTOU) race condition, as
  rain->buf_len is concurrently accessed and modified in the work
  handler rain_irq_work_handler() under the same lock.

  Multiple interrupt invocations can race, with each reading buf_len
  before it becomes full and then proceeding. This can lead to both
  interrupts attempting to write to the buffer, incrementing buf_len
  beyond its capacity (DATA_SIZE) and causing a buffer overflow.

  Fix this bug by moving the spin_lock() to before the buffer full
  check. This ensures that the check and the subsequent buffer modification
  are performed atomically, preventing the race condition. An corresponding
  spin_unlock() is added to the overflow path to correctly release the
  lock.

  This possible bug was found by an experimental static analysis tool
  developed by our team.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39713
weaknesses:
  - CWE-367
references:
  - url: https://git.kernel.org/stable/c/1c2769dc80255824542ea5a4ff1a07dcdeb1603f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2964dbe631fd21ad7873b1752b895548d3c12496
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3c3e33b7edca7a2d6a96801f287f9faeb684d655
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6aaef1a75985865d8c6c5b65fb54152060faba48
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7af160aea26c7dc9e6734d19306128cce156ec40
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ed905fe7cba03cf22ae0b84cf1b73cd1c070423a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fbc81e78d75bf28972bc22b1599559557b1a1b83
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff9dd3db6cd4c6b54a2ecbc58151bea4ec63bc59
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39713
    reference_type:
    reference_id: CVE-2025-39713
