advisory_id: CVE-2024-57899
datasource_id: nvd_importer_v2/CVE-2024-57899
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-57899
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: mac80211: fix mbss changed flags corruption on 32 bit systems

  On 32-bit systems, the size of an unsigned long is 4 bytes,
  while a u64 is 8 bytes. Therefore, when using
  or_each_set_bit(bit, &bits, sizeof(changed) * BITS_PER_BYTE),
  the code is incorrectly searching for a bit in a 32-bit
  variable that is expected to be 64 bits in size,
  leading to incorrect bit finding.

  Solution: Ensure that the size of the bits variable is correctly
  adjusted for each architecture.

   Call Trace:
    ? show_regs+0x54/0x58
    ? __warn+0x6b/0xd4
    ? ieee80211_link_info_change_notify+0xcc/0xd4 [mac80211]
    ? report_bug+0x113/0x150
    ? exc_overflow+0x30/0x30
    ? handle_bug+0x27/0x44
    ? exc_invalid_op+0x18/0x50
    ? handle_exception+0xf6/0xf6
    ? exc_overflow+0x30/0x30
    ? ieee80211_link_info_change_notify+0xcc/0xd4 [mac80211]
    ? exc_overflow+0x30/0x30
    ? ieee80211_link_info_change_notify+0xcc/0xd4 [mac80211]
    ? ieee80211_mesh_work+0xff/0x260 [mac80211]
    ? cfg80211_wiphy_work+0x72/0x98 [cfg80211]
    ? process_one_work+0xf1/0x1fc
    ? worker_thread+0x2c0/0x3b4
    ? kthread+0xc7/0xf0
    ? mod_delayed_work_on+0x4c/0x4c
    ? kthread_complete_and_exit+0x14/0x14
    ? ret_from_fork+0x24/0x38
    ? kthread_complete_and_exit+0x14/0x14
    ? ret_from_fork_asm+0xf/0x14
    ? entry_INT80_32+0xf0/0xf0

  [restore no-op path for no changes]
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-57899
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/36b739637d7042843f9df57212ecee6ed6e0d4b2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/49dba1ded8dd5a6a12748631403240b2ab245c34
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/86772872f9f5097cd03d0e1c6813238bd38c250b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-57899
    reference_type:
    reference_id: CVE-2024-57899
