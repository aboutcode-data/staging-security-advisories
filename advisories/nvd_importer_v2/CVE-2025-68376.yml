advisory_id: CVE-2025-68376
datasource_id: nvd_importer_v2/CVE-2025-68376
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68376
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  coresight: ETR: Fix ETR buffer use-after-free issue

  When ETR is enabled as CS_MODE_SYSFS, if the buffer size is changed
  and enabled again, currently sysfs_buf will point to the newly
  allocated memory(buf_new) and free the old memory(buf_old). But the
  etr_buf that is being used by the ETR remains pointed to buf_old, not
  updated to buf_new. In this case, it will result in a memory
  use-after-free issue.

  Fix this by checking ETR's mode before updating and releasing buf_old,
  if the mode is CS_MODE_SYSFS, then skip updating and releasing it.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/35501ac3c7d40a7bb9568c2f89d6b56beaf9bed3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/70acbc9c77686b7a521af6d7a543dcd9c324cf07
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cda077a19f5c8d6ec61e5b97deca203d95e3a422
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68376
    reference_type:
    reference_id: CVE-2025-68376
