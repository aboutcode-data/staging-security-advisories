advisory_id: CVE-2021-47388
datasource_id: nvd_importer_v2/CVE-2021-47388
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47388
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mac80211: fix use-after-free in CCMP/GCMP RX

  When PN checking is done in mac80211, for fragmentation we need
  to copy the PN to the RX struct so we can later use it to do a
  comparison, since commit bf30ca922a0c ("mac80211: check defrag
  PN against current frame").

  Unfortunately, in that commit I used the 'hdr' variable without
  it being necessarily valid, so use-after-free could occur if it
  was necessary to reallocate (parts of) the frame.

  Fix this by reloading the variable after the code that results
  in the reallocations, if any.

  This fixes https://bugzilla.kernel.org/show_bug.cgi?id=214401.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47388
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/27d3eb5616ee2c0a3b30c3fa34813368ed1f3dc9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/31de381aef0ab1b342f62485118dc8a19363dc78
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3d5d629c99c468458022e9b381789de3595bf4dd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/447d001b875d0e7f211c4ba004916028da994258
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/50149e0866a82cef33e680ee68dc380a5bc75d32
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/57de2dcb18742dc2860861c9f496da7d42b67da0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/94513069eb549737bcfc3d988d6ed4da948a2de8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f556e1d6fb9f2923a9a36f3df638c7d79ba09dbb
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47388
    reference_type:
    reference_id: CVE-2021-47388
