advisory_id: CVE-2021-47036
datasource_id: nvd_importer_v2/CVE-2021-47036
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47036
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  udp: skip L4 aggregation for UDP tunnel packets

  If NETIF_F_GRO_FRAGLIST or NETIF_F_GRO_UDP_FWD are enabled, and there
  are UDP tunnels available in the system, udp_gro_receive() could end-up
  doing L4 aggregation (either SKB_GSO_UDP_L4 or SKB_GSO_FRAGLIST) at
  the outer UDP tunnel level for packets effectively carrying and UDP
  tunnel header.

  That could cause inner protocol corruption. If e.g. the relevant
  packets carry a vxlan header, different vxlan ids will be ignored/
  aggregated to the same GSO packet. Inner headers will be ignored, too,
  so that e.g. TCP over vxlan push packets will be held in the GRO
  engine till the next flush, etc.

  Just skip the SKB_GSO_UDP_L4 and SKB_GSO_FRAGLIST code path if the
  current packet could land in a UDP tunnel, and let udp_gro_receive()
  do GRO via udp_sk(sk)->gro_receive.

  The check implemented in this patch is broader than what is strictly
  needed, as the existing UDP tunnel could be e.g. configured on top of
  a different device: we could end-up skipping GRO at-all for some packets.

  Anyhow, that is a very thin corner case and covering it will add quite
  a bit of complexity.

  v1 -> v2:
   - hopefully clarify the commit message
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47036
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/18f25dc399901426dff61e676ba603ff52c666f7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/450687386cd16d081b58cd7a342acff370a96078
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47036
    reference_type:
    reference_id: CVE-2021-47036
