advisory_id: CVE-2023-54172
datasource_id: nvd_importer_v2/CVE-2023-54172
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54172
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/hyperv: Disable IBT when hypercall page lacks ENDBR instruction

  On hardware that supports Indirect Branch Tracking (IBT), Hyper-V VMs
  with ConfigVersion 9.3 or later support IBT in the guest. However,
  current versions of Hyper-V have a bug in that there's not an ENDBR64
  instruction at the beginning of the hypercall page. Since hypercalls are
  made with an indirect call to the hypercall page, all hypercall attempts
  fail with an exception and Linux panics.

  A Hyper-V fix is in progress to add ENDBR64. But guard against the Linux
  panic by clearing X86_FEATURE_IBT if the hypercall page doesn't start
  with ENDBR. The VM will boot and run without IBT.

  If future Linux 32-bit kernels were to support IBT, additional hypercall
  page hackery would be needed to make IBT work for such kernels in a
  Hyper-V VM.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/73626b70b361ddda7c380e52c236aa4f2487c402
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/98cccbd0a19a161971bc7f7feb10577adc62c400
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d5ace2a776442d80674eff9ed42e737f7dd95056
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54172
    reference_type:
    reference_id: CVE-2023-54172
