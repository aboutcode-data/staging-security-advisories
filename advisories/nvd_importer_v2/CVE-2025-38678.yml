advisory_id: CVE-2025-38678
datasource_id: nvd_importer_v2/CVE-2025-38678
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38678
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: nf_tables: reject duplicate device on updates

  A chain/flowtable update with duplicated devices in the same batch is
  possible. Unfortunately, netdev event path only removes the first
  device that is found, leaving unregistered the hook of the duplicated
  device.

  Check if a duplicated device exists in the transaction batch, bail out
  with EEXIST in such case.

  WARNING is hit when unregistering the hook:

   [49042.221275] WARNING: CPU: 4 PID: 8425 at net/netfilter/core.c:340 nf_hook_entry_head+0xaa/0x150
   [49042.221375] CPU: 4 UID: 0 PID: 8425 Comm: nft Tainted: G S                  6.16.0+ #170 PREEMPT(full)
   [...]
   [49042.221382] RIP: 0010:nf_hook_entry_head+0xaa/0x150
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38678
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0521e694d5b80899fba8695881a6349f9bc538cb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3f358a66a04513311668ea4b40f5064e253d8386
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4681960bc0f4f8bcc782cbf2fd205f48ad314dfd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4ce2a0c3b8497a66cfc25fc7ca3d087258a785d2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cf23d531a9d496863aa4c5a0e2f71f0a23f3df3c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cf5fb87fcdaaaafec55dcc0dc5a9e15ead343973
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d7615bde541f16517d6790412da6ec46fa8a4c1f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38678
    reference_type:
    reference_id: CVE-2025-38678
