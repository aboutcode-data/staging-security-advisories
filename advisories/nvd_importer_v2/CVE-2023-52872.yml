advisory_id: CVE-2023-52872
datasource_id: nvd_importer_v2/CVE-2023-52872
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-52872
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tty: n_gsm: fix race condition in status line change on dead connections

  gsm_cleanup_mux() cleans up the gsm by closing all DLCIs, stopping all
  timers, removing the virtual tty devices and clearing the data queues.
  This procedure, however, may cause subsequent changes of the virtual modem
  status lines of a DLCI. More data is being added the outgoing data queue
  and the deleted kick timer is restarted to handle this. At this point many
  resources have already been removed by the cleanup procedure. Thus, a
  kernel panic occurs.

  Fix this by proving in gsm_modem_update() that the cleanup procedure has
  not been started and the mux is still alive.

  Note that writing to a virtual tty is already protected by checks against
  the DLCI specific connection state.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52872
weaknesses:
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/19d34b73234af542cc8a218cf398dee73cdb1890
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3a75b205de43365f80a33b98ec9289785da56243
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/81a4dd5e6c78f5d8952fa8c9d36565db1fe01444
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ce4df90333c4fe65acb8b5089fdfe9b955ce976a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/df6cfab66ff2a44bd23ad5dd5309cb3421bb6593
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52872
    reference_type:
    reference_id: CVE-2023-52872
