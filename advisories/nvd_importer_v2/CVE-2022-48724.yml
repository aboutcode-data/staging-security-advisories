advisory_id: CVE-2022-48724
datasource_id: nvd_importer_v2/CVE-2022-48724
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-48724
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  iommu/vt-d: Fix potential memory leak in intel_setup_irq_remapping()

  After commit e3beca48a45b ("irqdomain/treewide: Keep firmware node
  unconditionally allocated"). For tear down scenario, fn is only freed
  after fail to allocate ir_domain, though it also should be freed in case
  dmar_enable_qi returns error.

  Besides free fn, irq_domain and ir_msi_domain need to be removed as well
  if intel_setup_irq_remapping fails to enable queued invalidation.

  Improve the rewinding path by add out_free_ir_domain and out_free_fwnode
  lables per Baolu's suggestion.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48724
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/336d096b62bdc673e852b6b80d5072d7888ce85d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5c43d46daa0d2928234dd2792ebebc35d29ee2d1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/99e675d473eb8cf2deac1376a0f840222fc1adcf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9d9995b0371e4e8c18d4f955479e5d47efe7b2d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a0c685ba99961b1dd894b2e470e692a539770f6d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a31cb1f0fb6caf46ffe88c41252b6b7a4ee062d9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b62eceb5f8f08815fe3f945fc55bbf997c344ecd
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48724
    reference_type:
    reference_id: CVE-2022-48724
