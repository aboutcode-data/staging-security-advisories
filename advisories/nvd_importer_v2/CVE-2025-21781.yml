advisory_id: CVE-2025-21781
datasource_id: nvd_importer_v2/CVE-2025-21781
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21781
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  batman-adv: fix panic during interface removal

  Reference counting is used to ensure that
  batadv_hardif_neigh_node and batadv_hard_iface
  are not freed before/during
  batadv_v_elp_throughput_metric_update work is
  finished.

  But there isn't a guarantee that the hard if will
  remain associated with a soft interface up until
  the work is finished.

  This fixes a crash triggered by reboot that looks
  like this:

  Call trace:
   batadv_v_mesh_free+0xd0/0x4dc [batman_adv]
   batadv_v_elp_throughput_metric_update+0x1c/0xa4
   process_one_work+0x178/0x398
   worker_thread+0x2e8/0x4d0
   kthread+0xd8/0xdc
   ret_from_fork+0x10/0x20

  (the batadv_v_mesh_free call is misleading,
  and does not actually happen)

  I was able to make the issue happen more reliably
  by changing hardif_neigh->bat_v.metric_work work
  to be delayed work. This allowed me to track down
  and confirm the fix.

  [sven@narfation.org: prevent entering batadv_v_elp_get_throughput without
   soft_iface]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21781
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/072b2787321903287a126c148e8db87dd7ef96fe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/167422a07096a6006599067c8b55884064fa0b72
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2c3fb7df4cc6d043f70d4a8a10f8b915bbfb75e7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/522b1596ea19e327853804da2de60aeb9c5d6f42
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7eb5dd201695645af071592a50026eb780081a72
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ccb7276a6d26d6f8416e315b43b45e15ee7f29e2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ce3f1545bf8fa28bd05ec113679e8e6cd23af577
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f0a16c6c79768180333f3e41ce63f32730e3c3af
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00028.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21781
    reference_type:
    reference_id: CVE-2025-21781
