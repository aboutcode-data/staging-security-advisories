advisory_id: CVE-2022-49504
datasource_id: nvd_importer_v2/CVE-2022-49504
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49504
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: lpfc: Inhibit aborts if external loopback plug is inserted

  After running a short external loopback test, when the external loopback is
  removed and a normal cable inserted that is directly connected to a target
  device, the system oops in the llpfc_set_rrq_active() routine.

  When the loopback was inserted an FLOGI was transmit. As we're looped back,
  we receive the FLOGI request. The FLOGI is ABTS'd as we recognize the same
  wppn thus understand it's a loopback. However, as the ABTS sends address
  information the port is not set to (fffffe), the ABTS is dropped on the
  wire. A short 1 frame loopback test is run and completes before the ABTS
  times out. The looback is unplugged and the new cable plugged in, and the
  an FLOGI to the new device occurs and completes. Due to a mixup in ref
  counting the completion of the new FLOGI releases the fabric ndlp. Then the
  original ABTS completes and references the released ndlp generating the
  oops.

  Correct by no-op'ing the ABTS when in loopback mode (it will be dropped
  anyway). Added a flag to track the mode to recognize when it should be
  no-op'd.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49504
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/a1516930cb605caee3bc7b4f3b7994b88c0b8505
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ead76d4c09b89f4c8d632648026a476a5a34fde8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49504
    reference_type:
    reference_id: CVE-2022-49504
