advisory_id: CVE-2024-4343
datasource_id: nvd_importer_v2/CVE-2024-4343
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-4343
aliases: []
summary: A Python command injection vulnerability exists in the `SagemakerLLM` class's `complete()`
  method within `./private_gpt/components/llm/custom/sagemaker.py` of the imartinez/privategpt
  application, versions up to and including 0.3.0. The vulnerability arises due to the use of
  the `eval()` function to parse a string received from a remote AWS SageMaker LLM endpoint
  into a dictionary. This method of parsing is unsafe as it can execute arbitrary Python code
  contained within the response. An attacker can exploit this vulnerability by manipulating
  the response from the AWS SageMaker LLM endpoint to include malicious Python code, leading
  to potential execution of arbitrary commands on the system hosting the application. The issue
  is fixed in version 0.6.0.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-4343
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-4343
weaknesses:
  - CWE-78
references:
  - url: https://github.com/imartinez/privategpt/commit/86368c61760c9cee5d977131d23ad2a3e063cbe9
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/1d1e8f06-ec45-4b17-ae24-b83a41304c15
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:pribai:privategpt:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:pribai:privategpt:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-4343
    reference_type:
    reference_id: CVE-2024-4343
