advisory_id: CVE-2022-49958
datasource_id: nvd_importer_v2/CVE-2022-49958
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49958
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/sched: fix netdevice reference leaks in attach_default_qdiscs()

  In attach_default_qdiscs(), if a dev has multiple queues and queue 0 fails
  to attach qdisc because there is no memory in attach_one_default_qdisc().
  Then dev->qdisc will be noop_qdisc by default. But the other queues may be
  able to successfully attach to default qdisc.

  In this case, the fallback to noqueue process will be triggered. If the
  original attached qdisc is not released and a new one is directly
  attached, this will cause netdevice reference leaks.

  The following is the bug log:

  veth0: default qdisc (fq_codel) fail, fallback to noqueue
  unregister_netdevice: waiting for veth0 to become free. Usage count = 32
  leaked reference.
   qdisc_alloc+0x12e/0x210
   qdisc_create_dflt+0x62/0x140
   attach_one_default_qdisc.constprop.41+0x44/0x70
   dev_activate+0x128/0x290
   __dev_open+0x12a/0x190
   __dev_change_flags+0x1a2/0x1f0
   dev_change_flags+0x23/0x60
   do_setlink+0x332/0x1150
   __rtnl_newlink+0x52f/0x8e0
   rtnl_newlink+0x43/0x70
   rtnetlink_rcv_msg+0x140/0x3b0
   netlink_rcv_skb+0x50/0x100
   netlink_unicast+0x1bb/0x290
   netlink_sendmsg+0x37c/0x4e0
   sock_sendmsg+0x5f/0x70
   ____sys_sendmsg+0x208/0x280

  Fix this bug by clearing any non-noop qdiscs that may have been assigned
  before trying to re-attach.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49958
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0c6c522857151ac00150fd01baeebf231fb7d142
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/44dfa645895a56f65461249deb5b81cd16560e2a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a420d587260185407eda9c5766cfa9bdd5c39a56
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f612466ebecb12a00d9152344ddda6f6345f04dc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49958
    reference_type:
    reference_id: CVE-2022-49958
