advisory_id: CVE-2022-50091
datasource_id: nvd_importer_v2/CVE-2022-50091
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50091
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  locking/csd_lock: Change csdlock_debug from early_param to __setup

  The csdlock_debug kernel-boot parameter is parsed by the
  early_param() function csdlock_debug().  If set, csdlock_debug()
  invokes static_branch_enable() to enable csd_lock_wait feature, which
  triggers a panic on arm64 for kernels built with CONFIG_SPARSEMEM=y and
  CONFIG_SPARSEMEM_VMEMMAP=n.

  With CONFIG_SPARSEMEM_VMEMMAP=n, __nr_to_section is called in
  static_key_enable() and returns NULL, resulting in a NULL dereference
  because mem_section is initialized only later in sparse_init().

  This is also a problem for powerpc because early_param() functions
  are invoked earlier than jump_label_init(), also resulting in
  static_key_enable() failures.  These failures cause the warning "static
  key 'xxx' used before call to jump_label_init()".

  Thus, early_param is too early for csd_lock_wait to run
  static_branch_enable(), so changes it to __setup to fix these.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50091
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/05de9e2e33b1625c71aee69e353fe906dd2be88a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9c9b26b0df270d4f9246e483a44686fca951a29c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b480d1e9a8c11ecc1c99dc01814b28e3103bd0a0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d2cbdbe22b5f190055d2d0ae92e7454479343a30
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50091
    reference_type:
    reference_id: CVE-2022-50091
