advisory_id: CVE-2022-50226
datasource_id: nvd_importer_v2/CVE-2022-50226
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50226
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  crypto: ccp - Use kzalloc for sev ioctl interfaces to prevent kernel memory leak

  For some sev ioctl interfaces, input may be passed that is less than or
  equal to SEV_FW_BLOB_MAX_SIZE, but larger than the data that PSP
  firmware returns. In this case, kmalloc will allocate memory that is the
  size of the input rather than the size of the data. Since PSP firmware
  doesn't fully overwrite the buffer, the sev ioctl interfaces with the
  issue may return uninitialized slab memory.

  Currently, all of the ioctl interfaces in the ccp driver are safe, but
  to prevent future problems, change all ioctl interfaces that allocate
  memory with kmalloc to use kzalloc and memset the data buffer to zero
  in sev_ioctl_do_platform_status.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50226
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/13dc15a3f5fd7f884e4bfa8c011a0ae868df12ae
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4c5300f6f5e18b11c02a92f136e69b98fddba15e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/caa395aa16e7c9193fd7fa6cde462dd8229d4953
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e11fb0a3a39bb42da35fa662c46ce7391f277436
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f2a920daa780956b987c14b9f23de7c3c8915bf2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50226
    reference_type:
    reference_id: CVE-2022-50226
