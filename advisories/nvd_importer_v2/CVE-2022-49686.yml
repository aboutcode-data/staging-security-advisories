advisory_id: CVE-2022-49686
datasource_id: nvd_importer_v2/CVE-2022-49686
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49686
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: gadget: uvc: fix list double add in uvcg_video_pump

  A panic can occur if the endpoint becomes disabled and the
  uvcg_video_pump adds the request back to the req_free list after it has
  already been queued to the endpoint. The endpoint complete will add the
  request back to the req_free list. Invalidate the local request handle
  once it's been queued.

  <6>[  246.796704][T13726] configfs-gadget gadget: uvc: uvc_function_set_alt(1, 0)
  <3>[  246.797078][   T26] list_add double add: new=ffffff878bee5c40, prev=ffffff878bee5c40, next=ffffff878b0f0a90.
  <6>[  246.797213][   T26] ------------[ cut here ]------------
  <2>[  246.797224][   T26] kernel BUG at lib/list_debug.c:31!
  <6>[  246.807073][   T26] Call trace:
  <6>[  246.807180][   T26]  uvcg_video_pump+0x364/0x38c
  <6>[  246.807366][   T26]  process_one_work+0x2a4/0x544
  <6>[  246.807394][   T26]  worker_thread+0x350/0x784
  <6>[  246.807442][   T26]  kthread+0x2ac/0x320
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49686
weaknesses:
  - CWE-415
references:
  - url: https://git.kernel.org/stable/c/96163f835e65f8c9897487fac965819f0651d671
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d95ac8b920de1d39525fadc408ce675697626ca6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49686
    reference_type:
    reference_id: CVE-2022-49686
