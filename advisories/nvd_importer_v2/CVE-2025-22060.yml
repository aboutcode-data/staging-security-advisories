advisory_id: CVE-2025-22060
datasource_id: nvd_importer_v2/CVE-2025-22060
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-22060
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: mvpp2: Prevent parser TCAM memory corruption

  Protect the parser TCAM/SRAM memory, and the cached (shadow) SRAM
  information, from concurrent modifications.

  Both the TCAM and SRAM tables are indirectly accessed by configuring
  an index register that selects the row to read or write to. This means
  that operations must be atomic in order to, e.g., avoid spreading
  writes across multiple rows. Since the shadow SRAM array is used to
  find free rows in the hardware table, it must also be protected in
  order to avoid TOCTOU errors where multiple cores allocate the same
  row.

  This issue was detected in a situation where `mvpp2_set_rx_mode()` ran
  concurrently on two CPUs. In this particular case the
  MVPP2_PE_MAC_UC_PROMISCUOUS entry was corrupted, causing the
  classifier unit to drop all incoming unicast - indicated by the
  `rx_classifier_drops` counter.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-22060
weaknesses:
  - CWE-367
references:
  - url: https://git.kernel.org/stable/c/46c1e23e34c9d1eaadf37f88216d9d8ce0d0bcee
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5b0ae1723a7d9574ae1aee7d9cf9757a30069865
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/96844075226b49af25a69a1d084b648ec2d9b08d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b3f48a41a00d6d8d9c6fe09ae47dd21c8c1c8b03
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e3711163d14d02af9005e4cdad30899c565f13fb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e64e9b6e86b39db3baa576fd73da73533b54cb2d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fcbfb54a0269875cf3cd6a2bff4f85a2e0a0b552
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22060
    reference_type:
    reference_id: CVE-2025-22060
