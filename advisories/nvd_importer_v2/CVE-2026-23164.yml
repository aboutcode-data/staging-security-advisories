advisory_id: CVE-2026-23164
datasource_id: nvd_importer_v2/CVE-2026-23164
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23164
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  rocker: fix memory leak in rocker_world_port_post_fini()

  In rocker_world_port_pre_init(), rocker_port->wpriv is allocated with
  kzalloc(wops->port_priv_size, GFP_KERNEL). However, in
  rocker_world_port_post_fini(), the memory is only freed when
  wops->port_post_fini callback is set:

      if (!wops->port_post_fini)
          return;
      wops->port_post_fini(rocker_port);
      kfree(rocker_port->wpriv);

  Since rocker_ofdpa_ops does not implement port_post_fini callback
  (it is NULL), the wpriv memory allocated for each port is never freed
  when ports are removed. This leads to a memory leak of
  sizeof(struct ofdpa_port) bytes per port on every device removal.

  Fix this by always calling kfree(rocker_port->wpriv) regardless of
  whether the port_post_fini callback exists.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2a3a64d75d2d0727da285749476761ebcad557a3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8ce2e85889939c02740b4245301aa5c35fc94887
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8d7ba71e46216b8657a82ca2ec118bc93812a4d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b11e6f926480ab0939fec44781f28558c54be4e7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d448bf96889f1905e740c554780f5c9fa0440566
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d8723917efda3b4f4c3de78d1ec1e1af015c0be1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dce375f4afc348c310d171abcde7ec1499a4c26a
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23164
    reference_type:
    reference_id: CVE-2026-23164
