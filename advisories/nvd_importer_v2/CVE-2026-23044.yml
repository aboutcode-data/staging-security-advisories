advisory_id: CVE-2026-23044
datasource_id: nvd_importer_v2/CVE-2026-23044
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23044
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  PM: hibernate: Fix crash when freeing invalid crypto compressor

  When crypto_alloc_acomp() fails, it returns an ERR_PTR value, not NULL.

  The cleanup code in save_compressed_image() and load_compressed_image()
  unconditionally calls crypto_free_acomp() without checking for ERR_PTR,
  which causes crypto_acomp_tfm() to dereference an invalid pointer and
  crash the kernel.

  This can be triggered when the compression algorithm is unavailable
  (e.g., CONFIG_CRYPTO_LZO not enabled).

  Fix by adding IS_ERR_OR_NULL() checks before calling crypto_free_acomp()
  and acomp_request_free(), similar to the existing kthread_stop() check.

  [ rjw: Added 2 empty code lines ]
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/7966cf0ebe32c981bfa3db252cb5fc3bb1bf2e77
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b7a883b0135dbc6817e90a829421c9fc8cd94bad
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23044
    reference_type:
    reference_id: CVE-2026-23044
