advisory_id: CVE-2022-3252
datasource_id: nvd_importer_v2/CVE-2022-3252
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-3252
aliases: []
summary: 'Improper detection of complete HTTP body decompression SwiftNIO Extras provides a
  pair of helpers for transparently decompressing received HTTP request or response bodies.
  These two objects (HTTPRequestDecompressor and HTTPResponseDecompressor) both failed to detect
  when the decompressed body was considered complete. If trailing junk data was appended to
  the HTTP message body, the code would repeatedly attempt to decompress this data and fail.
  This would lead to an infinite loop making no forward progress, leading to livelock of the
  system and denial-of-service. This issue can be triggered by any attacker capable of sending
  a compressed HTTP message. Most commonly this is HTTP servers, as compressed HTTP messages
  cannot be negotiated for HTTP requests, but it is possible that users have configured decompression
  for HTTP requests as well. The attack is low effort, and likely to be reached without requiring
  any privilege or system access. The impact on availability is high: the process immediately
  becomes unavailable but does not immediately crash, meaning that it is possible for the process
  to remain in this state until an administrator intervenes or an automated circuit breaker
  fires. If left unchecked this issue will very slowly exhaust memory resources due to repeated
  buffer allocation, but the buffers are not written to and so it is possible that the processes
  will not terminate for quite some time. This risk can be mitigated by removing transparent
  HTTP message decompression. The issue is fixed by correctly detecting the termination of the
  compressed body as reported by zlib and refusing to decompress further data. The issue was
  found by Vojtech Rylko (https://github.com/vojtarylko) and reported publicly on GitHub.'
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-3252
weaknesses:
  - CWE-835
  - CWE-606
references:
  - url: https://github.com/apple/swift-nio-extras/security/advisories/GHSA-773g-x274-8qmf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apple:swift-nio-extras:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apple:swift-nio-extras:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-3252
    reference_type:
    reference_id: CVE-2022-3252
