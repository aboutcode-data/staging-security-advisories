advisory_id: CVE-2025-21738
datasource_id: nvd_importer_v2/CVE-2025-21738
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21738
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ata: libata-sff: Ensure that we cannot write outside the allocated buffer

  reveliofuzzing reported that a SCSI_IOCTL_SEND_COMMAND ioctl with out_len
  set to 0xd42, SCSI command set to ATA_16 PASS-THROUGH, ATA command set to
  ATA_NOP, and protocol set to ATA_PROT_PIO, can cause ata_pio_sector() to
  write outside the allocated buffer, overwriting random memory.

  While a ATA device is supposed to abort a ATA_NOP command, there does seem
  to be a bug either in libata-sff or QEMU, where either this status is not
  set, or the status is cleared before read by ata_sff_hsm_move().
  Anyway, that is most likely a separate bug.

  Looking at __atapi_pio_bytes(), it already has a safety check to ensure
  that __atapi_pio_bytes() cannot write outside the allocated buffer.

  Add a similar check to ata_pio_sector(), such that also ata_pio_sector()
  cannot write outside the allocated buffer.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21738
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0a17a9944b8d89ef03946121241870ac53ddaf45
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0dd5aade301a10f4b329fa7454fdcc2518741902
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6e74e53b34b6dec5a50e1404e2680852ec6768d2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a8f8cf87059ed1905c2a5c72f8b39a4f57b11b4c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d5e6e3000309359eae2a17117aa6e3c44897bf6c
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00028.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21738
    reference_type:
    reference_id: CVE-2025-21738
