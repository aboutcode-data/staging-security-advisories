advisory_id: CVE-2024-39691
datasource_id: nvd_importer_v2/CVE-2024-39691
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-39691
aliases: []
summary: matrix-appservice-irc is a Node.js IRC bridge for the Matrix messaging protocol. The
  fix for GHSA-wm4w-7h2q-3pf7 / CVE-2024-32000 included in matrix-appservice-irc 2.0.0 relied
  on the Matrix homeserver-provided timestamp to determine whether a user has access to the
  event they're replying to when determining whether or not to include a truncated version of
  the original event in the IRC message. Since this value is controlled by external entities,
  a malicious Matrix homeserver joined to a room in which a matrix-appservice-irc bridge instance
  (before version 2.0.1) is present can fabricate the timestamp with the intent of tricking
  the bridge into leaking room messages the homeserver should not have access to. matrix-appservice-irc
  2.0.1 drops the reliance on `origin_server_ts` when determining whether or not an event should
  be visible to a user, instead tracking the event timestamps internally. As a workaround, it's
  possible to limit the amount of information leaked by setting a reply template that doesn't
  contain the original message.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-39691
weaknesses:
  - CWE-280
  - CWE-755
references:
  - url: https://github.com/matrix-org/matrix-appservice-irc/blob/d5d67d1d3ea3f0f6962a0af2cc57b56af3ad2129/config.sample.yaml#L601-L604
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/commit/1835e047f269001054be4c68867797aa12372a0f
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/pull/1804
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-w9mh-5x8j-9754
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-39691
    reference_type:
    reference_id: CVE-2024-39691
