advisory_id: CVE-2025-68289
datasource_id: nvd_importer_v2/CVE-2025-68289
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68289
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: gadget: f_eem: Fix memory leak in eem_unwrap

  The existing code did not handle the failure case of usb_ep_queue in the
  command path, potentially leading to memory leaks.

  Improve error handling to free all allocated resources on usb_ep_queue
  failure. This patch continues to use goto logic for error handling, as the
  existing error handling is complex and not easily adaptable to auto-cleanup
  helpers.

  kmemleak results:
    unreferenced object 0xffffff895a512300 (size 240):
      backtrace:
        slab_post_alloc_hook+0xbc/0x3a4
        kmem_cache_alloc+0x1b4/0x358
        skb_clone+0x90/0xd8
        eem_unwrap+0x1cc/0x36c
    unreferenced object 0xffffff8a157f4000 (size 256):
      backtrace:
        slab_post_alloc_hook+0xbc/0x3a4
        __kmem_cache_alloc_node+0x1b4/0x2dc
        kmalloc_trace+0x48/0x140
        dwc3_gadget_ep_alloc_request+0x58/0x11c
        usb_ep_alloc_request+0x40/0xe4
        eem_unwrap+0x204/0x36c
    unreferenced object 0xffffff8aadbaac00 (size 128):
      backtrace:
        slab_post_alloc_hook+0xbc/0x3a4
        __kmem_cache_alloc_node+0x1b4/0x2dc
        __kmalloc+0x64/0x1a8
        eem_unwrap+0x218/0x36c
    unreferenced object 0xffffff89ccef3500 (size 64):
      backtrace:
        slab_post_alloc_hook+0xbc/0x3a4
        __kmem_cache_alloc_node+0x1b4/0x2dc
        kmalloc_trace+0x48/0x140
        eem_unwrap+0x238/0x36c
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0ac07e476944a5e4c2b8b087dd167dec248c1bdf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0dea2e0069a7e9aa034696f8065945b7be6dd6b7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/41434488ca714ab15cb2a4d0378418d1be8052d2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5a1628283cd9dccf1e44acfb74e77504f4dc7472
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a9985a88b2fc29fbe1657fe8518908e261d6889c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e4f5ce990818d37930cd9fb0be29eee0553c59d9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e72c963177c708a167a7e17ed6c76320815157cf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68289
    reference_type:
    reference_id: CVE-2025-68289
