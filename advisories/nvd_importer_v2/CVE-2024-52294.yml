advisory_id: CVE-2024-52294
datasource_id: nvd_importer_v2/CVE-2024-52294
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-52294
aliases: []
summary: Khoj is a self-hostable artificial intelligence app. Prior to version 1.29.10, an Insecure
  Direct Object Reference (IDOR) vulnerability in the update_subscription endpoint allows any
  authenticated user to manipulate other users' Stripe subscriptions by simply modifying the
  email parameter in the request. The vulnerability exists in the subscription endpoint at `/api/subscription`.
  The endpoint uses an email parameter as a direct reference to user subscriptions without verifying
  object ownership. While authentication is required, there is no authorization check to verify
  if the authenticated user owns the referenced subscription. The issue was fixed in version
  1.29.10. Support for arbitrarily presenting an email for update has been deprecated.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-52294
weaknesses:
  - CWE-639
references:
  - url: https://github.com/khoj-ai/khoj/commit/47d3c8c23597900af708bdc60aced3ae5d2064c1
    reference_type:
    reference_id:
  - url: https://github.com/khoj-ai/khoj/security/advisories/GHSA-hq4h-w933-jm6c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-52294
    reference_type:
    reference_id: CVE-2024-52294
