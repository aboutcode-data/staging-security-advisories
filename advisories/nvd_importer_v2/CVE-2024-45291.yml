advisory_id: CVE-2024-45291
datasource_id: nvd_importer_v2/CVE-2024-45291
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-45291
aliases: []
summary: PHPSpreadsheet is a pure PHP library for reading and writing spreadsheet files. It's
  possible for an attacker to construct an XLSX file that links images from arbitrary paths.
  When embedding images has been enabled in HTML writer with `$writer->setEmbedImages(true);`
  those files will be included in the output as `data:` URLs, regardless of the file's type.
  Also URLs can be used for embedding, resulting in a Server-Side Request Forgery vulnerability.
  When embedding images has been enabled, an attacker can read arbitrary files on the server
  and perform arbitrary HTTP GET requests. Note that any PHP protocol wrappers can be used,
  meaning that if for example the `expect://` wrapper is enabled, also remote code execution
  is possible. This issue has been addressed in release versions 1.29.2, 2.1.1, and 2.3.0. All
  users are advised to upgrade. there are no known workarounds for this vulnerability.
impacted_packages: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-45291
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-45291
weaknesses:
  - CWE-36
  - CWE-918
  - CWE-22
references:
  - url: https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:phpoffice:phpspreadsheet:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:phpoffice:phpspreadsheet:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45291
    reference_type:
    reference_id: CVE-2024-45291
