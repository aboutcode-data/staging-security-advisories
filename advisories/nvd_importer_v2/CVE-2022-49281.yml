advisory_id: CVE-2022-49281
datasource_id: nvd_importer_v2/CVE-2022-49281
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49281
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  cifs: fix handlecache and multiuser

  In multiuser each individual user has their own tcon structure for the
  share and thus their own handle for a cached directory.
  When we umount such a share we much make sure to release the pinned down dentry
  for each such tcon and not just the master tcon.

  Otherwise we will get nasty warnings on umount that dentries are still in use:
  [ 3459.590047] BUG: Dentry 00000000115c6f41{i=12000000019d95,n=/}  still in use\
   (2) [unmount of cifs cifs]
  ...
  [ 3459.590492] Call Trace:
  [ 3459.590500]  d_walk+0x61/0x2a0
  [ 3459.590518]  ? shrink_lock_dentry.part.0+0xe0/0xe0
  [ 3459.590526]  shrink_dcache_for_umount+0x49/0x110
  [ 3459.590535]  generic_shutdown_super+0x1a/0x110
  [ 3459.590542]  kill_anon_super+0x14/0x30
  [ 3459.590549]  cifs_kill_sb+0xf5/0x104 [cifs]
  [ 3459.590773]  deactivate_locked_super+0x36/0xa0
  [ 3459.590782]  cleanup_mnt+0x131/0x190
  [ 3459.590789]  task_work_run+0x5c/0x90
  [ 3459.590798]  exit_to_user_mode_loop+0x151/0x160
  [ 3459.590809]  exit_to_user_mode_prepare+0x83/0xd0
  [ 3459.590818]  syscall_exit_to_user_mode+0x12/0x30
  [ 3459.590828]  do_syscall_64+0x48/0x90
  [ 3459.590833]  entry_SYSCALL_64_after_hwframe+0x44/0xae
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49281
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2fafbc198613823943c106d1ec9b516da692059f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/47178c7722ac528ea08aa82c3ef9ffa178962d7a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e71f6a3a1d5c826a30384fec587ca7503ef6bde5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ffa631c4bff59dde59b598011f570e27dfba3515
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49281
    reference_type:
    reference_id: CVE-2022-49281
