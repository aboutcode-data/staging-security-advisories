advisory_id: CVE-2019-9859
datasource_id: nvd_importer_v2/CVE-2019-9859
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2019-9859
aliases: []
summary: 'Vesta Control Panel (VestaCP) 0.9.7 through 0.9.8-23 is vulnerable to an authenticated
  command execution that can result in remote root access on the server. The platform works
  with PHP as the frontend language and uses shell scripts to execute system actions. PHP executes
  shell script through the dangerous command exec. This function can be dangerous if arguments
  passed to it are not filtered. Every user input in VestaCP that is used as an argument is
  filtered with the escapeshellarg function. This function comes from the PHP library directly
  and its description is as follows: "escapeshellarg() adds single quotes around a string and
  quotes/escapes any existing single quotes allowing you to pass a string directly to a shell
  function and having it be treated as a single safe argument." It means that if you give Username,
  it will have ''Username'' as a replacement. This works well and protects users from exploiting
  this potentially dangerous exec function. Unfortunately, VestaCP uses this escapeshellarg
  function incorrectly in several places.'
impacted_packages: []
severities:
  - score: '9.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-9859
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-9859
weaknesses:
  - CWE-78
references:
  - url: https://ssd-disclosure.com/?p=3926
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vestacp:vesta_control_panel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:vestacp:vesta_control_panel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-9859
    reference_type:
    reference_id: CVE-2019-9859
