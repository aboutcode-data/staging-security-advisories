advisory_id: CVE-2021-27099
datasource_id: nvd_importer_v2/CVE-2021-27099
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-27099
aliases: []
summary: In SPIRE before versions 0.8.5, 0.9.4, 0.10.2, 0.11.3 and 0.12.1, the "aws_iid" Node
  Attestor improperly normalizes the path provided through the agent ID templating feature,
  which may allow the issuance of an arbitrary SPIFFE ID within the same trust domain, if the
  attacker controls the value of an EC2 tag prior to attestation, and the attestor is configured
  for agent ID templating where the tag value is the last element in the path. This issue has
  been fixed in SPIRE versions 0.11.3 and 0.12.1
impacted_packages: []
severities:
  - score: '4.9'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-27099
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-27099
weaknesses:
  - CWE-863
references:
  - url: https://github.com/spiffe/spire/security/advisories/GHSA-q7gm-mjrg-44h9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:cncf:spire:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:cncf:spire:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-27099
    reference_type:
    reference_id: CVE-2021-27099
