advisory_id: CVE-2023-53333
datasource_id: nvd_importer_v2/CVE-2023-53333
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53333
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: conntrack: dccp: copy entire header to stack buffer, not just basic one

  Eric Dumazet says:
    nf_conntrack_dccp_packet() has an unique:

    dh = skb_header_pointer(skb, dataoff, sizeof(_dh), &_dh);

    And nothing more is 'pulled' from the packet, depending on the content.
    dh->dccph_doff, and/or dh->dccph_x ...)
    So dccp_ack_seq() is happily reading stuff past the _dh buffer.

  BUG: KASAN: stack-out-of-bounds in nf_conntrack_dccp_packet+0x1134/0x11c0
  Read of size 4 at addr ffff000128f66e0c by task syz-executor.2/29371
  [..]

  Fix this by increasing the stack buffer to also include room for
  the extra sequence numbers and all the known dccp packet type headers,
  then pull again after the initial validation of the basic header.

  While at it, mark packets invalid that lack 48bit sequence bit but
  where RFC says the type MUST use them.

  Compile tested only.

  v2: first skb_header_pointer() now needs to adjust the size to
      only pull the generic header. (Eric)

  Heads-up: I intend to remove dccp conntrack support later this year.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53333
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/26bd1f210d3783a691052c51d76bb8a8bbd24c67
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/337fdce450637ea663bc816edc2ba81e5cdad02e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5c618daa5038712c4a4ef8923905a2ea1b8836a1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8c0980493beed3a80d6329c44ab293dc8c032927
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9bdcda7abaf22f6453e5b5efb7eb4e524095d5d8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c052797ac36813419ad3bfa54cb8615db4b41f15
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff0a3a7d52ff7282dbd183e7fc29a1fe386b0c30
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53333
    reference_type:
    reference_id: CVE-2023-53333
