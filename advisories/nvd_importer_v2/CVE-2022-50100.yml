advisory_id: CVE-2022-50100
datasource_id: nvd_importer_v2/CVE-2022-50100
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50100
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sched/core: Do not requeue task on CPU excluded from cpus_mask

  The following warning was triggered on a large machine early in boot on
  a distribution kernel but the same problem should also affect mainline.

     WARNING: CPU: 439 PID: 10 at ../kernel/workqueue.c:2231 process_one_work+0x4d/0x440
     Call Trace:
      <TASK>
      rescuer_thread+0x1f6/0x360
      kthread+0x156/0x180
      ret_from_fork+0x22/0x30
      </TASK>

  Commit c6e7bd7afaeb ("sched/core: Optimize ttwu() spinning on p->on_cpu")
  optimises ttwu by queueing a task that is descheduling on the wakelist,
  but does not check if the task descheduling is still allowed to run on that CPU.

  In this warning, the problematic task is a workqueue rescue thread which
  checks if the rescue is for a per-cpu workqueue and running on the wrong CPU.
  While this is early in boot and it should be possible to create workers,
  the rescue thread may still used if the MAYDAY_INITIAL_TIMEOUT is reached
  or MAYDAY_INTERVAL and on a sufficiently large machine, the rescue
  thread is being used frequently.

  Tracing confirmed that the task should have migrated properly using the
  stopper thread to handle the migration. However, a parallel wakeup from udev
  running on another CPU that does not share CPU cache observes p->on_cpu and
  uses task_cpu(p), queues the task on the old CPU and triggers the warning.

  Check that the wakee task that is descheduling is still allowed to run
  on its current CPU and if not, wait for the descheduling to complete
  and select an allowed CPU.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50100
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/302f7b0fc337746f41c69eb08522907f6a90c643
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/748d2e9585ae53cb6be48e84f93d2f082ae1d135
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/751d4cbc43879229dbc124afefe240b70fd29a85
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fde45283f4c8a91c367ea5f20f87036468755121
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50100
    reference_type:
    reference_id: CVE-2022-50100
