advisory_id: CVE-2022-50307
datasource_id: nvd_importer_v2/CVE-2022-50307
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50307
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  s390/cio: fix out-of-bounds access on cio_ignore free

  The channel-subsystem-driver scans for newly available devices whenever
  device-IDs are removed from the cio_ignore list using a command such as:

    echo free >/proc/cio_ignore

  Since an I/O device scan might interfer with running I/Os, commit
  172da89ed0ea ("s390/cio: avoid excessive path-verification requests")
  introduced an optimization to exclude online devices from the scan.

  The newly added check for online devices incorrectly assumes that
  an I/O-subchannel's drvdata points to a struct io_subchannel_private.
  For devices that are bound to a non-default I/O subchannel driver, such
  as the vfio_ccw driver, this results in an out-of-bounds read access
  during each scan.

  Fix this by changing the scan logic to rely on a driver-independent
  online indication. For this we can use struct subchannel->config.ena,
  which is the driver's requested subchannel-enabled state. Since I/Os
  can only be started on enabled subchannels, this matches the intent
  of the original optimization of not scanning devices where I/O might
  be running.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50307
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/0e501fd0f38e42304bfa0d46a812d93f80294a87
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/106ab66cf5467726ca5ead51623043d37c06820a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1b6074112742f65ece71b0f299ca5a6a887d2db6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50307
    reference_type:
    reference_id: CVE-2022-50307
