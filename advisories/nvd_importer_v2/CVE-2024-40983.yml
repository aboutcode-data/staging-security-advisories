advisory_id: CVE-2024-40983
datasource_id: nvd_importer_v2/CVE-2024-40983
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-40983
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tipc: force a dst refcount before doing decryption

  As it says in commit 3bc07321ccc2 ("xfrm: Force a dst refcount before
  entering the xfrm type handlers"):

  "Crypto requests might return asynchronous. In this case we leave the
   rcu protected region, so force a refcount on the skb's destination
   entry before we enter the xfrm type input/output handlers."

  On TIPC decryption path it has the same problem, and skb_dst_force()
  should be called before doing decryption to avoid a possible crash.

  Shuang reported this issue when this warning is triggered:

    [] WARNING: include/net/dst.h:337 tipc_sk_rcv+0x1055/0x1ea0 [tipc]
    [] Kdump: loaded Tainted: G W --------- - - 4.18.0-496.el8.x86_64+debug
    [] Workqueue: crypto cryptd_queue_worker
    [] RIP: 0010:tipc_sk_rcv+0x1055/0x1ea0 [tipc]
    [] Call Trace:
    [] tipc_sk_mcast_rcv+0x548/0xea0 [tipc]
    [] tipc_rcv+0xcf5/0x1060 [tipc]
    [] tipc_aead_decrypt_done+0x215/0x2e0 [tipc]
    [] cryptd_aead_crypt+0xdb/0x190
    [] cryptd_queue_worker+0xed/0x190
    [] process_one_work+0x93d/0x17e0
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-40983
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2ebe8f840c7450ecbfca9d18ac92e9ce9155e269
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3eb1b39627892c4e26cb0162b75725aa5fcc60c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/623c90d86a61e3780f682b32928af469c66ec4c2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6808b41371670c51feea14f63ade211e78100930
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/692803b39a36e63ac73208e0a3769ae6a2f9bc76
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b57a4a2dc8746cea58a922ebe31b6aa629d69d93
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-40983
    reference_type:
    reference_id: CVE-2024-40983
