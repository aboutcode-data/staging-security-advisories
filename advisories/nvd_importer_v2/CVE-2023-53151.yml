advisory_id: CVE-2023-53151
datasource_id: nvd_importer_v2/CVE-2023-53151
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53151
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  md/raid10: prevent soft lockup while flush writes

  Currently, there is no limit for raid1/raid10 plugged bio. While flushing
  writes, raid1 has cond_resched() while raid10 doesn't, and too many
  writes can cause soft lockup.

  Follow up soft lockup can be triggered easily with writeback test for
  raid10 with ramdisks:

  watchdog: BUG: soft lockup - CPU#10 stuck for 27s! [md0_raid10:1293]
  Call Trace:
   <TASK>
   call_rcu+0x16/0x20
   put_object+0x41/0x80
   __delete_object+0x50/0x90
   delete_object_full+0x2b/0x40
   kmemleak_free+0x46/0xa0
   slab_free_freelist_hook.constprop.0+0xed/0x1a0
   kmem_cache_free+0xfd/0x300
   mempool_free_slab+0x1f/0x30
   mempool_free+0x3a/0x100
   bio_free+0x59/0x80
   bio_put+0xcf/0x2c0
   free_r10bio+0xbf/0xf0
   raid_end_bio_io+0x78/0xb0
   one_write_done+0x8a/0xa0
   raid10_end_write_request+0x1b4/0x430
   bio_endio+0x175/0x320
   brd_submit_bio+0x3b9/0x9b7 [brd]
   __submit_bio+0x69/0xe0
   submit_bio_noacct_nocheck+0x1e6/0x5a0
   submit_bio_noacct+0x38c/0x7e0
   flush_pending_writes+0xf0/0x240
   raid10d+0xac/0x1ed0

  Fix the problem by adding cond_resched() to raid10 like what raid1 did.

  Note that unlimited plugged bio still need to be optimized, for example,
  in the case of lots of dirty pages writeback, this will take lots of
  memory and io will spend a long time in plug, hence io latency is bad.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53151
weaknesses:
  - CWE-667
references:
  - url: https://git.kernel.org/stable/c/00ecb6fa67c0f772290c5ea5ae8b46eefd503b83
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/010444623e7f4da6b4a4dd603a7da7469981e293
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1d467e10507167eb6dc2c281a87675b731955d86
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/634daf6b2c81015cc5e28bf694a6a94a50c641cd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/84a578961b2566e475bfa8740beaf0abcc781a6f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d0345f7c7dbc5d42e4e6f1db99c1c1879d7b0eb5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f45b2fa7678ab385299de345f7e85d05caea386b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fbf50184190d55f8717bd29aa9530c399be96f30
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53151
    reference_type:
    reference_id: CVE-2023-53151
