advisory_id: CVE-2025-38198
datasource_id: nvd_importer_v2/CVE-2025-38198
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38198
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fbcon: Make sure modelist not set on unregistered console

  It looks like attempting to write to the "store_modes" sysfs node will
  run afoul of unregistered consoles:

  UBSAN: array-index-out-of-bounds in drivers/video/fbdev/core/fbcon.c:122:28
  index -1 is out of range for type 'fb_info *[32]'
  ...
   fbcon_info_from_console+0x192/0x1a0 drivers/video/fbdev/core/fbcon.c:122
   fbcon_new_modelist+0xbf/0x2d0 drivers/video/fbdev/core/fbcon.c:3048
   fb_new_modelist+0x328/0x440 drivers/video/fbdev/core/fbmem.c:673
   store_modes+0x1c9/0x3e0 drivers/video/fbdev/core/fbsysfs.c:113
   dev_attr_store+0x55/0x80 drivers/base/core.c:2439

  static struct fb_info *fbcon_registered_fb[FB_MAX];
  ...
  static signed char con2fb_map[MAX_NR_CONSOLES];
  ...
  static struct fb_info *fbcon_info_from_console(int console)
  ...
          return fbcon_registered_fb[con2fb_map[console]];

  If con2fb_map contains a -1 things go wrong here. Instead, return NULL,
  as callers of fbcon_info_from_console() are trying to compare against
  existing "info" pointers, so error handling should kick in correctly.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38198
weaknesses:
  - CWE-129
references:
  - url: https://git.kernel.org/stable/c/519ba75728ee8cd561dce25fc52a2ec5c47171dc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/54b28f7c567dd659e5f9562f518e4d7f3f6a367b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b3237d451bf3a4490cb1a76f3b7c91d9888f1c4b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cedc1b63394a866bf8663a3e40f4546f1d28c8d8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f28f1f578cd810779d01999c60618cda14c281dd
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38198
    reference_type:
    reference_id: CVE-2025-38198
