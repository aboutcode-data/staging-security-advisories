advisory_id: CVE-2023-31135
datasource_id: nvd_importer_v2/CVE-2023-31135
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-31135
aliases: []
summary: Dgraph is an open source distributed GraphQL database. Existing Dgraph audit logs are
  vulnerable to brute force attacks due to nonce collisions. The first 12 bytes come from a
  baseIv which is initialized when an audit log is created. The last 4 bytes come from the length
  of the log line being encrypted. This is problematic because two log lines will often have
  the same length, so due to these collisions we are reusing the same nonce many times. All
  audit logs generated by versions of Dgraph <v23.0.0 are affected. Attackers must have access
  to the system the logs are stored on. Dgraph users should upgrade to v23.0.0. Users unable
  to upgrade should store existing audit logs in a secure location and for extra security, encrypt
  using an external tool like `gpg`.
impacted_packages: []
severities:
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-31135
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-31135
weaknesses:
  - CWE-326
references:
  - url: https://en.wikipedia.org/wiki/Cryptographic_nonce
    reference_type:
    reference_id:
  - url: https://github.com/dgraph-io/dgraph/pull/8323
    reference_type:
    reference_id:
  - url: https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:dgraph:dgraph:*:*:*:*:*:go:*:*
    reference_type:
    reference_id: cpe:2.3:a:dgraph:dgraph:*:*:*:*:*:go:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-31135
    reference_type:
    reference_id: CVE-2023-31135
