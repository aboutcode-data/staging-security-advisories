advisory_id: CVE-2025-39681
datasource_id: nvd_importer_v2/CVE-2025-39681
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39681
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/cpu/hygon: Add missing resctrl_cpu_detect() in bsp_init helper

  Since

    923f3a2b48bd ("x86/resctrl: Query LLC monitoring properties once during boot")

  resctrl_cpu_detect() has been moved from common CPU initialization code to
  the vendor-specific BSP init helper, while Hygon didn't put that call in their
  code.

  This triggers a division by zero fault during early booting stage on our
  machines with X86_FEATURE_CQM* supported, where get_rdt_mon_resources() tries
  to calculate mon_l3_config with uninitialized boot_cpu_data.x86_cache_occ_scale.

  Add the missing resctrl_cpu_detect() in the Hygon BSP init helper.

    [ bp: Massage commit message. ]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39681
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/62f12cde10118253348a7540e85606869bd69432
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7207923d8453ebfb35667c1736169f2dd796772e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/873f32201df8876bdb2563e3187e79149427cab4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a9e5924daa954c9f585c1ca00358afe71d6781c4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d23264c257a70dbe021b43b3bc2ee16134cd2c69
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d8df126349dad855cdfedd6bbf315bad2e901c2f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fb81222c1559f89bfe3aa1010f6d112531d55353
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39681
    reference_type:
    reference_id: CVE-2025-39681
