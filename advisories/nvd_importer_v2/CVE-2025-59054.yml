advisory_id: CVE-2025-59054
datasource_id: nvd_importer_v2/CVE-2025-59054
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-59054
aliases: []
summary: dstack is a software development kit (SDK) to simplify the deployment of arbitrary
  containerized apps into trusted execution environments. In versions of dstack prior to 0.5.4,
  a malicious host may provide a crafted LUKS2 data volume to a dstack CVM for use as the `/data`
  mount. The guest will open the volume and write secret data using a volume key known to the
  attacker, causing disclosure of Wireguard keys and other secret information. The attacker
  can also pre-load data on the device, which could potentially compromise guest execution.
  LUKS2 volume metadata is not authenticated and supports null key-encryption algorithms, allowing
  an attacker to create a volume such that the volume opens (cryptsetup open) without error
  using any passphrase or token, records all writes in plaintext (or ciphertext with an attacker-known
  key), and/or contains arbitrary data chosen by the attacker. Version 0.5.4 of dstack contains
  a patch that addresses LUKS headers.
impacted_packages: []
severities:
  - score: '8.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59054
weaknesses:
  - CWE-552
references:
  - url: https://blog.trailofbits.com/2025/10/30/vulnerabilities-in-luks2-disk-encryption-for-confidential-vms/
    reference_type:
    reference_id:
  - url: https://github.com/Dstack-TEE/dstack/blob/04de4e422bb06f075b4215b2cfc410f5d7ac7aed/dstack-util/src/system_setup.rs#L453-L456
    reference_type:
    reference_id:
  - url: https://github.com/Dstack-TEE/dstack/commit/e36ad5f732d8821876a861934e1f47cda7b1a130
    reference_type:
    reference_id:
  - url: https://github.com/Dstack-TEE/dstack/security/advisories/GHSA-jxq2-hpw3-m5wf
    reference_type:
    reference_id:
  - url: https://gitlab.com/cryptsetup/cryptsetup/-/merge_requests/837
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59054
    reference_type:
    reference_id: CVE-2025-59054
