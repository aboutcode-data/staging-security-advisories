advisory_id: CVE-2021-21405
datasource_id: nvd_importer_v2/CVE-2021-21405
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21405
aliases: []
summary: 'Lotus is an Implementation of the Filecoin protocol written in Go. BLS signature validation
  in lotus uses blst library method VerifyCompressed. This method accepts signatures in 2 forms:
  "serialized", and "compressed", meaning that BLS signatures can be provided as either of 2
  unique byte arrays. Lotus block validation functions perform a uniqueness check on provided
  blocks. Two blocks are considered distinct if the CIDs of their blockheader do not match.
  The CID method for blockheader includes the BlockSig of the block. The result of these issues
  is that it would be possible to punish miners for valid blocks, as there are two different
  valid block CIDs available for each block, even though this must be unique. By switching from
  the go based `blst` bindings over to the bindings in `filecoin-ffi`, the code paths now ensure
  that all signatures are compressed by size and the way they are deserialized. This happened
  in https://github.com/filecoin-project/lotus/pull/5393.'
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21405
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21405
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21405
weaknesses:
  - CWE-347
references:
  - url: https://gist.github.com/wadeAlexC/2490d522e81a796af9efcad1686e6754
    reference_type:
    reference_id:
  - url: https://github.com/filecoin-project/lotus/pull/5393
    reference_type:
    reference_id:
  - url: https://github.com/filecoin-project/lotus/security/advisories/GHSA-4g52-pqcj-phvh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:filecoin:lotus:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:filecoin:lotus:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21405
    reference_type:
    reference_id: CVE-2021-21405
