advisory_id: CVE-2022-50329
datasource_id: nvd_importer_v2/CVE-2022-50329
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50329
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  block, bfq: fix uaf for bfqq in bfq_exit_icq_bfqq

  Commit 64dc8c732f5c ("block, bfq: fix possible uaf for 'bfqq->bic'")
  will access 'bic->bfqq' in bic_set_bfqq(), however, bfq_exit_icq_bfqq()
  can free bfqq first, and then call bic_set_bfqq(), which will cause uaf.

  Fix the problem by moving bfq_exit_bfqq() behind bic_set_bfqq().
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50329
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/1425f1bb5df5239021fd09ebc2a5e8070e705d36
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1ed959fef5b1c6f1a7a3fbea543698c30ebd6678
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/246cf66e300b76099b5dbd3fdd39e9a5dbc53f02
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7949b0df3dd9f4817ed4a4e989fa9ee81df6205f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cfe5b38c37720313eff0dec5517442c7ab3c9a20
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.15.86:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.15.86:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0.16:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0.16:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1.2:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1.2:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50329
    reference_type:
    reference_id: CVE-2022-50329
