advisory_id: CVE-2024-50199
datasource_id: nvd_importer_v2/CVE-2024-50199
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-50199
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/swapfile: skip HugeTLB pages for unuse_vma

  I got a bad pud error and lost a 1GB HugeTLB when calling swapoff.  The
  problem can be reproduced by the following steps:

   1. Allocate an anonymous 1GB HugeTLB and some other anonymous memory.
   2. Swapout the above anonymous memory.
   3. run swapoff and we will get a bad pud error in kernel message:

    mm/pgtable-generic.c:42: bad pud 00000000743d215d(84000001400000e7)

  We can tell that pud_clear_bad is called by pud_none_or_clear_bad in
  unuse_pud_range() by ftrace.  And therefore the HugeTLB pages will never
  be freed because we lost it from page table.  We can skip HugeTLB pages
  for unuse_vma to fix it.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50199
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/417d5838ca73c6331ae2fe692fab6c25c00d9a0b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6ec0fe3756f941f42f8c57156b8bdf2877b2ebaf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7528c4fb1237512ee18049f852f014eba80bbe8d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ba7f982cdb37ff5a7739dec85d7325ea66fc1496
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bed2b9037806c62166a0ef9a559a1e7e3e1275b8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e41710f5a61aca9d6baaa8f53908a927dd9e7aa7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eb66a833cdd2f7302ee05d05e0fa12a2ca32eb87
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50199
    reference_type:
    reference_id: CVE-2024-50199
