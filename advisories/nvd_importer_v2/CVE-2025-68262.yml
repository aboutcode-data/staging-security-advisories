advisory_id: CVE-2025-68262
datasource_id: nvd_importer_v2/CVE-2025-68262
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68262
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  crypto: zstd - fix double-free in per-CPU stream cleanup

  The crypto/zstd module has a double-free bug that occurs when multiple
  tfms are allocated and freed.

  The issue happens because zstd_streams (per-CPU contexts) are freed in
  zstd_exit() during every tfm destruction, rather than being managed at
  the module level.  When multiple tfms exist, each tfm exit attempts to
  free the same shared per-CPU streams, resulting in a double-free.

  This leads to a stack trace similar to:

    BUG: Bad page state in process kworker/u16:1  pfn:106fd93
    page: refcount:0 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x106fd93
    flags: 0x17ffffc0000000(node=0|zone=2|lastcpupid=0x1fffff)
    page_type: 0xffffffff()
    raw: 0017ffffc0000000 dead000000000100 dead000000000122 0000000000000000
    raw: 0000000000000000 0000000000000000 00000000ffffffff 0000000000000000
    page dumped because: nonzero entire_mapcount
    Modules linked in: ...
    CPU: 3 UID: 0 PID: 2506 Comm: kworker/u16:1 Kdump: loaded Tainted: G    B
    Hardware name: ...
    Workqueue: btrfs-delalloc btrfs_work_helper
    Call Trace:
     <TASK>
     dump_stack_lvl+0x5d/0x80
     bad_page+0x71/0xd0
     free_unref_page_prepare+0x24e/0x490
     free_unref_page+0x60/0x170
     crypto_acomp_free_streams+0x5d/0xc0
     crypto_acomp_exit_tfm+0x23/0x50
     crypto_destroy_tfm+0x60/0xc0
     ...

  Change the lifecycle management of zstd_streams to free the streams only
  once during module cleanup.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/48bc9da3c97c15f1ea24934bcb3b736acd30163d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dc0f4509b0ed5d82bef78e058db0ac4df04d0695
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e983feaa79de1e46c9087fb9f02fedb0e5397ce6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68262
    reference_type:
    reference_id: CVE-2025-68262
