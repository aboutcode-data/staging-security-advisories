advisory_id: CVE-2025-39877
datasource_id: nvd_importer_v2/CVE-2025-39877
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39877
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/damon/sysfs:\
  \ fix use-after-free in state_show()\n\nstate_show() reads kdamond->damon_ctx without holding\
  \ damon_sysfs_lock. \nThis allows a use-after-free race:\n\nCPU 0                        \
  \ CPU 1\n-----                         -----\nstate_show()                  damon_sysfs_turn_damon_on()\n\
  ctx = kdamond->damon_ctx;     mutex_lock(&damon_sysfs_lock);\n                           \
  \   damon_destroy_ctx(kdamond->damon_ctx);\n                              kdamond->damon_ctx\
  \ = NULL;\n                              mutex_unlock(&damon_sysfs_lock);\ndamon_is_running(ctx);\
  \        /* ctx is freed */\nmutex_lock(&ctx->kdamond_lock); /* UAF */\n\n(The race can also\
  \ occur with damon_sysfs_kdamonds_rm_dirs() and\ndamon_sysfs_kdamond_release(), which free\
  \ or replace the context under\ndamon_sysfs_lock.)\n\nFix by taking damon_sysfs_lock before\
  \ dereferencing the context, mirroring\nthe locking used in pid_show().\n\nThe bug has existed\
  \ since state_show() first accessed kdamond->damon_ctx."
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39877
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/26d29b2ac87a2989071755f9828ebf839b560d4c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3260a3f0828e06f5f13fac69fb1999a6d60d9cff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3858c44341ad49dc7544b19cc9f9ecffaa7cc50e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4e87f461d61959647464a94d11ae15c011be58ce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/60d7a3d2b985a395318faa1d88da6915fad11c19
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39877
    reference_type:
    reference_id: CVE-2025-39877
