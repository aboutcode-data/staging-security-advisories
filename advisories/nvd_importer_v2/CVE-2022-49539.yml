advisory_id: CVE-2022-49539
datasource_id: nvd_importer_v2/CVE-2022-49539
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49539
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  rtw89: ser: fix CAM leaks occurring in L2 reset

  The CAM, meaning address CAM and bssid CAM here, will get leaks during
  SER (system error recover) L2 reset process and ieee80211_restart_hw()
  which is called by L2 reset process eventually.

  The normal flow would be like
  -> add interface (acquire 1)
  -> enter ips (release 1)
  -> leave ips (acquire 1)
  -> connection (occupy 1) <(A) 1 leak after L2 reset if non-sec connection>

  The ieee80211_restart_hw() flow (under connection)
  -> ieee80211 reconfig
  -> add interface (acquire 1)
  -> leave ips (acquire 1)
  -> connection (occupy (A) + 2) <(B) 1 more leak>

  Originally, CAM is released before HW restart only if connection is under
  security. Now, release CAM whatever connection it is to fix leak in (A).
  OTOH, check if CAM is already valid to avoid acquiring multiple times to
  fix (B).

  Besides, if AP mode, release address CAM of all stations before HW restart.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49539
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/b169f877f001a474fb89939842c390518160bcc5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6aff772c9978844529618d86aafb53e5d3ae161
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49539
    reference_type:
    reference_id: CVE-2022-49539
