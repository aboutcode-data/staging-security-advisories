advisory_id: CVE-2022-49493
datasource_id: nvd_importer_v2/CVE-2022-49493
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49493
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ASoC: rt5645: Fix errorenous cleanup order

  There is a logic error when removing rt5645 device as the function
  rt5645_i2c_remove() first cancel the &rt5645->jack_detect_work and
  delete the &rt5645->btn_check_timer latter. However, since the timer
  handler rt5645_btn_check_callback() will re-queue the jack_detect_work,
  this cleanup order is buggy.

  That is, once the del_timer_sync in rt5645_i2c_remove is concurrently
  run with the rt5645_btn_check_callback, the canceled jack_detect_work
  will be rescheduled again, leading to possible use-after-free.

  This patch fix the issue by placing the del_timer_sync function before
  the cancel_delayed_work_sync.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49493
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/061a6159cea583f1155f67d1915917a6b9282662
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0941150100173d4eaf3fe08ff4b16740e7c3026f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1a5a3dfd9f172dcb115072f0aea5e27d3083c20e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/236d29c5857f02e0a53fdf15d3dce1536c4322ce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2def44d3aec59e38d2701c568d65540783f90f2f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/453f0920ffc1a28e28ddb9c3cd5562472b2895b0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/88c09e4812d72c3153afc8e5a45ecac2d0eae3ff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/abe7554da62cb489712a54de69ef5665c250e564
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49493
    reference_type:
    reference_id: CVE-2022-49493
