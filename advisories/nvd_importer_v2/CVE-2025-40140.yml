advisory_id: CVE-2025-40140
datasource_id: nvd_importer_v2/CVE-2025-40140
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40140
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: usb: Remove\
  \ disruptive netif_wake_queue in rtl8150_set_multicast\n\nsyzbot reported WARNING in rtl8150_start_xmit/usb_submit_urb.\n\
  This is the sequence of events that leads to the warning:\n\nrtl8150_start_xmit() {\n\tnetif_stop_queue();\n\
  \tusb_submit_urb(dev->tx_urb);\n}\n\nrtl8150_set_multicast() {\n\tnetif_stop_queue();\n\t\
  netif_wake_queue();\t\t<-- wakes up TX queue before URB is done\n}\n\nrtl8150_start_xmit()\
  \ {\n\tnetif_stop_queue();\n\tusb_submit_urb(dev->tx_urb);\t<-- double submission\n}\n\nrtl8150_set_multicast\
  \ being the ndo_set_rx_mode callback should not be\ncalling netif_stop_queue and notif_start_queue\
  \ as these handle\nTX queue synchronization.\n\nThe net core function dev_set_rx_mode handles\
  \ the synchronization\nfor rtl8150_set_multicast making it safe to remove these locks."
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/114e05344763a102a8844efd96ec06ba99293ccd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1a08a37ac03d07a1608a1592791041cac979fbc3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/54f8ef1a970a8376e5846ed90854decf7c00555d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6053e47bbf212b93c051beb4261d7d5a409d0ce3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6394bade9daab8e318c165fe43bba012bf13cd8e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/958baf5eaee394e5fd976979b0791a875f14a179
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9d72df7f5eac946f853bf49c428c4e87a17d91da
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cce3c0e21cdd15bcba5c35d3af1700186de8f187
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40140
    reference_type:
    reference_id: CVE-2025-40140
