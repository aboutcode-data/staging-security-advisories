advisory_id: CVE-2022-50720
datasource_id: nvd_importer_v2/CVE-2022-50720
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50720
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/apic: Don't disable x2APIC if locked

  The APIC supports two modes, legacy APIC (or xAPIC), and Extended APIC
  (or x2APIC).  X2APIC mode is mostly compatible with legacy APIC, but
  it disables the memory-mapped APIC interface in favor of one that uses
  MSRs.  The APIC mode is controlled by the EXT bit in the APIC MSR.

  The MMIO/xAPIC interface has some problems, most notably the APIC LEAK
  [1].  This bug allows an attacker to use the APIC MMIO interface to
  extract data from the SGX enclave.

  Introduce support for a new feature that will allow the BIOS to lock
  the APIC in x2APIC mode.  If the APIC is locked in x2APIC mode and the
  kernel tries to disable the APIC or revert to legacy APIC mode a GP
  fault will occur.

  Introduce support for a new MSR (IA32_XAPIC_DISABLE_STATUS) and handle
  the new locked mode when the LEGACY_XAPIC_DISABLED bit is set by
  preventing the kernel from trying to disable the x2APIC.

  On platforms with the IA32_XAPIC_DISABLE_STATUS MSR, if SGX or TDX are
  enabled the LEGACY_XAPIC_DISABLED will be set by the BIOS.  If
  legacy APIC is required, then it SGX and TDX need to be disabled in the
  BIOS.

  [1]: https://aepicleak.com/aepicleak.pdf
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/05785ba834f23272f9d23427ae4a80ac505a5296
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b8d1d163604bd1e600b062fb00de5dc42baa355f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd1241e00addbf0b95f6cd6ce32152692820657e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50720
    reference_type:
    reference_id: CVE-2022-50720
