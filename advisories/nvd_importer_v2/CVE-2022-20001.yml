advisory_id: CVE-2022-20001
datasource_id: nvd_importer_v2/CVE-2022-20001
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-20001
aliases: []
summary: fish is a command line shell. fish version 3.1.0 through version 3.3.1 is vulnerable
  to arbitrary code execution. git repositories can contain per-repository configuration that
  change the behavior of git, including running arbitrary commands. When using the default configuration
  of fish, changing to a directory automatically runs `git` commands in order to display information
  about the current repository in the prompt. If an attacker can convince a user to change their
  current directory into one controlled by the attacker, such as on a shared file system or
  extracted archive, fish will run arbitrary commands under the attacker's control. This problem
  has been fixed in fish 3.4.0. Note that running git in these directories, including using
  the git tab completion, remains a potential trigger for this issue. As a workaround, remove
  the `fish_git_prompt` function from the prompt.
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-20001
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-20001
weaknesses:
  - CWE-427
  - CWE-74
references:
  - url: https://github.com/fish-shell/fish-shell/pull/8589
    reference_type:
    reference_id:
  - url: https://github.com/fish-shell/fish-shell/releases/tag/3.4.0
    reference_type:
    reference_id:
  - url: https://github.com/fish-shell/fish-shell/security/advisories/GHSA-pj5f-6vxj-f5mq
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BPZ7JV22DSZB5LNUCUEJ2HO3PKM2TVVK/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TRNMYS2LKB6TKOOBQQRSRQICDMWLZ4QL/
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202309-10
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2022/dsa-5234
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:fishshell:fish:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:fishshell:fish:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-20001
    reference_type:
    reference_id: CVE-2022-20001
