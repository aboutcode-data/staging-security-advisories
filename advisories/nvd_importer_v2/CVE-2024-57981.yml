advisory_id: CVE-2024-57981
datasource_id: nvd_importer_v2/CVE-2024-57981
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-57981
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: xhci: Fix NULL pointer dereference on certain command aborts

  If a command is queued to the final usable TRB of a ring segment, the
  enqueue pointer is advanced to the subsequent link TRB and no further.
  If the command is later aborted, when the abort completion is handled
  the dequeue pointer is advanced to the first TRB of the next segment.

  If no further commands are queued, xhci_handle_stopped_cmd_ring() sees
  the ring pointers unequal and assumes that there is a pending command,
  so it calls xhci_mod_cmd_timer() which crashes if cur_cmd was NULL.

  Don't attempt timer setup if cur_cmd is NULL. The subsequent doorbell
  ring likely is unnecessary too, but it's harmless. Leave it alone.

  This is probably Bug 219532, but no confirmation has been received.

  The issue has been independently reproduced and confirmed fixed using
  a USB MCU programmed to NAK the Status stage of SET_ADDRESS forever.
  Everything continued working normally after several prevented crashes.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-57981
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/0ce5c0dac768be14afe2426101b568a0f66bfc4d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1e0a19912adb68a4b2b74fd77001c96cd83eb073
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4ff18870af793ce2034a6ad746e91d0a3d985b88
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ae069cd2ba09a2bd6a87a68c59ef0b7ea39cd641
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b44253956407046e5907d4d72c8fa5b93ae94485
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b649f0d5bc256f691c7d234c3986685d54053de1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cf30300a216a4f8dce94e11781a866a09d4b50d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fd8bfaeba4a85b14427899adec0efb3954300653
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00028.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-57981
    reference_type:
    reference_id: CVE-2024-57981
