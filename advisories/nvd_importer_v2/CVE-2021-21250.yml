advisory_id: CVE-2021-21250
datasource_id: nvd_importer_v2/CVE-2021-21250
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21250
aliases: []
summary: OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, there is a
  critical vulnerability which may lead to arbitrary file read. When BuildSpec is provided in
  XML format, the spec is processed by XmlBuildSpecMigrator.migrate(buildSpecString); which
  processes the XML document without preventing the expansion of external entities. These entities
  can be configured to read arbitrary files from the file system and dump their contents in
  the final XML document to be migrated. If the files are dumped in properties included in the
  YAML file, it will be possible for an attacker to read them. If not, it is possible for an
  attacker to exfiltrate the contents of these files Out Of Band. This issue was addressed in
  4.0.3 by ignoring ENTITY instructions in xml file.
impacted_packages: []
severities:
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21250
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21250
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21250
weaknesses:
  - CWE-538
references:
  - url: https://github.com/theonedev/onedev/commit/9196fd795e87dab069b4260a3590a0ea886e770f
    reference_type:
    reference_id:
  - url: https://github.com/theonedev/onedev/security/advisories/GHSA-9pph-8gfc-6w2r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21250
    reference_type:
    reference_id: CVE-2021-21250
