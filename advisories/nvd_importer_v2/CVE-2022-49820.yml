advisory_id: CVE-2022-49820
datasource_id: nvd_importer_v2/CVE-2022-49820
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49820
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mctp i2c: don't count unused / invalid keys for flow release

  We're currently hitting the WARN_ON in mctp_i2c_flow_release:

      if (midev->release_count > midev->i2c_lock_count) {
          WARN_ONCE(1, "release count overflow");

  This may be hit if we expire a flow before sending the first packet it
  contains - as we will not be pairing the increment of release_count
  (performed on flow release) with the i2c lock operation (only
  performed on actual TX).

  To fix this, only release a flow if we've encountered it previously (ie,
  dev_flow_state does not indicate NEW), as we will mark the flow as
  ACTIVE at the same time as accounting for the i2c lock operation. We
  also need to add an INVALID flow state, to indicate when we've done the
  release.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49820
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/9cbd48d5fa14e4c65f8580de16686077f7cea02b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a5915a9a3ab4067ef8996a57738d156eabeb3a12
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49820
    reference_type:
    reference_id: CVE-2022-49820
