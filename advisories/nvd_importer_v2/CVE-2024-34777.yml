advisory_id: CVE-2024-34777
datasource_id: nvd_importer_v2/CVE-2024-34777
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-34777
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dma-mapping: benchmark: fix node id validation

  While validating node ids in map_benchmark_ioctl(), node_possible() may
  be provided with invalid argument outside of [0,MAX_NUMNODES-1] range
  leading to:

  BUG: KASAN: wild-memory-access in map_benchmark_ioctl (kernel/dma/map_benchmark.c:214)
  Read of size 8 at addr 1fffffff8ccb6398 by task dma_map_benchma/971
  CPU: 7 PID: 971 Comm: dma_map_benchma Not tainted 6.9.0-rc6 #37
  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996)
  Call Trace:
   <TASK>
  dump_stack_lvl (lib/dump_stack.c:117)
  kasan_report (mm/kasan/report.c:603)
  kasan_check_range (mm/kasan/generic.c:189)
  variable_test_bit (arch/x86/include/asm/bitops.h:227) [inline]
  arch_test_bit (arch/x86/include/asm/bitops.h:239) [inline]
  _test_bit at (include/asm-generic/bitops/instrumented-non-atomic.h:142) [inline]
  node_state (include/linux/nodemask.h:423) [inline]
  map_benchmark_ioctl (kernel/dma/map_benchmark.c:214)
  full_proxy_unlocked_ioctl (fs/debugfs/file.c:333)
  __x64_sys_ioctl (fs/ioctl.c:890)
  do_syscall_64 (arch/x86/entry/common.c:83)
  entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)

  Compare node ids with sane bounds first. NUMA_NO_NODE is considered a
  special valid case meaning that benchmarking kthreads won't be bound to a
  cpuset of a given node.

  Found by Linux Verification Center (linuxtesting.org).
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-34777
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/1ff05e723f7ca30644b8ec3fb093f16312e408ad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/34a816d8735f3924b74be8e5bf766ade1f3bd10b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35d31c8bd4722b107f5a2f5ddddce839de04b936
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/63e7e05a48a35308aeddd7ecccb68363a5988e87
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c57874265a3c5206d7aece3793bb2fc9abcd7570
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-34777
    reference_type:
    reference_id: CVE-2024-34777
