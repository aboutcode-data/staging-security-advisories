advisory_id: CVE-2024-26752
datasource_id: nvd_importer_v2/CVE-2024-26752
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26752
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  l2tp: pass correct message length to ip6_append_data

  l2tp_ip6_sendmsg needs to avoid accounting for the transport header
  twice when splicing more data into an already partially-occupied skbuff.

  To manage this, we check whether the skbuff contains data using
  skb_queue_empty when deciding how much data to append using
  ip6_append_data.

  However, the code which performed the calculation was incorrect:

       ulen = len + skb_queue_empty(&sk->sk_write_queue) ? transhdrlen : 0;

  ...due to C operator precedence, this ends up setting ulen to
  transhdrlen for messages with a non-zero length, which results in
  corrupted packets on the wire.

  Add parentheses to correct the calculation in line with the original
  intent.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26752
weaknesses:
  - CWE-131
references:
  - url: https://git.kernel.org/stable/c/0da15a70395182ee8cb75716baf00dddc0bea38d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/13cd1daeea848614e585b2c6ecc11ca9c8ab2500
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/359e54a93ab43d32ee1bff3c2f9f10cb9f6b6e79
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4c3ce64bc9d36ca9164dd6c77ff144c121011aae
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/804bd8650a3a2bf3432375f8c97d5049d845ce56
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/83340c66b498e49353530e41542500fc8a4782d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c1d3a84a67db910ce28a871273c992c3d7f9efb5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dcb4d14268595065c85dc5528056713928e17243
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.14.327:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.14.327:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5.7:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5.7:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26752
    reference_type:
    reference_id: CVE-2024-26752
