advisory_id: CVE-2023-34967
datasource_id: nvd_importer_v2/CVE-2023-34967
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-34967
aliases: []
summary: A Type Confusion vulnerability was found in Samba's mdssvc RPC service for Spotlight.
  When parsing Spotlight mdssvc RPC packets, one encoded data structure is a key-value style
  dictionary where the keys are character strings, and the values can be any of the supported
  types in the mdssvc protocol. Due to a lack of type checking in callers of the dalloc_value_for_key()
  function, which returns the object associated with a key, a caller may trigger a crash in
  talloc_get_size() when talloc detects that the passed-in pointer is not a valid talloc pointer.
  With an RPC worker process shared among multiple client connections, a malicious client or
  attacker can trigger a process crash in a shared RPC mdssvc worker process, affecting all
  other clients this worker serves.
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34967
weaknesses:
  - CWE-843
references:
  - url: https://access.redhat.com/security/cve/CVE-2023-34967
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BPCSGND7LO467AJGR5DYBGZLTCGTOBCC/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OT74M42E6C36W7PQVY3OS4ZM7DVYB64Z/
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230731-0010/
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2023/dsa-5477
    reference_type:
    reference_id:
  - url: https://www.samba.org/samba/security/CVE-2023-34967.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2222794
    reference_type: bug
    reference_id: 2222794
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:12.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:12.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:redhat:enterprise_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:redhat:enterprise_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34967
    reference_type:
    reference_id: CVE-2023-34967
  - url: https://access.redhat.com/errata/RHSA-2023:6667
    reference_type:
    reference_id: RHSA-2023:6667
  - url: https://access.redhat.com/errata/RHSA-2023:7139
    reference_type:
    reference_id: RHSA-2023:7139
  - url: https://access.redhat.com/errata/RHSA-2024:0423
    reference_type:
    reference_id: RHSA-2024:0423
  - url: https://access.redhat.com/errata/RHSA-2024:0580
    reference_type:
    reference_id: RHSA-2024:0580
