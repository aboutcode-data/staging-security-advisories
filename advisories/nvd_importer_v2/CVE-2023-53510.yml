advisory_id: CVE-2023-53510
datasource_id: nvd_importer_v2/CVE-2023-53510
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53510
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: ufs: core: Fix handling of lrbp->cmd

  ufshcd_queuecommand() may be called two times in a row for a SCSI command
  before it is completed. Hence make the following changes:

   - In the functions that submit a command, do not check the old value of
     lrbp->cmd nor clear lrbp->cmd in error paths.

   - In ufshcd_release_scsi_cmd(), do not clear lrbp->cmd.

  See also scsi_send_eh_cmnd().

  This commit prevents that the following appears if a command times out:

  WARNING: at drivers/ufs/core/ufshcd.c:2965 ufshcd_queuecommand+0x6f8/0x9a8
  Call trace:
   ufshcd_queuecommand+0x6f8/0x9a8
   scsi_send_eh_cmnd+0x2c0/0x960
   scsi_eh_test_devices+0x100/0x314
   scsi_eh_ready_devs+0xd90/0x114c
   scsi_error_handler+0x2b4/0xb70
   kthread+0x16c/0x1e0
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53510
weaknesses:
  - CWE-415
references:
  - url: https://git.kernel.org/stable/c/49234a401e161a2f2698f4612ab792c49b3cad1b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/549e91a9bbaa0ee480f59357868421a61d369770
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f3ee24af62681b942bbd799ac77b90a6d7e1fdb1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53510
    reference_type:
    reference_id: CVE-2023-53510
