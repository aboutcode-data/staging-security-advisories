advisory_id: CVE-2021-40824
datasource_id: nvd_importer_v2/CVE-2021-40824
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-40824
aliases: []
summary: A logic error in the room key sharing functionality of Element Android before 1.2.2
  and matrix-android-sdk2 (aka Matrix SDK for Android) before 1.2.2 allows a malicious Matrix
  homeserver present in an encrypted room to steal room encryption keys (via crafted Matrix
  protocol messages) that were originally sent by affected Matrix clients participating in that
  room. This allows the attacker to decrypt end-to-end encrypted messages sent by affected clients.
impacted_packages: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40824
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40824
weaknesses:
  - CWE-290
references:
  - url: https://github.com/matrix-org/matrix-android-sdk2/releases/tag/v1.2.2
    reference_type:
    reference_id:
  - url: https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:element:*:*:*:*:*:android:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:element:*:*:*:*:*:android:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:matrix-android-sdk2:*:*:*:*:*:android:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:matrix-android-sdk2:*:*:*:*:*:android:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-40824
    reference_type:
    reference_id: CVE-2021-40824
