advisory_id: CVE-2024-37155
datasource_id: nvd_importer_v2/CVE-2024-37155
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-37155
aliases: []
summary: OpenCTI is an open source platform allowing organizations to manage their cyber threat
  intelligence knowledge and observables. Prior to version 6.1.9, the regex validation used
  to prevent Introspection queries can be bypassed by removing the extra whitespace, carriage
  return, and line feed characters from the query. GraphQL Queries in OpenCTI can be validated
  using the `secureIntrospectionPlugin`. The regex check in the plkugin can be bypassed by removing
  the carriage return and line feed characters (`\r\n`).  Running a curl command against a local
  instance of OpenCTI will result in a limited error message. By running the same Introspection
  query without the `\r\n` characters, the unauthenticated user is able to successfully run
  a full Introspection query. Bypassing this restriction allows the attacker to gather a wealth
  of information about the GraphQL endpoint functionality that can be used to perform actions
  and/or read data without authorization.  These queries can also be weaponized to conduct a
  Denial of Service (DoS) attack if sent repeatedly. Users should upgrade to version 6.1.9 to
  receive a patch for the issue.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37155
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37155
weaknesses:
  - CWE-284
references:
  - url: https://github.com/OpenCTI-Platform/opencti/blob/6343b82b0b0a5d3ded3b30d08ce282328a556268/opencti-platform/opencti-graphql/src/graphql/graphql.js#L83-L94
    reference_type:
    reference_id:
  - url: https://github.com/OpenCTI-Platform/opencti/commit/f87d96918c63b0c3d3ebfbea6c789d48e2f56ad5
    reference_type:
    reference_id:
  - url: https://github.com/OpenCTI-Platform/opencti/security/advisories/GHSA-4mvw-j8r9-xcgc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:citeum:opencti:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:citeum:opencti:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37155
    reference_type:
    reference_id: CVE-2024-37155
