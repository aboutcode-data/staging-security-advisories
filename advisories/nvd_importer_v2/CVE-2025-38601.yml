advisory_id: CVE-2025-38601
datasource_id: nvd_importer_v2/CVE-2025-38601
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38601
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: ath11k: clear initialized flag for deinit-ed srng lists

  In a number of cases we see kernel panics on resume due
  to ath11k kernel page fault, which happens under the
  following circumstances:

  1) First ath11k_hal_dump_srng_stats() call

   Last interrupt received for each group:
   ath11k_pci 0000:01:00.0: group_id 0 22511ms before
   ath11k_pci 0000:01:00.0: group_id 1 14440788ms before
   [..]
   ath11k_pci 0000:01:00.0: failed to receive control response completion, polling..
   ath11k_pci 0000:01:00.0: Service connect timeout
   ath11k_pci 0000:01:00.0: failed to connect to HTT: -110
   ath11k_pci 0000:01:00.0: failed to start core: -110
   ath11k_pci 0000:01:00.0: firmware crashed: MHI_CB_EE_RDDM
   ath11k_pci 0000:01:00.0: already resetting count 2
   ath11k_pci 0000:01:00.0: failed to wait wlan mode request (mode 4): -110
   ath11k_pci 0000:01:00.0: qmi failed to send wlan mode off: -110
   ath11k_pci 0000:01:00.0: failed to reconfigure driver on crash recovery
   [..]

  2) At this point reconfiguration fails (we have 2 resets) and
    ath11k_core_reconfigure_on_crash() calls ath11k_hal_srng_deinit()
    which destroys srng lists.  However, it does not reset per-list
    ->initialized flag.

  3) Second ath11k_hal_dump_srng_stats() call sees stale ->initialized
    flag and attempts to dump srng stats:

   Last interrupt received for each group:
   ath11k_pci 0000:01:00.0: group_id 0 66785ms before
   ath11k_pci 0000:01:00.0: group_id 1 14485062ms before
   ath11k_pci 0000:01:00.0: group_id 2 14485062ms before
   ath11k_pci 0000:01:00.0: group_id 3 14485062ms before
   ath11k_pci 0000:01:00.0: group_id 4 14780845ms before
   ath11k_pci 0000:01:00.0: group_id 5 14780845ms before
   ath11k_pci 0000:01:00.0: group_id 6 14485062ms before
   ath11k_pci 0000:01:00.0: group_id 7 66814ms before
   ath11k_pci 0000:01:00.0: group_id 8 68997ms before
   ath11k_pci 0000:01:00.0: group_id 9 67588ms before
   ath11k_pci 0000:01:00.0: group_id 10 69511ms before
   BUG: unable to handle page fault for address: ffffa007404eb010
   #PF: supervisor read access in kernel mode
   #PF: error_code(0x0000) - not-present page
   PGD 100000067 P4D 100000067 PUD 10022d067 PMD 100b01067 PTE 0
   Oops: 0000 [#1] PREEMPT SMP NOPTI
   RIP: 0010:ath11k_hal_dump_srng_stats+0x2b4/0x3b0 [ath11k]
   Call Trace:
   <TASK>
   ? __die_body+0xae/0xb0
   ? page_fault_oops+0x381/0x3e0
   ? exc_page_fault+0x69/0xa0
   ? asm_exc_page_fault+0x22/0x30
   ? ath11k_hal_dump_srng_stats+0x2b4/0x3b0 [ath11k (HASH:6cea 4)]
   ath11k_qmi_driver_event_work+0xbd/0x1050 [ath11k (HASH:6cea 4)]
   worker_thread+0x389/0x930
   kthread+0x149/0x170

  Clear per-list ->initialized flag in ath11k_hal_srng_deinit().
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38601
weaknesses:
  - CWE-909
references:
  - url: https://git.kernel.org/stable/c/0ebb5fe494501c19f31270008b26ab95201af6fd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/16872194c80f2724472fc207991712895ac8a230
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3a6daae987a829534636fd85ed6f84d5f0ad7fa4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5bf201c55fdf303e79005038648dfa1e8af48f54
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/72a48be1f53942793f3bc68a37fad1f38b53b082
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/916ac18d526a26f6072866b1a97622cf1351ef1c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a5b46aa7cf5f05c213316a018e49a8e086efd98e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eff3bb53c18c0ed4ab6f43d412b3ed3aecad52d5
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38601
    reference_type:
    reference_id: CVE-2025-38601
