advisory_id: CVE-2023-52618
datasource_id: nvd_importer_v2/CVE-2023-52618
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-52618
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  block/rnbd-srv: Check for unlikely string overflow

  Since "dev_search_path" can technically be as large as PATH_MAX,
  there was a risk of truncation when copying it and a second string
  into "full_path" since it was also PATH_MAX sized. The W=1 builds were
  reporting this warning:

  drivers/block/rnbd/rnbd-srv.c: In function 'process_msg_open.isra':
  drivers/block/rnbd/rnbd-srv.c:616:51: warning: '%s' directive output may be truncated writing up to 254 bytes into a region of size between 0 and 4095 [-Wformat-truncation=]
    616 |                 snprintf(full_path, PATH_MAX, "%s/%s",
        |                                                   ^~
  In function 'rnbd_srv_get_full_path',
      inlined from 'process_msg_open.isra' at drivers/block/rnbd/rnbd-srv.c:721:14: drivers/block/rnbd/rnbd-srv.c:616:17: note: 'snprintf' output between 2 and 4351 bytes into a destination of size 4096
    616 |                 snprintf(full_path, PATH_MAX, "%s/%s",
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    617 |                          dev_search_path, dev_name);
        |                          ~~~~~~~~~~~~~~~~~~~~~~~~~~

  To fix this, unconditionally check for truncation (as was already done
  for the case where "%SESSNAME%" was present).
impacted_packages: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52618
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/5b9ea86e662035a886ccb5c76d56793cba618827
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95bc866c11974d3e4a9d922275ea8127ff809cf7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e4bf6a08d1e127bcc4bd72557f2dfafc6bc7f41
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a2c6206f18104fba7f887bf4dbbfe4c41adc4339
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/af7bbdac89739e2e7380387fda598848d3b7010f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6abd5e17da33eba15df2bddc93413e76c2b55f7
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52618
    reference_type:
    reference_id: CVE-2023-52618
