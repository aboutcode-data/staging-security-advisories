advisory_id: CVE-2023-25149
datasource_id: nvd_importer_v2/CVE-2023-25149
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-25149
aliases: []
summary: |
  TimescaleDB, an open-source time-series SQL database, has a privilege escalation vulnerability in versions 2.8.0 through 2.9.2. During installation, TimescaleDB creates a telemetry job that is runs as the installation user. The queries run as part of the telemetry data collection were not run with a locked down `search_path`, allowing malicious users to create functions that would be executed by the telemetry job, leading to privilege escalation. In order to be able to take advantage of this vulnerability, a user would need to be able to create objects in a database and then get a superuser to install TimescaleDB into their database. When TimescaleDB is installed as trusted extension, non-superusers can install the extension without help from a superuser.

  Version 2.9.3 fixes this issue. As a mitigation, the `search_path` of the user running the telemetry job can be locked down to not include schemas writable by other users. The vulnerability is not exploitable on instances in Timescale Cloud and Managed Service for TimescaleDB due to additional security provisions in place on those platforms.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-25149
weaknesses:
  - CWE-269
  - CWE-284
references:
  - url: https://github.com/timescale/timescaledb/pull/5259
    reference_type:
    reference_id:
  - url: https://github.com/timescale/timescaledb/releases/tag/2.9.3
    reference_type:
    reference_id:
  - url: https://github.com/timescale/timescaledb/security/advisories/GHSA-44jh-j22r-33wq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:timescale:timescaledb:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:timescale:timescaledb:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-25149
    reference_type:
    reference_id: CVE-2023-25149
