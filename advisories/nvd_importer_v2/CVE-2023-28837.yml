advisory_id: CVE-2023-28837
datasource_id: nvd_importer_v2/CVE-2023-28837
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-28837
aliases: []
summary: "Wagtail is an open source content management system built on Django. Prior to versions\
  \ 4.1.4 and 4.2.2, a memory exhaustion bug exists in Wagtail's handling of uploaded images\
  \ and documents. For both images and documents, files are loaded into memory during upload\
  \ for additional processing. A user with access to upload images or documents through the\
  \ Wagtail admin interface could upload a file so large that it results in a crash of denial\
  \ of service.\n\nThe vulnerability is not exploitable by an ordinary site visitor without\
  \ access to the Wagtail admin. It can only be exploited by admin users with permission to\
  \ upload images or documents.\n\nImage uploads are restricted to 10MB by default, however\
  \ this validation only happens on the frontend and on the backend after the vulnerable code.\
  \ \n\nPatched versions have been released as Wagtail 4.1.4 and Wagtail 4.2.2). Site owners\
  \ who are unable to upgrade to the new versions are encouraged to add extra protections outside\
  \ of Wagtail to limit the size of uploaded files."
impacted_packages: []
severities:
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-28837
weaknesses:
  - CWE-770
  - CWE-400
references:
  - url: https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/3c0c64642b9e5b8d28b111263c7f4bddad6c3880
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/c9d2fcd650a88d76ae122646142245e5927a9165
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/cfa11bbe00dbe7ce8cd4c0bbfe2a898a690df2bf
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/commit/d4022310cbe497993459c3136311467c7ac6329a
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/releases/tag/v4.1.4
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/releases/tag/v4.2.2
    reference_type:
    reference_id:
  - url: https://github.com/wagtail/wagtail/security/advisories/GHSA-33pv-vcgh-jfg9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:torchbox:wagtail:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:torchbox:wagtail:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-28837
    reference_type:
    reference_id: CVE-2023-28837
