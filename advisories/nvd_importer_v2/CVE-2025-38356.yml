advisory_id: CVE-2025-38356
datasource_id: nvd_importer_v2/CVE-2025-38356
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38356
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/xe/guc: Explicitly exit CT safe mode on unwind

  During driver probe we might be briefly using CT safe mode, which
  is based on a delayed work, but usually we are able to stop this
  once we have IRQ fully operational.  However, if we abort the probe
  quite early then during unwind we might try to destroy the workqueue
  while there is still a pending delayed work that attempts to restart
  itself which triggers a WARN.

  This was recently observed during unsuccessful VF initialization:

   [ ] xe 0000:00:02.1: probe with driver xe failed with error -62
   [ ] ------------[ cut here ]------------
   [ ] workqueue: cannot queue safe_mode_worker_func [xe] on wq xe-g2h-wq
   [ ] WARNING: CPU: 9 PID: 0 at kernel/workqueue.c:2257 __queue_work+0x287/0x710
   [ ] RIP: 0010:__queue_work+0x287/0x710
   [ ] Call Trace:
   [ ]  delayed_work_timer_fn+0x19/0x30
   [ ]  call_timer_fn+0xa1/0x2a0

  Exit the CT safe mode on unwind to avoid that warning.

  (cherry picked from commit 2ddbb73ec20b98e70a5200cb85deade22ccea2ec)
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38356
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/6d0b588614c43d6334b2d7a70a99f31f7b14ecc0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ad40098da5c3b43114d860a5b5740e7204158534
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f161e905b08ae8a513c5a36a10e3163e9920cfe6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38356
    reference_type:
    reference_id: CVE-2025-38356
