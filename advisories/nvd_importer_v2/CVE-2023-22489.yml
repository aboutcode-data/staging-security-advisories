advisory_id: CVE-2023-22489
datasource_id: nvd_importer_v2/CVE-2023-22489
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-22489
aliases: []
summary: Flarum is a discussion platform for websites. If the first post of a discussion is
  permanently deleted but the discussion stays visible, any actor who can view the discussion
  is able to create a new reply via the REST API, no matter the reply permission or lock status.
  This includes users that don't have a validated email. Guests cannot successfully create a
  reply because the API will fail with a 500 error when the user ID 0 is inserted into the database.
  This happens because when the first post of a discussion is permanently deleted, the `first_post_id`
  attribute of the discussion becomes `null` which causes access control to be skipped for all
  new replies. Flarum automatically makes discussions with zero comments invisible so an additional
  condition for this vulnerability is that the discussion must have at least one approved reply
  so that `discussions.comment_count` is still above zero after the post deletion. This can
  open the discussion to uncontrolled spam or just unintentional replies if users still had
  their tab open before the vulnerable discussion was locked and then post a reply when they
  shouldn't be able to. In combination with the email notification settings, this could also
  be used as a way to send unsolicited emails. Versions between `v1.3.0` and `v1.6.3` are impacted.
  The vulnerability has been fixed and published as flarum/core v1.6.3. All communities running
  Flarum should upgrade as soon as possible. There are no known workarounds.
impacted_packages: []
severities:
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-22489
weaknesses:
  - CWE-862
references:
  - url: https://github.com/flarum/framework/commit/12f14112a0ecd1484d97330b82beb2a145919015
    reference_type:
    reference_id:
  - url: https://github.com/flarum/framework/releases/tag/v1.6.3
    reference_type:
    reference_id:
  - url: https://github.com/flarum/framework/security/advisories/GHSA-hph3-hv3c-7725
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:flarum:flarum:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:flarum:flarum:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-22489
    reference_type:
    reference_id: CVE-2023-22489
