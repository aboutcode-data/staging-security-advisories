advisory_id: CVE-2025-38721
datasource_id: nvd_importer_v2/CVE-2025-38721
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38721
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter:\
  \ ctnetlink: fix refcount leak on table dump\n\nThere is a reference count leak in ctnetlink_dump_table():\n\
  \      if (res < 0) {\n                nf_conntrack_get(&ct->ct_general); // HERE\n      \
  \          cb->args[1] = (unsigned long)ct;\n                ...\n\nWhile its very unlikely,\
  \ its possible that ct == last.\nIf this happens, then the refcount of ct was already incremented.\n\
  This 2nd increment is never undone.\n\nThis prevents the conntrack object from being released,\
  \ which in turn\nkeeps prevents cnet->count from dropping back to 0.\n\nThis will then block\
  \ the netns dismantle (or conntrack rmmod) as\nnf_conntrack_cleanup_net_list() will wait forever.\n\
  \nThis can be reproduced by running conntrack_resize.sh selftest in a loop.\nIt takes ~20\
  \ minutes for me on a preemptible kernel on average before\nI see a runaway kworker spinning\
  \ in nf_conntrack_cleanup_net_list.\n\nOne fix would to change this to:\n        if (res <\
  \ 0) {\n\t\tif (ct != last)\n\t                nf_conntrack_get(&ct->ct_general);\n\nBut this\
  \ reference counting isn't needed in the first place.\nWe can just store a cookie value instead.\n\
  \nA followup patch will do the same for ctnetlink_exp_dump_table,\nit looks to me as if this\
  \ has the same problem and like\nctnetlink_dump_table, we only need a 'skip hint', not the\
  \ actual\nobject so we can apply the same cookie strategy there as well."
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38721
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/19b909a4b1452fb97e477d2f08b97f8d04095619
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/30cf811058552b8cd0e98dff677ef3f89d6d34ce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/41462f4cfc583513833f87f9ee55d12da651a7e3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/586892e341fbf698e7cbaca293e1353957db725a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/962518c6ca9f9a13df099cafa429f72f68ad61f0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a2cb4df7872de069f809de2f076ec8e54d649fe3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a62d6aa3f31f216b637a4c71b7a8bfc7c57f049b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/de788b2e6227462b6dcd0e07474e72c089008f74
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e14f72aa66c029db106921d621edcedef68e065b
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:2.6.18:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:2.6.18:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:2.6.18:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:2.6.18:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:2.6.18:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:2.6.18:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:2.6.18:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:2.6.18:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38721
    reference_type:
    reference_id: CVE-2025-38721
