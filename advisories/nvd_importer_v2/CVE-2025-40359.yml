advisory_id: CVE-2025-40359
datasource_id: nvd_importer_v2/CVE-2025-40359
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40359
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  perf/x86/intel: Fix KASAN global-out-of-bounds warning

  When running "perf mem record" command on CWF, the below KASAN
  global-out-of-bounds warning is seen.

    ==================================================================
    BUG: KASAN: global-out-of-bounds in cmt_latency_data+0x176/0x1b0
    Read of size 4 at addr ffffffffb721d000 by task dtlb/9850

    Call Trace:

     kasan_report+0xb8/0xf0
     cmt_latency_data+0x176/0x1b0
     setup_arch_pebs_sample_data+0xf49/0x2560
     intel_pmu_drain_arch_pebs+0x577/0xb00
     handle_pmi_common+0x6c4/0xc80

  The issue is caused by below code in __grt_latency_data(). The code
  tries to access x86_hybrid_pmu structure which doesn't exist on
  non-hybrid platform like CWF.

          WARN_ON_ONCE(hybrid_pmu(event->pmu)->pmu_type == hybrid_big)

  So add is_hybrid() check before calling this WARN_ON_ONCE to fix the
  global-out-of-bounds access issue.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0ba6502ce167fc3d598c08c2cc3b4ed7ca5aa251
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1b61a1da3d8105ea1be548c94c2856697eb7ffd1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/710a72e81a7028e1ad1a10eb14f941f8dd45ffd3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40359
    reference_type:
    reference_id: CVE-2025-40359
