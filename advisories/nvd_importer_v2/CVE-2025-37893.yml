advisory_id: CVE-2025-37893
datasource_id: nvd_importer_v2/CVE-2025-37893
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37893
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  LoongArch: BPF: Fix off-by-one error in build_prologue()

  Vincent reported that running BPF progs with tailcalls on LoongArch
  causes kernel hard lockup. Debugging the issues shows that the JITed
  image missing a jirl instruction at the end of the epilogue.

  There are two passes in JIT compiling, the first pass set the flags and
  the second pass generates JIT code based on those flags. With BPF progs
  mixing bpf2bpf and tailcalls, build_prologue() generates N insns in the
  first pass and then generates N+1 insns in the second pass. This makes
  epilogue_offset off by one and we will jump to some unexpected insn and
  cause lockup. Fix this by inserting a nop insn.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37893
weaknesses:
  - CWE-193
references:
  - url: https://git.kernel.org/stable/c/205a2182c51ffebaef54d643e3745e720cded08b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/48b904de2408af5f936f0e03f48dfcddeab58aa0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7e2586991e36663c9bc48c828b83eab180ad30a9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b3ffad2f02db4aace6799fe0049508b8925eae45
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c74d95a5679741ef428974ab788f5b0758dc78ae
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37893
    reference_type:
    reference_id: CVE-2025-37893
