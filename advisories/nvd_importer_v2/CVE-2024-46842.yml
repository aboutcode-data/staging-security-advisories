advisory_id: CVE-2024-46842
datasource_id: nvd_importer_v2/CVE-2024-46842
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-46842
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: lpfc: Handle mailbox timeouts in lpfc_get_sfp_info

  The MBX_TIMEOUT return code is not handled in lpfc_get_sfp_info and the
  routine unconditionally frees submitted mailbox commands regardless of
  return status.  The issue is that for MBX_TIMEOUT cases, when firmware
  returns SFP information at a later time, that same mailbox memory region
  references previously freed memory in its cmpl routine.

  Fix by adding checks for the MBX_TIMEOUT return code.  During mailbox
  resource cleanup, check the mbox flag to make sure that the wait did not
  timeout.  If the MBOX_WAKE flag is not set, then do not free the resources
  because it will be freed when firmware completes the mailbox at a later
  time in its cmpl routine.

  Also, increase the timeout from 30 to 60 seconds to accommodate boot
  scripts requiring longer timeouts.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-46842
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/bba47fe3b038cca3d3ebd799665ce69d6d273b58
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ede596b1434b57c0b3fd5c02b326efe5c54f6e48
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-46842
    reference_type:
    reference_id: CVE-2024-46842
