advisory_id: CVE-2023-31421
datasource_id: nvd_importer_v2/CVE-2023-31421
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-31421
aliases: []
summary: It was discovered that when acting as TLS clients, Beats, Elastic Agent, APM Server,
  and Fleet Server did not verify whether the server certificate is valid for the target IP
  address; however, certificate signature validation is still performed. More specifically,
  when the client is configured to connect to an IP address (instead of a hostname) it does
  not validate the server certificate's IP SAN values against that IP address and certificate
  validation fails, and therefore the connection is not blocked as expected.
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-31421
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-31421
weaknesses:
  - CWE-295
references:
  - url: https://discuss.elastic.co/t/beats-elastic-agent-apm-server-and-fleet-server-8-10-1-security-update-improper-certificate-validation-issue-esa-2023-16/343385
    reference_type:
    reference_id:
  - url: https://www.elastic.co/community/security
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:elastic:apm_server:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:elastic:apm_server:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:elastic:elastic_agent:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:elastic:elastic_agent:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:elastic:elastic_beats:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:elastic:elastic_beats:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:elastic:elastic_fleet_server:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:elastic:elastic_fleet_server:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-31421
    reference_type:
    reference_id: CVE-2023-31421
