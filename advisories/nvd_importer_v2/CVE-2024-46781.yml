advisory_id: CVE-2024-46781
datasource_id: nvd_importer_v2/CVE-2024-46781
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-46781
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nilfs2: fix missing cleanup on rollforward recovery error

  In an error injection test of a routine for mount-time recovery, KASAN
  found a use-after-free bug.

  It turned out that if data recovery was performed using partial logs
  created by dsync writes, but an error occurred before starting the log
  writer to create a recovered checkpoint, the inodes whose data had been
  recovered were left in the ns_dirty_files list of the nilfs object and
  were not freed.

  Fix this issue by cleaning up inodes that have read the recovery data if
  the recovery routine fails midway before the log writer starts.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-46781
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/07e4dc2fe000ab008bcfe90be4324ef56b5b4355
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1cf1f7e8cd47244fa947d357ef1f642d91e219a3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35a9a7a7d94662146396199b0cfd95f9517cdd14
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5787fcaab9eb5930f5378d6a1dd03d916d146622
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8e2d1e9d93c4ec51354229361ac3373058529ec4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9d8c3a585d564d776ee60d4aabec59b404be7403
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ca92c4bff2833cb30d493b935168d6cccd5c805d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/da02f9eb333333b2e4f25d2a14967cff785ac82e
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/10/msg00003.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-46781
    reference_type:
    reference_id: CVE-2024-46781
