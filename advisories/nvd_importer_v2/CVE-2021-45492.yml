advisory_id: CVE-2021-45492
datasource_id: nvd_importer_v2/CVE-2021-45492
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-45492
aliases: []
summary: In Sage 300 ERP (formerly accpac) through 6.8.x, the installer configures the C:\Sage\Sage300\Runtime
  directory to be the first entry in the system-wide PATH environment variable. However, this
  directory is writable by unprivileged users because the Sage installer fails to set explicit
  permissions and therefore inherits weak permissions from the C:\ folder. Because entries in
  the system-wide PATH variable are included in the search order for DLLs, an attacker could
  perform DLL search-order hijacking to escalate their privileges to SYSTEM. Furthermore, if
  the Global Search or Web Screens functionality is enabled, then privilege escalation is possible
  via the GlobalSearchService and Sage.CNA.WindowsService services, again via DLL search-order
  hijacking because unprivileged users would have modify permissions on the application directory.
  Note that while older versions of the software default to installing in %PROGRAMFILES(X86)%
  (which would allow the Sage folder to inherit strong permissions, making the installation
  not vulnerable), the official Sage 300 installation guides for those versions recommend installing
  in C:\Sage, which would make the installation vulnerable.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-45492
weaknesses:
  - CWE-732
references:
  - url: https://controlgap.com/blog?tag=insecurity
    reference_type:
    reference_id:
  - url: https://www.controlgap.com/blog/sage-300-case-study
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sage:sage_300:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sage:sage_300:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-45492
    reference_type:
    reference_id: CVE-2021-45492
