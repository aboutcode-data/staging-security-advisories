advisory_id: CVE-2025-21721
datasource_id: nvd_importer_v2/CVE-2025-21721
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21721
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nilfs2: handle errors that nilfs_prepare_chunk() may return

  Patch series "nilfs2: fix issues with rename operations".

  This series fixes BUG_ON check failures reported by syzbot around rename
  operations, and a minor behavioral issue where the mtime of a child
  directory changes when it is renamed instead of moved.


  This patch (of 2):

  The directory manipulation routines nilfs_set_link() and
  nilfs_delete_entry() rewrite the directory entry in the folio/page
  previously read by nilfs_find_entry(), so error handling is omitted on the
  assumption that nilfs_prepare_chunk(), which prepares the buffer for
  rewriting, will always succeed for these.  And if an error is returned, it
  triggers the legacy BUG_ON() checks in each routine.

  This assumption is wrong, as proven by syzbot: the buffer layer called by
  nilfs_prepare_chunk() may call nilfs_get_block() if necessary, which may
  fail due to metadata corruption or other reasons.  This has been there all
  along, but improved sanity checks and error handling may have made it more
  reproducible in fuzzing tests.

  Fix this issue by adding missing error paths in nilfs_set_link(),
  nilfs_delete_entry(), and their caller nilfs_rename().
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21721
weaknesses:
  - CWE-617
references:
  - url: https://git.kernel.org/stable/c/1ee2d454baa361d2964e3e2f2cca9ee3f769d93c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/481136234dfe96c7f92770829bec6111c7c5f5dd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/607dc724b162f4452dc768865e578c1a509a1c8c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7891ac3b0a5c56f7148af507306308ab841cdc31
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b38c6c260c2415c7f0968871305e7a093daabb4c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eddd3176b8c4c83a46ab974574cda7c3dfe09388
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ee70999a988b8abc3490609142f50ebaa8344432
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f70bd2d8ca454e0ed78970f72147ca321dbaa015
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21721
    reference_type:
    reference_id: CVE-2025-21721
