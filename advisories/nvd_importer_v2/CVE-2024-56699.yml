advisory_id: CVE-2024-56699
datasource_id: nvd_importer_v2/CVE-2024-56699
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-56699
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  s390/pci: Fix potential double remove of hotplug slot

  In commit 6ee600bfbe0f ("s390/pci: remove hotplug slot when releasing the
  device") the zpci_exit_slot() was moved from zpci_device_reserved() to
  zpci_release_device() with the intention of keeping the hotplug slot
  around until the device is actually removed.

  Now zpci_release_device() is only called once all references are
  dropped. Since the zPCI subsystem only drops its reference once the
  device is in the reserved state it follows that zpci_release_device()
  must only deal with devices in the reserved state. Despite that it
  contains code to tear down from both configured and standby state. For
  the standby case this already includes the removal of the hotplug slot
  so would cause a double removal if a device was ever removed in
  either configured or standby state.

  Instead of causing a potential double removal in a case that should
  never happen explicitly WARN_ON() if a device in non-reserved state is
  released and get rid of the dead code cases.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56699
weaknesses:
  - CWE-415
references:
  - url: https://git.kernel.org/stable/c/371bd905599d18da62d75e3974acbf6a41e315c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c1489651071ab1be46d2af1da8adb15c9fc3c069
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c4a585e952ca403a370586d3f16e8331a7564901
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56699
    reference_type:
    reference_id: CVE-2024-56699
