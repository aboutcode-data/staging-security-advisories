advisory_id: CVE-2024-26813
datasource_id: nvd_importer_v2/CVE-2024-26813
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26813
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  vfio/platform: Create persistent IRQ handlers

  The vfio-platform SET_IRQS ioctl currently allows loopback triggering of
  an interrupt before a signaling eventfd has been configured by the user,
  which thereby allows a NULL pointer dereference.

  Rather than register the IRQ relative to a valid trigger, register all
  IRQs in a disabled state in the device open path.  This allows mask
  operations on the IRQ to nest within the overall enable state governed
  by a valid eventfd signal.  This decouples @masked, protected by the
  @locked spinlock from @trigger, protected via the @igate mutex.

  In doing so, it's guaranteed that changes to @trigger cannot race the
  IRQ handlers because the IRQ handler is synchronously disabled before
  modifying the trigger, and loopback triggering of the IRQ via ioctl is
  safe due to serialization with trigger changes via igate.

  For compatibility, request_irq() failures are maintained to be local to
  the SET_IRQS ioctl rather than a fatal error in the open device path.
  This allows, for example, a userspace driver with polling mode support
  to continue to work regardless of moving the request_irq() call site.
  This necessarily blocks all SET_IRQS access to the failed index.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26813
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/07afdfd8a68f9eea8db0ddc4626c874f29d2ac5e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/09452c8fcbd7817c06e8e3212d99b45917e603a5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0f8d8f9c2173a541812dd750529f4a415117eb29
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/62d4e43a569b67929eb3319780be5359694c8086
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/675daf435e9f8e5a5eab140a9864dfad6668b375
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7932db06c82c5b2f42a4d1a849d97dba9ce4a362
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cc5838f19d39a5fef04c468199699d2a4578be3a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d6bedd6acc0bcb1e7e010bc046032e47f08d379f
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26813
    reference_type:
    reference_id: CVE-2024-26813
