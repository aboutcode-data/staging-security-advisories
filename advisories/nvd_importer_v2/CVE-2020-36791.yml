advisory_id: CVE-2020-36791
datasource_id: nvd_importer_v2/CVE-2020-36791
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2020-36791
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net_sched: keep alloc_hash updated after hash allocation

  In commit 599be01ee567 ("net_sched: fix an OOB access in cls_tcindex")
  I moved cp->hash calculation before the first
  tcindex_alloc_perfect_hash(), but cp->alloc_hash is left untouched.
  This difference could lead to another out of bound access.

  cp->alloc_hash should always be the size allocated, we should
  update it after this tcindex_alloc_perfect_hash().
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-36791
weaknesses:
  - CWE-125
references:
  - url: https://blog.cdthoughts.ch/2021/03/16/syzbot-bug.html
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0d1c3530e1bd38382edef72591b78e877e0edcd3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/557d015ffb27b672e24e6ad141fd887783871dc2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9f8b6c44be178c2498a00b270872a6e30e7c8266
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bd3ee8fb6371b45c71c9345cc359b94da2ddefa9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c4453d2833671e3a9f6bd52f0f581056c3736386
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d23faf32e577922b6da20bf3740625c1105381bf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d6cdc5bb19b595486fb2e6661e5138d73a57f454
    reference_type:
    reference_id:
  - url: https://syzkaller.appspot.com/bug?id=ea260693da894e7b078d18fca2c9c0a19b457534
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.6:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.6:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.6:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.6:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.6:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.6:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.6:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.6:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.6:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.6:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.6:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.6:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.6:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.6:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-36791
    reference_type:
    reference_id: CVE-2020-36791
