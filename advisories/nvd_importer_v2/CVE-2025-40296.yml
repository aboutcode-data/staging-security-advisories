advisory_id: CVE-2025-40296
datasource_id: nvd_importer_v2/CVE-2025-40296
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40296
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  platform/x86: int3472: Fix double free of GPIO device during unregister

  regulator_unregister() already frees the associated GPIO device. On
  ThinkPad X9 (Lunar Lake), this causes a double free issue that leads to
  random failures when other drivers (typically Intel THC) attempt to
  allocate interrupts. The root cause is that the reference count of the
  pinctrl_intel_platform module unexpectedly drops to zero when this
  driver defers its probe.

  This behavior can also be reproduced by unloading the module directly.

  Fix the issue by removing the redundant release of the GPIO device
  during regulator unregistration.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/b8113bb56c45bd17bac5144b55591f9cdbd6aabe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f0f7a3f542c1698edb69075f25a3f846207facba
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40296
    reference_type:
    reference_id: CVE-2025-40296
