advisory_id: CVE-2022-50476
datasource_id: nvd_importer_v2/CVE-2022-50476
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50476
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ntb_netdev: Use dev_kfree_skb_any() in interrupt context

  TX/RX callback handlers (ntb_netdev_tx_handler(),
  ntb_netdev_rx_handler()) can be called in interrupt
  context via the DMA framework when the respective
  DMA operations have completed. As such, any calls
  by these routines to free skb's, should use the
  interrupt context safe dev_kfree_skb_any() function.

  Previously, these callback handlers would call the
  interrupt unsafe version of dev_kfree_skb(). This has
  not presented an issue on Intel IOAT DMA engines as
  that driver utilizes tasklets rather than a hard
  interrupt handler, like the AMD PTDMA DMA driver.
  On AMD systems, a kernel WARNING message is
  encountered, which is being issued from
  skb_release_head_state() due to in_hardirq()
  being true.

  Besides the user visible WARNING from the kernel,
  the other symptom of this bug was that TCP/IP performance
  across the ntb_netdev interface was very poor, i.e.
  approximately an order of magnitude below what was
  expected. With the repair to use dev_kfree_skb_any(),
  kernel WARNINGs from skb_release_head_state() ceased
  and TCP/IP performance, as measured by iperf, was on
  par with expected results, approximately 20 Gb/s on
  AMD Milan based server. Note that this performance
  is comparable with Intel based servers.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50476
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/07e28a8f450217db679802ebd4de0915556ce846
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/13286ad1c7c49c606fdcba4cf66f953a1a16c1ca
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/14d245da57a11e80277ab455aa9b6dcc5ed38a19
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/21296a52caa6a6bad6debdfe40ad81d4f1a27e69
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5f7d78b2b12a9d561f48fa00bab29b40f4616dad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8b78493968ed3cef0326183ed059c55e42f24d5b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a6b9e09403102bdf8402dae734800e4916c7ea58
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d4460c82177899751975180c268f352893302221
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd860b39aa7c7b82e6c99b6fdb99d4610ce49d67
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50476
    reference_type:
    reference_id: CVE-2022-50476
