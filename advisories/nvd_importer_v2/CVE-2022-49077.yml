advisory_id: CVE-2022-49077
datasource_id: nvd_importer_v2/CVE-2022-49077
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49077
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mmmremap.c: avoid pointless invalidate_range_start/end on mremap(old_size=0)

  If an mremap() syscall with old_size=0 ends up in move_page_tables(), it
  will call invalidate_range_start()/invalidate_range_end() unnecessarily,
  i.e.  with an empty range.

  This causes a WARN in KVM's mmu_notifier.  In the past, empty ranges
  have been diagnosed to be off-by-one bugs, hence the WARNing.  Given the
  low (so far) number of unique reports, the benefits of detecting more
  buggy callers seem to outweigh the cost of having to fix cases such as
  this one, where userspace is doing something silly.  In this particular
  case, an early return from move_page_tables() is enough to fix the
  issue.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49077
weaknesses:
  - CWE-193
references:
  - url: https://git.kernel.org/stable/c/01e67e04c28170c47700c2c226d732bbfedb1ad0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/04bc13dae4a27b8d030843c85ae452bb2f1d9c1f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2358aa84ef6dafcf544a557caaa6b91afb4a0bd2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7d659cb1763ff17d1c6ee082fa6feb4267c7a30b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a04cb99c5d4668fe3f5c0e5b6da1cecd34c3f219
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a05540f3903bd8295e8c4cd90dd3d416239a115b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c19d8de4e682ec4b0ea2b04a832cd8cc0be3bb31
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e2c328c2a8f9de8b761bd4025b66c63120c55761
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eeaf28e2a0128147d687237e59d5407ee1b14693
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.18:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49077
    reference_type:
    reference_id: CVE-2022-49077
