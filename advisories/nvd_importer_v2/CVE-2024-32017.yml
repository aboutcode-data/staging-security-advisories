advisory_id: CVE-2024-32017
datasource_id: nvd_importer_v2/CVE-2024-32017
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-32017
aliases: []
summary: RIOT is a real-time multi-threading operating system that supports a range of devices
  that are typically 8-bit, 16-bit and 32-bit microcontrollers. The size check in the `gcoap_dns_server_proxy_get()`
  function contains a small typo that may lead to a buffer overflow in the subsequent `strcpy()`.
  In detail, the length of the `_uri` string is checked instead of the length of the `_proxy`
  string. The `_gcoap_forward_proxy_copy_options()` function does not implement an explicit
  size check before copying data to the `cep->req_etag` buffer that is `COAP_ETAG_LENGTH_MAX`
  bytes long. If an attacker can craft input so that `optlen` becomes larger than `COAP_ETAG_LENGTH_MAX`,
  they can cause a buffer overflow. If the input above is attacker-controlled and crosses a
  security boundary, the impact of the buffer overflow vulnerabilities could range from denial
  of service to arbitrary code execution. This issue has yet to be patched. Users are advised
  to add manual bounds checking.
impacted_packages: []
severities:
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-32017
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-32017
weaknesses:
  - CWE-120
references:
  - url: http://seclists.org/fulldisclosure/2024/May/7
    reference_type:
    reference_id:
  - url: https://github.com/RIOT-OS/RIOT/blob/master/sys/net/application_layer/gcoap/dns.c#L319-L325
    reference_type:
    reference_id:
  - url: https://github.com/RIOT-OS/RIOT/blob/master/sys/net/application_layer/gcoap/forward_proxy.c#L352
    reference_type:
    reference_id:
  - url: https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-v97j-w9m6-c4h3
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/05/07/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:riot-os:riot:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:riot-os:riot:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32017
    reference_type:
    reference_id: CVE-2024-32017
