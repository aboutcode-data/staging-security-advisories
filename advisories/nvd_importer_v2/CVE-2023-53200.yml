advisory_id: CVE-2023-53200
datasource_id: nvd_importer_v2/CVE-2023-53200
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53200
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: x_tables: fix percpu counter block leak on error path when creating new netns

  Here is the stack where we allocate percpu counter block:

    +-< __alloc_percpu
      +-< xt_percpu_counter_alloc
        +-< find_check_entry # {arp,ip,ip6}_tables.c
          +-< translate_table

  And it can be leaked on this code path:

    +-> ip6t_register_table
      +-> translate_table # allocates percpu counter block
      +-> xt_register_table # fails

  there is no freeing of the counter block on xt_register_table fail.
  Note: xt_percpu_counter_free should be called to free it like we do in
  do_replace through cleanup_entry helper (or in __ip6t_unregister_table).

  Probability of hitting this error path is low AFAICS (xt_register_table
  can only return ENOMEM here, as it is not replacing anything, as we are
  creating new netns, and it is hard to imagine that all previous
  allocations succeeded and after that one in xt_register_table failed).
  But it's worth fixing even the rare leak.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53200
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/0af8c09c896810879387decfba8c942994bb61f5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3cc9610a87b7dde82f7360dd4eb6c2c27940ed57
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/512b6c4b83c91d007301ea7d7f095d16c3aceacd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e306dbee4c98025a9326386023a12ef4d887e9d1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53200
    reference_type:
    reference_id: CVE-2023-53200
