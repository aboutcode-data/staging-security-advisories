advisory_id: CVE-2024-40995
datasource_id: nvd_importer_v2/CVE-2024-40995
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-40995
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/sched: act_api: fix possible infinite loop in tcf_idr_check_alloc()

  syzbot found hanging tasks waiting on rtnl_lock [1]

  A reproducer is available in the syzbot bug.

  When a request to add multiple actions with the same index is sent, the
  second request will block forever on the first request. This holds
  rtnl_lock, and causes tasks to hang.

  Return -EAGAIN to prevent infinite looping, while keeping documented
  behavior.

  [1]

  INFO: task kworker/1:0:5088 blocked for more than 143 seconds.
  Not tainted 6.9.0-rc4-syzkaller-00173-g3cdb45594619 #0
  "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.
  task:kworker/1:0 state:D stack:23744 pid:5088 tgid:5088 ppid:2 flags:0x00004000
  Workqueue: events_power_efficient reg_check_chans_work
  Call Trace:
  <TASK>
  context_switch kernel/sched/core.c:5409 [inline]
  __schedule+0xf15/0x5d00 kernel/sched/core.c:6746
  __schedule_loop kernel/sched/core.c:6823 [inline]
  schedule+0xe7/0x350 kernel/sched/core.c:6838
  schedule_preempt_disabled+0x13/0x30 kernel/sched/core.c:6895
  __mutex_lock_common kernel/locking/mutex.c:684 [inline]
  __mutex_lock+0x5b8/0x9c0 kernel/locking/mutex.c:752
  wiphy_lock include/net/cfg80211.h:5953 [inline]
  reg_leave_invalid_chans net/wireless/reg.c:2466 [inline]
  reg_check_chans_work+0x10a/0x10e0 net/wireless/reg.c:2481
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-40995
weaknesses:
  - CWE-835
references:
  - url: https://git.kernel.org/stable/c/0d8a2d287c8a394c0d4653f0c6c7be4c688e5a74
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/25987a97eec4d5f897cd04ee1b45170829c610da
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5f926aa96b08b6c47178fe1171e7ae331c695fc2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6fc78d67f51aeb9a542d39a8714e16bc411582d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7a0e497b597df7c4cf2b63fc6e9188b6cabe5335
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c6a7da65a296745535a964be1019ec7691b0cb90
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d864319871b05fadd153e0aede4811ca7008f5d6
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-40995
    reference_type:
    reference_id: CVE-2024-40995
