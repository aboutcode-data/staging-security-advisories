advisory_id: CVE-2025-40336
datasource_id: nvd_importer_v2/CVE-2025-40336
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40336
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/gpusvm: fix hmm_pfn_to_map_order() usage

  Handle the case where the hmm range partially covers a huge page (like
  2M), otherwise we can potentially end up doing something nasty like
  mapping memory which is outside the range, and maybe not even mapped by
  the mm. Fix is based on the xe userptr code, which in a future patch
  will directly use gpusvm, so needs alignment here.

  v2:
    - Add kernel-doc (Matt B)
    - s/fls/ilog2/ (Thomas)
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/08e9fd78ba1b9e95141181c69cc51795c9888157
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c50729c68aaf93611c855752b00e49ce1fdd1558
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40336
    reference_type:
    reference_id: CVE-2025-40336
