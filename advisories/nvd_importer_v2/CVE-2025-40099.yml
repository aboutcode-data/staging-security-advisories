advisory_id: CVE-2025-40099
datasource_id: nvd_importer_v2/CVE-2025-40099
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40099
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  cifs: parse_dfs_referrals: prevent oob on malformed input

  Malicious SMB server can send invalid reply to FSCTL_DFS_GET_REFERRALS

  - reply smaller than sizeof(struct get_dfs_referral_rsp)
  - reply with number of referrals smaller than NumberOfReferrals in the
  header

  Processing of such replies will cause oob.

  Return -EINVAL error on such replies to prevent oob-s.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/15c73964da9df994302f579ed14ee5fdbce7a332
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6447b0e355562a1ff748c4a2ffb89aae7e84d2c9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8bc4a8d39bac23d8b044fd3e2dbfd965f1d9b058
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bb0f2e66e1ac043a5b238f5bcab4f26f3c317039
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cfacc7441f760e4a73cc71b6ff1635261d534657
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40099
    reference_type:
    reference_id: CVE-2025-40099
