advisory_id: CVE-2025-71089
datasource_id: nvd_importer_v2/CVE-2025-71089
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-71089
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\niommu: disable\
  \ SVA when CONFIG_X86 is set\n\nPatch series \"Fix stale IOTLB entries for kernel address\
  \ space\", v7.\n\nThis proposes a fix for a security vulnerability related to IOMMU Shared\n\
  Virtual Addressing (SVA).  In an SVA context, an IOMMU can cache kernel\npage table entries.\
  \  When a kernel page table page is freed and\nreallocated for another purpose, the IOMMU\
  \ might still hold stale,\nincorrect entries.  This can be exploited to cause a use-after-free\
  \ or\nwrite-after-free condition, potentially leading to privilege escalation or\ndata corruption.\n\
  \nThis solution introduces a deferred freeing mechanism for kernel page\ntable pages, which\
  \ provides a safe window to notify the IOMMU to\ninvalidate its caches before the page is\
  \ reused.\n\n\nThis patch (of 8):\n\nIn the IOMMU Shared Virtual Addressing (SVA) context,\
  \ the IOMMU hardware\nshares and walks the CPU's page tables.  The x86 architecture maps the\n\
  kernel's virtual address space into the upper portion of every process's\npage table.  Consequently,\
  \ in an SVA context, the IOMMU hardware can walk\nand cache kernel page table entries.\n\n\
  The Linux kernel currently lacks a notification mechanism for kernel page\ntable changes,\
  \ specifically when page table pages are freed and reused. \nThe IOMMU driver is only notified\
  \ of changes to user virtual address\nmappings.  This can cause the IOMMU's internal caches\
  \ to retain stale\nentries for kernel VA.\n\nUse-After-Free (UAF) and Write-After-Free (WAF)\
  \ conditions arise when\nkernel page table pages are freed and later reallocated.  The IOMMU\
  \ could\nmisinterpret the new data as valid page table entries.  The IOMMU might\nthen walk\
  \ into attacker-controlled memory, leading to arbitrary physical\nmemory DMA access or privilege\
  \ escalation.  This is also a\nWrite-After-Free issue, as the IOMMU will potentially continue\
  \ to write\nAccessed and Dirty bits to the freed memory while attempting to walk the\nstale\
  \ page tables.\n\nCurrently, SVA contexts are unprivileged and cannot access kernel\nmappings.\
  \  However, the IOMMU will still walk kernel-only page tables all\nthe way down to the leaf\
  \ entries, where it realizes the mapping is for the\nkernel and errors out.  This means the\
  \ IOMMU still caches these\nintermediate page table entries, making the described vulnerability\
  \ a real\nconcern.\n\nDisable SVA on x86 architecture until the IOMMU can receive notification\n\
  to flush the paging cache before freeing the CPU kernel page table pages."
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/240cd7f2812cc25496b12063d11c823618f364e9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/72f98ef9a4be30d2a60136dd6faee376f780d06c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7cad37e358970af1bb49030ff01f06a69fa7d985
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b34289505180a83607fcfdce14b5a290d0528476
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c2c3f1a3fd74ef16cf115f0c558616a13a8471b4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c341dee80b5df49a936182341b36395c831c2661
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-71089
    reference_type:
    reference_id: CVE-2025-71089
