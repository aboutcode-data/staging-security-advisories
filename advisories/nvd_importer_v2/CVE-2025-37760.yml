advisory_id: CVE-2025-37760
datasource_id: nvd_importer_v2/CVE-2025-37760
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37760
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/vma: add give_up_on_oom option on modify/merge, use in uffd release

  Currently, if a VMA merge fails due to an OOM condition arising on commit
  merge or a failure to duplicate anon_vma's, we report this so the caller
  can handle it.

  However there are cases where the caller is only ostensibly trying a
  merge, and doesn't mind if it fails due to this condition.

  Since we do not want to introduce an implicit assumption that we only
  actually modify VMAs after OOM conditions might arise, add a 'give up on
  oom' option and make an explicit contract that, should this flag be set, we
  absolutely will not modify any VMAs should OOM arise and just bail out.

  Since it'd be very unusual for a user to try to vma_modify() with this flag
  set but be specifying a range within a VMA which ends up being split (which
  can fail due to rlimit issues, not only OOM), we add a debug warning for
  this condition.

  The motivating reason for this is uffd release - syzkaller (and Pedro
  Falcato's VERY astute analysis) found a way in which an injected fault on
  allocation, triggering an OOM condition on commit merge, would result in
  uffd code becoming confused and treating an error value as if it were a VMA
  pointer.

  To avoid this, we make use of this new VMG flag to ensure that this never
  occurs, utilising the fact that, should we be clearing entire VMAs, we do
  not wish an OOM event to be reported to us.

  Many thanks to Pedro Falcato for his excellent analysis and Jann Horn for
  his insightful and intelligent analysis of the situation, both of whom were
  instrumental in this fix.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37760
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/41e6ddcaa0f18dda4c3fadf22533775a30d6f72f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b906c1ad25adce6ff35be19b65a1aa7d960fe1d7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c103a75c61648203d731e3b97a6fbeea4003cb15
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37760
    reference_type:
    reference_id: CVE-2025-37760
