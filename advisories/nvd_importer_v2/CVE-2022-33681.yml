advisory_id: CVE-2022-33681
datasource_id: nvd_importer_v2/CVE-2022-33681
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-33681
aliases: []
summary: Delayed TLS hostname verification in the Pulsar Java Client and the Pulsar Proxy make
  each client vulnerable to a man in the middle attack. Connections from the Pulsar Java Client
  to the Pulsar Broker/Proxy and connections from the Pulsar Proxy to the Pulsar Broker are
  vulnerable. Authentication data is sent before verifying the server’s TLS certificate matches
  the hostname, which means authentication data could be exposed to an attacker. An attacker
  can only take advantage of this vulnerability by taking control of a machine 'between' the
  client and the server. The attacker must then actively manipulate traffic to perform the attack
  by providing the client with a cryptographically valid certificate for an unrelated host.
  Because the client sends authentication data before performing hostname verification, an attacker
  could gain access to the client’s authentication data. The client eventually closes the connection
  when it verifies the hostname and identifies the targeted hostname does not match a hostname
  on the certificate. Because the client eventually closes the connection, the value of the
  intercepted authentication data depends on the authentication method used by the client. Token
  based authentication and username/password authentication methods are vulnerable because the
  authentication data can be used to impersonate the client in a separate session. This issue
  affects Apache Pulsar Java Client versions 2.7.0 to 2.7.4; 2.8.0 to 2.8.3; 2.9.0 to 2.9.2;
  2.10.0; 2.6.4 and earlier.
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-33681
weaknesses:
  - CWE-295
references:
  - url: https://lists.apache.org/thread/fpo6x10trvn20hlk0dmnr5vlz5v4kl3d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:pulsar:2.10.0:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:pulsar:2.10.0:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-33681
    reference_type:
    reference_id: CVE-2022-33681
