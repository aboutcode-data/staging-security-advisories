advisory_id: CVE-2025-71226
datasource_id: nvd_importer_v2/CVE-2025-71226
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-71226
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: iwlwifi: Implement settime64 as stub for MVM/MLD PTP

  Since commit dfb073d32cac ("ptp: Return -EINVAL on ptp_clock_register if
  required ops are NULL"), PTP clock registered through ptp_clock_register
  is required to have ptp_clock_info.settime64 set, however, neither MVM
  nor MLD's PTP clock implementation sets it, resulting in warnings when
  the interface starts up, like

  WARNING: drivers/ptp/ptp_clock.c:325 at ptp_clock_register+0x2c8/0x6b8, CPU#1: wpa_supplicant/469
  CPU: 1 UID: 0 PID: 469 Comm: wpa_supplicant Not tainted 6.18.0+ #101 PREEMPT(full)
  ra: ffff800002732cd4 iwl_mvm_ptp_init+0x114/0x188 [iwlmvm]
  ERA: 9000000002fdc468 ptp_clock_register+0x2c8/0x6b8
  iwlwifi 0000:01:00.0: Failed to register PHC clock (-22)

  I don't find an appropriate firmware interface to implement settime64()
  for iwlwifi MLD/MVM, thus instead create a stub that returns
  -EOPTNOTSUPP only, suppressing the warning and allowing the PTP clock to
  be registered.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/81d90d93d22ca4f61833cba921dce9a0bd82218f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff6892ea544c4052dd5799f675ebc20419953801
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-71226
    reference_type:
    reference_id: CVE-2025-71226
