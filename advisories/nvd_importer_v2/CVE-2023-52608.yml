advisory_id: CVE-2023-52608
datasource_id: nvd_importer_v2/CVE-2023-52608
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-52608
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  firmware: arm_scmi: Check mailbox/SMT channel for consistency

  On reception of a completion interrupt the shared memory area is accessed
  to retrieve the message header at first and then, if the message sequence
  number identifies a transaction which is still pending, the related
  payload is fetched too.

  When an SCMI command times out the channel ownership remains with the
  platform until eventually a late reply is received and, as a consequence,
  any further transmission attempt remains pending, waiting for the channel
  to be relinquished by the platform.

  Once that late reply is received the channel ownership is given back
  to the agent and any pending request is then allowed to proceed and
  overwrite the SMT area of the just delivered late reply; then the wait
  for the reply to the new request starts.

  It has been observed that the spurious IRQ related to the late reply can
  be wrongly associated with the freshly enqueued request: when that happens
  the SCMI stack in-flight lookup procedure is fooled by the fact that the
  message header now present in the SMT area is related to the new pending
  transaction, even though the real reply has still to arrive.

  This race-condition on the A2P channel can be detected by looking at the
  channel status bits: a genuine reply from the platform will have set the
  channel free bit before triggering the completion IRQ.

  Add a consistency check to validate such condition in the A2P ISR.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52608
weaknesses:
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/12dc4217f16551d6dee9cbefc23fdb5659558cda
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/437a310b22244d4e0b78665c3042e5d1c0f45306
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/614cc65032dcb0b64d23f5c5e338a8a04b12be5d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7f95f6997f4fdd17abec3200cae45420a5489350
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9b5e1b93c83ee5fc9f5d7bd2d45b421bd87774a2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52608
    reference_type:
    reference_id: CVE-2023-52608
