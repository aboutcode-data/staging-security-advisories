advisory_id: CVE-2022-49118
datasource_id: nvd_importer_v2/CVE-2022-49118
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49118
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: hisi_sas: Free irq vectors in order for v3 HW

  If the driver probe fails to request the channel IRQ or fatal IRQ, the
  driver will free the IRQ vectors before freeing the IRQs in free_irq(),
  and this will cause a kernel BUG like this:

  ------------[ cut here ]------------
  kernel BUG at drivers/pci/msi.c:369!
  Internal error: Oops - BUG: 0 [#1] PREEMPT SMP
  Call trace:
     free_msi_irqs+0x118/0x13c
     pci_disable_msi+0xfc/0x120
     pci_free_irq_vectors+0x24/0x3c
     hisi_sas_v3_probe+0x360/0x9d0 [hisi_sas_v3_hw]
     local_pci_probe+0x44/0xb0
     work_for_cpu_fn+0x20/0x34
     process_one_work+0x1d0/0x340
     worker_thread+0x2e0/0x460
     kthread+0x180/0x190
     ret_from_fork+0x10/0x20
  ---[ end trace b88990335b610c11 ]---

  So we use devm_add_action() to control the order in which we free the
  vectors.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49118
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/224903cc60d045576393c3b16907742f23e6c740
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/554fb72ee34f4732c7f694f56c3c6e67790352a0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8b6eab9d683bae7f88dc894b8c851f866032301c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b4cc04fa8f1fc3816c8494d77abab3f72b9d2292
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f05a0d8de2ea49af36821a20b0b501e20ced937e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49118
    reference_type:
    reference_id: CVE-2022-49118
