advisory_id: CVE-2024-53135
datasource_id: nvd_importer_v2/CVE-2024-53135
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-53135
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  KVM: VMX: Bury Intel PT virtualization (guest/host mode) behind CONFIG_BROKEN

  Hide KVM's pt_mode module param behind CONFIG_BROKEN, i.e. disable support
  for virtualizing Intel PT via guest/host mode unless BROKEN=y.  There are
  myriad bugs in the implementation, some of which are fatal to the guest,
  and others which put the stability and health of the host at risk.

  For guest fatalities, the most glaring issue is that KVM fails to ensure
  tracing is disabled, and *stays* disabled prior to VM-Enter, which is
  necessary as hardware disallows loading (the guest's) RTIT_CTL if tracing
  is enabled (enforced via a VMX consistency check).  Per the SDM:

    If the logical processor is operating with Intel PT enabled (if
    IA32_RTIT_CTL.TraceEn = 1) at the time of VM entry, the "load
    IA32_RTIT_CTL" VM-entry control must be 0.

  On the host side, KVM doesn't validate the guest CPUID configuration
  provided by userspace, and even worse, uses the guest configuration to
  decide what MSRs to save/load at VM-Enter and VM-Exit.  E.g. configuring
  guest CPUID to enumerate more address ranges than are supported in hardware
  will result in KVM trying to passthrough, save, and load non-existent MSRs,
  which generates a variety of WARNs, ToPA ERRORs in the host, a potential
  deadlock, etc.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-53135
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/aa0d42cacf093a6fcca872edc954f6f812926a17
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b8a1d572478b6f239061ee9578b2451bf2f021c2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b91bb0ce5cd7005b376eac690ec664c1b56372ec
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c3742319d021f5aa3a0a8c828485fee14753f6de
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d28b059ee4779b5102c5da6e929762520510e406
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d4b42f926adcce4e5ec193c714afd9d37bba8e5b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e6716f4230a8784957273ddd27326264b27b9313
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00002.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-53135
    reference_type:
    reference_id: CVE-2024-53135
