advisory_id: CVE-2019-19741
datasource_id: nvd_importer_v2/CVE-2019-19741
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2019-19741
aliases: []
summary: Electronic Arts Origin 10.5.55.33574 is vulnerable to local privilege escalation due
  to arbitrary directory DACL manipulation, a different issue than CVE-2019-19247 and CVE-2019-19248.
  When Origin.exe connects to the named pipe OriginClientService, the privileged service verifies
  the client's executable file instead of its in-memory process (which can be significantly
  different from the executable file due to, for example, DLL injection). Data transmitted over
  the pipe is encrypted using a static key. Instead of hooking the pipe communication directly
  via WriteFileEx(), this can be bypassed by hooking the EVP_EncryptUpdate() function of libeay32.dll.
  The pipe takes the command CreateDirectory to create a directory and adjust the directory
  DACL. Calls to this function can be intercepted, the directory and the DACL can be replaced,
  and the manipulated DACL is written. Arbitrary DACL write is further achieved by creating
  a hardlink in a user-controlled directory that points to (for example) a service binary. The
  DACL is then written to this service binary, which results in escalation of privileges.
impacted_packages: []
severities:
  - score: '7.2'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-19741
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-19741
weaknesses: []
references:
  - url: https://medium.com/%40tobiasgyoerfi/ea-origin-10-5-55-33574-createdirectory-arbitrary-dacl-write-privilege-escalation-cve-2019-19741-5f18adfabb27
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:ea:origin:*:*:*:*:*:macos:*:*
    reference_type:
    reference_id: cpe:2.3:a:ea:origin:*:*:*:*:*:macos:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:ea:origin:*:*:*:*:*:windows:*:*
    reference_type:
    reference_id: cpe:2.3:a:ea:origin:*:*:*:*:*:windows:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-19741
    reference_type:
    reference_id: CVE-2019-19741
