advisory_id: CVE-2025-21910
datasource_id: nvd_importer_v2/CVE-2025-21910
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21910
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: cfg80211: regulatory: improve invalid hints checking

  Syzbot keeps reporting an issue [1] that occurs when erroneous symbols
  sent from userspace get through into user_alpha2[] via
  regulatory_hint_user() call. Such invalid regulatory hints should be
  rejected.

  While a sanity check from commit 47caf685a685 ("cfg80211: regulatory:
  reject invalid hints") looks to be enough to deter these very cases,
  there is a way to get around it due to 2 reasons.

  1) The way isalpha() works, symbols other than latin lower and
  upper letters may be used to determine a country/domain.
  For instance, greek letters will also be considered upper/lower
  letters and for such characters isalpha() will return true as well.
  However, ISO-3166-1 alpha2 codes should only hold latin
  characters.

  2) While processing a user regulatory request, between
  reg_process_hint_user() and regulatory_hint_user() there happens to
  be a call to queue_regulatory_request() which modifies letters in
  request->alpha2[] with toupper(). This works fine for latin symbols,
  less so for weird letter characters from the second part of _ctype[].

  Syzbot triggers a warning in is_user_regdom_saved() by first sending
  over an unexpected non-latin letter that gets malformed by toupper()
  into a character that ends up failing isalpha() check.

  Prevent this by enhancing is_an_alpha2() to ensure that incoming
  symbols are latin letters and nothing else.

  [1] Syzbot report:
  ------------[ cut here ]------------
  Unexpected user alpha2: Aï¿½
  WARNING: CPU: 1 PID: 964 at net/wireless/reg.c:442 is_user_regdom_saved net/wireless/reg.c:440 [inline]
  WARNING: CPU: 1 PID: 964 at net/wireless/reg.c:442 restore_alpha2 net/wireless/reg.c:3424 [inline]
  WARNING: CPU: 1 PID: 964 at net/wireless/reg.c:442 restore_regulatory_settings+0x3c0/0x1e50 net/wireless/reg.c:3516
  Modules linked in:
  CPU: 1 UID: 0 PID: 964 Comm: kworker/1:2 Not tainted 6.12.0-rc5-syzkaller-00044-gc1e939a21eb1 #0
  Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024
  Workqueue: events_power_efficient crda_timeout_work
  RIP: 0010:is_user_regdom_saved net/wireless/reg.c:440 [inline]
  RIP: 0010:restore_alpha2 net/wireless/reg.c:3424 [inline]
  RIP: 0010:restore_regulatory_settings+0x3c0/0x1e50 net/wireless/reg.c:3516
  ...
  Call Trace:
   <TASK>
   crda_timeout_work+0x27/0x50 net/wireless/reg.c:542
   process_one_work kernel/workqueue.c:3229 [inline]
   process_scheduled_works+0xa65/0x1850 kernel/workqueue.c:3310
   worker_thread+0x870/0xd30 kernel/workqueue.c:3391
   kthread+0x2f2/0x390 kernel/kthread.c:389
   ret_from_fork+0x4d/0x80 arch/x86/kernel/process.c:147
   ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244
   </TASK>
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21910
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/17aa34c84867f6cd181a5743e1c647e7766962a6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35ef07112b61b06eb30683a6563c9f6378c02476
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/59b348be7597c4a9903cb003c69e37df20c04a30
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/62b1a9bbfebba4b4c2bb6c1ede9ef7ecee7a9ff6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6a5e3b23054cee3b92683d1467e3fa83921f5622
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/be7c5f00aa7f1344293e4d48d0e12be83a2f223d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/da3f599517ef2ea851208df3229d07728d238dc5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f4112cb477c727a65787a4065a75ca593bb5b2f4
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21910
    reference_type:
    reference_id: CVE-2025-21910
