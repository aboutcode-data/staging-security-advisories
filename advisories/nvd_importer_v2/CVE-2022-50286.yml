advisory_id: CVE-2022-50286
datasource_id: nvd_importer_v2/CVE-2022-50286
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50286
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: fix delayed allocation bug in ext4_clu_mapped for bigalloc + inline

  When converting files with inline data to extents, delayed allocations
  made on a file system created with both the bigalloc and inline options
  can result in invalid extent status cache content, incorrect reserved
  cluster counts, kernel memory leaks, and potential kernel panics.

  With bigalloc, the code that determines whether a block must be
  delayed allocated searches the extent tree to see if that block maps
  to a previously allocated cluster.  If not, the block is delayed
  allocated, and otherwise, it isn't.  However, if the inline option is
  also used, and if the file containing the block is marked as able to
  store data inline, there isn't a valid extent tree associated with
  the file.  The current code in ext4_clu_mapped() calls
  ext4_find_extent() to search the non-existent tree for a previously
  allocated cluster anyway, which typically finds nothing, as desired.
  However, a side effect of the search can be to cache invalid content
  from the non-existent tree (garbage) in the extent status tree,
  including bogus entries in the pending reservation tree.

  To fix this, avoid searching the extent tree when allocating blocks
  for bigalloc + inline files that are being converted from inline to
  extent mapped.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50286
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/131294c35ed6f777bd4e79d42af13b5c41bf2775
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6f4200ec76a0d31200c308ec5a71c68df5417004
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/81b915181c630ee1cffa052e52874fe4e1ba91ac
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9404839e0c9db5a517ea83c0ca3388b39d105fdf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c0c8edbc8abbe8f16d80a1d794d1ba2c12b6f193
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d440d6427a5e3a877c1c259b8d2b216ddb65e185
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f83391339d8493b9ff24167516aaa5a5e88d8f81
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50286
    reference_type:
    reference_id: CVE-2022-50286
