advisory_id: CVE-2026-23201
datasource_id: nvd_importer_v2/CVE-2026-23201
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23201
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ceph: fix oops due to invalid pointer for kfree() in parse_longname()

  This fixes a kernel oops when reading ceph snapshot directories (.snap),
  for example by simply running `ls /mnt/my_ceph/.snap`.

  The variable str is guarded by __free(kfree), but advanced by one for
  skipping the initial '_' in snapshot names. Thus, kfree() is called
  with an invalid pointer.  This patch removes the need for advancing the
  pointer so kfree() is called with correct memory pointer.

  Steps to reproduce:

  1. Create snapshots on a cephfs volume (I've 63 snaps in my testcase)

  2. Add cephfs mount to fstab
  $ echo "samba-fileserver@.files=/volumes/datapool/stuff/3461082b-ecc9-4e82-8549-3fd2590d3fb6      /mnt/test/stuff   ceph     acl,noatime,_netdev    0       0" >> /etc/fstab

  3. Reboot the system
  $ systemctl reboot

  4. Check if it's really mounted
  $ mount | grep stuff

  5. List snapshots (expected 63 snapshots on my system)
  $ ls /mnt/test/stuff/.snap

  Now ls hangs forever and the kernel log shows the oops.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/8c9af7339de419819cfc641d551675d38ff99abf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bc8dedae022ce3058659c3addef3ec4b41d15e00
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e258ed369c9e04caa7d2fd49785d753ae4034cb6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23201
    reference_type:
    reference_id: CVE-2026-23201
