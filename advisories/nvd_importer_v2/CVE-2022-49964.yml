advisory_id: CVE-2022-49964
datasource_id: nvd_importer_v2/CVE-2022-49964
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49964
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  arm64: cacheinfo: Fix incorrect assignment of signed error value to unsigned fw_level

  Though acpi_find_last_cache_level() always returned signed value and the
  document states it will return any errors caused by lack of a PPTT table,
  it never returned negative values before.

  Commit 0c80f9e165f8 ("ACPI: PPTT: Leave the table mapped for the runtime usage")
  however changed it by returning -ENOENT if no PPTT was found. The value
  returned from acpi_find_last_cache_level() is then assigned to unsigned
  fw_level.

  It will result in the number of cache leaves calculated incorrectly as
  a huge value which will then cause the following warning from __alloc_pages
  as the order would be great than MAX_ORDER because of incorrect and huge
  cache leaves value.

    |  WARNING: CPU: 0 PID: 1 at mm/page_alloc.c:5407 __alloc_pages+0x74/0x314
    |  Modules linked in:
    |  CPU: 0 PID: 1 Comm: swapper/0 Not tainted 5.19.0-10393-g7c2a8d3ac4c0 #73
    |  pstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
    |  pc : __alloc_pages+0x74/0x314
    |  lr : alloc_pages+0xe8/0x318
    |  Call trace:
    |   __alloc_pages+0x74/0x314
    |   alloc_pages+0xe8/0x318
    |   kmalloc_order_trace+0x68/0x1dc
    |   __kmalloc+0x240/0x338
    |   detect_cache_attributes+0xe0/0x56c
    |   update_siblings_masks+0x38/0x284
    |   store_cpu_topology+0x78/0x84
    |   smp_prepare_cpus+0x48/0x134
    |   kernel_init_freeable+0xc4/0x14c
    |   kernel_init+0x2c/0x1b4
    |   ret_from_fork+0x10/0x20

  Fix the same by changing fw_level to be signed integer and return the
  error from init_cache_level() early in case of error.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49964
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/a754ee1c66bd0a23e613f0bf865053b29cb90e16
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e75d18cecbb3805895d8ed64da4f78575ec96043
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49964
    reference_type:
    reference_id: CVE-2022-49964
