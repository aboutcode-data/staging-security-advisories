advisory_id: CVE-2024-49943
datasource_id: nvd_importer_v2/CVE-2024-49943
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-49943
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/xe/guc_submit: add missing locking in wedged_fini

  Any non-wedged queue can have a zero refcount here and can be running
  concurrently with an async queue destroy, therefore dereferencing the
  queue ptr to check wedge status after the lookup can trigger UAF if
  queue is not wedged.  Fix this by keeping the submission_state lock held
  around the check to postpone the free and make the check safe, before
  dropping again around the put() to avoid the deadlock.

  (cherry picked from commit d28af0b6b9580b9f90c265a7da0315b0ad20bbfd)
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49943
weaknesses:
  - CWE-667
references:
  - url: https://git.kernel.org/stable/c/790533e44bfc7af929842fccd9674c9f424d4627
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d88f9bab7e62dd0dbe983fa70cf040042a60cc84
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49943
    reference_type:
    reference_id: CVE-2024-49943
