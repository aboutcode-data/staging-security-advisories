advisory_id: CVE-2023-54243
datasource_id: nvd_importer_v2/CVE-2023-54243
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54243
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: ebtables: fix table blob use-after-free

  We are not allowed to return an error at this point.
  Looking at the code it looks like ret is always 0 at this
  point, but its not.

  t = find_table_lock(net, repl->name, &ret, &ebt_mutex);

  ... this can return a valid table, with ret != 0.

  This bug causes update of table->private with the new
  blob, but then frees the blob right away in the caller.

  Syzbot report:

  BUG: KASAN: vmalloc-out-of-bounds in __ebt_unregister_table+0xc00/0xcd0 net/bridge/netfilter/ebtables.c:1168
  Read of size 4 at addr ffffc90005425000 by task kworker/u4:4/74
  Workqueue: netns cleanup_net
  Call Trace:
   kasan_report+0xbf/0x1f0 mm/kasan/report.c:517
   __ebt_unregister_table+0xc00/0xcd0 net/bridge/netfilter/ebtables.c:1168
   ebt_unregister_table+0x35/0x40 net/bridge/netfilter/ebtables.c:1372
   ops_exit_list+0xb0/0x170 net/core/net_namespace.c:169
   cleanup_net+0x4ee/0xb10 net/core/net_namespace.c:613
  ...

  ip(6)tables appears to be ok (ret should be 0 at this point) but make
  this more obvious.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3dd6ac973351308d4117eda32298a9f1d68764fd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9060abce3305ab2354c892c09d5689df51486df5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cda0e0243bd3c04008fcd37a46b0269fb3c49249
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dbb3cbbf03b3c52cb390fabec357f1e4638004f5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e58a171d35e32e6e8c37cfe0e8a94406732a331f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54243
    reference_type:
    reference_id: CVE-2023-54243
