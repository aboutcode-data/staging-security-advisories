advisory_id: CVE-2025-31493
datasource_id: nvd_importer_v2/CVE-2025-31493
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-31493
aliases: []
summary: Kirby is an open-source content management system. A vulnerability in versions prior
  to 3.9.8.3, 3.10.1.2, and 4.7.1 affects all Kirby sites that use the `collection()` helper
  or `$kirby->collection()` method with a dynamic collection name (such as a collection name
  that depends on request or user data). Sites that only use fixed calls to the `collection()`
  helper/`$kirby->collection()` method (i.e. calls with a simple string for the collection name)
  are *not* affected. A missing path traversal check allowed attackers to navigate and access
  all files on the server that were accessible to the PHP process, including files outside of
  the collections root or even outside of the Kirby installation. PHP code within such files
  was executed. Such attacks first require an attack vector in the site code that is caused
  by dynamic collection names, such as `collection('tags-' . get('tags'))`. It generally also
  requires knowledge of the site structure and the server's file system by the attacker, although
  it can be possible to find vulnerable setups through automated methods such as fuzzing. In
  a vulnerable setup, this could cause damage to the confidentiality and integrity of the server.
  The problem has been patched in Kirby 3.9.8.3, Kirby 3.10.1.2, and Kirby 4.7.1. In all of
  the mentioned releases, the maintainers of Kirby have added a check for the collection path
  that ensures that the resulting path is contained within the configured collections root.
  Collection paths that point outside of the collections root will not be loaded.
impacted_packages: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-31493
  - score: '6.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-31493
weaknesses:
  - CWE-23
  - CWE-22
references:
  - url: https://github.com/getkirby/kirby/releases/tag/3.10.1.2
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.9.8.3
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/4.7.1
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/security/advisories/GHSA-x275-h9j4-7p4h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:getkirby:kirby:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:getkirby:kirby:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-31493
    reference_type:
    reference_id: CVE-2025-31493
