advisory_id: CVE-2023-52492
datasource_id: nvd_importer_v2/CVE-2023-52492
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-52492
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dmaengine: fix NULL pointer in channel unregistration function

  __dma_async_device_channel_register() can fail. In case of failure,
  chan->local is freed (with free_percpu()), and chan->local is nullified.
  When dma_async_device_unregister() is called (because of managed API or
  intentionally by DMA controller driver), channels are unconditionally
  unregistered, leading to this NULL pointer:
  [    1.318693] Unable to handle kernel NULL pointer dereference at virtual address 00000000000000d0
  [...]
  [    1.484499] Call trace:
  [    1.486930]  device_del+0x40/0x394
  [    1.490314]  device_unregister+0x20/0x7c
  [    1.494220]  __dma_async_device_channel_unregister+0x68/0xc0

  Look at dma_async_device_register() function error path, channel device
  unregistration is done only if chan->local is not NULL.

  Then add the same condition at the beginning of
  __dma_async_device_channel_unregister() function, to avoid NULL pointer
  issue whatever the API used to reach this function.
impacted_packages: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52492
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/047fce470412ab64cb7345f9ff5d06919078ad79
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2ab32986a0b9e329eb7f8f04dd57cc127f797c08
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7f0ccfad2031eddcc510caf4e57f2d4aa2d8a50b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9263fd2a63487c6d04cbb7b74a48fb12e1e352d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9de69732dde4e443c1c7f89acbbed2c45a6a8e17
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f5c24d94512f1b288262beda4d3dcb9629222fc7
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52492
    reference_type:
    reference_id: CVE-2023-52492
