advisory_id: CVE-2021-43844
datasource_id: nvd_importer_v2/CVE-2021-43844
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-43844
aliases: []
summary: MSEdgeRedirect is a tool to redirect news, search, widgets, weather, and more to a
  user's default browser. MSEdgeRedirect versions before 0.5.0.1 are vulnerable to Remote Code
  Execution via specifically crafted URLs. This vulnerability requires user interaction and
  the acceptance of a prompt. With how MSEdgeRedirect is coded, parameters are impossible to
  pass to any launched file. However, there are two possible scenarios in which an attacker
  can do more than a minor annoyance. In Scenario 1 (confirmed), a user visits an attacker controlled
  webpage; the user is prompted with, and downloads, an executable payload; the user is prompted
  with, and accepts, the aforementioned crafted URL prompt; and RCE executes the payload the
  user previously downloaded, if the download path is successfully guessed. In Scenario 2 (not
  yet confirmed), a user visits an attacked controlled webpage; the user is prompted with, and
  accepts, the aforementioned crafted URL prompt; and a payload on a remote, attacker controlled,
  SMB server is executed. The issue was found in the _DecodeAndRun() function, in which I incorrectly
  assumed _WinAPI_UrlIs() would only accept web resources. Unfortunately, file:/// passes the
  default _WinAPI_UrlIs check(). File paths are now directly checked for and must fail. There
  is no currently known exploitation of this vulnerability in the wild. A patched version, 0.5.0.1,
  has been released that checks for and denies these crafted URLs. There are no workarounds
  for this issue. Users are advised not to accept any unexpected prompts from web pages.
impacted_packages: []
severities:
  - score: '9.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43844
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43844
weaknesses:
  - CWE-610
references:
  - url: https://github.com/rcmaehl/MSEdgeRedirect/releases/tag/0.5.0.1
    reference_type:
    reference_id:
  - url: https://github.com/rcmaehl/MSEdgeRedirect/security/advisories/GHSA-95v4-748v-fmf9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:msedgeredirect_project:msedgeredirect:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:msedgeredirect_project:msedgeredirect:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43844
    reference_type:
    reference_id: CVE-2021-43844
