advisory_id: CVE-2024-53143
datasource_id: nvd_importer_v2/CVE-2024-53143
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-53143
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fsnotify: Fix ordering of iput() and watched_objects decrement

  Ensure the superblock is kept alive until we're done with iput().
  Holding a reference to an inode is not allowed unless we ensure the
  superblock stays alive, which fsnotify does by keeping the
  watched_objects count elevated, so iput() must happen before the
  watched_objects decrement.
  This can lead to a UAF of something like sb->s_fs_info in tmpfs, but the
  UAF is hard to hit because race orderings that oops are more likely, thanks
  to the CHECK_DATA_CORRUPTION() block in generic_shutdown_super().

  Also, ensure that fsnotify_put_sb_watched_objects() doesn't call
  fsnotify_sb_watched_objects() on a superblock that may have already been
  freed, which would cause a UAF read of sb->s_fsnotify_info.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-53143
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/21d1b618b6b9da46c5116c640ac4b1cc8d40d63a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/45a8f8232a495221ed058191629f5c628f21601a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/83af1cfa10d9aafdabd06b3655e07727f373b434
    reference_type:
    reference_id:
  - url: https://project-zero.issues.chromium.org/issues/379667898
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-53143
    reference_type:
    reference_id: CVE-2024-53143
