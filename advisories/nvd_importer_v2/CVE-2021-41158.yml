advisory_id: CVE-2021-41158
datasource_id: nvd_importer_v2/CVE-2021-41158
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-41158
aliases: []
summary: FreeSWITCH is a Software Defined Telecom Stack enabling the digital transformation
  from proprietary telecom switches to a software implementation that runs on any commodity
  hardware. Prior to version 1.10.7, an attacker can perform a SIP digest leak attack against
  FreeSWITCH and receive the challenge response of a gateway configured on the FreeSWITCH server.
  This is done by challenging FreeSWITCH's SIP requests with the realm set to that of the gateway,
  thus forcing FreeSWITCH to respond with the challenge response which is based on the password
  of that targeted gateway. Abuse of this vulnerability allows attackers to potentially recover
  gateway passwords by performing a fast offline password cracking attack on the challenge response.
  The attacker does not require special network privileges, such as the ability to sniff the
  FreeSWITCH's network traffic, to exploit this issue. Instead, what is required for this attack
  to work is the ability to cause the victim server to send SIP request messages to the malicious
  party. Additionally, to exploit this issue, the attacker needs to specify the correct realm
  which might in some cases be considered secret. However, because many gateways are actually
  public, this information can easily be retrieved. The vulnerability appears to be due to the
  code which handles challenges in `sofia_reg.c`, `sofia_reg_handle_sip_r_challenge()` which
  does not check if the challenge is originating from the actual gateway. The lack of these
  checks allows arbitrary UACs (and gateways) to challenge any request sent by FreeSWITCH with
  the realm of the gateway being targeted. This issue is patched in version 10.10.7. Maintainers
  recommend that one should create an association between a SIP session for each gateway and
  its realm to make a check be put into place for this association when responding to challenges.
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41158
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41158
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41158
weaknesses:
  - CWE-200
  - CWE-346
references:
  - url: http://seclists.org/fulldisclosure/2021/Oct/40
    reference_type:
    reference_id:
  - url: https://github.com/signalwire/freeswitch/releases/tag/v1.10.7
    reference_type:
    reference_id:
  - url: https://github.com/signalwire/freeswitch/security/advisories/GHSA-3v3f-99mv-qvj4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:freeswitch:freeswitch:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:freeswitch:freeswitch:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41158
    reference_type:
    reference_id: CVE-2021-41158
