advisory_id: CVE-2025-37858
datasource_id: nvd_importer_v2/CVE-2025-37858
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37858
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fs/jfs: Prevent integer overflow in AG size calculation

  The JFS filesystem calculates allocation group (AG) size using 1 <<
  l2agsize in dbExtendFS(). When l2agsize exceeds 31 (possible with >2TB
  aggregates on 32-bit systems), this 32-bit shift operation causes undefined
  behavior and improper AG sizing.

  On 32-bit architectures:
  - Left-shifting 1 by 32+ bits results in 0 due to integer overflow
  - This creates invalid AG sizes (0 or garbage values) in
  sbi->bmap->db_agsize
  - Subsequent block allocations would reference invalid AG structures
  - Could lead to:
    - Filesystem corruption during extend operations
    - Kernel crashes due to invalid memory accesses
    - Security vulnerabilities via malformed on-disk structures

  Fix by casting to s64 before shifting:
  bmp->db_agsize = (s64)1 << l2agsize;

  This ensures 64-bit arithmetic even on 32-bit architectures. The cast
  matches the data type of db_agsize (s64) and follows similar patterns in
  JFS block calculation code.

  Found by Linux Verification Center (linuxtesting.org) with SVACE.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37858
weaknesses:
  - CWE-190
references:
  - url: https://git.kernel.org/stable/c/211ed8f5e39e61f9e4d18edd64ce8005a67a1b2a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3d8a45f87010a802aa214bf39702ca9d99cbf3ba
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/55edbf5dbf60a8195c21e92124c4028939ae16b2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7ccf3b35274512b60ecb614e0637e76bd6f2d829
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7fcbf789629cdb9fbf4e2172ce31136cfed11e5e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8bb29629a5e4090e1ef7199cb42db04a52802239
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c802a6a4009f585111f903e810b3be9c6d0da329
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd07a985e2ded47b6c7d69fc93c1fe02977c8454
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ec34cdf4f917cc6abd306cf091f8b8361fedac88
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37858
    reference_type:
    reference_id: CVE-2025-37858
