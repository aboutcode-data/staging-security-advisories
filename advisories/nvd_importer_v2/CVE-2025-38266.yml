advisory_id: CVE-2025-38266
datasource_id: nvd_importer_v2/CVE-2025-38266
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38266
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  pinctrl: mediatek: eint: Fix invalid pointer dereference for v1 platforms

  Commit 3ef9f710efcb ("pinctrl: mediatek: Add EINT support for multiple
  addresses") introduced an access to the 'soc' field of struct
  mtk_pinctrl in mtk_eint_do_init() and for that an include of
  pinctrl-mtk-common-v2.h.

  However, pinctrl drivers relying on the v1 common driver include
  pinctrl-mtk-common.h instead, which provides another definition of
  struct mtk_pinctrl that does not contain an 'soc' field.

  Since mtk_eint_do_init() can be called both by v1 and v2 drivers, it
  will now try to dereference an invalid pointer when called on v1
  platforms. This has been observed on Genio 350 EVK (MT8365), which
  crashes very early in boot (the kernel trace can only be seen with
  earlycon).

  In order to fix this, since 'struct mtk_pinctrl' was only needed to get
  a 'struct mtk_eint_pin', make 'struct mtk_eint_pin' a parameter
  of mtk_eint_do_init() so that callers need to supply it, removing
  mtk_eint_do_init()'s dependency on any particular 'struct mtk_pinctrl'.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38266
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/1c9977b263475373b31bbf86af94a5c9ae2be42c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ebe21ede792cef851847648962c363cac67d17f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38266
    reference_type:
    reference_id: CVE-2025-38266
