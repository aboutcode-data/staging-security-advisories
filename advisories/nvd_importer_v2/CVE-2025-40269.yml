advisory_id: CVE-2025-40269
datasource_id: nvd_importer_v2/CVE-2025-40269
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40269
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ALSA: usb-audio: Fix potential overflow of PCM transfer buffer

  The PCM stream data in USB-audio driver is transferred over USB URB
  packet buffers, and each packet size is determined dynamically.  The
  packet sizes are limited by some factors such as wMaxPacketSize USB
  descriptor.  OTOH, in the current code, the actually used packet sizes
  are determined only by the rate and the PPS, which may be bigger than
  the size limit above.  This results in a buffer overflow, as reported
  by syzbot.

  Basically when the limit is smaller than the calculated packet size,
  it implies that something is wrong, most likely a weird USB
  descriptor.  So the best option would be just to return an error at
  the parameter setup time before doing any further operations.

  This patch introduces such a sanity check, and returns -EINVAL when
  the packet size is greater than maxpacksize.  The comparison with
  ep->packsize[1] alone should suffice since it's always equal or
  greater than ep->packsize[0].
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/05a1fc5efdd8560f34a3af39c9cf1e1526cc3ddf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/217d47255a2ec8b246f2725f5db9ac3f1d4109d7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/282aba56713bbc58155716b55ca7222b2d9cf3c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/480a1490c595a242f27493a4544b3efb21b29f6a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6a5da3fa80affc948923f20a4e086177f505e86e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/98e9d5e33bda8db875cc1a4fe99c192658e45ab6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ab0b5e92fc36ee82c1bd01fe896d0f775ed5de41
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c4dc012b027c9eb101583011089dea14d744e314
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d2c04f20ccc6c0d219e6d3038bab45bc66a178ad
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d67dde02049e632ba58d3c44a164a74b6a737154
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e0ed5a36fb3ab9e7b9ee45cd17f09f6d5f594360
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ece3b981bb6620e47fac826a2156c090b1a936a0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ef592bf2232a2daa9fffa8881881fc9957ea56e9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40269
    reference_type:
    reference_id: CVE-2025-40269
