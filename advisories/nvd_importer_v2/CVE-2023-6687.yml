advisory_id: CVE-2023-6687
datasource_id: nvd_importer_v2/CVE-2023-6687
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-6687
aliases: []
summary: An issue was discovered by Elastic whereby Elastic Agent would log a raw event in its
  own logs at the WARN or ERROR level if ingesting that event to Elasticsearch failed with any
  4xx HTTP status code except 409 or 429. Depending on the nature of the event that Elastic
  Agent attempted to ingest, this could lead to the insertion of sensitive or private information
  in the Elastic Agent logs. Elastic has released 8.11.3 and 7.17.16 that prevents this issue
  by limiting these types of logs to DEBUG level logging, which is disabled by default.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-6687
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-6687
weaknesses:
  - CWE-532
references:
  - url: https://discuss.elastic.co/t/beats-and-elastic-agent-8-11-3-7-17-16-security-update-esa-2023-30/349180
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:elastic:elastic_agent:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:elastic:elastic_agent:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-6687
    reference_type:
    reference_id: CVE-2023-6687
