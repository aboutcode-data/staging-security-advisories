advisory_id: CVE-2023-34253
datasource_id: nvd_importer_v2/CVE-2023-34253
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-34253
aliases: []
summary: Grav is a flat-file content management system. Prior to version 1.7.42, the denylist
  introduced in commit 9d6a2d to prevent dangerous functions from being executed via injection
  of malicious templates was insufficient and could be easily subverted in multiple ways --
  (1) using unsafe functions that are not banned, (2) using capitalised callable names, and
  (3) using fully-qualified names for referencing callables. Consequently, a low privileged
  attacker with login access to Grav Admin panel and page creation/update permissions is able
  to inject malicious templates to obtain remote code execution. A patch in version 1.7.42 improves
  the denylist.
impacted_packages: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34253
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34253
weaknesses:
  - CWE-1336
  - CWE-184
  - CWE-94
references:
  - url: https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/
    reference_type:
    reference_id:
  - url: https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:getgrav:grav:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:getgrav:grav:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34253
    reference_type:
    reference_id: CVE-2023-34253
