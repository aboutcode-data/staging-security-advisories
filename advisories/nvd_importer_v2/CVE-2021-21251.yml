advisory_id: CVE-2021-21251
datasource_id: nvd_importer_v2/CVE-2021-21251
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21251
aliases: []
summary: OneDev is an all-in-one devops platform. In OneDev before version 4.0.3 there is a
  critical "zip slip" vulnerability. This issue may lead to arbitrary file write. The KubernetesResource
  REST endpoint untars user controlled data from the request body using TarUtils. TarUtils is
  a custom library method leveraging Apache Commons Compress. During the untar process, there
  are no checks in place to prevent an untarred file from traversing the file system and overriding
  an existing file. For a successful exploitation, the attacker requires a valid __JobToken__
  which may not be possible to get without using any of the other reported vulnerabilities.
  But this should be considered a vulnerability in `io.onedev.commons.utils.TarUtils` since
  it lives in a different artifact and can affect other projects using it. This issue was addressed
  in 4.0.3 by validating paths in tar archive to only allow them to be in specified folder when
  extracted.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21251
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21251
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21251
weaknesses:
  - CWE-22
references:
  - url: https://github.com/theonedev/onedev/security/advisories/GHSA-2w6j-wc8c-9mq2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21251
    reference_type:
    reference_id: CVE-2021-21251
