advisory_id: CVE-2025-39921
datasource_id: nvd_importer_v2/CVE-2025-39921
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39921
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  spi: microchip-core-qspi: stop checking viability of op->max_freq in supports_op callback

  In commit 13529647743d9 ("spi: microchip-core-qspi: Support per spi-mem
  operation frequency switches") the logic for checking the viability of
  op->max_freq in mchp_coreqspi_setup_clock() was copied into
  mchp_coreqspi_supports_op(). Unfortunately, op->max_freq is not valid
  when this function is called during probe but is instead zero.
  Accordingly, baud_rate_val is calculated to be INT_MAX due to division
  by zero, causing probe of the attached memory device to fail.

  Seemingly spi-microchip-core-qspi was the only driver that had such a
  modification made to its supports_op callback when the per_op_freq
  capability was added, so just remove it to restore prior functionality.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39921
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/89e7353f522f5cf70cb48c01ce2dcdcb275b8022
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac8a13f35d5b8996582b3f97b924838a5c570c18
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39921
    reference_type:
    reference_id: CVE-2025-39921
