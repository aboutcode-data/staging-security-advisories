advisory_id: CVE-2021-21328
datasource_id: nvd_importer_v2/CVE-2021-21328
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21328
aliases: []
summary: 'Vapor is a web framework for Swift. In Vapor before version 4.40.1, there is a DoS
  attack against anyone who Bootstraps a metrics backend for their Vapor app. The following
  is the attack vector: 1. send unlimited requests against a vapor instance with different paths.
  this will create unlimited counters and timers, which will eventually drain the system. 2.
  downstream services might suffer from this attack as well by being spammed with error paths.
  This has been patched in 4.40.1. The `DefaultResponder` will rewrite any undefined route paths
  for to `vapor_route_undefined` to avoid unlimited counters.'
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21328
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21328
weaknesses:
  - CWE-400
references:
  - url: https://github.com/vapor/vapor/commit/e3aa712508db2854ac0ab905696c65fd88fa7e23
    reference_type:
    reference_id:
  - url: https://github.com/vapor/vapor/releases/tag/4.40.1
    reference_type:
    reference_id:
  - url: https://github.com/vapor/vapor/security/advisories/GHSA-gcj9-jj38-hwmc
    reference_type:
    reference_id:
  - url: https://vapor.codes/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vapor_project:vapor:*:*:*:*:*:swift:*:*
    reference_type:
    reference_id: cpe:2.3:a:vapor_project:vapor:*:*:*:*:*:swift:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21328
    reference_type:
    reference_id: CVE-2021-21328
