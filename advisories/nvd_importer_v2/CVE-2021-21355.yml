advisory_id: CVE-2021-21355
datasource_id: nvd_importer_v2/CVE-2021-21355
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21355
aliases: []
summary: TYPO3 is an open source PHP based web content management system. In TYPO3 before versions
  8.7.40, 9.5.25, 10.4.14, 11.1.1, due to the lack of ensuring file extensions belong to configured
  allowed mime-types, attackers can upload arbitrary data with arbitrary file extensions - however,
  default _fileDenyPattern_ successfully blocked files like _.htaccess_ or _malicious.php_.
  Besides that, _UploadedFileReferenceConverter_ transforming uploaded files into proper FileReference
  domain model objects handles possible file uploads for other extensions as well - given those
  extensions use the Extbase MVC framework, make use of FileReference items in their direct
  or inherited domain model definitions and did not implement their own type converter. In case
  this scenario applies, _UploadedFileReferenceConverter_ accepts any file mime-type and persists
  files in the default location. In any way, uploaded files are placed in the default location
  _/fileadmin/user_upload/_, in most scenarios keeping the submitted filename - which allows
  attackers to directly reference files, or even correctly guess filenames used by other individuals,
  disclosing this information. No authentication is required to exploit this vulnerability.
  This is fixed in versions 8.7.40, 9.5.25, 10.4.14, 11.1.1.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21355
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21355
weaknesses:
  - CWE-552
  - CWE-434
references:
  - url: https://github.com/TYPO3/TYPO3.CMS/security/advisories/GHSA-2r6j-862c-m2v2
    reference_type:
    reference_id:
  - url: https://packagist.org/packages/typo3/cms-form
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2021-002
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21355
    reference_type:
    reference_id: CVE-2021-21355
