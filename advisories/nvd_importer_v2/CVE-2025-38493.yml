advisory_id: CVE-2025-38493
datasource_id: nvd_importer_v2/CVE-2025-38493
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38493
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tracing/osnoise: Fix crash in timerlat_dump_stack()

  We have observed kernel panics when using timerlat with stack saving,
  with the following dmesg output:

  memcpy: detected buffer overflow: 88 byte write of buffer size 0
  WARNING: CPU: 2 PID: 8153 at lib/string_helpers.c:1032 __fortify_report+0x55/0xa0
  CPU: 2 UID: 0 PID: 8153 Comm: timerlatu/2 Kdump: loaded Not tainted 6.15.3-200.fc42.x86_64 #1 PREEMPT(lazy)
  Call Trace:
   <TASK>
   ? trace_buffer_lock_reserve+0x2a/0x60
   __fortify_panic+0xd/0xf
   __timerlat_dump_stack.cold+0xd/0xd
   timerlat_dump_stack.part.0+0x47/0x80
   timerlat_fd_read+0x36d/0x390
   vfs_read+0xe2/0x390
   ? syscall_exit_to_user_mode+0x1d5/0x210
   ksys_read+0x73/0xe0
   do_syscall_64+0x7b/0x160
   ? exc_page_fault+0x7e/0x1a0
   entry_SYSCALL_64_after_hwframe+0x76/0x7e

  __timerlat_dump_stack() constructs the ftrace stack entry like this:

  struct stack_entry *entry;
  ...
  memcpy(&entry->caller, fstack->calls, size);
  entry->size = fstack->nr_entries;

  Since commit e7186af7fb26 ("tracing: Add back FORTIFY_SOURCE logic to
  kernel_stack event structure"), struct stack_entry marks its caller
  field with __counted_by(size). At the time of the memcpy, entry->size
  contains garbage from the ringbuffer, which under some circumstances is
  zero, triggering a kernel panic by buffer overflow.

  Populate the size field before the memcpy so that the out-of-bounds
  check knows the correct size. This is analogous to
  __ftrace_trace_stack().
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38493
weaknesses:
  - CWE-674
references:
  - url: https://git.kernel.org/stable/c/7bb9ea515cda027c9e717e27fefcf34f092e7c41
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/823d798900481875ba6c68217af028c5ffd2976b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/85a3bce695b361d85fc528e6fbb33e4c8089c806
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fbf90f5aa7ac7cddc69148a71d58f12c8709ce2b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38493
    reference_type:
    reference_id: CVE-2025-38493
