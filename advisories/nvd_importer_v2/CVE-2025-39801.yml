advisory_id: CVE-2025-39801
datasource_id: nvd_importer_v2/CVE-2025-39801
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39801
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: dwc3: Remove WARN_ON for device endpoint command timeouts

  This commit addresses a rarely observed endpoint command timeout
  which causes kernel panic due to warn when 'panic_on_warn' is enabled
  and unnecessary call trace prints when 'panic_on_warn' is disabled.
  It is seen during fast software-controlled connect/disconnect testcases.
  The following is one such endpoint command timeout that we observed:

  1. Connect
     =======
  ->dwc3_thread_interrupt
   ->dwc3_ep0_interrupt
    ->configfs_composite_setup
     ->composite_setup
      ->usb_ep_queue
       ->dwc3_gadget_ep0_queue
        ->__dwc3_gadget_ep0_queue
         ->__dwc3_ep0_do_control_data
          ->dwc3_send_gadget_ep_cmd

  2. Disconnect
     ==========
  ->dwc3_thread_interrupt
   ->dwc3_gadget_disconnect_interrupt
    ->dwc3_ep0_reset_state
     ->dwc3_ep0_end_control_data
      ->dwc3_send_gadget_ep_cmd

  In the issue scenario, in Exynos platforms, we observed that control
  transfers for the previous connect have not yet been completed and end
  transfer command sent as a part of the disconnect sequence and
  processing of USB_ENDPOINT_HALT feature request from the host timeout.
  This maybe an expected scenario since the controller is processing EP
  commands sent as a part of the previous connect. It maybe better to
  remove WARN_ON in all places where device endpoint commands are sent to
  avoid unnecessary kernel panic due to warn.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39801
weaknesses:
  - CWE-617
references:
  - url: https://git.kernel.org/stable/c/45eae113dccaf8e502090ecf5b3d9e9b805add6f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5a1a847d841505dba2bd85602daf5c218e1d85b8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/84c95dbf5bece56086cdb65a64162af35158bdd9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db27482b9db340402e05d4e9b75352bbaca51af2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dfe40159eec6ca63b40133bfa783eee2e3ed829f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f49697dfba2915a9ff36f94604eb76fa61413929
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39801
    reference_type:
    reference_id: CVE-2025-39801
