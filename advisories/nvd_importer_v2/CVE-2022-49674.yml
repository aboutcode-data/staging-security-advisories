advisory_id: CVE-2022-49674
datasource_id: nvd_importer_v2/CVE-2022-49674
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49674
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dm raid: fix accesses beyond end of raid member array

  On dm-raid table load (using raid_ctr), dm-raid allocates an array
  rs->devs[rs->raid_disks] for the raid device members. rs->raid_disks
  is defined by the number of raid metadata and image tupples passed
  into the target's constructor.

  In the case of RAID layout changes being requested, that number can be
  different from the current number of members for existing raid sets as
  defined in their superblocks. Example RAID layout changes include:
  - raid1 legs being added/removed
  - raid4/5/6/10 number of stripes changed (stripe reshaping)
  - takeover to higher raid level (e.g. raid5 -> raid6)

  When accessing array members, rs->raid_disks must be used in control
  loops instead of the potentially larger value in rs->md.raid_disks.
  Otherwise it will cause memory access beyond the end of the rs->devs
  array.

  Fix this by changing code that is prone to out-of-bounds access.
  Also fix validate_raid_redundancy() to validate all devices that are
  added. Also, use braces to help clean up raid_iterate_devices().

  The out-of-bounds memory accesses was discovered using KASAN.

  This commit was verified to pass all LVM2 RAID tests (with KASAN
  enabled).
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49674
weaknesses:
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/332bd0778775d0cf105c4b9e03e460b590749916
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e161a8826b63c0b8b43e4a7fad1f956780f42ab
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6352b2f4d8e95ec0ae576d7705435d64cfa29503
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/90de15357504c8097ab29769dc6852e16281e9e8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9bf2b0757b04c78dc5d6e3a198acca98457b32a1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bcff98500ea3b4e7615ec31d2bdd326bc1ef5134
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/df1a5ab0dd0775f2ea101c71f2addbc4c0ea0f85
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49674
    reference_type:
    reference_id: CVE-2022-49674
