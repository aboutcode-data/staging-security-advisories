advisory_id: CVE-2024-31464
datasource_id: nvd_importer_v2/CVE-2024-31464
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-31464
aliases: []
summary: 'XWiki Platform is a generic wiki platform. Starting in version 5.0-rc-1 and prior
  to versions 14.10.19, 15.5.4, and 15.9-rc-1, it is possible to access the hash of a password
  by using the diff feature of the history whenever the object storing the password is deleted.
  Using that vulnerability it''s possible for an attacker to have access to the hash password
  of a user if they have rights to edit the users'' page.  With the default right scheme in
  XWiki this vulnerability is normally prevented on user profiles, except by users with Admin
  rights. Note that this vulnerability also impacts any extensions that might use passwords
  stored in xobjects: for those usecases it depends on the right of those pages. There is currently
  no way to be 100% sure that this vulnerability has been exploited, as an attacker with enough
  privilege could have deleted the revision where the xobject was deleted after rolling-back
  the deletion. But again, this operation requires high privileges on the target page (Admin
  right). A page with a user password xobject which have in its history a revision where the
  object has been deleted should be considered at risk and the password should be changed there.
  a diff, to ensure it''s not coming from a password field. As another mitigation, admins should
  ensure that the user pages are properly protected: the edit right shouldn''t be allowed for
  other users than Admin and owner of the profile (which is the default right). There is not
  much workaround possible for a privileged user other than upgrading XWiki.'
impacted_packages: []
severities:
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-31464
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-31464
weaknesses:
  - CWE-200
  - CWE-916
references:
  - url: https://github.com/xwiki/xwiki-platform/commit/9075668a4135cce114ef2a4b72eba3161a9e94c4
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/955fb097e02a2a7153f527522ee9eef42447e5d7
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/f1eaec1e512220fabd970d053c627e435a1652cf
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-v782-xr4w-3vqx
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19948
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-31464
    reference_type:
    reference_id: CVE-2024-31464
