advisory_id: CVE-2026-23068
datasource_id: nvd_importer_v2/CVE-2026-23068
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23068
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  spi: spi-sprd-adi: Fix double free in probe error path

  The driver currently uses spi_alloc_host() to allocate the controller
  but registers it using devm_spi_register_controller().

  If devm_register_restart_handler() fails, the code jumps to the
  put_ctlr label and calls spi_controller_put(). However, since the
  controller was registered via a devm function, the device core will
  automatically call spi_controller_put() again when the probe fails.
  This results in a double-free of the spi_controller structure.

  Fix this by switching to devm_spi_alloc_host() and removing the
  manual spi_controller_put() call.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/346775f2b4cf839177e8e86b94aa180a06dc15b0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/383d4f5cffcc8df930d95b06518a9d25a6d74aac
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/417cdfd9b9f986e95bfcb1d68eb443e6e0a15f8c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bddd3d10d039729b81cfb0804520c8832a701a0e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6d6b3f172df118db582fe5ec43ae223a55d99cf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23068
    reference_type:
    reference_id: CVE-2026-23068
