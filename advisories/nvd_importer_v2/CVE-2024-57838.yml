advisory_id: CVE-2024-57838
datasource_id: nvd_importer_v2/CVE-2024-57838
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-57838
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  s390/entry: Mark IRQ entries to fix stack depot warnings

  The stack depot filters out everything outside of the top interrupt
  context as an uninteresting or irrelevant part of the stack traces. This
  helps with stack trace de-duplication, avoiding an explosion of saved
  stack traces that share the same IRQ context code path but originate
  from different randomly interrupted points, eventually exhausting the
  stack depot.

  Filtering uses in_irqentry_text() to identify functions within the
  .irqentry.text and .softirqentry.text sections, which then become the
  last stack trace entries being saved.

  While __do_softirq() is placed into the .softirqentry.text section by
  common code, populating .irqentry.text is architecture-specific.

  Currently, the .irqentry.text section on s390 is empty, which prevents
  stack depot filtering and de-duplication and could result in warnings
  like:

  Stack depot reached limit capacity
  WARNING: CPU: 0 PID: 286113 at lib/stackdepot.c:252 depot_alloc_stack+0x39a/0x3c8

  with PREEMPT and KASAN enabled.

  Fix this by moving the IO/EXT interrupt handlers from .kprobes.text into
  the .irqentry.text section and updating the kprobes blacklist to include
  the .irqentry.text section.

  This is done only for asynchronous interrupts and explicitly not for
  program checks, which are synchronous and where the context beyond the
  program check is important to preserve. Despite machine checks being
  somewhat in between, they are extremely rare, and preserving context
  when possible is also of value.

  SVCs and Restart Interrupts are not relevant, one being always at the
  boundary to user space and the other being a one-time thing.

  IRQ entries filtering is also optionally used in ftrace function graph,
  where the same logic applies.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-57838
weaknesses:
  - CWE-668
references:
  - url: https://git.kernel.org/stable/c/1af22528fee8072b7adc007b8ca49cc4ea62689e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/45c9f2b856a075a34873d00788d2e8a250c1effd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/473ffae3030188f1c6b80e1b3631a26b4adf7b32
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5bb7a2c3afcf8732dc65ea49c09147b07da1d993
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-57838
    reference_type:
    reference_id: CVE-2024-57838
