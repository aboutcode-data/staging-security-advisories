advisory_id: CVE-2018-15758
datasource_id: nvd_importer_v2/CVE-2018-15758
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2018-15758
aliases: []
summary: 'Spring Security OAuth, versions 2.3 prior to 2.3.4, and 2.2 prior to 2.2.3, and 2.1
  prior to 2.1.3, and 2.0 prior to 2.0.16, and older unsupported versions could be susceptible
  to a privilege escalation under certain conditions. A malicious user or attacker can craft
  a request to the approval endpoint that can modify the previously saved authorization request
  and lead to a privilege escalation on the subsequent approval. This scenario can happen if
  the application is configured to use a custom approval endpoint that declares AuthorizationRequest
  as a controller method argument. This vulnerability exposes applications that meet all of
  the following requirements: Act in the role of an Authorization Server (e.g. @EnableAuthorizationServer)
  and use a custom Approval Endpoint that declares AuthorizationRequest as a controller method
  argument. This vulnerability does not expose applications that: Act in the role of an Authorization
  Server and use the default Approval Endpoint, act in the role of a Resource Server only (e.g.
  @EnableResourceServer), act in the role of a Client only (e.g. @EnableOAuthClient).'
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-15758
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-15758
  - score: '9.6'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-15758
weaknesses: []
references:
  - url: https://access.redhat.com/errata/RHSA-2019:2413
    reference_type:
    reference_id:
  - url: https://pivotal.io/security/cve-2018-15758
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/105687
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:pivotal_software:spring_security_oauth:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:pivotal_software:spring_security_oauth:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-15758
    reference_type:
    reference_id: CVE-2018-15758
