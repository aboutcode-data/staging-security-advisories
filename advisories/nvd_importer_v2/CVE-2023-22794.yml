advisory_id: CVE-2023-22794
datasource_id: nvd_importer_v2/CVE-2023-22794
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-22794
aliases: []
summary: A vulnerability in ActiveRecord <6.0.6.1, v6.1.7.1 and v7.0.4.1 related to the sanitization
  of comments. If malicious user input is passed to either the `annotate` query method, the
  `optimizer_hints` query method, or through the QueryLogs interface which automatically adds
  annotations, it may be sent to the database withinsufficient sanitization and be able to inject
  SQL outside of the comment.
impacted_packages: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-22794
weaknesses:
  - CWE-89
references:
  - url: https://discuss.rubyonrails.org/t/cve-2023-22794-sql-injection-vulnerability-via-activerecord-comments/82117
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240202-0008/
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2023/dsa-5372
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:activerecord_project:activerecord:*:*:*:*:*:ruby:*:*
    reference_type:
    reference_id: cpe:2.3:a:activerecord_project:activerecord:*:*:*:*:*:ruby:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-22794
    reference_type:
    reference_id: CVE-2023-22794
