advisory_id: CVE-2024-56828
datasource_id: nvd_importer_v2/CVE-2024-56828
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-56828
aliases: []
summary: 'File Upload vulnerability in ChestnutCMS through 1.5.0. Based on the code analysis,
  it was determined that the /api/member/avatar API endpoint receives a base64 string as input.
  This string is then passed to the memberService.uploadAvatarByBase64 method for processing.
  Within the service, the base64-encoded image is parsed. For example, given a string like:
  data:image/html;base64,PGh0bWw+PGltZyBzcmM9eCBvbmVycm9yPWFsZXJ0KDEpPjwvaHRtbD4= the content
  after the comma is extracted and decoded using Base64.getDecoder().decode(). The substring
  from the 11th character up to the first occurrence of a semicolon (;) is assigned to the suffix
  variable (representing the file extension). The decoded content is then written to a file.
  However, the file extension is not validated, and since this functionality is exposed to the
  frontend, it poses significant security risks.'
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56828
weaknesses:
  - CWE-434
references:
  - url: https://gitee.com/liweiyi/ChestnutCMS
    reference_type:
    reference_id:
  - url: https://github.com/Zerone0x00/CVE/blob/main/ChestnutCMS/CVE-2024-56828.md
    reference_type:
    reference_id:
  - url: https://www.1000mz.com/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:1000mz:chestnutcms:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:1000mz:chestnutcms:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56828
    reference_type:
    reference_id: CVE-2024-56828
