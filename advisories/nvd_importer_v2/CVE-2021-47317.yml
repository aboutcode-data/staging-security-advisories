advisory_id: CVE-2021-47317
datasource_id: nvd_importer_v2/CVE-2021-47317
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47317
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  powerpc/bpf: Fix detecting BPF atomic instructions

  Commit 91c960b0056672 ("bpf: Rename BPF_XADD and prepare to encode other
  atomics in .imm") converted BPF_XADD to BPF_ATOMIC and added a way to
  distinguish instructions based on the immediate field. Existing JIT
  implementations were updated to check for the immediate field and to
  reject programs utilizing anything more than BPF_ADD (such as BPF_FETCH)
  in the immediate field.

  However, the check added to powerpc64 JIT did not look at the correct
  BPF instruction. Due to this, such programs would be accepted and
  incorrectly JIT'ed resulting in soft lockups, as seen with the atomic
  bounds test. Fix this by looking at the correct immediate value.
impacted_packages: []
severities:
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47317
weaknesses:
  - CWE-667
references:
  - url: https://git.kernel.org/stable/c/0d435b6d94b05dcfd836d758a63145aa566618e2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/419ac821766cbdb9fd85872bb3f1a589df05c94c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7284dab07e4d51d453cc42851fae9ec4fac6ef2f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47317
    reference_type:
    reference_id: CVE-2021-47317
