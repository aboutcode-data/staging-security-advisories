advisory_id: CVE-2025-38584
datasource_id: nvd_importer_v2/CVE-2025-38584
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38584
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  padata: Fix pd UAF once and for all

  There is a race condition/UAF in padata_reorder that goes back
  to the initial commit.  A reference count is taken at the start
  of the process in padata_do_parallel, and released at the end in
  padata_serial_worker.

  This reference count is (and only is) required for padata_replace
  to function correctly.  If padata_replace is never called then
  there is no issue.

  In the function padata_reorder which serves as the core of padata,
  as soon as padata is added to queue->serial.list, and the associated
  spin lock released, that padata may be processed and the reference
  count on pd would go away.

  Fix this by getting the next padata before the squeue->serial lock
  is released.

  In order to make this possible, simplify padata_reorder by only
  calling it once the next padata arrives.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38584
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/71203f68c7749609d7fc8ae6ad054bdedeb24f91
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cdf79bd2e1ecb3cc75631c73d8f4149be6019a52
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dbe3e911a59bda6de96e7cae387ff882c2c177fa
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38584
    reference_type:
    reference_id: CVE-2025-38584
