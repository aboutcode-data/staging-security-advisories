advisory_id: CVE-2017-5217
datasource_id: nvd_importer_v2/CVE-2017-5217
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2017-5217
aliases: []
summary: Installing a zero-permission Android application on certain Samsung Android devices
  with KK(4.4), L(5.0/5.1), and M(6.0) software can continually crash the system_server process
  in the Android OS. The zero-permission app will create an active install session for a separate
  app that it has embedded within it. The active install session of the embedded app is performed
  using the android.content.pm.PackageInstaller class and its nested classes in the Android
  API. The active install session will write the embedded APK file to the /data/app directory,
  but the app will not be installed since third-party applications cannot programmatically install
  apps. Samsung has modified AOSP in order to accelerate the parsing of APKs by introducing
  the com.android.server.pm.PackagePrefetcher class and its nested classes. These classes will
  parse the APKs present in the /data/app directory and other directories, even if the app is
  not actually installed. The embedded APK that was written to the /data/app directory via the
  active install session has a very large but valid AndroidManifest.xml file. Specifically,
  the AndroidManifest.xml file contains a very large string value for the name of a permission-tree
  that it declares. When system_server tries to parse the APK file of the embedded app from
  the active install session, it will crash due to an uncaught error (i.e., java.lang.OutOfMemoryError)
  or an uncaught exception (i.e., std::bad_alloc) because of memory constraints. The Samsung
  Android device will encounter a soft reboot due to a system_server crash, and this action
  will keep repeating since parsing the APKs in the /data/app directory as performed by the
  system_server process is part of the normal boot process. The Samsung ID is SVE-2016-6917.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:N/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-5217
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-5217
weaknesses:
  - CWE-20
  - CWE-119
references:
  - url: http://security.samsungmobile.com/smrupdate.html#SMR-JAN-2017
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/95319
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:samsung:samsung_mobile:4.4:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:samsung:samsung_mobile:4.4:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:samsung:samsung_mobile:5.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:samsung:samsung_mobile:5.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:samsung:samsung_mobile:5.1:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:samsung:samsung_mobile:5.1:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:samsung:samsung_mobile:6.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:samsung:samsung_mobile:6.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-5217
    reference_type:
    reference_id: CVE-2017-5217
