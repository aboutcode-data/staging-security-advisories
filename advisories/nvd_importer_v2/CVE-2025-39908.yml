advisory_id: CVE-2025-39908
datasource_id: nvd_importer_v2/CVE-2025-39908
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39908
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: dev_ioctl: take ops lock in hwtstamp lower paths

  ndo hwtstamp callbacks are expected to run under the per-device ops
  lock. Make the lower get/set paths consistent with the rest of ndo
  invocations.

  Kernel log:
  WARNING: CPU: 13 PID: 51364 at ./include/net/netdev_lock.h:70 __netdev_update_features+0x4bd/0xe60
  ...
  RIP: 0010:__netdev_update_features+0x4bd/0xe60
  ...
  Call Trace:
  <TASK>
  netdev_update_features+0x1f/0x60
  mlx5_hwtstamp_set+0x181/0x290 [mlx5_core]
  mlx5e_hwtstamp_set+0x19/0x30 [mlx5_core]
  dev_set_hwtstamp_phylib+0x9f/0x220
  dev_set_hwtstamp_phylib+0x9f/0x220
  dev_set_hwtstamp+0x13d/0x240
  dev_ioctl+0x12f/0x4b0
  sock_ioctl+0x171/0x370
  __x64_sys_ioctl+0x3f7/0x900
  ? __sys_setsockopt+0x69/0xb0
  do_syscall_64+0x6f/0x2e0
  entry_SYSCALL_64_after_hwframe+0x4b/0x53
  ...
  </TASK>
  ....
  ---[ end trace 0000000000000000 ]---

  Note that the mlx5_hwtstamp_set and mlx5e_hwtstamp_set functions shown
  in the trace come from an in progress patch converting the legacy ioctl
  to ndo_hwtstamp_get/set and are not present in mainline.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39908
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2d92fa0cdc02291de57f72170e8b60cef0cf5372
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/686cab5a18e443e1d5f2abb17bed45837836425f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39908
    reference_type:
    reference_id: CVE-2025-39908
