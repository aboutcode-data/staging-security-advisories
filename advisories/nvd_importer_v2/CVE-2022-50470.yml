advisory_id: CVE-2022-50470
datasource_id: nvd_importer_v2/CVE-2022-50470
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50470
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  xhci: Remove device endpoints from bandwidth list when freeing the device

  Endpoints are normally deleted from the bandwidth list when they are
  dropped, before the virt device is freed.

  If xHC host is dying or being removed then the endpoints aren't dropped
  cleanly due to functions returning early to avoid interacting with a
  non-accessible host controller.

  So check and delete endpoints that are still on the bandwidth list when
  freeing the virt device.

  Solves a list_del corruption kernel crash when unbinding xhci-pci,
  caused by xhci_mem_cleanup() when it later tried to delete already freed
  endpoints from the bandwidth list.

  This only affects hosts that use software bandwidth checking, which
  currenty is only the xHC in intel Panther Point PCH (Ivy Bridge)
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50470
weaknesses:
  - CWE-415
references:
  - url: https://git.kernel.org/stable/c/3bf860a41e0f2fcea0ac3aae8f7ef887a7994b70
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5aed5b7c2430ce318a8e62f752f181e66f0d1053
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e4ce28ad907aa54f13b21d5f1dc490525957b0c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/678d2cc2041cc6ce05030852dce9ad42719abcfc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8f1cd9633d1f21efc13e8fc75be8f2b6bb85e38c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c892a81c7424b4f6a660cb9c249d354ccf3afeca
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cebbc8d335d6bcc1316584f779c08f80287c6af8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f0de39474078adef6ece7a183e34c15ce2c1d8d1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50470
    reference_type:
    reference_id: CVE-2022-50470
