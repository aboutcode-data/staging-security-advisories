advisory_id: CVE-2024-9681
datasource_id: nvd_importer_v2/CVE-2024-9681
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-9681
aliases: []
summary: |
  When curl is asked to use HSTS, the expiry time for a subdomain might
  overwrite a parent domain's cache entry, making it end sooner or later than
  otherwise intended.

  This affects curl using applications that enable HSTS and use URLs with the
  insecure `HTTP://` scheme and perform transfers with hosts like
  `x.example.com` as well as `example.com` where the first host is a subdomain
  of the second host.

  (The HSTS cache either needs to have been populated manually or there needs to
  have been previous HTTPS accesses done as the cache needs to have entries for
  the domains involved to trigger this problem.)

  When `x.example.com` responds with `Strict-Transport-Security:` headers, this
  bug can make the subdomain's expiry timeout *bleed over* and get set for the
  parent domain `example.com` in curl's HSTS cache.

  The result of a triggered bug is that HTTP accesses to `example.com` get
  converted to HTTPS for a different period of time than what was asked for by
  the origin server. If `example.com` for example stops supporting HTTPS at its
  expiry time, curl might then fail to access `http://example.com` until the
  (wrongly set) timeout expires. This bug can also expire the parent's entry
  *earlier*, thus making curl inadvertently switch back to insecure HTTP earlier
  than otherwise intended.
impacted_packages: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-9681
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-9681
weaknesses:
  - CWE-697
references:
  - url: https://curl.se/docs/CVE-2024-9681.html
    reference_type:
    reference_id:
  - url: https://curl.se/docs/CVE-2024-9681.json
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2025/Apr/10
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2025/Apr/11
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2025/Apr/12
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2025/Apr/13
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2025/Apr/4
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2025/Apr/5
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2025/Apr/8
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2025/Apr/9
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/2764830
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20241213-0006/
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/11/06/2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:haxx:curl:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:haxx:curl:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-9681
    reference_type:
    reference_id: CVE-2024-9681
