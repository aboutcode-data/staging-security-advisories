advisory_id: CVE-2025-40022
datasource_id: nvd_importer_v2/CVE-2025-40022
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40022
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  crypto: af_alg - Fix incorrect boolean values in af_alg_ctx

  Commit 1b34cbbf4f01 ("crypto: af_alg - Disallow concurrent writes in
  af_alg_sendmsg") changed some fields from bool to 1-bit bitfields of
  type u32.

  However, some assignments to these fields, specifically 'more' and
  'merge', assign values greater than 1.  These relied on C's implicit
  conversion to bool, such that zero becomes false and nonzero becomes
  true.

  With a 1-bit bitfields of type u32 instead, mod 2 of the value is taken
  instead, resulting in 0 being assigned in some cases when 1 was intended.

  Fix this by restoring the bool type.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/316b090c2fee964c307a634fecc7df269664b158
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3a21698ace915a445bce2d0dcfc84b6d2199baf7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/54506c6335690f4ef1b9f154e34f5a604c72c1ed
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8703940bd30b5ad94408d28d7192db2491cd3592
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d0ca0df179c4b21e2a6c4a4fb637aa8fa14575cb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d382d6daf0184490f366562469a5673f65ee2662
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fbe96bd25423e61273d8831e995260b429d850b6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40022
    reference_type:
    reference_id: CVE-2025-40022
