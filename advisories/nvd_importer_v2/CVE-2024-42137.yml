advisory_id: CVE-2024-42137
datasource_id: nvd_importer_v2/CVE-2024-42137
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-42137
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  Bluetooth: qca: Fix BT enable failure again for QCA6390 after warm reboot

  Commit 272970be3dab ("Bluetooth: hci_qca: Fix driver shutdown on closed
  serdev") will cause below regression issue:

  BT can't be enabled after below steps:
  cold boot -> enable BT -> disable BT -> warm reboot -> BT enable failure
  if property enable-gpios is not configured within DT|ACPI for QCA6390.

  The commit is to fix a use-after-free issue within qca_serdev_shutdown()
  by adding condition to avoid the serdev is flushed or wrote after closed
  but also introduces this regression issue regarding above steps since the
  VSC is not sent to reset controller during warm reboot.

  Fixed by sending the VSC to reset controller within qca_serdev_shutdown()
  once BT was ever enabled, and the use-after-free issue is also fixed by
  this change since the serdev is still opened before it is flushed or wrote.

  Verified by the reported machine Dell XPS 13 9310 laptop over below two
  kernel commits:
  commit e00fc2700a3f ("Bluetooth: btusb: Fix triggering coredump
  implementation for QCA") of bluetooth-next tree.
  commit b23d98d46d28 ("Bluetooth: btusb: Fix triggering coredump
  implementation for QCA") of linus mainline tree.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42137
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/215a26c2404fa34625c725d446967fa328a703eb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4ca6013cd18e58ac1044908c40d4006a92093a11
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/88e72239ead9814b886db54fc4ee39ef3c2b8f26
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/977b9dc65e14fb80de4763d949c7dec2ecb15b9b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e2d8aa4c763593704ac21e7591aed4f13e32f3b5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e6e200b264271f62a3fadb51ada9423015ece37b
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42137
    reference_type:
    reference_id: CVE-2024-42137
