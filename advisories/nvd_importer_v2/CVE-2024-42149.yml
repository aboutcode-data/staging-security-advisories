advisory_id: CVE-2024-42149
datasource_id: nvd_importer_v2/CVE-2024-42149
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-42149
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fs: don't misleadingly warn during thaw operations

  The block device may have been frozen before it was claimed by a
  filesystem. Concurrently another process might try to mount that
  frozen block device and has temporarily claimed the block device for
  that purpose causing a concurrent fs_bdev_thaw() to end up here. The
  mounter is already about to abort mounting because they still saw an
  elevanted bdev->bd_fsfreeze_count so get_bdev_super() will return
  NULL in that case.

  For example, P1 calls dm_suspend() which calls into bdev_freeze() before
  the block device has been claimed by the filesystem. This brings
  bdev->bd_fsfreeze_count to 1 and no call into fs_bdev_freeze() is
  required.

  Now P2 tries to mount that frozen block device. It claims it and checks
  bdev->bd_fsfreeze_count. As it's elevated it aborts mounting.

  In the meantime P3 called dm_resume(). P3 sees that the block device is
  already claimed by a filesystem and calls into fs_bdev_thaw().

  P3 takes a passive reference and realizes that the filesystem isn't
  ready yet. P3 puts itself to sleep to wait for the filesystem to become
  ready.

  P2 now puts the last active reference to the filesystem and marks it as
  dying. P3 gets woken, sees that the filesystem is dying and
  get_bdev_super() fails.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42149
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/25b1e3906e050d452427bc51620bb7f0a591373a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2ae4db5647d807efb6a87c09efaa6d1db9c905d7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42149
    reference_type:
    reference_id: CVE-2024-42149
