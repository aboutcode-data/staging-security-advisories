advisory_id: CVE-2022-29165
datasource_id: nvd_importer_v2/CVE-2022-29165
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-29165
aliases: []
summary: Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. A critical
  vulnerability has been discovered in Argo CD starting with version 1.4.0 and prior to versions
  2.1.15, 2.2.9, and 2.3.4 which would allow unauthenticated users to impersonate as any Argo
  CD user or role, including the `admin` user, by sending a specifically crafted JSON Web Token
  (JWT) along with the request. In order for this vulnerability to be exploited, anonymous access
  to the Argo CD instance must have been enabled. In a default Argo CD installation, anonymous
  access is disabled. The vulnerability can be exploited to impersonate as any user or role,
  including the built-in `admin` account regardless of whether it is enabled or disabled. Also,
  the attacker does not need an account on the Argo CD instance in order to exploit this. If
  anonymous access to the instance is enabled, an attacker can escalate their privileges, effectively
  allowing them to gain the same privileges on the cluster as the Argo CD instance, which is
  cluster admin in a default installation. This will allow the attacker to create, manipulate
  and delete any resource on the cluster. They may also exfiltrate data by deploying malicious
  workloads with elevated privileges, thus bypassing any redaction of sensitive data otherwise
  enforced by the Argo CD API. A patch for this vulnerability has been released in Argo CD versions
  2.3.4, 2.2.9, and 2.1.15. As a workaround, one may disable anonymous access, but upgrading
  to a patched version is preferable.
impacted_packages: []
severities:
  - score: '9.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29165
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29165
weaknesses:
  - CWE-290
  - CWE-200
  - CWE-287
references:
  - url: https://github.com/argoproj/argo-cd/releases/tag/v2.1.15
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-cd/releases/tag/v2.2.9
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-cd/releases/tag/v2.3.4
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-cd/security/advisories/GHSA-r642-gv9p-2wjj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:argoproj:argo_cd:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:argoproj:argo_cd:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29165
    reference_type:
    reference_id: CVE-2022-29165
