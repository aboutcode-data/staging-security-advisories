advisory_id: CVE-2025-40004
datasource_id: nvd_importer_v2/CVE-2025-40004
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40004
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/9p: Fix buffer overflow in USB transport layer

  A buffer overflow vulnerability exists in the USB 9pfs transport layer
  where inconsistent size validation between packet header parsing and
  actual data copying allows a malicious USB host to overflow heap buffers.

  The issue occurs because:
  - usb9pfs_rx_header() validates only the declared size in packet header
  - usb9pfs_rx_complete() uses req->actual (actual received bytes) for
  memcpy

  This allows an attacker to craft packets with small declared size
  (bypassing validation) but large actual payload (triggering overflow
  in memcpy).

  Add validation in usb9pfs_rx_complete() to ensure req->actual does not
  exceed the buffer capacity before copying data.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0da18d49f874d444ad83c8a546fa33bfcf2f582c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c04db81cd0288dfc68b7a0f7d09bd49b40bba451
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/df8462f0fc045b4475dc494a5787a03c972ba2a2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40004
    reference_type:
    reference_id: CVE-2025-40004
