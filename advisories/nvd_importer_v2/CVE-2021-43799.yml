advisory_id: CVE-2021-43799
datasource_id: nvd_importer_v2/CVE-2021-43799
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-43799
aliases: []
summary: Zulip is an open-source team collaboration tool. Zulip Server installs RabbitMQ for
  internal message passing. In versions of Zulip Server prior to 4.9, the initial installation
  (until first reboot, or restart of RabbitMQ) does not successfully limit the default ports
  which RabbitMQ opens; this includes port 25672, the RabbitMQ distribution port, which is used
  as a management port. RabbitMQ's default "cookie" which protects this port is generated using
  a weak PRNG, which limits the entropy of the password to at most 36 bits; in practicality,
  the seed for the randomizer is biased, resulting in approximately 20 bits of entropy. If other
  firewalls (at the OS or network level) do not protect port 25672, a remote attacker can brute-force
  the 20 bits of entropy in the "cookie" and leverage it for arbitrary execution of code as
  the rabbitmq user. They can also read all data which is sent through RabbitMQ, which includes
  all message traffic sent by users. Version 4.9 contains a patch for this vulnerability. As
  a workaround, ensure that firewalls prevent access to ports 5672 and 25672 from outside the
  Zulip server.
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43799
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43799
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43799
weaknesses:
  - CWE-338
references:
  - url: https://github.com/gteissier/erl-matter
    reference_type:
    reference_id:
  - url: https://github.com/zulip/zulip/commit/a5496f4098e3998c9b84e8dc564aa983d6cdf6e8
    reference_type:
    reference_id:
  - url: https://github.com/zulip/zulip/releases/tag/4.9
    reference_type:
    reference_id:
  - url: https://github.com/zulip/zulip/security/advisories/GHSA-p663-wxvv-2fjp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:zulip:zulip:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:zulip:zulip:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43799
    reference_type:
    reference_id: CVE-2021-43799
