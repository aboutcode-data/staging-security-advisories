advisory_id: CVE-2023-53832
datasource_id: nvd_importer_v2/CVE-2023-53832
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53832
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  md/raid10: fix null-ptr-deref in raid10_sync_request

  init_resync() inits mempool and sets conf->have_replacemnt at the beginning
  of sync, close_sync() frees the mempool when sync is completed.

  After [1] recovery might be skipped and init_resync() is called but
  close_sync() is not. null-ptr-deref occurs with r10bio->dev[i].repl_bio.

  The following is one way to reproduce the issue.

    1) create a array, wait for resync to complete, mddev->recovery_cp is set
       to MaxSector.
    2) recovery is woken and it is skipped. conf->have_replacement is set to
       0 in init_resync(). close_sync() not called.
    3) some io errors and rdev A is set to WantReplacement.
    4) a new device is added and set to A's replacement.
    5) recovery is woken, A have replacement, but conf->have_replacemnt is
       0. r10bio->dev[i].repl_bio will not be alloced and null-ptr-deref
       occurs.

  Fix it by not calling init_resync() if recovery skipped.

  [1] commit 7e83ccbecd60 ("md/raid10: Allow skipping recovery when clean arrays are assembled")
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/14964127be77884003976a392c9faa9ebaabbbe1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/38d33593260536840b49fd1dcac9aedfd14a9d42
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/68695084077e3de9d3e94e09238ace2b6f246446
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/99b503e4edc5938885d839cf0e7571963f75d800
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e9efc77efd1956cc244af975240f2513d78a371
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a405c6f0229526160aa3f177f65e20c86fce84c5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b50fd1c3d9d0175aa29ff2706ef36cc178bc356a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bdbf104b1c91fbf38f82c522ebf75429f094292a
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53832
    reference_type:
    reference_id: CVE-2023-53832
