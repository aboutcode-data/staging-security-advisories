advisory_id: CVE-2017-5223
datasource_id: nvd_importer_v2/CVE-2017-5223
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2017-5223
aliases: []
summary: An issue was discovered in PHPMailer before 5.2.22. PHPMailer's msgHTML method applies
  transformations to an HTML document to make it usable as an email message body. One of the
  transformations is to convert relative image URLs into attachments using a script-provided
  base directory. If no base directory is provided, it resolves to /, meaning that relative
  image URLs get treated as absolute local file paths and added as attachments. To form a remote
  vulnerability, the msgHTML method must be called, passed an unfiltered, user-supplied HTML
  document, and must not set a base directory.
impacted_packages: []
severities:
  - score: '2.1'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-5223
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-5223
weaknesses:
  - CWE-200
references:
  - url: http://kalilinux.co/2017/01/12/phpmailer-cve-2017-5223-local-information-disclosure-vulnerability-analysis/
    reference_type:
    reference_id:
  - url: https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/43056/
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/95328
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:phpmailer_project:phpmailer:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:phpmailer_project:phpmailer:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-5223
    reference_type:
    reference_id: CVE-2017-5223
