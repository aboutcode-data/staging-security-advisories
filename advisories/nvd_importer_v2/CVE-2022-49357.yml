advisory_id: CVE-2022-49357
datasource_id: nvd_importer_v2/CVE-2022-49357
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49357
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  efi: Do not import certificates from UEFI Secure Boot for T2 Macs

  On Apple T2 Macs, when Linux attempts to read the db and dbx efi variables
  at early boot to load UEFI Secure Boot certificates, a page fault occurs
  in Apple firmware code and EFI runtime services are disabled with the
  following logs:

  [Firmware Bug]: Page fault caused by firmware at PA: 0xffffb1edc0068000
  WARNING: CPU: 3 PID: 104 at arch/x86/platform/efi/quirks.c:735 efi_crash_gracefully_on_page_fault+0x50/0xf0
  (Removed some logs from here)
  Call Trace:
   <TASK>
   page_fault_oops+0x4f/0x2c0
   ? search_bpf_extables+0x6b/0x80
   ? search_module_extables+0x50/0x80
   ? search_exception_tables+0x5b/0x60
   kernelmode_fixup_or_oops+0x9e/0x110
   __bad_area_nosemaphore+0x155/0x190
   bad_area_nosemaphore+0x16/0x20
   do_kern_addr_fault+0x8c/0xa0
   exc_page_fault+0xd8/0x180
   asm_exc_page_fault+0x1e/0x30
  (Removed some logs from here)
   ? __efi_call+0x28/0x30
   ? switch_mm+0x20/0x30
   ? efi_call_rts+0x19a/0x8e0
   ? process_one_work+0x222/0x3f0
   ? worker_thread+0x4a/0x3d0
   ? kthread+0x17a/0x1a0
   ? process_one_work+0x3f0/0x3f0
   ? set_kthread_struct+0x40/0x40
   ? ret_from_fork+0x22/0x30
   </TASK>
  ---[ end trace 1f82023595a5927f ]---
  efi: Froze efi_rts_wq and disabled EFI Runtime Services
  integrity: Couldn't get size: 0x8000000000000015
  integrity: MODSIGN: Couldn't get UEFI db list
  efi: EFI Runtime Services are disabled!
  integrity: Couldn't get size: 0x8000000000000015
  integrity: Couldn't get UEFI dbx list
  integrity: Couldn't get size: 0x8000000000000015
  integrity: Couldn't get mokx list
  integrity: Couldn't get size: 0x80000000

  So we avoid reading these UEFI variables and thus prevent the crash.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49357
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/155ca952c7ca19aa32ecfb7373a32bbc2e1ec6eb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1f7264f0510f519b4e4f575a8f0579ea65e7592e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/65237307f88f5200782ae7f243bdd385e37cde5d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b1cda6dd2c44771f042d65f0d17bec322ef99a0a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b34786b25d75f9c119696e6bdf3827f54ae3601b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c072cab98bac11f6ef9db640fb51834d9552e2e6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49357
    reference_type:
    reference_id: CVE-2022-49357
