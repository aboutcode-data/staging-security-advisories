advisory_id: CVE-2022-49151
datasource_id: nvd_importer_v2/CVE-2022-49151
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49151
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  can: mcba_usb: properly check endpoint type

  Syzbot reported warning in usb_submit_urb() which is caused by wrong
  endpoint type. We should check that in endpoint is actually present to
  prevent this warning.

  Found pipes are now saved to struct mcba_priv and code uses them
  directly instead of making pipes in place.

  Fail log:

  | usb 5-1: BOGUS urb xfer, pipe 3 != type 1
  | WARNING: CPU: 1 PID: 49 at drivers/usb/core/urb.c:502 usb_submit_urb+0xed2/0x18a0 drivers/usb/core/urb.c:502
  | Modules linked in:
  | CPU: 1 PID: 49 Comm: kworker/1:2 Not tainted 5.17.0-rc6-syzkaller-00184-g38f80f42147f #0
  | Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.14.0-2 04/01/2014
  | Workqueue: usb_hub_wq hub_event
  | RIP: 0010:usb_submit_urb+0xed2/0x18a0 drivers/usb/core/urb.c:502
  | ...
  | Call Trace:
  |  <TASK>
  |  mcba_usb_start drivers/net/can/usb/mcba_usb.c:662 [inline]
  |  mcba_usb_probe+0x8a3/0xc50 drivers/net/can/usb/mcba_usb.c:858
  |  usb_probe_interface+0x315/0x7f0 drivers/usb/core/driver.c:396
  |  call_driver_probe drivers/base/dd.c:517 [inline]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49151
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/136bed0bfd3bc9c95c88aafff2d22ecb3a919f23
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5598442edc29e8f6f2380e4b471dc1a3fcd80508
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/88272b4a37913bdf6f339162a7920bd8e9b49de2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b48d1bb3f1ca337ad653022aefb5a40a47dfe5cd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cbd110b8dd7ad763bf413f71c0484116ae9302d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ef0acc514123140157b19a9ff2e2de5d91d612bc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f2ec3cd0f34f8c3f94bc21fbba14868301c9c49d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fa9c1f14002dc0d5293e16a2007bd89b6e79207b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49151
    reference_type:
    reference_id: CVE-2022-49151
