advisory_id: CVE-2022-50185
datasource_id: nvd_importer_v2/CVE-2022-50185
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50185
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/radeon: fix potential buffer overflow in ni_set_mc_special_registers()

  The last case label can write two buffers 'mc_reg_address[j]' and
  'mc_data[j]' with 'j' offset equal to SMC_NISLANDS_MC_REGISTER_ARRAY_SIZE
  since there are no checks for this value in both case labels after the
  last 'j++'.

  Instead of changing '>' to '>=' there, add the bounds check at the start
  of the second 'case' (the first one already has it).

  Also, remove redundant last checks for 'j' index bigger than array size.
  The expression is always false. Moreover, before or after the patch
  'table->last' can be equal to SMC_NISLANDS_MC_REGISTER_ARRAY_SIZE and it
  seems it can be a valid value.

  Detected using the static analysis tool - Svace.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50185
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/136f614931a2bb73616b292cf542da3a18daefd5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1f341053852be76f82610ce47a505d930512f05c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/782e413e38dffd37cc85b08b1ccb982adb4a93ce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8508d6d23a247c29792ce2fc0df3f3404d6a6a80
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9faff03617afeced1c4e5daa89e79b3906374342
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db1a9add3f90ff1c641974d5bb910c16b87af4ef
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/deb603c5928e546609c0d5798e231d0205748943
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ea73869df6ef386fc0feeb28ff66742ca835b18f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50185
    reference_type:
    reference_id: CVE-2022-50185
