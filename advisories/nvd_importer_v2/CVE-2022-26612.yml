advisory_id: CVE-2022-26612
datasource_id: nvd_importer_v2/CVE-2022-26612
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-26612
aliases: []
summary: In Apache Hadoop, The unTar function uses unTarUsingJava function on Windows and the
  built-in tar utility on Unix and other OSes. As a result, a TAR entry may create a symlink
  under the expected extraction directory which points to an external directory. A subsequent
  TAR entry may extract an arbitrary file into the external directory using the symlink name.
  This however would be caught by the same targetDirPath check on Unix because of the getCanonicalPath
  call. However on Windows, getCanonicalPath doesn't resolve symbolic links, which bypasses
  the check. unpackEntries during TAR extraction follows symbolic links which allows writing
  outside expected base directory on Windows. This was addressed in Apache Hadoop 3.2.3
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-26612
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-26612
weaknesses:
  - CWE-59
references:
  - url: https://lists.apache.org/thread/hslo7wzw2449gv1jyjk8g6ttd7935fyz
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220519-0004/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:hadoop:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:hadoop:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:hadoop:3.3.1:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:hadoop:3.3.1:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:hadoop:3.3.2:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:hadoop:3.3.2:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows:-:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows:-:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-26612
    reference_type:
    reference_id: CVE-2022-26612
