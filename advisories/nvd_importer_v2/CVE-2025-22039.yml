advisory_id: CVE-2025-22039
datasource_id: nvd_importer_v2/CVE-2025-22039
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-22039
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ksmbd: fix overflow in dacloffset bounds check

  The dacloffset field was originally typed as int and used in an
  unchecked addition, which could overflow and bypass the existing
  bounds check in both smb_check_perm_dacl() and smb_inherit_dacl().

  This could result in out-of-bounds memory access and a kernel crash
  when dereferencing the DACL pointer.

  This patch converts dacloffset to unsigned int and uses
  check_add_overflow() to validate access to the DACL.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-22039
weaknesses:
  - CWE-190
  - CWE-125
references:
  - url: https://git.kernel.org/stable/c/443b373a4df5a2cb9f7b8c4658b2afedeb16397f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6a9cd9ff0fa2bcc30b2bfb8bdb161eb20e44b9dc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6b8d379048b168a0dff5ab1acb975b933f368514
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/beff0bc9d69bc8e733f9bca28e2d3df5b3e10e42
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22039
    reference_type:
    reference_id: CVE-2025-22039
