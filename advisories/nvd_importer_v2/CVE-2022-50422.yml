advisory_id: CVE-2022-50422
datasource_id: nvd_importer_v2/CVE-2022-50422
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50422
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: libsas: Fix use-after-free bug in smp_execute_task_sg()

  When executing SMP task failed, the smp_execute_task_sg() calls del_timer()
  to delete "slow_task->timer". However, if the timer handler
  sas_task_internal_timedout() is running, the del_timer() in
  smp_execute_task_sg() will not stop it and a UAF will happen. The process
  is shown below:

        (thread 1)               |        (thread 2)
  smp_execute_task_sg()          | sas_task_internal_timedout()
   ...                           |
   del_timer()                   |
   ...                           |  ...
   sas_free_task(task)           |
    kfree(task->slow_task) //FREE|
                                 |  task->slow_task->... //USE

  Fix by calling del_timer_sync() in smp_execute_task_sg(), which makes sure
  the timer handler have finished before the "task->slow_task" is
  deallocated.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50422
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/117331a2a5227fb4369c2a1f321d3e3e2e2ef8fe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2e12ce270f0d926085c1209cc90397e307deef97
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/46ba53c30666717cb06c2b3c5d896301cd00d0c0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a9e5176ead6de64f572ad5c87a72825d9d3c82ae
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e45a1516d2933703a4823d9db71e17c3abeba24f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f7a785177611ffc97d645fcbc196e6de6ad2421d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50422
    reference_type:
    reference_id: CVE-2022-50422
