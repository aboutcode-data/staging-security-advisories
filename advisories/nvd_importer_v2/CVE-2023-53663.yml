advisory_id: CVE-2023-53663
datasource_id: nvd_importer_v2/CVE-2023-53663
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53663
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nKVM: nSVM:\
  \ Check instead of asserting on nested TSC scaling support\n\nCheck for nested TSC scaling\
  \ support on nested SVM VMRUN instead of\nasserting that TSC scaling is exposed to L1 if L1's\
  \ MSR_AMD64_TSC_RATIO\nhas diverged from KVM's default.  Userspace can trigger the WARN at\
  \ will\nby writing the MSR and then updating guest CPUID to hide the feature\n(modifying guest\
  \ CPUID is allowed anytime before KVM_RUN).  E.g. hacking\nKVM's state_test selftest to do\n\
  \n\t\tvcpu_set_msr(vcpu, MSR_AMD64_TSC_RATIO, 0);\n\t\tvcpu_clear_cpuid_feature(vcpu, X86_FEATURE_TSCRATEMSR);\n\
  \nafter restoring state in a new VM+vCPU yields an endless supply of:\n\n  ------------[ cut\
  \ here ]------------\n  WARNING: CPU: 164 PID: 62565 at arch/x86/kvm/svm/nested.c:699\n  \
  \         nested_vmcb02_prepare_control+0x3d6/0x3f0 [kvm_amd]\n  Call Trace:\n   <TASK>\n\
  \   enter_svm_guest_mode+0x114/0x560 [kvm_amd]\n   nested_svm_vmrun+0x260/0x330 [kvm_amd]\n\
  \   vmrun_interception+0x29/0x30 [kvm_amd]\n   svm_invoke_exit_handler+0x35/0x100 [kvm_amd]\n\
  \   svm_handle_exit+0xe7/0x180 [kvm_amd]\n   kvm_arch_vcpu_ioctl_run+0x1eab/0x2570 [kvm]\n\
  \   kvm_vcpu_ioctl+0x4c9/0x5b0 [kvm]\n   __se_sys_ioctl+0x7a/0xc0\n   __x64_sys_ioctl+0x21/0x30\n\
  \   do_syscall_64+0x41/0x90\n   entry_SYSCALL_64_after_hwframe+0x63/0xcd\n  RIP: 0033:0x45ca1b\n\
  \nNote, the nested #VMEXIT path has the same flaw, but needs a different\nfix and will be\
  \ handled separately."
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53663
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/02b24270568f65dd607c4a848512dc8055b4491b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6c1ecfea1daf6e75c46e295aad99dfbafd878897
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7cafe9b8e22bb3d77f130c461aedf6868c4aaf58
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53663
    reference_type:
    reference_id: CVE-2023-53663
