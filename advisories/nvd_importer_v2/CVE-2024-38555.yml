advisory_id: CVE-2024-38555
datasource_id: nvd_importer_v2/CVE-2024-38555
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-38555
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/mlx5: Discard command completions in internal error

  Fix use after free when FW completion arrives while device is in
  internal error state. Avoid calling completion handler in this case,
  since the device will flush the command interface and trigger all
  completions manually.

  Kernel log:
  ------------[ cut here ]------------
  refcount_t: underflow; use-after-free.
  ...
  RIP: 0010:refcount_warn_saturate+0xd8/0xe0
  ...
  Call Trace:
  <IRQ>
  ? __warn+0x79/0x120
  ? refcount_warn_saturate+0xd8/0xe0
  ? report_bug+0x17c/0x190
  ? handle_bug+0x3c/0x60
  ? exc_invalid_op+0x14/0x70
  ? asm_exc_invalid_op+0x16/0x20
  ? refcount_warn_saturate+0xd8/0xe0
  cmd_ent_put+0x13b/0x160 [mlx5_core]
  mlx5_cmd_comp_handler+0x5f9/0x670 [mlx5_core]
  cmd_comp_notifier+0x1f/0x30 [mlx5_core]
  notifier_call_chain+0x35/0xb0
  atomic_notifier_call_chain+0x16/0x20
  mlx5_eq_async_int+0xf6/0x290 [mlx5_core]
  notifier_call_chain+0x35/0xb0
  atomic_notifier_call_chain+0x16/0x20
  irq_int_handler+0x19/0x30 [mlx5_core]
  __handle_irq_event_percpu+0x4b/0x160
  handle_irq_event+0x2e/0x80
  handle_edge_irq+0x98/0x230
  __common_interrupt+0x3b/0xa0
  common_interrupt+0x7b/0xa0
  </IRQ>
  <TASK>
  asm_common_interrupt+0x22/0x40
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-38555
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/1337ec94bc5a9eed250e33f5f5c89a28a6bfabdb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1d5dce5e92a70274de67a59e1e674c3267f94cd7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3cb92b0ad73d3f1734e812054e698d655e9581b0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7ac4c69c34240c6de820492c0a28a0bd1494265a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bf8aaf0ae01c27ae3c06aa8610caf91e50393396
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db9b31aa9bc56ff0d15b78f7e827d61c4a096e40
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6fbb8535e990f844371086ab2c1221f71f993d3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-38555
    reference_type:
    reference_id: CVE-2024-38555
