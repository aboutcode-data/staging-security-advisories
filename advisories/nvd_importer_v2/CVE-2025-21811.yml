advisory_id: CVE-2025-21811
datasource_id: nvd_importer_v2/CVE-2025-21811
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21811
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nilfs2: protect access to buffers with no active references

  nilfs_lookup_dirty_data_buffers(), which iterates through the buffers
  attached to dirty data folios/pages, accesses the attached buffers without
  locking the folios/pages.

  For data cache, nilfs_clear_folio_dirty() may be called asynchronously
  when the file system degenerates to read only, so
  nilfs_lookup_dirty_data_buffers() still has the potential to cause use
  after free issues when buffers lose the protection of their dirty state
  midway due to this asynchronous clearing and are unintentionally freed by
  try_to_free_buffers().

  Eliminate this race issue by adjusting the lock section in this function.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21811
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/367a9bffabe08c04f6d725032cce3d891b2b9e1a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4b08d23d7d1917bef4fbee8ad81372f49b006656
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/58c27fa7a610b6e8d44e6220e7dbddfbaccaf439
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/72cf688d0ce7e642b12ddc9b2a42524737ec1b4a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8e1b9201c9a24638cf09c6e1c9f224157328010b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c437dfac9f7a5a46ac2a5e6d6acd3059e9f68188
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d8ff250e085a4c4cdda4ad1cdd234ed110393143
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e1fc4a90a90ea8514246c45435662531975937d9
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00028.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21811
    reference_type:
    reference_id: CVE-2025-21811
