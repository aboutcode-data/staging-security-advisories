advisory_id: CVE-2024-57876
datasource_id: nvd_importer_v2/CVE-2024-57876
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-57876
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/dp_mst: Fix resetting msg rx state after topology removal

  If the MST topology is removed during the reception of an MST down reply
  or MST up request sideband message, the
  drm_dp_mst_topology_mgr::up_req_recv/down_rep_recv states could be reset
  from one thread via drm_dp_mst_topology_mgr_set_mst(false), racing with
  the reading/parsing of the message from another thread via
  drm_dp_mst_handle_down_rep() or drm_dp_mst_handle_up_req(). The race is
  possible since the reader/parser doesn't hold any lock while accessing
  the reception state. This in turn can lead to a memory corruption in the
  reader/parser as described by commit bd2fccac61b4 ("drm/dp_mst: Fix MST
  sideband message body length check").

  Fix the above by resetting the message reception state if needed before
  reading/parsing a message. Another solution would be to hold the
  drm_dp_mst_topology_mgr::lock for the whole duration of the message
  reception/parsing in drm_dp_mst_handle_down_rep() and
  drm_dp_mst_handle_up_req(), however this would require a bigger change.
  Since the fix is also needed for stable, opting for the simpler solution
  in this patch.
impacted_packages: []
severities:
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-57876
weaknesses:
  - CWE-787
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/94b33b2d7640e807869451384eb88321dd0ffbd4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a6fa67d26de385c3c7a23c1e109a0e23bfda4ec7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/be826b4451fd187a7c0b04be4f8243d5df6e0450
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d834d20d2e86c52ed5cab41763fa61e6071680ef
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-57876
    reference_type:
    reference_id: CVE-2024-57876
