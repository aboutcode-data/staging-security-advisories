advisory_id: CVE-2021-47111
datasource_id: nvd_importer_v2/CVE-2021-47111
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47111
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  xen-netback: take a reference to the RX task thread

  Do this in order to prevent the task from being freed if the thread
  returns (which can be triggered by the frontend) before the call to
  kthread_stop done as part of the backend tear down. Not taking the
  reference will lead to a use-after-free in that scenario. Such
  reference was taken before but dropped as part of the rework done in
  2ac061ce97f4.

  Reintroduce the reference taking and add a comment this time
  explaining why it's needed.

  This is XSA-374 / CVE-2021-28691.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47111
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/107866a8eb0b664675a260f1ba0655010fac1e08
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6b53db8c4c14b4e7256f058d202908b54a7b85b4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/caec9bcaeb1a5f03f2d406305355c853af10c13e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47111
    reference_type:
    reference_id: CVE-2021-47111
