advisory_id: CVE-2023-53140
datasource_id: nvd_importer_v2/CVE-2023-53140
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53140
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: core: Remove the /proc/scsi/${proc_name} directory earlier

  Remove the /proc/scsi/${proc_name} directory earlier to fix a race
  condition between unloading and reloading kernel modules. This fixes a bug
  introduced in 2009 by commit 77c019768f06 ("[SCSI] fix /proc memory leak in
  the SCSI core").

  Fix the following kernel warning:

  proc_dir_entry 'scsi/scsi_debug' already registered
  WARNING: CPU: 19 PID: 27986 at fs/proc/generic.c:376 proc_register+0x27d/0x2e0
  Call Trace:
   proc_mkdir+0xb5/0xe0
   scsi_proc_hostdir_add+0xb5/0x170
   scsi_host_alloc+0x683/0x6c0
   sdebug_driver_probe+0x6b/0x2d0 [scsi_debug]
   really_probe+0x159/0x540
   __driver_probe_device+0xdc/0x230
   driver_probe_device+0x4f/0x120
   __device_attach_driver+0xef/0x180
   bus_for_each_drv+0xe5/0x130
   __device_attach+0x127/0x290
   device_initial_probe+0x17/0x20
   bus_probe_device+0x110/0x130
   device_add+0x673/0xc80
   device_register+0x1e/0x30
   sdebug_add_host_helper+0x1a7/0x3b0 [scsi_debug]
   scsi_debug_init+0x64f/0x1000 [scsi_debug]
   do_one_initcall+0xd7/0x470
   do_init_module+0xe7/0x330
   load_module+0x122a/0x12c0
   __do_sys_finit_module+0x124/0x1a0
   __x64_sys_finit_module+0x46/0x50
   do_syscall_64+0x38/0x80
   entry_SYSCALL_64_after_hwframe+0x46/0xb0
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53140
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/13daafe1e209b03e9bda16ff2bd2b2da145a139b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/17e98a5ede81b7696bec421f7afa2dfe467f5e6b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1ec363599f8346d5a8d08c71a0d9860d6c420ec0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6b223e32d66ca9db1f252f433514783d8b22a8e1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/891a3cba425cf483d96facca55aebd6ff1da4338
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e471e928de97b00f297ad1015cc14f9459765713
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fc663711b94468f4e1427ebe289c9f05669699c9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53140
    reference_type:
    reference_id: CVE-2023-53140
