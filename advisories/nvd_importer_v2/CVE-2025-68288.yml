advisory_id: CVE-2025-68288
datasource_id: nvd_importer_v2/CVE-2025-68288
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68288
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: storage: Fix memory leak in USB bulk transport

  A kernel memory leak was identified by the 'ioctl_sg01' test from Linux
  Test Project (LTP). The following bytes were mainly observed: 0x53425355.

  When USB storage devices incorrectly skip the data phase with status data,
  the code extracts/validates the CSW from the sg buffer, but fails to clear
  it afterwards. This leaves status protocol data in srb's transfer buffer,
  such as the US_BULK_CS_SIGN 'USBS' signature observed here. Thus, this can
  lead to USB protocols leaks to user space through SCSI generic (/dev/sg*)
  interfaces, such as the one seen here when the LTP test requested 512 KiB.

  Fix the leak by zeroing the CSW data in srb's transfer buffer immediately
  after the validation of devices that skip data phase.

  Note: Differently from CVE-2018-1000204, which fixed a big leak by zero-
  ing pages at allocation time, this leak occurs after allocation, when USB
  protocol data is written to already-allocated sg pages.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0f18eac44c5668204bf6eebb01ddb369ac56932b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/41e99fe2005182139b1058db71f0d241f8f0078c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/467fec3cefbeb9e3ea80f457da9a5666a71ca0d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4ba515dfff7eeca369ab85cdbb3f3b231c71720c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5b815ddb3f5560fac35b16de3a2a22d5f81c5993
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/83f0241959831586d9b6d47f6bd5d3dec8f43bf0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cb1401b5bcc2feb5b038fc4b512e5968b016e05e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68288
    reference_type:
    reference_id: CVE-2025-68288
