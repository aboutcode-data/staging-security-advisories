advisory_id: CVE-2022-48978
datasource_id: nvd_importer_v2/CVE-2022-48978
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-48978
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  HID: core: fix shift-out-of-bounds in hid_report_raw_event

  Syzbot reported shift-out-of-bounds in hid_report_raw_event.

  microsoft 0003:045E:07DA.0001: hid_field_extract() called with n (128) >
  32! (swapper/0)
  ======================================================================
  UBSAN: shift-out-of-bounds in drivers/hid/hid-core.c:1323:20
  shift exponent 127 is too large for 32-bit type 'int'
  CPU: 0 PID: 0 Comm: swapper/0 Not tainted
  6.1.0-rc4-syzkaller-00159-g4bbf3422df78 #0
  Hardware name: Google Compute Engine/Google Compute Engine, BIOS
  Google 10/26/2022
  Call Trace:
   <IRQ>
   __dump_stack lib/dump_stack.c:88 [inline]
   dump_stack_lvl+0x1e3/0x2cb lib/dump_stack.c:106
   ubsan_epilogue lib/ubsan.c:151 [inline]
   __ubsan_handle_shift_out_of_bounds+0x3a6/0x420 lib/ubsan.c:322
   snto32 drivers/hid/hid-core.c:1323 [inline]
   hid_input_fetch_field drivers/hid/hid-core.c:1572 [inline]
   hid_process_report drivers/hid/hid-core.c:1665 [inline]
   hid_report_raw_event+0xd56/0x18b0 drivers/hid/hid-core.c:1998
   hid_input_report+0x408/0x4f0 drivers/hid/hid-core.c:2066
   hid_irq_in+0x459/0x690 drivers/hid/usbhid/hid-core.c:284
   __usb_hcd_giveback_urb+0x369/0x530 drivers/usb/core/hcd.c:1671
   dummy_timer+0x86b/0x3110 drivers/usb/gadget/udc/dummy_hcd.c:1988
   call_timer_fn+0xf5/0x210 kernel/time/timer.c:1474
   expire_timers kernel/time/timer.c:1519 [inline]
   __run_timers+0x76a/0x980 kernel/time/timer.c:1790
   run_timer_softirq+0x63/0xf0 kernel/time/timer.c:1803
   __do_softirq+0x277/0x75b kernel/softirq.c:571
   __irq_exit_rcu+0xec/0x170 kernel/softirq.c:650
   irq_exit_rcu+0x5/0x20 kernel/softirq.c:662
   sysvec_apic_timer_interrupt+0x91/0xb0 arch/x86/kernel/apic/apic.c:1107
  ======================================================================

  If the size of the integer (unsigned n) is bigger than 32 in snto32(),
  shift exponent will be too large for 32-bit type 'int', resulting in a
  shift-out-of-bounds bug.
  Fix this by adding a check on the size of the integer (unsigned n) in
  snto32(). To add support for n greater than 32 bits, set n to 32, if n
  is greater than 32.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48978
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/151493fe5a6ed1a88decc929a7368a3f2a246914
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2b3b4d7aadaa1b6b58d0f34823bf86cfe8a31b4d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/809783f8b4b600c7fb3bccb10fefef822601ea3b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8e14f20e12224ee2429f75a5c9418a700e26a8d3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bc03f809da78fc79e4aee132d4e5c6a2b3aeec73
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db1ed1b3fb4ec0d19080a102956255769bc45c79
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ec61b41918587be530398b0d1c9a0d16619397e5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f755d11c55b29049b77da5cd9ab2faae96eb33c3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc8:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc8:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48978
    reference_type:
    reference_id: CVE-2022-48978
