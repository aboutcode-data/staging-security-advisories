advisory_id: CVE-2021-21245
datasource_id: nvd_importer_v2/CVE-2021-21245
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21245
aliases: []
summary: OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, AttachmentUploadServlet
  also saves user controlled data (`request.getInputStream()`) to a user specified location
  (`request.getHeader("File-Name")`). This issue may lead to arbitrary file upload which can
  be used to upload a WebShell to OneDev server. This issue is addressed in 4.0.3 by only allowing
  uploaded file to be in attachments folder. The webshell issue is not possible as OneDev never
  executes files in attachments folder.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21245
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21245
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21245
weaknesses:
  - CWE-434
references:
  - url: https://github.com/theonedev/onedev/commit/0c060153fb97c0288a1917efdb17cc426934dacb
    reference_type:
    reference_id:
  - url: https://github.com/theonedev/onedev/security/advisories/GHSA-62m2-38q5-96w9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21245
    reference_type:
    reference_id: CVE-2021-21245
