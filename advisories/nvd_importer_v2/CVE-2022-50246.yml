advisory_id: CVE-2022-50246
datasource_id: nvd_importer_v2/CVE-2022-50246
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50246
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: typec: tcpci: fix of node refcount leak in tcpci_register_port()

  I got the following report while doing device(mt6370-tcpc) load
  test with CONFIG_OF_UNITTEST and CONFIG_OF_DYNAMIC enabled:

    OF: ERROR: memory leak, expected refcount 1 instead of 2,
    of_node_get()/of_node_put() unbalanced - destroy cset entry:
    attach overlay node /i2c/pmic@34/tcpc/connector

  The 'fwnode' set in tcpci_parse_config() which is called
  in tcpci_register_port(), its node refcount is increased
  in device_get_named_child_node(). It needs be put while
  exiting, so call fwnode_handle_put() in the error path of
  tcpci_register_port() and in tcpci_unregister_port() to
  avoid leak.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50246
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0384e87e3fec735e47f1c133c796f32ef7a72a9b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4f257e2eba419ab4cd880c822346450e4e7b2af3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5f125507d2270035dfcf83fbff6cff5a143e200c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ba75be6f0d9d028d20852564206565a4c03e3288
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d3b6c28a71f111a6c67ddc3238aab95910fd86cf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e75a324409715bd71348f79a49aa61b69dbeb676
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50246
    reference_type:
    reference_id: CVE-2022-50246
