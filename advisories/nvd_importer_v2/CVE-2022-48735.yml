advisory_id: CVE-2022-48735
datasource_id: nvd_importer_v2/CVE-2022-48735
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-48735
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ALSA: hda: Fix UAF of leds class devs at unbinding

  The LED class devices that are created by HD-audio codec drivers are
  registered via devm_led_classdev_register() and associated with the
  HD-audio codec device.  Unfortunately, it turned out that the devres
  release doesn't work for this case; namely, since the codec resource
  release happens before the devm call chain, it triggers a NULL
  dereference or a UAF for a stale set_brightness_delay callback.

  For fixing the bug, this patch changes the LED class device register
  and unregister in a manual manner without devres, keeping the
  instances in hda_gen_spec.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48735
weaknesses:
  - CWE-416
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/0e629052f013eeb61494d4df2f1f647c2a9aef47
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/549f8ffc7b2f7561bea7f90930b6c5104318e87b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/813e9f3e06d22e29872d4fd51b54992d89cf66c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a7de1002135cf94367748ffc695a29812d7633b5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48735
    reference_type:
    reference_id: CVE-2022-48735
