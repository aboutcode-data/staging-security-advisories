advisory_id: CVE-2023-53658
datasource_id: nvd_importer_v2/CVE-2023-53658
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53658
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  spi: bcm-qspi: return error if neither hif_mspi nor mspi is available

  If neither a "hif_mspi" nor "mspi" resource is present, the driver will
  just early exit in probe but still return success. Apart from not doing
  anything meaningful, this would then also lead to a null pointer access
  on removal, as platform_get_drvdata() would return NULL, which it would
  then try to dereference when trying to unregister the spi master.

  Fix this by unconditionally calling devm_ioremap_resource(), as it can
  handle a NULL res and will then return a viable ERR_PTR() if we get one.

  The "return 0;" was previously a "goto qspi_resource_err;" where then
  ret was returned, but since ret was still initialized to 0 at this place
  this was a valid conversion in 63c5395bb7a9 ("spi: bcm-qspi: Fix
  use-after-free on unbind"). The issue was not introduced by this commit,
  only made more obvious.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53658
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/217b6ea8cf7b819477bca597a6ae2d43d38ba283
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/22ae32d80ef590d12a2364e4621f90f7c58445c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/32b9c8f7892c19f7f5c9fed5fb410b9fd5990bb6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/398e6a015877d44327f754aeb48ff3354945c78c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7c1f23ad34fcdace50275a6aa1e1969b41c6233f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a91c34357afcfaa5307e254f22a8452550a07b34
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d20db3c58a7f9361e370a7850ceb60dbdf62eea3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d3dcdb43c872a3b967345144151a2c9bb9124c9b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53658
    reference_type:
    reference_id: CVE-2023-53658
