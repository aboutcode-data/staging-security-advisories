advisory_id: CVE-2025-23131
datasource_id: nvd_importer_v2/CVE-2025-23131
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-23131
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dlm: prevent NPD when writing a positive value to event_done

  do_uevent returns the value written to event_done. In case it is a
  positive value, new_lockspace would undo all the work, and lockspace
  would not be set. __dlm_new_lockspace, however, would treat that
  positive value as a success due to commit 8511a2728ab8 ("dlm: fix use
  count with multiple joins").

  Down the line, device_create_lockspace would pass that NULL lockspace to
  dlm_find_lockspace_local, leading to a NULL pointer dereference.

  Treating such positive values as successes prevents the problem. Given
  this has been broken for so long, this is unlikely to break userspace
  expectations.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-23131
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/8e2bad543eca5c25cd02cbc63d72557934d45f13
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b73c4ad4d387fe5bc988145bd9f1bc0de76afd5c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23131
    reference_type:
    reference_id: CVE-2025-23131
