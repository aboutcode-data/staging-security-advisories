advisory_id: CVE-2026-23067
datasource_id: nvd_importer_v2/CVE-2026-23067
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23067
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  iommu/io-pgtable-arm: fix size_t signedness bug in unmap path

  __arm_lpae_unmap() returns size_t but was returning -ENOENT (negative
  error code) when encountering an unmapped PTE. Since size_t is unsigned,
  -ENOENT (typically -2) becomes a huge positive value (0xFFFFFFFFFFFFFFFE
  on 64-bit systems).

  This corrupted value propagates through the call chain:
    __arm_lpae_unmap() returns -ENOENT as size_t
    -> arm_lpae_unmap_pages() returns it
    -> __iommu_unmap() adds it to iova address
    -> iommu_pgsize() triggers BUG_ON due to corrupted iova

  This can cause IOVA address overflow in __iommu_unmap() loop and
  trigger BUG_ON in iommu_pgsize() from invalid address alignment.

  Fix by returning 0 instead of -ENOENT. The WARN_ON already signals
  the error condition, and returning 0 (meaning "nothing unmapped")
  is the correct semantic for size_t return type. This matches the
  behavior of other io-pgtable implementations (io-pgtable-arm-v7s,
  io-pgtable-dart) which return 0 on error conditions.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/374e7af67d9d9d6103c2cfc8eb32abfecf3a2fd8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/41ec6988547819756fb65e94fc24f3e0dddf84ac
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23067
    reference_type:
    reference_id: CVE-2026-23067
