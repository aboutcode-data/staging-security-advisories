advisory_id: CVE-2025-38453
datasource_id: nvd_importer_v2/CVE-2025-38453
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38453
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  io_uring/msg_ring: ensure io_kiocb freeing is deferred for RCU

  syzbot reports that defer/local task_work adding via msg_ring can hit
  a request that has been freed:

  CPU: 1 UID: 0 PID: 19356 Comm: iou-wrk-19354 Not tainted 6.16.0-rc4-syzkaller-00108-g17bbde2e1716 #0 PREEMPT(full)
  Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 05/07/2025
  Call Trace:
   <TASK>
   dump_stack_lvl+0x189/0x250 lib/dump_stack.c:120
   print_address_description mm/kasan/report.c:408 [inline]
   print_report+0xd2/0x2b0 mm/kasan/report.c:521
   kasan_report+0x118/0x150 mm/kasan/report.c:634
   io_req_local_work_add io_uring/io_uring.c:1184 [inline]
   __io_req_task_work_add+0x589/0x950 io_uring/io_uring.c:1252
   io_msg_remote_post io_uring/msg_ring.c:103 [inline]
   io_msg_data_remote io_uring/msg_ring.c:133 [inline]
   __io_msg_ring_data+0x820/0xaa0 io_uring/msg_ring.c:151
   io_msg_ring_data io_uring/msg_ring.c:173 [inline]
   io_msg_ring+0x134/0xa00 io_uring/msg_ring.c:314
   __io_issue_sqe+0x17e/0x4b0 io_uring/io_uring.c:1739
   io_issue_sqe+0x165/0xfd0 io_uring/io_uring.c:1762
   io_wq_submit_work+0x6e9/0xb90 io_uring/io_uring.c:1874
   io_worker_handle_work+0x7cd/0x1180 io_uring/io-wq.c:642
   io_wq_worker+0x42f/0xeb0 io_uring/io-wq.c:696
   ret_from_fork+0x3fc/0x770 arch/x86/kernel/process.c:148
   ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:245
   </TASK>

  which is supposed to be safe with how requests are allocated. But msg
  ring requests alloc and free on their own, and hence must defer freeing
  to a sane time.

  Add an rcu_head and use kfree_rcu() in both spots where requests are
  freed. Only the one in io_msg_tw_complete() is strictly required as it
  has been visible on the other ring, but use it consistently in the other
  spot as well.

  This should not cause any other issues outside of KASAN rightfully
  complaining about it.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38453
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/094ba14a471cc6c68078c7ad488539eaf32c2277
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e5b3432f4a6b418b8bd8fc91f38efbf17a77167a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fc582cd26e888b0652bc1494f252329453fd3b23
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38453
    reference_type:
    reference_id: CVE-2025-38453
