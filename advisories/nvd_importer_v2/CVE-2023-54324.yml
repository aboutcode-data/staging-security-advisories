advisory_id: CVE-2023-54324
datasource_id: nvd_importer_v2/CVE-2023-54324
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-54324
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dm: fix a race condition in retrieve_deps

  There's a race condition in the multipath target when retrieve_deps
  races with multipath_message calling dm_get_device and dm_put_device.
  retrieve_deps walks the list of open devices without holding any lock
  but multipath may add or remove devices to the list while it is
  running. The end result may be memory corruption or use-after-free
  memory access.

  See this description of a UAF with multipath_message():
  https://listman.redhat.com/archives/dm-devel/2022-October/052373.html

  Fix this bug by introducing a new rw semaphore "devices_lock". We grab
  devices_lock for read in retrieve_deps and we grab it for write in
  dm_get_device and dm_put_device.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/38f6e5ae5d9ff4a4050ea6f7b543d5d5a4e087cf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dbf1a719850577bb51fc7512a3972994b797a17b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6007dce0cd35d634d9be91ef3515a6385dcee16
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-54324
    reference_type:
    reference_id: CVE-2023-54324
