advisory_id: CVE-2021-21300
datasource_id: nvd_importer_v2/CVE-2021-21300
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21300
aliases: []
summary: 'Git is an open-source distributed revision control system. In affected versions of
  Git a specially crafted repository that contains symbolic links as well as files using a clean/smudge
  filter such as Git LFS, may cause just-checked out script to be executed while cloning onto
  a case-insensitive file system such as NTFS, HFS+ or APFS (i.e. the default file systems on
  Windows and macOS). Note that clean/smudge filters have to be configured for that. Git for
  Windows configures Git LFS by default, and is therefore vulnerable. The problem has been patched
  in the versions published on Tuesday, March 9th, 2021. As a workaound, if symbolic link support
  is disabled in Git (e.g. via `git config --global core.symlinks false`), the described attack
  won''t work. Likewise, if no clean/smudge filters such as Git LFS are configured globally
  (i.e. _before_ cloning), the attack is foiled. As always, it is best to avoid cloning repositories
  from untrusted sources. The earliest impacted version is 2.14.2. The fix versions are: 2.30.1,
  2.29.3, 2.28.1, 2.27.1, 2.26.3, 2.25.5, 2.24.4, 2.23.4, 2.22.5, 2.21.4, 2.20.5, 2.19.6, 2.18.5,
  2.17.62.17.6.'
impacted_packages: []
severities:
  - score: '5.1'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:H/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21300
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21300
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21300
weaknesses:
  - CWE-59
references:
  - url: http://packetstormsecurity.com/files/163978/Git-LFS-Clone-Command-Execution.html
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2021/Apr/60
    reference_type:
    reference_id:
  - url: https://github.com/git/git/commit/684dd4c2b414bcf648505e74498a608f28de4592
    reference_type:
    reference_id:
  - url: https://github.com/git/git/security/advisories/GHSA-8prw-h3cq-mghm
    reference_type:
    reference_id:
  - url: https://git-scm.com/docs/gitattributes#_filter
    reference_type:
    reference_id:
  - url: https://git-scm.com/docs/git-config#Documentation/git-config.txt-coresymlinks
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/10/msg00014.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BBPNGLQSYJHLZZ37BO42YY6S5OTIF4L4/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LCLJJLKKMS5WRFO6C475AOUZTWQLIARX/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LMXX2POK5X576BSDWSXGU7EIK6I72ERU/
    reference_type:
    reference_id:
  - url: https://lore.kernel.org/git/xmqqim6019yd.fsf%40gitster.c.googlers.com/
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202104-01
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT212320
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/03/09/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apple:xcode:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apple:xcode:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:git-scm:git:2.27.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:git-scm:git:2.27.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:git-scm:git:2.28.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:git-scm:git:2.28.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:apple:macos:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:apple:macos:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21300
    reference_type:
    reference_id: CVE-2021-21300
