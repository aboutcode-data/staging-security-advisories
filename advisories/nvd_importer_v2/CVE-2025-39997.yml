advisory_id: CVE-2025-39997
datasource_id: nvd_importer_v2/CVE-2025-39997
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39997
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ALSA: usb-audio: fix race condition to UAF in snd_usbmidi_free

  The previous commit 0718a78f6a9f ("ALSA: usb-audio: Kill timer properly at
  removal") patched a UAF issue caused by the error timer.

  However, because the error timer kill added in this patch occurs after the
  endpoint delete, a race condition to UAF still occurs, albeit rarely.

  Additionally, since kill-cleanup for urb is also missing, freed memory can
  be accessed in interrupt context related to urb, which can cause UAF.

  Therefore, to prevent this, error timer and urb must be killed before
  freeing the heap memory.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/353d8c715cc951a980728133c9dd64ca5a0a186c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/647d6b8d22be12842fde6ed0c56859ebc615f21e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9f2c0ac1423d5f267e7f1d1940780fc764b0fee3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/af600e7f5526d16146b3ae99f6ad57bfea79ca33
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dc4874366cf6cf4a31d8fa4b7f0e2a5b2d7647ba
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39997
    reference_type:
    reference_id: CVE-2025-39997
