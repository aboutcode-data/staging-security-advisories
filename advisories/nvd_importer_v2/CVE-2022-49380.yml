advisory_id: CVE-2022-49380
datasource_id: nvd_importer_v2/CVE-2022-49380
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49380
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  f2fs: fix to avoid f2fs_bug_on() in dec_valid_node_count()

  As Yanming reported in bugzilla:

  https://bugzilla.kernel.org/show_bug.cgi?id=215897

  I have encountered a bug in F2FS file system in kernel v5.17.

  The kernel should enable CONFIG_KASAN=y and CONFIG_KASAN_INLINE=y. You can
  reproduce the bug by running the following commands:

  The kernel message is shown below:

  kernel BUG at fs/f2fs/f2fs.h:2511!
  Call Trace:
   f2fs_remove_inode_page+0x2a2/0x830
   f2fs_evict_inode+0x9b7/0x1510
   evict+0x282/0x4e0
   do_unlinkat+0x33a/0x540
   __x64_sys_unlinkat+0x8e/0xd0
   do_syscall_64+0x3b/0x90
   entry_SYSCALL_64_after_hwframe+0x44/0xae

  The root cause is: .total_valid_block_count or .total_valid_node_count
  could fuzzed to zero, then once dec_valid_node_count() was called, it
  will cause BUG_ON(), this patch fixes to print warning info and set
  SBI_NEED_FSCK into CP instead of panic.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49380
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2766ddaf45b69252bb8fe526b5b6e56904a9ae7a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4d17e6fe9293d57081ffdc11e1cf313e25e8fd9e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/89d9a48d0cd30429463ea4e37ca83be6773ed5eb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bce859358d3d5940aa858e40ceee70ee6e76130e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ccffa99ae6a1f44797b57444c6a80382a42928fe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f8b3c3fcf33105bc1ee7788e3b51b0a1ae42ae53
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49380
    reference_type:
    reference_id: CVE-2022-49380
