advisory_id: CVE-2026-23009
datasource_id: nvd_importer_v2/CVE-2026-23009
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23009
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  xhci: sideband: don't dereference freed ring when removing sideband endpoint

  xhci_sideband_remove_endpoint() incorrecly assumes that the endpoint is
  running and has a valid transfer ring.

  Lianqin reported a crash during suspend/wake-up stress testing, and
  found the cause to be dereferencing a non-existing transfer ring
  'ep->ring' during xhci_sideband_remove_endpoint().

  The endpoint and its ring may be in unknown state if this function
  is called after xHCI was reinitialized in resume (lost power), or if
  device is being re-enumerated, disconnected or endpoint already dropped.

  Fix this by both removing unnecessary ring access, and by checking
  ep->ring exists before dereferencing it. Also make sure endpoint is
  running before attempting to stop it.

  Remove the xhci_initialize_ring_info() call during sideband endpoint
  removal as is it only initializes ring structure enqueue, dequeue and
  cycle state values to their starting values without changing actual
  hardware enqueue, dequeue and cycle state. Leaving them out of sync
  is worse than leaving it as it is. The endpoint will get freed in after
  this in most usecases.

  If the (audio) class driver want's to reuse the endpoint after offload
  then it is up to the class driver to ensure endpoint is properly set up.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/34f6634dba87ef72b3c3a3a524be663adef7ab42
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd83dc1249737b837ac5d57c81f2b0977c613d9f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23009
    reference_type:
    reference_id: CVE-2026-23009
