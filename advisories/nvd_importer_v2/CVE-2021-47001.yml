advisory_id: CVE-2021-47001
datasource_id: nvd_importer_v2/CVE-2021-47001
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47001
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  xprtrdma: Fix cwnd update ordering

  After a reconnect, the reply handler is opening the cwnd (and thus
  enabling more RPC Calls to be sent) /before/ rpcrdma_post_recvs()
  can post enough Receive WRs to receive their replies. This causes an
  RNR and the new connection is lost immediately.

  The race is most clearly exposed when KASAN and disconnect injection
  are enabled. This slows down rpcrdma_rep_create() enough to allow
  the send side to post a bunch of RPC Calls before the Receive
  completion handler can invoke ib_post_recv().
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47001
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/19b5fa9489b5706bc878c3a522a7f771079e2fa0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35d8b10a25884050bb3b0149b62c3818ec59f77c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8834ecb5df22b7ff3c9b0deba7726579bb613f95
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eddae8be7944096419c2ae29477a45f767d0fcd4
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20250411-0001/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47001
    reference_type:
    reference_id: CVE-2021-47001
