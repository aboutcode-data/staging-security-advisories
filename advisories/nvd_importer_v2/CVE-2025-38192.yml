advisory_id: CVE-2025-38192
datasource_id: nvd_importer_v2/CVE-2025-38192
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38192
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: clear the dst when changing skb protocol

  A not-so-careful NAT46 BPF program can crash the kernel
  if it indiscriminately flips ingress packets from v4 to v6:

    BUG: kernel NULL pointer dereference, address: 0000000000000000
      ip6_rcv_core (net/ipv6/ip6_input.c:190:20)
      ipv6_rcv (net/ipv6/ip6_input.c:306:8)
      process_backlog (net/core/dev.c:6186:4)
      napi_poll (net/core/dev.c:6906:9)
      net_rx_action (net/core/dev.c:7028:13)
      do_softirq (kernel/softirq.c:462:3)
      netif_rx (net/core/dev.c:5326:3)
      dev_loopback_xmit (net/core/dev.c:4015:2)
      ip_mc_finish_output (net/ipv4/ip_output.c:363:8)
      NF_HOOK (./include/linux/netfilter.h:314:9)
      ip_mc_output (net/ipv4/ip_output.c:400:5)
      dst_output (./include/net/dst.h:459:9)
      ip_local_out (net/ipv4/ip_output.c:130:9)
      ip_send_skb (net/ipv4/ip_output.c:1496:8)
      udp_send_skb (net/ipv4/udp.c:1040:8)
      udp_sendmsg (net/ipv4/udp.c:1328:10)

  The output interface has a 4->6 program attached at ingress.
  We try to loop the multicast skb back to the sending socket.
  Ingress BPF runs as part of netif_rx(), pushes a valid v6 hdr
  and changes skb->protocol to v6. We enter ip6_rcv_core which
  tries to use skb_dst(). But the dst is still an IPv4 one left
  after IPv4 mcast output.

  Clear the dst in all BPF helpers which change the protocol.
  Try to preserve metadata dsts, those may carry non-routing
  metadata.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38192
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/2a3ad42a57b43145839f2f233fb562247658a6d9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ba9db6f907ac02215e30128770f85fbd7db2fcf9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bfa4d86e130a09f67607482e988313430e38f6c4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e9994e7b9f7bbb882d13c8191731649249150d21
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38192
    reference_type:
    reference_id: CVE-2025-38192
