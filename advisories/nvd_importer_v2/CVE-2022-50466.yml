advisory_id: CVE-2022-50466
datasource_id: nvd_importer_v2/CVE-2022-50466
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50466
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fs/binfmt_elf: Fix memory leak in load_elf_binary()

  There is a memory leak reported by kmemleak:

    unreferenced object 0xffff88817104ef80 (size 224):
      comm "xfs_admin", pid 47165, jiffies 4298708825 (age 1333.476s)
      hex dump (first 32 bytes):
        00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
        60 a8 b3 00 81 88 ff ff a8 10 5a 00 81 88 ff ff  `.........Z.....
      backtrace:
        [<ffffffff819171e1>] __alloc_file+0x21/0x250
        [<ffffffff81918061>] alloc_empty_file+0x41/0xf0
        [<ffffffff81948cda>] path_openat+0xea/0x3d30
        [<ffffffff8194ec89>] do_filp_open+0x1b9/0x290
        [<ffffffff8192660e>] do_open_execat+0xce/0x5b0
        [<ffffffff81926b17>] open_exec+0x27/0x50
        [<ffffffff81a69250>] load_elf_binary+0x510/0x3ed0
        [<ffffffff81927759>] bprm_execve+0x599/0x1240
        [<ffffffff8192a997>] do_execveat_common.isra.0+0x4c7/0x680
        [<ffffffff8192b078>] __x64_sys_execve+0x88/0xb0
        [<ffffffff83bbf0a5>] do_syscall_64+0x35/0x80

  If "interp_elf_ex" fails to allocate memory in load_elf_binary(),
  the program will take the "out_free_ph" error handing path,
  resulting in "interpreter" file resource is not released.

  Fix it by adding an error handing path "out_free_file", which will
  release the file resource when "interp_elf_ex" failed to allocate
  memory.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50466
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/265b6fb780f57d10449a40e94219b28fa52479cc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/594d2a14f2168c09b13b114c3d457aa939403e52
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/706215300411d48db6b51a5832b872632a84bbc1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/acd9b4914f1c5928c7ae8ebc623d6291eb1a573a
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50466
    reference_type:
    reference_id: CVE-2022-50466
