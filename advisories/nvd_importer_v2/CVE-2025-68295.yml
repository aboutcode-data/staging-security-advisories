advisory_id: CVE-2025-68295
datasource_id: nvd_importer_v2/CVE-2025-68295
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-68295
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  smb: client: fix memory leak in cifs_construct_tcon()

  When having a multiuser mount with domain= specified and using
  cifscreds, cifs_set_cifscreds() will end up setting @ctx->domainname,
  so it needs to be freed before leaving cifs_construct_tcon().

  This fixes the following memory leak reported by kmemleak:

    mount.cifs //srv/share /mnt -o domain=ZELDA,multiuser,...
    su - testuser
    cifscreds add -d ZELDA -u testuser
    ...
    ls /mnt/1
    ...
    umount /mnt
    echo scan > /sys/kernel/debug/kmemleak
    cat /sys/kernel/debug/kmemleak
    unreferenced object 0xffff8881203c3f08 (size 8):
      comm "ls", pid 5060, jiffies 4307222943
      hex dump (first 8 bytes):
        5a 45 4c 44 41 00 cc cc                          ZELDA...
      backtrace (crc d109a8cf):
        __kmalloc_node_track_caller_noprof+0x572/0x710
        kstrdup+0x3a/0x70
        cifs_sb_tlink+0x1209/0x1770 [cifs]
        cifs_get_fattr+0xe1/0xf50 [cifs]
        cifs_get_inode_info+0xb5/0x240 [cifs]
        cifs_revalidate_dentry_attr+0x2d1/0x470 [cifs]
        cifs_getattr+0x28e/0x450 [cifs]
        vfs_getattr_nosec+0x126/0x180
        vfs_statx+0xf6/0x220
        do_statx+0xab/0x110
        __x64_sys_statx+0xd5/0x130
        do_syscall_64+0xbb/0x380
        entry_SYSCALL_64_after_hwframe+0x77/0x7f
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/3184b6a5a24ec9ee74087b2a550476f386df7dc2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3dd546e867e94c2f954bca45a961b6104ba708b6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a67e91d5f446e455dd9201cdd6e865f7078d251d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d146e96fef876492979658dce644305de35878d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f15288c137d960836277d0e3ecc62de68e52f00f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f62ffdfb431bdfa4b6d24233b7fd830eca0b801e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff8f9bd1c46ee02d5558293915d42e82646d5ee9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68295
    reference_type:
    reference_id: CVE-2025-68295
