advisory_id: CVE-2025-38538
datasource_id: nvd_importer_v2/CVE-2025-38538
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38538
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dmaengine: nbpfaxi: Fix memory corruption in probe()

  The nbpf->chan[] array is allocated earlier in the nbpf_probe() function
  and it has "num_channels" elements.  These three loops iterate one
  element farther than they should and corrupt memory.

  The changes to the second loop are more involved.  In this case, we're
  copying data from the irqbuf[] array into the nbpf->chan[] array.  If
  the data in irqbuf[i] is the error IRQ then we skip it, so the iterators
  are not in sync.  I added a check to ensure that we don't go beyond the
  end of the irqbuf[] array.  I'm pretty sure this can't happen, but it
  seemed harmless to add a check.

  On the other hand, after the loop has ended there is a check to ensure
  that the "chan" iterator is where we expect it to be.  In the original
  code we went one element beyond the end of the array so the iterator
  wasn't in the correct place and it would always return -EINVAL.  However,
  now it will always be in the correct place.  I deleted the check since
  we know the result.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38538
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/122160289adf8ebf15060f1cbf6265b55a914948
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/188c6ba1dd925849c5d94885c8bbdeb0b3dcf510
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/24861ef8b517a309a4225f2793be0cd8fa0bec9e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4bb016438335ec02b01f96bf1367378c2bfe03e5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/84fff8e6f11b9af1407e273995b5257d99ff0cff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aec396b4f736f3f8d2c28a9cd2924a4ada57ae87
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d6bbd67ab5de37a74ac85c83c5a26664b62034dd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f366b36c5e3ce29c9a3c8eed3d1631908e4fc8bb
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38538
    reference_type:
    reference_id: CVE-2025-38538
