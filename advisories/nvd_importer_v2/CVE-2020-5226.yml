advisory_id: CVE-2020-5226
datasource_id: nvd_importer_v2/CVE-2020-5226
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2020-5226
aliases: []
summary: Cross-site scripting in SimpleSAMLphp before version 1.18.4. The www/erroreport.php
  script allows error reports to be submitted and sent to the system administrator. Starting
  with SimpleSAMLphp 1.18.0, a new SimpleSAML\Utils\EMail class was introduced to handle sending
  emails, implemented as a wrapper of an external dependency. This new wrapper allows us to
  use Twig templates in order to create the email sent with an error report. Since Twig provides
  automatic escaping of variables, manual escaping of the free-text field in www/errorreport.php
  was removed to avoid double escaping. However, for those not using the new user interface
  yet, an email template is hardcoded into the class itself in plain PHP. Since no escaping
  is provided in this template, it is then possible to inject HTML inside the template by manually
  crafting the contents of the free-text field.
impacted_packages: []
severities:
  - score: '3.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-5226
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-5226
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-5226
weaknesses:
  - CWE-79
references:
  - url: https://github.com/simplesamlphp/simplesamlphp/security/advisories/GHSA-mj9p-v2r8-wf8w
    reference_type:
    reference_id:
  - url: https://simplesamlphp.org/security/202001-01
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:simplesamlphp:simplesamlphp:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:simplesamlphp:simplesamlphp:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-5226
    reference_type:
    reference_id: CVE-2020-5226
