advisory_id: CVE-2022-49744
datasource_id: nvd_importer_v2/CVE-2022-49744
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49744
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/uffd: fix pte marker when fork() without fork event

  Patch series "mm: Fixes on pte markers".

  Patch 1 resolves the syzkiller report from Pengfei.

  Patch 2 further harden pte markers when used with the recent swapin error
  markers.  The major case is we should persist a swapin error marker after
  fork(), so child shouldn't read a corrupted page.


  This patch (of 2):

  When fork(), dst_vma is not guaranteed to have VM_UFFD_WP even if src may
  have it and has pte marker installed.  The warning is improper along with
  the comment.  The right thing is to inherit the pte marker when needed, or
  keep the dst pte empty.

  A vague guess is this happened by an accident when there's the prior patch
  to introduce src/dst vma into this helper during the uffd-wp feature got
  developed and I probably messed up in the rebase, since if we replace
  dst_vma with src_vma the warning & comment it all makes sense too.

  Hugetlb did exactly the right here (copy_hugetlb_page_range()).  Fix the
  general path.

  Reproducer:

  https://github.com/xupengfe/syzkaller_logs/blob/main/221208_115556_copy_page_range/repro.c

  Bugzilla report: https://bugzilla.kernel.org/show_bug.cgi?id=216808
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49744
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2d11727655bf931776fb541f5862daf04bd5bf02
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/49d6d7fb631345b0f2957a7c4be24ad63903150f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49744
    reference_type:
    reference_id: CVE-2022-49744
