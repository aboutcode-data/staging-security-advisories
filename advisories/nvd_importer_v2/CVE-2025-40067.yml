advisory_id: CVE-2025-40067
datasource_id: nvd_importer_v2/CVE-2025-40067
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40067
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fs/ntfs3: reject index allocation if $BITMAP is empty but blocks exist

  Index allocation requires at least one bit in the $BITMAP attribute to
  track usage of index entries. If the bitmap is empty while index blocks
  are already present, this reflects on-disk corruption.

  syzbot triggered this condition using a malformed NTFS image. During a
  rename() operation involving a long filename (which spans multiple
  index entries), the empty bitmap allowed the name to be added without
  valid tracking. Subsequent deletion of the original entry failed with
  -ENOENT, due to unexpected index state.

  Reject such cases by verifying that the bitmap is not empty when index
  blocks exist.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/039ddf353cc33f6546a87ec1ac3210637d714bec
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0dc7117da8f92dd5fe077d712a756eccbe377d40
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/978aac54e93ea35aab20b32ae393d3d33964e7ae
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/be66551da203862c689c12e1d35ce87217c017c1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40067
    reference_type:
    reference_id: CVE-2025-40067
