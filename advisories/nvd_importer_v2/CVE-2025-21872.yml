advisory_id: CVE-2025-21872
datasource_id: nvd_importer_v2/CVE-2025-21872
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21872
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  efi: Don't map the entire mokvar table to determine its size

  Currently, when validating the mokvar table, we (re)map the entire table
  on each iteration of the loop, adding space as we discover new entries.
  If the table grows over a certain size, this fails due to limitations of
  early_memmap(), and we get a failure and traceback:

    ------------[ cut here ]------------
    WARNING: CPU: 0 PID: 0 at mm/early_ioremap.c:139 __early_ioremap+0xef/0x220
    ...
    Call Trace:
     <TASK>
     ? __early_ioremap+0xef/0x220
     ? __warn.cold+0x93/0xfa
     ? __early_ioremap+0xef/0x220
     ? report_bug+0xff/0x140
     ? early_fixup_exception+0x5d/0xb0
     ? early_idt_handler_common+0x2f/0x3a
     ? __early_ioremap+0xef/0x220
     ? efi_mokvar_table_init+0xce/0x1d0
     ? setup_arch+0x864/0xc10
     ? start_kernel+0x6b/0xa10
     ? x86_64_start_reservations+0x24/0x30
     ? x86_64_start_kernel+0xed/0xf0
     ? common_startup_64+0x13e/0x141
     </TASK>
    ---[ end trace 0000000000000000 ]---
    mokvar: Failed to map EFI MOKvar config table pa=0x7c4c3000, size=265187.

  Mapping the entire structure isn't actually necessary, as we don't ever
  need more than one entry header mapped at once.

  Changes efi_mokvar_table_init() to only map each entry header, not the
  entire table, when determining the table size.  Since we're not mapping
  any data past the variable name, it also changes the code to enforce
  that each variable name is NUL terminated, rather than attempting to
  verify it in place.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21872
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2b90e7ace79774a3540ce569e000388f8d22c9e0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/46c0454ffb78ce9d3355a3cccac86383ea8ddd55
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/65f4aebb8127708ba668dd938e83b8558abfc5cd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/97bd560b6cc4c26386a53b4881bf03e96f9ba03a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ea3f0b362dfe4ef885ef812bfaf4088176422c91
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21872
    reference_type:
    reference_id: CVE-2025-21872
