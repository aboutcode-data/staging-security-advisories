advisory_id: CVE-2025-71140
datasource_id: nvd_importer_v2/CVE-2025-71140
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-71140
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  media: mediatek: vcodec: Use spinlock for context list protection lock

  Previously a mutex was added to protect the encoder and decoder context
  lists from unexpected changes originating from the SCP IP block, causing
  the context pointer to go invalid, resulting in a NULL pointer
  dereference in the IPI handler.

  Turns out on the MT8173, the VPU IPI handler is called from hard IRQ
  context. This causes a big warning from the scheduler. This was first
  reported downstream on the ChromeOS kernels, but is also reproducible
  on mainline using Fluster with the FFmpeg v4l2m2m decoders. Even though
  the actual capture format is not supported, the affected code paths
  are triggered.

  Since this lock just protects the context list and operations on it are
  very fast, it should be OK to switch to a spinlock.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2c1ea6214827041f548279c9eda341eda0cc8351
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3e858938b0e659f6ec9ddcf853a87f1c5c3f44e1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a5844227e0f030d2af2d85d4aed10c5eca6ca176
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b92c19675f632a41af1222027a231bc2b7efa7ed
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-71140
    reference_type:
    reference_id: CVE-2025-71140
