advisory_id: CVE-2025-22072
datasource_id: nvd_importer_v2/CVE-2025-22072
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-22072
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nspufs: fix\
  \ gang directory lifetimes\n\nprior to \"[POWERPC] spufs: Fix gang destroy leaks\" we used\
  \ to have\na problem with gang lifetimes - creation of a gang returns opened\ngang directory,\
  \ which normally gets removed when that gets closed,\nbut if somebody has created a context\
  \ belonging to that gang and\nkept it alive until the gang got closed, removal failed and\
  \ we\nended up with a leak.\n\nUnfortunately, it had been fixed the wrong way.  Dentry of\
  \ gang\ndirectory was no longer pinned, and rmdir on close was gone.\nOne problem was that\
  \ failure of open kept calling simple_rmdir()\nas cleanup, which meant an unbalanced dput().\
  \  Another bug was\nin the success case - gang creation incremented link count on\nroot directory,\
  \ but that was no longer undone when gang got\ndestroyed.\n\nFix consists of\n\t* reverting\
  \ the commit in question\n\t* adding a counter to gang, protected by ->i_rwsem\nof gang directory\
  \ inode.\n\t* having it set to 1 at creation time, dropped\nin both spufs_dir_close() and\
  \ spufs_gang_close() and bumped\nin spufs_create_context(), provided that it's not 0.\n\t\
  * using simple_recursive_removal() to take the gang\ndirectory out when counter reaches zero."
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-22072
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/029d8c711f5e5fe8cf63e8a4a1a140a06e224e45
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/324f280806aab28ef757aecc18df419676c10ef8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/880e7b3da2e765c1f90c94c0539be039e96c7062
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/903733782f3ae28a2f7fe4dfb47c7fe3e079a528
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c134deabf4784e155d360744d4a6a835b9de4dd4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fc646a6c6d14b5d581f162a7e32999f789e3a3ac
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:2.6.22:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:2.6.22:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:2.6.22:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:2.6.22:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:2.6.22:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:2.6.22:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:2.6.22:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:2.6.22:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22072
    reference_type:
    reference_id: CVE-2025-22072
