advisory_id: CVE-2021-21271
datasource_id: nvd_importer_v2/CVE-2021-21271
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21271
aliases: []
summary: Tendermint Core is an open source Byzantine Fault Tolerant (BFT) middleware that takes
  a state transition machine - written in any programming language - and securely replicates
  it on many machines. Tendermint Core v0.34.0 introduced a new way of handling evidence of
  misbehavior. As part of this, we added a new Timestamp field to Evidence structs. This timestamp
  would be calculated using the same algorithm that is used when a block is created and proposed.
  (This algorithm relies on the timestamp of the last commit from this specific block.) In Tendermint
  Core v0.34.0-v0.34.2, the consensus reactor is responsible for forming DuplicateVoteEvidence
  whenever double signs are observed. However, the current block is still “in flight” when it
  is being formed by the consensus reactor. It hasn’t been finalized through network consensus
  yet. This means that different nodes in the network may observe different “last commits” when
  assigning a timestamp to DuplicateVoteEvidence. In turn, different nodes could form DuplicateVoteEvidence
  objects at the same height but with different timestamps. One DuplicateVoteEvidence object
  (with one timestamp) will then eventually get finalized in the block, but this means that
  any DuplicateVoteEvidence with a different timestamp is considered invalid. Any node that
  formed invalid DuplicateVoteEvidence will continue to propose invalid evidence; its peers
  may see this, and choose to disconnect from this node. This bug means that double signs are
  DoS vectors in Tendermint Core v0.34.0-v0.34.2. Tendermint Core v0.34.3 is a security release
  which fixes this bug. As of v0.34.3, DuplicateVoteEvidence is no longer formed by the consensus
  reactor; rather, the consensus reactor passes the Votes themselves into the EvidencePool,
  which is now responsible for forming DuplicateVoteEvidence. The EvidencePool has timestamp
  info that should be consistent across the network, which means that DuplicateVoteEvidence
  formed in this reactor should have consistent timestamps. This release changes the API between
  the consensus and evidence reactors.
impacted_packages: []
severities:
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21271
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21271
weaknesses:
  - CWE-400
references:
  - url: https://github.com/tendermint/tendermint/blob/v0.34.3/CHANGELOG.md#v0.34.3
    reference_type:
    reference_id:
  - url: https://github.com/tendermint/tendermint/commit/a2a6852ab99e4a0f9e79f0ea8c1726e262e25c76
    reference_type:
    reference_id:
  - url: https://github.com/tendermint/tendermint/security/advisories/GHSA-p658-8693-mhvg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:tendermint:tendermint:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:tendermint:tendermint:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21271
    reference_type:
    reference_id: CVE-2021-21271
