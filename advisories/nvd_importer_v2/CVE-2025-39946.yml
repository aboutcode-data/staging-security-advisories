advisory_id: CVE-2025-39946
datasource_id: nvd_importer_v2/CVE-2025-39946
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39946
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tls: make sure to abort the stream if headers are bogus

  Normally we wait for the socket to buffer up the whole record
  before we service it. If the socket has a tiny buffer, however,
  we read out the data sooner, to prevent connection stalls.
  Make sure that we abort the connection when we find out late
  that the record is actually invalid. Retrying the parsing is
  fine in itself but since we copy some more data each time
  before we parse we can overflow the allocated skb space.

  Constructing a scenario in which we're under pressure without
  enough data in the socket to parse the length upfront is quite
  hard. syzbot figured out a way to do this by serving us the header
  in small OOB sends, and then filling in the recvbuf with a large
  normal send.

  Make sure that tls_rx_msg_size() aborts strp, if we reach
  an invalid record there's really no way to recover.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39946
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0aeb54ac4cd5cf8f60131b4d9ec0b6dc9c27b20d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/208640e6225cc929a05adbf79d1df558add3e231
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4cefe5be73886f383639fe0850bb72d5b568a7b9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/61ca2da5fb8f433ce8bbd1657c84a86272133e6b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b36462146d86b1f22e594fe4dae611dffacfb203
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39946
    reference_type:
    reference_id: CVE-2025-39946
