advisory_id: CVE-2024-45388
datasource_id: nvd_importer_v2/CVE-2024-45388
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-45388
aliases: []
summary: Hoverfly is a lightweight service virtualization/ API simulation / API mocking tool
  for developers and testers. The `/api/v2/simulation` POST handler allows users to create new
  simulation views from the contents of a user-specified file. This feature can be abused by
  an attacker to read arbitrary files from the Hoverfly server. Note that, although the code
  prevents absolute paths from being specified, an attacker can escape out of the `hf.Cfg.ResponsesBodyFilesPath`
  base path by using `../` segments and reach any arbitrary files. This issue was found using
  the Uncontrolled data used in path expression CodeQL query for python. Users are advised to
  make sure the final path (`filepath.Join(hf.Cfg.ResponsesBodyFilesPath, filePath)`) is contained
  within the expected base path (`filepath.Join(hf.Cfg.ResponsesBodyFilesPath, "/")`). This
  issue is also tracked as GHSL-2023-274.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-45388
weaknesses:
  - CWE-200
  - CWE-22
references:
  - url: https://codeql.github.com/codeql-query-help/go/go-path-injection
    reference_type:
    reference_id:
  - url: https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87
    reference_type:
    reference_id:
  - url: https://github.com/SpectoLabs/hoverfly/releases/tag/v1.10.3
    reference_type:
    reference_id:
  - url: https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-6xx4-x46f-f897
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:hoverfly:hoverfly:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:hoverfly:hoverfly:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45388
    reference_type:
    reference_id: CVE-2024-45388
