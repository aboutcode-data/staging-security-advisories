advisory_id: CVE-2024-26653
datasource_id: nvd_importer_v2/CVE-2024-26653
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26653
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: misc: ljca: Fix double free in error handling path

  When auxiliary_device_add() returns error and then calls
  auxiliary_device_uninit(), callback function ljca_auxdev_release
  calls kfree(auxdev->dev.platform_data) to free the parameter data
  of the function ljca_new_client_device. The callers of
  ljca_new_client_device shouldn't call kfree() again
  in the error handling path to free the platform data.

  Fix this by cleaning up the redundant kfree() in all callers and
  adding kfree() the passed in platform_data on errors which happen
  before auxiliary_device_init() succeeds .
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26653
weaknesses:
  - CWE-415
references:
  - url: https://git.kernel.org/stable/c/420babea4f1881a7c4ea22a8e218b8c6895d3f21
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7c9631969287a5366bc8e39cd5abff154b35fb80
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8a9f653cc852677003c23ee8075e3ed8fb4743c9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26653
    reference_type:
    reference_id: CVE-2024-26653
