advisory_id: CVE-2022-50845
datasource_id: nvd_importer_v2/CVE-2022-50845
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50845
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: fix inode leak in ext4_xattr_inode_create() on an error path

  There is issue as follows when do setxattr with inject fault:

  [localhost]# fsck.ext4  -fn  /dev/sda
  e2fsck 1.46.6-rc1 (12-Sep-2022)
  Pass 1: Checking inodes, blocks, and sizes
  Pass 2: Checking directory structure
  Pass 3: Checking directory connectivity
  Pass 4: Checking reference counts
  Unattached zero-length inode 15.  Clear? no

  Unattached inode 15
  Connect to /lost+found? no

  Pass 5: Checking group summary information

  /dev/sda: ********** WARNING: Filesystem still has errors **********

  /dev/sda: 15/655360 files (0.0% non-contiguous), 66755/2621440 blocks

  This occurs in 'ext4_xattr_inode_create()'. If 'ext4_mark_inode_dirty()'
  fails, dropping i_nlink of the inode is needed. Or will lead to inode leak.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0f709e08caffb41bbc9b38b9a4c1bd0769794007
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/322cf639b0b7f137543072c55545adab782b3a25
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/70e5b46beba64706430a87a6d516054225e8ac8a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9882601ee689975c1c0076ee65bf222a2a35e535
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ef603086c5b796fde1c7f22a17d0fc826ba54cb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e4db04f7d3dbbe16680e0ded27ea2a65b10f766a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eab94a46560f68d4bcd15222701ced479f84f427
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fdaaf45786dc8c17a72901021772520fceb18f8c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50845
    reference_type:
    reference_id: CVE-2022-50845
