advisory_id: CVE-2023-50731
datasource_id: nvd_importer_v2/CVE-2023-50731
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-50731
aliases: []
summary: MindsDB is a SQL Server for artificial intelligence. Prior to version 23.11.4.1, the
  `put` method in `mindsdb/mindsdb/api/http/namespaces/file.py` does not validate the user-controlled
  name value, which is used in a temporary file name, which is afterwards opened for writing
  on lines 122-125, which leads to path injection. Later in the method, the temporary directory
  is deleted on line 151, but since we can write outside of the directory using the path injection
  vulnerability, the potentially dangerous file is not deleted. Arbitrary file contents can
  be written due to `f.write(chunk)` on line 125. Mindsdb does check later on line 149 in the
  `save_file` method in `file-controller.py` which calls the `_handle_source` method in `file_handler.py`
  if a file is of one of the types `csv`, `json`, `parquet`, `xls`, or `xlsx`. However, since
  the check happens after the file has already been written, the files will still exist (and
  will not be removed due to the path injection described earlier), just the `_handle_source`
  method will return an error. The same user-controlled source source is used also in another
  path injection sink on line 138. This leads to another path injection, which allows an attacker
  to delete any `zip` or `tar.gz` files on the server.
impacted_packages: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-50731
weaknesses:
  - CWE-918
  - CWE-22
references:
  - url: https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L122-L125
    reference_type:
    reference_id:
  - url: https://github.com/mindsdb/mindsdb/blob/1821da719f34c022890c9ff25810218e71c5abbc/mindsdb/api/http/namespaces/file.py#L138
    reference_type:
    reference_id:
  - url: https://github.com/mindsdb/mindsdb/security/advisories/GHSA-j8w6-2r9h-cxhj
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2023-182_GHSL-2023-184_mindsdb_mindsdb/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mindsdb:mindsdb:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:mindsdb:mindsdb:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-50731
    reference_type:
    reference_id: CVE-2023-50731
