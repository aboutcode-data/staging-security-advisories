advisory_id: CVE-2025-38732
datasource_id: nvd_importer_v2/CVE-2025-38732
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38732
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: nf_reject: don't leak dst refcount for loopback packets

  recent patches to add a WARN() when replacing skb dst entry found an
  old bug:

  WARNING: include/linux/skbuff.h:1165 skb_dst_check_unset include/linux/skbuff.h:1164 [inline]
  WARNING: include/linux/skbuff.h:1165 skb_dst_set include/linux/skbuff.h:1210 [inline]
  WARNING: include/linux/skbuff.h:1165 nf_reject_fill_skb_dst+0x2a4/0x330 net/ipv4/netfilter/nf_reject_ipv4.c:234
  [..]
  Call Trace:
   nf_send_unreach+0x17b/0x6e0 net/ipv4/netfilter/nf_reject_ipv4.c:325
   nft_reject_inet_eval+0x4bc/0x690 net/netfilter/nft_reject_inet.c:27
   expr_call_ops_eval net/netfilter/nf_tables_core.c:237 [inline]
   ..

  This is because blamed commit forgot about loopback packets.
  Such packets already have a dst_entry attached, even at PRE_ROUTING stage.

  Instead of checking hook just check if the skb already has a route
  attached to it.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38732
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/51e8531371f90bee742c63775c9a568e5d6bf3c5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b8b503c06274ef3c6c1a107743f1ec0d0a53ef8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/82ef97abf22790182f7d433c74960dfd61b99c33
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/91a79b792204313153e1bdbbe5acbfc28903b3a5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a0a3ace2a57887dac1e7c9a724846040c3e31868
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b32e1590a8d22cf7d7f965e46d5576051acf8e42
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b7a885ba25960c91db237c3f83b4285156789bce
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38732
    reference_type:
    reference_id: CVE-2025-38732
