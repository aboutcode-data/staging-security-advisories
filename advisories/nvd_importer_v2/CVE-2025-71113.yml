advisory_id: CVE-2025-71113
datasource_id: nvd_importer_v2/CVE-2025-71113
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-71113
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  crypto: af_alg - zero initialize memory allocated via sock_kmalloc

  Several crypto user API contexts and requests allocated with
  sock_kmalloc() were left uninitialized, relying on callers to
  set fields explicitly. This resulted in the use of uninitialized
  data in certain error paths or when new fields are added in the
  future.

  The ACVP patches also contain two user-space interface files:
  algif_kpp.c and algif_akcipher.c. These too rely on proper
  initialization of their context structures.

  A particular issue has been observed with the newly added
  'inflight' variable introduced in af_alg_ctx by commit:

    67b164a871af ("crypto: af_alg - Disallow multiple in-flight AIO requests")

  Because the context is not memset to zero after allocation,
  the inflight variable has contained garbage values. As a result,
  af_alg_alloc_areq() has incorrectly returned -EBUSY randomly when
  the garbage value was interpreted as true:

    https://github.com/gregkh/linux/blame/master/crypto/af_alg.c#L1209

  The check directly tests ctx->inflight without explicitly
  comparing against true/false. Since inflight is only ever set to
  true or false later, an uninitialized value has triggered
  -EBUSY failures. Zero-initializing memory allocated with
  sock_kmalloc() ensures inflight and other fields start in a known
  state, removing random issues caused by uninitialized data.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/51a5ab36084f3251ef87eda3e6a6236f6488925e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/543bf004e4eafbb302b1e6c78570d425d2ca13a0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5a4b65523608974a81edbe386f8a667a3e10c726
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6f6e309328d53a10c0fe1f77dec2db73373179b6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/84238876e3b3b262cf62d5f4d1338e983fb27010
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e125c8e346e4eb7b3e854c862fcb4392bc13ddba
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f81244fd6b14fecfa93b66b6bb1d59f96554e550
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-71113
    reference_type:
    reference_id: CVE-2025-71113
