advisory_id: CVE-2021-46971
datasource_id: nvd_importer_v2/CVE-2021-46971
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-46971
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  perf/core: Fix unconditional security_locked_down() call

  Currently, the lockdown state is queried unconditionally, even though
  its result is used only if the PERF_SAMPLE_REGS_INTR bit is set in
  attr.sample_type. While that doesn't matter in case of the Lockdown LSM,
  it causes trouble with the SELinux's lockdown hook implementation.

  SELinux implements the locked_down hook with a check whether the current
  task's type has the corresponding "lockdown" class permission
  ("integrity" or "confidentiality") allowed in the policy. This means
  that calling the hook when the access control decision would be ignored
  generates a bogus permission check and audit record.

  Fix this by checking sample_type first and only calling the hook when
  its result would be honored.
impacted_packages: []
severities:
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46971
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/08ef1af4de5fe7de9c6d69f1e22e51b66e385d9b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4348d3b5027bc3ff6336368b6c60605d4ef8e1ce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b246759284d6a2bc5b6f1009caeeb3abce2ec9ff
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c7b0208ee370b89d20486fae71cd9abb759819c1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f5809ca4c311b71bfaba6d13f4e39eab0557895e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-46971
    reference_type:
    reference_id: CVE-2021-46971
