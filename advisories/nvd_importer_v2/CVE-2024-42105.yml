advisory_id: CVE-2024-42105
datasource_id: nvd_importer_v2/CVE-2024-42105
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-42105
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nnilfs2: fix\
  \ inode number range checks\n\nPatch series \"nilfs2: fix potential issues related to reserved\
  \ inodes\".\n\nThis series fixes one use-after-free issue reported by syzbot, caused by\n\
  nilfs2's internal inode being exposed in the namespace on a corrupted\nfilesystem, and a couple\
  \ of flaws that cause problems if the starting\nnumber of non-reserved inodes written in the\
  \ on-disk super block is\nintentionally (or corruptly) changed from its default value.  \n\
  \n\nThis patch (of 3):\n\nIn the current implementation of nilfs2, \"nilfs->ns_first_ino\"\
  , which\ngives the first non-reserved inode number, is read from the superblock,\nbut its\
  \ lower limit is not checked.\n\nAs a result, if a number that overlaps with the inode number\
  \ range of\nreserved inodes such as the root directory or metadata files is set in the\nsuper\
  \ block parameter, the inode number test macros (NILFS_MDT_INODE and\nNILFS_VALID_INODE) will\
  \ not function properly.\n\nIn addition, these test macros use left bit-shift calculations\
  \ using with\nthe inode number as the shift count via the BIT macro, but the result of a\n\
  shift calculation that exceeds the bit width of an integer is undefined in\nthe C specification,\
  \ so if \"ns_first_ino\" is set to a large value other\nthan the default value NILFS_USER_INO\
  \ (=11), the macros may potentially\nmalfunction depending on the environment.\n\nFix these\
  \ issues by checking the lower bound of \"nilfs->ns_first_ino\" and\nby preventing bit shifts\
  \ equal to or greater than the NILFS_USER_INO\nconstant in the inode number test macros.\n\
  \nAlso, change the type of \"ns_first_ino\" from signed integer to unsigned\ninteger to avoid\
  \ the need for type casting in comparisons such as the\nlower bound check introduced this\
  \ time."
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42105
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/08cab183a624ba71603f3754643ae11cab34dbc4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1c91058425a01131ea30dda6cf43c67b17884d6a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3be4dcc8d7bea52ea41f87aa4bbf959efe7a5987
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/57235c3c88bb430043728d0d02f44a4efe386476
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/731011ac6c37cbe97ece229fc6daa486276052c5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9194f8ca57527958bee207919458e372d638d783
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e2fec219a36e0993642844be0f345513507031f4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fae1959d6ab2c52677b113935e36ab4e25df37ea
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42105
    reference_type:
    reference_id: CVE-2024-42105
