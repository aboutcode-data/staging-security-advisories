advisory_id: CVE-2019-12520
datasource_id: nvd_importer_v2/CVE-2019-12520
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2019-12520
aliases: []
summary: An issue was discovered in Squid through 4.7 and 5. When receiving a request, Squid
  checks its cache to see if it can serve up a response. It does this by making a MD5 hash of
  the absolute URL of the request. If found, it servers the request. The absolute URL can include
  the decoded UserInfo (username and password) for certain protocols. This decoded info is prepended
  to the domain. This allows an attacker to provide a username that has special characters to
  delimit the domain, and treat the rest of the URL as a path or query string. An attacker could
  first make a request to their domain using an encoded username, then when a request for the
  target domain comes in that decodes to the exact URL, it will serve the attacker's HTML instead
  of the real HTML. On Squid servers that also act as reverse proxies, this allows an attacker
  to gain access to features that only reverse proxies can use, such as ESI.
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-12520
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-12520
weaknesses:
  - CWE-20
references:
  - url: https://github.com/squid-cache/squid/commits/v4
    reference_type:
    reference_id:
  - url: https://gitlab.com/jeriko.one/security/-/blob/master/squid/CVEs/CVE-2019-12520.txt
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2020/07/msg00009.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20210205-0006/
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4446-1/
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2020/dsa-4682
    reference_type:
    reference_id:
  - url: http://www.squid-cache.org/Versions/v4/
    reference_type:
    reference_id:
  - url: http://www.squid-cache.org/Versions/v4/changesets/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:squid-cache:squid:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:squid-cache:squid:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-12520
    reference_type:
    reference_id: CVE-2019-12520
