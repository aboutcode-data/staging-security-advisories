advisory_id: CVE-2026-23207
datasource_id: nvd_importer_v2/CVE-2026-23207
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2026-23207
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  spi: tegra210-quad: Protect curr_xfer check in IRQ handler

  Now that all other accesses to curr_xfer are done under the lock,
  protect the curr_xfer NULL check in tegra_qspi_isr_thread() with the
  spinlock. Without this protection, the following race can occur:

    CPU0 (ISR thread)              CPU1 (timeout path)
    ----------------               -------------------
    if (!tqspi->curr_xfer)
      // sees non-NULL
                                   spin_lock()
                                   tqspi->curr_xfer = NULL
                                   spin_unlock()
    handle_*_xfer()
      spin_lock()
      t = tqspi->curr_xfer  // NULL!
      ... t->len ...        // NULL dereference!

  With this patch, all curr_xfer accesses are now properly synchronized.

  Although all accesses to curr_xfer are done under the lock, in
  tegra_qspi_isr_thread() it checks for NULL, releases the lock and
  reacquires it later in handle_cpu_based_xfer()/handle_dma_based_xfer().
  There is a potential for an update in between, which could cause a NULL
  pointer dereference.

  To handle this, add a NULL check inside the handlers after acquiring
  the lock. This ensures that if the timeout path has already cleared
  curr_xfer, the handler will safely return without dereferencing the
  NULL pointer.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/2ac3a105e51496147c0e44e49466eecfcc532d57
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/edf9088b6e1d6d88982db7eb5e736a0e4fbcc09e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-23207
    reference_type:
    reference_id: CVE-2026-23207
