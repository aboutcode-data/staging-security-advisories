advisory_id: CVE-2024-56638
datasource_id: nvd_importer_v2/CVE-2024-56638
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-56638
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: nft_inner: incorrect percpu area handling under softirq

  Softirq can interrupt ongoing packet from process context that is
  walking over the percpu area that contains inner header offsets.

  Disable bh and perform three checks before restoring the percpu inner
  header offsets to validate that the percpu area is valid for this
  skbuff:

  1) If the NFT_PKTINFO_INNER_FULL flag is set on, then this skbuff
     has already been parsed before for inner header fetching to
     register.

  2) Validate that the percpu area refers to this skbuff using the
     skbuff pointer as a cookie. If there is a cookie mismatch, then
     this skbuff needs to be parsed again.

  3) Finally, validate if the percpu area refers to this tunnel type.

  Only after these three checks the percpu area is restored to a on-stack
  copy and bh is enabled again.

  After inner header fetching, the on-stack copy is stored back to the
  percpu area.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56638
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/53c7314208c865086d78b4e88da53bc33da0b603
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b1d83da254be3bf054965c8f3b1ad976f460ae5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/da5cc778e7bf78fe525bc90ec2043f41415c31d9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56638
    reference_type:
    reference_id: CVE-2024-56638
