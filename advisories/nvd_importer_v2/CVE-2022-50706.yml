advisory_id: CVE-2022-50706
datasource_id: nvd_importer_v2/CVE-2022-50706
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50706
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/ieee802154: don't warn zero-sized raw_sendmsg()

  syzbot is hitting skb_assert_len() warning at __dev_queue_xmit() [1],
  for PF_IEEE802154 socket's zero-sized raw_sendmsg() request is hitting
  __dev_queue_xmit() with skb->len == 0.

  Since PF_IEEE802154 socket's zero-sized raw_sendmsg() request was
  able to return 0, don't call __dev_queue_xmit() if packet length is 0.

    ----------
    #include <sys/socket.h>
    #include <netinet/in.h>

    int main(int argc, char *argv[])
    {
      struct sockaddr_in addr = { .sin_family = AF_INET, .sin_addr.s_addr = htonl(INADDR_LOOPBACK) };
      struct iovec iov = { };
      struct msghdr hdr = { .msg_name = &addr, .msg_namelen = sizeof(addr), .msg_iov = &iov, .msg_iovlen = 1 };
      sendmsg(socket(PF_IEEE802154, SOCK_RAW, 0), &hdr, 0);
      return 0;
    }
    ----------

  Note that this might be a sign that commit fd1894224407c484 ("bpf: Don't
  redirect packets with invalid pkt_len") should be reverted, for
  skb->len == 0 was acceptable for at least PF_IEEE802154 socket.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/34f31a2b667914ab701ca725554a0b447809d7ef
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4a36de8947794fa21435d1e916e089095f3246a8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/791489a5c56396ddfed75fc525066d4738dace46
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9974d220c5073d035b5469d1d8ecd71da86c7afd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b12e924a2f5b960373459c8f8a514f887adf5cac
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/df0da3fc131132b6c32a15c4da4ffa3a5aea1af2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50706
    reference_type:
    reference_id: CVE-2022-50706
