advisory_id: CVE-2025-39780
datasource_id: nvd_importer_v2/CVE-2025-39780
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39780
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sched/ext: Fix invalid task state transitions on class switch

  When enabling a sched_ext scheduler, we may trigger invalid task state
  transitions, resulting in warnings like the following (which can be
  easily reproduced by running the hotplug selftest in a loop):

   sched_ext: Invalid task state transition 0 -> 3 for fish[770]
   WARNING: CPU: 18 PID: 787 at kernel/sched/ext.c:3862 scx_set_task_state+0x7c/0xc0
   ...
   RIP: 0010:scx_set_task_state+0x7c/0xc0
   ...
   Call Trace:
    <TASK>
    scx_enable_task+0x11f/0x2e0
    switching_to_scx+0x24/0x110
    scx_enable.isra.0+0xd14/0x13d0
    bpf_struct_ops_link_create+0x136/0x1a0
    __sys_bpf+0x1edd/0x2c30
    __x64_sys_bpf+0x21/0x30
    do_syscall_64+0xbb/0x370
    entry_SYSCALL_64_after_hwframe+0x77/0x7f

  This happens because we skip initialization for tasks that are already
  dead (with their usage counter set to zero), but we don't exclude them
  during the scheduling class transition phase.

  Fix this by also skipping dead tasks during class swiching, preventing
  invalid task state transitions.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39780
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/6a32cbe95029ebe21cc08349fd7ef2a3d32d2043
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/786f6314604b34c3e7de5f733f4e08e35c448a50
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ddf7233fcab6c247379d0928d46cc316ee122229
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39780
    reference_type:
    reference_id: CVE-2025-39780
