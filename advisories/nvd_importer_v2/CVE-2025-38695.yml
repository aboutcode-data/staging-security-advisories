advisory_id: CVE-2025-38695
datasource_id: nvd_importer_v2/CVE-2025-38695
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38695
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: lpfc: Check for hdwq null ptr when cleaning up lpfc_vport structure

  If a call to lpfc_sli4_read_rev() from lpfc_sli4_hba_setup() fails, the
  resultant cleanup routine lpfc_sli4_vport_delete_fcp_xri_aborted() may
  occur before sli4_hba.hdwqs are allocated.  This may result in a null
  pointer dereference when attempting to take the abts_io_buf_list_lock for
  the first hardware queue.  Fix by adding a null ptr check on
  phba->sli4_hba.hdwq and early return because this situation means there
  must have been an error during port initialization.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38695
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/46a0602c24d7d425dd8e00c749cd64a934aac7ec
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/571617f171f723b05f02d154a2e549a17eab4935
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e25ee1ecec91c61a8acf938ad338399cad464de
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6698796282e828733cde3329c887b4ae9e5545e9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6711ce7e9de4eb1a541ef30638df1294ea4267f8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/74bdf54a847dab209d2a8f65852f59b7fa156175
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7925dd68807cc8fd755b04ca99e7e6f1c04392e8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/add68606a01dcccf18837a53e85b85caf0693b4b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d3f55f46bb37a8ec73bfe3cfe36e3ecfa2945dfa
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38695
    reference_type:
    reference_id: CVE-2025-38695
