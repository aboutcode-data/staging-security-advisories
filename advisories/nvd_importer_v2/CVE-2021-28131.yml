advisory_id: CVE-2021-28131
datasource_id: nvd_importer_v2/CVE-2021-28131
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-28131
aliases: []
summary: 'Impala sessions use a 16 byte secret to verify that the session is not being hijacked
  by another user. However, these secrets appear in the Impala logs, therefore Impala users
  with access to the logs can use another authenticated user''s sessions with specially constructed
  requests. This means the attacker is able to execute statements for which they don''t have
  the necessary privileges otherwise. Impala deployments with Apache Sentry or Apache Ranger
  authorization enabled may be vulnerable to privilege escalation if an authenticated attacker
  is able to hijack a session or query from another authenticated user with privileges not assigned
  to the attacker. Impala deployments with audit logging enabled may be vulnerable to incorrect
  audit logging as a user could undertake actions that were logged under the name of a different
  authenticated user. Constructing an attack requires a high degree of technical sophistication
  and access to the Impala system as an authenticated user. Mitigation: If an Impala deployment
  uses Apache Sentry, Apache Ranger or audit logging, then users should upgrade to a version
  of Impala with the fix for IMPALA-10600. The Impala 4.0 release includes this fix. This hides
  session secrets from the logs to eliminate the risk of any attack using this mechanism. In
  lieu of an upgrade, restricting access to logs that expose secrets will reduce the risk of
  an attack. Restricting access to the Impala deployment to trusted users will also reduce the
  risk of an attack. Log redaction techniques can be used to redact secrets from the logs.'
impacted_packages: []
severities:
  - score: '6.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-28131
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-28131
weaknesses:
  - CWE-288
  - CWE-532
references:
  - url: https://lists.apache.org/thread.html/rb54f54a91b7abaf1ed772f3a9cec290153c24881b25567b06f1b4a8c%40%3Cannounce.apache.org%3E
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/rb54f54a91b7abaf1ed772f3a9cec290153c24881b25567b06f1b4a8c%40%3Cuser.impala.apache.org%3E
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2021/07/22/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:impala:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:impala:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28131
    reference_type:
    reference_id: CVE-2021-28131
