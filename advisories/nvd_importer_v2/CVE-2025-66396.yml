advisory_id: CVE-2025-66396
datasource_id: nvd_importer_v2/CVE-2025-66396
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-66396
aliases: []
summary: ChurchCRM is an open-source church management system. Prior to version 6.5.3, a SQL
  injection vulnerability exists in the `src/UserEditor.php` file. When an administrator saves
  a user's configuration settings, the keys of the `type` POST parameter array are not properly
  sanitized or type-casted before being used in multiple SQL queries. This allows a malicious
  or compromised administrator account to execute arbitrary SQL commands, including time-based
  blind SQL injection attacks, to directly interact with the database. The vulnerability is
  located in `src/UserEditor.php` within the logic that handles saving user-specific configuration
  settings. The `type` parameter from the POST request is processed as an array. The code iterates
  through this array and uses `key($type)` to extract the array key, which is expected to be
  a numeric ID. This key is then assigned to the `$id` variable. The `$id` variable is subsequently
  concatenated directly into a `SELECT` and an `UPDATE` SQL query without any sanitization or
  validation, making it an injection vector. Although the vulnerability requires administrator
  privileges to exploit, it allows a malicious or compromised admin account to execute arbitrary
  SQL queries. This can be used to bypass any application-level logging or restrictions, directly
  manipulate the database, exfiltrate, modify, or delete all data (including other user credentials,
  financial records, and personal information), and could potentially lead to further system
  compromise, such as writing files to the server, depending on the database's configuration
  and user privileges. Version 6.5.3 patches the issue.
impacted_packages: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66396
weaknesses:
  - CWE-89
references:
  - url: https://github.com/ChurchCRM/CRM/security/advisories/GHSA-whpp-wx64-4qp9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:churchcrm:churchcrm:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:churchcrm:churchcrm:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66396
    reference_type:
    reference_id: CVE-2025-66396
