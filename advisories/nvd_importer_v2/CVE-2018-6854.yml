advisory_id: CVE-2018-6854
datasource_id: nvd_importer_v2/CVE-2018-6854
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2018-6854
aliases: []
summary: Sophos SafeGuard Enterprise before 8.00.5, SafeGuard Easy before 7.00.3, and SafeGuard
  LAN Crypt before 3.95.2 are vulnerable to Local Privilege Escalation via multiple IOCTLs,
  e.g., 0x8810200B, 0x8810200F, 0x8810201B, 0x8810201F, 0x8810202B, 0x8810202F, 0x8810203F,
  0x8810204B, 0x88102003, 0x88102007, 0x88102013, 0x88102017, 0x88102027, 0x88102033, 0x88102037,
  0x88102043, and 0x88102047. When some conditions in the user-controlled input buffer are not
  met, the driver writes an error code (0x2000001A) to a user-controlled address. Also, note
  that all the aforementioned IOCTLs use transfer type METHOD_NEITHER, which means that the
  I/O manager does not validate any of the supplied pointers and buffer sizes. So, even though
  the driver checks for input/output buffer sizes, it doesn't validate if the pointers to those
  buffers are actually valid. So, we can supply a pointer for the output buffer to a kernel
  address space address, and the error code will be written there. We can take advantage of
  this condition to modify the SEP_TOKEN_PRIVILEGES structure of the Token object belonging
  to the exploit process and grant SE_DEBUG_NAME privilege. This allows the exploit process
  to interact with higher privileged processes running as SYSTEM and execute code in their security
  context.
impacted_packages: []
severities:
  - score: '7.2'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-6854
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-6854
weaknesses:
  - CWE-119
references:
  - url: https://community.sophos.com/kb/en-us/131934
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2018/Jul/20
    reference_type:
    reference_id:
  - url: https://labs.nettitude.com/blog/cve-2018-6851-to-cve-2018-6857-sophos-privilege-escalation-vulnerabilities/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:6.00:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:6.00:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:6.10:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:6.10:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:7.00:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:7.00:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_enterprise_client:5.60.3:vs-nfd:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_enterprise_client:5.60.3:vs-nfd:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_enterprise_client:6.00:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_enterprise_client:6.00:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_enterprise_client:6.00.1:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_enterprise_client:6.00.1:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_enterprise_client:6.10:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_enterprise_client:6.10:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_enterprise_client:7.00:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_enterprise_client:7.00:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_enterprise_client:8.00:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_enterprise_client:8.00:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.90.1:ts:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.90.1:ts:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.90.2:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.90.2:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.95.1:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.95.1:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.95.1:ts:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.95.1:ts:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-6854
    reference_type:
    reference_id: CVE-2018-6854
