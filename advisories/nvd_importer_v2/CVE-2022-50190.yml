advisory_id: CVE-2022-50190
datasource_id: nvd_importer_v2/CVE-2022-50190
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-50190
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  spi: Fix simplification of devm_spi_register_controller

  This reverts commit 59ebbe40fb51 ("spi: simplify
  devm_spi_register_controller").

  If devm_add_action() fails in devm_add_action_or_reset(),
  devm_spi_unregister() will be called, it decreases the
  refcount of 'ctlr->dev' to 0, then it will cause uaf in
  the drivers that calling spi_put_controller() in error path.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-50190
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/34bab623ebfc08398499e463396b81abb4abe01e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3c6bd448442b6c3f6843ac70d57201a13478dd47
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/43cc5a0afe4184a7fafe1eba32b5a11bb69c9ce0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/445fb9c19cf45bd9472fd9babaa31c5e6c7d2720
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50190
    reference_type:
    reference_id: CVE-2022-50190
