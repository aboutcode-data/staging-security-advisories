advisory_id: CVE-2021-41272
datasource_id: nvd_importer_v2/CVE-2021-41272
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-41272
aliases: []
summary: 'Besu is an Ethereum client written in Java. Starting in version 21.10.0, changes in
  the implementation of the SHL, SHR, and SAR operations resulted in the introduction of a signed
  type coercion error in values that represent negative values for 32 bit signed integers. Smart
  contracts that ask for shifts between approximately 2 billion and 4 billion bits (nonsensical
  but valid values for the operation) will fail to execute and hence fail to validate. In networks
  where vulnerable versions are mining with other clients or non-vulnerable versions this will
  result in a fork and the relevant transactions will not be included in the fork. In networks
  where vulnerable versions are not mining (such as Rinkeby) no fork will result and the validator
  nodes will stop accepting blocks. In networks where only vulnerable versions are mining the
  relevant transaction will not be included in any blocks. When the network adds a non-vulnerable
  version the network will act as in the first case. Besu 21.10.2 contains a patch for this
  issue. Besu 21.7.4 is not vulnerable and clients can roll back to that version. There is a
  workaround available: Once a transaction with the relevant shift operations is included in
  the canonical chain, the only remediation is to make sure all nodes are on non-vulnerable
  versions.'
impacted_packages: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41272
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41272
weaknesses:
  - CWE-681
references:
  - url: https://github.com/hyperledger/besu/commit/4170524ac3b45185704fcfbdeeb71b0b05dfa0a1
    reference_type:
    reference_id:
  - url: https://github.com/hyperledger/besu/pull/3039
    reference_type:
    reference_id:
  - url: https://github.com/hyperledger/besu/security/advisories/GHSA-7pg2-p5vj-xp5h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:linuxfoundation:besu:21.10.0:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:linuxfoundation:besu:21.10.0:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:linuxfoundation:besu:21.10.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:linuxfoundation:besu:21.10.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:linuxfoundation:besu:21.10.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:linuxfoundation:besu:21.10.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:linuxfoundation:besu:21.10.0:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:linuxfoundation:besu:21.10.0:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:linuxfoundation:besu:21.10.0:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:linuxfoundation:besu:21.10.0:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:linuxfoundation:besu:21.10.1:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:linuxfoundation:besu:21.10.1:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41272
    reference_type:
    reference_id: CVE-2021-41272
