advisory_id: CVE-2023-53998
datasource_id: nvd_importer_v2/CVE-2023-53998
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53998
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  hwrng: virtio - Fix race on data_avail and actual data

  The virtio rng device kicks off a new entropy request whenever the
  data available reaches zero.  When a new request occurs at the end
  of a read operation, that is, when the result of that request is
  only needed by the next reader, then there is a race between the
  writing of the new data and the next reader.

  This is because there is no synchronisation whatsoever between the
  writer and the reader.

  Fix this by writing data_avail with smp_store_release and reading
  it with smp_load_acquire when we first enter read.  The subsequent
  reads are safe because they're either protected by the first load
  acquire, or by the completion mechanism.

  Also remove the redundant zeroing of data_idx in random_recv_done
  (data_idx must already be zero at this point) and data_avail in
  request_entropy (ditto).
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/22c30022cde6e2c88612b3a499223cfa912f1bc7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/241ef15776a7c8505008db689175b320d345ecd3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2fc91f156b3f3446a1bce80cf4adedcbf41271c2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/318657b4c2077289659f1cd9e2a34f6a3b208e3e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/77471e4912d3960dafe141e268c44be8024fe4dc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a43bcb0b661cbbf3ad797d2aee6b6fd06b8fc69d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac52578d6e8d300dd50f790f29a24169b1edd26c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c76d991b6f01a5d931e7053a73bc9524975a5215
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53998
    reference_type:
    reference_id: CVE-2023-53998
