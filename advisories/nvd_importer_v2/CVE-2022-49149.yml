advisory_id: CVE-2022-49149
datasource_id: nvd_importer_v2/CVE-2022-49149
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49149
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  rxrpc: Fix call timer start racing with call destruction

  The rxrpc_call struct has a timer used to handle various timed events
  relating to a call.  This timer can get started from the packet input
  routines that are run in softirq mode with just the RCU read lock held.
  Unfortunately, because only the RCU read lock is held - and neither ref or
  other lock is taken - the call can start getting destroyed at the same time
  a packet comes in addressed to that call.  This causes the timer - which
  was already stopped - to get restarted.  Later, the timer dispatch code may
  then oops if the timer got deallocated first.

  Fix this by trying to take a ref on the rxrpc_call struct and, if
  successful, passing that ref along to the timer.  If the timer was already
  running, the ref is discarded.

  The timer completion routine can then pass the ref along to the call's work
  item when it queues it.  If the timer or work item where already
  queued/running, the extra ref is discarded.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49149
weaknesses:
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/051360e51341cd17738d82c15a8226010c7cb7f6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4a7f62f91933c8ae5308f9127fd8ea48188b6bc3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/54df5a37f1d951ed27fd47bf9b15a42279582110
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5e3c11144e557a9dbf9a2f6abe444689ef9d8aae
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8cbf4ae7a2833767d63114573e5f9a45740cc975
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.15:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.15:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.15:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.15:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.15:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.15:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.15:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.15:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.15:rc8:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.15:rc8:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:4.15:rc9:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:4.15:rc9:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49149
    reference_type:
    reference_id: CVE-2022-49149
