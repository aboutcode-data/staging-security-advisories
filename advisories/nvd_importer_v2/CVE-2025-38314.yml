advisory_id: CVE-2025-38314
datasource_id: nvd_importer_v2/CVE-2025-38314
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38314
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  virtio-pci: Fix result size returned for the admin command completion

  The result size returned by virtio_pci_admin_dev_parts_get() is 8 bytes
  larger than the actual result data size. This occurs because the
  result_sg_size field of the command is filled with the result length
  from virtqueue_get_buf(), which includes both the data size and an
  additional 8 bytes of status.

  This oversized result size causes two issues:
  1. The state transferred to the destination includes 8 bytes of extra
     data at the end.
  2. The allocated buffer in the kernel may be smaller than the returned
     size, leading to failures when reading beyond the allocated size.

  The commit fixes this by subtracting the status size from the result of
  virtqueue_get_buf().

  This fix has been tested through live migrations with virtio-net,
  virtio-net-transitional, and virtio-blk devices.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38314
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/920b6720bb63893b81516c0c45884a8350f9e4bf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ef41ebf787fcbde99ac404ae473f8467641f983
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38314
    reference_type:
    reference_id: CVE-2025-38314
