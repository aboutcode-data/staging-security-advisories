advisory_id: CVE-2024-58340
datasource_id: nvd_importer_v2/CVE-2024-58340
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-58340
aliases: []
summary: LangChain versions up to and including 0.3.1 contain a regular expression denial-of-service
  (ReDoS) vulnerability in the MRKLOutputParser.parse() method (libs/langchain/langchain/agents/mrkl/output_parser.py).
  The parser applies a backtracking-prone regular expression when extracting tool actions from
  model output. An attacker who can supply or influence the parsed text (for example via prompt
  injection in downstream applications that pass LLM output directly into MRKLOutputParser.parse())
  can trigger excessive CPU consumption by providing a crafted payload, causing significant
  parsing delays and a denial-of-service condition.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-58340
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-58340
weaknesses:
  - CWE-1333
references:
  - url: https://github.com/langchain-ai/langchain
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/e7ece02c-d4bb-4166-8e08-6baf4f8845bb
    reference_type:
    reference_id:
  - url: https://www.langchain.com/
    reference_type:
    reference_id:
  - url: https://www.vulncheck.com/advisories/langchain-mrkloutputparser-redos
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:langchain:langchain:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:langchain:langchain:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-58340
    reference_type:
    reference_id: CVE-2024-58340
