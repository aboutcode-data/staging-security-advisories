advisory_id: CVE-2021-29536
datasource_id: nvd_importer_v2/CVE-2021-29536
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-29536
aliases: []
summary: TensorFlow is an end-to-end open source platform for machine learning. An attacker
  can cause a heap buffer overflow in `QuantizedReshape` by passing in invalid thresholds for
  the quantization. This is because the implementation(https://github.com/tensorflow/tensorflow/blob/a324ac84e573fba362a5e53d4e74d5de6729933e/tensorflow/core/kernels/quantized_reshape_op.cc#L38-L55)
  assumes that the 2 arguments are always valid scalars and tries to access the numeric value
  directly. However, if any of these tensors is empty, then `.flat<T>()` is an empty buffer
  and accessing the element at position 0 results in overflow. The fix will be included in TensorFlow
  2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow
  2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.
impacted_packages: []
severities:
  - score: '4.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29536
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29536
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29536
weaknesses:
  - CWE-131
  - CWE-787
references:
  - url: https://github.com/tensorflow/tensorflow/commit/a324ac84e573fba362a5e53d4e74d5de6729933e
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-2gfx-95x2-5v3x
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29536
    reference_type:
    reference_id: CVE-2021-29536
