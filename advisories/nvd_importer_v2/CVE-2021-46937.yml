advisory_id: CVE-2021-46937
datasource_id: nvd_importer_v2/CVE-2021-46937
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-46937
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/damon/dbgfs: fix 'struct pid' leaks in 'dbgfs_target_ids_write()'

  DAMON debugfs interface increases the reference counts of 'struct pid's
  for targets from the 'target_ids' file write callback
  ('dbgfs_target_ids_write()'), but decreases the counts only in DAMON
  monitoring termination callback ('dbgfs_before_terminate()').

  Therefore, when 'target_ids' file is repeatedly written without DAMON
  monitoring start/termination, the reference count is not decreased and
  therefore memory for the 'struct pid' cannot be freed.  This commit
  fixes this issue by decreasing the reference counts when 'target_ids' is
  written.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46937
weaknesses:
  - CWE-668
references:
  - url: https://git.kernel.org/stable/c/ebb3f994dd92f8fb4d70c7541091216c1e10cb71
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ffe4a1ba1a82c416a6b3a09d46594f6a885ae141
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-46937
    reference_type:
    reference_id: CVE-2021-46937
