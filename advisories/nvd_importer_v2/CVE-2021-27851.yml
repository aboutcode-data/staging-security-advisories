advisory_id: CVE-2021-27851
datasource_id: nvd_importer_v2/CVE-2021-27851
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-27851
aliases: []
summary: A security vulnerability that can lead to local privilege escalation has been found
  in ’guix-daemon’. It affects multi-user setups in which ’guix-daemon’ runs locally. The attack
  consists in having an unprivileged user spawn a build process, for instance with `guix build`,
  that makes its build directory world-writable. The user then creates a hardlink to a root-owned
  file such as /etc/shadow in that build directory. If the user passed the --keep-failed option
  and the build eventually fails, the daemon changes ownership of the whole build tree, including
  the hardlink, to the user. At that point, the user has write access to the target file. Versions
  after and including v0.11.0-3298-g2608e40988, and versions prior to v1.2.0-75109-g94f0312546
  are vulnerable.
impacted_packages: []
severities:
  - score: '2.1'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-27851
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-27851
weaknesses:
  - CWE-59
  - CWE-264
references:
  - url: https://bugs.gnu.org/47229
    reference_type:
    reference_id:
  - url: https://guix.gnu.org/en/blog/2021/risk-of-local-privilege-escalation-via-guix-daemon/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:gnu:guix:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:gnu:guix:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-27851
    reference_type:
    reference_id: CVE-2021-27851
