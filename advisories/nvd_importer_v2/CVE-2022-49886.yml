advisory_id: CVE-2022-49886
datasource_id: nvd_importer_v2/CVE-2022-49886
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49886
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nx86/tdx: Panic\
  \ on bad configs that #VE on \"private\" memory access\n\nAll normal kernel memory is \"TDX\
  \ private memory\".  This includes\neverything from kernel stacks to kernel text.  Handling\n\
  exceptions on arbitrary accesses to kernel memory is essentially\nimpossible because they\
  \ can happen in horribly nasty places like\nkernel entry/exit.  But, TDX hardware can theoretically\
  \ _deliver_\na virtualization exception (#VE) on any access to private memory.\n\nBut, it's\
  \ not as bad as it sounds.  TDX can be configured to never\ndeliver these exceptions on private\
  \ memory with a \"TD attribute\"\ncalled ATTR_SEPT_VE_DISABLE.  The guest has no way to *set*\
  \ this\nattribute, but it can check it.\n\nEnsure ATTR_SEPT_VE_DISABLE is set in early boot.\
  \  panic() if it\nis unset.  There is no sane way for Linux to run with this\nattribute clear\
  \ so a panic() is appropriate.\n\nThere's small window during boot before the check where\
  \ kernel\nhas an early #VE handler. But the handler is only for port I/O\nand will also panic()\
  \ as soon as it sees any other #VE, such as\na one generated by a private memory access.\n\
  \n[ dhansen: Rewrite changelog and rebase on new tdx_parse_tdinfo().\n\t   Add Kirill's tested-by\
  \ because I made changes since\n\t   he wrote this. ]"
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49886
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/373e715e31bf4e0f129befe87613a278fac228d3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/895c168c8f78079f21ad50fead7593ffa352f795
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49886
    reference_type:
    reference_id: CVE-2022-49886
