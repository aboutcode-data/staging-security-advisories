advisory_id: CVE-2024-49865
datasource_id: nvd_importer_v2/CVE-2024-49865
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-49865
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/xe/vm: move xa_alloc to prevent UAF

  Evil user can guess the next id of the vm before the ioctl completes and
  then call vm destroy ioctl to trigger UAF since create ioctl is still
  referencing the same vm. Move the xa_alloc all the way to the end to
  prevent this.

  v2:
   - Rebase

  (cherry picked from commit dcfd3971327f3ee92765154baebbaece833d3ca9)
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49865
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/09cf8901fc0225898311b375cfcc67bae37ed5da
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/74231870cf4976f69e83aa24f48edb16619f652f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49865
    reference_type:
    reference_id: CVE-2024-49865
