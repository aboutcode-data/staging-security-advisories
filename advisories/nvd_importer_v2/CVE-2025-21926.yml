advisory_id: CVE-2025-21926
datasource_id: nvd_importer_v2/CVE-2025-21926
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21926
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: gso: fix ownership in __udp_gso_segment

  In __udp_gso_segment the skb destructor is removed before segmenting the
  skb but the socket reference is kept as-is. This is an issue if the
  original skb is later orphaned as we can hit the following bug:

    kernel BUG at ./include/linux/skbuff.h:3312!  (skb_orphan)
    RIP: 0010:ip_rcv_core+0x8b2/0xca0
    Call Trace:
     ip_rcv+0xab/0x6e0
     __netif_receive_skb_one_core+0x168/0x1b0
     process_backlog+0x384/0x1100
     __napi_poll.constprop.0+0xa1/0x370
     net_rx_action+0x925/0xe50

  The above can happen following a sequence of events when using
  OpenVSwitch, when an OVS_ACTION_ATTR_USERSPACE action precedes an
  OVS_ACTION_ATTR_OUTPUT action:

  1. OVS_ACTION_ATTR_USERSPACE is handled (in do_execute_actions): the skb
     goes through queue_gso_packets and then __udp_gso_segment, where its
     destructor is removed.
  2. The segments' data are copied and sent to userspace.
  3. OVS_ACTION_ATTR_OUTPUT is handled (in do_execute_actions) and the
     same original skb is sent to its path.
  4. If it later hits skb_orphan, we hit the bug.

  Fix this by also removing the reference to the socket in
  __udp_gso_segment.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21926
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/01a83237644d6822bc7df2c5564fc81b0df84358
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/084819b0d8b1bd433b90142371eb9450d657f8ca
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/455217ac9db0cf9349b3933664355e907bb1a569
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9f28205ddb76e86cac418332e952241d85fed0dc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a2d1cca955ed34873e524cc2e6e885450d262f05
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c32da44cc9298eaa6109e3fc2c2b4e07cc4bf11b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e8db70537878e1bb3fd83e5abcc6feefc0587828
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ee01b2f2d7d0010787c2343463965bbc283a497f
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21926
    reference_type:
    reference_id: CVE-2025-21926
