advisory_id: CVE-2025-38010
datasource_id: nvd_importer_v2/CVE-2025-38010
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38010
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  phy: tegra: xusb: Use a bitmask for UTMI pad power state tracking

  The current implementation uses bias_pad_enable as a reference count to
  manage the shared bias pad for all UTMI PHYs. However, during system
  suspension with connected USB devices, multiple power-down requests for
  the UTMI pad result in a mismatch in the reference count, which in turn
  produces warnings such as:

  [  237.762967] WARNING: CPU: 10 PID: 1618 at tegra186_utmi_pad_power_down+0x160/0x170
  [  237.763103] Call trace:
  [  237.763104]  tegra186_utmi_pad_power_down+0x160/0x170
  [  237.763107]  tegra186_utmi_phy_power_off+0x10/0x30
  [  237.763110]  phy_power_off+0x48/0x100
  [  237.763113]  tegra_xusb_enter_elpg+0x204/0x500
  [  237.763119]  tegra_xusb_suspend+0x48/0x140
  [  237.763122]  platform_pm_suspend+0x2c/0xb0
  [  237.763125]  dpm_run_callback.isra.0+0x20/0xa0
  [  237.763127]  __device_suspend+0x118/0x330
  [  237.763129]  dpm_suspend+0x10c/0x1f0
  [  237.763130]  dpm_suspend_start+0x88/0xb0
  [  237.763132]  suspend_devices_and_enter+0x120/0x500
  [  237.763135]  pm_suspend+0x1ec/0x270

  The root cause was traced back to the dynamic power-down changes
  introduced in commit a30951d31b25 ("xhci: tegra: USB2 pad power controls"),
  where the UTMI pad was being powered down without verifying its current
  state. This unbalanced behavior led to discrepancies in the reference
  count.

  To rectify this issue, this patch replaces the single reference counter
  with a bitmask, renamed to utmi_pad_enabled. Each bit in the mask
  corresponds to one of the four USB2 PHYs, allowing us to track each pad's
  enablement status individually.

  With this change:
    - The bias pad is powered on only when the mask is clear.
    - Each UTMI pad is powered on or down based on its corresponding bit
      in the mask, preventing redundant operations.
    - The overall power state of the shared bias pad is maintained
      correctly during suspend/resume cycles.

  The mutex used to prevent race conditions during UTMI pad enable/disable
  operations has been moved from the tegra186_utmi_bias_pad_power_on/off
  functions to the parent functions tegra186_utmi_pad_power_on/down. This
  change ensures that there are no race conditions when updating the bitmask.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38010
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1db527f0cb8f677adadd4e28e5bc77aaf5d4e4c9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/628bec9ed68a2204184fc8230a2609075b08666e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b47158fb42959c417ff2662075c0d46fb783d5d1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ba25131b3c1ceec303839b2462586d7673788197
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38010
    reference_type:
    reference_id: CVE-2025-38010
