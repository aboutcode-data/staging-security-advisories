advisory_id: CVE-2023-53593
datasource_id: nvd_importer_v2/CVE-2023-53593
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53593
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  cifs: Release folio lock on fscache read hit.

  Under the current code, when cifs_readpage_worker is called, the call
  contract is that the callee should unlock the page. This is documented
  in the read_folio section of Documentation/filesystems/vfs.rst as:

  > The filesystem should unlock the folio once the read has completed,
  > whether it was successful or not.

  Without this change, when fscache is in use and cache hit occurs during
  a read, the page lock is leaked, producing the following stack on
  subsequent reads (via mmap) to the page:

  $ cat /proc/3890/task/12864/stack
  [<0>] folio_wait_bit_common+0x124/0x350
  [<0>] filemap_read_folio+0xad/0xf0
  [<0>] filemap_fault+0x8b1/0xab0
  [<0>] __do_fault+0x39/0x150
  [<0>] do_fault+0x25c/0x3e0
  [<0>] __handle_mm_fault+0x6ca/0xc70
  [<0>] handle_mm_fault+0xe9/0x350
  [<0>] do_user_addr_fault+0x225/0x6c0
  [<0>] exc_page_fault+0x84/0x1b0
  [<0>] asm_exc_page_fault+0x27/0x30

  This requires a reboot to resolve; it is a deadlock.

  Note however that the call to cifs_readpage_from_fscache does mark the
  page clean, but does not free the folio lock. This happens in
  __cifs_readpage_from_fscache on success. Releasing the lock at that
  point however is not appropriate as cifs_readahead also calls
  cifs_readpage_from_fscache and *does* unconditionally release the lock
  after its return. This change therefore effectively makes
  cifs_readpage_worker work like cifs_readahead.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53593
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/69513dd669e243928f7450893190915a88f84a2b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7a9fb689c1a1dc373887621a3bfa3810df0abde4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e725386d4262ef23ae51993f04602bc535b5be2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.17:rc8:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.17:rc8:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53593
    reference_type:
    reference_id: CVE-2023-53593
