advisory_id: CVE-2023-46247
datasource_id: nvd_importer_v2/CVE-2023-46247
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-46247
aliases: []
summary: Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine (EVM).
  Contracts containing large arrays might underallocate the number of slots they need by 1.
  Prior to v0.3.8, the calculation to determine how many slots a storage variable needed used
  `math.ceil(type_.size_in_bytes / 32)`. The intermediate floating point step can produce a
  rounding error if there are enough bits set in the IEEE-754 mantissa. Roughly speaking, if
  `type_.size_in_bytes` is large (> 2**46), and slightly less than a power of 2, the calculation
  can overestimate how many slots are needed by 1. If `type_.size_in_bytes` is slightly more
  than a power of 2, the calculation can underestimate how many slots are needed by 1. This
  issue is patched in version 0.3.8.
impacted_packages: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-46247
weaknesses:
  - CWE-682
  - CWE-193
references:
  - url: https://github.com/vyperlang/vyper/blob/6020b8bbf66b062d299d87bc7e4eddc4c9d1c157/vyper/semantics/validation/data_positions.py#L197
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/commit/0bb7203b584e771b23536ba065a6efda457161bb
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-6m97-7527-mh74
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*
    reference_type:
    reference_id: cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-46247
    reference_type:
    reference_id: CVE-2023-46247
