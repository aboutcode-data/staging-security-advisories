advisory_id: CVE-2025-37920
datasource_id: nvd_importer_v2/CVE-2025-37920
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-37920
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  xsk: Fix race condition in AF_XDP generic RX path

  Move rx_lock from xsk_socket to xsk_buff_pool.
  Fix synchronization for shared umem mode in
  generic RX path where multiple sockets share
  single xsk_buff_pool.

  RX queue is exclusive to xsk_socket, while FILL
  queue can be shared between multiple sockets.
  This could result in race condition where two
  CPU cores access RX path of two different sockets
  sharing the same umem.

  Protect both queues by acquiring spinlock in shared
  xsk_buff_pool.

  Lock contention may be minimized in the future by some
  per-thread FQ buffering.

  It's safe and necessary to move spin_lock_bh(rx_lock)
  after xsk_rcv_check():
  * xs->pool and spinlock_init is synchronized by
    xsk_bind() -> xsk_is_bound() memory barriers.
  * xsk_rcv_check() may return true at the moment
    of xsk_release() or xsk_unbind_dev(),
    however this will not cause any data races or
    race conditions. xsk_unbind_dev() removes xdp
    socket from all maps and waits for completion
    of all outstanding rx operations. Packets in
    RX path will either complete safely or drop.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-37920
weaknesses:
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/65d3c570614b892257dc58a1b202908242ecf8fd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/75a240a3e8abf17b9e00b0ef0492b1bbaa932251
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/975b372313dc018b9bd6cc0d85d188787054b19e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a1356ac7749cafc4e27aa62c0c4604b5dca4983e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b6978c565ce33658543c637060852434b4248d30
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37920
    reference_type:
    reference_id: CVE-2025-37920
