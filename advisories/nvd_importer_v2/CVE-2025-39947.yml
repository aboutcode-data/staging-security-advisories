advisory_id: CVE-2025-39947
datasource_id: nvd_importer_v2/CVE-2025-39947
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-39947
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/mlx5e: Harden uplink netdev access against device unbind

  The function mlx5_uplink_netdev_get() gets the uplink netdevice
  pointer from mdev->mlx5e_res.uplink_netdev. However, the netdevice can
  be removed and its pointer cleared when unbound from the mlx5_core.eth
  driver. This results in a NULL pointer, causing a kernel panic.

   BUG: unable to handle page fault for address: 0000000000001300
   at RIP: 0010:mlx5e_vport_rep_load+0x22a/0x270 [mlx5_core]
   Call Trace:
    <TASK>
    mlx5_esw_offloads_rep_load+0x68/0xe0 [mlx5_core]
    esw_offloads_enable+0x593/0x910 [mlx5_core]
    mlx5_eswitch_enable_locked+0x341/0x420 [mlx5_core]
    mlx5_devlink_eswitch_mode_set+0x17e/0x3a0 [mlx5_core]
    devlink_nl_eswitch_set_doit+0x60/0xd0
    genl_family_rcv_msg_doit+0xe0/0x130
    genl_rcv_msg+0x183/0x290
    netlink_rcv_skb+0x4b/0xf0
    genl_rcv+0x24/0x40
    netlink_unicast+0x255/0x380
    netlink_sendmsg+0x1f3/0x420
    __sock_sendmsg+0x38/0x60
    __sys_sendto+0x119/0x180
    do_syscall_64+0x53/0x1d0
    entry_SYSCALL_64_after_hwframe+0x4b/0x53

  Ensure the pointer is valid before use by checking it for NULL. If it
  is valid, immediately call netdev_hold() to take a reference, and
  preventing the netdevice from being freed while it is in use.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39947
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/2cb17c88edd3a1c7aa6bc880dcdb35a6866fcb2e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6b4be64fd9fec16418f365c2d8e47a7566e9eba5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8df354eb2dd63d111ed5ae2e956e0dbb22bcf93b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d1f3db4e7a3be29fc17f01850f162363f919370d
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39947
    reference_type:
    reference_id: CVE-2025-39947
