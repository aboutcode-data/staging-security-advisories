advisory_id: CVE-2022-49554
datasource_id: nvd_importer_v2/CVE-2022-49554
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49554
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  zsmalloc: fix races between asynchronous zspage free and page migration

  The asynchronous zspage free worker tries to lock a zspage's entire page
  list without defending against page migration.  Since pages which haven't
  yet been locked can concurrently migrate off the zspage page list while
  lock_zspage() churns away, lock_zspage() can suffer from a few different
  lethal races.

  It can lock a page which no longer belongs to the zspage and unsafely
  dereference page_private(), it can unsafely dereference a torn pointer to
  the next page (since there's a data race), and it can observe a spurious
  NULL pointer to the next page and thus not lock all of the zspage's pages
  (since a single page migration will reconstruct the entire page list, and
  create_page_chain() unconditionally zeroes out each list pointer in the
  process).

  Fix the races by using migrate_read_lock() in lock_zspage() to synchronize
  with page migration.
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49554
weaknesses:
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/2505a981114dcb715f8977b8433f7540854851d8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3674d8a8dadd03a447dd21069d4dacfc3399b63b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3ec459c8810e658401be428d3168eacfc380bdd0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/645996efc2ae391246d595832aaa6f9d3cc338c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8ba7b7c1dad1f6503c541778f31b33f7f62eb966
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c5402fb5f71f1a725f1e55d9c6799c0c7bec308f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fae05b2314b147a78fbed1dc4c645d9a66313758
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fc658c083904427abbf8f18280d517ee2668677c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49554
    reference_type:
    reference_id: CVE-2022-49554
