advisory_id: CVE-2025-38524
datasource_id: nvd_importer_v2/CVE-2025-38524
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38524
aliases: []
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nrxrpc: Fix\
  \ recv-recv race of completed call\n\nIf a call receives an event (such as incoming data),\
  \ the call gets placed\non the socket's queue and a thread in recvmsg can be awakened to go\
  \ and\nprocess it.  Once the thread has picked up the call off of the queue,\nfurther events\
  \ will cause it to be requeued, and once the socket lock is\ndropped (recvmsg uses call->user_mutex\
  \ to allow the socket to be used in\nparallel), a second thread can come in and its recvmsg\
  \ can pop the call off\nthe socket queue again.\n\nIn such a case, the first thread will be\
  \ receiving stuff from the call and\nthe second thread will be blocked on call->user_mutex.\
  \  The first thread\ncan, at this point, process both the event that it picked call for and\
  \ the\nevent that the second thread picked the call for and may see the call\nterminate -\
  \ in which case the call will be \"released\", decoupling the call\nfrom the user call ID\
  \ assigned to it (RXRPC_USER_CALL_ID in the control\nmessage).\n\nThe first thread will return\
  \ okay, but then the second thread will wake up\nholding the user_mutex and, if it sees that\
  \ the call has been released by\nthe first thread, it will BUG thusly:\n\n\tkernel BUG at\
  \ net/rxrpc/recvmsg.c:474!\n\nFix this by just dequeuing the call and ignoring it if it is\
  \ seen to be\nalready released.  We can't tell userspace about it anyway as the user call\n\
  ID has become stale."
impacted_packages: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38524
weaknesses:
  - CWE-362
references:
  - url: https://git.kernel.org/stable/c/6c75a97a32a5fa2060c3dd30207e63b6914b606d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7692bde890061797f3dece0148d7859e85c55778
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/839fe96c15209dc2255c064bb44b636efe04f032
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/962fb1f651c2cf2083e0c3ef53ba69e3b96d3fbc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.16:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.16:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38524
    reference_type:
    reference_id: CVE-2025-38524
