advisory_id: CVE-2024-56543
datasource_id: nvd_importer_v2/CVE-2024-56543
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-56543
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: ath12k: Skip Rx TID cleanup for self peer

  During peer create, dp setup for the peer is done where Rx TID is
  updated for all the TIDs. Peer object for self peer will not go through
  dp setup.

  When core halts, dp cleanup is done for all the peers. While cleanup,
  rx_tid::ab is accessed which causes below stack trace for self peer.

  WARNING: CPU: 6 PID: 12297 at drivers/net/wireless/ath/ath12k/dp_rx.c:851
  Call Trace:
  __warn+0x7b/0x1a0
  ath12k_dp_rx_frags_cleanup+0xd2/0xe0 [ath12k]
  report_bug+0x10b/0x200
  handle_bug+0x3f/0x70
  exc_invalid_op+0x13/0x60
  asm_exc_invalid_op+0x16/0x20
  ath12k_dp_rx_frags_cleanup+0xd2/0xe0 [ath12k]
  ath12k_dp_rx_frags_cleanup+0xca/0xe0 [ath12k]
  ath12k_dp_rx_peer_tid_cleanup+0x39/0xa0 [ath12k]
  ath12k_mac_peer_cleanup_all+0x61/0x100 [ath12k]
  ath12k_core_halt+0x3b/0x100 [ath12k]
  ath12k_core_reset+0x494/0x4c0 [ath12k]

  sta object in peer will be updated when remote peer is created. Hence
  use peer::sta to detect the self peer and skip the cleanup.

  Tested-on: QCN9274 hw2.0 PCI WLAN.WBE.1.0.1-00029-QCAHKSWPL_SILICONZ-1
  Tested-on: WCN7850 hw2.0 PCI WLAN.HMT.1.0.c5-00481-QCAHMTSWPL_V1.0_V2.0_SILICONZ-3
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56543
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1a0c640ce1cdcde3eb131a0c1e70ca1ed7cf27cb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a052483d495a4dc62c814f2fd17d0ceb308fc6a6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a1e2d6738b29c74c2024eb23167dfff68aadd984
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d73da0dd2853887b7aab71f0d572fd3314dafafe
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56543
    reference_type:
    reference_id: CVE-2024-56543
