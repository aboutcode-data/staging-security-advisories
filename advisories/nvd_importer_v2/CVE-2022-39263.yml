advisory_id: CVE-2022-39263
datasource_id: nvd_importer_v2/CVE-2022-39263
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-39263
aliases: []
summary: '`@next-auth/upstash-redis-adapter` is the Upstash Redis adapter for NextAuth.js, which
  provides authentication for Next.js. Applications that use `next-auth` Email Provider and
  `@next-auth/upstash-redis-adapter` before v3.0.2 are affected by this vulnerability. The Upstash
  Redis adapter implementation did not check for both the identifier (email) and the token,
  but only checking for the identifier when verifying the token in the email callback flow.
  An attacker who knows about the victim''s email could easily sign in as the victim, given
  the attacker also knows about the verification token''s expired duration. The vulnerability
  is patched in v3.0.2. A workaround is available. Using Advanced Initialization, developers
  can check the requests and compare the query''s token and identifier before proceeding.'
impacted_packages: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39263
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39263
weaknesses:
  - CWE-287
references:
  - url: https://github.com/nextauthjs/next-auth/commit/d16e04848ee703cf797724194d4ad2907fe125a9
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-4rxr-27mm-mxq9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39263
    reference_type:
    reference_id: CVE-2022-39263
