advisory_id: CVE-2021-37647
datasource_id: nvd_importer_v2/CVE-2021-37647
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-37647
aliases: []
summary: TensorFlow is an end-to-end open source platform for machine learning. When a user
  does not supply arguments that determine a valid sparse tensor, `tf.raw_ops.SparseTensorSliceDataset`
  implementation can be made to dereference a null pointer. The [implementation](https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/data/sparse_tensor_slice_dataset_op.cc#L240-L251)
  has some argument validation but fails to consider the case when either `indices` or `values`
  are provided for an empty sparse tensor when the other is not. If `indices` is empty, then
  [code that performs validation](https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/data/sparse_tensor_slice_dataset_op.cc#L260-L261)
  (i.e., checking that the indices are monotonically increasing) results in a null pointer dereference.
  If `indices` as provided by the user is empty, then `indices` in the C++ code above is backed
  by an empty `std::vector`, hence calling `indices->dim_size(0)` results in null pointer dereferencing
  (same as calling `std::vector::at()` on an empty vector). We have patched the issue in GitHub
  commit 02cc160e29d20631de3859c6653184e3f876b9d7. The fix will be included in TensorFlow 2.6.0.
  We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow
  2.3.4, as these are also affected and still in supported range.
impacted_packages: []
severities:
  - score: '2.1'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37647
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37647
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37647
weaknesses:
  - CWE-476
references:
  - url: https://github.com/tensorflow/tensorflow/commit/02cc160e29d20631de3859c6653184e3f876b9d7
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-c5x2-p679-95wc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37647
    reference_type:
    reference_id: CVE-2021-37647
