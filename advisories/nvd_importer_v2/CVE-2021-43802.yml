advisory_id: CVE-2021-43802
datasource_id: nvd_importer_v2/CVE-2021-43802
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-43802
aliases: []
summary: Etherpad is a real-time collaborative editor. In versions prior to 1.8.16, an attacker
  can craft an `*.etherpad` file that, when imported, might allow the attacker to gain admin
  privileges for the Etherpad instance. This, in turn, can be used to install a malicious Etherpad
  plugin that can execute arbitrary code (including system commands). To gain privileges, the
  attacker must be able to trigger deletion of `express-session` state or wait for old `express-session`
  state to be cleaned up. Core Etherpad does not delete any `express-session` state, so the
  only known attacks require either a plugin that can delete session state or a custom cleanup
  process (such as a cron job that deletes old `sessionstorage:*` records). The problem has
  been fixed in version 1.8.16. If users cannot upgrade to 1.8.16 or install patches manually,
  several workarounds are available. Users may configure their reverse proxies to reject requests
  to `/p/*/import`, which will block all imports, not just `*.etherpad` imports; limit all users
  to read-only access; and/or prevent the reuse of `express_sid` cookie values that refer to
  deleted express-session state. More detailed information and general mitigation strategies
  may be found in the GitHub Security Advisory.
impacted_packages: []
severities:
  - score: '9.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43802
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43802
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43802
weaknesses:
  - CWE-1287
  - CWE-20
  - CWE-790
references:
  - url: https://github.com/ether/etherpad-lite/compare/b7065eb9a0ec7c3c265f8cfeb2534efe6f036456...77bcb507b30e762e9375b0511b3763e0162aae53
    reference_type:
    reference_id:
  - url: https://github.com/ether/etherpad-lite/issues/5010
    reference_type:
    reference_id:
  - url: https://github.com/ether/etherpad-lite/releases/tag/1.8.16
    reference_type:
    reference_id:
  - url: https://github.com/ether/etherpad-lite/security/advisories/GHSA-w3g3-qf3g-2mqc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:etherpad:etherpad:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:etherpad:etherpad:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43802
    reference_type:
    reference_id: CVE-2021-43802
