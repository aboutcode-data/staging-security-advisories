advisory_id: CVE-2021-21368
datasource_id: nvd_importer_v2/CVE-2021-21368
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-21368
aliases: []
summary: msgpack5 is a msgpack v5 implementation for node.js and the browser. In msgpack5 before
  versions 3.6.1, 4.5.1, and 5.2.1 there is a "Prototype Poisoning" vulnerability. When msgpack5
  decodes a map containing a key "__proto__", it assigns the decoded value to __proto__. Object.prototype.__proto__
  is an accessor property for the receiver's prototype. If the value corresponding to the key
  __proto__ decodes to an object or null, msgpack5 sets the decoded object's prototype to that
  value. An attacker who can submit crafted MessagePack data to a service can use this to produce
  values that appear to be of other types; may have unexpected prototype properties and methods
  (for example length, numeric properties, and push et al if __proto__'s value decodes to an
  Array); and/or may throw unexpected exceptions when used (for example if the __proto__ value
  decodes to a Map or Date). Other unexpected behavior might be produced for other types. There
  is no effect on the global prototype. This "prototype poisoning" is sort of a very limited
  inversion of a prototype pollution attack. Only the decoded value's prototype is affected,
  and it can only be set to msgpack5 values (though if the victim makes use of custom codecs,
  anything could be a msgpack5 value). We have not found a way to escalate this to true prototype
  pollution (absent other bugs in the consumer's code). This has been fixed in msgpack5 version
  3.6.1, 4.5.1, and 5.2.1. See the referenced GitHub Security Advisory for an example and more
  details.
impacted_packages: []
severities:
  - score: '6.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21368
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21368
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21368
weaknesses:
  - CWE-1321
  - CWE-915
references:
  - url: https://github.com/mcollina/msgpack5/commit/d4e6cb956ae51c8bb2828e71c7c1107c340cf1e8
    reference_type:
    reference_id:
  - url: https://github.com/mcollina/msgpack5/releases/tag/v3.6.1
    reference_type:
    reference_id:
  - url: https://github.com/mcollina/msgpack5/releases/tag/v4.5.1
    reference_type:
    reference_id:
  - url: https://github.com/mcollina/msgpack5/releases/tag/v5.2.1
    reference_type:
    reference_id:
  - url: https://github.com/mcollina/msgpack5/security/advisories/GHSA-gmjw-49p4-pcfm
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/msgpack5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:msgpack5_project:msgpack5:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:msgpack5_project:msgpack5:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21368
    reference_type:
    reference_id: CVE-2021-21368
