advisory_id: CVE-2025-22021
datasource_id: nvd_importer_v2/CVE-2025-22021
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-22021
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: socket: Lookup orig tuple for IPv6 SNAT

  nf_sk_lookup_slow_v4 does the conntrack lookup for IPv4 packets to
  restore the original 5-tuple in case of SNAT, to be able to find the
  right socket (if any). Then socket_match() can correctly check whether
  the socket was transparent.

  However, the IPv6 counterpart (nf_sk_lookup_slow_v6) lacks this
  conntrack lookup, making xt_socket fail to match on the socket when the
  packet was SNATed. Add the same logic to nf_sk_lookup_slow_v6.

  IPv6 SNAT is used in Kubernetes clusters for pod-to-world packets, as
  pods' addresses are in the fd00::/8 ULA subnet and need to be replaced
  with the node's external address. Cilium leverages Envoy to enforce L7
  policies, and Envoy uses transparent sockets. Cilium inserts an iptables
  prerouting rule that matches on `-m socket --transparent` and redirects
  the packets to localhost, but it fails to match SNATed IPv6 packets due
  to that missing conntrack lookup.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-22021
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/1ca2169cc19dca893c7aae6af122852097435d16
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1ec43100f7123010730b7ddfc3d5c2eac19e70e7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/221c27259324ec1404f028d4f5a0f2ae7f63ee23
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2bb139e483f8cbe488d19d8c1135ac3615e2668c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/41904cbb343d115931d6bf79aa2c815cac4ef72b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5251041573850e5020cd447374e23010be698898
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/58ab63d3ded2ca6141357a2b24eee8453d0f871d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6488b96a79a26e19100ad872622f04e93b638d7f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/932b32ffd7604fb00b5c57e239a3cc4d901ccf6e
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22021
    reference_type:
    reference_id: CVE-2025-22021
