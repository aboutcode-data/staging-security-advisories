advisory_id: CVE-2021-41248
datasource_id: nvd_importer_v2/CVE-2021-41248
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-41248
aliases: []
summary: GraphiQL is the reference implementation of this monorepo, GraphQL IDE, an official
  project under the GraphQL Foundation. All versions of graphiql older than graphiql@1.4.7 are
  vulnerable to compromised HTTP schema introspection responses or schema prop values with malicious
  GraphQL type names, exposing a dynamic XSS attack surface that can allow code injection on
  operation autocomplete. In order for the attack to take place, the user must load a vulnerable
  schema in graphiql. There are a number of ways that can occur. By default, the schema URL
  is not attacker-controllable in graphiql or in its suggested implementations or examples,
  leaving only very complex attack vectors. If a custom implementation of graphiql's fetcher
  allows the schema URL to be set dynamically, such as a URL query parameter like ?endpoint=
  in graphql-playground, or a database provided value, then this custom graphiql implementation
  is vulnerable to phishing attacks, and thus much more readily available, low or no privelege
  level xss attacks. The URLs could look like any generic looking graphql schema URL. It should
  be noted that desktop clients such as Altair, Insomnia, Postwoman, do not appear to be impacted
  by this. This vulnerability does not impact codemirror-graphql, monaco-graphql or other dependents,
  as it exists in onHasCompletion.ts in graphiql. It does impact all forks of graphiql, and
  every released version of graphiql.
impacted_packages: []
severities:
  - score: '2.6'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:H/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41248
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41248
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41248
weaknesses:
  - CWE-79
references:
  - url: https://github.com/graphql/graphiql/commit/cb237eeeaf7333c4954c752122261db7520f7bf4
    reference_type:
    reference_id:
  - url: https://github.com/graphql/graphiql/security/advisories/GHSA-x4r7-m2q9-69c8
    reference_type:
    reference_id:
  - url: https://github.com/graphql/graphql-playground/security/advisories/GHSA-59r9-6jp6-jcm7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:graphql:graphiql:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:graphql:graphiql:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41248
    reference_type:
    reference_id: CVE-2021-41248
