advisory_id: CVE-2025-21831
datasource_id: nvd_importer_v2/CVE-2025-21831
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21831
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  PCI: Avoid putting some root ports into D3 on TUXEDO Sirius Gen1

  commit 9d26d3a8f1b0 ("PCI: Put PCIe ports into D3 during suspend") sets the
  policy that all PCIe ports are allowed to use D3.  When the system is
  suspended if the port is not power manageable by the platform and won't be
  used for wakeup via a PME this sets up the policy for these ports to go
  into D3hot.

  This policy generally makes sense from an OSPM perspective but it leads to
  problems with wakeup from suspend on the TUXEDO Sirius 16 Gen 1 with a
  specific old BIOS. This manifests as a system hang.

  On the affected Device + BIOS combination, add a quirk for the root port of
  the problematic controller to ensure that these root ports are not put into
  D3hot at suspend.

  This patch is based on

    https://lore.kernel.org/linux-pci/20230708214457.1229-2-mario.limonciello@amd.com

  but with the added condition both in the documentation and in the code to
  apply only to the TUXEDO Sirius 16 Gen 1 with a specific old BIOS and only
  the affected root ports.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21831
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/5ee3dd6e59b834e4d66e8b16fc684749ee40a257
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8852e056e297df1d8635ee7504e780d3184e45d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a78dfe50fffe6058afed2bb04c50c2c9a16664ee
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b1049f2d68693c80a576c4578d96774a68df2bad
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21831
    reference_type:
    reference_id: CVE-2025-21831
