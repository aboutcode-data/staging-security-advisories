advisory_id: CVE-2019-18421
datasource_id: nvd_importer_v2/CVE-2019-18421
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2019-18421
aliases: []
summary: 'An issue was discovered in Xen through 4.12.x allowing x86 PV guest OS users to gain
  host OS privileges by leveraging race conditions in pagetable promotion and demotion operations.
  There are issues with restartable PV type change operations. To avoid using shadow pagetables
  for PV guests, Xen exposes the actual hardware pagetables to the guest. In order to prevent
  the guest from modifying these page tables directly, Xen keeps track of how pages are used
  using a type system; pages must be "promoted" before being used as a pagetable, and "demoted"
  before being used for any other type. Xen also allows for "recursive" promotions: i.e., an
  operating system promoting a page to an L4 pagetable may end up causing pages to be promoted
  to L3s, which may in turn cause pages to be promoted to L2s, and so on. These operations may
  take an arbitrarily large amount of time, and so must be re-startable. Unfortunately, making
  recursive pagetable promotion and demotion operations restartable is incredibly complicated,
  and the code contains several races which, if triggered, can cause Xen to drop or retain extra
  type counts, potentially allowing guests to get write access to in-use pagetables. A malicious
  PV guest administrator may be able to escalate their privilege to that of the host. All x86
  systems with untrusted PV guests are vulnerable. HVM and PVH guests cannot exercise this vulnerability.'
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:H/Au:S/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-18421
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-18421
weaknesses:
  - CWE-362
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2019-11/msg00037.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2BQKX7M2RHCWDBKNPX4KEBI3MJIH6AYZ/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/I5WWPW4BSZDDW7VHU427XTVXV7ROOFFW/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/IZYATWNUGHRBG6I3TC24YHP5Y3J7I6KH/
    reference_type:
    reference_id:
  - url: https://seclists.org/bugtraq/2020/Jan/21
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202003-56
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2020/dsa-4602
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2019/10/31/3
    reference_type:
    reference_id:
  - url: http://xenbits.xen.org/xsa/advisory-299.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:29:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:29:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:30:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:30:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:31:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:31:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:opensuse:leap:15.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:opensuse:leap:15.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:xen:xen:*:*:*:*:*:*:x86:*
    reference_type:
    reference_id: cpe:2.3:o:xen:xen:*:*:*:*:*:*:x86:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-18421
    reference_type:
    reference_id: CVE-2019-18421
