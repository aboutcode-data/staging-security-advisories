advisory_id: CVE-2025-38293
datasource_id: nvd_importer_v2/CVE-2025-38293
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38293
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: ath11k: fix node corruption in ar->arvifs list

  In current WLAN recovery code flow, ath11k_core_halt() only
  reinitializes the "arvifs" list head. This will cause the
  list node immediately following the list head to become an
  invalid list node. Because the prev of that node still points
  to the list head "arvifs", but the next of the list head "arvifs"
  no longer points to that list node.

  When a WLAN recovery occurs during the execution of a vif
  removal, and it happens before the spin_lock_bh(&ar->data_lock)
  in ath11k_mac_op_remove_interface(), list_del() will detect the
  previously mentioned situation, thereby triggering a kernel panic.

  The fix is to remove and reinitialize all vif list nodes from the
  list head "arvifs" during WLAN halt. The reinitialization is to make
  the list nodes valid, ensuring that the list_del() in
  ath11k_mac_op_remove_interface() can execute normally.

  Call trace:
  __list_del_entry_valid_or_report+0xb8/0xd0
  ath11k_mac_op_remove_interface+0xb0/0x27c [ath11k]
  drv_remove_interface+0x48/0x194 [mac80211]
  ieee80211_do_stop+0x6e0/0x844 [mac80211]
  ieee80211_stop+0x44/0x17c [mac80211]
  __dev_close_many+0xac/0x150
  __dev_change_flags+0x194/0x234
  dev_change_flags+0x24/0x6c
  devinet_ioctl+0x3a0/0x670
  inet_ioctl+0x200/0x248
  sock_do_ioctl+0x60/0x118
  sock_ioctl+0x274/0x35c
  __arm64_sys_ioctl+0xac/0xf0
  invoke_syscall+0x48/0x114
  ...

  Tested-on: QCA6698AQ hw2.1 PCI WLAN.HSP.1.1-04591-QCAHSPSWPL_V1_V2_SILICONZ_IOE-1
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38293
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/31e98e277ae47f56632e4d663b1d4fd12ba33ea8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6c139015b597e570dd5962934e9f9a2f4cc8ef48
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6d6cb27fe146061f2512e904618f5e005bb7bb6a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b0974ed82e6ad5ff246fd90a5b14f3e7be4f2924
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f50ba7e7b607f2d00618799312e7fdb76a1ff48e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f5d77d0d41ea7a204d47288d0cf0404a52b5890e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f9507cf2dd0e1ed5028c0e8240da6fe5fd3110d3
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00008.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38293
    reference_type:
    reference_id: CVE-2025-38293
