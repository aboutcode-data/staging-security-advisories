advisory_id: CVE-2025-21724
datasource_id: nvd_importer_v2/CVE-2025-21724
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21724
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  iommufd/iova_bitmap: Fix shift-out-of-bounds in iova_bitmap_offset_to_index()

  Resolve a UBSAN shift-out-of-bounds issue in iova_bitmap_offset_to_index()
  where shifting the constant "1" (of type int) by bitmap->mapped.pgshift
  (an unsigned long value) could result in undefined behavior.

  The constant "1" defaults to a 32-bit "int", and when "pgshift" exceeds
  31 (e.g., pgshift = 63) the shift operation overflows, as the result
  cannot be represented in a 32-bit type.

  To resolve this, the constant is updated to "1UL", promoting it to an
  unsigned long type to match the operand's type.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21724
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/38ac76fc06bc6826a3e4b12a98efbe98432380a9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/44d9c94b7a3f29a3e07c4753603a35e9b28842a3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b1f8453b8ff1ab79a03820ef608256c499769cb6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d5d33f01b86af44b23eea61ee309e4ef22c0cdfe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e24c1551059268b37f6f40639883eafb281b8b9c
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/03/msg00028.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21724
    reference_type:
    reference_id: CVE-2025-21724
