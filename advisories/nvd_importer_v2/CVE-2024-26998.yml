advisory_id: CVE-2024-26998
datasource_id: nvd_importer_v2/CVE-2024-26998
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-26998
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  serial: core: Clearing the circular buffer before NULLifying it

  The circular buffer is NULLified in uart_tty_port_shutdown()
  under the spin lock. However, the PM or other timer based callbacks
  may still trigger after this event without knowning that buffer pointer
  is not valid. Since the serial code is a bit inconsistent in checking
  the buffer state (some rely on the head-tail positions, some on the
  buffer pointer), it's better to have both aligned, i.e. buffer pointer
  to be NULL and head-tail possitions to be the same, meaning it's empty.
  This will prevent asynchronous calls to dereference NULL pointer as
  reported recently in 8250 case:

    BUG: kernel NULL pointer dereference, address: 00000cf5
    Workqueue: pm pm_runtime_work
    EIP: serial8250_tx_chars (drivers/tty/serial/8250/8250_port.c:1809)
    ...
    ? serial8250_tx_chars (drivers/tty/serial/8250/8250_port.c:1809)
    __start_tx (drivers/tty/serial/8250/8250_port.c:1551)
    serial8250_start_tx (drivers/tty/serial/8250/8250_port.c:1654)
    serial_port_runtime_suspend (include/linux/serial_core.h:667 drivers/tty/serial/serial_port.c:63)
    __rpm_callback (drivers/base/power/runtime.c:393)
    ? serial_port_remove (drivers/tty/serial/serial_port.c:50)
    rpm_suspend (drivers/base/power/runtime.c:447)

  The proposed change will prevent ->start_tx() to be called during
  suspend on shut down port.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26998
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/7ae7104d54342433a3a73975f6569beefdd86350
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9cf7ea2eeb745213dc2a04103e426b960e807940
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bb1118905e875c111d7ccef9aee86ac5e4e7f985
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4EZ6PJW7VOZ224TD7N4JZNU6KV32ZJ53/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DAMSOZXJEPUOXW33WZYWCVAY7Z5S7OOY/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GCBZZEC7L7KTWWAS2NLJK6SO3IZIL4WW/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26998
    reference_type:
    reference_id: CVE-2024-26998
