advisory_id: CVE-2025-38718
datasource_id: nvd_importer_v2/CVE-2025-38718
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38718
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sctp: linearize cloned gso packets in sctp_rcv

  A cloned head skb still shares these frag skbs in fraglist with the
  original head skb. It's not safe to access these frag skbs.

  syzbot reported two use-of-uninitialized-memory bugs caused by this:

    BUG: KMSAN: uninit-value in sctp_inq_pop+0x15b7/0x1920 net/sctp/inqueue.c:211
     sctp_inq_pop+0x15b7/0x1920 net/sctp/inqueue.c:211
     sctp_assoc_bh_rcv+0x1a7/0xc50 net/sctp/associola.c:998
     sctp_inq_push+0x2ef/0x380 net/sctp/inqueue.c:88
     sctp_backlog_rcv+0x397/0xdb0 net/sctp/input.c:331
     sk_backlog_rcv+0x13b/0x420 include/net/sock.h:1122
     __release_sock+0x1da/0x330 net/core/sock.c:3106
     release_sock+0x6b/0x250 net/core/sock.c:3660
     sctp_wait_for_connect+0x487/0x820 net/sctp/socket.c:9360
     sctp_sendmsg_to_asoc+0x1ec1/0x1f00 net/sctp/socket.c:1885
     sctp_sendmsg+0x32b9/0x4a80 net/sctp/socket.c:2031
     inet_sendmsg+0x25a/0x280 net/ipv4/af_inet.c:851
     sock_sendmsg_nosec net/socket.c:718 [inline]

  and

    BUG: KMSAN: uninit-value in sctp_assoc_bh_rcv+0x34e/0xbc0 net/sctp/associola.c:987
     sctp_assoc_bh_rcv+0x34e/0xbc0 net/sctp/associola.c:987
     sctp_inq_push+0x2a3/0x350 net/sctp/inqueue.c:88
     sctp_backlog_rcv+0x3c7/0xda0 net/sctp/input.c:331
     sk_backlog_rcv+0x142/0x420 include/net/sock.h:1148
     __release_sock+0x1d3/0x330 net/core/sock.c:3213
     release_sock+0x6b/0x270 net/core/sock.c:3767
     sctp_wait_for_connect+0x458/0x820 net/sctp/socket.c:9367
     sctp_sendmsg_to_asoc+0x223a/0x2260 net/sctp/socket.c:1886
     sctp_sendmsg+0x3910/0x49f0 net/sctp/socket.c:2032
     inet_sendmsg+0x269/0x2a0 net/ipv4/af_inet.c:851
     sock_sendmsg_nosec net/socket.c:712 [inline]

  This patch fixes it by linearizing cloned gso packets in sctp_rcv().
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38718
weaknesses:
  - CWE-908
references:
  - url: https://git.kernel.org/stable/c/03d0cc6889e02420125510b5444b570f4bbf53d5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1bd5214ea681584c5886fea3ba03e49f93a43c0e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4506bcaabe004d07be8ff09116a3024fbd6aa965
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7d757f17bc2ef2727994ffa6d5d6e4bc4789a770
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cd0e92bb2b7542fb96397ffac639b4f5b099d0cb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d0194e391bb493aa6cec56d177b14df6b29188d5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ea094f38d387d1b0ded5dee4a3e5720aa4ce0139
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fc66772607101bd2030a4332b3bd0ea3b3605250
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fd60d8a086191fe33c2d719732d2482052fa6805
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00007.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38718
    reference_type:
    reference_id: CVE-2025-38718
