advisory_id: CVE-2024-5982
datasource_id: nvd_importer_v2/CVE-2024-5982
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-5982
aliases: []
summary: A path traversal vulnerability exists in the latest version of gaizhenbiao/chuanhuchatgpt.
  The vulnerability arises from unsanitized input handling in multiple features, including user
  upload, directory creation, and template loading. Specifically, the load_chat_history function
  in modules/models/base_model.py allows arbitrary file uploads, potentially leading to remote
  code execution (RCE). The get_history_names function in utils.py permits arbitrary directory
  creation. Additionally, the load_template function in utils.py can be exploited to leak the
  first column of CSV files. These issues stem from improper sanitization of user inputs concatenated
  with directory paths using os.path.join.
impacted_packages: []
severities:
  - score: '9.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-5982
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-5982
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-5982
weaknesses:
  - CWE-22
references:
  - url: https://github.com/gaizhenbiao/chuanhuchatgpt/commit/952fc8c3cbacead858311747cddd4bedcb4721d7
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/5d5c5356-e893-44d1-b5ca-642aa05d96bb
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:gaizhenbiao:chuanhuchatgpt:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:gaizhenbiao:chuanhuchatgpt:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-5982
    reference_type:
    reference_id: CVE-2024-5982
