advisory_id: CVE-2021-47203
datasource_id: nvd_importer_v2/CVE-2021-47203
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-47203
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: lpfc: Fix list_add() corruption in lpfc_drain_txq()

  When parsing the txq list in lpfc_drain_txq(), the driver attempts to pass
  the requests to the adapter. If such an attempt fails, a local "fail_msg"
  string is set and a log message output.  The job is then added to a
  completions list for cancellation.

  Processing of any further jobs from the txq list continues, but since
  "fail_msg" remains set, jobs are added to the completions list regardless
  of whether a wqe was passed to the adapter.  If successfully added to
  txcmplq, jobs are added to both lists resulting in list corruption.

  Fix by clearing the fail_msg string after adding a job to the completions
  list. This stops the subsequent jobs from being added to the completions
  list unless they had an appropriate failure.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47203
weaknesses:
  - CWE-787
references:
  - url: https://git.kernel.org/stable/c/16bcbfb56d759c25665f786e33ec633b9508a08f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/814d3610c4ce86e8cf285b2cdac0057a42e82de5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/99154581b05c8fb22607afb7c3d66c1bace6aa5d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ad4776b5eb2e58af1226847fcd3b4f6d051674dd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b291d147d0268e93ad866f8bc820ea14497abc9b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c097bd5a59162156d9c2077a2f58732ffbaa9fca
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ec70d80a8642900086447ba0cdc79e3f44d42e8f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f05a0191b90156e539cccc189b9d87ca2a4d9305
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47203
    reference_type:
    reference_id: CVE-2021-47203
