advisory_id: CVE-2024-21302
datasource_id: nvd_importer_v2/CVE-2024-21302
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-21302
aliases: []
summary: |
  Summary:
  As of July 8, 2025 Microsoft has completed mitigations to address this vulnerability. See KB5042562: Guidance for blocking rollback of virtualization-based security related updates and the Recommended Actions section of this CVE for guidance on how to protect your systems from this vulnerability.
  An elevation of privilege vulnerability exists in Windows based systems supporting Virtualization Based Security (VBS), including a subset of Azure Virtual Machine SKUS. This vulnerability enables an attacker with administrator privileges to replace current versions of Windows system files with outdated versions. By exploiting this vulnerability, an attacker could reintroduce previously mitigated vulnerabilities, circumvent some features of VBS, and exfiltrate data protected by VBS.
  Update: July 10, 2025
  Microsoft has addressed this vulnerability for Windows 10 1507, Windows 10, version 1607, Windows 10, version 1809, and Windows Server 2016 and Windows Server 2018. This ensures that mitigations are available to protect all supported versions of Windows 10 and Windows 11 from this vulnerability. See the available mitigations and deployment guidelines described in KB5042562: Guidance for blocking rollback of virtualization-based security related updates.
  Update: August 13, 2024
  Microsoft has released the August 2024 security updates that include an opt-in revocation policy mitigation to address this vulnerability. Customers running affected versions of Windows are encouraged to review KB5042562: Guidance for blocking rollback of virtualization-based security related updates to assess if this opt-in policy meets the needs of their environment before implementing this mitigation. There are risks associated with this mitigation that should be understood prior to applying it to your systems. Detailed information about these risks is also available in KB5042562.
  Details:
  A security researcher informed Microsoft of an elevation of privilege vulnerability in Windows 10, Windows 11, Windows Server 2016, and higher based systems including Azure Virtual Machines (VM) that support VBS. For more information on Windows versions and VM SKUs supporting VBS, reference: Virtualization-based Security (VBS) | Microsoft Learn.
  The vulnerability enables an attacker with administrator privileges on the target system to replace current Windows system files with outdated versions. Successful... See more at https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21302
impacted_packages: []
severities:
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-21302
weaknesses:
  - CWE-284
references:
  - url: https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21302
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:x64:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:x64:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:x86:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:x86:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:x64:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:x64:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:x86:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:x86:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_10_21h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_10_21h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_10_22h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_10_22h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_11_24h2:*:*:*:*:*:*:arm64:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_11_24h2:*:*:*:*:*:*:arm64:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_11_24h2:*:*:*:*:*:*:x64:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_11_24h2:*:*:*:*:*:*:x64:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_server_2016:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_server_2016:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_server_2022_23h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_server_2022_23h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-21302
    reference_type:
    reference_id: CVE-2024-21302
