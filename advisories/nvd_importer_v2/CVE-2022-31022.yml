advisory_id: CVE-2022-31022
datasource_id: nvd_importer_v2/CVE-2022-31022
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-31022
aliases: []
summary: "Bleve is a text indexing library for go. Bleve includes HTTP utilities under bleve/http\
  \ package, that are used by its sample application. These HTTP methods pave way for exploitation\
  \ of a node’s filesystem where the bleve index resides, if the user has used bleve’s own HTTP\
  \ (bleve/http) handlers for exposing the access to the indexes. For instance, the CreateIndexHandler\
  \ (`http/index_create.go`) and DeleteIndexHandler (`http/index_delete.go`) enable an attacker\
  \ to create a bleve index (directory structure) anywhere where the user running the server\
  \ has the write permissions and to delete recursively any directory owned by the same user\
  \ account. Users who have used the bleve/http package for exposing access to bleve index without\
  \ the explicit \nhandling for the Role Based Access Controls(RBAC) of the index assets would\
  \ be impacted by this issue. Version 2.5.0 relocated the `http/` dir used _only_ by bleve-explorer\
  \ to `blevesearch/bleve-explorer`, thereby addressing the issue. However, the http package\
  \ is purely intended to be used for demonstration purposes. Bleve was never designed handle\
  \ the RBACs, nor it was ever advertised to be used in that way. The collaborators of this\
  \ project have decided to stay away from adding any authentication or authorization to bleve\
  \ project at the moment. The bleve/http package is mainly for demonstration purposes and it\
  \ lacks exhaustive validation of the user inputs as well as any authentication and authorization\
  \ measures. It is recommended to not use bleve/http in production use cases."
impacted_packages: []
severities:
  - score: '2.1'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31022
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31022
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31022
weaknesses:
  - CWE-288
  - CWE-306
references:
  - url: https://github.com/blevesearch/bleve/commit/1c7509d6a17d36f265c90b4e8f4e3a3182fe79ff
    reference_type:
    reference_id:
  - url: https://github.com/blevesearch/bleve/commit/af9e3111dadfedf9d30f0448506b4a57fecc8550
    reference_type:
    reference_id:
  - url: https://github.com/blevesearch/bleve/security/advisories/GHSA-9w9f-6mg8-jp7w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:couchbase:bleve:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:couchbase:bleve:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31022
    reference_type:
    reference_id: CVE-2022-31022
