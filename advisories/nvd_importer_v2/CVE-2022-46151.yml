advisory_id: CVE-2022-46151
datasource_id: nvd_importer_v2/CVE-2022-46151
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-46151
aliases: []
summary: Querybook is an open source data querying UI. In affected versions user provided data
  is not escaped in the error field of the auth callback url in `querybook/server/app/auth/oauth_auth.py`
  and `querybook/server/app/auth/okta_auth.py`. This may allow attackers to perform reflected
  cross site scripting (XSS) if Content Security Policy (CSP) is not enabled or `unsafe-inline`
  is allowed. Users are advised to upgrade to the latest, patched version of querybook (version
  3.14.2 or greater). Users unable to upgrade may enable CSP and not allow unsafe-inline or
  manually escape query parameters in a reverse proxy.
impacted_packages: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-46151
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-46151
weaknesses:
  - CWE-79
references:
  - url: https://github.com/pinterest/querybook/commit/88a7f10495bf5ed1a556ade51a2f2794e403c063
    reference_type:
    reference_id:
  - url: https://github.com/pinterest/querybook/security/advisories/GHSA-mrrw-9wf7-xq6w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:pinterest:querybook:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:pinterest:querybook:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-46151
    reference_type:
    reference_id: CVE-2022-46151
