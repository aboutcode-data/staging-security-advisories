advisory_id: CVE-2023-53597
datasource_id: nvd_importer_v2/CVE-2023-53597
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53597
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  cifs: fix mid leak during reconnection after timeout threshold

  When the number of responses with status of STATUS_IO_TIMEOUT
  exceeds a specified threshold (NUM_STATUS_IO_TIMEOUT), we reconnect
  the connection. But we do not return the mid, or the credits
  returned for the mid, or reduce the number of in-flight requests.

  This bug could result in the server->in_flight count to go bad,
  and also cause a leak in the mids.

  This change moves the check to a few lines below where the
  response is decrypted, even of the response is read from the
  transform header. This way, the code for returning the mids
  can be reused.

  Also, the cifs_reconnect was reconnecting just the transport
  connection before. In case of multi-channel, this may not be
  what we want to do after several timeouts. Changed that to
  reconnect the session and the tree too.

  Also renamed NUM_STATUS_IO_TIMEOUT to a more appropriate name
  MAX_STATUS_IO_TIMEOUT.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53597
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/57d25e9905c71133e201f6d06b56a3403d4ad433
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/69cba9d3c1284e0838ae408830a02c4a063104bc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c55901d381a22300c9922170e59704059f50977b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/df31d05f0678cdd0796ea19983a2b93edca18bb0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.5:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.5:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53597
    reference_type:
    reference_id: CVE-2023-53597
