advisory_id: CVE-2022-49172
datasource_id: nvd_importer_v2/CVE-2022-49172
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49172
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  parisc: Fix non-access data TLB cache flush faults

  When a page is not present, we get non-access data TLB faults from
  the fdc and fic instructions in flush_user_dcache_range_asm and
  flush_user_icache_range_asm. When these occur, the cache line is
  not invalidated and potentially we get memory corruption. The
  problem was hidden by the nullification of the flush instructions.

  These faults also affect performance. With pa8800/pa8900 processors,
  there will be 32 faults per 4 KB page since the cache line is 128
  bytes.  There will be more faults with earlier processors.

  The problem is fixed by using flush_cache_pages(). It does the flush
  using a tmp alias mapping.

  The flush_cache_pages() call in flush_cache_range() flushed too
  large a range.

  V2: Remove unnecessary preempt_disable() and preempt_enable() calls.
impacted_packages: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49172
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/b3d6adb3a49d82e4e557c5fc16f50c9ff731da5d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ddca4b82027e2a66333dd40fab21a4beff435c7e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f839e5f1cef36ce268950c387129b1bfefdaebc9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49172
    reference_type:
    reference_id: CVE-2022-49172
