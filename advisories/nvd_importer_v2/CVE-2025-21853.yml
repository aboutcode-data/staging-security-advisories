advisory_id: CVE-2025-21853
datasource_id: nvd_importer_v2/CVE-2025-21853
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-21853
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: avoid holding freeze_mutex during mmap operation

  We use map->freeze_mutex to prevent races between map_freeze() and
  memory mapping BPF map contents with writable permissions. The way we
  naively do this means we'll hold freeze_mutex for entire duration of all
  the mm and VMA manipulations, which is completely unnecessary. This can
  potentially also lead to deadlocks, as reported by syzbot in [0].

  So, instead, hold freeze_mutex only during writeability checks, bump
  (proactively) "write active" count for the map, unlock the mutex and
  proceed with mmap logic. And only if something went wrong during mmap
  logic, then undo that "write active" counter increment.

    [0] https://lore.kernel.org/bpf/678dcbc9.050a0220.303755.0066.GAE@google.com/
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-21853
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/0d90d9e154144a3a80e9fc0eb9b21b7fc990f68f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/271e49f8a58edba65bc2b1250a0abaa98c4bfdbe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/29cfda62ab4d92ab94123813db49ab76c1e61b29
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2ce31c97c219b4fe797749f950274f246eb88c49
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4759acbd44d24a69b7b14848012ec4201d6c5501
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bc27c52eea189e8f7492d40739b7746d67b65beb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d95607a5f2f9bb08194c9deaf4a5f3e8ba59a9d4
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21853
    reference_type:
    reference_id: CVE-2025-21853
