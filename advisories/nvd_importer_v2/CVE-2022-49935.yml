advisory_id: CVE-2022-49935
datasource_id: nvd_importer_v2/CVE-2022-49935
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49935
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dma-buf/dma-resv: check if the new fence is really later

  Previously when we added a fence to a dma_resv object we always
  assumed the the newer than all the existing fences.

  With Jason's work to add an UAPI to explicit export/import that's not
  necessary the case any more. So without this check we would allow
  userspace to force the kernel into an use after free error.

  Since the change is very small and defensive it's probably a good
  idea to backport this to stable kernels as well just in case others
  are using the dma_resv object in the same way.
impacted_packages: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49935
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/a3f7c10a269d5b77dd5822ade822643ced3057f0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c4c798fe98adceb642050819cb57cbc8f5c27870
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49935
    reference_type:
    reference_id: CVE-2022-49935
