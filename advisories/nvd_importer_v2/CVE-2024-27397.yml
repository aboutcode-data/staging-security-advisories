advisory_id: CVE-2024-27397
datasource_id: nvd_importer_v2/CVE-2024-27397
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2024-27397
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: nf_tables: use timestamp to check for set element timeout

  Add a timestamp field at the beginning of the transaction, store it
  in the nftables per-netns area.

  Update set backend .insert, .deactivate and sync gc path to use the
  timestamp, this avoids that an element expires while control plane
  transaction is still unfinished.

  .lookup and .update, which are used from packet path, still use the
  current time to check if the element has expired. And .get path and dump
  also since this runs lockless under rcu read size lock. Then, there is
  async gc which also needs to check the current time since it runs
  asynchronously from a workqueue.
impacted_packages: []
severities:
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-27397
weaknesses:
  - CWE-416
references:
  - url: https://git.kernel.org/stable/c/0d40e8cb1d1f56a994cdd2e015af622fdca9ed4d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/383182db8d58c4237772ba0764cded4938a235c3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7395dfacfff65e9938ac0889dafa1ab01e987d15
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b17de2a71e56c10335b565cc7ad238e6d984379
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7fa2e2960fff8322ce2ded57b5f8e9cbc450b967
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b45176b869673417ace338b87cf9cdb66e2eeb01
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eaf1a29ea5d7dba8e84e9e9f3b3f47d0cd540bfe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f8dfda798650241c1692058713ca4fef8e429061
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/10/msg00003.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/01/msg00001.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-27397
    reference_type:
    reference_id: CVE-2024-27397
