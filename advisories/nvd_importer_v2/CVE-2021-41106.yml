advisory_id: CVE-2021-41106
datasource_id: nvd_importer_v2/CVE-2021-41106
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-41106
aliases: []
summary: JWT is a library to work with JSON Web Token and JSON Web Signature. Prior to versions
  3.4.6, 4.0.4, and 4.1.5, users of HMAC-based algorithms (HS256, HS384, and HS512) combined
  with `Lcobucci\JWT\Signer\Key\LocalFileReference` as key are having their tokens issued/validated
  using the file path as hashing key - instead of the contents. The HMAC hashing functions take
  any string as input and, since users can issue and validate tokens, users are lead to believe
  that everything works properly. Versions 3.4.6, 4.0.4, and 4.1.5 have been patched to always
  load the file contents, deprecated the `Lcobucci\JWT\Signer\Key\LocalFileReference`, and suggest
  `Lcobucci\JWT\Signer\Key\InMemory` as the alternative. As a workaround, use `Lcobucci\JWT\Signer\Key\InMemory`
  instead of `Lcobucci\JWT\Signer\Key\LocalFileReference` to create the instances of one's keys.
impacted_packages: []
severities:
  - score: '2.1'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41106
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41106
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41106
weaknesses:
  - CWE-345
references:
  - url: https://github.com/lcobucci/jwt/commit/8175de5b841fbe3fd97d2d49b3fc15c4ecb39a73
    reference_type:
    reference_id:
  - url: https://github.com/lcobucci/jwt/commit/c45bb8b961a8e742d8f6b88ef5ff1bd5cca5d01c
    reference_type:
    reference_id:
  - url: https://github.com/lcobucci/jwt/security/advisories/GHSA-7322-jrq4-x5hf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:lcobucci:jwt:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:lcobucci:jwt:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41106
    reference_type:
    reference_id: CVE-2021-41106
