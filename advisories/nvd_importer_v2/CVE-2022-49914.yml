advisory_id: CVE-2022-49914
datasource_id: nvd_importer_v2/CVE-2022-49914
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-49914
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  btrfs: fix inode list leak during backref walking at resolve_indirect_refs()

  During backref walking, at resolve_indirect_refs(), if we get an error
  we jump to the 'out' label and call ulist_free() on the 'parents' ulist,
  which frees all the elements in the ulist - however that does not free
  any inode lists that may be attached to elements, through the 'aux' field
  of a ulist node, so we end up leaking lists if we have any attached to
  the unodes.

  Fix this by calling free_leaf_list() instead of ulist_free() when we exit
  from resolve_indirect_refs(). The static function free_leaf_list() is
  moved up for this to be possible and it's slightly simplified by removing
  unnecessary code.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49914
weaknesses:
  - CWE-401
references:
  - url: https://git.kernel.org/stable/c/2c0329406bb28109c07c6e23e5e3e0fa618a95d7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/396515db923ad5cbeb179d6b88927870b4cbebb7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5614dc3a47e3310fbc77ea3b67eaadd1c6417bf1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6ba3479f9e96b9ad460c7e77abc26dd16e5dec4f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a52e24c7fcc3c5ce3588a14e3663c00868d36623
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b1dc9019bb5f89abae85645de1a2dd4830c1f8e9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cded2c89774b99b67c98147ae103ea878c92a206
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49914
    reference_type:
    reference_id: CVE-2022-49914
