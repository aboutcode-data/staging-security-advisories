advisory_id: CVE-2025-38049
datasource_id: nvd_importer_v2/CVE-2025-38049
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-38049
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/resctrl: Fix allocation of cleanest CLOSID on platforms with no monitors

  Commit

    6eac36bb9eb0 ("x86/resctrl: Allocate the cleanest CLOSID by searching closid_num_dirty_rmid")

  added logic that causes resctrl to search for the CLOSID with the fewest dirty
  cache lines when creating a new control group, if requested by the arch code.
  This depends on the values read from the llc_occupancy counters. The logic is
  applicable to architectures where the CLOSID effectively forms part of the
  monitoring identifier and so do not allow complete freedom to choose an unused
  monitoring identifier for a given CLOSID.

  This support missed that some platforms may not have these counters.  This
  causes a NULL pointer dereference when creating a new control group as the
  array was not allocated by dom_data_init().

  As this feature isn't necessary on platforms that don't have cache occupancy
  monitors, add this to the check that occurs when a new control group is
  allocated.
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-38049
weaknesses:
  - CWE-476
references:
  - url: https://git.kernel.org/stable/c/93a418fc61da13d1ee4047d4d1327990f7a2816a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a121798ae669351ec0697c94f71c3a692b2a755b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a8a1bcc27d4607227088d80483164289b5348293
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ed5addb55e403ad6598102bcf546e068ae01fef6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38049
    reference_type:
    reference_id: CVE-2025-38049
