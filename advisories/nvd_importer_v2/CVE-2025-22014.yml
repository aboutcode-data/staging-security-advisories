advisory_id: CVE-2025-22014
datasource_id: nvd_importer_v2/CVE-2025-22014
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-22014
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  soc: qcom: pdr: Fix the potential deadlock

  When some client process A call pdr_add_lookup() to add the look up for
  the service and does schedule locator work, later a process B got a new
  server packet indicating locator is up and call pdr_locator_new_server()
  which eventually sets pdr->locator_init_complete to true which process A
  sees and takes list lock and queries domain list but it will timeout due
  to deadlock as the response will queued to the same qmi->wq and it is
  ordered workqueue and process B is not able to complete new server
  request work due to deadlock on list lock.

  Fix it by removing the unnecessary list iteration as the list iteration
  is already being done inside locator work, so avoid it here and just
  call schedule_work() here.

         Process A                        Process B

                                       process_scheduled_works()
  pdr_add_lookup()                      qmi_data_ready_work()
   process_scheduled_works()             pdr_locator_new_server()
                                           pdr->locator_init_complete=true;
     pdr_locator_work()
      mutex_lock(&pdr->list_lock);

       pdr_locate_service()                  mutex_lock(&pdr->list_lock);

        pdr_get_domain_list()
         pr_err("PDR: %s get domain list
                 txn wait failed: %d\n",
                 req->service_name,
                 ret);

  Timeout error log due to deadlock:

  "
   PDR: tms/servreg get domain list txn wait failed: -110
   PDR: service lookup for msm/adsp/sensor_pd:tms/servreg failed: -110
  "

  Thanks to Bjorn and Johan for letting me know that this commit also fixes
  an audio regression when using the in-kernel pd-mapper as that makes it
  easier to hit this race. [1]
impacted_packages: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-22014
weaknesses:
  - CWE-667
references:
  - url: https://git.kernel.org/stable/c/02612f1e4c34d94d6c8ee75bf7d254ed697e22d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0a566a79aca9851fae140536e0fc5b0853c90a90
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2eeb03ad9f42dfece63051be2400af487ddb96d2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/72a222b6af10c2a05a5fad0029246229ed8912c2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/daba84612236de3ab39083e62c9e326a654ebd20
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f2bbfd50e95bc117360f0f59e629aa03d821ebd6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f4489260f5713c94e1966e5f20445bff262876f4
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/05/msg00045.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22014
    reference_type:
    reference_id: CVE-2025-22014
