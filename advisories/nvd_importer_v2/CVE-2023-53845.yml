advisory_id: CVE-2023-53845
datasource_id: nvd_importer_v2/CVE-2023-53845
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2023-53845
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nilfs2: fix infinite loop in nilfs_mdt_get_block()

  If the disk image that nilfs2 mounts is corrupted and a virtual block
  address obtained by block lookup for a metadata file is invalid,
  nilfs_bmap_lookup_at_level() may return the same internal return code as
  -ENOENT, meaning the block does not exist in the metadata file.

  This duplication of return codes confuses nilfs_mdt_get_block(), causing
  it to read and create a metadata block indefinitely.

  In particular, if this happens to the inode metadata file, ifile,
  semaphore i_rwsem can be left held, causing task hangs in lock_mount.

  Fix this issue by making nilfs_bmap_lookup_at_level() treat virtual block
  address translation failures with -ENOENT as metadata corruption instead
  of returning the error code.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/25457d07c8146e57d28906c663def033dc425af6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/34c5f17222b50c79848bb03ec8811648813e6a45
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5b29661669cb65b9750a3cf70ed3eaf947b92167
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8a89d36a07afe1ed4564df51fefa2bb556c85412
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8d07d9119642ba43d21f8ba64d51d01931096b20
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a6a491c048882e7e424d407d32cba0b52d9ef2bf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cfb0bb4fbd40c1f06da7e9f88c0a2d46155b90c2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d536f9976bb04e9c84cf80045a9355975e418f41
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fe1cbbcb1a2532ee1654e1ff121be8906d83c6f0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53845
    reference_type:
    reference_id: CVE-2023-53845
