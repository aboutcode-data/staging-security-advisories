advisory_id: CVE-2022-31186
datasource_id: nvd_importer_v2/CVE-2022-31186
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2022-31186
aliases: []
summary: 'NextAuth.js is a complete open source authentication solution for Next.js applications.
  An information disclosure vulnerability in `next-auth` before `v4.10.2` and `v3.29.9` allows
  an attacker with log access privilege to obtain excessive information such as an identity
  provider''s secret in the log (which is thrown during OAuth error handling) and use it to
  leverage further attacks on the system, like impersonating the client to ask for extensive
  permissions. This issue has been patched in `v4.10.2` and `v3.29.9` by moving the log for
  `provider` information to the debug level. In addition, we added a warning for having the
  `debug: true` option turned on in production. If for some reason you cannot upgrade, you can
  user the `logger` configuration option by sanitizing the logs.'
impacted_packages: []
severities:
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31186
weaknesses:
  - CWE-532
references:
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-p6mm-27gq-9v3p
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/options#logger
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/getting-started/upgrade-v4
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/warnings#debug_enabled
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:next-auth:nextauth.js:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:next-auth:nextauth.js:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31186
    reference_type:
    reference_id: CVE-2022-31186
