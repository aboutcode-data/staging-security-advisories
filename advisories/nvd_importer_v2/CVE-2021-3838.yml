advisory_id: CVE-2021-3838
datasource_id: nvd_importer_v2/CVE-2021-3838
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2021-3838
aliases: []
summary: DomPDF before version 2.0.0 is vulnerable to PHAR deserialization due to a lack of
  checking on the protocol before passing it into the file_get_contents() function. An attacker
  who can upload files of any type to the server can pass in the phar:// protocol to unserialize
  the uploaded file and instantiate arbitrary PHP objects. This can lead to remote code execution,
  especially when DOMPdf is used with frameworks with documented POP chains like Laravel or
  vulnerable developer code.
impacted_packages: []
severities:
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3838
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3838
weaknesses:
  - CWE-502
references:
  - url: https://github.com/dompdf/dompdf/commit/99aeec1efec9213e87098d42eb09439e7ee0bb6a
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:dompdf_project:dompdf:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:dompdf_project:dompdf:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3838
    reference_type:
    reference_id: CVE-2021-3838
