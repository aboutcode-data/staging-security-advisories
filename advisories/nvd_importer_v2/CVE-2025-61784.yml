advisory_id: CVE-2025-61784
datasource_id: nvd_importer_v2/CVE-2025-61784
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-61784
aliases: []
summary: LLaMA-Factory is a tuning library for large language models. Prior to version 0.9.4,
  a Server-Side Request Forgery (SSRF) vulnerability in the chat API allows any authenticated
  user to force the server to make arbitrary HTTP requests to internal and external networks.
  This can lead to the exposure of sensitive internal services, reconnaissance of the internal
  network, or interaction with third-party services. The same mechanism also allows for a Local
  File Inclusion (LFI) vulnerability, enabling users to read arbitrary files from the server's
  filesystem. The vulnerability exists in the `_process_request` function within `src/llamafactory/api/chat.py.`
  This function is responsible for processing incoming multimodal content, including images,
  videos, and audio provided via URLs. The function checks if the provided URL is a base64 data
  URI or a local file path (`os.path.isfile`). If neither is true, it falls back to treating
  the URL as a web URI and makes a direct HTTP GET request using `requests.get(url, stream=True).raw`
  without any validation or sanitization of the URL. Version 0.9.4 fixes the underlying issue.
impacted_packages: []
severities:
  - score: '7.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-61784
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-61784
weaknesses:
  - CWE-918
  - CWE-22
references:
  - url: https://github.com/hiyouga/LLaMA-Factory/commit/95b7188090a1018935c9dc072bfc97f24f1c96e9
    reference_type:
    reference_id:
  - url: https://github.com/hiyouga/LLaMA-Factory/security/advisories/GHSA-527m-2xhr-j27g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-61784
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:hiyouga:llama-factory:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:hiyouga:llama-factory:*:*:*:*:*:*:*:*
