advisory_id: CVE-2025-40255
datasource_id: nvd_importer_v2/CVE-2025-40255
datasource_url: https://nvd.nist.gov/vuln/detail/CVE-2025-40255
aliases: []
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: core: prevent NULL deref in generic_hwtstamp_ioctl_lower()

  The ethtool tsconfig Netlink path can trigger a null pointer
  dereference. A call chain such as:

    tsconfig_prepare_data() ->
    dev_get_hwtstamp_phylib() ->
    vlan_hwtstamp_get() ->
    generic_hwtstamp_get_lower() ->
    generic_hwtstamp_ioctl_lower()

  results in generic_hwtstamp_ioctl_lower() being called with
  kernel_cfg->ifr as NULL.

  The generic_hwtstamp_ioctl_lower() function does not expect
  a NULL ifr and dereferences it, leading to a system crash.

  Fix this by adding a NULL check for kernel_cfg->ifr in
  generic_hwtstamp_ioctl_lower(). If ifr is NULL, return -EINVAL.
impacted_packages: []
severities: []
weaknesses: []
references:
  - url: https://git.kernel.org/stable/c/8817f816ae41908e9625c0770c4af0dcdcc01238
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f796a8dec9beafcc0f6f0d3478ed685a15c5e062
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-40255
    reference_type:
    reference_id: CVE-2025-40255
