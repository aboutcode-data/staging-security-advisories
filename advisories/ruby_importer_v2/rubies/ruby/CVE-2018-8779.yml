advisory_id: rubies/ruby/CVE-2018-8779
datasource_id: ruby_importer_v2/rubies/ruby/CVE-2018-8779
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/rubies/ruby/CVE-2018-8779.yml
aliases:
  - CVE-2018-8779
summary: |
  Unintentional socket creation by poisoned NUL byte in UNIXServer and UNIXSocket
  There is a unintentional socket creation vulnerability in `UNIXServer.open`
  method of socket library bundled with Ruby. And there is also a unintentional
  socket access vulnerability in `UNIXSocket.open` method.

  `UNIXServer.open` accepts the path of the socket to be created at the first
  parameter. If the path contains NUL (`\0`) bytes, this method recognize that
  the path is completed before the NUL bytes. So, if a script accepts an external
  input as the argument of this method, the attacker can make the socket file in
  the unintentional path. And, `UNIXSocket.open` also accepts the path of the
  socket to be created at the first parameter without checking NUL bytes like
  `UNIXServer.open`. So, if a script accepts an external input as the argument of
  this method, the attacker can accepts the socket file in the unintentional
  path.

  All users running an affected release should upgrade immediately.
impacted_packages:
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.2.10|<2.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.3.7|<2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.4.4|<2.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.5.1|<2.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>2.6.0-preview1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://www.ruby-lang.org/en/news/2018/03/28/poisoned-nul-byte-unixsocket-cve-2018-8779/
    reference_type:
    reference_id:
