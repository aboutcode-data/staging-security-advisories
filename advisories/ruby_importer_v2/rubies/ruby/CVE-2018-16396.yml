advisory_id: rubies/ruby/CVE-2018-16396
datasource_id: ruby_importer_v2/rubies/ruby/CVE-2018-16396
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/rubies/ruby/CVE-2018-16396.yml
aliases:
  - CVE-2018-16396
  - GHSA-xh4x-ph6p-vmxh
summary: |
  Tainted flags not always propogated in Array#pack and String#unpack
  In `Array#pack` and `String#unpack` with some formats, the tainted flags of
  the original data are not propagated to the returned string/array.

  `Array#pack` method converts the receiverâ€™s contents into a string with
  specified format. If the receiver contains some tainted objects, the
  returned string also should be tainted. `String#unpack` method which
  converts the receiver into an array also should propagate its tainted flag
  to the objects contained in the returned array. But, with `B`, `b`, `H` and
  `h` directives, the tainted flags are not propagated. So, if a script
  processes unreliable inputs by `Array#pack` and/or `String#unpack` with these
  directives and checks the reliability with tainted flags, the check might be
  wrong.

  All users running an affected release should upgrade immediately.
impacted_packages:
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.3.8|<2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.4.5|<2.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.5.2|<2.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.6.0-preview3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.0'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://www.ruby-lang.org/en/news/2018/10/17/not-propagated-taint-flag-in-some-formats-of-pack-cve-2018-16396/
    reference_type:
    reference_id:
