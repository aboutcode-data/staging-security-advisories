advisory_id: rubies/ruby/CVE-2019-16255
datasource_id: ruby_importer_v2/rubies/ruby/CVE-2019-16255
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/rubies/ruby/CVE-2019-16255.yml
aliases:
  - CVE-2019-16255
  - GHSA-ph7w-p94x-9vvw
summary: |
  A code injection vulnerability of Shell#[] and Shell#test
  Shell#[] and its alias Shell#test defined in lib/shell.rb allow code
  injection if the first argument (aka the “command” argument) is untrusted
  data. An attacker can exploit this to call an arbitrary Ruby method.

  Note that passing untrusted data to methods of Shell is dangerous in general.
  Users must never do it. However, we treat this particular case as a
  vulnerability because the purpose of Shell#[] and Shell#[] is considered file
  testing.
impacted_packages:
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.4.8|<2.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.5.7|<2.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.6.5|<2.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>2.7.0-preview1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-16255
    reference_type:
    reference_id: CVE-2019-16255
