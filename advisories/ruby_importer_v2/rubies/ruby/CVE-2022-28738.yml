advisory_id: rubies/ruby/CVE-2022-28738
datasource_id: ruby_importer_v2/rubies/ruby/CVE-2022-28738
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/rubies/ruby/CVE-2022-28738.yml
aliases:
  - CVE-2022-28738
  - GHSA-8pqg-8p79-j5j8
summary: |
  Double free in Regexp compilation
  A double-free vulnerability is discovered in Regexp compilation. This
  vulnerability has been assigned the CVE identifier CVE-2022-28738.
  We strongly recommend upgrading Ruby.

  Due to a bug in the Regexp compilation process, creating a Regexp
  object with a crafted source string could cause the same memory to
  be freed twice. This is known as a “double free” vulnerability. Note
  that, in general, it is considered unsafe to create and use a Regexp
  object generated from untrusted input. In this case, however,
  following a comprehensive assessment, we treat this issue as a vulnerability.

  Please update Ruby to 3.0.4 or 3.1.2.
impacted_packages:
  - purl: pkg:ruby/ruby
    affected_versions: vers:gem/<2.6.0|>=2.7
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions: vers:gem/<2.7.0|>=2.8
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=3.0.4|<3.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=3.1.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://www.ruby-lang.org/en/news/2022/04/12/double-free-in-regexp-compilation-cve-2022-28738/
    reference_type:
    reference_id:
