advisory_id: rubies/ruby/CVE-2016-2339
datasource_id: ruby_importer_v2/rubies/ruby/CVE-2016-2339
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/rubies/ruby/CVE-2016-2339.yml
aliases:
  - CVE-2016-2339
  - GHSA-c4w7-m676-pcvp
summary: |
  Ruby 2.1 has exploitable heap overflow vulnerability
  An exploitable heap overflow vulnerability exists in the
  Fiddle::Function.new "initialize" function functionality of
  Ruby. In Fiddle::Function.new "initialize" heap buffer
  "arg_types" allocation is made based on args array length.
  Specially constructed object passed as element of args array
  can increase this array size after mentioned allocation and
  cause heap overflow.

  Versions affected:
    - Ruby "2.0.0-p648, 2.1.0-p0 through 2.1.9, and 2.2.0 through 2.2.5."
      - NOTE: Unclear where the patches where applied.
    - "Fix was introduced in Ruby 2.1.9, with related packages like
       ruby2.1 updated to version 2.1.9-19.3.2 or newer"
impacted_packages:
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.1.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2016-2339
    reference_type:
    reference_id: CVE-2016-2339
