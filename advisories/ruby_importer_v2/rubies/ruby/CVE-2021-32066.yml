advisory_id: rubies/ruby/CVE-2021-32066
datasource_id: ruby_importer_v2/rubies/ruby/CVE-2021-32066
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/rubies/ruby/CVE-2021-32066.yml
aliases:
  - CVE-2021-32066
  - GHSA-gx49-h5r3-q3xj
summary: |
  imap - StartTLS stripping attack
  An issue was discovered in Ruby through
  2.6.7, 2.7.x through 2.7.3, and 3.x through 3.0.1.
  Net::IMAP does not raise an exception when StartTLS fails with
  an an unknown response, which might allow man-in-the-middle
  attackers to bypass the TLS protections by leveraging a network
  position between the client and the registry to block the
  StartTLS command, aka a "StartTLS stripping attack."
impacted_packages:
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.6.8|<2.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.7.4|<2.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=3.0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.8'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '7.4'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32066
    reference_type:
    reference_id: CVE-2021-32066
