advisory_id: rubies/ruby/CVE-2018-6914
datasource_id: ruby_importer_v2/rubies/ruby/CVE-2018-6914
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/rubies/ruby/CVE-2018-6914.yml
aliases:
  - CVE-2018-6914
  - GHSA-wpg3-wgm5-rv8w
summary: |
  Unintentional file and directory creation with directory traversal in tempfile and tmpdir
  There is an unintentional directory creation vulnerability in tmpdir library
  bundled with Ruby. And there is also an unintentional file creation
  vulnerability in tempfile library bundled with Ruby, because it uses tmpdir
  internally

  `Dir.mktmpdir` method introduced by tmpdir library accepts the prefix and the
  suffix of the directory which is created as the first parameter. The prefix can
  contain relative directory specifiers `../`, so this method can be used to
  target any directory. So, if a script accepts an external input as the prefix,
  and the targeted directory has inappropriate permissions or the ruby process
  has inappropriate privileges, the attacker can create a directory or a file at
  any directory.

  All users running an affected release should upgrade immediately.
impacted_packages:
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.2.10|<2.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.3.7|<2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.4.4|<2.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>=2.5.1|<2.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:ruby/ruby
    affected_versions:
    fixed_versions: vers:gem/>2.6.0-preview1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://www.ruby-lang.org/en/news/2018/03/28/unintentional-file-and-directory-creation-with-directory-traversal-cve-2018-6914/
    reference_type:
    reference_id:
