advisory_id: gems/carrierwave/CVE-2021-21288
datasource_id: ruby_importer_v2/gems/carrierwave/CVE-2021-21288
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/carrierwave/CVE-2021-21288.yml
aliases:
  - CVE-2021-21288
  - GHSA-fwcm-636p-68r5
summary: |
  Server-side request forgery in CarrierWave
  ### Impact
  [CarrierWave download feature](https://github.com/carrierwaveuploader/carrierwave#uploading-files-from-a-remote-location
  has an SSRF vulnerability, allowing attacks to provide DNS entries or IP addresses that are intended for internal use
  and gather information about the Intranet infrastructure of the platform.

  ### Patches
  Upgrade to [2.1.1](https://rubygems.org/gems/carrierwave/versions/2.1.1) or
  [1.3.2](https://rubygems.org/gems/carrierwave/versions/1.3.2).

  ### Workarounds
  Using proper network segmentation and applying the principle of least privilege to outbound connections from application
  servers can reduce the severity of SSRF vulnerabilities. Ideally the vulnerable gem should run on an isolated server
  without access to any internal network resources or cloud metadata access.
impacted_packages:
  - purl: pkg:gem/carrierwave
    affected_versions:
    fixed_versions: vers:gem/>=1.3.2|<1.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/carrierwave
    affected_versions:
    fixed_versions: vers:gem/>=2.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/carrierwaveuploader/carrierwave/security/advisories/GHSA-fwcm-636p-68r5
    reference_type:
    reference_id:
