advisory_id: gems/sha3/CVE-2022-37454
datasource_id: ruby_importer_v2/gems/sha3/CVE-2022-37454
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sha3/CVE-2022-37454.yml
aliases:
  - CVE-2022-37454
  - GHSA-6w4m-2xhg-2658
summary: |
  Buffer overflow in sponge queue functions
  Impact
    The Keccak sponge function interface accepts partial inputs to be
    absorbed and partial outputs to be squeezed. A buffer can overflow
    when partial data with some specific sizes are queued, where at
    least one of them has a length of 2^32 - 200 bytes or more.
  Patches
    Yes, see commit [fdc6fef0](https://github.com/XKCP/XKCP/commit/fdc6fef075f4e81d6b1bc38364248975e08e340a).
  Workarounds
    The problem can be avoided by limiting the size of the partial
    input data (or partial output digest) below 2^32 - 200 bytes.
    Multiple calls to the queue system can be chained at a higher
    level to retain the original functionality. Alternatively, one
    can process the entire input (or produce the entire output) at
    once, avoiding the queuing functions altogether.
  References
    See [issue #105](https://github.com/XKCP/XKCP/issues/105) for more details.
impacted_packages:
  - purl: pkg:gem/sha3
    affected_versions:
    fixed_versions: vers:gem/>=1.0.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/XKCP/XKCP/security/advisories/GHSA-6w4m-2xhg-2658
    reference_type:
    reference_id:
