advisory_id: gems/actionmailer/CVE-2024-47889
datasource_id: ruby_importer_v2/gems/actionmailer/CVE-2024-47889
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionmailer/CVE-2024-47889.yml
aliases:
  - CVE-2024-47889
  - GHSA-h47h-mwp9-c6q6
summary: |
  Possible ReDoS vulnerability in block_format in Action Mailer
  There is a possible ReDoS vulnerability in the block_format helper
  in Action Mailer. This vulnerability has been assigned the
  CVE identifier CVE-2024-47889.

  ## Impact

  Carefully crafted text can cause the block_format helper to take an
  unexpected amount of time, possibly resulting in a DoS vulnerability.
  All users running an affected release should either upgrade or apply
  the relevant patch immediately.

  Ruby 3.2 has mitigations for this problem, so Rails applications
  using Ruby 3.2 or newer are unaffected. Rails 8.0.0.beta1 requires
  Ruby 3.2 or greater so is unaffected.

  ## Releases

  The fixed releases are available at the normal locations.

  ## Workarounds

  Users can avoid calling the `block_format` helper or upgrade
  to Ruby 3.2.

  ##Credits

  Thanks to [ooooooo_q](https://hackerone.com/ooooooo_q) for the report!
impacted_packages:
  - purl: pkg:gem/actionmailer
    affected_versions: vers:gem/>=3.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionmailer
    affected_versions:
    fixed_versions: vers:gem/>=6.1.7.9|<6.1.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionmailer
    affected_versions:
    fixed_versions: vers:gem/>=7.2.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/rails/rails/security/advisories/GHSA-h47h-mwp9-c6q6
    reference_type:
    reference_id:
