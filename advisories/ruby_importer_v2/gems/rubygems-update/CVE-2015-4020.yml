advisory_id: gems/rubygems-update/CVE-2015-4020
datasource_id: ruby_importer_v2/gems/rubygems-update/CVE-2015-4020
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rubygems-update/CVE-2015-4020.yml
aliases:
  - CVE-2015-4020
  - GHSA-qv62-xfj6-32xm
summary: |
  RubyGems remote_fetcher.rb api_endpoint() Function Missing SRV Record Hostname Validation Request Hijacking
  RubyGems contains a flaw in the api_endpoint() function in remote_fetcher.rb
  that is triggered when handling hostnames in SRV records. With a specially
  crafted response, a context-dependent attacker may conduct DNS hijacking
  attacks. This vulnerability is due to an incomplete fix for CVE-2015-3900,
  which allowed redirection to an arbitrary gem server in any security domain.
impacted_packages:
  - purl: pkg:gem/rubygems-update
    affected_versions:
    fixed_versions: vers:gem/>=2.0.17|<2.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rubygems-update
    affected_versions:
    fixed_versions: vers:gem/>=2.2.5|<2.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rubygems-update
    affected_versions:
    fixed_versions: vers:gem/>=2.4.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2015-009/?fid=6478
    reference_type:
    reference_id:
