advisory_id: gems/solidus_backend/CVE-2022-31000
datasource_id: ruby_importer_v2/gems/solidus_backend/CVE-2022-31000
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/solidus_backend/CVE-2022-31000.yml
aliases:
  - CVE-2022-31000
  - GHSA-8639-qx56-r428
summary: |
  CSRF allows attacker to finalize/unfinalize order adjustments in solidus_backend
  ### Impact
  CSRF vulnerability allowing attackers to change the state of an order's adjustments
  if they hold its number, and the execution happens on a store administrator's computer.

  Reproduction steps:
  - Take an order's number.
  - Log in as an administrator.
  - Visit that order's adjustments section (_Orders -> {Click on number} -> Adjustments_) and check that its adjustments are finalized (closed padlock under the **State** column).
  - On another tab, visit `{your_site_url}/admin/orders/{order_number}/adjustments/unfinalize`.
  - Notice how the adjustments are unfinalized (open padlock), even if the previous was a `GET` request which could have been linked from any other site.
  - Visit `{your_site_url}/admin/orders/{order_number}/adjustments/finalize`.
  - Notice how the adjustments are again finalized.

  That happened because both routes were handled as `GET` requests, which are skipped by Rails anti-forgery protection.

  ### Patches
  Users should upgrade to solidus_backend v3.1.6, v3.0.6, or v2.11.16, depending on the major and minor versions in use.

  ### References
  - [Rails CSRF protection](https://api.rubyonrails.org/classes/ActionController/RequestForgeryProtection.html).
impacted_packages:
  - purl: pkg:gem/solidus_backend
    affected_versions:
    fixed_versions: vers:gem/>=2.11.16|<2.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/solidus_backend
    affected_versions:
    fixed_versions: vers:gem/>=3.0.6|<3.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/solidus_backend
    affected_versions:
    fixed_versions: vers:gem/>=3.1.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.3'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/solidusio/solidus/security/advisories/GHSA-8639-qx56-r428
    reference_type:
    reference_id:
