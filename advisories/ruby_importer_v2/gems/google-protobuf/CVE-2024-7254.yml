advisory_id: gems/google-protobuf/CVE-2024-7254
datasource_id: ruby_importer_v2/gems/google-protobuf/CVE-2024-7254
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/google-protobuf/CVE-2024-7254.yml
aliases:
  - CVE-2024-7254
  - GHSA-735f-pc8j-v9w8
summary: |
  protobuf-java has potential Denial of Service issue
  ### Summary
  When parsing unknown fields in the Protobuf Java Lite and Full library,
  a maliciously crafted message can cause a StackOverflow error and lead
  to a program crash.

  Reporter: Alexis Challande, Trail of Bits Ecosystem Security
  Team <ecosystem@trailofbits.com>

  Affected versions: This issue affects all versions of both the Java
  full and lite Protobuf runtimes, as well as Protobuf for Kotlin and
  JRuby, which themselves use the Java Protobuf runtime.

  ### Severity
  [CVE-2024-7254](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-7254)
  **High** CVSS4.0 Score 8.7 (NOTE: there may be a delay in publication)

  This is a potential Denial of Service. Parsing nested groups as unknown
  fields with DiscardUnknownFieldsParser or Java Protobuf Lite parser,
  or against Protobuf map fields, creates unbounded recursions that can
  be abused by an attacker.

  ### Proof of Concept
  For reproduction details, please refer to the unit tests (Protobuf Java
  [LiteTest](https://github.com/protocolbuffers/protobuf/blob/a037f28ff81ee45ebe008c64ab632bf5372242ce/java/lite/src/test/java/com/google/protobuf/LiteTest.java)
  and [CodedInputStreamTest](https://github.com/protocolbuffers/protobuf/blob/a037f28ff81ee45ebe008c64ab632bf5372242ce/java/core/src/test/java/com/google/protobuf/CodedInputStreamTest.java))
  that identify the specific inputs that exercise this parsing weakness.

  ### Remediation and Mitigation
  We have been working diligently to address this issue and have released
  a mitigation that is available now. Please update to the latest
  available versions of the following packages:

  * protobuf-java (3.25.5, 4.27.5, 4.28.2)
  * protobuf-javalite (3.25.5, 4.27.5, 4.28.2)
  * protobuf-kotlin (3.25.5, 4.27.5, 4.28.2)
  * protobuf-kotlin-lite (3.25.5, 4.27.5, 4.28.2)
  * com-protobuf [JRuby gem only] (3.25.5, 4.27.5, 4.28.2)
impacted_packages:
  - purl: pkg:gem/google-protobuf
    affected_versions:
    fixed_versions: vers:gem/>=3.25.5|<3.26
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/google-protobuf
    affected_versions:
    fixed_versions: vers:gem/>=4.27.5|<4.28
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/google-protobuf
    affected_versions:
    fixed_versions: vers:gem/>=4.28.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/protocolbuffers/protobuf/security/advisories/GHSA-735f-pc8j-v9w8
    reference_type:
    reference_id:
