advisory_id: gems/google-protobuf/CVE-2021-22569
datasource_id: ruby_importer_v2/gems/google-protobuf/CVE-2021-22569
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/google-protobuf/CVE-2021-22569.yml
aliases:
  - CVE-2021-22569
  - GHSA-wrvw-hg22-4m67
summary: |
  ## Summary

  A potential Denial of Service issue in protobuf-java was discovered in the
  parsing procedure for binary data.

  Affected versions: All versions of Java Protobufs (including Kotlin and JRuby)
  prior to the versions listed below. Protobuf "javalite" users (typically
  Android) are not affected.

  ## Severity

  **High** - An implementation weakness in how unknown fields are parsed in
  Java. A small (~800 KB) malicious payload can occupy the parser for several
  minutes by creating large numbers of short-lived objects that cause frequent,
  repeated GC pauses.

  ## Proof of Concept

  For reproduction details, please refer to the oss-fuzz issue that identifies
  the specific inputs that exercise this parsing weakness.

  ## Remediation and Mitigation

  Please update to the latest available versions of the following packages:

  - protobuf-java (3.16.1, 3.18.2, 3.19.2)
  - protobuf-kotlin (3.18.2, 3.19.2)
  - google-protobuf [JRuby gem only] (3.19.2)
impacted_packages:
  - purl: pkg:gem/google-protobuf
    affected_versions:
    fixed_versions: vers:gem/>=3.19.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/protocolbuffers/protobuf/security/advisories/GHSA-wrvw-hg22-4m67
    reference_type:
    reference_id:
