advisory_id: gems/jquery-ui-rails/CVE-2021-41183
datasource_id: ruby_importer_v2/gems/jquery-ui-rails/CVE-2021-41183
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/jquery-ui-rails/CVE-2021-41183.yml
aliases:
  - CVE-2021-41183
  - GHSA-j7qv-pgf6-hvh4
summary: |
  XSS in `*Text` options of the Datepicker widget in jquery-ui
  ### Impact
  Accepting the value of various `*Text` options of the Datepicker
  widget from untrusted sources may execute untrusted code. For example, initializing
  the datepicker in the following way:
  ```js
  $("#datepicker").datepicker( {
    showButtonPanel: true,
    showOn: "both",
    closeText: "<script>doEvilThing('closeText XSS')</script>",
    currentText: "<script>doEvilThing('currentText XSS')</script>",
    prevText: "<script>doEvilThing('prevText XSS')</script>",
    nextText: "<script>doEvilThing('nextText XSS')</script>",
    buttonText: "<script>doEvilThing('buttonText XSS')</script>",
    appendText: "<script>doEvilThing('appendText XSS')</script>",
    }
  );
  ```
  will call `doEvilThing` with 6 different parameters coming from
  all `*Text` options.

  ### Patches
  The issue is fixed in jQuery UI 1.13.0. The values passed to various
  `*Text` options are now always treated as pure text, not HTML.

  ### Workarounds
  A workaround is to not accept the value of the `*Text` options from
  untrusted sources.

  ### For more information
  If you have any questions or comments about this advisory, search
  for a relevant issue in
  [the jQuery UI repo](https://github.com/jquery/jquery-ui/issues).
  If you don't find an answer, open a new issue.
impacted_packages:
  - purl: pkg:gem/jquery-ui-rails
    affected_versions:
    fixed_versions: vers:gem/>=7.0.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/jquery/jquery-ui/security/advisories/GHSA-j7qv-pgf6-hvh4
    reference_type:
    reference_id:
