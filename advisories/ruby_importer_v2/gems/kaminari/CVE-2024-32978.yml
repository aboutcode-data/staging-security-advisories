advisory_id: gems/kaminari/CVE-2024-32978
datasource_id: ruby_importer_v2/gems/kaminari/CVE-2024-32978
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/kaminari/CVE-2024-32978.yml
aliases:
  - CVE-2024-32978
  - GHSA-7r3j-qmr4-jfpj
summary: |
  Insecure File Permissions vulnerability in kaminari
  kaminari versions prior to 0.16.2 are vulnerable to an Insecure File
  Permissions vulnerability, where certain files within the kaminari gem have
  insecure file permissions.

  Versions Affected: < 0.16.2
  Fixed Versions: >= 0.16.2

  # Impact

  An attacker with local access could write arbitrary code to the affected files
  resulting in arbitrary code execution.

  # Releases

  The fixed releases are available at the normal locations.

  # Workarounds

  Manually set the permissions of the affected files to `644`.

  ## All Affected Versions:

  ```
  lib/kaminari/models/page_scope_methods.rb
  ```

  ## Version 0.15.0 and 0.15.1:

  ```
  spec/models/mongo_mapper/mongo_mapper_spec.rb
  ```

  ## Version 0.16.0:

  ```
  spec/models/mongo_mapper/mongo_mapper_spec.rb
  spec/models/mongoid/mongoid_spec.rb
  ```

  ## Version 0.16.1:

  ```
  spec/models/active_record/scopes_spec.rb
  spec/models/mongo_mapper/mongo_mapper_spec.rb
  spec/models/mongoid/mongoid_spec.rb
  gemfiles/data_mapper_12.gemfile
  gemfiles/active_record_32.gemfile
  ```
impacted_packages:
  - purl: pkg:gem/kaminari
    affected_versions:
    fixed_versions: vers:gem/>=0.16.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.6'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32978
    reference_type:
    reference_id: CVE-2024-32978
