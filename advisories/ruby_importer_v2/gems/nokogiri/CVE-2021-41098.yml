advisory_id: gems/nokogiri/CVE-2021-41098
datasource_id: ruby_importer_v2/gems/nokogiri/CVE-2021-41098
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/CVE-2021-41098.yml
aliases:
  - CVE-2021-41098
  - GHSA-2rr5-8q37-2w7h
summary: |
  Improper Restriction of XML External Entity Reference (XXE) in Nokogiri on JRuby
  ### Severity

  The Nokogiri maintainers have evaluated this as [**High Severity** 7.5 (CVSS3.0)](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:H/RL:O/RC:C/MAV:N/MAC:L) for JRuby users. (This security advisory does not apply to CRuby users.)

  ### Impact

  In Nokogiri v1.12.4 and earlier, **on JRuby only**, the SAX parser resolves external entities by default.

  Users of Nokogiri on JRuby who parse untrusted documents using any of these classes are affected:

  - Nokogiri::XML::SAX::Parser
  - Nokogiri::HTML4::SAX::Parser or its alias Nokogiri::HTML::SAX::Parser
  - Nokogiri::XML::SAX::PushParser
  - Nokogiri::HTML4::SAX::PushParser or its alias Nokogiri::HTML::SAX::PushParser

  ### Mitigation

  JRuby users should upgrade to Nokogiri v1.12.5 or later. There are no workarounds available for v1.12.4 or earlier.

  CRuby users are not affected.
impacted_packages:
  - purl: pkg:gem/nokogiri
    affected_versions:
    fixed_versions: vers:gem/>=1.12.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-2rr5-8q37-2w7h
    reference_type:
    reference_id:
