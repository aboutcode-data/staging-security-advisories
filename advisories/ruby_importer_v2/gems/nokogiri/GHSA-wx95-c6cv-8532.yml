advisory_id: gems/nokogiri/GHSA-wx95-c6cv-8532
datasource_id: ruby_importer_v2/gems/nokogiri/GHSA-wx95-c6cv-8532
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/GHSA-wx95-c6cv-8532.yml
aliases:
  - GHSA-wx95-c6cv-8532
summary: |
  Nokogiri does not check the return value from xmlC14NExecute
  ## Summary

  Nokogiri's CRuby extension fails to check the return value from
  `xmlC14NExecute` in the method `Nokogiri::XML::Document#canonicalize`
  and `Nokogiri::XML::Node#canonicalize`. When canonicalization fails,
  an empty string is returned instead of raising an exception. This
  incorrect return value may allow downstream libraries to accept
  invalid or incomplete canonicalized XML, which has been demonstrated
  to enable signature validation bypass in SAML libraries.

  JRuby is not affected, as the Java implementation correctly
  raises `RuntimeError` on canonicalization failure.

  ## Mitigation

  Upgrade to Nokogiri `>= 1.19.1`.

  ## Severity

  The maintainers have assessed this as **Medium** severity. Nokogiri
  itself is a parsing library without a clear security boundary
  related to canonicalization, so the direct impact is that a method
  returns incorrect data on invalid input. However, this behavior
  was exploited in practice to bypass SAML signature validation
  in downstream libraries (see References).

  ## Credit

  This vulnerability was responsibly reported by HackerOne
  researcher `d4d`.
impacted_packages:
  - purl: pkg:gem/nokogiri
    affected_versions: vers:gem/>=1.5.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/nokogiri
    affected_versions:
    fixed_versions: vers:gem/>=1.19.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-wx95-c6cv-8532
    reference_type:
    reference_id:
