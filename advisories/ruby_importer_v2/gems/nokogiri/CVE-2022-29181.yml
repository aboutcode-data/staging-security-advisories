advisory_id: gems/nokogiri/CVE-2022-29181
datasource_id: ruby_importer_v2/gems/nokogiri/CVE-2022-29181
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/CVE-2022-29181.yml
aliases:
  - CVE-2022-29181
  - GHSA-xh29-r2w5-wx8m
summary: |
  Improper Handling of Unexpected Data Type in Nokogiri
  ### Summary

  Nokogiri `< v1.13.6` does not type-check all inputs into the XML and HTML4 SAX parsers.
  For CRuby users, this may allow specially crafted untrusted inputs to cause illegal
  memory access errors (segfault) or reads from unrelated memory.

  ### Severity

  The Nokogiri maintainers have evaluated this as **High 8.2** (CVSS3.1).

  ### Mitigation

  CRuby users should upgrade to Nokogiri `>= 1.13.6`.

  JRuby users are not affected.

  ### Workarounds

  To avoid this vulnerability in affected applications, ensure the untrusted input is a
  `String` by calling `#to_s` or equivalent.
impacted_packages:
  - purl: pkg:gem/nokogiri
    affected_versions:
    fixed_versions: vers:gem/>=1.13.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-xh29-r2w5-wx8m
    reference_type:
    reference_id:
