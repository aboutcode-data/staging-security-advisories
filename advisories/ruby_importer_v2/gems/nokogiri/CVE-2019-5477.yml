advisory_id: gems/nokogiri/CVE-2019-5477
datasource_id: ruby_importer_v2/gems/nokogiri/CVE-2019-5477
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/CVE-2019-5477.yml
aliases:
  - CVE-2019-5477
  - GHSA-cr5j-953j-xw5p
summary: |
  Nokogiri Command Injection Vulnerability via Nokogiri::CSS::Tokenizer#load_file
  A command injection vulnerability in Nokogiri v1.10.3 and earlier allows
  commands to be executed in a subprocess by Ruby's `Kernel.open` method.
  Processes are vulnerable only if the undocumented method
  `Nokogiri::CSS::Tokenizer#load_file` is being passed untrusted user input.

  This vulnerability appears in code generated by the Rexical gem versions
  v1.0.6 and earlier. Rexical is used by Nokogiri to generate lexical scanner
  code for parsing CSS queries. The underlying vulnerability was addressed in
  Rexical v1.0.7 and Nokogiri upgraded to this version of Rexical in
  Nokogiri v1.10.4.

  Upgrade to Nokogiri v1.10.4, or avoid calling the undocumented method
  `Nokogiri::CSS::Tokenizer#load_file` with untrusted user input.
impacted_packages:
  - purl: pkg:gem/nokogiri
    affected_versions:
    fixed_versions: vers:gem/>=1.10.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/sparklemotion/nokogiri/issues/1915
    reference_type:
    reference_id:
