advisory_id: gems/pgsync/CVE-2021-31671
datasource_id: ruby_importer_v2/gems/pgsync/CVE-2021-31671
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/pgsync/CVE-2021-31671.yml
aliases:
  - CVE-2021-31671
  - GHSA-72rj-36qc-47g7
summary: |
  Connection security vulnerability with schema sync
  pgsync drops connection parameters when syncing the schema with the
  --schema-first and --schema-only options. Some of these parameters may
  affect security. For instance, if sslmode is dropped, the connection
  may not use SSL. The first connection parameter is not affected.

  pgsync drops connection parameters when syncing the schema with the
  `--schema-first` and `--schema-only` options. Some of these parameters
  may affect security. For instance, if `sslmode` is dropped, the
  connection may not use SSL. The first connection parameter is not affected.

  An example where `sslmode` is dropped (`connect_timeout` is not affected):

  ```yaml
  from: postgres://user:pass@host/dbname?connect_timeout=10&sslmode=require
  ```

  This applies to both the `to` and `from` connections.
impacted_packages:
  - purl: pkg:gem/pgsync
    affected_versions:
    fixed_versions: vers:gem/>=0.6.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/ankane/pgsync/issues/121
    reference_type:
    reference_id:
