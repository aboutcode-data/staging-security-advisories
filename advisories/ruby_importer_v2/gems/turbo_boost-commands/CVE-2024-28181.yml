advisory_id: gems/turbo_boost-commands/CVE-2024-28181
datasource_id: ruby_importer_v2/gems/turbo_boost-commands/CVE-2024-28181
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/turbo_boost-commands/CVE-2024-28181.yml
aliases:
  - CVE-2024-28181
  - GHSA-mp76-7w5v-pr75
summary: |
  TurboBoost Commands vulnerable to arbitrary method invocation
  ### Impact

  TurboBoost Commands has existing protections in place to
  guarantee that only public methods on Command classes can be invoked; however, the
  existing checks aren't as robust as they should be. It's possible for a sophisticated
  attacker to invoke more methods than should be permitted depending on the the strictness
  of authorization checks that individual applications enforce. Being able to call
  some of these methods can have security implications.

  #### Details

  Commands verify that the class must be a `Command` and that the method requested is
  defined as a public method; however, this isn't robust enough to guard against all
  unwanted code execution. The library should more strictly enforce which methods are
  considered safe before allowing them to be executed.

  ### Patches

  Patched in the following versions.
  - 0.1.3
    - [NPM Package](https://www.npmjs.com/package/@turbo-boost/commands/v/0.1.3)
    - [Ruby GEM](https://rubygems.org/gems/turbo_boost-commands/versions/0.1.3)
  - 0.2.2
    - [NPM Package](https://www.npmjs.com/package/@turbo-boost/commands/v/0.2.2)
    - [Ruby GEM](https://rubygems.org/gems/turbo_boost-commands/versions/0.2.2)

  ### Workarounds

  You can add this guard to mitigate the issue if running an unpatched
  version of the library.

  ```ruby
  class ApplicationCommand < TurboBoost::Commands::Command
    before_command do
      method_name = params[:name].include?(\"#\") ? params[:name].split(\"#\").last : :perform
      ancestors = self.class.ancestors[0..self.class.ancestors.index(TurboBoost::Commands::Command) - 1]
      allowed = ancestors.any? { |a| a.public_instance_methods(false).any? method_name.to_sym }
      throw :abort unless allowed # ← blocks invocation
      # raise \"Invalid Command\" unless allowed # ← blocks invocation
    end
  end
  ```
impacted_packages:
  - purl: pkg:gem/turbo_boost-commands
    affected_versions:
    fixed_versions: vers:gem/>=0.1.3|<0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/turbo_boost-commands
    affected_versions:
    fixed_versions: vers:gem/>=0.2.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/hopsoft/turbo_boost-commands/security/advisories/GHSA-mp76-7w5v-pr75
    reference_type:
    reference_id:
