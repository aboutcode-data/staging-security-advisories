advisory_id: gems/ruby-saml/CVE-2017-11428
datasource_id: ruby_importer_v2/gems/ruby-saml/CVE-2017-11428
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/ruby-saml/CVE-2017-11428.yml
aliases:
  - CVE-2017-11428
  - GHSA-x2fr-v8wf-8wwv
summary: |
  Authentication bypass via incorrect XML canonicalization and DOM traversal
  ruby-saml prior to version 1.7.0 is vulnerable to an authentication bypass via incorrect
  XML canonicalization and DOM traversal. Specifically, there are inconsistencies in
  handling of comments within XML nodes, resulting in incorrect parsing of the inner text
  of XML nodes such that any inner text after the comment is lost prior to
  cryptographically signing the SAML message. Text after the comment therefore has no
  impact on the signature on the SAML message.

  A remote attacker can modify SAML content for a SAML service provider without
  invalidating the cryptographic signature, which may allow attackers to bypass
  primary authentication for the affected SAML service provider.
impacted_packages:
  - purl: pkg:gem/ruby-saml
    affected_versions:
    fixed_versions: vers:gem/>=1.7.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.3'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '7.7'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/onelogin/ruby-saml/commit/048a544730930f86e46804387a6b6fad50d8176f
    reference_type:
    reference_id:
