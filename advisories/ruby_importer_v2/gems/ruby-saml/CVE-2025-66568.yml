advisory_id: gems/ruby-saml/CVE-2025-66568
datasource_id: ruby_importer_v2/gems/ruby-saml/CVE-2025-66568
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/ruby-saml/CVE-2025-66568.yml
aliases:
  - CVE-2025-66568
  - GHSA-x4h9-gwv3-r4m4
summary: |
  Ruby-saml allows a Libxml2 Canonicalization error to bypass Digest/Signature validation
  ### Summary

  Ruby-saml up to and including 1.12.4, there is an authentication
  bypass vulnerability because of an issue at libxml2 canonicalization
  process used by Nokogiri for document transformation. That allows
  an attacker to be able to execute a Signature Wrapping attack.
  The vulnerability does not affect the version 1.18.0.

  ### Details

  When libxml2â€™s canonicalization is invoked on an invalid XML input,
  it may return an empty string rather than a canonicalized node.
  ruby-saml then proceeds to compute the DigestValue over this empty
  string, treating it as if canonicalization succeeded.

  ### Impact

  1. Digest bypass: By crafting input that causes canonicalization to
     yield an empty string, the attacker can manipulate validation to
     pass incorrectly.

  2. Signature replay on empty canonical form: If an empty string has
     been signed once (e.g., in a prior interaction or via a
     misconfigured flow), that signature can potentially be replayed
     to bypass authentication.
impacted_packages:
  - purl: pkg:gem/ruby-saml
    affected_versions:
    fixed_versions: vers:gem/>=1.18.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-x4h9-gwv3-r4m4
    reference_type:
    reference_id:
