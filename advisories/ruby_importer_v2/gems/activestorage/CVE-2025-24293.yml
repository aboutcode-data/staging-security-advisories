advisory_id: gems/activestorage/CVE-2025-24293
datasource_id: ruby_importer_v2/gems/activestorage/CVE-2025-24293
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activestorage/CVE-2025-24293.yml
aliases:
  - CVE-2025-24293
  - GHSA-r4mg-4433-c7g3
summary: |
  Active Storage allowed transformation methods that were potentially unsafe
  Active Storage attempts to prevent the use of potentially unsafe
  image transformation methods and parameters by default.
  The default allowed list contains three methods allowing for the
  circumvention of the safe defaults which enables potential command
  injection vulnerabilities in cases where arbitrary user supplied
  input is accepted as valid transformation methods or parameters.

  This has been assigned the CVE identifier CVE-2025-24293.

  Versions Affected:  >= 5.2.0
  Not affected:       < 5.2.0
  Fixed Versions:     7.1.5.2, 7.2.2.2, 8.0.2.1

  ## Impact

  This vulnerability impacts applications that use Active Storage
  with the image_processing processing gem in addition to
  mini_magick as the image processor.

  Vulnerable code will look something similar to this:

  ```
  <= image_tag blob.variant(params[:t] => params[:v]) >
  ```

  Where the transformation method or its arguments are untrusted
  arbitrary input.

  All users running an affected release should either upgrade or
  use one of the workarounds immediately.

  ## Releases

  The fixed releases are available at the normal locations.

  ## Workarounds

  Consuming user supplied input for image transformation methods
  or their parameters is unsupported behavior and should be
  considered dangerous.

  Strict validation of user supplied methods and parameters should
  be performed as well as having a strong
  [ImageMagick security policy](https://imagemagick.org/script/security-policy.php) deployed.

  ## Credits

  Thank you [lio346](https://hackerone.com/lio346) for reporting this!
impacted_packages:
  - purl: pkg:gem/activestorage
    affected_versions: vers:gem/>=5.20
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activestorage
    affected_versions:
    fixed_versions: vers:gem/>=8.0.2.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/rails/rails/security/advisories/GHSA-r4mg-4433-c7g3
    reference_type:
    reference_id:
