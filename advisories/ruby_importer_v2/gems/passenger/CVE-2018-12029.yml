advisory_id: gems/passenger/CVE-2018-12029
datasource_id: ruby_importer_v2/gems/passenger/CVE-2018-12029
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/passenger/CVE-2018-12029.yml
aliases:
  - CVE-2018-12029
  - GHSA-jjcj-fgfm-9g9r
summary: |
  CHMOD race vulnerability
  The file system access race condition allows for local privilege escalation
  and affects the Nginx module for Passenger versions 5.3.1, all the way back
  to 3.0.0 (the chown command entered the code in 2010).

  The vulnerability was exploitable only when running a non-standard
  `passenger_instance_registry_dir`, via a race condition where after a file
  was created, there was a window in which it could be replaced with a symlink
  before it was chowned via the path and not the file descriptor.

  If the symlink target was to a file which would be executed by root such as
  root's crontab file, then privilege escalation was possible.
impacted_packages:
  - purl: pkg:gem/passenger
    affected_versions: vers:gem/>=3.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/passenger
    affected_versions:
    fixed_versions: vers:gem/>=5.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.4'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes/
    reference_type:
    reference_id:
