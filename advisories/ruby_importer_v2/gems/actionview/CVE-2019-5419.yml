advisory_id: gems/actionview/CVE-2019-5419
datasource_id: ruby_importer_v2/gems/actionview/CVE-2019-5419
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionview/CVE-2019-5419.yml
aliases:
  - CVE-2019-5419
  - GHSA-m63j-wh5w-c252
summary: |
  Denial of Service Vulnerability in Action View
  There is a potential denial of service vulnerability in actionview.
  This vulnerability has been assigned the CVE identifier CVE-2019-5419.

  Impact
  ------
  Specially crafted accept headers can cause the Action View template location
  code to consume 100% CPU, causing the server unable to process requests.  This
  impacts all Rails applications that render views.

  All users running an affected release should either upgrade or use one of the
  workarounds immediately.

  Workarounds
  -----------
  This vulnerability can be mitigated by wrapping `render` calls with
  `respond_to` blocks.  For example, the following example is vulnerable:

  ```
  class UserController < ApplicationController
    def index
      render "index"
    end
  end
  ```

  But the following code is not vulnerable:

  ```
  class UserController < ApplicationController
    def index
      respond_to |format|
        format.html { render "index" }
      end
    end
  end
  ```

  Implicit rendering is impacted, so this code is vulnerable:

  ```
  class UserController < ApplicationController
    def index
    end
  end
  ```

  But can be changed this this:

  ```
  class UserController < ApplicationController
    def index
      respond_to |format|
        format.html { render "index" }
      end
    end
  end
  ```

  Alternatively to specifying the format, the following monkey patch can be
  applied in an initializer:

  ```
  $ cat config/initializers/formats_filter.rb
  # frozen_string_literal: true

  ActionDispatch::Request.prepend(Module.new do
    def formats
      super().select do |format|
        format.symbol || format.ref == "*/*"
      end
    end
  end)
  ```

  Credits
  -------
  Thanks to John Hawthorn <john@hawthorn.email> of GitHub
impacted_packages:
  - purl: pkg:gem/actionview
    affected_versions:
    fixed_versions: vers:gem/>=6.0.0.beta3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://groups.google.com/forum/#!topic/rubyonrails-security/GN7w9fFAQeI
    reference_type:
    reference_id:
