advisory_id: gems/actionview/CVE-2020-15169
datasource_id: ruby_importer_v2/gems/actionview/CVE-2020-15169
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionview/CVE-2020-15169.yml
aliases:
  - CVE-2020-15169
  - GHSA-cfjv-5498-mph5
summary: |
  Potential XSS vulnerability in Action View
  There is a potential Cross-Site Scripting (XSS) vulnerability in Action
  View's translation helpers. Views that allow the user to control the
  default (not found) value of the `t` and `translate` helpers could be
  susceptible to XSS attacks.

  Impact
  ------

  When an HTML-unsafe string is passed as the default for a missing
  translation key [named `html` or ending in `_html`](https://guides.rubyonrails.org/i18n.html#using-safe-html-translations),
  the default string is incorrectly marked as HTML-safe and not escaped.
  Vulnerable code may look like the following examples:

  ```erb
  <%# The welcome_html translation is not defined for the current locale: %>
  <%= t("welcome_html", default: untrusted_user_controlled_string) %>

  <%# Neither the title.html translation nor the missing.html translation is defined for the current locale: %>
  <%= t("title.html", default: [:"missing.html", untrusted_user_controlled_string]) %>
  ```

  Workarounds
  -----------
  Impacted users who canâ€™t upgrade to a patched Rails version can avoid
  this issue by manually escaping default translations with the
  `html_escape` helper (aliased as `h`):

  ```erb
  <%= t("welcome_html", default: h(untrusted_user_controlled_string)) %>
  ```
impacted_packages:
  - purl: pkg:gem/actionview
    affected_versions:
    fixed_versions: vers:gem/>=6.0.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://groups.google.com/g/rubyonrails-security/c/b-C9kSGXYrc
    reference_type:
    reference_id:
