advisory_id: gems/mapbox-rails/CVE-2017-1000043
datasource_id: ruby_importer_v2/gems/mapbox-rails/CVE-2017-1000043
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/mapbox-rails/CVE-2017-1000043.yml
aliases:
  - CVE-2017-1000043
  - GHSA-q69p-5h74-w36f
  - OSV-132871
summary: |
  mapbox-rails Content Injection via TileJSON Name
  Mapbox.js versions 1.x prior to 1.6.6 and 2.x prior to 2.2.4 are vulnerable
  to a cross-site-scripting attack in certain uncommon usage scenarios.

  If you use L.mapbox.map and L.mapbox.shareControl it is possible for a
  malicious user with control over the TileJSON content to inject script
  content into the name value of the TileJSON. After clicking on the share
  control, the malicious code will execute in the context of the page using
  Mapbox.js.

  Such usage is uncommon. L.mapbox.shareControl is not automatically added to
  Mapbox.js maps and must be explicitly added. The following usage scenarios
  are not vulnerable:

  * the map does not use a share control (L.mapbox.sharecontrol)
  * only trusted TileJSON content is loaded
impacted_packages:
  - purl: pkg:gem/mapbox-rails
    affected_versions:
    fixed_versions: vers:gem/>=1.6.6|<1.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/mapbox-rails
    affected_versions:
    fixed_versions: vers:gem/>=2.2.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-1000043
    reference_type:
    reference_id: CVE-2017-1000043
