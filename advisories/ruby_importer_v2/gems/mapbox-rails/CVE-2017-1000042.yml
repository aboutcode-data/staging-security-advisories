advisory_id: gems/mapbox-rails/CVE-2017-1000042
datasource_id: ruby_importer_v2/gems/mapbox-rails/CVE-2017-1000042
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/mapbox-rails/CVE-2017-1000042.yml
aliases:
  - CVE-2017-1000042
  - GHSA-qr28-7j6p-9hmv
  - OSV-129854
summary: |
  mapbox-rails Content Injection via TileJSON attribute
  Mapbox.js versions 1.x prior to 1.6.5 and 2.x prior to 2.1.7 are vulnerable
  to a cross-site-scripting attack in certain uncommon usage scenarios.

  If you use L.mapbox.map or L.mapbox.tileLayer to load untrusted TileJSON
  content from a non-Mapbox URL, it is possible for a malicious user with
  control over the TileJSON content to inject script content into the
  "attribution" value of the TileJSON which will be executed in the context of
  the page using Mapbox.js.

  Such usage is uncommon. The following usage scenarios are not vulnerable:

  * only trusted TileJSON content is loaded
  * TileJSON content comes only from mapbox.com URLs
  * a Mapbox map ID is supplied, rather than a TileJSON URL

  * CWE: 79 - Improper Neutralization of Input During Web Page Generation (XSS)
impacted_packages:
  - purl: pkg:gem/mapbox-rails
    affected_versions:
    fixed_versions: vers:gem/>=1.6.5|<1.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/mapbox-rails
    affected_versions:
    fixed_versions: vers:gem/>=2.1.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-1000042
    reference_type:
    reference_id: CVE-2017-1000042
