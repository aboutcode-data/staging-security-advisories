advisory_id: gems/sinatra/CVE-2025-61921
datasource_id: ruby_importer_v2/gems/sinatra/CVE-2025-61921
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sinatra/CVE-2025-61921.yml
aliases:
  - CVE-2025-61921
  - GHSA-mr3q-g2mv-mr4q
summary: |
  Sinatra is vulnerable to ReDoS through ETag header value generation
  ### Summary

  There is a denial of service vulnerability in the `If-Match` and
  `If-None-Match` header parsing component of Sinatra, if the `etag`
  method is used when constructing the response and you are using Ruby < 3.2.

  ### Details

  Carefully crafted input can cause `If-Match` and `If-None-Match`
  header parsing in Sinatra to take an unexpected amount of time,
  possibly resulting in a denial of service attack vector. This header
  is typically involved in generating the `ETag` header value. Any
  applications that use the `etag` method when generating a response
  are impacted if they are using Ruby below version 3.2.

  ### Resources

  * https://github.com/sinatra/sinatra/issues/2120 (report)
  * https://github.com/sinatra/sinatra/pull/2121 (fix)
  * https://github.com/sinatra/sinatra/pull/1823 (older ReDoS vulnerability)
  * https://bugs.ruby-lang.org/issues/19104 (fix in Ruby >= 3.2)
impacted_packages:
  - purl: pkg:gem/sinatra
    affected_versions:
    fixed_versions: vers:gem/>=4.2.0
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/sinatra/sinatra/security/advisories/GHSA-mr3q-g2mv-mr4q
    reference_type:
    reference_id:
