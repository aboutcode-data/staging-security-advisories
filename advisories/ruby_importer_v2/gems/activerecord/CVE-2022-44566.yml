advisory_id: gems/activerecord/CVE-2022-44566
datasource_id: ruby_importer_v2/gems/activerecord/CVE-2022-44566
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activerecord/CVE-2022-44566.yml
aliases:
  - CVE-2022-44566
  - GHSA-579w-22j4-4749
summary: |
  Denial of Service Vulnerability in ActiveRecord’s PostgreSQL adapter
  There is a potential denial of service vulnerability present in
  ActiveRecord’s PostgreSQL adapter.

  This has been assigned the CVE identifier CVE-2022-44566.

  Versions Affected: All.
  Not affected: None.
  Fixed Versions: 6.1.7.1, 7.0.4.1

  # Impact

  In ActiveRecord <7.0.4.1 and <6.1.7.1, when a value outside the range for a
  64bit signed integer is provided to the PostgreSQL connection adapter, it
  will treat the target column type as numeric. Comparing integer values
  against numeric values can result in a slow sequential scan resulting in
  potential Denial of Service.

  # Workarounds

  Ensure that user supplied input which is provided to ActiveRecord clauses do
  not contain integers wider than a signed 64bit representation or floats.
impacted_packages:
  - purl: pkg:gem/activerecord
    affected_versions:
    fixed_versions: vers:gem/>=5.2.8|<5.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activerecord
    affected_versions:
    fixed_versions: vers:gem/>=7.0.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/rails/rails/releases/tag/v7.0.4.1
    reference_type:
    reference_id:
