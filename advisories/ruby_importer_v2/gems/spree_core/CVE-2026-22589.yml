advisory_id: gems/spree_core/CVE-2026-22589
datasource_id: ruby_importer_v2/gems/spree_core/CVE-2026-22589
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/spree_core/CVE-2026-22589.yml
aliases:
  - CVE-2026-22589
  - GHSA-3ghg-3787-w2xr
summary: |
  Spree API has Unauthenticated IDOR - Guest Address
  ### Summary

  An Unauthenticated Insecure Direct Object Reference (IDOR)
  vulnerability was identified that allows an unauthenticated attacker
  to access guest address information without supplying valid
  credentials or session cookies.

  ###  Details

  During testing, it was observed that all guest users can make an
  unauthenticated request to retrieve address data belonging to other
  guest users by manipulating object identifiers. The attacker would
  need to know the storefront URL structure to perform this attack
  (which can be learnt after creating a registered user account).

  Affected Component(s)

  * Address Edit endpoint: `/addresses/{addressId}/edit`

  Root Cause
  - Faulty authorization check in CanCanCan Ability class:

  ```diff
  - can :manage,  ::Spree::Address, user_id: user.id
  + can :manage, ::Spree::Address, user_id: user.id if user.persisted?
  ```

  the `user` object in `Spree::Ability` class for guest users is
  a `Spree.user_class.new` object.

  Addresses endpoint to access it is part of the `spree_storefront`
  gem. **Headless builds using APIs are not affected,** as the
  Addresses endpoint there is only for registered users, and
  records are scoped to the currently signed-in user.

  ### Impact

  An unauthenticated attacker can:

  - Enumerate and retrieve guest address information (Addresses
    associated with User accounts are NOT affected)
  - Access personally identifiable information (PII) such as:
  - Full names
  - Physical addresses
  - Phone numbers (if present)

  This vulnerability could lead to:

  - Privacy violations
  - Regulatory compliance issues (e.g., GDPR)
  - Loss of user trust"
impacted_packages:
  - purl: pkg:gem/spree_core
    affected_versions: vers:gem/>=4.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_core
    affected_versions:
    fixed_versions: vers:gem/>=4.10.2|<4.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_core
    affected_versions:
    fixed_versions: vers:gem/>=5.0.7|<5.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_core
    affected_versions:
    fixed_versions: vers:gem/>=5.1.9|<5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_core
    affected_versions:
    fixed_versions: vers:gem/>=5.2.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/spree/spree/security/advisories/GHSA-3ghg-3787-w2xr
    reference_type:
    reference_id:
