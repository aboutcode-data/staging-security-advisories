advisory_id: gems/activeresource/CVE-2020-8151
datasource_id: ruby_importer_v2/gems/activeresource/CVE-2020-8151
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activeresource/CVE-2020-8151.yml
aliases:
  - CVE-2020-8151
  - GHSA-46j2-xjgp-jrfm
summary: |
  activeresource Gem for Ruby lib/active_resource/base.rb element_path Lack of Encoding
  activeresource contains a lack of encoding flaw in the element_path function of
  lib/active_resource/base.rb.

  There is an issue with the way Active Resource encodes data before querying the back end server.  This encoding mechanism can allow specially crafted requests to possibly access data that may not be expected.

  Impacted code will look something like this:

  ```
  require 'activeresource'

  class Test < ActiveResource::Base
    self.site = 'http://127.0.0.1:3000'
  end

  Test.exists?(untrusted_user_input)
  ```

  Where untrusted user input is passed to an Active Resource model.  Specially crafted untrusted input can cause Active Resource to access data in an unexpected way and possibly leak information.

  Workarounds
  -------------

  For those that can't upgrade, the following monkey patch can be applied:

  ```
  module ActiveResource
   class Base
     class << self
       def element_path(id, prefix_options = {}, query_options = nil)
         check_prefix_options(prefix_options)

         prefix_options, query_options = split_options(prefix_options) if query_options.nil?
         "#{prefix(prefix_options)}#{collection_name}/#{URI.encode_www_form_component(id.to_s)}#{format_extension}#{query_string(query_options)}"
       end
     end
   end
  end
  ```
impacted_packages:
  - purl: pkg:gem/activeresource
    affected_versions:
    fixed_versions: vers:gem/>=5.1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://groups.google.com/forum/#!topic/rubyonrails-security/pktoF4VmiM8
    reference_type:
    reference_id:
