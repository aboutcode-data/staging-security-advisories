advisory_id: gems/ejson2env/CVE-2025-48069
datasource_id: ruby_importer_v2/gems/ejson2env/CVE-2025-48069
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/ejson2env/CVE-2025-48069.yml
aliases:
  - CVE-2025-48069
  - GHSA-2c47-m757-32g6
summary: |
  Insufficient input sanitization in ejson2env
  ### Summary
  The `ejson2env` tool has a vulnerability related to how it writes to
  `stdout`. Specifically, the tool is intended to write an export
  statement for environment variables and their values. However, due
  to inadequate output sanitization, there is a potential risk where
  variable names or values may include malicious content, resulting
  in additional unintended commands being output to `stdout`. If this
  output is improperly utilized in further command execution, it could
  lead to command injection vulnerabilities, allowing an attacker to
  execute arbitrary commands on the host system.

  ### Details
  The vulnerability exists because environment variables are not
  properly sanitized during the decryption phase, which enables
  malicious keys or encrypted values to inject commands.

  ### Impact
  An attacker with control over `.ejson` files can inject commands
  in the environment where `source $(ejson2env)` or `eval ejson2env`
  are executed.

  ### Mitigation
  - Update to a version of `ejson2env` that sanitizes the output
    during decryption or
  - Do not use `ejson2env` to decrypt untrusted user secrets or
  - Do not evaluate or execute the direct output from `ejson2env`
    without removing nonprintable characters.

  ### Credit
  Thanks to security researcher [Demonia](https://hackerone.com/demonia?type=user)
  for reporting this issue.
impacted_packages:
  - purl: pkg:gem/ejson2env
    affected_versions:
    fixed_versions: vers:gem/>=2.0.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.6'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/Shopify/ejson2env/security/advisories/GHSA-2c47-m757-32g6
    reference_type:
    reference_id:
