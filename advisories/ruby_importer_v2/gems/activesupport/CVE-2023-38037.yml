advisory_id: gems/activesupport/CVE-2023-38037
datasource_id: ruby_importer_v2/gems/activesupport/CVE-2023-38037
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activesupport/CVE-2023-38037.yml
aliases:
  - CVE-2023-38037
  - GHSA-cr5q-6q9f-rq6q
summary: |
  Possible File Disclosure of Locally Encrypted Files
  There is a possible file disclosure of locally encrypted files in
  Active Support. This vulnerability has been assigned the
  CVE identifier CVE-2023-38037.

  * Versions Affected: >= 5.2.0
  * Not affected: < 5.2.0
  * Fixed Versions: 7.0.7.1, 6.1.7.5

  # Impact

  ActiveSupport::EncryptedFile writes contents that will be encrypted
  to a temporary file. The temporary file’s permissions are defaulted
  to the user’s current umask settings, meaning that it’s possible
  for other users on the same system to read the contents of the
  temporary file.

  Attackers that have access to the file system could possibly read
  the contents of this temporary file while a user is editing it.

  All users running an affected release should either upgrade or use
  one of the workarounds immediately.

  # Releases

  The fixed releases are available at the normal locations.

  # Workarounds

  To work around this issue, you can set your umask to be more
  restrictive like this:

    $ umask 0077
impacted_packages:
  - purl: pkg:gem/activesupport
    affected_versions: vers:gem/>=5.2.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activesupport
    affected_versions:
    fixed_versions: vers:gem/>=7.0.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/rails/rails/releases/tag/v7.0.7.1
    reference_type:
    reference_id:
