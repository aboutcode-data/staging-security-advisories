advisory_id: gems/activesupport/CVE-2015-3226
datasource_id: ruby_importer_v2/gems/activesupport/CVE-2015-3226
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activesupport/CVE-2015-3226.yml
aliases:
  - CVE-2015-3226
  - GHSA-vxvp-4xwc-jpp6
summary: |
  XSS Vulnerability in ActiveSupport::JSON.encode
  When a `Hash` containing user-controlled data is encode as JSON (either through
  `Hash#to_json` or `ActiveSupport::JSON.encode`), Rails does not perform adequate
  escaping that matches the guarantee implied by the `escape_html_entities_in_json`
  option (which is enabled by default). If this resulting JSON string is subsequently
  inserted directly into an HTML page, the page will be vulnerable to XSS attacks.

  For example, the following code snippet is vulnerable to this attack:

      <%= javascript_tag "var data = #{user_supplied_data.to_json};" %>

  Similarly, the following is also vulnerable:

      <script>
        var data = <%= ActiveSupport::JSON.encode(user_supplied_data).html_safe %>;
      </script>

  All applications that renders JSON-encoded strings that contains user-controlled
  data in their views should either upgrade to one of the FIXED versions or use
  the suggested workaround immediately.

  Workarounds
  -----------
  To work around this problem add an initializer with the following code:

    module ActiveSupport
      module JSON
        module Encoding
          private
          class EscapedString
            def to_s
              self
            end
          end
        end
      end
    end
impacted_packages:
  - purl: pkg:gem/activesupport
    affected_versions: vers:gem/>=4.1.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activesupport
    affected_versions:
    fixed_versions: vers:gem/>=4.2.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activesupport
    affected_versions:
    fixed_versions: vers:gem/>=4.1.11|<4.2
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://groups.google.com/forum/#!topic/ruby-security-ann/7VlB_pck3hU
    reference_type:
    reference_id:
