advisory_id: gems/activesupport/CVE-2023-22796
datasource_id: ruby_importer_v2/gems/activesupport/CVE-2023-22796
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activesupport/CVE-2023-22796.yml
aliases:
  - CVE-2023-22796
  - GHSA-j6gc-792m-qgm2
summary: |
  ReDoS based DoS vulnerability in Active Supportâ€™s underscore
  There is a possible regular expression based DoS vulnerability in Active
  Support. This vulnerability has been assigned the CVE identifier
  CVE-2023-22796.

  Versions Affected: All
  Not affected: None
  Fixed Versions: 6.1.7.1, 7.0.4.1

  # Impact

  A specially crafted string passed to the underscore method can cause the
  regular expression engine to enter a state of catastrophic backtracking.
  This can cause the process to use large amounts of CPU and memory, leading
  to a possible DoS vulnerability.

  This affects String#underscore, ActiveSupport::Inflector.underscore,
  String#titleize, and any other methods using these.

  All users running an affected release should either upgrade or use one of the
  workarounds immediately.

  # Workarounds

  There are no feasible workarounds for this issue.

  Users on Ruby 3.2.0 or greater may be able to reduce the impact by
  configuring Regexp.timeout.
impacted_packages:
  - purl: pkg:gem/activesupport
    affected_versions:
    fixed_versions: vers:gem/>=5.2.8|<5.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/activesupport
    affected_versions:
    fixed_versions: vers:gem/>=7.0.4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/rails/rails/releases/tag/v7.0.4.1
    reference_type:
    reference_id:
