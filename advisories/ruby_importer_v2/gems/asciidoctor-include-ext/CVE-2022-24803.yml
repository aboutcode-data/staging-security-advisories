advisory_id: gems/asciidoctor-include-ext/CVE-2022-24803
datasource_id: ruby_importer_v2/gems/asciidoctor-include-ext/CVE-2022-24803
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/asciidoctor-include-ext/CVE-2022-24803.yml
aliases:
  - CVE-2022-24803
  - GHSA-v222-6mr4-qj29
summary: |
  Command Injection vulnerability in asciidoctor-include-ext
  ### Impact

  Applications using [Asciidoctor (Ruby)](https://github.com/asciidoctor/asciidoctor)
  with [asciidoctor-include-ext](https://github.com/jirutka/asciidoctor-include-ext)
  (prior to version 0.4.0), which render user-supplied input in AsciiDoc markup, may
  allow an attacker to execute arbitrary system commands on the host operating system.
  This attack is possible even when `allow-uri-read` is disabled!

  ### Patches

  The vulnerability has been fixed in commit c7ea001 (and further improved in cbaccf3),
  which is included in version
  [0.4.0](https://rubygems.org/gems/asciidoctor-include-ext/versions/0.4.0).

  ### Workarounds

  ```rb
  require 'asciidoctor/include_ext'

  class Asciidoctor::IncludeExt::IncludeProcessor
    # Overrides superclass private method to mitigate Command Injection
    # vulnerability in asciidoctor-include-ext <0.4.0.
    def target_uri?(target)
      target.downcase.start_with?('http://', 'https://') \
        && URI.parse(target).is_a?(URI::HTTP)
    rescue URI::InvalidURIError
      false
    end
  end
  ```

  ### References

  * https://sakurity.com/blog/2015/02/28/openuri.html
impacted_packages:
  - purl: pkg:gem/asciidoctor-include-ext
    affected_versions:
    fixed_versions: vers:gem/>=0.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/jirutka/asciidoctor-include-ext/security/advisories/GHSA-v222-6mr4-qj29
    reference_type:
    reference_id:
