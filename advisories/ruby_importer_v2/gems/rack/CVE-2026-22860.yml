advisory_id: gems/rack/CVE-2026-22860
datasource_id: ruby_importer_v2/gems/rack/CVE-2026-22860
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2026-22860.yml
aliases:
  - CVE-2026-22860
  - GHSA-mxw3-3hh2-x2mh
summary: |
  Rack has a Directory Traversal via Rack:Directory
  ## Summary

  `Rack::Directory`â€™s path check used a string prefix match
  on the expanded path. A request like `/../root_example/` can escape the configured
  root if the target path starts with the root string, allowing directory listing
  outside the intended root.

  ## Details

  In `directory.rb`, `File.expand_path(File.join(root,
  path_info)).start_with?(root)` does not enforce a path boundary. If the server root
  is `/var/www/root`, a path like `/var/www/root_backup` passes the check because
  it shares the same prefix, so `Rack::Directory` will list that directory also.

  ## Impact

  Information disclosure via directory listing outside the configured root
  when `Rack::Directory` is exposed to untrusted clients and a directory shares the
  root prefix (e.g., `public2`, `www_backup`).

  ## Mitigation

  * Update to a patched
  version of Rack that correctly checks the root prefix.\n* Don't name directories
  with the same prefix as one which is exposed via `Rack::Directory`."
impacted_packages:
  - purl: pkg:gem/rack
    affected_versions:
    fixed_versions: vers:gem/>=2.2.22|<2.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions:
    fixed_versions: vers:gem/>=3.1.20|<3.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions:
    fixed_versions: vers:gem/>=3.2.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/rack/rack/security/advisories/GHSA-mxw3-3hh2-x2mh
    reference_type:
    reference_id:
