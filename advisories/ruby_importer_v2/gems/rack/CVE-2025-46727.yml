advisory_id: gems/rack/CVE-2025-46727
datasource_id: ruby_importer_v2/gems/rack/CVE-2025-46727
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-46727.yml
aliases:
  - CVE-2025-46727
  - GHSA-gjh7-p2fx-99vx
summary: |
  Rack has an Unbounded-Parameter DoS in Rack::QueryParser
  ## Summary

  `Rack::QueryParser` parses query strings and
  `application/x-www-form-urlencoded` bodies into Ruby data structures
  without imposing any limit on the number of parameters, allowing
  attackers to send requests with extremely large numbers of parameters.

  ## Details

  The vulnerability arises because `Rack::QueryParser` iterates over
  each `&`-separated key-value pair and adds it to a Hash without
  enforcing an upper bound on the total number of parameters. This
  allows an attacker to send a single request containing hundreds of
  thousands (or more) of parameters, which consumes excessive memory
  and CPU during parsing.

  ## Impact

  An attacker can trigger denial of service by sending specifically
  crafted HTTP requests, which can cause memory exhaustion or pin CPU
  resources, stalling or crashing the Rack server. This results in
  full service disruption until the affected worker is restarted.

  ## Mitigation

  - Update to a version of Rack that limits the number of parameters parsed, or
  - Use middleware to enforce a maximum query string size or parameter count, or
  - Employ a reverse proxy (such as Nginx) to limit request sizes and
    reject oversized query strings or bodies.

  Limiting request body sizes and query string lengths at the web
  server or CDN level is an effective mitigation.
impacted_packages:
  - purl: pkg:gem/rack
    affected_versions:
    fixed_versions: vers:gem/>=2.2.14|<2.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions:
    fixed_versions: vers:gem/>=3.0.16|<3.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions:
    fixed_versions: vers:gem/>=3.1.14
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/rack/rack/security/advisories/GHSA-gjh7-p2fx-99vx
    reference_type:
    reference_id:
