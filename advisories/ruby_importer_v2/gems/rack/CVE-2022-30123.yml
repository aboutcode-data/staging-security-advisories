advisory_id: gems/rack/CVE-2022-30123
datasource_id: ruby_importer_v2/gems/rack/CVE-2022-30123
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2022-30123.yml
aliases:
  - CVE-2022-30123
  - GHSA-wq4h-7r42-5hrr
summary: |
  Possible shell escape sequence injection vulnerability in Rack
  There is a possible shell escape sequence injection vulnerability in the Lint
  and CommonLogger components of Rack.  This vulnerability has been assigned the
  CVE identifier CVE-2022-30123.

  Versions Affected:  All.
  Not affected:       None
  Fixed Versions:     2.0.9.1, 2.1.4.1, 2.2.3.1

  ## Impact
  Carefully crafted requests can cause shell escape sequences to be written to
  the terminal via Rack's Lint middleware and CommonLogger middleware.  These
  escape sequences can be leveraged to possibly execute commands in the victim's
  terminal.

  Impacted applications will have either of these middleware installed, and
  vulnerable apps may have something like this:

  ```
  use Rack::Lint
  ```

  Or

  ```
  use Rack::CommonLogger
  ```

  All users running an affected release should either upgrade or use one of the
  workarounds immediately.

  ## Workarounds
  Remove these middleware from your application
impacted_packages:
  - purl: pkg:gem/rack
    affected_versions:
    fixed_versions: vers:gem/>=2.2.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://groups.google.com/g/ruby-security-ann/c/LWB10kWzag8
    reference_type:
    reference_id:
