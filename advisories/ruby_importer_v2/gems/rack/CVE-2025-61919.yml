advisory_id: gems/rack/CVE-2025-61919
datasource_id: ruby_importer_v2/gems/rack/CVE-2025-61919
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61919.yml
aliases:
  - CVE-2025-61919
  - GHSA-6xw4-3v39-52mm
summary: |
  Rack is vulnerable to a memory-exhaustion DoS through unbounded URL-encoded body parsing
  ## Summary

  `Rack::Request#POST` reads the entire request body into memory for
  `Content-Type: application/x-www-form-urlencoded`, calling
  `rack.input.read(nil)` without enforcing a length or cap. Large
  request bodies can therefore be buffered completely into process
  memory before parsing, leading to denial of service (DoS) through
  memory exhaustion.

  ## Details

  When handling non-multipart form submissions, Rackâ€™s request
  parser performs:

  ```ruby
  form_vars = get_header(RACK_INPUT).read
  ```

  Since `read` is called with no argument, the entire request body is
  loaded into a Ruby `String`. This occurs before query parameter
  parsing or enforcement of any `params_limit`. As a result, Rack
  applications without an upstream body-size limit can experience
  unbounded memory allocation proportional to request size.

  ## Impact

  Attackers can send large `application/x-www-form-urlencoded` bodies
  to consume process memory, causing slowdowns or termination by the
  operating system (OOM). The effect scales linearly with request
  size and concurrency. Even with parsing limits configured, the
  issue occurs *before* those limits are enforced.

  ## Mitigation

  * Update to a patched version of Rack that enforces form parameter
    limits using `query_parser.bytesize_limit`, preventing unbounded
    reads of `application/x-www-form-urlencoded` bodies.
  * Enforce strict maximum body size at the proxy or web server layer
    (e.g., Nginx `client_max_body_size`, Apache `LimitRequestBody`).
impacted_packages:
  - purl: pkg:gem/rack
    affected_versions:
    fixed_versions: vers:gem/>=2.2.20|<2.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions:
    fixed_versions: vers:gem/>=3.1.18|<3.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/rack
    affected_versions:
    fixed_versions: vers:gem/>=3.2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/rack/rack/security/advisories/GHSA-6xw4-3v39-52mm
    reference_type:
    reference_id:
