advisory_id: gems/fugit/CVE-2024-43380
datasource_id: ruby_importer_v2/gems/fugit/CVE-2024-43380
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/fugit/CVE-2024-43380.yml
aliases:
  - CVE-2024-43380
  - GHSA-2m96-52r3-2f3g
summary: |
  fugit parse and parse_nat stall on lengthy input
  ### Impact

  The fugit "natural" parser, that turns "every wednesday at 5pm" into
  "0 17 * * 3", accepted any length of input and went on attempting to
  parse it, not returning promptly, as expected. The parse call could
  hold the thread with no end in sight.

  Fugit dependents that do not check (user) input length for
  plausability are impacted.

  ### Patches

  Problem was reported in #104 and the fix was released in
  [fugit 1.11.1](https://rubygems.org/gems/fugit/versions/1.11.1)

  ### Workarounds

  By making sure that `Fugit.parse(s)`, `Fugit.do_parse(s)`,
  `Fugit.parse_nat(s)`, `Fugit.do_parse_nat(s)`, `Fugit::Nat.parse(s)`,
  and `Fugit::Nat.do_parse(s)` are not fed strings too long.
  1000 chars feels ok, while 10_000 chars makes it stall.

  In fewer words, making sure those fugit methods are not fed
  unvetted input strings.
impacted_packages:
  - purl: pkg:gem/fugit
    affected_versions:
    fixed_versions: vers:gem/>=1.11.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/floraison/fugit/security/advisories/GHSA-2m96-52r3-2f3g
    reference_type:
    reference_id:
