advisory_id: gems/decidim-decidim_awesome/CVE-2024-43415
datasource_id: ruby_importer_v2/gems/decidim-decidim_awesome/CVE-2024-43415
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/decidim-decidim_awesome/CVE-2024-43415.yml
aliases:
  - CVE-2024-43415
  - GHSA-cxwf-qc32-375f
summary: |
  Decidim-Awesome has SQL injection in AdminAccountability
  ## Vulnerability type: CWE-89: Improper Neutralization of Special

  Elements used in an SQL Command ('SQL Injection')

  ## Vendor:

  Decidim International
  Community Environment

  ### Has vendor conﬁrmed: Yes

  ### Attack type: Remote

  ### Impact:

  Code Execution
  Escalation of Privileges
  Information Disclosure

  ### Aﬀected component:

  A raw sql-statement that uses an interpolated variable
  exists in the admin_role_actions method of the
  `papertrail/version-model(app/models/decidim/decidim_awesome/paper_trail_version.rb`).

  ### Attack vector:

  An attacker with admin permissions could manipulate database queries
  in order to read out the database, read ﬁles from the ﬁlesystem,
  write ﬁles from the ﬁlesystem. In the worst case, this could lead
  to remote code execution on the server.

  Description of the vulnerability for use in the CVE
  [ℹ] (https://cveproject.github.io/docs/content/key-details-\nphrasing.pdf):
    An improper neutralization of special elements used in an SQL
    command in the `papertrail/version-\nmodel` of the
    decidim_awesome-module <= v0.11.1 (> 0.9.0) allows an authenticated
    admin user to manipulate sql queries\nto disclose information,
    read and write ﬁles or execute commands.

  ### Discoverer Credits: Wolfgang Hotwagner

  ### References:

  https://pentest.ait.ac.at/security-advisory/decidim-awesome-sql-injection-in-adminaccountability
  https://portswigger.net/web-security/sql-injection
impacted_packages:
  - purl: pkg:gem/decidim-decidim_awesome
    affected_versions: vers:gem/>=0.11.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/decidim-decidim_awesome
    affected_versions:
    fixed_versions: vers:gem/>=0.10.3|<0.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/decidim-decidim_awesome
    affected_versions:
    fixed_versions: vers:gem/>=0.11.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.0'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/decidim-ice/decidim-module-decidim_awesome/security/advisories/GHSA-cxwf-qc32-375f
    reference_type:
    reference_id:
