advisory_id: gems/arr-pm/CVE-2022-39224
datasource_id: ruby_importer_v2/gems/arr-pm/CVE-2022-39224
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/arr-pm/CVE-2022-39224.yml
aliases:
  - CVE-2022-39224
  - GHSA-88cv-mj24-8w3q
summary: |
  arr-pm vulnerable to arbitrary shell execution when extracting or listing files contained in a malicious rpm
  ### Impact

  Arbitrary shell execution is possible when using RPM::File#files and
  RPM::File#extract if the RPM contains a malicious "payload compressor" field.

  This vulnerability impacts the `extract` and `files` methods of the
  `RPM::File` class in the affected versions of this library.

  ### Patches

  Version 0.0.12 is available with a fix for these issues.

  ### Workarounds

  When using an affected version of this library (arr-pm), ensure any RPMs
  being processed contain valid/known payload compressor values. Such values
  include: gzip, bzip2, xz, zstd, and lzma.

  You can check the payload compressor field in an rpm by using the rpm command
  line tool. For example:

  ```
  % rpm -qp example-1.0-1.x86_64.rpm --qf "%{PAYLOADCOMPRESSOR}\n"
  gzip
  ```

  ### Impact on known dependent projects

  This library is used by [fpm](https://github.com/jordansissel/fpm). The
  vulnerability may impact fpm only when using the flag `-s rpm` or
  `--input-type rpm` to convert a malicious rpm to another format. It does
  not impact creating rpms.
impacted_packages:
  - purl: pkg:gem/arr-pm
    affected_versions:
    fixed_versions: vers:gem/>=0.0.12
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/jordansissel/ruby-arr-pm/security/advisories/GHSA-88cv-mj24-8w3q
    reference_type:
    reference_id:
