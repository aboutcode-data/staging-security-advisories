advisory_id: gems/pageflow/GHSA-qcqv-38jg-2r43
datasource_id: ruby_importer_v2/gems/pageflow/GHSA-qcqv-38jg-2r43
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/pageflow/GHSA-qcqv-38jg-2r43.yml
aliases:
  - GHSA-qcqv-38jg-2r43
summary: |
  Pageflow vulnerable to insecure direct object reference in membership update endpoint
  ### Impact

  Pageflow has a membership edit feature which allows users to edit the roles of user
  memberships associated with an account that they have the `manager` role to (including
  their own). While the `Entity` dropdown select field is greyed out in the UI, an attacker
  can use tools which allow sending arbitrary HTTP request to craft a request to the
  `/admin/users/{user_id}/memberships/{membership_id}` endpoint containing an additional
  `membership[entity_id]` parameter. This parameter is honored when the membership is
  updated, allowing an attacker to update the membership object associated with their own
  account (with `manager` role) to be associated with a different attacker-chosen account
  instead. Since `account_id`s are enumerable, an attacker can compromise all accounts
  present on the platform.

  ### Mitigation

  Upgrade to version 15.7.1 or 14.5.2 of the `pageflow` gem.
impacted_packages:
  - purl: pkg:gem/pageflow
    affected_versions:
    fixed_versions: vers:gem/>=14.5.2|<14.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/pageflow
    affected_versions:
    fixed_versions: vers:gem/>=15.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/codevise/pageflow/security/advisories/GHSA-qcqv-38jg-2r43
    reference_type:
    reference_id:
