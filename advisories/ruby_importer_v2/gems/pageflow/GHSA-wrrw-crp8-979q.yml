advisory_id: gems/pageflow/GHSA-wrrw-crp8-979q
datasource_id: ruby_importer_v2/gems/pageflow/GHSA-wrrw-crp8-979q
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/pageflow/GHSA-wrrw-crp8-979q.yml
aliases:
  - GHSA-wrrw-crp8-979q
summary: |
  Pageflow vulnerable to sensitive user data extraction via Ransack query injection
  ### Impact

  The attack allows extracting sensitive properties of database objects that are
  associated with users or entries belonging to an account that the attacker has access
  to.

  Pageflow uses the `ActiveAdmin` Ruby library to provide some management features to
  its users. `ActiveAdmin` relies on the `Ransack` library to implement search
  functionality. In its default configuration, `Ransack` will allow for query conditions
  based on properties of associated database objects [1]. The `*_starts_with`,
  `*_ends_with` or `*_contains` search matchers [2] can then be abused to exfiltrate
  sensitive string values of associated database objects via character-by-character
  brute-force.

  [1] https://activerecord-hackery.github.io/ransack/going-further/associations/
  [2] https://activerecord-hackery.github.io/ransack/getting-started/search-matches/

  ### Mitigation

  Upgrade to version 15.7.1 or 14.5.2 of the `pageflow` gem.
impacted_packages:
  - purl: pkg:gem/pageflow
    affected_versions:
    fixed_versions: vers:gem/>=14.5.2|<14.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/pageflow
    affected_versions:
    fixed_versions: vers:gem/>=15.7.1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/codevise/pageflow/security/advisories/GHSA-wrrw-crp8-979q
    reference_type:
    reference_id:
