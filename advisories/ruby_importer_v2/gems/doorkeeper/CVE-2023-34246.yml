advisory_id: gems/doorkeeper/CVE-2023-34246
datasource_id: ruby_importer_v2/gems/doorkeeper/CVE-2023-34246
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/doorkeeper/CVE-2023-34246.yml
aliases:
  - CVE-2023-34246
  - GHSA-7w2c-w47h-789w
summary: |
  Doorkeeper Improper Authentication vulnerability
  OAuth RFC 8252 says  https://www.rfc-editor.org/rfc/rfc8252#section-8.6

  > the authorization server SHOULD NOT process authorization requests
  > automatically without user consent or interaction, except when the
  > identity of the client can be assured. **This includes the case
  > where the user has previously approved an authorization request
  > for a given client id**

  But Doorkeeper automatically processes authorization requests without
  user consent for public clients that have been previous approved.
  Public clients are inherently  vulnerable to impersonation, their
  identity cannot be assured.

  Issue https://github.com/doorkeeper-gem/doorkeeper/issues/1589

  Fix https://github.com/doorkeeper-gem/doorkeeper/pull/1646
impacted_packages:
  - purl: pkg:gem/doorkeeper
    affected_versions:
    fixed_versions: vers:gem/>=5.6.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.2'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/advisories/GHSA-7w2c-w47h-789w
    reference_type:
    reference_id:
