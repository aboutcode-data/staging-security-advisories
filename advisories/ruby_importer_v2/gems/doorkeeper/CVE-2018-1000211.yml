advisory_id: gems/doorkeeper/CVE-2018-1000211
datasource_id: ruby_importer_v2/gems/doorkeeper/CVE-2018-1000211
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/doorkeeper/CVE-2018-1000211.yml
aliases:
  - CVE-2018-1000211
  - GHSA-694m-jhr9-pf77
summary: |
  Doorkeeper gem does not revoke token for public clients
  Any OAuth application that uses public/non-confidential authentication when
  interacting with Doorkeeper is unable to revoke its tokens when calling the
  revocation endpoint.

  A bug in the token revocation API would cause it to attempt to authenticate
  the public OAuth client as if it was a confidential app. Because of this, the
  token is never revoked.

  The impact of this is the access or refresh token is not revoked, leaking
  access to protected resources for the remainder of that token's lifetime.

  If Doorkeeper is used to facilitate public OAuth apps and leverage token
  revocation functionality, upgrade to the patched versions immediately.

  Credit to Roberto Ostinelli for discovery, Justin Bull for the fixes.

  DWF has assigned CVE-2018-1000211.
impacted_packages:
  - purl: pkg:gem/doorkeeper
    affected_versions: vers:gem/>=4.2.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/doorkeeper
    affected_versions:
    fixed_versions: vers:gem/>=4.4.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/doorkeeper
    affected_versions:
    fixed_versions: vers:gem/>=5.0.0.rc2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://blog.justinbull.ca/cve-2018-1000211-public-apps-cant-revoke-tokens-in-doorkeeper/
    reference_type:
    reference_id:
