advisory_id: gems/doorkeeper/CVE-2018-1000088
datasource_id: ruby_importer_v2/gems/doorkeeper/CVE-2018-1000088
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/doorkeeper/CVE-2018-1000088.yml
aliases:
  - CVE-2018-1000088
  - GHSA-hwhh-2fwm-cfgw
summary: |
  Doorkeeper gem has stored XSS on authorization consent view
  Stored XSS on the OAuth Client's name will cause users being prompted for
  consent via the "implicit" grant type to execute the XSS payload.

  The XSS attack could gain access to the user's active session, resulting in
  account compromise.

  Any user is susceptible if they click the authorization link for the
  malicious OAuth client. Because of how the links work, a user cannot tell if
  a link is malicious or not without first visiting the page with the XSS
  payload.

  If 3rd parties are allowed to create OAuth clients in the app using
  Doorkeeper, upgrade to the patched versions immediately.

  Additionally there is stored XSS in the native_redirect_uri form element.

  DWF has assigned CVE-2018-1000088.
impacted_packages:
  - purl: pkg:gem/doorkeeper
    affected_versions: vers:gem/>=2.1.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/doorkeeper
    affected_versions:
    fixed_versions: vers:gem/>=4.2.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.6'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://blog.justinbull.ca/cve-2018-1000088-stored-xss-in-doorkeeper/
    reference_type:
    reference_id:
