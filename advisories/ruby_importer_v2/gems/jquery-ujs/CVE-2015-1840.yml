advisory_id: gems/jquery-ujs/CVE-2015-1840
datasource_id: ruby_importer_v2/gems/jquery-ujs/CVE-2015-1840
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/jquery-ujs/CVE-2015-1840.yml
aliases:
  - CVE-2015-1840
  - GHSA-4whc-pp4x-9pf3
summary: |
  CSRF Vulnerability in jquery-ujs
  In the scenario where an attacker might be able to control the href attribute
  of an anchor tag or the action attribute of a form tag that will trigger a
  POST action, the attacker can set the href or action to
  " https://attacker.com" (note the leading space) that will be passed to
  JQuery, who will see this as a same origin request, and send the user's CSRF
  token to the attacker domain.

  To work around this problem, change code that allows users to control the
  href attribute of an anchor tag or the action attribute of a form tag to
  filter the user parameters.

  For example, code like this:

    link_to params

  to code like this:

    link_to filtered_params

    def filtered_params
      \# Filter just the parameters that you trust
    end

  See also:
    - http://blog.honeybadger.io/understanding-the-rails-jquery-csrf-vulnerability-cve-2015-1840/
impacted_packages:
  - purl: pkg:gem/jquery-ujs
    affected_versions:
    fixed_versions: vers:gem/>=1.0.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://groups.google.com/forum/#!topic/ruby-security-ann/XIZPbobuwaY
    reference_type:
    reference_id:
