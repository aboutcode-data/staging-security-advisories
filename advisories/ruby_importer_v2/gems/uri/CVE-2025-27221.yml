advisory_id: gems/uri/CVE-2025-27221
datasource_id: ruby_importer_v2/gems/uri/CVE-2025-27221
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/uri/CVE-2025-27221.yml
aliases:
  - CVE-2025-27221
  - GHSA-22h5-pq3x-2gf2
summary: |
  CVE-2025-27221 - userinfo leakage in URI#join, URI#merge and URI#+.
  There is a possibility for userinfo leakage by in the uri gem.
  This vulnerability has been assigned the CVE identifier
  CVE-2025-27221. We recommend upgrading the uri gem.

  ## Details

  The methods URI#join, URI#merge, and URI#+ retained userinfo, such
  as user:password, even after the host is replaced. When generating
  a URL to a malicious host from a URL containing secret userinfo
  using these methods, and having someone access that URL, an
  unintended userinfo leak could occur.

  Please update URI gem to version 0.11.3, 0.12.4, 0.13.2, 1.0.3 or later.

  ## Affected versions

  uri gem versions < 0.11.3, 0.12.0 to 0.12.3, 0.13.0, 0.13.1 and
  1.0.0 to 1.0.2.

  ## Credits

  Thanks to Tsubasa Irisawa (lambdasawa) for discovering this issue.
  Also thanks to nobu for additional fixes of this vulnerability.
impacted_packages:
  - purl: pkg:gem/uri
    affected_versions:
    fixed_versions: vers:gem/>=0.11.3|<0.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/uri
    affected_versions:
    fixed_versions: vers:gem/>=0.12.4|<0.13
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/uri
    affected_versions:
    fixed_versions: vers:gem/>=0.13.2|<0.14
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/uri
    affected_versions:
    fixed_versions: vers:gem/>=1.0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-27221
    reference_type:
    reference_id:
