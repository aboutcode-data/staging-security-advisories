advisory_id: gems/google_sign_in/CVE-2025-58067
datasource_id: ruby_importer_v2/gems/google_sign_in/CVE-2025-58067
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/google_sign_in/CVE-2025-58067.yml
aliases:
  - CVE-2025-58067
  - GHSA-5jch-xhw4-r43v
summary: |
  Google Sign-In for Rails allowed redirect to protocol-relative URI
  ## Summary

  It is possible to redirect a user to another origin if the
  "proceed_to" value in the session store is set to a
  protocol-relative URL.

  ## Details

  The google_sign_in gem persists an optional URL for redirection
  after authentication. If this URL is set to a protocol-relative URL,
  it improperly passes the "same origin" check, and it's possible
  for the user to be redirected to another origin after authentication,
  possibly resulting in exposure of authentication information if
  this attack is chained with other attacks.

  Normally the value of this URL is only written and read by the
  library or the calling application. However, it may be possible to
  set this session value from a malicious site with a form submission.

  ## Impact

  Any Rails applications using the google_sign_in gem may be vulnerable,
  if this vector can be chained with another attack that is able to
  modify the OAuth2 request parameters.

  ## Workarounds

  No known workarounds.

  ## Credits

  This issue was responsibly reported by Hackerone user
  [muntrive](https://hackerone.com/muntrive?type=user).
impacted_packages:
  - purl: pkg:gem/google_sign_in
    affected_versions:
    fixed_versions: vers:gem/>=1.3.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.2'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/basecamp/google_sign_in/security/advisories/GHSA-5jch-xhw4-r43v
    reference_type:
    reference_id:
