advisory_id: gems/puma/CVE-2024-45614
datasource_id: ruby_importer_v2/gems/puma/CVE-2024-45614
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/puma/CVE-2024-45614.yml
aliases:
  - CVE-2024-45614
  - GHSA-9hf4-67fc-4vf4
summary: |
  Puma's header normalization allows for client to clobber proxy set headers
  ### Impact

  Clients could clobber values set by intermediate proxies (such as
  X-Forwarded-For) by providing a underscore version of the same
  header (X-Forwarded_For).

  Any users trusting headers set by their proxy may be affected.
  Attackers may be able to downgrade connections to HTTP (non-SSL)
  or redirect responses, which could cause confidentiality leaks
  if combined with a separate MITM attack.

  ### Patches
  v6.4.3/v5.6.9 now discards any headers using underscores if the
  non-underscore version also exists.  Effectively, allowing the
  proxy defined headers to always win.

  ### Workarounds
  Nginx has a [underscores_in_headers](https://nginx.org/en/docs/http/ngx_http_core_module.html#underscores_in_headers)
  configuration variable to discard these headers at the proxy level.

  Any users that are implicitly trusting the proxy defined headers
  for security or availability should immediately cease doing so
  until upgraded to the fixed versions.
impacted_packages:
  - purl: pkg:gem/puma
    affected_versions:
    fixed_versions: vers:gem/>=5.6.9|<5.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/puma
    affected_versions:
    fixed_versions: vers:gem/>=6.4.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/puma/puma/security/advisories/GHSA-9hf4-67fc-4vf4
    reference_type:
    reference_id:
