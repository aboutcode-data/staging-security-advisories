advisory_id: gems/yard/CVE-2024-27285
datasource_id: ruby_importer_v2/gems/yard/CVE-2024-27285
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/yard/CVE-2024-27285.yml
aliases:
  - CVE-2024-27285
  - GHSA-8mq4-9jjh-9xrc
summary: |
  YARD's default template vulnerable to Cross-site Scripting in generated frames.html
  ### Summary

  The "frames.html" file within the Yard Doc's generated documentation
  is vulnerable to Cross-Site Scripting (XSS) attacks due to inadequate
  sanitization of user input within the JavaScript segment of the
  "frames.erb" template file.

  ### Details

  The vulnerability stems from mishandling user-controlled data retrieved
  from the URL hash in the embedded JavaScript code within the "frames.erb"
  template file. Specifically, the script lacks proper sanitization of
  the hash data before utilizing it to establish the top-level window's
  location. This oversight permits an attacker to inject malicious
  JavaScript payloads through carefully crafted URLs.

  Snippet from "frames.erb":
  (v0.9.34)
  ```erb
  <script type="text/javascript">
    var match = unescape(window.location.hash).match(/^#!(.+)/);
    var name = match ? match[1] : '<%= url_for_main %>';
    name = name.replace(/^(\w+):\/\//, '').replace(/^\/\//, '');
    window.top.location = name;
  </script>
  ```

  (v0.9.35)
  ```erb
  <script type="text/javascript">
    var match = decodeURIComponent(window.location.hash).match(/^#!(.+)/);
    var name = match ? match[1] : '<%= url_for_main %>';
    name = name.replace(/^((\w*):)?[\/\\]*/gm, '').trim();
    window.top.location.replace(name)
  </script>
  ```

  ### Impact

  This XSS vulnerability presents a substantial threat by enabling
  an attacker to execute arbitrary JavaScript code within the user's
  session context. Potential ramifications include session hijacking,
  theft of sensitive data, unauthorized access to user accounts, and
  defacement of websites. Any user visiting the compromised page is
  susceptible to exploitation. It is critical to promptly address
  this vulnerability to mitigate potential harm to users and preserve
  the application's integrity.
impacted_packages:
  - purl: pkg:gem/yard
    affected_versions:
    fixed_versions: vers:gem/>=0.9.36
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/advisories/GHSA-8mq4-9jjh-9xrc
    reference_type:
    reference_id:
