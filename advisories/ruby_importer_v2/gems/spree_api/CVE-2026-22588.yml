advisory_id: gems/spree_api/CVE-2026-22588
datasource_id: ruby_importer_v2/gems/spree_api/CVE-2026-22588
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/spree_api/CVE-2026-22588.yml
aliases:
  - CVE-2026-22588
  - GHSA-g268-72p7-9j6j
summary: |
  Spree API has Authenticated Insecure Direct Object Reference (IDOR) via Order Modification
  ### Summary

  An Authenticated Insecure Direct Object Reference (IDOR)
  vulnerability was identified that allows an authenticated user to
  retrieve other users’ address information by modifying an existing order.
  By editing an order they legitimately own and manipulating address
  identifiers in the request, the backend server accepts and processes
  references to addresses belonging to other users, subsequently
  associating those addresses with the attacker’s order and returning
  them in the response.

  ### Details

  Affected Component(s)

  - Authenticated user order management
  - Address association logic
  - Order update endpoint(s)

  Affected Endpoint(s):
  - `/api/v2/storefront/checkout`

  The application fails to enforce proper object-level authorization
  when updating an existing order. While the user is authenticated and
  authorized to modify their own order, the backend does not verify
  that the supplied address identifiers belong to the same authenticated user.

  **See reference below for POC.**

  ### Impact

  As a result, an attacker can:
  - Replace the address identifier with one belonging to another user
  - Cause the backend to associate and return another user’s address
    within the attacker’s order"
impacted_packages:
  - purl: pkg:gem/spree_api
    affected_versions: vers:gem/>=3.7.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_api
    affected_versions:
    fixed_versions: vers:gem/>=4.10.2|<4.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_api
    affected_versions:
    fixed_versions: vers:gem/>=5.0.7|<5.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_api
    affected_versions:
    fixed_versions: vers:gem/>=5.1.9|<5.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/spree_api
    affected_versions:
    fixed_versions: vers:gem/>=5.2.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/spree/spree/security/advisories/GHSA-g268-72p7-9j6j
    reference_type:
    reference_id:
