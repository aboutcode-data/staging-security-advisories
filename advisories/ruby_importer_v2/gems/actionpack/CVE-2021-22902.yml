advisory_id: gems/actionpack/CVE-2021-22902
datasource_id: ruby_importer_v2/gems/actionpack/CVE-2021-22902
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2021-22902.yml
aliases:
  - CVE-2021-22902
  - GHSA-g8ww-46x2-2p65
summary: |
  Possible Denial of Service vulnerability in Action Dispatch
  There is a possible Denial of Service vulnerability in the Mime type parser of
  Action Dispatch. This vulnerability has been assigned the CVE identifier
  CVE-2021-22902.

  Versions Affected:  >= 6.0.0
  Not affected:       < 6.0.0
  Fixed Versions:     6.0.3.7, 6.1.3.2

  Impact
  ------
  There is a possible Denial of Service vulnerability in Action Dispatch.
  Carefully crafted Accept headers can cause the mime type parser in Action
  Dispatch to do catastrophic backtracking in the regular expression engine.

  Workarounds
  -----------
  The following monkey patch placed in an initializer can be used to work around
  the issue:

  ```ruby
  module Mime
    class Type
      MIME_REGEXP = /\A(?:\*\/\*|#{MIME_NAME}\/(?:\*|#{MIME_NAME})(?>\s*#{MIME_PARAMETER}\s*)*)\z/
    end
  end
  ```
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=6.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions:
    fixed_versions: vers:gem/>=6.1.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://groups.google.com/g/rubyonrails-security/c/_5ID_ld9u1c
    reference_type:
    reference_id:
