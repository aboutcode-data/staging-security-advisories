advisory_id: gems/actionpack/CVE-2021-44528
datasource_id: ruby_importer_v2/gems/actionpack/CVE-2021-44528
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2021-44528.yml
aliases:
  - CVE-2021-44528
  - GHSA-qphc-hf5q-v8fc
summary: |
  Possible Open Redirect in Host Authorization Middleware
  There is a possible open redirect vulnerability in the Host Authorization
  middleware in Action Pack.

  Specially crafted "X-Forwarded-Host" headers in combination with certain
  "allowed host" formats can cause the Host Authorization middleware in Action
  Pack to redirect users to a malicious website.

  Impacted applications will have allowed hosts with a leading dot. For example,
  configuration files that look like this:

  ```
  config.hosts <<  '.EXAMPLE.com'
  ```

  When an allowed host contains a leading dot, a specially crafted Host header
  can be used to redirect to a malicious website.

  This vulnerability is similar to CVE-2021-22881 and CVE-2021-22942.

  Releases
  --------
  The fixed releases are available at the normal locations.

  Patches
  -------
  To aid users who aren't able to upgrade immediately we have provided patches for
  the two supported release series. They are in git-am format and consist of a
  single changeset.

  * 6-0-host-authorzation-open-redirect.patch - Patch for 6.0 series
  * 6-1-host-authorzation-open-redirect.patch - Patch for 6.1 series
  * 7-0-host-authorzation-open-redirect.patch - Patch for 7.0 series

  Please note that only the 6.1.Z, 6.0.Z, and 5.2.Z series are supported at
  present. Users of earlier unsupported releases are advised to upgrade as soon
  as possible as we cannot guarantee the continued availability of security
  fixes for unsupported releases.
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=6.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions:
    fixed_versions: vers:gem/>=7.0.0.rc2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://groups.google.com/g/ruby-security-ann/c/vG9gz3nk1pM/m/7-NU4MNrDAAJ
    reference_type:
    reference_id:
