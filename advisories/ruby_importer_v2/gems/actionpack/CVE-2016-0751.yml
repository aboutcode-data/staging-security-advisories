advisory_id: gems/actionpack/CVE-2016-0751
datasource_id: ruby_importer_v2/gems/actionpack/CVE-2016-0751
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2016-0751.yml
aliases:
  - CVE-2016-0751
  - GHSA-ffpv-c4hm-3x6v
summary: |
  Possible Object Leak and Denial of Service attack in Action Pack
  There is a possible object leak which can lead to a denial of service
  vulnerability in Action Pack. This vulnerability has been
  assigned the CVE identifier CVE-2016-0751.

  Versions Affected:  All.
  Not affected:       None.
  Fixed Versions:     5.0.0.beta1.1, 4.2.5.1, 4.1.14.1, 3.2.22.1

  Impact
  ------
  A carefully crafted accept header can cause a global cache of mime types to
  grow indefinitely which can lead to a possible denial of service attack in
  Action Pack.

  All users running an affected release should either upgrade or use one of the
  workarounds immediately.

  Releases
  --------
  The FIXED releases are available at the normal locations.

  Workarounds
  -----------
  This attack can be mitigated by a proxy that only allows known mime types in
  the Accept header.

  Placing the following code in an initializer will also mitigate the issue:

  ```ruby
  require 'action_dispatch/http/mime_type'

  Mime.const_set :LOOKUP, Hash.new { |h,k|
    Mime::Type.new(k) unless k.blank?
  }
  ```

  Patches
  -------
  To aid users who aren't able to upgrade immediately we have provided patches for
  the two supported release series. They are in git-am format and consist of a
  single changeset.

  * 5-0-mime_types_leak.patch - Patch for 5.0 series
  * 4-2-mime_types_leak.patch - Patch for 4.2 series
  * 4-1-mime_types_leak.patch - Patch for 4.1 series
  * 3-2-mime_types_leak.patch - Patch for 3.2 series

  Please note that only the 4.1.x and 4.2.x series are supported at present. Users
  of earlier unsupported releases are advised to upgrade as soon as possible as we
  cannot guarantee the continued availability of security fixes for unsupported
  releases.

  Credits
  -------
  Aaron Patterson <3<3
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions:
    fixed_versions: vers:gem/>=5.0.0.beta1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions:
    fixed_versions: vers:gem/>=3.2.22.1|<3.2.23
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://groups.google.com/forum/#!topic/rubyonrails-security/9oLY_FCzvoc
    reference_type:
    reference_id:
