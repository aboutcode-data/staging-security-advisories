advisory_id: gems/actionpack/CVE-2020-8185
datasource_id: ruby_importer_v2/gems/actionpack/CVE-2020-8185
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2020-8185.yml
aliases:
  - CVE-2020-8185
  - GHSA-c6qr-h5vq-59jc
summary: |
  Untrusted users able to run pending migrations in production
  There is a vulnerability in versions of Rails prior to 6.0.3.2 that allowed
  an untrusted user to run any pending migrations on a Rails app running in
  production.

  This vulnerability has been assigned the CVE identifier CVE-2020-8185.

  Versions Affected:  6.0.0 < rails < 6.0.3.2
  Not affected:       Applications with `config.action_dispatch.show_exceptions = false` (this is not a default setting in production)
  Fixed Versions:     rails >= 6.0.3.2

  Impact
  ------

  Using this issue, an attacker would be able to execute any migrations that
  are pending for a Rails app running in production mode. It is important to
  note that an attacker is limited to running migrations the application
  developer has already defined in their application and ones that have not
  already ran.

  Workarounds
  -----------

  Until such time as the patch can be applied, application developers should
  disable the ActionDispatch middleware in their production environment via
  a line such as this one in their config/environment/production.rb:

  `config.middleware.delete ActionDispatch::ActionableExceptions`
impacted_packages:
  - purl: pkg:gem/actionpack
    affected_versions: vers:gem/>=6.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/actionpack
    affected_versions:
    fixed_versions: vers:gem/>=6.0.3.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://groups.google.com/g/rubyonrails-security/c/pAe9EV8gbM0
    reference_type:
    reference_id:
