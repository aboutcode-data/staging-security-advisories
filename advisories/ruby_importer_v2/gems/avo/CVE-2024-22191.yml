advisory_id: gems/avo/CVE-2024-22191
datasource_id: ruby_importer_v2/gems/avo/CVE-2024-22191
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/avo/CVE-2024-22191.yml
aliases:
  - CVE-2024-22191
  - GHSA-ghjv-mh6x-7q6h
summary: |
  avo vulnerable to stored cross-site scripting (XSS) in key_value field
  ### Summary

  A **stored cross-site scripting (XSS)** vulnerability was found in
  the **key_value** field of Avo v3.2.3. This vulnerability could allow
  an attacker to execute arbitrary JavaScript code in the victim's browser.

  ### Details

  The value of the key_value is inserted directly into the HTML code.
  In the current version of Avo (possibly also older versions), the
  value is not properly sanitized before it is inserted into the HTML code.

  This vulnerability can be exploited by an attacker to inject malicious
  JavaScript code into the key_value field. When a victim views the page
  containing the malicious code, the code will be executed in their browser.

  In [avo/fields/common/key_value_component.html.erb](https://github.com/avo-hq/avo/blob/main/app/components/avo/fields/common/key_value_component.html.erb#L38C21-L38C33)
  the value is taken in lines **38** and **49** and seems to be
  interpreted directly as html in lines **44** and **55**.

  ### Impact

  This vulnerability could be used to steal sensitive information from
  victims that could be used to hijack victims' accounts or redirect
  them to malicious websites.
impacted_packages:
  - purl: pkg:gem/avo
    affected_versions:
    fixed_versions: vers:gem/>=3.2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/avo
    affected_versions:
    fixed_versions: vers:gem/>=2.47|<3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/avo-hq/avo/security/advisories/GHSA-ghjv-mh6x-7q6h
    reference_type:
    reference_id:
