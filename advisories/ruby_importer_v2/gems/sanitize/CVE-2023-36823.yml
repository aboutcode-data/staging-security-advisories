advisory_id: gems/sanitize/CVE-2023-36823
datasource_id: ruby_importer_v2/gems/sanitize/CVE-2023-36823
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sanitize/CVE-2023-36823.yml
aliases:
  - CVE-2023-36823
  - GHSA-f5ww-cq3m-q3g7
summary: |
  Sanitize vulnerable to Cross-site Scripting via insufficient neutralization  of `style` element content
  ### Impact

  Using carefully crafted input, an attacker may be able to sneak
  arbitrary HTML and CSS through Sanitize `>= 3.0.0, < 6.0.2` when
  Sanitize is configured to use the built-in "relaxed" config or
  when using a custom config that allows `style` elements and one
  or more CSS at-rules. This could result in XSS (cross-site scripting)
  or other undesired behavior when the malicious HTML and CSS are
  rendered in a browser.

  ### Patches

  Sanitize `>= 6.0.2` performs additional escaping of CSS in `style`
  element content, which fixes this issue.

  ### Workarounds

  Users who are unable to upgrade can prevent this issue by using a
  Sanitize config that doesn't allow `style` elements, using a Sanitize
  config that doesn't allow CSS at-rules, or by manually escaping the
  character sequence `</` as `<\/` in `style` element content.

  ### Credit

  This issue was found by @cure53 during an audit of a project that
  uses Sanitize and was reported by one of that project's maintainers.
  Thank you!
impacted_packages:
  - purl: pkg:gem/sanitize
    affected_versions: vers:gem/>=3.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/sanitize
    affected_versions:
    fixed_versions: vers:gem/>=6.0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/rgrove/sanitize/releases/tag/v6.0.2
    reference_type:
    reference_id:
