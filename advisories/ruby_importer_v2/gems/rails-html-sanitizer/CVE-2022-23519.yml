advisory_id: gems/rails-html-sanitizer/CVE-2022-23519
datasource_id: ruby_importer_v2/gems/rails-html-sanitizer/CVE-2022-23519
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rails-html-sanitizer/CVE-2022-23519.yml
aliases:
  - CVE-2022-23519
  - GHSA-9h9g-93gc-623h
summary: |
  Possible XSS vulnerability with certain configurations of rails-html-sanitizer
  ## Summary

  There is a possible XSS vulnerability with certain configurations of Rails::Html::Sanitizer.

  - Versions affected: ALL
  - Not affected: NONE
  - Fixed versions: 1.4.4

  ## Impact

  A possible XSS vulnerability with certain configurations of Rails::Html::Sanitizer may allow an attacker to inject content if the application developer has overridden the sanitizer's allowed tags in either of the following ways:

  - allow both "math" and "style" elements,
  - or allow both "svg" and "style" elements

  Code is only impacted if allowed tags are being overridden. Applications may be doing this in four different ways:

  1. using application configuration:

    ```ruby
    # In config/application.rb
    config.action_view.sanitized_allowed_tags = ["math", "style"]
    # or
    config.action_view.sanitized_allowed_tags = ["svg", "style"]
    ```

    see https://guides.rubyonrails.org/configuring.html#configuring-action-view

  2. using a `:tags` option to the Action View helper `sanitize`:

    ```
    <%= sanitize @comment.body, tags: ["math", "style"] %>
    <%# or %>
    <%= sanitize @comment.body, tags: ["svg", "style"] %>
    ```

    see https://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-sanitize

  3. using Rails::Html::SafeListSanitizer class method `allowed_tags=`:

    ```ruby
    # class-level option
    Rails::Html::SafeListSanitizer.allowed_tags = ["math", "style"]
    # or
    Rails::Html::SafeListSanitizer.allowed_tags = ["svg", "style"]
    ```

  4. using a `:tags` options to the Rails::Html::SafeListSanitizer instance method `sanitize`:

    ```ruby
    # instance-level option
    Rails::Html::SafeListSanitizer.new.sanitize(@article.body, tags: ["math", "style"])
    # or
    Rails::Html::SafeListSanitizer.new.sanitize(@article.body, tags: ["svg", "style"])
    ```

  All users overriding the allowed tags by any of the above mechanisms to include (("math" or "svg") and "style") should either upgrade or use one of the workarounds immediately.

  ## Workarounds

  Remove "style" from the overridden allowed tags, or remove "math" and "svg" from the overridden allowed tags.
impacted_packages:
  - purl: pkg:gem/rails-html-sanitizer
    affected_versions:
    fixed_versions: vers:gem/>=1.4.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/rails/rails-html-sanitizer/security/advisories/GHSA-9h9g-93gc-623h
    reference_type:
    reference_id:
