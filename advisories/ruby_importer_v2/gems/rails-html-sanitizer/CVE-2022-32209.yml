advisory_id: gems/rails-html-sanitizer/CVE-2022-32209
datasource_id: ruby_importer_v2/gems/rails-html-sanitizer/CVE-2022-32209
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rails-html-sanitizer/CVE-2022-32209.yml
aliases:
  - CVE-2022-32209
  - GHSA-pg8v-g4xq-hww9
summary: |
  Possible XSS vulnerability with certain configurations of Rails::Html::Sanitizer
  There is a possible XSS vulnerability with certain configurations of Rails::Html::Sanitizer.
  This vulnerability has been assigned the CVE identifier CVE-2022-32209.

  Versions Affected: ALL
  Not affected: NONE
  Fixed Versions: v1.4.3

  ## Impact

  A possible XSS vulnerability with certain configurations of Rails::Html::Sanitizer
  may allow an attacker to inject content if the application developer has overridden
  the sanitizer's allowed tags to allow both `select` and `style` elements.

  Code is only impacted if allowed tags are being overridden. This may be done via
  application configuration:

  ```ruby
  # In config/application.rb
  config.action_view.sanitized_allowed_tags = ["select", "style"]
  ```

  see https://guides.rubyonrails.org/configuring.html#configuring-action-view

  Or it may be done with a `:tags` option to the Action View helper `sanitize`:

  ```
  <%= sanitize @comment.body, tags: ["select", "style"] %>
  ```

  see https://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-sanitize

  Or it may be done with Rails::Html::SafeListSanitizer directly:

  ```ruby
  # class-level option
  Rails::Html::SafeListSanitizer.allowed_tags = ["select", "style"]
  ```

  or

  ```ruby
  # instance-level option
  Rails::Html::SafeListSanitizer.new.sanitize(@article.body, tags: ["select", "style"])
  ```

  All users overriding the allowed tags by any of the above mechanisms to include
  both "select" and "style" should either upgrade or use one of the workarounds immediately.

  ## Workarounds

  Remove either `select` or `style` from the overridden allowed tags.
impacted_packages:
  - purl: pkg:gem/rails-html-sanitizer
    affected_versions:
    fixed_versions: vers:gem/>=1.4.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://groups.google.com/g/rubyonrails-security/c/ce9PhUANQ6s
    reference_type:
    reference_id:
