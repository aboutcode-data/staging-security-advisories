advisory_id: gems/fat_free_crm/CVE-2022-39281
datasource_id: ruby_importer_v2/gems/fat_free_crm/CVE-2022-39281
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/fat_free_crm/CVE-2022-39281.yml
aliases:
  - CVE-2022-39281
  - GHSA-p75c-5x3h-cxcg
summary: |
  Fat Free CRM vulnerable to Remote Denial of Service via Tasks endpoint
  ### Impact
  An authenticated user can perform a remote Denial of Service attack against
  Fat Free CRM.

  This vulnerability has been assigned the CVE identifier: CVE-2022-39281

  Affected versions: All
  Not affected: None
  Fixed versions: 0.20.1

  All users running an affected release should either upgrade or apply the patch
  immediately.

  ### Releases
  Fixed versions: 0.20.1 and above

  ### Patches

  If you are unable to upgrade immediately, you should apply the following
  patch.

  ```
  diff --git a/app/models/polymorphic/task.rb b/app/models/polymorphic/task.rb
  index d3d5c32c..7cdb24d6 100644
  --- a/app/models/polymorphic/task.rb
  +++ b/app/models/polymorphic/task.rb
  @@ -189,6 +189,7 @@ class Task < ActiveRecord::Base
     #----------------------------------------------------------------------------
     def self.bucket_empty?(bucket, user, view = "pending")
       return false if bucket.blank? || !ALLOWED_VIEWS.include?(view)
  +    return false unless Setting.task_bucket.map(&:to_s).include?(bucket.to_s)

       if view == "assigned"
         assigned_by(user).send(bucket).pending.count
  ```
impacted_packages:
  - purl: pkg:gem/fat_free_crm
    affected_versions:
    fixed_versions: vers:gem/>=0.20.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/fatfreecrm/fat_free_crm/security/advisories/GHSA-p75c-5x3h-cxcg
    reference_type:
    reference_id:
