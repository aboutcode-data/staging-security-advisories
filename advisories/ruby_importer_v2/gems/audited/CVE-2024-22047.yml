advisory_id: gems/audited/CVE-2024-22047
datasource_id: ruby_importer_v2/gems/audited/CVE-2024-22047
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/audited/CVE-2024-22047.yml
aliases:
  - CVE-2024-22047
  - GHSA-hjp3-5g2q-7jww
summary: |
  Race Condition leading to logging errors
  In certain setups with threaded web servers, Audited's use of
  `Thread.current` can incorrectly attributed audits to the wrong user.

  Fixed in 5.3.3.

  In March, @convisoappsec noticed that the library in question had a
  Race Condition problem, which caused logs to be registered at times
  with different users than those who performed the genuine actions.

  - The first issue we identified was from November
    2021: https://github.com/collectiveidea/audited/issues/601

  - So the solution was implemented in the following Pull Request:
    https://github.com/collectiveidea/audited/pull/669

  - And the feature was published in version 5.3.3:
    RELEASE: https://github.com/collectiveidea/audited/pull/671
impacted_packages:
  - purl: pkg:gem/audited
    affected_versions: vers:gem/>=4.0.0
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:gem/audited
    affected_versions:
    fixed_versions: vers:gem/>=5.3.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/collectiveidea/audited/security/advisories/GHSA-hjp3-5g2q-7jww
    reference_type:
    reference_id:
