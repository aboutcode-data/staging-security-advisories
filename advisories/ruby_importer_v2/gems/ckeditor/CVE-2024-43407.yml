advisory_id: gems/ckeditor/CVE-2024-43407
datasource_id: ruby_importer_v2/gems/ckeditor/CVE-2024-43407
datasource_url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/ckeditor/CVE-2024-43407.yml
aliases:
  - CVE-2024-43407
  - GHSA-7r32-vfj5-c2jv
summary: |
  Code Snippet GeSHi plugin in CKEditor 4 has reflected cross-site scripting (XSS) vulnerability
  ### Affected packages
  The vulnerability has been discovered in [Code Snippet GeSHi](https://ckeditor.com/cke4/addon/codesnippetgeshi) plugin. All integrators that use [GeSHi syntax highlighter](https://github.com/GeSHi/geshi-1.0) on the backend side can be affected.

  ### Impact
  A potential vulnerability has been discovered in CKEditor 4 [Code Snippet GeSHi](https://ckeditor.com/cke4/addon/codesnippetgeshi) plugin. The vulnerability allowed a reflected XSS attack by exploiting a flaw in the [GeSHi syntax highlighter library](https://github.com/GeSHi/geshi-1.0) hosted by the victim.

  The GeSHi library was included as a vendor dependency in CKEditor 4 source files. In a specific scenario, an attacker could craft a malicious script that could be executed by sending a request to the GeSHi library hosted on a PHP web server.

  ### Patches

  The [GeSHi library](https://github.com/GeSHi/geshi-1.0) is no longer actively maintained. Due to the lack of ongoing support and updates, potential security vulnerabilities have been identified with its continued use. To mitigate these risks and enhance the overall security of the CKEditor 4, we have decided to completely remove the GeSHi library as a dependency. This change aims to maintain a secure environment and reduce the risk of any security incidents related to outdated or unsupported software.

  To integrators who still want to use the GeSHi syntax highlighter, we recommend manually adding the [GeSHi library](https://github.com/GeSHi/geshi-1.0) . Please be aware of and understand the potential security vulnerabilities associated with its use.

  The fix is be available in version 4.25.0-lts.

  ### Acknowledgements

  The CKEditor 4 team would like to thank [Jiasheng He](https://github.com/Hebing123) from Qihoo 360 for recognizing and reporting this vulnerability.

  ### For more information

  Email us at [security@cksource.com](mailto:security@cksource.com) if you have any questions or comments about this advisory.
impacted_packages: []
severities:
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url:
weaknesses: []
references:
  - url: https://github.com/ckeditor/ckeditor4/security/advisories/GHSA-7r32-vfj5-c2jv
    reference_type:
    reference_id:
