advisory_id: CVE-2016-2097
datasource_id: collect_rails_fix_commits/CVE-2016-2097
datasource_url: https://github.com/rails/rails
aliases: []
summary: |
  8a1d3ea617ffb0c8ae8467fa439bf63a3bfc4324:Change render "foo" to render a template and not a file.

  Previously, calling `render "foo/bar"` in a controller action is
  equivalent to `render file: "foo/bar"`. This has been changed to
  mean `render template: "foo/bar"` instead. If you need to render a
  file, please change your code to use the explicit form
  (`render file: "foo/bar"`) instead.

  Test that we are not allowing you to grab a file with an absolute path
  outside of your application directory. This is dangerous because it
  could be used to retrieve files from the server like `/etc/passwd`.

  Fix CVE-2016-2097.
  af9b9132f82d1f468836997c716a02f14e61c38c:Complete work on 3.2 for render_data_leak patch.

  Render could leak access to external files before this patch.
  A previous patch(CVE-2016-0752), attempted to fix this. However the tests
  were miss-placed outside the TestCase subclass, so they were not running.

  We should allow :file to be outside rails root, but anything else must
  be inside the rails view directory.

  The implementation has changed a bit though. Now the patch is more
  similar with the 4.x series patches.
  Now `render 'foo/bar'`, will add a special key in the options
  hash, and not use the :file one, so when we look up that file, we
  don't set the fallbacks, and only lookup a template, to constraint the
  folders that can be accessed.

  CVE-2016-2097
impacted_packages:
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 8a1d3ea617ffb0c8ae8467fa439bf63a3bfc4324
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: af9b9132f82d1f468836997c716a02f14e61c38c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/rails/rails/tree/8a1d3ea617ffb0c8ae8467fa439bf63a3bfc4324
    reference_type: commit
    reference_id: 8a1d3ea617ffb0c8ae8467fa439bf63a3bfc4324
  - url: https://github.com/rails/rails/tree/af9b9132f82d1f468836997c716a02f14e61c38c
    reference_type: commit
    reference_id: af9b9132f82d1f468836997c716a02f14e61c38c
