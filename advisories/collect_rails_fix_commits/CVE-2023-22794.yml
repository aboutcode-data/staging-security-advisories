advisory_id: CVE-2023-22794
datasource_id: collect_rails_fix_commits/CVE-2023-22794
datasource_url: https://github.com/rails/rails
aliases: []
summary: |
  9aa80813bbf88560696d10aa43aa6e5c237ef6c9:Make sanitize_as_sql_comment more strict

  Though this method was likely never meant to take user input, it was
  attempting sanitization. That sanitization could be bypassed with
  carefully crafted input.

  This commit makes the sanitization more robust by replacing any
  occurrances of "/*" or "*/" with "/ *" or "* /". It also performs a
  first pass to remove one surrounding comment to avoid compatibility
  issues for users relying on the existing removal.

  This also clarifies in the documentation of annotate that it should not
  be provided user input.

  [CVE-2023-22794]
  048e9fc05e18c91838a44e60175e475de8b2aad5:Make sanitize_as_sql_comment more strict

  Though this method was likely never meant to take user input, it was
  attempting sanitization. That sanitization could be bypassed with
  carefully crafted input.

  This commit makes the sanitization more robust by replacing any
  occurrances of "/*" or "*/" with "/ *" or "* /". It also performs a
  first pass to remove one surrounding comment to avoid compatibility
  issues for users relying on the existing removal.

  This also clarifies in the documentation of annotate that it should not
  be provided user input.

  [CVE-2023-22794]
  a7169bf11c514a24722d7f9e6ccf53427c8068a7:Make sanitize_as_sql_comment more strict

  Though this method was likely never meant to take user input, it was
  attempting sanitization. That sanitization could be bypassed with
  carefully crafted input.

  This commit makes the sanitization more robust by replacing any
  occurrances of "/*" or "*/" with "/ *" or "* /". It also performs a
  first pass to remove one surrounding comment to avoid compatibility
  issues for users relying on the existing removal.

  This also clarifies in the documentation of annotate that it should not
  be provided user input.

  [CVE-2023-22794]
  732bd05a646ceca58053754ebdb095d321598a2d:Make sanitize_as_sql_comment more strict

  Though this method was likely never meant to take user input, it was
  attempting sanitization. That sanitization could be bypassed with
  carefully crafted input.

  This commit makes the sanitization more robust by replacing any
  occurrances of "/*" or "*/" with "/ *" or "* /". It also performs a
  first pass to remove one surrounding comment to avoid compatibility
  issues for users relying on the existing removal.

  This also clarifies in the documentation of annotate that it should not
  be provided user input.

  [CVE-2023-22794]
  91e0722884e99b9411414881ab205ff8b4f7f71c:Make sanitize_as_sql_comment more strict

  Though this method was likely never meant to take user input, it was
  attempting sanitization. That sanitization could be bypassed with
  carefully crafted input.

  This commit makes the sanitization more robust by replacing any
  occurrances of "/*" or "*/" with "/ *" or "* /". It also performs a
  first pass to remove one surrounding comment to avoid compatibility
  issues for users relying on the existing removal.

  This also clarifies in the documentation of annotate that it should not
  be provided user input.

  [CVE-2023-22794]
  3db858cbc99e332e6f209d50be2b7420211f4c33:Make sanitize_as_sql_comment more strict

  Though this method was likely never meant to take user input, it was
  attempting sanitization. That sanitization could be bypassed with
  carefully crafted input.

  This commit makes the sanitization more robust by replacing any
  occurrances of "/*" or "*/" with "/ *" or "* /". It also performs a
  first pass to remove one surrounding comment to avoid compatibility
  issues for users relying on the existing removal.

  This also clarifies in the documentation of annotate that it should not
  be provided user input.

  [CVE-2023-22794]
  d7aba06953f9fa789c411676b941d20df8ef73de:Make sanitize_as_sql_comment more strict

  Though this method was likely never meant to take user input, it was
  attempting sanitization. That sanitization could be bypassed with
  carefully crafted input.

  This commit makes the sanitization more robust by replacing any
  occurrances of "/*" or "*/" with "/ *" or "* /". It also performs a
  first pass to remove one surrounding comment to avoid compatibility
  issues for users relying on the existing removal.

  This also clarifies in the documentation of annotate that it should not
  be provided user input.

  [CVE-2023-22794]
impacted_packages:
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 732bd05a646ceca58053754ebdb095d321598a2d
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 3db858cbc99e332e6f209d50be2b7420211f4c33
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: a7169bf11c514a24722d7f9e6ccf53427c8068a7
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: d7aba06953f9fa789c411676b941d20df8ef73de
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 91e0722884e99b9411414881ab205ff8b4f7f71c
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 9aa80813bbf88560696d10aa43aa6e5c237ef6c9
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 048e9fc05e18c91838a44e60175e475de8b2aad5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/rails/rails/tree/048e9fc05e18c91838a44e60175e475de8b2aad5
    reference_type: commit
    reference_id: 048e9fc05e18c91838a44e60175e475de8b2aad5
  - url: https://github.com/rails/rails/tree/3db858cbc99e332e6f209d50be2b7420211f4c33
    reference_type: commit
    reference_id: 3db858cbc99e332e6f209d50be2b7420211f4c33
  - url: https://github.com/rails/rails/tree/732bd05a646ceca58053754ebdb095d321598a2d
    reference_type: commit
    reference_id: 732bd05a646ceca58053754ebdb095d321598a2d
  - url: https://github.com/rails/rails/tree/91e0722884e99b9411414881ab205ff8b4f7f71c
    reference_type: commit
    reference_id: 91e0722884e99b9411414881ab205ff8b4f7f71c
  - url: https://github.com/rails/rails/tree/9aa80813bbf88560696d10aa43aa6e5c237ef6c9
    reference_type: commit
    reference_id: 9aa80813bbf88560696d10aa43aa6e5c237ef6c9
  - url: https://github.com/rails/rails/tree/a7169bf11c514a24722d7f9e6ccf53427c8068a7
    reference_type: commit
    reference_id: a7169bf11c514a24722d7f9e6ccf53427c8068a7
  - url: https://github.com/rails/rails/tree/d7aba06953f9fa789c411676b941d20df8ef73de
    reference_type: commit
    reference_id: d7aba06953f9fa789c411676b941d20df8ef73de
