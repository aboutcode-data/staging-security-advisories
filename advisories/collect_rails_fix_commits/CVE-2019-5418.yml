advisory_id: CVE-2019-5418
datasource_id: collect_rails_fix_commits/CVE-2019-5418
datasource_url: https://github.com/rails/rails
aliases: []
summary: |
  c7820d8124c854760a4d288334f185de2fb99446:Introduce Template::File as new render file:

  The previous behaviour of render file: was essentially the same as
  render template:, except that templates can be specified as an absolute
  path on the filesystem.

  This makes sense for historic reasons, but now render file: is almost
  exclusively used to render raw files (not .erb) like public/404.html. In
  addition to complicating the code in template/resolver.rb, I think the
  current behaviour is surprising to developers.

  This commit deprecates the existing "lookup a template from anywhere"
  behaviour and replaces it with "render this file exactly as it is on
  disk". Handlers will no longer be used (it will render the same as if
  the :raw handler was used), but formats (.html, .xml, etc) will still be
  detected (and will default to :plain).

  The existing render file: behaviour was the path through which Rails
  apps were vulnerable in the recent CVE-2019-5418. Although the
  vulnerability has been patched in a fully backwards-compatible way, I
  think it's a strong hint that we should drop the existing
  previously-vulnerable behaviour if it isn't a benefit to developers.
  58ed245e80a8710fbe31e91417bfd19f9f934cc4:Only accept formats from registered mime types

  [CVE-2019-5418]
  [CVE-2019-5419]
  f4c70c2222180b8d9d924f00af0c7fd632e26715:Only accept formats from registered mime types

  [CVE-2019-5418]
  [CVE-2019-5419]
  c79dcbce9bfd20fe7f72ca431c49965ee39bd645:Only accept formats from registered mime types

  [CVE-2019-5418]
  [CVE-2019-5419]
  92c025d7f17ff256ac50f5e3bc014bb1a016d1ec:Only accept formats from registered mime types

  [CVE-2019-5418]
  [CVE-2019-5419]
  d7fac9c09a535ec7f11bb9aa8addb4af37b7d4b5:Only accept formats from registered mime types

  [CVE-2019-5418]
  [CVE-2019-5419]
impacted_packages:
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 92c025d7f17ff256ac50f5e3bc014bb1a016d1ec
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: c7820d8124c854760a4d288334f185de2fb99446
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 58ed245e80a8710fbe31e91417bfd19f9f934cc4
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: c79dcbce9bfd20fe7f72ca431c49965ee39bd645
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: d7fac9c09a535ec7f11bb9aa8addb4af37b7d4b5
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: f4c70c2222180b8d9d924f00af0c7fd632e26715
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/rails/rails/tree/58ed245e80a8710fbe31e91417bfd19f9f934cc4
    reference_type: commit
    reference_id: 58ed245e80a8710fbe31e91417bfd19f9f934cc4
  - url: https://github.com/rails/rails/tree/92c025d7f17ff256ac50f5e3bc014bb1a016d1ec
    reference_type: commit
    reference_id: 92c025d7f17ff256ac50f5e3bc014bb1a016d1ec
  - url: https://github.com/rails/rails/tree/c7820d8124c854760a4d288334f185de2fb99446
    reference_type: commit
    reference_id: c7820d8124c854760a4d288334f185de2fb99446
  - url: https://github.com/rails/rails/tree/c79dcbce9bfd20fe7f72ca431c49965ee39bd645
    reference_type: commit
    reference_id: c79dcbce9bfd20fe7f72ca431c49965ee39bd645
  - url: https://github.com/rails/rails/tree/d7fac9c09a535ec7f11bb9aa8addb4af37b7d4b5
    reference_type: commit
    reference_id: d7fac9c09a535ec7f11bb9aa8addb4af37b7d4b5
  - url: https://github.com/rails/rails/tree/f4c70c2222180b8d9d924f00af0c7fd632e26715
    reference_type: commit
    reference_id: f4c70c2222180b8d9d924f00af0c7fd632e26715
