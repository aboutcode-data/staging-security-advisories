advisory_id: CVE-2021-44528
datasource_id: collect_rails_fix_commits/CVE-2021-44528
datasource_url: https://github.com/rails/rails
aliases: []
summary: |
  0fccfb9a3097a9c4260c791f1a40b128517e7815:Fix invalid forwarded host vulnerability

  Prior to this commit, it was possible to pass an unvalidated host
  through the `X-Forwarded-Host` header. If the value of the header
  was prefixed with a invalid domain character (for example a `/`),
  it was always accepted as the actual host of that request.

  Since this host is used for all url helpers, an attacker could change
  generated links and redirects. If the header is set to
  `X-Forwarded-Host: //evil.hacker`, a redirect will be send to
  `https:////evil.hacker/`. Browsers will ignore these four slashes
  and redirect the user.

  [CVE-2021-44528]
  970d3b2e7387c34663988b0db222d045c34c59c1:Fix invalid forwarded host vulnerability

  Prior to this commit, it was possible to pass an unvalidated host
  through the `X-Forwarded-Host` header. If the value of the header
  was prefixed with a invalid domain character (for example a `/`),
  it was always accepted as the actual host of that request.

  Since this host is used for all url helpers, an attacker could change
  generated links and redirects. If the header is set to
  `X-Forwarded-Host: //evil.hacker`, a redirect will be send to
  `https:////evil.hacker/`. Browsers will ignore these four slashes
  and redirect the user.

  [CVE-2021-44528]
  aecba3c301b80e9d5a63c30ea1b287bceaf2c107:Fix invalid forwarded host vulnerability

  Prior to this commit, it was possible to pass an unvalidated host
  through the `X-Forwarded-Host` header. If the value of the header
  was prefixed with a invalid domain character (for example a `/`),
  it was always accepted as the actual host of that request.

  Since this host is used for all url helpers, an attacker could change
  generated links and redirects. If the header is set to
  `X-Forwarded-Host: //evil.hacker`, a redirect will be send to
  `https:////evil.hacker/`. Browsers will ignore these four slashes
  and redirect the user.

  [CVE-2021-44528]
  fd6a64fef1d0f7f40a8d4b046da882e83163299c:Fix invalid forwarded host vulnerability

  Prior to this commit, it was possible to pass an unvalidated host
  through the `X-Forwarded-Host` header. If the value of the header
  was prefixed with a invalid domain character (for example a `/`),
  it was always accepted as the actual host of that request.

  Since this host is used for all url helpers, an attacker could change
  generated links and redirects. If the header is set to
  `X-Forwarded-Host: //evil.hacker`, a redirect will be send to
  `https:////evil.hacker/`. Browsers will ignore these four slashes
  and redirect the user.

  [CVE-2021-44528]
impacted_packages:
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: aecba3c301b80e9d5a63c30ea1b287bceaf2c107
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 970d3b2e7387c34663988b0db222d045c34c59c1
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: fd6a64fef1d0f7f40a8d4b046da882e83163299c
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 0fccfb9a3097a9c4260c791f1a40b128517e7815
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/rails/rails/tree/0fccfb9a3097a9c4260c791f1a40b128517e7815
    reference_type: commit
    reference_id: 0fccfb9a3097a9c4260c791f1a40b128517e7815
  - url: https://github.com/rails/rails/tree/970d3b2e7387c34663988b0db222d045c34c59c1
    reference_type: commit
    reference_id: 970d3b2e7387c34663988b0db222d045c34c59c1
  - url: https://github.com/rails/rails/tree/aecba3c301b80e9d5a63c30ea1b287bceaf2c107
    reference_type: commit
    reference_id: aecba3c301b80e9d5a63c30ea1b287bceaf2c107
  - url: https://github.com/rails/rails/tree/fd6a64fef1d0f7f40a8d4b046da882e83163299c
    reference_type: commit
    reference_id: fd6a64fef1d0f7f40a8d4b046da882e83163299c
