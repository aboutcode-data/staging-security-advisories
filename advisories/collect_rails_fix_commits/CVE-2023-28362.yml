advisory_id: CVE-2023-28362
datasource_id: collect_rails_fix_commits/CVE-2023-28362
datasource_url: https://github.com/rails/rails
aliases: []
summary: |
  69e37c84e3f77d75566424c7d0015172d6a6fac5:Added check for illegal HTTP header value in redirect_to

  The set of legal characters for an HTTP header value is described
  in https://datatracker.ietf.org/doc/html/rfc7230\#section-3.2.6.

  This commit adds a check to redirect_to that ensures the
  provided URL does not contain any of the illegal characters.

  Downstream consumers of the resulting Location response header
  may accidentally remove the header if it does not comply with the RFC
  resulting in unexpected behavior.

  Related to [CVE-2023-28362].
  1c3f93d1e90a3475f9ae2377ead25ccf11f71441:Added check for illegal HTTP header value in redirect_to

  The set of legal characters for an HTTP header value is described
  in https://datatracker.ietf.org/doc/html/rfc7230\#section-3.2.6.

  This commit adds a check to redirect_to that ensures the
  provided URL does not contain any of the illegal characters.

  Downstream consumers of the resulting Location response header
  may remove the header if it does not comply with the RFC.
  This can result in a cross site scripting (XSS) vector by
  allowing for the redirection page to sit idle waiting
  for user interaction with the provided malicious link.

  [CVE-2023-28362]
  c9ab9b32bcdcfd8bcd55907f6c7b20b4e004cc23:Added check for illegal HTTP header value in redirect_to

  The set of legal characters for an HTTP header value is described
  in https://datatracker.ietf.org/doc/html/rfc7230\#section-3.2.6.

  This commit adds a check to redirect_to that ensures the
  provided URL does not contain any of the illegal characters.

  Downstream consumers of the resulting Location response header
  may remove the header if it does not comply with the RFC.
  This can result in a cross site scripting (XSS) vector by
  allowing for the redirection page to sit idle waiting
  for user interaction with the provided malicious link.

  [CVE-2023-28362]
impacted_packages:
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 1c3f93d1e90a3475f9ae2377ead25ccf11f71441
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: c9ab9b32bcdcfd8bcd55907f6c7b20b4e004cc23
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 69e37c84e3f77d75566424c7d0015172d6a6fac5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/rails/rails/tree/1c3f93d1e90a3475f9ae2377ead25ccf11f71441
    reference_type: commit
    reference_id: 1c3f93d1e90a3475f9ae2377ead25ccf11f71441
  - url: https://github.com/rails/rails/tree/69e37c84e3f77d75566424c7d0015172d6a6fac5
    reference_type: commit
    reference_id: 69e37c84e3f77d75566424c7d0015172d6a6fac5
  - url: https://github.com/rails/rails/tree/c9ab9b32bcdcfd8bcd55907f6c7b20b4e004cc23
    reference_type: commit
    reference_id: c9ab9b32bcdcfd8bcd55907f6c7b20b4e004cc23
