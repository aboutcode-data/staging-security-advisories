advisory_id: CVE-2016-0752
datasource_id: collect_rails_fix_commits/CVE-2016-0752
datasource_url: https://github.com/rails/rails
aliases: []
summary: "c185f7936743271db80424bb29dbdca0c5c59341:Update guide for render file:\n\nMost of\
  \ this section was written from the time that render file: was the\ndefault, before CVE-2016-0752.\n\
  \nThis updates the guide to the Rails 6 `render file:` behaviour, moves it\nto a more appropriate\
  \ part of the file.\n\n[ci skip]\n211dd25e42ee72d652001b72a9a67c57edd0603b:Remove obsolete\
  \ or discouraged render examples\n\nMost of these examples no longer work. The ability to\
  \ render an absolute\npath was removed as part of CVE-2016-0752. In Rails 6 we changed `render\n\
  file:` to only take exact paths and always to render them as raw files.\nRendering a template\
  \ with its extensions _is_ supported, but I don't\nthink should be recommended.\n\nThis also\
  \ removes `render file:` from an example where it isn't\nrelevant.\n\n[ci skip]\n9fe5aa32a7c962e084117af94351061009cd350b:Update\
  \ guide for render file:\n\nMost of this section was written from the time that render file:\
  \ was the\ndefault, before CVE-2016-0752.\n\nThis updates the guide to the Rails 6 `render\
  \ file:` behaviour, moves it\nto a more appropriate part of the file.\n\n[ci skip]\n85fa9b6549f6bf0b4ab0262b869bdd3d25969939:Remove\
  \ obsolete or discouraged render examples\n\nMost of these examples no longer work. The ability\
  \ to render an absolute\npath was removed as part of CVE-2016-0752. In Rails 6 we changed\
  \ `render\nfile:` to only take exact paths and always to render them as raw files.\nRendering\
  \ a template with its extensions _is_ supported, but I don't\nthink should be recommended.\n\
  \nThis also removes `render file:` from an example where it isn't\nrelevant.\n\n[ci skip]\n\
  eb52904eb5c19ab4e8ff7a7d4f501fe5e1142ad0:Always reject files external to app\n\nPreviously,\
  \ when using `render file:`, it was possible to render files\nnot only at an absolute path\
  \ or relative to the current directory, but\nrelative to ANY view paths. This was probably\
  \ done for absolutely\nmaximum compatibility when addressing CVE-2016-0752, but I think is\n\
  unlikely to be used in practice.\n\nTihs commit removes the ability to `render file:` with\
  \ a path relative\nto a non-fallback view path.\n\nMake FallbackResolver.new private\n\nTo\
  \ ensure nobody is making FallbackResolvers other than \"/\" and \"\".\n\nMake reject_files_external_...\
  \ no-op for fallbacks\n\nBecause there are only two values used for path: \"\" and \"/\",\
  \ and\nFile.join(\"\", \"\") == File.join(\"/\", \"\") == \"/\", this method was only\ntesting\
  \ that the absolute paths started at \"/\" (which of course all do).\n\nThis commit doesn't\
  \ change any behaviour, but it makes it explicit that\nthe FallbackFileSystemResolver works\
  \ this way.\n\nRemove outside_app_allowed argument\n\nDeprecate find_all_anywhere\n\nThis\
  \ is now equivalent to find_all\n\nRemove outside_app argument\n\nDeprecate find_file for\
  \ find\n\nBoth LookupContext#find_file and PathSet#find_file are now equivalent to\ntheir\
  \ respective #find methods.\naf9b9132f82d1f468836997c716a02f14e61c38c:Complete work on 3.2\
  \ for render_data_leak patch.\n\nRender could leak access to external files before this patch.\n\
  A previous patch(CVE-2016-0752), attempted to fix this. However the tests\nwere miss-placed\
  \ outside the TestCase subclass, so they were not running.\n\nWe should allow :file to be\
  \ outside rails root, but anything else must\nbe inside the rails view directory.\n\nThe implementation\
  \ has changed a bit though. Now the patch is more\nsimilar with the 4.x series patches.\n\
  Now `render 'foo/bar'`, will add a special key in the options\nhash, and not use the :file\
  \ one, so when we look up that file, we\ndon't set the fallbacks, and only lookup a template,\
  \ to constraint the\nfolders that can be accessed.\n\nCVE-2016-2097\nb7758b40fc035a47f6843158155606d455314c42:allow\
  \ :file to be outside rails root, but anything else must be inside the rails view directory\n\
  \nCVE-2016-0752\n0c5c32aa7cea5ee1ea60bd1f87dfa5c7e7146a54:allow :file to be outside rails\
  \ root, but anything else must be inside the rails view directory\n\nConflicts:\n\tactionpack/test/controller/render_test.rb\n\
  \tactionview/lib/action_view/template/resolver.rb\n\nCVE-2016-0752\nbe543e8e18246d5c2faa336eb3c0a03b797f3517:allow\
  \ :file to be outside rails root, but anything else must be inside the rails view directory\n\
  \nConflicts:\n\tactionpack/test/controller/render_test.rb\n\tactionview/lib/action_view/template/resolver.rb\n\
  \nCVE-2016-0752\n18269d250fa58001ce7d8318571546aa90412975:allow :file to be outside rails\
  \ root, but anything else must be inside the rails view directory\n\nConflicts:\n\tactionpack/test/controller/render_test.rb\n\
  \tactionview/lib/action_view/template/resolver.rb\n\nCVE-2016-0752"
impacted_packages:
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 18269d250fa58001ce7d8318571546aa90412975
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: eb52904eb5c19ab4e8ff7a7d4f501fe5e1142ad0
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: c185f7936743271db80424bb29dbdca0c5c59341
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 9fe5aa32a7c962e084117af94351061009cd350b
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 211dd25e42ee72d652001b72a9a67c57edd0603b
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 0c5c32aa7cea5ee1ea60bd1f87dfa5c7e7146a54
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: be543e8e18246d5c2faa336eb3c0a03b797f3517
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: af9b9132f82d1f468836997c716a02f14e61c38c
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: b7758b40fc035a47f6843158155606d455314c42
    introduced_in_commits: []
  - purl: pkg:github/rails/rails
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/rails/rails
        commit: 85fa9b6549f6bf0b4ab0262b869bdd3d25969939
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/rails/rails/tree/0c5c32aa7cea5ee1ea60bd1f87dfa5c7e7146a54
    reference_type: commit
    reference_id: 0c5c32aa7cea5ee1ea60bd1f87dfa5c7e7146a54
  - url: https://github.com/rails/rails/tree/18269d250fa58001ce7d8318571546aa90412975
    reference_type: commit
    reference_id: 18269d250fa58001ce7d8318571546aa90412975
  - url: https://github.com/rails/rails/tree/211dd25e42ee72d652001b72a9a67c57edd0603b
    reference_type: commit
    reference_id: 211dd25e42ee72d652001b72a9a67c57edd0603b
  - url: https://github.com/rails/rails/tree/85fa9b6549f6bf0b4ab0262b869bdd3d25969939
    reference_type: commit
    reference_id: 85fa9b6549f6bf0b4ab0262b869bdd3d25969939
  - url: https://github.com/rails/rails/tree/9fe5aa32a7c962e084117af94351061009cd350b
    reference_type: commit
    reference_id: 9fe5aa32a7c962e084117af94351061009cd350b
  - url: https://github.com/rails/rails/tree/af9b9132f82d1f468836997c716a02f14e61c38c
    reference_type: commit
    reference_id: af9b9132f82d1f468836997c716a02f14e61c38c
  - url: https://github.com/rails/rails/tree/b7758b40fc035a47f6843158155606d455314c42
    reference_type: commit
    reference_id: b7758b40fc035a47f6843158155606d455314c42
  - url: https://github.com/rails/rails/tree/be543e8e18246d5c2faa336eb3c0a03b797f3517
    reference_type: commit
    reference_id: be543e8e18246d5c2faa336eb3c0a03b797f3517
  - url: https://github.com/rails/rails/tree/c185f7936743271db80424bb29dbdca0c5c59341
    reference_type: commit
    reference_id: c185f7936743271db80424bb29dbdca0c5c59341
  - url: https://github.com/rails/rails/tree/eb52904eb5c19ab4e8ff7a7d4f501fe5e1142ad0
    reference_type: commit
    reference_id: eb52904eb5c19ab4e8ff7a7d4f501fe5e1142ad0
