advisory_id: CVE-2024-24783
datasource_id: collect_go_fix_commits/CVE-2024-24783
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  afb105056dc62b3f2f569341a9fff080023ee812:crypto/x509: make sure pub key is non-nil before interface conversion

  alreadyInChain assumes all keys fit a interface which contains the
  Equal method (which they do), but this ignores that certificates may
  have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
  this case alreadyInChain panics.

  Check that the key is non-nil as part of considerCandidate (we are never
  going to build a chain containing UnknownPublicKeyAlgorithm anyway).

  Fixes #65390
  Fixes CVE-2024-24783

  Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2137282
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/569339
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  be5b52bea674190ef7de272664be6c7ae93ec5a0:[release-branch.go1.21] crypto/x509: make sure pub key is non-nil before interface conversion

  alreadyInChain assumes all keys fit a interface which contains the
  Equal method (which they do), but this ignores that certificates may
  have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
  this case alreadyInChain panics.

  Check that the key is non-nil as part of considerCandidate (we are never
  going to build a chain containing UnknownPublicKeyAlgorithm anyway).

  For #65390
  Fixes #65392
  Fixes CVE-2024-24783

  Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2137282
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2173774
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Carlos Amedee <amedee@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/569238
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  337b8e9cbfa749d9d5c899e0dc358e2208d5e54f:[release-branch.go1.22] crypto/x509: make sure pub key is non-nil before interface conversion

  alreadyInChain assumes all keys fit a interface which contains the
  Equal method (which they do), but this ignores that certificates may
  have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
  this case alreadyInChain panics.

  Check that the key is non-nil as part of considerCandidate (we are never
  going to build a chain containing UnknownPublicKeyAlgorithm anyway).

  For #65390
  Fixes #65831
  Fixes CVE-2024-24783

  Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2137282
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174343
  Reviewed-by: Carlos Amedee <amedee@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/569235
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 337b8e9cbfa749d9d5c899e0dc358e2208d5e54f
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: afb105056dc62b3f2f569341a9fff080023ee812
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: be5b52bea674190ef7de272664be6c7ae93ec5a0
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/337b8e9cbfa749d9d5c899e0dc358e2208d5e54f
    reference_type: commit
    reference_id: 337b8e9cbfa749d9d5c899e0dc358e2208d5e54f
  - url: https://github.com/golang/go/tree/afb105056dc62b3f2f569341a9fff080023ee812
    reference_type: commit
    reference_id: afb105056dc62b3f2f569341a9fff080023ee812
  - url: https://github.com/golang/go/tree/be5b52bea674190ef7de272664be6c7ae93ec5a0
    reference_type: commit
    reference_id: be5b52bea674190ef7de272664be6c7ae93ec5a0
