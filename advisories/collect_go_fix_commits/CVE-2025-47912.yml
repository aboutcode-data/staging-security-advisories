advisory_id: CVE-2025-47912
datasource_id: collect_go_fix_commits/CVE-2025-47912
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  f6f4e8b3ef21299db1ea3a343c3e55e91365a7fd:net/url: enforce stricter parsing of bracketed IPv6 hostnames

  - Previously, url.Parse did not enforce validation of hostnames within
    square brackets.
  - RFC 3986 stipulates that only IPv6 hostnames can be embedded within
    square brackets in a URL.
  - Now, the parsing logic should strictly enforce that only IPv6
    hostnames can be resolved when in square brackets. IPv4, IPv4-mapped
    addresses and other input will be rejected.
  - Update url_test to add test cases that cover the above scenarios.

  Thanks to Enze Wang, Jingcheng Yang and Zehui Miao of Tsinghua
  University for reporting this issue.

  Fixes CVE-2025-47912
  Fixes #75678

  Change-Id: Iaa41432bf0ee86de95a39a03adae5729e4deb46c
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2680
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709857
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  9fd3ac8a10272afd90312fef5d379de7d688a58e:[release-branch.go1.25] net/url: enforce stricter parsing of bracketed IPv6 hostnames

  - Previously, url.Parse did not enforce validation of hostnames within
    square brackets.
  - RFC 3986 stipulates that only IPv6 hostnames can be embedded within
    square brackets in a URL.
  - Now, the parsing logic should strictly enforce that only IPv6
    hostnames can be resolved when in square brackets. IPv4, IPv4-mapped
    addresses and other input will be rejected.
  - Update url_test to add test cases that cover the above scenarios.

  Thanks to Enze Wang, Jingcheng Yang and Zehui Miao of Tsinghua
  University for reporting this issue.

  Fixes CVE-2025-47912
  For #75678
  Fixes #75713

  Change-Id: Iaa41432bf0ee86de95a39a03adae5729e4deb46c
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2680
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2988
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709847
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  d6d2f7bf76718f1db05461cd912ae5e30d7b77ea:[release-branch.go1.24] net/url: enforce stricter parsing of bracketed IPv6 hostnames

  - Previously, url.Parse did not enforce validation of hostnames within
    square brackets.
  - RFC 3986 stipulates that only IPv6 hostnames can be embedded within
    square brackets in a URL.
  - Now, the parsing logic should strictly enforce that only IPv6
    hostnames can be resolved when in square brackets. IPv4, IPv4-mapped
    addresses and other input will be rejected.
  - Update url_test to add test cases that cover the above scenarios.

  Thanks to Enze Wang, Jingcheng Yang and Zehui Miao of Tsinghua
  University for reporting this issue.

  Fixes CVE-2025-47912
  Fixes #75678
  Fixes #75712

  Change-Id: Iaa41432bf0ee86de95a39a03adae5729e4deb46c
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2680
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2968
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709838
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Auto-Submit: Michael Pratt <mpratt@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: d6d2f7bf76718f1db05461cd912ae5e30d7b77ea
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: f6f4e8b3ef21299db1ea3a343c3e55e91365a7fd
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 9fd3ac8a10272afd90312fef5d379de7d688a58e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/9fd3ac8a10272afd90312fef5d379de7d688a58e
    reference_type: commit
    reference_id: 9fd3ac8a10272afd90312fef5d379de7d688a58e
  - url: https://github.com/golang/go/tree/d6d2f7bf76718f1db05461cd912ae5e30d7b77ea
    reference_type: commit
    reference_id: d6d2f7bf76718f1db05461cd912ae5e30d7b77ea
  - url: https://github.com/golang/go/tree/f6f4e8b3ef21299db1ea3a343c3e55e91365a7fd
    reference_type: commit
    reference_id: f6f4e8b3ef21299db1ea3a343c3e55e91365a7fd
