advisory_id: CVE-2021-34558
datasource_id: collect_go_fix_commits/CVE-2021-34558
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  a98589711da5e9d935e8d690cfca92892e86d557:crypto/tls: test key type when casting

  When casting the certificate public key in generateClientKeyExchange,
  check the type is appropriate. This prevents a panic when a server
  agrees to a RSA based key exchange, but then sends an ECDSA (or
  other) certificate.

  Fixes #47143
  Fixes CVE-2021-34558

  Thanks to Imre Rad for reporting this issue.

  Change-Id: Iabccacca6052769a605cccefa1216a9f7b7f6aea
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1116723
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-by: Katie Hockman <katiehockman@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/334031
  Trust: Filippo Valsorda <filippo@golang.org>
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  c77980bc077f3774276ab2deba78d8e6bfe4b3bd:[release-branch.go1.15] crypto/tls: test key type when casting

  When casting the certificate public key in generateClientKeyExchange,
  check the type is appropriate. This prevents a panic when a server
  agrees to a RSA based key exchange, but then sends an ECDSA (or
  other) certificate.

  Updates #47143
  Fixes #47144
  Fixes CVE-2021-34558

  Thanks to Imre Rad for reporting this issue.

  Change-Id: Iabccacca6052769a605cccefa1216a9f7b7f6aea
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1116723
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-by: Katie Hockman <katiehockman@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/334030
  Trust: Filippo Valsorda <filippo@golang.org>
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  58bc454a11d4b3dbc03f44dfcabb9068a9c076f4:[release-branch.go1.16] crypto/tls: test key type when casting

  When casting the certificate public key in generateClientKeyExchange,
  check the type is appropriate. This prevents a panic when a server
  agrees to a RSA based key exchange, but then sends an ECDSA (or
  other) certificate.

  Updates #47143
  Fixes #47145
  Fixes CVE-2021-34558

  Thanks to Imre Rad for reporting this issue.

  Change-Id: Iabccacca6052769a605cccefa1216a9f7b7f6aea
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1116723
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-by: Katie Hockman <katiehockman@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/334029
  Trust: Filippo Valsorda <filippo@golang.org>
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 58bc454a11d4b3dbc03f44dfcabb9068a9c076f4
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: c77980bc077f3774276ab2deba78d8e6bfe4b3bd
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: a98589711da5e9d935e8d690cfca92892e86d557
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/58bc454a11d4b3dbc03f44dfcabb9068a9c076f4
    reference_type: commit
    reference_id: 58bc454a11d4b3dbc03f44dfcabb9068a9c076f4
  - url: https://github.com/golang/go/tree/a98589711da5e9d935e8d690cfca92892e86d557
    reference_type: commit
    reference_id: a98589711da5e9d935e8d690cfca92892e86d557
  - url: https://github.com/golang/go/tree/c77980bc077f3774276ab2deba78d8e6bfe4b3bd
    reference_type: commit
    reference_id: c77980bc077f3774276ab2deba78d8e6bfe4b3bd
