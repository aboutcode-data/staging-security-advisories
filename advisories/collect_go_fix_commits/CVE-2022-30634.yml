advisory_id: CVE-2022-30634
datasource_id: collect_go_fix_commits/CVE-2022-30634
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  2be03d789de905a4b050ff5f3a51b724e1b09494:[release-branch.go1.17] crypto/rand: properly handle large Read on windows

  Use the batched reader to chunk large Read calls on windows to a max of
  1 << 31 - 1 bytes. This prevents an infinite loop when trying to read
  more than 1 << 32 -1 bytes, due to how RtlGenRandom works.

  This change moves the batched function from rand_unix.go to rand.go,
  since it is now needed for both windows and unix implementations.

  Updates #52561
  Fixes #52932
  Fixes CVE-2022-30634

  Change-Id: Id98fc4b1427e5cb2132762a445b2aed646a37473
  Reviewed-on: https://go-review.googlesource.com/c/go/+/402257
  Run-TryBot: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  (cherry picked from commit bb1f4416180511231de6d17a1f2f55c82aafc863)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/406635
  Reviewed-by: Damien Neil <dneil@google.com>
  32dedaa69e22f1a058ae90b9484fd4c3b46fbcbf:[release-branch.go1.18] [release-branch.go1.18 crypto/rand: properly handle large Read on windows

  Use the batched reader to chunk large Read calls on windows to a max of
  1 << 31 - 1 bytes. This prevents an infinite loop when trying to read
  more than 1 << 32 -1 bytes, due to how RtlGenRandom works.

  This change moves the batched function from rand_unix.go to rand.go,
  since it is now needed for both windows and unix implementations.

  Updates #52561
  Fixes #52933
  Fixes CVE-2022-30634

  Change-Id: Id98fc4b1427e5cb2132762a445b2aed646a37473
  Reviewed-on: https://go-review.googlesource.com/c/go/+/402257
  Run-TryBot: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  (cherry picked from commit bb1f4416180511231de6d17a1f2f55c82aafc863)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/406634
  Reviewed-by: Damien Neil <dneil@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 32dedaa69e22f1a058ae90b9484fd4c3b46fbcbf
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2be03d789de905a4b050ff5f3a51b724e1b09494
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/2be03d789de905a4b050ff5f3a51b724e1b09494
    reference_type: commit
    reference_id: 2be03d789de905a4b050ff5f3a51b724e1b09494
  - url: https://github.com/golang/go/tree/32dedaa69e22f1a058ae90b9484fd4c3b46fbcbf
    reference_type: commit
    reference_id: 32dedaa69e22f1a058ae90b9484fd4c3b46fbcbf
