advisory_id: CVE-2025-22874
datasource_id: collect_go_fix_commits/CVE-2025-22874
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  03811ab1b31525e8d779997db169c6fedab7c505:[release-branch.go1.24] crypto/x509: decouple key usage and policy validation

  Disabling key usage validation (by passing ExtKeyUsageAny)
  unintentionally disabled policy validation. This change decouples these
  two checks, preventing the user from unintentionally disabling policy
  validation.

  Thanks to Krzysztof Skrzętnicki (@Tener) of Teleport for reporting this
  issue.

  Updates #73612
  Fixes #73700
  Fixes CVE-2025-22874

  Change-Id: Iec8f080a8879a3dd44cb3da30352fa3e7f539d40
  Reviewed-on: https://go-review.googlesource.com/c/go/+/670375
  Reviewed-by: Daniel McCarney <daniel@binaryparadox.net>
  Reviewed-by: Cherry Mui <cherryyz@google.com>
  Reviewed-by: Ian Stapleton Cordasco <graffatcolmingov@gmail.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  (cherry picked from commit 9bba799955e68972041c4f340ee4ea2d267e5c0e)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/672316
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  9bba799955e68972041c4f340ee4ea2d267e5c0e:crypto/x509: decouple key usage and policy validation

  Disabling key usage validation (by passing ExtKeyUsageAny)
  unintentionally disabled policy validation. This change decouples these
  two checks, preventing the user from unintentionally disabling policy
  validation.

  Thanks to Krzysztof Skrzętnicki (@Tener) of Teleport for reporting this
  issue.

  Fixes #73612
  Fixes CVE-2025-22874

  Change-Id: Iec8f080a8879a3dd44cb3da30352fa3e7f539d40
  Reviewed-on: https://go-review.googlesource.com/c/go/+/670375
  Reviewed-by: Daniel McCarney <daniel@binaryparadox.net>
  Reviewed-by: Cherry Mui <cherryyz@google.com>
  Reviewed-by: Ian Stapleton Cordasco <graffatcolmingov@gmail.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 03811ab1b31525e8d779997db169c6fedab7c505
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 9bba799955e68972041c4f340ee4ea2d267e5c0e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/03811ab1b31525e8d779997db169c6fedab7c505
    reference_type: commit
    reference_id: 03811ab1b31525e8d779997db169c6fedab7c505
  - url: https://github.com/golang/go/tree/9bba799955e68972041c4f340ee4ea2d267e5c0e
    reference_type: commit
    reference_id: 9bba799955e68972041c4f340ee4ea2d267e5c0e
