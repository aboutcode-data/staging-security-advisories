advisory_id: CVE-2019-17596
datasource_id: collect_go_fix_commits/CVE-2019-17596
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  552987fdbf4c2bc9641016fd323c3ae5d3a0d9a3:crypto/dsa: prevent bad public keys from causing panic

  dsa.Verify might currently use a nil s inverse in a
  multiplication if the public key contains a non-prime Q,
  causing a panic. Change this to check that the mod
  inverse exists before using it.

  Fixes CVE-2019-17596

  Fixes #34960

  Change-Id: I94d5f3cc38f1b5d52d38dcb1d253c71b7fd1cae7
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/572809
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/205441
  Run-TryBot: Katie Hockman <katie@golang.org>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  4cabf6992e98f74a324e6f814a7cb35e41b05f25:[release-branch.go1.13-security] crypto/dsa: prevent bad public keys from causing panic

  dsa.Verify might currently use a nil s inverse in a
  multiplication if the public key contains a non-prime Q,
  causing a panic. Change this to check that the mod
  inverse exists before using it.

  Fixes CVE-2019-17596

  Change-Id: I94d5f3cc38f1b5d52d38dcb1d253c71b7fd1cae7
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/572809
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  (cherry picked from commit 9119dfb0511326d4485b248b83d4fde19c95d0f7)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/575233
  2017d88dbc096381d4f348d2fb08bfb3c2b7ed73:[release-branch.go1.12-security] crypto/dsa: prevent bad public keys from causing panic

  dsa.Verify might currently use a nil s inverse in a
  multiplication if the public key contains a non-prime Q,
  causing a panic. Change this to check that the mod
  inverse exists before using it.

  Fixes CVE-2019-17596

  Change-Id: I94d5f3cc38f1b5d52d38dcb1d253c71b7fd1cae7
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/572809
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  (cherry picked from commit 9119dfb0511326d4485b248b83d4fde19c95d0f7)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/575232
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 4cabf6992e98f74a324e6f814a7cb35e41b05f25
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2017d88dbc096381d4f348d2fb08bfb3c2b7ed73
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 552987fdbf4c2bc9641016fd323c3ae5d3a0d9a3
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/2017d88dbc096381d4f348d2fb08bfb3c2b7ed73
    reference_type: commit
    reference_id: 2017d88dbc096381d4f348d2fb08bfb3c2b7ed73
  - url: https://github.com/golang/go/tree/4cabf6992e98f74a324e6f814a7cb35e41b05f25
    reference_type: commit
    reference_id: 4cabf6992e98f74a324e6f814a7cb35e41b05f25
  - url: https://github.com/golang/go/tree/552987fdbf4c2bc9641016fd323c3ae5d3a0d9a3
    reference_type: commit
    reference_id: 552987fdbf4c2bc9641016fd323c3ae5d3a0d9a3
