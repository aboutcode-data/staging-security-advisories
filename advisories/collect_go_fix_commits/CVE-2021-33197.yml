advisory_id: CVE-2021-33197
datasource_id: collect_go_fix_commits/CVE-2021-33197
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  cbd1ca84453fecf3825a6bb9f985823e8bc32b76:[release-branch.go1.15] net/http/httputil: always remove hop-by-hop headers

  Previously, we'd fail to remove the Connection header from a request
  like this:

      Connection:
      Connection: x-header

  Updates #46313
  Fixes #46314
  Fixes CVE-2021-33197

  Change-Id: Ie3009e926ceecfa86dfa6bcc6fe14ff01086be7d
  Reviewed-on: https://go-review.googlesource.com/c/go/+/321929
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  Reviewed-by: Katie Hockman <katie@golang.org>
  Trust: Katie Hockman <katie@golang.org>
  Trust: Filippo Valsorda <filippo@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/323091
  Run-TryBot: Katie Hockman <katie@golang.org>
  0410005dc458f23fb15f64354f9a24ca8f2fe044:[release-branch.go1.16] net/http/httputil: always remove hop-by-hop headers

  Previously, we'd fail to remove the Connection header from a request
  like this:

      Connection:
      Connection: x-header

  Updates #46313
  Fixes #46315
  Fixes CVE-2021-33197

  Change-Id: Ie3009e926ceecfa86dfa6bcc6fe14ff01086be7d
  Reviewed-on: https://go-review.googlesource.com/c/go/+/321929
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  Reviewed-by: Katie Hockman <katie@golang.org>
  Trust: Katie Hockman <katie@golang.org>
  Trust: Filippo Valsorda <filippo@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  (cherry picked from commit 950fa11c4cb01a145bb07eeb167d90a1846061b3)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/323090
  950fa11c4cb01a145bb07eeb167d90a1846061b3:net/http/httputil: always remove hop-by-hop headers

  Previously, we'd fail to remove the Connection header from a request
  like this:

      Connection:
      Connection: x-header

  Fixes #46313
  Fixes CVE-2021-33197

  Change-Id: Ie3009e926ceecfa86dfa6bcc6fe14ff01086be7d
  Reviewed-on: https://go-review.googlesource.com/c/go/+/321929
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  Reviewed-by: Katie Hockman <katie@golang.org>
  Trust: Katie Hockman <katie@golang.org>
  Trust: Filippo Valsorda <filippo@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 0410005dc458f23fb15f64354f9a24ca8f2fe044
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 950fa11c4cb01a145bb07eeb167d90a1846061b3
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: cbd1ca84453fecf3825a6bb9f985823e8bc32b76
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/0410005dc458f23fb15f64354f9a24ca8f2fe044
    reference_type: commit
    reference_id: 0410005dc458f23fb15f64354f9a24ca8f2fe044
  - url: https://github.com/golang/go/tree/950fa11c4cb01a145bb07eeb167d90a1846061b3
    reference_type: commit
    reference_id: 950fa11c4cb01a145bb07eeb167d90a1846061b3
  - url: https://github.com/golang/go/tree/cbd1ca84453fecf3825a6bb9f985823e8bc32b76
    reference_type: commit
    reference_id: cbd1ca84453fecf3825a6bb9f985823e8bc32b76
