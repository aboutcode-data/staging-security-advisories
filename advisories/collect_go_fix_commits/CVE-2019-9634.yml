advisory_id: CVE-2019-9634
datasource_id: collect_go_fix_commits/CVE-2019-9634
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  1bebc53bc3c200890dd5f03cbd67fbe1023156d1:[release-branch.go1.11] runtime: safely load DLLs

  While many other call sites have been moved to using the proper
  higher-level system loading, these areas were left out. This prevents
  DLL directory injection attacks. This includes both the runtime load
  calls (using LoadLibrary prior) and the implicitly linked ones via
  cgo_import_dynamic, which we move to our LoadLibraryEx. The goal is to
  only loosely load kernel32.dll and strictly load all others.

  Meanwhile we make sure that we never fallback to insecure loading on
  older or unpatched systems.

  This is CVE-2019-9634.

  Fixes #30989
  Updates #14959
  Updates #28978
  Updates #30642

  Change-Id: I401a13ed8db248ab1bb5039bf2d31915cac72b93
  Reviewed-on: https://go-review.googlesource.com/c/go/+/165798
  Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  Reviewed-by: Alex Brainman <alex.brainman@gmail.com>
  (cherry picked from commit 9b6e9f0c8c66355c0f0575d808b32f52c8c6d21c)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/175378
  Run-TryBot: Dmitri Shuralyov <dmitshur@golang.org>
  Reviewed-by: Andrew Bonventre <andybons@golang.org>
  fc6457d1d2f6330a628d398701912c19e1f3b1ec:[release-branch.go1.12] runtime: safely load DLLs

  While many other call sites have been moved to using the proper
  higher-level system loading, these areas were left out. This prevents
  DLL directory injection attacks. This includes both the runtime load
  calls (using LoadLibrary prior) and the implicitly linked ones via
  cgo_import_dynamic, which we move to our LoadLibraryEx. The goal is to
  only loosely load kernel32.dll and strictly load all others.

  Meanwhile we make sure that we never fallback to insecure loading on
  older or unpatched systems.

  This is CVE-2019-9634.

  Fixes #30666
  Updates #14959
  Updates #28978
  Updates #30642

  Change-Id: I401a13ed8db248ab1bb5039bf2d31915cac72b93
  Reviewed-on: https://go-review.googlesource.com/c/go/+/165798
  Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  Reviewed-by: Alex Brainman <alex.brainman@gmail.com>
  (cherry picked from commit 9b6e9f0c8c66355c0f0575d808b32f52c8c6d21c)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/168339
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  Reviewed-by: Andrew Bonventre <andybons@golang.org>
  9b6e9f0c8c66355c0f0575d808b32f52c8c6d21c:runtime: safely load DLLs

  While many other call sites have been moved to using the proper
  higher-level system loading, these areas were left out. This prevents
  DLL directory injection attacks. This includes both the runtime load
  calls (using LoadLibrary prior) and the implicitly linked ones via
  cgo_import_dynamic, which we move to our LoadLibraryEx. The goal is to
  only loosely load kernel32.dll and strictly load all others.

  Meanwhile we make sure that we never fallback to insecure loading on
  older or unpatched systems.

  This is CVE-2019-9634.

  Fixes #14959
  Fixes #28978
  Fixes #30642

  Change-Id: I401a13ed8db248ab1bb5039bf2d31915cac72b93
  Reviewed-on: https://go-review.googlesource.com/c/go/+/165798
  Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  Reviewed-by: Alex Brainman <alex.brainman@gmail.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 1bebc53bc3c200890dd5f03cbd67fbe1023156d1
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: fc6457d1d2f6330a628d398701912c19e1f3b1ec
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 9b6e9f0c8c66355c0f0575d808b32f52c8c6d21c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/1bebc53bc3c200890dd5f03cbd67fbe1023156d1
    reference_type: commit
    reference_id: 1bebc53bc3c200890dd5f03cbd67fbe1023156d1
  - url: https://github.com/golang/go/tree/9b6e9f0c8c66355c0f0575d808b32f52c8c6d21c
    reference_type: commit
    reference_id: 9b6e9f0c8c66355c0f0575d808b32f52c8c6d21c
  - url: https://github.com/golang/go/tree/fc6457d1d2f6330a628d398701912c19e1f3b1ec
    reference_type: commit
    reference_id: fc6457d1d2f6330a628d398701912c19e1f3b1ec
