advisory_id: CVE-2023-29406
datasource_id: collect_go_fix_commits/CVE-2023-29406
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  5fa6923b1ea891400153d04ddf1545e23b40041b:[release-branch.go1.19] net/http: validate Host header before sending

  Verify that the Host header we send is valid.
  Avoids surprising behavior such as a Host of "go.dev\r\nX-Evil:oops"
  adding an X-Evil header to HTTP/1 requests.

  Add a test, skip the test for HTTP/2. HTTP/2 is not vulnerable to
  header injection in the way HTTP/1 is, but x/net/http2 doesn't validate
  the header and will go into a retry loop when the server rejects it.
  CL 506995 adds the necessary validation to x/net/http2.

  Updates #60374
  Fixes #61075
  For CVE-2023-29406

  Change-Id: I05cb6866a9bead043101954dfded199258c6dd04
  Reviewed-on: https://go-review.googlesource.com/c/go/+/506996
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Damien Neil <dneil@google.com>
  (cherry picked from commit 499458f7ca04087958987a33c2703c3ef03e27e2)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/507358
  Run-TryBot: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  312920c00aac9897b2a0693e752390b5b0711a5a:[release-branch.go1.20] net/http: validate Host header before sending

  Verify that the Host header we send is valid.
  Avoids surprising behavior such as a Host of "go.dev\r\nX-Evil:oops"
  adding an X-Evil header to HTTP/1 requests.

  Add a test, skip the test for HTTP/2. HTTP/2 is not vulnerable to
  header injection in the way HTTP/1 is, but x/net/http2 doesn't validate
  the header and will go into a retry loop when the server rejects it.
  CL 506995 adds the necessary validation to x/net/http2.

  For #60374
  Fixes #61076
  For CVE-2023-29406

  Change-Id: I05cb6866a9bead043101954dfded199258c6dd04
  Reviewed-on: https://go-review.googlesource.com/c/go/+/506996
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Damien Neil <dneil@google.com>
  (cherry picked from commit 499458f7ca04087958987a33c2703c3ef03e27e2)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/507357
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 5fa6923b1ea891400153d04ddf1545e23b40041b
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 312920c00aac9897b2a0693e752390b5b0711a5a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/312920c00aac9897b2a0693e752390b5b0711a5a
    reference_type: commit
    reference_id: 312920c00aac9897b2a0693e752390b5b0711a5a
  - url: https://github.com/golang/go/tree/5fa6923b1ea891400153d04ddf1545e23b40041b
    reference_type: commit
    reference_id: 5fa6923b1ea891400153d04ddf1545e23b40041b
