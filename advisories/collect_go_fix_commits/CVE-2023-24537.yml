advisory_id: CVE-2023-24537
datasource_id: collect_go_fix_commits/CVE-2023-24537
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  110e4fb1c2e3a21631704bbfaf672230b9ba2492:go/scanner: reject large line and column numbers in //line directives

  Setting a large line or column number using a //line directive can cause
  integer overflow even in small source files.

  Limit line and column numbers in //line directives to 2^30-1, which
  is small enough to avoid int32 overflow on all reasonbly-sized files.

  For #59180
  Fixes CVE-2023-24537

  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1802456
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Change-Id: I149bf34deca532af7994203fa1e6aca3c890ea14
  Reviewed-on: https://go-review.googlesource.com/c/go/+/482078
  Reviewed-by: Matthew Dempsky <mdempsky@google.com>
  TryBot-Bypass: Michael Knyszek <mknyszek@google.com>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  e7c4b07ecf6b367f1afc9cc48cde963829dd0aab:[release-branch.go1.20] go/scanner: reject large line and column numbers in //line directives

  Setting a large line or column number using a //line directive can cause
  integer overflow even in small source files.

  Limit line and column numbers in //line directives to 2^30-1, which
  is small enough to avoid int32 overflow on all reasonbly-sized files.

  Fixes CVE-2023-24537
  For #59180
  Fixes #59274

  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1802456
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Change-Id: Ib9c5cb38428ed34ab129d451b00a2998e72c861c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1802401
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/481992
  Reviewed-by: Matthew Dempsky <mdempsky@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  TryBot-Bypass: Michael Knyszek <mknyszek@google.com>
  126a1d02da82f93ede7ce0bd8d3c51ef627f2104:[release-branch.go1.19] go/scanner: reject large line and column numbers in //line directives

  Setting a large line or column number using a //line directive can cause
  integer overflow even in small source files.

  Limit line and column numbers in //line directives to 2^30-1, which
  is small enough to avoid int32 overflow on all reasonbly-sized files.

  Fixes CVE-2023-24537
  Fixes #59273
  For #59180

  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1802456
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1802611
  Reviewed-by: Damien Neil <dneil@google.com>
  Change-Id: Ifdfa192d54f722d781a4d8c5f35b5fb72d122168
  Reviewed-on: https://go-review.googlesource.com/c/go/+/481986
  Reviewed-by: Matthew Dempsky <mdempsky@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 110e4fb1c2e3a21631704bbfaf672230b9ba2492
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 126a1d02da82f93ede7ce0bd8d3c51ef627f2104
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: e7c4b07ecf6b367f1afc9cc48cde963829dd0aab
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/110e4fb1c2e3a21631704bbfaf672230b9ba2492
    reference_type: commit
    reference_id: 110e4fb1c2e3a21631704bbfaf672230b9ba2492
  - url: https://github.com/golang/go/tree/126a1d02da82f93ede7ce0bd8d3c51ef627f2104
    reference_type: commit
    reference_id: 126a1d02da82f93ede7ce0bd8d3c51ef627f2104
  - url: https://github.com/golang/go/tree/e7c4b07ecf6b367f1afc9cc48cde963829dd0aab
    reference_type: commit
    reference_id: e7c4b07ecf6b367f1afc9cc48cde963829dd0aab
