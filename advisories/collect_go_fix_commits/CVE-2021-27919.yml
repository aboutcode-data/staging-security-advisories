advisory_id: CVE-2021-27919
datasource_id: collect_go_fix_commits/CVE-2021-27919
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  cd3b4ca9f20fd14187ed4cdfdee1a02ea87e5cd8:archive/zip: fix panic in Reader.Open

  When operating on a Zip file that contains a file prefixed with "../",
  Open(...) would cause a panic in toValidName when attempting to strip
  the prefixed path components.

  Fixes CVE-2021-27919
  Fixes #44916

  Change-Id: Ic755d8126cb0897e2cbbdacf572439c38dde7b35
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1004761
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Katie Hockman <katiehockman@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/300489
  Trust: Katie Hockman <katie@golang.org>
  Run-TryBot: Katie Hockman <katie@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  Reviewed-by: Alexander Rakoczy <alex@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  634d28d78ccbeb6e86f8bfeba030ea8be518f8fa:[release-branch.go1.16-security] archive/zip: fix panic in Reader.Open

  When operating on a Zip file that contains a file prefixed with "../",
  Open(...) would cause a panic in toValidName when attempting to strip
  the prefixed path components.

  Fixes CVE-2021-27919

  Change-Id: Ic755d8126cb0897e2cbbdacf572439c38dde7b35
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1004761
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Katie Hockman <katiehockman@google.com>
  (cherry picked from commit ce22003b26eaf8e4a690757f699aae7062d41472)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1013753
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 634d28d78ccbeb6e86f8bfeba030ea8be518f8fa
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: cd3b4ca9f20fd14187ed4cdfdee1a02ea87e5cd8
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/634d28d78ccbeb6e86f8bfeba030ea8be518f8fa
    reference_type: commit
    reference_id: 634d28d78ccbeb6e86f8bfeba030ea8be518f8fa
  - url: https://github.com/golang/go/tree/cd3b4ca9f20fd14187ed4cdfdee1a02ea87e5cd8
    reference_type: commit
    reference_id: cd3b4ca9f20fd14187ed4cdfdee1a02ea87e5cd8
