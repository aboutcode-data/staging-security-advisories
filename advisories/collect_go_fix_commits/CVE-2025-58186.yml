advisory_id: CVE-2025-58186
datasource_id: collect_go_fix_commits/CVE-2025-58186
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  9b9d02c5a015910ce57024788de2ff254c6cfca6:net/http: add httpcookiemaxnum GODEBUG option to limit number of cookies parsed

  When handling HTTP headers, net/http does not currently limit the number
  of cookies that can be parsed. The only limitation that exists is for
  the size of the entire HTTP header, which is controlled by
  MaxHeaderBytes (defaults to 1 MB).

  Unfortunately, this allows a malicious actor to send HTTP headers which
  contain a massive amount of small cookies, such that as much cookies as
  possible can be fitted within the MaxHeaderBytes limitation. Internally,
  this causes us to allocate a massive number of Cookie struct.

  For example, a 1 MB HTTP header with cookies that repeats "a=;" will
  cause an allocation of ~66 MB in the heap. This can serve as a way for
  malicious actors to induce memory exhaustion.

  To fix this, we will now limit the number of cookies we are willing to
  parse to 3000 by default. This behavior can be changed by setting a new
  GODEBUG option: GODEBUG=httpcookiemaxnum. httpcookiemaxnum can be set to
  allow a higher or lower cookie limit. Setting it to 0 will also allow an
  infinite number of cookies to be parsed.

  Thanks to jub0bs for reporting this issue.

  For #75672
  Fixes CVE-2025-58186

  Change-Id: Ied58b3bc8acf5d11c880f881f36ecbf1d5d52622
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2720
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709855
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  100c5a66802b5a895b1d0e5ed3b7918f899c4833:[release-branch.go1.25] net/http: add httpcookiemaxnum GODEBUG option to limit number of cookies parsed

  When handling HTTP headers, net/http does not currently limit the number
  of cookies that can be parsed. The only limitation that exists is for
  the size of the entire HTTP header, which is controlled by
  MaxHeaderBytes (defaults to 1 MB).

  Unfortunately, this allows a malicious actor to send HTTP headers which
  contain a massive amount of small cookies, such that as much cookies as
  possible can be fitted within the MaxHeaderBytes limitation. Internally,
  this causes us to allocate a massive number of Cookie struct.

  For example, a 1 MB HTTP header with cookies that repeats "a=;" will
  cause an allocation of ~66 MB in the heap. This can serve as a way for
  malicious actors to induce memory exhaustion.

  To fix this, we will now limit the number of cookies we are willing to
  parse to 3000 by default. This behavior can be changed by setting a new
  GODEBUG option: GODEBUG=httpcookiemaxnum. httpcookiemaxnum can be set to
  allow a higher or lower cookie limit. Setting it to 0 will also allow an
  infinite number of cookies to be parsed.

  Thanks to jub0bs for reporting this issue.

  For #75672
  Fixes #75707
  Fixes CVE-2025-58186

  Change-Id: Ied58b3bc8acf5d11c880f881f36ecbf1d5d52622
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2720
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2965
  Reviewed-by: Nicholas Husin <husin@google.com>
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709849
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  c6b04dd33b0215f5deb83724661921842bf67607:[release-branch.go1.24] net/http: add httpcookiemaxnum GODEBUG option to limit number of cookies parsed

  When handling HTTP headers, net/http does not currently limit the number
  of cookies that can be parsed. The only limitation that exists is for
  the size of the entire HTTP header, which is controlled by
  MaxHeaderBytes (defaults to 1 MB).

  Unfortunately, this allows a malicious actor to send HTTP headers which
  contain a massive amount of small cookies, such that as much cookies as
  possible can be fitted within the MaxHeaderBytes limitation. Internally,
  this causes us to allocate a massive number of Cookie struct.

  For example, a 1 MB HTTP header with cookies that repeats "a=;" will
  cause an allocation of ~66 MB in the heap. This can serve as a way for
  malicious actors to induce memory exhaustion.

  To fix this, we will now limit the number of cookies we are willing to
  parse to 3000 by default. This behavior can be changed by setting a new
  GODEBUG option: GODEBUG=httpcookiemaxnum. httpcookiemaxnum can be set to
  allow a higher or lower cookie limit. Setting it to 0 will also allow an
  infinite number of cookies to be parsed.

  Thanks to jub0bs for reporting this issue.

  For #75672
  Fixes #75706
  Fixes CVE-2025-58186

  Change-Id: Ied58b3bc8acf5d11c880f881f36ecbf1d5d52622
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2720
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2983
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709840
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 9b9d02c5a015910ce57024788de2ff254c6cfca6
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: c6b04dd33b0215f5deb83724661921842bf67607
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 100c5a66802b5a895b1d0e5ed3b7918f899c4833
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/100c5a66802b5a895b1d0e5ed3b7918f899c4833
    reference_type: commit
    reference_id: 100c5a66802b5a895b1d0e5ed3b7918f899c4833
  - url: https://github.com/golang/go/tree/9b9d02c5a015910ce57024788de2ff254c6cfca6
    reference_type: commit
    reference_id: 9b9d02c5a015910ce57024788de2ff254c6cfca6
  - url: https://github.com/golang/go/tree/c6b04dd33b0215f5deb83724661921842bf67607
    reference_type: commit
    reference_id: c6b04dd33b0215f5deb83724661921842bf67607
