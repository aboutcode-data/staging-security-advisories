advisory_id: CVE-2021-41772
datasource_id: collect_go_fix_commits/CVE-2021-41772
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  88407a8dd98411f1730907dc8a69b99488af0052:[release-branch.go1.16] archive/zip: don't panic on (*Reader).Open

  Previously, opening a zip with (*Reader).Open could result in a panic if
  the zip contained a file whose name was exclusively made up of slash
  characters or ".." path elements.

  Open could also panic if passed the empty string directly as an argument.

  Now, any files in the zip whose name could not be made valid for
  fs.FS.Open will be skipped, and no longer added to the fs.FS file list,
  although they are still accessible through (*Reader).File.

  Note that it was already the case that a file could be accessible from
  (*Reader).Open with a name different from the one in (*Reader).File, as
  the former is the cleaned name, while the latter is the original one.

  Finally, made the actual panic site robust as a defense-in-depth measure.

  Fixes CVE-2021-41772
  Fixes #48251
  Updates #48085

  Co-authored-by: Filippo Valsorda <filippo@golang.org>
  Change-Id: I6271a3f2892e7746f52e213b8eba9a1bba974678
  Reviewed-on: https://go-review.googlesource.com/c/go/+/349770
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  Reviewed-by: Katie Hockman <katie@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  Trust: Katie Hockman <katie@golang.org>
  Trust: Julie Qiu <julie@golang.org>
  (cherry picked from commit b24687394b55a93449e2be4e6892ead58ea9a10f)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/360858
  Trust: Dmitri Shuralyov <dmitshur@golang.org>
  Run-TryBot: Dmitri Shuralyov <dmitshur@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  b212ba68296b503b395e7d1838ca72a19030a6bf:[release-branch.go1.17] archive/zip: don't panic on (*Reader).Open

  Previously, opening a zip with (*Reader).Open could result in a panic if
  the zip contained a file whose name was exclusively made up of slash
  characters or ".." path elements.

  Open could also panic if passed the empty string directly as an argument.

  Now, any files in the zip whose name could not be made valid for
  fs.FS.Open will be skipped, and no longer added to the fs.FS file list,
  although they are still accessible through (*Reader).File.

  Note that it was already the case that a file could be accessible from
  (*Reader).Open with a name different from the one in (*Reader).File, as
  the former is the cleaned name, while the latter is the original one.

  Finally, made the actual panic site robust as a defense-in-depth measure.

  Fixes CVE-2021-41772
  Fixes #48252
  Updates #48085

  Co-authored-by: Filippo Valsorda <filippo@golang.org>
  Change-Id: I6271a3f2892e7746f52e213b8eba9a1bba974678
  Reviewed-on: https://go-review.googlesource.com/c/go/+/349770
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  Reviewed-by: Katie Hockman <katie@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  Trust: Katie Hockman <katie@golang.org>
  Trust: Julie Qiu <julie@golang.org>
  (cherry picked from commit b24687394b55a93449e2be4e6892ead58ea9a10f)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/360859
  Trust: Dmitri Shuralyov <dmitshur@golang.org>
  Run-TryBot: Dmitri Shuralyov <dmitshur@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  b24687394b55a93449e2be4e6892ead58ea9a10f:archive/zip: don't panic on (*Reader).Open

  Previously, opening a zip with (*Reader).Open could result in a panic if
  the zip contained a file whose name was exclusively made up of slash
  characters or ".." path elements.

  Open could also panic if passed the empty string directly as an argument.

  Now, any files in the zip whose name could not be made valid for
  fs.FS.Open will be skipped, and no longer added to the fs.FS file list,
  although they are still accessible through (*Reader).File.

  Note that it was already the case that a file could be accessible from
  (*Reader).Open with a name different from the one in (*Reader).File, as
  the former is the cleaned name, while the latter is the original one.

  Finally, made the actual panic site robust as a defense-in-depth measure.

  Fixes CVE-2021-41772
  Fixes #48085

  Co-authored-by: Filippo Valsorda <filippo@golang.org>
  Change-Id: I6271a3f2892e7746f52e213b8eba9a1bba974678
  Reviewed-on: https://go-review.googlesource.com/c/go/+/349770
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  Reviewed-by: Katie Hockman <katie@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  Trust: Katie Hockman <katie@golang.org>
  Trust: Julie Qiu <julie@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 88407a8dd98411f1730907dc8a69b99488af0052
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: b24687394b55a93449e2be4e6892ead58ea9a10f
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: b212ba68296b503b395e7d1838ca72a19030a6bf
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/88407a8dd98411f1730907dc8a69b99488af0052
    reference_type: commit
    reference_id: 88407a8dd98411f1730907dc8a69b99488af0052
  - url: https://github.com/golang/go/tree/b212ba68296b503b395e7d1838ca72a19030a6bf
    reference_type: commit
    reference_id: b212ba68296b503b395e7d1838ca72a19030a6bf
  - url: https://github.com/golang/go/tree/b24687394b55a93449e2be4e6892ead58ea9a10f
    reference_type: commit
    reference_id: b24687394b55a93449e2be4e6892ead58ea9a10f
