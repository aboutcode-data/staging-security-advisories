advisory_id: CVE-2025-22873
datasource_id: collect_go_fix_commits/CVE-2025-22873
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  92e23b683f01fe581a0e14b5658f0c59d9ce0d38:os: avoid escape from Root via paths ending in ../

  The doInRoot function operates on a path split into components.
  The final path component retained any trailing path separator
  characters, to permit operations in a Root to retain the
  trailing-separator behavior of non-Root operations. However,
  doInRoot failed to take trailing separators into account
  when checking for .. path components.

  This could permit opening the parent directory of the Root
  with a path ending in "../".

  Change the split path to never include path separators in
  components, and handle trailing separators independently
  of the split path.

  Thanks to Dan Sebastian Thrane of SDU eScience Center for
  reporting this issue.

  Fixes #73555
  Fixes CVE-2025-22873

  Change-Id: I9a33a145c22f5eb1dd4e4cafae5fcc61a8d4f0d4
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2160
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/670036
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  8947f3395eb24dce6a5749517c0b40204b585f0a:[release-branch.go1.24] os: avoid escape from Root via paths ending in ../

  The doInRoot function operates on a path split into components.
  The final path component retained any trailing path separator
  characters, to permit operations in a Root to retain the
  trailing-separator behavior of non-Root operations. However,
  doInRoot failed to take trailing separators into account
  when checking for .. path components.

  This could permit opening the parent directory of the Root
  with a path ending in "../".

  Change the split path to never include path separators in
  components, and handle trailing separators independently
  of the split path.

  Thanks to Dan Sebastian Thrane of SDU eScience Center for
  reporting this issue.

  Fixes #73556
  Updates #73555
  Fixes CVE-2025-22873

  Change-Id: I9a33a145c22f5eb1dd4e4cafae5fcc61a8d4f0d4
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2160
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2180
  Commit-Queue: Damien Neil <dneil@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/670357
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 92e23b683f01fe581a0e14b5658f0c59d9ce0d38
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 8947f3395eb24dce6a5749517c0b40204b585f0a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/8947f3395eb24dce6a5749517c0b40204b585f0a
    reference_type: commit
    reference_id: 8947f3395eb24dce6a5749517c0b40204b585f0a
  - url: https://github.com/golang/go/tree/92e23b683f01fe581a0e14b5658f0c59d9ce0d38
    reference_type: commit
    reference_id: 92e23b683f01fe581a0e14b5658f0c59d9ce0d38
