advisory_id: CVE-2021-27918
datasource_id: collect_go_fix_commits/CVE-2021-27918
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  d0b79e3513a29628f3599dc8860666b6eed75372:encoding/xml: prevent infinite loop while decoding

  This change properly handles a TokenReader which
  returns an EOF in the middle of an open XML
  element.

  Thanks to Sam Whited for reporting this.

  Fixes CVE-2021-27918
  Fixes #44913

  Change-Id: Id02a3f3def4a1b415fa2d9a8e3b373eb6cb0f433
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1004594
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/300391
  Trust: Katie Hockman <katie@golang.org>
  Run-TryBot: Katie Hockman <katie@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  Reviewed-by: Alexander Rakoczy <alex@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  d86e53e896eca907ad67300c0bb495e3dd925358:[release-branch.go1.16-security] encoding/xml: prevent infinite loop while decoding

  This change properly handles a TokenReader which
  returns an EOF in the middle of an open XML
  element.

  Thanks to Sam Whited for reporting this.

  Fixes CVE-2021-27918

  Change-Id: Id02a3f3def4a1b415fa2d9a8e3b373eb6cb0f433
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1004594
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  (cherry picked from commit e7ce1f6746223ec7b4caa3b1ece25d9be3864710)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1014235
  91062c2e4cbbf78a108919f6ed3ded1173937cf3:[release-branch.go1.15-security] encoding/xml: prevent infinite loop while decoding

  This change properly handles a TokenReader which
  returns an EOF in the middle of an open XML
  element.

  Thanks to Sam Whited for reporting this.

  Fixes CVE-2021-27918

  Change-Id: Id02a3f3def4a1b415fa2d9a8e3b373eb6cb0f433
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1004594
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  (cherry picked from commit e7ce1f6746223ec7b4caa3b1ece25d9be3864710)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1014236
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 91062c2e4cbbf78a108919f6ed3ded1173937cf3
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: d0b79e3513a29628f3599dc8860666b6eed75372
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: d86e53e896eca907ad67300c0bb495e3dd925358
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/91062c2e4cbbf78a108919f6ed3ded1173937cf3
    reference_type: commit
    reference_id: 91062c2e4cbbf78a108919f6ed3ded1173937cf3
  - url: https://github.com/golang/go/tree/d0b79e3513a29628f3599dc8860666b6eed75372
    reference_type: commit
    reference_id: d0b79e3513a29628f3599dc8860666b6eed75372
  - url: https://github.com/golang/go/tree/d86e53e896eca907ad67300c0bb495e3dd925358
    reference_type: commit
    reference_id: d86e53e896eca907ad67300c0bb495e3dd925358
