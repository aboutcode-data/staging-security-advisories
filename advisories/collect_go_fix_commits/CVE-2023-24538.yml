advisory_id: CVE-2023-24538
datasource_id: collect_go_fix_commits/CVE-2023-24538
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  ecc5ba46117d2e73f65caac27dfe53acb12cf4f3:html/template: disallow actions in JS template literals

  ECMAScript 6 introduced template literals[0][1] which are delimited with
  backticks. These need to be escaped in a similar fashion to the
  delimiters for other string literals. Additionally template literals can
  contain special syntax for string interpolation.

  There is no clear way to allow safe insertion of actions within JS
  template literals, as handling (JS) string interpolation inside of these
  literals is rather complex. As such we've chosen to simply disallow
  template actions within these template literals.

  A new error code is added for this parsing failure case, errJsTmplLit,
  but it is unexported as it is not backwards compatible with other minor
  release versions to introduce an API change in a minor release. We will
  export this code in the next major release.

  The previous behavior (with the cavet that backticks are now escaped
  properly) can be re-enabled with GODEBUG=jstmpllitinterp=1.

  This change subsumes CL471455.

  Thanks to Sohom Datta, Manipal Institute of Technology, for reporting
  this issue.

  Fixes CVE-2023-24538
  Fixes #59234

  [0] https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#sec-template-literals
  [1] https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals

  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1802457
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Change-Id: Ia221fefdb273bd0f066dffc2abcf2a616801d2f2
  Reviewed-on: https://go-review.googlesource.com/c/go/+/482079
  TryBot-Bypass: Michael Knyszek <mknyszek@google.com>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Matthew Dempsky <mdempsky@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  20374d1d759bc4e17486bde1cb9dca5be37d9e52:[release-branch.go1.20] html/template: disallow actions in JS template literals

  ECMAScript 6 introduced template literals[0][1] which are delimited with
  backticks. These need to be escaped in a similar fashion to the
  delimiters for other string literals. Additionally template literals can
  contain special syntax for string interpolation.

  There is no clear way to allow safe insertion of actions within JS
  template literals, as handling (JS) string interpolation inside of these
  literals is rather complex. As such we've chosen to simply disallow
  template actions within these template literals.

  A new error code is added for this parsing failure case, errJsTmplLit,
  but it is unexported as it is not backwards compatible with other minor
  release versions to introduce an API change in a minor release. We will
  export this code in the next major release.

  The previous behavior (with the cavet that backticks are now escaped
  properly) can be re-enabled with GODEBUG=jstmpllitinterp=1.

  This change subsumes CL471455.

  Thanks to Sohom Datta, Manipal Institute of Technology, for reporting
  this issue.

  Fixes CVE-2023-24538
  For #59234
  Fixes #59272

  [0] https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#sec-template-literals
  [1] https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals

  Change-Id: Idff74ec386e9b73d6e9a3c9f71990eabc0ce7506
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1802457
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1802688
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/481993
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  TryBot-Bypass: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Matthew Dempsky <mdempsky@google.com>
  b1e3ecfa06b67014429a197ec5e134ce4303ad9b:[release-branch.go1.19] html/template: disallow actions in JS template literals

  ECMAScript 6 introduced template literals[0][1] which are delimited with
  backticks. These need to be escaped in a similar fashion to the
  delimiters for other string literals. Additionally template literals can
  contain special syntax for string interpolation.

  There is no clear way to allow safe insertion of actions within JS
  template literals, as handling (JS) string interpolation inside of these
  literals is rather complex. As such we've chosen to simply disallow
  template actions within these template literals.

  A new error code is added for this parsing failure case, errJsTmplLit,
  but it is unexported as it is not backwards compatible with other minor
  release versions to introduce an API change in a minor release. We will
  export this code in the next major release.

  The previous behavior (with the cavet that backticks are now escaped
  properly) can be re-enabled with GODEBUG=jstmpllitinterp=1.

  This change subsumes CL471455.

  Thanks to Sohom Datta, Manipal Institute of Technology, for reporting
  this issue.

  Fixes CVE-2023-24538
  For #59234
  Fixes #59271

  [0] https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#sec-template-literals
  [1] https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals

  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1802457
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1802612
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Change-Id: Ic7f10595615f2b2740d9c85ad7ef40dc0e78c04c
  Reviewed-on: https://go-review.googlesource.com/c/go/+/481987
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Matthew Dempsky <mdempsky@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: b1e3ecfa06b67014429a197ec5e134ce4303ad9b
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: ecc5ba46117d2e73f65caac27dfe53acb12cf4f3
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 20374d1d759bc4e17486bde1cb9dca5be37d9e52
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/20374d1d759bc4e17486bde1cb9dca5be37d9e52
    reference_type: commit
    reference_id: 20374d1d759bc4e17486bde1cb9dca5be37d9e52
  - url: https://github.com/golang/go/tree/b1e3ecfa06b67014429a197ec5e134ce4303ad9b
    reference_type: commit
    reference_id: b1e3ecfa06b67014429a197ec5e134ce4303ad9b
  - url: https://github.com/golang/go/tree/ecc5ba46117d2e73f65caac27dfe53acb12cf4f3
    reference_type: commit
    reference_id: ecc5ba46117d2e73f65caac27dfe53acb12cf4f3
