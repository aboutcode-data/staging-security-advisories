advisory_id: CVE-2021-36221
datasource_id: collect_go_fix_commits/CVE-2021-36221
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  ba93baa74a52d57ae79313313ea990cc791ef50e:[release-branch.go1.15] net/http/httputil: close incoming ReverseProxy request body

  Reading from an incoming request body after the request handler aborts
  with a panic can cause a panic, becuse http.Server does not (contrary
  to its documentation) close the request body in this case.

  Always close the incoming request body in ReverseProxy.ServeHTTP to
  ensure that any in-flight outgoing requests using the body do not
  read from it.

  Fixes #47473
  Updates #46866
  Fixes CVE-2021-36221

  Change-Id: I310df269200ad8732c5d9f1a2b00de68725831df
  Reviewed-on: https://go-review.googlesource.com/c/go/+/333191
  Trust: Damien Neil <dneil@google.com>
  Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  (cherry picked from commit b7a85e0003cedb1b48a1fd3ae5b746ec6330102e)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/338550
  Trust: Filippo Valsorda <filippo@golang.org>
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  Reviewed-by: Damien Neil <dneil@google.com>
  accf363d5da864521c90b152fb734f3f15e00521:[release-branch.go1.16] net/http/httputil: close incoming ReverseProxy request body

  Reading from an incoming request body after the request handler aborts
  with a panic can cause a panic, becuse http.Server does not (contrary
  to its documentation) close the request body in this case.

  Always close the incoming request body in ReverseProxy.ServeHTTP to
  ensure that any in-flight outgoing requests using the body do not
  read from it.

  Fixes #47474
  Updates #46866
  Fixes CVE-2021-36221

  Change-Id: I310df269200ad8732c5d9f1a2b00de68725831df
  Reviewed-on: https://go-review.googlesource.com/c/go/+/333191
  Trust: Damien Neil <dneil@google.com>
  Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  (cherry picked from commit b7a85e0003cedb1b48a1fd3ae5b746ec6330102e)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/338551
  Trust: Filippo Valsorda <filippo@golang.org>
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  Reviewed-by: Damien Neil <dneil@google.com>
  b7a85e0003cedb1b48a1fd3ae5b746ec6330102e:net/http/httputil: close incoming ReverseProxy request body

  Reading from an incoming request body after the request handler aborts
  with a panic can cause a panic, becuse http.Server does not (contrary
  to its documentation) close the request body in this case.

  Always close the incoming request body in ReverseProxy.ServeHTTP to
  ensure that any in-flight outgoing requests using the body do not
  read from it.

  Updates #46866
  Fixes CVE-2021-36221

  Change-Id: I310df269200ad8732c5d9f1a2b00de68725831df
  Reviewed-on: https://go-review.googlesource.com/c/go/+/333191
  Trust: Damien Neil <dneil@google.com>
  Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: accf363d5da864521c90b152fb734f3f15e00521
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: ba93baa74a52d57ae79313313ea990cc791ef50e
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: b7a85e0003cedb1b48a1fd3ae5b746ec6330102e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/accf363d5da864521c90b152fb734f3f15e00521
    reference_type: commit
    reference_id: accf363d5da864521c90b152fb734f3f15e00521
  - url: https://github.com/golang/go/tree/b7a85e0003cedb1b48a1fd3ae5b746ec6330102e
    reference_type: commit
    reference_id: b7a85e0003cedb1b48a1fd3ae5b746ec6330102e
  - url: https://github.com/golang/go/tree/ba93baa74a52d57ae79313313ea990cc791ef50e
    reference_type: commit
    reference_id: ba93baa74a52d57ae79313313ea990cc791ef50e
