advisory_id: CVE-2020-28366
datasource_id: collect_go_fix_commits/CVE-2020-28366
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  57ffa7b101296229328eaec6219a7c211a4ac49b:[release-branch.go1.14-security] cmd/go, cmd/cgo: don't let bogus symbol set cgo_ldflag

  A hand-edited object file can have a symbol name that uses newline and
  other normally invalid characters. The cgo tool will generate Go files
  containing symbol names, unquoted. That can permit those symbol names
  to inject Go code into a cgo-generated file. If that Go code uses the
  //go:cgo_ldflag pragma, it can cause the C linker to run arbitrary
  code when building a package. If you build an imported package we
  permit arbitrary code at run time, but we don't want to permit it at
  package build time. This CL prevents this in two ways.

  In cgo, reject invalid symbols that contain non-printable or space
  characters, or that contain anything that looks like a Go comment.

  In the go tool, double check all //go:cgo_ldflag directives in
  generated code, to make sure they follow the existing LDFLAG restrictions.

  Thanks to Chris Brown and Tempus Ex for reporting this.

  Fixes CVE-2020-28366

  Change-Id: Ia1ad8f3791ea79612690fa7d26ac451d0f6df7c1
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/895832
  Reviewed-by: Than McIntosh <thanm@google.com>
  Reviewed-by: Cherry Zhang <cherryyz@google.com>
  (cherry picked from commit 6bc814dd2bbfeaafa41d314dd4cc591b575dfbf6)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/901055
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  32159824698a82a174b60a6845e8494ae3243102:[release-branch.go1.15-security] cmd/go, cmd/cgo: don't let bogus symbol set cgo_ldflag

  A hand-edited object file can have a symbol name that uses newline and
  other normally invalid characters. The cgo tool will generate Go files
  containing symbol names, unquoted. That can permit those symbol names
  to inject Go code into a cgo-generated file. If that Go code uses the
  //go:cgo_ldflag pragma, it can cause the C linker to run arbitrary
  code when building a package. If you build an imported package we
  permit arbitrary code at run time, but we don't want to permit it at
  package build time. This CL prevents this in two ways.

  In cgo, reject invalid symbols that contain non-printable or space
  characters, or that contain anything that looks like a Go comment.

  In the go tool, double check all //go:cgo_ldflag directives in
  generated code, to make sure they follow the existing LDFLAG restrictions.

  Thanks to Chris Brown and Tempus Ex for reporting this.

  Fixes CVE-2020-28366

  Change-Id: Ia1ad8f3791ea79612690fa7d26ac451d0f6df7c1
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/895832
  Reviewed-by: Than McIntosh <thanm@google.com>
  Reviewed-by: Cherry Zhang <cherryyz@google.com>
  (cherry picked from commit 6bc814dd2bbfeaafa41d314dd4cc591b575dfbf6)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/901056
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 32159824698a82a174b60a6845e8494ae3243102
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 57ffa7b101296229328eaec6219a7c211a4ac49b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/32159824698a82a174b60a6845e8494ae3243102
    reference_type: commit
    reference_id: 32159824698a82a174b60a6845e8494ae3243102
  - url: https://github.com/golang/go/tree/57ffa7b101296229328eaec6219a7c211a4ac49b
    reference_type: commit
    reference_id: 57ffa7b101296229328eaec6219a7c211a4ac49b
