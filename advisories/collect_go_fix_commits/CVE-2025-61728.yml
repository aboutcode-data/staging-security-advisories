advisory_id: CVE-2025-61728
datasource_id: collect_go_fix_commits/CVE-2025-61728
datasource_url: https://github.com/golang/go
aliases: []
summary: "bb7c0c717c8b3517210dce8f38cb2c91694af4e2:archive/zip: reduce CPU usage in index construction\n\
  \nConstructing the zip index (which is done once when first opening\na file in an archive)\
  \ can consume large amounts of CPU when\nprocessing deeply-nested directory paths.\n\nSwitch\
  \ to a less inefficient algorithm.\n\nThanks to Jakub Ciolek for reporting this issue.\n\n\
  \tgoos: darwin\n\tgoarch: arm64\n\tpkg: archive/zip\n\tcpu: Apple M4 Pro\n\t             \
  \             │  /tmp/bench.0  │            /tmp/bench.1            │\n\t                \
  \          │     sec/op     │   sec/op     vs base               │\n\tReaderOneDeepDir-14\
  \         25983.62m ± 2%   46.01m ± 2%  -99.82% (p=0.000 n=8)\n\tReaderManyDeepDirs-14   \
  \       16.221 ± 1%    2.763 ± 6%  -82.96% (p=0.000 n=8)\n\tReaderManyShallowFiles-14    \
  \  130.3m ± 1%   128.8m ± 2%   -1.20% (p=0.003 n=8)\n\tgeomean                         3.801\
  \        253.9m       -93.32%\n\nFixes #77102\nFixes CVE-2025-61728\n\nChange-Id: I2c9c864be01b2a2769eb67fbab1b250aeb8f6c42\n\
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3060\nReviewed-by: Nicholas\
  \ Husin <husin@google.com>\nReviewed-by: Neal Patel <nealpatel@google.com>\nReviewed-on: https://go-review.googlesource.com/c/go/+/736713\n\
  Auto-Submit: Michael Pratt <mpratt@google.com>\nLUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>\n\
  Reviewed-by: Junyang Shao <shaojunyang@google.com>\n9d497df196d66553ae844c22a53fb86cd422e80c:[release-branch.go1.25]\
  \ archive/zip: reduce CPU usage in index construction\n\nConstructing the zip index (which\
  \ is done once when first opening\na file in an archive) can consume large amounts of CPU\
  \ when\nprocessing deeply-nested directory paths.\n\nSwitch to a less inefficient algorithm.\n\
  \nThanks to Jakub Ciolek for reporting this issue.\n\n\tgoos: darwin\n\tgoarch: arm64\n\t\
  pkg: archive/zip\n\tcpu: Apple M4 Pro\n\t                          │  /tmp/bench.0  │    \
  \        /tmp/bench.1            │\n\t                          │     sec/op     │   sec/op\
  \     vs base               │\n\tReaderOneDeepDir-14         25983.62m ± 2%   46.01m ± 2%\
  \  -99.82% (p=0.000 n=8)\n\tReaderManyDeepDirs-14          16.221 ± 1%    2.763 ± 6%  -82.96%\
  \ (p=0.000 n=8)\n\tReaderManyShallowFiles-14      130.3m ± 1%   128.8m ± 2%   -1.20% (p=0.003\
  \ n=8)\n\tgeomean                         3.801        253.9m       -93.32%\n\nFixes #77102\n\
  Fixes CVE-2025-61728\n\nChange-Id: I2c9c864be01b2a2769eb67fbab1b250aeb8f6c42\nReviewed-on:\
  \ https://go-internal-review.googlesource.com/c/go/+/3060\nReviewed-by: Nicholas Husin <husin@google.com>\n\
  Reviewed-by: Neal Patel <nealpatel@google.com>\nReviewed-on: https://go-internal-review.googlesource.com/c/go/+/3327\n\
  Reviewed-by: Damien Neil <dneil@google.com>\nReviewed-on: https://go-review.googlesource.com/c/go/+/736724\n\
  TryBot-Bypass: Michael Pratt <mpratt@google.com>\nReviewed-by: Junyang Shao <shaojunyang@google.com>\n\
  Auto-Submit: Michael Pratt <mpratt@google.com>\n73dcdd54362fbdf347a72b77279fb5ccb804c392:[release-branch.go1.26]\
  \ archive/zip: reduce CPU usage in index construction\n\nConstructing the zip index (which\
  \ is done once when first opening\na file in an archive) can consume large amounts of CPU\
  \ when\nprocessing deeply-nested directory paths.\n\nSwitch to a less inefficient algorithm.\n\
  \nThanks to Jakub Ciolek for reporting this issue.\n\n\tgoos: darwin\n\tgoarch: arm64\n\t\
  pkg: archive/zip\n\tcpu: Apple M4 Pro\n\t                          │  /tmp/bench.0  │    \
  \        /tmp/bench.1            │\n\t                          │     sec/op     │   sec/op\
  \     vs base               │\n\tReaderOneDeepDir-14         25983.62m ± 2%   46.01m ± 2%\
  \  -99.82% (p=0.000 n=8)\n\tReaderManyDeepDirs-14          16.221 ± 1%    2.763 ± 6%  -82.96%\
  \ (p=0.000 n=8)\n\tReaderManyShallowFiles-14      130.3m ± 1%   128.8m ± 2%   -1.20% (p=0.003\
  \ n=8)\n\tgeomean                         3.801        253.9m       -93.32%\n\nFixes #77102\n\
  Fixes CVE-2025-61728\n\nChange-Id: I2c9c864be01b2a2769eb67fbab1b250aeb8f6c42\nReviewed-on:\
  \ https://go-internal-review.googlesource.com/c/go/+/3060\nReviewed-by: Nicholas Husin <husin@google.com>\n\
  Reviewed-by: Neal Patel <nealpatel@google.com>\nReviewed-on: https://go-internal-review.googlesource.com/c/go/+/3346\n\
  Reviewed-by: Damien Neil <dneil@google.com>\nReviewed-on: https://go-review.googlesource.com/c/go/+/736708\n\
  Auto-Submit: Michael Pratt <mpratt@google.com>\nTryBot-Bypass: Michael Pratt <mpratt@google.com>\n\
  Reviewed-by: Junyang Shao <shaojunyang@google.com>\n3235ef3db85c2d7e797b976822a7addaf6d5ca2a:[release-branch.go1.24]\
  \ archive/zip: reduce CPU usage in index construction\n\nConstructing the zip index (which\
  \ is done once when first opening\na file in an archive) can consume large amounts of CPU\
  \ when\nprocessing deeply-nested directory paths.\n\nSwitch to a less inefficient algorithm.\n\
  \nThanks to Jakub Ciolek for reporting this issue.\n\n\tgoos: darwin\n\tgoarch: arm64\n\t\
  pkg: archive/zip\n\tcpu: Apple M4 Pro\n\t                          │  /tmp/bench.0  │    \
  \        /tmp/bench.1            │\n\t                          │     sec/op     │   sec/op\
  \     vs base               │\n\tReaderOneDeepDir-14         25983.62m ± 2%   46.01m ± 2%\
  \  -99.82% (p=0.000 n=8)\n\tReaderManyDeepDirs-14          16.221 ± 1%    2.763 ± 6%  -82.96%\
  \ (p=0.000 n=8)\n\tReaderManyShallowFiles-14      130.3m ± 1%   128.8m ± 2%   -1.20% (p=0.003\
  \ n=8)\n\tgeomean                         3.801        253.9m       -93.32%\n\nFixes #77102\n\
  Fixes CVE-2025-61728\n\nChange-Id: I2c9c864be01b2a2769eb67fbab1b250aeb8f6c42\nReviewed-on:\
  \ https://go-internal-review.googlesource.com/c/go/+/3060\nReviewed-by: Nicholas Husin <husin@google.com>\n\
  Reviewed-by: Neal Patel <nealpatel@google.com>\nReviewed-on: https://go-internal-review.googlesource.com/c/go/+/3328\n\
  Reviewed-by: Damien Neil <dneil@google.com>\nReviewed-on: https://go-review.googlesource.com/c/go/+/736703\n\
  TryBot-Bypass: Michael Pratt <mpratt@google.com>\nAuto-Submit: Michael Pratt <mpratt@google.com>\n\
  Reviewed-by: Junyang Shao <shaojunyang@google.com>"
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 9d497df196d66553ae844c22a53fb86cd422e80c
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: bb7c0c717c8b3517210dce8f38cb2c91694af4e2
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 3235ef3db85c2d7e797b976822a7addaf6d5ca2a
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 73dcdd54362fbdf347a72b77279fb5ccb804c392
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/3235ef3db85c2d7e797b976822a7addaf6d5ca2a
    reference_type: commit
    reference_id: 3235ef3db85c2d7e797b976822a7addaf6d5ca2a
  - url: https://github.com/golang/go/tree/73dcdd54362fbdf347a72b77279fb5ccb804c392
    reference_type: commit
    reference_id: 73dcdd54362fbdf347a72b77279fb5ccb804c392
  - url: https://github.com/golang/go/tree/9d497df196d66553ae844c22a53fb86cd422e80c
    reference_type: commit
    reference_id: 9d497df196d66553ae844c22a53fb86cd422e80c
  - url: https://github.com/golang/go/tree/bb7c0c717c8b3517210dce8f38cb2c91694af4e2
    reference_type: commit
    reference_id: bb7c0c717c8b3517210dce8f38cb2c91694af4e2
