advisory_id: CVE-2025-22871
datasource_id: collect_go_fix_commits/CVE-2025-22871
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  ac1f5aa3d62efe21e65ce4dc30e6996d59acfbd0:[release-branch.go1.24] net/http: reject newlines in chunk-size lines

  Unlike request headers, where we are allowed to leniently accept
  a bare LF in place of a CRLF, chunked bodies must always use CRLF
  line terminators. We were already enforcing this for chunk-data lines;
  do so for chunk-size lines as well. Also reject bare CRs anywhere
  other than as part of the CRLF terminator.

  Fixes CVE-2025-22871
  Fixes #72011
  For #71988

  Change-Id: Ib0e21af5a8ba28c2a1ca52b72af8e2265ec79e4a
  Reviewed-on: https://go-review.googlesource.com/c/go/+/652998
  Reviewed-by: Jonathan Amsterdam <jba@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  (cherry picked from commit d31c805535f3fde95646ee4d87636aaaea66847b)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/657056
  15e01a2e43ecb8c7e15ff7e9d62fe3f10dcac931:[release-branch.go1.23] net/http: reject newlines in chunk-size lines

  Unlike request headers, where we are allowed to leniently accept
  a bare LF in place of a CRLF, chunked bodies must always use CRLF
  line terminators. We were already enforcing this for chunk-data lines;
  do so for chunk-size lines as well. Also reject bare CRs anywhere
  other than as part of the CRLF terminator.

  Fixes CVE-2025-22871
  Fixes #72010
  For #71988

  Change-Id: Ib0e21af5a8ba28c2a1ca52b72af8e2265ec79e4a
  Reviewed-on: https://go-review.googlesource.com/c/go/+/652998
  Reviewed-by: Jonathan Amsterdam <jba@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  (cherry picked from commit d31c805535f3fde95646ee4d87636aaaea66847b)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/657216
  d31c805535f3fde95646ee4d87636aaaea66847b:net/http: reject newlines in chunk-size lines

  Unlike request headers, where we are allowed to leniently accept
  a bare LF in place of a CRLF, chunked bodies must always use CRLF
  line terminators. We were already enforcing this for chunk-data lines;
  do so for chunk-size lines as well. Also reject bare CRs anywhere
  other than as part of the CRLF terminator.

  Fixes CVE-2025-22871
  Fixes #71988

  Change-Id: Ib0e21af5a8ba28c2a1ca52b72af8e2265ec79e4a
  Reviewed-on: https://go-review.googlesource.com/c/go/+/652998
  Reviewed-by: Jonathan Amsterdam <jba@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 15e01a2e43ecb8c7e15ff7e9d62fe3f10dcac931
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: ac1f5aa3d62efe21e65ce4dc30e6996d59acfbd0
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: d31c805535f3fde95646ee4d87636aaaea66847b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/15e01a2e43ecb8c7e15ff7e9d62fe3f10dcac931
    reference_type: commit
    reference_id: 15e01a2e43ecb8c7e15ff7e9d62fe3f10dcac931
  - url: https://github.com/golang/go/tree/ac1f5aa3d62efe21e65ce4dc30e6996d59acfbd0
    reference_type: commit
    reference_id: ac1f5aa3d62efe21e65ce4dc30e6996d59acfbd0
  - url: https://github.com/golang/go/tree/d31c805535f3fde95646ee4d87636aaaea66847b
    reference_type: commit
    reference_id: d31c805535f3fde95646ee4d87636aaaea66847b
