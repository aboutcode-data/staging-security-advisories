advisory_id: CVE-2020-24553
datasource_id: collect_go_fix_commits/CVE-2020-24553
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  4f5cd0c0331943c7ec72df3b827d972584f77833:net/http/cgi,net/http/fcgi: add Content-Type detection

  This CL ensures that responses served via CGI and FastCGI
  have a Content-Type header based on the content of the
  response if not explicitly set by handlers.

  If the implementers of the handler did not explicitly
  specify a Content-Type both CGI implementations would default
  to "text/html", potentially causing cross-site scripting.

  Thanks to RedTeam Pentesting GmbH for reporting this.

  Fixes #40928
  Fixes CVE-2020-24553

  Change-Id: I82cfc396309b5ab2e8d6e9a87eda8ea7e3799473
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/823217
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/252179
  Run-TryBot: Filippo Valsorda <filippo@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  Reviewed-by: Katie Hockman <katie@golang.org>
  eb07103a083237414145a45f029c873d57037e06:[release-branch.go1.15-security] net/http/cgi,net/http/fcgi: add Content-Type detection

  This CL ensures that responses served via CGI and FastCGI
  have a Content-Type header based on the content of the
  response if not explicitly set by handlers.

  If the implementers of the handler did not explicitly
  specify a Content-Type both CGI implementations would default
  to "text/html", potentially causing cross-site scripting.

  Thanks to RedTeam Pentesting GmbH for reporting this.

  Fixes CVE-2020-24553

  Change-Id: I82cfc396309b5ab2e8d6e9a87eda8ea7e3799473
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/823217
  Reviewed-by: Russ Cox <rsc@google.com>
  (cherry picked from commit 23d675d07fdc56aafd67c0a0b63d5b7e14708ff0)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/835311
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  8fcee8abbea1bb959c63a6944f9ddf490a97f802:[release-branch.go1.14-security] net/http/cgi,net/http/fcgi: add Content-Type detection

  This CL ensures that responses served via CGI and FastCGI
  have a Content-Type header based on the content of the
  response if not explicitly set by handlers.

  If the implementers of the handler did not explicitly
  specify a Content-Type both CGI implementations would default
  to "text/html", potentially causing cross-site scripting.

  Thanks to RedTeam Pentesting GmbH for reporting this.

  Fixes CVE-2020-24553

  Change-Id: I82cfc396309b5ab2e8d6e9a87eda8ea7e3799473
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/823217
  Reviewed-by: Russ Cox <rsc@google.com>
  (cherry picked from commit 23d675d07fdc56aafd67c0a0b63d5b7e14708ff0)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/835312
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: eb07103a083237414145a45f029c873d57037e06
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 4f5cd0c0331943c7ec72df3b827d972584f77833
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 8fcee8abbea1bb959c63a6944f9ddf490a97f802
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/4f5cd0c0331943c7ec72df3b827d972584f77833
    reference_type: commit
    reference_id: 4f5cd0c0331943c7ec72df3b827d972584f77833
  - url: https://github.com/golang/go/tree/8fcee8abbea1bb959c63a6944f9ddf490a97f802
    reference_type: commit
    reference_id: 8fcee8abbea1bb959c63a6944f9ddf490a97f802
  - url: https://github.com/golang/go/tree/eb07103a083237414145a45f029c873d57037e06
    reference_type: commit
    reference_id: eb07103a083237414145a45f029c873d57037e06
