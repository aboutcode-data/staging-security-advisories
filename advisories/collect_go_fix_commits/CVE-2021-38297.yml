advisory_id: CVE-2021-38297
datasource_id: collect_go_fix_commits/CVE-2021-38297
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  77f2750f4398990eed972186706f160631d7dae4:misc/wasm, cmd/link: do not let command line args overwrite global data

  On Wasm, wasm_exec.js puts command line arguments at the beginning
  of the linear memory (following the "zero page"). Currently there
  is no limit for this, and a very long command line can overwrite
  the program's data section. Prevent this by limiting the command
  line to 4096 bytes, and in the linker ensuring the data section
  starts at a high enough address (8192).

  (Arguably our address assignment on Wasm is a bit confusing. This
  is the minimum fix I can come up with.)

  Thanks to Ben Lubar for reporting this issue.

  Fixes #48797
  Fixes CVE-2021-38297

  Change-Id: I0f50fbb2a5b6d0d047e3c134a88988d9133e4ab3
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1205933
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Than McIntosh <thanm@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/354571
  Reviewed-by: Cherry Mui <cherryyz@google.com>
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  Trust: Michael Knyszek <mknyszek@google.com>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  TryBot-Result: Go Bot <gobot@golang.org>
  4548fcc8dfd933c237f29bba6f90040a85922564:[release-branch.go1.16] misc/wasm, cmd/link: do not let command line args overwrite global data

  On Wasm, wasm_exec.js puts command line arguments at the beginning
  of the linear memory (following the "zero page"). Currently there
  is no limit for this, and a very long command line can overwrite
  the program's data section. Prevent this by limiting the command
  line to 4096 bytes, and in the linker ensuring the data section
  starts at a high enough address (8192).

  (Arguably our address assignment on Wasm is a bit confusing. This
  is the minimum fix I can come up with.)

  Thanks to Ben Lubar for reporting this issue.

  Change by Cherry Mui <cherryyz@google.com>.

  For #48797
  Fixes #48799
  Fixes CVE-2021-38297

  Change-Id: I0f50fbb2a5b6d0d047e3c134a88988d9133e4ab3
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1205933
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Than McIntosh <thanm@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/354591
  Trust: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  4925e0766f8a92ab82913b3564228645613290f5:[release-branch.go1.17] misc/wasm, cmd/link: do not let command line args overwrite global data

  On Wasm, wasm_exec.js puts command line arguments at the beginning
  of the linear memory (following the "zero page"). Currently there
  is no limit for this, and a very long command line can overwrite
  the program's data section. Prevent this by limiting the command
  line to 4096 bytes, and in the linker ensuring the data section
  starts at a high enough address (8192).

  (Arguably our address assignment on Wasm is a bit confusing. This
  is the minimum fix I can come up with.)

  Thanks to Ben Lubar for reporting this issue.

  Change by Cherry Mui <cherryyz@google.com>.

  For #48797
  Fixes #48800
  Fixes CVE-2021-38297

  Change-Id: I0f50fbb2a5b6d0d047e3c134a88988d9133e4ab3
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1205933
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Than McIntosh <thanm@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/354592
  Trust: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Heschi Kreinick <heschi@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 4548fcc8dfd933c237f29bba6f90040a85922564
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 77f2750f4398990eed972186706f160631d7dae4
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 4925e0766f8a92ab82913b3564228645613290f5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/4548fcc8dfd933c237f29bba6f90040a85922564
    reference_type: commit
    reference_id: 4548fcc8dfd933c237f29bba6f90040a85922564
  - url: https://github.com/golang/go/tree/4925e0766f8a92ab82913b3564228645613290f5
    reference_type: commit
    reference_id: 4925e0766f8a92ab82913b3564228645613290f5
  - url: https://github.com/golang/go/tree/77f2750f4398990eed972186706f160631d7dae4
    reference_type: commit
    reference_id: 77f2750f4398990eed972186706f160631d7dae4
