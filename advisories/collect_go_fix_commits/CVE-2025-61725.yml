advisory_id: CVE-2025-61725
datasource_id: collect_go_fix_commits/CVE-2025-61725
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  463165699d874ef0ac7965fc5788fe1693eaae9a:net/mail: avoid quadratic behavior in mail address parsing

  RFC 5322 domain-literal parsing built the dtext value one character
  at a time with string concatenation, resulting in excessive
  resource consumption when parsing very large domain-literal values.

  Replace with a subslice.

  Benchmark not included in this CL because it's too narrow to be
  of general ongoing use, but for:

      ParseAddress("alice@[" + strings.Repeat("a", 0x40000) + "]")

  goos: darwin
  goarch: arm64
  pkg: net/mail
  cpu: Apple M4 Pro
                  │  /tmp/bench.0  │            /tmp/bench.1             │
                  │     sec/op     │   sec/op     vs base                │
  ParseAddress-14   1987.732m ± 9%   1.524m ± 5%  -99.92% (p=0.000 n=10)

                  │   /tmp/bench.0   │             /tmp/bench.1              │
                  │       B/op       │     B/op      vs base                 │
  ParseAddress-14   33692.767Mi ± 0%   1.282Mi ± 0%  -100.00% (p=0.000 n=10)

                  │  /tmp/bench.0  │            /tmp/bench.1            │
                  │   allocs/op    │ allocs/op   vs base                │
  ParseAddress-14   263711.00 ± 0%   17.00 ± 0%  -99.99% (p=0.000 n=10)

  Thanks to Philippe Antoine (Catena cyber) for reporting this issue.

  Fixes CVE-2025-61725
  Fixes #75680

  Change-Id: Id971c2d5b59882bb476e22fceb7e01ec08234bb7
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2840
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709860
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  6a057327cf9a405e6388593dd4aedc0d0da77092:[release-branch.go1.25] net/mail: avoid quadratic behavior in mail address parsing

  RFC 5322 domain-literal parsing built the dtext value one character
  at a time with string concatenation, resulting in excessive
  resource consumption when parsing very large domain-literal values.

  Replace with a subslice.

  Benchmark not included in this CL because it's too narrow to be
  of general ongoing use, but for:

      ParseAddress("alice@[" + strings.Repeat("a", 0x40000) + "]")

  goos: darwin
  goarch: arm64
  pkg: net/mail
  cpu: Apple M4 Pro
                  │  /tmp/bench.0  │            /tmp/bench.1             │
                  │     sec/op     │   sec/op     vs base                │
  ParseAddress-14   1987.732m ± 9%   1.524m ± 5%  -99.92% (p=0.000 n=10)

                  │   /tmp/bench.0   │             /tmp/bench.1              │
                  │       B/op       │     B/op      vs base                 │
  ParseAddress-14   33692.767Mi ± 0%   1.282Mi ± 0%  -100.00% (p=0.000 n=10)

                  │  /tmp/bench.0  │            /tmp/bench.1            │
                  │   allocs/op    │ allocs/op   vs base                │
  ParseAddress-14   263711.00 ± 0%   17.00 ± 0%  -99.99% (p=0.000 n=10)

  Thanks to Philippe Antoine (Catena cyber) for reporting this issue.

  Fixes CVE-2025-61725
  For #75680
  Fixes #75701

  Change-Id: Id971c2d5b59882bb476e22fceb7e01ec08234bb7
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2840
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2961
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709844
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  bc6981fd74024098185a23ba3a83a81ed68a06c9:[release-branch.go1.24] net/mail: avoid quadratic behavior in mail address parsing

  RFC 5322 domain-literal parsing built the dtext value one character
  at a time with string concatenation, resulting in excessive
  resource consumption when parsing very large domain-literal values.

  Replace with a subslice.

  Benchmark not included in this CL because it's too narrow to be
  of general ongoing use, but for:

      ParseAddress("alice@[" + strings.Repeat("a", 0x40000) + "]")

  goos: darwin
  goarch: arm64
  pkg: net/mail
  cpu: Apple M4 Pro
                  │  /tmp/bench.0  │            /tmp/bench.1             │
                  │     sec/op     │   sec/op     vs base                │
  ParseAddress-14   1987.732m ± 9%   1.524m ± 5%  -99.92% (p=0.000 n=10)

                  │   /tmp/bench.0   │             /tmp/bench.1              │
                  │       B/op       │     B/op      vs base                 │
  ParseAddress-14   33692.767Mi ± 0%   1.282Mi ± 0%  -100.00% (p=0.000 n=10)

                  │  /tmp/bench.0  │            /tmp/bench.1            │
                  │   allocs/op    │ allocs/op   vs base                │
  ParseAddress-14   263711.00 ± 0%   17.00 ± 0%  -99.99% (p=0.000 n=10)

  Thanks to Philippe Antoine (Catena cyber) for reporting this issue.

  Fixes CVE-2025-61725
  For #75680
  Fixes #75700

  Change-Id: Id971c2d5b59882bb476e22fceb7e01ec08234bb7
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2840
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2962
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709835
  Auto-Submit: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 463165699d874ef0ac7965fc5788fe1693eaae9a
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 6a057327cf9a405e6388593dd4aedc0d0da77092
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: bc6981fd74024098185a23ba3a83a81ed68a06c9
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/463165699d874ef0ac7965fc5788fe1693eaae9a
    reference_type: commit
    reference_id: 463165699d874ef0ac7965fc5788fe1693eaae9a
  - url: https://github.com/golang/go/tree/6a057327cf9a405e6388593dd4aedc0d0da77092
    reference_type: commit
    reference_id: 6a057327cf9a405e6388593dd4aedc0d0da77092
  - url: https://github.com/golang/go/tree/bc6981fd74024098185a23ba3a83a81ed68a06c9
    reference_type: commit
    reference_id: bc6981fd74024098185a23ba3a83a81ed68a06c9
