advisory_id: CVE-2026-27139
datasource_id: collect_go_fix_commits/CVE-2026-27139
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  8cce3ab20c49a5c3c9fa8e97ad47335c3ccd2620:[release-branch.go1.26] os: avoid escape from Root via ReadDir or Readdir

  When reading the contents of a directory using
  File.ReadDir or File.Readdir, the os.FileInfo was
  populated on Unix platforms using lstat.
  This lstat call is vulnerable to a TOCTOU race
  and could escape the root.

  For example:
    - Open the directory "dir" within a Root.
      This directory contains a file named "file".
    - Use File.ReadDir to list the contents of "dir",
      receiving a os.DirEntry for "dir/file".
    - Replace "dir" with a symlink to "/etc".
    - Use DirEntry.Info to retrieve the FileInfo for "dir/file".
      This FileInfo contains information on "/etc/file" instead.

  This escape permits identifying the presence or absence of
  files outside a Root, as well as retreiving stat metadata
  (size, mode, modification time, etc.) for files outside a Root.

  This escape does not permit reading or writing to files
  outside a Root.

  For #77827
  Fixes #77834
  Fixes CVE-2026-27139

  Change-Id: I40004f830c588e516aff8ee593d630d36a6a6964
  Reviewed-on: https://go-review.googlesource.com/c/go/+/749480
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Nicholas Husin <nsh@golang.org>
  Auto-Submit: Damien Neil <dneil@google.com>
  (cherry picked from commit 657ed934e85dc575aad51356c4b437961e7c1313)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/749822
  4091800393d254befde3770fd16f51200ebd5a3d:[release-branch.go1.25] os: avoid escape from Root via ReadDir or Readdir

  When reading the contents of a directory using
  File.ReadDir or File.Readdir, the os.FileInfo was
  populated on Unix platforms using lstat.
  This lstat call is vulnerable to a TOCTOU race
  and could escape the root.

  For example:
    - Open the directory "dir" within a Root.
      This directory contains a file named "file".
    - Use File.ReadDir to list the contents of "dir",
      receiving a os.DirEntry for "dir/file".
    - Replace "dir" with a symlink to "/etc".
    - Use DirEntry.Info to retrieve the FileInfo for "dir/file".
      This FileInfo contains information on "/etc/file" instead.

  This escape permits identifying the presence or absence of
  files outside a Root, as well as retreiving stat metadata
  (size, mode, modification time, etc.) for files outside a Root.

  This escape does not permit reading or writing to files
  outside a Root.

  For #77827
  Fixes #77833
  Fixes CVE-2026-27139

  Change-Id: I40004f830c588e516aff8ee593d630d36a6a6964
  Reviewed-on: https://go-review.googlesource.com/c/go/+/749480
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Nicholas Husin <nsh@golang.org>
  Auto-Submit: Damien Neil <dneil@google.com>
  (cherry picked from commit 657ed934e85dc575aad51356c4b437961e7c1313)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/749920
  657ed934e85dc575aad51356c4b437961e7c1313:os: avoid escape from Root via ReadDir or Readdir

  When reading the contents of a directory using
  File.ReadDir or File.Readdir, the os.FileInfo was
  populated on Unix platforms using lstat.
  This lstat call is vulnerable to a TOCTOU race
  and could escape the root.

  For example:
    - Open the directory "dir" within a Root.
      This directory contains a file named "file".
    - Use File.ReadDir to list the contents of "dir",
      receiving a os.DirEntry for "dir/file".
    - Replace "dir" with a symlink to "/etc".
    - Use DirEntry.Info to retrieve the FileInfo for "dir/file".
      This FileInfo contains information on "/etc/file" instead.

  This escape permits identifying the presence or absence of
  files outside a Root, as well as retreiving stat metadata
  (size, mode, modification time, etc.) for files outside a Root.

  This escape does not permit reading or writing to files
  outside a Root.

  Fixes #77827
  Fixes CVE-2026-27139

  Change-Id: I40004f830c588e516aff8ee593d630d36a6a6964
  Reviewed-on: https://go-review.googlesource.com/c/go/+/749480
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Nicholas Husin <nsh@golang.org>
  Auto-Submit: Damien Neil <dneil@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 657ed934e85dc575aad51356c4b437961e7c1313
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 4091800393d254befde3770fd16f51200ebd5a3d
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 8cce3ab20c49a5c3c9fa8e97ad47335c3ccd2620
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/4091800393d254befde3770fd16f51200ebd5a3d
    reference_type: commit
    reference_id: 4091800393d254befde3770fd16f51200ebd5a3d
  - url: https://github.com/golang/go/tree/657ed934e85dc575aad51356c4b437961e7c1313
    reference_type: commit
    reference_id: 657ed934e85dc575aad51356c4b437961e7c1313
  - url: https://github.com/golang/go/tree/8cce3ab20c49a5c3c9fa8e97ad47335c3ccd2620
    reference_type: commit
    reference_id: 8cce3ab20c49a5c3c9fa8e97ad47335c3ccd2620
