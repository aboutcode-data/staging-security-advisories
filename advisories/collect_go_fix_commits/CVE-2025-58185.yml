advisory_id: CVE-2025-58185
datasource_id: collect_go_fix_commits/CVE-2025-58185
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  8709a41d5ef7321f486a1857f189c3fee20e8edd:encoding/asn1: prevent memory exhaustion when parsing using internal/saferio

  Within parseSequenceOf, reflect.MakeSlice is being used to pre-allocate
  a slice that is needed in order to fully validate the given DER payload.
  The size of the slice allocated are also multiple times larger than the
  input DER:

  - When using asn1.Unmarshal directly, the allocated slice is ~28x
    larger.
  - When passing in DER using x509.ParseCertificateRequest, the allocated
    slice is ~48x larger.
  - When passing in DER using ocsp.ParseResponse, the allocated slice is
    ~137x larger.

  As a result, a malicious actor can craft a big empty DER payload,
  resulting in an unnecessary large allocation of memories. This can be a
  way to cause memory exhaustion.

  To prevent this, we now use SliceCapWithSize within internal/saferio to
  enforce a memory allocation cap.

  Thanks to Jakub Ciolek for reporting this issue.

  For #75671
  Fixes CVE-2025-58185

  Change-Id: Id50e76187eda43f594be75e516b9ca1d2ae6f428
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2700
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709856
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  e0f655bf3f96410f90756f49532bc6a1851855ca:[release-branch.go1.25] encoding/asn1: prevent memory exhaustion when parsing using internal/saferio

  Within parseSequenceOf, reflect.MakeSlice is being used to pre-allocate
  a slice that is needed in order to fully validate the given DER payload.
  The size of the slice allocated are also multiple times larger than the
  input DER:

  - When using asn1.Unmarshal directly, the allocated slice is ~28x
    larger.
  - When passing in DER using x509.ParseCertificateRequest, the allocated
    slice is ~48x larger.
  - When passing in DER using ocsp.ParseResponse, the allocated slice is
    ~137x larger.

  As a result, a malicious actor can craft a big empty DER payload,
  resulting in an unnecessary large allocation of memories. This can be a
  way to cause memory exhaustion.

  To prevent this, we now use SliceCapWithSize within internal/saferio to
  enforce a memory allocation cap.

  Thanks to Jakub Ciolek for reporting this issue.

  For #75671
  Fixes #75705
  Fixes CVE-2025-58185

  Change-Id: Id50e76187eda43f594be75e516b9ca1d2ae6f428
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2700
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2966
  Reviewed-by: Nicholas Husin <husin@google.com>
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709850
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  5c3d61c886f7ecfce9a6d6d3c97e6d5a8afb17d1:[release-branch.go1.24] encoding/asn1: prevent memory exhaustion when parsing using internal/saferio

  Within parseSequenceOf, reflect.MakeSlice is being used to pre-allocate
  a slice that is needed in order to fully validate the given DER payload.
  The size of the slice allocated are also multiple times larger than the
  input DER:

  - When using asn1.Unmarshal directly, the allocated slice is ~28x
    larger.
  - When passing in DER using x509.ParseCertificateRequest, the allocated
    slice is ~48x larger.
  - When passing in DER using ocsp.ParseResponse, the allocated slice is
    ~137x larger.

  As a result, a malicious actor can craft a big empty DER payload,
  resulting in an unnecessary large allocation of memories. This can be a
  way to cause memory exhaustion.

  To prevent this, we now use SliceCapWithSize within internal/saferio to
  enforce a memory allocation cap.

  Thanks to Jakub Ciolek for reporting this issue.

  For #75671
  Fixes #75704
  Fixes CVE-2025-58185

  Change-Id: Id50e76187eda43f594be75e516b9ca1d2ae6f428
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2700
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2984
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709841
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: e0f655bf3f96410f90756f49532bc6a1851855ca
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 5c3d61c886f7ecfce9a6d6d3c97e6d5a8afb17d1
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 8709a41d5ef7321f486a1857f189c3fee20e8edd
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/5c3d61c886f7ecfce9a6d6d3c97e6d5a8afb17d1
    reference_type: commit
    reference_id: 5c3d61c886f7ecfce9a6d6d3c97e6d5a8afb17d1
  - url: https://github.com/golang/go/tree/8709a41d5ef7321f486a1857f189c3fee20e8edd
    reference_type: commit
    reference_id: 8709a41d5ef7321f486a1857f189c3fee20e8edd
  - url: https://github.com/golang/go/tree/e0f655bf3f96410f90756f49532bc6a1851855ca
    reference_type: commit
    reference_id: e0f655bf3f96410f90756f49532bc6a1851855ca
