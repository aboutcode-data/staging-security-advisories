advisory_id: CVE-2020-15586
datasource_id: collect_go_fix_commits/CVE-2020-15586
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  fa98f46741f818913a8c11b877520a548715131f:net/http: synchronize "100 Continue" write and Handler writes

  The expectContinueReader writes to the connection on the first
  Request.Body read. Since a Handler might be doing a read in parallel or
  before a write, expectContinueReader needs to synchronize with the
  ResponseWriter, and abort if a response already went out.

  The tests will land in a separate CL.

  Fixes #34902
  Fixes CVE-2020-15586

  Change-Id: Icdd8dd539f45e8863762bd378194bb4741e875fc
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/793350
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/242598
  Run-TryBot: Katie Hockman <katie@golang.org>
  Reviewed-by: Filippo Valsorda <filippo@golang.org>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  f3529ca9610be93ac4bb6fedc65429f7984227b6:[release-branch.go1.14-security] net/http: synchronize "100 Continue" write and Handler writes

  The expectContinueReader writes to the connection on the first
  Request.Body read. Since a Handler might be doing a read in parallel or
  before a write, expectContinueReader needs to synchronize with the
  ResponseWriter, and abort if a response already went out.

  The tests will land in a separate CL.

  Fixes #34902
  Fixes CVE-2020-15586

  Change-Id: Icdd8dd539f45e8863762bd378194bb4741e875fc
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/793350
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  (cherry picked from commit b5e504f4a07c572744b228fa1b10e3989c4c44f3)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/793500
  e434185ec16b3783629bcb364b9a350706df7c1e:[release-branch.go1.13-security] net/http: synchronize "100 Continue" write and Handler writes

  The expectContinueReader writes to the connection on the first
  Request.Body read. Since a Handler might be doing a read in parallel or
  before a write, expectContinueReader needs to synchronize with the
  ResponseWriter, and abort if a response already went out.

  The tests will land in a separate CL.

  Fixes #34902
  Fixes CVE-2020-15586

  Change-Id: Icdd8dd539f45e8863762bd378194bb4741e875fc
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/793350
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  (cherry picked from commit b5e504f4a07c572744b228fa1b10e3989c4c44f3)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/793499
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: f3529ca9610be93ac4bb6fedc65429f7984227b6
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: e434185ec16b3783629bcb364b9a350706df7c1e
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: fa98f46741f818913a8c11b877520a548715131f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/e434185ec16b3783629bcb364b9a350706df7c1e
    reference_type: commit
    reference_id: e434185ec16b3783629bcb364b9a350706df7c1e
  - url: https://github.com/golang/go/tree/f3529ca9610be93ac4bb6fedc65429f7984227b6
    reference_type: commit
    reference_id: f3529ca9610be93ac4bb6fedc65429f7984227b6
  - url: https://github.com/golang/go/tree/fa98f46741f818913a8c11b877520a548715131f
    reference_type: commit
    reference_id: fa98f46741f818913a8c11b877520a548715131f
