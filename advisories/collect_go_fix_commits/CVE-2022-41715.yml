advisory_id: CVE-2022-41715
datasource_id: collect_go_fix_commits/CVE-2022-41715
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  c3c4aea55b404c2e6ef109ec6a345f4ccb877381:regexp: limit size of parsed regexps

  Set a 128 MB limit on the amount of space used by []syntax.Inst
  in the compiled form corresponding to a given regexp.

  Also set a 128 MB limit on the rune storage in the *syntax.Regexp
  tree itself.

  Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

  Fixes CVE-2022-41715.
  Fixes #55949.

  Change-Id: Ia656baed81564436368cf950e1c5409752f28e1b
  Reviewed-on: https://go-review.googlesource.com/c/go/+/439356
  Auto-Submit: Roland Shoemaker <roland@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Damien Neil <dneil@google.com>
  e9017c2416ad0ef642f5e0c2eab2dbf3cba4d997:[release-branch.go1.18] regexp: limit size of parsed regexps

  Set a 128 MB limit on the amount of space used by []syntax.Inst
  in the compiled form corresponding to a given regexp.

  Also set a 128 MB limit on the rune storage in the *syntax.Regexp
  tree itself.

  Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

  Fixes CVE-2022-41715.
  Updates #55949.
  Fixes #55950.

  Change-Id: Ia656baed81564436368cf950e1c5409752f28e1b
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1592136
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/438501
  Run-TryBot: Carlos Amedee <carlos@golang.org>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  645abfe529dc325e16daa17210640c2907d1c17a:[release-branch.go1.19] regexp: limit size of parsed regexps

  Set a 128 MB limit on the amount of space used by []syntax.Inst
  in the compiled form corresponding to a given regexp.

  Also set a 128 MB limit on the rune storage in the *syntax.Regexp
  tree itself.

  Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

  Fixes CVE-2022-41715.
  Updates #55949.
  Fixes #55951.

  Change-Id: Ia656baed81564436368cf950e1c5409752f28e1b
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1592047
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/438499
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Run-TryBot: Carlos Amedee <carlos@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: c3c4aea55b404c2e6ef109ec6a345f4ccb877381
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: e9017c2416ad0ef642f5e0c2eab2dbf3cba4d997
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 645abfe529dc325e16daa17210640c2907d1c17a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/645abfe529dc325e16daa17210640c2907d1c17a
    reference_type: commit
    reference_id: 645abfe529dc325e16daa17210640c2907d1c17a
  - url: https://github.com/golang/go/tree/c3c4aea55b404c2e6ef109ec6a345f4ccb877381
    reference_type: commit
    reference_id: c3c4aea55b404c2e6ef109ec6a345f4ccb877381
  - url: https://github.com/golang/go/tree/e9017c2416ad0ef642f5e0c2eab2dbf3cba4d997
    reference_type: commit
    reference_id: e9017c2416ad0ef642f5e0c2eab2dbf3cba4d997
