advisory_id: CVE-2022-30631
datasource_id: collect_go_fix_commits/CVE-2022-30631
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  0117dee7dccbbd7803d88f65a2ce8bd686219ad3:[release-branch.go1.17] compress/gzip: fix stack exhaustion bug in Reader.Read

  Replace recursion with iteration in Reader.Read to avoid stack
  exhaustion when there are a large number of files.

  Fixes CVE-2022-30631
  Fixes #53717
  Updates #53168

  Change-Id: I47d8afe3f2d40b0213ab61431df9b221794dbfe0
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1455673
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  (cherry picked from commit cf498969c8a0bae9d7a24b98fc1f66c824a4775d)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/417071
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  8e27a8ac4c001c27713810b75925aa3794049c48:[release-branch.go1.18] compress/gzip: fix stack exhaustion bug in Reader.Read

  Replace recursion with iteration in Reader.Read to avoid stack
  exhaustion when there are a large number of files.

  Fixes CVE-2022-30631
  Fixes #53718
  Updates #53168

  Change-Id: I47d8afe3f2d40b0213ab61431df9b221794dbfe0
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1455673
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  (cherry picked from commit cf498969c8a0bae9d7a24b98fc1f66c824a4775d)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/417057
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  b2b8872c876201eac2d0707276c6999ff3eb185e:compress/gzip: fix stack exhaustion bug in Reader.Read

  Replace recursion with iteration in Reader.Read to avoid stack
  exhaustion when there are a large number of files.

  Fixes CVE-2022-30631
  Fixes #53168

  Change-Id: I47d8afe3f2d40b0213ab61431df9b221794dbfe0
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1455673
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/417067
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: b2b8872c876201eac2d0707276c6999ff3eb185e
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 8e27a8ac4c001c27713810b75925aa3794049c48
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 0117dee7dccbbd7803d88f65a2ce8bd686219ad3
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/0117dee7dccbbd7803d88f65a2ce8bd686219ad3
    reference_type: commit
    reference_id: 0117dee7dccbbd7803d88f65a2ce8bd686219ad3
  - url: https://github.com/golang/go/tree/8e27a8ac4c001c27713810b75925aa3794049c48
    reference_type: commit
    reference_id: 8e27a8ac4c001c27713810b75925aa3794049c48
  - url: https://github.com/golang/go/tree/b2b8872c876201eac2d0707276c6999ff3eb185e
    reference_type: commit
    reference_id: b2b8872c876201eac2d0707276c6999ff3eb185e
