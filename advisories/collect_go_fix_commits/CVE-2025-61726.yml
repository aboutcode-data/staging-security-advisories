advisory_id: CVE-2025-61726
datasource_id: collect_go_fix_commits/CVE-2025-61726
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  2dcaaa751295597e1f603b7488c4624db6a84d2b:net/url: add urlmaxqueryparams GODEBUG to limit the number of query parameters

  net/url does not currently limit the number of query parameters parsed by
  url.ParseQuery or URL.Query.

  When parsing a application/x-www-form-urlencoded form,
  net/http.Request.ParseForm will parse up to 10 MB of query parameters.
  An input consisting of a large number of small, unique parameters can
  cause excessive memory consumption.

  We now limit the number of query parameters parsed to 10000 by default.
  The limit can be adjusted by setting GODEBUG=urlmaxqueryparams=<n>.
  Setting urlmaxqueryparams to 0 disables the limit.

  Thanks to jub0bs for reporting this issue.

  Fixes #77101
  Fixes CVE-2025-61726

  Change-Id: Iee3374c7ee2d8586dbf158536d3ade424203ff66
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3020
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736712
  Auto-Submit: Michael Pratt <mpratt@google.com>
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  afa9b66ac081d3b239d8c1a226b5e884c8435185:[release-branch.go1.25] net/url: add urlmaxqueryparams GODEBUG to limit the number of query parameters

  net/url does not currently limit the number of query parameters parsed by
  url.ParseQuery or URL.Query.

  When parsing a application/x-www-form-urlencoded form,
  net/http.Request.ParseForm will parse up to 10 MB of query parameters.
  An input consisting of a large number of small, unique parameters can
  cause excessive memory consumption.

  We now limit the number of query parameters parsed to 10000 by default.
  The limit can be adjusted by setting GODEBUG=urlmaxqueryparams=<n>.
  Setting urlmaxqueryparams to 0 disables the limit.

  Thanks to jub0bs for reporting this issue.

  Fixes #77101
  Fixes CVE-2025-61726

  Change-Id: Iee3374c7ee2d8586dbf158536d3ade424203ff66
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3020
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3325
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736723
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  5405b5ce26dc7113e0ab585676921870c251cf3a:[release-branch.go1.26] net/url: add urlmaxqueryparams GODEBUG to limit the number of query parameters

  net/url does not currently limit the number of query parameters parsed by
  url.ParseQuery or URL.Query.

  When parsing a application/x-www-form-urlencoded form,
  net/http.Request.ParseForm will parse up to 10 MB of query parameters.
  An input consisting of a large number of small, unique parameters can
  cause excessive memory consumption.

  We now limit the number of query parameters parsed to 10000 by default.
  The limit can be adjusted by setting GODEBUG=urlmaxqueryparams=<n>.
  Setting urlmaxqueryparams to 0 disables the limit.

  Thanks to jub0bs for reporting this issue.

  Fixes #77101
  Fixes CVE-2025-61726

  Change-Id: Iee3374c7ee2d8586dbf158536d3ade424203ff66
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3020
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3345
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736707
  Auto-Submit: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
  85c794ddce26a092b0ea68d0fca79028b5069d5a:[release-branch.go1.24] net/url: add urlmaxqueryparams GODEBUG to limit the number of query parameters

  net/url does not currently limit the number of query parameters parsed by
  url.ParseQuery or URL.Query.

  When parsing a application/x-www-form-urlencoded form,
  net/http.Request.ParseForm will parse up to 10 MB of query parameters.
  An input consisting of a large number of small, unique parameters can
  cause excessive memory consumption.

  We now limit the number of query parameters parsed to 10000 by default.
  The limit can be adjusted by setting GODEBUG=urlmaxqueryparams=<n>.
  Setting urlmaxqueryparams to 0 disables the limit.

  Thanks to jub0bs for reporting this issue.

  Fixes #77101
  Fixes CVE-2025-61726

  Change-Id: Iee3374c7ee2d8586dbf158536d3ade424203ff66
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3020
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3326
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736702
  Auto-Submit: Michael Pratt <mpratt@google.com>
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 5405b5ce26dc7113e0ab585676921870c251cf3a
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: afa9b66ac081d3b239d8c1a226b5e884c8435185
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2dcaaa751295597e1f603b7488c4624db6a84d2b
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 85c794ddce26a092b0ea68d0fca79028b5069d5a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/2dcaaa751295597e1f603b7488c4624db6a84d2b
    reference_type: commit
    reference_id: 2dcaaa751295597e1f603b7488c4624db6a84d2b
  - url: https://github.com/golang/go/tree/5405b5ce26dc7113e0ab585676921870c251cf3a
    reference_type: commit
    reference_id: 5405b5ce26dc7113e0ab585676921870c251cf3a
  - url: https://github.com/golang/go/tree/85c794ddce26a092b0ea68d0fca79028b5069d5a
    reference_type: commit
    reference_id: 85c794ddce26a092b0ea68d0fca79028b5069d5a
  - url: https://github.com/golang/go/tree/afa9b66ac081d3b239d8c1a226b5e884c8435185
    reference_type: commit
    reference_id: afa9b66ac081d3b239d8c1a226b5e884c8435185
