advisory_id: CVE-2024-34158
datasource_id: collect_go_fix_commits/CVE-2024-34158
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  f22d73197635b23c13bb852e330e5339eefaf910:go/build/constraint: add parsing limits

  Limit the size of build constraints that we will parse. This prevents a
  number of stack exhaustions that can be hit when parsing overly complex
  constraints. The imposed limits are unlikely to ever be hit in real
  world usage.

  Fixes #69141
  Fixes CVE-2024-34158

  Change-Id: I38b614bf04caa36eefc6a4350d848588c4cef3c4
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1540
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/611240
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Auto-Submit: Dmitri Shuralyov <dmitshur@golang.org>
  d4c53812e6ce2ac368173d7fcd31d0ecfcffb002:[release-branch.go1.22] go/build/constraint: add parsing limits

  Limit the size of build constraints that we will parse. This prevents a
  number of stack exhaustions that can be hit when parsing overly complex
  constraints. The imposed limits are unlikely to ever be hit in real
  world usage.

  Updates #69141
  Fixes #69148
  Fixes CVE-2024-34158

  Change-Id: I38b614bf04caa36eefc6a4350d848588c4cef3c4
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1540
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  (cherry picked from commit 0c74dc9e0da0cf1e12494b514d822b5bebbc9f04)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1582
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/611183
  Auto-Submit: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Dmitri Shuralyov <dmitshur@google.com>
  032ac075c20c01c6c35a672d1542d3e98eab84ea:[release-branch.go1.23] go/build/constraint: add parsing limits

  Limit the size of build constraints that we will parse. This prevents a
  number of stack exhaustions that can be hit when parsing overly complex
  constraints. The imposed limits are unlikely to ever be hit in real
  world usage.

  Updates #69141
  Fixes #69149
  Fixes CVE-2024-34158

  Change-Id: I38b614bf04caa36eefc6a4350d848588c4cef3c4
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1540
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  (cherry picked from commit 0c74dc9e0da0cf1e12494b514d822b5bebbc9f04)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1562
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/611177
  Reviewed-by: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Auto-Submit: Dmitri Shuralyov <dmitshur@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: f22d73197635b23c13bb852e330e5339eefaf910
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 032ac075c20c01c6c35a672d1542d3e98eab84ea
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: d4c53812e6ce2ac368173d7fcd31d0ecfcffb002
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/032ac075c20c01c6c35a672d1542d3e98eab84ea
    reference_type: commit
    reference_id: 032ac075c20c01c6c35a672d1542d3e98eab84ea
  - url: https://github.com/golang/go/tree/d4c53812e6ce2ac368173d7fcd31d0ecfcffb002
    reference_type: commit
    reference_id: d4c53812e6ce2ac368173d7fcd31d0ecfcffb002
  - url: https://github.com/golang/go/tree/f22d73197635b23c13bb852e330e5339eefaf910
    reference_type: commit
    reference_id: f22d73197635b23c13bb852e330e5339eefaf910
