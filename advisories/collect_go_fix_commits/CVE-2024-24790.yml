advisory_id: CVE-2024-24790
datasource_id: collect_go_fix_commits/CVE-2024-24790
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  12d5810cdb1f73cf23d7a86462143e9463317fca:[release-branch.go1.22] net/netip: check if address is v6 mapped in Is methods

  In all of the Is* methods, check if the address is a v6 mapped v4
  address, and unmap it if so.

  Thanks to Enze Wang of Alioth (@zer0yu) and Jianjun Chen of Zhongguancun
  Lab (@chenjj) for reporting this issue.

  Fixes #67680
  Fixes #67682
  Fixes CVE-2024-24790

  Change-Id: I6bd03ca1a5d93a0b59027d861c84060967b265b0
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1460
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit f7f270c1621fdc7ee48e0487b2fac0356947d19b)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1480
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/590296
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: David Chase <drchase@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  051bdf3fd12a40307606ff9381138039c5f452f0:[release-branch.go1.21] net/netip: check if address is v6 mapped in Is methods

  In all of the Is* methods, check if the address is a v6 mapped v4
  address, and unmap it if so.

  Thanks to Enze Wang of Alioth (@zer0yu) and Jianjun Chen of Zhongguancun
  Lab (@chenjj) for reporting this issue.

  Fixes #67680
  Fixes #67681
  Fixes CVE-2024-24790

  Change-Id: I6bd03ca1a5d93a0b59027d861c84060967b265b0
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1460
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit f7f270c1621fdc7ee48e0487b2fac0356947d19b)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1500
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/590315
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: David Chase <drchase@google.com>
  ad4d9b046482a3a3fef19388a0d692ff4ebbe730:net/netip: check if address is v6 mapped in Is methods

  In all of the Is* methods, check if the address is a v6 mapped v4
  address, and unmap it if so.

  Thanks to Enze Wang of Alioth (@zer0yu) and Jianjun Chen of Zhongguancun
  Lab (@chenjj) for reporting this issue.

  Fixes #67680
  Fixes CVE-2024-24790

  Change-Id: I6bd03ca1a5d93a0b59027d861c84060967b265b0
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1460
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/590316
  Reviewed-by: David Chase <drchase@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: ad4d9b046482a3a3fef19388a0d692ff4ebbe730
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 12d5810cdb1f73cf23d7a86462143e9463317fca
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 051bdf3fd12a40307606ff9381138039c5f452f0
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/051bdf3fd12a40307606ff9381138039c5f452f0
    reference_type: commit
    reference_id: 051bdf3fd12a40307606ff9381138039c5f452f0
  - url: https://github.com/golang/go/tree/12d5810cdb1f73cf23d7a86462143e9463317fca
    reference_type: commit
    reference_id: 12d5810cdb1f73cf23d7a86462143e9463317fca
  - url: https://github.com/golang/go/tree/ad4d9b046482a3a3fef19388a0d692ff4ebbe730
    reference_type: commit
    reference_id: ad4d9b046482a3a3fef19388a0d692ff4ebbe730
