advisory_id: CVE-2023-39326
datasource_id: collect_go_fix_commits/CVE-2023-39326
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  ec8c526e4be720e94b98ca509e6364f0efaf28f7:[release-branch.go1.21] net/http: limit chunked data overhead

  The chunked transfer encoding adds some overhead to
  the content transferred. When writing one byte per
  chunk, for example, there are five bytes of overhead
  per byte of data transferred: "1\r\nX\r\n" to send "X".

  Chunks may include "chunk extensions",
  which we skip over and do not use.
  For example: "1;chunk extension here\r\nX\r\n".

  A malicious sender can use chunk extensions to add
  about 4k of overhead per byte of data.
  (The maximum chunk header line size we will accept.)

  Track the amount of overhead read in chunked data,
  and produce an error if it seems excessive.

  Updates #64433
  Fixes #64435
  Fixes CVE-2023-39326

  Change-Id: I40f8d70eb6f9575fb43f506eb19132ccedafcf39
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2076135
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit 3473ae72ee66c60744665a24b2fde143e8964d4f)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2095408
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/547356
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  6446af942e2e2b161c4ec1b60d9703a2b55dc4dd:[release-branch.go1.20] net/http: limit chunked data overhead

  The chunked transfer encoding adds some overhead to
  the content transferred. When writing one byte per
  chunk, for example, there are five bytes of overhead
  per byte of data transferred: "1\r\nX\r\n" to send "X".

  Chunks may include "chunk extensions",
  which we skip over and do not use.
  For example: "1;chunk extension here\r\nX\r\n".

  A malicious sender can use chunk extensions to add
  about 4k of overhead per byte of data.
  (The maximum chunk header line size we will accept.)

  Track the amount of overhead read in chunked data,
  and produce an error if it seems excessive.

  Updates #64433
  Fixes #64434
  Fixes CVE-2023-39326

  Change-Id: I40f8d70eb6f9575fb43f506eb19132ccedafcf39
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2076135
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit 3473ae72ee66c60744665a24b2fde143e8964d4f)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2095407
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/547355
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  285ef16b3872faccb877abaef5e481a630acdaf2:net/http: limit chunked data overhead

  The chunked transfer encoding adds some overhead to
  the content transferred. When writing one byte per
  chunk, for example, there are five bytes of overhead
  per byte of data transferred: "1\r\nX\r\n" to send "X".

  Chunks may include "chunk extensions",
  which we skip over and do not use.
  For example: "1;chunk extension here\r\nX\r\n".

  A malicious sender can use chunk extensions to add
  about 4k of overhead per byte of data.
  (The maximum chunk header line size we will accept.)

  Track the amount of overhead read in chunked data,
  and produce an error if it seems excessive.

  Fixes #64433
  Fixes CVE-2023-39326

  Change-Id: I40f8d70eb6f9575fb43f506eb19132ccedafcf39
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2076135
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/547335
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 285ef16b3872faccb877abaef5e481a630acdaf2
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: ec8c526e4be720e94b98ca509e6364f0efaf28f7
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 6446af942e2e2b161c4ec1b60d9703a2b55dc4dd
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/285ef16b3872faccb877abaef5e481a630acdaf2
    reference_type: commit
    reference_id: 285ef16b3872faccb877abaef5e481a630acdaf2
  - url: https://github.com/golang/go/tree/6446af942e2e2b161c4ec1b60d9703a2b55dc4dd
    reference_type: commit
    reference_id: 6446af942e2e2b161c4ec1b60d9703a2b55dc4dd
  - url: https://github.com/golang/go/tree/ec8c526e4be720e94b98ca509e6364f0efaf28f7
    reference_type: commit
    reference_id: ec8c526e4be720e94b98ca509e6364f0efaf28f7
