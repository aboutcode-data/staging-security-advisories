advisory_id: CVE-2022-1705
datasource_id: collect_go_fix_commits/CVE-2022-1705
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  222ee24a0046ae61679f4d97967e3b4058a3b90e:[release-branch.go1.18] net/http: don't strip whitespace from Transfer-Encoding headers

  Do not accept "Transfer-Encoding: \rchunked" as a valid TE header
  setting chunked encoding.

  Thanks to Zeyu Zhang (https://www.zeyu2001.com/) for identifying
  the issue.

  For #53188
  For CVE-2022-1705
  Fixes #53433

  Change-Id: I1a16631425159267f2eca68056b057192a7edf6c
  Reviewed-on: https://go-review.googlesource.com/c/go/+/409874
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
  (cherry picked from commit e5017a93fcde94f09836200bca55324af037ee5f)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/415218
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  Run-TryBot: Dmitri Shuralyov <dmitshur@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  d13431c37ab62f9755f705731536ff74e7165b08:[release-branch.go1.17] net/http: don't strip whitespace from Transfer-Encoding headers

  Do not accept "Transfer-Encoding: \rchunked" as a valid TE header
  setting chunked encoding.

  Thanks to Zeyu Zhang (https://www.zeyu2001.com/) for identifying
  the issue.

  For #53188
  For CVE-2022-1705
  Fixes #53432

  Change-Id: I1a16631425159267f2eca68056b057192a7edf6c
  Reviewed-on: https://go-review.googlesource.com/c/go/+/409874
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
  (cherry picked from commit e5017a93fcde94f09836200bca55324af037ee5f)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/415217
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  Run-TryBot: Dmitri Shuralyov <dmitshur@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  e5017a93fcde94f09836200bca55324af037ee5f:net/http: don't strip whitespace from Transfer-Encoding headers

  Do not accept "Transfer-Encoding: \rchunked" as a valid TE header
  setting chunked encoding.

  Thanks to Zeyu Zhang (https://www.zeyu2001.com/) for identifying
  the issue.

  Fixes #53188
  Fixes CVE-2022-1705

  Change-Id: I1a16631425159267f2eca68056b057192a7edf6c
  Reviewed-on: https://go-review.googlesource.com/c/go/+/409874
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 222ee24a0046ae61679f4d97967e3b4058a3b90e
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: d13431c37ab62f9755f705731536ff74e7165b08
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: e5017a93fcde94f09836200bca55324af037ee5f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/222ee24a0046ae61679f4d97967e3b4058a3b90e
    reference_type: commit
    reference_id: 222ee24a0046ae61679f4d97967e3b4058a3b90e
  - url: https://github.com/golang/go/tree/d13431c37ab62f9755f705731536ff74e7165b08
    reference_type: commit
    reference_id: d13431c37ab62f9755f705731536ff74e7165b08
  - url: https://github.com/golang/go/tree/e5017a93fcde94f09836200bca55324af037ee5f
    reference_type: commit
    reference_id: e5017a93fcde94f09836200bca55324af037ee5f
