advisory_id: CVE-2022-41716
datasource_id: collect_go_fix_commits/CVE-2022-41716
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  61ae0a37a8c96e2b1745594e477244100f1a7046:syscall, os/exec: reject environment variables containing NULs

  Check for and reject environment variables containing NULs.

  The conventions for passing environment variables to subprocesses
  cause most or all systems to interpret a NUL as a separator. The
  syscall package rejects environment variables containing a NUL
  on most systems, but erroniously did not do so on Windows. This
  causes an environment variable such as "FOO=a\x00BAR=b" to be
  interpreted as "FOO=a", "BAR=b".

  Check for and reject NULs in environment variables passed to
  syscall.StartProcess on Windows.

  Add a redundant check to os/exec as extra insurance.

  Fixes #56284
  Fixes CVE-2022-41716

  Change-Id: I2950e2b0cb14ebd26e5629be1521858f66a7d4ae
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1609434
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/446916
  Reviewed-by: Tatiana Bradley <tatiana@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Matthew Dempsky <mdempsky@google.com>
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  aba57b07721cac39b4b7cf70f8dfbf9e2e299187:[release-branch.go1.18] syscall, os/exec: reject environment variables containing NULs

  Check for and reject environment variables containing NULs.

  The conventions for passing environment variables to subprocesses
  cause most or all systems to interpret a NUL as a separator. The
  syscall package rejects environment variables containing a NUL
  on most systems, but erroneously did not do so on Windows. This
  causes an environment variable such as "FOO=a\x00BAR=b" to be
  interpreted as "FOO=a", "BAR=b".

  Check for and reject NULs in environment variables passed to
  syscall.StartProcess on Windows.

  Add a redundant check to os/exec as extra insurance.

  Updates #56284
  Fixes #56327
  Fixes CVE-2022-41716

  Change-Id: I2950e2b0cb14ebd26e5629be1521858f66a7d4ae
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1609434
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  (cherry picked from commit 845accdebb2772c5344ed0c96df9910f3b02d741)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1617552
  Run-TryBot: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/446915
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  Run-TryBot: Matthew Dempsky <mdempsky@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Reviewed-by: Tatiana Bradley <tatiana@golang.org>
  2a7adf4ccde9734becf41acf8274d1a190f2ec64:[release-branch.go1.19] syscall, os/exec: reject environment variables containing NULs

  Check for and reject environment variables containing NULs.

  The conventions for passing environment variables to subprocesses
  cause most or all systems to interpret a NUL as a separator. The
  syscall package rejects environment variables containing a NUL
  on most systems, but erroneously did not do so on Windows. This
  causes an environment variable such as "FOO=a\x00BAR=b" to be
  interpreted as "FOO=a", "BAR=b".

  Check for and reject NULs in environment variables passed to
  syscall.StartProcess on Windows.

  Add a redundant check to os/exec as extra insurance.

  Updates #56284
  Fixes #56328
  Fixes CVE-2022-41716

  Change-Id: I2950e2b0cb14ebd26e5629be1521858f66a7d4ae
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1609434
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  (cherry picked from commit 845accdebb2772c5344ed0c96df9910f3b02d741)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1617553
  Run-TryBot: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/446879
  Reviewed-by: Tatiana Bradley <tatiana@golang.org>
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  Run-TryBot: Matthew Dempsky <mdempsky@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2a7adf4ccde9734becf41acf8274d1a190f2ec64
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 61ae0a37a8c96e2b1745594e477244100f1a7046
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: aba57b07721cac39b4b7cf70f8dfbf9e2e299187
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/2a7adf4ccde9734becf41acf8274d1a190f2ec64
    reference_type: commit
    reference_id: 2a7adf4ccde9734becf41acf8274d1a190f2ec64
  - url: https://github.com/golang/go/tree/61ae0a37a8c96e2b1745594e477244100f1a7046
    reference_type: commit
    reference_id: 61ae0a37a8c96e2b1745594e477244100f1a7046
  - url: https://github.com/golang/go/tree/aba57b07721cac39b4b7cf70f8dfbf9e2e299187
    reference_type: commit
    reference_id: aba57b07721cac39b4b7cf70f8dfbf9e2e299187
