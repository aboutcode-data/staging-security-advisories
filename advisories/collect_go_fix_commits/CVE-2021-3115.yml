advisory_id: CVE-2021-3115
datasource_id: collect_go_fix_commits/CVE-2021-3115
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  953d1feca9b21af075ad5fc8a3dad096d3ccc3a0:all: introduce and use internal/execabs

  Introduces a wrapper around os/exec, internal/execabs, for use in
  all commands. This wrapper prevents exec.LookPath and exec.Command from
  running executables in the current directory.

  All imports of os/exec in non-test files in cmd/ are replaced with
  imports of internal/execabs.

  This issue was reported by RyotaK.

  Fixes CVE-2021-3115
  Fixes #43783

  Change-Id: I0423451a6e27ec1e1d6f3fe929ab1ef69145c08f
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/955304
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Katie Hockman <katiehockman@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/284783
  Run-TryBot: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Katie Hockman <katie@golang.org>
  Trust: Roland Shoemaker <roland@golang.org>
  46e2e2e9d99925bbf724b12693c6d3e27a95d6a0:cmd/go: pass resolved CC, GCCGO to cgo

  This makes sure the go command and cgo agree about
  exactly which compiler is being used.

  This issue was reported by RyotaK.

  Fixes CVE-2021-3115
  Fixes #43783

  Change-Id: If171c5c8b2523efb5ea2d957e5ad1380a038149c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/949416
  Reviewed-by: Ian Lance Taylor <iant@google.com>
  Reviewed-by: Jay Conrod <jayconrod@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/284780
  Run-TryBot: Roland Shoemaker <roland@golang.org>
  TryBot-Result: Go Bot <gobot@golang.org>
  Reviewed-by: Ian Lance Taylor <iant@golang.org>
  Trust: Roland Shoemaker <roland@golang.org>
  94200a92cf4d6dfdab5291f9e29785cad566faa0:[release-branch.go1.14-security] all: introduce and use internal/execabs

  Introduces a wrapper around os/exec, internal/execabs, for use in
  all commands. This wrapper prevents exec.LookPath and exec.Command from
  running executables in the current directory.

  All imports of os/exec in non-test files in cmd/ are replaced with
  imports of internal/execabs.

  This issue was reported by RyotaK.

  Fixes CVE-2021-3115

  Change-Id: I0423451a6e27ec1e1d6f3fe929ab1ef69145c08f
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/955304
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Katie Hockman <katiehockman@google.com>
  (cherry picked from commit 44f09a6990ccf4db601cbf8208c89ac4e888f884)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/955309
  e749a96e717718e3ac881a75f805776370302a86:[release-branch.go1.14-security] cmd/go: pass resolved CC, GCCGO to cgo

  This makes sure the go command and cgo agree about
  exactly which compiler is being used.

  This issue was reported by RyotaK.

  Fixes CVE-2021-3115.

  Change-Id: If171c5c8b2523efb5ea2d957e5ad1380a038149c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/949416
  Reviewed-by: Ian Lance Taylor <iant@google.com>
  Reviewed-by: Jay Conrod <jayconrod@google.com>
  (cherry picked from commit 4cf399ca38587a6e4a3e85b494cd9a9b4cc53378)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/955294
  Reviewed-by: Katie Hockman <katiehockman@google.com>
  07e3195293ec510171d7d43ec8ac2bcb9cf00df4:[release-branch.go1.15-security] all: introduce and use internal/execabs

  Introduces a wrapper around os/exec, internal/execabs, for use in
  all commands. This wrapper prevents exec.LookPath and exec.Command from
  running executables in the current directory.

  All imports of os/exec in non-test files in cmd/ are replaced with
  imports of internal/execabs.

  This issue was reported by RyotaK.

  Fixes CVE-2021-3115

  Change-Id: I0423451a6e27ec1e1d6f3fe929ab1ef69145c08f
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/955304
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Katie Hockman <katiehockman@google.com>
  (cherry picked from commit 44f09a6990ccf4db601cbf8208c89ac4e888f884)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/955308
  e8e7facfaa47bf21007c0a1c679debba52ec3ea0:[release-branch.go1.15-security] cmd/go: pass resolved CC, GCCGO to cgo

  This makes sure the go command and cgo agree about
  exactly which compiler is being used.

  This issue was reported by RyotaK.

  Fixes CVE-2021-3115.

  Change-Id: If171c5c8b2523efb5ea2d957e5ad1380a038149c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/949416
  Reviewed-by: Ian Lance Taylor <iant@google.com>
  Reviewed-by: Jay Conrod <jayconrod@google.com>
  (cherry picked from commit 4cf399ca38587a6e4a3e85b494cd9a9b4cc53378)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/955293
  Reviewed-by: Katie Hockman <katiehockman@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 07e3195293ec510171d7d43ec8ac2bcb9cf00df4
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: e8e7facfaa47bf21007c0a1c679debba52ec3ea0
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 953d1feca9b21af075ad5fc8a3dad096d3ccc3a0
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 94200a92cf4d6dfdab5291f9e29785cad566faa0
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 46e2e2e9d99925bbf724b12693c6d3e27a95d6a0
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: e749a96e717718e3ac881a75f805776370302a86
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/07e3195293ec510171d7d43ec8ac2bcb9cf00df4
    reference_type: commit
    reference_id: 07e3195293ec510171d7d43ec8ac2bcb9cf00df4
  - url: https://github.com/golang/go/tree/46e2e2e9d99925bbf724b12693c6d3e27a95d6a0
    reference_type: commit
    reference_id: 46e2e2e9d99925bbf724b12693c6d3e27a95d6a0
  - url: https://github.com/golang/go/tree/94200a92cf4d6dfdab5291f9e29785cad566faa0
    reference_type: commit
    reference_id: 94200a92cf4d6dfdab5291f9e29785cad566faa0
  - url: https://github.com/golang/go/tree/953d1feca9b21af075ad5fc8a3dad096d3ccc3a0
    reference_type: commit
    reference_id: 953d1feca9b21af075ad5fc8a3dad096d3ccc3a0
  - url: https://github.com/golang/go/tree/e749a96e717718e3ac881a75f805776370302a86
    reference_type: commit
    reference_id: e749a96e717718e3ac881a75f805776370302a86
  - url: https://github.com/golang/go/tree/e8e7facfaa47bf21007c0a1c679debba52ec3ea0
    reference_type: commit
    reference_id: e8e7facfaa47bf21007c0a1c679debba52ec3ea0
