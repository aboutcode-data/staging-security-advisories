advisory_id: CVE-2023-45283
datasource_id: collect_go_fix_commits/CVE-2023-45283
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  46fb78168596f7ce8834f528bb0eb9555c08bcae:[release-branch.go1.20] path/filepath: fix various issues in parsing Windows paths

  On Windows, A root local device path is a path which begins with
  \\?\ or \??\.  A root local device path accesses the DosDevices
  object directory, and permits access to any file or device on the
  system. For example \??\C:\foo is equivalent to common C:\foo.

  The Clean, IsAbs, IsLocal, and VolumeName functions did not
  recognize root local device paths beginning with \??\.

  Clean could convert a rooted path such as \a\..\??\b into
  the root local device path \??\b. It will now convert this
  path into .\??\b.

  IsAbs now correctly reports paths beginning with \??\
  as absolute.

  IsLocal now correctly reports paths beginning with \??\
  as non-local.

  VolumeName now reports the \??\ prefix as a volume name.

  Join(`\`, `??`, `b`) could convert a seemingly innocent
  sequence of path elements into the root local device path
  \??\b. It will now convert this to \.\??\b.

  In addition, the IsLocal function did not correctly
  detect reserved names in some cases:

    - reserved names followed by spaces, such as "COM1 ".
    - "COM" or "LPT" followed by a superscript 1, 2, or 3.

  IsLocal now correctly reports these names as non-local.

  For #63713
  Fixes #63714
  Fixes CVE-2023-45283
  Fixes CVE-2023-45284

  Change-Id: I446674a58977adfa54de7267d716ac23ab496c54
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2040691
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2072597
  Reviewed-by: Cherry Mui <cherryyz@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/539276
  Auto-Submit: Heschi Kreinick <heschi@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  9e933c189ca3a84f12995b3c799364a06abc4376:[release-branch.go1.21] path/filepath: fix various issues in parsing Windows paths

  On Windows, A root local device path is a path which begins with
  \\?\ or \??\.  A root local device path accesses the DosDevices
  object directory, and permits access to any file or device on the
  system. For example \??\C:\foo is equivalent to common C:\foo.

  The Clean, IsAbs, IsLocal, and VolumeName functions did not
  recognize root local device paths beginning with \??\.

  Clean could convert a rooted path such as \a\..\??\b into
  the root local device path \??\b. It will now convert this
  path into .\??\b.

  IsAbs now correctly reports paths beginning with \??\
  as absolute.

  IsLocal now correctly reports paths beginning with \??\
  as non-local.

  VolumeName now reports the \??\ prefix as a volume name.

  Join(`\`, `??`, `b`) could convert a seemingly innocent
  sequence of path elements into the root local device path
  \??\b. It will now convert this to \.\??\b.

  In addition, the IsLocal function did not correctly
  detect reserved names in some cases:

    - reserved names followed by spaces, such as "COM1 ".
    - "COM" or "LPT" followed by a superscript 1, 2, or 3.

  IsLocal now correctly reports these names as non-local.

  For #63713
  Fixes #63715
  Fixes CVE-2023-45283
  Fixes CVE-2023-45284

  Change-Id: I446674a58977adfa54de7267d716ac23ab496c54
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2040691
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2072596
  Reviewed-by: Cherry Mui <cherryyz@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/540276
  Auto-Submit: Heschi Kreinick <heschi@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  cae35cd2582878341452547378ffdc14fdb0a022:path/filepath: fix various issues in parsing Windows paths

  On Windows, A root local device path is a path which begins with
  \\?\ or \??\.  A root local device path accesses the DosDevices
  object directory, and permits access to any file or device on the
  system. For example \??\C:\foo is equivalent to common C:\foo.

  The Clean, IsAbs, IsLocal, and VolumeName functions did not
  recognize root local device paths beginning with \??\.

  Clean could convert a rooted path such as \a\..\??\b into
  the root local device path \??\b. It will now convert this
  path into .\??\b.

  IsAbs now correctly reports paths beginning with \??\
  as absolute.

  IsLocal now correctly reports paths beginning with \??\
  as non-local.

  VolumeName now reports the \??\ prefix as a volume name.

  Join(`\`, `??`, `b`) could convert a seemingly innocent
  sequence of path elements into the root local device path
  \??\b. It will now convert this to \.\??\b.

  In addition, the IsLocal function did not correctly
  detect reserved names in some cases:

    - reserved names followed by spaces, such as "COM1 ".
    - "COM" or "LPT" followed by a superscript 1, 2, or 3.

  IsLocal now correctly reports these names as non-local.

  Fixes #63713
  Fixes CVE-2023-45283
  Fixes CVE-2023-45284

  Change-Id: I446674a58977adfa54de7267d716ac23ab496c54
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2040691
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/540277
  Reviewed-by: Cherry Mui <cherryyz@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Heschi Kreinick <heschi@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: cae35cd2582878341452547378ffdc14fdb0a022
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 9e933c189ca3a84f12995b3c799364a06abc4376
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 46fb78168596f7ce8834f528bb0eb9555c08bcae
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/46fb78168596f7ce8834f528bb0eb9555c08bcae
    reference_type: commit
    reference_id: 46fb78168596f7ce8834f528bb0eb9555c08bcae
  - url: https://github.com/golang/go/tree/9e933c189ca3a84f12995b3c799364a06abc4376
    reference_type: commit
    reference_id: 9e933c189ca3a84f12995b3c799364a06abc4376
  - url: https://github.com/golang/go/tree/cae35cd2582878341452547378ffdc14fdb0a022
    reference_type: commit
    reference_id: cae35cd2582878341452547378ffdc14fdb0a022
