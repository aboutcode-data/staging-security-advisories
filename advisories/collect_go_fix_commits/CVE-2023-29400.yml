advisory_id: CVE-2023-29400
datasource_id: collect_go_fix_commits/CVE-2023-29400
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  0d347544cbca0f42b160424f6bc2458ebcc7b3fc:html/template: emit filterFailsafe for empty unquoted attr value

  An unquoted action used as an attribute value can result in unsafe
  behavior if it is empty, as HTML normalization will result in unexpected
  attributes, and may allow attribute injection. If executing a template
  results in a empty unquoted attribute value, emit filterFailsafe
  instead.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes #59722
  Fixes CVE-2023-29400

  Change-Id: Ia38d1b536ae2b4af5323a6c6d861e3c057c2570a
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1826631
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/491617
  Run-TryBot: Carlos Amedee <carlos@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  337dd75343145b74ed2073d793322eb4103b56ad:[release-branch.go1.20] html/template: emit filterFailsafe for empty unquoted attr value

  An unquoted action used as an attribute value can result in unsafe
  behavior if it is empty, as HTML normalization will result in unexpected
  attributes, and may allow attribute injection. If executing a template
  results in a empty unquoted attribute value, emit filterFailsafe
  instead.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  For #59722
  Fixes #59816
  Fixes CVE-2023-29400

  Change-Id: Ia38d1b536ae2b4af5323a6c6d861e3c057c2570a
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1826631
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1851494
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/491358
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Run-TryBot: Carlos Amedee <carlos@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  9db0e74f606b8afb28cc71d4b1c8b4ed24cabbf5:[release-branch.go1.19] html/template: emit filterFailsafe for empty unquoted attr value

  An unquoted action used as an attribute value can result in unsafe
  behavior if it is empty, as HTML normalization will result in unexpected
  attributes, and may allow attribute injection. If executing a template
  results in a empty unquoted attribute value, emit filterFailsafe
  instead.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  For #59722
  Fixes #59815
  Fixes CVE-2023-29400

  Change-Id: Ia38d1b536ae2b4af5323a6c6d861e3c057c2570a
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1826631
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1851498
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/491357
  Run-TryBot: Carlos Amedee <carlos@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 0d347544cbca0f42b160424f6bc2458ebcc7b3fc
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 9db0e74f606b8afb28cc71d4b1c8b4ed24cabbf5
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 337dd75343145b74ed2073d793322eb4103b56ad
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/0d347544cbca0f42b160424f6bc2458ebcc7b3fc
    reference_type: commit
    reference_id: 0d347544cbca0f42b160424f6bc2458ebcc7b3fc
  - url: https://github.com/golang/go/tree/337dd75343145b74ed2073d793322eb4103b56ad
    reference_type: commit
    reference_id: 337dd75343145b74ed2073d793322eb4103b56ad
  - url: https://github.com/golang/go/tree/9db0e74f606b8afb28cc71d4b1c8b4ed24cabbf5
    reference_type: commit
    reference_id: 9db0e74f606b8afb28cc71d4b1c8b4ed24cabbf5
