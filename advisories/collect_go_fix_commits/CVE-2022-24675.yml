advisory_id: CVE-2022-24675
datasource_id: collect_go_fix_commits/CVE-2022-24675
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  45c3387d777caf28f4b992ad9a6216e3085bb8fe:encoding/pem: fix stack overflow in Decode

  Previously, Decode called decodeError, a recursive function that was
  prone to stack overflows when given a large PEM file containing errors.

  Credit to Juho Nurminen of Mattermost who reported the error.

  Fixes CVE-2022-24675
  Fixes #51853

  Change-Id: Iffe768be53c8ddc0036fea0671d290f8f797692c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1391157
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  (cherry picked from commit 794ea5e828010e8b68493b2fc6d2963263195a02)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/399820
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Run-TryBot: Dmitri Shuralyov <dmitshur@google.com>
  Auto-Submit: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Cherry Mui <cherryyz@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  84264fcecaf7a3cdfb7ef9e423814e72c2885c1d:[release-branch.go1.18] encoding/pem: fix stack overflow in Decode

  Previously, Decode called decodeError, a recursive function that was
  prone to stack overflows when given a large PEM file containing errors.

  Credit to Juho Nurminen of Mattermost who reported the error.

  Fixes CVE-2022-24675
  Updates #51853
  Fixes #52037

  Change-Id: Iffe768be53c8ddc0036fea0671d290f8f797692c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1391157
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  (cherry picked from commit 794ea5e828010e8b68493b2fc6d2963263195a02)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/399817
  Run-TryBot: Dmitri Shuralyov <dmitshur@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Cherry Mui <cherryyz@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  2116d60993e90d3f9b963c979f4bf1d116af03ff:[release-branch.go1.17] encoding/pem: fix stack overflow in Decode

  Previously, Decode called decodeError, a recursive function that was
  prone to stack overflows when given a large PEM file containing errors.

  Credit to Juho Nurminen of Mattermost who reported the error.

  Fixes CVE-2022-24675
  Updates #51853
  Fixes #52036

  Change-Id: Iffe768be53c8ddc0036fea0671d290f8f797692c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1391157
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  (cherry picked from commit 794ea5e828010e8b68493b2fc6d2963263195a02)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/399816
  Run-TryBot: Dmitri Shuralyov <dmitshur@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Cherry Mui <cherryyz@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 84264fcecaf7a3cdfb7ef9e423814e72c2885c1d
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2116d60993e90d3f9b963c979f4bf1d116af03ff
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 45c3387d777caf28f4b992ad9a6216e3085bb8fe
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/2116d60993e90d3f9b963c979f4bf1d116af03ff
    reference_type: commit
    reference_id: 2116d60993e90d3f9b963c979f4bf1d116af03ff
  - url: https://github.com/golang/go/tree/45c3387d777caf28f4b992ad9a6216e3085bb8fe
    reference_type: commit
    reference_id: 45c3387d777caf28f4b992ad9a6216e3085bb8fe
  - url: https://github.com/golang/go/tree/84264fcecaf7a3cdfb7ef9e423814e72c2885c1d
    reference_type: commit
    reference_id: 84264fcecaf7a3cdfb7ef9e423814e72c2885c1d
