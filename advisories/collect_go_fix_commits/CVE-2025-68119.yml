advisory_id: CVE-2025-68119
datasource_id: collect_go_fix_commits/CVE-2025-68119
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  73fe85f0ea1bf2cec8e9a89bf5645de06ecaa0a6:[release-branch.go1.24] cmd/go: update VCS commands to use safer flag/argument syntax

  In various situations, the toolchain invokes VCS commands. Some of these
  commands take arbitrary input, either provided by users or fetched from
  external sources. To prevent potential command injection vulnerabilities
  or misinterpretation of arguments as flags, this change updates the VCS
  commands to use various techniques to separate flags from positional
  arguments, and to directly associate flags with their values.

  Additionally, we update the environment variable for Mercurial to use
  `HGPLAIN=+strictflags`, which is the more explicit way to disable user
  configurations (intended or otherwise) that might interfere with command
  execution.

  We also now disallow version strings from being prefixed with '-' or
  '/', as doing so opens us up to making the same mistake again in the
  future. As far as we know there are currently ~0 public modules affected
  by this.

  While I was working on cmd/go/internal/vcs, I also noticed that a
  significant portion of the commands being implemented were dead code.
  In order to reduce the maintenance burden and surface area for potential
  issues, I removed the dead code for unused commands.

  We should probably follow up with a more structured change to make it
  harder to accidentally re-introduce these issues in the future, but for
  now this addresses the issue at hand.

  Thanks to splitline (@splitline) from DEVCORE Research Team for
  reporting this issue.

  Fixes CVE-2025-68119
  Updates #77099
  Fixes #77103

  Change-Id: I9d9f4ee05b95be49fe14edf71a1b8e6c0784378e
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3260
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736710
  Auto-Submit: Michael Pratt <mpratt@google.com>
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  (cherry picked from commit 94a1296a457387d1fd6eca1a9bcd44e89bdd9d55)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/739421
  Auto-Submit: Dmitri Shuralyov <dmitshur@google.com>
  94a1296a457387d1fd6eca1a9bcd44e89bdd9d55:cmd/go: update VCS commands to use safer flag/argument syntax

  In various situations, the toolchain invokes VCS commands. Some of these
  commands take arbitrary input, either provided by users or fetched from
  external sources. To prevent potential command injection vulnerabilities
  or misinterpretation of arguments as flags, this change updates the VCS
  commands to use various techniques to separate flags from positional
  arguments, and to directly associate flags with their values.

  Additionally, we update the environment variable for Mercurial to use
  `HGPLAIN=+strictflags`, which is the more explicit way to disable user
  configurations (intended or otherwise) that might interfere with command
  execution.

  We also now disallow version strings from being prefixed with '-' or
  '/', as doing so opens us up to making the same mistake again in the
  future. As far as we know there are currently ~0 public modules affected
  by this.

  While I was working on cmd/go/internal/vcs, I also noticed that a
  significant portion of the commands being implemented were dead code.
  In order to reduce the maintenance burden and surface area for potential
  issues, I removed the dead code for unused commands.

  We should probably follow up with a more structured change to make it
  harder to accidentally re-introduce these issues in the future, but for
  now this addresses the issue at hand.

  Thanks to splitline (@splitline) from DEVCORE Research Team for
  reporting this issue.

  Fixes CVE-2025-68119
  Fixes #77099

  Change-Id: I9d9f4ee05b95be49fe14edf71a1b8e6c0784378e
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3260
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736710
  Auto-Submit: Michael Pratt <mpratt@google.com>
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  082365aa552a7e2186f79110d5311dce70749cc0:[release-branch.go1.25] cmd/go: update VCS commands to use safer flag/argument syntax

  In various situations, the toolchain invokes VCS commands. Some of these
  commands take arbitrary input, either provided by users or fetched from
  external sources. To prevent potential command injection vulnerabilities
  or misinterpretation of arguments as flags, this change updates the VCS
  commands to use various techniques to separate flags from positional
  arguments, and to directly associate flags with their values.

  Additionally, we update the environment variable for Mercurial to use
  `HGPLAIN=+strictflags`, which is the more explicit way to disable user
  configurations (intended or otherwise) that might interfere with command
  execution.

  We also now disallow version strings from being prefixed with '-' or
  '/', as doing so opens us up to making the same mistake again in the
  future. As far as we know there are currently ~0 public modules affected
  by this.

  While I was working on cmd/go/internal/vcs, I also noticed that a
  significant portion of the commands being implemented were dead code.
  In order to reduce the maintenance burden and surface area for potential
  issues, I removed the dead code for unused commands.

  We should probably follow up with a more structured change to make it
  harder to accidentally re-introduce these issues in the future, but for
  now this addresses the issue at hand.

  Thanks to splitline (@splitline) from DEVCORE Research Team for
  reporting this issue.

  Fixes CVE-2025-68119
  Fixes #77099

  Change-Id: I9d9f4ee05b95be49fe14edf71a1b8e6c0784378e
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3260
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3342
  Reviewed-by: Michael Matloob <matloob@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736721
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  29f3f72dbd67c25033df944c8ced91e0efd46851:[release-branch.go1.26] cmd/go: update VCS commands to use safer flag/argument syntax

  In various situations, the toolchain invokes VCS commands. Some of these
  commands take arbitrary input, either provided by users or fetched from
  external sources. To prevent potential command injection vulnerabilities
  or misinterpretation of arguments as flags, this change updates the VCS
  commands to use various techniques to separate flags from positional
  arguments, and to directly associate flags with their values.

  Additionally, we update the environment variable for Mercurial to use
  `HGPLAIN=+strictflags`, which is the more explicit way to disable user
  configurations (intended or otherwise) that might interfere with command
  execution.

  We also now disallow version strings from being prefixed with '-' or
  '/', as doing so opens us up to making the same mistake again in the
  future. As far as we know there are currently ~0 public modules affected
  by this.

  While I was working on cmd/go/internal/vcs, I also noticed that a
  significant portion of the commands being implemented were dead code.
  In order to reduce the maintenance burden and surface area for potential
  issues, I removed the dead code for unused commands.

  We should probably follow up with a more structured change to make it
  harder to accidentally re-introduce these issues in the future, but for
  now this addresses the issue at hand.

  Thanks to splitline (@splitline) from DEVCORE Research Team for
  reporting this issue.

  Fixes CVE-2025-68119
  Fixes #77099

  Change-Id: I9d9f4ee05b95be49fe14edf71a1b8e6c0784378e
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3260
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3341
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736705
  Auto-Submit: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 082365aa552a7e2186f79110d5311dce70749cc0
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 94a1296a457387d1fd6eca1a9bcd44e89bdd9d55
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 29f3f72dbd67c25033df944c8ced91e0efd46851
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 73fe85f0ea1bf2cec8e9a89bf5645de06ecaa0a6
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/082365aa552a7e2186f79110d5311dce70749cc0
    reference_type: commit
    reference_id: 082365aa552a7e2186f79110d5311dce70749cc0
  - url: https://github.com/golang/go/tree/29f3f72dbd67c25033df944c8ced91e0efd46851
    reference_type: commit
    reference_id: 29f3f72dbd67c25033df944c8ced91e0efd46851
  - url: https://github.com/golang/go/tree/73fe85f0ea1bf2cec8e9a89bf5645de06ecaa0a6
    reference_type: commit
    reference_id: 73fe85f0ea1bf2cec8e9a89bf5645de06ecaa0a6
  - url: https://github.com/golang/go/tree/94a1296a457387d1fd6eca1a9bcd44e89bdd9d55
    reference_type: commit
    reference_id: 94a1296a457387d1fd6eca1a9bcd44e89bdd9d55
