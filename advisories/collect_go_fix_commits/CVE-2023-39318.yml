advisory_id: CVE-2023-39318
datasource_id: collect_go_fix_commits/CVE-2023-39318
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  67fb00396d1f0acf4b726990d5cd729ecace403c:html/template: support HTML-like comments in script contexts

  Per Appendix B.1.1 of the ECMAScript specification, support HTML-like
  comments in script contexts. Also per section 12.5, support hashbang
  comments. This brings our parsing in-line with how browsers treat these
  comment types.

  Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for
  reporting this issue.

  Fixes #62196
  Fixes CVE-2023-39318

  Change-Id: Id512702c5de3ae46cf648e268cb10e1eb392a181
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1976593
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/526156
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  023b542edf38e2a1f87fcefb9f75ff2f99401b4c:[release-branch.go1.20] html/template: support HTML-like comments in script contexts

  Per Appendix B.1.1 of the ECMAScript specification, support HTML-like
  comments in script contexts. Also per section 12.5, support hashbang
  comments. This brings our parsing in-line with how browsers treat these
  comment types.

  Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for
  reporting this issue.

  Fixes #62196
  Fixes #62395
  Fixes CVE-2023-39318

  Change-Id: Id512702c5de3ae46cf648e268cb10e1eb392a181
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1976593
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2014620
  Reviewed-on: https://go-review.googlesource.com/c/go/+/526098
  Run-TryBot: Cherry Mui <cherryyz@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  b0e1d3ea26e8e8fce7726690c9ef0597e60739fb:[release-branch.go1.21] html/template: support HTML-like comments in script contexts

  Per Appendix B.1.1 of the ECMAScript specification, support HTML-like
  comments in script contexts. Also per section 12.5, support hashbang
  comments. This brings our parsing in-line with how browsers treat these
  comment types.

  Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for
  reporting this issue.

  Fixes #62196
  Fixes #62396
  Fixes CVE-2023-39318

  Change-Id: Id512702c5de3ae46cf648e268cb10e1eb392a181
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1976593
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2014618
  Reviewed-on: https://go-review.googlesource.com/c/go/+/526096
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Cherry Mui <cherryyz@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: b0e1d3ea26e8e8fce7726690c9ef0597e60739fb
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 67fb00396d1f0acf4b726990d5cd729ecace403c
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 023b542edf38e2a1f87fcefb9f75ff2f99401b4c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/023b542edf38e2a1f87fcefb9f75ff2f99401b4c
    reference_type: commit
    reference_id: 023b542edf38e2a1f87fcefb9f75ff2f99401b4c
  - url: https://github.com/golang/go/tree/67fb00396d1f0acf4b726990d5cd729ecace403c
    reference_type: commit
    reference_id: 67fb00396d1f0acf4b726990d5cd729ecace403c
  - url: https://github.com/golang/go/tree/b0e1d3ea26e8e8fce7726690c9ef0597e60739fb
    reference_type: commit
    reference_id: b0e1d3ea26e8e8fce7726690c9ef0597e60739fb
