advisory_id: CVE-2023-45290
datasource_id: collect_go_fix_commits/CVE-2023-45290
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  16e5d24480dca7ddcbdffb78a8ed5de3e5155dec:net/textproto, mime/multipart: avoid unbounded read in MIME header

  mime/multipart.Reader.ReadForm allows specifying the maximum amount
  of memory that will be consumed by the form. While this limit is
  correctly applied to the parsed form data structure, it was not
  being applied to individual header lines in a form.

  For example, when presented with a form containing a header line
  that never ends, ReadForm will continue to read the line until it
  runs out of memory.

  Limit the amount of data consumed when reading a header.

  Fixes CVE-2023-45290
  Fixes #65383

  Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2134435
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/569341
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Reviewed-by: Damien Neil <dneil@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  bf80213b121074f4ad9b449410a4d13bae5e9be0:[release-branch.go1.21] net/textproto, mime/multipart: avoid unbounded read in MIME header

  mime/multipart.Reader.ReadForm allows specifying the maximum amount
  of memory that will be consumed by the form. While this limit is
  correctly applied to the parsed form data structure, it was not
  being applied to individual header lines in a form.

  For example, when presented with a form containing a header line
  that never ends, ReadForm will continue to read the line until it
  runs out of memory.

  Limit the amount of data consumed when reading a header.

  Fixes CVE-2023-45290
  Fixes #65389
  For #65383

  Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2134435
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2173776
  Reviewed-by: Carlos Amedee <amedee@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/569240
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  041a47712e765e94f86d841c3110c840e76d8f82:[release-branch.go1.22] net/textproto, mime/multipart: avoid unbounded read in MIME header

  mime/multipart.Reader.ReadForm allows specifying the maximum amount
  of memory that will be consumed by the form. While this limit is
  correctly applied to the parsed form data structure, it was not
  being applied to individual header lines in a form.

  For example, when presented with a form containing a header line
  that never ends, ReadForm will continue to read the line until it
  runs out of memory.

  Limit the amount of data consumed when reading a header.

  Fixes CVE-2023-45290
  Fixes #65850
  For #65383

  Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2134435
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174345
  Reviewed-by: Carlos Amedee <amedee@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/569237
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: bf80213b121074f4ad9b449410a4d13bae5e9be0
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 16e5d24480dca7ddcbdffb78a8ed5de3e5155dec
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 041a47712e765e94f86d841c3110c840e76d8f82
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/041a47712e765e94f86d841c3110c840e76d8f82
    reference_type: commit
    reference_id: 041a47712e765e94f86d841c3110c840e76d8f82
  - url: https://github.com/golang/go/tree/16e5d24480dca7ddcbdffb78a8ed5de3e5155dec
    reference_type: commit
    reference_id: 16e5d24480dca7ddcbdffb78a8ed5de3e5155dec
  - url: https://github.com/golang/go/tree/bf80213b121074f4ad9b449410a4d13bae5e9be0
    reference_type: commit
    reference_id: bf80213b121074f4ad9b449410a4d13bae5e9be0
