advisory_id: CVE-2023-45289
datasource_id: collect_go_fix_commits/CVE-2023-45289
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  821bf37819ec170cadbc9e44a7471f7613611c41:net/http, net/http/cookiejar: avoid subdomain matches on IPv6 zones

  When deciding whether to forward cookies or sensitive headers
  across a redirect, do not attempt to interpret an IPv6 address
  as a domain name.

  Avoids a case where a maliciously-crafted redirect to an
  IPv6 address with a scoped addressing zone could be
  misinterpreted as a within-domain redirect. For example,
  we could interpret "::1%.www.example.com" as a subdomain
  of "www.example.com".

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes CVE-2023-45289
  Fixes #65065

  Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2131938
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/569340
  Reviewed-by: Damien Neil <dneil@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  20586c0dbe03d144f914155f879fa5ee287591a1:[release-branch.go1.21] net/http, net/http/cookiejar: avoid subdomain matches on IPv6 zones

  When deciding whether to forward cookies or sensitive headers
  across a redirect, do not attempt to interpret an IPv6 address
  as a domain name.

  Avoids a case where a maliciously-crafted redirect to an
  IPv6 address with a scoped addressing zone could be
  misinterpreted as a within-domain redirect. For example,
  we could interpret "::1%.www.example.com" as a subdomain
  of "www.example.com".

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes CVE-2023-45289
  Fixes #65385
  For #65065

  Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2131938
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2173775
  Reviewed-by: Carlos Amedee <amedee@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/569239
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  TryBot-Bypass: Michael Knyszek <mknyszek@google.com>
  3a855208e3efed2e9d7c20ad023f1fa78afcc0be:[release-branch.go1.22] net/http, net/http/cookiejar: avoid subdomain matches on IPv6 zones

  When deciding whether to forward cookies or sensitive headers
  across a redirect, do not attempt to interpret an IPv6 address
  as a domain name.

  Avoids a case where a maliciously-crafted redirect to an
  IPv6 address with a scoped addressing zone could be
  misinterpreted as a within-domain redirect. For example,
  we could interpret "::1%.www.example.com" as a subdomain
  of "www.example.com".

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes CVE-2023-45289
  Fixes #65859
  For #65065

  Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2131938
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174344
  Reviewed-by: Carlos Amedee <amedee@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/569236
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 821bf37819ec170cadbc9e44a7471f7613611c41
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 3a855208e3efed2e9d7c20ad023f1fa78afcc0be
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 20586c0dbe03d144f914155f879fa5ee287591a1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/20586c0dbe03d144f914155f879fa5ee287591a1
    reference_type: commit
    reference_id: 20586c0dbe03d144f914155f879fa5ee287591a1
  - url: https://github.com/golang/go/tree/3a855208e3efed2e9d7c20ad023f1fa78afcc0be
    reference_type: commit
    reference_id: 3a855208e3efed2e9d7c20ad023f1fa78afcc0be
  - url: https://github.com/golang/go/tree/821bf37819ec170cadbc9e44a7471f7613611c41
    reference_type: commit
    reference_id: 821bf37819ec170cadbc9e44a7471f7613611c41
