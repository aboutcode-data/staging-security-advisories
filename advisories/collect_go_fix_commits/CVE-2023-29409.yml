advisory_id: CVE-2023-29409
datasource_id: collect_go_fix_commits/CVE-2023-29409
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  2350afd2e8ab054390e284c95d5b089c142db017:crypto/tls: restrict RSA keys in certificates to <= 8192 bits

  Extremely large RSA keys in certificate chains can cause a client/server
  to expend significant CPU time verifying signatures. Limit this by
  restricting the size of RSA keys transmitted during handshakes to <=
  8192 bits.

  Based on a survey of publicly trusted RSA keys, there are currently only
  three certificates in circulation with keys larger than this, and all
  three appear to be test certificates that are not actively deployed. It
  is possible there are larger keys in use in private PKIs, but we target
  the web PKI, so causing breakage here in the interests of increasing the
  default safety of users of crypto/tls seems reasonable.

  Thanks to Mateusz Poliwczak for reporting this issue.

  Fixes #61460
  Fixes CVE-2023-29409

  Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1912161
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/515257
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Auto-Submit: David Chase <drchase@google.com>
  Run-TryBot: David Chase <drchase@google.com>
  a51957fb0b20bb6c91d0415efca222cc9ecdb770:[release-branch.go1.21] crypto/tls: restrict RSA keys in certificates to <= 8192 bits

  Extremely large RSA keys in certificate chains can cause a client/server
  to expend significant CPU time verifying signatures. Limit this by
  restricting the size of RSA keys transmitted during handshakes to <=
  8192 bits.

  Based on a survey of publicly trusted RSA keys, there are currently only
  three certificates in circulation with keys larger than this, and all
  three appear to be test certificates that are not actively deployed. It
  is possible there are larger keys in use in private PKIs, but we target
  the web PKI, so causing breakage here in the interests of increasing the
  default safety of users of crypto/tls seems reasonable.

  Thanks to Mateusz Poliwczak for reporting this issue.

  Updates #61460
  Fixes CVE-2023-29409

  Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1912161
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/515056
  Run-TryBot: David Chase <drchase@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  659f2a22076713bd2500adc82e026b6a746d8ba1:[release-branch.go1.20] crypto/tls: restrict RSA keys in certificates to <= 8192 bits

  Extremely large RSA keys in certificate chains can cause a client/server
  to expend significant CPU time verifying signatures. Limit this by
  restricting the size of RSA keys transmitted during handshakes to <=
  8192 bits.

  Based on a survey of publicly trusted RSA keys, there are currently only
  three certificates in circulation with keys larger than this, and all
  three appear to be test certificates that are not actively deployed. It
  is possible there are larger keys in use in private PKIs, but we target
  the web PKI, so causing breakage here in the interests of increasing the
  default safety of users of crypto/tls seems reasonable.

  Thanks to Mateusz Poliwczak for reporting this issue.

  Updates #61460
  Fixes #61580
  Fixes CVE-2023-29409

  Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1912161
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1965747
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/514900
  Run-TryBot: David Chase <drchase@google.com>
  Reviewed-by: Matthew Dempsky <mdempsky@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  2300f7ef07718f6be4d8aa8486c7de99836e233f:[release-branch.go1.19] crypto/tls: restrict RSA keys in certificates to <= 8192 bits

  Extremely large RSA keys in certificate chains can cause a client/server
  to expend significant CPU time verifying signatures. Limit this by
  restricting the size of RSA keys transmitted during handshakes to <=
  8192 bits.

  Based on a survey of publicly trusted RSA keys, there are currently only
  three certificates in circulation with keys larger than this, and all
  three appear to be test certificates that are not actively deployed. It
  is possible there are larger keys in use in private PKIs, but we target
  the web PKI, so causing breakage here in the interests of increasing the
  default safety of users of crypto/tls seems reasonable.

  Thanks to Mateusz Poliwczak for reporting this issue.

  Updates #61460
  Fixes #61579
  Fixes CVE-2023-29409

  Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1912161
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1965487
  Reviewed-on: https://go-review.googlesource.com/c/go/+/514915
  Run-TryBot: David Chase <drchase@google.com>
  Reviewed-by: Matthew Dempsky <mdempsky@google.com>
  TryBot-Bypass: David Chase <drchase@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 659f2a22076713bd2500adc82e026b6a746d8ba1
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2350afd2e8ab054390e284c95d5b089c142db017
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: a51957fb0b20bb6c91d0415efca222cc9ecdb770
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2300f7ef07718f6be4d8aa8486c7de99836e233f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/2300f7ef07718f6be4d8aa8486c7de99836e233f
    reference_type: commit
    reference_id: 2300f7ef07718f6be4d8aa8486c7de99836e233f
  - url: https://github.com/golang/go/tree/2350afd2e8ab054390e284c95d5b089c142db017
    reference_type: commit
    reference_id: 2350afd2e8ab054390e284c95d5b089c142db017
  - url: https://github.com/golang/go/tree/659f2a22076713bd2500adc82e026b6a746d8ba1
    reference_type: commit
    reference_id: 659f2a22076713bd2500adc82e026b6a746d8ba1
  - url: https://github.com/golang/go/tree/a51957fb0b20bb6c91d0415efca222cc9ecdb770
    reference_type: commit
    reference_id: a51957fb0b20bb6c91d0415efca222cc9ecdb770
