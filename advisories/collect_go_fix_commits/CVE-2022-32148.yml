advisory_id: CVE-2022-32148
datasource_id: collect_go_fix_commits/CVE-2022-32148
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  ebea1e3353fa766025aa5190b9c7cc05cf069187:[release-branch.go1.18] net/http: preserve nil values in Header.Clone

  ReverseProxy makes a distinction between nil and zero-length header values.
  Avoid losing nil-ness when cloning a request.

  Thanks to Christian Mehlmauer for discovering this.

  For #53423
  For CVE-2022-32148
  Fixes #53621

  Change-Id: Ice369cdb4712e2d62e25bb881b080847aa4801f5
  Reviewed-on: https://go-review.googlesource.com/c/go/+/412857
  Reviewed-by: Ian Lance Taylor <iant@google.com>
  Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
  (cherry picked from commit b2cc0fecc2ccd80e6d5d16542cc684f97b3a9c8a)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/415222
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  Run-TryBot: Heschi Kreinick <heschi@google.com>
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  ed2f33e1a7e0d18f61bd56f7ee067331d612c27e:[release-branch.go1.17] net/http: preserve nil values in Header.Clone

  ReverseProxy makes a distinction between nil and zero-length header values.
  Avoid losing nil-ness when cloning a request.

  Thanks to Christian Mehlmauer for discovering this.

  For #53423
  For CVE-2022-32148
  Fixes #53620

  Change-Id: Ice369cdb4712e2d62e25bb881b080847aa4801f5
  Reviewed-on: https://go-review.googlesource.com/c/go/+/412857
  Reviewed-by: Ian Lance Taylor <iant@google.com>
  Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
  (cherry picked from commit b2cc0fecc2ccd80e6d5d16542cc684f97b3a9c8a)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/415221
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  Run-TryBot: Heschi Kreinick <heschi@google.com>
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  b2cc0fecc2ccd80e6d5d16542cc684f97b3a9c8a:net/http: preserve nil values in Header.Clone

  ReverseProxy makes a distinction between nil and zero-length header values.
  Avoid losing nil-ness when cloning a request.

  Thanks to Christian Mehlmauer for discovering this.

  Fixes #53423
  Fixes CVE-2022-32148

  Change-Id: Ice369cdb4712e2d62e25bb881b080847aa4801f5
  Reviewed-on: https://go-review.googlesource.com/c/go/+/412857
  Reviewed-by: Ian Lance Taylor <iant@google.com>
  Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: ebea1e3353fa766025aa5190b9c7cc05cf069187
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: b2cc0fecc2ccd80e6d5d16542cc684f97b3a9c8a
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: ed2f33e1a7e0d18f61bd56f7ee067331d612c27e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/b2cc0fecc2ccd80e6d5d16542cc684f97b3a9c8a
    reference_type: commit
    reference_id: b2cc0fecc2ccd80e6d5d16542cc684f97b3a9c8a
  - url: https://github.com/golang/go/tree/ebea1e3353fa766025aa5190b9c7cc05cf069187
    reference_type: commit
    reference_id: ebea1e3353fa766025aa5190b9c7cc05cf069187
  - url: https://github.com/golang/go/tree/ed2f33e1a7e0d18f61bd56f7ee067331d612c27e
    reference_type: commit
    reference_id: ed2f33e1a7e0d18f61bd56f7ee067331d612c27e
