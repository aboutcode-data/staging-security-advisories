advisory_id: CVE-2023-29405
datasource_id: collect_go_fix_commits/CVE-2023-29405
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  6d8af00a630aa51134e54f0f321658621c6410f0:cmd/go,cmd/cgo: in _cgo_flags use one line per flag

  The flags that we recorded in _cgo_flags did not use any quoting,
  so a flag containing embedded spaces was mishandled.
  Change the _cgo_flags format to put each flag on a separate line.
  That is a simple format that does not require any quoting.

  As far as I can tell only cmd/go uses _cgo_flags, and it is only
  used for gccgo. If this patch doesn't cause any trouble, then
  in the next release we can change to only using _cgo_flags for gccgo.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes #60306
  Fixes CVE-2023-29405

  Change-Id: I81fb5337db8a22e1f4daca22ceff4b79b96d0b4f
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1875094
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/501224
  Reviewed-by: Ian Lance Taylor <iant@google.com>
  Run-TryBot: David Chase <drchase@google.com>
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  44e0fb13e783a44463e95926a674fd580daa3a55:[release-branch.go1.19] cmd/go,cmd/cgo: in _cgo_flags use one line per flag

  The flags that we recorded in _cgo_flags did not use any quoting,
  so a flag containing embedded spaces was mishandled.
  Change the _cgo_flags format to put each flag on a separate line.
  That is a simple format that does not require any quoting.

  As far as I can tell only cmd/go uses _cgo_flags, and it is only
  used for gccgo. If this patch doesn't cause any trouble, then
  in the next release we can change to only using _cgo_flags for gccgo.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Updates #60306
  Fixes #60513
  Fixes CVE-2023-29405

  Change-Id: Id738a737ecae47babb34c4b4fc4d65336cf0c0f3
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1875094
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit bcdfcadd5612212089d958bc352a6f6c90742dcc)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1902227
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1904341
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/501216
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  Run-TryBot: David Chase <drchase@google.com>
  TryBot-Bypass: David Chase <drchase@google.com>
  fa60c381ed06c12f9c27a7b50ca44c5f84f7f0f4:[release-branch.go1.20] cmd/go,cmd/cgo: in _cgo_flags use one line per flag

  The flags that we recorded in _cgo_flags did not use any quoting,
  so a flag containing embedded spaces was mishandled.
  Change the _cgo_flags format to put each flag on a separate line.
  That is a simple format that does not require any quoting.

  As far as I can tell only cmd/go uses _cgo_flags, and it is only
  used for gccgo. If this patch doesn't cause any trouble, then
  in the next release we can change to only using _cgo_flags for gccgo.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Updates #60306
  Fixes #60514
  Fixes CVE-2023-29405

  Change-Id: I36b6e188a44c80d7b9573efa577c386770bd2ba3
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1875094
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit bcdfcadd5612212089d958bc352a6f6c90742dcc)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1902228
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1904345
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/501220
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: David Chase <drchase@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 6d8af00a630aa51134e54f0f321658621c6410f0
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: fa60c381ed06c12f9c27a7b50ca44c5f84f7f0f4
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 44e0fb13e783a44463e95926a674fd580daa3a55
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/44e0fb13e783a44463e95926a674fd580daa3a55
    reference_type: commit
    reference_id: 44e0fb13e783a44463e95926a674fd580daa3a55
  - url: https://github.com/golang/go/tree/6d8af00a630aa51134e54f0f321658621c6410f0
    reference_type: commit
    reference_id: 6d8af00a630aa51134e54f0f321658621c6410f0
  - url: https://github.com/golang/go/tree/fa60c381ed06c12f9c27a7b50ca44c5f84f7f0f4
    reference_type: commit
    reference_id: fa60c381ed06c12f9c27a7b50ca44c5f84f7f0f4
