advisory_id: CVE-2022-30629
datasource_id: collect_go_fix_commits/CVE-2022-30629
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  c15a8e2dbb5ac376a6ed890735341b812d6b965c:[release-branch.go1.17] crypto/tls: randomly generate ticket_age_add

  As required by RFC 8446, section 4.6.1, ticket_age_add now holds a
  random 32-bit value. Before this change, this value was always set
  to 0.

  This change also documents the reasoning for always setting
  ticket_nonce to 0. The value ticket_nonce must be unique per
  connection, but we only ever send one ticket per connection.

  Updates #52814
  Fixes #52832
  Fixes CVE-2022-30629

  Change-Id: I6c2fc6ca0376b7b968abd59d6d3d3854c1ab68bb
  Reviewed-on: https://go-review.googlesource.com/c/go/+/405994
  Reviewed-by: Tatiana Bradley <tatiana@golang.org>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Run-TryBot: Tatiana Bradley <tatiana@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  (cherry picked from commit fe4de36198794c447fbd9d7cc2d7199a506c76a5)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/408574
  Run-TryBot: Roland Shoemaker <roland@golang.org>
  c838098c327a1b6d63446f4722e943b02d235d78:[release-branch.go1.18 crypto/tls: randomly generate ticket_age_add

  As required by RFC 8446, section 4.6.1, ticket_age_add now holds a
  random 32-bit value. Before this change, this value was always set
  to 0.

  This change also documents the reasoning for always setting
  ticket_nonce to 0. The value ticket_nonce must be unique per
  connection, but we only ever send one ticket per connection.

  Updates #52814
  Fixes #52833
  Fixes CVE-2022-30629

  Change-Id: I6c2fc6ca0376b7b968abd59d6d3d3854c1ab68bb
  Reviewed-on: https://go-review.googlesource.com/c/go/+/405994
  Reviewed-by: Tatiana Bradley <tatiana@golang.org>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Run-TryBot: Tatiana Bradley <tatiana@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  (cherry picked from commit fe4de36198794c447fbd9d7cc2d7199a506c76a5)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/408575
  Run-TryBot: Roland Shoemaker <roland@golang.org>
  fe4de36198794c447fbd9d7cc2d7199a506c76a5:crypto/tls: randomly generate ticket_age_add

  As required by RFC 8446, section 4.6.1, ticket_age_add now holds a
  random 32-bit value. Before this change, this value was always set
  to 0.

  This change also documents the reasoning for always setting
  ticket_nonce to 0. The value ticket_nonce must be unique per
  connection, but we only ever send one ticket per connection.

  Fixes #52814
  Fixes CVE-2022-30629

  Change-Id: I6c2fc6ca0376b7b968abd59d6d3d3854c1ab68bb
  Reviewed-on: https://go-review.googlesource.com/c/go/+/405994
  Reviewed-by: Tatiana Bradley <tatiana@golang.org>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Run-TryBot: Tatiana Bradley <tatiana@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: fe4de36198794c447fbd9d7cc2d7199a506c76a5
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: c838098c327a1b6d63446f4722e943b02d235d78
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: c15a8e2dbb5ac376a6ed890735341b812d6b965c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/c15a8e2dbb5ac376a6ed890735341b812d6b965c
    reference_type: commit
    reference_id: c15a8e2dbb5ac376a6ed890735341b812d6b965c
  - url: https://github.com/golang/go/tree/c838098c327a1b6d63446f4722e943b02d235d78
    reference_type: commit
    reference_id: c838098c327a1b6d63446f4722e943b02d235d78
  - url: https://github.com/golang/go/tree/fe4de36198794c447fbd9d7cc2d7199a506c76a5
    reference_type: commit
    reference_id: fe4de36198794c447fbd9d7cc2d7199a506c76a5
