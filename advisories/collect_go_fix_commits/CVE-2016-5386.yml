advisory_id: CVE-2016-5386
datasource_id: collect_go_fix_commits/CVE-2016-5386
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  a357d15e9ee36a1232ae071d9968c4cf10a672b4:[release-branch.go1.6] net/http, net/http/cgi: fix for CGI + HTTP_PROXY security issue

  Because,

  * The CGI spec defines that incoming request header "Foo: Bar" maps to
    environment variable HTTP_FOO == "Bar". (see RFC 3875 4.1.18)

  * The HTTP_PROXY environment variable is conventionally used to configure
    the HTTP proxy for HTTP clients (and is respected by default for
    Go's net/http.Client and Transport)

  That means Go programs running in a CGI environment (as a child
  process under a CGI host) are vulnerable to an incoming request
  containing "Proxy: attacker.com:1234", setting HTTP_PROXY, and
  changing where Go by default proxies all outbound HTTP requests.

  This is CVE-2016-5386, aka https://httpoxy.org/

  Fixes #16405

  Change-Id: I6f68ade85421b4807785799f6d98a8b077e871f0
  Reviewed-on: https://go-review.googlesource.com/25010
  Run-TryBot: Chris Broadfoot <cbro@golang.org>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  Reviewed-by: Chris Broadfoot <cbro@golang.org>
  Reviewed-on: https://go-review.googlesource.com/25012
  cad4e97af8f2e0b9f09b97f67fb3a89ced2e9021:[release-branch.go1.7] net/http, net/http/cgi: fix for CGI + HTTP_PROXY security issue

  Because,

  * The CGI spec defines that incoming request header "Foo: Bar" maps to
    environment variable HTTP_FOO == "Bar". (see RFC 3875 4.1.18)

  * The HTTP_PROXY environment variable is conventionally used to configure
    the HTTP proxy for HTTP clients (and is respected by default for
    Go's net/http.Client and Transport)

  That means Go programs running in a CGI environment (as a child
  process under a CGI host) are vulnerable to an incoming request
  containing "Proxy: attacker.com:1234", setting HTTP_PROXY, and
  changing where Go by default proxies all outbound HTTP requests.

  This is CVE-2016-5386, aka https://httpoxy.org/

  Fixes #16405

  Change-Id: I6f68ade85421b4807785799f6d98a8b077e871f0
  Reviewed-on: https://go-review.googlesource.com/25010
  Run-TryBot: Chris Broadfoot <cbro@golang.org>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  Reviewed-by: Chris Broadfoot <cbro@golang.org>
  Reviewed-on: https://go-review.googlesource.com/25013
  b97df54c31d6c4cc2a28a3c83725366d52329223:net/http, net/http/cgi: fix for CGI + HTTP_PROXY security issue

  Because,

  * The CGI spec defines that incoming request header "Foo: Bar" maps to
    environment variable HTTP_FOO == "Bar". (see RFC 3875 4.1.18)

  * The HTTP_PROXY environment variable is conventionally used to configure
    the HTTP proxy for HTTP clients (and is respected by default for
    Go's net/http.Client and Transport)

  That means Go programs running in a CGI environment (as a child
  process under a CGI host) are vulnerable to an incoming request
  containing "Proxy: attacker.com:1234", setting HTTP_PROXY, and
  changing where Go by default proxies all outbound HTTP requests.

  This is CVE-2016-5386, aka https://httpoxy.org/

  Fixes #16405

  Change-Id: I6f68ade85421b4807785799f6d98a8b077e871f0
  Reviewed-on: https://go-review.googlesource.com/25010
  Run-TryBot: Chris Broadfoot <cbro@golang.org>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  Reviewed-by: Chris Broadfoot <cbro@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: a357d15e9ee36a1232ae071d9968c4cf10a672b4
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: b97df54c31d6c4cc2a28a3c83725366d52329223
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: cad4e97af8f2e0b9f09b97f67fb3a89ced2e9021
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/a357d15e9ee36a1232ae071d9968c4cf10a672b4
    reference_type: commit
    reference_id: a357d15e9ee36a1232ae071d9968c4cf10a672b4
  - url: https://github.com/golang/go/tree/b97df54c31d6c4cc2a28a3c83725366d52329223
    reference_type: commit
    reference_id: b97df54c31d6c4cc2a28a3c83725366d52329223
  - url: https://github.com/golang/go/tree/cad4e97af8f2e0b9f09b97f67fb3a89ced2e9021
    reference_type: commit
    reference_id: cad4e97af8f2e0b9f09b97f67fb3a89ced2e9021
