advisory_id: CVE-2024-34155
datasource_id: collect_go_fix_commits/CVE-2024-34155
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  dd2019528b669908f8ccc0c327a64d0e07fc2a1b:go/parser: track depth in nested element lists

  Prevents stack exhaustion with extremely deeply nested literal values,
  i.e. field values in structs.

  Fixes #69138
  Fixes CVE-2024-34155

  Change-Id: I2e8e33b44105cc169d7ed1ae83fb56df0c10f1ee
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1520
  Reviewed-by: Robert Griesemer <gri@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/611238
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Auto-Submit: Dmitri Shuralyov <dmitshur@golang.org>
  b232596139dbe96a62edbe3a2a203e856bf556eb:[release-branch.go1.22] go/parser: track depth in nested element lists

  Prevents stack exhaustion with extremely deeply nested literal values,
  i.e. field values in structs.

  Updates #69138
  Fixes #69142
  Fixes CVE-2024-34155

  Change-Id: I2e8e33b44105cc169d7ed1ae83fb56df0c10f1ee
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1520
  Reviewed-by: Robert Griesemer <gri@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  (cherry picked from commit eb1b038c0d01761694e7a735ef87ac9164c6568e)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1561
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/611181
  Reviewed-by: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Dmitri Shuralyov <dmitshur@google.com>
  Auto-Submit: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  53487e5477151ed75da50e50a0ba8f1ca64c00a3:[release-branch.go1.23] go/parser: track depth in nested element lists

  Prevents stack exhaustion with extremely deeply nested literal values,
  i.e. field values in structs.

  Updates #69138
  Fixes #69143
  Fixes CVE-2024-34155

  Change-Id: I2e8e33b44105cc169d7ed1ae83fb56df0c10f1ee
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1520
  Reviewed-by: Robert Griesemer <gri@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  (cherry picked from commit eb1b038c0d01761694e7a735ef87ac9164c6568e)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1560
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/611175
  Auto-Submit: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  TryBot-Bypass: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Michael Pratt <mpratt@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: dd2019528b669908f8ccc0c327a64d0e07fc2a1b
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 53487e5477151ed75da50e50a0ba8f1ca64c00a3
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: b232596139dbe96a62edbe3a2a203e856bf556eb
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/53487e5477151ed75da50e50a0ba8f1ca64c00a3
    reference_type: commit
    reference_id: 53487e5477151ed75da50e50a0ba8f1ca64c00a3
  - url: https://github.com/golang/go/tree/b232596139dbe96a62edbe3a2a203e856bf556eb
    reference_type: commit
    reference_id: b232596139dbe96a62edbe3a2a203e856bf556eb
  - url: https://github.com/golang/go/tree/dd2019528b669908f8ccc0c327a64d0e07fc2a1b
    reference_type: commit
    reference_id: dd2019528b669908f8ccc0c327a64d0e07fc2a1b
