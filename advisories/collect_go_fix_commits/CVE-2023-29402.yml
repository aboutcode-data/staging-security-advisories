advisory_id: CVE-2023-29402
datasource_id: collect_go_fix_commits/CVE-2023-29402
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  4dae3bbe0e6a5700037bb996ae84d6f457c4f58a:cmd/go: disallow package directories containing newlines

  Directory or file paths containing newlines may cause tools (such as
  cmd/cgo) that emit "//line" or "#line" -directives to write part of
  the path into non-comment lines in generated source code. If those
  lines contain valid Go code, it may be injected into the resulting
  binary.

  (Note that Go import paths and file paths within module zip files
  already could not contain newlines.)

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes #60167.
  Fixes CVE-2023-29402.

  Change-Id: I64572e9f454bce7b685d00e2e6a1c96cd33d53df
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1882606
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/501226
  Run-TryBot: David Chase <drchase@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  c160b49b6d328c86bd76ca2fff9009a71347333f:[release-branch.go1.19] cmd/go: disallow package directories containing newlines

  Directory or file paths containing newlines may cause tools (such as
  cmd/cgo) that emit "//line" or "#line" -directives to write part of
  the path into non-comment lines in generated source code. If those
  lines contain valid Go code, it may be injected into the resulting
  binary.

  (Note that Go import paths and file paths within module zip files
  already could not contain newlines.)

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Updates #60167.
  Fixes #60515.
  Fixes CVE-2023-29402.

  Change-Id: If55d0400c02beb7a5da5eceac60f1abeac99f064
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1882606
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit 41f9046495564fc728d6f98384ab7276450ac7e2)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1902229
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1904343
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Bryan Mills <bcmills@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/501218
  Run-TryBot: David Chase <drchase@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  c0ed873cd8259f16d0da67eee783fda49f45ef61:[release-branch.go1.20] cmd/go: disallow package directories containing newlines

  Directory or file paths containing newlines may cause tools (such as
  cmd/cgo) that emit "//line" or "#line" -directives to write part of
  the path into non-comment lines in generated source code. If those
  lines contain valid Go code, it may be injected into the resulting
  binary.

  (Note that Go import paths and file paths within module zip files
  already could not contain newlines.)

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Updates #60167.
  Fixes #60516.
  Fixes CVE-2023-29402.

  Change-Id: Ic3c7d8d1f6460993bd93a27035d61bff7dd68832
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1882606
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit 41f9046495564fc728d6f98384ab7276450ac7e2)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1902230
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1904347
  Reviewed-by: Bryan Mills <bcmills@google.com>
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/501222
  Run-TryBot: David Chase <drchase@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: c160b49b6d328c86bd76ca2fff9009a71347333f
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 4dae3bbe0e6a5700037bb996ae84d6f457c4f58a
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: c0ed873cd8259f16d0da67eee783fda49f45ef61
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/4dae3bbe0e6a5700037bb996ae84d6f457c4f58a
    reference_type: commit
    reference_id: 4dae3bbe0e6a5700037bb996ae84d6f457c4f58a
  - url: https://github.com/golang/go/tree/c0ed873cd8259f16d0da67eee783fda49f45ef61
    reference_type: commit
    reference_id: c0ed873cd8259f16d0da67eee783fda49f45ef61
  - url: https://github.com/golang/go/tree/c160b49b6d328c86bd76ca2fff9009a71347333f
    reference_type: commit
    reference_id: c160b49b6d328c86bd76ca2fff9009a71347333f
