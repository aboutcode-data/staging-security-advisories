advisory_id: CVE-2025-22867
datasource_id: collect_go_fix_commits/CVE-2025-22867
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  51bf2cf7cfa999777697a9548d59d22c3716fbde:Revert "cmd/go/internal/work: allow @ character in some -Wl, linker flags on darwin"

  This reverts CL 638075 (commit e3cd55e9d293d519e622e788e902f372dc30338a).

  This change introduced a security issue as @ flags are first resolved as
  files by the darwin linker, before their meaning as flags, allowing the
  flag filtering logic to be entirely bypassed.

  Thanks to Juho Forsén for reporting this issue.

  Fixes #71476
  Fixes CVE-2025-22867

  Change-Id: I3a4b4a6fc534de105d930b8ed5b9900bc94b0c4e
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1900
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/646996
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  c43ac38b3b9fe861186af2e60b6f6b16486d8640:[release-branch.go1.24] Revert "cmd/go/internal/work: allow @ character in some -Wl, linker flags on darwin"

  This reverts commit e3cd55e9d293d519e622e788e902f372dc30338a.

  This change introduced a security issue as @ flags are first resolved as
  files by the darwin linker, before their meaning as flags, allowing the
  flag filtering logic to be entirely bypassed.

  Thanks to Juho Forsén for reporting this issue.

  Fixes #71476
  Fixes CVE-2025-22867

  Change-Id: I3a4b4a6fc534de105d930b8ed5b9900bc94b0c4e
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1900
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit cc0d725a4168f234ef38859b2d951a50a8fd94b5)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1940
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/646995
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  TryBot-Bypass: Cherry Mui <cherryyz@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 51bf2cf7cfa999777697a9548d59d22c3716fbde
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: c43ac38b3b9fe861186af2e60b6f6b16486d8640
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/51bf2cf7cfa999777697a9548d59d22c3716fbde
    reference_type: commit
    reference_id: 51bf2cf7cfa999777697a9548d59d22c3716fbde
  - url: https://github.com/golang/go/tree/c43ac38b3b9fe861186af2e60b6f6b16486d8640
    reference_type: commit
    reference_id: c43ac38b3b9fe861186af2e60b6f6b16486d8640
