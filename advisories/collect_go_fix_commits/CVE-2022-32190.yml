advisory_id: CVE-2022-32190
datasource_id: collect_go_fix_commits/CVE-2022-32190
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  28335508913a46e05ef0c04a18e8a1a6beb775ec:[release-branch.go1.19] net/url: consistently remove ../ elements in JoinPath

  JoinPath would fail to remove relative elements from the start of
  the path when the first path element is "".

  In addition, JoinPath would return the original path unmodified
  when provided with no elements to join, violating the documented
  behavior of always cleaning the resulting path.

  Correct both these cases.

      JoinPath("http://go.dev", "../go")
      // before: http://go.dev/../go
      // after:  http://go.dev/go

      JoinPath("http://go.dev/../go")
      // before: http://go.dev/../go
      // after:  http://go.dev/go

  For #54385.
  Fixes #54635.
  Fixes CVE-2022-32190.

  Change-Id: I6d22cd160d097c50703dd96e4f453c6c118fd5d9
  Reviewed-on: https://go-review.googlesource.com/c/go/+/423514
  Reviewed-by: David Chase <drchase@google.com>
  Reviewed-by: Alan Donovan <adonovan@google.com>
  (cherry picked from commit 0765da5884adcc8b744979303a36a27092d8fc51)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/425357
  Run-TryBot: Damien Neil <dneil@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 28335508913a46e05ef0c04a18e8a1a6beb775ec
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/28335508913a46e05ef0c04a18e8a1a6beb775ec
    reference_type: commit
    reference_id: 28335508913a46e05ef0c04a18e8a1a6beb775ec
