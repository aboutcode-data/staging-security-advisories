advisory_id: CVE-2023-39320
datasource_id: collect_go_fix_commits/CVE-2023-39320
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  a0c3a1b6769c9849577eb6426fdac39d40372307:cmd/go: reject toolchain directives containing path separators

  If GOTOOLCHAIN="path" or "auto", the go command uses exec.LookPath to
  search for it in order to allow toolchains to refer to local-only
  toolchain variants (such as toolchains built from enterprise- or
  distro-patched source). However, those toolchains should only be
  resolved from $PATH, not relative to the working directory of the
  command.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes #62198.
  Fixes CVE-2023-39320.

  Change-Id: I247c7acea95d737362dd0475e9fc8515430d0fcc
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1996318
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/526158
  Reviewed-by: Bryan Mills <bcmills@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  d25a935574efd573668d8ce9ea4cfc530bb63ecb:[release-branch.go1.21] cmd/go: reject toolchain directives containing path separators

  If GOTOOLCHAIN="path" or "auto", the go command uses exec.LookPath to
  search for it in order to allow toolchains to refer to local-only
  toolchain variants (such as toolchains built from enterprise- or
  distro-patched source). However, those toolchains should only be
  resolved from $PATH, not relative to the working directory of the
  command.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes #62198.
  Fixes #62394.
  Fixes CVE-2023-39320.

  Change-Id: I247c7acea95d737362dd0475e9fc8515430d0fcc
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1996318
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit e41c0a55d45e9a9acbc5d7c1143ea4fff8fb9283)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2014013
  Reviewed-by: Bryan Mills <bcmills@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/526095
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Cherry Mui <cherryyz@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: a0c3a1b6769c9849577eb6426fdac39d40372307
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: d25a935574efd573668d8ce9ea4cfc530bb63ecb
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/a0c3a1b6769c9849577eb6426fdac39d40372307
    reference_type: commit
    reference_id: a0c3a1b6769c9849577eb6426fdac39d40372307
  - url: https://github.com/golang/go/tree/d25a935574efd573668d8ce9ea4cfc530bb63ecb
    reference_type: commit
    reference_id: d25a935574efd573668d8ce9ea4cfc530bb63ecb
