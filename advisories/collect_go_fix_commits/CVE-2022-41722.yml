advisory_id: CVE-2022-41722
datasource_id: collect_go_fix_commits/CVE-2022-41722
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  3345ddca41f00f9ed6fc3c1a36f6e2bede02d7ff:[release-branch.go1.19] path/filepath: do not Clean("a/../c:/b") into c:\b on Windows

  Do not permit Clean to convert a relative path into one starting
  with a drive reference. This change causes Clean to insert a .
  path element at the start of a path when the original path does not
  start with a volume name, and the first path element would contain
  a colon.

  This may introduce a spurious but harmless . path element under
  some circumstances. For example, Clean("a/../b:/../c") becomes `.\c`.

  This reverts CL 401595, since the change here supersedes the one
  in that CL.

  Thanks to RyotaK (https://twitter.com/ryotkak) for reporting this issue.

  Updates #57274
  Fixes #57275
  Fixes CVE-2022-41722

  Change-Id: I837446285a03aa74c79d7642720e01f354c2ca17
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1675249
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  (cherry picked from commit 780dfa043ff5192c37de0d6fd1053a66b2b9f378)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1728206
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/468115
  Reviewed-by: Than McIntosh <thanm@google.com>
  Run-TryBot: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  bdf07c2e168baf736e4c057279ca12a4d674f18c:[release-branch.go1.20] path/filepath: do not Clean("a/../c:/b") into c:\b on Windows

  Do not permit Clean to convert a relative path into one starting
  with a drive reference. This change causes Clean to insert a .
  path element at the start of a path when the original path does not
  start with a volume name, and the first path element would contain
  a colon.

  This may introduce a spurious but harmless . path element under
  some circumstances. For example, Clean("a/../b:/../c") becomes `.\c`.

  This reverts CL 401595, since the change here supersedes the one
  in that CL.

  Thanks to RyotaK (https://twitter.com/ryotkak) for reporting this issue.

  Updates #57274
  Fixes #57276
  Fixes CVE-2022-41722

  Change-Id: I837446285a03aa74c79d7642720e01f354c2ca17
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1675249
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  (cherry picked from commit 8ca37f4813ef2f64600c92b83f17c9f3ca6c03a5)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1728944
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/468119
  Reviewed-by: Than McIntosh <thanm@google.com>
  Run-TryBot: Michael Pratt <mpratt@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  95eb5abd6340b271ae728f99986eeccbc0354ab1:path/filepath: do not Clean("a/../c:/b") into c:\b on Windows

  Do not permit Clean to convert a relative path into one starting
  with a drive reference. This change causes Clean to insert a .
  path element at the start of a path when the original path does not
  start with a volume name, and the first path element would contain
  a colon.

  This may introduce a spurious but harmless . path element under
  some circumstances. For example, Clean("a/../b:/../c") becomes `.\c`.

  This reverts CL 401595, since the change here supersedes the one
  in that CL.

  Thanks to RyotaK (https://twitter.com/ryotkak) for reporting this issue.

  Fixes #57274
  Fixes CVE-2022-41722

  Change-Id: I837446285a03aa74c79d7642720e01f354c2ca17
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1675249
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Run-TryBot: Damien Neil <dneil@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/468123
  Run-TryBot: Michael Pratt <mpratt@google.com>
  Reviewed-by: Than McIntosh <thanm@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 3345ddca41f00f9ed6fc3c1a36f6e2bede02d7ff
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 95eb5abd6340b271ae728f99986eeccbc0354ab1
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: bdf07c2e168baf736e4c057279ca12a4d674f18c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/3345ddca41f00f9ed6fc3c1a36f6e2bede02d7ff
    reference_type: commit
    reference_id: 3345ddca41f00f9ed6fc3c1a36f6e2bede02d7ff
  - url: https://github.com/golang/go/tree/95eb5abd6340b271ae728f99986eeccbc0354ab1
    reference_type: commit
    reference_id: 95eb5abd6340b271ae728f99986eeccbc0354ab1
  - url: https://github.com/golang/go/tree/bdf07c2e168baf736e4c057279ca12a4d674f18c
    reference_type: commit
    reference_id: bdf07c2e168baf736e4c057279ca12a4d674f18c
