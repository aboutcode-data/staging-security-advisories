advisory_id: CVE-2022-1962
datasource_id: collect_go_fix_commits/CVE-2022-1962
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  ba8788ebcead55e99e631c6a1157ad7b35535d11:[release-branch.go1.17] go/parser: limit recursion depth

  Limit nested parsing to 100,000, which prevents stack exhaustion when
  parsing deeply nested statements, types, and expressions. Also limit
  the scope depth to 1,000 during object resolution.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes #53707
  Updates #53616
  Fixes CVE-2022-1962

  Change-Id: I4d7b86c1d75d0bf3c7af1fdea91582aa74272c64
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1491025
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit 6a856f08d58e4b6705c0c337d461c540c1235c83)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/417070
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  0d1615b23f9a558aa0a1957b4c81596220eb8ec4:[release-branch.go1.18] go/parser: limit recursion depth

  Limit nested parsing to 100,000, which prevents stack exhaustion when
  parsing deeply nested statements, types, and expressions. Also limit
  the scope depth to 1,000 during object resolution.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes #53708
  Updates #53616
  Fixes CVE-2022-1962

  Change-Id: I4d7b86c1d75d0bf3c7af1fdea91582aa74272c64
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1491025
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit 6a856f08d58e4b6705c0c337d461c540c1235c83)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/417056
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  695be961d57508da5a82217f7415200a11845879:go/parser: limit recursion depth

  Limit nested parsing to 100,000, which prevents stack exhaustion when
  parsing deeply nested statements, types, and expressions. Also limit
  the scope depth to 1,000 during object resolution.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes #53616
  Fixes CVE-2022-1962

  Change-Id: I4d7b86c1d75d0bf3c7af1fdea91582aa74272c64
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1491025
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/417063
  Run-TryBot: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Heschi Kreinick <heschi@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: ba8788ebcead55e99e631c6a1157ad7b35535d11
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 695be961d57508da5a82217f7415200a11845879
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 0d1615b23f9a558aa0a1957b4c81596220eb8ec4
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/0d1615b23f9a558aa0a1957b4c81596220eb8ec4
    reference_type: commit
    reference_id: 0d1615b23f9a558aa0a1957b4c81596220eb8ec4
  - url: https://github.com/golang/go/tree/695be961d57508da5a82217f7415200a11845879
    reference_type: commit
    reference_id: 695be961d57508da5a82217f7415200a11845879
  - url: https://github.com/golang/go/tree/ba8788ebcead55e99e631c6a1157ad7b35535d11
    reference_type: commit
    reference_id: ba8788ebcead55e99e631c6a1157ad7b35535d11
