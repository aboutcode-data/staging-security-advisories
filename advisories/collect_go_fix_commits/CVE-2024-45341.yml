advisory_id: CVE-2024-45341
datasource_id: collect_go_fix_commits/CVE-2024-45341
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  468fad45a27db0ec1fff4ae397d3670795b3f977:[release-branch.go1.24] crypto/x509: properly check for IPv6 hosts in URIs

  When checking URI constraints, use netip.ParseAddr, which understands
  zones, unlike net.ParseIP which chokes on them. This prevents zone IDs
  from mistakenly satisfying URI constraints.

  Thanks to Juho Forsén of Mattermost for reporting this issue.

  For #71156
  Fixes #71209
  Fixes CVE-2024-45341

  Change-Id: Iecac2529f3605382d257996e0fb6d6983547e400
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1700
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit 22ca55d396ba801e6ae9b2bd67a059fcb30562fd)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1800
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/643099
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Michael Pratt <mpratt@google.com>
  19d21034157ba69d0f54318a9867d9b08730efcb:[release-branch.go1.22] crypto/x509: properly check for IPv6 hosts in URIs

  When checking URI constraints, use netip.ParseAddr, which understands
  zones, unlike net.ParseIP which chokes on them. This prevents zone IDs
  from mistakenly satisfying URI constraints.

  Thanks to Juho Forsén of Mattermost for reporting this issue.

  For #71156
  Fixes #71207
  Fixes CVE-2024-45341

  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1700
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Change-Id: I1d97723e0f29fcf1404fb868ba0495282da70f6e
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1780
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/643105
  TryBot-Bypass: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  fdb8413fe588ec6dc31f1deaf43eb7202a76bb79:[release-branch.go1.23] crypto/x509: properly check for IPv6 hosts in URIs

  When checking URI constraints, use netip.ParseAddr, which understands
  zones, unlike net.ParseIP which chokes on them. This prevents zone IDs
  from mistakenly satisfying URI constraints.

  Thanks to Juho Forsén of Mattermost for reporting this issue.

  For #71156
  Fixes #71208
  Fixes CVE-2024-45341

  Change-Id: Iecac2529f3605382d257996e0fb6d6983547e400
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1700
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit 22ca55d396ba801e6ae9b2bd67a059fcb30562fd)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1762
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/643103
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  Reviewed-by: Michael Pratt <mpratt@google.com>
  2b2314e9f6103de322b2e247387c8b01fd0cd5a4:crypto/x509: properly check for IPv6 hosts in URIs

  When checking URI constraints, use netip.ParseAddr, which understands
  zones, unlike net.ParseIP which chokes on them. This prevents zone IDs
  from mistakenly satisfying URI constraints.

  Thanks to Juho Forsén of Mattermost for reporting this issue.

  Fixes #71156
  Fixes CVE-2024-45341

  Change-Id: Iecac2529f3605382d257996e0fb6d6983547e400
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1700
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/643096
  Reviewed-by: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: '19d21034157ba69d0f54318a9867d9b08730efcb'
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: fdb8413fe588ec6dc31f1deaf43eb7202a76bb79
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2b2314e9f6103de322b2e247387c8b01fd0cd5a4
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 468fad45a27db0ec1fff4ae397d3670795b3f977
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/19d21034157ba69d0f54318a9867d9b08730efcb
    reference_type: commit
    reference_id: '19d21034157ba69d0f54318a9867d9b08730efcb'
  - url: https://github.com/golang/go/tree/2b2314e9f6103de322b2e247387c8b01fd0cd5a4
    reference_type: commit
    reference_id: 2b2314e9f6103de322b2e247387c8b01fd0cd5a4
  - url: https://github.com/golang/go/tree/468fad45a27db0ec1fff4ae397d3670795b3f977
    reference_type: commit
    reference_id: 468fad45a27db0ec1fff4ae397d3670795b3f977
  - url: https://github.com/golang/go/tree/fdb8413fe588ec6dc31f1deaf43eb7202a76bb79
    reference_type: commit
    reference_id: fdb8413fe588ec6dc31f1deaf43eb7202a76bb79
