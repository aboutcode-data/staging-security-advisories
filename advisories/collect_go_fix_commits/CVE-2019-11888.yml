advisory_id: CVE-2019-11888
datasource_id: collect_go_fix_commits/CVE-2019-11888
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  afcfe0d3c2980722af0dc55a3422c19cc53f5a65:[release-branch.go1.12] os: pass correct environment when creating Windows processes

  This is CVE-2019-11888.

  Previously, passing a nil environment but a non-nil token would result
  in the new potentially unprivileged process inheriting the parent
  potentially privileged environment, or would result in the new
  potentially privileged process inheriting the parent potentially
  unprivileged environment. Either way, it's bad. In the former case, it's
  an infoleak. In the latter case, it's a possible EoP, since things like
  PATH could be overwritten.

  Not specifying an environment currently means, "use the existing
  environment". This commit amends the behavior to be, "use the existing
  environment of the token the process is being created for." The behavior
  therefore stays the same when creating processes without specifying a
  token. And it does the correct thing when creating processes when
  specifying a token.

  Updates #32000
  Fixes #32081

  Change-Id: Ib4a90cfffb6ba866c855f66f1313372fdd34ce41
  Reviewed-on: https://go-review.googlesource.com/c/go/+/177538
  Run-TryBot: Jason Donenfeld <Jason@zx2c4.com>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  Reviewed-by: Ian Lance Taylor <iant@golang.org>
  12279faa727696a78d849be8a16c470a344b24a8:os: pass correct environment when creating Windows processes

  This is CVE-2019-11888.

  Previously, passing a nil environment but a non-nil token would result
  in the new potentially unprivileged process inheriting the parent
  potentially privileged environment, or would result in the new
  potentially privileged process inheriting the parent potentially
  unprivileged environment. Either way, it's bad. In the former case, it's
  an infoleak. In the latter case, it's a possible EoP, since things like
  PATH could be overwritten.

  Not specifying an environment currently means, "use the existing
  environment". This commit amends the behavior to be, "use the existing
  environment of the token the process is being created for." The behavior
  therefore stays the same when creating processes without specifying a
  token. And it does the correct thing when creating processes when
  specifying a token.

  Fixes #32000

  Change-Id: Ia57f6e89b97bdbaf7274d6a89c1d9948b6d40ef5
  Reviewed-on: https://go-review.googlesource.com/c/go/+/176619
  Run-TryBot: Jason Donenfeld <Jason@zx2c4.com>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  Reviewed-by: Alex Brainman <alex.brainman@gmail.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 12279faa727696a78d849be8a16c470a344b24a8
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: afcfe0d3c2980722af0dc55a3422c19cc53f5a65
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/12279faa727696a78d849be8a16c470a344b24a8
    reference_type: commit
    reference_id: 12279faa727696a78d849be8a16c470a344b24a8
  - url: https://github.com/golang/go/tree/afcfe0d3c2980722af0dc55a3422c19cc53f5a65
    reference_type: commit
    reference_id: afcfe0d3c2980722af0dc55a3422c19cc53f5a65
