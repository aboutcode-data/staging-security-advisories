advisory_id: CVE-2020-16845
datasource_id: collect_go_fix_commits/CVE-2020-16845
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  027d7241ce050d197e7fabea3d541ffbe3487258:encoding/binary: read at most MaxVarintLen64 bytes in ReadUvarint

  This CL ensures that ReadUvarint consumes only a limited
  amount of input (instead of an unbounded amount).

  On some inputs, ReadUvarint could read an arbitrary number
  of bytes before deciding to return an overflow error.
  After this CL, ReadUvarint returns that same overflow
  error sooner, after reading at most MaxVarintLen64 bytes.

  Fix authored by Robert Griesemer and Filippo Valsorda.

  Thanks to Diederik Loerakker, Jonny Rhea, Raúl Kripalani,
  and Preston Van Loon for reporting this.

  Fixes #40618
  Fixes CVE-2020-16845

  Change-Id: Ie0cb15972f14c38b7cf7af84c45c4ce54909bb8f
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/812099
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/247120
  Run-TryBot: Katie Hockman <katie@golang.org>
  TryBot-Result: Gobot Gobot <gobot@golang.org>
  Reviewed-by: Alexander Rakoczy <alex@golang.org>
  ec5b63a6a2b6205cc204e9ce856e7517a1b989d2:[release-branch.go1.13-security] encoding/binary: read at most MaxVarintLen64 bytes in ReadUvarint

  This CL ensures that ReadUvarint consumes only a limited
  amount of input (instead of an unbounded amount).

  On some inputs, ReadUvarint could read an arbitrary number
  of bytes before deciding to return an overflow error.
  After this CL, ReadUvarint returns that same overflow
  error sooner, after reading at most MaxVarintLen64 bytes.

  Fix authored by Robert Griesemer and Filippo Valsorda.

  Thanks to Diederik Loerakker, Jonny Rhea, Raúl Kripalani,
  and Preston Van Loon for reporting this.

  Fixes CVE-2020-16845

  Change-Id: Ie0cb15972f14c38b7cf7af84c45c4ce54909bb8f
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/812099
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/812324
  51bb041f7cf17c5e8e10a7307521625437687b04:[release-branch.go1.14-security] encoding/binary: read at most MaxVarintLen64 bytes in ReadUvarint

  This CL ensures that ReadUvarint consumes only a limited
  amount of input (instead of an unbounded amount).

  On some inputs, ReadUvarint could read an arbitrary number
  of bytes before deciding to return an overflow error.
  After this CL, ReadUvarint returns that same overflow
  error sooner, after reading at most MaxVarintLen64 bytes.

  Fix authored by Robert Griesemer and Filippo Valsorda.

  Thanks to Diederik Loerakker, Jonny Rhea, Raúl Kripalani,
  and Preston Van Loon for reporting this.

  Fixes CVE-2020-16845

  Change-Id: Ie0cb15972f14c38b7cf7af84c45c4ce54909bb8f
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/812099
  Reviewed-by: Filippo Valsorda <valsorda@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/812326
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 027d7241ce050d197e7fabea3d541ffbe3487258
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: ec5b63a6a2b6205cc204e9ce856e7517a1b989d2
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 51bb041f7cf17c5e8e10a7307521625437687b04
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/027d7241ce050d197e7fabea3d541ffbe3487258
    reference_type: commit
    reference_id: 027d7241ce050d197e7fabea3d541ffbe3487258
  - url: https://github.com/golang/go/tree/51bb041f7cf17c5e8e10a7307521625437687b04
    reference_type: commit
    reference_id: 51bb041f7cf17c5e8e10a7307521625437687b04
  - url: https://github.com/golang/go/tree/ec5b63a6a2b6205cc204e9ce856e7517a1b989d2
    reference_type: commit
    reference_id: ec5b63a6a2b6205cc204e9ce856e7517a1b989d2
