advisory_id: CVE-2024-45336
datasource_id: collect_go_fix_commits/CVE-2024-45336
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  6b605505047416bbbf513bba1540220a8897f3f6:[release-branch.go1.24] net/http: persist header stripping across repeated redirects

  When an HTTP redirect changes the host of a request, we drop
  sensitive headers such as Authorization from the redirected request.
  Fix a bug where a chain of redirects could result in sensitive
  headers being sent to the wrong host:

    1. request to a.tld with Authorization header
    2. a.tld redirects to b.tld
    3. request to b.tld with no Authorization header
    4. b.tld redirects to b.tld
    3. request to b.tld with Authorization header restored

  Thanks to Kyle Seely for reporting this issue.

  For #70530
  Fixes #71212
  Fixes CVE-2024-45336

  Change-Id: Ia58a2e10d33d6b0cc7220935e771450e5c34de72
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1641
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit 2889169b87a61f1218a02994feb80fd3d8bfa87c)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1766
  Reviewed-on: https://go-review.googlesource.com/c/go/+/643100
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Michael Pratt <mpratt@google.com>
  b72d56f98d6620ebe07626dca4bb67ea8e185379:[release-branch.go1.22] net/http: persist header stripping across repeated redirects

  When an HTTP redirect changes the host of a request, we drop
  sensitive headers such as Authorization from the redirected request.
  Fix a bug where a chain of redirects could result in sensitive
  headers being sent to the wrong host:

    1. request to a.tld with Authorization header
    2. a.tld redirects to b.tld
    3. request to b.tld with no Authorization header
    4. b.tld redirects to b.tld
    3. request to b.tld with Authorization header restored

  Thanks to Kyle Seely for reporting this issue.

  Fixes #70530
  For #71210
  Fixes CVE-2024-45336

  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1641
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Change-Id: Id7b1e3c90345566b8ee1a51f65dbb179da6eb427
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1765
  Reviewed-on: https://go-review.googlesource.com/c/go/+/643106
  Reviewed-by: Michael Pratt <mpratt@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  bb8230f80535945648e8b56739ad450cf433eba9:[release-branch.go1.23] net/http: persist header stripping across repeated redirects

  When an HTTP redirect changes the host of a request, we drop
  sensitive headers such as Authorization from the redirected request.
  Fix a bug where a chain of redirects could result in sensitive
  headers being sent to the wrong host:

    1. request to a.tld with Authorization header
    2. a.tld redirects to b.tld
    3. request to b.tld with no Authorization header
    4. b.tld redirects to b.tld
    3. request to b.tld with Authorization header restored

  Thanks to Kyle Seely for reporting this issue.

  For #70530
  Fixes ##71211
  Fixes CVE-2024-45336

  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1641
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Change-Id: I326544358de71ff892d9e9fe338252a5dd04001f
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1764
  Reviewed-on: https://go-review.googlesource.com/c/go/+/643104
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Michael Pratt <mpratt@google.com>
  6783377295e0878aa3ad821eefe3d7879064df6d:net/http: persist header stripping across repeated redirects

  When an HTTP redirect changes the host of a request, we drop
  sensitive headers such as Authorization from the redirected request.
  Fix a bug where a chain of redirects could result in sensitive
  headers being sent to the wrong host:

    1. request to a.tld with Authorization header
    2. a.tld redirects to b.tld
    3. request to b.tld with no Authorization header
    4. b.tld redirects to b.tld
    3. request to b.tld with Authorization header restored

  Thanks to Kyle Seely for reporting this issue.

  For #70530
  Fixes CVE-2024-45336

  Change-Id: Ia58a2e10d33d6b0cc7220935e771450e5c34de72
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1641
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/643095
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 6b605505047416bbbf513bba1540220a8897f3f6
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 6783377295e0878aa3ad821eefe3d7879064df6d
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: b72d56f98d6620ebe07626dca4bb67ea8e185379
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: bb8230f80535945648e8b56739ad450cf433eba9
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/6783377295e0878aa3ad821eefe3d7879064df6d
    reference_type: commit
    reference_id: 6783377295e0878aa3ad821eefe3d7879064df6d
  - url: https://github.com/golang/go/tree/6b605505047416bbbf513bba1540220a8897f3f6
    reference_type: commit
    reference_id: 6b605505047416bbbf513bba1540220a8897f3f6
  - url: https://github.com/golang/go/tree/b72d56f98d6620ebe07626dca4bb67ea8e185379
    reference_type: commit
    reference_id: b72d56f98d6620ebe07626dca4bb67ea8e185379
  - url: https://github.com/golang/go/tree/bb8230f80535945648e8b56739ad450cf433eba9
    reference_type: commit
    reference_id: bb8230f80535945648e8b56739ad450cf433eba9
