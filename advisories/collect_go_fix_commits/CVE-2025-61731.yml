advisory_id: CVE-2025-61731
datasource_id: collect_go_fix_commits/CVE-2025-61731
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  5e1ad12db93611b13d2be176fdc276330dc52b98:cmd/go/internal/work: sanitize flags before invoking 'pkg-config'

  The addition of CgoPkgConfig allowed execution with flags not
  matching the safelist. In order to prevent potential arbitrary
  code execution at build time, ensure that flags are validated
  prior to invoking the 'pkg-config' binary.

  Thank you to RyotaK (https://ryotak.net) of GMO Flatt Security Inc.
  for reporting this issue.

  Fixes CVE-2025-61731
  Fixes #77100

  Change-Id: Ic51b41f1f7e697ab98c9c32c6fae35f217f7f364
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3240
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736711
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  2526187481ee31241b72f491992accbdd66c2655:[release-branch.go1.25] cmd/go/internal/work: sanitize flags before invoking 'pkg-config'

  The addition of CgoPkgConfig allowed execution with flags not
  matching the safelist. In order to prevent potential arbitrary
  code execution at build time, ensure that flags are validated
  prior to invoking the 'pkg-config' binary.

  Thank you to RyotaK (https://ryotak.net) of GMO Flatt Security Inc.
  for reporting this issue.

  Fixes CVE-2025-61731
  Fixes #77100

  Change-Id: Ic51b41f1f7e697ab98c9c32c6fae35f217f7f364
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3240
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3343
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736722
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
  6ed1ff80d68b3e6de9366f65038a43eede049a4a:[release-branch.go1.26] cmd/go/internal/work: sanitize flags before invoking 'pkg-config'

  The addition of CgoPkgConfig allowed execution with flags not
  matching the safelist. In order to prevent potential arbitrary
  code execution at build time, ensure that flags are validated
  prior to invoking the 'pkg-config' binary.

  Thank you to RyotaK (https://ryotak.net) of GMO Flatt Security Inc.
  for reporting this issue.

  Fixes CVE-2025-61731
  Fixes #77100

  Change-Id: Ic51b41f1f7e697ab98c9c32c6fae35f217f7f364
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3240
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3324
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736706
  Auto-Submit: Michael Pratt <mpratt@google.com>
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  00b7309387a171bcba37382e7ed96b473df04917:[release-branch.go1.24] cmd/go/internal/work: sanitize flags before invoking 'pkg-config'

  The addition of CgoPkgConfig allowed execution with flags not
  matching the safelist. In order to prevent potential arbitrary
  code execution at build time, ensure that flags are validated
  prior to invoking the 'pkg-config' binary.

  Thank you to RyotaK (https://ryotak.net) of GMO Flatt Security Inc.
  for reporting this issue.

  Fixes CVE-2025-61731
  Fixes #77100

  Change-Id: Ic51b41f1f7e697ab98c9c32c6fae35f217f7f364
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3240
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3344
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/736701
  Auto-Submit: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Reviewed-by: Junyang Shao <shaojunyang@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 6ed1ff80d68b3e6de9366f65038a43eede049a4a
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2526187481ee31241b72f491992accbdd66c2655
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 5e1ad12db93611b13d2be176fdc276330dc52b98
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 00b7309387a171bcba37382e7ed96b473df04917
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/00b7309387a171bcba37382e7ed96b473df04917
    reference_type: commit
    reference_id: 00b7309387a171bcba37382e7ed96b473df04917
  - url: https://github.com/golang/go/tree/2526187481ee31241b72f491992accbdd66c2655
    reference_type: commit
    reference_id: 2526187481ee31241b72f491992accbdd66c2655
  - url: https://github.com/golang/go/tree/5e1ad12db93611b13d2be176fdc276330dc52b98
    reference_type: commit
    reference_id: 5e1ad12db93611b13d2be176fdc276330dc52b98
  - url: https://github.com/golang/go/tree/6ed1ff80d68b3e6de9366f65038a43eede049a4a
    reference_type: commit
    reference_id: 6ed1ff80d68b3e6de9366f65038a43eede049a4a
