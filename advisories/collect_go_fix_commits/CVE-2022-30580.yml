advisory_id: CVE-2022-30580
datasource_id: collect_go_fix_commits/CVE-2022-30580
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  590b53fac9ebdb259b32e82805dec1cc96987930:[release-branch.go1.17] os/exec: return clear error for missing cmd.Path

  Following up on CL 403694, there is a bit of confusion about
  when Path is and isn't set, along with now the exported Err field.
  Catch the case where Path and Err (and lookPathErr) are all unset
  and give a helpful error.

  Updates #52574
  Followup after #43724.

  Fixes #53056
  Fixes CVE-2022-30580

  Change-Id: I03205172aef3801c3194f5098bdb93290c02b1b6
  Reviewed-on: https://go-review.googlesource.com/c/go/+/403759
  Reviewed-by: Bryan Mills <bcmills@google.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  (cherry picked from commit 960ffa98ce73ef2c2060c84c7ac28d37a83f345e)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/408578
  Run-TryBot: Roland Shoemaker <roland@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  6c65a4ab8e8bc6caa70d3bfe9b4bdd3dc26b8de5:[release-branch.go1.18] os/exec: return clear error for missing cmd.Path

  Following up on CL 403694, there is a bit of confusion about
  when Path is and isn't set, along with now the exported Err field.
  Catch the case where Path and Err (and lookPathErr) are all unset
  and give a helpful error.

  Updates #52574
  Followup after #43724.

  Fixes #53057
  Fixes CVE-2022-30580

  Change-Id: I03205172aef3801c3194f5098bdb93290c02b1b6
  Reviewed-on: https://go-review.googlesource.com/c/go/+/403759
  Reviewed-by: Bryan Mills <bcmills@google.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  (cherry picked from commit 960ffa98ce73ef2c2060c84c7ac28d37a83f345e)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/408577
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Run-TryBot: Roland Shoemaker <roland@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 590b53fac9ebdb259b32e82805dec1cc96987930
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 6c65a4ab8e8bc6caa70d3bfe9b4bdd3dc26b8de5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/590b53fac9ebdb259b32e82805dec1cc96987930
    reference_type: commit
    reference_id: 590b53fac9ebdb259b32e82805dec1cc96987930
  - url: https://github.com/golang/go/tree/6c65a4ab8e8bc6caa70d3bfe9b4bdd3dc26b8de5
    reference_type: commit
    reference_id: 6c65a4ab8e8bc6caa70d3bfe9b4bdd3dc26b8de5
