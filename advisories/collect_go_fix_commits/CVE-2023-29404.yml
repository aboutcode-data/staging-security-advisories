advisory_id: CVE-2023-29404
datasource_id: collect_go_fix_commits/CVE-2023-29404
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  bbeb55f5faf93659e1cfd6ab073ab3c9d126d195:cmd/go: enforce flags with non-optional arguments

  Enforce that linker flags which expect arguments get them, otherwise it
  may be possible to smuggle unexpected flags through as the linker can
  consume what looks like a flag as an argument to a preceding flag (i.e.
  "-Wl,-O -Wl,-R,-bad-flag" is interpreted as "-O=-R -bad-flag"). Also be
  somewhat more restrictive in the general format of some flags.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Fixes #60305
  Fixes CVE-2023-29404

  Change-Id: I913df78a692cee390deefc3cd7d8f5b031524fc9
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1876275
  Reviewed-by: Ian Lance Taylor <iant@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/501225
  Run-TryBot: David Chase <drchase@google.com>
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  bf3c8ce03e175e870763901a3850bca01381a828:[release-branch.go1.19] cmd/go: enforce flags with non-optional arguments

  Enforce that linker flags which expect arguments get them, otherwise it
  may be possible to smuggle unexpected flags through as the linker can
  consume what looks like a flag as an argument to a preceding flag (i.e.
  "-Wl,-O -Wl,-R,-bad-flag" is interpreted as "-O=-R -bad-flag"). Also be
  somewhat more restrictive in the general format of some flags.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Updates #60305
  Fixes #60511
  Fixes CVE-2023-29404

  Change-Id: Icdffef2c0f644da50261cace6f43742783931cff
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1876275
  Reviewed-by: Ian Lance Taylor <iant@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit 896779503cf754cbdac24b61d4cc953b50fe2dde)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1902225
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1904342
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/501217
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  Run-TryBot: David Chase <drchase@google.com>
  TryBot-Bypass: Michael Knyszek <mknyszek@google.com>
  356a419e2f811b65d227abcea1a346f8dcb154e0:[release-branch.go1.20] cmd/go: enforce flags with non-optional arguments

  Enforce that linker flags which expect arguments get them, otherwise it
  may be possible to smuggle unexpected flags through as the linker can
  consume what looks like a flag as an argument to a preceding flag (i.e.
  "-Wl,-O -Wl,-R,-bad-flag" is interpreted as "-O=-R -bad-flag"). Also be
  somewhat more restrictive in the general format of some flags.

  Thanks to Juho Nurminen of Mattermost for reporting this issue.

  Updates #60305
  Fixes #60512
  Fixes CVE-2023-29404

  Change-Id: I5989f68d21a8851d8edd47f08550850524ee9180
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1876275
  Reviewed-by: Ian Lance Taylor <iant@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit 896779503cf754cbdac24b61d4cc953b50fe2dde)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1902226
  TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1904346
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/501221
  Run-TryBot: David Chase <drchase@google.com>
  Auto-Submit: Michael Knyszek <mknyszek@google.com>
  TryBot-Result: Gopher Robot <gobot@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: bbeb55f5faf93659e1cfd6ab073ab3c9d126d195
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: bf3c8ce03e175e870763901a3850bca01381a828
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 356a419e2f811b65d227abcea1a346f8dcb154e0
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/356a419e2f811b65d227abcea1a346f8dcb154e0
    reference_type: commit
    reference_id: 356a419e2f811b65d227abcea1a346f8dcb154e0
  - url: https://github.com/golang/go/tree/bbeb55f5faf93659e1cfd6ab073ab3c9d126d195
    reference_type: commit
    reference_id: bbeb55f5faf93659e1cfd6ab073ab3c9d126d195
  - url: https://github.com/golang/go/tree/bf3c8ce03e175e870763901a3850bca01381a828
    reference_type: commit
    reference_id: bf3c8ce03e175e870763901a3850bca01381a828
