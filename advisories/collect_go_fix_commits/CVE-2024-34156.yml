advisory_id: CVE-2024-34156
datasource_id: collect_go_fix_commits/CVE-2024-34156
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  08c84420bc40d1cd5eb71b85cbe3a36f707bdb3f:encoding/gob: cover missed cases when checking ignore depth

  This change makes sure that we are properly checking the ignored field
  recursion depth in decIgnoreOpFor consistently. This prevents stack
  exhaustion when attempting to decode a message that contains an
  extremely deeply nested struct which is ignored.

  Thanks to Md Sakib Anwar of The Ohio State University (anwar.40@osu.edu)
  for reporting this issue.

  Fixes #69139
  Fixes CVE-2024-34156

  Change-Id: Iacce06be95a5892b3064f1c40fcba2e2567862d6
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1440
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/611239
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Auto-Submit: Dmitri Shuralyov <dmitshur@golang.org>
  2092294f2b097c5828f4eace6c98a322c1510b01:[release-branch.go1.22] encoding/gob: cover missed cases when checking ignore depth

  This change makes sure that we are properly checking the ignored field
  recursion depth in decIgnoreOpFor consistently. This prevents stack
  exhaustion when attempting to decode a message that contains an
  extremely deeply nested struct which is ignored.

  Thanks to Md Sakib Anwar of The Ohio State University (anwar.40@osu.edu)
  for reporting this issue.

  Updates #69139
  Fixes #69144
  Fixes CVE-2024-34156

  Change-Id: Iacce06be95a5892b3064f1c40fcba2e2567862d6
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1440
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit f0a11f9b3aaa362cb1d05e095e3c8d421d4f087f)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1580
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/611182
  TryBot-Bypass: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Michael Pratt <mpratt@google.com>
  Auto-Submit: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  fa8ff1a46deb6c816304441ec6740ec112e19012:[release-branch.go1.23] encoding/gob: cover missed cases when checking ignore depth

  This change makes sure that we are properly checking the ignored field
  recursion depth in decIgnoreOpFor consistently. This prevents stack
  exhaustion when attempting to decode a message that contains an
  extremely deeply nested struct which is ignored.

  Thanks to Md Sakib Anwar of The Ohio State University (anwar.40@osu.edu)
  for reporting this issue.

  Updates #69139
  Fixes #69145
  Fixes CVE-2024-34156

  Change-Id: Iacce06be95a5892b3064f1c40fcba2e2567862d6
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1440
  Reviewed-by: Russ Cox <rsc@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit 9f2ea73c5f2a7056b7da5d579a485a7216f4b20a)
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1581
  Commit-Queue: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/611176
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Auto-Submit: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Dmitri Shuralyov <dmitshur@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: fa8ff1a46deb6c816304441ec6740ec112e19012
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2092294f2b097c5828f4eace6c98a322c1510b01
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 08c84420bc40d1cd5eb71b85cbe3a36f707bdb3f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/08c84420bc40d1cd5eb71b85cbe3a36f707bdb3f
    reference_type: commit
    reference_id: 08c84420bc40d1cd5eb71b85cbe3a36f707bdb3f
  - url: https://github.com/golang/go/tree/2092294f2b097c5828f4eace6c98a322c1510b01
    reference_type: commit
    reference_id: 2092294f2b097c5828f4eace6c98a322c1510b01
  - url: https://github.com/golang/go/tree/fa8ff1a46deb6c816304441ec6740ec112e19012
    reference_type: commit
    reference_id: fa8ff1a46deb6c816304441ec6740ec112e19012
