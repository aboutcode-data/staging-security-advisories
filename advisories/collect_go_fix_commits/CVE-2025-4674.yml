advisory_id: CVE-2025-4674
datasource_id: collect_go_fix_commits/CVE-2025-4674
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  54c9d776302d53ab1907645cb67fa4a948e1500c:cmd/go: disable support for multiple vcs in one module

  Removes the somewhat redundant vcs.FromDir, "allowNesting" argument,
  which was always enabled, and disallow multiple VCS metadata folders
  being present in a single directory. This makes VCS injection attacks
  much more difficult.

  Also adds a GODEBUG, allowmultiplevcs, which re-enables this behavior.

  Thanks to RyotaK (https://ryotak.net) of GMO Flatt Security Inc for reporting this issue.

  Fixes #74380
  Fixes CVE-2025-4674

  Change-Id: I5787d90cdca8deb3aca6f154efb627df1e7d2789
  Reviewed-on: https://go-review.googlesource.com/c/go/+/686515
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: David Chase <drchase@google.com>
  Commit-Queue: Carlos Amedee <carlos@golang.org>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  2899144b8d80e8d73274c04fb39a36d3a54658dd:[release-branch.go1.25] cmd/go: disable support for multiple vcs in one module

  Removes the somewhat redundant vcs.FromDir, "allowNesting" argument,
  which was always enabled, and disallow multiple VCS metadata folders
  being present in a single directory. This makes VCS injection attacks
  much more difficult.

  Also adds a GODEBUG, allowmultiplevcs, which re-enables this behavior.

  Thanks to RyotaK (https://ryotak.net) of GMO Flatt Security Inc for
  reporting this issue.

  Fixes #74380
  Fixes CVE-2025-4674

  Change-Id: I95b619588ecb6661770aa4e1d6023d6cb22e2263
  Reviewed-on: https://go-review.googlesource.com/c/go/+/686338
  Reviewed-by: David Chase <drchase@google.com>
  Auto-Submit: Carlos Amedee <carlos@golang.org>
  TryBot-Bypass: Carlos Amedee <carlos@golang.org>
  825eeee3f789a11231ce23a4836c74ec5e34bf2a:[release-branch.go1.24] cmd/go: disable support for multiple vcs in one module

  Removes the somewhat redundant vcs.FromDir, "allowNesting" argument,
  which was always enabled, and disallow multiple VCS metadata folders
  being present in a single directory. This makes VCS injection attacks
  much more difficult.

  Also adds a GODEBUG, allowmultiplevcs, which re-enables this behavior.

  Thanks to RyotaK (https://ryotak.net) of GMO Flatt Security Inc for
  reporting this issue.

  Updates #74380
  Fixes #74381
  Fixes CVE-2025-4674

  Change-Id: I6c7925b034d60b80d7698cca677b00bdcc67f24e
  Reviewed-on: https://go-review.googlesource.com/c/go/+/686395
  Reviewed-by: David Chase <drchase@google.com>
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Commit-Queue: Carlos Amedee <carlos@golang.org>
  e9d2c032b14c17083be0f8f0c822565199d2994f:[release-branch.go1.23] cmd/go: disable support for multiple vcs in one module

  Removes the somewhat redundant vcs.FromDir, "allowNesting" argument,
  which was always enabled, and disallow multiple VCS metadata folders
  being present in a single directory. This makes VCS injection attacks
  much more difficult.

  Also adds a GODEBUG, allowmultiplevcs, which re-enables this behavior.

  Thanks to RyotaK (https://ryotak.net) of GMO Flatt Security Inc for
  reporting this issue.

  Updates #74380
  Fixes #74382
  Fixes CVE-2025-4674

  Change-Id: I2db79f2baacfacfec331ee7c6978c4057d483eba
  Reviewed-on: https://go-review.googlesource.com/c/go/+/686337
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Reviewed-by: David Chase <drchase@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Commit-Queue: Carlos Amedee <carlos@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2899144b8d80e8d73274c04fb39a36d3a54658dd
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 54c9d776302d53ab1907645cb67fa4a948e1500c
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: e9d2c032b14c17083be0f8f0c822565199d2994f
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 825eeee3f789a11231ce23a4836c74ec5e34bf2a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/2899144b8d80e8d73274c04fb39a36d3a54658dd
    reference_type: commit
    reference_id: 2899144b8d80e8d73274c04fb39a36d3a54658dd
  - url: https://github.com/golang/go/tree/54c9d776302d53ab1907645cb67fa4a948e1500c
    reference_type: commit
    reference_id: 54c9d776302d53ab1907645cb67fa4a948e1500c
  - url: https://github.com/golang/go/tree/825eeee3f789a11231ce23a4836c74ec5e34bf2a
    reference_type: commit
    reference_id: 825eeee3f789a11231ce23a4836c74ec5e34bf2a
  - url: https://github.com/golang/go/tree/e9d2c032b14c17083be0f8f0c822565199d2994f
    reference_type: commit
    reference_id: e9d2c032b14c17083be0f8f0c822565199d2994f
