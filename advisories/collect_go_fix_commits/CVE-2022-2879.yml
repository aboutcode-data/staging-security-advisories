advisory_id: CVE-2022-2879
datasource_id: collect_go_fix_commits/CVE-2022-2879
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  0bf7ee9977c0218562c50a0b0f0d9cbdf33f65e6:archive/tar: limit size of headers

  Set a 1MiB limit on special file blocks (PAX headers, GNU long names,
  GNU link names), to avoid reading arbitrarily large amounts of data
  into memory.

  Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting
  this issue.

  Fixes CVE-2022-2879
  For #54853

  Change-Id: I85136d6ff1e0af101a112190e027987ab4335680
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1565555
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/439355
  Reviewed-by: Damien Neil <dneil@google.com>
  Run-TryBot: Roland Shoemaker <roland@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Auto-Submit: Roland Shoemaker <roland@golang.org>
  0a723816cd205576945fa57fbdde7e6532d59d08:[release-branch.go1.18] archive/tar: limit size of headers

  Set a 1MiB limit on special file blocks (PAX headers, GNU long names,
  GNU link names), to avoid reading arbitrarily large amounts of data
  into memory.

  Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting
  this issue.

  Fixes CVE-2022-2879
  Updates #54853
  Fixes #55925

  Change-Id: I85136d6ff1e0af101a112190e027987ab4335680
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1565555
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit 6ee768cef6b82adf7a90dcf367a1699ef694f3b2)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1590622
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/438500
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Run-TryBot: Carlos Amedee <carlos@golang.org>
  TryBot-Result: Gopher Robot <gobot@golang.org>
  4fa773cdefd20be093c84f731be7d4febf5536fa:[release-branch.go1.19] archive/tar: limit size of headers

  Set a 1MiB limit on special file blocks (PAX headers, GNU long names,
  GNU link names), to avoid reading arbitrarily large amounts of data
  into memory.

  Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting
  this issue.

  Fixes CVE-2022-2879
  Updates #54853
  Fixes #55926

  Change-Id: I85136d6ff1e0af101a112190e027987ab4335680
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1565555
  Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
  Run-TryBot: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  (cherry picked from commit 6ee768cef6b82adf7a90dcf367a1699ef694f3b2)
  Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1591053
  Reviewed-by: Julie Qiu <julieqiu@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/438498
  TryBot-Result: Gopher Robot <gobot@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
  Run-TryBot: Carlos Amedee <carlos@golang.org>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 4fa773cdefd20be093c84f731be7d4febf5536fa
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 0a723816cd205576945fa57fbdde7e6532d59d08
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 0bf7ee9977c0218562c50a0b0f0d9cbdf33f65e6
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/0a723816cd205576945fa57fbdde7e6532d59d08
    reference_type: commit
    reference_id: 0a723816cd205576945fa57fbdde7e6532d59d08
  - url: https://github.com/golang/go/tree/0bf7ee9977c0218562c50a0b0f0d9cbdf33f65e6
    reference_type: commit
    reference_id: 0bf7ee9977c0218562c50a0b0f0d9cbdf33f65e6
  - url: https://github.com/golang/go/tree/4fa773cdefd20be093c84f731be7d4febf5536fa
    reference_type: commit
    reference_id: 4fa773cdefd20be093c84f731be7d4febf5536fa
