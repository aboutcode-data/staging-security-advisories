advisory_id: CVE-2025-58183
datasource_id: collect_go_fix_commits/CVE-2025-58183
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  f7a68d3804efabd271f0338391858bc1e7e57422:archive/tar: set a limit on the size of GNU sparse file 1.0 regions

  Sparse files in tar archives contain only the non-zero components
  of the file. There are several different encodings for sparse
  files. When reading GNU tar pax 1.0 sparse files, archive/tar did
  not set a limit on the size of the sparse region data. A malicious
  archive containing a large number of sparse blocks could cause
  archive/tar to read an unbounded amount of data from the archive
  into memory.

  Since a malicious input can be highly compressable, a small
  compressed input could cause very large allocations.

  Cap the size of the sparse block data to the same limit used
  for PAX headers (1 MiB).

  Thanks to Harshit Gupta (Mr HAX) (https://www.linkedin.com/in/iam-harshit-gupta/)
  for reporting this issue.

  Fixes CVE-2025-58183
  Fixes #75677

  Change-Id: I70b907b584a7b8676df8a149a1db728ae681a770
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2800
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709861
  Auto-Submit: Michael Pratt <mpratt@google.com>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  2612dcfd3cb6dd73c76e14a24fe1a68e2708e4e3:[release-branch.go1.25] archive/tar: set a limit on the size of GNU sparse file 1.0 regions

  Sparse files in tar archives contain only the non-zero components
  of the file. There are several different encodings for sparse
  files. When reading GNU tar pax 1.0 sparse files, archive/tar did
  not set a limit on the size of the sparse region data. A malicious
  archive containing a large number of sparse blocks could cause
  archive/tar to read an unbounded amount of data from the archive
  into memory.

  Since a malicious input can be highly compressable, a small
  compressed input could cause very large allocations.

  Cap the size of the sparse block data to the same limit used
  for PAX headers (1 MiB).

  Thanks to Harshit Gupta (Mr HAX) (https://www.linkedin.com/in/iam-harshit-gupta/)
  for reporting this issue.

  Fixes CVE-2025-58183
  For #75677
  Fixes #75711

  Change-Id: I70b907b584a7b8676df8a149a1db728ae681a770
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2800
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2987
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709852
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  Auto-Submit: Michael Pratt <mpratt@google.com>
  613e746327381d820759ebea6ce722720b343556:[release-branch.go1.24] archive/tar: set a limit on the size of GNU sparse file 1.0 regions

  Sparse files in tar archives contain only the non-zero components
  of the file. There are several different encodings for sparse
  files. When reading GNU tar pax 1.0 sparse files, archive/tar did
  not set a limit on the size of the sparse region data. A malicious
  archive containing a large number of sparse blocks could cause
  archive/tar to read an unbounded amount of data from the archive
  into memory.

  Since a malicious input can be highly compressable, a small
  compressed input could cause very large allocations.

  Cap the size of the sparse block data to the same limit used
  for PAX headers (1 MiB).

  Thanks to Harshit Gupta (Mr HAX) (https://www.linkedin.com/in/iam-harshit-gupta/)
  for reporting this issue.

  Fixes CVE-2025-58183
  For #75677
  Fixes #75710

  Change-Id: I70b907b584a7b8676df8a149a1db728ae681a770
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2800
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-by: Nicholas Husin <husin@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/2967
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/709843
  Reviewed-by: Carlos Amedee <carlos@golang.org>
  TryBot-Bypass: Michael Pratt <mpratt@google.com>
  Auto-Submit: Michael Pratt <mpratt@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: f7a68d3804efabd271f0338391858bc1e7e57422
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 2612dcfd3cb6dd73c76e14a24fe1a68e2708e4e3
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 613e746327381d820759ebea6ce722720b343556
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/2612dcfd3cb6dd73c76e14a24fe1a68e2708e4e3
    reference_type: commit
    reference_id: 2612dcfd3cb6dd73c76e14a24fe1a68e2708e4e3
  - url: https://github.com/golang/go/tree/613e746327381d820759ebea6ce722720b343556
    reference_type: commit
    reference_id: 613e746327381d820759ebea6ce722720b343556
  - url: https://github.com/golang/go/tree/f7a68d3804efabd271f0338391858bc1e7e57422
    reference_type: commit
    reference_id: f7a68d3804efabd271f0338391858bc1e7e57422
