advisory_id: CVE-2025-61729
datasource_id: collect_go_fix_commits/CVE-2025-61729
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  c1acdcb34560b20291cf55c988d0f883a38e8bbf:crypto/x509: prevent HostnameError.Error() from consuming excessive resource

  Constructing HostnameError.Error() takes O(N^2) runtime due to using a
  string concatenation in a loop. Additionally, there is no limit on how
  many names are included in the error message. As a result, a malicious
  attacker could craft a certificate with an infinite amount of names to
  unfairly consume resource.

  To remediate this, we will now use strings.Builder to construct the
  error message, preventing O(N^2) runtime. When a certificate has 100 or
  more names, we will also not print each name individually.

  Thanks to Philippe Antoine (Catena cyber) for reporting this issue.

  Fixes #76445
  Fixes CVE-2025-61729

  Change-Id: I6343776ec3289577abc76dad71766c491c1a7c81
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3000
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/725920
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  TryBot-Bypass: Dmitri Shuralyov <dmitshur@golang.org>
  3a842bd5c6aa8eefa13c0174de3ab361e50bd672:[release-branch.go1.24] crypto/x509: prevent HostnameError.Error() from consuming excessive resource

  Constructing HostnameError.Error() takes O(N^2) runtime due to using a
  string concatenation in a loop. Additionally, there is no limit on how
  many names are included in the error message. As a result, a malicious
  attacker could craft a certificate with an infinite amount of names to
  unfairly consume resource.

  To remediate this, we will now use strings.Builder to construct the
  error message, preventing O(N^2) runtime. When a certificate has 100 or
  more names, we will also not print each name individually.

  Thanks to Philippe Antoine (Catena cyber) for reporting this issue.

  Updates #76445
  Fixes #76460
  Fixes CVE-2025-61729

  Change-Id: I6343776ec3289577abc76dad71766c491c1a7c81
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3000
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3220
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/725820
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  TryBot-Bypass: Dmitri Shuralyov <dmitshur@golang.org>
  Auto-Submit: Dmitri Shuralyov <dmitshur@google.com>
  Reviewed-by: Mark Freeman <markfreeman@google.com>
  f7bce4bd6f7b13de8d9f06f7f262e3b60381e7e9:[release-branch.go1.25] crypto/x509: prevent HostnameError.Error() from consuming excessive resource

  Constructing HostnameError.Error() takes O(N^2) runtime due to using a
  string concatenation in a loop. Additionally, there is no limit on how
  many names are included in the error message. As a result, a malicious
  attacker could craft a certificate with an infinite amount of names to
  unfairly consume resource.

  To remediate this, we will now use strings.Builder to construct the
  error message, preventing O(N^2) runtime. When a certificate has 100 or
  more names, we will also not print each name individually.

  Thanks to Philippe Antoine (Catena cyber) for reporting this issue.

  Updates #76445
  Fixes #76461
  Fixes CVE-2025-61729

  Change-Id: I6343776ec3289577abc76dad71766c491c1a7c81
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3000
  Reviewed-by: Neal Patel <nealpatel@google.com>
  Reviewed-by: Damien Neil <dneil@google.com>
  Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/3200
  Reviewed-by: Roland Shoemaker <bracewell@google.com>
  Reviewed-on: https://go-review.googlesource.com/c/go/+/725800
  TryBot-Bypass: Dmitri Shuralyov <dmitshur@golang.org>
  Reviewed-by: Mark Freeman <markfreeman@google.com>
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Auto-Submit: Dmitri Shuralyov <dmitshur@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: f7bce4bd6f7b13de8d9f06f7f262e3b60381e7e9
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 3a842bd5c6aa8eefa13c0174de3ab361e50bd672
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: c1acdcb34560b20291cf55c988d0f883a38e8bbf
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/3a842bd5c6aa8eefa13c0174de3ab361e50bd672
    reference_type: commit
    reference_id: 3a842bd5c6aa8eefa13c0174de3ab361e50bd672
  - url: https://github.com/golang/go/tree/c1acdcb34560b20291cf55c988d0f883a38e8bbf
    reference_type: commit
    reference_id: c1acdcb34560b20291cf55c988d0f883a38e8bbf
  - url: https://github.com/golang/go/tree/f7bce4bd6f7b13de8d9f06f7f262e3b60381e7e9
    reference_type: commit
    reference_id: f7bce4bd6f7b13de8d9f06f7f262e3b60381e7e9
