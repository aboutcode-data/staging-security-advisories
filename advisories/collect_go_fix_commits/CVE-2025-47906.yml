advisory_id: CVE-2025-47906
datasource_id: collect_go_fix_commits/CVE-2025-47906
datasource_url: https://github.com/golang/go
aliases: []
summary: |
  0f5133b742bf61cda6c98b4cd1d313a330f13f32:[release-branch.go1.24] os/exec: fix incorrect expansion of "", "." and ".." in LookPath

  Fix incorrect expansion of "" and "." when $PATH contains an executable
  file or, on Windows, a parent directory of a %PATH% element contains an
  file with the same name as the %PATH% element but with one of the
  %PATHEXT% extension (ex: C:\utils\bin is in PATH, and C:\utils\bin.exe
  exists).

  Fix incorrect expansion of ".." when $PATH contains an element which is
  an the concatenation of the path to an executable file (or on Windows
  a path that can be expanded to an executable by appending a %PATHEXT%
  extension), a path separator and a name.

  "", "." and ".." are now rejected early with ErrNotFound.

  Fixes CVE-2025-47906
  Fixes #74804

  Change-Id: Ie50cc0a660fce8fbdc952a7f2e05c36062dcb50e
  Reviewed-on: https://go-review.googlesource.com/c/go/+/685755
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit e0b07dc22eaab1b003d98ad6d63cdfacc76c5c70)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/691875
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  8fa31a2d7d9e60c50a3a94080c097b6e65773f4b:[release-branch.go1.23] os/exec: fix incorrect expansion of "", "." and ".." in LookPath

  Fix incorrect expansion of "" and "." when $PATH contains an executable
  file or, on Windows, a parent directory of a %PATH% element contains an
  file with the same name as the %PATH% element but with one of the
  %PATHEXT% extension (ex: C:\utils\bin is in PATH, and C:\utils\bin.exe
  exists).

  Fix incorrect expansion of ".." when $PATH contains an element which is
  an the concatenation of the path to an executable file (or on Windows
  a path that can be expanded to an executable by appending a %PATHEXT%
  extension), a path separator and a name.

  "", "." and ".." are now rejected early with ErrNotFound.

  Fixes CVE-2025-47906
  Fixes #74803

  Change-Id: Ie50cc0a660fce8fbdc952a7f2e05c36062dcb50e
  Reviewed-on: https://go-review.googlesource.com/c/go/+/685755
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit e0b07dc22eaab1b003d98ad6d63cdfacc76c5c70)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/691855
  Reviewed-by: Michael Knyszek <mknyszek@google.com>
  ebee011a54f9310099d02a7e7731330539db16cf:[release-branch.go1.25] os/exec: fix incorrect expansion of "", "." and ".." in LookPath

  Fix incorrect expansion of "" and "." when $PATH contains an executable
  file or, on Windows, a parent directory of a %PATH% element contains an
  file with the same name as the %PATH% element but with one of the
  %PATHEXT% extension (ex: C:\utils\bin is in PATH, and C:\utils\bin.exe
  exists).

  Fix incorrect expansion of ".." when $PATH contains an element which is
  an the concatenation of the path to an executable file (or on Windows
  a path that can be expanded to an executable by appending a %PATHEXT%
  extension), a path separator and a name.

  "", "." and ".." are now rejected early with ErrNotFound.

  Fixes CVE-2025-47906
  Fixes #74466

  Change-Id: Ie50cc0a660fce8fbdc952a7f2e05c36062dcb50e
  Reviewed-on: https://go-review.googlesource.com/c/go/+/685755
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Damien Neil <dneil@google.com>
  (cherry picked from commit e0b07dc22eaab1b003d98ad6d63cdfacc76c5c70)
  Reviewed-on: https://go-review.googlesource.com/c/go/+/691775
  Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
  Auto-Submit: Dmitri Shuralyov <dmitshur@golang.org>
  e0b07dc22eaab1b003d98ad6d63cdfacc76c5c70:os/exec: fix incorrect expansion of "", "." and ".." in LookPath

  Fix incorrect expansion of "" and "." when $PATH contains an executable
  file or, on Windows, a parent directory of a %PATH% element contains an
  file with the same name as the %PATH% element but with one of the
  %PATHEXT% extension (ex: C:\utils\bin is in PATH, and C:\utils\bin.exe
  exists).

  Fix incorrect expansion of ".." when $PATH contains an element which is
  an the concatenation of the path to an executable file (or on Windows
  a path that can be expanded to an executable by appending a %PATHEXT%
  extension), a path separator and a name.

  "", "." and ".." are now rejected early with ErrNotFound.

  Fixes CVE-2025-47906
  Fixes #74466

  Change-Id: Ie50cc0a660fce8fbdc952a7f2e05c36062dcb50e
  Reviewed-on: https://go-review.googlesource.com/c/go/+/685755
  LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
  Auto-Submit: Damien Neil <dneil@google.com>
  Reviewed-by: Roland Shoemaker <roland@golang.org>
  Reviewed-by: Damien Neil <dneil@google.com>
impacted_packages:
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: e0b07dc22eaab1b003d98ad6d63cdfacc76c5c70
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 0f5133b742bf61cda6c98b4cd1d313a330f13f32
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: ebee011a54f9310099d02a7e7731330539db16cf
    introduced_in_commits: []
  - purl: pkg:github/golang/go
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/golang/go
        commit: 8fa31a2d7d9e60c50a3a94080c097b6e65773f4b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/golang/go/tree/0f5133b742bf61cda6c98b4cd1d313a330f13f32
    reference_type: commit
    reference_id: 0f5133b742bf61cda6c98b4cd1d313a330f13f32
  - url: https://github.com/golang/go/tree/8fa31a2d7d9e60c50a3a94080c097b6e65773f4b
    reference_type: commit
    reference_id: 8fa31a2d7d9e60c50a3a94080c097b6e65773f4b
  - url: https://github.com/golang/go/tree/e0b07dc22eaab1b003d98ad6d63cdfacc76c5c70
    reference_type: commit
    reference_id: e0b07dc22eaab1b003d98ad6d63cdfacc76c5c70
  - url: https://github.com/golang/go/tree/ebee011a54f9310099d02a7e7731330539db16cf
    reference_type: commit
    reference_id: ebee011a54f9310099d02a7e7731330539db16cf
