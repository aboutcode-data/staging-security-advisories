advisory_id: CVE-2020-1736
datasource_id: collect_ansible_fix_commits/CVE-2020-1736
datasource_url: https://github.com/ansible/ansible
aliases: []
summary: "9a48ffd61b6ed88abbf793ff195e2a7cf51ffce1:Attempt at reverting CVE-2020-1736 changes\
  \ [2.10] (#71514)\n\n* Revert atomic_move changes\r\n* add note about mode reverts in porting\
  \ guide\r\n\r\nSigned-off-by: Rick Elrod <rick@elrod.me>\n69827e089415a9d3f9e6b538f8ad64fbb2e079ce:Re-add\
  \ changelogs and add docs for CVE-2020-1736 reverts [2.8] (#71516)\n\nSigned-off-by: Rick\
  \ Elrod <rick@elrod.me>\r\nCo-authored-by: Alicia Cozine <879121+acozine@users.noreply.github.com>\r\
  \nCo-authored-by: Sam Doran <sdoran@redhat.com>\n7eec8e4d268d6711f317583974e9e936083de636:Re-add\
  \ changelogs and add docs for CVE-2020-1736 reverts [2.9] (#71515)\n\nSigned-off-by: Rick\
  \ Elrod <rick@elrod.me>\n0199b1cf05e1838bc65ac26d99f2c5505c24ad0f:[stable-2.9] Change default\
  \ file permissions so they are not world readable (#70221) (#70825)\n\n* [stable-2.9] Change\
  \ default file permissions so they are not world readable (#70221)\r\n\r\n* Change default\
  \ file permissions so they are not world readable\r\n\r\nCVE-2020-1736\r\n\r\nSet the default\
  \ permissions for files we create with atomic_move() to 0o0660. Track\r\nwhich files we create\
  \ that did not exist and warn if the module supports 'mode'\r\nand it was not specified and\
  \ the module did not call set_mode_if_different(). This allows the user to take action and\
  \ specify a mode rather than using the defaults.\r\n\r\nA code audit is needed to find all\
  \ instances of modules that call atomic_move()\r\nbut do not call set_mode_if_different().\
  \ The findings need to be documented in\r\na changelog since we are not warning. Warning in\
  \ those instances would be frustrating\r\nto the user since they have no way to change the\
  \ module code.\r\n\r\n- use a set for storing list of created files\r\n- just check the argument\
  \ spac and params rather than using another property\r\n- improve the warning message to include\
  \ the default permissions.\r\n(cherry picked from commit 5260527c4a71bfed99d803e687dd19619423b134)\r\
  \n\r\nCo-authored-by: Sam Doran <sdoran@redhat.com>\r\n\r\n* Fix jboss test\r\n\r\n* Fix lamdba_policy\
  \ test\r\n\r\n* Fix aws_lamdba test\r\n\r\n* Fix warning for new default permissions when\
  \ mode is not specified (#70976)\r\n\r\nFollow up to #70221\r\nRelated to #67794\r\nCVE-2020-1736\r\
  \n\r\nWhen set_mode_if_different() is called with mode of 'None', ensure we issue\r\na warning\
  \ about the change in default permissions.\r\n\r\nAdd integration tests to ensure the warning\
  \ works properly.\r\n\r\n* Fix tests\r\n- actually use custom module \U0001F926‍♂️\r\n- verify\
  \ file permission on created files\r\n- use remote_tmp_dir so we're ready for split controller\r\
  \n- improve test module so we can skip the call to set_fs_attributes_if_different()\r\n- fix\
  \ tests for CentOS 6\r\n\r\n(cherry-picked from commit dc79528cc6)\r\n\r\n* Use new category\
  \ in changelog fragments\n0199b1cf05e1838bc65ac26d99f2c5505c24ad0f:[stable-2.9] Change default\
  \ file permissions so they are not world readable (#70221) (#70825)\n\n* [stable-2.9] Change\
  \ default file permissions so they are not world readable (#70221)\r\n\r\n* Change default\
  \ file permissions so they are not world readable\r\n\r\nCVE-2020-1736\r\n\r\nSet the default\
  \ permissions for files we create with atomic_move() to 0o0660. Track\r\nwhich files we create\
  \ that did not exist and warn if the module supports 'mode'\r\nand it was not specified and\
  \ the module did not call set_mode_if_different(). This allows the user to take action and\
  \ specify a mode rather than using the defaults.\r\n\r\nA code audit is needed to find all\
  \ instances of modules that call atomic_move()\r\nbut do not call set_mode_if_different().\
  \ The findings need to be documented in\r\na changelog since we are not warning. Warning in\
  \ those instances would be frustrating\r\nto the user since they have no way to change the\
  \ module code.\r\n\r\n- use a set for storing list of created files\r\n- just check the argument\
  \ spac and params rather than using another property\r\n- improve the warning message to include\
  \ the default permissions.\r\n(cherry picked from commit 5260527c4a71bfed99d803e687dd19619423b134)\r\
  \n\r\nCo-authored-by: Sam Doran <sdoran@redhat.com>\r\n\r\n* Fix jboss test\r\n\r\n* Fix lamdba_policy\
  \ test\r\n\r\n* Fix aws_lamdba test\r\n\r\n* Fix warning for new default permissions when\
  \ mode is not specified (#70976)\r\n\r\nFollow up to #70221\r\nRelated to #67794\r\nCVE-2020-1736\r\
  \n\r\nWhen set_mode_if_different() is called with mode of 'None', ensure we issue\r\na warning\
  \ about the change in default permissions.\r\n\r\nAdd integration tests to ensure the warning\
  \ works properly.\r\n\r\n* Fix tests\r\n- actually use custom module \U0001F926‍♂️\r\n- verify\
  \ file permission on created files\r\n- use remote_tmp_dir so we're ready for split controller\r\
  \n- improve test module so we can skip the call to set_fs_attributes_if_different()\r\n- fix\
  \ tests for CentOS 6\r\n\r\n(cherry-picked from commit dc79528cc6)\r\n\r\n* Use new category\
  \ in changelog fragments\n11738aed97c9aa2151d971d02655fa8689caf26f:[stable-2.8] Change default\
  \ file permissions so they are not world readable (#70221) (#70827)\n\n* [stable-2.8] Change\
  \ default file permissions so they are not world readable (#70221)\r\n\r\n* Change default\
  \ file permissions so they are not world readable\r\n\r\nCVE-2020-1736\r\n\r\nSet the default\
  \ permissions for files we create with atomic_move() to 0o0660. Track\r\nwhich files we create\
  \ that did not exist and warn if the module supports 'mode'\r\nand it was not specified and\
  \ the module did not call set_mode_if_different(). This allows the user to take action and\
  \ specify a mode rather than using the defaults.\r\n\r\nA code audit is needed to find all\
  \ instances of modules that call atomic_move()\r\nbut do not call set_mode_if_different().\
  \ The findings need to be documented in\r\na changelog since we are not warning. Warning in\
  \ those instances would be frustrating\r\nto the user since they have no way to change the\
  \ module code.\r\n\r\n- use a set for storing list of created files\r\n- just check the argument\
  \ spac and params rather than using another property\r\n- improve the warning message to include\
  \ the default permissions.\r\n(cherry picked from commit 5260527c4a71bfed99d803e687dd19619423b134)\r\
  \n\r\nCo-authored-by: Sam Doran <sdoran@redhat.com>\r\n\r\n* Fix service test\r\n\r\n* Fix\
  \ lamdba_policy test\r\n\r\n* Fix aws_lamdba test\r\n\r\n* Fix warning for new default permissions\
  \ when mode is not specified (#70976)\r\n\r\nFollow up to #70221\r\nRelated to #67794\r\n\
  CVE-2020-1736\r\n\r\nWhen set_mode_if_different() is called with mode of 'None', ensure we\
  \ issue\r\na warning about the change in default permissions.\r\n\r\nAdd integration tests\
  \ to ensure the warning works properly.\r\n\r\n* Fix tests\r\n- actually use custom module\
  \ \U0001F926‍♂️\r\n- verify file permission on created files\r\n- use remote_tmp_dir so we're\
  \ ready for split controller\r\n- improve test module so we can skip the call to set_fs_attributes_if_different()\r\
  \n- fix tests for CentOS 6\r\n\r\n(cherry picked from commit dc79528cc6609ccef41a4e9708973b992851ab31)\r\
  \n\r\n* Use new category in changelog fragments\n11738aed97c9aa2151d971d02655fa8689caf26f:[stable-2.8]\
  \ Change default file permissions so they are not world readable (#70221) (#70827)\n\n* [stable-2.8]\
  \ Change default file permissions so they are not world readable (#70221)\r\n\r\n* Change\
  \ default file permissions so they are not world readable\r\n\r\nCVE-2020-1736\r\n\r\nSet\
  \ the default permissions for files we create with atomic_move() to 0o0660. Track\r\nwhich\
  \ files we create that did not exist and warn if the module supports 'mode'\r\nand it was\
  \ not specified and the module did not call set_mode_if_different(). This allows the user\
  \ to take action and specify a mode rather than using the defaults.\r\n\r\nA code audit is\
  \ needed to find all instances of modules that call atomic_move()\r\nbut do not call set_mode_if_different().\
  \ The findings need to be documented in\r\na changelog since we are not warning. Warning in\
  \ those instances would be frustrating\r\nto the user since they have no way to change the\
  \ module code.\r\n\r\n- use a set for storing list of created files\r\n- just check the argument\
  \ spac and params rather than using another property\r\n- improve the warning message to include\
  \ the default permissions.\r\n(cherry picked from commit 5260527c4a71bfed99d803e687dd19619423b134)\r\
  \n\r\nCo-authored-by: Sam Doran <sdoran@redhat.com>\r\n\r\n* Fix service test\r\n\r\n* Fix\
  \ lamdba_policy test\r\n\r\n* Fix aws_lamdba test\r\n\r\n* Fix warning for new default permissions\
  \ when mode is not specified (#70976)\r\n\r\nFollow up to #70221\r\nRelated to #67794\r\n\
  CVE-2020-1736\r\n\r\nWhen set_mode_if_different() is called with mode of 'None', ensure we\
  \ issue\r\na warning about the change in default permissions.\r\n\r\nAdd integration tests\
  \ to ensure the warning works properly.\r\n\r\n* Fix tests\r\n- actually use custom module\
  \ \U0001F926‍♂️\r\n- verify file permission on created files\r\n- use remote_tmp_dir so we're\
  \ ready for split controller\r\n- improve test module so we can skip the call to set_fs_attributes_if_different()\r\
  \n- fix tests for CentOS 6\r\n\r\n(cherry picked from commit dc79528cc6609ccef41a4e9708973b992851ab31)\r\
  \n\r\n* Use new category in changelog fragments\n5cb96087e6e8270229d6a801287a01398a9d1bf0:Fix\
  \ warning for new default permissions when mode is not specified (#70976) (#70985)\n\nFollow\
  \ up to #70221\r\nRelated to #67794\r\nCVE-2020-1736\r\n\r\nWhen set_mode_if_different() is\
  \ called with mode of 'None', ensure we issue\r\na warning about the change in default permissions.\r\
  \n\r\nAdd integration tests to ensure the warning works properly.\r\n\r\n* Fix tests\r\n-\
  \ actually use custom module \U0001F926‍♂️\r\n- verify file permission on created files\r\n\
  - use remote_tmp_dir so we're ready for split controller\r\n- improve test module so we can\
  \ skip the call to set_fs_attributes_if_different()\r\n- fix tests for CentOS 6\r\n\r\n(cherry\
  \ picked from commit dc79528cc6609ccef41a4e9708973b992851ab31)\ndc79528cc6609ccef41a4e9708973b992851ab31:Fix\
  \ warning for new default permissions when mode is not specified (#70976)\n\nFollow up to\
  \ #70221\r\nRelated to #67794\r\nCVE-2020-1736\r\n\r\nWhen set_mode_if_different() is called\
  \ with mode of 'None', ensure we issue\r\na warning about the change in default permissions.\r\
  \n\r\nAdd integration tests to ensure the warning works properly.\r\n\r\n* Fix tests\r\n-\
  \ actually use custom module \U0001F926‍♂️\r\n- verify file permission on created files\r\n\
  - use remote_tmp_dir so we're ready for split controller\r\n- improve test module so we can\
  \ skip the call to set_fs_attributes_if_different()\r\n- fix tests for CentOS 6\n7e4cffc5d2b6d4b3d412c2361e4a69d9f229dcbd:[stable-2.10]\
  \ Change default file permissions so they are not world readable (#70221) (#70824)\n\n* Change\
  \ default file permissions so they are not world readable\r\n\r\nCVE-2020-1736\r\n\r\nSet\
  \ the default permissions for files we create with atomic_move() to 0o0660. Track\r\nwhich\
  \ files we create that did not exist and warn if the module supports 'mode'\r\nand it was\
  \ not specified and the module did not call set_mode_if_different(). This allows the user\
  \ to take action and specify a mode rather than using the defaults.\r\n\r\nA code audit is\
  \ needed to find all instances of modules that call atomic_move()\r\nbut do not call set_mode_if_different().\
  \ The findings need to be documented in\r\na changelog since we are not warning. Warning in\
  \ those instances would be frustrating\r\nto the user since they have no way to change the\
  \ module code.\r\n\r\n- use a set for storing list of created files\r\n- just check the argument\
  \ spac and params rather than using another property\r\n- improve the warning message to include\
  \ the default permissions.\r\n(cherry picked from commit 5260527c4a71bfed99d803e687dd19619423b134)\r\
  \n\r\nCo-authored-by: Sam Doran <sdoran@redhat.com>\n5260527c4a71bfed99d803e687dd19619423b134:Change\
  \ default file permissions so they are not world readable (#70221)\n\n* Change default file\
  \ permissions so they are not world readable\r\n\r\nCVE-2020-1736\r\n\r\nSet the default permissions\
  \ for files we create with atomic_move() to 0o0660. Track\r\nwhich files we create that did\
  \ not exist and warn if the module supports 'mode'\r\nand it was not specified and the module\
  \ did not call set_mode_if_different(). This allows the user to take action and specify a\
  \ mode rather than using the defaults.\r\n\r\nA code audit is needed to find all instances\
  \ of modules that call atomic_move()\r\nbut do not call set_mode_if_different(). The findings\
  \ need to be documented in\r\na changelog since we are not warning. Warning in those instances\
  \ would be frustrating\r\nto the user since they have no way to change the module code.\r\n\
  \r\n- use a set for storing list of created files\r\n- just check the argument spac and params\
  \ rather than using another property\r\n- improve the warning message to include the default\
  \ permissions\n566f2467f6ca6e0e817ea793ef802116ad469858:stricter permissions on atomic_move\
  \ when creating new file (#68970)\n\nfixes #67794\r\n  updated some tests that expected previous\
  \ defaults\r\n  CVE-2020-1736"
impacted_packages:
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: 566f2467f6ca6e0e817ea793ef802116ad469858
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: 0199b1cf05e1838bc65ac26d99f2c5505c24ad0f
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: 5260527c4a71bfed99d803e687dd19619423b134
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: dc79528cc6609ccef41a4e9708973b992851ab31
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: 7eec8e4d268d6711f317583974e9e936083de636
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: 9a48ffd61b6ed88abbf793ff195e2a7cf51ffce1
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: 5cb96087e6e8270229d6a801287a01398a9d1bf0
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: 69827e089415a9d3f9e6b538f8ad64fbb2e079ce
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: 11738aed97c9aa2151d971d02655fa8689caf26f
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: 7e4cffc5d2b6d4b3d412c2361e4a69d9f229dcbd
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/ansible/ansible/tree/0199b1cf05e1838bc65ac26d99f2c5505c24ad0f
    reference_type: commit
    reference_id: 0199b1cf05e1838bc65ac26d99f2c5505c24ad0f
  - url: https://github.com/ansible/ansible/tree/11738aed97c9aa2151d971d02655fa8689caf26f
    reference_type: commit
    reference_id: 11738aed97c9aa2151d971d02655fa8689caf26f
  - url: https://github.com/ansible/ansible/tree/5260527c4a71bfed99d803e687dd19619423b134
    reference_type: commit
    reference_id: 5260527c4a71bfed99d803e687dd19619423b134
  - url: https://github.com/ansible/ansible/tree/566f2467f6ca6e0e817ea793ef802116ad469858
    reference_type: commit
    reference_id: 566f2467f6ca6e0e817ea793ef802116ad469858
  - url: https://github.com/ansible/ansible/tree/5cb96087e6e8270229d6a801287a01398a9d1bf0
    reference_type: commit
    reference_id: 5cb96087e6e8270229d6a801287a01398a9d1bf0
  - url: https://github.com/ansible/ansible/tree/69827e089415a9d3f9e6b538f8ad64fbb2e079ce
    reference_type: commit
    reference_id: 69827e089415a9d3f9e6b538f8ad64fbb2e079ce
  - url: https://github.com/ansible/ansible/tree/7e4cffc5d2b6d4b3d412c2361e4a69d9f229dcbd
    reference_type: commit
    reference_id: 7e4cffc5d2b6d4b3d412c2361e4a69d9f229dcbd
  - url: https://github.com/ansible/ansible/tree/7eec8e4d268d6711f317583974e9e936083de636
    reference_type: commit
    reference_id: 7eec8e4d268d6711f317583974e9e936083de636
  - url: https://github.com/ansible/ansible/tree/9a48ffd61b6ed88abbf793ff195e2a7cf51ffce1
    reference_type: commit
    reference_id: 9a48ffd61b6ed88abbf793ff195e2a7cf51ffce1
  - url: https://github.com/ansible/ansible/tree/dc79528cc6609ccef41a4e9708973b992851ab31
    reference_type: commit
    reference_id: dc79528cc6609ccef41a4e9708973b992851ab31
