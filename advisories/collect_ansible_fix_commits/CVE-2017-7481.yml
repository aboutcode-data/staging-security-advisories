advisory_id: CVE-2017-7481
datasource_id: collect_ansible_fix_commits/CVE-2017-7481
datasource_url: https://github.com/ansible/ansible
aliases: []
summary: |
  fd30f5328986f9e1da434474481f32bf918a600c:Fixing security issue with lookup returns not tainting the jinja2 environment

  CVE-2017-7481

  Lookup returns wrap the result in unsafe, however when used through the
  standard templar engine, this does not result in the jinja2 environment being
  marked as unsafe as a whole. This means the lookup result looses the unsafe
  protection and may become simple unicode strings, which can result in bad
  things being re-templated.

  This also adds a global lookup param and cfg options for lookups to allow
  unsafe returns, so users can force the previous (insecure) behavior.

  (cherry picked from commit 72dfb1570d22ac519350a8c09e76c458789120ed)
  (cherry picked from commit fadccda7c7a2e8d0650f4dee8e3cea93cf17acfd)
  f0e348f5eeb70c1fb3127d90891da43b5c0a9d29:Fixing security issue with lookup returns not tainting the jinja2 environment

  CVE-2017-7481

  Lookup returns wrap the result in unsafe, however when used through the
  standard templar engine, this does not result in the jinja2 environment being
  marked as unsafe as a whole. This means the lookup result looses the unsafe
  protection and may become simple unicode strings, which can result in bad
  things being re-templated.

  This also adds a global lookup param and cfg options for lookups to allow
  unsafe returns, so users can force the previous (insecure) behavior.

  (cherry picked from commit 72dfb1570d22ac519350a8c09e76c458789120ed)
  ed56f51f185a1ffd7ea57130d260098686fcc7c2:Fixing security issue with lookup returns not tainting the jinja2 environment

  CVE-2017-7481

  Lookup returns wrap the result in unsafe, however when used through the
  standard templar engine, this does not result in the jinja2 environment being
  marked as unsafe as a whole. This means the lookup result looses the unsafe
  protection and may become simple unicode strings, which can result in bad
  things being re-templated.

  This also adds a global lookup param and cfg options for lookups to allow
  unsafe returns, so users can force the previous (insecure) behavior.
  a1886911fcf4b691130cfc70dfc5daa5e07c46a3:Fixing security issue with lookup returns not tainting the jinja2 environment

  CVE-2017-7481

  Lookup returns wrap the result in unsafe, however when used through the
  standard templar engine, this does not result in the jinja2 environment being
  marked as unsafe as a whole. This means the lookup result looses the unsafe
  protection and may become simple unicode strings, which can result in bad
  things being re-templated.

  This also adds a global lookup param and cfg options for lookups to allow
  unsafe returns, so users can force the previous (insecure) behavior.

  (cherry picked from commit 72dfb1570d22ac519350a8c09e76c458789120ed)
impacted_packages:
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: f0e348f5eeb70c1fb3127d90891da43b5c0a9d29
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: a1886911fcf4b691130cfc70dfc5daa5e07c46a3
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: fd30f5328986f9e1da434474481f32bf918a600c
    introduced_in_commits: []
  - purl: pkg:github/ansible/ansible
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/ansible/ansible
        commit: ed56f51f185a1ffd7ea57130d260098686fcc7c2
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/ansible/ansible/tree/a1886911fcf4b691130cfc70dfc5daa5e07c46a3
    reference_type: commit
    reference_id: a1886911fcf4b691130cfc70dfc5daa5e07c46a3
  - url: https://github.com/ansible/ansible/tree/ed56f51f185a1ffd7ea57130d260098686fcc7c2
    reference_type: commit
    reference_id: ed56f51f185a1ffd7ea57130d260098686fcc7c2
  - url: https://github.com/ansible/ansible/tree/f0e348f5eeb70c1fb3127d90891da43b5c0a9d29
    reference_type: commit
    reference_id: f0e348f5eeb70c1fb3127d90891da43b5c0a9d29
  - url: https://github.com/ansible/ansible/tree/fd30f5328986f9e1da434474481f32bf918a600c
    reference_type: commit
    reference_id: fd30f5328986f9e1da434474481f32bf918a600c
