advisory_id: UBUNTU-CVE-2022-24828
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-24828
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24828.json
aliases:
  - CVE-2022-24828
summary: Composer is a dependency manager for the PHP programming language. Integrators using
  Composer code to call `VcsDriver::getFileContent` can have a code injection vulnerability
  if the user can control the `$file` or `$identifier` argument. This leads to a vulnerability
  on packagist.org for example where the composer.json's `readme` field can be used as a vector
  for injecting parameters into hg/Mercurial via the `$file` argument, or git via the `$identifier`
  argument if you allow arbitrary data there (Packagist does not, but maybe other integrators
  do). Composer itself should not be affected by the vulnerability as it does not call `getFileContent`
  with arbitrary data into `$file`/`$identifier`. To the best of our knowledge this was not
  abused, and the vulnerability has been patched on packagist.org and Private Packagist within
  a day of the vulnerability report.
impacted_packages:
  - purl: pkg:deb/ubuntu/composer?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.0.0~alpha10+20150602-1|1.0.0~alpha10+20150602-2|1.0.0~alpha11-1|1.0.0~alpha11-1ubuntu1|1.0.0~alpha11-2|1.0.0~alpha11-3|1.0.0~beta1-1ubuntu1|1.0.0~beta2-1|1.0.0~beta2-1ubuntu0.1~esm1
    fixed_versions: vers:deb/1.0.0~beta2-1ubuntu0.1~esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/composer?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.5.1-1|1.5.2-1|1.6.2-1|1.6.3-1|1.6.3-1ubuntu0.1~esm1
    fixed_versions: vers:deb/1.6.3-1ubuntu0.1~esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/composer?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/1.9.0-2|1.9.1-1|1.9.2-1|1.9.3-1|1.10.0-1|1.10.1-1|1.10.1-1ubuntu0.1~esm1
    fixed_versions: vers:deb/1.10.1-1ubuntu0.1~esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/composer?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/2.0.9-2ubuntu2|2.0.9-2ubuntu3|2.0.13-1ubuntu1|2.1.12-1ubuntu1|2.2.6-2ubuntu4
    fixed_versions: vers:deb/2.2.6-2ubuntu4+esm1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24828.json
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24828.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24828.json
weaknesses: []
references:
  - url: https://github.com/composer/composer/commit/2c40c53637c5c7e43fff7c09d3d324d632734709
    reference_type:
    reference_id:
  - url: https://github.com/composer/composer/security/advisories/GHSA-x7cr-6qr6-2hh6
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-24828
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7603-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-24828
    reference_type:
    reference_id:
