advisory_id: UBUNTU-CVE-2025-64345
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-64345
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-64345.json
aliases:
  - CVE-2025-64345
summary: 'Wasmtime is a runtime for WebAssembly. Prior to version 38.0.4, 37.0.3, 36.0.3, and
  24.0.5, Wasmtime''s Rust embedder API contains an unsound interaction where a WebAssembly
  shared linear memory could be viewed as a type which provides safe access to the host (Rust)
  to the contents of the linear memory. This is not sound for shared linear memories, which
  could be modified in parallel, and this could lead to a data race in the host. Patch releases
  have been issued for all supported versions of Wasmtime, notably: 24.0.5, 36.0.3, 37.0.3,
  and 38.0.4. These releases reject creation of shared memories via `Memory::new` and shared
  memories are now excluded from core dumps. As a workaround, eembeddings affected by this issue
  should use `SharedMemory::new` instead of `Memory::new` to create shared memories. Affected
  embeddings should also disable core dumps if they are unable to upgrade. Note that core dumps
  are disabled by default but the wasm threads proposal (and shared memory) is enabled by default.'
impacted_packages:
  - purl: pkg:deb/ubuntu/rust-wasmtime?arch=source&distro=noble
    affected_versions: vers:deb/10.0.1+dfsg-7|15.0.1+dfsg-4|16.0.0+dfsg-2|16.0.0+dfsg-3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/rust-wasmtime?arch=source&distro=questing
    affected_versions: vers:deb/26.0.1+dfsg-3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '1.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-64345.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-64345.json
weaknesses: []
references:
  - url: https://docs.rs/wasmtime/latest/wasmtime/struct.Memory.html#method.new
    reference_type:
    reference_id:
  - url: https://docs.rs/wasmtime/latest/wasmtime/struct.SharedMemory.html#method.new
    reference_type:
    reference_id:
  - url: https://docs.wasmtime.dev/stability-release.html
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime/commit/9ebb6934f00d58b92fb68ed0e0b16c0ae828ca10
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime/releases/tag/v38.0.4
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-hc7m-r6v8-hg9q
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-64345
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-64345
    reference_type:
    reference_id:
