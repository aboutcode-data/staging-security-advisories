advisory_id: UBUNTU-CVE-2021-32718
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-32718
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32718.json
aliases:
  - CVE-2021-32718
summary: RabbitMQ is a multi-protocol messaging broker. In rabbitmq-server prior to version
  3.8.17, a new user being added via management UI could lead to the user's bane being rendered
  in a confirmation message without proper `<script>` tag sanitization, potentially allowing
  for JavaScript code execution in the context of the page. In order for this to occur, the
  user must be signed in and have elevated permissions (other user management). The vulnerability
  is patched in RabbitMQ 3.8.17. As a workaround, disable `rabbitmq_management` plugin and use
  CLI tools for management operations and Prometheus and Grafana for metrics and monitoring.
impacted_packages:
  - purl: pkg:deb/ubuntu/rabbitmq-server?arch=source&distro=focal
    affected_versions: vers:deb/3.7.8-4ubuntu2|3.7.18-1|3.8.2-0ubuntu1|3.8.2-0ubuntu1.1|3.8.2-0ubuntu1.2|3.8.2-0ubuntu1.3|3.8.2-0ubuntu1.4|3.8.2-0ubuntu1.5|3.8.3-0ubuntu0.1
    fixed_versions: vers:deb/3.8.3-0ubuntu0.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32718.json
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32718.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32718.json
weaknesses: []
references:
  - url: https://github.com/rabbitmq/rabbitmq-server/pull/3028
    reference_type:
    reference_id:
  - url: https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-c3hj-rg5h-2772
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-32718
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7143-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-32718
    reference_type:
    reference_id:
