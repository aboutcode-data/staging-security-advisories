advisory_id: UBUNTU-CVE-2023-45803
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-45803
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-45803.json
aliases:
  - CVE-2023-45803
summary: 'urllib3 is a user-friendly HTTP client library for Python. urllib3 previously wouldn''t
  remove the HTTP request body when an HTTP redirect response using status 301, 302, or 303
  after the request had its method changed from one that could accept a request body (like `POST`)
  to `GET` as is required by HTTP RFCs. Although this behavior is not specified in the section
  for redirects, it can be inferred by piecing together information from different sections
  and we have observed the behavior in other major HTTP client implementations like curl and
  web browsers. Because the vulnerability requires a previously trusted service to become compromised
  in order to have an impact on confidentiality we believe the exploitability of this vulnerability
  is low. Additionally, many users aren''t putting sensitive data in HTTP request bodies, if
  this is the case then this vulnerability isn''t exploitable. Both of the following conditions
  must be true to be affected by this vulnerability: 1. Using urllib3 and submitting sensitive
  information in the HTTP request body (such as form data or JSON) and 2. The origin service
  is compromised and starts redirecting using 301, 302, or 303 to a malicious peer or the redirected-to
  service becomes compromised. This issue has been addressed in versions 1.26.18 and 2.0.7 and
  users are advised to update to resolve this issue. Users unable to update should disable redirects
  for services that aren''t expecting to respond with redirects with `redirects=False` and disable
  automatic redirects with `redirects=False` and handle 301, 302, and 303 redirects manually
  by stripping the HTTP request body.'
impacted_packages:
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/1.4.1-2|1.5.4-1|1.5.4-1ubuntu1|1.5.4-1ubuntu3|1.5.4-1ubuntu4|1.5.4-1ubuntu4+esm1|1.5.4-1ubuntu4+esm2|1.5.4-1ubuntu4+esm3|1.5.4-1ubuntu4+esm4|1.5.4-1ubuntu4+esm5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/1.6-2|1.7.1-1|1.7.1-1build1|1.7.1-1ubuntu0.1|1.7.1-1ubuntu3|1.7.1-1ubuntu4|1.7.1-1ubuntu4.1|1.7.1-1ubuntu4.1+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/1.11-1|1.12-1|1.13.1-1|1.13.1-2|1.13.1-2ubuntu0.16.04.1|1.13.1-2ubuntu0.16.04.2|1.13.1-2ubuntu0.16.04.3|1.13.1-2ubuntu0.16.04.4
    fixed_versions: vers:deb/1.13.1-2ubuntu0.16.04.4+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.5.6-7ubuntu1|1.5.6-7ubuntu2|8.0.2-7|8.0.3-1|8.0.3-2|8.1.0-1|8.1.0-2|8.1.1-1|8.1.1-2|8.1.1-2ubuntu0.1|8.1.1-2ubuntu0.2|8.1.1-2ubuntu0.4|8.1.1-2ubuntu0.6|8.1.1-2ubuntu0.6+esm2|8.1.1-2ubuntu0.6+esm3|8.1.1-2ubuntu0.6+esm4|8.1.1-2ubuntu0.6+esm5
    fixed_versions: vers:deb/8.1.1-2ubuntu0.6+esm6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=esm-infra/bionic
    affected_versions: vers:deb/1.21.1-1|1.22-1|1.22-1ubuntu0.18.04.1|1.22-1ubuntu0.18.04.2
    fixed_versions: vers:deb/1.22-1ubuntu0.18.04.2+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/9.0.1-2|9.0.1-2.3~ubuntu1|9.0.1-2.3~ubuntu1.18.04.1|9.0.1-2.3~ubuntu1.18.04.2|9.0.1-2.3~ubuntu1.18.04.3|9.0.1-2.3~ubuntu1.18.04.4|9.0.1-2.3~ubuntu1.18.04.5|9.0.1-2.3~ubuntu1.18.04.5+esm2|9.0.1-2.3~ubuntu1.18.04.5+esm3|9.0.1-2.3~ubuntu1.18.04.6|9.0.1-2.3~ubuntu1.18.04.6+esm1|9.0.1-2.3~ubuntu1.18.04.7|9.0.1-2.3~ubuntu1.18.04.7+esm1|9.0.1-2.3~ubuntu1.18.04.8|9.0.1-2.3~ubuntu1.18.04.8+esm1
    fixed_versions: vers:deb/9.0.1-2.3~ubuntu1.18.04.8+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=focal
    affected_versions: vers:deb/18.1-5|18.1-5build1|18.1-5ubuntu1|20.0.2-2|20.0.2-4|20.0.2-5|20.0.2-5ubuntu1|20.0.2-5ubuntu1.1|20.0.2-5ubuntu1.3|20.0.2-5ubuntu1.4|20.0.2-5ubuntu1.5|20.0.2-5ubuntu1.6|20.0.2-5ubuntu1.7|20.0.2-5ubuntu1.8|20.0.2-5ubuntu1.9
    fixed_versions: vers:deb/20.0.2-5ubuntu1.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=focal
    affected_versions: vers:deb/1.24.1-1ubuntu1|1.24.1-1ubuntu2|1.25.8-1|1.25.8-2|1.25.8-2ubuntu0.1|1.25.8-2ubuntu0.2
    fixed_versions: vers:deb/1.25.8-2ubuntu0.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=jammy
    affected_versions: vers:deb/20.3.4-4|21.3.1+dfsg-3|22.0.2+dfsg-1|22.0.2+dfsg-1ubuntu0.1|22.0.2+dfsg-1ubuntu0.2|22.0.2+dfsg-1ubuntu0.3
    fixed_versions: vers:deb/22.0.2+dfsg-1ubuntu0.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=jammy
    affected_versions: vers:deb/1.26.5-1~exp1
    fixed_versions: vers:deb/1.26.5-1~exp1ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=noble
    affected_versions: vers:deb/23.2+dfsg-1|23.3+dfsg-1|24.0+dfsg-1|24.0+dfsg-1ubuntu1|24.0+dfsg-1ubuntu1.1|24.0+dfsg-1ubuntu1.2
    fixed_versions: vers:deb/24.0+dfsg-1ubuntu1.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-45803.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-45803.json
weaknesses: []
references:
  - url: https://github.com/urllib3/urllib3/commit/4e98d57809dacab1cbe625fddeec1a290c478ea9
    reference_type:
    reference_id:
  - url: https://github.com/urllib3/urllib3/security/advisories/GHSA-g4mx-q9vg-27p4
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-45803
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6473-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6473-2
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7762-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-45803
    reference_type:
    reference_id:
  - url: https://www.rfc-editor.org/rfc/rfc9110.html#name-get
    reference_type:
    reference_id:
