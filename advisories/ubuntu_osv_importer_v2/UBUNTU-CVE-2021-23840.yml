advisory_id: UBUNTU-CVE-2021-23840
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-23840
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-23840.json
aliases:
  - CVE-2021-23840
summary: Calls to EVP_CipherUpdate, EVP_EncryptUpdate and EVP_DecryptUpdate may overflow the
  output length argument in some cases where the input length is close to the maximum permissable
  length for an integer on the platform. In such cases the return value from the function call
  will be 1 (indicating success), but the output length value will be negative. This could cause
  applications to behave incorrectly or crash. OpenSSL versions 1.1.1i and below are affected
  by this issue. Users of these versions should upgrade to OpenSSL 1.1.1j. OpenSSL versions
  1.0.2x and below are affected by this issue. However OpenSSL 1.0.2 is out of support and no
  longer receiving public updates. Premium support customers of OpenSSL 1.0.2 should upgrade
  to 1.0.2y. Other users should upgrade to 1.1.1j. Fixed in OpenSSL 1.1.1j (Affected 1.1.1-1.1.1i).
  Fixed in OpenSSL 1.0.2y (Affected 1.0.2-1.0.2x).
impacted_packages:
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=trusty/esm
    affected_versions: vers:deb/1.0.1e-3ubuntu1|1.0.1e-4ubuntu1|1.0.1e-4ubuntu2|1.0.1e-4ubuntu3|1.0.1e-4ubuntu4|1.0.1f-1ubuntu1|1.0.1f-1ubuntu2|1.0.1f-1ubuntu2.1|1.0.1f-1ubuntu2.2|1.0.1f-1ubuntu2.3|1.0.1f-1ubuntu2.4|1.0.1f-1ubuntu2.5|1.0.1f-1ubuntu2.7|1.0.1f-1ubuntu2.8|1.0.1f-1ubuntu2.11|1.0.1f-1ubuntu2.12|1.0.1f-1ubuntu2.15|1.0.1f-1ubuntu2.16|1.0.1f-1ubuntu2.17|1.0.1f-1ubuntu2.18|1.0.1f-1ubuntu2.19|1.0.1f-1ubuntu2.20|1.0.1f-1ubuntu2.21|1.0.1f-1ubuntu2.22|1.0.1f-1ubuntu2.23|1.0.1f-1ubuntu2.24|1.0.1f-1ubuntu2.25|1.0.1f-1ubuntu2.26|1.0.1f-1ubuntu2.27|1.0.1f-1ubuntu2.27+esm1|1.0.1f-1ubuntu2.27+esm2|1.0.1f-1ubuntu2.27+esm3|1.0.1f-1ubuntu2.27+esm4|1.0.1f-1ubuntu2.27+esm5|1.0.1f-1ubuntu2.27+esm6|1.0.1f-1ubuntu2.27+esm7|1.0.1f-1ubuntu2.27+esm9
    fixed_versions: vers:deb/1.0.1f-1ubuntu2.27+esm10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=xenial
    affected_versions: vers:deb/1.0.2d-0ubuntu1|1.0.2d-0ubuntu2|1.0.2e-1ubuntu1|1.0.2f-2ubuntu1|1.0.2g-1ubuntu2|1.0.2g-1ubuntu3|1.0.2g-1ubuntu4|1.0.2g-1ubuntu4.1|1.0.2g-1ubuntu4.2|1.0.2g-1ubuntu4.4|1.0.2g-1ubuntu4.5|1.0.2g-1ubuntu4.6|1.0.2g-1ubuntu4.8|1.0.2g-1ubuntu4.9|1.0.2g-1ubuntu4.10|1.0.2g-1ubuntu4.11|1.0.2g-1ubuntu4.12|1.0.2g-1ubuntu4.13|1.0.2g-1ubuntu4.14|1.0.2g-1ubuntu4.15|1.0.2g-1ubuntu4.16|1.0.2g-1ubuntu4.17|1.0.2g-1ubuntu4.18
    fixed_versions: vers:deb/1.0.2g-1ubuntu4.19
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/edk2?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/0~20150106.5c2d456b-2|0~20160104.c2a892d7-1|0~20160408.ffea0a2c-2|0~20160408.ffea0a2c-2ubuntu0.1|0~20160408.ffea0a2c-2ubuntu0.2|0~20160408.ffea0a2c-2ubuntu0.2+esm1|0~20160408.ffea0a2c-2ubuntu0.2+esm3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=fips-updates/xenial
    affected_versions: vers:deb/1.0.2g-1ubuntu4.fips.4.9.1|1.0.2g-1ubuntu4.fips.4.13.1|1.0.2g-1ubuntu4.fips.4.15.1|1.0.2g-1ubuntu4.fips.4.16.1|1.0.2g-1ubuntu4.fips.4.17.1|1.0.2g-1ubuntu4.fips.4.18.1
    fixed_versions: vers:deb/1.0.2g-1ubuntu4.fips.4.19.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=fips/xenial
    affected_versions: vers:deb/1.0.2g-1ubuntu4.fips.4.6~ppa1|1.0.2g-1ubuntu4.fips.4.6~ppa2|1.0.2g-1ubuntu4.fips.4.6~ppa3|1.0.2g-1ubuntu4.fips.4.6|1.0.2g-1ubuntu4.fips.4.6.1|1.0.2g-1ubuntu4.fips.4.6.2|1.0.2g-1ubuntu4.fips.4.6.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=bionic
    affected_versions: vers:deb/1.0.2g-1ubuntu13|1.0.2g-1ubuntu14|1.0.2n-1ubuntu1|1.1.0g-2ubuntu1|1.1.0g-2ubuntu2|1.1.0g-2ubuntu3|1.1.0g-2ubuntu4|1.1.0g-2ubuntu4.1|1.1.0g-2ubuntu4.3|1.1.1-1ubuntu2.1~18.04.1|1.1.1-1ubuntu2.1~18.04.2|1.1.1-1ubuntu2.1~18.04.3|1.1.1-1ubuntu2.1~18.04.4|1.1.1-1ubuntu2.1~18.04.5|1.1.1-1ubuntu2.1~18.04.6|1.1.1-1ubuntu2.1~18.04.7
    fixed_versions: vers:deb/1.1.1-1ubuntu2.1~18.04.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl1.0?arch=source&distro=bionic
    affected_versions: vers:deb/1.0.2n-1ubuntu2|1.0.2n-1ubuntu3|1.0.2n-1ubuntu4|1.0.2n-1ubuntu5|1.0.2n-1ubuntu5.1|1.0.2n-1ubuntu5.2|1.0.2n-1ubuntu5.3|1.0.2n-1ubuntu5.4|1.0.2n-1ubuntu5.5
    fixed_versions: vers:deb/1.0.2n-1ubuntu5.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/edk2?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/0~20170911.5dfba97c-1|0~20171010.234dbcef-1|0~20171027.76fd5a66-1|0~20171205.a9212288-1|0~20180105.0bc94c74-1|0~20180205.c0d9813c-1|0~20180205.c0d9813c-2|0~20180205.c0d9813c-2ubuntu0.1|0~20180205.c0d9813c-2ubuntu0.2|0~20180205.c0d9813c-2ubuntu0.3|0~20180205.c0d9813c-2ubuntu0.3+esm1|0~20180205.c0d9813c-2ubuntu0.3+esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=fips-updates/bionic
    affected_versions: vers:deb/1.1.1-1ubuntu2.fips.2.1~18.04.5.1|1.1.1-1ubuntu2.fips.2.1~18.04.6.1|1.1.1-1ubuntu2.fips.2.1~18.04.7.1
    fixed_versions: vers:deb/1.1.1-1ubuntu2.fips.2.1~18.04.9.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=fips/bionic
    affected_versions: vers:deb/1.1.1-1ubuntu2.fips.2.1~18.04.3.1|1.1.1-1ubuntu2.fips.2.1~18.04.15.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/edk2?arch=source&distro=focal
    affected_versions: vers:deb/0~20190606.20d2e5a1-2ubuntu1|0~20190828.37eef910-3|0~20190828.37eef910-4|0~20191122.bd85bf54-1|0~20191122.bd85bf54-1ubuntu1|0~20191122.bd85bf54-2|0~20191122.bd85bf54-2ubuntu1|0~20191122.bd85bf54-2ubuntu2|0~20191122.bd85bf54-2ubuntu3|0~20191122.bd85bf54-2ubuntu3.1|0~20191122.bd85bf54-2ubuntu3.2
    fixed_versions: vers:deb/0~20191122.bd85bf54-2ubuntu3.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=focal
    affected_versions: vers:deb/1.1.1c-1ubuntu4|1.1.1d-2ubuntu3|1.1.1d-2ubuntu6|1.1.1f-1ubuntu1|1.1.1f-1ubuntu2|1.1.1f-1ubuntu2.1
    fixed_versions: vers:deb/1.1.1f-1ubuntu2.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=fips-updates/focal
    affected_versions: vers:deb/1.1.1f-1ubuntu2.fips.7
    fixed_versions: vers:deb/1.1.1f-1ubuntu2.fips.7.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=fips/focal
    affected_versions: vers:deb/<1.1.1f-1ubuntu2.fips.2.8
    fixed_versions: vers:deb/1.1.1f-1ubuntu2.fips.2.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/nodejs?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/12.22.5~dfsg-5ubuntu1|12.22.7~dfsg-2ubuntu1|12.22.7~dfsg-2ubuntu3|12.22.9~dfsg-1ubuntu2|12.22.9~dfsg-1ubuntu3|12.22.9~dfsg-1ubuntu3.1|12.22.9~dfsg-1ubuntu3.2|12.22.9~dfsg-1ubuntu3.3|12.22.9~dfsg-1ubuntu3.4|12.22.9~dfsg-1ubuntu3.5|12.22.9~dfsg-1ubuntu3.6|12.22.9~dfsg-1ubuntu3.6+esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-23840.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-23840.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2021-23840
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4738-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5088-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7018-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-23840
    reference_type:
    reference_id:
  - url: https://www.openssl.org/news/secadv/20210216.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
