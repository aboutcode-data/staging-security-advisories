advisory_id: UBUNTU-CVE-2021-32761
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-32761
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32761.json
aliases:
  - CVE-2021-32761
summary: Redis is an in-memory database that persists on disk. A vulnerability involving out-of-bounds
  read and integer overflow to buffer overflow exists starting with version 2.2 and prior to
  versions 5.0.13, 6.0.15, and 6.2.5. On 32-bit systems, Redis `*BIT*` command are vulnerable
  to integer overflow that can potentially be exploited to corrupt the heap, leak arbitrary
  heap contents or trigger remote code execution. The vulnerability involves changing the default
  `proto-max-bulk-len` configuration parameter to a very large value and constructing specially
  crafted commands bit commands. This problem only affects Redis on 32-bit platforms, or compiled
  as a 32-bit binary. Redis versions 5.0.`3m 6.0.15, and 6.2.5 contain patches for this issue.
  An additional workaround to mitigate the problem without patching the `redis-server` executable
  is to prevent users from modifying the `proto-max-bulk-len` configuration parameter. This
  can be done using ACL to restrict unprivileged users from using the CONFIG SET command.
impacted_packages:
  - purl: pkg:deb/ubuntu/redis?arch=source&distro=trusty/esm
    affected_versions: vers:deb/2:2.6.13-1|2:2.6.16-3|2:2.8.0-1|2:2.8.2-1|2:2.8.4-2|2:2.8.4-2ubuntu0.2|2:2.8.4-2ubuntu0.2+esm1
    fixed_versions: vers:deb/2:2.8.4-2ubuntu0.2+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/redis?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/2:3.0.3-3|2:3.0.5-1|2:3.0.5-2|2:3.0.5-3|2:3.0.5-4|2:3.0.6-1|2:3.0.6-1ubuntu0.2|2:3.0.6-1ubuntu0.3|2:3.0.6-1ubuntu0.4
    fixed_versions: vers:deb/2:3.0.6-1ubuntu0.4+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/redis?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/4:4.0.1-7|4:4.0.2-6|4:4.0.2-9|5:4.0.5-1|5:4.0.6-1|5:4.0.6-2|5:4.0.7-1|5:4.0.8-1|5:4.0.8-2|5:4.0.9-1|5:4.0.9-1ubuntu0.1|5:4.0.9-1ubuntu0.2|5:4.0.9-1ubuntu0.2+esm2
    fixed_versions: vers:deb/5:4.0.9-1ubuntu0.2+esm3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32761.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32761.json
weaknesses: []
references:
  - url: https://github.com/redis/redis/security/advisories/GHSA-8wxq-j7rp-g8wj
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-32761
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5221-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-32761
    reference_type:
    reference_id:
