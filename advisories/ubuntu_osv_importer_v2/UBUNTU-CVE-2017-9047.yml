advisory_id: UBUNTU-CVE-2017-9047
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2017-9047
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-9047.json
aliases:
  - CVE-2017-9047
summary: A buffer overflow was discovered in libxml2 20904-GITv2.9.4-16-g0741801. The function
  xmlSnprintfElementContent in valid.c is supposed to recursively dump the element content definition
  into a char buffer 'buf' of size 'size'. The variable len is assigned strlen(buf). If the
  content->type is XML_ELEMENT_CONTENT_ELEMENT, then (i) the content->prefix is appended to
  buf (if it actually fits) whereupon (ii) content->name is written to the buffer. However,
  the check for whether the content->name actually fits also uses 'len' rather than the updated
  buffer length strlen(buf). This allows us to write about "size" many bytes beyond the allocated
  memory. This vulnerability causes programs that use libxml2, such as PHP, to crash.
impacted_packages:
  - purl: pkg:deb/ubuntu/libxml2?arch=source&distro=trusty
    affected_versions: vers:deb/2.9.1+dfsg1-3ubuntu2|2.9.1+dfsg1-3ubuntu3|2.9.1+dfsg1-3ubuntu4|2.9.1+dfsg1-3ubuntu4.1|2.9.1+dfsg1-3ubuntu4.2|2.9.1+dfsg1-3ubuntu4.3|2.9.1+dfsg1-3ubuntu4.4|2.9.1+dfsg1-3ubuntu4.5|2.9.1+dfsg1-3ubuntu4.6|2.9.1+dfsg1-3ubuntu4.7|2.9.1+dfsg1-3ubuntu4.8|2.9.1+dfsg1-3ubuntu4.9
    fixed_versions: vers:deb/2.9.1+dfsg1-3ubuntu4.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libxml2?arch=source&distro=xenial
    affected_versions: vers:deb/2.9.2+zdfsg1-4|2.9.2+zdfsg1-4ubuntu1|2.9.2+zdfsg1-4ubuntu2|2.9.2+zdfsg1-4ubuntu3|2.9.3+dfsg1-1|2.9.3+dfsg1-1ubuntu0.1|2.9.3+dfsg1-1ubuntu0.2
    fixed_versions: vers:deb/2.9.3+dfsg1-1ubuntu0.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-9047.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-9047.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2017-9047
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3424-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3424-2
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2017-9047
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2017/05/15/1
    reference_type:
    reference_id:
