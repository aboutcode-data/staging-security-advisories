advisory_id: UBUNTU-CVE-2021-4044
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-4044
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-4044.json
aliases:
  - CVE-2021-4044
summary: Internally libssl in OpenSSL calls X509_verify_cert() on the client side to verify
  a certificate supplied by a server. That function may return a negative return value to indicate
  an internal error (for example out of memory). Such a negative return value is mishandled
  by OpenSSL and will cause an IO function (such as SSL_connect() or SSL_do_handshake()) to
  not indicate success and a subsequent call to SSL_get_error() to return the value SSL_ERROR_WANT_RETRY_VERIFY.
  This return value is only supposed to be returned by OpenSSL if the application has previously
  called SSL_CTX_set_cert_verify_callback(). Since most applications do not do this the SSL_ERROR_WANT_RETRY_VERIFY
  return value from SSL_get_error() will be totally unexpected and applications may not behave
  correctly as a result. The exact behaviour will depend on the application but it could result
  in crashes, infinite loops or other similar incorrect responses. This issue is made more serious
  in combination with a separate bug in OpenSSL 3.0 that will cause X509_verify_cert() to indicate
  an internal error when processing a certificate chain. This will occur where a certificate
  does not include the Subject Alternative Name extension but where a Certificate Authority
  has enforced name constraints. This issue can occur even with valid chains. By combining the
  two issues an attacker could induce incorrect, application dependent behaviour. Fixed in OpenSSL
  3.0.1 (Affected 3.0.0).
impacted_packages:
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=jammy
    affected_versions: vers:deb/1.1.1l-1ubuntu1|3.0.0-1ubuntu1
    fixed_versions: vers:deb/3.0.1-0ubuntu1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-4044.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-4044.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2021-4044
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-4044
    reference_type:
    reference_id:
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=758754966791c537ea95241438454aa86f91f256
    reference_type: commit
    reference_id: 3.0.1 git commit
  - url: https://www.openssl.org/news/secadv/20211214.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
