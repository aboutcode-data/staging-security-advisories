advisory_id: UBUNTU-CVE-2023-34455
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-34455
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-34455.json
aliases:
  - CVE-2023-34455
summary: snappy-java is a fast compressor/decompressor for Java. Due to use of an unchecked
  chunk length, an unrecoverable fatal error can occur in versions prior to 1.1.10.1. The code
  in the function hasNextChunk in the fileSnappyInputStream.java checks if a given stream has
  more chunks to read. It does that by attempting to read 4 bytes. If it wasn’t possible to
  read the 4 bytes, the function returns false. Otherwise, if 4 bytes were available, the code
  treats them as the length of the next chunk. In the case that the `compressed` variable is
  null, a byte array is allocated with the size given by the input data. Since the code doesn’t
  test the legality of the `chunkSize` variable, it is possible to pass a negative number (such
  as 0xFFFFFFFF which is -1), which will cause the code to raise a `java.lang.NegativeArraySizeException`
  exception. A worse case would happen when passing a huge positive value (such as 0x7FFFFFFF),
  which would raise the fatal `java.lang.OutOfMemoryError` error. Version 1.1.10.1 contains
  a patch for this issue.
impacted_packages:
  - purl: pkg:deb/ubuntu/snappy-java?arch=source&distro=trusty
    affected_versions: vers:deb/1.0.4.1~dfsg-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/snappy-java?arch=source&distro=xenial
    affected_versions: vers:deb/1.1.1.7-2|1.1.2-1|1.1.2.1-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/snappy-java?arch=source&distro=bionic
    affected_versions: vers:deb/1.1.4-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/snappy-java?arch=source&distro=focal
    affected_versions: vers:deb/1.1.7.2-1|1.1.7.3-1|1.1.7.3-1build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/snappy-java?arch=source&distro=jammy
    affected_versions: vers:deb/1.1.8.3-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/snappy-java?arch=source&distro=noble
    affected_versions: vers:deb/1.1.8.3-1|1.1.10.5-1|1.1.10.5-1build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/snappy-java?arch=source&distro=questing
    affected_versions: vers:deb/1.1.10.7-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-34455.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-34455.json
weaknesses: []
references:
  - url: https://github.com/xerial/snappy-java/blob/05c39b2ca9b5b7b39611529cc302d3d796329611/src/main/java/org/xerial/snappy/SnappyInputStream.java#L388
    reference_type:
    reference_id:
  - url: https://github.com/xerial/snappy-java/blob/master/src/main/java/org/xerial/snappy/SnappyInputStream.java
    reference_type:
    reference_id:
  - url: https://github.com/xerial/snappy-java/commit/3bf67857fcf70d9eea56eed4af7c925671e8eaea
    reference_type:
    reference_id:
  - url: https://github.com/xerial/snappy-java/security/advisories/GHSA-qcwq-55hx-v3vh
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-34455
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-34455
    reference_type:
    reference_id:
