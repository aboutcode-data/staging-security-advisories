advisory_id: UBUNTU-CVE-2021-21708
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-21708
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-21708.json
aliases:
  - CVE-2021-21708
summary: 'In PHP versions 7.4.x below 7.4.28, 8.0.x below 8.0.16, and 8.1.x below 8.1.3, when
  using filter functions with FILTER_VALIDATE_FLOAT filter and min/max limits, if the filter
  fails, there is a possibility to trigger use of allocated memory after free, which can result
  it crashes, and potentially in overwrite of other memory chunks and RCE. This issue affects:
  code that uses FILTER_VALIDATE_FLOAT with min/max limits.'
impacted_packages:
  - purl: pkg:deb/ubuntu/php7.4?arch=source&distro=focal
    affected_versions: vers:deb/7.4.3-4build1|7.4.3-4build2|7.4.3-4ubuntu1|7.4.3-4ubuntu1.1|7.4.3-4ubuntu2.2|7.4.3-4ubuntu2.4|7.4.3-4ubuntu2.5|7.4.3-4ubuntu2.6|7.4.3-4ubuntu2.7|7.4.3-4ubuntu2.8
    fixed_versions: vers:deb/7.4.3-4ubuntu2.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/php8.1?arch=source&distro=jammy
    affected_versions: vers:deb/8.1.0~rc4-1ubuntu2|8.1.0-1
    fixed_versions: vers:deb/8.1.2-1ubuntu1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-21708.json
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-21708.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-21708.json
weaknesses: []
references:
  - url: https://nakedsecurity.sophos.com/2022/02/18/irony-alert-php-fixes-security-flaw-in-input-validation-code/
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-21708
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5303-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-21708
    reference_type:
    reference_id:
  - url: https://www.php.net/ChangeLog-7.php#PHP_7_4
    reference_type:
    reference_id:
  - url: https://www.php.net/ChangeLog-8.php#PHP_8_1
    reference_type:
    reference_id:
