advisory_id: UBUNTU-CVE-2025-9905
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-9905
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-9905.json
aliases:
  - CVE-2025-9905
summary: The Keras Model.load_model method can be exploited to achieve arbitrary code execution,
  even with safe_mode=True. One can create a specially crafted .h5/.hdf5 model archive that,
  when loaded via Model.load_model, will trigger arbitrary code to be executed. This is achieved
  by crafting a special .h5 archive file that uses the Lambda layer feature of keras which allows
  arbitrary Python code in the form of pickled code. The vulnerability comes from the fact that
  the safe_mode=True option is not honored when reading .h5 archives. Note that the .h5/.hdf5 format
  is a legacy format supported by Keras 3 for backwards compatibility.
impacted_packages:
  - purl: pkg:deb/ubuntu/keras?arch=source&distro=bionic
    affected_versions: vers:deb/1.0.7-2|2.1.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/keras?arch=source&distro=focal
    affected_versions: vers:deb/2.2.4-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-9905.json
  - score: '7.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:H/AT:P/PR:L/UI:P/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-9905.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-9905.json
weaknesses: []
references:
  - url: https://github.com/keras-team/keras/pull/21602
    reference_type:
    reference_id:
  - url: https://github.com/keras-team/keras/security/advisories/GHSA-36rr-ww3j-vrjv
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-9905
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-9905
    reference_type:
    reference_id:
