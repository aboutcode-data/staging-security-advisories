advisory_id: UBUNTU-CVE-2024-23651
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-23651
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-23651.json
aliases:
  - CVE-2024-23651
summary: BuildKit is a toolkit for converting source code to build artifacts in an efficient,
  expressive and repeatable manner. Two malicious build steps running in parallel sharing the
  same cache mounts with subpaths could cause a race condition that can lead to files from the
  host system being accessible to the build container. The issue has been fixed in v0.12.5.
  Workarounds include, avoiding using BuildKit frontend from an untrusted source or building
  an untrusted Dockerfile containing cache mounts with --mount=type=cache,source=... options.
impacted_packages:
  - purl: pkg:deb/ubuntu/docker.io-app?arch=source&distro=noble
    affected_versions: vers:deb/24.0.5-0ubuntu1|24.0.7-0ubuntu1|24.0.7-0ubuntu2|24.0.7-0ubuntu3|24.0.7-0ubuntu4|24.0.7-0ubuntu4.1|26.1.3-0ubuntu1~24.04.1|27.5.1-0ubuntu3~24.04.1
    fixed_versions: vers:deb/27.5.1-0ubuntu3~24.04.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io?arch=source&distro=esm-apps/noble
    affected_versions: vers:deb/20.10.24+dfsg1-1ubuntu2|20.10.25+dfsg1-2ubuntu1|20.10.25+dfsg1-2ubuntu1+esm1
    fixed_versions: vers:deb/20.10.25+dfsg1-2ubuntu1+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io-app?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/20.10.25-0ubuntu1~20.04.1|20.10.25-0ubuntu1~20.04.2|24.0.5-0ubuntu1~20.04.1|24.0.7-0ubuntu2~20.04.1|26.1.3-0ubuntu1~20.04.1
    fixed_versions: vers:deb/26.1.3-0ubuntu1~20.04.1+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io-app?arch=source&distro=jammy
    affected_versions: vers:deb/20.10.25-0ubuntu1~22.04.1|20.10.25-0ubuntu1~22.04.2|24.0.5-0ubuntu1~22.04.1|24.0.7-0ubuntu2~22.04.1|26.1.3-0ubuntu1~22.04.1|27.5.1-0ubuntu3~22.04.1
    fixed_versions: vers:deb/27.5.1-0ubuntu3~22.04.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/20.10.7-0ubuntu5|20.10.7-0ubuntu7|20.10.12-0ubuntu1|20.10.12-0ubuntu2|20.10.12-0ubuntu3|20.10.12-0ubuntu3+gke1.24.1|20.10.12-0ubuntu4|20.10.21-0ubuntu1~22.04.2|20.10.21-0ubuntu1~22.04.3|20.10.21-0ubuntu1~22.04.5|20.10.21-0ubuntu1~22.04.6|20.10.21-0ubuntu1~22.04.7|20.10.21-0ubuntu1~22.04.7+esm1
    fixed_versions: vers:deb/20.10.21-0ubuntu1~22.04.7+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.13.1-0ubuntu6|17.03.2-0ubuntu1|17.03.2-0ubuntu3|17.03.2-0ubuntu5|17.12.1-0ubuntu1|18.06.1-0ubuntu1~18.04.1|18.06.1-0ubuntu1.2~18.04.1|18.09.2-0ubuntu1~18.04.1|18.09.5-0ubuntu1~18.04.2|18.09.7-0ubuntu1~18.04.1|18.09.7-0ubuntu1~18.04.3|18.09.7-0ubuntu1~18.04.4|19.03.6-0ubuntu1~18.04.1|19.03.6-0ubuntu1~18.04.2|19.03.6-0ubuntu1~18.04.3|20.10.2-0ubuntu1~18.04.2|20.10.2-0ubuntu1~18.04.3|20.10.7-0ubuntu1~18.04.1|20.10.7-0ubuntu1~18.04.2|20.10.7-0ubuntu5~18.04.2|20.10.7-0ubuntu5~18.04.3|20.10.12-0ubuntu2~18.04.1|20.10.21-0ubuntu1~18.04.2|20.10.21-0ubuntu1~18.04.3|20.10.21-0ubuntu1~18.04.3+esm1|20.10.21-0ubuntu1~18.04.3+esm2
    fixed_versions: vers:deb/20.10.21-0ubuntu1~18.04.3+esm3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/19.03.2-0ubuntu1|19.03.6-0ubuntu1|19.03.8-0ubuntu1|19.03.8-0ubuntu1.20.04|19.03.8-0ubuntu1.20.04.1|19.03.8-0ubuntu1.20.04.2|20.10.2-0ubuntu1~20.04.2|20.10.2-0ubuntu1~20.04.3|20.10.7-0ubuntu1~20.04.1|20.10.7-0ubuntu1~20.04.2|20.10.7-0ubuntu5~20.04.1|20.10.7-0ubuntu5~20.04.2|20.10.12-0ubuntu2~20.04.1|20.10.21-0ubuntu1~20.04.1|20.10.21-0ubuntu1~20.04.2|20.10.21-0ubuntu1~20.04.4|20.10.21-0ubuntu1~20.04.5|20.10.21-0ubuntu1~20.04.6|20.10.21-0ubuntu1~20.04.6+esm1
    fixed_versions: vers:deb/20.10.21-0ubuntu1~20.04.6+esm2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-23651.json
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-23651.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-23651.json
weaknesses: []
references:
  - url: https://github.com/moby/buildkit/pull/4604
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/releases/tag/v0.12.5
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/security/advisories/GHSA-m3r6-h7wv-7xxv
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-23651
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7474-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-23651
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2019/05/28/1
    reference_type:
    reference_id:
