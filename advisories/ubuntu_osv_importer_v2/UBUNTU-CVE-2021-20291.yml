advisory_id: UBUNTU-CVE-2021-20291
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-20291
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-20291.json
aliases:
  - CVE-2021-20291
summary: A deadlock vulnerability was found in 'github.com/containers/storage' in versions before
  1.28.1. When a container image is processed, each layer is unpacked using `tar`. If one of
  those layers is not a valid `tar` archive this causes an error leading to an unexpected situation
  where the code indefinitely waits for the tar unpacked stream, which never finishes. An attacker
  could use this vulnerability to craft a malicious image, which when downloaded and stored
  by an application using containers/storage, would then cause a deadlock leading to a Denial
  of Service (DoS).
impacted_packages:
  - purl: pkg:deb/ubuntu/golang-github-containers-storage?arch=source&distro=focal
    affected_versions: vers:deb/1.13.2+dfsg1-2|1.13.2+dfsg1-3|1.13.5+dfsg1-1|1.15.1+dfsg1-1|1.15.2+dfsg1-1|1.15.3+dfsg1-1|1.15.5+dfsg1-1|1.15.7+dfsg1-1|1.15.8+dfsg1-1|1.15.8+dfsg1-1ubuntu1|1.15.8+dfsg1-1ubuntu2|1.15.8+dfsg1-1ubuntu2.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-20291.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-20291.json
weaknesses: []
references:
  - url: https://github.com/containers/storage/commit/306fcabc964470e4b3b87a43a8f6b7d698209ee1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-20291
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-20291
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1939485
    reference_type: bug
    reference_id: '1939485'
