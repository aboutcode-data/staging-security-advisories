advisory_id: UBUNTU-CVE-2023-31038
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-31038
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-31038.json
aliases:
  - CVE-2023-31038
summary: 'SQL injection in Log4cxx when using the ODBC appender to send log messages to a database. 
  No fields sent to the database were properly escaped for SQL injection.  This has been the
  case since at least version 0.9.0(released 2003-08-06) Note that Log4cxx is a C++ framework,
  so only C++ applications are affected. Before version 1.1.0, the ODBC appender was automatically
  part of Log4cxx if the library was found when compiling the library.  As of version 1.1.0,
  this must be both explicitly enabled in order to be compiled in. Three preconditions must
  be met for this vulnerability to be possible: 1. Log4cxx compiled with ODBC support(before
  version 1.1.0, this was auto-detected at compile time) 2. ODBCAppender enabled for logging
  messages to, generally done via a config file 3. User input is logged at some point. If your
  application does not have user input, it is unlikely to be affected. Users are recommended
  to upgrade to version 1.1.0 which properly binds the parameters to the SQL statement, or migrate
  to the new DBAppender class which supports an ODBC connection in addition to other databases.
  Note that this fix does require a configuration file update, as the old configuration files
  will not configure properly.  An example is shown below, and more information may be found
  in the Log4cxx documentation on the ODBCAppender. Example of old configuration snippet: <appender
  name="SqlODBCAppender" class="ODBCAppender">     <param name="sql" value="INSERT INTO logs
  (message) VALUES (''%m'')" />     ... other params here ... </appender> The migrated configuration
  snippet with new ColumnMapping parameters: <appender name="SqlODBCAppender" class="ODBCAppender">
      <param name="sql" value="INSERT INTO logs (message) VALUES (?)" />     <param name="ColumnMapping"
  value="message"/>     ... other params here ... </appender>'
impacted_packages:
  - purl: pkg:deb/ubuntu/log4cxx?arch=source&distro=focal
    affected_versions: vers:deb/0.10.0-15ubuntu1|0.10.0-15ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/log4cxx?arch=source&distro=jammy
    affected_versions: vers:deb/0.11.0-2ubuntu1|0.11.0-3ubuntu2|0.12.1-4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/log4cxx?arch=source&distro=noble
    affected_versions: vers:deb/1.1.0-1|1.1.0-1build1|1.1.0-1build2|1.1.0-1build3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/log4cxx?arch=source&distro=questing
    affected_versions: vers:deb/1.3.1-1|1.4.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/log4cxx?arch=source&distro=trusty
    affected_versions: vers:deb/0.10.0-1.2ubuntu3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/log4cxx?arch=source&distro=xenial
    affected_versions: vers:deb/0.10.0-9ubuntu1|0.10.0-9ubuntu2|0.10.0-10ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/log4cxx?arch=source&distro=bionic
    affected_versions: vers:deb/0.10.0-12ubuntu1|0.10.0-13ubuntu1|0.10.0-13ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-31038.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-31038.json
weaknesses: []
references:
  - url: https://lists.apache.org/thread/vgjlpdf353vv91gryspwxrzj6p0fbjd9
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-31038
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-31038
    reference_type:
    reference_id:
