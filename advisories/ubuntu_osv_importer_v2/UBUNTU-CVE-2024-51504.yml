advisory_id: UBUNTU-CVE-2024-51504
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-51504
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-51504.json
aliases:
  - CVE-2024-51504
summary: When using IPAuthenticationProvider in ZooKeeper Admin Server there is a possibility
  of Authentication Bypass by Spoofing -- this only impacts IP based authentication implemented
  in ZooKeeper Admin Server. Default configuration of client's IP address detection in IPAuthenticationProvider,
  which uses HTTP request headers, is weak and allows an attacker to bypass authentication via
  spoofing client's IP address in request headers. Default configuration honors X-Forwarded-For
  HTTP header to read client's IP address. X-Forwarded-For request header is mainly used by
  proxy servers to identify the client and can be easily spoofed by an attacker pretending that
  the request comes from a different IP address. Admin Server commands, such as snapshot and
  restore arbitrarily can be executed on successful exploitation which could potentially lead
  to information leakage or service availability issues. Users are recommended to upgrade to
  version 3.9.3, which fixes this issue.
impacted_packages:
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=noble
    affected_versions: vers:deb/3.8.0-11|3.9.1-1|3.9.1-1build1|3.9.1-1build2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-51504.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-51504.json
weaknesses: []
references:
  - url: https://lists.apache.org/thread/b3qrmpkto5r6989qr61fw9y2x646kqlh
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-51504
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-51504
    reference_type:
    reference_id:
