advisory_id: UBUNTU-CVE-2025-47909
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-47909
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-47909.json
aliases:
  - CVE-2025-47909
summary: Hosts listed in TrustedOrigins implicitly allow requests from the corresponding HTTP
  origins, allowing network MitMs to perform CSRF attacks. After the CVE-2025-24358 fix, a network
  attacker that places a form at http://example.com can't get it to submit to https://example.com
  because the Origin header is checked with sameOrigin against a synthetic URL. However, if
  a host is added to TrustedOrigins, both its HTTP and HTTPS origins will be allowed, because
  the schema of the synthetic URL is ignored and only the host is checked. For example, if an
  application is hosted on https://example.com and adds example.net to TrustedOrigins, a network
  attacker can serve a form at http://example.net to perform the attack. Applications should
  migrate to net/http.CrossOriginProtection, introduced in Go 1.25. If that is not an option,
  a backport is available as a module at filippo.io/csrf, and a drop-in replacement for the
  github.com/gorilla/csrf API is available at filippo.io/csrf/gorilla.
impacted_packages:
  - purl: pkg:deb/ubuntu/golang-github-gorilla-csrf?arch=source&distro=focal
    affected_versions: vers:deb/1.6.2-1|1.6.2-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-gorilla-csrf?arch=source&distro=jammy
    affected_versions: vers:deb/1.6.2-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-gorilla-csrf?arch=source&distro=noble
    affected_versions: vers:deb/1.7.1-1|1.7.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-gorilla-csrf?arch=source&distro=questing
    affected_versions: vers:deb/1.7.2+ds1-1|1.7.2+ds1-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-47909.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-47909.json
weaknesses: []
references:
  - url: https://github.com/advisories/GHSA-82ff-hg59-8x73
    reference_type:
    reference_id:
  - url: https://github.com/golang/vulndb/issues/3884
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3884
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-47909
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-47909
    reference_type:
    reference_id:
