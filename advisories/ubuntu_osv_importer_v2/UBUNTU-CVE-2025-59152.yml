advisory_id: UBUNTU-CVE-2025-59152
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-59152
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-59152.json
aliases:
  - CVE-2025-59152
summary: Litestar is an Asynchronous Server Gateway Interface (ASGI) framework. In version 2.17.0,
  rate limits can be completely bypassed by manipulating the X-Forwarded-For header. This renders
  IP-based rate limiting ineffective against determined attackers. Litestar's RateLimitMiddleware
  uses `cache_key_from_request()` to generate cache keys for rate limiting. When an X-Forwarded-For
  header is present, the middleware trusts it unconditionally and uses its value as part of
  the client identifier. Since clients can set arbitrary X-Forwarded-For values, each different
  spoofed IP creates a separate rate limit bucket. An attacker can rotate through different
  header values to avoid hitting any single bucket's limit. This affects any Litestar application
  using RateLimitMiddleware with default settings, which likely includes most applications that
  implement rate limiting. Version 2.18.0 contains a patch for the vulnerability.
impacted_packages:
  - purl: pkg:deb/ubuntu/litestar?arch=source&distro=plucky
    affected_versions: vers:deb/2.15.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-59152.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-59152.json
weaknesses: []
references:
  - url: https://github.com/litestar-org/litestar/blob/26f20ac6c52de2b4bf81161f7560c8bb4af6f382/litestar/middleware/rate_limit.py#L127
    reference_type:
    reference_id:
  - url: https://github.com/litestar-org/litestar/security/advisories/GHSA-hm36-ffrh-c77c
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-59152
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-59152
    reference_type:
    reference_id:
