advisory_id: UBUNTU-CVE-2024-23185
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-23185
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-23185.json
aliases:
  - CVE-2024-23185
summary: Very large headers can cause resource exhaustion when parsing message. The message-parser
  normally reads reasonably sized chunks of the message. However, when it feeds them to message-header-parser,
  it starts building up "full_value" buffer out of the smaller chunks. The full_value buffer
  has no size limit, so large headers can cause large memory usage. It doesn't matter whether
  it's a single long header line, or a single header split into multiple lines. This bug exists
  in all Dovecot versions. Incoming mails typically have some size limits set by MTA, so even
  largest possible header size may still fit into Dovecot's vsz_limit. So attackers probably
  can't DoS a victim user this way. A user could APPEND larger mails though, allowing them to
  DoS themselves (although maybe cause some memory issues for the backend in general). One can
  implement restrictions on headers on MTA component preceding Dovecot. No publicly available
  exploits are known.
impacted_packages:
  - purl: pkg:deb/ubuntu/dovecot?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/1:2.1.7-7ubuntu3|1:2.2.9-1ubuntu1|1:2.2.9-1ubuntu2|1:2.2.9-1ubuntu2.1|1:2.2.9-1ubuntu2.3|1:2.2.9-1ubuntu2.4|1:2.2.9-1ubuntu2.5|1:2.2.9-1ubuntu2.6|1:2.2.9-1ubuntu2.6+esm1|1:2.2.9-1ubuntu2.6+esm2|1:2.2.9-1ubuntu2.6+esm3|1:2.2.9-1ubuntu2.6+esm4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/dovecot?arch=source&distro=xenial
    affected_versions: vers:deb/1:2.2.18-2ubuntu2|1:2.2.22-1ubuntu1|1:2.2.22-1ubuntu2|1:2.2.22-1ubuntu2.1|1:2.2.22-1ubuntu2.2|1:2.2.22-1ubuntu2.3|1:2.2.22-1ubuntu2.4|1:2.2.22-1ubuntu2.6|1:2.2.22-1ubuntu2.7|1:2.2.22-1ubuntu2.8|1:2.2.22-1ubuntu2.9|1:2.2.22-1ubuntu2.10|1:2.2.22-1ubuntu2.11|1:2.2.22-1ubuntu2.12|1:2.2.22-1ubuntu2.13|1:2.2.22-1ubuntu2.14
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/dovecot?arch=source&distro=bionic
    affected_versions: vers:deb/1:2.2.27-3ubuntu1|1:2.2.33.2-1ubuntu1|1:2.2.33.2-1ubuntu2|1:2.2.33.2-1ubuntu3|1:2.2.33.2-1ubuntu4|1:2.2.33.2-1ubuntu4.1|1:2.2.33.2-1ubuntu4.2|1:2.2.33.2-1ubuntu4.3|1:2.2.33.2-1ubuntu4.4|1:2.2.33.2-1ubuntu4.5|1:2.2.33.2-1ubuntu4.6|1:2.2.33.2-1ubuntu4.7|1:2.2.33.2-1ubuntu4.8
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/dovecot?arch=source&distro=focal
    affected_versions: vers:deb/1:2.3.4.1-5ubuntu3|1:2.3.7.2-1ubuntu1|1:2.3.7.2-1ubuntu2|1:2.3.7.2-1ubuntu3|1:2.3.7.2-1ubuntu3.1|1:2.3.7.2-1ubuntu3.2|1:2.3.7.2-1ubuntu3.3|1:2.3.7.2-1ubuntu3.4|1:2.3.7.2-1ubuntu3.5|1:2.3.7.2-1ubuntu3.6
    fixed_versions: vers:deb/1:2.3.7.2-1ubuntu3.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/dovecot?arch=source&distro=jammy
    affected_versions: vers:deb/1:2.3.13+dfsg1-1ubuntu3|1:2.3.16+dfsg1-3ubuntu1|1:2.3.16+dfsg1-3ubuntu2|1:2.3.16+dfsg1-3ubuntu2.1|1:2.3.16+dfsg1-3ubuntu2.2
    fixed_versions: vers:deb/1:2.3.16+dfsg1-3ubuntu2.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/dovecot?arch=source&distro=noble
    affected_versions: vers:deb/1:2.3.20+dfsg1-1ubuntu3|1:2.3.21+dfsg1-2ubuntu1|1:2.3.21+dfsg1-2ubuntu2|1:2.3.21+dfsg1-2ubuntu4|1:2.3.21+dfsg1-2ubuntu5
    fixed_versions: vers:deb/1:2.3.21+dfsg1-2ubuntu6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-23185.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-23185.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2024-23185
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6982-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7013-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-23185
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2024/08/15/4
    reference_type:
    reference_id:
