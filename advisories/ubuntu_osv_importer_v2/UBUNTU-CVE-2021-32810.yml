advisory_id: UBUNTU-CVE-2021-32810
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-32810
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32810.json
aliases:
  - CVE-2021-32810
summary: crossbeam-deque is a package of work-stealing deques for building task schedulers when
  programming in Rust. In versions prior to 0.7.4 and 0.8.0, the result of the race condition
  is that one or more tasks in the worker queue can be popped twice instead of other tasks that
  are forgotten and never popped. If tasks are allocated on the heap, this can cause double
  free and a memory leak. If not, this still can cause a logical bug. Crates using `Stealer::steal`,
  `Stealer::steal_batch`, or `Stealer::steal_batch_and_pop` are affected by this issue. This
  has been fixed in crossbeam-deque 0.8.1 and 0.7.4.
impacted_packages:
  - purl: pkg:deb/ubuntu/firefox?arch=source&distro=bionic
    affected_versions: vers:deb/56.0+build6-0ubuntu1|57.0.1+build2-0ubuntu1|59.0.1+build1-0ubuntu1|59.0.2+build1-0ubuntu1|60.0+build2-0ubuntu1|60.0.1+build2-0ubuntu0.18.04.1|60.0.2+build1-0ubuntu0.18.04.1|61.0+build3-0ubuntu0.18.04.1|61.0.1+build1-0ubuntu0.18.04.1|62.0+build2-0ubuntu0.18.04.3|62.0+build2-0ubuntu0.18.04.4|62.0+build2-0ubuntu0.18.04.5|62.0.3+build1-0ubuntu0.18.04.1|63.0+build2-0ubuntu0.18.04.2|63.0.3+build1-0ubuntu0.18.04.1|64.0+build3-0ubuntu0.18.04.1|65.0+build2-0ubuntu0.18.04.1|65.0.1+build2-0ubuntu0.18.04.1|66.0+build3-0ubuntu0.18.04.1|66.0.1+build1-0ubuntu0.18.04.1|66.0.2+build1-0ubuntu0.18.04.1|66.0.3+build1-0ubuntu0.18.04.1|66.0.4+build3-0ubuntu0.18.04.1|66.0.5+build1-0ubuntu0.18.04.1|67.0+build2-0ubuntu0.18.04.1|67.0.1+build1-0ubuntu0.18.04.1|67.0.2+build2-0ubuntu0.18.04.1|67.0.3+build1-0ubuntu0.18.04.1|67.0.4+build1-0ubuntu0.18.04.1|68.0+build3-0ubuntu0.18.04.1|68.0.1+build1-0ubuntu0.18.04.1|68.0.2+build1-0ubuntu0.18.04.1|69.0+build2-0ubuntu0.18.04.1|69.0.1+build1-0ubuntu0.18.04.1|69.0.2+build1-0ubuntu0.18.04.1|70.0+build2-0ubuntu0.18.04.1|70.0.1+build1-0ubuntu0.18.04.1|71.0+build5-0ubuntu0.18.04.1|72.0.1+build1-0ubuntu0.18.04.1|72.0.2+build1-0ubuntu0.18.04.1|73.0+build3-0ubuntu0.18.04.1|73.0.1+build1-0ubuntu0.18.04.1|74.0+build3-0ubuntu0.18.04.1|74.0.1+build1-0ubuntu0.18.04.1|75.0+build3-0ubuntu0.18.04.1|76.0+build2-0ubuntu0.18.04.1|76.0.1+build1-0ubuntu0.18.04.1|77.0.1+build1-0ubuntu0.18.04.1|78.0.1+build1-0ubuntu0.18.04.1|78.0.2+build2-0ubuntu0.18.04.1|79.0+build1-0ubuntu0.18.04.1|80.0+build2-0ubuntu0.18.04.1|80.0.1+build1-0ubuntu0.18.04.1|81.0+build2-0ubuntu0.18.04.1|81.0.2+build1-0ubuntu0.18.04.1|82.0+build2-0ubuntu0.18.04.1|82.0.2+build1-0ubuntu0.18.04.1|82.0.3+build1-0ubuntu0.18.04.1|83.0+build2-0ubuntu0.18.04.2|84.0+build3-0ubuntu0.18.04.1|84.0.1+build1-0ubuntu0.18.04.1|84.0.2+build1-0ubuntu0.18.04.1|85.0+build1-0ubuntu0.18.04.1|85.0.1+build1-0ubuntu0.18.04.1|86.0+build3-0ubuntu0.18.04.1|86.0.1+build1-0ubuntu0.18.04.1|87.0+build3-0ubuntu0.18.04.2|88.0+build2-0ubuntu0.18.04.2|88.0.1+build1-0ubuntu0.18.04.2|89.0+build2-0ubuntu0.18.04.2|89.0.1+build1-0ubuntu0.18.04.1|89.0.2+build1-0ubuntu0.18.04.1|90.0+build1-0ubuntu0.18.04.1|90.0.2+build1-0ubuntu0.18.04.1|91.0+build2-0ubuntu0.18.04.1|91.0.1+build1-0ubuntu0.18.04.1|91.0.2+build1-0ubuntu0.18.04.1|92.0+build3-0ubuntu0.18.04.1
    fixed_versions: vers:deb/93.0+build1-0ubuntu0.18.04.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/firefox?arch=source&distro=focal
    affected_versions: vers:deb/69.0.3+build1-0ubuntu1|70.0+build2-0ubuntu1|70.0+build2-0ubuntu2|70.0.1+build1-0ubuntu2|71.0+build2-0ubuntu2|71.0+build5-0ubuntu1|72.0.1+build1-0ubuntu1|72.0.2+build1-0ubuntu1|73.0+build1-0ubuntu1|73.0+build2-0ubuntu1|73.0+build3-0ubuntu1|73.0.1+build1-0ubuntu1|74.0+build1-0ubuntu1|74.0+build2-0ubuntu1|74.0+build2-0ubuntu2|74.0+build3-0ubuntu1|75.0+build3-0ubuntu1|76.0+build2-0ubuntu0.20.04.1|76.0.1+build1-0ubuntu0.20.04.1|77.0.1+build1-0ubuntu0.20.04.1|78.0.1+build1-0ubuntu0.20.04.1|78.0.2+build2-0ubuntu0.20.04.1|79.0+build1-0ubuntu0.20.04.1|80.0+build2-0ubuntu0.20.04.1|80.0.1+build1-0ubuntu0.20.04.1|81.0+build2-0ubuntu0.20.04.1|81.0.2+build1-0ubuntu0.20.04.1|82.0+build2-0ubuntu0.20.04.1|82.0.2+build1-0ubuntu0.20.04.1|82.0.3+build1-0ubuntu0.20.04.1|83.0+build2-0ubuntu0.20.04.1|84.0+build3-0ubuntu0.20.04.1|84.0.1+build1-0ubuntu0.20.04.1|84.0.2+build1-0ubuntu0.20.04.1|85.0+build1-0ubuntu0.20.04.1|85.0.1+build1-0ubuntu0.20.04.1|86.0+build3-0ubuntu0.20.04.1|86.0.1+build1-0ubuntu0.20.04.1|87.0+build3-0ubuntu0.20.04.2|88.0+build2-0ubuntu0.20.04.1|88.0.1+build1-0ubuntu0.20.04.2|89.0+build2-0ubuntu0.20.04.2|89.0.1+build1-0ubuntu0.20.04.1|89.0.2+build1-0ubuntu0.20.04.1|90.0+build1-0ubuntu0.20.04.1|90.0.2+build1-0ubuntu0.20.04.1|91.0+build2-0ubuntu0.20.04.1|91.0.1+build1-0ubuntu0.20.04.1|91.0.2+build1-0ubuntu0.20.04.1|92.0+build3-0ubuntu0.20.04.1
    fixed_versions: vers:deb/93.0+build1-0ubuntu0.20.04.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/rust-crossbeam-deque?arch=source&distro=focal
    affected_versions: vers:deb/0.7.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/rust-crossbeam-deque?arch=source&distro=jammy
    affected_versions: vers:deb/0.7.3-1|0.7.4-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32810.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32810.json
weaknesses: []
references:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0093.html
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-32810
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5107-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5132-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-32810
    reference_type:
    reference_id:
  - url: https://www.mozilla.org/en-US/security/advisories/mfsa2021-43/#CVE-2021-32810
    reference_type:
    reference_id:
