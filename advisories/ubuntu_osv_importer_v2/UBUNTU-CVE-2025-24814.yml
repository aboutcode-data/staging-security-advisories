advisory_id: UBUNTU-CVE-2025-24814
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-24814
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24814.json
aliases:
  - CVE-2025-24814
summary: Core creation allows users to replace "trusted" configset files with arbitrary configuration
  Solr instances that (1) use the "FileSystemConfigSetService" component (the default in "standalone"
  or "user-managed" mode), and (2) are running without authentication and authorization are
  vulnerable to a sort of privilege escalation wherein individual "trusted" configset files
  can be ignored in favor of potentially-untrusted replacements available elsewhere on the filesystem. 
  These replacement config files are treated as "trusted" and can use "<lib>" tags to add to
  Solr's classpath, which an attacker might use to load malicious code as a searchComponent
  or other plugin. This issue affects all Apache Solr versions up through Solr 9.7.  Users can
  protect against the vulnerability by enabling authentication and authorization on their Solr
  clusters or switching to SolrCloud (and away from "FileSystemConfigSetService").  Users are
  also recommended to upgrade to Solr 9.8.0, which mitigates this issue by disabling use of
  "<lib>" tags by default.
impacted_packages:
  - purl: pkg:deb/ubuntu/lucene-solr?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/3.6.2+dfsg-1|3.6.2+dfsg-2|3.6.2+dfsg-2ubuntu0.1~esm1|3.6.2+dfsg-2ubuntu0.1~esm2|3.6.2+dfsg-2ubuntu0.1~esm4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/lucene-solr?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/3.6.2+dfsg-7|3.6.2+dfsg-8|3.6.2+dfsg-8ubuntu0.1|3.6.2+dfsg-8ubuntu0.1+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/lucene-solr?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/3.6.2+dfsg-10|3.6.2+dfsg-11|3.6.2+dfsg-18~18.04|3.6.2+dfsg-18~18.04.1~esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/lucene-solr?arch=source&distro=focal
    affected_versions: vers:deb/3.6.2+dfsg-20|3.6.2+dfsg-22
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24814.json
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24814.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24814.json
weaknesses: []
references:
  - url: https://lists.apache.org/thread/gl291pn8x9f9n52ys5l0pc0b6qtf0qw1
    reference_type:
    reference_id:
  - url: https://solr.apache.org/security.html#cve-2025-24814-apache-solr-core-creation-with-trusted-configset-can-use-arbitrary-untrusted-files
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-24814
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-24814
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2025/01/26/1
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2025/01/26/1
    reference_type:
    reference_id:
