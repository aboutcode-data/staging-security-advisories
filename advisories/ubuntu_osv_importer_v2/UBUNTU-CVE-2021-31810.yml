advisory_id: UBUNTU-CVE-2021-31810
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-31810
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-31810.json
aliases:
  - CVE-2021-31810
summary: An issue was discovered in Ruby through 2.6.7, 2.7.x through 2.7.3, and 3.x through
  3.0.1. A malicious FTP server can use the PASV response to trick Net::FTP into connecting
  back to a given IP address and port. This potentially makes curl extract information about
  services that are otherwise private and not disclosed (e.g., the attacker can conduct port
  scans and service banner extractions).
impacted_packages:
  - purl: pkg:deb/ubuntu/ruby2.3?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/2.3.0-1|2.3.0-2|2.3.0-4ubuntu2|2.3.0-4ubuntu3|2.3.0-5ubuntu1|2.3.1-2~16.04|2.3.1-2~16.04.2|2.3.1-2~16.04.4|2.3.1-2~16.04.5|2.3.1-2~16.04.6|2.3.1-2~16.04.7|2.3.1-2~16.04.9|2.3.1-2~16.04.10|2.3.1-2~16.04.11|2.3.1-2~16.04.12|2.3.1-2~ubuntu16.04.13|2.3.1-2~ubuntu16.04.14|2.3.1-2~ubuntu16.04.15|2.3.1-2~ubuntu16.04.16
    fixed_versions: vers:deb/2.3.1-2~ubuntu16.04.16+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby2.5?arch=source&distro=bionic
    affected_versions: vers:deb/2.5.0~preview1-1ubuntu2|2.5.0-4ubuntu1|2.5.0-4ubuntu4|2.5.0-5ubuntu1|2.5.0-6ubuntu1|2.5.1-1ubuntu1|2.5.1-1ubuntu1.1|2.5.1-1ubuntu1.2|2.5.1-1ubuntu1.4|2.5.1-1ubuntu1.5|2.5.1-1ubuntu1.6|2.5.1-1ubuntu1.7|2.5.1-1ubuntu1.8|2.5.1-1ubuntu1.9
    fixed_versions: vers:deb/2.5.1-1ubuntu1.10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby2.7?arch=source&distro=focal
    affected_versions: vers:deb/2.7.0-1|2.7.0-2|2.7.0-3|2.7.0-4|2.7.0-4ubuntu1|2.7.0-5ubuntu1|2.7.0-5ubuntu1.1|2.7.0-5ubuntu1.2|2.7.0-5ubuntu1.3|2.7.0-5ubuntu1.4
    fixed_versions: vers:deb/2.7.0-5ubuntu1.5
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-31810.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-31810.json
weaknesses: []
references:
  - url: https://github.com/ruby/ruby/commit/3ca1399150ed4eacfd2fe1ee251b966f8d1ee469
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1145454
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-31810
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5020-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-31810
    reference_type:
    reference_id:
  - url: https://www.ruby-lang.org/en/news/2021/07/07/trusting-pasv-responses-in-net-ftp/
    reference_type:
    reference_id:
