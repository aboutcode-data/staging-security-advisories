advisory_id: UBUNTU-CVE-2024-51744
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-51744
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-51744.json
aliases:
  - CVE-2024-51744
summary: golang-jwt is a Go implementation of JSON Web Tokens. Unclear documentation of the
  error behavior in `ParseWithClaims` can lead to situation where users are potentially not
  checking errors in the way they should be. Especially, if a token is both expired and invalid,
  the errors returned by `ParseWithClaims` return both error codes. If users only check for
  the `jwt.ErrTokenExpired ` using `error.Is`, they will ignore the embedded `jwt.ErrTokenSignatureInvalid`
  and thus potentially accept invalid tokens. A fix has been back-ported with the error handling
  logic from the `v5` branch to the `v4` branch. In this logic, the `ParseWithClaims` function
  will immediately return in "dangerous" situations (e.g., an invalid signature), limiting the
  combined errors only to situations where the signature is valid, but further validation failed
  (e.g., if the signature is valid, but is expired AND has the wrong audience). This fix is
  part of the 4.5.1 release. We are aware that this changes the behaviour of an established
  function and is not 100 % backwards compatible, so updating to 4.5.1 might break your code.
  In case you cannot update to 4.5.0, please make sure that you are properly checking for all
  errors ("dangerous" ones first), so that you are not running in the case detailed above.
impacted_packages:
  - purl: pkg:deb/ubuntu/golang-github-golang-jwt-jwt?arch=source&distro=jammy
    affected_versions: vers:deb/4.1.0-1|4.1.0-2|4.2.0-1|4.2.0-1ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-golang-jwt-jwt?arch=source&distro=noble
    affected_versions: vers:deb/4.4.3-1build1|5.0.0+really4.5.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-golang-jwt-jwt-v5?arch=source&distro=noble
    affected_versions: vers:deb/5.2.0-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-golang-jwt-jwt?arch=source&distro=questing
    affected_versions: vers:deb/5.0.0+really4.5.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-golang-jwt-jwt-v5?arch=source&distro=questing
    affected_versions: vers:deb/5.2.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-51744.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-51744.json
weaknesses: []
references:
  - url: https://github.com/golang-jwt/jwt/commit/7b1c1c00a171c6c79bbdb40e4ce7d197060c1c2c
    reference_type:
    reference_id:
  - url: https://github.com/golang-jwt/jwt/security/advisories/GHSA-29wx-vh33-7x7r
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-51744
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-51744
    reference_type:
    reference_id:
