advisory_id: UBUNTU-CVE-2022-31022
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-31022
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31022.json
aliases:
  - CVE-2022-31022
summary: Bleve is a text indexing library for go. Bleve includes HTTP utilities under bleve/http
  package, that are used by its sample application. These HTTP methods pave way for exploitation
  of a node’s filesystem where the bleve index resides, if the user has used bleve’s own HTTP
  (bleve/http) handlers for exposing the access to the indexes. For instance, the CreateIndexHandler
  (`http/index_create.go`) and DeleteIndexHandler (`http/index_delete.go`) enable an attacker
  to create a bleve index (directory structure) anywhere where the user running the server has
  the write permissions and to delete recursively any directory owned by the same user account.
  Users who have used the bleve/http package for exposing access to bleve index without the
  explicit handling for the Role Based Access Controls(RBAC) of the index assets would be impacted
  by this issue. Version 2.5.0 relocated the `http/` dir used _only_ by bleve-explorer to `blevesearch/bleve-explorer`,
  thereby addressing the issue. However, the http package is purely intended to be used for
  demonstration purposes. Bleve was never designed handle the RBACs, nor it was ever advertised
  to be used in that way. The collaborators of this project have decided to stay away from adding
  any authentication or authorization to bleve project at the moment. The bleve/http package
  is mainly for demonstration purposes and it lacks exhaustive validation of the user inputs
  as well as any authentication and authorization measures. It is recommended to not use bleve/http
  in production use cases.
impacted_packages:
  - purl: pkg:deb/ubuntu/golang-github-blevesearch-bleve?arch=source&distro=bionic
    affected_versions: vers:deb/0.5.0+git20170628.269.174f8ed4-2|0.5.0+git20170912.278.6eea5b78-2|0.5.0+git20170912.278.6eea5b78-3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-blevesearch-bleve?arch=source&distro=focal
    affected_versions: vers:deb/0.5.0+git20170912.278.6eea5b78-4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-blevesearch-bleve?arch=source&distro=jammy
    affected_versions: vers:deb/0.5.0+git20170912.278.6eea5b78-5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31022.json
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31022.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31022.json
weaknesses: []
references:
  - url: https://github.com/blevesearch/bleve/security/advisories/GHSA-9w9f-6mg8-jp7w
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-31022
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-31022
    reference_type:
    reference_id:
