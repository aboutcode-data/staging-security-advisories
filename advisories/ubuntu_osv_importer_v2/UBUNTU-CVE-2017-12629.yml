advisory_id: UBUNTU-CVE-2017-12629
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2017-12629
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-12629.json
aliases:
  - CVE-2017-12629
summary: Remote code execution occurs in Apache Solr before 7.1 with Apache Lucene before 7.1
  by exploiting XXE in conjunction with use of a Config API add-listener command to reach the
  RunExecutableListener class. Elasticsearch, although it uses Lucene, is NOT vulnerable to
  this. Note that the XML external entity expansion vulnerability occurs in the XML Query Parser
  which is available, by default, for any query request with parameters deftype=xmlparser and
  can be exploited to upload malicious data to the /upload request handler or as Blind XXE using
  ftp wrapper in order to read arbitrary local files from the Solr server. Note also that the
  second vulnerability relates to remote code execution using the RunExecutableListener available
  on all affected versions of Solr.
impacted_packages:
  - purl: pkg:deb/ubuntu/lucene-solr?arch=source&distro=trusty/esm
    affected_versions: vers:deb/3.6.2+dfsg-1|3.6.2+dfsg-2
    fixed_versions: vers:deb/3.6.2+dfsg-2ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/lucene-solr?arch=source&distro=xenial
    affected_versions: vers:deb/3.6.2+dfsg-7|3.6.2+dfsg-8
    fixed_versions: vers:deb/3.6.2+dfsg-8ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-12629.json
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-12629.json
  - score: high
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-12629.json
weaknesses: []
references:
  - url: http://mail-archives.apache.org/mod_mbox/lucene-dev/201710.mbox/%3CCAKrJsP=twErMhzf+FtUMOpCk7+r0pK35hAqoqf_ZtvEoshTgjQ@mail.gmail.com%3E
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2017-12629
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4259-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2017-12629
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1501529
    reference_type: bug
    reference_id: 1501529
