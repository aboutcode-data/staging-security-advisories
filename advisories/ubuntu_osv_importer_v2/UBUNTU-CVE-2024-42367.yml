advisory_id: UBUNTU-CVE-2024-42367
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-42367
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-42367.json
aliases:
  - CVE-2024-42367
summary: aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. In
  versions on the 3.10 branch prior to version 3.10.2, static routes which contain files with
  compressed variants (`.gz` or `.br` extension) are vulnerable to path traversal outside the
  root directory if those variants are symbolic links. The server protects static routes from
  path traversal outside the root directory when `follow_symlinks=False` (default).  It does
  this by resolving the requested URL to an absolute path and then checking that path relative
  to the root. However, these checks are not performed when looking for compressed variants
  in the `FileResponse` class, and symbolic links are then automatically followed when performing
  the `Path.stat()` and `Path.open()` to send the file. Version 3.10.2 contains a patch for
  the issue.
impacted_packages:
  - purl: pkg:deb/ubuntu/python-aiohttp?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/0.17.2-1|0.17.4-1|0.17.4-1build1|0.20.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-aiohttp?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/2.2.3-1build1|2.2.3-2|2.3.6-1|3.0.1-1|3.0.1-1ubuntu0.1~esm1|3.0.1-1ubuntu0.1~esm4|3.0.1-1ubuntu0.1~esm5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-aiohttp?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/3.5.4-1|3.5.4-1build1|3.6.1-1|3.6.2-1|3.6.2-1build1|3.6.2-1ubuntu0.1~esm1|3.6.2-1ubuntu1|3.6.2-1ubuntu1+esm1|3.6.2-1ubuntu1+esm3|3.6.2-1ubuntu1+esm4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-aiohttp?arch=source&distro=jammy
    affected_versions: vers:deb/3.7.4-1|3.7.4-1build2|3.8.1-3|3.8.1-4|3.8.1-4build1|3.8.1-4ubuntu0.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-aiohttp?arch=source&distro=noble
    affected_versions: vers:deb/3.8.4-1|3.9.1-1|3.9.1-1build1|3.9.1-1ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-aiohttp?arch=source&distro=plucky
    affected_versions: vers:deb/3.9.5-1|3.10.11-1
    fixed_versions: vers:deb/3.10.11-1build1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-42367.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-42367.json
weaknesses: []
references:
  - url: https://github.com/aio-libs/aiohttp/commit/ce2e9758814527589b10759a20783fb03b98339f
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/pull/8653
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiohttp/security/advisories/GHSA-jwhx-xcg6-8xhj
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-42367
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-42367
    reference_type:
    reference_id:
