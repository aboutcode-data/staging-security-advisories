advisory_id: UBUNTU-CVE-2021-20110
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-20110
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-20110.json
aliases:
  - CVE-2021-20110
summary: Due to Manage Engine Asset Explorer Agent 1.0.34 not validating HTTPS certificates,
  an attacker on the network can statically configure their IP address to match the Asset Explorer's
  Server IP address. This will allow an attacker to send a NEWSCAN request to a listening agent
  on the network as well as receive the agent's HTTP request verifying its authtoken. In httphandler.cpp,
  the agent reaching out over HTTP is vulnerable to an Integer Overflow, which can be turned
  into a Heap Overflow allowing for remote code execution as NT AUTHORITY/SYSTEM on the agent
  machine. The Integer Overflow occurs when receiving POST response from the Manage Engine server,
  and the agent calling "HttpQueryInfoW" in order to get the "Content-Length" size from the
  incoming POST request. This size is taken, but multiplied to a larger amount. If an attacker
  specifies a Content-Length size of 1073741823 or larger, this integer arithmetic will wrap
  the value back around to smaller integer, then calls "calloc" with this size to allocate memory.
  The following API "InternetReadFile" will copy the POST data into this buffer, which will
  be too small for the contents, and cause heap overflow.
impacted_packages:
  - purl: pkg:deb/ubuntu/due?arch=source&distro=jammy
    affected_versions: vers:deb/2.3.0-2|3.0.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/due?arch=source&distro=noble
    affected_versions: vers:deb/3.0.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/due?arch=source&distro=questing
    affected_versions: vers:deb/3.0.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-20110.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-20110.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2021-20110
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-20110
    reference_type:
    reference_id:
  - url: https://www.tenable.com/security/research/tra-2021-31
    reference_type:
    reference_id:
