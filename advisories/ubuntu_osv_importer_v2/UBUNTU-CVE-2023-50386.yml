advisory_id: UBUNTU-CVE-2023-50386
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-50386
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-50386.json
aliases:
  - CVE-2023-50386
summary: 'Improper Control of Dynamically-Managed Code Resources, Unrestricted Upload of File
  with Dangerous Type, Inclusion of Functionality from Untrusted Control Sphere vulnerability
  in Apache Solr.This issue affects Apache Solr: from 6.0.0 through 8.11.2, from 9.0.0 before
  9.4.1. In the affected versions, Solr ConfigSets accepted Java jar and class files to be uploaded
  through the ConfigSets API. When backing up Solr Collections, these configSet files would
  be saved to disk when using the LocalFileSystemRepository (the default for backups). If the
  backup was saved to a directory that Solr uses in its ClassPath/ClassLoaders, then the jar
  and class files would be available to use with any ConfigSet, trusted or untrusted. When Solr
  is run in a secure way (Authorization enabled), as is strongly suggested, this vulnerability
  is limited to extending the Backup permissions with the ability to add libraries. Users are
  recommended to upgrade to version 8.11.3 or 9.4.1, which fix the issue. In these versions,
  the following protections have been added: * Users are no longer able to upload files to a
  configSet that could be executed via a Java ClassLoader. * The Backup API restricts saving
  backups to directories that are used in the ClassLoader.'
impacted_packages:
  - purl: pkg:deb/ubuntu/lucene-solr?arch=source&distro=jammy
    affected_versions: vers:deb/<3.6.2+dfsg-24
    fixed_versions: vers:deb/3.6.2+dfsg-24
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-50386.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-50386.json
weaknesses: []
references:
  - url: https://solr.apache.org/security.html#cve-2023-50386-apache-solr-backuprestore-apis-allow-for-deployment-of-executables-in-malicious-configsets
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-50386
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-50386
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2024/02/09/1
    reference_type:
    reference_id:
