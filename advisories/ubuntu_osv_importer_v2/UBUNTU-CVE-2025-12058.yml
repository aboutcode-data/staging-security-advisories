advisory_id: UBUNTU-CVE-2025-12058
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-12058
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-12058.json
aliases:
  - CVE-2025-12058
summary: 'The Keras.Model.load_model method, including when executed with the intended security
  mitigation safe_mode=True, is vulnerable to arbitrary local file loading and Server-Side Request
  Forgery (SSRF). This vulnerability stems from the way the StringLookup layer is handled during
  model loading from a specially crafted .keras archive. The constructor for the StringLookup
  layer accepts a vocabulary argument that can specify a local file path or a remote file path.   *  Arbitrary
  Local File Read: An attacker can create a malicious .keras file that embeds a local path in
  the StringLookup layer''s configuration. When the model is loaded, Keras will attempt to read
  the content of the specified local file and incorporate it into the model state (e.g., retrievable
  via get_vocabulary()), allowing an attacker to read arbitrary local files on the hosting system.   *  Server-Side
  Request Forgery (SSRF): Keras utilizes tf.io.gfile for file operations. Since tf.io.gfile
  supports remote filesystem handlers (such as GCS and HDFS) and HTTP/HTTPS protocols, the same
  mechanism can be leveraged to fetch content from arbitrary network endpoints on the server''s
  behalf, resulting in an SSRF condition. The security issue is that the feature allowing external
  path loading was not properly restricted by the safe_mode=True flag, which was intended to
  prevent such unintended data access.'
impacted_packages:
  - purl: pkg:deb/ubuntu/keras?arch=source&distro=bionic
    affected_versions: vers:deb/1.0.7-2|2.1.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/keras?arch=source&distro=focal
    affected_versions: vers:deb/2.2.4-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:A/AC:H/AT:P/PR:L/UI:P/VC:H/VI:L/VA:L/SC:H/SI:L/SA:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-12058.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-12058.json
weaknesses: []
references:
  - url: https://github.com/keras-team/keras/pull/21751
    reference_type:
    reference_id:
  - url: https://github.com/keras-team/keras/security/advisories/GHSA-qg93-c7p6-gg7f
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-12058
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-12058
    reference_type:
    reference_id:
