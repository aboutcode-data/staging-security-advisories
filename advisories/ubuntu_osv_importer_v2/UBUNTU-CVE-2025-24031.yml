advisory_id: UBUNTU-CVE-2025-24031
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-24031
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24031.json
aliases:
  - CVE-2025-24031
summary: PAM-PKCS#11 is a Linux-PAM login module that allows a X.509 certificate based user
  login. In versions 0.6.12 and prior, the pam_pkcs11 module segfaults when a user presses ctrl-c/ctrl-d
  when they are asked for a PIN. When a user enters no PIN at all, `pam_get_pwd` will never
  initialize the password buffer pointer and as such `cleanse` will try to dereference an uninitialized
  pointer. On my system this pointer happens to have the value 3 most of the time when running
  sudo and as such it will segfault. The most likely impact to a system affected by this issue
  is an availability impact due to a daemon that uses PAM crashing. As of time of publication,
  a patch for the issue is unavailable.
impacted_packages:
  - purl: pkg:deb/ubuntu/pam-pkcs11?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/0.6.8-4|0.6.8-4ubuntu0.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pam-pkcs11?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/0.6.9-1|0.6.9-2|0.6.9-2build1|0.6.9-2build2|0.6.9-2ubuntu0.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pam-pkcs11?arch=source&distro=focal
    affected_versions: vers:deb/0.6.11-2|0.6.11-2ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pam-pkcs11?arch=source&distro=jammy
    affected_versions: vers:deb/0.6.11-4build1|0.6.11-4build2|0.6.11-4ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pam-pkcs11?arch=source&distro=noble
    affected_versions: vers:deb/0.6.12-1|0.6.12-2|0.6.12-2build2|0.6.12-2build3|0.6.12-2ubuntu0.24.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pam-pkcs11?arch=source&distro=questing
    affected_versions: vers:deb/0.6.13-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:N/SI:N/SA:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24031.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24031.json
weaknesses: []
references:
  - url: https://github.com/OpenSC/pam_pkcs11/blob/bb2e3f3a95e44fdf44b0d5a4b377db3179021380/src/pam_pkcs11/pam_pkcs11.c#L211
    reference_type:
    reference_id:
  - url: https://github.com/OpenSC/pam_pkcs11/blob/bb2e3f3a95e44fdf44b0d5a4b377db3179021380/src/pam_pkcs11/pam_pkcs11.c#L797
    reference_type:
    reference_id:
  - url: https://github.com/OpenSC/pam_pkcs11/security/advisories/GHSA-wvr3-c9x3-9mff
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-24031
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-24031
    reference_type:
    reference_id:
