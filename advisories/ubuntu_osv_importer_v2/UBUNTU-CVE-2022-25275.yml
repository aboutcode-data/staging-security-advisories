advisory_id: UBUNTU-CVE-2022-25275
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-25275
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-25275.json
aliases:
  - CVE-2022-25275
summary: In some situations, the Image module does not correctly check access to image files
  not stored in the standard public files directory when generating derivative images using
  the image styles system. Access to a non-public file is checked only if it is stored in the
  "private" file system. However, some contributed modules provide additional file systems,
  or schemes, which may lead to this vulnerability. This vulnerability is mitigated by the fact
  that it only applies when the site sets (Drupal 9) $config['image.settings']['allow_insecure_derivatives']
  or (Drupal 7) $conf['image_allow_insecure_derivatives'] to TRUE. The recommended and default
  setting is FALSE, and Drupal core does not provide a way to change that in the admin UI. Some
  sites may require configuration changes following this security release. Review the release
  notes for your Drupal version if you have issues accessing files or image styles after updating.
impacted_packages:
  - purl: pkg:deb/ubuntu/drupal7?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/7.23-1|7.24-1|7.24-2|7.26-1|7.26-1ubuntu0.1|7.26-1ubuntu0.1+esm1|7.26-1ubuntu0.1+esm2|7.26-1ubuntu0.1+esm3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/drupal7?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/7.38-1|7.41-1|7.44-1ubuntu1~16.04.0|7.44-1ubuntu1~16.04.0+esm1|7.44-1ubuntu1~16.04.0+esm2|7.44-1ubuntu1~16.04.0+esm3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-25275.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-25275.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2022-25275
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-25275
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2022-012
    reference_type:
    reference_id:
