advisory_id: UBUNTU-CVE-2023-3326
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-3326
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-3326.json
aliases:
  - CVE-2023-3326
summary: pam_krb5 authenticates a user by essentially running kinit with the password, getting
  a ticket-granting ticket (tgt) from the Kerberos KDC (Key Distribution Center) over the network,
  as a way to verify the password. However, if a keytab is not provisioned on the system, pam_krb5
  has no way to validate the response from the KDC, and essentially trusts the tgt provided
  over the network as being valid. In a non-default FreeBSD installation that leverages pam_krb5
  for authentication and does not have a keytab provisioned, an attacker that is able to control
  both the password and the KDC responses can return a valid tgt, allowing authentication to
  occur for any user on the system.
impacted_packages:
  - purl: pkg:deb/ubuntu/libpam-krb5?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/4.6-2|4.6-2ubuntu0.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libpam-krb5?arch=source&distro=xenial
    affected_versions: vers:deb/4.7-2|4.7-2ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/sssd?arch=source&distro=xenial
    affected_versions: vers:deb/1.12.5-2|1.13.1-2|1.13.2-1|1.13.3-1|1.13.4-1|1.13.4-1ubuntu1|1.13.4-1ubuntu1.1|1.13.4-1ubuntu1.2|1.13.4-1ubuntu1.5|1.13.4-1ubuntu1.6|1.13.4-1ubuntu1.7|1.13.4-1ubuntu1.8|1.13.4-1ubuntu1.9|1.13.4-1ubuntu1.10|1.13.4-1ubuntu1.11|1.13.4-1ubuntu1.12|1.13.4-1ubuntu1.13|1.13.4-1ubuntu1.14|1.13.4-1ubuntu1.15
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libpam-krb5?arch=source&distro=bionic
    affected_versions: vers:deb/4.7-4|4.8-1|4.8-1ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/sssd?arch=source&distro=bionic
    affected_versions: vers:deb/1.15.3-2ubuntu1|1.15.3-3ubuntu1|1.16.0-5ubuntu1|1.16.0-5ubuntu2|1.16.1-1ubuntu1|1.16.1-1ubuntu1.1|1.16.1-1ubuntu1.2|1.16.1-1ubuntu1.3|1.16.1-1ubuntu1.4|1.16.1-1ubuntu1.5|1.16.1-1ubuntu1.6|1.16.1-1ubuntu1.7|1.16.1-1ubuntu1.8
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libpam-krb5?arch=source&distro=focal
    affected_versions: vers:deb/4.8-2|4.8-2ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/sssd?arch=source&distro=focal
    affected_versions: vers:deb/2.2.0-4ubuntu1|2.2.2-1|2.2.2-1ubuntu1|2.2.3-1.1ubuntu1|2.2.3-2|2.2.3-3|2.2.3-3ubuntu0.1|2.2.3-3ubuntu0.2|2.2.3-3ubuntu0.3|2.2.3-3ubuntu0.4|2.2.3-3ubuntu0.6|2.2.3-3ubuntu0.7|2.2.3-3ubuntu0.8|2.2.3-3ubuntu0.9|2.2.3-3ubuntu0.10|2.2.3-3ubuntu0.11|2.2.3-3ubuntu0.12|2.2.3-3ubuntu0.13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libpam-krb5?arch=source&distro=jammy
    affected_versions: vers:deb/4.9-2build1|4.11-1|4.11-1build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/sssd?arch=source&distro=jammy
    affected_versions: vers:deb/2.4.1-2ubuntu4|2.5.2-4ubuntu1|2.5.2-4ubuntu3|2.5.2-4ubuntu4|2.6.1-1ubuntu3|2.6.3-1ubuntu3|2.6.3-1ubuntu3.1|2.6.3-1ubuntu3.2|2.6.3-1ubuntu3.3|2.6.3-1ubuntu3.4|2.6.3-1ubuntu3.5|2.6.3-1ubuntu3.6
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libpam-krb5?arch=source&distro=noble
    affected_versions: vers:deb/4.11-1build1|4.11-1build2|4.11-1build3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/sssd?arch=source&distro=noble
    affected_versions: vers:deb/2.9.1-2ubuntu2|2.9.1-2ubuntu3|2.9.2-1ubuntu2|2.9.4-1ubuntu1|2.9.4-1.1ubuntu3|2.9.4-1.1ubuntu5|2.9.4-1.1ubuntu6|2.9.4-1.1ubuntu6.1|2.9.4-1.1ubuntu6.2|2.9.4-1.1ubuntu6.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libpam-krb5?arch=source&distro=questing
    affected_versions: vers:deb/4.11-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/sssd?arch=source&distro=questing
    affected_versions: vers:deb/2.10.1-2ubuntu4|2.10.1-2ubuntu5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-3326.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-3326.json
weaknesses: []
references:
  - url: https://seclists.org/oss-sec/2023/q2/245
    reference_type:
    reference_id:
  - url: https://security.FreeBSD.org/advisories/FreeBSD-SA-23:04.pam_krb5.asc
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-3326
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-3326
    reference_type:
    reference_id:
