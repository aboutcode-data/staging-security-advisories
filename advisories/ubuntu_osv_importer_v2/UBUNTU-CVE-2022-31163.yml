advisory_id: UBUNTU-CVE-2022-31163
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-31163
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31163.json
aliases:
  - CVE-2022-31163
summary: TZInfo is a Ruby library that provides access to time zone data and allows times to
  be converted using time zone rules. Versions prior to 0.36.1, as well as those prior to 1.2.10
  when used with the Ruby data source tzinfo-data, are vulnerable to relative path traversal.
  With the Ruby data source, time zones are defined in Ruby files. There is one file per time
  zone. Time zone files are loaded with `require` on demand. In the affected versions, `TZInfo::Timezone.get`
  fails to validate time zone identifiers correctly, allowing a new line character within the
  identifier. With Ruby version 1.9.3 and later, `TZInfo::Timezone.get` can be made to load
  unintended files with `require`, executing them within the Ruby process. Versions 0.3.61 and
  1.2.10 include fixes to correctly validate time zone identifiers. Versions 2.0.0 and later
  are not vulnerable. Version 0.3.61 can still load arbitrary files from the Ruby load path
  if their name follows the rules for a valid time zone identifier and the file has a prefix
  of `tzinfo/definition` within a directory in the load path. Applications should ensure that
  untrusted files are not placed in a directory on the load path. As a workaround, the time
  zone identifier can be validated before passing to `TZInfo::Timezone.get` by ensuring it matches
  the regular expression `\A[A-Za-z0-9+\-_]+(?:\/[A-Za-z0-9+\-_]+)*\z`.
impacted_packages:
  - purl: pkg:deb/ubuntu/ruby-tzinfo?arch=source&distro=xenial
    affected_versions: vers:deb/1.2.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-tzinfo?arch=source&distro=bionic
    affected_versions: vers:deb/1.2.2-2|1.2.3-1|1.2.5-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-tzinfo?arch=source&distro=focal
    affected_versions: vers:deb/1.2.5-1|1.2.6-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-tzinfo?arch=source&distro=jammy
    affected_versions: vers:deb/1.2.6-1|2.0.4-3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-tzinfo?arch=source&distro=noble
    affected_versions: vers:deb/2.0.5-1|2.0.6-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-tzinfo?arch=source&distro=questing
    affected_versions: vers:deb/2.0.6-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31163.json
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31163.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31163.json
weaknesses: []
references:
  - url: https://github.com/tzinfo/tzinfo/commit/ca29f349856d62cb2b2edb3257d9ddd2f97b3c27
    reference_type:
    reference_id:
  - url: https://github.com/tzinfo/tzinfo/releases/tag/v0.3.61
    reference_type:
    reference_id:
  - url: https://github.com/tzinfo/tzinfo/releases/tag/v1.2.10
    reference_type:
    reference_id:
  - url: https://github.com/tzinfo/tzinfo/security/advisories/GHSA-5cm2-9h8c-rvfx
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-31163
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-31163
    reference_type:
    reference_id:
