advisory_id: UBUNTU-CVE-2022-39254
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-39254
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-39254.json
aliases:
  - CVE-2022-39254
summary: matrix-nio is a Python Matrix client library, designed according to sans I/O principles.
  Prior to version 0.20, when a users requests a room key from their devices, the software correctly
  remember the request. Once they receive a forwarded room key, they accept it without checking
  who the room key came from. This allows homeservers to try to insert room keys of questionable
  validity, potentially mounting an impersonation attack. Version 0.20 fixes the issue.
impacted_packages:
  - purl: pkg:deb/ubuntu/python-matrix-nio?arch=source&distro=jammy
    affected_versions: vers:deb/0.16.0-1|0.18.7-1|0.19.0-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-matrix-nio?arch=source&distro=noble
    affected_versions: vers:deb/0.21.2-1|0.23.0-1|0.24.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-matrix-nio?arch=source&distro=questing
    affected_versions: vers:deb/0.25.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-39254.json
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-39254.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-39254.json
weaknesses: []
references:
  - url: https://github.com/poljar/matrix-nio/commit/b1cbf234a831daa160673defd596e6450e9c29f0
    reference_type:
    reference_id:
  - url: https://github.com/poljar/matrix-nio/security/advisories/GHSA-w4pr-4vjg-hffh
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-39254
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-39254
    reference_type:
    reference_id:
