advisory_id: UBUNTU-CVE-2024-41957
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-41957
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-41957.json
aliases:
  - CVE-2024-41957
summary: Vim is an open source command line text editor. Vim < v9.1.0647 has double free in
  src/alloc.c:616. When closing a window, the corresponding tagstack data will be cleared and
  freed. However a bit later, the quickfix list belonging to that window will also be cleared
  and if that quickfix list points to the same tagstack data, Vim will try to free it again,
  resulting in a double-free/use-after-free access exception. Impact is low since the user must
  intentionally execute vim with several non-default flags, but it may cause a crash of Vim.
  The issue has been fixed as of Vim patch v9.1.0647
impacted_packages:
  - purl: pkg:deb/ubuntu/vim?arch=source&distro=trusty/esm
    affected_versions: vers:deb/2:7.4.000-1ubuntu2|2:7.4.052-1ubuntu1|2:7.4.052-1ubuntu2|2:7.4.052-1ubuntu3|2:7.4.052-1ubuntu3.1|2:7.4.052-1ubuntu3.1+esm1|2:7.4.052-1ubuntu3.1+esm3|2:7.4.052-1ubuntu3.1+esm4|2:7.4.052-1ubuntu3.1+esm5|2:7.4.052-1ubuntu3.1+esm6|2:7.4.052-1ubuntu3.1+esm7|2:7.4.052-1ubuntu3.1+esm8|2:7.4.052-1ubuntu3.1+esm9|2:7.4.052-1ubuntu3.1+esm10|2:7.4.052-1ubuntu3.1+esm11|2:7.4.052-1ubuntu3.1+esm12|2:7.4.052-1ubuntu3.1+esm13|2:7.4.052-1ubuntu3.1+esm14|2:7.4.052-1ubuntu3.1+esm15|2:7.4.052-1ubuntu3.1+esm16|2:7.4.052-1ubuntu3.1+esm17
    fixed_versions: vers:deb/2:7.4.052-1ubuntu3.1+esm18
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/vim?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/2:7.4.712-2ubuntu4|2:7.4.826-1ubuntu1|2:7.4.826-1ubuntu2|2:7.4.826-1ubuntu3|2:7.4.963-1ubuntu1|2:7.4.963-1ubuntu4|2:7.4.963-1ubuntu5|2:7.4.1689-3ubuntu1|2:7.4.1689-3ubuntu1.1|2:7.4.1689-3ubuntu1.2|2:7.4.1689-3ubuntu1.3|2:7.4.1689-3ubuntu1.4|2:7.4.1689-3ubuntu1.5|2:7.4.1689-3ubuntu1.5+esm2|2:7.4.1689-3ubuntu1.5+esm3|2:7.4.1689-3ubuntu1.5+esm4|2:7.4.1689-3ubuntu1.5+esm5|2:7.4.1689-3ubuntu1.5+esm6|2:7.4.1689-3ubuntu1.5+esm7|2:7.4.1689-3ubuntu1.5+esm8|2:7.4.1689-3ubuntu1.5+esm10|2:7.4.1689-3ubuntu1.5+esm11|2:7.4.1689-3ubuntu1.5+esm12|2:7.4.1689-3ubuntu1.5+esm13|2:7.4.1689-3ubuntu1.5+esm14|2:7.4.1689-3ubuntu1.5+esm15|2:7.4.1689-3ubuntu1.5+esm17|2:7.4.1689-3ubuntu1.5+esm18|2:7.4.1689-3ubuntu1.5+esm19|2:7.4.1689-3ubuntu1.5+esm20|2:7.4.1689-3ubuntu1.5+esm22|2:7.4.1689-3ubuntu1.5+esm23
    fixed_versions: vers:deb/2:7.4.1689-3ubuntu1.5+esm24
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/vim?arch=source&distro=esm-infra/bionic
    affected_versions: vers:deb/2:8.0.0197-4ubuntu5|2:8.0.1144-1ubuntu1|2:8.0.1401-1ubuntu1|2:8.0.1401-1ubuntu2|2:8.0.1401-1ubuntu3|2:8.0.1453-1ubuntu1|2:8.0.1453-1ubuntu1.1|2:8.0.1453-1ubuntu1.3|2:8.0.1453-1ubuntu1.4|2:8.0.1453-1ubuntu1.6|2:8.0.1453-1ubuntu1.7|2:8.0.1453-1ubuntu1.8|2:8.0.1453-1ubuntu1.9|2:8.0.1453-1ubuntu1.10|2:8.0.1453-1ubuntu1.11|2:8.0.1453-1ubuntu1.12|2:8.0.1453-1ubuntu1.13|2:8.0.1453-1ubuntu1.13+esm1|2:8.0.1453-1ubuntu1.13+esm3|2:8.0.1453-1ubuntu1.13+esm4|2:8.0.1453-1ubuntu1.13+esm5|2:8.0.1453-1ubuntu1.13+esm6|2:8.0.1453-1ubuntu1.13+esm7|2:8.0.1453-1ubuntu1.13+esm8
    fixed_versions: vers:deb/2:8.0.1453-1ubuntu1.13+esm9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/vim?arch=source&distro=focal
    affected_versions: vers:deb/2:8.1.0875-5ubuntu2|2:8.1.0875-5ubuntu3|2:8.1.0875-5ubuntu4|2:8.1.2269-1ubuntu1|2:8.1.2269-1ubuntu4|2:8.1.2269-1ubuntu5|2:8.1.2269-1ubuntu5.3|2:8.1.2269-1ubuntu5.4|2:8.1.2269-1ubuntu5.6|2:8.1.2269-1ubuntu5.7|2:8.1.2269-1ubuntu5.8|2:8.1.2269-1ubuntu5.9|2:8.1.2269-1ubuntu5.11|2:8.1.2269-1ubuntu5.12|2:8.1.2269-1ubuntu5.13|2:8.1.2269-1ubuntu5.14|2:8.1.2269-1ubuntu5.15|2:8.1.2269-1ubuntu5.16|2:8.1.2269-1ubuntu5.17|2:8.1.2269-1ubuntu5.18|2:8.1.2269-1ubuntu5.20|2:8.1.2269-1ubuntu5.21|2:8.1.2269-1ubuntu5.22|2:8.1.2269-1ubuntu5.23
    fixed_versions: vers:deb/2:8.1.2269-1ubuntu5.24
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/vim?arch=source&distro=jammy
    affected_versions: vers:deb/2:8.2.2434-3ubuntu3|2:8.2.2434-3ubuntu4|2:8.2.3565-1ubuntu1|2:8.2.3565-1ubuntu2|2:8.2.3565-1ubuntu3|2:8.2.3565-1ubuntu5|2:8.2.3995-1ubuntu1|2:8.2.3995-1ubuntu2|2:8.2.3995-1ubuntu2.1|2:8.2.3995-1ubuntu2.3|2:8.2.3995-1ubuntu2.4|2:8.2.3995-1ubuntu2.5|2:8.2.3995-1ubuntu2.7|2:8.2.3995-1ubuntu2.8|2:8.2.3995-1ubuntu2.9|2:8.2.3995-1ubuntu2.10|2:8.2.3995-1ubuntu2.11|2:8.2.3995-1ubuntu2.12|2:8.2.3995-1ubuntu2.13|2:8.2.3995-1ubuntu2.15|2:8.2.3995-1ubuntu2.16|2:8.2.3995-1ubuntu2.17
    fixed_versions: vers:deb/2:8.2.3995-1ubuntu2.18
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/vim?arch=source&distro=noble
    affected_versions: vers:deb/2:9.0.1672-1ubuntu2|2:9.0.2087-1ubuntu1|2:9.0.2116-1ubuntu1|2:9.0.2116-1ubuntu2|2:9.0.2184-0ubuntu1|2:9.0.2189-1ubuntu1|2:9.1.0-1ubuntu1|2:9.1.0016-1ubuntu2|2:9.1.0016-1ubuntu6|2:9.1.0016-1ubuntu7|2:9.1.0016-1ubuntu7.1
    fixed_versions: vers:deb/2:9.1.0016-1ubuntu7.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-41957.json
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-41957.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-41957.json
weaknesses: []
references:
  - url: https://github.com/vim/vim/security/advisories/GHSA-f9cr-gv85-hcr4
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-41957
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6993-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-41957
    reference_type:
    reference_id:
