advisory_id: UBUNTU-CVE-2024-8013
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-8013
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-8013.json
aliases:
  - CVE-2024-8013
summary: A bug in query analysis of certain complex self-referential $lookup subpipelines may
  result in literal values in expressions for encrypted fields to be sent to the server as plaintext
  instead of ciphertext. Should this occur, no documents would be returned or written. This
  issue affects mongocryptd binary (v5.0 versions prior to 5.0.29, v6.0 versions prior to 6.0.17,
  v7.0 versions prior to 7.0.12 and v7.3 versions prior to 7.3.4) and mongo_crypt_v1.so shared
  libraries (v6.0 versions prior to 6.0.17, v7.0 versions prior to 7.0.12 and v7.3 versions
  prior to 7.3.4) released alongside MongoDB Enterprise Server versions.
impacted_packages:
  - purl: pkg:deb/ubuntu/mongodb?arch=source&distro=trusty
    affected_versions: vers:deb/1:2.4.6-0ubuntu5|1:2.4.6-0ubuntu6|1:2.4.8-1ubuntu1|1:2.4.8-2|1:2.4.9-1|1:2.4.9-1ubuntu1|1:2.4.9-1ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/mongodb?arch=source&distro=xenial
    affected_versions: vers:deb/1:2.6.10-0ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/mongodb?arch=source&distro=bionic
    affected_versions: vers:deb/1:3.4.7-1|1:3.4.7-1ubuntu1|1:3.4.7-1ubuntu2|1:3.4.7-1ubuntu4|1:3.4.14-3ubuntu1|1:3.4.14-3ubuntu2|1:3.6.3-0ubuntu1|1:3.6.3-0ubuntu1.1|1:3.6.3-0ubuntu1.3|1:3.6.3-0ubuntu1.4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/mongodb?arch=source&distro=focal
    affected_versions: vers:deb/1:3.6.9+really3.6.8+90~g8e540c0b6d-0ubuntu2|1:3.6.9+really3.6.8+90~g8e540c0b6d-0ubuntu5|1:3.6.9+really3.6.8+90~g8e540c0b6d-0ubuntu5.2|1:3.6.9+really3.6.8+90~g8e540c0b6d-0ubuntu5.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-8013.json
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-8013.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-8013.json
weaknesses: []
references:
  - url: https://jira.mongodb.org/browse/SERVER-96254
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-8013
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-8013
    reference_type:
    reference_id:
