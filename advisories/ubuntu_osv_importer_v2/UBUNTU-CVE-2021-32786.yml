advisory_id: UBUNTU-CVE-2021-32786
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-32786
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32786.json
aliases:
  - CVE-2021-32786
summary: mod_auth_openidc is an authentication/authorization module for the Apache 2.x HTTP
  server that functions as an OpenID Connect Relying Party, authenticating users against an
  OpenID Connect Provider. In versions prior to 2.4.9, `oidc_validate_redirect_url()` does not
  parse URLs the same way as most browsers do. As a result, this function can be bypassed and
  leads to an Open Redirect vulnerability in the logout functionality. This bug has been fixed
  in version 2.4.9 by replacing any backslash of the URL to redirect with slashes to address
  a particular breaking change between the different specifications (RFC2396 / RFC3986 and WHATWG).
  As a workaround, this vulnerability can be mitigated by configuring `mod_auth_openidc` to
  only allow redirection whose destination matches a given regular expression.
impacted_packages:
  - purl: pkg:deb/ubuntu/libapache2-mod-auth-openidc?arch=source&distro=bionic
    affected_versions: vers:deb/2.1.6-1|2.3.1-2|2.3.2-1|2.3.2-1build1|2.3.3-1build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libapache2-mod-auth-openidc?arch=source&distro=focal
    affected_versions: vers:deb/2.3.10.2-1|2.4.0.4-1|2.4.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32786.json
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32786.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32786.json
weaknesses: []
references:
  - url: https://daniel.haxx.se/blog/2017/01/30/one-url-standard-please/
    reference_type:
    reference_id:
  - url: https://github.com/zmartzone/mod_auth_openidc/commit/3a115484eb927bc6daa5737dd84f88ff4bbc5544
    reference_type:
    reference_id:
  - url: https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9
    reference_type:
    reference_id:
  - url: https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-xm4c-5wm5-jqv7
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-32786
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-32786
    reference_type:
    reference_id:
