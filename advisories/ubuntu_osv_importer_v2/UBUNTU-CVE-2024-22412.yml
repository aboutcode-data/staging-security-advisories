advisory_id: UBUNTU-CVE-2024-22412
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-22412
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-22412.json
aliases:
  - CVE-2024-22412
summary: ClickHouse is an open-source column-oriented database management system. A bug exists
  in the cloud ClickHouse offering prior to version 24.0.2.54535 and in github.com/clickhouse/clickhouse
  version 23.1. Query caching bypasses the role based access controls and the policies being
  enforced on roles. In affected versions, the query cache only respects separate users, however
  this is not documented and not expected behavior. People relying on ClickHouse roles can have
  their access control lists bypassed if they are using query caching. Attackers who have control
  of a role could guess queries and see data they shouldn't have access to. Version 24.1 of
  ClickHouse and version 24.0.2.54535 of ClickHouse Cloud contain a patch for this issue. Based
  on the documentation, role based access control should be enforced regardless if query caching
  is enabled or not.
impacted_packages:
  - purl: pkg:deb/ubuntu/clickhouse?arch=source&distro=focal
    affected_versions: vers:deb/18.16.1+ds-5|18.16.1+ds-5ubuntu1|18.16.1+ds-5ubuntu2|18.16.1+ds-6ubuntu1|18.16.1+ds-7|18.16.1+ds-7ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/clickhouse?arch=source&distro=noble
    affected_versions: vers:deb/18.16.1+ds-7.4|18.16.1+ds-7.4build1|18.16.1+ds-7.4build2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '2.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-22412.json
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-22412.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-22412.json
weaknesses: []
references:
  - url: https://github.com/ClickHouse/ClickHouse/pull/58611
    reference_type:
    reference_id:
  - url: https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-45h5-f7g3-gr8r
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-22412
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-22412
    reference_type:
    reference_id:
