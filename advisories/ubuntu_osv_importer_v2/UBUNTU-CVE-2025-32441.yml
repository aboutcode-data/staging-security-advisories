advisory_id: UBUNTU-CVE-2025-32441
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-32441
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-32441.json
aliases:
  - CVE-2025-32441
summary: Rack is a modular Ruby web server interface. Prior to version 2.2.14, when using the
  `Rack::Session::Pool` middleware, simultaneous rack requests can restore a deleted rack session,
  which allows the unauthenticated user to occupy that session. Rack session middleware prepares
  the session at the beginning of request, then saves is back to the store with possible changes
  applied by host rack application. This way the session becomes to be a subject of race conditions
  in general sense over concurrent rack requests. When using the `Rack::Session::Pool` middleware,
  and provided the attacker can acquire a session cookie (already a major issue), the session
  may be restored if the attacker can trigger a long running request (within that same session)
  adjacent to the user logging out, in order to retain illicit access even after a user has
  attempted to logout. Version 2.2.14 contains a patch for the issue. Some other mitigations
  are available. Either ensure the application invalidates sessions atomically by marking them
  as logged out e.g., using a `logged_out` flag, instead of deleting them, and check this flag
  on every request to prevent reuse; or implement a custom session store that tracks session
  invalidation timestamps and refuses to accept session data if the session was invalidated
  after the request began.
impacted_packages:
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/1.5.2-1|1.5.2-1ubuntu0.1~esm1|1.5.2-3+deb8u3ubuntu1~esm2|1.5.2-3+deb8u3ubuntu1~esm3|1.5.2-3+deb8u3ubuntu1~esm4|1.5.2-3+deb8u3ubuntu1~esm6|1.5.2-3+deb8u3ubuntu1~esm7|1.5.2-3+deb8u3ubuntu1~esm8|1.5.2-3+deb8u3ubuntu1~esm9
    fixed_versions: vers:deb/1.5.2-3+deb8u3ubuntu1~esm10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.5.2-4|1.6.4-2|1.6.4-3|1.6.4-3ubuntu0.1|1.6.4-3ubuntu0.2|1.6.4-3ubuntu0.2+esm1|1.6.4-3ubuntu0.2+esm2|1.6.4-3ubuntu0.2+esm4|1.6.4-3ubuntu0.2+esm5|1.6.4-3ubuntu0.2+esm6|1.6.4-3ubuntu0.2+esm7
    fixed_versions: vers:deb/1.6.4-3ubuntu0.2+esm8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.6.4-4|1.6.4-4ubuntu0.1|1.6.4-4ubuntu0.2|1.6.4-4ubuntu0.2+esm1|1.6.4-4ubuntu0.2+esm2|1.6.4-4ubuntu0.2+esm4|1.6.4-4ubuntu0.2+esm5|1.6.4-4ubuntu0.2+esm6|1.6.4-4ubuntu0.2+esm7
    fixed_versions: vers:deb/1.6.4-4ubuntu0.2+esm8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/2.0.6-3|2.0.7-2|2.0.7-2ubuntu0.1|2.0.7-2ubuntu0.1+esm1|2.0.7-2ubuntu0.1+esm2|2.0.7-2ubuntu0.1+esm3|2.0.7-2ubuntu0.1+esm4|2.0.7-2ubuntu0.1+esm5|2.0.7-2ubuntu0.1+esm6
    fixed_versions: vers:deb/2.0.7-2ubuntu0.1+esm7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/2.1.4-3|2.1.4-4|2.1.4-5|2.1.4-5ubuntu1|2.1.4-5ubuntu1+esm2|2.1.4-5ubuntu1+esm3|2.1.4-5ubuntu1+esm4|2.1.4-5ubuntu1+esm5|2.1.4-5ubuntu1.1|2.1.4-5ubuntu1.1+esm1
    fixed_versions: vers:deb/2.1.4-5ubuntu1.1+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=noble
    affected_versions: vers:deb/2.2.4-3|2.2.7-1|2.2.7-1ubuntu0.1|2.2.7-1ubuntu0.2
    fixed_versions: vers:deb/2.2.7-1ubuntu0.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=questing
    affected_versions: vers:deb/2.2.7-1.1
    fixed_versions: vers:deb/3.1.16-0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-32441.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-32441.json
weaknesses: []
references:
  - url: https://github.com/rack/rack/blob/v2.2.13/lib/rack/session/abstract/id.rb#L263-L270
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/c48e52f7c57e99e1e1bf54c8760d4f082cd1c89d
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/security/advisories/GHSA-vpfw-47h7-xj4g
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-32441
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7507-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-32441
    reference_type:
    reference_id:
