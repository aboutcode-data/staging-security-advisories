advisory_id: UBUNTU-CVE-2023-48706
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-48706
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-48706.json
aliases:
  - CVE-2023-48706
summary: Vim is a UNIX editor that, prior to version 9.0.2121, has a heap-use-after-free vulnerability.
  When executing a `:s` command for the very first time and using a sub-replace-special atom
  inside the substitution part, it is possible that the recursive `:s` call causes free-ing
  of memory which may later then be accessed by the initial `:s` command. The user must intentionally
  execute the payload and the whole process is a bit tricky to do since it seems to work only
  reliably for the very first :s command. It may also cause a crash of Vim. Version 9.0.2121
  contains a fix for this issue.
impacted_packages:
  - purl: pkg:deb/ubuntu/vim?arch=source&distro=jammy
    affected_versions: vers:deb/2:8.2.2434-3ubuntu3|2:8.2.2434-3ubuntu4|2:8.2.3565-1ubuntu1|2:8.2.3565-1ubuntu2|2:8.2.3565-1ubuntu3|2:8.2.3565-1ubuntu5|2:8.2.3995-1ubuntu1|2:8.2.3995-1ubuntu2|2:8.2.3995-1ubuntu2.1|2:8.2.3995-1ubuntu2.3|2:8.2.3995-1ubuntu2.4|2:8.2.3995-1ubuntu2.5|2:8.2.3995-1ubuntu2.7|2:8.2.3995-1ubuntu2.8|2:8.2.3995-1ubuntu2.9|2:8.2.3995-1ubuntu2.10|2:8.2.3995-1ubuntu2.11|2:8.2.3995-1ubuntu2.12|2:8.2.3995-1ubuntu2.13
    fixed_versions: vers:deb/2:8.2.3995-1ubuntu2.15
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/vim?arch=source&distro=noble
    affected_versions: vers:deb/2:9.0.1672-1ubuntu2|2:9.0.2087-1ubuntu1|2:9.0.2116-1ubuntu1
    fixed_versions: vers:deb/2:9.0.2116-1ubuntu2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-48706.json
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-48706.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-48706.json
weaknesses: []
references:
  - url: https://github.com/gandalf4a/crash_report/blob/main/vim/vim_huaf
    reference_type:
    reference_id:
  - url: https://github.com/vim/vim/pull/13552
    reference_type:
    reference_id:
  - url: https://github.com/vim/vim/security/advisories/GHSA-c8qm-x72m-q53q
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-48706
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6557-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-48706
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/11/22/3
    reference_type:
    reference_id:
