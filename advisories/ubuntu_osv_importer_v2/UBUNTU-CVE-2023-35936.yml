advisory_id: UBUNTU-CVE-2023-35936
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-35936
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35936.json
aliases:
  - CVE-2023-35936
summary: Pandoc is a Haskell library for converting from one markup format to another, and a
  command-line tool that uses this library. Starting in version 1.13 and prior to version 3.1.4,
  Pandoc is susceptible to an arbitrary file write vulnerability, which can be triggered by
  providing a specially crafted image element in the input when generating files using the `--extract-media`
  option or outputting to PDF format. This vulnerability allows an attacker to create or overwrite
  arbitrary files on the system ,depending on the privileges of the process running pandoc.
  It only affects systems that pass untrusted user input to pandoc and allow pandoc to be used
  to produce a PDF or with the `--extract-media` option. The fix is to unescape the percent-encoding
  prior to checking that the resource is not above the working directory, and prior to extracting
  the extension.  Some code for checking that the path is below the working directory was flawed
  in a similar way and has also been fixed. Note that the `--sandbox` option, which only affects
  IO done by readers and writers themselves, does not block this vulnerability. The vulnerability
  is patched in pandoc 3.1.4. As a workaround, audit the pandoc command and disallow PDF output
  and the `--extract-media` option.
impacted_packages:
  - purl: pkg:deb/ubuntu/pandoc?arch=source&distro=trusty
    affected_versions: vers:deb/1.11.1-2build2|1.11.1-4|1.11.1-5|1.12.2.1-1|1.12.2.1-1build1|1.12.2.1-1build2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pandoc?arch=source&distro=xenial
    affected_versions: vers:deb/1.13.2.1~dfsg-1build6|1.15.1.1~dfsg-2|1.15.1.1~dfsg-2build1|1.16.0.2~dfsg-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pandoc?arch=source&distro=bionic
    affected_versions: vers:deb/1.19.2.1.0-1|1.19.2.4~dfsg-1build1|1.19.2.4~dfsg-1build2|1.19.2.4~dfsg-1build3|1.19.2.4~dfsg-1build4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pandoc?arch=source&distro=focal
    affected_versions: vers:deb/2.5-2|2.5-3|2.5-3build1|2.5-3build2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pandoc?arch=source&distro=jammy
    affected_versions: vers:deb/2.9.2.1-1ubuntu4|2.9.2.1-3ubuntu1|2.9.2.1-3ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pandoc?arch=source&distro=noble
    affected_versions: vers:deb/2.17.1.1-3ubuntu1|3.0.1+ds-3|3.1.3+ds-1|3.1.3+ds-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/pandoc?arch=source&distro=questing
    affected_versions: vers:deb/3.1.11.1+ds-2|3.1.11.1+ds-4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35936.json
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:N/I:H/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35936.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35936.json
weaknesses: []
references:
  - url: https://github.com/jgm/pandoc/security/advisories/GHSA-xj5q-fv23-575g
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-35936
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-35936
    reference_type:
    reference_id:
