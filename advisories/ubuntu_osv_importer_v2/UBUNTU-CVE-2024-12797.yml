advisory_id: UBUNTU-CVE-2024-12797
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-12797
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-12797.json
aliases:
  - CVE-2024-12797
summary: 'Issue summary: Clients using RFC7250 Raw Public Keys (RPKs) to authenticate a server
  may fail to notice that the server was not authenticated, because handshakes don''t abort
  as expected when the SSL_VERIFY_PEER verification mode is set. Impact summary: TLS and DTLS
  connections using raw public keys may be vulnerable to man-in-middle attacks when server authentication
  failure is not detected by clients. RPKs are disabled by default in both TLS clients and TLS
  servers.  The issue only arises when TLS clients explicitly enable RPK use by the server,
  and the server, likewise, enables sending of an RPK instead of an X.509 certificate chain.  The
  affected clients are those that then rely on the handshake to fail when the server''s RPK
  fails to match one of the expected public keys, by setting the verification mode to SSL_VERIFY_PEER.
  Clients that enable server-side raw public keys can still find out that raw public key verification
  failed by calling SSL_get_verify_result(), and those that do, and take appropriate action,
  are not affected.  This issue was introduced in the initial implementation of RPK support
  in OpenSSL 3.2. The FIPS modules in 3.4, 3.3, 3.2, 3.1 and 3.0 are not affected by this issue.'
impacted_packages:
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=plucky
    affected_versions: vers:deb/3.3.1-2ubuntu2|3.4.0-1ubuntu2
    fixed_versions: vers:deb/3.4.1-1ubuntu1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-12797.json
  - score: high
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-12797.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2024-12797
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7264-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-12797
    reference_type:
    reference_id:
  - url: https://openssl-library.org/news/secadv/20250211.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
