advisory_id: UBUNTU-CVE-2026-24765
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2026-24765
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-24765.json
aliases:
  - CVE-2026-24765
summary: PHPUnit is a testing framework for PHP. A vulnerability has been discovered in versions
  prior to 12.5.8, 11.5.50, 10.5.62, 9.6.33, and 8.5.52 involving unsafe deserialization of
  code coverage data in PHPT test execution. The vulnerability exists in the `cleanupForCoverage()`
  method, which deserializes code coverage files without validation, potentially allowing remote
  code execution if malicious `.coverage` files are present prior to the execution of the PHPT
  test. The vulnerability occurs when a `.coverage` file, which should not exist before test
  execution, is deserialized without the `allowed_classes` parameter restriction. An attacker
  with local file write access can place a malicious serialized object with a `__wakeup()` method
  into the file system, leading to arbitrary code execution during test runs with code coverage
  instrumentation enabled. This vulnerability requires local file write access to the location
  where PHPUnit stores or expects code coverage files for PHPT tests. This can occur through
  CI/CD pipeline attacks, the local development environment, and/or compromised dependencies.
  Rather than just silently sanitizing the input via `['allowed_classes' => false]`, the maintainer
  has chosen to make the anomalous state explicit by treating pre-existing `.coverage` files
  for PHPT tests as an error condition. Starting in versions  in versions 12.5.8, 11.5.50, 10.5.62,
  9.6.33, when a `.coverage` file is detected for a PHPT test prior to execution, PHPUnit will
  emit a clear error message identifying the anomalous state. Organizations can reduce the effective
  risk of this vulnerability through proper CI/CD configuration, including ephemeral runners,
  code review enforcement, branch protection, artifact isolation, and access control.
impacted_packages:
  - purl: pkg:deb/ubuntu/phpunit?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/4.7.6-1|4.8.16-1|5.1.3-1ubuntu1|5.1.3-1+build1|5.1.3-1+ubuntu1|5.1.3-1+ubuntu3|5.1.3-1+ubuntu3+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/phpunit?arch=source&distro=bionic
    affected_versions: vers:deb/5.4.6-2|5.4.6-3|6.5.5-1ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/phpunit?arch=source&distro=focal
    affected_versions: vers:deb/7.5.6-1|8.5.2-1ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/phpunit?arch=source&distro=jammy
    affected_versions: vers:deb/9.5.4-1|9.5.10-1ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/phpunit?arch=source&distro=noble
    affected_versions: vers:deb/9.6.10-1|9.6.13-1|9.6.15-1|9.6.16-1|9.6.17-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/phpunit?arch=source&distro=questing
    affected_versions: vers:deb/11.5.3-1ubuntu4|11.5.19-1build4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-24765.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-24765.json
weaknesses: []
references:
  - url: https://github.com/sebastianbergmann/phpunit/commit/3141742e00620e2968d3d2e732d320de76685fda
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/releases/tag/10.5.63
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/releases/tag/11.5.50
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/releases/tag/12.5.8
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/releases/tag/8.5.52
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/releases/tag/9.6.33
    reference_type:
    reference_id:
  - url: https://github.com/sebastianbergmann/phpunit/security/advisories/GHSA-vvj3-c3rp-c85p
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2026-24765
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2026-24765
    reference_type:
    reference_id:
