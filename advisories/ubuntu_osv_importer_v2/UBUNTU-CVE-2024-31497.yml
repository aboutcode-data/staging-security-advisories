advisory_id: UBUNTU-CVE-2024-31497
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-31497
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31497.json
aliases:
  - CVE-2024-31497
summary: In PuTTY 0.68 through 0.80 before 0.81, biased ECDSA nonce generation allows an attacker
  to recover a user's NIST P-521 secret key via a quick attack in approximately 60 signatures.
  This is especially important in a scenario where an adversary is able to read messages signed
  by PuTTY or Pageant. The required set of signed messages may be publicly readable because
  they are stored in a public Git service that supports use of SSH for commit signing, and the
  signatures were made by Pageant through an agent-forwarding mechanism. In other words, an
  adversary may already have enough signature information to compromise a victim's private key,
  even if there is no further use of vulnerable PuTTY versions. After a key compromise, an adversary
  may be able to conduct supply-chain attacks on software maintained in Git. A second, independent
  scenario is that the adversary is an operator of an SSH server to which the victim authenticates
  (for remote login or file copy), even though this server is not fully trusted by the victim,
  and the victim uses the same private key for SSH connections to other services operated by
  other entities. Here, the rogue server operator (who would otherwise have no way to determine
  the victim's private key) can derive the victim's private key, and then use it for unauthorized
  access to those other services. If the other services include Git services, then again it
  may be possible to conduct supply-chain attacks on software maintained in Git. This also affects,
  for example, FileZilla before 3.67.0, WinSCP before 6.3.3, TortoiseGit before 2.15.0.1, and
  TortoiseSVN through 1.14.6.
impacted_packages:
  - purl: pkg:deb/ubuntu/filezilla?arch=source&distro=xenial
    affected_versions: vers:deb/3.12.0.2-1ubuntu2|3.14.1-1ubuntu1|3.15.0.2-0ubuntu1|3.15.0.2-1ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/putty?arch=source&distro=xenial
    affected_versions: vers:deb/0.65-2|0.66-1|0.66-2|0.66-3|0.66-4|0.67-1|0.67-2|0.67-3build0.16.04.1|0.67-3+deb9u1build0.16.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/filezilla?arch=source&distro=bionic
    affected_versions: vers:deb/3.27.0~rc1-1|3.28.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/putty?arch=source&distro=bionic
    affected_versions: vers:deb/0.70-1|0.70-2|0.70-3|0.70-4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/filezilla?arch=source&distro=focal
    affected_versions: vers:deb/3.39.0-2|3.45.1-3|3.45.1-3build1|3.46.3-1~build1|3.46.3-1|3.46.3-1build1|3.46.3-1ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/putty?arch=source&distro=focal
    affected_versions: vers:deb/0.72-1|0.73-1|0.73-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/filezilla?arch=source&distro=jammy
    affected_versions: vers:deb/3.52.2-3|3.56.0-1|3.56.2-1|3.57.0-1|3.57.0-1build1|3.58.0-1|3.58.0-1ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/putty?arch=source&distro=jammy
    affected_versions: vers:deb/0.75-3|0.76-1|0.76-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/filezilla?arch=source&distro=noble
    affected_versions: vers:deb/3.65.0-3|3.66.1-2|3.66.1-3|3.66.1-3.2|3.66.1-4|3.66.4-1|3.66.4-2|3.66.5-2|3.66.5-2build1|3.66.5-2build2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31497.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31497.json
weaknesses: []
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2275183
    reference_type:
    reference_id:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=1222864
    reference_type:
    reference_id:
  - url: https://docs.ccv.brown.edu/oscar/connecting-to-oscar/ssh/ssh-agent-forwarding/key-generation-and-agent-forwarding-with-putty
    reference_type:
    reference_id:
  - url: https://filezilla-project.org/versions.php
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-6p4c-r453-8743
    reference_type:
    reference_id:
  - url: https://github.com/daedalus/BreakingECDSAwithLLL
    reference_type:
    reference_id:
  - url: https://git.tartarus.org/?h=c193fe9848f50a88a4089aac647fecc31ae96d27&p=simon/putty.git
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WMJH7M663BVO3SY6MFAW2FAZWLLXAPRQ/
    reference_type:
    reference_id:
  - url: https://news.ycombinator.com/item?id=40044665
    reference_type:
    reference_id:
  - url: https://securityonline.info/cve-2024-31497-critical-putty-vulnerability-exposes-private-keys-immediate-action-required/
    reference_type:
    reference_id:
  - url: https://security-tracker.debian.org/tracker/CVE-2024-31497
    reference_type:
    reference_id:
  - url: https://tartarus.org/~simon/putty-snapshots/htmldoc/Chapter9.html#pageant-forward
    reference_type:
    reference_id:
  - url: https://tortoisegit.org
    reference_type:
    reference_id:
  - url: https://twitter.com/CCBalert/status/1780229237569470549
    reference_type:
    reference_id:
  - url: https://twitter.com/lambdafu/status/1779969509522133272
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-31497
    reference_type:
    reference_id:
  - url: https://winscp.net/eng/news.php
    reference_type:
    reference_id:
  - url: https://www.bleepingcomputer.com/news/security/putty-ssh-client-flaw-allows-recovery-of-cryptographic-private-keys/
    reference_type:
    reference_id:
  - url: https://www.chiark.greenend.org.uk/~sgtatham/putty/changes.html
    reference_type:
    reference_id:
  - url: https://www.chiark.greenend.org.uk/~sgtatham/putty/wishlist/vuln-p521-bias.html
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-31497
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2024/04/15/6
    reference_type:
    reference_id:
  - url: https://www.reddit.com/r/sysadmin/comments/1c4wmoj/putty_vulnerability_affecting_v068_to_v08/
    reference_type:
    reference_id:
