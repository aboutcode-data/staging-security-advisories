advisory_id: UBUNTU-CVE-2021-3838
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-3838
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-3838.json
aliases:
  - CVE-2021-3838
summary: DomPDF before version 2.0.0 is vulnerable to PHAR deserialization due to a lack of
  checking on the protocol before passing it into the file_get_contents() function. An attacker
  who can upload files of any type to the server can pass in the phar:// protocol to unserialize
  the uploaded file and instantiate arbitrary PHP objects. This can lead to remote code execution,
  especially when DOMPdf is used with frameworks with documented POP chains like Laravel or
  vulnerable developer code.
impacted_packages:
  - purl: pkg:deb/ubuntu/php-dompdf?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/0.6.1+dfsg-2|0.6.1+dfsg-2build1|0.6.1+dfsg-2ubuntu1
    fixed_versions: vers:deb/0.6.1+dfsg-2ubuntu1+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/php-dompdf?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/0.6.2+dfsg-3
    fixed_versions: vers:deb/0.6.2+dfsg-3ubuntu0.18.04.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/php-dompdf?arch=source&distro=focal
    affected_versions: vers:deb/0.6.2+dfsg-3
    fixed_versions: vers:deb/0.6.2+dfsg-3ubuntu0.20.04.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/php-dompdf?arch=source&distro=jammy
    affected_versions: vers:deb/0.6.2+dfsg-3.1
    fixed_versions: vers:deb/0.6.2+dfsg-3.1ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-3838.json
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-3838.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-3838.json
weaknesses: []
references:
  - url: https://github.com/dompdf/dompdf/issues/2564
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-3838
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6277-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6277-2
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-3838
    reference_type:
    reference_id:
