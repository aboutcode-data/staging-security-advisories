advisory_id: UBUNTU-CVE-2025-24293
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-24293
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24293.json
aliases:
  - CVE-2025-24293
summary: '# Active Storage allowed transformation methods potentially unsafe Active Storage
  attempts to prevent the use of potentially unsafe image transformation methods and parameters
  by default. The default allowed list contains three methods allow for the circumvention of
  the safe defaults which enables potential command injection vulnerabilities in cases where
  arbitrary user supplied input is accepted as valid transformation methods or parameters. Impact
  ------ This vulnerability impacts applications that use Active Storage with the image_processing
  processing gem in addition to mini_magick as the image processor. Vulnerable code will look
  something similar to this: ``` <%= image_tag blob.variant(params[:t] => params[:v]) %> ```
  Where the transformation method or its arguments are untrusted arbitrary input. All users
  running an affected release should either upgrade or use one of the workarounds immediately.
  Workarounds ----------- Consuming user supplied input for image transformation methods or
  their parameters is unsupported behavior and should be considered dangerous. Strict validation
  of user supplied methods and parameters should be performed as well as having a strong [ImageMagick
  security policy](https://imagemagick.org/script/security-policy.php) deployed. Credits -------
  Thank you [lio346](https://hackerone.com/lio346) for reporting this!'
impacted_packages:
  - purl: pkg:deb/ubuntu/rails?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/2:4.1.10-1|2:4.2.5-1|2:4.2.5.1-1|2:4.2.5.2-2|2:4.2.6-1|2:4.2.6-1ubuntu0.1~esm1|2:4.2.6-1ubuntu0.1~esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/rails?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/2:4.2.9-2|2:4.2.9-4|2:4.2.10-0ubuntu4|2:4.2.10-0ubuntu4+esm1|2:4.2.10-0ubuntu4+esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/rails?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/2:5.2.2.1+dfsg-1ubuntu1|2:5.2.3+dfsg-3|2:5.2.3+dfsg-3ubuntu0.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/rails?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/2:6.0.3.7+dfsg-2|2:6.1.4.1+dfsg-8ubuntu2|2:6.1.4.1+dfsg-8ubuntu2+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/rails?arch=source&distro=noble
    affected_versions: vers:deb/2:6.1.7.3+dfsg-2build1|2:6.1.7.3+dfsg-3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/rails?arch=source&distro=questing
    affected_versions: vers:deb/2:6.1.7.3+dfsg-7|2:7.2.2.1+dfsg-7
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24293.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24293.json
weaknesses: []
references:
  - url: https://github.com/rails/rails/commit/1b1adf6ee6ca0f3104fcfce79360b2ec1e06a354
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/2d612735ac0d9712fdfffaf80afa627e7295f6ce
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/3beef20013736fd52c5dcfdf061f7999ba318290
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/568c0bc2f1e74c65d150a84b89a080949bf9eb9b
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/6a944ca4805e72050a0fbb1a461534eb760d3202
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/commit/fb8f3a18c3d97524c0efc29150d1e5f3162fbb13
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/security/advisories/GHSA-r4mg-4433-c7g3
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-24293
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-24293
    reference_type:
    reference_id:
