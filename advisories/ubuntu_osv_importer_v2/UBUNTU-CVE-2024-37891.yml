advisory_id: UBUNTU-CVE-2024-37891
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-37891
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-37891.json
aliases:
  - CVE-2024-37891
summary: 'urllib3 is a user-friendly HTTP client library for Python. When using urllib3''s proxy
  support with `ProxyManager`, the `Proxy-Authorization` header is only sent to the configured
  proxy, as expected. However, when sending HTTP requests *without* using urllib3''s proxy support,
  it''s possible to accidentally configure the `Proxy-Authorization` header even though it won''t
  have any effect as the request is not using a forwarding proxy or a tunneling proxy. In those
  cases, urllib3 doesn''t treat the `Proxy-Authorization` HTTP header as one carrying authentication
  material and thus doesn''t strip the header on cross-origin redirects. Because this is a highly
  unlikely scenario, we believe the severity of this vulnerability is low for almost all users.
  Out of an abundance of caution urllib3 will automatically strip the `Proxy-Authorization`
  header during cross-origin redirects to avoid the small chance that users are doing this on
  accident. Users should use urllib3''s proxy support or disable automatic redirects to achieve
  safe processing of the `Proxy-Authorization` header, but we still decided to strip the header
  by default in order to further protect users who aren''t using the correct approach. We believe
  the number of usages affected by this advisory is low. It requires all of the following to
  be true to be exploited: 1. Setting the `Proxy-Authorization` header without using urllib3''s
  built-in proxy support. 2. Not disabling HTTP redirects. 3. Either not using an HTTPS origin
  server or for the proxy or target origin to redirect to a malicious origin. Users are advised
  to update to either version 1.26.19 or version 2.2.2. Users unable to upgrade may use the
  `Proxy-Authorization` header with urllib3''s `ProxyManager`, disable HTTP redirects using
  `redirects=False` when sending requests, or not user the `Proxy-Authorization` header as mitigations.'
impacted_packages:
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/1.4.1-2|1.5.4-1|1.5.4-1ubuntu1|1.5.4-1ubuntu3|1.5.4-1ubuntu4|1.5.4-1ubuntu4+esm1|1.5.4-1ubuntu4+esm2|1.5.4-1ubuntu4+esm3|1.5.4-1ubuntu4+esm4|1.5.4-1ubuntu4+esm5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/1.6-2|1.7.1-1|1.7.1-1build1|1.7.1-1ubuntu0.1|1.7.1-1ubuntu3|1.7.1-1ubuntu4|1.7.1-1ubuntu4.1|1.7.1-1ubuntu4.1+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/1.11-1|1.12-1|1.13.1-1|1.13.1-2|1.13.1-2ubuntu0.16.04.1|1.13.1-2ubuntu0.16.04.2|1.13.1-2ubuntu0.16.04.3|1.13.1-2ubuntu0.16.04.4|1.13.1-2ubuntu0.16.04.4+esm1
    fixed_versions: vers:deb/1.13.1-2ubuntu0.16.04.4+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.5.6-7ubuntu1|1.5.6-7ubuntu2|8.0.2-7|8.0.3-1|8.0.3-2|8.1.0-1|8.1.0-2|8.1.1-1|8.1.1-2|8.1.1-2ubuntu0.1|8.1.1-2ubuntu0.2|8.1.1-2ubuntu0.4|8.1.1-2ubuntu0.6|8.1.1-2ubuntu0.6+esm2|8.1.1-2ubuntu0.6+esm3|8.1.1-2ubuntu0.6+esm4|8.1.1-2ubuntu0.6+esm5|8.1.1-2ubuntu0.6+esm6|8.1.1-2ubuntu0.6+esm8
    fixed_versions: vers:deb/8.1.1-2ubuntu0.6+esm10
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=esm-infra/bionic
    affected_versions: vers:deb/1.21.1-1|1.22-1|1.22-1ubuntu0.18.04.1|1.22-1ubuntu0.18.04.2|1.22-1ubuntu0.18.04.2+esm1
    fixed_versions: vers:deb/1.22-1ubuntu0.18.04.2+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/9.0.1-2|9.0.1-2.3~ubuntu1|9.0.1-2.3~ubuntu1.18.04.1|9.0.1-2.3~ubuntu1.18.04.2|9.0.1-2.3~ubuntu1.18.04.3|9.0.1-2.3~ubuntu1.18.04.4|9.0.1-2.3~ubuntu1.18.04.5|9.0.1-2.3~ubuntu1.18.04.5+esm2|9.0.1-2.3~ubuntu1.18.04.5+esm3|9.0.1-2.3~ubuntu1.18.04.6|9.0.1-2.3~ubuntu1.18.04.6+esm1|9.0.1-2.3~ubuntu1.18.04.7|9.0.1-2.3~ubuntu1.18.04.7+esm1|9.0.1-2.3~ubuntu1.18.04.8|9.0.1-2.3~ubuntu1.18.04.8+esm1|9.0.1-2.3~ubuntu1.18.04.8+esm2|9.0.1-2.3~ubuntu1.18.04.8+esm4
    fixed_versions: vers:deb/9.0.1-2.3~ubuntu1.18.04.8+esm6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=focal
    affected_versions: vers:deb/18.1-5|18.1-5build1|18.1-5ubuntu1|20.0.2-2|20.0.2-4|20.0.2-5|20.0.2-5ubuntu1|20.0.2-5ubuntu1.1|20.0.2-5ubuntu1.3|20.0.2-5ubuntu1.4|20.0.2-5ubuntu1.5|20.0.2-5ubuntu1.6|20.0.2-5ubuntu1.7|20.0.2-5ubuntu1.8|20.0.2-5ubuntu1.9|20.0.2-5ubuntu1.10
    fixed_versions: vers:deb/20.0.2-5ubuntu1.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=focal
    affected_versions: vers:deb/1.24.1-1ubuntu1|1.24.1-1ubuntu2|1.25.8-1|1.25.8-2|1.25.8-2ubuntu0.1|1.25.8-2ubuntu0.2|1.25.8-2ubuntu0.3
    fixed_versions: vers:deb/1.25.8-2ubuntu0.4
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=jammy
    affected_versions: vers:deb/20.3.4-4|21.3.1+dfsg-3|22.0.2+dfsg-1|22.0.2+dfsg-1ubuntu0.1|22.0.2+dfsg-1ubuntu0.2|22.0.2+dfsg-1ubuntu0.3|22.0.2+dfsg-1ubuntu0.4
    fixed_versions: vers:deb/22.0.2+dfsg-1ubuntu0.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=jammy
    affected_versions: vers:deb/1.26.5-1~exp1|1.26.5-1~exp1ubuntu0.1
    fixed_versions: vers:deb/1.26.5-1~exp1ubuntu0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-pip?arch=source&distro=noble
    affected_versions: vers:deb/23.2+dfsg-1|23.3+dfsg-1|24.0+dfsg-1|24.0+dfsg-1ubuntu1
    fixed_versions: vers:deb/24.0+dfsg-1ubuntu1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-urllib3?arch=source&distro=noble
    affected_versions: vers:deb/1.26.16-1|1.26.18-1|2.0.7-1
    fixed_versions: vers:deb/2.0.7-1ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-37891.json
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-37891.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-37891.json
weaknesses: []
references:
  - url: https://github.com/urllib3/urllib3/security/advisories/GHSA-34jh-p97f-mpxf
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-37891
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7084-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7084-2
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-37891
    reference_type:
    reference_id:
