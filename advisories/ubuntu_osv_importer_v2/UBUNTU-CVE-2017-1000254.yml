advisory_id: UBUNTU-CVE-2017-1000254
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2017-1000254
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-1000254.json
aliases:
  - CVE-2017-1000254
summary: libcurl may read outside of a heap allocated buffer when doing FTP. When libcurl connects
  to an FTP server and successfully logs in (anonymous or not), it asks the server for the current
  directory with the `PWD` command. The server then responds with a 257 response containing
  the path, inside double quotes. The returned path name is then kept by libcurl for subsequent
  uses. Due to a flaw in the string parser for this directory name, a directory name passed
  like this but without a closing double quote would lead to libcurl not adding a trailing NUL
  byte to the buffer holding the name. When libcurl would then later access the string, it could
  read beyond the allocated heap buffer and crash or wrongly access data beyond the buffer,
  thinking it was part of the path. A malicious server could abuse this fact and effectively
  prevent libcurl-based clients to work with it - the PWD command is always issued on new FTP
  connections and the mistake has a high chance of causing a segfault. The simple fact that
  this has issue remained undiscovered for this long could suggest that malformed PWD responses
  are rare in benign servers. We are not aware of any exploit of this flaw. This bug was introduced
  in commit [415d2e7cb7](https://github.com/curl/curl/commit/415d2e7cb7), March 2005. In libcurl
  version 7.56.0, the parser always zero terminates the string but also rejects it if not terminated
  properly with a final double quote.
impacted_packages:
  - purl: pkg:deb/ubuntu/curl?arch=source&distro=trusty
    affected_versions: vers:deb/7.32.0-1ubuntu1|7.33.0-1ubuntu1|7.34.0-1ubuntu1|7.35.0-1ubuntu1|7.35.0-1ubuntu2|7.35.0-1ubuntu2.1|7.35.0-1ubuntu2.2|7.35.0-1ubuntu2.3|7.35.0-1ubuntu2.5|7.35.0-1ubuntu2.6|7.35.0-1ubuntu2.7|7.35.0-1ubuntu2.8|7.35.0-1ubuntu2.9|7.35.0-1ubuntu2.10
    fixed_versions: vers:deb/7.35.0-1ubuntu2.11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/curl?arch=source&distro=xenial
    affected_versions: vers:deb/7.43.0-1ubuntu2|7.45.0-1ubuntu1|7.46.0-1ubuntu1|7.47.0-1ubuntu1|7.47.0-1ubuntu2|7.47.0-1ubuntu2.1|7.47.0-1ubuntu2.2
    fixed_versions: vers:deb/7.47.0-1ubuntu2.3
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-1000254.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-1000254.json
weaknesses: []
references:
  - url: https://curl.haxx.se/docs/adv_20171004.html
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2017-1000254
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3441-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3441-2
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2017-1000254
    reference_type:
    reference_id:
