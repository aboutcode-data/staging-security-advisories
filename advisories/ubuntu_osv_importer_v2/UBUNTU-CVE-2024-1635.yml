advisory_id: UBUNTU-CVE-2024-1635
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-1635
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-1635.json
aliases:
  - CVE-2024-1635
summary: A vulnerability was found in Undertow. This vulnerability impacts a server that supports
  the wildfly-http-client protocol. Whenever a malicious user opens and closes a connection
  with the HTTP port of the server and then closes the connection immediately, the server will
  end with both memory and open file limits exhausted at some point, depending on the amount
  of memory available. At HTTP upgrade to remoting, the WriteTimeoutStreamSinkConduit leaks
  connections if RemotingConnection is closed by Remoting ServerConnectionOpenListener. Because
  the remoting connection originates in Undertow as part of the HTTP upgrade, there is an external
  layer to the remoting connection. This connection is unaware of the outermost layer when closing
  the connection during the connection opening procedure. Hence, the Undertow WriteTimeoutStreamSinkConduit
  is not notified of the closed connection in this scenario. Because WriteTimeoutStreamSinkConduit
  creates a timeout task, the whole dependency tree leaks via that task, which is added to XNIO
  WorkerThread. So, the workerThread points to the Undertow conduit, which contains the connections
  and causes the leak.
impacted_packages:
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=xenial
    affected_versions: vers:deb/1.3.4-1|1.3.5-1|1.3.7-1|1.3.11-1|1.3.16-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=bionic
    affected_versions: vers:deb/1.4.20-1|1.4.21-1|1.4.22-1|1.4.23-1|1.4.23-2build1|1.4.23-3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=focal
    affected_versions: vers:deb/2.0.23-1|2.0.27-1|2.0.28-1|2.0.29-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=jammy
    affected_versions: vers:deb/2.2.8-1|2.2.12-1|2.2.13-1|2.2.14-1|2.2.16-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=noble
    affected_versions: vers:deb/2.3.8-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=questing
    affected_versions: vers:deb/2.3.18-1|2.3.18-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-1635.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-1635.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/cve/CVE-2024-1635
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-1635
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-1635
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2264928
    reference_type: bug
    reference_id: 2264928
