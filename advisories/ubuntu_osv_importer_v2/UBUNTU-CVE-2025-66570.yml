advisory_id: UBUNTU-CVE-2025-66570
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-66570
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-66570.json
aliases:
  - CVE-2025-66570
summary: 'cpp-httplib is a C++11 single-file header-only cross platform HTTP/HTTPS library.
  Prior to 0.27.0, a vulnerability allows attacker-controlled HTTP headers to influence server-visible
  metadata, logging, and authorization decisions. An attacker can inject headers named REMOTE_ADDR,
  REMOTE_PORT, LOCAL_ADDR, LOCAL_PORT that are parsed into the request header multimap via read_headers()
  in httplib.h (headers.emplace), then the server later appends its own internal metadata using
  the same header names in Server::process_request without erasing duplicates. Because Request::get_header_value
  returns the first entry for a header key (id == 0) and the client-supplied headers are parsed
  before server-inserted headers, downstream code that uses these header names may inadvertently
  use attacker-controlled values. Affected files/locations: cpp-httplib/httplib.h (read_headers,
  Server::process_request, Request::get_header_value, get_header_value_u64) and cpp-httplib/docker/main.cc
  (get_client_ip, nginx_access_logger, nginx_error_logger). Attack surface: attacker-controlled
  HTTP headers in incoming requests flow into the Request.headers multimap and into logging
  code that reads forwarded headers, enabling IP spoofing, log poisoning, and authorization
  bypass via header shadowing. This vulnerability is fixed in 0.27.0.'
impacted_packages:
  - purl: pkg:deb/ubuntu/cpp-httplib?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/0.9.9+ds-1|0.9.10+ds-1|0.10.1+ds-1|0.10.2+ds-1|0.10.3+ds-1
    fixed_versions: vers:deb/0.10.3+ds-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/cpp-httplib?arch=source&distro=esm-apps/noble
    affected_versions: vers:deb/0.13.1+ds-1ubuntu1|0.14.3+ds-1|0.14.3+ds-1.1|0.14.3+ds-1.1build1|0.14.3+ds-1.1build2
    fixed_versions: vers:deb/0.14.3+ds-1.1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/cpp-httplib?arch=source&distro=questing
    affected_versions: vers:deb/0.18.7-1
    fixed_versions: vers:deb/0.18.7-1ubuntu0.25.10.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-66570.json
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-66570.json
  - score: high
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-66570.json
weaknesses: []
references:
  - url: https://github.com/yhirose/cpp-httplib/commit/ac9ebb0ee333ce8bf13523f487bdfad9518a2aff
    reference_type:
    reference_id:
  - url: https://github.com/yhirose/cpp-httplib/security/advisories/GHSA-xm2j-vfr9-mg9m
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-66570
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7962-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-66570
    reference_type:
    reference_id:
