advisory_id: UBUNTU-CVE-2025-59729
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-59729
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-59729.json
aliases:
  - CVE-2025-59729
summary: When parsing the header for a DHAV file, there's an integer underflow in offset calculation
  that leads to reading the duration from before the start of the allocated buffer. If we load
  a DHAV file that is larger than MAX_DURATION_BUFFER_SIZE bytes (0x100000) for example 0x101000
  bytes, then at [0] we have size = 0x101000. At [1] we have end_buffer_size = 0x100000, and
  at [2] we have end_buffer_pos = 0x1000. The loop then scans backwards through the buffer looking
  for the dhav tag; when it is found, we'll calculate end_pos based on a 32-bit offset read
  from the buffer. There is subsequently a check [3] that end_pos is within the section of the
  file that has been copied into end_buffer, but it only correctly handles the cases where end_pos is
  before the start of the file or after the section copied into end_buffer, and not the case
  where end_pos is within the the file, but before the section copied into end_buffer. If we
  provide such an offset, (end_pos - end_buffer_pos) can underflow, resulting in the subsequent
  access at [4] occurring before the beginning of the allocation. We recommend upgrading to
  version 8.0 or beyond.
impacted_packages:
  - purl: pkg:deb/ubuntu/libav?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/6:0.8.7-1ubuntu2|6:9.10-1ubuntu1|6:9.10-1ubuntu2|6:9.10-1ubuntu5|6:9.10-1ubuntu6|6:9.10-1ubuntu7|6:9.11-2ubuntu1|6:9.11-2ubuntu2|6:9.13-0ubuntu0.14.04.1|6:9.14-0ubuntu0.14.04.1|6:9.16-0ubuntu0.14.04.1|6:9.18-0ubuntu0.14.04.1|6:9.20-0ubuntu0.14.04.1|6:9.20-0ubuntu0.14.04.1+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:A/AC:H/AT:P/PR:L/UI:P/VC:L/VI:H/VA:N/SC:L/SI:H/SA:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-59729.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-59729.json
weaknesses: []
references:
  - url: https://issuetracker.google.com/433513232
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-59729
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-59729
    reference_type:
    reference_id:
