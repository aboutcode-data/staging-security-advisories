advisory_id: UBUNTU-CVE-2021-32791
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-32791
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32791.json
aliases:
  - CVE-2021-32791
summary: mod_auth_openidc is an authentication/authorization module for the Apache 2.x HTTP
  server that functions as an OpenID Connect Relying Party, authenticating users against an
  OpenID Connect Provider. In mod_auth_openidc before version 2.4.9, the AES GCM encryption
  in mod_auth_openidc uses a static IV and AAD. It is important to fix because this creates
  a static nonce and since aes-gcm is a stream cipher, this can lead to known cryptographic
  issues, since the same key is being reused. From 2.4.9 onwards this has been patched to use
  dynamic values through usage of cjose AES encryption routines.
impacted_packages:
  - purl: pkg:deb/ubuntu/libapache2-mod-auth-openidc?arch=source&distro=bionic
    affected_versions: vers:deb/2.1.6-1|2.3.1-2|2.3.2-1|2.3.2-1build1|2.3.3-1build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libapache2-mod-auth-openidc?arch=source&distro=focal
    affected_versions: vers:deb/2.3.10.2-1|2.4.0.4-1|2.4.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32791.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32791.json
weaknesses: []
references:
  - url: https://github.com/zmartzone/mod_auth_openidc/commit/375407c16c61a70b56fdbe13b0d2c8f11398e92c
    reference_type:
    reference_id:
  - url: https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9
    reference_type:
    reference_id:
  - url: https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-px3c-6x7j-3r9r
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-32791
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-32791
    reference_type:
    reference_id:
