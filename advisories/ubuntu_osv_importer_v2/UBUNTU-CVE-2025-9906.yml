advisory_id: UBUNTU-CVE-2025-9906
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-9906
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-9906.json
aliases:
  - CVE-2025-9906
summary: The Keras Model.load_model method can be exploited to achieve arbitrary code execution,
  even with safe_mode=True. One can create a specially crafted .keras model archive that, when
  loaded via Model.load_model, will trigger arbitrary code to be executed. This is achieved
  by crafting a special config.json (a file within the .keras archive) that will invoke keras.config.enable_unsafe_deserialization() to
  disable safe mode. Once safe mode is disable, one can use the Lambda layer feature of keras,
  which allows arbitrary Python code in the form of pickled code. Both can appear in the same
  archive. Simply the keras.config.enable_unsafe_deserialization() needs to appear first in
  the archive and the Lambda with arbitrary code needs to be second.
impacted_packages:
  - purl: pkg:deb/ubuntu/keras?arch=source&distro=bionic
    affected_versions: vers:deb/1.0.7-2|2.1.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/keras?arch=source&distro=focal
    affected_versions: vers:deb/2.2.4-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-9906.json
  - score: '8.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:P/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/AU:Y/R:A
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-9906.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-9906.json
weaknesses: []
references:
  - url: https://github.com/keras-team/keras/pull/21429
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-9906
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-9906
    reference_type:
    reference_id:
