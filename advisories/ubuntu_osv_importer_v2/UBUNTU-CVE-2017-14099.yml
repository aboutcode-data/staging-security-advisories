advisory_id: UBUNTU-CVE-2017-14099
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2017-14099
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-14099.json
aliases:
  - CVE-2017-14099
summary: In res/res_rtp_asterisk.c in Asterisk 11.x before 11.25.2, 13.x before 13.17.1, and
  14.x before 14.6.1 and Certified Asterisk 11.x before 11.6-cert17 and 13.x before 13.13-cert5,
  unauthorized data disclosure (media takeover in the RTP stack) is possible with careful timing
  by an attacker. The "strictrtp" option in rtp.conf enables a feature of the RTP stack that
  learns the source address of media for a session and drops any packets that do not originate
  from the expected address. This option is enabled by default in Asterisk 11 and above. The
  "nat" and "rtp_symmetric" options (for chan_sip and chan_pjsip, respectively) enable symmetric
  RTP support in the RTP stack. This uses the source address of incoming media as the target
  address of any sent media. This option is not enabled by default, but is commonly enabled
  to handle devices behind NAT. A change was made to the strict RTP support in the RTP stack
  to better tolerate late media when a reinvite occurs. When combined with the symmetric RTP
  support, this introduced an avenue where media could be hijacked. Instead of only learning
  a new address when expected, the new code allowed a new source address to be learned at all
  times. If a flood of RTP traffic was received, the strict RTP support would allow the new
  address to provide media, and (with symmetric RTP enabled) outgoing traffic would be sent
  to this new address, allowing the media to be hijacked. Provided the attacker continued to
  send traffic, they would continue to receive traffic as well.
impacted_packages:
  - purl: pkg:deb/ubuntu/asterisk?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1:13.1.0~dfsg-1.1ubuntu3|1:13.1.0~dfsg-1.1ubuntu4|1:13.1.0~dfsg-1.1ubuntu4.1|1:13.1.0~dfsg-1.1ubuntu4.1+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-14099.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-14099.json
weaknesses: []
references:
  - url: http://downloads.asterisk.org/pub/security/AST-2017-005.html
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/873907
    reference_type:
    reference_id:
  - url: https://gerrit.asterisk.org/#/c/6356/
    reference_type:
    reference_id:
  - url: https://issues.asterisk.org/jira/browse/ASTERISK-27013
    reference_type:
    reference_id:
  - url: https://rtpbleed.com
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2017-14099
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2017-14099
    reference_type:
    reference_id:
  - url: http://www.securitytracker.com/id/1039251
    reference_type:
    reference_id:
