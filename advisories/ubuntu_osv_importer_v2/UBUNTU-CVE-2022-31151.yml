advisory_id: UBUNTU-CVE-2022-31151
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-31151
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31151.json
aliases:
  - CVE-2022-31151
summary: 'Authorization headers are cleared on cross-origin redirect. However, cookie headers
  which are sensitive headers and are official headers found in the spec, remain uncleared.
  There are active users using cookie headers in undici. This may lead to accidental leakage
  of cookie to a 3rd-party site or a malicious attacker who can control the redirection target
  (ie. an open redirector) to leak the cookie to the 3rd party site. This was patched in v5.7.1.
  By default, this vulnerability is not exploitable. Do not enable redirections, i.e. `maxRedirections:
  0` (the default).'
impacted_packages:
  - purl: pkg:deb/ubuntu/node-undici?arch=source&distro=noble
    affected_versions: vers:deb/5.22.1+dfsg1+~cs20.10.10.2-1ubuntu1|5.26.3+dfsg1+~cs23.10.12-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-undici?arch=source&distro=questing
    affected_versions: vers:deb/7.3.0+dfsg1+~cs24.12.11-1|7.3.0+dfsg1+~cs24.12.11-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31151.json
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31151.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31151.json
weaknesses: []
references:
  - url: https://github.com/nodejs/undici/issues/872
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1635514
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-31151
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-31151
    reference_type:
    reference_id:
