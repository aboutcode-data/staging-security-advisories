advisory_id: UBUNTU-CVE-2025-69871
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-69871
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-69871.json
aliases:
  - CVE-2025-69871
summary: A race condition vulnerability exists in MedusaJS Medusa v2.12.2 and earlier in the
  registerUsage() function of the promotion module. The function performs a non-atomic read-check-update
  operation when enforcing promotion usage limits. This allows unauthenticated remote attackers
  to bypass usage limits by sending concurrent checkout requests, resulting in unlimited redemptions
  of limited-use promotional codes and potential financial loss.
impacted_packages:
  - purl: pkg:deb/ubuntu/medusa?arch=source&distro=questing
    affected_versions: vers:deb/2.3~rc1-2|2.3-1|2.3-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/medusa?arch=source&distro=xenial
    affected_versions: vers:deb/2.1.1-1|2.2~rc3-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/medusa?arch=source&distro=bionic
    affected_versions: vers:deb/2.2-4|2.2-4build1|2.2-5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/medusa?arch=source&distro=focal
    affected_versions: vers:deb/2.2-6
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/medusa?arch=source&distro=jammy
    affected_versions: vers:deb/2.2-7|2.2-7build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/medusa?arch=source&distro=noble
    affected_versions: vers:deb/2.2-7build1|2.2-7build2|2.2-7build3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-69871.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-69871.json
weaknesses: []
references:
  - url: https://github.com/EthanKim88/ethan-cve-disclosures/blob/main/CVE-2025-69871-MedusaJS-TOCTOU.md
    reference_type:
    reference_id:
  - url: https://github.com/medusajs/medusa
    reference_type:
    reference_id:
  - url: https://github.com/medusajs/medusa/pull/13760
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-69871
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-69871
    reference_type:
    reference_id:
