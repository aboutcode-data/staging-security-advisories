advisory_id: UBUNTU-CVE-2025-37818
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-37818
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-37818.json
aliases:
  - CVE-2025-37818
summary: 'In the Linux kernel, the following vulnerability has been resolved: LoongArch: Return
  NULL from huge_pte_offset() for invalid PMD LoongArch''s huge_pte_offset() currently returns
  a pointer to a PMD slot even if the underlying entry points to invalid_pte_table (indicating
  no mapping). Callers like smaps_hugetlb_range() fetch this invalid entry value (the address
  of invalid_pte_table) via this pointer. The generic is_swap_pte() check then incorrectly identifies
  this address as a swap entry on LoongArch, because it satisfies the "!pte_present() && !pte_none()"
  conditions. This misinterpretation, combined with a coincidental match by is_migration_entry()
  on the address bits, leads to kernel crashes in pfn_swap_entry_to_page(). Fix this at the
  architecture level by modifying huge_pte_offset() to check the PMD entry''s content using
  pmd_none() before returning. If the entry is invalid (i.e., it points to invalid_pte_table),
  return NULL instead of the pointer to the slot.'
impacted_packages:
  - purl: pkg:deb/ubuntu/linux-gcp-6.14?arch=source&distro=noble
    affected_versions: vers:deb/6.14.0-1007.7~24.04.1
    fixed_versions: vers:deb/6.14.0-1011.11~24.04.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/linux-realtime-6.14?arch=source&distro=realtime/noble
    affected_versions: vers:deb/6.14.0-1003.3~24.04.3
    fixed_versions: vers:deb/6.14.0-1010.10~24.04.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-37818.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-37818.json
weaknesses: []
references:
  - url: https://git.kernel.org/linus/bd51834d1cf65a2c801295d230c220aeebf87a73
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-37818
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-37818
    reference_type:
    reference_id:
