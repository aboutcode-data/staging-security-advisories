advisory_id: UBUNTU-CVE-2021-45046
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-45046
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-45046.json
aliases:
  - CVE-2021-45046
summary: It was found that the fix to address CVE-2021-44228 in Apache Log4j 2.15.0 was incomplete
  in certain non-default configurations. This could allows attackers with control over Thread
  Context Map (MDC) input data when the logging configuration uses a non-default Pattern Layout
  with either a Context Lookup (for example, $${ctx:loginId}) or a Thread Context Map pattern
  (%X, %mdc, or %MDC) to craft malicious input data using a JNDI Lookup pattern resulting in
  an information leak and remote code execution in some environments and local code execution
  in all environments. Log4j 2.16.0 (Java 8) and 2.12.2 (Java 7) fix this issue by removing
  support for message lookup patterns and disabling JNDI functionality by default.
impacted_packages:
  - purl: pkg:deb/ubuntu/apache-log4j2?arch=source&distro=focal
    affected_versions: vers:deb/2.11.1-2|2.11.2-1|2.15.0-0.20.04.1
    fixed_versions: vers:deb/2.16.0-0.20.04.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-45046.json
  - score: high
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-45046.json
weaknesses: []
references:
  - url: https://issues.apache.org/jira/browse/LOG4J2-3221
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/83y7dx5xvn3h5290q1twn16tltolv88f
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-45046
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5197-1
    reference_type:
    reference_id:
  - url: https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/Log4Shell
    reference_type:
    reference_id:
  - url: https://www.cisa.gov/known-exploited-vulnerabilities-catalog
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-45046
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2021/12/14/4
    reference_type:
    reference_id:
