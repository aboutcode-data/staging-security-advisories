advisory_id: UBUNTU-CVE-2023-34325
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-34325
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-34325.json
aliases:
  - CVE-2023-34325
summary: '[This CNA information record relates to multiple CVEs; the text explains which aspects/vulnerabilities
  correspond to which CVE.] libfsimage contains parsing code for several filesystems, most of
  them based on grub-legacy code.  libfsimage is used by pygrub to inspect guest disks. Pygrub
  runs as the same user as the toolstack (root in a priviledged domain). At least one issue
  has been reported to the Xen Security Team that allows an attacker to trigger a stack buffer
  overflow in libfsimage.  After further analisys the Xen Security Team is no longer confident
  in the suitability of libfsimage when run against guest controlled input with super user priviledges.
  In order to not affect current deployments that rely on pygrub patches are provided in the
  resolution section of the advisory that allow running pygrub in deprivileged mode. CVE-2023-4949
  refers to the original issue in the upstream grub project ("An attacker with local access
  to a system (either through a disk or external drive) can present a modified XFS partition
  to grub-legacy in such a way to exploit a memory corruption in grubâ€™s XFS file system implementation.")  CVE-2023-34325
  refers specifically to the vulnerabilities in Xen''s copy of libfsimage, which is decended
  from a very old version of grub.'
impacted_packages:
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=xenial
    affected_versions: vers:deb/4.5.1-0ubuntu1|4.5.1-0ubuntu2|4.6.0-1ubuntu1|4.6.0-1ubuntu2|4.6.0-1ubuntu4|4.6.0-1ubuntu4.1|4.6.0-1ubuntu4.2|4.6.0-1ubuntu4.3|4.6.5-0ubuntu1|4.6.5-0ubuntu1.1|4.6.5-0ubuntu1.2|4.6.5-0ubuntu1.4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=bionic
    affected_versions: vers:deb/4.9.0-0ubuntu3|4.9.0-0ubuntu4|4.9.2-0ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=focal
    affected_versions: vers:deb/4.9.2-0ubuntu2|4.9.2-0ubuntu6|4.9.2-0ubuntu7|4.11.3+24-g14b62ab3e5-1ubuntu1|4.11.3+24-g14b62ab3e5-1ubuntu2|4.11.3+24-g14b62ab3e5-1ubuntu2.2|4.11.3+24-g14b62ab3e5-1ubuntu2.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=jammy
    affected_versions: vers:deb/4.11.4+24-gddaaccbbab-1ubuntu2|4.16.0-1~ubuntu2|4.16.0-1~ubuntu2.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=noble
    affected_versions: vers:deb/4.17.2-1|4.17.2+55-g0b56bed864-1|4.17.2+76-ge1f9cb16e2-1|4.17.2+76-ge1f9cb16e2-1ubuntu1|4.17.3+10-g091466ba55-1|4.17.3+10-g091466ba55-1.1ubuntu2|4.17.3+10-g091466ba55-1.1ubuntu3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=questing
    affected_versions: vers:deb/4.20.0-1ubuntu1|4.20.0+68-g35cb38b222-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-34325.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-34325.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2023-34325
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-34325
    reference_type:
    reference_id:
  - url: https://xenbits.xen.org/xsa/advisory-443.html
    reference_type:
    reference_id:
