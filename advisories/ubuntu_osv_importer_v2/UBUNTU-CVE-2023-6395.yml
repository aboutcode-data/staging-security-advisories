advisory_id: UBUNTU-CVE-2023-6395
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-6395
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-6395.json
aliases:
  - CVE-2023-6395
summary: The Mock software contains a vulnerability wherein an attacker could potentially exploit
  privilege escalation, enabling the execution of arbitrary code with root user privileges.
  This weakness stems from the absence of proper sandboxing during the expansion and execution
  of Jinja2 templates, which may be included in certain configuration parameters. While the
  Mock documentation advises treating users added to the mock group as privileged, certain build
  systems invoking mock on behalf of users might inadvertently permit less privileged users
  to define configuration tags. These tags could then be passed as parameters to mock during
  execution, potentially leading to the utilization of Jinja2 templates for remote privilege
  escalation and the execution of arbitrary code as the root user on the build server.
impacted_packages:
  - purl: pkg:deb/ubuntu/mock?arch=source&distro=xenial
    affected_versions: vers:deb/1.1.33-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/mock?arch=source&distro=bionic
    affected_versions: vers:deb/1.3.2-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-6395.json
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-6395.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-6395.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/cve/CVE-2023-6395
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2252206
    reference_type:
    reference_id:
  - url: https://github.com/xsuchy/templated-dictionary/commit/0740bd0ca8d487301881541028977d120f8b8933
    reference_type:
    reference_id:
  - url: https://github.com/xsuchy/templated-dictionary/commit/bcd90f0dafa365575c4b101e6f5d98c4ef4e4b69
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-6395
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-6395
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2024/01/16/1
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/01/16/1
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/01/16/3
    reference_type:
    reference_id:
