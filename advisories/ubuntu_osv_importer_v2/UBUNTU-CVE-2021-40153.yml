advisory_id: UBUNTU-CVE-2021-40153
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-40153
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-40153.json
aliases:
  - CVE-2021-40153
summary: squashfs_opendir in unsquash-1.c in Squashfs-Tools 4.5 stores the filename in the directory
  entry; this is then used by unsquashfs to create the new file during the unsquash. The filename
  is not validated for traversal outside of the destination directory, and thus allows writing
  to locations outside of the destination.
impacted_packages:
  - purl: pkg:deb/ubuntu/squashfs-tools?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/1:4.2+20130409-2.1|1:4.3-3|1:4.3-3ubuntu1|1:4.3-3ubuntu2|1:4.3-3ubuntu2.16.04.1|1:4.3-3ubuntu2.16.04.2|1:4.3-3ubuntu2.16.04.3
    fixed_versions: vers:deb/1:4.3-3ubuntu2.16.04.3+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/squashfs-tools?arch=source&distro=bionic
    affected_versions: vers:deb/1:4.3-4ubuntu1|1:4.3-4ubuntu2|1:4.3-6|1:4.3-6ubuntu0.18.04.1|1:4.3-6ubuntu0.18.04.2
    fixed_versions: vers:deb/1:4.3-6ubuntu0.18.04.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/squashfs-tools?arch=source&distro=focal
    affected_versions: vers:deb/1:4.4-1
    fixed_versions: vers:deb/1:4.4-1ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-40153.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-40153.json
weaknesses: []
references:
  - url: https://bugs.launchpad.net/ubuntu/+source/squashfs-tools/+bug/1941790
    reference_type:
    reference_id:
  - url: https://github.com/plougher/squashfs-tools/commit/79b5a555058eef4e1e7ff220c344d39f8cd09646
    reference_type:
    reference_id:
  - url: https://github.com/plougher/squashfs-tools/issues/72
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-40153
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5057-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5078-2
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-40153
    reference_type:
    reference_id:
