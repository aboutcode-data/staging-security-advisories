advisory_id: UBUNTU-CVE-2024-45310
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-45310
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-45310.json
aliases:
  - CVE-2024-45310
summary: runc is a CLI tool for spawning and running containers according to the OCI specification.
  runc 1.1.13 and earlier, as well as 1.2.0-rc2 and earlier, can be tricked into creating empty
  files or directories in arbitrary locations in the host filesystem by sharing a volume between
  two containers and exploiting a race with `os.MkdirAll`. While this could be used to create
  empty files, existing files would not be truncated. An attacker must have the ability to start
  containers using some kind of custom volume configuration. Containers using user namespaces
  are still affected, but the scope of places an attacker can create inodes can be significantly
  reduced. Sufficiently strict LSM policies (SELinux/Apparmor) can also in principle block this
  attack -- we suspect the industry standard SELinux policy may restrict this attack's scope
  but the exact scope of protection hasn't been analysed. This is exploitable using runc directly
  as well as through Docker and Kubernetes. The issue is fixed in runc v1.1.14 and v1.2.0-rc3.
  Some workarounds are available. Using user namespaces restricts this attack fairly significantly
  such that the attacker can only create inodes in directories that the remapped root user/group
  has write access to. Unless the root user is remapped to an actual user on the host (such
  as with rootless containers that don't use `/etc/sub[ug]id`), this in practice means that
  an attacker would only be able to create inodes in world-writable directories. A strict enough
  SELinux or AppArmor policy could in principle also restrict the scope if a specific label
  is applied to the runc runtime, though neither the extent to which the standard existing policies
  block this attack nor what exact policies are needed to sufficiently restrict this attack
  have been thoroughly tested.
impacted_packages:
  - purl: pkg:deb/ubuntu/runc?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/0.0.8+dfsg-2|0.1.1-0ubuntu5~16.04|1.0.0~rc1-0ubuntu1~16.04|1.0.0~rc1-0ubuntu2~16.04.1|1.0.0~rc1-0ubuntu2~16.04.1.1|1.0.0~rc2-0ubuntu2~16.04.1|1.0.0~rc2+docker1.12.6-0ubuntu1~16.04.1|1.0.0~rc2+docker1.13.1-0ubuntu1~16.04.1|1.0.0~rc2+docker1.13.1-0ubuntu1~16.04.2|1.0.0~rc7+git20190403.029124da-0ubuntu1~16.04.3|1.0.0~rc7+git20190403.029124da-0ubuntu1~16.04.4|1.0.0~rc7+git20190403.029124da-0ubuntu1~16.04.4+esm1|1.0.0~rc7+git20190403.029124da-0ubuntu1~16.04.4+esm2|1.0.0~rc7+git20190403.029124da-0ubuntu1~16.04.4+esm4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/runc?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.0.0~rc2+docker1.13.1-0ubuntu1|1.0.0~rc4+dfsg1-2|1.0.0~rc4+dfsg1-6|1.0.0~rc4+dfsg1-6ubuntu0.18.04.1|1.0.0~rc7+git20190403.029124da-0ubuntu1~18.04.1|1.0.0~rc7+git20190403.029124da-0ubuntu1~18.04.2|1.0.0~rc7+git20190403.029124da-0ubuntu1~18.04.2+esm1|1.0.0~rc10-0ubuntu1~18.04.1|1.0.0~rc10-0ubuntu1~18.04.2|1.0.0~rc93-0ubuntu1~18.04.1|1.0.0~rc93-0ubuntu1~18.04.2|1.0.0~rc95-0ubuntu1~18.04.1|1.0.0~rc95-0ubuntu1~18.04.2|1.0.1-0ubuntu2~18.04.1|1.1.0-0ubuntu1~18.04.1|1.1.4-0ubuntu1~18.04.1|1.1.4-0ubuntu1~18.04.2|1.1.4-0ubuntu1~18.04.2+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/runc?arch=source&distro=focal
    affected_versions: vers:deb/1.0.0~rc8+git20190923.3e425f80-0ubuntu1|1.0.0~rc10-0ubuntu1|1.0.0~rc93-0ubuntu1~20.04.1|1.0.0~rc93-0ubuntu1~20.04.2|1.0.0~rc95-0ubuntu1~20.04.1|1.0.0~rc95-0ubuntu1~20.04.2|1.0.1-0ubuntu2~20.04.1|1.1.0-0ubuntu1~20.04.1|1.1.0-0ubuntu1~20.04.2|1.1.4-0ubuntu1~20.04.1|1.1.4-0ubuntu1~20.04.2|1.1.4-0ubuntu1~20.04.3|1.1.7-0ubuntu1~20.04.1|1.1.7-0ubuntu1~20.04.2|1.1.7-0ubuntu1~20.04.4|1.1.7-0ubuntu1~20.04.5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/runc-app?arch=source&distro=focal
    affected_versions: vers:deb/1.1.12-0ubuntu2~20.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/runc?arch=source&distro=jammy
    affected_versions: vers:deb/1.0.1-0ubuntu2|1.0.1-0ubuntu3|1.0.3-0ubuntu1|1.1.0-0ubuntu1|1.1.0-0ubuntu1.1|1.1.4-0ubuntu1~22.04.1|1.1.4-0ubuntu1~22.04.2|1.1.4-0ubuntu1~22.04.3|1.1.7-0ubuntu1~22.04.1|1.1.7-0ubuntu1~22.04.2|1.1.7-0ubuntu1~22.04.4|1.1.7-0ubuntu1~22.04.5|1.1.7-0ubuntu1~22.04.6
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/runc-app?arch=source&distro=jammy
    affected_versions: vers:deb/1.1.12-0ubuntu2~22.04.1|1.2.5-0ubuntu1~22.04.1|1.3.0-0ubuntu2~22.04.1|1.3.3-0ubuntu1~22.04.2|1.3.3-0ubuntu1~22.04.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/runc?arch=source&distro=noble
    affected_versions: vers:deb/1.1.7-0ubuntu2|1.1.10+ds1-1ubuntu1|1.1.10+ds1-1ubuntu2|1.1.12+ds1-1ubuntu1|1.1.12+ds1-2ubuntu1|1.1.12+ds1-2ubuntu1.1|1.1.12+ds1-2ubuntu1.2|1.1.12+ds1-2ubuntu1.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/runc-app?arch=source&distro=noble
    affected_versions: vers:deb/1.1.10-0ubuntu1|1.1.12-0ubuntu1|1.1.12-0ubuntu2|1.1.12-0ubuntu3|1.1.12-0ubuntu3.1|1.2.5-0ubuntu1~24.04.1|1.3.0-0ubuntu2~24.04.1|1.3.3-0ubuntu1~24.04.2|1.3.3-0ubuntu1~24.04.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-45310.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-45310.json
weaknesses: []
references:
  - url: https://github.com/opencontainers/runc/pull/4359
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/runc/security/advisories/GHSA-jfvp-7x6p-h2pv
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-45310
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-45310
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2024/09/03/1
    reference_type:
    reference_id:
