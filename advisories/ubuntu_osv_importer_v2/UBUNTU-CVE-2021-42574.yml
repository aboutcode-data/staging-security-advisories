advisory_id: UBUNTU-CVE-2021-42574
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-42574
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-42574.json
aliases:
  - CVE-2021-42574
summary: 'An issue was discovered in the Bidirectional Algorithm in the Unicode Specification
  through 14.0. It permits the visual reordering of characters via control sequences, which
  can be used to craft source code that renders different logic than the logical ordering of
  tokens ingested by compilers and interpreters. Adversaries can leverage this to encode source
  code for compilers accepting Unicode such that targeted vulnerabilities are introduced invisibly
  to human reviewers. NOTE: the Unicode Consortium offers the following alternative approach
  to presenting this concern. An issue is noted in the nature of international text that can
  affect applications that implement support for The Unicode Standard and the Unicode Bidirectional
  Algorithm (all versions). Due to text display behavior when text includes left-to-right and
  right-to-left characters, the visual order of tokens may be different from their logical order.
  Additionally, control characters needed to fully support the requirements of bidirectional
  text can further obfuscate the logical order of tokens. Unless mitigated, an adversary could
  craft source code such that the ordering of tokens perceived by human reviewers does not match
  what will be processed by a compiler/interpreter/etc. The Unicode Consortium has documented
  this class of vulnerability in its document, Unicode Technical Report #36, Unicode Security
  Considerations. The Unicode Consortium also provides guidance on mitigations for this class
  of issues in Unicode Technical Standard #39, Unicode Security Mechanisms, and in Unicode Standard
  Annex #31, Unicode Identifier and Pattern Syntax. Also, the BIDI specification allows applications
  to tailor the implementation in ways that can mitigate misleading visual reordering in program
  text; see HL4 in Unicode Standard Annex #9, Unicode Bidirectional Algorithm.'
impacted_packages:
  - purl: pkg:deb/ubuntu/rustc?arch=source&distro=focal
    affected_versions: vers:deb/1.37.0+dfsg1+llvm-1ubuntu1|1.38.0+dfsg0.2+llvm-0ubuntu1|1.38.0+dfsg0.2+llvm-0ubuntu2|1.39.0+dfsg1+llvm-3ubuntu1|1.40.0+dfsg1+llvm-5ubuntu1|1.41.0+dfsg1+llvm-0ubuntu1|1.41.0+dfsg1+llvm-0ubuntu2|1.43.0+dfsg1+llvm-1~exp1ubuntu1~20.04.1|1.47.0+dfsg1+llvm-1ubuntu1~20.04.1|1.51.0+dfsg1+llvm-1~exp3ubuntu1~20.04.2|1.53.0+dfsg1+llvm-4ubuntu1~20.04.1
    fixed_versions: vers:deb/1.57.0+dfsg1+llvm-0ubuntu1~20.04.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/rustc?arch=source&distro=jammy
    affected_versions: vers:deb/1.51.0+dfsg1+llvm-1~exp3ubuntu1|1.53.0+dfsg1+llvm-4ubuntu1|1.54.0+dfsg2+llvm-3ubuntu1|1.56.0+dfsg1+llvm-2ubuntu1|1.56.0+dfsg1+llvm-2ubuntu2|1.57.0+dfsg1+llvm-0ubuntu1
    fixed_versions: vers:deb/1.57.0+dfsg1+llvm-0ubuntu2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-42574.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-42574.json
weaknesses: []
references:
  - url: https://github.com/rust-lang/rust/commit/dd61274930ec0cd17711fab52d2bc9ad3e9053de
    reference_type:
    reference_id:
  - url: https://trojansource.codes
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-42574
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-42574
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2021/11/01/1
    reference_type:
    reference_id:
  - url: http://www.unicode.org/versions/Unicode14.0.0/
    reference_type:
    reference_id:
