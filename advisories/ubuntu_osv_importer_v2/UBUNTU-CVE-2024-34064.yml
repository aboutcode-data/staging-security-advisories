advisory_id: UBUNTU-CVE-2024-34064
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-34064
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-34064.json
aliases:
  - CVE-2024-34064
summary: Jinja is an extensible templating engine. The `xmlattr` filter in affected versions
  of Jinja accepts keys containing non-attribute characters. XML/HTML attributes cannot contain
  spaces, `/`, `>`, or `=`, as each would then be interpreted as starting a separate attribute.
  If an application accepts keys (as opposed to only values) as user input, and renders these
  in pages that other users see as well, an attacker could use this to inject other attributes
  and perform XSS. The fix for CVE-2024-22195 only addressed spaces but not other characters.
  Accepting keys as user input is now explicitly considered an unintended use case of the `xmlattr`
  filter, and code that does so without otherwise validating the input should be flagged as
  insecure, regardless of Jinja version. Accepting _values_ as user input continues to be safe.
  This vulnerability is fixed in 3.1.4.
impacted_packages:
  - purl: pkg:deb/ubuntu/jinja2?arch=source&distro=trusty/esm
    affected_versions: vers:deb/2.7-3|2.7.1-1|2.7.2-1|2.7.2-2|2.7.2-2ubuntu0.1~esm1|2.7.2-2ubuntu0.1~esm2
    fixed_versions: vers:deb/2.7.2-2ubuntu0.1~esm3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/jinja2?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/2.8-1|2.8-1ubuntu0.1|2.8-1ubuntu0.1+esm1|2.8-1ubuntu0.1+esm2
    fixed_versions: vers:deb/2.8-1ubuntu0.1+esm3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/jinja2?arch=source&distro=esm-infra/bionic
    affected_versions: vers:deb/2.9.6-1|2.10-1|2.10-1ubuntu0.18.04.1|2.10-1ubuntu0.18.04.1+esm1
    fixed_versions: vers:deb/2.10-1ubuntu0.18.04.1+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/jinja2?arch=source&distro=focal
    affected_versions: vers:deb/2.10-2ubuntu1|2.10-2ubuntu2|2.10.1-1ubuntu1|2.10.1-2|2.10.1-2ubuntu0.2
    fixed_versions: vers:deb/2.10.1-2ubuntu0.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/jinja2?arch=source&distro=jammy
    affected_versions: vers:deb/2.11.3-1|3.0.1-2|3.0.3-1|3.0.3-1ubuntu0.1
    fixed_versions: vers:deb/3.0.3-1ubuntu0.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/jinja2?arch=source&distro=noble
    affected_versions: vers:deb/3.1.2-1|3.1.2-1ubuntu1
    fixed_versions: vers:deb/3.1.2-1ubuntu1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-34064.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-34064.json
weaknesses: []
references:
  - url: https://github.com/pallets/jinja/commit/0668239dc6b44ef38e7a6c9f91f312fd4ca581cb
    reference_type:
    reference_id:
  - url: https://github.com/pallets/jinja/security/advisories/GHSA-h75v-3vvj-5mfj
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-34064
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6787-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-34064
    reference_type:
    reference_id:
