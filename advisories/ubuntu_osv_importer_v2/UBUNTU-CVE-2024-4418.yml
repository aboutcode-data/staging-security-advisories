advisory_id: UBUNTU-CVE-2024-4418
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-4418
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-4418.json
aliases:
  - CVE-2024-4418
summary: A race condition leading to a stack use-after-free flaw was found in libvirt. Due to
  a bad assumption in the virNetClientIOEventLoop() method, the `data` pointer to a stack-allocated
  virNetClientIOEventData structure ended up being used in the virNetClientIOEventFD callback
  while the data pointer's stack frame was concurrently being "freed" when returning from virNetClientIOEventLoop().
  The 'virtproxyd' daemon can be used to trigger requests. If libvirt is configured with fine-grained
  access control, this issue, in theory, allows a user to escape their otherwise limited access.
  This flaw allows a local, unprivileged user to access virtproxyd without authenticating. Remote
  users would need to authenticate before they could access it.
impacted_packages:
  - purl: pkg:deb/ubuntu/libvirt?arch=source&distro=noble
    affected_versions: vers:deb/9.6.0-1ubuntu1|9.6.0-1ubuntu2|10.0.0-1ubuntu1|10.0.0-2ubuntu1|10.0.0-2ubuntu5|10.0.0-2ubuntu7|10.0.0-2ubuntu8|10.0.0-2ubuntu8.1
    fixed_versions: vers:deb/10.0.0-2ubuntu8.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-4418.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-4418.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2024-4418
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6763-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-4418
    reference_type:
    reference_id:
