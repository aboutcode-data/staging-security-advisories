advisory_id: UBUNTU-CVE-2022-31008
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-31008
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31008.json
aliases:
  - CVE-2022-31008
summary: 'RabbitMQ is a multi-protocol messaging and streaming broker. In affected versions
  the shovel and federation plugins perform URI obfuscation in their worker (link) state. The
  encryption key used to encrypt the URI was seeded with a predictable secret. This means that
  in case of certain exceptions related to Shovel and Federation plugins, reasonably easily
  deobfuscatable data could appear in the node log. Patched versions correctly use a cluster-wide
  secret for that purpose. This issue has been addressed and Patched versions: `3.10.2`, `3.9.18`,
  `3.8.32` are available. Users unable to upgrade should disable the Shovel and Federation plugins.'
impacted_packages:
  - purl: pkg:deb/ubuntu/broker?arch=source&distro=jammy
    affected_versions: vers:deb/1.4.0+ds1-1|1.4.0+ds1-1build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31008.json
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31008.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-31008.json
weaknesses: []
references:
  - url: https://github.com/rabbitmq/rabbitmq-server/pull/4841
    reference_type:
    reference_id:
  - url: https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-v9gv-xp36-jgj8
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-31008
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-31008
    reference_type:
    reference_id:
