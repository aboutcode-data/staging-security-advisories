advisory_id: UBUNTU-CVE-2017-3737
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2017-3737
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-3737.json
aliases:
  - CVE-2017-3737
summary: OpenSSL 1.0.2 (starting from version 1.0.2b) introduced an "error state" mechanism.
  The intent was that if a fatal error occurred during a handshake then OpenSSL would move into
  the error state and would immediately fail if you attempted to continue the handshake. This
  works as designed for the explicit handshake functions (SSL_do_handshake(), SSL_accept() and
  SSL_connect()), however due to a bug it does not work correctly if SSL_read() or SSL_write()
  is called directly. In that scenario, if the handshake fails then a fatal error will be returned
  in the initial function call. If SSL_read()/SSL_write() is subsequently called by the application
  for the same SSL object then it will succeed and the data is passed without being decrypted/encrypted
  directly from the SSL/TLS record layer. In order to exploit this issue an application bug
  would have to be present that resulted in a call to SSL_read()/SSL_write() being issued after
  having already received a fatal error. OpenSSL version 1.0.2b-1.0.2m are affected. Fixed in
  OpenSSL 1.0.2n. OpenSSL 1.1.0 is not affected.
impacted_packages:
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=xenial
    affected_versions: vers:deb/1.0.2d-0ubuntu1|1.0.2d-0ubuntu2|1.0.2e-1ubuntu1|1.0.2f-2ubuntu1|1.0.2g-1ubuntu2|1.0.2g-1ubuntu3|1.0.2g-1ubuntu4|1.0.2g-1ubuntu4.1|1.0.2g-1ubuntu4.2|1.0.2g-1ubuntu4.4|1.0.2g-1ubuntu4.5|1.0.2g-1ubuntu4.6|1.0.2g-1ubuntu4.8|1.0.2g-1ubuntu4.9
    fixed_versions: vers:deb/1.0.2g-1ubuntu4.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-3737.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2017/UBUNTU-CVE-2017-3737.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2017-3737
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3512-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2017-3737
    reference_type:
    reference_id:
  - url: https://www.openssl.org/news/secadv/20171207.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
