advisory_id: UBUNTU-CVE-2022-30699
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-30699
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-30699.json
aliases:
  - CVE-2022-30699
summary: NLnet Labs Unbound, up to and including version 1.16.1, is vulnerable to a novel type
  of the "ghost domain names" attack. The vulnerability works by targeting an Unbound instance.
  Unbound is queried for a rogue domain name when the cached delegation information is about
  to expire. The rogue nameserver delays the response so that the cached delegation information
  is expired. Upon receiving the delayed answer containing the delegation information, Unbound
  overwrites the now expired entries. This action can be repeated when the delegation information
  is about to expire making the rogue delegation information ever-updating. From version 1.16.2
  on, Unbound stores the start time for a query and uses that to decide if the cached delegation
  information can be overwritten.
impacted_packages:
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/1.4.20-1|1.4.21-1|1.4.21-1ubuntu1|1.4.21-1ubuntu2|1.4.22-1ubuntu1|1.4.22-1ubuntu2|1.4.22-1ubuntu3|1.4.22-1ubuntu4|1.4.22-1ubuntu4.14.04.1|1.4.22-1ubuntu4.14.04.2|1.4.22-1ubuntu4.14.04.3|1.4.22-1ubuntu4.14.04.3+esm1|1.4.22-1ubuntu4.14.04.3+esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/1.4.22-1ubuntu6|1.5.7-1ubuntu1|1.5.7-1ubuntu2|1.5.8-1ubuntu1|1.5.8-1ubuntu1.1|1.5.8-1ubuntu1.1+esm1|1.5.8-1ubuntu1.1+esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=bionic
    affected_versions: vers:deb/1.6.5-1|1.6.7-1|1.6.7-1build1|1.6.7-1ubuntu1|1.6.7-1ubuntu2|1.6.7-1ubuntu2.1|1.6.7-1ubuntu2.2|1.6.7-1ubuntu2.3|1.6.7-1ubuntu2.4
    fixed_versions: vers:deb/1.6.7-1ubuntu2.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=focal
    affected_versions: vers:deb/1.9.0-2ubuntu1|1.9.0-2ubuntu2|1.9.4-2|1.9.4-2ubuntu1|1.9.4-2ubuntu1.1|1.9.4-2ubuntu1.2
    fixed_versions: vers:deb/1.9.4-2ubuntu1.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=jammy
    affected_versions: vers:deb/1.13.1-1ubuntu1|1.13.1-1ubuntu3|1.13.1-1ubuntu5
    fixed_versions: vers:deb/1.13.1-1ubuntu5.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-30699.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-30699.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2022-30699
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5569-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-30699
    reference_type:
    reference_id:
  - url: https://www.nlnetlabs.nl/downloads/unbound/CVE-2022-30698_CVE-2022-30699.txt
    reference_type:
    reference_id:
