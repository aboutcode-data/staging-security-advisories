advisory_id: UBUNTU-CVE-2014-1737
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2014-1737
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2014/UBUNTU-CVE-2014-1737.json
aliases:
  - CVE-2014-1737
summary: The raw_cmd_copyin function in drivers/block/floppy.c in the Linux kernel through 3.14.3
  does not properly handle error conditions during processing of an FDRAWCMD ioctl call, which
  allows local users to trigger kfree operations and gain privileges by leveraging write access
  to a /dev/fd device. First, raw_cmd_ioctl calls raw_cmd_copyin. This function kmallocs space
  for a floppy_raw_cmd structure and stores the resulting allocation in the "rcmd" pointer argument.
  It then attempts to copy_from_user the structure from userspace. If this fails, an early EFAULT
  return is taken. The problem is that even if the early return is taken, the pointer to the
  non-/partially-initialized floppy_raw_cmd structure has already been returned via the "rcmd"
  pointer. Back out in raw_cmd_ioctl, it attempts to raw_cmd_free this pointer. raw_cmd_free
  attempts to free any DMA pages allocated for the raw command, kfrees the raw command structure
  itself, and follows the linked list, if any, of further raw commands (a user can specify the
  FD_RAW_MORE flag to signal that there are more raw commands to follow in a single FDRAWCMD
  ioctl). So, a malicious user can send a FDRAWCMD ioctl with a raw command argument structure
  that has some bytes inaccessible (ie. off the end of an allocated page). The copy_from_user
  will fail but raw_cmd_free will attempt to process the floppy_raw_cmd as if it had been fully
  initialized by the rest of raw_cmd_copyin. The user can control the arguments passed to fd_dma_mem_free
  and kfree (by making use of the linked-list feature and specifying the target address as a
  next-in-list structure).
impacted_packages:
  - purl: pkg:deb/ubuntu/linux?arch=source&distro=trusty
    affected_versions: vers:deb/3.11.0-12.19|3.12.0-1.3|3.12.0-2.5|3.12.0-2.7|3.12.0-3.8|3.12.0-3.9|3.12.0-4.10|3.12.0-4.12|3.12.0-5.13|3.12.0-7.15|3.13.0-1.16|3.13.0-2.17|3.13.0-3.18|3.13.0-4.19|3.13.0-5.20|3.13.0-6.23|3.13.0-7.25|3.13.0-7.26|3.13.0-8.27|3.13.0-8.28|3.13.0-10.30|3.13.0-11.31|3.13.0-12.32|3.13.0-13.33|3.13.0-14.34|3.13.0-15.35|3.13.0-16.36|3.13.0-17.37|3.13.0-18.38|3.13.0-19.39|3.13.0-19.40|3.13.0-20.42|3.13.0-21.43|3.13.0-22.44|3.13.0-23.45|3.13.0-24.46|3.13.0-24.47
    fixed_versions: vers:deb/3.13.0-27.50
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: high
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2014/UBUNTU-CVE-2014-1737.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2014-1737
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-2219-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-2220-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-2221-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-2223-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-2224-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-2225-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-2226-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-2227-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-2228-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-2260-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2014-1737
    reference_type:
    reference_id:
