advisory_id: UBUNTU-CVE-2022-41678
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-41678
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-41678.json
aliases:
  - CVE-2022-41678
summary: 'Once an user is authenticated on Jolokia, he can potentially trigger arbitrary code
  execution. In details, in ActiveMQ configurations, jetty allows org.jolokia.http.AgentServlet
  to handler request to /api/jolokia org.jolokia.http.HttpRequestHandler#handlePostRequest is
  able to create JmxRequest through JSONObject. And calls to org.jolokia.http.HttpRequestHandler#executeRequest.
  Into deeper calling stacks, org.jolokia.handler.ExecHandler#doHandleRequest can be invoked
  through refection. This could lead to RCE through via various mbeans. One example is unrestricted
  deserialization in jdk.management.jfr.FlightRecorderMXBeanImpl which exists on Java version
  above 11. 1 Call newRecording. 2 Call setConfiguration. And a webshell data hides in it. 3
  Call startRecording. 4 Call copyTo method. The webshell will be written to a .jsp file. The
  mitigation is to restrict (by default) the actions authorized on Jolokia, or disable Jolokia.
  A more restrictive Jolokia configuration has been defined in default ActiveMQ distribution.
  We encourage users to upgrade to ActiveMQ distributions version including updated Jolokia
  configuration: 5.16.6, 5.17.4, 5.18.0, 6.0.0.'
impacted_packages:
  - purl: pkg:deb/ubuntu/activemq?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/5.15.10-1|5.15.11-1
    fixed_versions: vers:deb/5.15.11-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/activemq?arch=source&distro=jammy
    affected_versions: vers:deb/5.16.1-1
    fixed_versions: vers:deb/5.16.1-1ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/activemq?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/5.6.0+dfsg1-4+deb8u1ubuntu1|5.6.0+dfsg1-5|5.13.2+dfsg-2
    fixed_versions: vers:deb/5.13.2+dfsg-2ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/activemq?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/5.14.5-3|5.15.2-2|5.15.3-2|5.15.8-2~18.04
    fixed_versions: vers:deb/5.15.8-2~18.04.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-41678.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-41678.json
weaknesses: []
references:
  - url: https://activemq.apache.org/security-advisories.data/CVE-2022-41678-announcement.txt
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/7g17kwbtjl011mm4tr8bn1vnoq9wh4sl
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-41678
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6910-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7268-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-41678
    reference_type:
    reference_id:
