advisory_id: UBUNTU-CVE-2021-33912
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-33912
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-33912.json
aliases:
  - CVE-2021-33912
summary: libspf2 before 1.2.11 has a four-byte heap-based buffer overflow that might allow remote
  attackers to execute arbitrary code (via an unauthenticated e-mail message from anywhere on
  the Internet) with a crafted SPF DNS record, because of incorrect sprintf usage in SPF_record_expand_data
  in spf_expand.c. The vulnerable code may be part of the supply chain of a site's e-mail infrastructure
  (e.g., with additional configuration, Exim can use libspf2; the Postfix web site links to
  unofficial patches for use of libspf2 with Postfix; older versions of spfquery relied on libspf2)
  but most often is not.
impacted_packages:
  - purl: pkg:deb/ubuntu/libspf2?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.2.10-6|1.2.10-6build1|1.2.10-6ubuntu0.1~esm1
    fixed_versions: vers:deb/1.2.10-6ubuntu0.1~esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libspf2?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.2.10-7build2
    fixed_versions: vers:deb/1.2.10-7ubuntu0.18.04.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libspf2?arch=source&distro=focal
    affected_versions: vers:deb/1.2.10-7build3|1.2.10-7build4
    fixed_versions: vers:deb/1.2.10-7+deb9u2build0.20.04.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-33912.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-33912.json
weaknesses: []
references:
  - url: https://github.com/shevek/libspf2/commit/28faf4624a6a371b11afdb9820078d3b0ee3803d
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-33912
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6584-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6584-2
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-33912
    reference_type:
    reference_id:
