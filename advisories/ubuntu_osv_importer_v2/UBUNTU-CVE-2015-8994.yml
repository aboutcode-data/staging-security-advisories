advisory_id: UBUNTU-CVE-2015-8994
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2015-8994
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2015/UBUNTU-CVE-2015-8994.json
aliases:
  - CVE-2015-8994
summary: 'An issue was discovered in PHP 5.x and 7.x, when the configuration uses apache2handler/mod_php
  or php-fpm with OpCache enabled. With 5.x after 5.6.28 or 7.x after 7.0.13, the issue is resolved
  in a non-default configuration with the opcache.validate_permission=1 setting. The vulnerability
  details are as follows. In PHP SAPIs where PHP interpreters share a common parent process,
  Zend OpCache creates a shared memory object owned by the common parent during initialization.
  Child PHP processes inherit the SHM descriptor, using it to cache and retrieve compiled script
  bytecode ("opcode" in PHP jargon). Cache keys vary depending on configuration, but filename
  is a central key component, and compiled opcode can generally be run if a script''s filename
  is known or can be guessed. Many common shared-hosting configurations change EUID in child
  processes to enforce privilege separation among hosted users (for example using mod_ruid2
  for the Apache HTTP Server, or php-fpm user settings). In these scenarios, the default Zend
  OpCache behavior defeats script file permissions by sharing a single SHM cache among all child
  PHP processes. PHP scripts often contain sensitive information: Think of CMS configurations
  where reading or running another user''s script usually means gaining privileges to the CMS
  database.'
impacted_packages:
  - purl: pkg:deb/ubuntu/php5?arch=source&distro=trusty
    affected_versions: vers:deb/5.5.3+dfsg-1ubuntu2|5.5.3+dfsg-1ubuntu3|5.5.6+dfsg-1ubuntu1|5.5.6+dfsg-1ubuntu2|5.5.8+dfsg-2ubuntu1|5.5.9+dfsg-1ubuntu1|5.5.9+dfsg-1ubuntu2|5.5.9+dfsg-1ubuntu3|5.5.9+dfsg-1ubuntu4|5.5.9+dfsg-1ubuntu4.1|5.5.9+dfsg-1ubuntu4.2|5.5.9+dfsg-1ubuntu4.3|5.5.9+dfsg-1ubuntu4.4|5.5.9+dfsg-1ubuntu4.5|5.5.9+dfsg-1ubuntu4.6|5.5.9+dfsg-1ubuntu4.7|5.5.9+dfsg-1ubuntu4.9|5.5.9+dfsg-1ubuntu4.11|5.5.9+dfsg-1ubuntu4.12|5.5.9+dfsg-1ubuntu4.13|5.5.9+dfsg-1ubuntu4.14|5.5.9+dfsg-1ubuntu4.16|5.5.9+dfsg-1ubuntu4.17|5.5.9+dfsg-1ubuntu4.19|5.5.9+dfsg-1ubuntu4.20|5.5.9+dfsg-1ubuntu4.21
    fixed_versions: vers:deb/5.5.9+dfsg-1ubuntu4.22
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2015/UBUNTU-CVE-2015-8994.json
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2015/UBUNTU-CVE-2015-8994.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2015/UBUNTU-CVE-2015-8994.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2015-8994
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3382-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2015-8994
    reference_type:
    reference_id:
