advisory_id: UBUNTU-CVE-2024-5187
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-5187
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-5187.json
aliases:
  - CVE-2024-5187
summary: A vulnerability in the `download_model_with_test_data` function of the onnx/onnx framework,
  version 1.16.0, allows for arbitrary file overwrite due to inadequate prevention of path traversal
  attacks in malicious tar files. This vulnerability enables attackers to overwrite any file
  on the system, potentially leading to remote code execution, deletion of system, personal,
  or application files, thus impacting the integrity and availability of the system. The issue
  arises from the function's handling of tar file extraction without performing security checks
  on the paths within the tar file, as demonstrated by the ability to overwrite the `/home/kali/.ssh/authorized_keys`
  file by specifying an absolute path in the malicious tar file.
impacted_packages:
  - purl: pkg:deb/ubuntu/onnx?arch=source&distro=jammy
    affected_versions: vers:deb/1.7.0+dfsg-3build1|1.7.0+dfsg-3build2|1.7.0+dfsg-3ubuntu1|1.7.0+dfsg-3ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/onnx?arch=source&distro=noble
    affected_versions: vers:deb/1.13.1-3|1.13.1-3build1|1.14.1-2|1.14.1-2.1|1.14.1-2.1build1|1.14.1-2.1build2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/onnx?arch=source&distro=questing
    affected_versions: vers:deb/1.17.0-3build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-5187.json
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-5187.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-5187.json
weaknesses: []
references:
  - url: https://huntr.com/bounties/50235ebd-3410-4ada-b064-1a648e11237e
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-5187
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-5187
    reference_type:
    reference_id:
