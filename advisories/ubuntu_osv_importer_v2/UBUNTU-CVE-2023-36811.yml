advisory_id: UBUNTU-CVE-2023-36811
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-36811
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-36811.json
aliases:
  - CVE-2023-36811
summary: 'borgbackup is an opensource, deduplicating archiver with compression and authenticated
  encryption. A flaw in the cryptographic authentication scheme in borgbackup allowed an attacker
  to fake archives and potentially indirectly cause backup data loss in the repository. The
  attack requires an attacker to be able to: 1. insert files (with no additional headers) into
  backups and 2. gain write access to the repository. This vulnerability does not disclose plaintext
  to the attacker, nor does it affect the authenticity of existing archives. Creating plausible
  fake archives may be feasible for empty or small archives, but is unlikely for large archives.
  The issue has been fixed in borgbackup 1.2.5. Users are advised to upgrade. Additionally to
  installing the fixed code, users must follow the upgrade procedure as documented in the change
  log. Data loss after being attacked can be avoided by reviewing the archives (timestamp and
  contents valid and as expected) after any "borg check --repair" and before "borg prune". There
  are no known workarounds for this vulnerability.'
impacted_packages:
  - purl: pkg:deb/ubuntu/borgbackup?arch=source&distro=xenial
    affected_versions: vers:deb/0.28.1-1|0.28.1-2|0.28.2-1|0.28.2-2|0.29.0-1|0.29.0-2|0.29.0-3|0.29.0-4|0.30.0-1|1.0.0~rc1-1|1.0.0~rc1-2|1.0.0~rc1-3|1.0.0~rc2-1|1.0.0~rc2-3|1.0.0-1|1.0.0-2|1.0.0-3|1.0.0-4|1.0.1-1|1.0.2-1|1.0.7-0ubuntu1.16.04.1|1.0.11-0ubuntu1.16.04.2|1.0.12-0ubuntu1.16.04.1|1.0.13-0ubuntu1.16.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/borgbackup?arch=source&distro=bionic
    affected_versions: vers:deb/1.0.11-4|1.1.2-3|1.1.2-4|1.1.2-5|1.1.3-1build1|1.1.3-2|1.1.3-3|1.1.4-1|1.1.4-2|1.1.4-2build1|1.1.4-3|1.1.5-1~build1|1.1.5-1|1.1.15-1~ubuntu1.18.04.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/borgbackup?arch=source&distro=focal
    affected_versions: vers:deb/1.1.10-2|1.1.10-2build1|1.1.11-1~build1|1.1.11-1|1.1.11-2|1.1.11-5~build1|1.1.11-5|1.1.15-1~ubuntu1.20.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/borgbackup?arch=source&distro=jammy
    affected_versions: vers:deb/1.1.17-1|1.1.17-1build1|1.2.0-1|1.2.0-1ubuntu1.22.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/borgbackup?arch=source&distro=noble
    affected_versions: vers:deb/1.2.6-2|1.2.7-1|1.2.7-2|1.2.7-2build1|1.2.7-2build2|1.2.7-2build3|1.2.8-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-36811.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-36811.json
weaknesses: []
references:
  - url: https://borgbackup.readthedocs.io/en/stable/changes.html#pre-1-2-5-archives-spoofing-vulnerability-cve-2023-36811
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/blob/1.2.5-cvedocs/docs/changes.rst#pre-125-archives-spoofing-vulnerability-cve-2023-36811
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/277b0b81a860f4518d7bf0cc0951e77f9c99336d
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/3eb070191da10c2d3f7bc6484cf3d51c3045f884
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/449cd51b73b0710a940af8cefe74793ce81563f4
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/462c1bdf2e597bd2e276c8fea82c84fabc0b7244
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/56da3987111eb80b4ca38ac3e6aaa7953c61d2e3
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/5cd2060345f38f2e0324ab178f847c2f45598b12
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/95b560442284eda3ffae403c3086d549f6e121b8
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/a2ee13fd341dcd004b4a06b17d6f2fc759327861
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/b23e6cb73da01df038f7bd10c34a91c7187817b0
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/bfead4b288833f890523d8881797ff6b345edaf9
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/commit/f334ef1b4de2f8a359ededa41ce13358b81e63c1
    reference_type:
    reference_id:
  - url: https://github.com/borgbackup/borg/security/advisories/GHSA-8fjr-hghr-4m99
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-36811
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-36811
    reference_type:
    reference_id:
