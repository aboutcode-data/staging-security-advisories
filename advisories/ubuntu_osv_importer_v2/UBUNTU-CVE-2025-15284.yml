advisory_id: UBUNTU-CVE-2025-15284
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-15284
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-15284.json
aliases:
  - CVE-2025-15284
summary: 'Improper Input Validation vulnerability in qs (parse modules) allows HTTP DoS.This
  issue affects qs: < 6.14.1. Summary The arrayLimit option in qs did not enforce limits for
  bracket notation (a[]=1&a[]=2), only for indexed notation (a[0]=1). This is a consistency
  bug; arrayLimit should apply uniformly across all array notations. Note: The default parameterLimit of
  1000 effectively mitigates the DoS scenario originally described. With default options, bracket
  notation cannot produce arrays larger than parameterLimit regardless of arrayLimit, because
  each a[]=valueconsumes one parameter slot. The severity has been reduced accordingly. Details
  The arrayLimit option only checked limits for indexed notation (a[0]=1&a[1]=2) but did not
  enforce it for bracket notation (a[]=1&a[]=2). Vulnerable code (lib/parse.js:159-162): if
  (root === ''[]'' && options.parseArrays) {     obj = utils.combine([], leaf);  // No arrayLimit
  check } Working code (lib/parse.js:175): else if (index <= options.arrayLimit) {  // Limit
  checked here     obj = [];     obj[index] = leaf; } The bracket notation handler at line 159
  uses utils.combine([], leaf) without validating against options.arrayLimit, while indexed
  notation at line 175 checks index <= options.arrayLimit before creating arrays. PoC const
  qs = require(''qs''); const result = qs.parse(''a[]=1&a[]=2&a[]=3&a[]=4&a[]=5&a[]=6'', { arrayLimit:
  5 }); console.log(result.a.length);  // Output: 6 (should be max 5) Note on parameterLimit
  interaction: The original advisory''s "DoS demonstration" claimed a length of 10,000, but
  parameterLimit (default: 1000) caps parsing to 1,000 parameters. With default options, the
  actual output is 1,000, not 10,000. Impact Consistency bug in arrayLimit enforcement. With
  default parameterLimit, the practical DoS risk is negligible since parameterLimit already
  caps the total number of parsed parameters (and thus array elements from bracket notation).
  The risk increases only when parameterLimit is explicitly set to a very high value.'
impacted_packages:
  - purl: pkg:deb/ubuntu/node-qs?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/0.4.2-1|0.6.5-1|0.6.5-1ubuntu0.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-qs?arch=source&distro=xenial
    affected_versions: vers:deb/2.2.4-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-qs?arch=source&distro=bionic
    affected_versions: vers:deb/2.2.4-1|2.2.4-1ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-qs?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/6.5.2-1|6.9.0+ds-1|6.9.1+ds-1|6.9.1+ds-1ubuntu0.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-qs?arch=source&distro=jammy
    affected_versions: vers:deb/6.9.4+ds-1|6.10.1+ds-1|6.10.2+ds+~6.9.7-1|6.10.3+ds+~6.9.7-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-qs?arch=source&distro=noble
    affected_versions: vers:deb/6.11.0+ds+~6.9.7-3|6.11.0+ds+~6.9.7-4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-qs?arch=source&distro=questing
    affected_versions: vers:deb/6.13.0+ds+~6.9.16-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-15284.json
  - score: '6.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-15284.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-15284.json
weaknesses: []
references:
  - url: https://github.com/ljharb/qs/commit/3086902ecf7f088d0d1803887643ac6c03d415b9
    reference_type:
    reference_id:
  - url: https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-15284
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-15284
    reference_type:
    reference_id:
