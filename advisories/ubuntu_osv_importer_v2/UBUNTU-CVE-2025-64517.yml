advisory_id: UBUNTU-CVE-2025-64517
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-64517
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-64517.json
aliases:
  - CVE-2025-64517
summary: sudo-rs is a memory safe implementation of sudo and su written in Rust. With `Defaults
  targetpw` (or `Defaults rootpw`) enabled,  the password of the target account (or root account)
  instead of the invoking user is used for authentication. sudo-rs starting in version 0.2.5
  and prior to version 0.2.10 incorrectly recorded the invoking userâ€™s UID instead of the authenticated-as
  user's UID in the authentication timestamp. Any later `sudo` invocation on the same terminal
  while the timestamp was still valid would use that timestamp, potentially bypassing new authentication
  even if the policy would have required it. A highly-privileged user (able to run commands
  as other users, or as root, through sudo) who knows one password of an account they are allowed
  to run commands as, would be able to run commands as any other account the policy permits
  them to run commands for, even if they don't know the password for those accounts. A common
  instance of this would be that a user can still use their own password to run commands as
  root (the default behaviour of `sudo`), effectively negating the intended behaviour of the
  `targetpw` or `rootpw` options. Version 0.2.10 contains a patch for the issue. Versions prior
  to 0.2.5 are not affected, since they do not offer `Defaults targetpw` or `Defaults rootpw`.
impacted_packages:
  - purl: pkg:deb/ubuntu/rust-sudo-rs?arch=source&distro=questing
    affected_versions: vers:deb/0.2.4-1|0.2.5-3ubuntu1|0.2.5-4|0.2.5-5|0.2.5-5ubuntu1|0.2.5-5ubuntu3|0.2.8-1ubuntu2|0.2.8-1ubuntu3|0.2.8-1ubuntu4|0.2.8-1ubuntu5|0.2.8-1ubuntu5.1
    fixed_versions: vers:deb/0.2.8-1ubuntu5.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-64517.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-64517.json
weaknesses: []
references:
  - url: https://github.com/trifectatechfoundation/sudo-rs/security/advisories/GHSA-q428-6v73-fc4q
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-64517
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7867-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-64517
    reference_type:
    reference_id:
