advisory_id: UBUNTU-CVE-2021-32751
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-32751
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32751.json
aliases:
  - CVE-2021-32751
summary: Gradle is a build tool with a focus on build automation. In versions prior to 7.2,
  start scripts generated by the `application` plugin and the `gradlew` script are both vulnerable
  to arbitrary code execution when an attacker is able to change environment variables for the
  user running the script. This may impact those who use `gradlew` on Unix-like systems or use
  the scripts generated by Gradle in thieir application on Unix-like systems. For this vulnerability
  to be exploitable, an attacker needs to be able to set the value of particular environment
  variables and have those environment variables be seen by the vulnerable scripts. This issue
  has been patched in Gradle 7.2 by removing the use of `eval` and requiring the use of the
  `bash` shell. There are a few workarounds available. For CI/CD systems using the Gradle build
  tool, one may ensure that untrusted users are unable to change environment variables for the
  user that executes `gradlew`. If one is unable to upgrade to Gradle 7.2, one may generate
  a new `gradlew` script with Gradle 7.2 and use it for older versions of Gradle. Fpplications
  using start scripts generated by Gradle, one may ensure that untrusted users are unable to
  change environment variables for the user that executes the start script. A vulnerable start
  script could be manually patched to remove the use of `eval` or the use of environment variables
  that affect the application's command-line. If the application is simple enough, one may be
  able to avoid the use of the start scripts by running the application directly with Java command.
impacted_packages:
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=xenial
    affected_versions: vers:deb/2.5-3|2.7-1|2.7-2|2.7-3|2.10-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/3.2.1-3build2|3.2.1-4|3.2.1-5|3.4.1-4|3.4.1-6|3.4.1-7ubuntu1|4.4.1-5ubuntu2~18.04|4.4.1-5ubuntu2~18.04+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=focal
    affected_versions: vers:deb/4.4.1-8|4.4.1-9|4.4.1-10
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=jammy
    affected_versions: vers:deb/4.4.1-13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=noble
    affected_versions: vers:deb/4.4.1-18|4.4.1-20
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=questing
    affected_versions: vers:deb/4.4.1-22
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32751.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32751.json
weaknesses: []
references:
  - url: https://github.com/gradle/gradle/security/advisories/GHSA-6j2p-252f-7mw8
    reference_type:
    reference_id:
  - url: https://medium.com/dot-debug/the-perils-of-bash-eval-cc5f9e309cae
    reference_type:
    reference_id:
  - url: https://mywiki.wooledge.org/BashFAQ/048
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-32751
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-32751
    reference_type:
    reference_id:
