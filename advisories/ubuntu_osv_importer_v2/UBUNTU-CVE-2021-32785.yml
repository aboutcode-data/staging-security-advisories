advisory_id: UBUNTU-CVE-2021-32785
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-32785
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32785.json
aliases:
  - CVE-2021-32785
summary: mod_auth_openidc is an authentication/authorization module for the Apache 2.x HTTP
  server that functions as an OpenID Connect Relying Party, authenticating users against an
  OpenID Connect Provider. When mod_auth_openidc versions prior to 2.4.9 are configured to use
  an unencrypted Redis cache (`OIDCCacheEncrypt off`, `OIDCSessionType server-cache`, `OIDCCacheType
  redis`), `mod_auth_openidc` wrongly performed argument interpolation before passing Redis
  requests to `hiredis`, which would perform it again and lead to an uncontrolled format string
  bug. Initial assessment shows that this bug does not appear to allow gaining arbitrary code
  execution, but can reliably provoke a denial of service by repeatedly crashing the Apache
  workers. This bug has been corrected in version 2.4.9 by performing argument interpolation
  only once, using the `hiredis` API. As a workaround, this vulnerability can be mitigated by
  setting `OIDCCacheEncrypt` to `on`, as cache keys are cryptographically hashed before use
  when this option is enabled.
impacted_packages:
  - purl: pkg:deb/ubuntu/libapache2-mod-auth-openidc?arch=source&distro=bionic
    affected_versions: vers:deb/2.1.6-1|2.3.1-2|2.3.2-1|2.3.2-1build1|2.3.3-1build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libapache2-mod-auth-openidc?arch=source&distro=focal
    affected_versions: vers:deb/2.3.10.2-1|2.4.0.4-1|2.4.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32785.json
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32785.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32785.json
weaknesses: []
references:
  - url: https://github.com/zmartzone/mod_auth_openidc/commit/dc672688dc1f2db7df8ad4abebc367116017a449
    reference_type:
    reference_id:
  - url: https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9
    reference_type:
    reference_id:
  - url: https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-55r8-6w97-xxr4
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-32785
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-32785
    reference_type:
    reference_id:
