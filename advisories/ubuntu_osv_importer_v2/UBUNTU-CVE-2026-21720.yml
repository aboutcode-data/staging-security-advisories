advisory_id: UBUNTU-CVE-2026-21720
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2026-21720
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-21720.json
aliases:
  - CVE-2026-21720
summary: Every uncached /avatar/:hash request spawns a goroutine that refreshes the Gravatar
  image. If the refresh sits in the 10-slot worker queue longer than three seconds, the handler
  times out and stops listening for the result, so that goroutine blocks forever trying to send
  on an unbuffered channel. Sustained traffic with random hashes keeps tripping this timeout,
  so goroutine count grows linearly, eventually exhausting memory and causing Grafana to crash
  on some systems.
impacted_packages:
  - purl: pkg:deb/ubuntu/grafana?arch=source&distro=xenial
    affected_versions: vers:deb/2.6.0+dfsg-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-21720.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-21720.json
weaknesses: []
references:
  - url: https://grafana.com/security/security-advisories/CVE-2026-21720
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2026-21720
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2026-21720
    reference_type:
    reference_id:
