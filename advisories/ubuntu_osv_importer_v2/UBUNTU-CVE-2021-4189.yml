advisory_id: UBUNTU-CVE-2021-4189
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-4189
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-4189.json
aliases:
  - CVE-2021-4189
summary: A flaw was found in Python, specifically in the FTP (File Transfer Protocol) client
  library in PASV (passive) mode. The issue is how the FTP client trusts the host from the PASV
  response by default. This flaw allows an attacker to set up a malicious FTP server that can
  trick FTP clients into connecting back to a given IP address and port. This vulnerability
  could lead to FTP client scanning ports, which otherwise would not have been possible.
impacted_packages:
  - purl: pkg:deb/ubuntu/python2.7?arch=source&distro=trusty/esm
    affected_versions: vers:deb/2.7.5-8ubuntu3|2.7.5-8ubuntu4|2.7.6-2|2.7.6-2ubuntu1|2.7.6-3|2.7.6-3ubuntu1|2.7.6-4|2.7.6-4ubuntu1|2.7.6-5|2.7.6-7|2.7.6-8|2.7.6-8ubuntu0.2|2.7.6-8ubuntu0.3|2.7.6-8ubuntu0.4|2.7.6-8ubuntu0.5|2.7.6-8ubuntu0.6+esm2|2.7.6-8ubuntu0.6+esm3|2.7.6-8ubuntu0.6+esm5|2.7.6-8ubuntu0.6+esm6|2.7.6-8ubuntu0.6+esm7|2.7.6-8ubuntu0.6+esm8|2.7.6-8ubuntu0.6+esm9|2.7.6-8ubuntu0.6+esm10|2.7.6-8ubuntu0.6+esm11
    fixed_versions: vers:deb/2.7.6-8ubuntu0.6+esm12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python3.4?arch=source&distro=trusty/esm
    affected_versions: vers:deb/3.4~b1-0ubuntu3|3.4~b1-4ubuntu4|3.4~b1-4ubuntu6|3.4~b1-5ubuntu2|3.4~b2-1|3.4~b3-1ubuntu1|3.4~rc1-1build1|3.4~rc2-1|3.4~rc3-0ubuntu1|3.4.0-1|3.4.0-2ubuntu1|3.4.0-2ubuntu1.1|3.4.3-1ubuntu1~14.04.1|3.4.3-1ubuntu1~14.04.3|3.4.3-1ubuntu1~14.04.4|3.4.3-1ubuntu1~14.04.5|3.4.3-1ubuntu1~14.04.6|3.4.3-1ubuntu1~14.04.7|3.4.3-1ubuntu1~14.04.7+esm2|3.4.3-1ubuntu1~14.04.7+esm4|3.4.3-1ubuntu1~14.04.7+esm6|3.4.3-1ubuntu1~14.04.7+esm7|3.4.3-1ubuntu1~14.04.7+esm8|3.4.3-1ubuntu1~14.04.7+esm10|3.4.3-1ubuntu1~14.04.7+esm11
    fixed_versions: vers:deb/3.4.3-1ubuntu1~14.04.7+esm12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python3.5?arch=source&distro=trusty/esm
    affected_versions: vers:deb/3.5.2-2ubuntu0~16.04.4~14.04.1
    fixed_versions: vers:deb/3.5.2-2ubuntu0~16.04.4~14.04.1+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python2.7?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/2.7.10-4ubuntu1|2.7.10-4ubuntu2|2.7.11-2|2.7.11-3|2.7.11-4|2.7.11-6|2.7.11-7|2.7.11-7ubuntu1|2.7.12-1~16.04|2.7.12-1ubuntu0~16.04.1|2.7.12-1ubuntu0~16.04.2|2.7.12-1ubuntu0~16.04.3|2.7.12-1ubuntu0~16.04.4|2.7.12-1ubuntu0~16.04.8|2.7.12-1ubuntu0~16.04.9|2.7.12-1ubuntu0~16.04.11|2.7.12-1ubuntu0~16.04.12|2.7.12-1ubuntu0~16.04.13|2.7.12-1ubuntu0~16.04.14|2.7.12-1ubuntu0~16.04.16|2.7.12-1ubuntu0~16.04.18
    fixed_versions: vers:deb/2.7.12-1ubuntu0~16.04.18+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python3.5?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/3.5.0-3|3.5.0-3ubuntu1|3.5.1~rc1-2ubuntu1|3.5.1-1|3.5.1-2|3.5.1-3|3.5.1-5|3.5.1-6ubuntu1|3.5.1-6ubuntu2|3.5.1-9ubuntu1|3.5.1-10|3.5.2-2~16.01|3.5.2-2~16.04|3.5.2-2ubuntu0~16.04.1|3.5.2-2ubuntu0~16.04.2|3.5.2-2ubuntu0~16.04.3|3.5.2-2ubuntu0~16.04.4|3.5.2-2ubuntu0~16.04.5|3.5.2-2ubuntu0~16.04.8|3.5.2-2ubuntu0~16.04.9|3.5.2-2ubuntu0~16.04.10|3.5.2-2ubuntu0~16.04.11|3.5.2-2ubuntu0~16.04.12|3.5.2-2ubuntu0~16.04.13|3.5.2-2ubuntu0~16.04.13+esm1
    fixed_versions: vers:deb/3.5.2-2ubuntu0~16.04.13+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python2.7?arch=source&distro=bionic
    affected_versions: vers:deb/2.7.14-2ubuntu2|2.7.14-4|2.7.14-6|2.7.14-7|2.7.14-8|2.7.15~rc1-1|2.7.15~rc1-1ubuntu0.1|2.7.15-4ubuntu4~18.04|2.7.15-4ubuntu4~18.04.1|2.7.15-4ubuntu4~18.04.2|2.7.17-1~18.04|2.7.17-1~18.04ubuntu1|2.7.17-1~18.04ubuntu1.1|2.7.17-1~18.04ubuntu1.2|2.7.17-1~18.04ubuntu1.3|2.7.17-1~18.04ubuntu1.5|2.7.17-1~18.04ubuntu1.6
    fixed_versions: vers:deb/2.7.17-1~18.04ubuntu1.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python3.6?arch=source&distro=bionic
    affected_versions: vers:deb/3.6.3-1ubuntu1|3.6.4~rc1-1|3.6.4~rc1-2|3.6.4-1|3.6.4-2|3.6.4-3build1|3.6.4-4|3.6.5~rc1-1|3.6.5-3|3.6.6-1~18.04|3.6.7-1~18.04|3.6.8-1~18.04.1|3.6.8-1~18.04.2|3.6.8-1~18.04.3|3.6.9-1~18.04|3.6.9-1~18.04ubuntu1|3.6.9-1~18.04ubuntu1.1|3.6.9-1~18.04ubuntu1.3|3.6.9-1~18.04ubuntu1.4|3.6.9-1~18.04ubuntu1.6
    fixed_versions: vers:deb/3.6.9-1~18.04ubuntu1.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python3.7?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/3.7.0~a2-1|3.7.0~a3-1|3.7.0~a3-2|3.7.0~a3-3|3.7.0~a4-1|3.7.0~b1-1|3.7.0~b1-1build1|3.7.0~b2-1|3.7.0~b3-1|3.7.0-1~18.04|3.7.1-1~18.04|3.7.3-2~18.04.1|3.7.5-2~18.04|3.7.5-2~18.04.4|3.7.5-2ubuntu1~18.04.2|3.7.5-2ubuntu1~18.04.2+esm1|3.7.5-2ubuntu1~18.04.2+esm2
    fixed_versions: vers:deb/3.7.5-2ubuntu1~18.04.2+esm3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python3.8?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/3.8.0-3~18.04|3.8.0-3~18.04.1|3.8.0-3ubuntu1~18.04.2|3.8.0-3ubuntu1~18.04.2+esm1
    fixed_versions: vers:deb/3.8.0-3ubuntu1~18.04.2+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python2.7?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/2.7.17~rc1-1|2.7.17-1|2.7.17-1ubuntu5|2.7.17-1ubuntu6|2.7.18~rc1-2|2.7.18-1~20.04|2.7.18-1~20.04.1|2.7.18-1~20.04.1+esm1|2.7.18-1~20.04.3
    fixed_versions: vers:deb/2.7.18-1~20.04.3+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python2.7?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/2.7.18-8build1|2.7.18-13|2.7.18-13ubuntu1|2.7.18-13ubuntu1.1
    fixed_versions: vers:deb/2.7.18-13ubuntu1.1+esm2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-4189.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-4189.json
weaknesses: []
references:
  - url: https://bugs.python.org/issue43285
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2036020
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/0ab152c6b5d95caa2dc1a30fa96e10258b5f188e
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/4134f154ae2f621f25c5d698cc0f1748035a1b88
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/79373951b3eab585d42e0f0ab83718cbe1d0ee33
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/7dcb4baa4f0fde3aef5122a8e9f6a41853ec9335
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-4189
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5342-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5342-2
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6891-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-4189
    reference_type:
    reference_id:
