advisory_id: UBUNTU-CVE-2023-35934
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-35934
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35934.json
aliases:
  - CVE-2023-35934
summary: 'yt-dlp is a command-line program to download videos from video sites. During file
  downloads, yt-dlp or the external downloaders that yt-dlp employs may leak cookies on HTTP
  redirects to a different host, or leak them when the host for download fragments differs from
  their parent manifest''s host. This vulnerable behavior is present in yt-dlp prior to 2023.07.06
  and nightly 2023.07.06.185519. All native and external downloaders are affected, except for
  `curl` and `httpie` (version 3.1.0 or later). At the file download stage, all cookies are
  passed by yt-dlp to the file downloader as a `Cookie` header, thereby losing their scope.
  This also occurs in yt-dlp''s info JSON output, which may be used by external tools. As a
  result, the downloader or external tool may indiscriminately send cookies with requests to
  domains or paths for which the cookies are not scoped. yt-dlp version 2023.07.06 and nightly
  2023.07.06.185519 fix this issue by removing the `Cookie` header upon HTTP redirects; having
  native downloaders calculate the `Cookie` header from the cookiejar, utilizing external downloaders''
  built-in support for cookies instead of passing them as header arguments, disabling HTTP redirectiong
  if the external downloader does not have proper cookie support, processing cookies passed
  as HTTP headers to limit their scope, and having a separate field for cookies in the info
  dict storing more information about scoping Some workarounds are available for those who are
  unable to upgrade. Avoid using cookies and user authentication methods. While extractors may
  set custom cookies, these usually do not contain sensitive information. Alternatively, avoid
  using `--load-info-json`. Or, if authentication is a must: verify the integrity of download
  links from unknown sources in browser (including redirects) before passing them to yt-dlp;
  use `curl` as external downloader, since it is not impacted; and/or avoid fragmented formats
  such as HLS/m3u8, DASH/mpd and ISM.'
impacted_packages:
  - purl: pkg:deb/ubuntu/yt-dlp?arch=source&distro=jammy
    affected_versions: vers:deb/2021.12.01-1|2021.12.27-1|2022.01.21-1|2022.02.04-1|2022.03.08.1-1|2022.04.08-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/yt-dlp?arch=source&distro=noble
    affected_versions: vers:deb/2023.07.06-1|2023.10.13-1ubuntu1|2023.11.16-1|2023.12.30-1ubuntu1|2024.03.10-1|2024.04.09-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/yt-dlp?arch=source&distro=questing
    affected_versions: vers:deb/2025.03.27-1|2025.04.30-1|2025.05.22-1|2025.06.09-1|2025.06.25-1|2025.06.30-1|2025.07.21-1|2025.08.11-1|2025.08.20-1|2025.08.22-1|2025.08.27-1|2025.09.05-1|2025.09.23-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35934.json
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35934.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35934.json
weaknesses: []
references:
  - url: https://github.com/yt-dlp/yt-dlp/commit/1ceb657bdd254ad961489e5060f2ccc7d556b729
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/commit/3121512228487c9c690d3d39bfd2579addf96e07
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/commit/f8b4bcc0a791274223723488bfbfc23ea3276641
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp-nightly-builds/releases/tag/2023.07.06.185519
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/releases/tag/2023.07.06
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-v8mc-9377-rwjj
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-35934
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-35934
    reference_type:
    reference_id:
