advisory_id: UBUNTU-CVE-2024-7348
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-7348
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-7348.json
aliases:
  - CVE-2024-7348
summary: Time-of-check Time-of-use (TOCTOU) race condition in pg_dump in PostgreSQL allows an
  object creator to execute arbitrary SQL functions as the user running pg_dump, which is often
  a superuser. The attack involves replacing another relation type with a view or foreign table.
  The attack requires waiting for pg_dump to start, but winning the race condition is trivial
  if the attacker retains an open transaction. Versions before PostgreSQL 16.4, 15.8, 14.13,
  13.16, and 12.20 are affected.
impacted_packages:
  - purl: pkg:deb/ubuntu/postgresql-9.3?arch=source&distro=trusty/esm
    affected_versions: vers:deb/9.3.1-1|9.3.2-1|9.3.2-1ubuntu1|9.3.2-1ubuntu2|9.3.3-1|9.3.3-1bzr1|9.3.3-1bzr2|9.3.4-1|9.3.5-0ubuntu0.14.04.1|9.3.6-0ubuntu0.14.04|9.3.7-0ubuntu0.14.04|9.3.8-0ubuntu0.4.04|9.3.9-0ubuntu0.14.04|9.3.10-0ubuntu0.14.04|9.3.11-0ubuntu0.14.04|9.3.12-0ubuntu0.14.04|9.3.13-0ubuntu0.14.04|9.3.14-0ubuntu0.14.04|9.3.15-0ubuntu0.14.04|9.3.16-0ubuntu0.14.04|9.3.17-0ubuntu0.14.04|9.3.18-0ubuntu0.14.04.1|9.3.19-0ubuntu0.14.04|9.3.20-0ubuntu0.14.04|9.3.21-0ubuntu0.14.04|9.3.22-0ubuntu0.14.04|9.3.23-0ubuntu0.14.04|9.3.24-0ubuntu0.14.04
    fixed_versions: vers:deb/9.3.24-0ubuntu0.14.04+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/postgresql-9.5?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/9.5.0-1|9.5.0-2|9.5.0-3|9.5.1-1|9.5.2-1|9.5.3-0ubuntu0.16.04|9.5.4-0ubuntu0.16.04|9.5.5-0ubuntu0.16.04|9.5.6-0ubuntu0.16.04|9.5.7-0ubuntu0.16.04|9.5.8-0ubuntu0.16.04.1|9.5.9-0ubuntu0.16.04|9.5.10-0ubuntu0.16.04|9.5.11-0ubuntu0.16.04|9.5.12-0ubuntu0.16.04|9.5.13-0ubuntu0.16.04|9.5.14-0ubuntu0.16.04|9.5.16-0ubuntu0.16.04.1|9.5.17-0ubuntu0.16.04.1|9.5.18-0ubuntu0.16.04.1|9.5.19-0ubuntu0.16.04.1|9.5.21-0ubuntu0.16.04.1|9.5.23-0ubuntu0.16.04.1|9.5.24-0ubuntu0.16.04.1|9.5.25-0ubuntu0.16.04.1|9.5.25-0ubuntu0.16.04.1+esm1|9.5.25-0ubuntu0.16.04.1+esm2|9.5.25-0ubuntu0.16.04.1+esm3|9.5.25-0ubuntu0.16.04.1+esm4|9.5.25-0ubuntu0.16.04.1+esm5|9.5.25-0ubuntu0.16.04.1+esm6|9.5.25-0ubuntu0.16.04.1+esm7
    fixed_versions: vers:deb/9.5.25-0ubuntu0.16.04.1+esm8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/postgresql-10?arch=source&distro=esm-infra/bionic
    affected_versions: vers:deb/10.1-1|10.1-2|10.2-1|10.3-1|10.4-0ubuntu0.18.04|10.5-0ubuntu0.18.04|10.6-0ubuntu0.18.04.1|10.7-0ubuntu0.18.04.1|10.8-0ubuntu0.18.04.1|10.9-0ubuntu0.18.04.1|10.10-0ubuntu0.18.04.1|10.12-0ubuntu0.18.04.1|10.14-0ubuntu0.18.04.1|10.15-0ubuntu0.18.04.1|10.16-0ubuntu0.18.04.1|10.17-0ubuntu0.18.04.1|10.18-0ubuntu0.18.04.1|10.19-0ubuntu0.18.04.1|10.20-0ubuntu0.18.04.1|10.21-0ubuntu0.18.04.1|10.22-0ubuntu0.18.04.1|10.23-0ubuntu0.18.04.1|10.23-0ubuntu0.18.04.2|10.23-0ubuntu0.18.04.2+esm1
    fixed_versions: vers:deb/10.23-0ubuntu0.18.04.2+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/postgresql-12?arch=source&distro=focal
    affected_versions: vers:deb/12.0-1|12.1-1|12.1-2build1|12.2-1|12.2-1ubuntu2|12.2-4|12.4-0ubuntu0.20.04.1|12.5-0ubuntu0.20.04.1|12.6-0ubuntu0.20.04.1|12.7-0ubuntu0.20.04.1|12.8-0ubuntu0.20.04.1|12.9-0ubuntu0.20.04.1|12.10-0ubuntu0.20.04.1|12.11-0ubuntu0.20.04.1|12.12-0ubuntu0.20.04.1|12.13-0ubuntu0.20.04.1|12.14-0ubuntu0.20.04.1|12.15-0ubuntu0.20.04.1|12.16-0ubuntu0.20.04.1|12.17-0ubuntu0.20.04.1|12.18-0ubuntu0.20.04.1|12.19-0ubuntu0.20.04.1
    fixed_versions: vers:deb/12.20-0ubuntu0.20.04.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/postgresql-14?arch=source&distro=jammy
    affected_versions: vers:deb/14.1-1ubuntu1|14.2-1|14.2-1ubuntu1|14.3-0ubuntu0.22.04.1|14.4-0ubuntu0.22.04.1|14.5-0ubuntu0.22.04.1|14.6-0ubuntu0.22.04.1|14.7-0ubuntu0.22.04.1|14.8-0ubuntu0.22.04.1|14.9-0ubuntu0.22.04.1|14.10-0ubuntu0.22.04.1|14.11-0ubuntu0.22.04.1|14.12-0ubuntu0.22.04.1
    fixed_versions: vers:deb/14.13-0ubuntu0.22.04.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/postgresql-16?arch=source&distro=noble
    affected_versions: vers:deb/16.0-2|16.1-1|16.1-1build1|16.1-1build3|16.2-1|16.2-1ubuntu2|16.2-1ubuntu3|16.2-1ubuntu4|16.3-0ubuntu0.24.04.1
    fixed_versions: vers:deb/16.4-0ubuntu0.24.04.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-7348.json
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-7348.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-7348.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2024-7348
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6968-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6968-2
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6968-3
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-7348
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/about/news/postgresql-164-158-1413-1316-1220-and-17-beta-3-released-2910/
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/support/security/CVE-2024-7348/
    reference_type:
    reference_id:
