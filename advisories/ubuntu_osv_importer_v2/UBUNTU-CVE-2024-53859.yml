advisory_id: UBUNTU-CVE-2024-53859
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-53859
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-53859.json
aliases:
  - CVE-2024-53859
summary: 'go-gh is a Go module for interacting with the `gh` utility and the GitHub API from
  the command line. A security vulnerability has been identified in `go-gh` that could leak
  authentication tokens intended for GitHub hosts to non-GitHub hosts when within a codespace.
  `go-gh` sources authentication tokens from different environment variables depending on the
  host involved: 1. `GITHUB_TOKEN`, `GH_TOKEN` for GitHub.com and ghe.com and 2. `GITHUB_ENTERPRISE_TOKEN`,
  `GH_ENTERPRISE_TOKEN` for GitHub Enterprise Server. Prior to version `2.11.1`, `auth.TokenForHost`
  could source a token from the `GITHUB_TOKEN` environment variable for a host other than GitHub.com
  or ghe.com when within a codespace. In version `2.11.1`, `auth.TokenForHost` will only source
  a token from the `GITHUB_TOKEN` environment variable for GitHub.com or ghe.com hosts. Successful
  exploitation could send authentication token to an unintended host. This issue has been addressed
  in version 2.11.1 and all users are advised to upgrade. Users are also advised to regenerate
  authentication tokens and to review their personal security log and any relevant audit logs
  for actions associated with their account or enterprise.'
impacted_packages:
  - purl: pkg:deb/ubuntu/golang-github-cli-go-gh-v2?arch=source&distro=esm-apps/noble
    affected_versions: vers:deb/2.0.0-2|2.3.0-1|2.4.0+git20231120.d32c104-1|2.5.0-1|2.6.0-1
    fixed_versions: vers:deb/2.6.0-1ubuntu0.24.04.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-cli-go-gh-v2?arch=source&distro=questing
    affected_versions: vers:deb/2.6.0-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-53859.json
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-53859.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-53859.json
weaknesses: []
references:
  - url: https://docs.github.com/en/apps/using-github-apps/reviewing-and-revoking-authorization-of-github-apps#reviewing-your-authorized-github-apps
    reference_type:
    reference_id:
  - url: https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-security-log
    reference_type:
    reference_id:
  - url: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/identifying-audit-log-events-performed-by-an-access-token
    reference_type:
    reference_id:
  - url: https://docs.github.com/en/enterprise-cloud@latest/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens
    reference_type:
    reference_id:
  - url: https://github.com/cli/go-gh/blob/71770357e0cb12867d3e3e288854c0aa09d440b7/pkg/auth/auth.go#L73-L77
    reference_type:
    reference_id:
  - url: https://github.com/cli/go-gh/security/advisories/GHSA-55v3-xh23-96gh
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-53859
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7362-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-53859
    reference_type:
    reference_id:
