advisory_id: UBUNTU-CVE-2021-41174
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-41174
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-41174.json
aliases:
  - CVE-2021-41174
summary: 'Grafana is an open-source platform for monitoring and observability. In affected versions
  if an attacker is able to convince a victim to visit a URL referencing a vulnerable page,
  arbitrary JavaScript content may be executed within the context of the victim''s browser.
  The user visiting the malicious link must be unauthenticated and the link must be for a page
  that contains the login button in the menu bar. The url has to be crafted to exploit AngularJS
  rendering and contain the interpolation binding for AngularJS expressions. AngularJS uses
  double curly braces for interpolation binding: {{ }} ex: {{constructor.constructor(‘alert(1)’)()}}.
  When the user follows the link and the page renders, the login button will contain the original
  link with a query parameter to force a redirect to the login page. The URL is not validated
  and the AngularJS rendering engine will execute the JavaScript expression contained in the
  URL. Users are advised to upgrade as soon as possible. If for some reason you cannot upgrade,
  you can use a reverse proxy or similar to block access to block the literal string {{ in the
  path.'
impacted_packages:
  - purl: pkg:deb/ubuntu/grafana?arch=source&distro=xenial
    affected_versions: vers:deb/2.6.0+dfsg-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-41174.json
  - score: '6.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-41174.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-41174.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2021-41174
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-41174
    reference_type:
    reference_id:
