advisory_id: UBUNTU-CVE-2024-31460
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-31460
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31460.json
aliases:
  - CVE-2024-31460
summary: Cacti provides an operational monitoring and fault management framework. Prior to version
  1.2.27, some of the data stored in `automation_tree_rules.php` is not thoroughly checked and
  is used to concatenate the SQL statement in `create_all_header_nodes()`  function from `lib/api_automation.php`
  , finally resulting in SQL injection. Using SQL based secondary injection technology, attackers
  can modify the contents of the Cacti database, and based on the modified content, it may be
  possible to achieve further impact, such as arbitrary file reading, and even remote code execution
  through arbitrary file writing. Version 1.2.27 contains a patch for the issue.
impacted_packages:
  - purl: pkg:deb/ubuntu/cacti?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.1.18+ds1-1|1.1.27+ds1-2|1.1.27+ds1-3|1.1.28+ds1-2|1.1.35+ds1-1|1.1.36+ds1-1|1.1.38+ds1-1|1.1.38+ds1-1ubuntu0.1~esm1
    fixed_versions: vers:deb/1.1.38+ds1-1ubuntu0.1~esm3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/cacti?arch=source&distro=focal
    affected_versions: vers:deb/1.2.4+ds1-2ubuntu3|1.2.9+ds1-1ubuntu1|1.2.9+ds1-1ubuntu2|1.2.10+ds1-1ubuntu1
    fixed_versions: vers:deb/1.2.10+ds1-1ubuntu1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/cacti?arch=source&distro=jammy
    affected_versions: vers:deb/1.2.16+ds1-2ubuntu1|1.2.19+ds1-2ubuntu1
    fixed_versions: vers:deb/1.2.19+ds1-2ubuntu1.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/cacti?arch=source&distro=noble
    affected_versions: vers:deb/1.2.25+ds1-2|1.2.26+ds1-1
    fixed_versions: vers:deb/1.2.26+ds1-1ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31460.json
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31460.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31460.json
weaknesses: []
references:
  - url: https://github.com/Cacti/cacti/security/advisories/GHSA-cx8g-hvq8-p2rv
    reference_type:
    reference_id:
  - url: https://github.com/Cacti/cacti/security/advisories/GHSA-gj3f-p326-gh8r
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-31460
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6969-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-31460
    reference_type:
    reference_id:
