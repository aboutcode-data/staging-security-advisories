advisory_id: UBUNTU-CVE-2024-8508
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-8508
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-8508.json
aliases:
  - CVE-2024-8508
summary: NLnet Labs Unbound up to and including version 1.21.0 contains a vulnerability when
  handling replies with very large RRsets that it needs to perform name compression for. Malicious
  upstreams responses with very large RRsets can cause Unbound to spend a considerable time
  applying name compression to downstream replies. This can lead to degraded performance and
  eventually denial of service in well orchestrated attacks. The vulnerability can be exploited
  by a malicious actor querying Unbound for the specially crafted contents of a malicious zone
  with very large RRsets. Before Unbound replies to the query it will try to apply name compression
  which was an unbounded operation that could lock the CPU until the whole packet was complete.
  Unbound version 1.21.1 introduces a hard limit on the number of name compression calculations
  it is willing to do per packet. Packets that need more compression will result in semi-compressed
  packets or truncated packets, even on TCP for huge messages, to avoid locking the CPU for
  long. This change should not affect normal DNS traffic.
impacted_packages:
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/1.4.22-1ubuntu6|1.5.7-1ubuntu1|1.5.7-1ubuntu2|1.5.8-1ubuntu1|1.5.8-1ubuntu1.1|1.5.8-1ubuntu1.1+esm1
    fixed_versions: vers:deb/1.5.8-1ubuntu1.1+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=esm-infra/bionic
    affected_versions: vers:deb/1.6.5-1|1.6.7-1|1.6.7-1build1|1.6.7-1ubuntu1|1.6.7-1ubuntu2|1.6.7-1ubuntu2.1|1.6.7-1ubuntu2.2|1.6.7-1ubuntu2.3|1.6.7-1ubuntu2.4|1.6.7-1ubuntu2.5|1.6.7-1ubuntu2.6|1.6.7-1ubuntu2.6+esm2
    fixed_versions: vers:deb/1.6.7-1ubuntu2.6+esm3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=focal
    affected_versions: vers:deb/1.9.0-2ubuntu1|1.9.0-2ubuntu2|1.9.4-2|1.9.4-2ubuntu1|1.9.4-2ubuntu1.1|1.9.4-2ubuntu1.2|1.9.4-2ubuntu1.3|1.9.4-2ubuntu1.4|1.9.4-2ubuntu1.5|1.9.4-2ubuntu1.6|1.9.4-2ubuntu1.8
    fixed_versions: vers:deb/1.9.4-2ubuntu1.9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=jammy
    affected_versions: vers:deb/1.13.1-1ubuntu1|1.13.1-1ubuntu3|1.13.1-1ubuntu5|1.13.1-1ubuntu5.1|1.13.1-1ubuntu5.2|1.13.1-1ubuntu5.3|1.13.1-1ubuntu5.4|1.13.1-1ubuntu5.5|1.13.1-1ubuntu5.7
    fixed_versions: vers:deb/1.13.1-1ubuntu5.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=noble
    affected_versions: vers:deb/1.17.1-2|1.18.0-2ubuntu1|1.18.0-2ubuntu2|1.19.1-1ubuntu1|1.19.2-1ubuntu1|1.19.2-1ubuntu3|1.19.2-1ubuntu3.1|1.19.2-1ubuntu3.2
    fixed_versions: vers:deb/1.19.2-1ubuntu3.3
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/unbound?arch=source&distro=trusty/esm
    affected_versions: vers:deb/1.4.20-1|1.4.21-1|1.4.21-1ubuntu1|1.4.21-1ubuntu2|1.4.22-1ubuntu1|1.4.22-1ubuntu2|1.4.22-1ubuntu3|1.4.22-1ubuntu4|1.4.22-1ubuntu4.14.04.1|1.4.22-1ubuntu4.14.04.2|1.4.22-1ubuntu4.14.04.3|1.4.22-1ubuntu4.14.04.3+esm1
    fixed_versions: vers:deb/1.4.22-1ubuntu4.14.04.3+esm2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-8508.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-8508.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2024-8508
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7080-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-8508
    reference_type:
    reference_id:
  - url: https://www.nlnetlabs.nl/downloads/unbound/CVE-2024-8508.txt
    reference_type:
    reference_id:
