advisory_id: UBUNTU-CVE-2021-37712
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-37712
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-37712.json
aliases:
  - CVE-2021-37712
summary: The npm package "tar" (aka node-tar) before versions 4.4.18, 5.0.10, and 6.1.9 has
  an arbitrary file creation/overwrite and arbitrary code execution vulnerability. node-tar
  aims to guarantee that any file whose location would be modified by a symbolic link is not
  extracted. This is, in part, achieved by ensuring that extracted directories are not symlinks.
  Additionally, in order to prevent unnecessary stat calls to determine whether a given path
  is a directory, paths are cached when directories are created. This logic was insufficient
  when extracting tar files that contained both a directory and a symlink with names containing
  unicode values that normalized to the same value. Additionally, on Windows systems, long path
  portions would resolve to the same file system entities as their 8.3 "short path" counterparts.
  A specially crafted tar archive could thus include a directory with one form of the path,
  followed by a symbolic link with a different string that resolves to the same file system
  entity, followed by a file using the first form. By first creating a directory, and then replacing
  that directory with a symlink that had a different apparent name that resolved to the same
  entry in the filesystem, it was thus possible to bypass node-tar symlink checks on directories,
  essentially allowing an untrusted tar file to symlink into an arbitrary location and subsequently
  extracting arbitrary files into that location, thus allowing arbitrary file creation and overwrite.
  These issues were addressed in releases 4.4.18, 5.0.10 and 6.1.9. The v3 branch of node-tar
  has been deprecated and did not receive patches for these issues. If you are still using a
  v3 release we recommend you update to a more recent version of node-tar. If this is not possible,
  a workaround is available in the referenced GHSA-qq89-hq3f-393p.
impacted_packages:
  - purl: pkg:deb/ubuntu/node-tar?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/0.1.18-1|0.1.18-1ubuntu0.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-tar?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.0.3-2|1.0.3-2ubuntu0.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-tar?arch=source&distro=bionic
    affected_versions: vers:deb/2.2.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-tar?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/4.4.10+ds1-2|4.4.10+ds1-2ubuntu1|4.4.10+ds1-2ubuntu1+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-tar?arch=source&distro=jammy
    affected_versions: vers:deb/6.1.7+~cs11.3.10-1|6.1.11+~cs11.3.10-1|6.1.11+ds1+~cs6.0.6-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-tar?arch=source&distro=noble
    affected_versions: vers:deb/6.1.13+~cs7.0.5-1|6.1.13+~cs7.0.5-3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/node-tar?arch=source&distro=questing
    affected_versions: vers:deb/6.2.1+~cs7.0.8-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-37712.json
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-37712.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-37712.json
weaknesses: []
references:
  - url: https://github.com/npm/node-tar/security/advisories/GHSA-qq89-hq3f-393p
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-37712
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-37712
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/tar
    reference_type:
    reference_id:
