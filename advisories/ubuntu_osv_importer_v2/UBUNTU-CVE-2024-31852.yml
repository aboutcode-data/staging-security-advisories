advisory_id: UBUNTU-CVE-2024-31852
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-31852
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31852.json
aliases:
  - CVE-2024-31852
summary: 'LLVM before 18.1.3 generates code in which the LR register can be overwritten without
  data being saved to the stack, and thus there can sometimes be an exploitable error in the
  flow of control. This affects the ARM backend and can be demonstrated with Clang. NOTE: the
  vendor perspective is "we don''t have strong objections for a CVE to be created ... It does
  seem that the likelihood of this miscompile enabling an exploit remains very low, because
  the miscompile resulting in this JOP gadget is such that the function is most likely to crash
  on most valid inputs to the function. So, if this function is covered by any testing, the
  miscompile is most likely to be discovered before the binary is shipped to production."'
impacted_packages:
  - purl: pkg:deb/ubuntu/llvm-toolchain-3.7?arch=source&distro=xenial
    affected_versions: vers:deb/1:3.7-2ubuntu1|1:3.7-2ubuntu2|1:3.7-4ubuntu1|1:3.7.1-1ubuntu1|1:3.7.1-1ubuntu2|1:3.7.1-1ubuntu3|1:3.7.1-1ubuntu4|1:3.7.1-2ubuntu1|1:3.7.1-2ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-3.9?arch=source&distro=xenial
    affected_versions: vers:deb/1:3.9.1-4ubuntu3~16.04.1|1:3.9.1-4ubuntu3~16.04.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-8?arch=source&distro=xenial
    affected_versions: vers:deb/1:8-3~ubuntu16.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-10?arch=source&distro=bionic
    affected_versions: vers:deb/1:10.0.0-4ubuntu1~18.04.1|1:10.0.0-4ubuntu1~18.04.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-3.9?arch=source&distro=bionic
    affected_versions: vers:deb/1:3.9.1-17ubuntu1|1:3.9.1-18ubuntu1|1:3.9.1-19ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-6.0?arch=source&distro=bionic
    affected_versions: vers:deb/1:6.0~+rc1-1|1:6.0~+rc2-1|1:6.0-1ubuntu1|1:6.0-1ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-7?arch=source&distro=bionic
    affected_versions: vers:deb/1:7-3~ubuntu0.18.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-8?arch=source&distro=bionic
    affected_versions: vers:deb/1:8-3~ubuntu18.04.1|1:8-3~ubuntu18.04.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-9?arch=source&distro=bionic
    affected_versions: vers:deb/1:9-2~ubuntu18.04.1|1:9-2~ubuntu18.04.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-3.7?arch=source&distro=bionic
    affected_versions: vers:deb/1:3.7.1-5ubuntu3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-4.0?arch=source&distro=bionic
    affected_versions: vers:deb/1:4.0.1-6|1:4.0.1-8|1:4.0.1-10
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-5.0?arch=source&distro=bionic
    affected_versions: vers:deb/1:5.0-3|1:5.0-4|1:5.0.1-1|1:5.0.1-2|1:5.0.1-4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-6.0?arch=source&distro=xenial
    affected_versions: vers:deb/1:6.0-1ubuntu2~16.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-3.5?arch=source&distro=xenial
    affected_versions: vers:deb/1:3.5.2-2|1:3.5.2-3|1:3.5.2-3build1|1:3.5.2-3build2|1:3.5.2-3ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-3.6?arch=source&distro=trusty
    affected_versions: vers:deb/1:3.6-2ubuntu1~trusty1|1:3.6-2ubuntu1~trusty2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-3.8?arch=source&distro=trusty
    affected_versions: vers:deb/1:3.8-2ubuntu3~trusty4|1:3.8-2ubuntu3~trusty5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-3.9?arch=source&distro=trusty
    affected_versions: vers:deb/1:3.9.1-4ubuntu3~14.04.2|1:3.9.1-4ubuntu3~14.04.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-3.6?arch=source&distro=xenial
    affected_versions: vers:deb/1:3.6.2-1|1:3.6.2-3|1:3.6.2-3build1|1:3.6.2-3ubuntu1|1:3.6.2-3ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-3.8?arch=source&distro=xenial
    affected_versions: vers:deb/1:3.8~+rc1-1~exp1ubuntu3|1:3.8~+rc2-1~exp1ubuntu2|1:3.8-2ubuntu1|1:3.8-2ubuntu3|1:3.8-2ubuntu4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-4.0?arch=source&distro=xenial
    affected_versions: vers:deb/1:4.0-1ubuntu1~16.04.1|1:4.0-1ubuntu1~16.04.2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-5.0?arch=source&distro=xenial
    affected_versions: vers:deb/1:5.0-3~16.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-10?arch=source&distro=focal
    affected_versions: vers:deb/1:10~++20200121023453+de4b2a7fad6-1~exp1|1:10.0.0~+rc1-1~exp1|1:10.0.0~+rc2-2~build2|1:10.0.0~+rc2-2|1:10.0.0~+rc3-1|1:10.0.0~+rc3-1build1|1:10.0.0~+rc4-1|1:10.0.0~+rc5-1ubuntu1|1:10.0.0-1ubuntu1|1:10.0.0-1ubuntu2|1:10.0.0-2ubuntu1|1:10.0.0-2ubuntu2|1:10.0.0-3|1:10.0.0-4ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-11?arch=source&distro=focal
    affected_versions: vers:deb/1:11.0.0-2~ubuntu20.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-12?arch=source&distro=focal
    affected_versions: vers:deb/1:12.0.0-3ubuntu1~20.04.3|1:12.0.0-3ubuntu1~20.04.4|1:12.0.0-3ubuntu1~20.04.5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-9?arch=source&distro=focal
    affected_versions: vers:deb/1:9-2|1:9.0.0-3ubuntu2|1:9.0.0-4ubuntu4|1:9.0.1~+rc2-1~exp1|1:9.0.1~+rc2-1~exp1ubuntu1|1:9.0.1-1|1:9.0.1-2|1:9.0.1-6build1|1:9.0.1-8build1|1:9.0.1-8ubuntu1|1:9.0.1-9ubuntu1|1:9.0.1-10|1:9.0.1-11|1:9.0.1-11ubuntu1|1:9.0.1-12
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-6.0?arch=source&distro=focal
    affected_versions: vers:deb/1:6.0.1-11|1:6.0.1-11ubuntu1|1:6.0.1-12|1:6.0.1-14
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-7?arch=source&distro=focal
    affected_versions: vers:deb/1:7.0.1-9build1|1:7.0.1-9ubuntu2|1:7.0.1-10|1:7.0.1-10build1|1:7.0.1-12
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-8?arch=source&distro=focal
    affected_versions: vers:deb/1:8.0.1-3build1|1:8.0.1-4|1:8.0.1-4ubuntu3|1:8.0.1-7build1|1:8.0.1-7ubuntu1|1:8.0.1-8ubuntu1|1:8.0.1-9
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-11?arch=source&distro=jammy
    affected_versions: vers:deb/1:11.0.1-2ubuntu5|1:11.1.0-6
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/llvm-toolchain-12?arch=source&distro=jammy
    affected_versions: vers:deb/1:12.0.1-8build1|1:12.0.1-16|1:12.0.1-19ubuntu3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31852.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31852.json
weaknesses: []
references:
  - url: https://github.com/llvmbot/llvm-project/commit/0e16af8e4cf3a66ad5d078d52744ae2776f9c4b2
    reference_type:
    reference_id:
  - url: https://github.com/llvm/llvm-project/issues/80287
    reference_type:
    reference_id:
  - url: https://llvm.org/docs/Security.html
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-31852
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-31852
    reference_type:
    reference_id:
