advisory_id: UBUNTU-CVE-2024-29018
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-29018
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-29018.json
aliases:
  - CVE-2024-29018
summary: 'Moby is an open source container framework that is a key component of Docker Engine,
  Docker Desktop, and other distributions of container tooling or runtimes. Moby''s networking
  implementation allows for many networks, each with their own IP address range and gateway,
  to be defined. This feature is frequently referred to as custom networks, as each network
  can have a different driver, set of parameters and thus behaviors. When creating a network,
  the `--internal` flag is used to designate a network as _internal_. The `internal` attribute
  in a docker-compose.yml file may also be used to mark a network _internal_, and other API
  clients may specify the `internal` parameter as well. When containers with networking are
  created, they are assigned unique network interfaces and IP addresses. The host serves as
  a router for non-internal networks, with a gateway IP that provides SNAT/DNAT to/from container
  IPs. Containers on an internal network may communicate between each other, but are precluded
  from communicating with any networks the host has access to (LAN or WAN) as no default route
  is configured, and firewall rules are set up to drop all outgoing traffic. Communication with
  the gateway IP address (and thus appropriately configured host services) is possible, and
  the host may communicate with any container IP directly. In addition to configuring the Linux
  kernel''s various networking features to enable container networking, `dockerd` directly provides
  some services to container networks. Principal among these is serving as a resolver, enabling
  service discovery, and resolution of names from an upstream resolver. When a DNS request for
  a name that does not correspond to a container is received, the request is forwarded to the
  configured upstream resolver. This request is made from the container''s network namespace:
  the level of access and routing of traffic is the same as if the request was made by the container
  itself. As a consequence of this design, containers solely attached to an internal network
  will be unable to resolve names using the upstream resolver, as the container itself is unable
  to communicate with that nameserver. Only the names of containers also attached to the internal
  network are able to be resolved. Many systems run a local forwarding DNS resolver. As the
  host and any containers have separate loopback devices, a consequence of the design described
  above is that containers are unable to resolve names from the host''s configured resolver,
  as they cannot reach these addresses on the host loopback device. To bridge this gap, and
  to allow containers to properly resolve names even when a local forwarding resolver is used
  on a loopback address, `dockerd` detects this scenario and instead forward DNS requests from
  the host namework namespace. The loopback resolver then forwards the requests to its configured
  upstream resolvers, as expected. Because `dockerd` forwards DNS requests to the host loopback
  device, bypassing the container network namespace''s normal routing semantics entirely, internal
  networks can unexpectedly forward DNS requests to an external nameserver. By registering a
  domain for which they control the authoritative nameservers, an attacker could arrange for
  a compromised container to exfiltrate data by encoding it in DNS queries that will eventually
  be answered by their nameservers. Docker Desktop is not affected, as Docker Desktop always
  runs an internal resolver on a RFC 1918 address. Moby releases 26.0.0, 25.0.4, and 23.0.11
  are patched to prevent forwarding any DNS requests from internal networks. As a workaround,
  run containers intended to be solely attached to internal networks with a custom upstream
  address, which will force all upstream DNS queries to be resolved from the container''s network
  namespace.'
impacted_packages:
  - purl: pkg:deb/ubuntu/docker.io?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/1.6.2~dfsg1-1ubuntu4|1.10.2-0ubuntu3|1.10.2-0ubuntu4|1.10.3-0ubuntu1|1.10.3-0ubuntu4|1.10.3-0ubuntu5|1.10.3-0ubuntu6|1.11.2-0ubuntu5~16.04|1.12.1-0ubuntu13~16.04.1|1.12.3-0ubuntu4~16.04.2|1.12.6-0ubuntu1~16.04.1|1.13.1-0ubuntu1~16.04.2|17.03.2-0ubuntu2~16.04.1|18.06.1-0ubuntu1~16.04.2|18.06.1-0ubuntu1.2~16.04.1|18.09.2-0ubuntu1~16.04.1|18.09.5-0ubuntu1~16.04.2|18.09.7-0ubuntu1~16.04.1|18.09.7-0ubuntu1~16.04.4|18.09.7-0ubuntu1~16.04.5|18.09.7-0ubuntu1~16.04.6|18.09.7-0ubuntu1~16.04.7|18.09.7-0ubuntu1~16.04.9+esm1
    fixed_versions: vers:deb/18.09.7-0ubuntu1~16.04.9+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.13.1-0ubuntu6|17.03.2-0ubuntu1|17.03.2-0ubuntu3|17.03.2-0ubuntu5|17.12.1-0ubuntu1|18.06.1-0ubuntu1~18.04.1|18.06.1-0ubuntu1.2~18.04.1|18.09.2-0ubuntu1~18.04.1|18.09.5-0ubuntu1~18.04.2|18.09.7-0ubuntu1~18.04.1|18.09.7-0ubuntu1~18.04.3|18.09.7-0ubuntu1~18.04.4|19.03.6-0ubuntu1~18.04.1|19.03.6-0ubuntu1~18.04.2|19.03.6-0ubuntu1~18.04.3|20.10.2-0ubuntu1~18.04.2|20.10.2-0ubuntu1~18.04.3|20.10.7-0ubuntu1~18.04.1|20.10.7-0ubuntu1~18.04.2|20.10.7-0ubuntu5~18.04.2|20.10.7-0ubuntu5~18.04.3|20.10.12-0ubuntu2~18.04.1|20.10.21-0ubuntu1~18.04.2|20.10.21-0ubuntu1~18.04.3|20.10.21-0ubuntu1~18.04.3+esm1
    fixed_versions: vers:deb/20.10.21-0ubuntu1~18.04.3+esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/19.03.2-0ubuntu1|19.03.6-0ubuntu1|19.03.8-0ubuntu1|19.03.8-0ubuntu1.20.04|19.03.8-0ubuntu1.20.04.1|19.03.8-0ubuntu1.20.04.2|20.10.2-0ubuntu1~20.04.2|20.10.2-0ubuntu1~20.04.3|20.10.7-0ubuntu1~20.04.1|20.10.7-0ubuntu1~20.04.2|20.10.7-0ubuntu5~20.04.1|20.10.7-0ubuntu5~20.04.2|20.10.12-0ubuntu2~20.04.1|20.10.21-0ubuntu1~20.04.1|20.10.21-0ubuntu1~20.04.2|20.10.21-0ubuntu1~20.04.4|20.10.21-0ubuntu1~20.04.5|20.10.21-0ubuntu1~20.04.6|20.10.21-0ubuntu1~20.04.6+esm1|20.10.21-0ubuntu1~20.04.6+esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io-app?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/20.10.25-0ubuntu1~20.04.1|20.10.25-0ubuntu1~20.04.2|24.0.5-0ubuntu1~20.04.1|24.0.7-0ubuntu2~20.04.1|26.1.3-0ubuntu1~20.04.1
    fixed_versions: vers:deb/26.1.3-0ubuntu1~20.04.1+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io?arch=source&distro=jammy
    affected_versions: vers:deb/20.10.7-0ubuntu5|20.10.7-0ubuntu7|20.10.12-0ubuntu1|20.10.12-0ubuntu2|20.10.12-0ubuntu3|20.10.12-0ubuntu3+gke1.24.1|20.10.12-0ubuntu4|20.10.21-0ubuntu1~22.04.2|20.10.21-0ubuntu1~22.04.3|20.10.21-0ubuntu1~22.04.5|20.10.21-0ubuntu1~22.04.6|20.10.21-0ubuntu1~22.04.7|20.10.21-0ubuntu1~22.04.8
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io-app?arch=source&distro=jammy
    affected_versions: vers:deb/20.10.25-0ubuntu1~22.04.1|20.10.25-0ubuntu1~22.04.2|24.0.5-0ubuntu1~22.04.1|24.0.7-0ubuntu2~22.04.1|26.1.3-0ubuntu1~22.04.1|27.5.1-0ubuntu3~22.04.1
    fixed_versions: vers:deb/27.5.1-0ubuntu3~22.04.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io-app?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/20.10.25-0ubuntu1~22.04.1|20.10.25-0ubuntu1~22.04.2|24.0.5-0ubuntu1~22.04.1|24.0.7-0ubuntu2~22.04.1|26.1.3-0ubuntu1~22.04.1
    fixed_versions: vers:deb/26.1.3-0ubuntu1~22.04.1+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io?arch=source&distro=noble
    affected_versions: vers:deb/20.10.24+dfsg1-1ubuntu2|20.10.25+dfsg1-2ubuntu1|20.10.25+dfsg1-2ubuntu1.24.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io-app?arch=source&distro=noble
    affected_versions: vers:deb/24.0.5-0ubuntu1|24.0.7-0ubuntu1|24.0.7-0ubuntu2|24.0.7-0ubuntu3|24.0.7-0ubuntu4|24.0.7-0ubuntu4.1|26.1.3-0ubuntu1~24.04.1|27.5.1-0ubuntu3~24.04.1
    fixed_versions: vers:deb/27.5.1-0ubuntu3~24.04.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/docker.io-app?arch=source&distro=esm-apps/noble
    affected_versions: vers:deb/24.0.5-0ubuntu1|24.0.7-0ubuntu1|24.0.7-0ubuntu2|24.0.7-0ubuntu3|24.0.7-0ubuntu4|24.0.7-0ubuntu4.1|26.1.3-0ubuntu1~24.04.1
    fixed_versions: vers:deb/26.1.3-0ubuntu1~24.04.1+esm1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-29018.json
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-29018.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-29018.json
weaknesses: []
references:
  - url: https://github.com/moby/moby/pull/46609
    reference_type:
    reference_id:
  - url: https://github.com/moby/moby/security/advisories/GHSA-mq39-4gv4-mvpx
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-29018
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7161-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7161-2
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-29018
    reference_type:
    reference_id:
