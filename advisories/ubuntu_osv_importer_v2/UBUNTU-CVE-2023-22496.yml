advisory_id: UBUNTU-CVE-2023-22496
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-22496
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-22496.json
aliases: []
summary: 'Netdata is an open source option for real-time infrastructure monitoring and troubleshooting.
  An attacker with the ability to establish a streaming connection can execute arbitrary commands
  on the targeted Netdata agent. When an alert is triggered, the function `health_alarm_execute`
  is called. This function performs different checks and then enqueues a command by calling
  `spawn_enq_cmd`. This command is populated with several arguments that are not sanitized.
  One of them is the `registry_hostname` of the node for which the alert is raised. By providing
  a specially crafted `registry_hostname` as part of the health data that is streamed to a Netdata
  (parent) agent, an attacker can execute arbitrary commands at the remote host as a side-effect
  of the raised alert. Note that the commands are executed as the user running the Netdata Agent.
  This user is usually named `netdata`. The ability to run arbitrary commands may allow an attacker
  to escalate privileges by escalating other vulnerabilities in the system, as that user. The
  problem has been fixed in: Netdata agent v1.37 (stable) and Netdata agent v1.36.0-409 (nightly).
  As a workaround, streaming is not enabled by default. If you have previously enabled this,
  it can be disabled. Limiting access to the port on the recipient Agent to trusted child connections
  may mitigate the impact of this vulnerability.'
impacted_packages:
  - purl: pkg:deb/ubuntu/netdata?arch=source&distro=focal
    affected_versions: vers:deb/1.16.1-2|1.19.0-3ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/netdata?arch=source&distro=jammy
    affected_versions: vers:deb/1.29.3-4|1.31.0-4|1.33.1-1ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/netdata?arch=source&distro=oracular
    affected_versions: vers:deb/1.43.2-1build2|1.44.3-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/netdata?arch=source&distro=noble
    affected_versions: vers:deb/1.42.1-1|1.43.1-1|1.43.2-1|1.43.2-1build1|1.43.2-1build2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/netdata?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.7.0+dfsg-1|1.8.0+dfsg-1|1.9.0+dfsg-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-22496.json
weaknesses: []
references:
  - url: https://github.com/netdata/netdata/security/advisories/GHSA-xg38-3vmw-2978
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-22496
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-22496
    reference_type:
    reference_id:
