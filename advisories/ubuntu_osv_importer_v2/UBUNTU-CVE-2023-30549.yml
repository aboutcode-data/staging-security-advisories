advisory_id: UBUNTU-CVE-2023-30549
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-30549
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-30549.json
aliases:
  - CVE-2023-30549
summary: Apptainer is an open source container platform for Linux. There is an ext4 use-after-free
  flaw that is exploitable through versions of Apptainer < 1.1.0 and installations that include
  apptainer-suid < 1.1.8 on older operating systems where that CVE has not been patched. That
  includes Red Hat Enterprise Linux 7, Debian 10 buster (unless the linux-5.10 package is installed),
  Ubuntu 18.04 bionic and Ubuntu 20.04 focal. Use-after-free flaws in the kernel can be used
  to attack the kernel for denial of service and potentially for privilege escalation. Apptainer
  1.1.8 includes a patch that by default disables mounting of extfs filesystem types in setuid-root
  mode, while continuing to allow mounting of extfs filesystems in non-setuid "rootless" mode
  using fuse2fs. Some workarounds are possible. Either do not install apptainer-suid (for versions
  1.1.0 through 1.1.7) or set `allow setuid = no` in apptainer.conf.  This requires having unprivileged
  user namespaces enabled and except for apptainer 1.1.x versions will disallow mounting of
  sif files, extfs files, and squashfs files in addition to other, less significant impacts.
  (Encrypted sif files are also not supported unprivileged in apptainer 1.1.x.). Alternatively,
  use the `limit containers` options in apptainer.conf/singularity.conf to limit sif files to
  trusted users, groups, and/or paths, and set `allow container extfs = no` to disallow mounting
  of extfs overlay files.  The latter option by itself does not disallow mounting of extfs overlay
  partitions inside SIF files, so that's why the former options are also needed.
impacted_packages:
  - purl: pkg:deb/ubuntu/singularity-container?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/2.3.1-2|2.3.2-1|2.4.1-1|2.4.2-2|2.4.2-3|2.4.2-4|2.4.2-4ubuntu0.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/singularity-container?arch=source&distro=esm-apps/noble
    affected_versions: vers:deb/4.1.1+ds2-1|4.1.1+ds2-1build1|4.1.1+ds2-1ubuntu0.1|4.1.1+ds2-1ubuntu0.2|4.1.1+ds2-1ubuntu0.2+esm1|4.1.1+ds2-1ubuntu0.3|4.1.1+ds2-1ubuntu0.3+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/singularity-container?arch=source&distro=questing
    affected_versions: vers:deb/4.1.5+ds4-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-30549.json
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-30549.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-30549.json
weaknesses: []
references:
  - url: https://access.redhat.com/security/cve/cve-2022-1184
    reference_type:
    reference_id:
  - url: https://github.com/apptainer/apptainer/commit/5a4964f5ba9c8d89a0e353b97f51fd607670a9f7
    reference_type:
    reference_id:
  - url: https://github.com/apptainer/apptainer/releases/tag/v1.1.8
    reference_type:
    reference_id:
  - url: https://github.com/apptainer/apptainer/security/advisories/GHSA-j4rf-7357-f4cg
    reference_type:
    reference_id:
  - url: https://security-tracker.debian.org/tracker/CVE-2022-1184
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-1184
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-30549
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-30549
    reference_type:
    reference_id:
  - url: https://www.suse.com/security/cve/CVE-2022-1184.html
    reference_type:
    reference_id:
