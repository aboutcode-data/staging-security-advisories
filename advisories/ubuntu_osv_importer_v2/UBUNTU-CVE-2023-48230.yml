advisory_id: UBUNTU-CVE-2023-48230
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-48230
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-48230.json
aliases:
  - CVE-2023-48230
summary: Cap'n Proto is a data interchange format and capability-based RPC system. In versions
  1.0 and 1.0.1, when using the KJ HTTP library with WebSocket compression enabled, a buffer
  underrun can be caused by a remote peer. The underrun always writes a constant value that
  is not attacker-controlled, likely resulting in a crash, enabling a remote denial-of-service
  attack. Most Cap'n Proto and KJ users are unlikely to have this functionality enabled and
  so unlikely to be affected. Maintainers suspect only the Cloudflare Workers Runtime is affected.
  If KJ HTTP is used with WebSocket compression enabled, a malicious peer may be able to cause
  a buffer underrun on a heap-allocated buffer. KJ HTTP is an optional library bundled with
  Cap'n Proto, but is not directly used by Cap'n Proto. WebSocket compression is disabled by
  default. It must be enabled via a setting passed to the KJ HTTP library via `HttpClientSettings`
  or `HttpServerSettings`. The bytes written out-of-bounds are always a specific constant 4-byte
  string `{ 0x00, 0x00, 0xFF, 0xFF }`. Because this string is not controlled by the attacker,
  maintainers believe it is unlikely that remote code execution is possible. However, it cannot
  be ruled out. This functionality first appeared in Cap'n Proto 1.0. Previous versions are
  not affected. This issue is fixed in Cap'n Proto 1.0.1.1.
impacted_packages:
  - purl: pkg:deb/ubuntu/capnproto?arch=source&distro=noble
    affected_versions: vers:deb/0.9.2-3|1.0.1-2|1.0.1-3|1.0.1-4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-48230.json
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-48230.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-48230.json
weaknesses: []
references:
  - url: https://github.com/capnproto/capnproto/security/advisories/GHSA-r89h-f468-62w3
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-48230
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-48230
    reference_type:
    reference_id:
