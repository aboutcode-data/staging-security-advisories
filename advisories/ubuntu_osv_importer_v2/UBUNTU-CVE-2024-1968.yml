advisory_id: UBUNTU-CVE-2024-1968
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-1968
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-1968.json
aliases:
  - CVE-2024-1968
summary: In scrapy/scrapy, an issue was identified where the Authorization header is not removed
  during redirects that only change the scheme (e.g., HTTPS to HTTP) but remain within the same
  domain. This behavior contravenes the Fetch standard, which mandates the removal of Authorization
  headers in cross-origin requests when the scheme, host, or port changes. Consequently, when
  a redirect downgrades from HTTPS to HTTP, the Authorization header may be inadvertently exposed
  in plaintext, leading to potential sensitive information disclosure to unauthorized actors.
  The flaw is located in the _build_redirect_request function of the redirect middleware.
impacted_packages:
  - purl: pkg:deb/ubuntu/python-scrapy?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/2.4.1-2|2.5.1-2
    fixed_versions: vers:deb/2.5.1-2ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-scrapy?arch=source&distro=esm-apps/noble
    affected_versions: vers:deb/2.10.0-1|2.11.0-1|2.11.0-2|2.11.1-1
    fixed_versions: vers:deb/2.11.1-1ubuntu0.1~esm2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-scrapy?arch=source&distro=xenial
    affected_versions: vers:deb/1.0.0-1|1.0.3-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-scrapy?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.3.0-1~exp2|1.4.0-1|1.5.0-1
    fixed_versions: vers:deb/1.5.0-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-scrapy?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/1.7.3-1
    fixed_versions: vers:deb/1.7.3-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-1968.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-1968.json
weaknesses: []
references:
  - url: https://github.com/scrapy/scrapy/commit/1d0502f25bbe55a22899af915623fda1aaeb9dd8
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/27f6a021-a891-446a-ada5-0226d619dd1a
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-1968
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7476-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-1968
    reference_type:
    reference_id:
