advisory_id: UBUNTU-CVE-2019-5477
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2019-5477
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-5477.json
aliases:
  - CVE-2019-5477
summary: A command injection vulnerability in Nokogiri v1.10.3 and earlier allows commands to
  be executed in a subprocess via Ruby's `Kernel.open` method. Processes are vulnerable only
  if the undocumented method `Nokogiri::CSS::Tokenizer#load_file` is being called with unsafe
  user input as the filename. This vulnerability appears in code generated by the Rexical gem
  versions v1.0.6 and earlier. Rexical is used by Nokogiri to generate lexical scanner code
  for parsing CSS queries. The underlying vulnerability was addressed in Rexical v1.0.7 and
  Nokogiri upgraded to this version of Rexical in Nokogiri v1.10.4.
impacted_packages:
  - purl: pkg:deb/ubuntu/ruby-nokogiri?arch=source&distro=trusty/esm
    affected_versions: vers:deb/1.5.9-2|1.5.9-3|1.6.0-1|1.6.1+ds-1
    fixed_versions: vers:deb/1.6.1+ds-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-nokogiri?arch=source&distro=xenial
    affected_versions: vers:deb/1.6.6.2+ds-2build2|1.6.6.3-1|1.6.7-1|1.6.7.1-1|1.6.7.2-3|1.6.7.2-3build1
    fixed_versions: vers:deb/1.6.7.2-3ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-nokogiri?arch=source&distro=bionic
    affected_versions: vers:deb/1.8.0-1|1.8.1-1|1.8.1-1build1|1.8.2-1build1
    fixed_versions: vers:deb/1.8.2-1ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-5477.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-5477.json
weaknesses: []
references:
  - url: https://github.com/sparklemotion/nokogiri/issues/1915
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2019-5477
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4175-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2019-5477
    reference_type:
    reference_id:
