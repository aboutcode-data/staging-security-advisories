advisory_id: UBUNTU-CVE-2025-61672
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-61672
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-61672.json
aliases:
  - CVE-2025-61672
summary: Synapse is an open source Matrix homeserver implementation. Lack of validation for
  device keys in Synapse before 1.138.3 and in Synapse 1.139.0 allow an attacker registered
  on the victim homeserver to degrade federation functionality, unpredictably breaking outbound
  federation to other homeservers. The issue is patched in Synapse 1.138.3, 1.138.4, 1.139.1,
  and 1.139.2. Note that even though 1.138.3 and 1.139.1 fix the vulnerability, they inadvertently
  introduced an unrelated regression. For this reason, the maintainers of Synapse recommend
  skipping these releases and upgrading straight to 1.138.4 and 1.139.2.
impacted_packages:
  - purl: pkg:deb/ubuntu/matrix-synapse?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/0.19.2+dfsg-6|0.24.0+dfsg-1|0.24.0+dfsg-1ubuntu0.1~esm1|0.24.0+dfsg-1ubuntu0.1~esm4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/matrix-synapse?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/1.3.0-1|1.4.0-1|1.5.0-1|1.5.1-1|1.6.0-1|1.6.1-1|1.7.0-2|1.7.1-1|1.7.2-1|1.7.3-1|1.8.0-1|1.9.0-1|1.9.1-1|1.10.0-1|1.10.0-2|1.11.0-1|1.11.0-1ubuntu0.1~esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/matrix-synapse?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/1.39.0-1|1.47.0-2|1.47.1-1|1.48.0-1|1.49.0-1|1.49.2-1|1.50.1-1|1.50.2-1|1.51.0-1|1.52.0-1|1.53.0-1|1.53.0-1ubuntu0.1~esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/matrix-synapse?arch=source&distro=noble
    affected_versions: vers:deb/1.90.0-1|1.100.0-1ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-61672.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-61672.json
weaknesses: []
references:
  - url: https://github.com/element-hq/synapse/commit/26aaaf9e48fff80cf67a20c691c75d670034b3c1
    reference_type:
    reference_id:
  - url: https://github.com/element-hq/synapse/commit/7069636c2d6d1ef2022287addf3ed8b919ef2740
    reference_type:
    reference_id:
  - url: https://github.com/element-hq/synapse/pull/17097
    reference_type:
    reference_id:
  - url: https://github.com/element-hq/synapse/releases/tag/v1.138.3
    reference_type:
    reference_id:
  - url: https://github.com/element-hq/synapse/releases/tag/v1.139.1
    reference_type:
    reference_id:
  - url: https://github.com/element-hq/synapse/security/advisories/GHSA-fh66-fcv5-jjfr
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-61672
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-61672
    reference_type:
    reference_id:
