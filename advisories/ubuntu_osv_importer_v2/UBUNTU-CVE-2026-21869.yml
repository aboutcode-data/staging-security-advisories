advisory_id: UBUNTU-CVE-2026-21869
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2026-21869
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-21869.json
aliases:
  - CVE-2026-21869
summary: llama.cpp is an inference of several LLM models in C/C++. In commits 55d4206c8 and
  prior, the n_discard parameter is parsed directly from JSON input in the llama.cpp server's
  completion endpoints without validation to ensure it's non-negative. When a negative value
  is supplied and the context fills up, llama_memory_seq_rm/add receives a reversed range and
  negative offset, causing out-of-bounds memory writes in the token evaluation loop. This deterministic
  memory corruption can crash the process or enable remote code execution (RCE). There is no
  fix at the time of publication.
impacted_packages:
  - purl: pkg:deb/ubuntu/llama.cpp?arch=source&distro=questing
    affected_versions: vers:deb/5318+dfsg-1|5318+dfsg-2|5713+dfsg-1|5760+dfsg-1|5760+dfsg-3|5760+dfsg-4|5882+dfsg-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-21869.json
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-21869.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-21869.json
weaknesses: []
references:
  - url: https://github.com/ggml-org/llama.cpp/security/advisories/GHSA-8947-pfff-2f3c
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2026-21869
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2026-21869
    reference_type:
    reference_id:
