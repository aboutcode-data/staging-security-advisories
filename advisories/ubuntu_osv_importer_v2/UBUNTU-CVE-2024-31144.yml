advisory_id: UBUNTU-CVE-2024-31144
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-31144
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31144.json
aliases:
  - CVE-2024-31144
summary: 'For a brief summary of Xapi terminology, see: https://xapi-project.github.io/xen-api/overview.html#object-model-overview
  Xapi contains functionality to backup and restore metadata about Virtual Machines and Storage
  Repositories (SRs). The metadata itself is stored in a Virtual Disk Image (VDI) inside an
  SR.  This is used for two purposes; a general backup of metadata (e.g. to recover from a host
  failure if the filer is still good), and Portable SRs (e.g. using an external hard drive to
  move VMs to another host). Metadata is only restored as an explicit administrator action,
  but occurs in cases where the host has no information about the SR, and must locate the metadata
  VDI in order to retrieve the metadata. The metadata VDI is located by searching (in UUID alphanumeric
  order) each VDI, mounting it, and seeing if there is a suitable metadata file present.  The
  first matching VDI is deemed to be the metadata VDI, and is restored from. In the general
  case, the content of VDIs are controlled by the VM owner, and should not be trusted by the
  host administrator. A malicious guest can manipulate its disk to appear to be a metadata backup.
  A guest cannot choose the UUIDs of its VDIs, but a guest with one disk has a 50% chance of
  sorting ahead of the legitimate metadata backup.  A guest with two disks has a 75% chance,
  etc.'
impacted_packages:
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=xenial
    affected_versions: vers:deb/4.5.1-0ubuntu1|4.5.1-0ubuntu2|4.6.0-1ubuntu1|4.6.0-1ubuntu2|4.6.0-1ubuntu4|4.6.0-1ubuntu4.1|4.6.0-1ubuntu4.2|4.6.0-1ubuntu4.3|4.6.5-0ubuntu1|4.6.5-0ubuntu1.1|4.6.5-0ubuntu1.2|4.6.5-0ubuntu1.4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=bionic
    affected_versions: vers:deb/4.9.0-0ubuntu3|4.9.0-0ubuntu4|4.9.2-0ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=focal
    affected_versions: vers:deb/4.9.2-0ubuntu2|4.9.2-0ubuntu6|4.9.2-0ubuntu7|4.11.3+24-g14b62ab3e5-1ubuntu1|4.11.3+24-g14b62ab3e5-1ubuntu2|4.11.3+24-g14b62ab3e5-1ubuntu2.2|4.11.3+24-g14b62ab3e5-1ubuntu2.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=jammy
    affected_versions: vers:deb/4.11.4+24-gddaaccbbab-1ubuntu2|4.16.0-1~ubuntu2|4.16.0-1~ubuntu2.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=noble
    affected_versions: vers:deb/4.17.2-1|4.17.2+55-g0b56bed864-1|4.17.2+76-ge1f9cb16e2-1|4.17.2+76-ge1f9cb16e2-1ubuntu1|4.17.3+10-g091466ba55-1|4.17.3+10-g091466ba55-1.1ubuntu2|4.17.3+10-g091466ba55-1.1ubuntu3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=questing
    affected_versions: vers:deb/4.20.0-1ubuntu1|4.20.0+68-g35cb38b222-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31144.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-31144.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2024-31144
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-31144
    reference_type:
    reference_id:
  - url: https://xenbits.xen.org/xsa/advisory-459.html
    reference_type:
    reference_id:
