advisory_id: UBUNTU-CVE-2021-20254
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-20254
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-20254.json
aliases:
  - CVE-2021-20254
summary: A flaw was found in samba. The Samba smbd file server must map Windows group identities
  (SIDs) into unix group ids (gids). The code that performs this had a flaw that could allow
  it to read data beyond the end of the array in the case where a negative cache entry had been
  added to the mapping cache. This could cause the calling code to return those values into
  the process token that stores the group membership for a user. The highest threat from this
  vulnerability is to data confidentiality and integrity.
impacted_packages:
  - purl: pkg:deb/ubuntu/samba?arch=source&distro=trusty/esm
    affected_versions: vers:deb/2:3.6.18-1ubuntu3|2:4.0.10+dfsg-4ubuntu2|2:4.0.13+dfsg-1ubuntu1|2:4.1.3+dfsg-2ubuntu2|2:4.1.3+dfsg-2ubuntu3|2:4.1.3+dfsg-2ubuntu4|2:4.1.3+dfsg-2ubuntu5|2:4.1.6+dfsg-1ubuntu1|2:4.1.6+dfsg-1ubuntu2|2:4.1.6+dfsg-1ubuntu2.14.04.1|2:4.1.6+dfsg-1ubuntu2.14.04.2|2:4.1.6+dfsg-1ubuntu2.14.04.3|2:4.1.6+dfsg-1ubuntu2.14.04.4|2:4.1.6+dfsg-1ubuntu2.14.04.5|2:4.1.6+dfsg-1ubuntu2.14.04.7|2:4.1.6+dfsg-1ubuntu2.14.04.8|2:4.1.6+dfsg-1ubuntu2.14.04.9|2:4.1.6+dfsg-1ubuntu2.14.04.11|2:4.1.6+dfsg-1ubuntu2.14.04.12|2:4.1.6+dfsg-1ubuntu2.14.04.13|2:4.3.8+dfsg-0ubuntu0.14.04.2|2:4.3.9+dfsg-0ubuntu0.14.04.1|2:4.3.9+dfsg-0ubuntu0.14.04.3|2:4.3.11+dfsg-0ubuntu0.14.04.1|2:4.3.11+dfsg-0ubuntu0.14.04.2|2:4.3.11+dfsg-0ubuntu0.14.04.3|2:4.3.11+dfsg-0ubuntu0.14.04.4|2:4.3.11+dfsg-0ubuntu0.14.04.6|2:4.3.11+dfsg-0ubuntu0.14.04.7|2:4.3.11+dfsg-0ubuntu0.14.04.8|2:4.3.11+dfsg-0ubuntu0.14.04.9|2:4.3.11+dfsg-0ubuntu0.14.04.10|2:4.3.11+dfsg-0ubuntu0.14.04.11|2:4.3.11+dfsg-0ubuntu0.14.04.12|2:4.3.11+dfsg-0ubuntu0.14.04.13|2:4.3.11+dfsg-0ubuntu0.14.04.14|2:4.3.11+dfsg-0ubuntu0.14.04.16|2:4.3.11+dfsg-0ubuntu0.14.04.17|2:4.3.11+dfsg-0ubuntu0.14.04.19|2:4.3.11+dfsg-0ubuntu0.14.04.20|2:4.3.11+dfsg-0ubuntu0.14.04.20+esm1|2:4.3.11+dfsg-0ubuntu0.14.04.20+esm2|2:4.3.11+dfsg-0ubuntu0.14.04.20+esm3|2:4.3.11+dfsg-0ubuntu0.14.04.20+esm4|2:4.3.11+dfsg-0ubuntu0.14.04.20+esm6|2:4.3.11+dfsg-0ubuntu0.14.04.20+esm7|2:4.3.11+dfsg-0ubuntu0.14.04.20+esm8|2:4.3.11+dfsg-0ubuntu0.14.04.20+esm9
    fixed_versions: vers:deb/2:4.3.11+dfsg-0ubuntu0.14.04.20+esm11
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/samba?arch=source&distro=xenial
    affected_versions: vers:deb/2:4.1.17+dfsg-4ubuntu2|2:4.1.20+dfsg-1ubuntu1|2:4.1.20+dfsg-1ubuntu2|2:4.1.20+dfsg-1ubuntu3|2:4.1.20+dfsg-1ubuntu5|2:4.3.3+dfsg-1ubuntu1|2:4.3.3+dfsg-1ubuntu2|2:4.3.3+dfsg-1ubuntu3|2:4.3.6+dfsg-1ubuntu1|2:4.3.8+dfsg-0ubuntu1|2:4.3.9+dfsg-0ubuntu0.16.04.1|2:4.3.9+dfsg-0ubuntu0.16.04.2|2:4.3.9+dfsg-0ubuntu0.16.04.3|2:4.3.11+dfsg-0ubuntu0.16.04.1|2:4.3.11+dfsg-0ubuntu0.16.04.3|2:4.3.11+dfsg-0ubuntu0.16.04.5|2:4.3.11+dfsg-0ubuntu0.16.04.6|2:4.3.11+dfsg-0ubuntu0.16.04.7|2:4.3.11+dfsg-0ubuntu0.16.04.8|2:4.3.11+dfsg-0ubuntu0.16.04.9|2:4.3.11+dfsg-0ubuntu0.16.04.10|2:4.3.11+dfsg-0ubuntu0.16.04.11|2:4.3.11+dfsg-0ubuntu0.16.04.12|2:4.3.11+dfsg-0ubuntu0.16.04.13|2:4.3.11+dfsg-0ubuntu0.16.04.15|2:4.3.11+dfsg-0ubuntu0.16.04.16|2:4.3.11+dfsg-0ubuntu0.16.04.17|2:4.3.11+dfsg-0ubuntu0.16.04.18|2:4.3.11+dfsg-0ubuntu0.16.04.19|2:4.3.11+dfsg-0ubuntu0.16.04.20|2:4.3.11+dfsg-0ubuntu0.16.04.21|2:4.3.11+dfsg-0ubuntu0.16.04.23|2:4.3.11+dfsg-0ubuntu0.16.04.24|2:4.3.11+dfsg-0ubuntu0.16.04.25|2:4.3.11+dfsg-0ubuntu0.16.04.26|2:4.3.11+dfsg-0ubuntu0.16.04.27|2:4.3.11+dfsg-0ubuntu0.16.04.28|2:4.3.11+dfsg-0ubuntu0.16.04.29|2:4.3.11+dfsg-0ubuntu0.16.04.30|2:4.3.11+dfsg-0ubuntu0.16.04.31|2:4.3.11+dfsg-0ubuntu0.16.04.32
    fixed_versions: vers:deb/2:4.3.11+dfsg-0ubuntu0.16.04.34
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/samba?arch=source&distro=bionic
    affected_versions: vers:deb/2:4.6.7+dfsg-1ubuntu3|2:4.7.1+dfsg-1ubuntu1|2:4.7.3+dfsg-1ubuntu1|2:4.7.4+dfsg-1ubuntu1|2:4.7.6+dfsg~ubuntu-0ubuntu1|2:4.7.6+dfsg~ubuntu-0ubuntu2|2:4.7.6+dfsg~ubuntu-0ubuntu2.2|2:4.7.6+dfsg~ubuntu-0ubuntu2.4|2:4.7.6+dfsg~ubuntu-0ubuntu2.5|2:4.7.6+dfsg~ubuntu-0ubuntu2.6|2:4.7.6+dfsg~ubuntu-0ubuntu2.7|2:4.7.6+dfsg~ubuntu-0ubuntu2.9|2:4.7.6+dfsg~ubuntu-0ubuntu2.10|2:4.7.6+dfsg~ubuntu-0ubuntu2.11|2:4.7.6+dfsg~ubuntu-0ubuntu2.13|2:4.7.6+dfsg~ubuntu-0ubuntu2.14|2:4.7.6+dfsg~ubuntu-0ubuntu2.15|2:4.7.6+dfsg~ubuntu-0ubuntu2.16|2:4.7.6+dfsg~ubuntu-0ubuntu2.17|2:4.7.6+dfsg~ubuntu-0ubuntu2.18|2:4.7.6+dfsg~ubuntu-0ubuntu2.19|2:4.7.6+dfsg~ubuntu-0ubuntu2.20|2:4.7.6+dfsg~ubuntu-0ubuntu2.21
    fixed_versions: vers:deb/2:4.7.6+dfsg~ubuntu-0ubuntu2.23
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/samba?arch=source&distro=focal
    affected_versions: vers:deb/2:4.10.7+dfsg-0ubuntu2|2:4.10.7+dfsg-0ubuntu3|2:4.11.1+dfsg-3ubuntu1|2:4.11.1+dfsg-3ubuntu2|2:4.11.1+dfsg-3ubuntu4|2:4.11.5+dfsg-1ubuntu1|2:4.11.5+dfsg-1ubuntu2|2:4.11.6+dfsg-0ubuntu1|2:4.11.6+dfsg-0ubuntu1.1|2:4.11.6+dfsg-0ubuntu1.2|2:4.11.6+dfsg-0ubuntu1.3|2:4.11.6+dfsg-0ubuntu1.4|2:4.11.6+dfsg-0ubuntu1.5|2:4.11.6+dfsg-0ubuntu1.6
    fixed_versions: vers:deb/2:4.11.6+dfsg-0ubuntu1.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-20254.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-20254.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2021-20254
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4930-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4931-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-20254
    reference_type:
    reference_id:
  - url: https://www.samba.org/samba/security/CVE-2021-20254.html
    reference_type:
    reference_id:
