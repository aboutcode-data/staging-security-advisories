advisory_id: UBUNTU-CVE-2025-61770
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-61770
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-61770.json
aliases:
  - CVE-2025-61770
summary: Rack is a modular Ruby web server interface. In versions prior to 2.2.19, 3.1.17, and
  3.2.2, `Rack::Multipart::Parser` buffers the entire multipart preamble (bytes before the first
  boundary) in memory without any size limit. A client can send a large preamble followed by
  a valid boundary, causing significant memory use and potential process termination due to
  out-of-memory (OOM) conditions. Remote attackers can trigger large transient memory spikes
  by including a long preamble in multipart/form-data requests. The impact scales with allowed
  request sizes and concurrency, potentially causing worker crashes or severe slowdown due to
  garbage collection. Versions 2.2.19, 3.1.17, and 3.2.2 enforce a preamble size limit (e.g.,
  16 KiB) or discard preamble data entirely. Workarounds include limiting total request body
  size at the proxy or web server level and monitoring memory and set per-process limits to
  prevent OOM conditions.
impacted_packages:
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/1.5.2-1|1.5.2-1ubuntu0.1~esm1|1.5.2-3+deb8u3ubuntu1~esm2|1.5.2-3+deb8u3ubuntu1~esm3|1.5.2-3+deb8u3ubuntu1~esm4|1.5.2-3+deb8u3ubuntu1~esm6|1.5.2-3+deb8u3ubuntu1~esm7|1.5.2-3+deb8u3ubuntu1~esm8|1.5.2-3+deb8u3ubuntu1~esm9|1.5.2-3+deb8u3ubuntu1~esm10
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.5.2-4|1.6.4-2|1.6.4-3|1.6.4-3ubuntu0.1|1.6.4-3ubuntu0.2|1.6.4-3ubuntu0.2+esm1|1.6.4-3ubuntu0.2+esm2|1.6.4-3ubuntu0.2+esm4|1.6.4-3ubuntu0.2+esm5|1.6.4-3ubuntu0.2+esm6|1.6.4-3ubuntu0.2+esm7|1.6.4-3ubuntu0.2+esm8|1.6.4-3ubuntu0.2+esm9
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.6.4-4|1.6.4-4ubuntu0.1|1.6.4-4ubuntu0.2|1.6.4-4ubuntu0.2+esm1|1.6.4-4ubuntu0.2+esm2|1.6.4-4ubuntu0.2+esm4|1.6.4-4ubuntu0.2+esm5|1.6.4-4ubuntu0.2+esm6|1.6.4-4ubuntu0.2+esm7|1.6.4-4ubuntu0.2+esm8|1.6.4-4ubuntu0.2+esm9
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/2.0.6-3|2.0.7-2|2.0.7-2ubuntu0.1|2.0.7-2ubuntu0.1+esm1|2.0.7-2ubuntu0.1+esm2|2.0.7-2ubuntu0.1+esm3|2.0.7-2ubuntu0.1+esm4|2.0.7-2ubuntu0.1+esm5|2.0.7-2ubuntu0.1+esm6|2.0.7-2ubuntu0.1+esm7|2.0.7-2ubuntu0.1+esm8|2.0.7-2ubuntu0.1+esm9
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=jammy
    affected_versions: vers:deb/2.1.4-3|2.1.4-4|2.1.4-5|2.1.4-5ubuntu1|2.1.4-5ubuntu1.1
    fixed_versions: vers:deb/2.1.4-5ubuntu1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=noble
    affected_versions: vers:deb/2.2.4-3|2.2.7-1|2.2.7-1ubuntu0.1|2.2.7-1ubuntu0.2|2.2.7-1ubuntu0.3|2.2.7-1ubuntu0.4
    fixed_versions: vers:deb/2.2.7-1ubuntu0.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=questing
    affected_versions: vers:deb/2.2.7-1.1|3.1.16-0.1
    fixed_versions: vers:deb/3.1.16-0.1ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-61770.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-61770.json
weaknesses: []
references:
  - url: https://github.com/rack/rack/security/advisories/GHSA-p543-xpfm-54cp
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-61770
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7960-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-61770
    reference_type:
    reference_id:
