advisory_id: UBUNTU-CVE-2023-42118
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-42118
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-42118.json
aliases:
  - CVE-2023-42118
summary: Exim libspf2 Integer Underflow Remote Code Execution Vulnerability. This vulnerability
  allows network-adjacent attackers to execute arbitrary code on affected installations of Exim
  libspf2. Authentication is not required to exploit this vulnerability. The specific flaw exists
  within the parsing of SPF macros. When parsing SPF macros, the process does not properly validate
  user-supplied data, which can result in an integer underflow before writing to memory. An
  attacker can leverage this vulnerability to execute code in the context of the service account.
  . Was ZDI-CAN-17578.
impacted_packages:
  - purl: pkg:deb/ubuntu/exim4?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/4.80-7ubuntu3|4.80-7ubuntu4|4.80-9ubuntu1|4.80-9ubuntu2|4.82-3ubuntu1|4.82-3ubuntu2|4.82-3ubuntu2.1|4.82-3ubuntu2.2|4.82-3ubuntu2.3|4.82-3ubuntu2.4|4.82-3ubuntu2.4+esm1|4.82-3ubuntu2.4+esm2|4.82-3ubuntu2.4+esm3|4.82-3ubuntu2.4+esm4|4.82-3ubuntu2.4+esm6|4.82-3ubuntu2.4+esm7|4.82-3ubuntu2.4+esm8
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/exim4?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/4.86-3ubuntu1|4.86-7ubuntu1|4.86-7ubuntu2|4.86-7ubuntu3|4.86.2-2ubuntu1|4.86.2-2ubuntu2|4.86.2-2ubuntu2.1|4.86.2-2ubuntu2.2|4.86.2-2ubuntu2.3|4.86.2-2ubuntu2.4|4.86.2-2ubuntu2.5|4.86.2-2ubuntu2.6|4.86.2-2ubuntu2.6+esm1|4.86.2-2ubuntu2.6+esm2|4.86.2-2ubuntu2.6+esm4|4.86.2-2ubuntu2.6+esm5|4.86.2-2ubuntu2.6+esm6|4.86.2-2ubuntu2.6+esm7|4.86.2-2ubuntu2.6+esm8
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libspf2?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.2.10-6|1.2.10-6build1|1.2.10-6ubuntu0.1~esm1|1.2.10-6ubuntu0.1~esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/exim4?arch=source&distro=esm-infra/bionic
    affected_versions: vers:deb/4.89-5ubuntu1|4.89-9ubuntu1|4.89-9ubuntu2|4.89-9ubuntu3|4.89-9ubuntu4|4.90.1-1ubuntu1|4.90.1-1ubuntu1.1|4.90.1-1ubuntu1.2|4.90.1-1ubuntu1.3|4.90.1-1ubuntu1.4|4.90.1-1ubuntu1.5|4.90.1-1ubuntu1.8|4.90.1-1ubuntu1.9|4.90.1-1ubuntu1.10|4.90.1-1ubuntu1.10+esm1|4.90.1-1ubuntu1.10+esm2|4.90.1-1ubuntu1.10+esm3|4.90.1-1ubuntu1.10+esm4|4.90.1-1ubuntu1.10+esm5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libspf2?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.2.10-7build2|1.2.10-7ubuntu0.18.04.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/exim4?arch=source&distro=focal
    affected_versions: vers:deb/4.92.1-1ubuntu3|4.92.1-1ubuntu4|4.93~RC2-1ubuntu1|4.93-9ubuntu1|4.93-11ubuntu1|4.93-12ubuntu1|4.93-13ubuntu1|4.93-13ubuntu1.1|4.93-13ubuntu1.5|4.93-13ubuntu1.6|4.93-13ubuntu1.7|4.93-13ubuntu1.8|4.93-13ubuntu1.9|4.93-13ubuntu1.10|4.93-13ubuntu1.11|4.93-13ubuntu1.12
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libspf2?arch=source&distro=focal
    affected_versions: vers:deb/1.2.10-7build3|1.2.10-7build4|1.2.10-7+deb9u2build0.20.04.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/exim4?arch=source&distro=jammy
    affected_versions: vers:deb/4.94.2-7ubuntu2|4.95-2ubuntu2|4.95-4ubuntu1|4.95-4ubuntu2|4.95-4ubuntu2.1|4.95-4ubuntu2.2|4.95-4ubuntu2.3|4.95-4ubuntu2.4|4.95-4ubuntu2.5|4.95-4ubuntu2.6
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libspf2?arch=source&distro=jammy
    affected_versions: vers:deb/1.2.10-7.1|1.2.10-7.1ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/exim4?arch=source&distro=noble
    affected_versions: vers:deb/4.96-17ubuntu2|4.96-17ubuntu2.1|4.97-3ubuntu1|4.97-4ubuntu1|4.97-4ubuntu3|4.97-4ubuntu4|4.97-4ubuntu4.1|4.97-4ubuntu4.2|4.97-4ubuntu4.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libspf2?arch=source&distro=noble
    affected_versions: vers:deb/1.2.10-7.2build1|1.2.10-8|1.2.10-8build1|1.2.10-8.1ubuntu2|1.2.10-8.1ubuntu3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/exim4?arch=source&distro=questing
    affected_versions: vers:deb/4.98.1-1ubuntu2|4.98.2-1ubuntu1|4.98.2-1ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/libspf2?arch=source&distro=questing
    affected_versions: vers:deb/1.2.10-8.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-42118.json
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-42118.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-42118.json
weaknesses: []
references:
  - url: https://exim.org/static/doc/security/CVE-2023-zdi.txt
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-42118
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-42118
    reference_type:
    reference_id:
  - url: https://www.zerodayinitiative.com/advisories/ZDI-23-1472/
    reference_type:
    reference_id:
