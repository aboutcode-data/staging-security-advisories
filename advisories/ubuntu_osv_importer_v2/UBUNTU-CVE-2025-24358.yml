advisory_id: UBUNTU-CVE-2025-24358
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-24358
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24358.json
aliases:
  - CVE-2025-24358
summary: gorilla/csrf provides Cross Site Request Forgery (CSRF) prevention middleware for Go
  web applications & services. Prior to 1.7.2, gorilla/csrf does not validate the Origin header
  against an allowlist. Its executes its validation of the Referer header for cross-origin requests
  only when it believes the request is being served over TLS. It determines this by inspecting
  the r.URL.Scheme value. However, this value is never populated for "server" requests per the
  Go spec, and so this check does not run in practice. This vulnerability allows an attacker
  who has gained XSS on a subdomain or top level domain to perform authenticated form submissions
  against gorilla/csrf protected targets that share the same top level domain. This vulnerability
  is fixed in 1.7.2.
impacted_packages:
  - purl: pkg:deb/ubuntu/golang-github-gorilla-csrf?arch=source&distro=focal
    affected_versions: vers:deb/1.6.2-1|1.6.2-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-gorilla-csrf?arch=source&distro=jammy
    affected_versions: vers:deb/1.6.2-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-gorilla-csrf?arch=source&distro=noble
    affected_versions: vers:deb/1.7.1-1|1.7.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-gorilla-csrf?arch=source&distro=questing
    affected_versions: vers:deb/1.7.2+ds1-1|1.7.2+ds1-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24358.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-24358.json
weaknesses: []
references:
  - url: https://github.com/gorilla/csrf/commit/9dd6af1f6d30fc79fb0d972394deebdabad6b5eb
    reference_type:
    reference_id:
  - url: https://github.com/gorilla/csrf/security/advisories/GHSA-rq77-p4h8-4crw
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-24358
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-24358
    reference_type:
    reference_id:
