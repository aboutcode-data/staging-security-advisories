advisory_id: UBUNTU-CVE-2019-3822
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2019-3822
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-3822.json
aliases:
  - CVE-2019-3822
summary: libcurl versions from 7.36.0 to before 7.64.0 are vulnerable to a stack-based buffer
  overflow. The function creating an outgoing NTLM type-3 header (`lib/vauth/ntlm.c:Curl_auth_create_ntlm_type3_message()`),
  generates the request HTTP header contents based on previously received data. The check that
  exists to prevent the local buffer from getting overflowed is implemented wrongly (using unsigned
  math) and as such it does not prevent the overflow from happening. This output data can grow
  larger than the local buffer if very large 'nt response' data is extracted from a previous
  NTLMv2 header provided by the malicious or broken HTTP server. Such a 'large value' needs
  to be around 1000 bytes or more. The actual payload data copied to the target buffer comes
  from the NTLMv2 type-2 response header.
impacted_packages:
  - purl: pkg:deb/ubuntu/curl?arch=source&distro=xenial
    affected_versions: vers:deb/7.43.0-1ubuntu2|7.45.0-1ubuntu1|7.46.0-1ubuntu1|7.47.0-1ubuntu1|7.47.0-1ubuntu2|7.47.0-1ubuntu2.1|7.47.0-1ubuntu2.2|7.47.0-1ubuntu2.3|7.47.0-1ubuntu2.4|7.47.0-1ubuntu2.5|7.47.0-1ubuntu2.6|7.47.0-1ubuntu2.7|7.47.0-1ubuntu2.8|7.47.0-1ubuntu2.9|7.47.0-1ubuntu2.11
    fixed_versions: vers:deb/7.47.0-1ubuntu2.12
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/curl?arch=source&distro=bionic
    affected_versions: vers:deb/7.55.1-1ubuntu2|7.55.1-1ubuntu2.1|7.57.0-1ubuntu1|7.58.0-2ubuntu1|7.58.0-2ubuntu2|7.58.0-2ubuntu3|7.58.0-2ubuntu3.1|7.58.0-2ubuntu3.2|7.58.0-2ubuntu3.3|7.58.0-2ubuntu3.5
    fixed_versions: vers:deb/7.58.0-2ubuntu3.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-3822.json
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-3822.json
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-3822.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-3822.json
weaknesses: []
references:
  - url: https://curl.haxx.se/docs/CVE-2019-3822.html
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2019-3822
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3882-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2019-3822
    reference_type:
    reference_id:
