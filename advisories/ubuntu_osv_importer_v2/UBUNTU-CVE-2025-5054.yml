advisory_id: UBUNTU-CVE-2025-5054
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-5054
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-5054.json
aliases:
  - CVE-2025-5054
summary: Race condition in Canonical apport up to and including 2.32.0 allows a local attacker
  to leak sensitive information via PID-reuse by leveraging namespaces. When handling a crash,
  the function `_check_global_pid_and_forward`, which detects if the crashing process resided
  in a container, was being called before `consistency_checks`, which attempts to detect if
  the crashing process had been replaced. Because of this, if a process crashed and was quickly
  replaced with a containerized one, apport could be made to forward the core dump to the container,
  potentially leaking sensitive information. `consistency_checks` is now being called before
  `_check_global_pid_and_forward`. Additionally, given that the PID-reuse race condition cannot
  be reliably detected from userspace alone, crashes are only forwarded to containers if the
  kernel provided a pidfd, or if the crashing process was unprivileged (i.e., if dump mode ==
  1).
impacted_packages:
  - purl: pkg:deb/ubuntu/apport?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/2.19.1-0ubuntu3|2.19.2-0ubuntu1|2.19.2-0ubuntu2|2.19.2-0ubuntu3|2.19.2-0ubuntu4|2.19.2-0ubuntu5|2.19.2-0ubuntu6|2.19.2-0ubuntu8|2.19.2-0ubuntu9|2.19.3-0ubuntu1|2.19.3-0ubuntu2|2.19.3-0ubuntu3|2.19.4-0ubuntu1|2.19.4-0ubuntu2|2.20-0ubuntu2|2.20-0ubuntu3|2.20.1-0ubuntu1|2.20.1-0ubuntu2|2.20.1-0ubuntu2.1|2.20.1-0ubuntu2.2|2.20.1-0ubuntu2.4|2.20.1-0ubuntu2.5|2.20.1-0ubuntu2.6|2.20.1-0ubuntu2.9|2.20.1-0ubuntu2.10|2.20.1-0ubuntu2.12|2.20.1-0ubuntu2.13|2.20.1-0ubuntu2.14|2.20.1-0ubuntu2.15|2.20.1-0ubuntu2.16|2.20.1-0ubuntu2.17|2.20.1-0ubuntu2.18|2.20.1-0ubuntu2.19|2.20.1-0ubuntu2.20|2.20.1-0ubuntu2.21|2.20.1-0ubuntu2.22|2.20.1-0ubuntu2.23|2.20.1-0ubuntu2.24|2.20.1-0ubuntu2.25|2.20.1-0ubuntu2.26|2.20.1-0ubuntu2.27|2.20.1-0ubuntu2.28|2.20.1-0ubuntu2.30|2.20.1-0ubuntu2.30+esm1|2.20.1-0ubuntu2.30+esm2|2.20.1-0ubuntu2.30+esm3|2.20.1-0ubuntu2.30+esm4
    fixed_versions: vers:deb/2.20.1-0ubuntu2.30+esm5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/apport?arch=source&distro=esm-infra/bionic
    affected_versions: vers:deb/2.20.7-0ubuntu3|2.20.7-0ubuntu3.1|2.20.7-0ubuntu4|2.20.8-0ubuntu1|2.20.8-0ubuntu2|2.20.8-0ubuntu3|2.20.8-0ubuntu4|2.20.8-0ubuntu5|2.20.8-0ubuntu6|2.20.8-0ubuntu7|2.20.8-0ubuntu8|2.20.8-0ubuntu9|2.20.8-0ubuntu10|2.20.9-0ubuntu1|2.20.9-0ubuntu2|2.20.9-0ubuntu4|2.20.9-0ubuntu5|2.20.9-0ubuntu6|2.20.9-0ubuntu7|2.20.9-0ubuntu7.1|2.20.9-0ubuntu7.2|2.20.9-0ubuntu7.3|2.20.9-0ubuntu7.4|2.20.9-0ubuntu7.5|2.20.9-0ubuntu7.6|2.20.9-0ubuntu7.7|2.20.9-0ubuntu7.8|2.20.9-0ubuntu7.9|2.20.9-0ubuntu7.11|2.20.9-0ubuntu7.12|2.20.9-0ubuntu7.13|2.20.9-0ubuntu7.14|2.20.9-0ubuntu7.15|2.20.9-0ubuntu7.16|2.20.9-0ubuntu7.17|2.20.9-0ubuntu7.18|2.20.9-0ubuntu7.19|2.20.9-0ubuntu7.20|2.20.9-0ubuntu7.21|2.20.9-0ubuntu7.23|2.20.9-0ubuntu7.24|2.20.9-0ubuntu7.26|2.20.9-0ubuntu7.27|2.20.9-0ubuntu7.28|2.20.9-0ubuntu7.29
    fixed_versions: vers:deb/2.20.9-0ubuntu7.29+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/apport?arch=source&distro=focal
    affected_versions: vers:deb/2.20.11-0ubuntu8|2.20.11-0ubuntu9|2.20.11-0ubuntu13|2.20.11-0ubuntu14|2.20.11-0ubuntu15|2.20.11-0ubuntu16|2.20.11-0ubuntu17|2.20.11-0ubuntu18|2.20.11-0ubuntu19|2.20.11-0ubuntu20|2.20.11-0ubuntu21|2.20.11-0ubuntu22|2.20.11-0ubuntu24|2.20.11-0ubuntu25|2.20.11-0ubuntu26|2.20.11-0ubuntu27|2.20.11-0ubuntu27.2|2.20.11-0ubuntu27.3|2.20.11-0ubuntu27.4|2.20.11-0ubuntu27.6|2.20.11-0ubuntu27.8|2.20.11-0ubuntu27.9|2.20.11-0ubuntu27.10|2.20.11-0ubuntu27.11|2.20.11-0ubuntu27.12|2.20.11-0ubuntu27.13|2.20.11-0ubuntu27.14|2.20.11-0ubuntu27.16|2.20.11-0ubuntu27.17|2.20.11-0ubuntu27.18|2.20.11-0ubuntu27.20|2.20.11-0ubuntu27.21|2.20.11-0ubuntu27.23|2.20.11-0ubuntu27.24|2.20.11-0ubuntu27.25|2.20.11-0ubuntu27.26|2.20.11-0ubuntu27.27
    fixed_versions: vers:deb/2.20.11-0ubuntu27.28
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/apport?arch=source&distro=jammy
    affected_versions: vers:deb/2.20.11-0ubuntu70|2.20.11-0ubuntu73|2.20.11-0ubuntu74|2.20.11-0ubuntu75|2.20.11-0ubuntu76|2.20.11-0ubuntu77|2.20.11-0ubuntu78|2.20.11-0ubuntu79|2.20.11-0ubuntu80|2.20.11-0ubuntu81|2.20.11-0ubuntu82|2.20.11-0ubuntu82.1|2.20.11-0ubuntu82.2|2.20.11-0ubuntu82.3|2.20.11-0ubuntu82.4|2.20.11-0ubuntu82.5|2.20.11-0ubuntu82.6
    fixed_versions: vers:deb/2.20.11-0ubuntu82.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/apport?arch=source&distro=noble
    affected_versions: vers:deb/2.27.0-0ubuntu5|2.27.0-0ubuntu6|2.27.0-0ubuntu7|2.28.0-0ubuntu1|2.28.1-0ubuntu1|2.28.1-0ubuntu2|2.28.1-0ubuntu3|2.28.1-0ubuntu3.1|2.28.1-0ubuntu3.3|2.28.1-0ubuntu3.5
    fixed_versions: vers:deb/2.28.1-0ubuntu3.6
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-5054.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-5054.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2025-5054
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7545-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-5054
    reference_type:
    reference_id:
