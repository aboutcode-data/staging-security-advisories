advisory_id: UBUNTU-CVE-2022-38152
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-38152
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-38152.json
aliases:
  - CVE-2022-38152
summary: An issue was discovered in wolfSSL before 5.5.0. When a TLS 1.3 client connects to
  a wolfSSL server and SSL_clear is called on its session, the server crashes with a segmentation
  fault. This occurs in the second session, which is created through TLS session resumption
  and reuses the initial struct WOLFSSL. If the server reuses the previous session structure
  (struct WOLFSSL) by calling wolfSSL_clear(WOLFSSL* ssl) on it, the next received Client Hello
  (that resumes the previous session) crashes the server. Note that this bug is only triggered
  when resuming sessions using TLS session resumption. Only servers that use wolfSSL_clear instead
  of the recommended SSL_free; SSL_new sequence are affected. Furthermore, wolfSSL_clear is
  part of wolfSSL's compatibility layer and is not enabled by default. It is not part of wolfSSL's
  native API.
impacted_packages:
  - purl: pkg:deb/ubuntu/wolfssl?arch=source&distro=xenial
    affected_versions: vers:deb/3.4.8+dfsg-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/wolfssl?arch=source&distro=bionic
    affected_versions: vers:deb/3.10.2+dfsg-2|3.12.0+dfsg-1|3.12.2+dfsg-1|3.13.0+dfsg-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/wolfssl?arch=source&distro=focal
    affected_versions: vers:deb/4.1.0+dfsg-2|4.2.0+dfsg-1|4.2.0+dfsg-2|4.2.0+dfsg-3|4.3.0+dfsg-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/wolfssl?arch=source&distro=jammy
    affected_versions: vers:deb/4.6.0-3|5.0.0-1|5.1.1-1|5.2.0-1|5.2.0-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/wolfssl?arch=source&distro=noble
    affected_versions: vers:deb/5.5.4-2|5.5.4-2.1|5.6.4-2|5.6.6-1.2|5.6.6-1.3|5.6.6-1.3build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/wolfssl?arch=source&distro=questing
    affected_versions: vers:deb/5.7.2-0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-38152.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-38152.json
weaknesses: []
references:
  - url: https://github.com/tlspuffin/tlspuffin
    reference_type:
    reference_id:
  - url: https://github.com/wolfSSL/wolfssl/pull/5468
    reference_type:
    reference_id:
  - url: https://github.com/wolfSSL/wolfssl/releases
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-38152
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-38152
    reference_type:
    reference_id:
  - url: https://www.wolfssl.com/docs/security-vulnerabilities/
    reference_type:
    reference_id:
