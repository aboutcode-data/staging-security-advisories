advisory_id: UBUNTU-CVE-2023-36830
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-36830
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-36830.json
aliases:
  - CVE-2023-36830
summary: SQLFluff is a SQL linter. Prior to version 2.1.2, in environments where untrusted users
  have access to the config files, there is a potential security vulnerability where those users
  could use the `library_path` config value to allow arbitrary python code to be executed via
  macros. For many users who use SQLFluff in the context of an environment where all users already
  have fairly escalated privileges, this may not be an issue - however in larger user bases,
  or where SQLFluff is bundled into another tool where developers still wish to give users access
  to supply their on rule configuration, this may be an issue. The 2.1.2 release offers the
  ability for the `library_path` argument to be overwritten on the command line by using the
  `--library-path` option. This overrides any values provided in the config files and effectively
  prevents this route of attack for users which have access to the config file, but not to the
  scripts which call the SQLFluff CLI directly. A similar option is provided for the Python
  API, where users also have a greater ability to further customise or override configuration
  as necessary. Unless `library_path` is explicitly required, SQLFluff maintainers recommend
  using the option `--library-path none` when invoking SQLFluff which will disable the `library-path`
  option entirely regardless of the options set in the configuration file or via inline config
  directives. As a workaround, limiting access to - or otherwise validating configuration files
  before they are ingested by SQLFluff will provides a similar effect and does not require upgrade.
impacted_packages:
  - purl: pkg:deb/ubuntu/sqlfluff?arch=source&distro=noble
    affected_versions: vers:deb/1.4.5-2|2.3.5-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/sqlfluff?arch=source&distro=questing
    affected_versions: vers:deb/3.3.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-36830.json
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-36830.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-36830.json
weaknesses: []
references:
  - url: https://github.com/sqlfluff/sqlfluff/releases/tag/2.1.2
    reference_type:
    reference_id:
  - url: https://github.com/sqlfluff/sqlfluff/security/advisories/GHSA-jqhc-m2j3-fjrx
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-36830
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-36830
    reference_type:
    reference_id:
