advisory_id: UBUNTU-CVE-2023-22745
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-22745
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-22745.json
aliases:
  - CVE-2023-22745
summary: tpm2-tss is an open source software implementation of the Trusted Computing Group (TCG)
  Trusted Platform Module (TPM) 2 Software Stack (TSS2). In versions prior to 4.1.0-rc0, 4.0.1,
  and 3.2.2-rc1, `Tss2_RC_SetHandler` and `Tss2_RC_Decode` both index into `layer_handler` with
  an 8 bit layer number, but the array only has `TPM2_ERROR_TSS2_RC_LAYER_COUNT` entries, so
  trying to add a handler for higher-numbered layers or decode a response code with such a layer
  number reads/writes past the end of the buffer. This Buffer overrun, could result in arbitrary
  code execution. An example attack would be a MiTM bus attack that returns 0xFFFFFFFF for the
  RC. Given the common use case of TPM modules an attacker must have local access to the target
  machine with local system privileges which allows access to the TPM system. Usually TPM access
  requires administrative privilege. Versions 4.1.0-rc0, 4.0.1, and 3.2.2-rc1 fix the issue.
impacted_packages:
  - purl: pkg:deb/ubuntu/tpm2-tss?arch=source&distro=focal
    affected_versions: vers:deb/2.1.0-4|2.3.1-3|2.3.2-1|2.3.2-1ubuntu0.20.04.1
    fixed_versions: vers:deb/2.3.2-1ubuntu0.20.04.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/tpm2-tss?arch=source&distro=jammy
    affected_versions: vers:deb/3.0.3-2ubuntu1|3.0.3-2ubuntu2|3.1.0-3ubuntu1|3.2.0-0ubuntu2|3.2.0-1ubuntu1
    fixed_versions: vers:deb/3.2.0-1ubuntu1.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-22745.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-22745.json
weaknesses: []
references:
  - url: https://github.com/tpm2-software/tpm2-tss/security/advisories/GHSA-4j3v-fh23-vx67
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-22745
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6796-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-22745
    reference_type:
    reference_id:
