advisory_id: UBUNTU-CVE-2024-45159
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-45159
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-45159.json
aliases:
  - CVE-2024-45159
summary: An issue was discovered in Mbed TLS 3.x before 3.6.1. With TLS 1.3, when a server enables
  optional authentication of the client, if the client-provided certificate does not have appropriate
  values in if keyUsage or extKeyUsage extensions, then the return value of mbedtls_ssl_get_verify_result()
  would incorrectly have the MBEDTLS_X509_BADCERT_KEY_USAGE and MBEDTLS_X509_BADCERT_KEY_USAGE
  bits clear. As a result, an attacker that had a certificate valid for uses other than TLS
  client authentication would nonetheless be able to use it for TLS client authentication. Only
  TLS 1.3 servers were affected, and only with optional authentication (with required authentication,
  the handshake would be aborted with a fatal alert).
impacted_packages:
  - purl: pkg:deb/ubuntu/mbedtls?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/2.5.1-1ubuntu1|2.6.0-1|2.7.0-2|2.8.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/mbedtls?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/2.16.2-1|2.16.3-1|2.16.4-1ubuntu2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/mbedtls?arch=source&distro=jammy
    affected_versions: vers:deb/2.16.9-0.1ubuntu1|2.16.11-0.1ubuntu1|2.16.11-0.3|2.28.0-1|2.28.0-1build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/mbedtls?arch=source&distro=noble
    affected_versions: vers:deb/2.28.3-1|2.28.6-1ubuntu1|2.28.7-1ubuntu1|2.28.7-1.1ubuntu1|2.28.8-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/mbedtls?arch=source&distro=plucky
    affected_versions: vers:deb/2.28.8-1|3.6.2-1ubuntu4|3.6.2-2ubuntu1|3.6.2-3ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/mbedtls?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/2.1.2-1|2.2.0-1|2.2.1-1|2.2.1-2|2.2.1-2ubuntu0.1|2.2.1-2ubuntu0.2|2.2.1-2ubuntu0.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-45159.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-45159.json
weaknesses: []
references:
  - url: https://github.com/Mbed-TLS/mbedtls/releases/
    reference_type:
    reference_id:
  - url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/
    reference_type:
    reference_id:
  - url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-3/
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-45159
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-45159
    reference_type:
    reference_id:
