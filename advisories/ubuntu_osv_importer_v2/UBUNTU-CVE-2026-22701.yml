advisory_id: UBUNTU-CVE-2026-22701
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2026-22701
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-22701.json
aliases:
  - CVE-2026-22701
summary: filelock is a platform-independent file lock for Python. Prior to version 3.20.3, a
  TOCTOU race condition vulnerability exists in the SoftFileLock implementation of the filelock
  package. An attacker with local filesystem access and permission to create symlinks can exploit
  a race condition between the permission validation and file creation to cause lock operations
  to fail or behave unexpectedly. The vulnerability occurs in the _acquire() method between
  raise_on_not_writable_file() (permission check) and os.open() (file creation). During this
  race window, an attacker can create a symlink at the lock file path, potentially causing the
  lock to operate on an unintended target file or leading to denial of service. This issue has
  been patched in version 3.20.3.
impacted_packages:
  - purl: pkg:deb/ubuntu/python-filelock?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/3.0.12-2|3.3.2-1|3.4.0-1|3.4.2-1|3.4.2-2|3.6.0-1
    fixed_versions: vers:deb/3.6.0-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-filelock?arch=source&distro=esm-apps/noble
    affected_versions: vers:deb/3.12.2-1|3.12.4-1|3.13.1-1
    fixed_versions: vers:deb/3.13.1-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-filelock?arch=source&distro=questing
    affected_versions: vers:deb/3.18.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python-filelock?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/2.0.11-1|2.0.12-1|2.0.13-1|3.0.0-2|3.0.3-1|3.0.4-1
    fixed_versions: vers:deb/3.0.4-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-22701.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2026/UBUNTU-CVE-2026-22701.json
weaknesses: []
references:
  - url: https://github.com/tox-dev/filelock/commit/255ed068bc85d1ef406e50a135e1459170dd1bf0
    reference_type:
    reference_id:
  - url: https://github.com/tox-dev/filelock/commit/41b42dd2c72aecf7da83dbda5903b8087dddc4d5
    reference_type:
    reference_id:
  - url: https://github.com/tox-dev/filelock/security/advisories/GHSA-qmgc-5h2g-mvrw
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2026-22701
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7999-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2026-22701
    reference_type:
    reference_id:
