advisory_id: UBUNTU-CVE-2024-45337
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-45337
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-45337.json
aliases:
  - CVE-2024-45337
summary: Applications and libraries which misuse connection.serverAuthenticate (via callback
  field ServerConfig.PublicKeyCallback) may be susceptible to an authorization bypass. The documentation
  for ServerConfig.PublicKeyCallback says that "A call to this function does not guarantee that
  the key offered is in fact used to authenticate." Specifically, the SSH protocol allows clients
  to inquire about whether a public key is acceptable before proving control of the corresponding
  private key. PublicKeyCallback may be called with multiple keys, and the order in which the
  keys were provided cannot be used to infer which key the client successfully authenticated
  with, if any. Some applications, which store the key(s) passed to PublicKeyCallback (or derived
  information) and make security relevant determinations based on it once the connection is
  established, may make incorrect assumptions. For example, an attacker may send public keys
  A and B, and then authenticate with A. PublicKeyCallback would be called only twice, first
  with A and then with B. A vulnerable application may then make authorization decisions based
  on key B for which the attacker does not actually control the private key. Since this API
  is widely misused, as a partial mitigation golang.org/x/cry...@v0.31.0 enforces the property
  that, when successfully authenticating via public key, the last key passed to ServerConfig.PublicKeyCallback
  will be the key used to authenticate the connection. PublicKeyCallback will now be called
  multiple times with the same key, if necessary. Note that the client may still not control
  the last key passed to PublicKeyCallback if the connection is then authenticated with a different
  method, such as PasswordCallback, KeyboardInteractiveCallback, or NoClientAuth. Users should
  be using the Extensions field of the Permissions return value from the various authentication
  callbacks to record data associated with the authentication attempt instead of referencing
  external state. Once the connection is established the state corresponding to the successful
  authentication attempt can be retrieved via the ServerConn.Permissions field. Note that some
  third-party libraries misuse the Permissions type by sharing it across authentication attempts;
  users of third-party libraries should refer to the relevant projects for guidance.
impacted_packages:
  - purl: pkg:deb/ubuntu/golang-go.crypto?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1:0.0~git20170629.0.5ef0053-1ubuntu1|1:0.0~git20170629.0.5ef0053-1ubuntu2|1:0.0~git20170629.0.5ef0053-2
    fixed_versions: vers:deb/1:0.0~git20170629.0.5ef0053-2ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-go.crypto?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/1:0.0~git20150608-1|1:0.0~git20151201.0.7b85b09-2
    fixed_versions: vers:deb/1:0.0~git20151201.0.7b85b09-2ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/lxd?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/0.20-0ubuntu4|0.21-0ubuntu3|0.21-0ubuntu5|0.22-0ubuntu1|0.22-0ubuntu2|0.23-0ubuntu1|0.23-0ubuntu2|0.23-0ubuntu3|0.24-0ubuntu2|0.24-0ubuntu3|0.24-0ubuntu4|0.25-0ubuntu1|0.26-0ubuntu2|0.26-0ubuntu3|0.27-0ubuntu1|0.27-0ubuntu2|2.0.0~beta1-0ubuntu3|2.0.0~beta1-0ubuntu4|2.0.0~beta2-0ubuntu1|2.0.0~beta2-0ubuntu2|2.0.0~beta3-0ubuntu1|2.0.0~beta3-0ubuntu2|2.0.0~beta3-0ubuntu3|2.0.0~beta3-0ubuntu4|2.0.0~beta4-0ubuntu1|2.0.0~beta4-0ubuntu2|2.0.0~beta4-0ubuntu3|2.0.0~beta4-0ubuntu4|2.0.0~beta4-0ubuntu5|2.0.0~beta4-0ubuntu6|2.0.0~beta4-0ubuntu7|2.0.0~rc1-0ubuntu1|2.0.0~rc1-0ubuntu2|2.0.0~rc1-0ubuntu3|2.0.0~rc2-0ubuntu2|2.0.0~rc2-0ubuntu3|2.0.0~rc3-0ubuntu1|2.0.0~rc3-0ubuntu2|2.0.0~rc3-0ubuntu3|2.0.0~rc3-0ubuntu4|2.0.0~rc4-0ubuntu1|2.0.0~rc5-0ubuntu1|2.0.0~rc6-0ubuntu1|2.0.0~rc6-0ubuntu2|2.0.0~rc7-0ubuntu1|2.0.0~rc7-0ubuntu2|2.0.0~rc8-0ubuntu1|2.0.0~rc8-0ubuntu2|2.0.0~rc8-0ubuntu3|2.0.0~rc8-0ubuntu5|2.0.0~rc8-0ubuntu6|2.0.0~rc8-0ubuntu7|2.0.0~rc9-0ubuntu2|2.0.0~rc9-0ubuntu3|2.0.0~rc9-0ubuntu4|2.0.0~rc9-0ubuntu5|2.0.0-0ubuntu1|2.0.0-0ubuntu2|2.0.0-0ubuntu3|2.0.0-0ubuntu4|2.0.1-0ubuntu1~16.04.1|2.0.2-0ubuntu1~16.04.1|2.0.3-0ubuntu1~ubuntu16.04.2|2.0.4-0ubuntu1~ubuntu16.04.1|2.0.5-0ubuntu1~ubuntu16.04.1|2.0.8-0ubuntu1~ubuntu16.04.1|2.0.8-0ubuntu1~ubuntu16.04.2|2.0.9-0ubuntu1~16.04.1|2.0.9-0ubuntu1~16.04.2|2.0.10-0ubuntu1~16.04.1|2.0.10-0ubuntu1~16.04.2|2.0.11-0ubuntu1~16.04.2|2.0.11-0ubuntu1~16.04.4|2.0.11-0ubuntu1~16.04.4+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/google-guest-agent?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/20201217.02-0ubuntu1~16.04.0|20230426.00-0ubuntu2~16.04.3|20231004.02-0ubuntu1~16.04.1|20231004.02-0ubuntu1~16.04.2|20240716.00-0ubuntu1~16.04.0
    fixed_versions: vers:deb/20240716.00-0ubuntu1~16.04.0+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/lxd?arch=source&distro=esm-infra/bionic
    affected_versions: vers:deb/2.18-0ubuntu6|2.19-0ubuntu1|2.20-0ubuntu3|2.20-0ubuntu4|2.21-0ubuntu1|2.21-0ubuntu2|2.21-0ubuntu3|2.21-0ubuntu4|3.0.0~beta2-0ubuntu3|3.0.0~beta3-0ubuntu3|3.0.0~beta5-0ubuntu2|3.0.0~beta7-0ubuntu1|3.0.0-0ubuntu1|3.0.0-0ubuntu2|3.0.0-0ubuntu3|3.0.0-0ubuntu4|3.0.1-0ubuntu1~18.04.1|3.0.2-0ubuntu1~18.04.1|3.0.3-0ubuntu1~18.04.1|3.0.3-0ubuntu1~18.04.2|3.0.3-0ubuntu1~18.04.2+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/google-guest-agent?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/20201217.02-0ubuntu1~18.04.0|20210414.00-0ubuntu1~18.04.0|20210629.00-0ubuntu1~18.04.1|20220622.00-0ubuntu2~18.04.0|20220622.00-0ubuntu2~18.04.1|20230426.00-0ubuntu2~18.04.0|20231004.02-0ubuntu1~18.04.2|20231004.02-0ubuntu1~18.04.3|20240716.00-0ubuntu1~18.04.0|20241011.01-0ubuntu1~18.04.0
    fixed_versions: vers:deb/20241011.01-0ubuntu1~18.04.0+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/google-guest-agent?arch=source&distro=esm-infra/focal
    affected_versions: vers:deb/20201217.02-0ubuntu1~20.04.0|20210414.00-0ubuntu1~20.04.0|20210629.00-0ubuntu1~20.04.0|20220622.00-0ubuntu2~20.04.0|20220622.00-0ubuntu2~20.04.2|20230426.00-0ubuntu2~20.04.0|20231004.02-0ubuntu1~20.04.1|20231004.02-0ubuntu1~20.04.2|20231004.02-0ubuntu1~20.04.3|20231004.02-0ubuntu1~20.04.4|20240716.00-0ubuntu1~20.04.0|20241011.01-0ubuntu1~20.04.1|20250116.00-0ubuntu1~20.04.0
    fixed_versions: vers:deb/20250116.00-0ubuntu1~20.04.0+esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-go.crypto?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/1:0.0~git20190701.4def268-2|1:0.0~git20200221.2aa609c-1
    fixed_versions: vers:deb/1:0.0~git20200221.2aa609c-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/google-guest-agent?arch=source&distro=jammy
    affected_versions: vers:deb/20210629.00-0ubuntu1|20210629.00-0ubuntu2|20220104.00-0ubuntu1|20220104.00-0ubuntu2|20220622.00-0ubuntu2~22.04.0|20220622.00-0ubuntu2~22.04.1|20230426.00-0ubuntu2~22.04.0|20231004.02-0ubuntu1~22.04.1|20231004.02-0ubuntu1~22.04.2|20231004.02-0ubuntu1~22.04.3|20231004.02-0ubuntu1~22.04.4|20231004.02-0ubuntu1~22.04.5|20240716.00-0ubuntu1~22.04.0|20241011.01-0ubuntu1~22.04.0|20250116.00-0ubuntu1~22.04.0
    fixed_versions: vers:deb/20250116.00-0ubuntu1~22.04.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-go.crypto?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/1:0.0~git20201221.eec23a3-1|1:0.0~git20211202.5770296-1
    fixed_versions: vers:deb/1:0.0~git20211202.5770296-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/google-guest-agent?arch=source&distro=noble
    affected_versions: vers:deb/20230426.00-0ubuntu3|20231004.02-0ubuntu1|20231004.02-0ubuntu3|20240213.00-0ubuntu1|20240213.00-0ubuntu2|20240213.00-0ubuntu3|20240213.00-0ubuntu3.1|20240213.00-0ubuntu3.2|20240716.00-0ubuntu1~24.04.0|20240716.00-0ubuntu1~24.04.1|20241011.01-0ubuntu1~24.04.0|20250116.00-0ubuntu1~24.04.0|20250116.00-0ubuntu1~24.04.1
    fixed_versions: vers:deb/20250116.00-0ubuntu1~24.04.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-go.crypto?arch=source&distro=esm-apps/noble
    affected_versions: vers:deb/1:0.4.0-1|1:0.17.0-1|1:0.18.0-1|1:0.19.0-1
    fixed_versions: vers:deb/1:0.19.0-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-go.crypto?arch=source&distro=questing
    affected_versions: vers:deb/1:0.25.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-45337.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-45337.json
weaknesses: []
references:
  - url: https://go.dev/cl/635315
    reference_type:
    reference_id:
  - url: https://go-review.googlesource.com/c/crypto/+/635315/
    reference_type:
    reference_id:
  - url: https://groups.google.com/g/golang-announce/c/-nPEi39gI4Q/m/cGVPJCqdAQAJ
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3321
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-45337
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7839-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7839-2
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-45337
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/12/11/2
    reference_type:
    reference_id:
