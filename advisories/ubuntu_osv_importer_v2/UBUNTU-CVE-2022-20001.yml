advisory_id: UBUNTU-CVE-2022-20001
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-20001
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-20001.json
aliases:
  - CVE-2022-20001
summary: fish is a command line shell. fish version 3.1.0 through version 3.3.1 is vulnerable
  to arbitrary code execution. git repositories can contain per-repository configuration that
  change the behavior of git, including running arbitrary commands. When using the default configuration
  of fish, changing to a directory automatically runs `git` commands in order to display information
  about the current repository in the prompt. If an attacker can convince a user to change their
  current directory into one controlled by the attacker, such as on a shared file system or
  extracted archive, fish will run arbitrary commands under the attacker's control. This problem
  has been fixed in fish 3.4.0. Note that running git in these directories, including using
  the git tab completion, remains a potential trigger for this issue. As a workaround, remove
  the `fish_git_prompt` function from the prompt.
impacted_packages:
  - purl: pkg:deb/ubuntu/fish?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/3.0.2-2|3.1.0-1|3.1.0-1.1|3.1.0-1.2
    fixed_versions: vers:deb/3.1.0-1.2ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/fish?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/3.1.2-3ubuntu1|3.3.1+ds-2|3.3.1+ds-3
    fixed_versions: vers:deb/3.3.1+ds-3ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-20001.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-20001.json
weaknesses: []
references:
  - url: https://github.com/fish-shell/fish-shell/commit/37625053d424c1ab88de2b0c50c7fe71e1468e2c
    reference_type:
    reference_id:
  - url: https://github.com/fish-shell/fish-shell/pull/8589
    reference_type:
    reference_id:
  - url: https://github.com/fish-shell/fish-shell/releases/tag/3.4.0
    reference_type:
    reference_id:
  - url: https://github.com/fish-shell/fish-shell/security/advisories/GHSA-pj5f-6vxj-f5mq
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-20001
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5367-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-20001
    reference_type:
    reference_id:
