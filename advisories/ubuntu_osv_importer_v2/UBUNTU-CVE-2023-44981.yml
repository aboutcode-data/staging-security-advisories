advisory_id: UBUNTU-CVE-2023-44981
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-44981
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-44981.json
aliases:
  - CVE-2023-44981
summary: Authorization Bypass Through User-Controlled Key vulnerability in Apache ZooKeeper.
  If SASL Quorum Peer authentication is enabled in ZooKeeper (quorum.auth.enableSasl=true),
  the authorization is done by verifying that the instance part in SASL authentication ID is
  listed in zoo.cfg server list. The instance part in SASL auth ID is optional and if it's missing,
  like 'eve@EXAMPLE.COM', the authorization check will be skipped. As a result an arbitrary
  endpoint could join the cluster and begin propagating counterfeit changes to the leader, essentially
  giving it complete read-write access to the data tree. Quorum Peer authentication is not enabled
  by default. Users are recommended to upgrade to version 3.9.1, 3.8.3, 3.7.2, which fixes the
  issue. Alternately ensure the ensemble election/quorum communication is protected by a firewall
  as this will mitigate the issue. See the documentation for more details on correct cluster
  administration.
impacted_packages:
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/3.4.10-2|3.4.10-3|3.4.13-3
    fixed_versions: vers:deb/3.4.13-3ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=focal
    affected_versions: vers:deb/3.4.13-1|3.4.13-3|3.4.13-3build1|3.4.13-4|3.4.13-5|3.4.13-5build1
    fixed_versions: vers:deb/3.4.13-5ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=jammy
    affected_versions: vers:deb/3.4.13-5ubuntu4|3.4.13-6ubuntu2|3.4.13-6ubuntu3|3.4.13-6ubuntu4
    fixed_versions: vers:deb/3.4.13-6ubuntu4.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-44981.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-44981.json
weaknesses: []
references:
  - url: https://github.com/apache/zookeeper/commit/96b3172ca249a8580e9a315d589d319286cee4ee
    reference_type:
    reference_id:
  - url: https://github.com/apache/zookeeper/commit/e2070bed85d8b0c98a5a0045bf92421f473c412e
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/wf0yrk84dg1942z1o74kd8nycg6pgm5b
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-44981
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6559-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-44981
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2023/10/11/4
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/10/11/4
    reference_type:
    reference_id:
