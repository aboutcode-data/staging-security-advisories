advisory_id: UBUNTU-CVE-2022-25277
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-25277
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-25277.json
aliases:
  - CVE-2022-25277
summary: 'Drupal core sanitizes filenames with dangerous extensions upon upload (reference:
  SA-CORE-2020-012) and strips leading and trailing dots from filenames to prevent uploading
  server configuration files (reference: SA-CORE-2019-010). However, the protections for these
  two vulnerabilities previously did not work correctly together. As a result, if the site were
  configured to allow the upload of files with an htaccess extension, these files'' filenames
  would not be properly sanitized. This could allow bypassing the protections provided by Drupal
  core''s default .htaccess files and possible remote code execution on Apache web servers.
  This issue is mitigated by the fact that it requires a field administrator to explicitly configure
  a file field to allow htaccess as an extension (a restricted permission), or a contributed
  module or custom code that overrides allowed file uploads.'
impacted_packages:
  - purl: pkg:deb/ubuntu/drupal7?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/7.23-1|7.24-1|7.24-2|7.26-1|7.26-1ubuntu0.1|7.26-1ubuntu0.1+esm1|7.26-1ubuntu0.1+esm2|7.26-1ubuntu0.1+esm3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/drupal7?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/7.38-1|7.41-1|7.44-1ubuntu1~16.04.0|7.44-1ubuntu1~16.04.0+esm1|7.44-1ubuntu1~16.04.0+esm2|7.44-1ubuntu1~16.04.0+esm3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-25277.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-25277.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2022-25277
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-25277
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2022-014
    reference_type:
    reference_id:
