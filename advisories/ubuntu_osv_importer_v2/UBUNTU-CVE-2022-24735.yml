advisory_id: UBUNTU-CVE-2022-24735
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-24735
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24735.json
aliases:
  - CVE-2022-24735
summary: Redis is an in-memory database that persists on disk. By exploiting weaknesses in the
  Lua script execution environment, an attacker with access to Redis prior to version 7.0.0
  or 6.2.7 can inject Lua code that will execute with the (potentially higher) privileges of
  another Redis user. The Lua script execution environment in Redis provides some measures that
  prevent a script from creating side effects that persist and can affect the execution of the
  same, or different script, at a later time. Several weaknesses of these measures have been
  publicly known for a long time, but they had no security impact as the Redis security model
  did not endorse the concept of users or privileges. With the introduction of ACLs in Redis
  6.0, these weaknesses can be exploited by a less privileged users to inject Lua code that
  will execute at a later time, when a privileged user executes a Lua script. The problem is
  fixed in Redis versions 7.0.0 and 6.2.7. An additional workaround to mitigate this problem
  without patching the redis-server executable, if Lua scripting is not being used, is to block
  access to `SCRIPT LOAD` and `EVAL` commands using ACL rules.
impacted_packages:
  - purl: pkg:deb/ubuntu/redis?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/2:2.6.13-1|2:2.6.16-3|2:2.8.0-1|2:2.8.2-1|2:2.8.4-2|2:2.8.4-2ubuntu0.2|2:2.8.4-2ubuntu0.2+esm1|2:2.8.4-2ubuntu0.2+esm2|2:2.8.4-2ubuntu0.2+esm3|2:2.8.4-2ubuntu0.2+esm4|2:2.8.4-2ubuntu0.2+esm5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/redis?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/2:3.0.3-3|2:3.0.5-1|2:3.0.5-2|2:3.0.5-3|2:3.0.5-4|2:3.0.6-1|2:3.0.6-1ubuntu0.2|2:3.0.6-1ubuntu0.3|2:3.0.6-1ubuntu0.4|2:3.0.6-1ubuntu0.4+esm1|2:3.0.6-1ubuntu0.4+esm2|2:3.0.6-1ubuntu0.4+esm3|2:3.0.6-1ubuntu0.4+esm4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/redis?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/4:4.0.1-7|4:4.0.2-6|4:4.0.2-9|5:4.0.5-1|5:4.0.6-1|5:4.0.6-2|5:4.0.7-1|5:4.0.8-1|5:4.0.8-2|5:4.0.9-1|5:4.0.9-1ubuntu0.1|5:4.0.9-1ubuntu0.2|5:4.0.9-1ubuntu0.2+esm2|5:4.0.9-1ubuntu0.2+esm3|5:4.0.9-1ubuntu0.2+esm4|5:4.0.9-1ubuntu0.2+esm5|5:4.0.9-1ubuntu0.2+esm6
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/redis?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/5:5.0.5-2build1|5:5.0.6-1|5:5.0.7-1|5:5.0.7-2|5:5.0.7-2ubuntu0.1~esm1|5:5.0.7-2ubuntu0.1|5:5.0.7-2ubuntu0.1+esm1|5:5.0.7-2ubuntu0.1+esm2|5:5.0.7-2ubuntu0.1+esm3|5:5.0.7-2ubuntu0.1+esm4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/redis?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/5:6.0.15-1|5:6.0.16-1|5:6.0.16-1build1|5:6.0.16-1ubuntu1|5:6.0.16-1ubuntu1+esm1|5:6.0.16-1ubuntu1+esm2|5:6.0.16-1ubuntu1.1|5:6.0.16-1ubuntu1.1+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '3.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24735.json
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24735.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24735.json
weaknesses: []
references:
  - url: https://github.com/redis/redis/pull/10651
    reference_type:
    reference_id:
  - url: https://github.com/redis/redis/releases/tag/6.2.7
    reference_type:
    reference_id:
  - url: https://github.com/redis/redis/releases/tag/7.0.0
    reference_type:
    reference_id:
  - url: https://github.com/redis/redis/security/advisories/GHSA-647m-2wmq-qmvq
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-24735
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-24735
    reference_type:
    reference_id:
