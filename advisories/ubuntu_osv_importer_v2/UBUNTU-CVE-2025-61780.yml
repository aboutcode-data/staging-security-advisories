advisory_id: UBUNTU-CVE-2025-61780
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-61780
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-61780.json
aliases:
  - CVE-2025-61780
summary: 'Rack is a modular Ruby web server interface. Prior to versions 2.2.20, 3.1.18, and
  3.2.3, a possible information disclosure vulnerability existed in `Rack::Sendfile` when running
  behind a proxy that supports `x-sendfile` headers (such as Nginx). Specially crafted headers
  could cause `Rack::Sendfile` to miscommunicate with the proxy and trigger unintended internal
  requests, potentially bypassing proxy-level access restrictions. When `Rack::Sendfile` received
  untrusted `x-sendfile-type` or `x-accel-mapping` headers from a client, it would interpret
  them as proxy configuration directives. This could cause the middleware to send a "redirect"
  response to the proxy, prompting it to reissue a new internal request that was not subject
  to the proxy''s access controls. An attacker could exploit this by setting a crafted `x-sendfile-type:
  x-accel-redirect` header, setting a crafted `x-accel-mapping` header, and requesting a path
  that qualifies for proxy-based acceleration. Attackers could bypass proxy-enforced restrictions
  and access internal endpoints intended to be protected (such as administrative pages). The
  vulnerability did not allow arbitrary file reads but could expose sensitive application routes.
  This issue only affected systems meeting all of the following conditions: The application
  used `Rack::Sendfile` with a proxy that supports `x-accel-redirect` (e.g., Nginx); the proxy
  did **not** always set or remove the `x-sendfile-type` and `x-accel-mapping` headers; and
  the application exposed an endpoint that returned a body responding to `.to_path`. Users should
  upgrade to Rack versions 2.2.20, 3.1.18, or 3.2.3, which require explicit configuration to
  enable `x-accel-redirect`. Alternatively, configure the proxy to always set or strip the header,
  or in Rails applications, disable sendfile completely.'
impacted_packages:
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/1.5.2-1|1.5.2-1ubuntu0.1~esm1|1.5.2-3+deb8u3ubuntu1~esm2|1.5.2-3+deb8u3ubuntu1~esm3|1.5.2-3+deb8u3ubuntu1~esm4|1.5.2-3+deb8u3ubuntu1~esm6|1.5.2-3+deb8u3ubuntu1~esm7|1.5.2-3+deb8u3ubuntu1~esm8|1.5.2-3+deb8u3ubuntu1~esm9|1.5.2-3+deb8u3ubuntu1~esm10
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.5.2-4|1.6.4-2|1.6.4-3|1.6.4-3ubuntu0.1|1.6.4-3ubuntu0.2|1.6.4-3ubuntu0.2+esm1|1.6.4-3ubuntu0.2+esm2|1.6.4-3ubuntu0.2+esm4|1.6.4-3ubuntu0.2+esm5|1.6.4-3ubuntu0.2+esm6|1.6.4-3ubuntu0.2+esm7|1.6.4-3ubuntu0.2+esm8
    fixed_versions: vers:deb/1.6.4-3ubuntu0.2+esm9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.6.4-4|1.6.4-4ubuntu0.1|1.6.4-4ubuntu0.2|1.6.4-4ubuntu0.2+esm1|1.6.4-4ubuntu0.2+esm2|1.6.4-4ubuntu0.2+esm4|1.6.4-4ubuntu0.2+esm5|1.6.4-4ubuntu0.2+esm6|1.6.4-4ubuntu0.2+esm7|1.6.4-4ubuntu0.2+esm8
    fixed_versions: vers:deb/1.6.4-4ubuntu0.2+esm9
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/2.0.6-3|2.0.7-2|2.0.7-2ubuntu0.1|2.0.7-2ubuntu0.1+esm1|2.0.7-2ubuntu0.1+esm2|2.0.7-2ubuntu0.1+esm3|2.0.7-2ubuntu0.1+esm4|2.0.7-2ubuntu0.1+esm5|2.0.7-2ubuntu0.1+esm6|2.0.7-2ubuntu0.1+esm7
    fixed_versions: vers:deb/2.0.7-2ubuntu0.1+esm8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=jammy
    affected_versions: vers:deb/2.1.4-3|2.1.4-4|2.1.4-5|2.1.4-5ubuntu1|2.1.4-5ubuntu1.1
    fixed_versions: vers:deb/2.1.4-5ubuntu1.2
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=noble
    affected_versions: vers:deb/2.2.4-3|2.2.7-1|2.2.7-1ubuntu0.1|2.2.7-1ubuntu0.2|2.2.7-1ubuntu0.3|2.2.7-1ubuntu0.4
    fixed_versions: vers:deb/2.2.7-1ubuntu0.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/ruby-rack?arch=source&distro=questing
    affected_versions: vers:deb/2.2.7-1.1|3.1.16-0.1
    fixed_versions: vers:deb/3.1.16-0.1ubuntu0.1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-61780.json
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-61780.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-61780.json
weaknesses: []
references:
  - url: https://github.com/rack/rack/commit/57277b7741581fa827472c5c666f6e6a33abd784
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/7e69f65eefe9cd2868df9f9f3b0977b86f93523a
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/fba2c8bc63eb787ff4b19bc612d315fda6126d85
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/security/advisories/GHSA-r657-rxjc-j557
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-61780
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7960-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-61780
    reference_type:
    reference_id:
