advisory_id: UBUNTU-CVE-2019-12520
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2019-12520
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-12520.json
aliases:
  - CVE-2019-12520
summary: An issue was discovered in Squid through 4.7 and 5. When receiving a request, Squid
  checks its cache to see if it can serve up a response. It does this by making a MD5 hash of
  the absolute URL of the request. If found, it servers the request. The absolute URL can include
  the decoded UserInfo (username and password) for certain protocols. This decoded info is prepended
  to the domain. This allows an attacker to provide a username that has special characters to
  delimit the domain, and treat the rest of the URL as a path or query string. An attacker could
  first make a request to their domain using an encoded username, then when a request for the
  target domain comes in that decodes to the exact URL, it will serve the attacker's HTML instead
  of the real HTML. On Squid servers that also act as reverse proxies, this allows an attacker
  to gain access to features that only reverse proxies can use, such as ESI.
impacted_packages:
  - purl: pkg:deb/ubuntu/squid3?arch=source&distro=bionic
    affected_versions: vers:deb/3.5.23-5ubuntu1|3.5.23-5ubuntu2|3.5.27-1ubuntu1|3.5.27-1ubuntu1.1|3.5.27-1ubuntu1.2|3.5.27-1ubuntu1.3|3.5.27-1ubuntu1.4|3.5.27-1ubuntu1.5|3.5.27-1ubuntu1.6
    fixed_versions: vers:deb/3.5.27-1ubuntu1.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-12520.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2019/UBUNTU-CVE-2019-12520.json
weaknesses: []
references:
  - url: https://github.com/squid-cache/squid/commits/v4
    reference_type:
    reference_id:
  - url: https://gitlab.com/jeriko.one/security/-/blob/master/squid/CVEs/CVE-2019-12520.txt
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2019-12520
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4446-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2019-12520
    reference_type:
    reference_id:
  - url: http://www.squid-cache.org/Advisories/SQUID-2019_4.txt
    reference_type:
    reference_id:
  - url: http://www.squid-cache.org/Versions/v4/
    reference_type:
    reference_id:
  - url: http://www.squid-cache.org/Versions/v4/changesets/
    reference_type:
    reference_id:
