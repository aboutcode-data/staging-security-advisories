advisory_id: UBUNTU-CVE-2020-11013
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2020-11013
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2020/UBUNTU-CVE-2020-11013.json
aliases:
  - CVE-2020-11013
summary: Their is an information disclosure vulnerability in Helm from version 3.1.0 and before
  version 3.2.0. `lookup` is a Helm template function introduced in Helm v3. It is able to lookup
  resources in the cluster to check for the existence of specific resources and get details
  about them. This can be used as part of the process to render templates. The documented behavior
  of `helm template` states that it does not attach to a remote cluster. However, a the recently
  added `lookup` template function circumvents this restriction and connects to the cluster
  even during `helm template` and `helm install|update|delete|rollback --dry-run`. The user
  is not notified of this behavior. Running `helm template` should not make calls to a cluster.
  This is different from `install`, which is presumed to have access to a cluster in order to
  load resources into Kubernetes. Helm 2 is unaffected by this vulnerability. A malicious chart
  author could inject a `lookup` into a chart that, when rendered through `helm template`, performs
  unannounced lookups against the cluster a user&#39;s `KUBECONFIG` file points to. This information
  can then be disclosed via the output of `helm template`. This issue has been fixed in Helm
  3.2.0
impacted_packages:
  - purl: pkg:deb/ubuntu/helm?arch=source&distro=xenial
    affected_versions: vers:deb/1.9.1-1|1.9.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/helm?arch=source&distro=bionic
    affected_versions: vers:deb/2.8.2-1|2.8.5-1|2.8.6-1|2.8.7-1|2.8.8-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/helm?arch=source&distro=focal
    affected_versions: vers:deb/3.2-1|3.5.0-3|3.6.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/helm?arch=source&distro=jammy
    affected_versions: vers:deb/3.7.0-2|3.8.0-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/helm?arch=source&distro=noble
    affected_versions: vers:deb/3.8.4-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/helm?arch=source&distro=questing
    affected_versions: vers:deb/3.8.4-2|4.0.3-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2020/UBUNTU-CVE-2020-11013.json
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2020/UBUNTU-CVE-2020-11013.json
  - score: low
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2020/UBUNTU-CVE-2020-11013.json
weaknesses: []
references:
  - url: https://github.com/helm/helm/releases/tag/v3.2.0
    reference_type:
    reference_id:
  - url: https://github.com/helm/helm/security/advisories/GHSA-q8q8-93cv-v6h8
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2020-11013
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2020-11013
    reference_type:
    reference_id:
