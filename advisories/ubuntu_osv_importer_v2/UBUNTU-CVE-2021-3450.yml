advisory_id: UBUNTU-CVE-2021-3450
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-3450
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-3450.json
aliases:
  - CVE-2021-3450
summary: The X509_V_FLAG_X509_STRICT flag enables additional security checks of the certificates
  present in a certificate chain. It is not set by default. Starting from OpenSSL version 1.1.1h
  a check to disallow certificates in the chain that have explicitly encoded elliptic curve
  parameters was added as an additional strict check. An error in the implementation of this
  check meant that the result of a previous check to confirm that certificates in the chain
  are valid CA certificates was overwritten. This effectively bypasses the check that non-CA
  certificates must not be able to issue other certificates. If a "purpose" has been configured
  then there is a subsequent opportunity for checks that the certificate is a valid CA. All
  of the named "purpose" values implemented in libcrypto perform this check. Therefore, where
  a purpose is set the certificate chain will still be rejected even when the strict flag has
  been used. A purpose is set by default in libssl client and server certificate verification
  routines, but it can be overridden or removed by an application. In order to be affected,
  an application must explicitly set the X509_V_FLAG_X509_STRICT verification flag and either
  not set a purpose for the certificate verification or, in the case of TLS client or server
  applications, override the default purpose. OpenSSL versions 1.1.1h and newer are affected
  by this issue. Users of these versions should upgrade to OpenSSL 1.1.1k. OpenSSL 1.0.2 is
  not impacted by this issue. Fixed in OpenSSL 1.1.1k (Affected 1.1.1h-1.1.1j).
impacted_packages:
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=xenial
    affected_versions: vers:deb/1.0.2d-0ubuntu1|1.0.2d-0ubuntu2|1.0.2e-1ubuntu1|1.0.2f-2ubuntu1|1.0.2g-1ubuntu2|1.0.2g-1ubuntu3|1.0.2g-1ubuntu4|1.0.2g-1ubuntu4.1|1.0.2g-1ubuntu4.2|1.0.2g-1ubuntu4.4|1.0.2g-1ubuntu4.5|1.0.2g-1ubuntu4.6|1.0.2g-1ubuntu4.8|1.0.2g-1ubuntu4.9|1.0.2g-1ubuntu4.10|1.0.2g-1ubuntu4.11|1.0.2g-1ubuntu4.12|1.0.2g-1ubuntu4.13|1.0.2g-1ubuntu4.14|1.0.2g-1ubuntu4.15|1.0.2g-1ubuntu4.16|1.0.2g-1ubuntu4.17|1.0.2g-1ubuntu4.18
    fixed_versions: vers:deb/1.0.2g-1ubuntu4.19
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=bionic
    affected_versions: vers:deb/1.0.2g-1ubuntu13|1.0.2g-1ubuntu14|1.0.2n-1ubuntu1|1.1.0g-2ubuntu1|1.1.0g-2ubuntu2|1.1.0g-2ubuntu3|1.1.0g-2ubuntu4|1.1.0g-2ubuntu4.1|1.1.0g-2ubuntu4.3|1.1.1-1ubuntu2.1~18.04.1|1.1.1-1ubuntu2.1~18.04.2|1.1.1-1ubuntu2.1~18.04.3|1.1.1-1ubuntu2.1~18.04.4|1.1.1-1ubuntu2.1~18.04.5|1.1.1-1ubuntu2.1~18.04.6|1.1.1-1ubuntu2.1~18.04.7
    fixed_versions: vers:deb/1.1.1-1ubuntu2.1~18.04.8
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl1.0?arch=source&distro=bionic
    affected_versions: vers:deb/1.0.2n-1ubuntu2|1.0.2n-1ubuntu3|1.0.2n-1ubuntu4|1.0.2n-1ubuntu5|1.0.2n-1ubuntu5.1|1.0.2n-1ubuntu5.2|1.0.2n-1ubuntu5.3|1.0.2n-1ubuntu5.4|1.0.2n-1ubuntu5.5
    fixed_versions: vers:deb/1.0.2n-1ubuntu5.6
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openssl?arch=source&distro=focal
    affected_versions: vers:deb/1.1.1c-1ubuntu4|1.1.1d-2ubuntu3|1.1.1d-2ubuntu6|1.1.1f-1ubuntu1|1.1.1f-1ubuntu2|1.1.1f-1ubuntu2.1
    fixed_versions: vers:deb/1.1.1f-1ubuntu2.2
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-3450.json
  - score: high
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-3450.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2021-3450
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-3450
    reference_type:
    reference_id:
  - url: https://www.openssl.org/news/secadv/20210325.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
