advisory_id: UBUNTU-CVE-2023-22491
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-22491
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-22491.json
aliases:
  - CVE-2023-22491
summary: Gatsby is a free and open source framework based on React that helps developers build
  websites and apps. The gatsby-transformer-remark plugin prior to versions 5.25.1 and 6.3.2
  passes input through to the `gray-matter` npm package, which is vulnerable to JavaScript injection
  in its default configuration, unless input is sanitized.  The vulnerability is present in
  gatsby-transformer-remark when passing input in data mode (querying MarkdownRemark nodes via
  GraphQL).  Injected JavaScript executes in the context of the build server. To exploit this
  vulnerability untrusted/unsanitized input would need to be sourced by or added into a file
  processed by gatsby-transformer-remark. A patch has been introduced in `gatsby-transformer-remark@5.25.1`
  and `gatsby-transformer-remark@6.3.2` which mitigates the issue by disabling the `gray-matter`
  JavaScript Frontmatter engine. As a workaround, if an older version of `gatsby-transformer-remark`
  must be used, input passed into the plugin should be sanitized ahead of processing. It is
  encouraged for  projects to upgrade to the latest major release branch for all Gatsby plugins
  to ensure the latest security updates and bug fixes are received in a timely manner.
impacted_packages:
  - purl: pkg:deb/ubuntu/react?arch=source&distro=bionic
    affected_versions: vers:deb/1.2.0-3|1.2.0-3build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/react?arch=source&distro=focal
    affected_versions: vers:deb/1.2.0-3build2|1.2.1-1build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/react?arch=source&distro=jammy
    affected_versions: vers:deb/1.2.1-1build2|1.2.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/react?arch=source&distro=noble
    affected_versions: vers:deb/1.2.2-1|1.2.2-1build2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/react?arch=source&distro=questing
    affected_versions: vers:deb/1.2.2-1build4|1.2.2-1build5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/react?arch=source&distro=xenial
    affected_versions: vers:deb/0.9.4-3|1.2.0-2build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-22491.json
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-22491.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-22491.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2023-22491
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-22491
    reference_type:
    reference_id:
