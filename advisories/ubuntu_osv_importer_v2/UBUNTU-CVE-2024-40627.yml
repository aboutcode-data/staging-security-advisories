advisory_id: UBUNTU-CVE-2024-40627
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-40627
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-40627.json
aliases:
  - CVE-2024-40627
summary: Fastapi OPA is an opensource fastapi middleware which includes auth flow. HTTP `OPTIONS`
  requests are always allowed by `OpaMiddleware`, even when they lack authentication, and are
  passed through directly to the application. `OpaMiddleware` allows all HTTP `OPTIONS` requests
  without evaluating it against any policy. If an application provides different responses to
  HTTP `OPTIONS` requests based on an entity existing (such as to indicate whether an entity
  is writable on a system level), an unauthenticated attacker could discover which entities
  exist within an application. This issue has been addressed in release version 2.0.1. All users
  are advised to upgrade. There are no known workarounds for this vulnerability.
impacted_packages:
  - purl: pkg:deb/ubuntu/fastapi?arch=source&distro=jammy
    affected_versions: vers:deb/0.63.0-2|0.63.0-2ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/fastapi?arch=source&distro=noble
    affected_versions: vers:deb/0.101.0-1|0.101.0-2|0.101.0-3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/fastapi?arch=source&distro=questing
    affected_versions: vers:deb/0.115.11-3|0.115.11-4ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-40627.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-40627.json
weaknesses: []
references:
  - url: https://github.com/busykoala/fastapi-opa/blob/6dd6f8c87e908fe080784a74707f016f1422b58a/fastapi_opa/opa/opa_middleware.py#L79-L80
    reference_type:
    reference_id:
  - url: https://github.com/busykoala/fastapi-opa/commit/9588109ff651f7ffc92687129c4956126443fb8c
    reference_type:
    reference_id:
  - url: https://github.com/busykoala/fastapi-opa/security/advisories/GHSA-5f5c-8rvc-j8wf
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-40627
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-40627
    reference_type:
    reference_id:
