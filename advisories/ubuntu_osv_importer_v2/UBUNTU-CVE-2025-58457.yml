advisory_id: UBUNTU-CVE-2025-58457
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-58457
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-58457.json
aliases:
  - CVE-2025-58457
summary: 'Improper permission check in ZooKeeper AdminServer lets authorized clients to run
  snapshot and restore command with insufficient permissions. This issue affects Apache ZooKeeper:
  from 3.9.0 before 3.9.4. Users are recommended to upgrade to version 3.9.4, which fixes the
  issue. The issue can be mitigated by disabling both commands (via admin.snapshot.enabled and
  admin.restore.enabled), disabling the whole AdminServer interface (via admin.enableServer),
  or ensuring that the root ACL does not provide open permissions. (Note that ZooKeeper ACLs
  are not recursive, so this does not impact operations on child nodes besides notifications
  from recursive watches.)'
impacted_packages:
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=esm-infra-legacy/trusty
    affected_versions: vers:deb/3.4.5+dfsg-1|3.4.5+dfsg-1ubuntu0.1~esm1|3.4.5+dfsg-1ubuntu0.1~esm3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/3.4.6-8|3.4.7-1|3.4.8-1|3.4.8-1ubuntu0.1~esm1|3.4.8-1ubuntu0.1~esm2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/3.4.10-2|3.4.10-3|3.4.13-3|3.4.13-3ubuntu0.1~esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=focal
    affected_versions: vers:deb/3.4.13-1|3.4.13-3|3.4.13-3build1|3.4.13-4|3.4.13-5|3.4.13-5build1|3.4.13-5ubuntu0.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=jammy
    affected_versions: vers:deb/3.4.13-5ubuntu4|3.4.13-6ubuntu2|3.4.13-6ubuntu3|3.4.13-6ubuntu4|3.4.13-6ubuntu4.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=noble
    affected_versions: vers:deb/3.8.0-11|3.9.1-1|3.9.1-1build1|3.9.1-1build2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/zookeeper?arch=source&distro=questing
    affected_versions: vers:deb/3.9.3-1build1|3.9.3-1build2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-58457.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-58457.json
weaknesses: []
references:
  - url: https://issues.apache.org/jira/browse/ZOOKEEPER-4964
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/r5yol0kkhx2fzw22pxk1ozwm3oc6yxrx
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-58457
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-58457
    reference_type:
    reference_id:
