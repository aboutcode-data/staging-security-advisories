advisory_id: UBUNTU-CVE-2023-35947
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-35947
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35947.json
aliases:
  - CVE-2023-35947
summary: 'Gradle is a build tool with a focus on build automation and support for multi-language
  development. In affected versions when unpacking Tar archives, Gradle did not check that files
  could be written outside of the unpack location. This could lead to important files being
  overwritten anywhere the Gradle process has write permissions. For a build reading Tar entries
  from a Tar archive, this issue could allow Gradle to disclose information from sensitive files
  through an arbitrary file read. To exploit this behavior, an attacker needs to either control
  the source of an archive already used by the build or modify the build to interact with a
  malicious archive. It is unlikely that this would go unnoticed. A fix has been released in
  Gradle 7.6.2 and 8.2 to protect against this vulnerability. Starting from these versions,
  Gradle will refuse to handle Tar archives which contain path traversal elements in a Tar entry
  name. Users are advised to upgrade. There are no known workarounds for this vulnerability.
  ### Impact This is a path traversal vulnerability when Gradle deals with Tar archives, often
  referenced as TarSlip, a variant of ZipSlip. * When unpacking Tar archives, Gradle did not
  check that files could be written outside of the unpack location. This could lead to important
  files being overwritten anywhere the Gradle process has write permissions. * For a build reading
  Tar entries from a Tar archive, this issue could allow Gradle to disclose information from
  sensitive files through an arbitrary file read. To exploit this behavior, an attacker needs
  to either control the source of an archive already used by the build or modify the build to
  interact with a malicious archive. It is unlikely that this would go unnoticed. Gradle uses
  Tar archives for its [Build Cache](https://docs.gradle.org/current/userguide/build_cache.html).
  These archives are safe when created by Gradle. But if an attacker had control of a remote
  build cache server, they could inject malicious build cache entries that leverage this vulnerability.
  This attack vector could also be exploited if a man-in-the-middle can be performed between
  the remote cache and the build. ### Patches A fix has been released in Gradle 7.6.2 and 8.2
  to protect against this vulnerability. Starting from these versions, Gradle will refuse to
  handle Tar archives which contain path traversal elements in a Tar entry name. It is recommended
  that users upgrade to a patched version. ### Workarounds There is no workaround. * If your
  build deals with Tar archives that you do not fully trust, you need to inspect them to confirm
  they do not attempt to leverage this vulnerability. * If you use the Gradle remote build cache,
  make sure only trusted parties have write access to it and that connections to the remote
  cache are properly secured. ### References * [CWE-22: Improper Limitation of a Pathname to
  a Restricted Directory (''Path Traversal'')](https://cwe.mitre.org/data/definitions/22.html)
  * [Gradle Build Cache](https://docs.gradle.org/current/userguide/build_cache.html) * [ZipSlip](https://security.snyk.io/research/zip-slip-vulnerability)'
impacted_packages:
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=xenial
    affected_versions: vers:deb/2.5-3|2.7-1|2.7-2|2.7-3|2.10-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/3.2.1-3build2|3.2.1-4|3.2.1-5|3.4.1-4|3.4.1-6|3.4.1-7ubuntu1|4.4.1-5ubuntu2~18.04|4.4.1-5ubuntu2~18.04+esm1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=focal
    affected_versions: vers:deb/4.4.1-8|4.4.1-9|4.4.1-10
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=jammy
    affected_versions: vers:deb/4.4.1-13
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=noble
    affected_versions: vers:deb/4.4.1-18|4.4.1-20
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/gradle?arch=source&distro=questing
    affected_versions: vers:deb/4.4.1-22
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:L/I:H/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35947.json
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35947.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-35947.json
weaknesses: []
references:
  - url: https://github.com/gradle/gradle/commit/1096b309520a8c315e3b6109a6526de4eabcb879
    reference_type:
    reference_id:
  - url: https://github.com/gradle/gradle/commit/2e5c34d57d0c0b7f0e8b039a192b91e5c8249d91
    reference_type:
    reference_id:
  - url: https://github.com/gradle/gradle/security/advisories/GHSA-84mw-qh6q-v842
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-35947
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-35947
    reference_type:
    reference_id:
