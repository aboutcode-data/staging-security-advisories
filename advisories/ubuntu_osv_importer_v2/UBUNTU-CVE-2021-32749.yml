advisory_id: UBUNTU-CVE-2021-32749
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2021-32749
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32749.json
aliases:
  - CVE-2021-32749
summary: fail2ban is a daemon to ban hosts that cause multiple authentication errors. In versions
  0.9.7 and prior, 0.10.0 through 0.10.6, and 0.11.0 through 0.11.2, there is a vulnerability
  that leads to possible remote code execution in the mailing action mail-whois. Command `mail`
  from mailutils package used in mail actions like `mail-whois` can execute command if unescaped
  sequences (`\n~`) are available in "foreign" input (for instance in whois output). To exploit
  the vulnerability, an attacker would need to insert malicious characters into the response
  sent by the whois server, either via a MITM attack or by taking over a whois server. The issue
  is patched in versions 0.10.7 and 0.11.3. As a workaround, one may avoid the usage of action
  `mail-whois` or patch the vulnerability manually.
impacted_packages:
  - purl: pkg:deb/ubuntu/fail2ban?arch=source&distro=trusty/esm
    affected_versions: vers:deb/0.8.10-3|0.8.11~pre1+git29-gccd2657-1|0.8.11-1
    fixed_versions: vers:deb/0.8.11-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/fail2ban?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/0.9.3-1
    fixed_versions: vers:deb/0.9.3-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/fail2ban?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/0.9.7-2|0.10.2-1|0.10.2-2
    fixed_versions: vers:deb/0.10.2-2ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/fail2ban?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/0.10.2-2.1|0.11.1-1
    fixed_versions: vers:deb/0.11.1-1ubuntu0.1~esm1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32749.json
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32749.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2021/UBUNTU-CVE-2021-32749.json
weaknesses: []
references:
  - url: https://github.com/fail2ban/fail2ban/commit/2ed414ed09b3bb4c478abc9366a1ff22024a33c9
    reference_type:
    reference_id:
  - url: https://github.com/fail2ban/fail2ban/commit/410a6ce5c80dd981c22752da034f2529b5eee844
    reference_type:
    reference_id:
  - url: https://github.com/fail2ban/fail2ban/security/advisories/GHSA-m985-3f3v-cwmm
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2021-32749
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5232-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2021-32749
    reference_type:
    reference_id:
