advisory_id: UBUNTU-CVE-2023-33953
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-33953
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-33953.json
aliases:
  - CVE-2023-33953
summary: 'gRPC contains a vulnerability that allows hpack table accounting errors could lead
  to unwanted disconnects between clients and servers in exceptional cases/ Three vectors were
  found that allow the following DOS attacks: - Unbounded memory buffering in the HPACK parser
  - Unbounded CPU consumption in the HPACK parser The unbounded CPU consumption is down to a
  copy that occurred per-input-block in the parser, and because that could be unbounded due
  to the memory copy bug we end up with an O(n^2) parsing loop, with n selected by the client.
  The unbounded memory buffering bugs: - The header size limit check was behind the string reading
  code, so we needed to first buffer up to a 4 gigabyte string before rejecting it as longer
  than 8 or 16kb. - HPACK varints have an encoding quirk whereby an infinite number of 0’s can
  be added at the start of an integer. gRPC’s hpack parser needed to read all of them before
  concluding a parse. - gRPC’s metadata overflow check was performed per frame, so that the
  following sequence of frames could cause infinite buffering: HEADERS: containing a: 1 CONTINUATION:
  containing a: 2 CONTINUATION: containing a: 3 etc…'
impacted_packages:
  - purl: pkg:deb/ubuntu/grpc?arch=source&distro=xenial
    affected_versions: vers:deb/0.10.2-1|0.11.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/grpc?arch=source&distro=bionic
    affected_versions: vers:deb/1.3.2-1|1.3.2-1ubuntu1|1.3.2-1.1~build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/grpc?arch=source&distro=focal
    affected_versions: vers:deb/1.16.1-1|1.16.1-1ubuntu1|1.16.1-1ubuntu3|1.16.1-1ubuntu4|1.16.1-1ubuntu5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/grpc?arch=source&distro=jammy
    affected_versions: vers:deb/1.30.2-3|1.30.2-3build1|1.30.2-3build3|1.30.2-3build5|1.30.2-3build6
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/grpc?arch=source&distro=noble
    affected_versions: vers:deb/1.51.1-3build3|1.51.1-3build4|1.51.1-4|1.51.1-4build1|1.51.1-4build2|1.51.1-4.1build3|1.51.1-4.1build4|1.51.1-4.1build5
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/grpc?arch=source&distro=questing
    affected_versions: vers:deb/1.51.1-6|1.51.1-6build1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-33953.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-33953.json
weaknesses: []
references:
  - url: https://cloud.google.com/support/bulletins#gcp-2023-022
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2023-33953
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-33953
    reference_type:
    reference_id:
