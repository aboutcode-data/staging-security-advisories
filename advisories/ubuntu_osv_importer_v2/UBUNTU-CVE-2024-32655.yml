advisory_id: UBUNTU-CVE-2024-32655
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-32655
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-32655.json
aliases:
  - CVE-2024-32655
summary: Npgsql is the .NET data provider for PostgreSQL. The `WriteBind()` method in `src/Npgsql/Internal/NpgsqlConnector.FrontendMessages.cs`
  uses `int` variables to store the message length and the sum of parameter lengths. Both variables
  overflow when the sum of parameter lengths becomes too large. This causes Npgsql to write
  a message size that is too small when constructing a Postgres protocol message to send it
  over the network to the database. When parsing the message, the database will only read a
  small number of bytes and treat any following bytes as new messages while they belong to the
  old message. Attackers can abuse this to inject arbitrary Postgres protocol messages into
  the connection, leading to the execution of arbitrary SQL statements on the application's
  behalf. This vulnerability is fixed in 4.0.14, 4.1.13, 5.0.18, 6.0.11, 7.0.7, and 8.0.3.
impacted_packages:
  - purl: pkg:deb/ubuntu/npgsql?arch=source&distro=xenial
    affected_versions: vers:deb/2.2.7+dfsg3-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/npgsql?arch=source&distro=bionic
    affected_versions: vers:deb/2.2.7+dfsg3-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/npgsql?arch=source&distro=focal
    affected_versions: vers:deb/2.2.7+dfsg3-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/npgsql?arch=source&distro=jammy
    affected_versions: vers:deb/2.2.7+dfsg3-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/npgsql?arch=source&distro=noble
    affected_versions: vers:deb/2.2.7+dfsg3-1.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-32655.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-32655.json
weaknesses: []
references:
  - url: https://github.com/npgsql/npgsql/commit/f7e7ead0702d776a8f551f5786c4cac2d65c4bc6
    reference_type:
    reference_id:
  - url: https://github.com/npgsql/npgsql/security/advisories/GHSA-x9vc-6hfv-hg8c
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-32655
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-32655
    reference_type:
    reference_id:
