advisory_id: UBUNTU-CVE-2023-46841
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2023-46841
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-46841.json
aliases:
  - CVE-2023-46841
summary: 'Recent x86 CPUs offer functionality named Control-flow Enforcement Technology (CET).  A
  sub-feature of this are Shadow Stacks (CET-SS). CET-SS is a hardware feature designed to protect
  against Return Oriented Programming attacks. When enabled, traditional stacks holding both
  data and return addresses are accompanied by so called "shadow stacks", holding little more
  than return addresses.  Shadow stacks aren''t writable by normal instructions, and upon function
  returns their contents are used to check for possible manipulation of a return address coming
  from the traditional stack. In particular certain memory accesses need intercepting by Xen.  In
  various cases the necessary emulation involves kind of replaying of the instruction.  Such
  replaying typically involves filling and then invoking of a stub.  Such a replayed instruction
  may raise an exceptions, which is expected and dealt with accordingly. Unfortunately the interaction
  of both of the above wasn''t right: Recovery involves removal of a call frame from the (traditional)
  stack. The counterpart of this operation for the shadow stack was missing.'
impacted_packages:
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=xenial
    affected_versions: vers:deb/4.5.1-0ubuntu1|4.5.1-0ubuntu2|4.6.0-1ubuntu1|4.6.0-1ubuntu2|4.6.0-1ubuntu4|4.6.0-1ubuntu4.1|4.6.0-1ubuntu4.2|4.6.0-1ubuntu4.3|4.6.5-0ubuntu1|4.6.5-0ubuntu1.1|4.6.5-0ubuntu1.2|4.6.5-0ubuntu1.4
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=bionic
    affected_versions: vers:deb/4.9.0-0ubuntu3|4.9.0-0ubuntu4|4.9.2-0ubuntu1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=focal
    affected_versions: vers:deb/4.9.2-0ubuntu2|4.9.2-0ubuntu6|4.9.2-0ubuntu7|4.11.3+24-g14b62ab3e5-1ubuntu1|4.11.3+24-g14b62ab3e5-1ubuntu2|4.11.3+24-g14b62ab3e5-1ubuntu2.2|4.11.3+24-g14b62ab3e5-1ubuntu2.3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=jammy
    affected_versions: vers:deb/4.11.4+24-gddaaccbbab-1ubuntu2|4.16.0-1~ubuntu2|4.16.0-1~ubuntu2.1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=noble
    affected_versions: vers:deb/4.17.2-1|4.17.2+55-g0b56bed864-1|4.17.2+76-ge1f9cb16e2-1|4.17.2+76-ge1f9cb16e2-1ubuntu1|4.17.3+10-g091466ba55-1|4.17.3+10-g091466ba55-1.1ubuntu2|4.17.3+10-g091466ba55-1.1ubuntu3
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=questing
    affected_versions: vers:deb/4.20.0-1ubuntu1|4.20.0+68-g35cb38b222-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-46841.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2023/UBUNTU-CVE-2023-46841.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2023-46841
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2023-46841
    reference_type:
    reference_id:
  - url: https://xenbits.xen.org/xsa/advisory-451.html
    reference_type:
    reference_id:
