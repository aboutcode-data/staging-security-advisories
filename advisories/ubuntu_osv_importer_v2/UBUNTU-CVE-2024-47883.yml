advisory_id: UBUNTU-CVE-2024-47883
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-47883
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-47883.json
aliases:
  - CVE-2024-47883
summary: 'The OpenRefine fork of the MIT Simile Butterfly server is a modular web application
  framework. The Butterfly framework uses the `java.net.URL` class to refer to (what are expected
  to be) local resource files, like images or templates. This works: "opening a connection"
  to these URLs opens the local file. However, prior to version 1.2.6, if a `file:/` URL is
  directly given where a relative path (resource name) is expected, this is also accepted in
  some code paths; the app then fetches the file, from a remote machine if indicated, and uses
  it as if it was a trusted part of the app''s codebase. This leads to multiple weaknesses and
  potential weaknesses. An attacker that has network access to the application could use it
  to gain access to files, either on the the server''s filesystem (path traversal) or shared
  by nearby machines (server-side request forgery with e.g. SMB). An attacker that can lead
  or redirect a user to a crafted URL belonging to the app could cause arbitrary attacker-controlled
  JavaScript to be loaded in the victim''s browser (cross-site scripting). If an app is written
  in such a way that an attacker can influence the resource name used for a template, that attacker
  could cause the app to fetch and execute an attacker-controlled template (remote code execution).
  Version 1.2.6 contains a patch.'
impacted_packages:
  - purl: pkg:deb/ubuntu/openrefine-butterfly?arch=source&distro=jammy
    affected_versions: vers:deb/1.1.1-2|1.2.0-1|1.2.3-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/openrefine-butterfly?arch=source&distro=noble
    affected_versions: vers:deb/1.2.4-1|1.2.5-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-47883.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-47883.json
weaknesses: []
references:
  - url: https://github.com/OpenRefine/simile-butterfly/security/advisories/GHSA-3p8v-w8mr-m3x8
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-47883
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-47883
    reference_type:
    reference_id:
