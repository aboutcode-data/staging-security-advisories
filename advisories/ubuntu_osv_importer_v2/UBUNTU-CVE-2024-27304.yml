advisory_id: UBUNTU-CVE-2024-27304
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2024-27304
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-27304.json
aliases:
  - CVE-2024-27304
summary: pgx is a PostgreSQL driver and toolkit for Go. SQL injection can occur if an attacker
  can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the
  calculated message size can cause the one large message to be sent as multiple messages under
  the attacker's control. The problem is resolved in v4.18.2 and v5.5.4. As a workaround, reject
  user input large enough to cause a single query or bind message to exceed 4 GB in size.
impacted_packages:
  - purl: pkg:deb/ubuntu/golang-github-jackc-pgx?arch=source&distro=jammy
    affected_versions: vers:deb/3.6.2-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-jackc-pgproto3?arch=source&distro=noble
    affected_versions: vers:deb/2.2.0-2|2.3.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-jackc-pgx?arch=source&distro=noble
    affected_versions: vers:deb/4.15.0-4|4.18.1-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-jackc-pgproto3?arch=source&distro=questing
    affected_versions: vers:deb/2.3.2-1
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/golang-github-jackc-pgx?arch=source&distro=questing
    affected_versions: vers:deb/4.18.1-1|4.18.1-2
    fixed_versions:
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-27304.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2024/UBUNTU-CVE-2024-27304.json
weaknesses: []
references:
  - url: https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2024-27304
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2024-27304
    reference_type:
    reference_id:
