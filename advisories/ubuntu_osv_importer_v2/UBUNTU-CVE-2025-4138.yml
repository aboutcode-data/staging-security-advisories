advisory_id: UBUNTU-CVE-2025-4138
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2025-4138
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-4138.json
aliases:
  - CVE-2025-4138
summary: Allows the extraction filter to be ignored, allowing symlink targets to point outside
  the destination directory, and the modification of some file metadata. You are affected by
  this vulnerability if using the tarfile module to extract untrusted tar archives using TarFile.extractall() or
  TarFile.extract() using the filter= parameter with a value of "data" or "tar". See the tarfile  extraction
  filters documentation https://docs.python.org/3/library/tarfile.html#tarfile-extraction-filter
   for more information. Note that for Python 3.14 or later the default value of filter= changed
  from "no filtering" to `"data", so if you are relying on this new default behavior then your
  usage is also affected. Note that none of these vulnerabilities significantly affect the installation
  of source distributions which are tar archives as source distributions already allow arbitrary
  code execution during the build process. However when evaluating source distributions it's
  important to avoid installing source distributions with suspicious links.
impacted_packages:
  - purl: pkg:deb/ubuntu/python3.12?arch=source&distro=noble
    affected_versions: vers:deb/3.12.0-1|3.12.0-5|3.12.0-6|3.12.0-7|3.12.1-2|3.12.2-1|3.12.2-4build3|3.12.2-4build4|3.12.2-5ubuntu3|3.12.3-1|3.12.3-1ubuntu0.1|3.12.3-1ubuntu0.2|3.12.3-1ubuntu0.3|3.12.3-1ubuntu0.4|3.12.3-1ubuntu0.5|3.12.3-1ubuntu0.6
    fixed_versions: vers:deb/3.12.3-1ubuntu0.7
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:deb/ubuntu/python3.14?arch=source&distro=questing
    affected_versions: vers:deb/3.14.0~a7-0ubuntu1|3.14.0~b1-1|3.14.0~b3-1|3.14.0~rc1-1|3.14.0~rc2-1|3.14.0~rc3-1
    fixed_versions: vers:deb/3.14.0-1
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-4138.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2025/UBUNTU-CVE-2025-4138.json
weaknesses: []
references:
  - url: https://gist.github.com/sethmlarson/52398e33eff261329a0180ac1d54f42f
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/19de092debb3d7e832e5672cc2f7b788d35951da
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/28463dba112af719df1e8b0391c46787ad756dd9
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/3612d8f51741b11f36f8fb0494d79086bac9390a
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/4633f3f497b1ff70e4a35b6fe2c907cbe2d4cb2e
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/98016f7c92aa4c1232c68bac1ed6646db31782ec
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/9e0ac76d96cf80b49055f6d6b9a6763fb9215c2a
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/aa9eb5f757ceff461e6e996f12c89e5d9b583b01
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/issues/135034
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/pull/135037
    reference_type:
    reference_id:
  - url: https://mail.python.org/archives/list/security-announce@python.org/thread/MAXIJJCUUMCL7ATZNDVEGGHUMQMUUKLG/
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2025-4138
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-7583-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2025-4138
    reference_type:
    reference_id:
