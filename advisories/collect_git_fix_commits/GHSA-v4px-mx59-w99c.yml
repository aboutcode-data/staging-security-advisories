advisory_id: GHSA-v4px-mx59-w99c
datasource_id: collect_git_fix_commits/GHSA-v4px-mx59-w99c
datasource_url: https://github.com/git/git
aliases: []
summary: "aae9560a355d4ab91385e49eae62fade2ddd27ef:Work around Tcl's default `PATH` lookup\n\
  \nAs per https://www.tcl.tk/man/tcl8.6/TclCmd/exec.html#M23, Tcl's `exec`\nfunction goes out\
  \ of its way to imitate the highly dangerous path lookup\nof `cmd.exe`, but _of course_ only\
  \ on Windows:\n\n\tIf a directory name was not specified as part of the application\n\tname,\
  \ the following directories are automatically searched in\n\torder when attempting to locate\
  \ the application:\n\n\t    The directory from which the Tcl executable was loaded.\n\n\t\
  \    The current directory.\n\n\t    The Windows 32-bit system directory.\n\n\t    The Windows\
  \ home directory.\n\n\t    The directories listed in the path.\n\nThe dangerous part is the\
  \ second item, of course: `exec` _prefers_\nexecutables in the current directory to those\
  \ that are actually in the\n`PATH`.\n\nIt is almost as if people wanted to Windows users vulnerable,\n\
  specifically.\n\nTo avoid that, Git GUI already has the `_which` function that does not\n\
  imitate that dangerous practice when looking up executables in the\nsearch path.\n\nHowever,\
  \ Git GUI currently fails to use that function e.g. when trying to\nexecute `aspell` for spell\
  \ checking.\n\nThat is not only dangerous but combined with Tcl's unfortunate default\nbehavior\
  \ and with the fact that Git GUI tries to spell-check a\nrepository just after cloning, leads\
  \ to a critical Remote Code Execution\nvulnerability.\n\nLet's override both `exec` and `open`\
  \ to always use `_which` instead of\nletting Tcl perform the path lookup, to prevent this\
  \ attack vector.\n\nThis addresses CVE-2022-41953.\n\nFor more details, see\nhttps://github.com/git-for-windows/git/security/advisories/GHSA-v4px-mx59-w99c\n\
  \nSigned-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>\nSigned-off-by: Pratyush\
  \ Yadav <me@yadavpratyush.com>"
impacted_packages:
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: aae9560a355d4ab91385e49eae62fade2ddd27ef
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/git/git/tree/aae9560a355d4ab91385e49eae62fade2ddd27ef
    reference_type: commit
    reference_id: aae9560a355d4ab91385e49eae62fade2ddd27ef
