advisory_id: CVE-2019-1350
datasource_id: collect_git_fix_commits/CVE-2019-1350
datasource_url: https://github.com/git/git
aliases: []
summary: |
  20c71bcf67c7087555b95cf413b79445547cb442:Merge branch 'fix-msys2-quoting-bugs'

  These patches fix several bugs in quoting arguments when spawning shell
  scripts on Windows.

  Note: these bugs are Windows-only, as we have to construct a command
  line for the process-to-spawn, unlike Linux/macOS, where `execv()`
  accepts an already-split command line.

  Furthermore, these fixes were not included in the CVE-2019-1350 part of
  v2.14.6 because the Windows-specific quoting when spawning shell scripts
  was contributed from Git for Windows into Git only in the v2.21.x era.

  Signed-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>
  6d8684161ee9c03bed5cb69ae76dfdddb85a0003:mingw: fix quoting of arguments

  We need to be careful to follow proper quoting rules. For example, if an
  argument contains spaces, we have to quote them. Double-quotes need to
  be escaped. Backslashes need to be escaped, but only if they are
  followed by a double-quote character.

  We need to be _extra_ careful to consider the case where an argument
  ends in a backslash _and_ needs to be quoted: in this case, we append a
  double-quote character, i.e. the backslash now has to be escaped!

  The current code, however, fails to recognize that, and therefore can
  turn an argument that ends in a single backslash into a quoted argument
  that now ends in an escaped double-quote character. This allows
  subsequent command-line parameters to be split and part of them being
  mistaken for command-line options, e.g. through a maliciously-crafted
  submodule URL during a recursive clone.

  Technically, we would not need to quote _all_ arguments which end in a
  backslash _unless_ the argument needs to be quoted anyway. For example,
  `test\` would not need to be quoted, while `test \` would need to be.

  To keep the code simple, however, and therefore easier to reason about
  and ensure its correctness, we now _always_ quote an argument that ends
  in a backslash.

  This addresses CVE-2019-1350.

  Signed-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>
impacted_packages:
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: 20c71bcf67c7087555b95cf413b79445547cb442
    introduced_in_commits: []
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: 6d8684161ee9c03bed5cb69ae76dfdddb85a0003
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/git/git/tree/20c71bcf67c7087555b95cf413b79445547cb442
    reference_type: commit
    reference_id: 20c71bcf67c7087555b95cf413b79445547cb442
  - url: https://github.com/git/git/tree/6d8684161ee9c03bed5cb69ae76dfdddb85a0003
    reference_type: commit
    reference_id: 6d8684161ee9c03bed5cb69ae76dfdddb85a0003
