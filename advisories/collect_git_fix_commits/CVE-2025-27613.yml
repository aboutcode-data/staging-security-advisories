advisory_id: CVE-2025-27613
datasource_id: collect_git_fix_commits/CVE-2025-27613
datasource_url: https://github.com/git/git
aliases: []
summary: |
  b7ef4071c42f6ff20e696b0197a40f60da6ce70c:Merge branch 'js/fix-open-exec'

  This addresses CVE-2025-27613, Gitk can create and truncate a user's
  files:

  When a user clones an untrusted repository and runs gitk without
  additional command arguments, files for which the user has write
  permission can be created and truncated. The option "Support per-file
  encoding" must have been enabled before in Gitk's Preferences.  This
  option is disabled by default.

  The same happens when "Show origin of this line" is used in the main
  window (regardless of whether "Support per-file encoding" is enabled or
  not).

  * js/fix-open-exec:
    gitk: sanitize 'open' arguments: revisit recently updated 'open' calls
    gitk: sanitize 'open' arguments: command pipeline
    gitk: collect construction of blameargs into a single conditional
    gitk: sanitize 'open' arguments: simple commands, readable and writable
    gitk: sanitize 'open' arguments: simple commands with redirections
    gitk: sanitize 'open' arguments: simple commands
    gitk: sanitize 'exec' arguments: redirect to process
    gitk: sanitize 'exec' arguments: redirections and background
    gitk: sanitize 'exec' arguments: redirections
    gitk: sanitize 'exec' arguments: 'eval exec'
    gitk: sanitize 'exec' arguments: simple cases
    gitk: have callers of diffcmd supply pipe symbol when necessary
    gitk: treat file names beginning with "|" as relative paths

  Signed-off-by: Johannes Sixt <j6t@kdbg.org>
  d61cfed2c23705fbeb9c0d08f59e75ee08738950:Merge branch 'js/gitk-git-gui-harden-exec-open' into maint-2.43

  This merges in fixes for CVE-2025-27614, CVE-2025-27613, CVE-2025-46334,
  and CVE-2025-46835 targeting Gitk and Git GUI.

  * js/gitk-git-gui-harden-exec-open: (41 commits)
    git-gui: sanitize 'exec' arguments: convert new 'cygpath' calls
    git-gui: do not mistake command arguments as redirection operators
    git-gui: introduce function git_redir for git calls with redirections
    git-gui: pass redirections as separate argument to git_read
    git-gui: pass redirections as separate argument to _open_stdout_stderr
    git-gui: convert git_read*, git_write to be non-variadic
    git-gui: override exec and open only on Windows
    gitk: sanitize 'open' arguments: revisit recently updated 'open' calls
    git-gui: use git_read in githook_read
    git-gui: sanitize $PATH on all platforms
    git-gui: break out a separate function git_read_nice
    git-gui: assure PATH has only absolute elements.
    git-gui: remove option --stderr from git_read
    git-gui: cleanup git-bash menu item
    git-gui: sanitize 'exec' arguments: background
    git-gui: avoid auto_execok in do_windows_shortcut
    git-gui: sanitize 'exec' arguments: simple cases
    git-gui: avoid auto_execok for git-bash menu item
    git-gui: treat file names beginning with "|" as relative paths
    git-gui: remove unused proc is_shellscript
    git-gui: remove git config --list handling for git < 1.5.3
    git-gui: remove special treatment of Windows from open_cmd_pipe
    git-gui: remove HEAD detachment implementation for git < 1.5.3
    git-gui: use only the configured shell
    git-gui: remove Tcl 8.4 workaround on 2>@1 redirection
    git-gui: make _shellpath usable on startup
    git-gui: use [is_Windows], not bad _shellpath
    git-gui: _which, only add .exe suffix if not present
    gitk: encode arguments correctly with "open"
    gitk: sanitize 'open' arguments: command pipeline
    gitk: collect construction of blameargs into a single conditional
    gitk: sanitize 'open' arguments: simple commands, readable and writable
    gitk: sanitize 'open' arguments: simple commands with redirections
    gitk: sanitize 'open' arguments: simple commands
    gitk: sanitize 'exec' arguments: redirect to process
    gitk: sanitize 'exec' arguments: redirections and background
    gitk: sanitize 'exec' arguments: redirections
    gitk: sanitize 'exec' arguments: 'eval exec'
    gitk: sanitize 'exec' arguments: simple cases
    gitk: have callers of diffcmd supply pipe symbol when necessary
    gitk: treat file names beginning with "|" as relative paths
    ...

  Signed-off-by: Taylor Blau <me@ttaylorr.com>
  27fbab4898620183e608865beffd960139c04d58:Merge branch 'js/fix-open-exec'

  This addresses CVE-2025-27613, Gitk can create and truncate a user's
  files:

  When a user clones an untrusted repository and runs gitk without
  additional command arguments, files for which the user has write
  permission can be created and truncated. The option "Support per-file
  encoding" must have been enabled before in Gitk's Preferences.  This
  option is disabled by default.

  The same happens when "Show origin of this line" is used in the main
  window (regardless of whether "Support per-file encoding" is enabled or
  not).

  Signed-off-by: Johannes Sixt <j6t@kdbg.org>
impacted_packages:
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: d61cfed2c23705fbeb9c0d08f59e75ee08738950
    introduced_in_commits: []
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: 27fbab4898620183e608865beffd960139c04d58
    introduced_in_commits: []
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: b7ef4071c42f6ff20e696b0197a40f60da6ce70c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/git/git/tree/27fbab4898620183e608865beffd960139c04d58
    reference_type: commit
    reference_id: 27fbab4898620183e608865beffd960139c04d58
  - url: https://github.com/git/git/tree/b7ef4071c42f6ff20e696b0197a40f60da6ce70c
    reference_type: commit
    reference_id: b7ef4071c42f6ff20e696b0197a40f60da6ce70c
  - url: https://github.com/git/git/tree/d61cfed2c23705fbeb9c0d08f59e75ee08738950
    reference_type: commit
    reference_id: d61cfed2c23705fbeb9c0d08f59e75ee08738950
