advisory_id: CVE-2023-25815
datasource_id: collect_git_fix_commits/CVE-2023-25815
datasource_url: https://github.com/git/git
aliases: []
summary: |
  4fe5d0b10afdc9ac5b703605b8d84d1ce5d71e87:Merge branch 'avoid-using-uninitialized-gettext'

  Avoids the overhead of calling `gettext` when initialization of the
  translated messages was skipped. Addresses CVE-2023-25815.

  * avoid-using-uninitialized-gettext: (1 commit)
    gettext: avoid using gettext if the locale dir is not present
  c4137be0f5a6edf9a9044e6e43ecf4468c7a4046:gettext: avoid using gettext if the locale dir is not present

  In cc5e1bf99247 (gettext: avoid initialization if the locale dir is not
  present, 2018-04-21) Git was taught to avoid a costly gettext start-up
  when there are not even any localized messages to work with.

  But we still called `gettext()` and `ngettext()` functions.

  Which caused a problem in Git for Windows when the libgettext that is
  consumed from the MSYS2 project stopped using a runtime prefix in
  https://github.com/msys2/MINGW-packages/pull/10461

  Due to that change, we now use an unintialized gettext machinery that
  might get auto-initialized _using an unintended locale directory_:
  `C:\mingw64\share\locale`.

  Let's record the fact when the gettext initialization was skipped, and
  skip calling the gettext functions accordingly.

  This addresses CVE-2023-25815.

  Signed-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>
impacted_packages:
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: 4fe5d0b10afdc9ac5b703605b8d84d1ce5d71e87
    introduced_in_commits: []
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: c4137be0f5a6edf9a9044e6e43ecf4468c7a4046
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/git/git/tree/4fe5d0b10afdc9ac5b703605b8d84d1ce5d71e87
    reference_type: commit
    reference_id: 4fe5d0b10afdc9ac5b703605b8d84d1ce5d71e87
  - url: https://github.com/git/git/tree/c4137be0f5a6edf9a9044e6e43ecf4468c7a4046
    reference_type: commit
    reference_id: c4137be0f5a6edf9a9044e6e43ecf4468c7a4046
