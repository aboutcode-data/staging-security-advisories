advisory_id: CVE-2024-50338
datasource_id: collect_git_fix_commits/CVE-2024-50338
datasource_url: https://github.com/git/git
aliases: []
summary: |
  b01b9b81d36759cdcd07305e78765199e1bc2060:credential: disallow Carriage Returns in the protocol by default

  While Git has documented that the credential protocol is line-based,
  with newlines as terminators, the exact shape of a newline has not been
  documented.

  From Git's perspective, which is firmly rooted in the Linux ecosystem,
  it is clear that "a newline" means a Line Feed character.

  However, even Git's credential protocol respects Windows line endings
  (a Carriage Return character followed by a Line Feed character, "CR/LF")
  by virtue of using `strbuf_getline()`.

  There is a third category of line endings that has been used originally
  by MacOS, and that is respected by the default line readers of .NET and
  node.js: bare Carriage Returns.

  Git cannot handle those, and what is worse: Git's remedy against
  CVE-2020-5260 does not catch when credential helpers are used that
  interpret bare Carriage Returns as newlines.

  Git Credential Manager addressed this as CVE-2024-50338, but other
  credential helpers may still be vulnerable. So let's not only disallow
  Line Feed characters as part of the values in the credential protocol,
  but also disallow Carriage Return characters.

  In the unlikely event that a credential helper relies on Carriage
  Returns in the protocol, introduce an escape hatch via the
  `credential.protectProtocol` config setting.

  This addresses CVE-2024-52006.

  Signed-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>
impacted_packages:
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: b01b9b81d36759cdcd07305e78765199e1bc2060
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/git/git/tree/b01b9b81d36759cdcd07305e78765199e1bc2060
    reference_type: commit
    reference_id: b01b9b81d36759cdcd07305e78765199e1bc2060
