advisory_id: CVE-2021-29468
datasource_id: collect_git_fix_commits/CVE-2021-29468
datasource_url: https://github.com/git/git
aliases: []
summary: |
  bccc37fdc7ec66377af454417013f7612aef75e6:cygwin: disallow backslashes in file names

  The backslash character is not a valid part of a file name on Windows.
  If, in Windows, Git attempts to write a file that has a backslash
  character in the filename, it will be incorrectly interpreted as a
  directory separator.

  This caused CVE-2019-1354 in MinGW, as this behaviour can be manipulated
  to cause the checkout to write to files it ought not write to, such as
  adding code to the .git/hooks directory.  This was fixed by e1d911dd4c
  (mingw: disallow backslash characters in tree objects' file names,
  2019-09-12).  However, the vulnerability also exists in Cygwin: while
  Cygwin mostly provides a POSIX-like path system, it will still interpret
  a backslash as a directory separator.

  To avoid this vulnerability, CVE-2021-29468, extend the previous fix to
  also apply to Cygwin.

  Similarly, extend the test case added by the previous version of the
  commit.  The test suite doesn't have an easy way to say "run this test
  if in MinGW or Cygwin", so add a new test prerequisite that covers both.

  As well as checking behaviour in the presence of paths containing
  backslashes, the existing test also checks behaviour in the presence of
  paths that differ only by the presence of a trailing ".".  MinGW follows
  normal Windows application behaviour and treats them as the same path,
  but Cygwin more closely emulates *nix systems (at the expense of
  compatibility with native Windows applications) and will create and
  distinguish between such paths.  Gate the relevant bit of that test
  accordingly.

  Reported-by: RyotaK <security@ryotak.me>
  Helped-by: Johannes Schindelin <johannes.schindelin@gmx.de>
  Signed-off-by: Adam Dinwoodie <adam@dinwoodie.org>
  Signed-off-by: Junio C Hamano <gitster@pobox.com>
impacted_packages:
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: bccc37fdc7ec66377af454417013f7612aef75e6
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/git/git/tree/bccc37fdc7ec66377af454417013f7612aef75e6
    reference_type: commit
    reference_id: bccc37fdc7ec66377af454417013f7612aef75e6
