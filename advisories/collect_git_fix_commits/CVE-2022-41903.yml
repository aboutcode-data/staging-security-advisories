advisory_id: CVE-2022-41903
datasource_id: collect_git_fix_commits/CVE-2022-41903
datasource_url: https://github.com/git/git
aliases: []
summary: |
  2121a76d71e6742fe9627289b45717663bcef832:git-compat-util: introduce macros to disable "-Wsign-compare" warnings

  When compiling with DEVELOPER=YesPlease, we explicitly disable the
  "-Wsign-compare" warning. This is mostly because our code base is full
  of cases where we don't bother at all whether something should be signed
  or unsigned, and enabling the warning would thus cause tons of warnings
  to pop up.

  Unfortunately, disabling this warning also masks real issues. There have
  been multiple CVEs in the Git project that would have been flagged by
  this warning (e.g. CVE-2022-39260, CVE-2022-41903 and several fixes in
  the vicinity of these CVEs). Furthermore, the final audit report by
  X41 D-Sec, who are the ones who have discovered some of the CVEs, hinted
  that it might be a good idea to become more strict in this context.

  Now simply enabling the warning globally does not fly due to the stated
  reason above that we simply have too many sites where we use the wrong
  integer types. Instead, introduce a new set of macros that allow us to
  mark a file as being free of warnings with "-Wsign-compare". The
  mechanism is similar to what we do with `USE_THE_REPOSITORY_VARIABLE`:
  every file that is not marked with `DISABLE_SIGN_COMPARE_WARNINGS` will
  be compiled with those warnings enabled.

  These new markings will be wired up in the subsequent commits.

  Signed-off-by: Patrick Steinhardt <ps@pks.im>
  Signed-off-by: Junio C Hamano <gitster@pobox.com>
impacted_packages:
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: 2121a76d71e6742fe9627289b45717663bcef832
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/git/git/tree/2121a76d71e6742fe9627289b45717663bcef832
    reference_type: commit
    reference_id: 2121a76d71e6742fe9627289b45717663bcef832
