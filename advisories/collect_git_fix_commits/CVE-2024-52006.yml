advisory_id: CVE-2024-52006
datasource_id: collect_git_fix_commits/CVE-2024-52006
datasource_url: https://github.com/git/git
aliases: []
summary: "08756131a3b7038a60365ae56804cea4301082a9:Merge branch 'disallow-control-characters-in-credential-urls-by-default'\n\
  \nThis addresses two vulnerabilities:\n\n- CVE-2024-50349:\n\n\tPrinting unsanitized URLs\
  \ when asking for credentials made the\n\tuser susceptible to crafted URLs (e.g. in recursive\
  \ clones) that\n\tmislead the user into typing in passwords for trusted sites that\n\twould\
  \ then be sent to untrusted sites instead.\n\n- CVE-2024-52006\n\n\tGit may pass on Carriage\
  \ Returns via the credential protocol to\n\tcredential helpers which use line-reading functions\
  \ that\n\tinterpret said Carriage Returns as line endings, even though Git\n\tdid not intend\
  \ that.\n\nSigned-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>\nb01b9b81d36759cdcd07305e78765199e1bc2060:credential:\
  \ disallow Carriage Returns in the protocol by default\n\nWhile Git has documented that the\
  \ credential protocol is line-based,\nwith newlines as terminators, the exact shape of a newline\
  \ has not been\ndocumented.\n\nFrom Git's perspective, which is firmly rooted in the Linux\
  \ ecosystem,\nit is clear that \"a newline\" means a Line Feed character.\n\nHowever, even\
  \ Git's credential protocol respects Windows line endings\n(a Carriage Return character followed\
  \ by a Line Feed character, \"CR/LF\")\nby virtue of using `strbuf_getline()`.\n\nThere is\
  \ a third category of line endings that has been used originally\nby MacOS, and that is respected\
  \ by the default line readers of .NET and\nnode.js: bare Carriage Returns.\n\nGit cannot handle\
  \ those, and what is worse: Git's remedy against\nCVE-2020-5260 does not catch when credential\
  \ helpers are used that\ninterpret bare Carriage Returns as newlines.\n\nGit Credential Manager\
  \ addressed this as CVE-2024-50338, but other\ncredential helpers may still be vulnerable.\
  \ So let's not only disallow\nLine Feed characters as part of the values in the credential\
  \ protocol,\nbut also disallow Carriage Return characters.\n\nIn the unlikely event that a\
  \ credential helper relies on Carriage\nReturns in the protocol, introduce an escape hatch\
  \ via the\n`credential.protectProtocol` config setting.\n\nThis addresses CVE-2024-52006.\n\
  \nSigned-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>"
impacted_packages:
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: 08756131a3b7038a60365ae56804cea4301082a9
    introduced_in_commits: []
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: b01b9b81d36759cdcd07305e78765199e1bc2060
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/git/git/tree/08756131a3b7038a60365ae56804cea4301082a9
    reference_type: commit
    reference_id: 08756131a3b7038a60365ae56804cea4301082a9
  - url: https://github.com/git/git/tree/b01b9b81d36759cdcd07305e78765199e1bc2060
    reference_type: commit
    reference_id: b01b9b81d36759cdcd07305e78765199e1bc2060
