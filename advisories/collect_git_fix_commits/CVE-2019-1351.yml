advisory_id: CVE-2019-1351
datasource_id: collect_git_fix_commits/CVE-2019-1351
datasource_url: https://github.com/git/git
aliases: []
summary: |
  2ddcccf97a717f9df17a4843c39e3c4f1df49fec:Merge branch 'win32-accommodate-funny-drive-names'

  While the only permitted drive letters for physical drives on Windows
  are letters of the US-English alphabet, this restriction does not apply
  to virtual drives assigned via `subst <letter>: <path>`.

  To prevent targeted attacks against systems where "funny" drive letters
  such as `1` or `!` are assigned, let's handle them as regular drive
  letters on Windows.

  This fixes CVE-2019-1351.

  Signed-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>
  f82a97eb9197c1e3768e72648f37ce0ca3233734:mingw: handle `subst`-ed "DOS drives"

  Over a decade ago, in 25fe217b86c (Windows: Treat Windows style path
  names., 2008-03-05), Git was taught to handle absolute Windows paths,
  i.e. paths that start with a drive letter and a colon.

  Unbeknownst to us, while drive letters of physical drives are limited to
  letters of the English alphabet, there is a way to assign virtual drive
  letters to arbitrary directories, via the `subst` command, which is
  _not_ limited to English letters.

  It is therefore possible to have absolute Windows paths of the form
  `1:\what\the\hex.txt`. Even "better": pretty much arbitrary Unicode
  letters can also be used, e.g. `ä:\tschibät.sch`.

  While it can be sensibly argued that users who set up such funny drive
  letters really seek adverse consequences, the Windows Operating System
  is known to be a platform where many users are at the mercy of
  administrators who have their very own idea of what constitutes a
  reasonable setup.

  Therefore, let's just make sure that such funny paths are still
  considered absolute paths by Git, on Windows.

  In addition to Unicode characters, pretty much any character is a valid
  drive letter, as far as `subst` is concerned, even `:` and `"` or even a
  space character. While it is probably the opposite of smart to use them,
  let's safeguard `is_dos_drive_prefix()` against all of them.

  Note: `[::1]:repo` is a valid URL, but not a valid path on Windows.
  As `[` is now considered a valid drive letter, we need to be very
  careful to avoid misinterpreting such a string as valid local path in
  `url_is_local_not_ssh()`. To do that, we use the just-introduced
  function `is_valid_path()` (which will label the string as invalid file
  name because of the colon characters).

  This fixes CVE-2019-1351.

  Reported-by: Nicolas Joly <Nicolas.Joly@microsoft.com>
  Signed-off-by: Johannes Schindelin <johannes.schindelin@gmx.de>
impacted_packages:
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: 2ddcccf97a717f9df17a4843c39e3c4f1df49fec
    introduced_in_commits: []
  - purl: pkg:github/git/git
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/git/git
        commit: f82a97eb9197c1e3768e72648f37ce0ca3233734
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/git/git/tree/2ddcccf97a717f9df17a4843c39e3c4f1df49fec
    reference_type: commit
    reference_id: 2ddcccf97a717f9df17a4843c39e3c4f1df49fec
  - url: https://github.com/git/git/tree/f82a97eb9197c1e3768e72648f37ce0ca3233734
    reference_type: commit
    reference_id: f82a97eb9197c1e3768e72648f37ce0ca3233734
