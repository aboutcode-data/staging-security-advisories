advisory_id: CVE-2024-21896
datasource_id: collect_node_js_fix_commits/CVE-2024-21896
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  46ce27807970157ab1052f70824f46e70e267b5e:fs: protect against modified Buffer internals in possiblyTransformPath

  Use encodeUtf8String from the encoding_binding internal binding to
  convert the result of path.resolve() to a Uint8Array instead of using
  Buffer.from(), whose result can be manipulated by the user by
  monkey-patching internals such as Buffer.prototype.utf8Write.

  HackerOne report: https://hackerone.com/reports/2218653

  PR-URL: https://github.com/nodejs-private/node-private/pull/497
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-21896
  480fc169a808fd5f6bec059788c8984ddc6f51f0:fs: protect against modified Buffer internals in possiblyTransformPath

  Use encodeUtf8String from the encoding_binding internal binding to
  convert the result of path.resolve() to a Uint8Array instead of using
  Buffer.from(), whose result can be manipulated by the user by
  monkey-patching internals such as Buffer.prototype.utf8Write.

  HackerOne report: https://hackerone.com/reports/2218653

  PR-URL: https://github.com/nodejs-private/node-private/pull/497
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-21896
  a4edd22e3094c89fbedaa4c94adf3f8c0d01a3de:fs: protect against modified Buffer internals in possiblyTransformPath

  Use encodeUtf8String from the encoding_binding internal binding to
  convert the result of path.resolve() to a Uint8Array instead of using
  Buffer.from(), whose result can be manipulated by the user by
  monkey-patching internals such as Buffer.prototype.utf8Write.

  HackerOne report: https://hackerone.com/reports/2218653

  PR-URL: https://github.com/nodejs-private/node-private/pull/497
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-21896
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a4edd22e3094c89fbedaa4c94adf3f8c0d01a3de
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 480fc169a808fd5f6bec059788c8984ddc6f51f0
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 46ce27807970157ab1052f70824f46e70e267b5e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/46ce27807970157ab1052f70824f46e70e267b5e
    reference_type: commit
    reference_id: 46ce27807970157ab1052f70824f46e70e267b5e
  - url: https://github.com/nodejs/node/tree/480fc169a808fd5f6bec059788c8984ddc6f51f0
    reference_type: commit
    reference_id: 480fc169a808fd5f6bec059788c8984ddc6f51f0
  - url: https://github.com/nodejs/node/tree/a4edd22e3094c89fbedaa4c94adf3f8c0d01a3de
    reference_type: commit
    reference_id: a4edd22e3094c89fbedaa4c94adf3f8c0d01a3de
