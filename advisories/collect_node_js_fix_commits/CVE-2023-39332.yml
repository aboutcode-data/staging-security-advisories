advisory_id: CVE-2023-39332
datasource_id: collect_node_js_fix_commits/CVE-2023-39332
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  f447a4611a49d1843c17bf9ffbc86a835f1f1b9c:permission: fix Uint8Array path traversal

  Previous security patches addressed path traversal vulnerabilities for
  string and Buffer inputs, but ignored Uint8Array inputs. This commit
  fixes the existing logic to account for the latter.

  The previous implementation would silently ignore unexpected inputs,
  whereas this commit introduces an explicit assertion to prevent that
  unsafe behavior.

  PR-URL: https://github.com/nodejs-private/node-private/pull/456
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-39332
  deeffa0388a17e3f4848f914e88576087cc29727:2023-10-13, Version 20.8.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2023-44487: `nghttp2` Security Release (High)
  * CVE-2023-45143: `undici` Security Release (High)
  * CVE-2023-39332: Path traversal through path stored in Uint8Array (High)
  * CVE-2023-39331: Permission model improperly protects against path traversal (High)
  * CVE-2023-38552:  Integrity checks according to policies can be circumvented (Medium)
  * CVE-2023-39333: Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/491
  b485ffc458edc7140d43093cd8837a7c1ccc5ab3:2023-10-13, Version 20.8.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2023-44487: `nghttp2` Security Release (High)
  * CVE-2023-45143: `undici` Security Release (High)
  * CVE-2023-39332: Path traversal through path stored in Uint8Array (High)
  * CVE-2023-39331: Permission model improperly protects against path traversal (High)
  * CVE-2023-38552:  Integrity checks according to policies can be circumvented (Medium)
  * CVE-2023-39333: Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/491
  fa5dae1944d928748170de65b8d955a5b6b2f2d5:permission: fix Uint8Array path traversal

  Previous security patches addressed path traversal vulnerabilities for
  string and Buffer inputs, but ignored Uint8Array inputs. This commit
  fixes the existing logic to account for the latter.

  The previous implementation would silently ignore unexpected inputs,
  whereas this commit introduces an explicit assertion to prevent that
  unsafe behavior.

  PR-URL: https://github.com/nodejs-private/node-private/pull/456
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-39332
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: fa5dae1944d928748170de65b8d955a5b6b2f2d5
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: f447a4611a49d1843c17bf9ffbc86a835f1f1b9c
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b485ffc458edc7140d43093cd8837a7c1ccc5ab3
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: deeffa0388a17e3f4848f914e88576087cc29727
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/b485ffc458edc7140d43093cd8837a7c1ccc5ab3
    reference_type: commit
    reference_id: b485ffc458edc7140d43093cd8837a7c1ccc5ab3
  - url: https://github.com/nodejs/node/tree/deeffa0388a17e3f4848f914e88576087cc29727
    reference_type: commit
    reference_id: deeffa0388a17e3f4848f914e88576087cc29727
  - url: https://github.com/nodejs/node/tree/f447a4611a49d1843c17bf9ffbc86a835f1f1b9c
    reference_type: commit
    reference_id: f447a4611a49d1843c17bf9ffbc86a835f1f1b9c
  - url: https://github.com/nodejs/node/tree/fa5dae1944d928748170de65b8d955a5b6b2f2d5
    reference_type: commit
    reference_id: fa5dae1944d928748170de65b8d955a5b6b2f2d5
