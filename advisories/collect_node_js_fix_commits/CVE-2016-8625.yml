advisory_id: CVE-2016-8625
datasource_id: collect_node_js_fix_commits/CVE-2016-8625
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  c82f2445e5f5e8b387992e4e0e0ed99ab3e93012:dns: use IDNA 2008 to encode non-ascii hostnames

  Before this commit, Node.js left it up to the system resolver or c-ares.

  Leaving it to the system resolver introduces platform differences
  because:

  * some support IDNA 2008
  * some only IDNA 2003 (glibc until 2.28), and
  * some don't support IDNA at all (musl libc)

  c-ares doesn't support IDNA either although curl does, by virtue of
  linking against libidn2. Upgrading from libidn1 to libidn2 in order
  to get proper IDNA 2008 support was the fix for curl's CVE-2016-8625.

  libidn2 is not an option (incompatible license) but ICU has an IDNA API
  and we already use that in one place. For non-ICU builds, we fall back
  to the bundled punycode.js that also supports IDNA 2008.

  Fixes: https://github.com/nodejs-private/security/issues/97
  Fixes: https://github.com/nodejs/node/issues/25558

  PR-URL: https://github.com/nodejs/node/pull/25679
  Reviewed-By: Santiago Gimeno <santiago.gimeno@gmail.com>
  Reviewed-By: Saúl Ibarra Corretgé <saghul@gmail.com>
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  Reviewed-By: Ruben Bridgewater <ruben@bridgewater.de>
  Reviewed-By: Colin Ihrig <cjihrig@gmail.com>
  Reviewed-By: Tiancheng "Timothy" Gu <timothygu99@gmail.com>
  f399b01dc4dbb47f678301aea6f476527889b959:dns: use IDNA 2008 to encode non-ascii hostnames

  Before this commit, Node.js left it up to the system resolver or c-ares.

  Leaving it to the system resolver introduces platform differences
  because:

  * some support IDNA 2008
  * some only IDNA 2003 (glibc until 2.28), and
  * some don't support IDNA at all (musl libc)

  c-ares doesn't support IDNA either although curl does, by virtue of
  linking against libidn2. Upgrading from libidn1 to libidn2 in order
  to get proper IDNA 2008 support was the fix for curl's CVE-2016-8625.

  libidn2 is not an option (incompatible license) but ICU has an IDNA API
  and we already use that in one place. For non-ICU builds, we fall back
  to the bundled punycode.js that also supports IDNA 2008.

  Fixes: https://github.com/nodejs-private/security/issues/97
  Fixes: https://github.com/nodejs/node/issues/25558

  PR-URL: https://github.com/nodejs/node/pull/25679
  Reviewed-By: Santiago Gimeno <santiago.gimeno@gmail.com>
  Reviewed-By: Saúl Ibarra Corretgé <saghul@gmail.com>
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  Reviewed-By: Ruben Bridgewater <ruben@bridgewater.de>
  Reviewed-By: Colin Ihrig <cjihrig@gmail.com>
  Reviewed-By: Tiancheng "Timothy" Gu <timothygu99@gmail.com>
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: f399b01dc4dbb47f678301aea6f476527889b959
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: c82f2445e5f5e8b387992e4e0e0ed99ab3e93012
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/c82f2445e5f5e8b387992e4e0e0ed99ab3e93012
    reference_type: commit
    reference_id: c82f2445e5f5e8b387992e4e0e0ed99ab3e93012
  - url: https://github.com/nodejs/node/tree/f399b01dc4dbb47f678301aea6f476527889b959
    reference_type: commit
    reference_id: f399b01dc4dbb47f678301aea6f476527889b959
