advisory_id: CVE-2023-32559
datasource_id: collect_node_js_fix_commits/CVE-2023-32559
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  4aa0eff787c14f14a239cf2f44bf751a0151e3eb:policy: disable process.binding() when enabled

  process.binding() can be used to trivially bypass restrictions imposed
  through a policy. Since the function is deprecated already, simply
  replace it with a stub when a policy is being enabled.

  Fixes: https://hackerone.com/bugs?report_id=1946470
  PR-URL: https://github.com/nodejs-private/node-private/pull/397
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-32559
  ae25da20fa098bd8cb551efb7bbefa3e8ce7328b:2023-08-09, Version 20.5.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2023-32002: Policies can be bypassed via Module.\_load (High)
  * CVE-2023-32558: process.binding() can bypass the permission model through path traversal (High)
  * CVE-2023-32004: Permission model can be bypassed by specifying a path traversal sequence in a Buffer (High)
  * CVE-2023-32006: Policies can be bypassed by module.constructor.createRequire (Medium)
  * CVE-2023-32559: Policies can be bypassed via process.binding (Medium)
  * CVE-2023-32005: fs.statfs can bypass the permission model (Low)
  * CVE-2023-32003: fs.mkdtemp() and fs.mkdtempSync() can bypass the permission model (Low)
  * OpenSSL Security Releases
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000264.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000265.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000267.html

  PR-URL: https://github.com/nodejs-private/node-private/pull/465
  6d46d986a47ba86ea7ed52c86c46085ca5a8462b:2023-08-09, Version 18.17.1 'Hydrogen' (LTS)

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-32002: Policies can be bypassed via Module._load (High)
  * CVE-2023-32006: Policies can be bypassed by module.constructor.createRequire (Medium)
  * CVE-2023-32559: Policies can be bypassed via process.binding (Medium)
  * OpenSSL Security Releases
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000264.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000265.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000267.html

  PR-URL: https://github.com/nodejs-private/node-private/pull/463
  eed21991fbae3dfef4d80b73fe343908a426fa52:2023-08-09, Version 16.20.2 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-32002: Policies can be bypassed via Module._load (High)
  * CVE-2023-32006: Policies can be bypassed by module.constructor.createRequire (Medium)
  * CVE-2023-32559: Policies can be bypassed via process.binding (Medium)
  * OpenSSL Security Releases
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000264.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000265.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000267.html

  PR-URL: https://github.com/nodejs-private/node-private/pull/458
  9f51c55a47702dc6a0ca3569853dd7ba022bf7bb:2023-08-09, Version 20.5.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2023-32002: Policies can be bypassed via Module.\_load (High)
  * CVE-2023-32558: process.binding() can bypass the permission model through path traversal (High)
  * CVE-2023-32004: Permission model can be bypassed by specifying a path traversal sequence in a Buffer (High)
  * CVE-2023-32006: Policies can be bypassed by module.constructor.createRequire (Medium)
  * CVE-2023-32559: Policies can be bypassed via process.binding (Medium)
  * CVE-2023-32005: fs.statfs can bypass the permission model (Low)
  * CVE-2023-32003: fs.mkdtemp() and fs.mkdtempSync() can bypass the permission model (Low)
  * OpenSSL Security Releases
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000264.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000265.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000267.html

  PR-URL: https://github.com/nodejs-private/node-private/pull/465
  cf348ec6408e3f32bdec44b1f86e008a1bc1ce23:policy: disable process.binding() when enabled

  process.binding() can be used to trivially bypass restrictions imposed
  through a policy. Since the function is deprecated already, simply
  replace it with a stub when a policy is being enabled.

  Fixes: https://hackerone.com/bugs?report_id=1946470
  PR-URL: https://github.com/nodejs-private/node-private/pull/397
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-32559
  2e414d5d1082233c3516fca923fe351d5186c80e:2023-08-09, Version 18.17.1 'Hydrogen' (LTS)

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-32002: Policies can be bypassed via Module._load (High)
  * CVE-2023-32006: Policies can be bypassed by module.constructor.createRequire (Medium)
  * CVE-2023-32559: Policies can be bypassed via process.binding (Medium)
  * OpenSSL Security Releases
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000264.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000265.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000267.html

  PR-URL: https://github.com/nodejs-private/node-private/pull/463
  dadbde963fd37a637316c875f8c3e9bbf6e6a393:2023-08-09, Version 16.20.2 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-32002: Policies can be bypassed via Module._load (High)
  * CVE-2023-32006: Policies can be bypassed by module.constructor.createRequire (Medium)
  * CVE-2023-32559: Policies can be bypassed via process.binding (Medium)
  * OpenSSL Security Releases
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000264.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000265.html
    * https://mta.openssl.org/pipermail/openssl-announce/2023-July/000267.html

  PR-URL: https://github.com/nodejs-private/node-private/pull/458
  d4570fae358693b8f7fec05294b9bb92a966226d:policy: disable process.binding() when enabled

  process.binding() can be used to trivially bypass restrictions imposed
  through a policy. Since the function is deprecated already, simply
  replace it with a stub when a policy is being enabled.

  Fixes: https://hackerone.com/bugs?report_id=1946470
  PR-URL: https://github.com/nodejs-private/node-private/pull/460
  CVE-ID: CVE-2023-32559
  242aaa0caaf0c15109067b598d58fdeae603c5fd:policy: disable process.binding() when enabled

  process.binding() can be used to trivially bypass restrictions imposed
  through a policy. Since the function is deprecated already, simply
  replace it with a stub when a policy is being enabled.

  Fixes: https://hackerone.com/bugs?report_id=1946470
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-32559
  PR-URL: https://github.com/nodejs-private/node-private/pull/459
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: cf348ec6408e3f32bdec44b1f86e008a1bc1ce23
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: dadbde963fd37a637316c875f8c3e9bbf6e6a393
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9f51c55a47702dc6a0ca3569853dd7ba022bf7bb
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 242aaa0caaf0c15109067b598d58fdeae603c5fd
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: ae25da20fa098bd8cb551efb7bbefa3e8ce7328b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4aa0eff787c14f14a239cf2f44bf751a0151e3eb
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: eed21991fbae3dfef4d80b73fe343908a426fa52
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: d4570fae358693b8f7fec05294b9bb92a966226d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 2e414d5d1082233c3516fca923fe351d5186c80e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6d46d986a47ba86ea7ed52c86c46085ca5a8462b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/242aaa0caaf0c15109067b598d58fdeae603c5fd
    reference_type: commit
    reference_id: 242aaa0caaf0c15109067b598d58fdeae603c5fd
  - url: https://github.com/nodejs/node/tree/2e414d5d1082233c3516fca923fe351d5186c80e
    reference_type: commit
    reference_id: 2e414d5d1082233c3516fca923fe351d5186c80e
  - url: https://github.com/nodejs/node/tree/4aa0eff787c14f14a239cf2f44bf751a0151e3eb
    reference_type: commit
    reference_id: 4aa0eff787c14f14a239cf2f44bf751a0151e3eb
  - url: https://github.com/nodejs/node/tree/6d46d986a47ba86ea7ed52c86c46085ca5a8462b
    reference_type: commit
    reference_id: 6d46d986a47ba86ea7ed52c86c46085ca5a8462b
  - url: https://github.com/nodejs/node/tree/9f51c55a47702dc6a0ca3569853dd7ba022bf7bb
    reference_type: commit
    reference_id: 9f51c55a47702dc6a0ca3569853dd7ba022bf7bb
  - url: https://github.com/nodejs/node/tree/ae25da20fa098bd8cb551efb7bbefa3e8ce7328b
    reference_type: commit
    reference_id: ae25da20fa098bd8cb551efb7bbefa3e8ce7328b
  - url: https://github.com/nodejs/node/tree/cf348ec6408e3f32bdec44b1f86e008a1bc1ce23
    reference_type: commit
    reference_id: cf348ec6408e3f32bdec44b1f86e008a1bc1ce23
  - url: https://github.com/nodejs/node/tree/d4570fae358693b8f7fec05294b9bb92a966226d
    reference_type: commit
    reference_id: d4570fae358693b8f7fec05294b9bb92a966226d
  - url: https://github.com/nodejs/node/tree/dadbde963fd37a637316c875f8c3e9bbf6e6a393
    reference_type: commit
    reference_id: dadbde963fd37a637316c875f8c3e9bbf6e6a393
  - url: https://github.com/nodejs/node/tree/eed21991fbae3dfef4d80b73fe343908a426fa52
    reference_type: commit
    reference_id: eed21991fbae3dfef4d80b73fe343908a426fa52
