advisory_id: CVE-2018-12115
datasource_id: collect_node_js_fix_commits/CVE-2018-12115
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  88105c998ef9d3f54aa8f22b82ec8cc31cbfac95:buffer: avoid overrun on UCS-2 string write

  CVE-2018-12115
  Discovered by ChALkeR - Сковорода Никита Андреевич
  Fix by Anna Henningsen

  Writing to the second-to-last byte with UCS-2 encoding will cause a -1
  length to be send to String::Write(), writing all of the provided Buffer
  from that point and beyond.

  Fixes: https://github.com/nodejs-private/security/issues/203
  PR-URL: https://github.com/nodejs-private/node-private/pull/138
  97c1fa3d3b98bf1b28cf3362e197ae91093cf68f:2018-08-15, Version 10.9.0 (Current)

  Notable changes:

  * buffer:
    * Fix out-of-bounds (OOB) write in `Buffer.write()` for UCS-2 encoding
      (CVE-2018-12115)
    * Fix unintentional exposure of uninitialized memory in `Buffer.alloc()`
      (CVE-2018-7166)
  * deps:
    * Upgrade to OpenSSL 1.1.0i, fixing:
      - Client DoS due to large DH parameter (CVE-2018-0732)
      - ECDSA key extraction via local side-channel (CVE not assigned)
    * Upgrade V8 from 6.7 to 6.8 (Michaël Zasso) #21079
      - Memory reduction and performance improvements, details at:
        https://v8project.blogspot.com/2018/06/v8-release-68.html
  * http: `http.get()` and `http.request()` (and `https` variants) can now accept
    three arguments to allow for a `URL` _and_ an `options` object
    (Sam Ruby) #21616
  * Added new collaborators
    * Sam Ruby (https://github.com/rubys)
    * George Adams (https://github.com/gdams)
  1efdc5876dc00495994c806d2eba0638f6a355bf:2018-08-15, Version 8.11.4 'Carbon' (LTS)

  This is a security release. All Node.js users should consult the
  security release summary at:

    https://nodejs.org/en/blog/vulnerability/august-2018-security-releases/

  for details on patched vulnerabilities.

  Fixes for the following CVEs are included in this release:

    * CVE-2018-0732 (OpenSSL)
    * CVE-2018-12115 (Node.js)

  Notable changes:

  * buffer: Fix out-of-bounds (OOB) write in `Buffer.write()` for UCS-2 encoding
    (CVE-2018-12115)
  * deps: Upgrade to OpenSSL 1.0.2p, fixing:
    * Client DoS due to large DH parameter (CVE-2018-0732)
    * ECDSA key extraction via local side-channel (CVE not assigned)
  1efdc5876dc00495994c806d2eba0638f6a355bf:2018-08-15, Version 8.11.4 'Carbon' (LTS)

  This is a security release. All Node.js users should consult the
  security release summary at:

    https://nodejs.org/en/blog/vulnerability/august-2018-security-releases/

  for details on patched vulnerabilities.

  Fixes for the following CVEs are included in this release:

    * CVE-2018-0732 (OpenSSL)
    * CVE-2018-12115 (Node.js)

  Notable changes:

  * buffer: Fix out-of-bounds (OOB) write in `Buffer.write()` for UCS-2 encoding
    (CVE-2018-12115)
  * deps: Upgrade to OpenSSL 1.0.2p, fixing:
    * Client DoS due to large DH parameter (CVE-2018-0732)
    * ECDSA key extraction via local side-channel (CVE not assigned)
  82ab9b336d90206bc5b64662f3052cd14b606705:2018-08-15, Version 6.14.4 'Boron' (LTS)

  This is a security release. All Node.js users should consult the
  security release summary at:

    https://nodejs.org/en/blog/vulnerability/august-2018-security-releases/

  for details on patched vulnerabilities.

  Fixes for the following CVEs are included in this release:

    * CVE-2018-0732 (OpenSSL)
    * CVE-2018-12115 (Node.js)

  Notable changes:

  * buffer: Fix out-of-bounds (OOB) write in `Buffer.write()` for UCS-2 encoding
    (CVE-2018-12115)
  * deps: Upgrade to OpenSSL 1.0.2p, fixing:
    * Client DoS due to large DH parameter (CVE-2018-0732)
    * ECDSA key extraction via local side-channel (CVE not assigned)
  82ab9b336d90206bc5b64662f3052cd14b606705:2018-08-15, Version 6.14.4 'Boron' (LTS)

  This is a security release. All Node.js users should consult the
  security release summary at:

    https://nodejs.org/en/blog/vulnerability/august-2018-security-releases/

  for details on patched vulnerabilities.

  Fixes for the following CVEs are included in this release:

    * CVE-2018-0732 (OpenSSL)
    * CVE-2018-12115 (Node.js)

  Notable changes:

  * buffer: Fix out-of-bounds (OOB) write in `Buffer.write()` for UCS-2 encoding
    (CVE-2018-12115)
  * deps: Upgrade to OpenSSL 1.0.2p, fixing:
    * Client DoS due to large DH parameter (CVE-2018-0732)
    * ECDSA key extraction via local side-channel (CVE not assigned)
  03b825811ed4af0addcdf6e75bacb3dc1c4c5940:2018-08-15, Version 10.9.0 (Current)

  Notable changes:

  * buffer:
    * Fix out-of-bounds (OOB) write in `Buffer.write()` for UCS-2 encoding
      (CVE-2018-12115)
    * Fix unintentional exposure of uninitialized memory in `Buffer.alloc()`
      (CVE-2018-7166)
  * deps:
    * Upgrade to OpenSSL 1.1.0i, fixing:
      - Client DoS due to large DH parameter (CVE-2018-0732)
      - ECDSA key extraction via local side-channel (CVE not assigned)
    * Upgrade V8 from 6.7 to 6.8 (Michaël Zasso) #21079
      - Memory reduction and performance improvements, details at:
        https://v8project.blogspot.com/2018/06/v8-release-68.html
  * http: `http.get()` and `http.request()` (and `https` variants) can now accept
    three arguments to allow for a `URL` _and_ an `options` object
    (Sam Ruby) #21616
  * Added new collaborators
    * Sam Ruby (https://github.com/rubys)
    * George Adams (https://github.com/gdams)
  2c4c17b708ddd93cfcffd6fe2083bd3b75b5de0d:buffer: avoid overrun on UCS-2 string write

  CVE-2018-12115
  Discovered by ChALkeR - Сковорода Никита Андреевич
  Fix by Anna Henningsen

  Writing to the second-to-last byte with UCS-2 encoding will cause a -1
  length to be send to String::Write(), writing all of the provided Buffer
  from that point and beyond.

  Fixes: https://github.com/nodejs-private/security/issues/203
  PR-URL: https://github.com/nodejs-private/node-private/pull/138
  1cb5aed5f596a9cb5b68e3a676222c0c35501a5e:2018-08-15, Version 6.14.4 'Boron' (LTS)

  This is a security release. All Node.js users should consult the
  security release summary at:

    https://nodejs.org/en/blog/vulnerability/august-2018-security-releases/

  for details on patched vulnerabilities.

  Fixes for the following CVEs are included in this release:

    * CVE-2018-0732 (OpenSSL)
    * CVE-2018-12115 (Node.js)

  Notable changes:

  * buffer: Fix out-of-bounds (OOB) write in `Buffer.write()` for UCS-2 encoding
    (CVE-2018-12115)
  * deps: Upgrade to OpenSSL 1.0.2p, fixing:
    * Client DoS due to large DH parameter (CVE-2018-0732)
    * ECDSA key extraction via local side-channel (CVE not assigned)
  1cb5aed5f596a9cb5b68e3a676222c0c35501a5e:2018-08-15, Version 6.14.4 'Boron' (LTS)

  This is a security release. All Node.js users should consult the
  security release summary at:

    https://nodejs.org/en/blog/vulnerability/august-2018-security-releases/

  for details on patched vulnerabilities.

  Fixes for the following CVEs are included in this release:

    * CVE-2018-0732 (OpenSSL)
    * CVE-2018-12115 (Node.js)

  Notable changes:

  * buffer: Fix out-of-bounds (OOB) write in `Buffer.write()` for UCS-2 encoding
    (CVE-2018-12115)
  * deps: Upgrade to OpenSSL 1.0.2p, fixing:
    * Client DoS due to large DH parameter (CVE-2018-0732)
    * ECDSA key extraction via local side-channel (CVE not assigned)
  0cae3c3fe5e3f4c275701446a4baf1f2727344f6:2018-08-15, Version 8.11.4 'Carbon' (LTS)

  This is a security release. All Node.js users should consult the
  security release summary at:

    https://nodejs.org/en/blog/vulnerability/august-2018-security-releases/

  for details on patched vulnerabilities.

  Fixes for the following CVEs are included in this release:

    * CVE-2018-0732 (OpenSSL)
    * CVE-2018-12115 (Node.js)

  Notable changes:

  * buffer: Fix out-of-bounds (OOB) write in `Buffer.write()` for UCS-2 encoding
    (CVE-2018-12115)
  * deps: Upgrade to OpenSSL 1.0.2p, fixing:
    * Client DoS due to large DH parameter (CVE-2018-0732)
    * ECDSA key extraction via local side-channel (CVE not assigned)
  0cae3c3fe5e3f4c275701446a4baf1f2727344f6:2018-08-15, Version 8.11.4 'Carbon' (LTS)

  This is a security release. All Node.js users should consult the
  security release summary at:

    https://nodejs.org/en/blog/vulnerability/august-2018-security-releases/

  for details on patched vulnerabilities.

  Fixes for the following CVEs are included in this release:

    * CVE-2018-0732 (OpenSSL)
    * CVE-2018-12115 (Node.js)

  Notable changes:

  * buffer: Fix out-of-bounds (OOB) write in `Buffer.write()` for UCS-2 encoding
    (CVE-2018-12115)
  * deps: Upgrade to OpenSSL 1.0.2p, fixing:
    * Client DoS due to large DH parameter (CVE-2018-0732)
    * ECDSA key extraction via local side-channel (CVE not assigned)
  fc14d812b742cfec4e0a1ee1573c5636709c2bce:buffer: avoid overrun on UCS-2 string write

  CVE-2018-12115
  Discovered by ChALkeR - Сковорода Никита Андреевич
  Fix by Anna Henningsen

  Writing to the second-to-last byte with UCS-2 encoding will cause a -1
  length to be send to String::Write(), writing all of the provided Buffer
  from that point and beyond.

  Fixes: https://github.com/nodejs-private/security/issues/203
  PR-URL: https://github.com/nodejs-private/node-private/pull/138
  0052926476474a28747004321e37f1dd4969d250:buffer: avoid overrun on UCS-2 string write

  CVE-2018-12115
  Discovered by ChALkeR - Сковорода Никита Андреевич
  Fix by Anna Henningsen

  Writing to the second-to-last byte with UCS-2 encoding will cause a -1
  length to be send to String::Write(), writing all of the provided Buffer
  from that point and beyond.

  Fixes: https://github.com/nodejs-private/security/issues/203
  PR-URL: https://github.com/nodejs-private/node-private/pull/138
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: fc14d812b742cfec4e0a1ee1573c5636709c2bce
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 82ab9b336d90206bc5b64662f3052cd14b606705
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0052926476474a28747004321e37f1dd4969d250
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 2c4c17b708ddd93cfcffd6fe2083bd3b75b5de0d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0cae3c3fe5e3f4c275701446a4baf1f2727344f6
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 97c1fa3d3b98bf1b28cf3362e197ae91093cf68f
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 88105c998ef9d3f54aa8f22b82ec8cc31cbfac95
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 03b825811ed4af0addcdf6e75bacb3dc1c4c5940
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1cb5aed5f596a9cb5b68e3a676222c0c35501a5e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1efdc5876dc00495994c806d2eba0638f6a355bf
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/0052926476474a28747004321e37f1dd4969d250
    reference_type: commit
    reference_id: 0052926476474a28747004321e37f1dd4969d250
  - url: https://github.com/nodejs/node/tree/03b825811ed4af0addcdf6e75bacb3dc1c4c5940
    reference_type: commit
    reference_id: 03b825811ed4af0addcdf6e75bacb3dc1c4c5940
  - url: https://github.com/nodejs/node/tree/0cae3c3fe5e3f4c275701446a4baf1f2727344f6
    reference_type: commit
    reference_id: 0cae3c3fe5e3f4c275701446a4baf1f2727344f6
  - url: https://github.com/nodejs/node/tree/1cb5aed5f596a9cb5b68e3a676222c0c35501a5e
    reference_type: commit
    reference_id: 1cb5aed5f596a9cb5b68e3a676222c0c35501a5e
  - url: https://github.com/nodejs/node/tree/1efdc5876dc00495994c806d2eba0638f6a355bf
    reference_type: commit
    reference_id: 1efdc5876dc00495994c806d2eba0638f6a355bf
  - url: https://github.com/nodejs/node/tree/2c4c17b708ddd93cfcffd6fe2083bd3b75b5de0d
    reference_type: commit
    reference_id: 2c4c17b708ddd93cfcffd6fe2083bd3b75b5de0d
  - url: https://github.com/nodejs/node/tree/82ab9b336d90206bc5b64662f3052cd14b606705
    reference_type: commit
    reference_id: 82ab9b336d90206bc5b64662f3052cd14b606705
  - url: https://github.com/nodejs/node/tree/88105c998ef9d3f54aa8f22b82ec8cc31cbfac95
    reference_type: commit
    reference_id: 88105c998ef9d3f54aa8f22b82ec8cc31cbfac95
  - url: https://github.com/nodejs/node/tree/97c1fa3d3b98bf1b28cf3362e197ae91093cf68f
    reference_type: commit
    reference_id: 97c1fa3d3b98bf1b28cf3362e197ae91093cf68f
  - url: https://github.com/nodejs/node/tree/fc14d812b742cfec4e0a1ee1573c5636709c2bce
    reference_type: commit
    reference_id: fc14d812b742cfec4e0a1ee1573c5636709c2bce
