advisory_id: CVE-2023-23919
datasource_id: collect_node_js_fix_commits/CVE-2023-23919
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  438812e14d3b2a705fb639b69e37c6cc4e7c8029:crypto: clear OpenSSL error on invalid ca cert

  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>

  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1808596
  CVE-ID: CVE-2023-23919
  PR-URL: https://github.com/nodejs-private/node-private/pull/368
  Reviewed-by: Michael Dawson <midawson@redhat.com>
  dd1977f3ddda8bb0b939699cae998e4e72d3677a:2023-02-16, Version 19.6.1 (Current)

  This is a security release.

  The following CVEs are fixed in this release:

  - CVE-2023-23919: OpenSSL errors not cleared in error stack (Medium)
  - CVE-2023-23918: Experimental Policies bypass via `process.mainModule.require`(High)
  - CVE-2023-23920: Insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: #385
  667dd34d794bae01051fcdceb6b24a12a9a43859:2023-02-16, Version 18.14.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: https://github.com/nodejs-private/node-private/pull/386
  5c4a287c3e43854d5c91293ede41bdf7996e567f:2023-02-16, Version 16.19.1 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via
    process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs
    crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA
    environment variable (Low)

  Fixed by an update to undici:

  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
    See https://github.com/nodejs/undici/security/advisories/GHSA-5r9g-qh6m-jxff
    for more information.
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
    See https://github.com/nodejs/undici/security/advisories/GHSA-r6ch-mqf9-qc9w
    for more information.

  - OpenSSL 1.1.1t

  PR-URL: https://github.com/nodejs-private/node-private/pull/390
  96a4559f259f109a2abc480caeba12644b8a8fd1:2023-02-16, Version 16.19.1 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via
    process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs
    crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA
    environment variable (Low)

  Fixed by an update to undici:

  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
    See https://github.com/nodejs/undici/security/advisories/GHSA-5r9g-qh6m-jxff
    for more information.
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
    See https://github.com/nodejs/undici/security/advisories/GHSA-r6ch-mqf9-qc9w
    for more information.

  - OpenSSL 1.1.1t

  PR-URL: https://github.com/nodejs-private/node-private/pull/390
  7bc2cf7fa9a2016fadb27e042968a69297bd975e:2023-02-16, Version 18.14.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: https://github.com/nodejs-private/node-private/pull/386
  004e34d046f33d06491b4db3e58950f65579e2b4:crypto: clear OpenSSL error on invalid ca cert

  CVE-ID: CVE-2023-23919
  PR-URL: https://github.com/nodejs-private/node-private/pull/370
  Refs: https://hackerone.com/bugs?report_id=1808596
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>
  a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b:2023-02-16, Version 19.6.1 (Current)

  This is a security release.

  The following CVEs are fixed in this release:

  - CVE-2023-23919: OpenSSL errors not cleared in error stack (Medium)
  - CVE-2023-23918: Experimental Policies bypass via `process.mainModule.require`(High)
  - CVE-2023-23920: Insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: #385
  8ac90e6372d896c8564ceec5e0bce71e370239d9:crypto: clear OpenSSL error on invalid ca cert

  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>

  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1808596
  CVE-ID: CVE-2023-23919
  PR-URL: https://github.com/nodejs-private/node-private/pull/368
  Reviewed-by: Michael Dawson <midawson@redhat.com>
  b558e9f476506099252a346b202a093245f73360:crypto: clear OpenSSL error on invalid ca cert

  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-23919
  PR-URL: https://github.com/nodejs-private/node-private/pull/375
  Refs: https://hackerone.com/bugs?report_id=1808596
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  Reviewed-By: Richard Lau <rlau@redhat.com>
  160adb7ffc8048d12fe0599b8fb12e4236b9d21a:crypto: clear OpenSSL error queue after calling X509_check_private_key()

  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/375
  CVE-ID: CVE-2023-23919
  Fixes: https://github.com/nodejs/node/issues/45485
  PR-URL: https://github.com/nodejs/node/pull/45495
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1808596
  Reviewed-By: Tobias Nießen <tniessen@tnie.de>
  Reviewed-By: Yagiz Nizipli <yagiz@nizipli.com>
  d0ece3094845c66a69e5cd72be956ae526ae3f11:crypto: clear OpenSSL error queue after calling X509_verify()

  Prior to this commit, functions accessing the OpenSSL error queue did
  not work properly after x509.verify() returned false.

  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/375
  CVE-ID: CVE-2023-23919
  PR-URL: https://github.com/nodejs/node/pull/45377
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1808596
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Tobias Nießen <tniessen@tnie.de>
  Reviewed-By: Filip Skokan <panva.ip@gmail.com>
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 5c4a287c3e43854d5c91293ede41bdf7996e567f
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: dd1977f3ddda8bb0b939699cae998e4e72d3677a
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8ac90e6372d896c8564ceec5e0bce71e370239d9
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b558e9f476506099252a346b202a093245f73360
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 004e34d046f33d06491b4db3e58950f65579e2b4
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 160adb7ffc8048d12fe0599b8fb12e4236b9d21a
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 7bc2cf7fa9a2016fadb27e042968a69297bd975e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 667dd34d794bae01051fcdceb6b24a12a9a43859
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 96a4559f259f109a2abc480caeba12644b8a8fd1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 438812e14d3b2a705fb639b69e37c6cc4e7c8029
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: d0ece3094845c66a69e5cd72be956ae526ae3f11
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/004e34d046f33d06491b4db3e58950f65579e2b4
    reference_type: commit
    reference_id: 004e34d046f33d06491b4db3e58950f65579e2b4
  - url: https://github.com/nodejs/node/tree/160adb7ffc8048d12fe0599b8fb12e4236b9d21a
    reference_type: commit
    reference_id: 160adb7ffc8048d12fe0599b8fb12e4236b9d21a
  - url: https://github.com/nodejs/node/tree/438812e14d3b2a705fb639b69e37c6cc4e7c8029
    reference_type: commit
    reference_id: 438812e14d3b2a705fb639b69e37c6cc4e7c8029
  - url: https://github.com/nodejs/node/tree/5c4a287c3e43854d5c91293ede41bdf7996e567f
    reference_type: commit
    reference_id: 5c4a287c3e43854d5c91293ede41bdf7996e567f
  - url: https://github.com/nodejs/node/tree/667dd34d794bae01051fcdceb6b24a12a9a43859
    reference_type: commit
    reference_id: 667dd34d794bae01051fcdceb6b24a12a9a43859
  - url: https://github.com/nodejs/node/tree/7bc2cf7fa9a2016fadb27e042968a69297bd975e
    reference_type: commit
    reference_id: 7bc2cf7fa9a2016fadb27e042968a69297bd975e
  - url: https://github.com/nodejs/node/tree/8ac90e6372d896c8564ceec5e0bce71e370239d9
    reference_type: commit
    reference_id: 8ac90e6372d896c8564ceec5e0bce71e370239d9
  - url: https://github.com/nodejs/node/tree/96a4559f259f109a2abc480caeba12644b8a8fd1
    reference_type: commit
    reference_id: 96a4559f259f109a2abc480caeba12644b8a8fd1
  - url: https://github.com/nodejs/node/tree/a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b
    reference_type: commit
    reference_id: a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b
  - url: https://github.com/nodejs/node/tree/b558e9f476506099252a346b202a093245f73360
    reference_type: commit
    reference_id: b558e9f476506099252a346b202a093245f73360
  - url: https://github.com/nodejs/node/tree/d0ece3094845c66a69e5cd72be956ae526ae3f11
    reference_type: commit
    reference_id: d0ece3094845c66a69e5cd72be956ae526ae3f11
  - url: https://github.com/nodejs/node/tree/dd1977f3ddda8bb0b939699cae998e4e72d3677a
    reference_type: commit
    reference_id: dd1977f3ddda8bb0b939699cae998e4e72d3677a
