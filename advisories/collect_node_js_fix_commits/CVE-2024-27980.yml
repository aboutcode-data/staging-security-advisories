advisory_id: CVE-2024-27980
datasource_id: collect_node_js_fix_commits/CVE-2024-27980
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  4fe0f826a80365ce2512b8193ceaa9466c288aa5:2024-07-08, Version 22.4.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/617
  0881c1f01ac90006315cae5b9c38cfbf44d37e59:2024-07-08, Version 20.15.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/608
  4324e11935659a2ed2d17f84bc87b9c9198b4fdf:2024-07-08, Version 18.20.4 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/609
  8512434d2beea2ca2fcb85d13175fa30a95ecf77:2024-07-08, Version 22.4.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/617
  a407d1f0b3669cc82c755700f0d500fb27cc39ea:2024-07-08, Version 20.15.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/608
  e922fb64b53530af4ad2e3df298a302225645f5b:2024-07-08, Version 18.20.4 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/609
  4a6ca7a1d42d861b1679d842c51cf2571bd7f8df:src: remove erroneous CVE-2024-27980 revert option

  No security reverts should exist on the main branch.

  PR-URL: https://github.com/nodejs/node/pull/52543
  Reviewed-By: Richard Lau <rlau@redhat.com>
  Reviewed-By: Yagiz Nizipli <yagiz.nizipli@sentry.io>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Reviewed-By: Luigi Pinca <luigipinca@gmail.com>
  3790d524c1781334ccc504a6eb510bc53ee2ad64:src: remove erroneous CVE-2024-27980 revert option

  No security reverts should exist on the main branch.

  PR-URL: https://github.com/nodejs/node/pull/52543
  Reviewed-By: Richard Lau <rlau@redhat.com>
  Reviewed-By: Yagiz Nizipli <yagiz.nizipli@sentry.io>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Reviewed-By: Luigi Pinca <luigipinca@gmail.com>
  64b67779f72ea9e4a0f444284576df9e591d79a0:src: disallow direct .bat and .cmd file spawning

  An undocumented feature of the Win32 CreateProcess API allows spawning
  batch files directly but is potentially insecure because arguments are
  not escaped (and sometimes cannot be unambiguously escaped), hence why
  they are refused starting today.

  PR-URL: https://github.com/nodejs-private/node-private/pull/560
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-27980
  9095c914ed8467cf16f077a3fac20b1f1e89bbe4:src: disallow direct .bat and .cmd file spawning

  An undocumented feature of the Win32 CreateProcess API allows spawning
  batch files directly but is potentially insecure because arguments are
  not escaped (and sometimes cannot be unambiguously escaped), hence why
  they are refused starting today.

  PR-URL: https://github.com/nodejs-private/node-private/pull/562
  Reviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Reviewed-By: Marco Ippolito <marcoippolito54@gmail.com>
  CVE-ID: CVE-2024-27980
  69ffc6d50dbd9d7d0257f5b9b403026e1aa205ee:src: disallow direct .bat and .cmd file spawning

  An undocumented feature of the Win32 CreateProcess API allows spawning
  batch files directly but is potentially insecure because arguments are
  not escaped (and sometimes cannot be unambiguously escaped), hence why
  they are refused starting today.

  PR-URL: https://github.com/nodejs-private/node-private/pull/563
  Reviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-27980
  662722240928668e4b16822be2f660fc6d957340:src: disallow direct .bat and .cmd file spawning

  An undocumented feature of the Win32 CreateProcess API allows spawning
  batch files directly but is potentially insecure because arguments are
  not escaped (and sometimes cannot be unambiguously escaped), hence why
  they are refused starting today.

  PR-URL: https://github.com/nodejs-private/node-private/pull/564
  Reviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-27980
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 64b67779f72ea9e4a0f444284576df9e591d79a0
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9095c914ed8467cf16f077a3fac20b1f1e89bbe4
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4a6ca7a1d42d861b1679d842c51cf2571bd7f8df
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e922fb64b53530af4ad2e3df298a302225645f5b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a407d1f0b3669cc82c755700f0d500fb27cc39ea
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4324e11935659a2ed2d17f84bc87b9c9198b4fdf
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0881c1f01ac90006315cae5b9c38cfbf44d37e59
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 69ffc6d50dbd9d7d0257f5b9b403026e1aa205ee
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 662722240928668e4b16822be2f660fc6d957340
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 3790d524c1781334ccc504a6eb510bc53ee2ad64
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8512434d2beea2ca2fcb85d13175fa30a95ecf77
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4fe0f826a80365ce2512b8193ceaa9466c288aa5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/0881c1f01ac90006315cae5b9c38cfbf44d37e59
    reference_type: commit
    reference_id: 0881c1f01ac90006315cae5b9c38cfbf44d37e59
  - url: https://github.com/nodejs/node/tree/3790d524c1781334ccc504a6eb510bc53ee2ad64
    reference_type: commit
    reference_id: 3790d524c1781334ccc504a6eb510bc53ee2ad64
  - url: https://github.com/nodejs/node/tree/4324e11935659a2ed2d17f84bc87b9c9198b4fdf
    reference_type: commit
    reference_id: 4324e11935659a2ed2d17f84bc87b9c9198b4fdf
  - url: https://github.com/nodejs/node/tree/4a6ca7a1d42d861b1679d842c51cf2571bd7f8df
    reference_type: commit
    reference_id: 4a6ca7a1d42d861b1679d842c51cf2571bd7f8df
  - url: https://github.com/nodejs/node/tree/4fe0f826a80365ce2512b8193ceaa9466c288aa5
    reference_type: commit
    reference_id: 4fe0f826a80365ce2512b8193ceaa9466c288aa5
  - url: https://github.com/nodejs/node/tree/64b67779f72ea9e4a0f444284576df9e591d79a0
    reference_type: commit
    reference_id: 64b67779f72ea9e4a0f444284576df9e591d79a0
  - url: https://github.com/nodejs/node/tree/662722240928668e4b16822be2f660fc6d957340
    reference_type: commit
    reference_id: 662722240928668e4b16822be2f660fc6d957340
  - url: https://github.com/nodejs/node/tree/69ffc6d50dbd9d7d0257f5b9b403026e1aa205ee
    reference_type: commit
    reference_id: 69ffc6d50dbd9d7d0257f5b9b403026e1aa205ee
  - url: https://github.com/nodejs/node/tree/8512434d2beea2ca2fcb85d13175fa30a95ecf77
    reference_type: commit
    reference_id: 8512434d2beea2ca2fcb85d13175fa30a95ecf77
  - url: https://github.com/nodejs/node/tree/9095c914ed8467cf16f077a3fac20b1f1e89bbe4
    reference_type: commit
    reference_id: 9095c914ed8467cf16f077a3fac20b1f1e89bbe4
  - url: https://github.com/nodejs/node/tree/a407d1f0b3669cc82c755700f0d500fb27cc39ea
    reference_type: commit
    reference_id: a407d1f0b3669cc82c755700f0d500fb27cc39ea
  - url: https://github.com/nodejs/node/tree/e922fb64b53530af4ad2e3df298a302225645f5b
    reference_type: commit
    reference_id: e922fb64b53530af4ad2e3df298a302225645f5b
