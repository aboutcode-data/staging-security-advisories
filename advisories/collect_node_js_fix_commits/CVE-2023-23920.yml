advisory_id: CVE-2023-23920
datasource_id: collect_node_js_fix_commits/CVE-2023-23920
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  dd1977f3ddda8bb0b939699cae998e4e72d3677a:2023-02-16, Version 19.6.1 (Current)

  This is a security release.

  The following CVEs are fixed in this release:

  - CVE-2023-23919: OpenSSL errors not cleared in error stack (Medium)
  - CVE-2023-23918: Experimental Policies bypass via `process.mainModule.require`(High)
  - CVE-2023-23920: Insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: #385
  667dd34d794bae01051fcdceb6b24a12a9a43859:2023-02-16, Version 18.14.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: https://github.com/nodejs-private/node-private/pull/386
  5c4a287c3e43854d5c91293ede41bdf7996e567f:2023-02-16, Version 16.19.1 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via
    process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs
    crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA
    environment variable (Low)

  Fixed by an update to undici:

  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
    See https://github.com/nodejs/undici/security/advisories/GHSA-5r9g-qh6m-jxff
    for more information.
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
    See https://github.com/nodejs/undici/security/advisories/GHSA-r6ch-mqf9-qc9w
    for more information.

  - OpenSSL 1.1.1t

  PR-URL: https://github.com/nodejs-private/node-private/pull/390
  6aca711858cc8d4b011384977c543d65ed17aeab:2023-02-16, Version 14.21.3 'Fermium' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  * CVE-2023-23918: Node.js Permissions policies can be bypassed via process.mainModule (High)
  * CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA environment variable (Low)

  * OpenSSL 1.1.1t
  * npm 6.14.18

  PR-URL: https://github.com/nodejs-private/node-private/pull/389
  Refs: https://nodejs.org/en/blog/vulnerability/february-2023-security-releases
  96a4559f259f109a2abc480caeba12644b8a8fd1:2023-02-16, Version 16.19.1 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via
    process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs
    crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA
    environment variable (Low)

  Fixed by an update to undici:

  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
    See https://github.com/nodejs/undici/security/advisories/GHSA-5r9g-qh6m-jxff
    for more information.
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
    See https://github.com/nodejs/undici/security/advisories/GHSA-r6ch-mqf9-qc9w
    for more information.

  - OpenSSL 1.1.1t

  PR-URL: https://github.com/nodejs-private/node-private/pull/390
  7bc2cf7fa9a2016fadb27e042968a69297bd975e:2023-02-16, Version 18.14.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: https://github.com/nodejs-private/node-private/pull/386
  edd64fe5ba20c6c2f53720c672c591f09d9d4ac0:2023-02-16, Version 14.21.3 'Fermium' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  * CVE-2023-23918: Node.js Permissions policies can be bypassed via process.mainModule (High)
  * CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA environment variable (Low)

  * OpenSSL 1.1.1t
  * npm 6.14.18

  PR-URL: https://github.com/nodejs-private/node-private/pull/389
  Refs: https://nodejs.org/en/blog/vulnerability/february-2023-security-releases
  8393ebc72daa122e07b66559ad944042d67bb886:build: build ICU with ICU_NO_USER_DATA_OVERRIDE

  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/379
  CVE-ID: CVE-2023-23920
  PR-URL: https://github.com/nodejs-private/node-private/pull/374
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1625036
  Reviewed-By: Richard Lau <rlau@redhat.com>
  a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b:2023-02-16, Version 19.6.1 (Current)

  This is a security release.

  The following CVEs are fixed in this release:

  - CVE-2023-23919: OpenSSL errors not cleared in error stack (Medium)
  - CVE-2023-23918: Experimental Policies bypass via `process.mainModule.require`(High)
  - CVE-2023-23920: Insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: #385
  7fef050447da21194b2df030149676cd88e0abe1:build: build ICU with ICU_NO_USER_DATA_OVERRIDE

  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/378
  CVE-ID: CVE-2023-23920
  PR-URL: https://github.com/nodejs-private/node-private/pull/374
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1625036
  Reviewed-By: Ben Noordhuis <info@bnoordhuis.nl>
  Reviewed-By: Richard Lau <rlau@redhat.com>
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  97a0443f1369e65cf656a529b2f5433bfd56ad92:build: build ICU with ICU_NO_USER_DATA_OVERRIDE

  CVE-ID: CVE-2023-23920
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/377
  PR-URL: https://github.com/nodejs-private/node-private/pull/374
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1625036
  Reviewed-By: Ben Noordhuis <info@bnoordhuis.nl>
  Reviewed-By: Richard Lau <rlau@redhat.com>
  Reviewed-By: Michael Dawson <midawson@redhat.com>
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 5c4a287c3e43854d5c91293ede41bdf7996e567f
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: edd64fe5ba20c6c2f53720c672c591f09d9d4ac0
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: dd1977f3ddda8bb0b939699cae998e4e72d3677a
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6aca711858cc8d4b011384977c543d65ed17aeab
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8393ebc72daa122e07b66559ad944042d67bb886
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 7bc2cf7fa9a2016fadb27e042968a69297bd975e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 7fef050447da21194b2df030149676cd88e0abe1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 667dd34d794bae01051fcdceb6b24a12a9a43859
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 97a0443f1369e65cf656a529b2f5433bfd56ad92
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 96a4559f259f109a2abc480caeba12644b8a8fd1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/5c4a287c3e43854d5c91293ede41bdf7996e567f
    reference_type: commit
    reference_id: 5c4a287c3e43854d5c91293ede41bdf7996e567f
  - url: https://github.com/nodejs/node/tree/667dd34d794bae01051fcdceb6b24a12a9a43859
    reference_type: commit
    reference_id: 667dd34d794bae01051fcdceb6b24a12a9a43859
  - url: https://github.com/nodejs/node/tree/6aca711858cc8d4b011384977c543d65ed17aeab
    reference_type: commit
    reference_id: 6aca711858cc8d4b011384977c543d65ed17aeab
  - url: https://github.com/nodejs/node/tree/7bc2cf7fa9a2016fadb27e042968a69297bd975e
    reference_type: commit
    reference_id: 7bc2cf7fa9a2016fadb27e042968a69297bd975e
  - url: https://github.com/nodejs/node/tree/7fef050447da21194b2df030149676cd88e0abe1
    reference_type: commit
    reference_id: 7fef050447da21194b2df030149676cd88e0abe1
  - url: https://github.com/nodejs/node/tree/8393ebc72daa122e07b66559ad944042d67bb886
    reference_type: commit
    reference_id: 8393ebc72daa122e07b66559ad944042d67bb886
  - url: https://github.com/nodejs/node/tree/96a4559f259f109a2abc480caeba12644b8a8fd1
    reference_type: commit
    reference_id: 96a4559f259f109a2abc480caeba12644b8a8fd1
  - url: https://github.com/nodejs/node/tree/97a0443f1369e65cf656a529b2f5433bfd56ad92
    reference_type: commit
    reference_id: 97a0443f1369e65cf656a529b2f5433bfd56ad92
  - url: https://github.com/nodejs/node/tree/a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b
    reference_type: commit
    reference_id: a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b
  - url: https://github.com/nodejs/node/tree/dd1977f3ddda8bb0b939699cae998e4e72d3677a
    reference_type: commit
    reference_id: dd1977f3ddda8bb0b939699cae998e4e72d3677a
  - url: https://github.com/nodejs/node/tree/edd64fe5ba20c6c2f53720c672c591f09d9d4ac0
    reference_type: commit
    reference_id: edd64fe5ba20c6c2f53720c672c591f09d9d4ac0
