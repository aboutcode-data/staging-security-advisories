advisory_id: CVE-2020-8172
datasource_id: collect_node_js_fix_commits/CVE-2020-8172
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  12bcee8628c101c2a89debff11502b6a982d5f3a:2020-06-02, Version 12.18.0 'Erbium' (LTS)

  This is a security release.

  Notable changes:

  Vulnerabilities fixed:
  CVE-2020-8172: TLS session reuse can lead to host certificate verification bypass (High).
  CVE-2020-11080: HTTP/2 Large Settings Frame DoS (Low).
  CVE-2020-8174: `napi_get_value_string_*()` allows various kinds of memory corruption (High).

  PR-URL: https://github.com/nodejs-private/node-private/pull/213
  64e33dc9529d3cf63edd2ccb0d406cc3812ee23a:2020-06-02, Version 14.4.0 (Current)

  This is a security release.

  Notable changes:

  Vulnerabilities fixed:
  CVE-2020-8172: TLS session reuse can lead to host certificate verification bypass (High).
  CVE-2020-11080: HTTP/2 Large Settings Frame DoS (Low).
  CVE-2020-8174: `napi_get_value_string_*()` allows various kinds of memory corruption (High).

  PR-URL: https://github.com/nodejs-private/node-private/pull/212
  2e1b41a708a71ee127a5db9c750760f74db494e4:tls: emit `session` after verifying certificate

  Prior to this patch `session` event was emitted after `secure` event on
  TLSSocket, but before `secureConnect` event. This is problematic for
  `https.Agent` because it must cache session only after verifying the
  remote peer's certificate.

  Connecting to a server that presents an invalid certificate resulted
  in the session being cached after the handshake with the server and
  evicted right after a certifiate validation error and socket's
  destruction. A request initiated during this narrow window would pick
  the faulty session, send it to the malicious server and skip the
  verification of the server's certificate.

  Fixes: https://hackerone.com/reports/811502
  CVE-ID: CVE-2020-8172
  PR-URL: https://github.com/nodejs-private/node-private/pull/200
  Reviewed-By: Sam Roberts <vieuxtech@gmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Ben Noordhuis <info@bnoordhuis.nl>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Colin Ihrig <cjihrig@gmail.com>
  Reviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>
  f19f5b34d7c4e9a4e339b40bc791c78469091704:2020-06-02, Version 12.18.0 'Erbium' (LTS)

  This is a security release.

  Notable changes:

  Vulnerabilities fixed:
  CVE-2020-8172: TLS session reuse can lead to host certificate verification bypass (High).
  CVE-2020-11080: HTTP/2 Large Settings Frame DoS (Low).
  CVE-2020-8174: `napi_get_value_string_*()` allows various kinds of memory corruption (High).

  PR-URL: https://github.com/nodejs-private/node-private/pull/213
  0932309af2d9d66611cf5387f2cc925a80cb441f:tls: emit `session` after verifying certificate

  Prior to this patch `session` event was emitted after `secure` event on
  TLSSocket, but before `secureConnect` event. This is problematic for
  `https.Agent` because it must cache session only after verifying the
  remote peer's certificate.

  Connecting to a server that presents an invalid certificate resulted
  in the session being cached after the handshake with the server and
  evicted right after a certifiate validation error and socket's
  destruction. A request initiated during this narrow window would pick
  the faulty session, send it to the malicious server and skip the
  verification of the server's certificate.

  Fixes: https://hackerone.com/reports/811502
  CVE-ID: CVE-2020-8172
  PR-URL: https://github.com/nodejs-private/node-private/pull/200
  Reviewed-By: Sam Roberts <vieuxtech@gmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Ben Noordhuis <info@bnoordhuis.nl>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Colin Ihrig <cjihrig@gmail.com>
  Reviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>
  27adbf027f2dd3a75b22518f6825e1a1937059d1:2020-06-02, Version 14.4.0 (Current)

  This is a security release.

  Notable changes:

  Vulnerabilities fixed:
  CVE-2020-8172: TLS session reuse can lead to host certificate verification bypass (High).
  CVE-2020-11080: HTTP/2 Large Settings Frame DoS (Low).
  CVE-2020-8174: `napi_get_value_string_*()` allows various kinds of memory corruption (High).

  PR-URL: https://github.com/nodejs-private/node-private/pull/212
  94571c100131bda7d8780d2b789feecb98ef65d6:tls: emit `session` after verifying certificate

  Prior to this patch `session` event was emitted after `secure` event on
  TLSSocket, but before `secureConnect` event. This is problematic for
  `https.Agent` because it must cache session only after verifying the
  remote peer's certificate.

  Connecting to a server that presents an invalid certificate resulted
  in the session being cached after the handshake with the server and
  evicted right after a certifiate validation error and socket's
  destruction. A request initiated during this narrow window would pick
  the faulty session, send it to the malicious server and skip the
  verification of the server's certificate.

  Fixes: https://hackerone.com/reports/811502
  CVE-ID: CVE-2020-8172
  PR-URL: https://github.com/nodejs-private/node-private/pull/200
  Reviewed-By: Sam Roberts <vieuxtech@gmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Ben Noordhuis <info@bnoordhuis.nl>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Colin Ihrig <cjihrig@gmail.com>
  Reviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: f19f5b34d7c4e9a4e339b40bc791c78469091704
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 94571c100131bda7d8780d2b789feecb98ef65d6
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 12bcee8628c101c2a89debff11502b6a982d5f3a
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 64e33dc9529d3cf63edd2ccb0d406cc3812ee23a
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 2e1b41a708a71ee127a5db9c750760f74db494e4
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 27adbf027f2dd3a75b22518f6825e1a1937059d1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0932309af2d9d66611cf5387f2cc925a80cb441f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/0932309af2d9d66611cf5387f2cc925a80cb441f
    reference_type: commit
    reference_id: 0932309af2d9d66611cf5387f2cc925a80cb441f
  - url: https://github.com/nodejs/node/tree/12bcee8628c101c2a89debff11502b6a982d5f3a
    reference_type: commit
    reference_id: 12bcee8628c101c2a89debff11502b6a982d5f3a
  - url: https://github.com/nodejs/node/tree/27adbf027f2dd3a75b22518f6825e1a1937059d1
    reference_type: commit
    reference_id: 27adbf027f2dd3a75b22518f6825e1a1937059d1
  - url: https://github.com/nodejs/node/tree/2e1b41a708a71ee127a5db9c750760f74db494e4
    reference_type: commit
    reference_id: 2e1b41a708a71ee127a5db9c750760f74db494e4
  - url: https://github.com/nodejs/node/tree/64e33dc9529d3cf63edd2ccb0d406cc3812ee23a
    reference_type: commit
    reference_id: 64e33dc9529d3cf63edd2ccb0d406cc3812ee23a
  - url: https://github.com/nodejs/node/tree/94571c100131bda7d8780d2b789feecb98ef65d6
    reference_type: commit
    reference_id: 94571c100131bda7d8780d2b789feecb98ef65d6
  - url: https://github.com/nodejs/node/tree/f19f5b34d7c4e9a4e339b40bc791c78469091704
    reference_type: commit
    reference_id: f19f5b34d7c4e9a4e339b40bc791c78469091704
