advisory_id: CVE-2023-30588
datasource_id: collect_node_js_fix_commits/CVE-2023-30588
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  e8a1affab0b31b3586baef2ece978e449d40ce3d:crypto: handle cert with invalid SPKI gracefully

  When attempting to convert the SPKI of a X509Certificate to a KeyObject,
  throw an error if the subjectPublicKey cannot be parsed instead of
  aborting the process.

  Fixes: https://hackerone.com/bugs?report_id=1884159
  PR-URL: https://github.com/nodejs-private/node-private/pull/393
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  CVE-ID: CVE-2023-30588
  b607b74a4fb3640fc958cff1ff81ca7558134e9d:2023-06-20, Version 18.16.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)
  * OpenSSL Security Releases
    * https://www.openssl.org/news/secadv/20230328.txt
    * https://www.openssl.org/news/secadv/20230420.txt
    * https://www.openssl.org/news/secadv/20230530.txt
  * c-ares vulnerabilities:
    * GHSA-9g78-jv2r-p7vc
    * GHSA-8r8p-23f3-64c2
    * GHSA-54xr-f67r-4pc4
    * GHSA-x6mf-cxr9-8q6v

  PR-URL: https://github.com/nodejs-private/node-private/pull/434
  167dc77d85e97db5f8dcbcf110ade634944e02f9:2023-06-20, Version 20.3.1 (Current)

  This is a security release.

  Notable Changes

  The following CVEs are fixed in this release:
  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30584: Path Traversal Bypass in Experimental Permission Model (High)
  * CVE-2023-30587: Bypass of Experimental Permission Model via Node.js Inspector (High)
  * CVE-2023-30582: Inadequate Permission Model Allows Unauthorized File Watching (Medium)
  * CVE-2023-30583: Bypass of Experimental Permission Model via fs.openAsBlob() (Medium)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30586: Bypass of Experimental Permission Model via Arbitrary OpenSSL Engines (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)

  * OpenSSL Security Releases
    * [OpenSSL security advisory 28th March](https://www.openssl.org/news/secadv/20230328.txt).
    * [OpenSSL security advisory 20th April](https://www.openssl.org/news/secadv/20230420.txt).
    * [OpenSSL security advisory 30th May](https://www.openssl.org/news/secadv/20230530.txt)

  PR-URL: https://github.com/nodejs-private/node-private/pull/435
  c09acb3ea82fab3553e40b68f923a9b9f00c8eba:2023-06-20, Version 16.20.1 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)
  * OpenSSL Security Releases
    * https://www.openssl.org/news/secadv/20230328.txt
    * https://www.openssl.org/news/secadv/20230420.txt
    * https://www.openssl.org/news/secadv/20230530.txt
  * c-ares vulnerabilities:
    * GHSA-9g78-jv2r-p7vc
    * GHSA-8r8p-23f3-64c2
    * GHSA-54xr-f67r-4pc4
    * GHSA-x6mf-cxr9-8q6v

  PR-URL: https://github.com/nodejs-private/node-private/pull/432
  9869bdc93d7bd8b439c4a2598607ee779483ee53:2023-06-20, Version 20.3.1 (Current)

  This is a security release.

  Notable Changes

  The following CVEs are fixed in this release:
  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30584: Path Traversal Bypass in Experimental Permission Model (High)
  * CVE-2023-30587: Bypass of Experimental Permission Model via Node.js Inspector (High)
  * CVE-2023-30582: Inadequate Permission Model Allows Unauthorized File Watching (Medium)
  * CVE-2023-30583: Bypass of Experimental Permission Model via fs.openAsBlob() (Medium)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30586: Bypass of Experimental Permission Model via Arbitrary OpenSSL Engines (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)

  * OpenSSL Security Releases
    * [OpenSSL security advisory 28th March](https://www.openssl.org/news/secadv/20230328.txt).
    * [OpenSSL security advisory 20th April](https://www.openssl.org/news/secadv/20230420.txt).
    * [OpenSSL security advisory 30th May](https://www.openssl.org/news/secadv/20230530.txt)

  PR-URL: https://github.com/nodejs-private/node-private/pull/435
  8658efe376838821be7f9b4ff25c8bc2e229bb92:2023-06-20, Version 18.16.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)
  * OpenSSL Security Releases
    * https://www.openssl.org/news/secadv/20230328.txt
    * https://www.openssl.org/news/secadv/20230420.txt
    * https://www.openssl.org/news/secadv/20230530.txt
  * c-ares vulnerabilities:
    * GHSA-9g78-jv2r-p7vc
    * GHSA-8r8p-23f3-64c2
    * GHSA-54xr-f67r-4pc4
    * GHSA-x6mf-cxr9-8q6v

  PR-URL: https://github.com/nodejs-private/node-private/pull/434
  bf3e2c8928dcbab08d024aa9ebda226b4a7f99b3:crypto: handle cert with invalid SPKI gracefully

  When attempting to convert the SPKI of a X509Certificate to a KeyObject,
  throw an error if the subjectPublicKey cannot be parsed instead of
  aborting the process.

  Fixes: https://hackerone.com/bugs?report_id=1884159
  PR-URL: https://github.com/nodejs-private/node-private/pull/393
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  CVE-ID: CVE-2023-30588
  b53c51995380b1f8d642297d848cab6010d2909c:2023-06-20, Version 16.20.1 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)
  * OpenSSL Security Releases
    * https://www.openssl.org/news/secadv/20230328.txt
    * https://www.openssl.org/news/secadv/20230420.txt
    * https://www.openssl.org/news/secadv/20230530.txt
  * c-ares vulnerabilities:
    * GHSA-9g78-jv2r-p7vc
    * GHSA-8r8p-23f3-64c2
    * GHSA-54xr-f67r-4pc4
    * GHSA-x6mf-cxr9-8q6v

  PR-URL: https://github.com/nodejs-private/node-private/pull/432
  5a92ea7a3b6210f04c902e177f9dc673ae866393:crypto: handle cert with invalid SPKI gracefully

  When attempting to convert the SPKI of a X509Certificate to a KeyObject,
  throw an error if the subjectPublicKey cannot be parsed instead of
  aborting the process.

  Fixes: https://hackerone.com/bugs?report_id=1884159
  PR-URL: https://github.com/nodejs-private/node-private/pull/393/
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  CVE-ID: CVE-2023-30588
  dac08dafc9f26a6ffd25e786d57d8d147fe64316:crypto: handle cert with invalid SPKI gracefully

  When attempting to convert the SPKI of a X509Certificate to a KeyObject,
  throw an error if the subjectPublicKey cannot be parsed instead of
  aborting the process.

  Fixes: https://hackerone.com/bugs?report_id=1884159
  PR-URL: https://github.com/nodejs-private/node-private/pull/393
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  CVE-ID: CVE-2023-30588
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 167dc77d85e97db5f8dcbcf110ade634944e02f9
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: bf3e2c8928dcbab08d024aa9ebda226b4a7f99b3
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b607b74a4fb3640fc958cff1ff81ca7558134e9d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: c09acb3ea82fab3553e40b68f923a9b9f00c8eba
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8658efe376838821be7f9b4ff25c8bc2e229bb92
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e8a1affab0b31b3586baef2ece978e449d40ce3d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 5a92ea7a3b6210f04c902e177f9dc673ae866393
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: dac08dafc9f26a6ffd25e786d57d8d147fe64316
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b53c51995380b1f8d642297d848cab6010d2909c
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9869bdc93d7bd8b439c4a2598607ee779483ee53
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/167dc77d85e97db5f8dcbcf110ade634944e02f9
    reference_type: commit
    reference_id: 167dc77d85e97db5f8dcbcf110ade634944e02f9
  - url: https://github.com/nodejs/node/tree/5a92ea7a3b6210f04c902e177f9dc673ae866393
    reference_type: commit
    reference_id: 5a92ea7a3b6210f04c902e177f9dc673ae866393
  - url: https://github.com/nodejs/node/tree/8658efe376838821be7f9b4ff25c8bc2e229bb92
    reference_type: commit
    reference_id: 8658efe376838821be7f9b4ff25c8bc2e229bb92
  - url: https://github.com/nodejs/node/tree/9869bdc93d7bd8b439c4a2598607ee779483ee53
    reference_type: commit
    reference_id: 9869bdc93d7bd8b439c4a2598607ee779483ee53
  - url: https://github.com/nodejs/node/tree/b53c51995380b1f8d642297d848cab6010d2909c
    reference_type: commit
    reference_id: b53c51995380b1f8d642297d848cab6010d2909c
  - url: https://github.com/nodejs/node/tree/b607b74a4fb3640fc958cff1ff81ca7558134e9d
    reference_type: commit
    reference_id: b607b74a4fb3640fc958cff1ff81ca7558134e9d
  - url: https://github.com/nodejs/node/tree/bf3e2c8928dcbab08d024aa9ebda226b4a7f99b3
    reference_type: commit
    reference_id: bf3e2c8928dcbab08d024aa9ebda226b4a7f99b3
  - url: https://github.com/nodejs/node/tree/c09acb3ea82fab3553e40b68f923a9b9f00c8eba
    reference_type: commit
    reference_id: c09acb3ea82fab3553e40b68f923a9b9f00c8eba
  - url: https://github.com/nodejs/node/tree/dac08dafc9f26a6ffd25e786d57d8d147fe64316
    reference_type: commit
    reference_id: dac08dafc9f26a6ffd25e786d57d8d147fe64316
  - url: https://github.com/nodejs/node/tree/e8a1affab0b31b3586baef2ece978e449d40ce3d
    reference_type: commit
    reference_id: e8a1affab0b31b3586baef2ece978e449d40ce3d
