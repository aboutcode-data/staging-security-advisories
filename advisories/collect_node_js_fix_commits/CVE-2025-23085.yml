advisory_id: CVE-2025-23085
datasource_id: collect_node_js_fix_commits/CVE-2025-23085
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  1b693fa03a0d36bc1dc9ec8d95060e3e5ceeee7b:src: fix HTTP2 mem leak on premature close and ERR_PROTO

  This commit fixes a memory leak when the socket is
  suddenly closed by the peer (without GOAWAY notification)
  and when invalid header (by nghttp2) is identified and the
  connection is terminated by peer.

  Refs: https://hackerone.com/reports/2841362
  PR-URL: https://github.com/nodejs-private/node-private/pull/650
  Reviewed-By: James M Snell <jasnell@gmail.com>
  CVE-ID: CVE-2025-23085
  d07c60b08fbb293555678a6892b0854b2cd771d0:2025-01-21, Version 18.20.6 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2025-23084 - fix path traversal in normalize() on Windows (Medium)
  * CVE-2025-23085 - fix HTTP2 mem leak on premature close and ERR_PROTO
  * CVE-2025-22150 - Use of Insufficiently Random Values in undici fetch() (Medium)
    (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/659
  3efbb0dfb489d9051c0b765de803f65cecefcdeb:2025-01-21, Version 20.18.2 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2025-23083 - throw on InternalWorker use when permission model is enabled (High)
  * CVE-2025-23085 - src: fix HTTP2 mem leak on premature close and ERR_PROTO (Medium)
  * CVE-2025-23084 - path: fix path traversal in normalize() on Windows (Medium)
  * CVE-2025-22150 - Use of Insufficiently Random Values in undici fetch() (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/664
  e81c809d9d430894d5787f0f366c7377643c2cfc:2025-01-21, Version 22.13.1 'Jod' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2025-23083: throw on InternalWorker use when permission model is enabled (High)
  * CVE-2025-23084: fix path traversal in normalize() on Windows (Medium)
  * CVE-2025-23085: fix HTTP2 mem leak on premature close and ERR_PROTO (Medium)
  * CVE-2025-22150 - Use of Insufficiently Random Values in undici fetch() (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/655
  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>
  b845dc6fbeb0684b83e314dd2233958e95166aa2:2025-01-21, Version 23.6.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2025-23083: throw on InternalWorker use when permission model is enabled (High)
  * CVE-2025-23084: fix path traversal in normalize() on Windows (Medium)
  * CVE-2025-23085: fix HTTP2 mem leak on premature close and ERR_PROTO (Medium)
  * CVE-2025-22150 - Use of Insufficiently Random Values in undici fetch() (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/654
  25a01ea40d60a3cec56263fef109d00d638208c0:2025-01-21, Version 23.6.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2025-23083: throw on InternalWorker use when permission model is enabled (High)
  * CVE-2025-23084: fix path traversal in normalize() on Windows (Medium)
  * CVE-2025-23085: fix HTTP2 mem leak on premature close and ERR_PROTO (Medium)
  * CVE-2025-22150 - Use of Insufficiently Random Values in undici fetch() (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/654
  3c7686163ed4c6ae3e5901b758b7a7d4fd5bb0c0:src: fix HTTP2 mem leak on premature close and ERR_PROTO

  This commit fixes a memory leak when the socket is
  suddenly closed by the peer (without GOAWAY notification)
  and when invalid header (by nghttp2) is identified and the
  connection is terminated by peer.

  Refs: https://hackerone.com/reports/2841362
  PR-URL: https://github.com/nodejs-private/node-private/pull/650
  Reviewed-By: James M Snell <jasnell@gmail.com>
  CVE-ID: CVE-2025-23085
  e6c7018aa5db77c2cb720c5662eab12ff3320bf4:2025-01-21, Version 22.13.1 'Jod' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2025-23083: throw on InternalWorker use when permission model is enabled (High)
  * CVE-2025-23084: fix path traversal in normalize() on Windows (Medium)
  * CVE-2025-23085: fix HTTP2 mem leak on premature close and ERR_PROTO (Medium)
  * CVE-2025-22150 - Use of Insufficiently Random Values in undici fetch() (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/655
  984f735e35da5a0b628446d202991c509a482ac5:src: fix HTTP2 mem leak on premature close and ERR_PROTO

  This commit fixes a memory leak when the socket is
  suddenly closed by the peer (without GOAWAY notification)
  and when invalid header (by nghttp2) is identified and the
  connection is terminated by peer.

  Refs: https://hackerone.com/reports/2841362
  PR-URL: https://github.com/nodejs-private/node-private/pull/650
  Reviewed-By: James M Snell <jasnell@gmail.com>
  CVE-ID: CVE-2025-23085
  53a57efd83a18efe7a84bf1b460acc789139939b:2025-01-21, Version 20.18.2 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2025-23083 - throw on InternalWorker use when permission model is enabled (High)
  * CVE-2025-23085 - src: fix HTTP2 mem leak on premature close and ERR_PROTO (Medium)
  * CVE-2025-23084 - path: fix path traversal in normalize() on Windows (Medium)
  * CVE-2025-22150 - Use of Insufficiently Random Values in undici fetch() (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/664
  60224762462585b64a17ee007d7f657e1b66758c:2025-01-21, Version 18.20.6 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2025-23084 - fix path traversal in normalize() on Windows (Medium)
  * CVE-2025-23085 - fix HTTP2 mem leak on premature close and ERR_PROTO
  * CVE-2025-22150 - Use of Insufficiently Random Values in undici fetch() (Medium)
    (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/659
  6cc8d58e6f97c37c228f134bd9b98246c8871fb1:src: fix HTTP2 mem leak on premature close and ERR_PROTO

  This commit fixes a memory leak when the socket is
  suddenly closed by the peer (without GOAWAY notification)
  and when invalid header (by nghttp2) is identified and the
  connection is terminated by peer.

  Refs: https://hackerone.com/reports/2841362
  PR-URL: https://github.com/nodejs-private/node-private/pull/650
  Reviewed-By: James M Snell <jasnell@gmail.com>
  CVE-ID: CVE-2025-23085
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 3c7686163ed4c6ae3e5901b758b7a7d4fd5bb0c0
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e81c809d9d430894d5787f0f366c7377643c2cfc
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 25a01ea40d60a3cec56263fef109d00d638208c0
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e6c7018aa5db77c2cb720c5662eab12ff3320bf4
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6cc8d58e6f97c37c228f134bd9b98246c8871fb1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 60224762462585b64a17ee007d7f657e1b66758c
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b845dc6fbeb0684b83e314dd2233958e95166aa2
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: d07c60b08fbb293555678a6892b0854b2cd771d0
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1b693fa03a0d36bc1dc9ec8d95060e3e5ceeee7b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 984f735e35da5a0b628446d202991c509a482ac5
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 53a57efd83a18efe7a84bf1b460acc789139939b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 3efbb0dfb489d9051c0b765de803f65cecefcdeb
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/1b693fa03a0d36bc1dc9ec8d95060e3e5ceeee7b
    reference_type: commit
    reference_id: 1b693fa03a0d36bc1dc9ec8d95060e3e5ceeee7b
  - url: https://github.com/nodejs/node/tree/25a01ea40d60a3cec56263fef109d00d638208c0
    reference_type: commit
    reference_id: 25a01ea40d60a3cec56263fef109d00d638208c0
  - url: https://github.com/nodejs/node/tree/3c7686163ed4c6ae3e5901b758b7a7d4fd5bb0c0
    reference_type: commit
    reference_id: 3c7686163ed4c6ae3e5901b758b7a7d4fd5bb0c0
  - url: https://github.com/nodejs/node/tree/3efbb0dfb489d9051c0b765de803f65cecefcdeb
    reference_type: commit
    reference_id: 3efbb0dfb489d9051c0b765de803f65cecefcdeb
  - url: https://github.com/nodejs/node/tree/53a57efd83a18efe7a84bf1b460acc789139939b
    reference_type: commit
    reference_id: 53a57efd83a18efe7a84bf1b460acc789139939b
  - url: https://github.com/nodejs/node/tree/60224762462585b64a17ee007d7f657e1b66758c
    reference_type: commit
    reference_id: 60224762462585b64a17ee007d7f657e1b66758c
  - url: https://github.com/nodejs/node/tree/6cc8d58e6f97c37c228f134bd9b98246c8871fb1
    reference_type: commit
    reference_id: 6cc8d58e6f97c37c228f134bd9b98246c8871fb1
  - url: https://github.com/nodejs/node/tree/984f735e35da5a0b628446d202991c509a482ac5
    reference_type: commit
    reference_id: 984f735e35da5a0b628446d202991c509a482ac5
  - url: https://github.com/nodejs/node/tree/b845dc6fbeb0684b83e314dd2233958e95166aa2
    reference_type: commit
    reference_id: b845dc6fbeb0684b83e314dd2233958e95166aa2
  - url: https://github.com/nodejs/node/tree/d07c60b08fbb293555678a6892b0854b2cd771d0
    reference_type: commit
    reference_id: d07c60b08fbb293555678a6892b0854b2cd771d0
  - url: https://github.com/nodejs/node/tree/e6c7018aa5db77c2cb720c5662eab12ff3320bf4
    reference_type: commit
    reference_id: e6c7018aa5db77c2cb720c5662eab12ff3320bf4
  - url: https://github.com/nodejs/node/tree/e81c809d9d430894d5787f0f366c7377643c2cfc
    reference_type: commit
    reference_id: e81c809d9d430894d5787f0f366c7377643c2cfc
