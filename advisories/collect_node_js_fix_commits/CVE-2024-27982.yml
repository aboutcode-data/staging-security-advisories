advisory_id: CVE-2024-27982
datasource_id: collect_node_js_fix_commits/CVE-2024-27982
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  bd0aa5d44c894a170863de369dde6fc45faac0c2:http: do not allow OBS fold in headers by default

  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Fixes: https://hackerone.com/reports/2237099
  PR-URL: https://github.com/nodejs-private/node-private/pull/556
  CVE-ID: CVE-2024-27982
  04e16463d1bb6b7797f077f5257d9e1bb638ff06:http: do not allow OBS fold in headers by default

  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Fixes: https://hackerone.com/reports/2237099
  PR-URL: https://github.com/nodejs-private/node-private/pull/556
  CVE-ID: CVE-2024-27982
  6590a8c4e44923d6fbf6548db37e93f5049f73db:2024-04-03, Version 18.20.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-27983 - Assertion failed in node::http2::Http2Session::\~Http2Session() leads to HTTP/2 server crash- (High)
  * CVE-2024-27982 - HTTP Request Smuggling via Content Length Obfuscation - (Medium)
  * llhttp version 9.2.1
  * undici version 5.28.4

  PR-URL: https://github.com/nodejs-private/node-private/pull/573
  24d036ba4564dbb54da4b1714da806bdba5ee688:2024-04-03, Version 20.12.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-27983 - Assertion failed in node::http2::Http2Session::\~Http2Session() leads to HTTP/2 server crash- (High)
  * CVE-2024-27982 - HTTP Request Smuggling via Content Length Obfuscation - (Medium)
  * llhttp version 9.2.1
  * undici version 5.28.4

  PR-URL: https://github.com/nodejs-private/node-private/pull/575/
  957a99c82b82c865c8f74091c29f49c3c217b1fd:2024-04-03, Version 20.12.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-27983 - Assertion failed in node::http2::Http2Session::\~Http2Session() leads to HTTP/2 server crash- (High)
  * CVE-2024-27982 - HTTP Request Smuggling via Content Length Obfuscation - (Medium)
  * llhttp version 9.2.1
  * undici version 5.28.4

  PR-URL: https://github.com/nodejs-private/node-private/pull/575/
  1d526a47af29d59ad196c4e05606b0ec6f8090d9:2024-04-03, Version 18.20.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-27983 - Assertion failed in node::http2::Http2Session::\~Http2Session() leads to HTTP/2 server crash- (High)
  * CVE-2024-27982 - HTTP Request Smuggling via Content Length Obfuscation - (Medium)
  * llhttp version 9.2.1
  * undici version 5.28.4

  PR-URL: https://github.com/nodejs-private/node-private/pull/573
  5d4d5848cf557fba6dc0bfdd020471ea607950ca:http: do not allow OBS fold in headers by default

  PR-URL: https://github.com/nodejs-private/node-private/pull/558
  Refs: https://github.com/nodejs-private/node-private/pull/556
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-27982
  1a65e98e22c9e0daf782801273d64bb52c689318:http: do not allow OBS fold in headers by default

  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Fixes: https://hackerone.com/reports/2237099
  PR-URL: https://github.com/nodejs-private/node-private/pull/556
  CVE-ID: CVE-2024-27982
  5e34540a965e62591678850d14b095f2235d67be:http: do not allow OBS fold in headers by default

  PR-URL: https://github.com/nodejs-private/node-private/pull/557
  Refs: https://github.com/nodejs-private/node-private/pull/556
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-27982
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 5e34540a965e62591678850d14b095f2235d67be
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: bd0aa5d44c894a170863de369dde6fc45faac0c2
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 5d4d5848cf557fba6dc0bfdd020471ea607950ca
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6590a8c4e44923d6fbf6548db37e93f5049f73db
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 957a99c82b82c865c8f74091c29f49c3c217b1fd
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 24d036ba4564dbb54da4b1714da806bdba5ee688
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1d526a47af29d59ad196c4e05606b0ec6f8090d9
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 04e16463d1bb6b7797f077f5257d9e1bb638ff06
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1a65e98e22c9e0daf782801273d64bb52c689318
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/04e16463d1bb6b7797f077f5257d9e1bb638ff06
    reference_type: commit
    reference_id: 04e16463d1bb6b7797f077f5257d9e1bb638ff06
  - url: https://github.com/nodejs/node/tree/1a65e98e22c9e0daf782801273d64bb52c689318
    reference_type: commit
    reference_id: 1a65e98e22c9e0daf782801273d64bb52c689318
  - url: https://github.com/nodejs/node/tree/1d526a47af29d59ad196c4e05606b0ec6f8090d9
    reference_type: commit
    reference_id: 1d526a47af29d59ad196c4e05606b0ec6f8090d9
  - url: https://github.com/nodejs/node/tree/24d036ba4564dbb54da4b1714da806bdba5ee688
    reference_type: commit
    reference_id: 24d036ba4564dbb54da4b1714da806bdba5ee688
  - url: https://github.com/nodejs/node/tree/5d4d5848cf557fba6dc0bfdd020471ea607950ca
    reference_type: commit
    reference_id: 5d4d5848cf557fba6dc0bfdd020471ea607950ca
  - url: https://github.com/nodejs/node/tree/5e34540a965e62591678850d14b095f2235d67be
    reference_type: commit
    reference_id: 5e34540a965e62591678850d14b095f2235d67be
  - url: https://github.com/nodejs/node/tree/6590a8c4e44923d6fbf6548db37e93f5049f73db
    reference_type: commit
    reference_id: 6590a8c4e44923d6fbf6548db37e93f5049f73db
  - url: https://github.com/nodejs/node/tree/957a99c82b82c865c8f74091c29f49c3c217b1fd
    reference_type: commit
    reference_id: 957a99c82b82c865c8f74091c29f49c3c217b1fd
  - url: https://github.com/nodejs/node/tree/bd0aa5d44c894a170863de369dde6fc45faac0c2
    reference_type: commit
    reference_id: bd0aa5d44c894a170863de369dde6fc45faac0c2
