advisory_id: CVE-2021-22930
datasource_id: collect_node_js_fix_commits/CVE-2021-22930
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  ea47d836403fa055861b01ea791f9b2da7ee7e7e:2021-08-11, Version 16.6.2 (Current)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/280
  02b145083e4aa442c7c171904a68ea7e268b7af0:2021-08-11, Version 14.17.5 'Fermium' (LTS)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/279
  e973b55c86886961a913e1138b72fafb875c214a:2021-08-11, Version 12.22.5 'Erbium' (LTS)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/278
  bfe80913e88139da1aa283475cdbc060ea98ae6f:2021-08-11, Version 16.6.2 (Current)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/280
  db159ab870b1aa7f55e4e450c81764f22bf0ef80:2021-08-11, Version 14.17.5 'Fermium' (LTS)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/279
  151261efb8b85696620f80ecc1f50d9c1f886a1b:2021-08-11, Version 12.22.5 'Erbium' (LTS)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/278
  2008c9722fcf7591e39013691f303934b622df7b:http2: update handling of rst_stream with error code NGHTTP2_CANCEL

  The PR updates the handling of rst_stream frames and adds all streams
  to the pending list on receiving rst frames with the error code
  NGHTTP2_CANCEL.

  The changes will remove dependency on the stream state that may allow
  bypassing the checks in certain cases. I think a better solution is to
  delay streams in all cases if rst_stream is received for the cancel
  events.

  The rst_stream frames can be received for protocol/connection error as
  well it should be handled immediately. Adding streams to the pending
  list in such cases may cause errors.

  CVE-ID: CVE-2021-22930
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22930
  Backport-PR-URL: https://github.com/nodejs/node/pull/39659
  PR-URL: https://github.com/nodejs/node/pull/39622
  Refs: https://github.com/nodejs/node/pull/39423
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Beth Griggs <bgriggs@redhat.com>
  2008c9722fcf7591e39013691f303934b622df7b:http2: update handling of rst_stream with error code NGHTTP2_CANCEL

  The PR updates the handling of rst_stream frames and adds all streams
  to the pending list on receiving rst frames with the error code
  NGHTTP2_CANCEL.

  The changes will remove dependency on the stream state that may allow
  bypassing the checks in certain cases. I think a better solution is to
  delay streams in all cases if rst_stream is received for the cancel
  events.

  The rst_stream frames can be received for protocol/connection error as
  well it should be handled immediately. Adding streams to the pending
  list in such cases may cause errors.

  CVE-ID: CVE-2021-22930
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22930
  Backport-PR-URL: https://github.com/nodejs/node/pull/39659
  PR-URL: https://github.com/nodejs/node/pull/39622
  Refs: https://github.com/nodejs/node/pull/39423
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Beth Griggs <bgriggs@redhat.com>
  434872e83886e0ec39c6e7d3454a7f7e8d9cba94:http2: update handling of rst_stream with error code NGHTTP2_CANCEL

  The PR updates the handling of rst_stream frames and adds all streams
  to the pending list on receiving rst frames with the error code
  NGHTTP2_CANCEL.

  The changes will remove dependency on the stream state that may allow
  bypassing the checks in certain cases. I think a better solution is to
  delay streams in all cases if rst_stream is received for the cancel
  events.

  The rst_stream frames can be received for protocol/connection error as
  well it should be handled immediately. Adding streams to the pending
  list in such cases may cause errors.

  CVE-ID: CVE-2021-22930
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22930
  PR-URL: https://github.com/nodejs/node/pull/39622
  Refs: https://github.com/nodejs/node/pull/39423
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Beth Griggs <bgriggs@redhat.com>
  434872e83886e0ec39c6e7d3454a7f7e8d9cba94:http2: update handling of rst_stream with error code NGHTTP2_CANCEL

  The PR updates the handling of rst_stream frames and adds all streams
  to the pending list on receiving rst frames with the error code
  NGHTTP2_CANCEL.

  The changes will remove dependency on the stream state that may allow
  bypassing the checks in certain cases. I think a better solution is to
  delay streams in all cases if rst_stream is received for the cancel
  events.

  The rst_stream frames can be received for protocol/connection error as
  well it should be handled immediately. Adding streams to the pending
  list in such cases may cause errors.

  CVE-ID: CVE-2021-22930
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22930
  PR-URL: https://github.com/nodejs/node/pull/39622
  Refs: https://github.com/nodejs/node/pull/39423
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Beth Griggs <bgriggs@redhat.com>
  a3c33d4ce78f74d1cf1765704af5b427aa3840a6:http2: update handling of rst_stream with error code NGHTTP2_CANCEL

  The PR updates the handling of rst_stream frames and adds all streams
  to the pending list on receiving rst frames with the error code
  NGHTTP2_CANCEL.

  The changes will remove dependency on the stream state that may allow
  bypassing the checks in certain cases. I think a better solution is to
  delay streams in all cases if rst_stream is received for the cancel
  events.

  The rst_stream frames can be received for protocol/connection error as
  well it should be handled immediately. Adding streams to the pending
  list in such cases may cause errors.

  CVE-ID: CVE-2021-22930
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22930
  PR-URL: https://github.com/nodejs/node/pull/39622
  Refs: https://github.com/nodejs/node/pull/39423
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Beth Griggs <bgriggs@redhat.com>
  a3c33d4ce78f74d1cf1765704af5b427aa3840a6:http2: update handling of rst_stream with error code NGHTTP2_CANCEL

  The PR updates the handling of rst_stream frames and adds all streams
  to the pending list on receiving rst frames with the error code
  NGHTTP2_CANCEL.

  The changes will remove dependency on the stream state that may allow
  bypassing the checks in certain cases. I think a better solution is to
  delay streams in all cases if rst_stream is received for the cancel
  events.

  The rst_stream frames can be received for protocol/connection error as
  well it should be handled immediately. Adding streams to the pending
  list in such cases may cause errors.

  CVE-ID: CVE-2021-22930
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22930
  PR-URL: https://github.com/nodejs/node/pull/39622
  Refs: https://github.com/nodejs/node/pull/39423
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Beth Griggs <bgriggs@redhat.com>
  0e22fa0f3d690fad6d76672e835f38f81b7bbd2f:2021-07-29, Version 16.6.0 (Current)

  This is a security release.

  Notable Changes:

  - CVE-2021-22930: Use after free on close http2 on stream canceling
    (High) [#39423](https://github.com/nodejs/node/pull/39423)
  - (SEMVER-MINOR) deps: update V8 to 9.2.230.21 (Michaël Zasso)
    [#39470](https://github.com/nodejs/node/pull/39470)
  - inspector: mark as stable (Gireesh Punathil)
    [#37748](https://github.com/nodejs/node/pull/37748)
  - punycode: add pending deprecation (Antoine du Hamel)
    [#38444](https://github.com/nodejs/node/pull/38444)
  - (SEMVER-MINOR) repl: enable --experimental-repl-await /w opt-out
    (hemanth.hm) [#34733](https://github.com/nodejs/node/pull/34733)

  PR-URL: https://github.com/nodejs/node/pull/39534
  8d2e66cae33472f5d4017444fd4116a4db5667d2:2021-07-29, Version 16.6.0 (Current)

  This is a security release.

  Notable Changes:

  - CVE-2021-22930: Use after free on close http2 on stream canceling
    (High) [#39423](https://github.com/nodejs/node/pull/39423)
  - (SEMVER-MINOR) deps: update V8 to 9.2.230.21 (Michaël Zasso)
    [#39470](https://github.com/nodejs/node/pull/39470)
  - inspector: mark as stable (Gireesh Punathil)
    [#37748](https://github.com/nodejs/node/pull/37748)
  - punycode: add pending deprecation (Antoine du Hamel)
    [#38444](https://github.com/nodejs/node/pull/38444)
  - (SEMVER-MINOR) repl: enable --experimental-repl-await /w opt-out
    (hemanth.hm) [#34733](https://github.com/nodejs/node/pull/34733)

  PR-URL: https://github.com/nodejs/node/pull/39534
  bd33fdfadf1ffd79c99b4057bd2dc32c520e94d2:2021-07-29, Version 14.17.4 'Fermium' (LTS)

  This is a security release.

  Notable Changes:

  - CVE-2021-22930: Use after free on close http2 on stream canceling (High)

  This releases fixes some regressions with internationalization
  introduced by the ICU updates in Node.js 14.17.0 and 14.17.1.

  PR-URL: https://github.com/nodejs/node/pull/39466
  9b4199450ede4e9e3784f9c875215cd46963df84:2021-07-29, Version 12.22.4 'Erbium' (LTS)

  This is a security release.

  Notable changes:

  - CVE-2021-22930: Use after free on close http2 on stream canceling (High)

  PR-URL: https://github.com/nodejs/node/pull/39500
  488c27f71c56436af303dd6a99e4a4f82acd2e1b:2021-07-29, Version 14.17.4 'Fermium' (LTS)

  This is a security release.

  Notable Changes:

  - CVE-2021-22930: Use after free on close http2 on stream canceling (High)

  This releases fixes some regressions with internationalization
  introduced by the ICU updates in Node.js 14.17.0 and 14.17.1.

  PR-URL: https://github.com/nodejs/node/pull/39466
  2fdf98954de7336b841f5835a5cabcbf085c873b:2021-07-29, Version 12.22.4 'Erbium' (LTS)

  This is a security release.

  Notable changes:

  - CVE-2021-22930: Use after free on close http2 on stream canceling (High)

  PR-URL: https://github.com/nodejs/node/pull/39500
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8d2e66cae33472f5d4017444fd4116a4db5667d2
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: bd33fdfadf1ffd79c99b4057bd2dc32c520e94d2
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: bfe80913e88139da1aa283475cdbc060ea98ae6f
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 02b145083e4aa442c7c171904a68ea7e268b7af0
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a3c33d4ce78f74d1cf1765704af5b427aa3840a6
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: db159ab870b1aa7f55e4e450c81764f22bf0ef80
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0e22fa0f3d690fad6d76672e835f38f81b7bbd2f
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 434872e83886e0ec39c6e7d3454a7f7e8d9cba94
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 2008c9722fcf7591e39013691f303934b622df7b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e973b55c86886961a913e1138b72fafb875c214a
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 151261efb8b85696620f80ecc1f50d9c1f886a1b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 488c27f71c56436af303dd6a99e4a4f82acd2e1b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 2fdf98954de7336b841f5835a5cabcbf085c873b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: ea47d836403fa055861b01ea791f9b2da7ee7e7e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9b4199450ede4e9e3784f9c875215cd46963df84
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/02b145083e4aa442c7c171904a68ea7e268b7af0
    reference_type: commit
    reference_id: 02b145083e4aa442c7c171904a68ea7e268b7af0
  - url: https://github.com/nodejs/node/tree/0e22fa0f3d690fad6d76672e835f38f81b7bbd2f
    reference_type: commit
    reference_id: 0e22fa0f3d690fad6d76672e835f38f81b7bbd2f
  - url: https://github.com/nodejs/node/tree/151261efb8b85696620f80ecc1f50d9c1f886a1b
    reference_type: commit
    reference_id: 151261efb8b85696620f80ecc1f50d9c1f886a1b
  - url: https://github.com/nodejs/node/tree/2008c9722fcf7591e39013691f303934b622df7b
    reference_type: commit
    reference_id: 2008c9722fcf7591e39013691f303934b622df7b
  - url: https://github.com/nodejs/node/tree/2fdf98954de7336b841f5835a5cabcbf085c873b
    reference_type: commit
    reference_id: 2fdf98954de7336b841f5835a5cabcbf085c873b
  - url: https://github.com/nodejs/node/tree/434872e83886e0ec39c6e7d3454a7f7e8d9cba94
    reference_type: commit
    reference_id: 434872e83886e0ec39c6e7d3454a7f7e8d9cba94
  - url: https://github.com/nodejs/node/tree/488c27f71c56436af303dd6a99e4a4f82acd2e1b
    reference_type: commit
    reference_id: 488c27f71c56436af303dd6a99e4a4f82acd2e1b
  - url: https://github.com/nodejs/node/tree/8d2e66cae33472f5d4017444fd4116a4db5667d2
    reference_type: commit
    reference_id: 8d2e66cae33472f5d4017444fd4116a4db5667d2
  - url: https://github.com/nodejs/node/tree/9b4199450ede4e9e3784f9c875215cd46963df84
    reference_type: commit
    reference_id: 9b4199450ede4e9e3784f9c875215cd46963df84
  - url: https://github.com/nodejs/node/tree/a3c33d4ce78f74d1cf1765704af5b427aa3840a6
    reference_type: commit
    reference_id: a3c33d4ce78f74d1cf1765704af5b427aa3840a6
  - url: https://github.com/nodejs/node/tree/bd33fdfadf1ffd79c99b4057bd2dc32c520e94d2
    reference_type: commit
    reference_id: bd33fdfadf1ffd79c99b4057bd2dc32c520e94d2
  - url: https://github.com/nodejs/node/tree/bfe80913e88139da1aa283475cdbc060ea98ae6f
    reference_type: commit
    reference_id: bfe80913e88139da1aa283475cdbc060ea98ae6f
  - url: https://github.com/nodejs/node/tree/db159ab870b1aa7f55e4e450c81764f22bf0ef80
    reference_type: commit
    reference_id: db159ab870b1aa7f55e4e450c81764f22bf0ef80
  - url: https://github.com/nodejs/node/tree/e973b55c86886961a913e1138b72fafb875c214a
    reference_type: commit
    reference_id: e973b55c86886961a913e1138b72fafb875c214a
  - url: https://github.com/nodejs/node/tree/ea47d836403fa055861b01ea791f9b2da7ee7e7e
    reference_type: commit
    reference_id: ea47d836403fa055861b01ea791f9b2da7ee7e7e
