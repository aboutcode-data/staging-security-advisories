advisory_id: CVE-2024-36138
datasource_id: collect_node_js_fix_commits/CVE-2024-36138
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  39f207023a0f3d4cf3d54f2983da5f775d22e8ca:src: handle permissive extension on cmd check

  PR-URL: https://github.com/nodejs-private/node-private/pull/596
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  CVE-ID: CVE-2024-36138
  4fe0f826a80365ce2512b8193ceaa9466c288aa5:2024-07-08, Version 22.4.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/617
  0881c1f01ac90006315cae5b9c38cfbf44d37e59:2024-07-08, Version 20.15.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/608
  4324e11935659a2ed2d17f84bc87b9c9198b4fdf:2024-07-08, Version 18.20.4 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/609
  8512434d2beea2ca2fcb85d13175fa30a95ecf77:2024-07-08, Version 22.4.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/617
  09899e6302050862f2236586f23dc350442953eb:src: handle permissive extension on cmd check

  PR-URL: https://github.com/nodejs-private/node-private/pull/596
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  CVE-ID: CVE-2024-36138
  a407d1f0b3669cc82c755700f0d500fb27cc39ea:2024-07-08, Version 20.15.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/608
  1ba624cd3b169af9531432743b1d5e36f6458c79:src: handle permissive extension on cmd check

  PR-URL: https://github.com/nodejs-private/node-private/pull/596
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/605
  CVE-ID: CVE-2024-36138
  e922fb64b53530af4ad2e3df298a302225645f5b:2024-07-08, Version 18.20.4 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/609
  eccd63b865dd0b6e57b5b858274774081bdd4ba2:src: handle permissive extension on cmd check

  PR-URL: https://github.com/nodejs-private/node-private/pull/596
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/603
  CVE-ID: CVE-2024-36138
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 09899e6302050862f2236586f23dc350442953eb
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: eccd63b865dd0b6e57b5b858274774081bdd4ba2
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e922fb64b53530af4ad2e3df298a302225645f5b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a407d1f0b3669cc82c755700f0d500fb27cc39ea
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1ba624cd3b169af9531432743b1d5e36f6458c79
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4324e11935659a2ed2d17f84bc87b9c9198b4fdf
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0881c1f01ac90006315cae5b9c38cfbf44d37e59
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 39f207023a0f3d4cf3d54f2983da5f775d22e8ca
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8512434d2beea2ca2fcb85d13175fa30a95ecf77
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4fe0f826a80365ce2512b8193ceaa9466c288aa5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/0881c1f01ac90006315cae5b9c38cfbf44d37e59
    reference_type: commit
    reference_id: 0881c1f01ac90006315cae5b9c38cfbf44d37e59
  - url: https://github.com/nodejs/node/tree/09899e6302050862f2236586f23dc350442953eb
    reference_type: commit
    reference_id: 09899e6302050862f2236586f23dc350442953eb
  - url: https://github.com/nodejs/node/tree/1ba624cd3b169af9531432743b1d5e36f6458c79
    reference_type: commit
    reference_id: 1ba624cd3b169af9531432743b1d5e36f6458c79
  - url: https://github.com/nodejs/node/tree/39f207023a0f3d4cf3d54f2983da5f775d22e8ca
    reference_type: commit
    reference_id: 39f207023a0f3d4cf3d54f2983da5f775d22e8ca
  - url: https://github.com/nodejs/node/tree/4324e11935659a2ed2d17f84bc87b9c9198b4fdf
    reference_type: commit
    reference_id: 4324e11935659a2ed2d17f84bc87b9c9198b4fdf
  - url: https://github.com/nodejs/node/tree/4fe0f826a80365ce2512b8193ceaa9466c288aa5
    reference_type: commit
    reference_id: 4fe0f826a80365ce2512b8193ceaa9466c288aa5
  - url: https://github.com/nodejs/node/tree/8512434d2beea2ca2fcb85d13175fa30a95ecf77
    reference_type: commit
    reference_id: 8512434d2beea2ca2fcb85d13175fa30a95ecf77
  - url: https://github.com/nodejs/node/tree/a407d1f0b3669cc82c755700f0d500fb27cc39ea
    reference_type: commit
    reference_id: a407d1f0b3669cc82c755700f0d500fb27cc39ea
  - url: https://github.com/nodejs/node/tree/e922fb64b53530af4ad2e3df298a302225645f5b
    reference_type: commit
    reference_id: e922fb64b53530af4ad2e3df298a302225645f5b
  - url: https://github.com/nodejs/node/tree/eccd63b865dd0b6e57b5b858274774081bdd4ba2
    reference_type: commit
    reference_id: eccd63b865dd0b6e57b5b858274774081bdd4ba2
