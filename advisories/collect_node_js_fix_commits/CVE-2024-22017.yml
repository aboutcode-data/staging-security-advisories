advisory_id: CVE-2024-22017
datasource_id: collect_node_js_fix_commits/CVE-2024-22017
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  6d14352c51974f0ba1a11e9e4889e61dae9da1f4:src,deps: disable setuid() etc if io_uring enabled

  Within Node.js, attempt to determine if libuv is using io_uring. If it
  is, disable process.setuid() and other user identity setters.

  We cannot fully prevent users from changing the process's user identity,
  but this should still prevent some accidental, dangerous scenarios.

  PR-URL: https://github.com/nodejs-private/node-private/pull/528
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-22017
  42e659cb9d9425f76dbe9b57a437005508c0933d:deps: disable io_uring support in libuv by default

  setuid() does not affect libuv's internal io_uring operations if
  initialized before the call to setuid(). This potentially allows the
  process to perform privileged operations despite presumably having
  dropped such privileges through a call to setuid(). Similar concerns
  apply to other functions that modify the process's user identity.

  This commit changes libuv's io_uring behavior from opt-out (through
  UV_USE_IO_URING=0) to opt-in (through UV_USE_IO_URING=1) until we figure
  out a better long-term solution.

  PR-URL: https://github.com/nodejs-private/node-private/pull/528
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-22017
  3f6addd590360991503007d625d85034cb22c6d8:src,deps: disable setuid() etc if io_uring enabled

  Within Node.js, attempt to determine if libuv is using io_uring. If it
  is, disable process.setuid() and other user identity setters.

  We cannot fully prevent users from changing the process's user identity,
  but this should still prevent some accidental, dangerous scenarios.

  PR-URL: https://github.com/nodejs-private/node-private/pull/529
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-22017
  686da19abbb83b7e01d48be19f832ab081b87084:deps: disable io_uring support in libuv by default

  setuid() does not affect libuv's internal io_uring operations if
  initialized before the call to setuid(). This potentially allows the
  process to perform privileged operations despite presumably having
  dropped such privileges through a call to setuid(). Similar concerns
  apply to other functions that modify the process's user identity.

  This commit changes libuv's io_uring behavior from opt-out (through
  UV_USE_IO_URING=0) to opt-in (through UV_USE_IO_URING=1) until we figure
  out a better long-term solution.

  PR-URL: https://github.com/nodejs-private/node-private/pull/529
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-22017
  fc2454f29c69a23f0fa4262819437e379a4a78a6:src,deps: disable setuid() etc if io_uring enabled

  Within Node.js, attempt to determine if libuv is using io_uring. If it
  is, disable process.setuid() and other user identity setters.

  We cannot fully prevent users from changing the process's user identity,
  but this should still prevent some accidental, dangerous scenarios.

  PR-URL: https://github.com/nodejs-private/node-private/pull/528
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-22017
  666096298c34349d8c41d20b1a331835522deab8:deps: disable io_uring support in libuv by default

  setuid() does not affect libuv's internal io_uring operations if
  initialized before the call to setuid(). This potentially allows the
  process to perform privileged operations despite presumably having
  dropped such privileges through a call to setuid(). Similar concerns
  apply to other functions that modify the process's user identity.

  This commit changes libuv's io_uring behavior from opt-out (through
  UV_USE_IO_URING=0) to opt-in (through UV_USE_IO_URING=1) until we figure
  out a better long-term solution.

  PR-URL: https://github.com/nodejs-private/node-private/pull/528
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-22017
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 686da19abbb83b7e01d48be19f832ab081b87084
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 3f6addd590360991503007d625d85034cb22c6d8
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: fc2454f29c69a23f0fa4262819437e379a4a78a6
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 666096298c34349d8c41d20b1a331835522deab8
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 42e659cb9d9425f76dbe9b57a437005508c0933d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6d14352c51974f0ba1a11e9e4889e61dae9da1f4
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/3f6addd590360991503007d625d85034cb22c6d8
    reference_type: commit
    reference_id: 3f6addd590360991503007d625d85034cb22c6d8
  - url: https://github.com/nodejs/node/tree/42e659cb9d9425f76dbe9b57a437005508c0933d
    reference_type: commit
    reference_id: 42e659cb9d9425f76dbe9b57a437005508c0933d
  - url: https://github.com/nodejs/node/tree/666096298c34349d8c41d20b1a331835522deab8
    reference_type: commit
    reference_id: 666096298c34349d8c41d20b1a331835522deab8
  - url: https://github.com/nodejs/node/tree/686da19abbb83b7e01d48be19f832ab081b87084
    reference_type: commit
    reference_id: 686da19abbb83b7e01d48be19f832ab081b87084
  - url: https://github.com/nodejs/node/tree/6d14352c51974f0ba1a11e9e4889e61dae9da1f4
    reference_type: commit
    reference_id: 6d14352c51974f0ba1a11e9e4889e61dae9da1f4
  - url: https://github.com/nodejs/node/tree/fc2454f29c69a23f0fa4262819437e379a4a78a6
    reference_type: commit
    reference_id: fc2454f29c69a23f0fa4262819437e379a4a78a6
