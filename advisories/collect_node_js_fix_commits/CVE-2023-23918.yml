advisory_id: CVE-2023-23918
datasource_id: collect_node_js_fix_commits/CVE-2023-23918
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  9b7db62276e4a9c97aedf91daf38bf7b7d23fee4:lib: makeRequireFunction patch when experimental policy

  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>

  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1747642
  CVE-ID: CVE-2023-23918
  PR-URL: https://github.com/nodejs-private/node-private/pull/358
  Reviewed-by: Bradley Farias <bradley.meck@gmail.com>
  Reviewed-by: Matteo Collina <matteo.collina@gmail.com>
  af9140088621abd09016848f4526d66b7a81b9ba:policy: makeRequireFunction on mainModule.require

  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>

  Co-authored-by: Bradley Farias <bradley.meck@gmail.com>
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1747642
  CVE-ID: CVE-2023-23918
  PR-URL: https://github.com/nodejs-private/node-private/pull/358
  Reviewed-by: Bradley Farias <bradley.meck@gmail.com>
  Reviewed-by: Matteo Collina <matteo.collina@gmail.com>
  dd1977f3ddda8bb0b939699cae998e4e72d3677a:2023-02-16, Version 19.6.1 (Current)

  This is a security release.

  The following CVEs are fixed in this release:

  - CVE-2023-23919: OpenSSL errors not cleared in error stack (Medium)
  - CVE-2023-23918: Experimental Policies bypass via `process.mainModule.require`(High)
  - CVE-2023-23920: Insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: #385
  667dd34d794bae01051fcdceb6b24a12a9a43859:2023-02-16, Version 18.14.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: https://github.com/nodejs-private/node-private/pull/386
  5c4a287c3e43854d5c91293ede41bdf7996e567f:2023-02-16, Version 16.19.1 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via
    process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs
    crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA
    environment variable (Low)

  Fixed by an update to undici:

  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
    See https://github.com/nodejs/undici/security/advisories/GHSA-5r9g-qh6m-jxff
    for more information.
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
    See https://github.com/nodejs/undici/security/advisories/GHSA-r6ch-mqf9-qc9w
    for more information.

  - OpenSSL 1.1.1t

  PR-URL: https://github.com/nodejs-private/node-private/pull/390
  6aca711858cc8d4b011384977c543d65ed17aeab:2023-02-16, Version 14.21.3 'Fermium' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  * CVE-2023-23918: Node.js Permissions policies can be bypassed via process.mainModule (High)
  * CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA environment variable (Low)

  * OpenSSL 1.1.1t
  * npm 6.14.18

  PR-URL: https://github.com/nodejs-private/node-private/pull/389
  Refs: https://nodejs.org/en/blog/vulnerability/february-2023-security-releases
  96a4559f259f109a2abc480caeba12644b8a8fd1:2023-02-16, Version 16.19.1 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via
    process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs
    crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA
    environment variable (Low)

  Fixed by an update to undici:

  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF
    injection in host headers (Medium)
    See https://github.com/nodejs/undici/security/advisories/GHSA-5r9g-qh6m-jxff
    for more information.
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in
    Node.js fetch API (Low)
    See https://github.com/nodejs/undici/security/advisories/GHSA-r6ch-mqf9-qc9w
    for more information.

  - OpenSSL 1.1.1t

  PR-URL: https://github.com/nodejs-private/node-private/pull/390
  f95ef064f41ddba49b5f9b3c75b57f255aee5297:lib: makeRequireFunction patch when experimental policy

  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/372
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1747642
  CVE-ID: CVE-2023-23918
  PR-URL: https://github.com/nodejs-private/node-private/pull/358
  Reviewed-by: Bradley Farias <bradley.meck@gmail.com>
  Reviewed-by: Michael Dawson <midawson@redhat.com>
  b02d895137eea92fc140a53d26b867fb462cdf44:policy: makeRequireFunction on mainModule.require

  Co-authored-by: Bradley Farias <bradley.meck@gmail.com>
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/372
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1747642
  CVE-ID: CVE-2023-23918
  PR-URL: https://github.com/nodejs-private/node-private/pull/358
  Reviewed-by: Bradley Farias <bradley.meck@gmail.com>
  Reviewed-by: Michael Dawson <midawson@redhat.com>
  7bc2cf7fa9a2016fadb27e042968a69297bd975e:2023-02-16, Version 18.14.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  - CVE-2023-23918: Node.js Permissions policies can be bypassed via process.mainModule (High)
  - CVE-2023-23919: Node.js OpenSSL error handling issues in nodejs crypto library (Medium)
  - CVE-2023-23936: Fetch API in Node.js did not protect against CRLF injection in host headers (Medium)
  - CVE-2023-24807: Regular Expression Denial of Service in Headers in Node.js fetch API (Low)
  - CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: https://github.com/nodejs-private/node-private/pull/386
  edd64fe5ba20c6c2f53720c672c591f09d9d4ac0:2023-02-16, Version 14.21.3 'Fermium' (LTS)

  This is a security release.

  Notable changes:

  The following CVEs are fixed in this release:

  * CVE-2023-23918: Node.js Permissions policies can be bypassed via process.mainModule (High)
  * CVE-2023-23920: Node.js insecure loading of ICU data through ICU_DATA environment variable (Low)

  * OpenSSL 1.1.1t
  * npm 6.14.18

  PR-URL: https://github.com/nodejs-private/node-private/pull/389
  Refs: https://nodejs.org/en/blog/vulnerability/february-2023-security-releases
  f7892c16be6507e26c2ae478c261fa3fa2d84f52:lib: makeRequireFunction patch when experimental policy

  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/373
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1747642
  CVE-ID: CVE-2023-23918
  PR-URL: https://github.com/nodejs-private/node-private/pull/358
  Reviewed-by: Bradley Farias <bradley.meck@gmail.com>
  Reviewed-by: Michael Dawson <midawson@redhat.com>
  83975b7fb463e29c92c8e83693b725e269cee149:policy: makeRequireFunction on mainModule.require

  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>
  Co-authored-by: Bradley Farias <bradley.meck@gmail.com>
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/373
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1747642
  CVE-ID: CVE-2023-23918
  PR-URL: https://github.com/nodejs-private/node-private/pull/358
  Reviewed-by: Bradley Farias <bradley.meck@gmail.com>
  Reviewed-by: Michael Dawson <midawson@redhat.com>
  a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b:2023-02-16, Version 19.6.1 (Current)

  This is a security release.

  The following CVEs are fixed in this release:

  - CVE-2023-23919: OpenSSL errors not cleared in error stack (Medium)
  - CVE-2023-23918: Experimental Policies bypass via `process.mainModule.require`(High)
  - CVE-2023-23920: Insecure loading of ICU data through ICU_DATA environment variable (Low)
  - OpenSSL 3.0.8
  - undici 5.19.1

  PR-URL: #385
  2aae1976707d2bf074d6002ae47b93ba48d155e3:lib: makeRequireFunction patch when experimental policy

  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-23918
  PR-URL: #358
  Co-authored-by: Bradley Farias <bradley.meck@gmail.com>
  Reviewed-by: Bradley Farias <bradley.meck@gmail.com>
  Reviewed-by: Michael Dawson <midawson@redhat.com>
  6d17b693eccfb1a8f34893458c0c67dedd1c30c6:policy: makeRequireFunction on mainModule.require

  Signed-off-by: RafaelGSS <rafael.nunu@hotmail.com>

  Co-authored-by: Bradley Farias <bradley.meck@gmail.com>
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=1747642
  CVE-ID: CVE-2023-23918
  PR-URL: #358
  Reviewed-by: Bradley Farias <bradley.meck@gmail.com>
  Reviewed-by: Michael Dawson <midawson@redhat.com>
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: af9140088621abd09016848f4526d66b7a81b9ba
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 5c4a287c3e43854d5c91293ede41bdf7996e567f
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: edd64fe5ba20c6c2f53720c672c591f09d9d4ac0
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 83975b7fb463e29c92c8e83693b725e269cee149
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: dd1977f3ddda8bb0b939699cae998e4e72d3677a
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6aca711858cc8d4b011384977c543d65ed17aeab
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 96a4559f259f109a2abc480caeba12644b8a8fd1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 2aae1976707d2bf074d6002ae47b93ba48d155e3
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b02d895137eea92fc140a53d26b867fb462cdf44
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 7bc2cf7fa9a2016fadb27e042968a69297bd975e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: f7892c16be6507e26c2ae478c261fa3fa2d84f52
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: f95ef064f41ddba49b5f9b3c75b57f255aee5297
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 667dd34d794bae01051fcdceb6b24a12a9a43859
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9b7db62276e4a9c97aedf91daf38bf7b7d23fee4
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6d17b693eccfb1a8f34893458c0c67dedd1c30c6
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/2aae1976707d2bf074d6002ae47b93ba48d155e3
    reference_type: commit
    reference_id: 2aae1976707d2bf074d6002ae47b93ba48d155e3
  - url: https://github.com/nodejs/node/tree/5c4a287c3e43854d5c91293ede41bdf7996e567f
    reference_type: commit
    reference_id: 5c4a287c3e43854d5c91293ede41bdf7996e567f
  - url: https://github.com/nodejs/node/tree/667dd34d794bae01051fcdceb6b24a12a9a43859
    reference_type: commit
    reference_id: 667dd34d794bae01051fcdceb6b24a12a9a43859
  - url: https://github.com/nodejs/node/tree/6aca711858cc8d4b011384977c543d65ed17aeab
    reference_type: commit
    reference_id: 6aca711858cc8d4b011384977c543d65ed17aeab
  - url: https://github.com/nodejs/node/tree/6d17b693eccfb1a8f34893458c0c67dedd1c30c6
    reference_type: commit
    reference_id: 6d17b693eccfb1a8f34893458c0c67dedd1c30c6
  - url: https://github.com/nodejs/node/tree/7bc2cf7fa9a2016fadb27e042968a69297bd975e
    reference_type: commit
    reference_id: 7bc2cf7fa9a2016fadb27e042968a69297bd975e
  - url: https://github.com/nodejs/node/tree/83975b7fb463e29c92c8e83693b725e269cee149
    reference_type: commit
    reference_id: 83975b7fb463e29c92c8e83693b725e269cee149
  - url: https://github.com/nodejs/node/tree/96a4559f259f109a2abc480caeba12644b8a8fd1
    reference_type: commit
    reference_id: 96a4559f259f109a2abc480caeba12644b8a8fd1
  - url: https://github.com/nodejs/node/tree/9b7db62276e4a9c97aedf91daf38bf7b7d23fee4
    reference_type: commit
    reference_id: 9b7db62276e4a9c97aedf91daf38bf7b7d23fee4
  - url: https://github.com/nodejs/node/tree/a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b
    reference_type: commit
    reference_id: a9d1e5059f9cc63cafc8e786a7b6332aa7ab3b2b
  - url: https://github.com/nodejs/node/tree/af9140088621abd09016848f4526d66b7a81b9ba
    reference_type: commit
    reference_id: af9140088621abd09016848f4526d66b7a81b9ba
  - url: https://github.com/nodejs/node/tree/b02d895137eea92fc140a53d26b867fb462cdf44
    reference_type: commit
    reference_id: b02d895137eea92fc140a53d26b867fb462cdf44
  - url: https://github.com/nodejs/node/tree/dd1977f3ddda8bb0b939699cae998e4e72d3677a
    reference_type: commit
    reference_id: dd1977f3ddda8bb0b939699cae998e4e72d3677a
  - url: https://github.com/nodejs/node/tree/edd64fe5ba20c6c2f53720c672c591f09d9d4ac0
    reference_type: commit
    reference_id: edd64fe5ba20c6c2f53720c672c591f09d9d4ac0
  - url: https://github.com/nodejs/node/tree/f7892c16be6507e26c2ae478c261fa3fa2d84f52
    reference_type: commit
    reference_id: f7892c16be6507e26c2ae478c261fa3fa2d84f52
  - url: https://github.com/nodejs/node/tree/f95ef064f41ddba49b5f9b3c75b57f255aee5297
    reference_type: commit
    reference_id: f95ef064f41ddba49b5f9b3c75b57f255aee5297
