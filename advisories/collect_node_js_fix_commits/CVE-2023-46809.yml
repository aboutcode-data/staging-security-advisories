advisory_id: CVE-2023-46809
datasource_id: collect_node_js_fix_commits/CVE-2023-46809
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  20483aab7a71afd11360bed9ca33a11ab89e4c0d:crypto: fix `RSA_PKCS1_PADDING` error message

  The ability to revert the fix for CVE-2023-46809 was only added to
  Node.js 18.x, 20.x and 21.x as, per policy, security reverts are only
  added to the existing supported release lines at the time of the fix.

  The error message thrown when `RSA_PKCS1_PADDING` is used on `main`
  and subsequent major versions (i.e. Node.js 22 and 23) when OpenSSL
  does not support implicit rejections should not have suggested that
  it is possible to revert the fix.

  PR-URL: https://github.com/nodejs/node/pull/55629
  Fixes: https://github.com/nodejs/node/issues/55628
  Reviewed-By: Filip Skokan <panva.ip@gmail.com>
  Reviewed-By: Antoine du Hamel <duhamelantoine1995@gmail.com>
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Luigi Pinca <luigipinca@gmail.com>
  Reviewed-By: Tobias Nießen <tniessen@tnie.de>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  9b351b074936dfa476e98eb013f7b887ee6eaed1:crypto: fix `RSA_PKCS1_PADDING` error message

  The ability to revert the fix for CVE-2023-46809 was only added to
  Node.js 18.x, 20.x and 21.x as, per policy, security reverts are only
  added to the existing supported release lines at the time of the fix.

  The error message thrown when `RSA_PKCS1_PADDING` is used on `main`
  and subsequent major versions (i.e. Node.js 22 and 23) when OpenSSL
  does not support implicit rejections should not have suggested that
  it is possible to revert the fix.

  PR-URL: https://github.com/nodejs/node/pull/55629
  Fixes: https://github.com/nodejs/node/issues/55628
  Reviewed-By: Filip Skokan <panva.ip@gmail.com>
  Reviewed-By: Antoine du Hamel <duhamelantoine1995@gmail.com>
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Luigi Pinca <luigipinca@gmail.com>
  Reviewed-By: Tobias Nießen <tniessen@tnie.de>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  c2ff449e3f8fd39796cdb8d9496c47854ea1921d:crypto: fix `RSA_PKCS1_PADDING` error message

  The ability to revert the fix for CVE-2023-46809 was only added to
  Node.js 18.x, 20.x and 21.x as, per policy, security reverts are only
  added to the existing supported release lines at the time of the fix.

  The error message thrown when `RSA_PKCS1_PADDING` is used on `main`
  and subsequent major versions (i.e. Node.js 22 and 23) when OpenSSL
  does not support implicit rejections should not have suggested that
  it is possible to revert the fix.

  PR-URL: https://github.com/nodejs/node/pull/55629
  Fixes: https://github.com/nodejs/node/issues/55628
  Reviewed-By: Filip Skokan <panva.ip@gmail.com>
  Reviewed-By: Antoine du Hamel <duhamelantoine1995@gmail.com>
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Luigi Pinca <luigipinca@gmail.com>
  Reviewed-By: Tobias Nießen <tniessen@tnie.de>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  54cd268059626800dbe1e02a88b28d9538cf5587:crypto: disable PKCS#1 padding for privateDecrypt

  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=2269177

  Disable RSA_PKCS1_PADDING for crypto.privateDecrypt() in order
  to protect against the Marvin attack.

  Includes a security revert flag that can be used to restore
  support.

  Signed-off-by: Michael Dawson <midawson@redhat.com>
  PR-URL: https://github.com/nodejs-private/node-private/pull/525
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=2269177
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-46809
  7079c062bb4b4dd2930926f0f9425d4c9589ee7c:crypto: disable PKCS#1 padding for privateDecrypt

  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=2269177

  Disable RSA_PKCS1_PADDING for crypto.privateDecrypt() in order
  to protect against the Marvin attack.

  Includes a security revert flag that can be used to restore
  support.

  Signed-off-by: Michael Dawson <midawson@redhat.com>
  PR-URL: https://github.com/nodejs-private/node-private/pull/525
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=2269177
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-46809
  8344719369d0a8d944ec0b72492393c98633dbd2:crypto: disable PKCS#1 padding for privateDecrypt

  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=2269177

  Disable RSA_PKCS1_PADDING for crypto.privateDecrypt() in order
  to protect against the Marvin attack.

  Includes a security revert flag that can be used to restore
  support.

  Signed-off-by: Michael Dawson <midawson@redhat.com>
  PR-URL: https://github.com/nodejs-private/node-private/pull/525
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=2269177
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-46809
  d3d357ab096884f10f5d2f164149727eea875635:crypto: disable PKCS#1 padding for privateDecrypt

  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=2269177

  Disable RSA_PKCS1_PADDING for crypto.privateDecrypt() in order
  to protect against the Marvin attack.

  Includes a security revert flag that can be used to restore
  support.

  Signed-off-by: Michael Dawson <midawson@redhat.com>
  PR-URL: https://github.com/nodejs-private/node-private/pull/525
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  CVE-ID: CVE-2023-46809
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9b351b074936dfa476e98eb013f7b887ee6eaed1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8344719369d0a8d944ec0b72492393c98633dbd2
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 7079c062bb4b4dd2930926f0f9425d4c9589ee7c
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 54cd268059626800dbe1e02a88b28d9538cf5587
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: c2ff449e3f8fd39796cdb8d9496c47854ea1921d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: d3d357ab096884f10f5d2f164149727eea875635
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 20483aab7a71afd11360bed9ca33a11ab89e4c0d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/20483aab7a71afd11360bed9ca33a11ab89e4c0d
    reference_type: commit
    reference_id: 20483aab7a71afd11360bed9ca33a11ab89e4c0d
  - url: https://github.com/nodejs/node/tree/54cd268059626800dbe1e02a88b28d9538cf5587
    reference_type: commit
    reference_id: 54cd268059626800dbe1e02a88b28d9538cf5587
  - url: https://github.com/nodejs/node/tree/7079c062bb4b4dd2930926f0f9425d4c9589ee7c
    reference_type: commit
    reference_id: 7079c062bb4b4dd2930926f0f9425d4c9589ee7c
  - url: https://github.com/nodejs/node/tree/8344719369d0a8d944ec0b72492393c98633dbd2
    reference_type: commit
    reference_id: 8344719369d0a8d944ec0b72492393c98633dbd2
  - url: https://github.com/nodejs/node/tree/9b351b074936dfa476e98eb013f7b887ee6eaed1
    reference_type: commit
    reference_id: 9b351b074936dfa476e98eb013f7b887ee6eaed1
  - url: https://github.com/nodejs/node/tree/c2ff449e3f8fd39796cdb8d9496c47854ea1921d
    reference_type: commit
    reference_id: c2ff449e3f8fd39796cdb8d9496c47854ea1921d
  - url: https://github.com/nodejs/node/tree/d3d357ab096884f10f5d2f164149727eea875635
    reference_type: commit
    reference_id: d3d357ab096884f10f5d2f164149727eea875635
