advisory_id: CVE-2023-39333
datasource_id: collect_node_js_fix_commits/CVE-2023-39333
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  3b23b2ee531310e38a4ed7b659ef3e2d75e1e65d:module: fix code injection through export names

  createDynamicModule() properly escapes import names, but not export
  names. In WebAssembly, any string is a valid export name. Importing a
  WebAssembly module that uses a non-identifier export name leads to
  either a syntax error in createDynamicModule() or to code injection,
  that is, to the evaluation of almost arbitrary JavaScript code outside
  of the WebAssembly module.

  To address this issue, adopt the same mechanism in createExport() that
  createImport() already uses. Add tests for both exports and imports.

  PR-URL: https://github.com/nodejs-private/node-private/pull/461
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/489
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-39333
  937ea06fd5dde3ae217e29a78e118373674eb6f8:2023-10-13, Version 18.18.2 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * [CVE-2023-44487](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-44487): `nghttp2` Security Release (High)
  * [CVE-2023-45143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45143): `undici` Security Release (High)
  * [CVE-2023-38552](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38552): Integrity checks according to policies can be circumvented (Medium)
  * [CVE-2023-39333](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39333): Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/492
  937ea06fd5dde3ae217e29a78e118373674eb6f8:2023-10-13, Version 18.18.2 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * [CVE-2023-44487](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-44487): `nghttp2` Security Release (High)
  * [CVE-2023-45143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45143): `undici` Security Release (High)
  * [CVE-2023-38552](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38552): Integrity checks according to policies can be circumvented (Medium)
  * [CVE-2023-39333](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39333): Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/492
  deeffa0388a17e3f4848f914e88576087cc29727:2023-10-13, Version 20.8.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2023-44487: `nghttp2` Security Release (High)
  * CVE-2023-45143: `undici` Security Release (High)
  * CVE-2023-39332: Path traversal through path stored in Uint8Array (High)
  * CVE-2023-39331: Permission model improperly protects against path traversal (High)
  * CVE-2023-38552:  Integrity checks according to policies can be circumvented (Medium)
  * CVE-2023-39333: Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/491
  b485ffc458edc7140d43093cd8837a7c1ccc5ab3:2023-10-13, Version 20.8.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2023-44487: `nghttp2` Security Release (High)
  * CVE-2023-45143: `undici` Security Release (High)
  * CVE-2023-39332: Path traversal through path stored in Uint8Array (High)
  * CVE-2023-39331: Permission model improperly protects against path traversal (High)
  * CVE-2023-38552:  Integrity checks according to policies can be circumvented (Medium)
  * CVE-2023-39333: Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/491
  8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839:2023-10-13, Version 18.18.2 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * [CVE-2023-44487](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-44487): `nghttp2` Security Release (High)
  * [CVE-2023-45143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45143): `undici` Security Release (High)
  * [CVE-2023-38552](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38552): Integrity checks according to policies can be circumvented (Medium)
  * [CVE-2023-39333](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39333): Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/492
  8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839:2023-10-13, Version 18.18.2 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * [CVE-2023-44487](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-44487): `nghttp2` Security Release (High)
  * [CVE-2023-45143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45143): `undici` Security Release (High)
  * [CVE-2023-38552](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38552): Integrity checks according to policies can be circumvented (Medium)
  * [CVE-2023-39333](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39333): Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/492
  eaf9083cf1e43bd897ac8244dcc0f4e3500150ca:module: fix code injection through export names

  createDynamicModule() properly escapes import names, but not export
  names. In WebAssembly, any string is a valid export name. Importing a
  WebAssembly module that uses a non-identifier export name leads to
  either a syntax error in createDynamicModule() or to code injection,
  that is, to the evaluation of almost arbitrary JavaScript code outside
  of the WebAssembly module.

  To address this issue, adopt the same mechanism in createExport() that
  createImport() already uses. Add tests for both exports and imports.

  PR-URL: https://github.com/nodejs-private/node-private/pull/461
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/490
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-39333
  f5c90b2951ca8ce8e47136ef073a1778edcad15d:module: fix code injection through export names

  createDynamicModule() properly escapes import names, but not export
  names. In WebAssembly, any string is a valid export name. Importing a
  WebAssembly module that uses a non-identifier export name leads to
  either a syntax error in createDynamicModule() or to code injection,
  that is, to the evaluation of almost arbitrary JavaScript code outside
  of the WebAssembly module.

  To address this issue, adopt the same mechanism in createExport() that
  createImport() already uses. Add tests for both exports and imports.

  PR-URL: https://github.com/nodejs-private/node-private/pull/461
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/489
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-39333
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: eaf9083cf1e43bd897ac8244dcc0f4e3500150ca
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 937ea06fd5dde3ae217e29a78e118373674eb6f8
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b485ffc458edc7140d43093cd8837a7c1ccc5ab3
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: f5c90b2951ca8ce8e47136ef073a1778edcad15d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 3b23b2ee531310e38a4ed7b659ef3e2d75e1e65d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: deeffa0388a17e3f4848f914e88576087cc29727
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/3b23b2ee531310e38a4ed7b659ef3e2d75e1e65d
    reference_type: commit
    reference_id: 3b23b2ee531310e38a4ed7b659ef3e2d75e1e65d
  - url: https://github.com/nodejs/node/tree/8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839
    reference_type: commit
    reference_id: 8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839
  - url: https://github.com/nodejs/node/tree/937ea06fd5dde3ae217e29a78e118373674eb6f8
    reference_type: commit
    reference_id: 937ea06fd5dde3ae217e29a78e118373674eb6f8
  - url: https://github.com/nodejs/node/tree/b485ffc458edc7140d43093cd8837a7c1ccc5ab3
    reference_type: commit
    reference_id: b485ffc458edc7140d43093cd8837a7c1ccc5ab3
  - url: https://github.com/nodejs/node/tree/deeffa0388a17e3f4848f914e88576087cc29727
    reference_type: commit
    reference_id: deeffa0388a17e3f4848f914e88576087cc29727
  - url: https://github.com/nodejs/node/tree/eaf9083cf1e43bd897ac8244dcc0f4e3500150ca
    reference_type: commit
    reference_id: eaf9083cf1e43bd897ac8244dcc0f4e3500150ca
  - url: https://github.com/nodejs/node/tree/f5c90b2951ca8ce8e47136ef073a1778edcad15d
    reference_type: commit
    reference_id: f5c90b2951ca8ce8e47136ef073a1778edcad15d
