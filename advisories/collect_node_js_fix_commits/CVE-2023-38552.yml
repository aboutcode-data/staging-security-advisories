advisory_id: CVE-2023-38552
datasource_id: collect_node_js_fix_commits/CVE-2023-38552
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  e673c0362979f9cb2c74fc6876c45ae9be1fe853:policy: use tamper-proof integrity check function

  Using the JavaScript Hash class is unsafe because its internals can be
  tampered with. In particular, an application can cause
  Hash.prototype.digest() to return arbitrary values, thus allowing to
  circumvent the integrity verification that policies are supposed to
  guarantee.

  Add and use a new C++ binding internalVerifyIntegrity() that (hopefully)
  cannot be tampered with from JavaScript.

  PR-URL: https://github.com/nodejs-private/node-private/pull/462
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-38552
  937ea06fd5dde3ae217e29a78e118373674eb6f8:2023-10-13, Version 18.18.2 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * [CVE-2023-44487](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-44487): `nghttp2` Security Release (High)
  * [CVE-2023-45143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45143): `undici` Security Release (High)
  * [CVE-2023-38552](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38552): Integrity checks according to policies can be circumvented (Medium)
  * [CVE-2023-39333](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39333): Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/492
  937ea06fd5dde3ae217e29a78e118373674eb6f8:2023-10-13, Version 18.18.2 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * [CVE-2023-44487](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-44487): `nghttp2` Security Release (High)
  * [CVE-2023-45143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45143): `undici` Security Release (High)
  * [CVE-2023-38552](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38552): Integrity checks according to policies can be circumvented (Medium)
  * [CVE-2023-39333](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39333): Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/492
  deeffa0388a17e3f4848f914e88576087cc29727:2023-10-13, Version 20.8.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2023-44487: `nghttp2` Security Release (High)
  * CVE-2023-45143: `undici` Security Release (High)
  * CVE-2023-39332: Path traversal through path stored in Uint8Array (High)
  * CVE-2023-39331: Permission model improperly protects against path traversal (High)
  * CVE-2023-38552:  Integrity checks according to policies can be circumvented (Medium)
  * CVE-2023-39333: Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/491
  b485ffc458edc7140d43093cd8837a7c1ccc5ab3:2023-10-13, Version 20.8.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2023-44487: `nghttp2` Security Release (High)
  * CVE-2023-45143: `undici` Security Release (High)
  * CVE-2023-39332: Path traversal through path stored in Uint8Array (High)
  * CVE-2023-39331: Permission model improperly protects against path traversal (High)
  * CVE-2023-38552:  Integrity checks according to policies can be circumvented (Medium)
  * CVE-2023-39333: Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/491
  8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839:2023-10-13, Version 18.18.2 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * [CVE-2023-44487](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-44487): `nghttp2` Security Release (High)
  * [CVE-2023-45143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45143): `undici` Security Release (High)
  * [CVE-2023-38552](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38552): Integrity checks according to policies can be circumvented (Medium)
  * [CVE-2023-39333](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39333): Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/492
  8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839:2023-10-13, Version 18.18.2 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * [CVE-2023-44487](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-44487): `nghttp2` Security Release (High)
  * [CVE-2023-45143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45143): `undici` Security Release (High)
  * [CVE-2023-38552](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38552): Integrity checks according to policies can be circumvented (Medium)
  * [CVE-2023-39333](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39333): Code injection via WebAssembly export names (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/492
  1c538938ccadfd35fbc699d8e85102736cd5945c:policy: use tamper-proof integrity check function

  Using the JavaScript Hash class is unsafe because its internals can be
  tampered with. In particular, an application can cause
  Hash.prototype.digest() to return arbitrary values, thus allowing to
  circumvent the integrity verification that policies are supposed to
  guarantee.

  Add and use a new C++ binding internalVerifyIntegrity() that (hopefully)
  cannot be tampered with from JavaScript.

  PR-URL: https://github.com/nodejs-private/node-private/pull/462
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/493
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-38552
  a4cb7fc7c04869f051e270ed192a679d2d108328:policy: use tamper-proof integrity check function

  Using the JavaScript Hash class is unsafe because its internals can be
  tampered with. In particular, an application can cause
  Hash.prototype.digest() to return arbitrary values, thus allowing to
  circumvent the integrity verification that policies are supposed to
  guarantee.

  Add and use a new C++ binding internalVerifyIntegrity() that (hopefully)
  cannot be tampered with from JavaScript.

  PR-URL: https://github.com/nodejs-private/node-private/pull/462
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-38552
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1c538938ccadfd35fbc699d8e85102736cd5945c
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 937ea06fd5dde3ae217e29a78e118373674eb6f8
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b485ffc458edc7140d43093cd8837a7c1ccc5ab3
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a4cb7fc7c04869f051e270ed192a679d2d108328
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e673c0362979f9cb2c74fc6876c45ae9be1fe853
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: deeffa0388a17e3f4848f914e88576087cc29727
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/1c538938ccadfd35fbc699d8e85102736cd5945c
    reference_type: commit
    reference_id: 1c538938ccadfd35fbc699d8e85102736cd5945c
  - url: https://github.com/nodejs/node/tree/8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839
    reference_type: commit
    reference_id: 8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839
  - url: https://github.com/nodejs/node/tree/937ea06fd5dde3ae217e29a78e118373674eb6f8
    reference_type: commit
    reference_id: 937ea06fd5dde3ae217e29a78e118373674eb6f8
  - url: https://github.com/nodejs/node/tree/a4cb7fc7c04869f051e270ed192a679d2d108328
    reference_type: commit
    reference_id: a4cb7fc7c04869f051e270ed192a679d2d108328
  - url: https://github.com/nodejs/node/tree/b485ffc458edc7140d43093cd8837a7c1ccc5ab3
    reference_type: commit
    reference_id: b485ffc458edc7140d43093cd8837a7c1ccc5ab3
  - url: https://github.com/nodejs/node/tree/deeffa0388a17e3f4848f914e88576087cc29727
    reference_type: commit
    reference_id: deeffa0388a17e3f4848f914e88576087cc29727
  - url: https://github.com/nodejs/node/tree/e673c0362979f9cb2c74fc6876c45ae9be1fe853
    reference_type: commit
    reference_id: e673c0362979f9cb2c74fc6876c45ae9be1fe853
