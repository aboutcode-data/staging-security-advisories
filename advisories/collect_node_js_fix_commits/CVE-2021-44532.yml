advisory_id: CVE-2021-44532
datasource_id: collect_node_js_fix_commits/CVE-2021-44532
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  c4194c0dce93566fd463ff575726064886c74c1e:2022-01-10, Version 17.3.1 (Current)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/311
  c4194c0dce93566fd463ff575726064886c74c1e:2022-01-10, Version 17.3.1 (Current)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/311
  f99a2c275d940a9b55aa8a12f56c3be5984b2f64:2022-01-10, Version 16.13.2 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/312
  f99a2c275d940a9b55aa8a12f56c3be5984b2f64:2022-01-10, Version 16.13.2 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/312
  af829837bc4d7b1d145728491fda5cc88f1ed353:2022-01-10, Version 14.18.3 'Fermium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/310
  af829837bc4d7b1d145728491fda5cc88f1ed353:2022-01-10, Version 14.18.3 'Fermium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/310
  92e1abd541eb3bf5f01cb68bffbe96f79811db55:2022-01-10, Version 12.22.9 'Erbium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/309
  92e1abd541eb3bf5f01cb68bffbe96f79811db55:2022-01-10, Version 12.22.9 'Erbium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/309
  466e5415a2b7b3574ab5403acb87e89a94a980d1:crypto,tls: implement safe x509 GeneralName format

  This change introduces JSON-compatible escaping rules for strings that
  include X.509 GeneralName components (see RFC 5280). This non-standard
  format avoids ambiguities and prevents injection attacks that could
  previously lead to X.509 certificates being accepted even though they
  were not valid for the target hostname.

  These changes affect the format of subject alternative names and the
  format of authority information access. The checkServerIdentity function
  has been modified to safely handle the new format, eliminating the
  possibility of injecting subject alternative names into the verification
  logic.

  Because each subject alternative name is only encoded as a JSON string
  literal if necessary for security purposes, this change will only be
  visible in rare cases.

  This addresses CVE-2021-44532.

  CVE-ID: CVE-2021-44532
  PR-URL: https://github.com/nodejs-private/node-private/pull/300
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  466e5415a2b7b3574ab5403acb87e89a94a980d1:crypto,tls: implement safe x509 GeneralName format

  This change introduces JSON-compatible escaping rules for strings that
  include X.509 GeneralName components (see RFC 5280). This non-standard
  format avoids ambiguities and prevents injection attacks that could
  previously lead to X.509 certificates being accepted even though they
  were not valid for the target hostname.

  These changes affect the format of subject alternative names and the
  format of authority information access. The checkServerIdentity function
  has been modified to safely handle the new format, eliminating the
  possibility of injecting subject alternative names into the verification
  logic.

  Because each subject alternative name is only encoded as a JSON string
  literal if necessary for security purposes, this change will only be
  visible in rare cases.

  This addresses CVE-2021-44532.

  CVE-ID: CVE-2021-44532
  PR-URL: https://github.com/nodejs-private/node-private/pull/300
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  acb71eab779fb56bf70e8a9e0cb2e82a089a87de:2022-01-10, Version 16.13.2 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/312
  acb71eab779fb56bf70e8a9e0cb2e82a089a87de:2022-01-10, Version 16.13.2 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/312
  e4f326669a3f98a8804dde23eee6d8403f0a99f1:2022-01-10, Version 17.3.1 (Current)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/311
  e4f326669a3f98a8804dde23eee6d8403f0a99f1:2022-01-10, Version 17.3.1 (Current)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/311
  e52882da4ca99bd9c4f63890224327632f8bda42:crypto,tls: implement safe x509 GeneralName format

  This change introduces JSON-compatible escaping rules for strings that
  include X.509 GeneralName components (see RFC 5280). This non-standard
  format avoids ambiguities and prevents injection attacks that could
  previously lead to X.509 certificates being accepted even though they
  were not valid for the target hostname.

  These changes affect the format of subject alternative names and the
  format of authority information access. The checkServerIdentity function
  has been modified to safely handle the new format, eliminating the
  possibility of injecting subject alternative names into the verification
  logic.

  Because each subject alternative name is only encoded as a JSON string
  literal if necessary for security purposes, this change will only be
  visible in rare cases.

  This addresses CVE-2021-44532.

  Co-authored-by: Akshay K <iit.akshay@gmail.com>
  CVE-ID: CVE-2021-44532
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/304
  PR-URL: https://github.com/nodejs-private/node-private/pull/300
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  e52882da4ca99bd9c4f63890224327632f8bda42:crypto,tls: implement safe x509 GeneralName format

  This change introduces JSON-compatible escaping rules for strings that
  include X.509 GeneralName components (see RFC 5280). This non-standard
  format avoids ambiguities and prevents injection attacks that could
  previously lead to X.509 certificates being accepted even though they
  were not valid for the target hostname.

  These changes affect the format of subject alternative names and the
  format of authority information access. The checkServerIdentity function
  has been modified to safely handle the new format, eliminating the
  possibility of injecting subject alternative names into the verification
  logic.

  Because each subject alternative name is only encoded as a JSON string
  literal if necessary for security purposes, this change will only be
  visible in rare cases.

  This addresses CVE-2021-44532.

  Co-authored-by: Akshay K <iit.akshay@gmail.com>
  CVE-ID: CVE-2021-44532
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/304
  PR-URL: https://github.com/nodejs-private/node-private/pull/300
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  92df3d654b366aa115fb672756cb051d480d8acc:2022-01-10, Version 14.18.3 'Fermium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/310
  92df3d654b366aa115fb672756cb051d480d8acc:2022-01-10, Version 14.18.3 'Fermium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/310
  4e44cbfba6bbb87aa15564ea6856a556804f71c0:2022-01-10, Version 12.22.9 'Erbium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/309
  4e44cbfba6bbb87aa15564ea6856a556804f71c0:2022-01-10, Version 12.22.9 'Erbium' (LTS)

  This is a security release.

  Notable changes:

  Improper handling of URI Subject Alternative Names (Medium)(CVE-2021-44531)
  - Accepting arbitrary Subject Alternative Name (SAN) types, unless a PKI
  is specifically defined to use a particular SAN type, can result in
  bypassing name-constrained intermediates. Node.js was accepting URI SAN
  types, which PKIs are often not defined to use. Additionally, when a
  protocol allows URI SANs, Node.js did not match the URI correctly.
  - Versions of Node.js with the fix for this disable the URI SAN type when
  checking a certificate against a hostname. This behavior can be
  reverted through the `--security-revert` command-line option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44531

  Certificate Verification Bypass via String Injection (Medium)(CVE-2021-44532)
  - Node.js converts SANs (Subject Alternative Names) to a string format.
  It uses this string to check peer certificates against hostnames when
  validating connections. The string format was subject to an injection
  vulnerability when name constraints were used within a certificate
  chain, allowing the bypass of these name constraints.
  - Versions of Node.js with the fix for this escape SANs containing the
  problematic characters in order to prevent the injection. This
  behavior can be reverted through the `--security-revert` command-line
  option.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44532

  Incorrect handling of certificate subject and issuer fields (Medium)(CVE-2021-44533)
  - Node.js did not handle multi-value Relative Distinguished Names
  correctly. Attackers could craft certificate subjects containing a
  single-value Relative Distinguished Name that would be interpreted as a
  multi-value Relative Distinguished Name, for example, in order to inject
  a Common Name that would allow bypassing the certificate subject
  verification.
  - Affected versions of Node.js do not accept multi-value Relative
  Distinguished Names and are thus not vulnerable to such attacks
  themselves. However, third-party code that uses node's ambiguous
  presentation of certificate subjects may be vulnerable.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44533

  Prototype pollution via `console.table` properties (Low)(CVE-2022-21824)
  - Due to the formatting logic of the `console.table()` function it was
  not safe to allow user controlled input to be passed to the `properties`
  parameter while simultaneously passing a plain object with at least one
  property as the first parameter, which could be `__proto__`. The
  prototype pollution has very limited control, in that it only allows an
  empty string to be assigned numerical keys of the object prototype.
  - Versions of Node.js with the fix for this use a null protoype for the
  object these properties are being assigned to.
  - More details will be available at
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21824

  PR-URL: https://github.com/nodejs-private/node-private/pull/309
  2e2c45553dd7eac48027cd39bdb344e55a113f01:crypto,tls: implement safe x509 GeneralName format

  This change introduces JSON-compatible escaping rules for strings that
  include X.509 GeneralName components (see RFC 5280). This non-standard
  format avoids ambiguities and prevents injection attacks that could
  previously lead to X.509 certificates being accepted even though they
  were not valid for the target hostname.

  These changes affect the format of subject alternative names and the
  format of authority information access. The checkServerIdentity function
  has been modified to safely handle the new format, eliminating the
  possibility of injecting subject alternative names into the verification
  logic.

  Because each subject alternative name is only encoded as a JSON string
  literal if necessary for security purposes, this change will only be
  visible in rare cases.

  This addresses CVE-2021-44532.

  Co-authored-by: Akshay K <iit.akshay@gmail.com>
  CVE-ID: CVE-2021-44532
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/303
  PR-URL: https://github.com/nodejs-private/node-private/pull/300
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  2e2c45553dd7eac48027cd39bdb344e55a113f01:crypto,tls: implement safe x509 GeneralName format

  This change introduces JSON-compatible escaping rules for strings that
  include X.509 GeneralName components (see RFC 5280). This non-standard
  format avoids ambiguities and prevents injection attacks that could
  previously lead to X.509 certificates being accepted even though they
  were not valid for the target hostname.

  These changes affect the format of subject alternative names and the
  format of authority information access. The checkServerIdentity function
  has been modified to safely handle the new format, eliminating the
  possibility of injecting subject alternative names into the verification
  logic.

  Because each subject alternative name is only encoded as a JSON string
  literal if necessary for security purposes, this change will only be
  visible in rare cases.

  This addresses CVE-2021-44532.

  Co-authored-by: Akshay K <iit.akshay@gmail.com>
  CVE-ID: CVE-2021-44532
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/303
  PR-URL: https://github.com/nodejs-private/node-private/pull/300
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  19873abfb24dce75ffff042efe76dc5633052677:crypto,tls: implement safe x509 GeneralName format

  This change introduces JSON-compatible escaping rules for strings that
  include X.509 GeneralName components (see RFC 5280). This non-standard
  format avoids ambiguities and prevents injection attacks that could
  previously lead to X.509 certificates being accepted even though they
  were not valid for the target hostname.

  These changes affect the format of subject alternative names and the
  format of authority information access. The checkServerIdentity function
  has been modified to safely handle the new format, eliminating the
  possibility of injecting subject alternative names into the verification
  logic.

  Because each subject alternative name is only encoded as a JSON string
  literal if necessary for security purposes, this change will only be
  visible in rare cases.

  This addresses CVE-2021-44532.

  Co-authored-by: Akshay K <iit.akshay@gmail.com>
  CVE-ID: CVE-2021-44532
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/306
  PR-URL: https://github.com/nodejs-private/node-private/pull/300
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  19873abfb24dce75ffff042efe76dc5633052677:crypto,tls: implement safe x509 GeneralName format

  This change introduces JSON-compatible escaping rules for strings that
  include X.509 GeneralName components (see RFC 5280). This non-standard
  format avoids ambiguities and prevents injection attacks that could
  previously lead to X.509 certificates being accepted even though they
  were not valid for the target hostname.

  These changes affect the format of subject alternative names and the
  format of authority information access. The checkServerIdentity function
  has been modified to safely handle the new format, eliminating the
  possibility of injecting subject alternative names into the verification
  logic.

  Because each subject alternative name is only encoded as a JSON string
  literal if necessary for security purposes, this change will only be
  visible in rare cases.

  This addresses CVE-2021-44532.

  Co-authored-by: Akshay K <iit.akshay@gmail.com>
  CVE-ID: CVE-2021-44532
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/306
  PR-URL: https://github.com/nodejs-private/node-private/pull/300
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  df1b2c33f6b5dec388858a1e700619596c788969:crypto,tls: implement safe x509 GeneralName format

  This change introduces JSON-compatible escaping rules for strings that
  include X.509 GeneralName components (see RFC 5280). This non-standard
  format avoids ambiguities and prevents injection attacks that could
  previously lead to X.509 certificates being accepted even though they
  were not valid for the target hostname.

  These changes affect the format of subject alternative names and the
  format of authority information access. The checkServerIdentity function
  has been modified to safely handle the new format, eliminating the
  possibility of injecting subject alternative names into the verification
  logic.

  Because each subject alternative name is only encoded as a JSON string
  literal if necessary for security purposes, this change will only be
  visible in rare cases.

  This addresses CVE-2021-44532.

  Co-authored-by: Akshay K <iit.akshay@gmail.com>
  CVE-ID: CVE-2021-44532
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/305
  PR-URL: https://github.com/nodejs-private/node-private/pull/300
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  df1b2c33f6b5dec388858a1e700619596c788969:crypto,tls: implement safe x509 GeneralName format

  This change introduces JSON-compatible escaping rules for strings that
  include X.509 GeneralName components (see RFC 5280). This non-standard
  format avoids ambiguities and prevents injection attacks that could
  previously lead to X.509 certificates being accepted even though they
  were not valid for the target hostname.

  These changes affect the format of subject alternative names and the
  format of authority information access. The checkServerIdentity function
  has been modified to safely handle the new format, eliminating the
  possibility of injecting subject alternative names into the verification
  logic.

  Because each subject alternative name is only encoded as a JSON string
  literal if necessary for security purposes, this change will only be
  visible in rare cases.

  This addresses CVE-2021-44532.

  Co-authored-by: Akshay K <iit.akshay@gmail.com>
  CVE-ID: CVE-2021-44532
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/305
  PR-URL: https://github.com/nodejs-private/node-private/pull/300
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 92e1abd541eb3bf5f01cb68bffbe96f79811db55
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: df1b2c33f6b5dec388858a1e700619596c788969
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e4f326669a3f98a8804dde23eee6d8403f0a99f1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 2e2c45553dd7eac48027cd39bdb344e55a113f01
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4e44cbfba6bbb87aa15564ea6856a556804f71c0
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e52882da4ca99bd9c4f63890224327632f8bda42
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: f99a2c275d940a9b55aa8a12f56c3be5984b2f64
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: af829837bc4d7b1d145728491fda5cc88f1ed353
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 466e5415a2b7b3574ab5403acb87e89a94a980d1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 92df3d654b366aa115fb672756cb051d480d8acc
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: c4194c0dce93566fd463ff575726064886c74c1e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: acb71eab779fb56bf70e8a9e0cb2e82a089a87de
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: '19873abfb24dce75ffff042efe76dc5633052677'
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/19873abfb24dce75ffff042efe76dc5633052677
    reference_type: commit
    reference_id: '19873abfb24dce75ffff042efe76dc5633052677'
  - url: https://github.com/nodejs/node/tree/2e2c45553dd7eac48027cd39bdb344e55a113f01
    reference_type: commit
    reference_id: 2e2c45553dd7eac48027cd39bdb344e55a113f01
  - url: https://github.com/nodejs/node/tree/466e5415a2b7b3574ab5403acb87e89a94a980d1
    reference_type: commit
    reference_id: 466e5415a2b7b3574ab5403acb87e89a94a980d1
  - url: https://github.com/nodejs/node/tree/4e44cbfba6bbb87aa15564ea6856a556804f71c0
    reference_type: commit
    reference_id: 4e44cbfba6bbb87aa15564ea6856a556804f71c0
  - url: https://github.com/nodejs/node/tree/92df3d654b366aa115fb672756cb051d480d8acc
    reference_type: commit
    reference_id: 92df3d654b366aa115fb672756cb051d480d8acc
  - url: https://github.com/nodejs/node/tree/92e1abd541eb3bf5f01cb68bffbe96f79811db55
    reference_type: commit
    reference_id: 92e1abd541eb3bf5f01cb68bffbe96f79811db55
  - url: https://github.com/nodejs/node/tree/acb71eab779fb56bf70e8a9e0cb2e82a089a87de
    reference_type: commit
    reference_id: acb71eab779fb56bf70e8a9e0cb2e82a089a87de
  - url: https://github.com/nodejs/node/tree/af829837bc4d7b1d145728491fda5cc88f1ed353
    reference_type: commit
    reference_id: af829837bc4d7b1d145728491fda5cc88f1ed353
  - url: https://github.com/nodejs/node/tree/c4194c0dce93566fd463ff575726064886c74c1e
    reference_type: commit
    reference_id: c4194c0dce93566fd463ff575726064886c74c1e
  - url: https://github.com/nodejs/node/tree/df1b2c33f6b5dec388858a1e700619596c788969
    reference_type: commit
    reference_id: df1b2c33f6b5dec388858a1e700619596c788969
  - url: https://github.com/nodejs/node/tree/e4f326669a3f98a8804dde23eee6d8403f0a99f1
    reference_type: commit
    reference_id: e4f326669a3f98a8804dde23eee6d8403f0a99f1
  - url: https://github.com/nodejs/node/tree/e52882da4ca99bd9c4f63890224327632f8bda42
    reference_type: commit
    reference_id: e52882da4ca99bd9c4f63890224327632f8bda42
  - url: https://github.com/nodejs/node/tree/f99a2c275d940a9b55aa8a12f56c3be5984b2f64
    reference_type: commit
    reference_id: f99a2c275d940a9b55aa8a12f56c3be5984b2f64
